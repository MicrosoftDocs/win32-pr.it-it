---
title: Informazioni su Dynamic Data Exchange
description: In questo argomento viene illustrato il trasferimento dei dati tra le applicazioni.
ms.assetid: 0bcd8de4-a6f0-4f2a-8b9d-0b1b638925fb
keywords:
- Dynamic Data Exchange (DDE), informazioni
- DDE (Dynamic Data Exchange), informazioni
- scambio di dati, Dynamic Data Exchange (DDE)
- Dynamic Data Exchange (DDE), collegamento ai dati in tempo reale
- DDE (Dynamic Data Exchange), collegamento ai dati in tempo reale
- Dynamic Data Exchange (DDE), creazione di documenti composti
- DDE (Dynamic Data Exchange), creazione di documenti composti
- Dynamic Data Exchange (DDE), query di dati
- DDE (Dynamic Data Exchange), query di dati
- Dynamic Data Exchange (DDE), esempi
- DDE (Dynamic Data Exchange), esempi
- Dynamic Data Exchange (DDE), rappresentazione
- DDE (Dynamic Data Exchange), rappresentazione
- Dynamic Data Exchange (DDE), messaggi
- DDE (Dynamic Data Exchange), messaggi
- Dynamic Data Exchange (DDE), atomi
- DDE (Dynamic Data Exchange), atomi
- Dynamic Data Exchange (DDE), oggetti Shared Memory
- DDE (Dynamic Data Exchange), oggetti Shared Memory
- Dynamic Data Exchange (DDE), funzioni di compressione di parametri
- DDE (Dynamic Data Exchange), funzioni di compressione di parametri
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d38574e9182255e8f6761520aea60575d8affbc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399524"
---
# <a name="about-dynamic-data-exchange"></a><span data-ttu-id="edeff-124">Informazioni su Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-124">About Dynamic Data Exchange</span></span>

<span data-ttu-id="edeff-125">In Windows sono disponibili diversi metodi per il trasferimento dei dati tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-125">Windows provides several methods for transferring data between applications.</span></span> <span data-ttu-id="edeff-126">Un metodo consiste nell'utilizzare il protocollo Dynamic Data Exchange (DDE).</span><span class="sxs-lookup"><span data-stu-id="edeff-126">One method is to use the Dynamic Data Exchange (DDE) protocol.</span></span> <span data-ttu-id="edeff-127">Il protocollo DDE è un set di messaggi e linee guida.</span><span class="sxs-lookup"><span data-stu-id="edeff-127">The DDE protocol is a set of messages and guidelines.</span></span> <span data-ttu-id="edeff-128">Invia messaggi tra applicazioni che condividono dati e utilizza la memoria condivisa per scambiare dati tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-128">It sends messages between applications that share data and uses shared memory to exchange data between applications.</span></span> <span data-ttu-id="edeff-129">Le applicazioni possono utilizzare il protocollo DDE per i trasferimenti di dati monouso e per gli scambi continui in cui le applicazioni inviano gli aggiornamenti l'uno all'altro man volta che i nuovi dati diventano disponibili.</span><span class="sxs-lookup"><span data-stu-id="edeff-129">Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</span></span>

<span data-ttu-id="edeff-130">Windows supporta inoltre la libreria di gestione Dynamic Data Exchange (DDEML).</span><span class="sxs-lookup"><span data-stu-id="edeff-130">Windows also supports the Dynamic Data Exchange Management Library (DDEML).</span></span> <span data-ttu-id="edeff-131">DDEML è una libreria di collegamento dinamico (DLL) che può essere utilizzata dalle applicazioni per condividere i dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-131">The DDEML is a dynamic-link library (DLL) that applications can use to share data.</span></span> <span data-ttu-id="edeff-132">DDEML fornisce funzioni e messaggi che semplificano l'attività di aggiunta della funzionalità DDE a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-132">The DDEML provides functions and messages that simplify the task of adding DDE capability to an application.</span></span> <span data-ttu-id="edeff-133">Anziché inviare, inviare ed elaborare direttamente i messaggi DDE, un'applicazione utilizza le funzioni DDEML per gestire le conversazioni DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-133">Instead of sending, posting, and processing DDE messages directly, an application uses the DDEML functions to manage DDE conversations.</span></span> <span data-ttu-id="edeff-134">Una conversazione DDE è l'interazione tra applicazioni client e server.</span><span class="sxs-lookup"><span data-stu-id="edeff-134">(A DDE conversation is the interaction between client and server applications.)</span></span>

<span data-ttu-id="edeff-135">DDEML fornisce inoltre una funzionalità per la gestione delle stringhe e dei dati condivisi dalle applicazioni DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-135">The DDEML also provides a facility for managing the strings and data that DDE applications share.</span></span> <span data-ttu-id="edeff-136">Anziché utilizzare gli atomi e i puntatori agli oggetti Shared Memory, le applicazioni DDE creano e scambiano handle di stringa, che identificano le stringhe e gli handle di dati, che identificano gli oggetti di memoria.</span><span class="sxs-lookup"><span data-stu-id="edeff-136">Instead of using atoms and pointers to shared memory objects, DDE applications create and exchange string handles, which identify strings, and data handles, which identify memory objects.</span></span> <span data-ttu-id="edeff-137">Il DDEML consente anche a un'applicazione server di registrare i nomi di servizio supportati.</span><span class="sxs-lookup"><span data-stu-id="edeff-137">The DDEML also makes it possible for a server application to register the service names it supports.</span></span> <span data-ttu-id="edeff-138">I nomi vengono trasmessi ad altre applicazioni nel sistema, che possono usare i nomi per connettersi al server.</span><span class="sxs-lookup"><span data-stu-id="edeff-138">The names are broadcast to other applications in the system, which can use the names to connect to the server.</span></span> <span data-ttu-id="edeff-139">Inoltre, il DDEML garantisce la compatibilità tra applicazioni DDE forzando l'implementazione del protocollo DDE in modo coerente.</span><span class="sxs-lookup"><span data-stu-id="edeff-139">Moreover, the DDEML ensures compatibility among DDE applications by forcing them to implement the DDE protocol in a consistent manner.</span></span>

<span data-ttu-id="edeff-140">Le applicazioni esistenti che usano il protocollo DDE basato su messaggi sono completamente compatibili con quelle che usano DDEML.</span><span class="sxs-lookup"><span data-stu-id="edeff-140">Existing applications that use the message-based DDE protocol are fully compatible with those that use the DDEML.</span></span> <span data-ttu-id="edeff-141">Ovvero, un'applicazione che utilizza un DDE basato su messaggi può stabilire conversazioni ed eseguire transazioni con applicazioni che utilizzano DDEML.</span><span class="sxs-lookup"><span data-stu-id="edeff-141">That is, an application that uses message-based DDE can establish conversations and perform transactions with applications that use the DDEML.</span></span> <span data-ttu-id="edeff-142">A causa dei numerosi vantaggi di DDEML, le nuove applicazioni devono utilizzarlo invece dei messaggi DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-142">Because of the many advantages of the DDEML, new applications should use it rather than the DDE messages.</span></span> <span data-ttu-id="edeff-143">Per usare gli elementi API del DDEML, è necessario includere il file di intestazione DDEML nei file di origine, collegare con la libreria DDEML e verificare che la libreria a collegamento dinamico DDEML si trovi nel percorso di ricerca del sistema.</span><span class="sxs-lookup"><span data-stu-id="edeff-143">To use the API elements of the DDEML, you must include the DDEML header file in your source files, link with the DDEML library, and ensure that the DDEML dynamic-link library is in the system's search path.</span></span>

<span data-ttu-id="edeff-144">In questa sezione vengono descritti gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="edeff-144">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="edeff-145">Protocollo Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-145">Dynamic Data Exchange Protocol</span></span>](#dynamic-data-exchange-protocol)
-   [<span data-ttu-id="edeff-146">Usi per Windows Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-146">Uses for Windows Dynamic Data Exchange</span></span>](#uses-for-windows-dynamic-data-exchange)
-   [<span data-ttu-id="edeff-147">Dynamic Data Exchange dal punto di vista dell'utente</span><span class="sxs-lookup"><span data-stu-id="edeff-147">Dynamic Data Exchange from the User's Point of View</span></span>](#dynamic-data-exchange-from-the-users-point-of-view)
-   [<span data-ttu-id="edeff-148">Concetti di Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-148">Dynamic Data Exchange Concepts</span></span>](#dynamic-data-exchange-concepts)
    -   [<span data-ttu-id="edeff-149">Client, server e conversazione</span><span class="sxs-lookup"><span data-stu-id="edeff-149">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
    -   [<span data-ttu-id="edeff-150">Nomi di applicazione, argomento e elemento</span><span class="sxs-lookup"><span data-stu-id="edeff-150">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
    -   [<span data-ttu-id="edeff-151">Argomento di sistema</span><span class="sxs-lookup"><span data-stu-id="edeff-151">The System Topic</span></span>](#the-system-topic)
    -   [<span data-ttu-id="edeff-152">Collegamenti dati permanenti</span><span class="sxs-lookup"><span data-stu-id="edeff-152">Permanent Data Links</span></span>](#permanent-data-links)
    -   [<span data-ttu-id="edeff-153">Atomi e oggetti Shared Memory</span><span class="sxs-lookup"><span data-stu-id="edeff-153">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)
-   [<span data-ttu-id="edeff-154">Panoramica dei messaggi di Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-154">Dynamic Data Exchange Messages Overview</span></span>](#dynamic-data-exchange-messages-overview)
-   [<span data-ttu-id="edeff-155">Flusso di messaggi Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-155">Dynamic Data Exchange Message Flow</span></span>](#dynamic-data-exchange-message-flow)
-   [<span data-ttu-id="edeff-156">Funzioni di compressione di parametri</span><span class="sxs-lookup"><span data-stu-id="edeff-156">Parameter Packing Functions</span></span>](#parameter-packing-functions)
-   [<span data-ttu-id="edeff-157">Dynamic Data Exchange e rappresentazione</span><span class="sxs-lookup"><span data-stu-id="edeff-157">Dynamic Data Exchange and Impersonation</span></span>](#dynamic-data-exchange-and-impersonation)

## <a name="dynamic-data-exchange-protocol"></a><span data-ttu-id="edeff-158">Protocollo Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-158">Dynamic Data Exchange Protocol</span></span>

<span data-ttu-id="edeff-159">Poiché Windows dispone di un'architettura basata su messaggi, il passaggio dei messaggi è il metodo più appropriato per il trasferimento automatico delle informazioni tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-159">Because Windows has a message-based architecture, passing messages is the most appropriate method for automatically transferring information between applications.</span></span> <span data-ttu-id="edeff-160">Tuttavia, i messaggi contengono solo due parametri (*wParam* e *lParam*) per il passaggio di dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-160">However, messages contain only two parameters (*wParam* and *lParam*) for passing data.</span></span> <span data-ttu-id="edeff-161">Di conseguenza, questi parametri devono riferirsi indirettamente ad altre parti di dati quando più di poche parole di informazioni passano tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-161">As a result, these parameters must refer indirectly to other pieces of data when more than a few words of information pass between applications.</span></span> <span data-ttu-id="edeff-162">Il protocollo DDE definisce esattamente il modo in cui le applicazioni devono usare i parametri *wParam* e *lParam* per passare dati di grandi dimensioni per mezzo di atomi globali e handle di memoria condivisa.</span><span class="sxs-lookup"><span data-stu-id="edeff-162">The DDE protocol defines exactly how applications should use the *wParam* and *lParam* parameters to pass larger pieces of data by means of global atoms and shared memory handles.</span></span> <span data-ttu-id="edeff-163">Il protocollo DDE prevede regole specifiche per l'allocazione e l'eliminazione di atomi globali e oggetti di memoria condivisa.</span><span class="sxs-lookup"><span data-stu-id="edeff-163">The DDE protocol has specific rules for allocating and deleting global atoms and shared memory objects.</span></span>

<span data-ttu-id="edeff-164">Un Atom globale è un riferimento a una stringa di caratteri.</span><span class="sxs-lookup"><span data-stu-id="edeff-164">A global atom is a reference to a character string.</span></span> <span data-ttu-id="edeff-165">Nel protocollo DDE gli atomi identificano le applicazioni che scambiano dati, la natura dei dati scambiati e gli stessi elementi di dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-165">In the DDE protocol, atoms identify the applications exchanging data, the nature of the data being exchanged, and the data items themselves.</span></span> <span data-ttu-id="edeff-166">Per altre informazioni sugli atomi, vedere [informazioni sugli atomi](about-atom-tables.md).</span><span class="sxs-lookup"><span data-stu-id="edeff-166">For more information about atoms, see [About Atoms](about-atom-tables.md).</span></span>

## <a name="uses-for-windows-dynamic-data-exchange"></a><span data-ttu-id="edeff-167">Usi per Windows Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-167">Uses for Windows Dynamic Data Exchange</span></span>

<span data-ttu-id="edeff-168">Il DDE è più adatto per gli scambi di dati che non richiedono l'interazione dell'utente continua.</span><span class="sxs-lookup"><span data-stu-id="edeff-168">DDE is most appropriate for data exchanges that do not require ongoing user interaction.</span></span> <span data-ttu-id="edeff-169">In genere, un'applicazione fornisce un metodo per consentire all'utente di stabilire il collegamento tra le applicazioni che scambiano dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-169">Usually, an application provides a method for the user to establish the link between the applications exchanging data.</span></span> <span data-ttu-id="edeff-170">Una volta stabilito il collegamento, le applicazioni scambiano i dati senza ulteriore intervento dell'utente.</span><span class="sxs-lookup"><span data-stu-id="edeff-170">Once that link is established, however, the applications exchange data without further user involvement.</span></span>

<span data-ttu-id="edeff-171">È possibile utilizzare DDE per implementare un'ampia gamma di funzionalità dell'applicazione, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="edeff-171">DDE can be used to implement a broad range of application features — for example:</span></span>

-   <span data-ttu-id="edeff-172">Collegamento a dati in tempo reale, ad esempio aggiornamenti del mercato azionario, strumenti scientifici o controllo dei processi.</span><span class="sxs-lookup"><span data-stu-id="edeff-172">Linking to real-time data, such as to stock market updates, scientific instruments, or process control.</span></span>
-   <span data-ttu-id="edeff-173">Creazione di documenti composti, ad esempio un documento di elaborazione di testo che include un grafico prodotto da un'applicazione grafica.</span><span class="sxs-lookup"><span data-stu-id="edeff-173">Creating compound documents, such as a word processing document that includes a chart produced by a graphics application.</span></span> <span data-ttu-id="edeff-174">Utilizzando DDE, il grafico verrà modificato quando i dati di origine vengono modificati, mentre il resto del documento rimane lo stesso.</span><span class="sxs-lookup"><span data-stu-id="edeff-174">Using DDE, the chart will change when the source data is changed, while the rest of the document remains the same.</span></span>
-   <span data-ttu-id="edeff-175">Esecuzione di query sui dati tra applicazioni, ad esempio un foglio di calcolo che esegue query su un database per gli account precedenti.</span><span class="sxs-lookup"><span data-stu-id="edeff-175">Performing data queries between applications, such as a spreadsheet querying a database for accounts past due.</span></span>

## <a name="dynamic-data-exchange-from-the-users-point-of-view"></a><span data-ttu-id="edeff-176">Dynamic Data Exchange dal punto di vista dell'utente</span><span class="sxs-lookup"><span data-stu-id="edeff-176">Dynamic Data Exchange from the User's Point of View</span></span>

<span data-ttu-id="edeff-177">Nell'esempio seguente viene illustrato il modo in cui due applicazioni DDE possono collaborare, come illustrato dal punto di vista dell'utente.</span><span class="sxs-lookup"><span data-stu-id="edeff-177">The following example illustrates how two DDE applications can cooperate, as seen from the user's point of view.</span></span>

<span data-ttu-id="edeff-178">Un utente del foglio di calcolo desidera utilizzare Microsoft Excel per tenere traccia del prezzo di una determinata azione in borsa di New York.</span><span class="sxs-lookup"><span data-stu-id="edeff-178">A spreadsheet user wants to use Microsoft Excel to track the price of a particular stock on the New York Stock Exchange.</span></span> <span data-ttu-id="edeff-179">L'utente dispone di un'applicazione denominata virgolette che a sua volta ha accesso ai dati NYSE.</span><span class="sxs-lookup"><span data-stu-id="edeff-179">The user has an application called Quote that in turn has access to NYSE data.</span></span> <span data-ttu-id="edeff-180">La conversazione DDE tra Excel e le virgolette viene eseguita come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="edeff-180">The DDE conversation between Excel and Quote takes place as follows:</span></span>

-   <span data-ttu-id="edeff-181">L'utente avvia la conversazione fornendo il nome dell'applicazione (virgoletta) che fornirà i dati e il particolare argomento di interesse (NYSE).</span><span class="sxs-lookup"><span data-stu-id="edeff-181">The user initiates the conversation by supplying the name of the application (Quote) that will supply the data and the particular topic of interest (NYSE).</span></span> <span data-ttu-id="edeff-182">La conversazione DDE risultante viene utilizzata per richiedere virgolette in base a scorte specifiche.</span><span class="sxs-lookup"><span data-stu-id="edeff-182">The resulting DDE conversation is used to request quotes on specific stocks.</span></span>
-   <span data-ttu-id="edeff-183">Excel trasmette i nomi dell'applicazione e dell'argomento a tutte le applicazioni DDE attualmente in esecuzione nel sistema.</span><span class="sxs-lookup"><span data-stu-id="edeff-183">Excel broadcasts the application and topic names to all DDE applications currently running in the system.</span></span> <span data-ttu-id="edeff-184">Il preventivo risponde, che stabilisce una conversazione con Excel sull'argomento NYSE.</span><span class="sxs-lookup"><span data-stu-id="edeff-184">Quote responds, establishing a conversation with Excel about the NYSE topic.</span></span>
-   <span data-ttu-id="edeff-185">L'utente può quindi creare una formula del foglio di calcolo in una cella che richiede che il foglio di calcolo venga aggiornato automaticamente ogni volta che vengono apportate modifiche alle virgolette.</span><span class="sxs-lookup"><span data-stu-id="edeff-185">The user can then create a spreadsheet formula in a cell that requests that the spreadsheet be automatically updated whenever a particular stock quotation changes.</span></span> <span data-ttu-id="edeff-186">Ad esempio, l'utente potrebbe richiedere un aggiornamento automatico ogni volta che viene apportata una modifica al prezzo di vendita di ZAXX Stock specificando la formula di Excel seguente: =' quote ' \| ' NYSE '! ZAXX</span><span class="sxs-lookup"><span data-stu-id="edeff-186">For example, the user could request an automatic update whenever a change occurs in the selling price of ZAXX stock by specifying the following Excel formula: ='Quote'\|'NYSE'!ZAXX</span></span>
-   <span data-ttu-id="edeff-187">L'utente può terminare l'aggiornamento automatico delle quotazioni azionarie di ZAXX in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="edeff-187">The user can terminate the automatic updating of the ZAXX stock quotation at any time.</span></span> <span data-ttu-id="edeff-188">Altri collegamenti dati che sono stati stabiliti separatamente, ad esempio per le quote per altre scorte, rimarranno attivi nella stessa conversazione NYSE.</span><span class="sxs-lookup"><span data-stu-id="edeff-188">Other data links that were established separately (such as for quotations for other stocks) still will remain active under the same NYSE conversation.</span></span>
-   <span data-ttu-id="edeff-189">L'utente può anche terminare l'intera conversazione tra Excel e le virgolette nell'argomento NYSE, in modo che non sia possibile stabilire collegamenti dati specifici su tale argomento senza avviare una nuova conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-189">The user can also terminate the entire conversation between Excel and Quote on the NYSE topic, so that no specific data links on that topic can be established without initiating a new conversation.</span></span>

## <a name="dynamic-data-exchange-concepts"></a><span data-ttu-id="edeff-190">Concetti di Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-190">Dynamic Data Exchange Concepts</span></span>

<span data-ttu-id="edeff-191">Le sezioni seguenti illustrano i concetti e la terminologia principali per comprendere lo scambio di dati dinamici.</span><span class="sxs-lookup"><span data-stu-id="edeff-191">The following sections explain the important concepts and terminology that are key to understanding dynamic data exchange.</span></span>

-   [<span data-ttu-id="edeff-192">Client, server e conversazione</span><span class="sxs-lookup"><span data-stu-id="edeff-192">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
-   [<span data-ttu-id="edeff-193">Nomi di applicazione, argomento e elemento</span><span class="sxs-lookup"><span data-stu-id="edeff-193">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
-   [<span data-ttu-id="edeff-194">Argomento di sistema</span><span class="sxs-lookup"><span data-stu-id="edeff-194">The System Topic</span></span>](#the-system-topic)
-   [<span data-ttu-id="edeff-195">Collegamenti dati permanenti</span><span class="sxs-lookup"><span data-stu-id="edeff-195">Permanent Data Links</span></span>](#permanent-data-links)
-   [<span data-ttu-id="edeff-196">Atomi e oggetti Shared Memory</span><span class="sxs-lookup"><span data-stu-id="edeff-196">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)

### <a name="client-server-and-conversation"></a><span data-ttu-id="edeff-197">Client, server e conversazione</span><span class="sxs-lookup"><span data-stu-id="edeff-197">Client, Server, and Conversation</span></span>

<span data-ttu-id="edeff-198">Due applicazioni che partecipano a DDE sono definite in una conversazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-198">Two applications participating in DDE are said to be engaged in a DDE conversation.</span></span> <span data-ttu-id="edeff-199">L'applicazione che avvia la conversazione è l'applicazione client DDE. l'applicazione che risponde al client è l'applicazione server DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-199">The application that initiates the conversation is the DDE client application; the application that responds to the client is the DDE server application.</span></span> <span data-ttu-id="edeff-200">Un'applicazione può coinvolgere più conversazioni contemporaneamente, agendo come client in alcuni e come server in altri.</span><span class="sxs-lookup"><span data-stu-id="edeff-200">An application can engage in several conversations at the same time, acting as the client in some and as the server in others.</span></span>

<span data-ttu-id="edeff-201">Una conversazione DDE si verifica tra due finestre, una per ogni applicazione partecipante.</span><span class="sxs-lookup"><span data-stu-id="edeff-201">A DDE conversation takes place between two windows, one for each of the participating applications.</span></span> <span data-ttu-id="edeff-202">Una finestra può essere la finestra principale dell'applicazione. una finestra associata a un documento specifico, come in un'applicazione con interfaccia a documenti multipli (MDI); o una finestra nascosta (invisibile) il cui unico scopo è elaborare i messaggi DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-202">A window may be the main window of the application; a window associated with a specific document, as in a multiple-document interface (MDI) application; or a hidden (invisible) window whose only purpose is to process DDE messages.</span></span>

<span data-ttu-id="edeff-203">Poiché una conversazione DDE viene identificata dalla coppia di handle per le finestre coinvolte nella conversazione, nessuna finestra deve essere inserita in più di una conversazione con un'altra finestra.</span><span class="sxs-lookup"><span data-stu-id="edeff-203">Since a DDE conversation is identified by the pair of handles to the windows engaged in the conversation, no window should be engaged in more than one conversation with another window.</span></span> <span data-ttu-id="edeff-204">L'applicazione client o l'applicazione server deve fornire una finestra diversa per ognuna delle conversazioni con un server o un'applicazione client specifica.</span><span class="sxs-lookup"><span data-stu-id="edeff-204">Either the client application or the server application must provide a different window for each of its conversations with a particular server or client application.</span></span>

<span data-ttu-id="edeff-205">Un'applicazione può garantire che una coppia di Windows client e server non venga mai interessata in più di una conversazione creando una finestra nascosta per ogni conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-205">An application can ensure a pair of client and server windows is never involved in more than one conversation by creating a hidden window for each conversation.</span></span> <span data-ttu-id="edeff-206">L'unico scopo di questa finestra è elaborare i messaggi DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-206">The sole purpose of this window is to process DDE messages.</span></span>

### <a name="application-topic-and-item-names"></a><span data-ttu-id="edeff-207">Nomi di applicazione, argomento e elemento</span><span class="sxs-lookup"><span data-stu-id="edeff-207">Application, Topic, and Item Names</span></span>

<span data-ttu-id="edeff-208">Il protocollo DDE identifica le unità di dati passate tra il client e il server con una gerarchia a tre livelli dei nomi di applicazione, argomento e elemento.</span><span class="sxs-lookup"><span data-stu-id="edeff-208">The DDE protocol identifies the units of data passed between the client and server with a three-level hierarchy of application, topic, and item names.</span></span>

<span data-ttu-id="edeff-209">Ogni conversazione DDE viene definita in modo univoco dal nome dell'applicazione e dall'argomento.</span><span class="sxs-lookup"><span data-stu-id="edeff-209">Each DDE conversation is uniquely defined by the application name and topic.</span></span> <span data-ttu-id="edeff-210">All'inizio di una conversazione DDE, il client e il server determinano il nome dell'applicazione e l'argomento.</span><span class="sxs-lookup"><span data-stu-id="edeff-210">At the beginning of a DDE conversation, the client and server determine the application name and topic.</span></span> <span data-ttu-id="edeff-211">Il nome dell'applicazione è in genere il nome dell'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="edeff-211">The application name is usually the name of the server application.</span></span> <span data-ttu-id="edeff-212">Ad esempio, quando Excel funge da server in una conversazione, il nome dell'applicazione è Excel.</span><span class="sxs-lookup"><span data-stu-id="edeff-212">For example, when Excel acts as the server in a conversation, the application name is Excel.</span></span>

<span data-ttu-id="edeff-213">L'argomento DDE è una classificazione generale dei dati in cui è possibile che vengano discussi più elementi di dati (scambiati) durante la conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-213">The DDE topic is a general classification of data within which multiple data items may be "discussed" (exchanged) during the conversation.</span></span> <span data-ttu-id="edeff-214">Per le applicazioni che operano su documenti basati su file, l'argomento è in genere un nome di file.</span><span class="sxs-lookup"><span data-stu-id="edeff-214">For applications that operate on file-based documents, the topic is usually a filename.</span></span> <span data-ttu-id="edeff-215">Per altre applicazioni, l'argomento è un nome specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-215">For other applications, the topic is an application-specific name.</span></span>

<span data-ttu-id="edeff-216">Poiché la finestra client e server gestisce insieme l'identificazione di una conversazione DDE, il nome dell'applicazione e l'argomento che definiscono una conversazione non possono essere modificati nel corso della conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-216">Because the client and server window handles together identify a DDE conversation, the application name and topic that define a conversation cannot be changed during the course of the conversation.</span></span>

<span data-ttu-id="edeff-217">Un elemento di dati DDE è informazioni correlate all'argomento di conversazione scambiato tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-217">A DDE data item is information related to the conversation topic exchanged between the applications.</span></span> <span data-ttu-id="edeff-218">I valori per l'elemento di dati possono essere passati dal server al client o dal client al server.</span><span class="sxs-lookup"><span data-stu-id="edeff-218">Values for the data item can be passed from the server to the client, or from the client to the server.</span></span> <span data-ttu-id="edeff-219">I dati possono essere passati con uno dei formati degli Appunti standard o con un formato degli Appunti registrato.</span><span class="sxs-lookup"><span data-stu-id="edeff-219">Data can be passed with any of the standard clipboard formats or with a registered clipboard format.</span></span> <span data-ttu-id="edeff-220">Un formato speciale registrato denominato link identifica un elemento in una conversazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-220">A special, registered format named Link identifies an item in a DDE conversation.</span></span> <span data-ttu-id="edeff-221">Per ulteriori informazioni sui formati degli Appunti, vedere [Appunti](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="edeff-221">For more information about clipboard formats, see [Clipboard](clipboard.md).</span></span>

### <a name="the-system-topic"></a><span data-ttu-id="edeff-222">Argomento di sistema</span><span class="sxs-lookup"><span data-stu-id="edeff-222">The System Topic</span></span>

<span data-ttu-id="edeff-223">Le applicazioni devono supportare l'argomento di sistema in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="edeff-223">Applications should support the system topic at all times.</span></span> <span data-ttu-id="edeff-224">In questo argomento viene fornito un contesto per informazioni che possono essere di interesse generale per un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-224">This topic provides a context for information that may be of general interest to another application.</span></span>

<span data-ttu-id="edeff-225">È necessario eseguire il rendering dei valori degli elementi di dati nel formato degli Appunti di [**\_ testo CF**](standard-clipboard-formats.md) .</span><span class="sxs-lookup"><span data-stu-id="edeff-225">Data-item values must be rendered in the [**CF\_TEXT**](standard-clipboard-formats.md) clipboard format.</span></span> <span data-ttu-id="edeff-226">I singoli elementi dei valori degli elementi per un argomento di sistema devono essere delimitati da caratteri di tabulazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-226">Individual elements of item values for a system topic must be delimited by tab characters.</span></span> <span data-ttu-id="edeff-227">La tabella seguente suggerisce alcuni elementi per l'argomento di sistema.</span><span class="sxs-lookup"><span data-stu-id="edeff-227">The following table suggests some items for the system topic.</span></span>



| <span data-ttu-id="edeff-228">Elemento</span><span class="sxs-lookup"><span data-stu-id="edeff-228">Item</span></span>          | <span data-ttu-id="edeff-229">Descrizione</span><span class="sxs-lookup"><span data-stu-id="edeff-229">Description</span></span>                                                                                                                                                                                                                                                                                             |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="edeff-230">Formati</span><span class="sxs-lookup"><span data-stu-id="edeff-230">Formats</span></span>       | <span data-ttu-id="edeff-231">Elenco delimitato da tabulazioni di formati degli Appunti di cui l'applicazione può eseguire il rendering.</span><span class="sxs-lookup"><span data-stu-id="edeff-231">Tab-delimited list of clipboard formats the application can render.</span></span> <span data-ttu-id="edeff-232">In genere, i formati **CF \_** sono elencati con la parte "**CF \_**" dei nomi rimossi (ad esempio, il **\_ testo CF** viene elencato come "**testo**").</span><span class="sxs-lookup"><span data-stu-id="edeff-232">Typically, **CF\_** formats are listed with the "**CF\_**" portion of the names removed (for example, **CF\_TEXT** is listed as "**TEXT**").</span></span>                                                                                        |
| <span data-ttu-id="edeff-233">Help</span><span class="sxs-lookup"><span data-stu-id="edeff-233">Help</span></span>          | <span data-ttu-id="edeff-234">Testo che spiega brevemente come utilizzare il server DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-234">Text that briefly explains how to use the DDE server.</span></span>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="edeff-235">ReturnMessage</span><span class="sxs-lookup"><span data-stu-id="edeff-235">ReturnMessage</span></span> | <span data-ttu-id="edeff-236">Dettagli di supporto per il messaggio [**\_ \_ ACK DDE WM**](wm-dde-ack.md) usato più di recente.</span><span class="sxs-lookup"><span data-stu-id="edeff-236">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="edeff-237">Questo elemento è utile quando sono necessari più di otto bit di dati restituiti specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-237">This item is useful when more than eight bits of application-specific return data are required.</span></span>                                                                                                                |
| <span data-ttu-id="edeff-238">Stato</span><span class="sxs-lookup"><span data-stu-id="edeff-238">Status</span></span>        | <span data-ttu-id="edeff-239">Indica lo stato corrente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-239">Indication of the current status of the application.</span></span> <span data-ttu-id="edeff-240">Quando un server riceve un messaggio di [**\_ \_ richiesta DDE di WM**](wm-dde-request.md) per questo elemento dell'argomento di sistema, deve rispondere inserendo un messaggio di [**\_ \_ dati DDE WM**](wm-dde-data.md) con una stringa che contiene occupato o pronto, a seconda dei casi.</span><span class="sxs-lookup"><span data-stu-id="edeff-240">When a server receives a [**WM\_DDE\_REQUEST**](wm-dde-request.md) message for this system-topic item, it should respond by posting a [**WM\_DDE\_DATA**](wm-dde-data.md) message with a string containing either Busy or Ready, as appropriate.</span></span> |
| <span data-ttu-id="edeff-241">SysItems</span><span class="sxs-lookup"><span data-stu-id="edeff-241">SysItems</span></span>      | <span data-ttu-id="edeff-242">Elenco di elementi dell'argomento di sistema supportati dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-242">List of system-topic items the application supports.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="edeff-243">TopicItemList</span><span class="sxs-lookup"><span data-stu-id="edeff-243">TopicItemList</span></span> | <span data-ttu-id="edeff-244">Simile all'elemento SysItems, ad eccezione del fatto che TopicItemList deve essere supportato per ogni argomento diverso dall'argomento di sistema.</span><span class="sxs-lookup"><span data-stu-id="edeff-244">Similar to the SysItems item, except that TopicItemList should be supported for each topic other than the system topic.</span></span> <span data-ttu-id="edeff-245">In questo modo è possibile esplorare gli elementi supportati in qualsiasi argomento.</span><span class="sxs-lookup"><span data-stu-id="edeff-245">This allows browsing of the items supported under any topic.</span></span> <span data-ttu-id="edeff-246">Se non è possibile enumerare gli elementi, l'elemento deve contenere solo "TopicItemList".</span><span class="sxs-lookup"><span data-stu-id="edeff-246">If the items cannot be enumerated, this item should contain only "TopicItemList".</span></span>                                  |
| <span data-ttu-id="edeff-247">Argomenti</span><span class="sxs-lookup"><span data-stu-id="edeff-247">Topics</span></span>        | <span data-ttu-id="edeff-248">Elenco di argomenti supportati dall'applicazione nell'ora corrente; Questo elenco può variare a seconda del momento.</span><span class="sxs-lookup"><span data-stu-id="edeff-248">List of topics the application supports at the current time; this list can vary from moment to moment.</span></span>                                                                                                                                                                                                  |



 

### <a name="permanent-data-links"></a><span data-ttu-id="edeff-249">Collegamenti dati permanenti</span><span class="sxs-lookup"><span data-stu-id="edeff-249">Permanent Data Links</span></span>

<span data-ttu-id="edeff-250">Una volta iniziata una conversazione DDE, il client può stabilire uno o più collegamenti di dati permanenti con il server.</span><span class="sxs-lookup"><span data-stu-id="edeff-250">Once a DDE conversation has begun, the client can establish one or more permanent data links with the server.</span></span> <span data-ttu-id="edeff-251">Un collegamento dati è un meccanismo di comunicazione mediante il quale il server invia una notifica al client ogni volta che viene modificato il valore di un elemento di dati specificato.</span><span class="sxs-lookup"><span data-stu-id="edeff-251">A data link is a communications mechanism by which the server notifies the client whenever the value of a specified data item changes.</span></span> <span data-ttu-id="edeff-252">Il collegamento dati è permanente nel senso che questo processo di notifica continua fino a quando non viene terminato il collegamento dati o la conversazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-252">The data link is permanent in the sense that this notification process continues until the data link or the DDE conversation itself is terminated.</span></span>

<span data-ttu-id="edeff-253">Sono disponibili due tipi di collegamenti permanenti ai dati DDE: caldo e frequente.</span><span class="sxs-lookup"><span data-stu-id="edeff-253">There are two kinds of permanent DDE data links: warm and hot.</span></span> <span data-ttu-id="edeff-254">In un collegamento dati caldo, il server notifica al client che il valore dell'elemento di dati è stato modificato, ma il server non invia il valore dei dati al client fino a quando non viene richiesto dal client.</span><span class="sxs-lookup"><span data-stu-id="edeff-254">In a warm data link, the server notifies the client that the value of the data item has changed, but the server does not send the data value to the client until the client requests it.</span></span> <span data-ttu-id="edeff-255">In un collegamento dati attivo, il server invia immediatamente il valore dei dati modificati al client.</span><span class="sxs-lookup"><span data-stu-id="edeff-255">In a hot data link, the server immediately sends the changed data value to the client.</span></span>

<span data-ttu-id="edeff-256">Le applicazioni che supportano collegamenti dati caldi o a caldo forniscono in genere un comando **copia** o **Incolla collegamento** nel menu **modifica** per consentire all'utente di stabilire collegamenti tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="edeff-256">Applications that support warm or hot data links typically provide a **Copy** or **Paste Link** command in their **Edit** menu to enable the user to establish links between applications.</span></span>

### <a name="atoms-and-shared-memory-objects"></a><span data-ttu-id="edeff-257">Atomi e oggetti Shared Memory</span><span class="sxs-lookup"><span data-stu-id="edeff-257">Atoms and Shared Memory Objects</span></span>

<span data-ttu-id="edeff-258">Alcuni argomenti dei messaggi DDE sono atomi globali o oggetti Shared Memory.</span><span class="sxs-lookup"><span data-stu-id="edeff-258">Certain arguments of DDE messages are global atoms or shared memory objects.</span></span> <span data-ttu-id="edeff-259">Le applicazioni che usano questi argomenti devono seguire regole esplicite su quando allocarle ed eliminarle.</span><span class="sxs-lookup"><span data-stu-id="edeff-259">Applications using these arguments must follow explicit rules about when to allocate and delete them.</span></span> <span data-ttu-id="edeff-260">In tutti i casi, il mittente del messaggio deve eliminare tutti gli oggetti Atom o Shared Memory che non vengono ricevuti dal ricevitore previsto a causa di una condizione di errore, ad esempio un errore della funzione [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) .</span><span class="sxs-lookup"><span data-stu-id="edeff-260">In all cases, the message sender must delete any atom or shared memory object that the intended receiver will not receive because of an error condition, such as failure of the [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) function.</span></span>

<span data-ttu-id="edeff-261">Il DDE utilizza gli oggetti Shared Memory per tre scopi:</span><span class="sxs-lookup"><span data-stu-id="edeff-261">DDE uses shared memory objects for three purposes:</span></span>

-   <span data-ttu-id="edeff-262">Per portare un valore dell'elemento di dati da scambiare.</span><span class="sxs-lookup"><span data-stu-id="edeff-262">To carry a data-item value to be exchanged.</span></span> <span data-ttu-id="edeff-263">Si tratta di un elemento a cui fa  riferimento il parametro hData [**nei \_ \_ dati DDE di WM**](wm-dde-data.md) e nei messaggi [**\_ \_ poke DDE di WM**](wm-dde-poke.md) .</span><span class="sxs-lookup"><span data-stu-id="edeff-263">This is an item referenced by the *hData* parameter in the [**WM\_DDE\_DATA**](wm-dde-data.md) and [**WM\_DDE\_POKE**](wm-dde-poke.md) messages.</span></span>
-   <span data-ttu-id="edeff-264">Per includere le opzioni in un messaggio.</span><span class="sxs-lookup"><span data-stu-id="edeff-264">To carry options in a message.</span></span> <span data-ttu-id="edeff-265">Si tratta di un elemento a cui fa riferimento il parametro *hOptions* in un messaggio di [**\_ \_ avviso DDE di WM**](wm-dde-advise.md) .</span><span class="sxs-lookup"><span data-stu-id="edeff-265">This is an item referenced by the *hOptions* parameter in a [**WM\_DDE\_ADVISE**](wm-dde-advise.md) message.</span></span>
-   <span data-ttu-id="edeff-266">Per includere una stringa di esecuzione del comando.</span><span class="sxs-lookup"><span data-stu-id="edeff-266">To carry a command execution string.</span></span> <span data-ttu-id="edeff-267">Si tratta di un elemento a cui fa riferimento il parametro *hCommands* nel messaggio [**\_ \_ Execute DDE di WM**](wm-dde-execute.md) e il corrispondente messaggio [**\_ \_ ACK DDE**](wm-dde-ack.md) .</span><span class="sxs-lookup"><span data-stu-id="edeff-267">This is an item referenced by the *hCommands* parameter in the [**WM\_DDE\_EXECUTE**](wm-dde-execute.md) message and its corresponding [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span>

<span data-ttu-id="edeff-268">Un'applicazione che riceve un oggetto memoria condivisa DDE deve considerarla di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="edeff-268">An application that receives a DDE shared memory object must treat it as read only.</span></span> <span data-ttu-id="edeff-269">L'applicazione non deve usare l'oggetto come area di lettura/scrittura reciproca per lo scambio di dati libero.</span><span class="sxs-lookup"><span data-stu-id="edeff-269">The application must not use the object as a mutual read-write area for the free exchange of data.</span></span>

<span data-ttu-id="edeff-270">Come avviene con un Atom DDE, un'applicazione deve liberare un oggetto Shared Memory per gestire la memoria in modo efficace.</span><span class="sxs-lookup"><span data-stu-id="edeff-270">As it does with a DDE atom, an application should free a shared memory object to manage memory effectively.</span></span> <span data-ttu-id="edeff-271">L'applicazione deve inoltre bloccare e sbloccare gli oggetti di memoria.</span><span class="sxs-lookup"><span data-stu-id="edeff-271">The application should also lock and unlock memory objects.</span></span>

## <a name="dynamic-data-exchange-messages-overview"></a><span data-ttu-id="edeff-272">Panoramica dei messaggi di Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-272">Dynamic Data Exchange Messages Overview</span></span>

<span data-ttu-id="edeff-273">Poiché DDE è un protocollo basato su messaggi, non utilizza funzioni o librerie.</span><span class="sxs-lookup"><span data-stu-id="edeff-273">Because DDE is a message-based protocol, it employs no functions or libraries.</span></span> <span data-ttu-id="edeff-274">Tutte le transazioni DDE vengono eseguite passando determinati messaggi DDE definiti tra le finestre client e server.</span><span class="sxs-lookup"><span data-stu-id="edeff-274">All DDE transactions are conducted by passing certain defined DDE messages between the client and server windows.</span></span>

<span data-ttu-id="edeff-275">Sono presenti nove messaggi DDE. le costanti simboliche per questi messaggi sono definite nel file di intestazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-275">There are nine DDE messages; the symbolic constants for these messages are defined in the DDE header file.</span></span> <span data-ttu-id="edeff-276">In questo file di intestazione sono definite anche alcune strutture per i vari messaggi DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-276">Certain structures for the various DDE messages are also defined in this header file.</span></span>

<span data-ttu-id="edeff-277">Nella tabella seguente vengono riepilogati i messaggi DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-277">The following table summarizes the DDE messages.</span></span>



| <span data-ttu-id="edeff-278">Message</span><span class="sxs-lookup"><span data-stu-id="edeff-278">Message</span></span>                                        | <span data-ttu-id="edeff-279">Descrizione</span><span class="sxs-lookup"><span data-stu-id="edeff-279">Description</span></span>                                                                                                                                      |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="edeff-280">**\_ACK DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="edeff-280">**WM\_DDE\_ACK**</span></span>](wm-dde-ack.md)             | <span data-ttu-id="edeff-281">Conferma la ricezione o la mancata ricezione di un messaggio.</span><span class="sxs-lookup"><span data-stu-id="edeff-281">Acknowledges receiving or not receiving a message.</span></span>                                                                                               |
| [<span data-ttu-id="edeff-282">**\_avviso DDE di WM \_**</span><span class="sxs-lookup"><span data-stu-id="edeff-282">**WM\_DDE\_ADVISE**</span></span>](wm-dde-advise.md)       | <span data-ttu-id="edeff-283">Richiede all'applicazione server di fornire un aggiornamento o una notifica per un elemento di dati ogni volta che viene modificato.</span><span class="sxs-lookup"><span data-stu-id="edeff-283">Requests the server application to supply an update or notification for a data item whenever it changes.</span></span> <span data-ttu-id="edeff-284">Viene stabilito un collegamento dati permanente.</span><span class="sxs-lookup"><span data-stu-id="edeff-284">This establishes a permanent data link.</span></span> |
| [<span data-ttu-id="edeff-285">**\_dati DDE di WM \_**</span><span class="sxs-lookup"><span data-stu-id="edeff-285">**WM\_DDE\_DATA**</span></span>](wm-dde-data.md)           | <span data-ttu-id="edeff-286">Invia un valore dell'elemento di dati all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="edeff-286">Sends a data-item value to the client application.</span></span>                                                                                               |
| [<span data-ttu-id="edeff-287">**esecuzione di WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="edeff-287">**WM\_DDE\_EXECUTE**</span></span>](wm-dde-execute.md)     | <span data-ttu-id="edeff-288">Invia una stringa all'applicazione server, che dovrebbe elaborare la stringa come una serie di comandi.</span><span class="sxs-lookup"><span data-stu-id="edeff-288">Sends a string to the server application, which is expected to process the string as a series of commands.</span></span>                                       |
| [<span data-ttu-id="edeff-289">**\_avvio DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="edeff-289">**WM\_DDE\_INITIATE**</span></span>](wm-dde-initiate.md)   | <span data-ttu-id="edeff-290">Avvia una conversazione tra le applicazioni client e server.</span><span class="sxs-lookup"><span data-stu-id="edeff-290">Initiates a conversation between the client and server applications.</span></span>                                                                             |
| [<span data-ttu-id="edeff-291">**\_poke DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="edeff-291">**WM\_DDE\_POKE**</span></span>](wm-dde-poke.md)           | <span data-ttu-id="edeff-292">Invia un valore dell'elemento di dati all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="edeff-292">Sends a data-item value to the server application.</span></span>                                                                                               |
| [<span data-ttu-id="edeff-293">**\_richiesta DDE \_ WM**</span><span class="sxs-lookup"><span data-stu-id="edeff-293">**WM\_DDE\_REQUEST**</span></span>](wm-dde-request.md)     | <span data-ttu-id="edeff-294">Richiede all'applicazione server di fornire il valore di un elemento di dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-294">Requests the server application to provide the value of a data item.</span></span>                                                                             |
| [<span data-ttu-id="edeff-295">**\_ \_ terminazione DDE WM**</span><span class="sxs-lookup"><span data-stu-id="edeff-295">**WM\_DDE\_TERMINATE**</span></span>](wm-dde-terminate.md) | <span data-ttu-id="edeff-296">Termina una conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-296">Terminates a conversation.</span></span>                                                                                                                       |
| [<span data-ttu-id="edeff-297">**\_Unadvise DDE WM \_**</span><span class="sxs-lookup"><span data-stu-id="edeff-297">**WM\_DDE\_UNADVISE**</span></span>](wm-dde-unadvise.md)   | <span data-ttu-id="edeff-298">Termina un collegamento dati permanente.</span><span class="sxs-lookup"><span data-stu-id="edeff-298">Terminates a permanent data link.</span></span>                                                                                                                |



 

<span data-ttu-id="edeff-299">Un'applicazione chiama [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) per emettere il messaggio di [**\_ \_ avvio DDE di WM**](wm-dde-initiate.md) o un messaggio [**\_ \_ ACK DDE WM**](wm-dde-ack.md) inviato in risposta **all' \_ \_ avvio di WM DDE**.</span><span class="sxs-lookup"><span data-stu-id="edeff-299">An application calls [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) to issue the [**WM\_DDE\_INITIATE**](wm-dde-initiate.md) message or a [**WM\_DDE\_ACK**](wm-dde-ack.md) message sent in response to **WM\_DDE\_INITIATE**.</span></span> <span data-ttu-id="edeff-300">Tutti gli altri messaggi vengono inviati da [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span><span class="sxs-lookup"><span data-stu-id="edeff-300">All other messages are sent by [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span></span> <span data-ttu-id="edeff-301">Il primo parametro di queste chiamate è un handle per la finestra di ricezione. il secondo parametro contiene il messaggio da inviare. il terzo parametro identifica la finestra di invio; il quarto parametro contiene quindi gli argomenti specifici del messaggio.</span><span class="sxs-lookup"><span data-stu-id="edeff-301">The first parameter of these calls is a handle to the receiving window; the second parameter contains the message to be sent; the third parameter identifies the sending window; and the fourth parameter contains the message-specific arguments.</span></span>

## <a name="dynamic-data-exchange-message-flow"></a><span data-ttu-id="edeff-302">Flusso di messaggi Dynamic Data Exchange</span><span class="sxs-lookup"><span data-stu-id="edeff-302">Dynamic Data Exchange Message Flow</span></span>

<span data-ttu-id="edeff-303">Una tipica conversazione DDE è costituita dagli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="edeff-303">A typical DDE conversation consists of the following events:</span></span>

1.  <span data-ttu-id="edeff-304">L'applicazione client avvia la conversazione e l'applicazione server risponde.</span><span class="sxs-lookup"><span data-stu-id="edeff-304">The client application initiates the conversation, and the server application responds.</span></span>
2.  <span data-ttu-id="edeff-305">Le applicazioni scambiano i dati in base a uno o tutti i metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="edeff-305">The applications exchange data by any or all of the following methods:</span></span>
    -   -   <span data-ttu-id="edeff-306">L'applicazione server invia i dati al client in corrispondenza della richiesta del client.</span><span class="sxs-lookup"><span data-stu-id="edeff-306">The server application sends data to the client at the client's request.</span></span>
        -   <span data-ttu-id="edeff-307">L'applicazione client invia dati non richiesti all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="edeff-307">The client application sends unsolicited data to the server application.</span></span>
        -   <span data-ttu-id="edeff-308">L'applicazione client richiede all'applicazione server di notificare al client ogni volta che un elemento di dati viene modificato (collegamento dati caldo).</span><span class="sxs-lookup"><span data-stu-id="edeff-308">The client application requests the server application to notify the client whenever a data item changes (warm data link).</span></span>
        -   <span data-ttu-id="edeff-309">L'applicazione client richiede che l'applicazione server invii i dati ogni volta che i dati cambiano (collegamento a dati sensibili).</span><span class="sxs-lookup"><span data-stu-id="edeff-309">The client application requests the server application to send data whenever the data changes (hot data link).</span></span>
        -   <span data-ttu-id="edeff-310">L'applicazione server esegue un comando in corrispondenza della richiesta del client.</span><span class="sxs-lookup"><span data-stu-id="edeff-310">The server application carries out a command at the client's request.</span></span>

3.  <span data-ttu-id="edeff-311">Il client o l'applicazione server termina la conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-311">Either the client or server application terminates the conversation.</span></span>

<span data-ttu-id="edeff-312">Una finestra dell'applicazione che elabora le richieste da un client o da un server deve elaborarle rigorosamente nell'ordine in cui vengono ricevute.</span><span class="sxs-lookup"><span data-stu-id="edeff-312">An application window that processes requests from a client or server must process them strictly in the order they are received.</span></span>

<span data-ttu-id="edeff-313">Un client può stabilire conversazioni con più di un server. un server può avere conversazioni con più di un client.</span><span class="sxs-lookup"><span data-stu-id="edeff-313">A client can establish conversations with more than one server; a server can have conversations with more than one client.</span></span> <span data-ttu-id="edeff-314">Quando si gestiscono messaggi da più origini, un client o un server deve elaborare i messaggi di una conversazione in modo sincrono, ma non è necessario elaborare tutti i messaggi in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="edeff-314">When handling messages from more than one source, a client or server must process the messages of a conversation synchronously, but need not process all messages synchronously.</span></span> <span data-ttu-id="edeff-315">In altre parole, è possibile passare da una conversazione all'altra in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="edeff-315">In other words, it can shift from one conversation to another as needed.</span></span>

<span data-ttu-id="edeff-316">Se un'applicazione non è in grado di elaborare una richiesta in ingresso perché è in attesa di una risposta DDE, deve impedire il deadlock inviando un messaggio di [**\_ \_ ACK DDE WM**](wm-dde-ack.md) con il membro **fBusy** della struttura [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) impostata su 1.</span><span class="sxs-lookup"><span data-stu-id="edeff-316">If an application is unable to process an incoming request because it is waiting for a DDE response, it must prevent deadlock by posting a [**WM\_DDE\_ACK**](wm-dde-ack.md) message with the **fBusy** member of the [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) structure set to 1.</span></span> <span data-ttu-id="edeff-317">Un'applicazione può anche inviare un messaggio **di \_ \_ ACK DDE WM** occupato se, per qualsiasi motivo, non è in grado di elaborare una richiesta in ingresso entro un periodo di tempo ragionevole.</span><span class="sxs-lookup"><span data-stu-id="edeff-317">An application can also send a busy **WM\_DDE\_ACK** message if, for any reason, it cannot process an incoming request within a reasonable amount of time.</span></span>

<span data-ttu-id="edeff-318">Un'applicazione deve essere in grado di gestire l'errore di un client o di un server per rispondere a un messaggio entro un determinato periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="edeff-318">An application should be able to handle the failure of a client or server to respond to a message within a certain time.</span></span> <span data-ttu-id="edeff-319">Poiché l'intervallo di timeout può variare a seconda della natura dell'applicazione e della configurazione del sistema dell'utente (ad esempio se è connessa a una rete), l'applicazione deve fornire un modo per specificare l'intervallo per l'utente.</span><span class="sxs-lookup"><span data-stu-id="edeff-319">Since the time-out interval may vary depending on the nature of the application and the configuration of the user's system (including whether it is connected to a network), the application should provide a way for the user to specify the interval.</span></span>

## <a name="parameter-packing-functions"></a><span data-ttu-id="edeff-320">Funzioni di compressione di parametri</span><span class="sxs-lookup"><span data-stu-id="edeff-320">Parameter Packing Functions</span></span>

<span data-ttu-id="edeff-321">Il parametro *lParam* di molti messaggi DDE contiene due tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="edeff-321">The *lParam* parameter of many DDE messages contains two pieces of data.</span></span> <span data-ttu-id="edeff-322">Il valore *lParam* del messaggio di [**\_ \_ dati DDE WM**](wm-dde-data.md) , ad esempio, contiene un handle di dati e un Atom.</span><span class="sxs-lookup"><span data-stu-id="edeff-322">For example, the *lParam* of the [**WM\_DDE\_DATA**](wm-dde-data.md) message contains a data handle and an atom.</span></span> <span data-ttu-id="edeff-323">Le applicazioni devono utilizzare la funzione [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) per comprimere l'handle e il formato Atom in un parametro *lParam* e la funzione [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) per rimuovere i valori.</span><span class="sxs-lookup"><span data-stu-id="edeff-323">Applications must use the [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) function to pack the handle and atom into an *lParam* parameter, and the [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) function to remove the values.</span></span> <span data-ttu-id="edeff-324">Le applicazioni DDE devono usare **PackDDElParam** e **UnpackDDElParam** per tutti i messaggi inviati durante una conversazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-324">DDE applications must use **PackDDElParam** and **UnpackDDElParam** for all messages posted during a DDE conversation.</span></span>

<span data-ttu-id="edeff-325">Le applicazioni possono inoltre utilizzare le funzioni [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) e [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) .</span><span class="sxs-lookup"><span data-stu-id="edeff-325">Applications can also use the [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) and [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) functions.</span></span> <span data-ttu-id="edeff-326">**ReuseDDElParam** consente a un'applicazione DDE di riutilizzare un parametro *lParam* compresso, contribuendo a ridurre il numero di riallocazioni di memoria che l'applicazione deve eseguire durante una conversazione.</span><span class="sxs-lookup"><span data-stu-id="edeff-326">**ReuseDDElParam** allows a DDE application to reuse a packed *lParam* parameter, helping reduce the number of memory reallocations the application must perform during a conversation.</span></span> <span data-ttu-id="edeff-327">Un'applicazione può utilizzare **FreeDDElParam** per liberare la memoria associata a un handle di dati ricevuto durante una conversazione DDE.</span><span class="sxs-lookup"><span data-stu-id="edeff-327">An application can use **FreeDDElParam** to free the memory associated with a data handle received during a DDE conversation.</span></span>

## <a name="dynamic-data-exchange-and-impersonation"></a><span data-ttu-id="edeff-328">Dynamic Data Exchange e rappresentazione</span><span class="sxs-lookup"><span data-stu-id="edeff-328">Dynamic Data Exchange and Impersonation</span></span>

<span data-ttu-id="edeff-329">Per consentire a un server di rappresentare un client, il client chiama la funzione [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) .</span><span class="sxs-lookup"><span data-stu-id="edeff-329">To allow a server to impersonate a client, the client calls the [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) function.</span></span> <span data-ttu-id="edeff-330">La struttura del [**\_ \_ livello di rappresentazione di sicurezza**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) viene utilizzata per controllare il livello di rappresentazione che il server può eseguire.</span><span class="sxs-lookup"><span data-stu-id="edeff-330">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) structure is used to control the level of impersonation the server may perform.</span></span>

<span data-ttu-id="edeff-331">Un server DDE può rappresentare un client DDE chiamando la funzione [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) .</span><span class="sxs-lookup"><span data-stu-id="edeff-331">A DDE server can impersonate a DDE client by calling the [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) function.</span></span> <span data-ttu-id="edeff-332">Un server DDEML deve usare la funzione [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) .</span><span class="sxs-lookup"><span data-stu-id="edeff-332">A DDEML server should use the [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) function.</span></span>

 

 