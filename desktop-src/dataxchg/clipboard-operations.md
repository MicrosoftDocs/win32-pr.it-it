---
title: Operazioni degli Appunti
description: Una finestra deve usare gli Appunti per tagliare, copiare o incollare i dati. Una finestra inserisce i dati negli Appunti per le operazioni Taglia e copia e recupera i dati dagli Appunti per le operazioni Incolla.
ms.assetid: 27f9142c-3154-4de5-aea6-3c53f7e940ec
keywords:
- Interfaccia utente di Windows, appunti
- Appunti, Windows
- Appunti, taglio di dati
- Appunti, copia di dati
- Appunti, incolla di dati
- Appunti, finestra proprietaria
- Appunti, rendering ritardato
- Appunti, memoria
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5cb2c3451cf562b35b976e137a974e19892acbb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338911"
---
# <a name="clipboard-operations"></a><span data-ttu-id="dae52-112">Operazioni degli Appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-112">Clipboard Operations</span></span>

<span data-ttu-id="dae52-113">Una finestra deve usare gli Appunti per tagliare, copiare o incollare i dati.</span><span class="sxs-lookup"><span data-stu-id="dae52-113">A window should use the clipboard when cutting, copying, or pasting data.</span></span> <span data-ttu-id="dae52-114">Una finestra inserisce i dati negli Appunti per le operazioni Taglia e copia e recupera i dati dagli Appunti per le operazioni Incolla.</span><span class="sxs-lookup"><span data-stu-id="dae52-114">A window places data on the clipboard for cut and copy operations and retrieves data from the clipboard for paste operations.</span></span> <span data-ttu-id="dae52-115">Le sezioni seguenti descrivono le operazioni e i problemi correlati.</span><span class="sxs-lookup"><span data-stu-id="dae52-115">The following sections describe these operations and related issues.</span></span>

<span data-ttu-id="dae52-116">Per inserire dati o recuperare dati dagli Appunti, una finestra deve prima aprire gli Appunti utilizzando la funzione [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dae52-116">To place data on or retrieve data from the clipboard, a window must first open the clipboard by using the [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) function.</span></span> <span data-ttu-id="dae52-117">Gli Appunti possono essere aperti in una sola finestra alla volta.</span><span class="sxs-lookup"><span data-stu-id="dae52-117">Only one window can have the clipboard open at a time.</span></span> <span data-ttu-id="dae52-118">Per individuare la finestra con gli Appunti aperti, chiamare la funzione [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) .</span><span class="sxs-lookup"><span data-stu-id="dae52-118">To find out which window has the clipboard open, call the [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) function.</span></span> <span data-ttu-id="dae52-119">Al termine, la finestra deve chiudere gli Appunti chiamando la funzione [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dae52-119">When it has finished, the window must close the clipboard by calling the [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) function.</span></span>

<span data-ttu-id="dae52-120">In questa sezione vengono descritti gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="dae52-120">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="dae52-121">Operazioni Taglia e copia</span><span class="sxs-lookup"><span data-stu-id="dae52-121">Cut and Copy Operations</span></span>](#cut-and-copy-operations)
-   [<span data-ttu-id="dae52-122">Operazioni Incolla</span><span class="sxs-lookup"><span data-stu-id="dae52-122">Paste Operations</span></span>](#paste-operations)
-   [<span data-ttu-id="dae52-123">Proprietà degli Appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-123">Clipboard Ownership</span></span>](#clipboard-ownership)
-   [<span data-ttu-id="dae52-124">Rendering ritardato</span><span class="sxs-lookup"><span data-stu-id="dae52-124">Delayed Rendering</span></span>](#delayed-rendering)
-   [<span data-ttu-id="dae52-125">Memoria e appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-125">Memory and the Clipboard</span></span>](#memory-and-the-clipboard)

## <a name="cut-and-copy-operations"></a><span data-ttu-id="dae52-126">Operazioni Taglia e copia</span><span class="sxs-lookup"><span data-stu-id="dae52-126">Cut and Copy Operations</span></span>

<span data-ttu-id="dae52-127">Per inserire informazioni negli Appunti, una finestra Cancella prima di tutto il contenuto degli appunti precedente tramite la funzione [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dae52-127">To place information on the clipboard, a window first clears any previous clipboard content by using the [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="dae52-128">Questa funzione Invia il messaggio [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) al proprietario degli appunti precedente, libera le risorse associate ai dati negli Appunti e assegna la proprietà degli Appunti alla finestra con gli Appunti aperti.</span><span class="sxs-lookup"><span data-stu-id="dae52-128">This function sends the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to the previous clipboard owner, frees resources associated with data on the clipboard, and assigns clipboard ownership to the window that has the clipboard open.</span></span> <span data-ttu-id="dae52-129">Per individuare la finestra proprietaria degli Appunti, chiamare la funzione [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) .</span><span class="sxs-lookup"><span data-stu-id="dae52-129">To find out which window owns the clipboard, call the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function.</span></span>

<span data-ttu-id="dae52-130">Dopo aver svuotato gli appunti, la finestra inserisce i dati negli Appunti nel maggior numero possibile di formati degli Appunti, ordinati dal formato degli appunti più descrittivo al meno descrittivo.</span><span class="sxs-lookup"><span data-stu-id="dae52-130">After emptying the clipboard, the window places data on the clipboard in as many clipboard formats as possible, ordered from the most descriptive clipboard format to the least descriptive.</span></span> <span data-ttu-id="dae52-131">Per ogni formato, la finestra chiama la funzione [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) , specificando l'identificatore di formato e un handle di memoria globale.</span><span class="sxs-lookup"><span data-stu-id="dae52-131">For each format, the window calls the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function, specifying the format identifier and a global memory handle.</span></span> <span data-ttu-id="dae52-132">L'handle di memoria può essere NULL, a indicare che la finestra esegue il rendering dei dati su richiesta.</span><span class="sxs-lookup"><span data-stu-id="dae52-132">The memory handle can be NULL, indicating that the window renders the data on request.</span></span> <span data-ttu-id="dae52-133">Per ulteriori informazioni, vedere [rendering ritardato](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="dae52-133">For more information, see [Delayed Rendering](#delayed-rendering).</span></span>

## <a name="paste-operations"></a><span data-ttu-id="dae52-134">Operazioni Incolla</span><span class="sxs-lookup"><span data-stu-id="dae52-134">Paste Operations</span></span>

<span data-ttu-id="dae52-135">Per recuperare le informazioni di Incolla dagli Appunti, una finestra determina innanzitutto il formato degli Appunti da recuperare.</span><span class="sxs-lookup"><span data-stu-id="dae52-135">To retrieve paste information from the clipboard, a window first determines the clipboard format to retrieve.</span></span> <span data-ttu-id="dae52-136">In genere, una finestra enumera i formati degli appunti disponibili usando la funzione [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) e usa il primo formato riconosciuto.</span><span class="sxs-lookup"><span data-stu-id="dae52-136">Typically, a window enumerates the available clipboard formats by using the [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) function and uses the first format it recognizes.</span></span> <span data-ttu-id="dae52-137">Questo metodo seleziona il formato migliore disponibile in base al set di priorità quando i dati sono stati inseriti negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-137">This method selects the best available format according to the priority set when the data was placed on the clipboard.</span></span>

<span data-ttu-id="dae52-138">In alternativa, una finestra può utilizzare la funzione [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) .</span><span class="sxs-lookup"><span data-stu-id="dae52-138">Alternatively, a window can use the [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) function.</span></span> <span data-ttu-id="dae52-139">Questa funzione identifica il migliore formato degli appunti disponibili in base a una priorità specificata.</span><span class="sxs-lookup"><span data-stu-id="dae52-139">This function identifies the best available clipboard format according to a specified priority.</span></span> <span data-ttu-id="dae52-140">Una finestra che riconosce solo un formato degli Appunti può semplicemente determinare se tale formato è disponibile tramite la funzione [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) .</span><span class="sxs-lookup"><span data-stu-id="dae52-140">A window that recognizes only one clipboard format can simply determine whether that format is available by using the [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) function.</span></span>

<span data-ttu-id="dae52-141">Dopo aver determinato il formato degli Appunti da usare, una finestra chiama la funzione [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="dae52-141">After determining the clipboard format to use, a window calls the [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) function.</span></span> <span data-ttu-id="dae52-142">Questa funzione restituisce l'handle a un oggetto memoria globale contenente i dati nel formato specificato.</span><span class="sxs-lookup"><span data-stu-id="dae52-142">This function returns the handle to a global memory object containing data in the specified format.</span></span> <span data-ttu-id="dae52-143">Una finestra può bloccare brevemente l'oggetto memoria per esaminare o copiare i dati.</span><span class="sxs-lookup"><span data-stu-id="dae52-143">A window can briefly lock the memory object in order to examine or copy the data.</span></span> <span data-ttu-id="dae52-144">Tuttavia, una finestra non deve liberare l'oggetto o lasciarla bloccata per un lungo periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="dae52-144">However, a window should not free the object or leave it locked for a long period of time.</span></span>

## <a name="clipboard-ownership"></a><span data-ttu-id="dae52-145">Proprietà degli Appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-145">Clipboard Ownership</span></span>

<span data-ttu-id="dae52-146">Il *proprietario degli Appunti* è la finestra associata alle informazioni negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-146">The *clipboard owner* is the window associated with the information on the clipboard.</span></span> <span data-ttu-id="dae52-147">Una finestra diventa il proprietario degli Appunti quando inserisce i dati negli Appunti, in particolare quando chiama la funzione [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) .</span><span class="sxs-lookup"><span data-stu-id="dae52-147">A window becomes the clipboard owner when it places data on the clipboard, specifically, when it calls the [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="dae52-148">La finestra rimane il proprietario degli Appunti fino a quando non viene chiusa o un'altra finestra svuota gli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-148">The window remains the clipboard owner until it is closed or another window empties the clipboard.</span></span>

<span data-ttu-id="dae52-149">Quando gli Appunti vengono svuotati, il proprietario degli Appunti riceve un messaggio [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="dae52-149">When the clipboard is emptied, the clipboard owner receives a [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="dae52-150">Di seguito sono riportati alcuni dei motivi per cui una finestra potrebbe elaborare questo messaggio:</span><span class="sxs-lookup"><span data-stu-id="dae52-150">Following are some reasons why a window might process this message:</span></span>

-   <span data-ttu-id="dae52-151">Il rendering ritardato della finestra di uno o più formati degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-151">The window delayed rendering of one or more clipboard formats.</span></span> <span data-ttu-id="dae52-152">In risposta al messaggio [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) , la finestra potrebbe liberare le risorse allocate per eseguire il rendering dei dati su richiesta.</span><span class="sxs-lookup"><span data-stu-id="dae52-152">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had allocated in order to render data on request.</span></span> <span data-ttu-id="dae52-153">Per ulteriori informazioni sul rendering dei dati, vedere [rendering ritardato](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="dae52-153">For more information about the rendering of data, see [Delayed Rendering](#delayed-rendering).</span></span>
-   <span data-ttu-id="dae52-154">La finestra posiziona i dati negli Appunti nel formato degli Appunti privati.</span><span class="sxs-lookup"><span data-stu-id="dae52-154">The window placed data on the clipboard in a private clipboard format.</span></span> <span data-ttu-id="dae52-155">I dati per i formati degli Appunti privati non vengono liberati dal sistema quando gli Appunti vengono svuotati.</span><span class="sxs-lookup"><span data-stu-id="dae52-155">The data for private clipboard formats is not freed by the system when the clipboard is emptied.</span></span> <span data-ttu-id="dae52-156">Il proprietario degli Appunti deve pertanto liberare i dati alla ricezione del messaggio [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="dae52-156">Therefore, the clipboard owner should free the data upon receiving the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="dae52-157">Per ulteriori informazioni sui formati degli Appunti privati, vedere la pagina relativa ai [formati degli Appunti](clipboard-formats.md).</span><span class="sxs-lookup"><span data-stu-id="dae52-157">For more information about private clipboard formats, see [Clipboard Formats](clipboard-formats.md).</span></span>
-   <span data-ttu-id="dae52-158">La finestra ha inserito i dati negli appunti usando il formato degli Appunti **\_ OWNERDISPLAY di CF** .</span><span class="sxs-lookup"><span data-stu-id="dae52-158">The window placed data on the clipboard using the **CF\_OWNERDISPLAY** clipboard format.</span></span> <span data-ttu-id="dae52-159">In risposta al messaggio [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) , la finestra potrebbe liberare le risorse usate per visualizzare le informazioni nella finestra Visualizzatore Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-159">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had used to display information in the clipboard viewer window.</span></span> <span data-ttu-id="dae52-160">Per ulteriori informazioni su questo formato alternativo, vedere il [formato di visualizzazione del proprietario](about-the-clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="dae52-160">For more information about this alternative format, see [Owner Display Format](about-the-clipboard.md).</span></span>

## <a name="delayed-rendering"></a><span data-ttu-id="dae52-161">Rendering ritardato</span><span class="sxs-lookup"><span data-stu-id="dae52-161">Delayed Rendering</span></span>

<span data-ttu-id="dae52-162">Quando si inserisce un formato degli Appunti negli Appunti, una finestra può ritardare il rendering dei dati in tale formato fino a quando non sono necessari i dati.</span><span class="sxs-lookup"><span data-stu-id="dae52-162">When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed.</span></span> <span data-ttu-id="dae52-163">A tale scopo, un'applicazione può specificare **null** per il parametro *HData* della funzione [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) .</span><span class="sxs-lookup"><span data-stu-id="dae52-163">To do so, an application can specify **NULL** for the *hData* parameter of the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function.</span></span> <span data-ttu-id="dae52-164">Questa operazione è utile se l'applicazione supporta diversi formati degli Appunti, alcuni o tutti i quali richiedono molto tempo per il rendering.</span><span class="sxs-lookup"><span data-stu-id="dae52-164">This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render.</span></span> <span data-ttu-id="dae52-165">Passando un handle **null** , una finestra esegue il rendering dei formati degli Appunti complessi solo quando e se sono necessari.</span><span class="sxs-lookup"><span data-stu-id="dae52-165">By passing a **NULL** handle, a window renders complex clipboard formats only when and if they are needed.</span></span>

<span data-ttu-id="dae52-166">Se una finestra ritarda il rendering di un formato degli Appunti, deve essere preparato per eseguire il rendering del formato su richiesta per purché sia il proprietario degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-166">If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner.</span></span> <span data-ttu-id="dae52-167">Il sistema invia al proprietario degli Appunti un messaggio [**WM \_ RENDERFORMAT**](wm-renderformat.md) quando viene ricevuta una richiesta per un formato specifico di cui non è stato eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="dae52-167">The system sends the clipboard owner a [**WM\_RENDERFORMAT**](wm-renderformat.md) message when a request is received for a specific format that has not been rendered.</span></span> <span data-ttu-id="dae52-168">Alla ricezione di questo messaggio, la finestra deve chiamare la funzione [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) per inserire un handle di memoria globale negli Appunti nel formato richiesto.</span><span class="sxs-lookup"><span data-stu-id="dae52-168">Upon receiving this message, the window should call the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function to place a global memory handle on the clipboard in the requested format.</span></span>

<span data-ttu-id="dae52-169">Un'applicazione non deve aprire gli Appunti prima di chiamare [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in risposta al messaggio [**WM \_ RENDERFORMAT**](wm-renderformat.md) .</span><span class="sxs-lookup"><span data-stu-id="dae52-169">An application must not open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in response to the [**WM\_RENDERFORMAT**](wm-renderformat.md) message.</span></span> <span data-ttu-id="dae52-170">L'apertura degli Appunti non è necessaria e qualsiasi tentativo di eseguire questa operazione avrà esito negativo perché gli Appunti sono attualmente mantenuti aperti dall'applicazione che ha richiesto il rendering del formato.</span><span class="sxs-lookup"><span data-stu-id="dae52-170">Opening the clipboard is not necessary, and any attempt to do so will fail because the clipboard is currently being held open by the application that requested the format to be rendered.</span></span>

<span data-ttu-id="dae52-171">Se il proprietario degli appunti sta per essere eliminato definitivamente e ha ritardato il rendering di alcuni o di tutti i formati degli Appunti, riceve il messaggio [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) .</span><span class="sxs-lookup"><span data-stu-id="dae52-171">If the clipboard owner is about to be destroyed and has delayed rendering some or all clipboard formats, it receives the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message.</span></span> <span data-ttu-id="dae52-172">Al momento della ricezione di questo messaggio, la finestra deve aprire gli appunti, verificare che sia ancora il proprietario degli Appunti con la funzione [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) , quindi inserire gli handle di memoria validi negli Appunti per tutti i formati degli Appunti forniti.</span><span class="sxs-lookup"><span data-stu-id="dae52-172">Upon receiving this message, the window should open the clipboard, check that it is still the clipboard owner with the the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function, and then place valid memory handles on the clipboard for all clipboard formats that it provides.</span></span> <span data-ttu-id="dae52-173">In questo modo si garantisce che questi formati rimangano disponibili dopo che il proprietario degli Appunti viene eliminato definitivamente.</span><span class="sxs-lookup"><span data-stu-id="dae52-173">This ensures that these formats remain available after the clipboard owner is destroyed.</span></span>

<span data-ttu-id="dae52-174">A differenza di [**WM \_ RENDERFORMAT**](wm-renderformat.md), un'applicazione che risponde a [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) deve aprire gli Appunti prima di chiamare [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) per inserire tutti gli handle di memoria globale negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-174">Unlike with [**WM\_RENDERFORMAT**](wm-renderformat.md), an application responding to [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) should open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) to place any global memory handles on the clipboard.</span></span>

<span data-ttu-id="dae52-175">Tutti i formati degli Appunti di cui non viene eseguito il rendering in risposta al messaggio [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) non sono più disponibili per altre applicazioni e non vengono più enumerati dalle funzioni degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="dae52-175">Any clipboard formats that are not rendered in response to the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message cease to be available to other applications and are no longer enumerated by the clipboard functions.</span></span>

## <a name="memory-and-the-clipboard"></a><span data-ttu-id="dae52-176">Memoria e appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-176">Memory and the Clipboard</span></span>

<span data-ttu-id="dae52-177">Un oggetto memoria da inserire negli Appunti deve essere allocato usando la funzione [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) con il flag **GMEM \_ mobile** .</span><span class="sxs-lookup"><span data-stu-id="dae52-177">A memory object that is to be placed on the clipboard should be allocated by using the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the **GMEM\_MOVEABLE** flag.</span></span>

<span data-ttu-id="dae52-178">Dopo che un oggetto Memory è stato inserito negli Appunti, la proprietà dell'handle di memoria viene trasferita al sistema.</span><span class="sxs-lookup"><span data-stu-id="dae52-178">After a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system.</span></span> <span data-ttu-id="dae52-179">Quando gli Appunti sono vuoti e l'oggetto Memory ha uno dei formati degli Appunti seguenti, il sistema libera l'oggetto memory chiamando la funzione specificata:</span><span class="sxs-lookup"><span data-stu-id="dae52-179">When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the specified function:</span></span>



| <span data-ttu-id="dae52-180">Funzione per liberare oggetto</span><span class="sxs-lookup"><span data-stu-id="dae52-180">Function to free object</span></span>                             | <span data-ttu-id="dae52-181">Formato degli Appunti</span><span class="sxs-lookup"><span data-stu-id="dae52-181">Clipboard format</span></span>                                                                                                                                               |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="dae52-182">**DeleteMetaFile**</span><span class="sxs-lookup"><span data-stu-id="dae52-182">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)<br/> | <span data-ttu-id="dae52-183">**\_DSPENHMETAFILE CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-183">**CF\_DSPENHMETAFILE**</span></span><br/> <span data-ttu-id="dae52-184">**\_DSPMETAFILEPICT CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-184">**CF\_DSPMETAFILEPICT**</span></span><br/> <span data-ttu-id="dae52-185">**\_ENHMETAFILE CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-185">**CF\_ENHMETAFILE**</span></span><br/> <span data-ttu-id="dae52-186">**\_METAFILEPICT CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-186">**CF\_METAFILEPICT**</span></span><br/>                            |
| [<span data-ttu-id="dae52-187">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="dae52-187">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)<br/>     | <span data-ttu-id="dae52-188">**\_bitmap CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-188">**CF\_BITMAP**</span></span><br/> <span data-ttu-id="dae52-189">**\_DSPBITMAP CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-189">**CF\_DSPBITMAP**</span></span><br/> <span data-ttu-id="dae52-190">**\_tavolozza CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-190">**CF\_PALETTE**</span></span><br/>                                                                              |
| [<span data-ttu-id="dae52-191">**GlobalFree**</span><span class="sxs-lookup"><span data-stu-id="dae52-191">**GlobalFree**</span></span>](/windows/desktop/api/winbase/nf-winbase-globalfree)<br/>        | <span data-ttu-id="dae52-192">**\_DIB CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-192">**CF\_DIB**</span></span><br/> <span data-ttu-id="dae52-193">**\_DIBV5 CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-193">**CF\_DIBV5**</span></span><br/> <span data-ttu-id="dae52-194">**\_DSPTEXT CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-194">**CF\_DSPTEXT**</span></span><br/> <span data-ttu-id="dae52-195">**\_OEMTEXT CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-195">**CF\_OEMTEXT**</span></span><br/> <span data-ttu-id="dae52-196">**\_testo CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-196">**CF\_TEXT**</span></span><br/> <span data-ttu-id="dae52-197">**\_UNICODETEXT CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-197">**CF\_UNICODETEXT**</span></span><br/>   |
| <span data-ttu-id="dae52-198">Nessuno</span><span class="sxs-lookup"><span data-stu-id="dae52-198">none</span></span><br/>                                     | <span data-ttu-id="dae52-199">**\_OWNERDISPLAY CF**</span><span class="sxs-lookup"><span data-stu-id="dae52-199">**CF\_OWNERDISPLAY**</span></span><br/> <span data-ttu-id="dae52-200">Quando gli Appunti vengono svuotati di un oggetto **CF \_ OWNERDISPLAY** , l'applicazione deve liberare l'oggetto Memory.</span><span class="sxs-lookup"><span data-stu-id="dae52-200">When the clipboard is emptied of a **CF\_OWNERDISPLAY** object, the application itself must free the memory object.</span></span><br/> |



 

 

