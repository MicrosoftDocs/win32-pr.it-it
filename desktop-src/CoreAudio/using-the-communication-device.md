---
description: In Windows 7, il pannello di controllo multimediale di Windows, Mmsys.cpl, fornisce una nuova scheda comunicazioni.
ms.assetid: bec2127d-fb82-436d-beee-d43e8fef5c35
title: Uso di un dispositivo di comunicazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93f677245e650cf11c71c879b2c26d3183ff4a0b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103877934"
---
# <a name="using-a-communication-device"></a><span data-ttu-id="cfc24-103">Uso di un dispositivo di comunicazione</span><span class="sxs-lookup"><span data-stu-id="cfc24-103">Using a Communication Device</span></span>

<span data-ttu-id="cfc24-104">In Windows 7, il pannello di controllo multimediale di Windows, Mmsys.cpl, fornisce una nuova scheda **comunicazioni** . Questa scheda contiene opzioni che consentono a un utente di impostare opzioni che definiscono la modalità di gestione di un *dispositivo di comunicazione* da parte del sistema.</span><span class="sxs-lookup"><span data-stu-id="cfc24-104">In Windows 7, the Windows multimedia control panel, Mmsys.cpl, provides a new **Communications** tab. This tab contains options that enables a user to set options that defines how the system manages a *communication device*.</span></span> <span data-ttu-id="cfc24-105">Un dispositivo di comunicazione viene utilizzato principalmente per l'inserimento o la ricezione di chiamate telefoniche sul computer.</span><span class="sxs-lookup"><span data-stu-id="cfc24-105">A communication device is used primarily for placing or receiving telephone calls on the computer.</span></span> <span data-ttu-id="cfc24-106">Per un computer che dispone di un solo dispositivo di rendering (altoparlante) e un dispositivo di acquisizione (microfono), questi dispositivi audio fungono anche da dispositivi di comunicazione predefiniti.</span><span class="sxs-lookup"><span data-stu-id="cfc24-106">For a computer that has only one rendering device (speaker) and one capture device (microphone), these audio devices also act as the default communication devices.</span></span> <span data-ttu-id="cfc24-107">Quando un utente connette un nuovo dispositivo, ad esempio una cuffia USB, il sistema esegue il rilevamento automatico del ruolo del dispositivo cercando le impostazioni di configurazione popolate dall'OEM.</span><span class="sxs-lookup"><span data-stu-id="cfc24-107">When a user connects a new device, such as a USB headset, the system performs automatic device role detection by looking up the configuration settings that are populated by the OEM.</span></span> <span data-ttu-id="cfc24-108">Se il sistema determina che un dispositivo è più adatto a scopi di comunicazione, il sistema assegna il ruolo **comunicazioni elettroniche** al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfc24-108">If the system determines a device to be best suited for communication purposes, the system assigns the **eCommunications** role to the device.</span></span> <span data-ttu-id="cfc24-109">Per questi dispositivi, il Mmsys.cpl di Windows 7 fornisce l'opzione **dispositivo di comunicazione predefinito** che consente a un utente di selezionare un dispositivo di comunicazione ciascuno per il rendering audio (scheda **riproduzione** ) e l'acquisizione audio (scheda **registrazione** ).</span><span class="sxs-lookup"><span data-stu-id="cfc24-109">For these devices, the Windows 7 Mmsys.cpl provides the option **Default Communication Device** that enables a user to select a communication device each for audio rendering (**Playback** tab) and audio capturing (**Recording** tab).</span></span> <span data-ttu-id="cfc24-110">Il sistema esegue il rilevamento automatico dei ruoli, ma non imposta un dispositivo specifico da usare per le comunicazioni.</span><span class="sxs-lookup"><span data-stu-id="cfc24-110">The system performs automatic role detection but does not set a particular device to be used for communications.</span></span> <span data-ttu-id="cfc24-111">Questa operazione deve essere eseguita dall'utente.</span><span class="sxs-lookup"><span data-stu-id="cfc24-111">This must be done by the user.</span></span> <span data-ttu-id="cfc24-112">Il nuovo ruolo **comunicazioni elettroniche** consente a un'applicazione di distinguere tra un dispositivo scelto dall'utente per la gestione delle chiamate telefoniche e di un dispositivo da usare come dispositivo multimediale (riproduzione musicale).</span><span class="sxs-lookup"><span data-stu-id="cfc24-112">The new **eCommunications** role lets an application distinguish between a device that is chosen by the user for handling phone calls and a device to be used as a multimedia device (music playback).</span></span> <span data-ttu-id="cfc24-113">Ad esempio, se l'utente dispone di una cuffia e di un altoparlante connesso al computer, il sistema assegna il ruolo **eConsole** al relatore e il ruolo **comunicazioni elettroniche** all'auricolare.</span><span class="sxs-lookup"><span data-stu-id="cfc24-113">For example, if the user has a headset and a speaker connected to the computer, the system assigns the **eConsole** role to the speaker and the **eCommunications** role to the headset.</span></span> <span data-ttu-id="cfc24-114">Dopo che l'utente ha selezionato la cuffia da usare come dispositivo di comunicazione, per sviluppare un'applicazione di comunicazione, è possibile indirizzare l'auricolare in modo specifico per il rendering di un flusso audio.</span><span class="sxs-lookup"><span data-stu-id="cfc24-114">After the user selects the headset to be used as the communication device, to develop a communication application, you can target the headset specifically for rendering an audio stream.</span></span> <span data-ttu-id="cfc24-115">Un'applicazione l'utente non può modificare il ruolo del dispositivo assegnato dal sistema.</span><span class="sxs-lookup"><span data-stu-id="cfc24-115">An application the user cannot change the device role assigned by the system.</span></span> <span data-ttu-id="cfc24-116">Per ulteriori informazioni sui ruoli del dispositivo, vedere [ruoli del dispositivo](device-roles.md).</span><span class="sxs-lookup"><span data-stu-id="cfc24-116">For more information about device roles, see [Device Roles](device-roles.md).</span></span>

<span data-ttu-id="cfc24-117">Le applicazioni di comunicazione, ad esempio le applicazioni VoIP e Unified Communication, inseriscono e ricevono telefonate tramite un computer.</span><span class="sxs-lookup"><span data-stu-id="cfc24-117">Communication applications, such as VoIP and Unified Communication applications, place and receive phone calls through a computer.</span></span> <span data-ttu-id="cfc24-118">Ad esempio, un'applicazione VoIP potrebbe assegnare un flusso che contiene la notifica dell'anello all'endpoint di un set di dispositivi di comunicazione per il rendering dei flussi audio.</span><span class="sxs-lookup"><span data-stu-id="cfc24-118">For example, a VoIP application might assign a stream that contains the ring-in notification to the endpoint of a communication device set for rendering audio streams.</span></span> <span data-ttu-id="cfc24-119">Inoltre, l'applicazione potrebbe aprire i flussi di input e output vocali nei dispositivi dell'endpoint di acquisizione e rendering impostati come dispositivi di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-119">In addition, the application might open the voice input and output streams on the capture and rendering endpoint devices that are set as communication devices.</span></span>

<span data-ttu-id="cfc24-120">Per integrare le funzionalità di comunicazione nelle applicazioni, è possibile usare:</span><span class="sxs-lookup"><span data-stu-id="cfc24-120">To integrate communication capabilities into your applications, you can use:</span></span>

-   <span data-ttu-id="cfc24-121">[API MMDevice](mmdevice-api.md): per ottenere un riferimento all'endpoint del dispositivo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-121">[MMDevice API](mmdevice-api.md)—to get a reference to the endpoint of the communication device.</span></span>
-   <span data-ttu-id="cfc24-122">[WASAPI](wasapi.md): per eseguire il rendering e acquisire i flussi audio tramite il dispositivo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-122">[WASAPI](wasapi.md)—to render and capture audio streams through the communication device.</span></span> <span data-ttu-id="cfc24-123">Il sistema operativo considera il flusso aperto in un dispositivo di comunicazione come *flusso di comunicazione*.</span><span class="sxs-lookup"><span data-stu-id="cfc24-123">The operating system considers the stream opened on a communication device to be a *communication stream*.</span></span>

<span data-ttu-id="cfc24-124">L'applicazione di comunicazione enumera i dispositivi e fornisce la gestione del flusso per un flusso di comunicazione (rendering o acquisizione) nello stesso modo in cui gestirebbe un flusso non di comunicazione usando le API di base di audio.</span><span class="sxs-lookup"><span data-stu-id="cfc24-124">The communication application enumerates devices and provides stream management for a communication stream (rendering or capture) stream in the same manner as it would manage a non-communication stream by using the Core Audio APIs.</span></span>

<span data-ttu-id="cfc24-125">Una delle funzionalità che è possibile integrare nell'applicazione di comunicazione è il *ducking* o l' *attenuazione del flusso*.</span><span class="sxs-lookup"><span data-stu-id="cfc24-125">One of the features that you can integrate in your communication application is *ducking* or *stream attenuation*.</span></span> <span data-ttu-id="cfc24-126">Questo comportamento definisce cosa deve accadere ad altri suoni quando viene aperto un flusso di comunicazione, ad esempio quando viene ricevuta una telefonata sul dispositivo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-126">This behavior defines what must happen to other sounds when a communication stream is opened, such as when a phone call is received on the communication device.</span></span> <span data-ttu-id="cfc24-127">Il sistema potrebbe disattivare o abbassare il volume audio del flusso non di comunicazione a seconda della scelta dell'utente.</span><span class="sxs-lookup"><span data-stu-id="cfc24-127">The system might mute or lower the audio volume of the non-communication stream depending on the user's choice.</span></span> <span data-ttu-id="cfc24-128">Il sistema audio genera eventi ducking quando viene aperto o chiuso un flusso di comunicazione per il rendering o l'acquisizione di flussi.</span><span class="sxs-lookup"><span data-stu-id="cfc24-128">The audio system generates ducking events when a communication stream is opened or closed for rendering or capturing streams.</span></span> <span data-ttu-id="cfc24-129">Per impostazione predefinita, il sistema operativo fornisce un'esperienza di ducking predefinita.</span><span class="sxs-lookup"><span data-stu-id="cfc24-129">By default, the operating system provides a default ducking experience.</span></span> <span data-ttu-id="cfc24-130">Un'applicazione multimediale può sostituire il comportamento predefinito e gestire questi eventi per offrire un'esperienza di ducking personalizzata.</span><span class="sxs-lookup"><span data-stu-id="cfc24-130">A media application can replace the default behavior and handle these events itself to provide a customized ducking experience.</span></span>

<span data-ttu-id="cfc24-131">Le sezioni seguenti descrivono come usare le API audio di base per offrire un'esperienza di ducking personalizzata.</span><span class="sxs-lookup"><span data-stu-id="cfc24-131">The following sections describe how to use Core Audio APIs to provide a custom ducking experience.</span></span>

-   [<span data-ttu-id="cfc24-132">Esperienza di ducking predefinita</span><span class="sxs-lookup"><span data-stu-id="cfc24-132">Default Ducking Experience</span></span>](stream-attenuation.md)
-   [<span data-ttu-id="cfc24-133">Disabilitazione dell'esperienza di ducking predefinita</span><span class="sxs-lookup"><span data-stu-id="cfc24-133">Disabling the Default Ducking Experience</span></span>](disabling-the-ducking-experience.md)
-   [<span data-ttu-id="cfc24-134">Fornire un comportamento di ducking personalizzato</span><span class="sxs-lookup"><span data-stu-id="cfc24-134">Providing a Custom Ducking Behavior</span></span>](providing-a-custom-ducking-experience.md)
-   [<span data-ttu-id="cfc24-135">Considerazioni sull'implementazione per le notifiche di ducking</span><span class="sxs-lookup"><span data-stu-id="cfc24-135">Implementation Considerations for Ducking Notifications</span></span>](handling-audio-ducking-events-from-communication-devices.md)
-   [<span data-ttu-id="cfc24-136">Recupero di eventi ducking</span><span class="sxs-lookup"><span data-stu-id="cfc24-136">Getting Ducking Events</span></span>](getting-ducking-events-from-a-communication-device.md)

### <a name="getting-a-reference-to-the-communication-device-endpoint"></a><span data-ttu-id="cfc24-137">Ottenere un riferimento all'endpoint del dispositivo di comunicazione</span><span class="sxs-lookup"><span data-stu-id="cfc24-137">Getting a Reference to the Communication Device Endpoint</span></span>

<span data-ttu-id="cfc24-138">Per usare il dispositivo di comunicazione, un client WASAPI diretto deve enumerare i dispositivi usando l'enumeratore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfc24-138">To use the communication device, a direct WASAPI client must enumerate the devices by using the device enumerator.</span></span> <span data-ttu-id="cfc24-139">Ottenere un riferimento all'endpoint del dispositivo di comunicazione predefinito chiamando [**IMMDeviceEnumerator:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="cfc24-139">Get a reference to the endpoint of the default communication device by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="cfc24-140">In questa chiamata, l'applicazione deve specificare **comunicazioni elettroniche** nel parametro *Role* per limitare l'enumerazione del dispositivo ai dispositivi di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-140">In this call, the application must specify **eCommunications** in the *Role* parameter to restrict the device enumeration to communication devices.</span></span> <span data-ttu-id="cfc24-141">Dopo aver ottenuto un riferimento all'endpoint del dispositivo per il dispositivo, è possibile attivare i servizi che hanno come ambito l'endpoint chiamando [**IMMDevice:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span><span class="sxs-lookup"><span data-stu-id="cfc24-141">After you get a reference to the device endpoint for the device, you can activate the services that are scoped for the endpoint by calling [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span></span> <span data-ttu-id="cfc24-142">Ad esempio, è possibile passare l'identificatore del servizio **IID \_ IAudioClient** per attivare un oggetto client audio e usarlo per la gestione del flusso, l'identificatore di **\_ IAudioEndpointVolume IID** per ottenere l'accesso ai controlli volume dell'endpoint del dispositivo di comunicazione o l'identificatore **IID \_ IAudioSessionManager** per attivare il gestore sessioni che consente di interagire con il motore dei criteri dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="cfc24-142">For example, you can pass the **IID\_IAudioClient** service identifier to activate an audio client object and use it for stream management, the **IID\_IAudioEndpointVolume** identifier to get access to the volume controls of the communication device endpoint, or the **IID\_IAudioSessionManager** identifier to activate the session manager that enables you to interact with the policy engine of the endpoint.</span></span> <span data-ttu-id="cfc24-143">Per informazioni sulle operazioni di flusso, vedere [gestione dei flussi](stream-management.md).</span><span class="sxs-lookup"><span data-stu-id="cfc24-143">For information about stream operations, see [Stream Management](stream-management.md).</span></span>

<span data-ttu-id="cfc24-144">Usando il riferimento [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) , è anche possibile accedere all'archivio delle proprietà per l'endpoint del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfc24-144">By using the [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) reference, you can also access the property store for the device endpoint.</span></span> <span data-ttu-id="cfc24-145">Questi valori di proprietà, come il nome descrittivo del dispositivo e il nome del produttore, vengono popolati dall'OEM e consentono a un'applicazione di determinare le caratteristiche di un dispositivo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="cfc24-145">These property values, such as device friendly name and manufacturer name, are populated by the OEM and enable an application to determine the characteristics of a communication device.</span></span> <span data-ttu-id="cfc24-146">Per altre informazioni, vedere [proprietà del dispositivo](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="cfc24-146">For more information, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="cfc24-147">Il codice di esempio seguente ottiene un riferimento all'endpoint del dispositivo di comunicazione predefinito per il rendering di un flusso audio.</span><span class="sxs-lookup"><span data-stu-id="cfc24-147">The following example code gets a reference to the endpoint of the default communication device for rendering an audio stream.</span></span>


```C++
IMMDevice *defaultDevice = NULL;

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL,
            CLSCTX_INPROC_SERVER, 
            __uuidof(IMMDeviceEnumerator), 
            (LPVOID *)&deviceEnumerator);

hr = deviceEnumerator->GetDefaultAudioEndpoint(eRender, 
            eCommunications, &defaultDevice);
```



## <a name="related-topics"></a><span data-ttu-id="cfc24-148">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cfc24-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cfc24-149">Gestione dei flussi</span><span class="sxs-lookup"><span data-stu-id="cfc24-149">Stream Management</span></span>](stream-management.md)
</dt> </dl>

 

 



