---
description: Enumerazione dei dispositivi audio
ms.assetid: 20110ffc-5eff-4279-abea-53115803b6ee
title: Enumerazione dei dispositivi audio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 707b9a88181c83344757c711af1c0199c19ebc16
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104049211"
---
# <a name="enumerating-audio-devices"></a><span data-ttu-id="66fda-103">Enumerazione dei dispositivi audio</span><span class="sxs-lookup"><span data-stu-id="66fda-103">Enumerating Audio Devices</span></span>

<span data-ttu-id="66fda-104">La prima attività di un'applicazione audio client è trovare un dispositivo audio adatto da usare.</span><span class="sxs-lookup"><span data-stu-id="66fda-104">The first task of a client audio application is to find a suitable audio device to use.</span></span> <span data-ttu-id="66fda-105">L' [API MMDevice](mmdevice-api.md) consente ai client di individuare i [dispositivi dell'endpoint audio](audio-endpoint-devices.md) nel sistema e di determinare quali dispositivi sono appropriati per l'uso da parte dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="66fda-105">The [MMDevice API](mmdevice-api.md) lets clients discover the [audio endpoint devices](audio-endpoint-devices.md) in the system and determine which devices are suitable for the application to use.</span></span> <span data-ttu-id="66fda-106">Questa API consente ai client di recuperare le raccolte dei dispositivi endpoint disponibili e di ottenere le funzionalità di ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="66fda-106">This API enables clients to retrieve collections of the available endpoint devices and get the capabilities of each device.</span></span> <span data-ttu-id="66fda-107">Il file di intestazione mmdeviceapi. h definisce le interfacce nell'API MMDevice.</span><span class="sxs-lookup"><span data-stu-id="66fda-107">Header file Mmdeviceapi.h defines the interfaces in the MMDevice API.</span></span>

<span data-ttu-id="66fda-108">Una scheda audio potrebbe contenere diversi dispositivi, ad esempio un dispositivo di rendering Wave e un dispositivo di acquisizione Wave.</span><span class="sxs-lookup"><span data-stu-id="66fda-108">An audio adapter might contain several devices—for example, a wave-rendering device and a wave-capture device.</span></span> <span data-ttu-id="66fda-109">Si tratta di dispositivi adapter anziché di dispositivi endpoint.</span><span class="sxs-lookup"><span data-stu-id="66fda-109">These are adapter devices rather than endpoint devices.</span></span> <span data-ttu-id="66fda-110">Come indicato in precedenza, i dispositivi dell'adapter vengono registrati dal gestore Plug and Play, a differenza dei dispositivi endpoint, che vengono registrati da Gestione endpoint.</span><span class="sxs-lookup"><span data-stu-id="66fda-110">As mentioned previously, adapter devices are registered by the Plug and Play manager, in contrast with endpoint devices, which are registered by the endpoint manager.</span></span> <span data-ttu-id="66fda-111">Ogni dispositivo adapter supporta in genere uno o più dispositivi endpoint.</span><span class="sxs-lookup"><span data-stu-id="66fda-111">Each adapter device typically supports one or more endpoint devices.</span></span> <span data-ttu-id="66fda-112">Un dispositivo dell'endpoint di rendering (ad esempio, cuffie) può ricevere un flusso di dati audio da un'applicazione client e un dispositivo dell'endpoint di acquisizione, ad esempio un microfono, può inviare un flusso audio a un'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="66fda-112">A rendering endpoint device (for example, headphones) can receive a stream of audio data from a client application, and a capture endpoint device (for example, a microphone) can send an audio stream to a client application.</span></span>

<span data-ttu-id="66fda-113">Prima di enumerare i dispositivi endpoint nel sistema, il client deve prima chiamare la funzione Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) per creare un enumeratore di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="66fda-113">Before enumerating the endpoint devices in the system, the client must first call the Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to create a device enumerator.</span></span> <span data-ttu-id="66fda-114">Un enumeratore di dispositivo è un oggetto con un'interfaccia [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) .</span><span class="sxs-lookup"><span data-stu-id="66fda-114">A device enumerator is an object with an [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) interface.</span></span> <span data-ttu-id="66fda-115">Per informazioni su **CoCreateInstance**, vedere la documentazione Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="66fda-115">For information about **CoCreateInstance**, see the Windows SDK documentation.</span></span>

<span data-ttu-id="66fda-116">Il client chiama il metodo [**IMMDeviceEnumerator:: EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) per creare una raccolta di oggetti endpoint.</span><span class="sxs-lookup"><span data-stu-id="66fda-116">The client calls the [**IMMDeviceEnumerator::EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) method to create a collection of endpoint objects.</span></span> <span data-ttu-id="66fda-117">Ogni oggetto endpoint rappresenta un dispositivo endpoint audio nel sistema.</span><span class="sxs-lookup"><span data-stu-id="66fda-117">Each endpoint object represents an audio endpoint device in the system.</span></span> <span data-ttu-id="66fda-118">In questa chiamata il client specifica se la raccolta deve contenere tutti i dispositivi di rendering del sistema, tutti i dispositivi di acquisizione o entrambi.</span><span class="sxs-lookup"><span data-stu-id="66fda-118">In this call, the client specifies whether the collection should contain all of the rendering devices in the system, all of the capture devices, or both.</span></span>

<span data-ttu-id="66fda-119">Una raccolta di dispositivi è un oggetto con un'interfaccia [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) .</span><span class="sxs-lookup"><span data-stu-id="66fda-119">A device collection is an object with an [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) interface.</span></span> <span data-ttu-id="66fda-120">Ogni elemento in una raccolta di dispositivi è un oggetto endpoint con almeno le due interfacce seguenti:</span><span class="sxs-lookup"><span data-stu-id="66fda-120">Each item in a device collection is an endpoint object with at least the following two interfaces:</span></span>

-   <span data-ttu-id="66fda-121">Interfaccia [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) .</span><span class="sxs-lookup"><span data-stu-id="66fda-121">An [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) interface.</span></span> <span data-ttu-id="66fda-122">Un client ottiene un riferimento all'interfaccia **IMMDevice** di un oggetto endpoint in una raccolta di dispositivi chiamando il metodo [**IMMDeviceCollection:: Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) .</span><span class="sxs-lookup"><span data-stu-id="66fda-122">A client obtains a reference to the **IMMDevice** interface of an endpoint object in a device collection by calling the [**IMMDeviceCollection::Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) method.</span></span>
-   <span data-ttu-id="66fda-123">Interfaccia [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) .</span><span class="sxs-lookup"><span data-stu-id="66fda-123">An [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) interface.</span></span> <span data-ttu-id="66fda-124">Un client ottiene un riferimento all'interfaccia **IMMEndpoint** di un oggetto endpoint chiamando il metodo [**IMMDevice:: QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) .</span><span class="sxs-lookup"><span data-stu-id="66fda-124">A client obtains a reference to the **IMMEndpoint** interface of an endpoint object by calling the [**IMMDevice::QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span>

<span data-ttu-id="66fda-125">Dopo il recupero di una raccolta di dispositivi endpoint, il client può eseguire una query sulle proprietà dei singoli dispositivi nella raccolta per determinarne l'idoneità per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="66fda-125">After retrieving a collection of endpoint devices, the client can query the properties of the individual devices in the collection to determine their suitability for use.</span></span> <span data-ttu-id="66fda-126">Per un esempio di codice che illustra come enumerare i dispositivi endpoint ed eseguire query sulle relative proprietà, vedere [proprietà del dispositivo](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="66fda-126">For a code example that shows how to enumerate endpoint devices and query their properties, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="66fda-127">Dopo aver selezionato un dispositivo appropriato, il client può chiamare il metodo [**IMMDevice:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) per attivare le interfacce specifiche del dispositivo in [WASAPI](wasapi.md), l' [API DeviceTopology](devicetopology-api.md)e l' [API EndpointVolume](endpointvolume-api.md).</span><span class="sxs-lookup"><span data-stu-id="66fda-127">After selecting a suitable device, the client can call the [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) method to activate the device-specific interfaces in [WASAPI](wasapi.md), the [DeviceTopology API](devicetopology-api.md), and the [EndpointVolume API](endpointvolume-api.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="66fda-128">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="66fda-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="66fda-129">Dispositivi endpoint audio</span><span class="sxs-lookup"><span data-stu-id="66fda-129">Audio Endpoint Devices</span></span>](audio-endpoint-devices.md)
</dt> </dl>

 

 
