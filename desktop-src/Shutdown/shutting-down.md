---
description: "Ci sono tre modi per arrestare l'applicazione di computer locali o remoti: arrestare il systemshut di sistema e riavviare itshut per difetto l'applicazione, arrestare e riavviare il sistema e riavviare le applicazioni registrate per il riavvio"
ms.assetid: acadf58f-3f68-4fa1-bdcf-8f85c8479263
title: Chiusura in corso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e436dd9e3b115112e63b0440b4d51de4c7f9f619
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317666"
---
# <a name="shutting-down"></a><span data-ttu-id="a5684-103">Chiusura in corso</span><span class="sxs-lookup"><span data-stu-id="a5684-103">Shutting Down</span></span>

<span data-ttu-id="a5684-104">È possibile arrestare i computer locali o remoti per un'applicazione in tre modi:</span><span class="sxs-lookup"><span data-stu-id="a5684-104">There are three ways for an application to shut down local or remote computers:</span></span>

-   <span data-ttu-id="a5684-105">arrestare il sistema</span><span class="sxs-lookup"><span data-stu-id="a5684-105">shut down the system</span></span>
-   <span data-ttu-id="a5684-106">arrestare il sistema e riavviarlo</span><span class="sxs-lookup"><span data-stu-id="a5684-106">shut down the system and restart it</span></span>
-   <span data-ttu-id="a5684-107">arrestare l'applicazione, arrestare e riavviare il sistema e riavviare tutte le applicazioni registrate per il riavvio</span><span class="sxs-lookup"><span data-stu-id="a5684-107">shut down the application, shut down and restart the system, and restart any applications that have been registered for restart</span></span>

<span data-ttu-id="a5684-108">Per arrestare il sistema, utilizzare la funzione [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) con il flag di \_ chiusura EWX.</span><span class="sxs-lookup"><span data-stu-id="a5684-108">To shut down the system, use the [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) function with the EWX\_SHUTDOWN flag.</span></span> <span data-ttu-id="a5684-109">Per un esempio, vedere [come arrestare il sistema](how-to-shut-down-the-system.md).</span><span class="sxs-lookup"><span data-stu-id="a5684-109">For an example, see [How to Shut Down the System](how-to-shut-down-the-system.md).</span></span> <span data-ttu-id="a5684-110">Per arrestare e riavviare il sistema, usare il flag di \_ riavvio EWX.</span><span class="sxs-lookup"><span data-stu-id="a5684-110">To shut down and restart the system, use the EWX\_REBOOT flag.</span></span> <span data-ttu-id="a5684-111">Per riavviare le applicazioni che sono state registrate per il riavvio usando la funzione [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) , usare il \_ flag RESTARTAPPS di EXW.</span><span class="sxs-lookup"><span data-stu-id="a5684-111">To restart any applications that have been registered for restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function, use the EXW\_RESTARTAPPS flag.</span></span>

<span data-ttu-id="a5684-112">Le funzioni [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna)e [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) avviano un timer e visualizzano una finestra di dialogo in cui viene richiesto all'utente di disconnettersi.</span><span class="sxs-lookup"><span data-stu-id="a5684-112">The [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna), and [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) functions start a timer and display a dialog box that prompts the user to log off.</span></span> <span data-ttu-id="a5684-113">Quando questa finestra di dialogo viene visualizzata, la funzione [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) può arrestare il timer e impedire l'arresto del computer.</span><span class="sxs-lookup"><span data-stu-id="a5684-113">While this dialog box is displayed, the [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) function can stop the timer and prevent the computer from shutting down.</span></span> <span data-ttu-id="a5684-114">Tuttavia, se il timer scade, il computer viene arrestato.</span><span class="sxs-lookup"><span data-stu-id="a5684-114">However, if the timer expires, the computer is shut down.</span></span> <span data-ttu-id="a5684-115">Queste funzioni possono anche riavviare il computer dopo un'operazione di arresto.</span><span class="sxs-lookup"><span data-stu-id="a5684-115">These functions can also restart the computer following a shutdown operation.</span></span> <span data-ttu-id="a5684-116">Per ulteriori informazioni, vedere [visualizzazione della finestra di dialogo Arresta](displaying-the-shutdown-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="a5684-116">For more information, see [Displaying the Shutdown Dialog Box](displaying-the-shutdown-dialog-box.md).</span></span>

## <a name="shutdown-notifications"></a><span data-ttu-id="a5684-117">Notifiche di arresto</span><span class="sxs-lookup"><span data-stu-id="a5684-117">Shutdown Notifications</span></span>

<span data-ttu-id="a5684-118">Le applicazioni con una finestra e una coda di messaggi ricevono notifiche di chiusura tramite i messaggi [**WM \_ QUERYENDSESSION**](wm-queryendsession.md) e [**WM \_ ENDSESSION**](wm-endsession.md) .</span><span class="sxs-lookup"><span data-stu-id="a5684-118">Applications with a window and message queue receive shutdown notifications through the [**WM\_QUERYENDSESSION**](wm-queryendsession.md) and [**WM\_ENDSESSION**](wm-endsession.md) messages.</span></span> <span data-ttu-id="a5684-119">Queste applicazioni devono restituire **true** per indicare che possono essere interrotte.</span><span class="sxs-lookup"><span data-stu-id="a5684-119">These applications should return **TRUE** to indicate that they can be terminated.</span></span> <span data-ttu-id="a5684-120">Le applicazioni non devono bloccare l'arresto del sistema, a meno che non sia assolutamente necessario.</span><span class="sxs-lookup"><span data-stu-id="a5684-120">Applications should not block system shutdown unless it is absolutely necessary.</span></span> <span data-ttu-id="a5684-121">Le applicazioni devono eseguire qualsiasi pulizia necessaria durante l'elaborazione di **WM \_ ENDSESSION**.</span><span class="sxs-lookup"><span data-stu-id="a5684-121">Applications should perform any required cleanup while processing **WM\_ENDSESSION**.</span></span> <span data-ttu-id="a5684-122">Le applicazioni con dati non salvati potrebbero salvare i dati in un percorso temporaneo e ripristinarli al successivo avvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a5684-122">Applications that have unsaved data could save the data to a temporary location and restore it the next time the application starts.</span></span> <span data-ttu-id="a5684-123">È consigliabile che le applicazioni salvino i dati e lo stato di frequente; ad esempio, salvare automaticamente i dati tra le operazioni di salvataggio avviate dall'utente per ridurre la quantità di dati da salvare al momento dell'arresto.</span><span class="sxs-lookup"><span data-stu-id="a5684-123">It is recommended that applications save their data and state frequently; for example, automatically save data between save operations initiated by the user to reduce the amount of data to be saved at shutdown.</span></span>

<span data-ttu-id="a5684-124">Le applicazioni console ricevono notifiche di chiusura nelle routine del gestore.</span><span class="sxs-lookup"><span data-stu-id="a5684-124">Console applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="a5684-125">Per registrare un gestore della console, usare la funzione [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) .</span><span class="sxs-lookup"><span data-stu-id="a5684-125">To register a console handler, use the [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) function.</span></span>

<span data-ttu-id="a5684-126">Le applicazioni di servizio ricevono notifiche di chiusura nelle routine del gestore.</span><span class="sxs-lookup"><span data-stu-id="a5684-126">Service applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="a5684-127">Per registrare un gestore di controllo del servizio, utilizzare la funzione [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) .</span><span class="sxs-lookup"><span data-stu-id="a5684-127">To register a service control handler, use the [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) function.</span></span>

## <a name="blocking-shutdown"></a><span data-ttu-id="a5684-128">Arresto blocco</span><span class="sxs-lookup"><span data-stu-id="a5684-128">Blocking Shutdown</span></span>

<span data-ttu-id="a5684-129">Se un'applicazione deve bloccare un potenziale arresto del sistema, può chiamare la funzione [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) .</span><span class="sxs-lookup"><span data-stu-id="a5684-129">If an application must block a potential system shutdown, it can call the [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) function.</span></span> <span data-ttu-id="a5684-130">Il chiamante fornisce una stringa del motivo che verrà visualizzata all'utente.</span><span class="sxs-lookup"><span data-stu-id="a5684-130">The caller provides a reason string that will be displayed to the user.</span></span> <span data-ttu-id="a5684-131">La stringa del motivo dovrebbe essere breve e chiara, fornendo all'utente le informazioni necessarie per decidere se continuare l'arresto del sistema.</span><span class="sxs-lookup"><span data-stu-id="a5684-131">The reason string should be short and clear, providing the user with the information necessary to decide whether to continue shutting down the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a5684-132">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="a5684-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a5684-133">Come arrestare il sistema</span><span class="sxs-lookup"><span data-stu-id="a5684-133">How to Shut Down the System</span></span>](how-to-shut-down-the-system.md)
</dt> </dl>

 

 
