---
description: Ogni finestra è un membro di una particolare classe di finestra. La classe Window determina la routine della finestra predefinita utilizzata da una singola finestra per elaborare i messaggi.
ms.assetid: 3a8e8f4e-910d-4863-a4a7-dd37c2dfa402
title: Informazioni sulle routine della finestra
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1f63586b9ca4ac6fe8486ba112316174533b44e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106319096"
---
# <a name="about-window-procedures"></a><span data-ttu-id="5c443-104">Informazioni sulle routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-104">About Window Procedures</span></span>

<span data-ttu-id="5c443-105">Ogni finestra è un membro di una particolare classe di finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-105">Each window is a member of a particular window class.</span></span> <span data-ttu-id="5c443-106">La classe Window determina la routine della finestra predefinita utilizzata da una singola finestra per elaborare i messaggi.</span><span class="sxs-lookup"><span data-stu-id="5c443-106">The window class determines the default window procedure that an individual window uses to process its messages.</span></span> <span data-ttu-id="5c443-107">Tutte le finestre appartenenti alla stessa classe utilizzano la stessa routine della finestra predefinita.</span><span class="sxs-lookup"><span data-stu-id="5c443-107">All windows belonging to the same class use the same default window procedure.</span></span> <span data-ttu-id="5c443-108">Ad esempio, il sistema definisce una routine della finestra per la classe della casella combinata (**ComboBox**); tutte le caselle combinate usano quindi questa routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-108">For example, the system defines a window procedure for the combo box class (**COMBOBOX**); all combo boxes then use that window procedure.</span></span>

<span data-ttu-id="5c443-109">In genere, un'applicazione registra almeno una nuova classe di finestra e la relativa routine della finestra associata.</span><span class="sxs-lookup"><span data-stu-id="5c443-109">An application typically registers at least one new window class and its associated window procedure.</span></span> <span data-ttu-id="5c443-110">Dopo la registrazione di una classe, l'applicazione può creare molte finestre della classe, che usano tutte la stessa routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-110">After registering a class, the application can create many windows of that class, all of which use the same window procedure.</span></span> <span data-ttu-id="5c443-111">Poiché questo significa che diverse origini potrebbero chiamare contemporaneamente la stessa parte di codice, è necessario prestare attenzione quando si modificano le risorse condivise da una routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-111">Because this means several sources could simultaneously call the same piece of code, you must be careful when modifying shared resources from a window procedure.</span></span> <span data-ttu-id="5c443-112">Per altre informazioni, vedere [classi di finestra](window-classes.md).</span><span class="sxs-lookup"><span data-stu-id="5c443-112">For more information, see [Window Classes](window-classes.md).</span></span>

<span data-ttu-id="5c443-113">Le routine della finestra per le finestre di dialogo (chiamate routine della finestra di dialogo) hanno una struttura simile e funzionano come routine di finestra normali.</span><span class="sxs-lookup"><span data-stu-id="5c443-113">Window procedures for dialog boxes (called dialog box procedures) have a similar structure and function as regular window procedures.</span></span> <span data-ttu-id="5c443-114">Tutti i punti che fanno riferimento alle routine della finestra in questa sezione si applicano anche alle routine della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="5c443-114">All points referring to window procedures in this section also apply to dialog box procedures.</span></span> <span data-ttu-id="5c443-115">Per ulteriori informazioni, vedere [finestre di dialogo](/windows/desktop/dlgbox/dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="5c443-115">For more information, see [Dialog Boxes](/windows/desktop/dlgbox/dialog-boxes).</span></span>

<span data-ttu-id="5c443-116">In questa sezione vengono illustrati gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="5c443-116">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="5c443-117">Struttura di una routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-117">Structure of a Window Procedure</span></span>](#structure-of-a-window-procedure)
-   [<span data-ttu-id="5c443-118">Routine della finestra predefinita</span><span class="sxs-lookup"><span data-stu-id="5c443-118">Default Window Procedure</span></span>](#default-window-procedure)
-   [<span data-ttu-id="5c443-119">Sottoclasse delle routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-119">Window Procedure Subclassing</span></span>](#window-procedure-subclassing)
    -   [<span data-ttu-id="5c443-120">Sottoclasse dell'istanza</span><span class="sxs-lookup"><span data-stu-id="5c443-120">Instance Subclassing</span></span>](#instance-subclassing)
    -   [<span data-ttu-id="5c443-121">Sottoclassi globali</span><span class="sxs-lookup"><span data-stu-id="5c443-121">Global Subclassing</span></span>](#global-subclassing)
-   [<span data-ttu-id="5c443-122">Superclasse delle routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-122">Window Procedure Superclassing</span></span>](#window-procedure-superclassing)

## <a name="structure-of-a-window-procedure"></a><span data-ttu-id="5c443-123">Struttura di una routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-123">Structure of a Window Procedure</span></span>

<span data-ttu-id="5c443-124">Una routine della finestra è una funzione che presenta quattro parametri e restituisce un valore con segno.</span><span class="sxs-lookup"><span data-stu-id="5c443-124">A window procedure is a function that has four parameters and returns a signed value.</span></span> <span data-ttu-id="5c443-125">I parametri sono costituiti da un handle di finestra, un identificatore di messaggio **uint** e due parametri di messaggio dichiarati con i tipi di dati **wParam** e **lParam** .</span><span class="sxs-lookup"><span data-stu-id="5c443-125">The parameters consist of a window handle, a **UINT** message identifier, and two message parameters declared with the **WPARAM** and **LPARAM** data types.</span></span> <span data-ttu-id="5c443-126">Per ulteriori informazioni, vedere [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="5c443-126">For more information, see [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span></span>

<span data-ttu-id="5c443-127">I parametri dei messaggi contengono spesso informazioni sia nelle parole più basse che in quelle di ordine superiore.</span><span class="sxs-lookup"><span data-stu-id="5c443-127">Message parameters often contain information in both their low-order and high-order words.</span></span> <span data-ttu-id="5c443-128">Sono disponibili diverse macro che possono essere utilizzate da un'applicazione per estrarre informazioni dai parametri del messaggio.</span><span class="sxs-lookup"><span data-stu-id="5c443-128">There are several macros an application can use to extract information from the message parameters.</span></span> <span data-ttu-id="5c443-129">La macro [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85)) , ad esempio, estrae la parola meno ordinata (BITS da 0 a 15) da un parametro del messaggio.</span><span class="sxs-lookup"><span data-stu-id="5c443-129">The [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85)) macro, for example, extracts the low-order word (bits 0 through 15) from a message parameter.</span></span> <span data-ttu-id="5c443-130">Altre macro includono [**HIWORD**](/previous-versions/windows/desktop/legacy/ms632657(v=vs.85)), [**LOBYTE**](/previous-versions/windows/desktop/legacy/ms632658(v=vs.85))e [**HIBYTE**](/previous-versions/windows/desktop/legacy/ms632656(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="5c443-130">Other macros include [**HIWORD**](/previous-versions/windows/desktop/legacy/ms632657(v=vs.85)), [**LOBYTE**](/previous-versions/windows/desktop/legacy/ms632658(v=vs.85)), and [**HIBYTE**](/previous-versions/windows/desktop/legacy/ms632656(v=vs.85)).</span></span>

<span data-ttu-id="5c443-131">L'interpretazione del valore restituito dipende dal messaggio specifico.</span><span class="sxs-lookup"><span data-stu-id="5c443-131">The interpretation of the return value depends on the particular message.</span></span> <span data-ttu-id="5c443-132">Per determinare il valore restituito appropriato, consultare la descrizione di ogni messaggio.</span><span class="sxs-lookup"><span data-stu-id="5c443-132">Consult the description of each message to determine the appropriate return value.</span></span>

<span data-ttu-id="5c443-133">Poiché è possibile chiamare una routine della finestra in modo ricorsivo, è importante ridurre al minimo il numero di variabili locali utilizzate.</span><span class="sxs-lookup"><span data-stu-id="5c443-133">Because it is possible to call a window procedure recursively, it is important to minimize the number of local variables that it uses.</span></span> <span data-ttu-id="5c443-134">Quando si elaborano singoli messaggi, un'applicazione deve chiamare funzioni esterne alla routine della finestra per evitare un uso eccessivo di variabili locali, causando probabilmente l'overflow dello stack durante la ricorsione profonda.</span><span class="sxs-lookup"><span data-stu-id="5c443-134">When processing individual messages, an application should call functions outside the window procedure to avoid excessive use of local variables, possibly causing the stack to overflow during deep recursion.</span></span>

## <a name="default-window-procedure"></a><span data-ttu-id="5c443-135">Routine della finestra predefinita</span><span class="sxs-lookup"><span data-stu-id="5c443-135">Default Window Procedure</span></span>

<span data-ttu-id="5c443-136">La funzione predefinita della routine della finestra, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , definisce un comportamento fondamentale condiviso da tutte le finestre.</span><span class="sxs-lookup"><span data-stu-id="5c443-136">The default window procedure function, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) defines certain fundamental behavior shared by all windows.</span></span> <span data-ttu-id="5c443-137">La routine della finestra predefinita fornisce la funzionalità minima per una finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-137">The default window procedure provides the minimal functionality for a window.</span></span> <span data-ttu-id="5c443-138">Una routine della finestra definita dall'applicazione deve passare tutti i messaggi che non elabora alla funzione **DefWindowProc** per l'elaborazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="5c443-138">An application-defined window procedure should pass any messages that it does not process to the **DefWindowProc** function for default processing.</span></span>

## <a name="window-procedure-subclassing"></a><span data-ttu-id="5c443-139">Sottoclasse delle routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-139">Window Procedure Subclassing</span></span>

<span data-ttu-id="5c443-140">Quando un'applicazione crea una finestra, il sistema alloca un blocco di memoria per archiviare le informazioni specifiche della finestra, incluso l'indirizzo della routine della finestra che elabora i messaggi per la finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-140">When an application creates a window, the system allocates a block of memory for storing information specific to the window, including the address of the window procedure that processes messages for the window.</span></span> <span data-ttu-id="5c443-141">Quando il sistema deve passare un messaggio alla finestra, Cerca le informazioni specifiche della finestra per l'indirizzo della routine della finestra e passa il messaggio a tale procedura.</span><span class="sxs-lookup"><span data-stu-id="5c443-141">When the system needs to pass a message to the window, it searches the window-specific information for the address of the window procedure and passes the message to that procedure.</span></span>

<span data-ttu-id="5c443-142">La *sottoclasse* è una tecnica che consente a un'applicazione di intercettare ed elaborare i messaggi inviati o pubblicati in una determinata finestra prima che la finestra abbia la possibilità di elaborarli.</span><span class="sxs-lookup"><span data-stu-id="5c443-142">*Subclassing* is a technique that allows an application to intercept and process messages sent or posted to a particular window before the window has a chance to process them.</span></span> <span data-ttu-id="5c443-143">Tramite una sottoclasse di una finestra, un'applicazione può aumentare, modificare o monitorare il comportamento della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-143">By subclassing a window, an application can augment, modify, or monitor the behavior of the window.</span></span> <span data-ttu-id="5c443-144">Un'applicazione può eseguire la sottoclasse di una finestra appartenente a una classe globale di sistema, ad esempio un controllo di modifica o una casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="5c443-144">An application can subclass a window belonging to a system global class, such as an edit control or a list box.</span></span> <span data-ttu-id="5c443-145">Un'applicazione potrebbe ad esempio sottoporre a sottoclasse un controllo di modifica per impedire che il controllo accetti determinati caratteri.</span><span class="sxs-lookup"><span data-stu-id="5c443-145">For example, an application could subclass an edit control to prevent the control from accepting certain characters.</span></span> <span data-ttu-id="5c443-146">Tuttavia, non è possibile sottoclassare una finestra o una classe che appartiene a un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="5c443-146">However, you cannot subclass a window or class that belongs to another application.</span></span> <span data-ttu-id="5c443-147">Tutte le sottoclassi devono essere eseguite all'interno dello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="5c443-147">All subclassing must be performed within the same process.</span></span>

<span data-ttu-id="5c443-148">Un'applicazione sottoclassa una finestra sostituendo l'indirizzo della routine della finestra originale della finestra con l'indirizzo di una nuova routine della finestra, denominata *routine* della sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="5c443-148">An application subclasses a window by replacing the address of the window's original window procedure with the address of a new window procedure, called the *subclass procedure*.</span></span> <span data-ttu-id="5c443-149">Successivamente, la procedura di sottoclasse riceve tutti i messaggi inviati o inviati alla finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-149">Thereafter, the subclass procedure receives any messages sent or posted to the window.</span></span>

<span data-ttu-id="5c443-150">La procedura di sottoclasse può eseguire tre azioni alla ricezione di un messaggio: può passare il messaggio alla routine della finestra originale, modificare il messaggio e passarlo alla routine della finestra originale oppure elaborare il messaggio e non passarlo alla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-150">The subclass procedure can take three actions upon receiving a message: it can pass the message to the original window procedure, modify the message and pass it to the original window procedure, or process the message and not pass it to the original window procedure.</span></span> <span data-ttu-id="5c443-151">Se la procedura di sottoclasse elabora un messaggio, è possibile eseguire questa operazione prima, dopo o prima e dopo il passaggio del messaggio alla procedura della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-151">If the subclass procedure processes a message, it can do so before, after, or both before and after it passes the message to the original window procedure.</span></span>

<span data-ttu-id="5c443-152">Il sistema fornisce due tipi di sottoclassi: [istanza](#instance-subclassing) e [globale](#global-subclassing).</span><span class="sxs-lookup"><span data-stu-id="5c443-152">The system provides two types of subclassing: [instance](#instance-subclassing) and [global](#global-subclassing).</span></span> <span data-ttu-id="5c443-153">Nella *sottoclasse dell'istanza*, un'applicazione sostituisce l'indirizzo della routine della finestra di una singola istanza di una finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-153">In *instance subclassing*, an application replaces the window procedure address of a single instance of a window.</span></span> <span data-ttu-id="5c443-154">Un'applicazione deve usare la sottoclasse dell'istanza per sottoporre a una classe una finestra esistente.</span><span class="sxs-lookup"><span data-stu-id="5c443-154">An application must use instance subclassing to subclass an existing window.</span></span> <span data-ttu-id="5c443-155">Nella *sottoclasse globale*, un'applicazione sostituisce l'indirizzo della routine della finestra nella struttura [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) di una classe di finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-155">In *global subclassing*, an application replaces the address of the window procedure in the [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure of a window class.</span></span> <span data-ttu-id="5c443-156">Tutte le finestre successive create con la classe hanno l'indirizzo della routine della sottoclasse, ma le finestre esistenti della classe non sono interessate.</span><span class="sxs-lookup"><span data-stu-id="5c443-156">All subsequent windows created with the class have the address of the subclass procedure, but existing windows of the class are not affected.</span></span>

### <a name="instance-subclassing"></a><span data-ttu-id="5c443-157">Sottoclasse dell'istanza</span><span class="sxs-lookup"><span data-stu-id="5c443-157">Instance Subclassing</span></span>

<span data-ttu-id="5c443-158">Un'applicazione sottoclasse un'istanza di una finestra tramite la funzione [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) .</span><span class="sxs-lookup"><span data-stu-id="5c443-158">An application subclasses an instance of a window by using the [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) function.</span></span> <span data-ttu-id="5c443-159">L'applicazione passa il **flag \_ WndProc GWL** , l'handle per la finestra alla sottoclasse e l'indirizzo della procedura di sottoclasse a **SetWindowLong**.</span><span class="sxs-lookup"><span data-stu-id="5c443-159">The application passes the **GWL\_WNDPROC** flag, the handle to the window to subclass, and the address of the subclass procedure to **SetWindowLong**.</span></span> <span data-ttu-id="5c443-160">La routine della sottoclasse può risiedere nel file eseguibile dell'applicazione o in una DLL.</span><span class="sxs-lookup"><span data-stu-id="5c443-160">The subclass procedure can reside in either the application's executable or a DLL.</span></span>

<span data-ttu-id="5c443-161">[**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) restituisce l'indirizzo della routine della finestra originale della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-161">[**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) returns the address of the window's original window procedure.</span></span> <span data-ttu-id="5c443-162">L'applicazione deve salvare l'indirizzo, usandolo nelle chiamate successive alla funzione [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca) , per passare i messaggi intercettati alla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-162">The application must save the address, using it in subsequent calls to the [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca) function, to pass intercepted messages to the original window procedure.</span></span> <span data-ttu-id="5c443-163">L'applicazione deve avere anche l'indirizzo della routine della finestra originale per rimuovere la sottoclasse dalla finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-163">The application must also have the original window procedure address to remove the subclass from the window.</span></span> <span data-ttu-id="5c443-164">Per rimuovere la sottoclasse, l'applicazione chiama di nuovo **SetWindowLong** , passando l'indirizzo della routine della finestra originale con il flag **\_ WndProc GWL** e l'handle alla finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-164">To remove the subclass, the application calls **SetWindowLong** again, passing the address of the original window procedure with the **GWL\_WNDPROC** flag and the handle to the window.</span></span>

<span data-ttu-id="5c443-165">Il sistema è proprietario delle classi globali del sistema e gli aspetti dei controlli possono variare da una versione del sistema a quella successiva.</span><span class="sxs-lookup"><span data-stu-id="5c443-165">The system owns the system global classes, and aspects of the controls might change from one version of the system to the next.</span></span> <span data-ttu-id="5c443-166">Se l'applicazione deve sottoclassare una finestra che appartiene a una classe globale di sistema, lo sviluppatore potrebbe dover aggiornare l'applicazione quando viene rilasciata una nuova versione del sistema.</span><span class="sxs-lookup"><span data-stu-id="5c443-166">If the application must subclass a window that belongs to a system global class, the developer may need to update the application when a new version of the system is released.</span></span>

<span data-ttu-id="5c443-167">Poiché la sottoclasse dell'istanza si verifica dopo la creazione di una finestra, non è possibile aggiungere altri byte alla finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-167">Because instance subclassing occurs after a window is created, you cannot add any extra bytes to the window.</span></span> <span data-ttu-id="5c443-168">Le applicazioni che sottoclassano una finestra devono usare l'elenco di proprietà della finestra per archiviare tutti i dati necessari per un'istanza della finestra sottoclassata.</span><span class="sxs-lookup"><span data-stu-id="5c443-168">Applications that subclass a window should use the window's property list to store any data needed for an instance of the subclassed window.</span></span> <span data-ttu-id="5c443-169">Per altre informazioni, vedere [proprietà della finestra](window-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5c443-169">For more information, see [Window Properties](window-properties.md).</span></span>

<span data-ttu-id="5c443-170">Quando un'applicazione crea una sottoclasse di una finestra sottoclassata, deve rimuovere le sottoclassi nell'ordine inverso in cui sono state eseguite.</span><span class="sxs-lookup"><span data-stu-id="5c443-170">When an application subclasses a subclassed window, it must remove the subclasses in the reverse order they were performed.</span></span> <span data-ttu-id="5c443-171">Se l'ordine di rimozione non è invertito, potrebbe verificarsi un errore di sistema irreversibile.</span><span class="sxs-lookup"><span data-stu-id="5c443-171">If the removal order is not reversed, an unrecoverable system error may occur.</span></span>

### <a name="global-subclassing"></a><span data-ttu-id="5c443-172">Sottoclassi globali</span><span class="sxs-lookup"><span data-stu-id="5c443-172">Global Subclassing</span></span>

<span data-ttu-id="5c443-173">Per eseguire la sottoclasse globale di una classe di finestra, l'applicazione deve disporre di un handle per una finestra della classe.</span><span class="sxs-lookup"><span data-stu-id="5c443-173">To globally subclass a window class, the application must have a handle to a window of the class.</span></span> <span data-ttu-id="5c443-174">L'applicazione necessita anche dell'handle per rimuovere la sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="5c443-174">The application also needs the handle to remove the subclass.</span></span> <span data-ttu-id="5c443-175">Per ottenere l'handle, un'applicazione crea in genere una finestra nascosta della classe da sottoclassare.</span><span class="sxs-lookup"><span data-stu-id="5c443-175">To get the handle, an application typically creates a hidden window of the class to be subclassed.</span></span> <span data-ttu-id="5c443-176">Dopo aver ottenuto l'handle, l'applicazione chiama la funzione [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) , specificando l'handle, il flag **\_ WndProc di GCL** e l'indirizzo della routine della sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="5c443-176">After obtaining the handle, the application calls the [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) function, specifying the handle, the **GCL\_WNDPROC** flag, and the address of the subclass procedure.</span></span> <span data-ttu-id="5c443-177">**SetClassLong** restituisce l'indirizzo della routine della finestra originale per la classe.</span><span class="sxs-lookup"><span data-stu-id="5c443-177">**SetClassLong** returns the address of the original window procedure for the class.</span></span>

<span data-ttu-id="5c443-178">L'indirizzo della routine della finestra originale viene utilizzato nella sottoclasse globale nello stesso modo in cui viene utilizzato nella sottoclasse dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="5c443-178">The original window procedure address is used in global subclassing in the same way it is used in instance subclassing.</span></span> <span data-ttu-id="5c443-179">La routine della sottoclasse passa i messaggi alla routine della finestra originale chiamando [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca).</span><span class="sxs-lookup"><span data-stu-id="5c443-179">The subclass procedure passes messages to the original window procedure by calling [**CallWindowProc**](/windows/win32/api/winuser/nf-winuser-callwindowproca).</span></span> <span data-ttu-id="5c443-180">L'applicazione rimuove la sottoclasse dalla classe Window chiamando di nuovo [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) , specificando l'indirizzo della routine della finestra originale, il flag **GCL \_ WndProc** e l'handle di una finestra della classe sottoclassata.</span><span class="sxs-lookup"><span data-stu-id="5c443-180">The application removes the subclass from the window class by calling [**SetClassLong**](/windows/win32/api/winuser/nf-winuser-setclasslonga) again, specifying the address of the original window procedure, the **GCL\_WNDPROC** flag, and the handle to a window of the class being subclassed.</span></span> <span data-ttu-id="5c443-181">Un'applicazione che esegue la sottoclasse globale di una classe di controlli deve rimuovere la sottoclasse quando l'applicazione termina; in caso contrario, potrebbe verificarsi un errore di sistema irreversibile.</span><span class="sxs-lookup"><span data-stu-id="5c443-181">An application that globally subclasses a control class must remove the subclass when the application terminates; otherwise, an unrecoverable system error may occur.</span></span>

<span data-ttu-id="5c443-182">La sottoclasse globale presenta le stesse limitazioni della sottoclasse dell'istanza, oltre ad alcune restrizioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="5c443-182">Global subclassing has the same limitations as instance subclassing, plus some additional restrictions.</span></span> <span data-ttu-id="5c443-183">Un'applicazione non deve usare i byte aggiuntivi per la classe o l'istanza della finestra senza conoscere esattamente il modo in cui vengono usati dalla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-183">An application should not use the extra bytes for either the class or the window instance without knowing exactly how the original window procedure uses them.</span></span> <span data-ttu-id="5c443-184">Se l'applicazione deve associare dati a una finestra, deve usare le proprietà della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-184">If the application must associate data with a window, it should use window properties.</span></span>

## <a name="window-procedure-superclassing"></a><span data-ttu-id="5c443-185">Superclasse delle routine della finestra</span><span class="sxs-lookup"><span data-stu-id="5c443-185">Window Procedure Superclassing</span></span>

<span data-ttu-id="5c443-186">La *superclasse* è una tecnica che consente a un'applicazione di creare una nuova classe di finestra con la funzionalità di base della classe esistente, oltre ai miglioramenti forniti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5c443-186">*Superclassing* is a technique that allows an application to create a new window class with the basic functionality of the existing class, plus enhancements provided by the application.</span></span> <span data-ttu-id="5c443-187">Una superclasse è basata su una classe di finestra esistente denominata *classe base*.</span><span class="sxs-lookup"><span data-stu-id="5c443-187">A superclass is based on an existing window class called the *base class*.</span></span> <span data-ttu-id="5c443-188">Spesso la classe base è una classe di finestra globale di sistema, ad esempio un controllo di modifica, ma può essere qualsiasi classe di finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-188">Frequently, the base class is a system global window class such as an edit control, but it can be any window class.</span></span>

<span data-ttu-id="5c443-189">Una superclasse dispone di una propria routine della finestra, denominata routine superclass.</span><span class="sxs-lookup"><span data-stu-id="5c443-189">A superclass has its own window procedure, called the superclass procedure.</span></span> <span data-ttu-id="5c443-190">La *procedura superclasse* può eseguire tre azioni alla ricezione di un messaggio: può passare il messaggio alla routine della finestra originale, modificare il messaggio e passarlo alla routine della finestra originale oppure elaborare il messaggio e non passarlo alla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-190">The *superclass procedure* can take three actions upon receiving a message: It can pass the message to the original window procedure, modify the message and pass it to the original window procedure, or process the message and not pass it to the original window procedure.</span></span> <span data-ttu-id="5c443-191">Se la procedura superclass elabora un messaggio, può farlo prima, dopo o prima e dopo il passaggio del messaggio alla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-191">If the superclass procedure processes a message, it can do so before, after, or both before and after it passes the message to the original window procedure.</span></span>

<span data-ttu-id="5c443-192">A differenza di una routine di sottoclasse, una procedura di superclasse può elaborare i messaggi di creazione della finestra ([**WM \_ NCCREATE**](wm-nccreate.md), [**WM \_ create**](wm-create.md)e così via), ma è necessario passarli anche alla routine della finestra della classe base originale, in modo che la routine della finestra della classe base possa eseguire la procedura di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5c443-192">Unlike a subclass procedure, a superclass procedure can process window creation messages ([**WM\_NCCREATE**](wm-nccreate.md), [**WM\_CREATE**](wm-create.md), and so on), but it must also pass them to the original base-class window procedure so that the base-class window procedure can perform its initialization procedure.</span></span>

<span data-ttu-id="5c443-193">Per superclasse una classe della finestra, un'applicazione chiama prima di tutto la funzione [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) per recuperare le informazioni sulla classe di base.</span><span class="sxs-lookup"><span data-stu-id="5c443-193">To superclass a window class, an application first calls the [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) function to retrieve information about the base class.</span></span> <span data-ttu-id="5c443-194">**GetClassInfo** riempie una struttura [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) con i valori della struttura **WNDCLASS** della classe di base.</span><span class="sxs-lookup"><span data-stu-id="5c443-194">**GetClassInfo** fills a [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure with the values from the **WNDCLASS** structure of the base class.</span></span> <span data-ttu-id="5c443-195">Successivamente, l'applicazione copia il proprio handle di istanza nel membro **HINSTANCE** della struttura **WNDCLASS** e copia il nome della superclasse nel membro **lpszClassName** .</span><span class="sxs-lookup"><span data-stu-id="5c443-195">Next, the application copies its own instance handle into the **hInstance** member of the **WNDCLASS** structure and copies the name of the superclass into the **lpszClassName** member.</span></span> <span data-ttu-id="5c443-196">Se la classe base dispone di un menu, l'applicazione deve fornire un nuovo menu con gli stessi identificatori di menu e copiare il nome del menu nel membro **lpszMenuName** .</span><span class="sxs-lookup"><span data-stu-id="5c443-196">If the base class has a menu, the application must provide a new menu with the same menu identifiers and copy the menu name into the **lpszMenuName** member.</span></span> <span data-ttu-id="5c443-197">Se la procedura superclass elabora il messaggio di [**\_ comando WM**](/windows/desktop/menurc/wm-command) e non la passa alla routine della finestra della classe di base, non è necessario che nel menu siano presenti identificatori corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="5c443-197">If the superclass procedure processes the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message and does not pass it to the window procedure of the base class, the menu need not have corresponding identifiers.</span></span> <span data-ttu-id="5c443-198">**GetClassInfo** non restituisce il membro **lpszMenuName**, **LpszClassName** o **HINSTANCE** della struttura **WNDCLASS** .</span><span class="sxs-lookup"><span data-stu-id="5c443-198">**GetClassInfo** does not return the **lpszMenuName**, **lpszClassName**, or **hInstance** member of the **WNDCLASS** structure.</span></span>

<span data-ttu-id="5c443-199">Un'applicazione deve inoltre impostare il membro **lpfnWndProc** della struttura [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) .</span><span class="sxs-lookup"><span data-stu-id="5c443-199">An application must also set the **lpfnWndProc** member of the [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure.</span></span> <span data-ttu-id="5c443-200">La funzione [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) riempie questo membro con l'indirizzo della routine della finestra originale per la classe.</span><span class="sxs-lookup"><span data-stu-id="5c443-200">The [**GetClassInfo**](/windows/win32/api/winuser/nf-winuser-getclassinfoa) function fills this member with the address of the original window procedure for the class.</span></span> <span data-ttu-id="5c443-201">L'applicazione deve salvare questo indirizzo per passare i messaggi alla routine della finestra originale, quindi copiare l'indirizzo della procedura superclasse nel membro **lpfnWndProc** .</span><span class="sxs-lookup"><span data-stu-id="5c443-201">The application must save this address, to pass messages to the original window procedure, and then copy the address of the superclass procedure into the **lpfnWndProc** member.</span></span> <span data-ttu-id="5c443-202">Se necessario, l'applicazione può modificare qualsiasi altro membro della struttura **WNDCLASS** .</span><span class="sxs-lookup"><span data-stu-id="5c443-202">The application can, if necessary, modify any other members of the **WNDCLASS** structure.</span></span> <span data-ttu-id="5c443-203">Una volta riempita la struttura **WNDCLASS** , l'applicazione registra la superclasse passando l'indirizzo della struttura alla funzione [**registerClass**](/windows/win32/api/winuser/nf-winuser-registerclassa) .</span><span class="sxs-lookup"><span data-stu-id="5c443-203">After it fills the **WNDCLASS** structure, the application registers the superclass by passing the address of the structure to the [**RegisterClass**](/windows/win32/api/winuser/nf-winuser-registerclassa) function.</span></span> <span data-ttu-id="5c443-204">La superclasse può quindi essere usata per creare finestre.</span><span class="sxs-lookup"><span data-stu-id="5c443-204">The superclass can then be used to create windows.</span></span>

<span data-ttu-id="5c443-205">Poiché la superclasse registra una nuova classe di finestra, un'applicazione può aggiungere sia ai byte di classe aggiuntivi che ai byte aggiuntivi della finestra.</span><span class="sxs-lookup"><span data-stu-id="5c443-205">Because superclassing registers a new window class, an application can add to both the extra class bytes and the extra window bytes.</span></span> <span data-ttu-id="5c443-206">La superclasse non deve usare i byte aggiuntivi originali per la classe di base o per la finestra per gli stessi motivi per cui una sottoclasse di istanza o una sottoclasse globale non devono usarla.</span><span class="sxs-lookup"><span data-stu-id="5c443-206">The superclass must not use the original extra bytes for the base class or the window for the same reasons that an instance subclass or a global subclass should not use them.</span></span> <span data-ttu-id="5c443-207">Inoltre, se l'applicazione aggiunge byte aggiuntivi per l'utilizzo alla classe o all'istanza della finestra, deve fare riferimento ai byte aggiuntivi relativi al numero di byte aggiuntivi utilizzati dalla classe base originale.</span><span class="sxs-lookup"><span data-stu-id="5c443-207">Also, if the application adds extra bytes for its use to either the class or the window instance, it must reference the extra bytes relative to the number of extra bytes used by the original base class.</span></span> <span data-ttu-id="5c443-208">Poiché il numero di byte usati dalla classe base può variare da una versione della classe di base a quella successiva, l'offset iniziale per i byte aggiuntivi della superclasse può variare anche da una versione della classe di base a quella successiva.</span><span class="sxs-lookup"><span data-stu-id="5c443-208">Because the number of bytes used by the base class may vary from one version of the base class to the next, the starting offset for the superclass's own extra bytes may also vary from one version of the base class to the next.</span></span>

 

 
