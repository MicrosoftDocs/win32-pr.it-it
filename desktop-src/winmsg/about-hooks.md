---
description: Questo argomento descrive come usare gli hook.
ms.assetid: 9ced0ac4-e602-425f-b954-6af9c741699a
title: Panoramica degli hook
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c5d89f111604418d1dc3ea9a4ebce6fe0a8124
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106315939"
---
# <a name="hooks-overview"></a><span data-ttu-id="6f5aa-103">Panoramica degli hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-103">Hooks Overview</span></span>

<span data-ttu-id="6f5aa-104">Un *hook* è un meccanismo mediante il quale un'applicazione può intercettare gli eventi, ad esempio i messaggi, le azioni del mouse e le sequenze di tasti.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-104">A *hook* is a mechanism by which an application can intercept events, such as messages, mouse actions, and keystrokes.</span></span> <span data-ttu-id="6f5aa-105">Una funzione che intercetta un particolare tipo di evento è nota come *routine hook*.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-105">A function that intercepts a particular type of event is known as a *hook procedure*.</span></span> <span data-ttu-id="6f5aa-106">Una routine hook può agire su ogni evento ricevuto, quindi modificare o eliminare l'evento.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-106">A hook procedure can act on each event it receives, and then modify or discard the event.</span></span>

<span data-ttu-id="6f5aa-107">Di seguito viene riportato un esempio di utilizzo di per hook:</span><span class="sxs-lookup"><span data-stu-id="6f5aa-107">The following some example uses for hooks:</span></span>

-   <span data-ttu-id="6f5aa-108">Monitorare i messaggi a scopo di debug</span><span class="sxs-lookup"><span data-stu-id="6f5aa-108">Monitor messages for debugging purposes</span></span>
-   <span data-ttu-id="6f5aa-109">Fornire supporto per la registrazione e la riproduzione di macro</span><span class="sxs-lookup"><span data-stu-id="6f5aa-109">Provide support for recording and playback of macros</span></span>
-   <span data-ttu-id="6f5aa-110">Fornire supporto per un tasto guida (F1)</span><span class="sxs-lookup"><span data-stu-id="6f5aa-110">Provide support for a help key (F1)</span></span>
-   <span data-ttu-id="6f5aa-111">Simulare l'input del mouse e della tastiera</span><span class="sxs-lookup"><span data-stu-id="6f5aa-111">Simulate mouse and keyboard input</span></span>
-   <span data-ttu-id="6f5aa-112">Implementare un'applicazione di training basata su computer (CBT)</span><span class="sxs-lookup"><span data-stu-id="6f5aa-112">Implement a computer-based training (CBT) application</span></span>

> [!Note]  
> <span data-ttu-id="6f5aa-113">Gli hook tendono a rallentare il sistema perché aumentano la quantità di elaborazione che il sistema deve eseguire per ogni messaggio.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-113">Hooks tend to slow down the system because they increase the amount of processing the system must perform for each message.</span></span> <span data-ttu-id="6f5aa-114">È consigliabile installare un hook solo quando necessario e rimuoverlo appena possibile.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-114">You should install a hook only when necessary, and remove it as soon as possible.</span></span>

 

<span data-ttu-id="6f5aa-115">In questa sezione vengono descritte le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6f5aa-115">This section discusses the following:</span></span>

-   [<span data-ttu-id="6f5aa-116">Catene di hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-116">Hook Chains</span></span>](#hook-chains)
-   [<span data-ttu-id="6f5aa-117">Procedure Hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-117">Hook Procedures</span></span>](#hook-procedures)
-   [<span data-ttu-id="6f5aa-118">Tipi di hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-118">Hook Types</span></span>](#hook-types)
    -   [<span data-ttu-id="6f5aa-119">WH \_ CALLWNDPROC e WH \_ CALLWNDPROCRET</span><span class="sxs-lookup"><span data-stu-id="6f5aa-119">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>](#wh_callwndproc-and-wh_callwndprocret)
    -   [<span data-ttu-id="6f5aa-120">\_CBT WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-120">WH\_CBT</span></span>](#wh_cbt)
    -   [<span data-ttu-id="6f5aa-121">DEBUG di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-121">WH\_DEBUG</span></span>](#wh_debug)
    -   [<span data-ttu-id="6f5aa-122">FOREGROUNDIDLE di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-122">WH\_FOREGROUNDIDLE</span></span>](#wh_foregroundidle)
    -   [<span data-ttu-id="6f5aa-123">WH \_ GETmessage</span><span class="sxs-lookup"><span data-stu-id="6f5aa-123">WH\_GETMESSAGE</span></span>](#wh_getmessage)
    -   [<span data-ttu-id="6f5aa-124">JOURNALPLAYBACK di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-124">WH\_JOURNALPLAYBACK</span></span>](#wh_journalplayback)
    -   [<span data-ttu-id="6f5aa-125">JOURNALRECORD di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-125">WH\_JOURNALRECORD</span></span>](#wh_journalrecord)
    -   [<span data-ttu-id="6f5aa-126">tastiera di WH \_ \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-126">WH\_KEYBOARD\_LL</span></span>](#wh_keyboard_ll)
    -   [<span data-ttu-id="6f5aa-127">\_tastiera WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-127">WH\_KEYBOARD</span></span>](#wh_keyboard)
    -   [<span data-ttu-id="6f5aa-128">WH \_ mouse \_ ll</span><span class="sxs-lookup"><span data-stu-id="6f5aa-128">WH\_MOUSE\_LL</span></span>](#wh_mouse_ll)
    -   [<span data-ttu-id="6f5aa-129">\_mouse WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-129">WH\_MOUSE</span></span>](#wh_mouse)
    -   [<span data-ttu-id="6f5aa-130">WH \_ msgfilter e WH \_ SYSMSGFILTER</span><span class="sxs-lookup"><span data-stu-id="6f5aa-130">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>](#wh_msgfilter-and-wh_sysmsgfilter)
    -   [<span data-ttu-id="6f5aa-131">\_Shell WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-131">WH\_SHELL</span></span>](#wh_shell)

## <a name="hook-chains"></a><span data-ttu-id="6f5aa-132">Catene di hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-132">Hook Chains</span></span>

<span data-ttu-id="6f5aa-133">Il sistema supporta molti tipi diversi di hook; ogni tipo fornisce l'accesso a un aspetto diverso del meccanismo di gestione dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-133">The system supports many different types of hooks; each type provides access to a different aspect of its message-handling mechanism.</span></span> <span data-ttu-id="6f5aa-134">Ad esempio, un'applicazione può usare l' [hook \_ del mouse WH](#wh_mouse) per monitorare il traffico dei messaggi per i messaggi del mouse.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-134">For example, an application can use the [WH\_MOUSE](#wh_mouse) hook to monitor the message traffic for mouse messages.</span></span>

<span data-ttu-id="6f5aa-135">Il sistema mantiene una catena di hook separata per ogni tipo di hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-135">The system maintains a separate hook chain for each type of hook.</span></span> <span data-ttu-id="6f5aa-136">Una *catena di hook* è un elenco di puntatori a funzioni di callback speciali definite dall'applicazione denominate *routine hook*.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-136">A *hook chain* is a list of pointers to special, application-defined callback functions called *hook procedures*.</span></span> <span data-ttu-id="6f5aa-137">Quando si verifica un messaggio associato a un particolare tipo di hook, il sistema passa il messaggio a ogni routine di hook a cui viene fatto riferimento nella catena di hook, una dopo l'altra.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-137">When a message occurs that is associated with a particular type of hook, the system passes the message to each hook procedure referenced in the hook chain, one after the other.</span></span> <span data-ttu-id="6f5aa-138">L'azione che può essere eseguita da una procedura hook dipende dal tipo di hook necessario.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-138">The action a hook procedure can take depends on the type of hook involved.</span></span> <span data-ttu-id="6f5aa-139">Le procedure hook per alcuni tipi di hook possono monitorare solo i messaggi; altri utenti possono modificare i messaggi o arrestarne lo stato di avanzamento attraverso la catena, impedendo loro di raggiungere la successiva routine hook o la finestra di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-139">The hook procedures for some types of hooks can only monitor messages; others can modify messages or stop their progress through the chain, preventing them from reaching the next hook procedure or the destination window.</span></span>

## <a name="hook-procedures"></a><span data-ttu-id="6f5aa-140">Procedure Hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-140">Hook Procedures</span></span>

<span data-ttu-id="6f5aa-141">Per sfruttare i vantaggi di un particolare tipo di hook, lo sviluppatore fornisce una procedura di hook e usa la funzione [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) per installarla nella catena associata all'hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-141">To take advantage of a particular type of hook, the developer provides a hook procedure and uses the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function to install it into the chain associated with the hook.</span></span> <span data-ttu-id="6f5aa-142">Una routine hook deve avere la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="6f5aa-142">A hook procedure must have the following syntax:</span></span>

``` syntax
LRESULT CALLBACK HookProc(
  int nCode, 
  WPARAM wParam, 
  LPARAM lParam
)
{
   // process event
   ...

   return CallNextHookEx(NULL, nCode, wParam, lParam);
}
```

<span data-ttu-id="6f5aa-143">*HookProc* è un segnaposto per un nome definito dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-143">*HookProc* is a placeholder for an application-defined name.</span></span>

<span data-ttu-id="6f5aa-144">Il parametro *nCode* è un codice hook usato dalla routine hook per determinare l'azione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-144">The *nCode* parameter is a hook code that the hook procedure uses to determine the action to perform.</span></span> <span data-ttu-id="6f5aa-145">Il valore del codice hook dipende dal tipo di hook; ogni tipo ha un proprio set caratteristico di codici hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-145">The value of the hook code depends on the type of the hook; each type has its own characteristic set of hook codes.</span></span> <span data-ttu-id="6f5aa-146">I valori dei parametri *wParam* e *lParam* dipendono dal codice hook, ma in genere contengono informazioni su un messaggio inviato o inviato.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-146">The values of the *wParam* and *lParam* parameters depend on the hook code, but they typically contain information about a message that was sent or posted.</span></span>

<span data-ttu-id="6f5aa-147">La funzione [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) installa sempre una routine hook all'inizio di una catena di hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-147">The [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function always installs a hook procedure at the beginning of a hook chain.</span></span> <span data-ttu-id="6f5aa-148">Quando si verifica un evento monitorato da un particolare tipo di hook, il sistema chiama la stored procedure all'inizio della catena di hook associata all'hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-148">When an event occurs that is monitored by a particular type of hook, the system calls the procedure at the beginning of the hook chain associated with the hook.</span></span> <span data-ttu-id="6f5aa-149">Ogni routine hook nella catena determina se passare l'evento alla procedura successiva.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-149">Each hook procedure in the chain determines whether to pass the event to the next procedure.</span></span> <span data-ttu-id="6f5aa-150">Una routine hook passa un evento alla procedura successiva chiamando la funzione [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-150">A hook procedure passes an event to the next procedure by calling the [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex) function.</span></span>

<span data-ttu-id="6f5aa-151">Si noti che le procedure hook per alcuni tipi di hook possono monitorare solo i messaggi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-151">Note that the hook procedures for some types of hooks can only monitor messages.</span></span> <span data-ttu-id="6f5aa-152">il sistema passa i messaggi a ogni routine hook, indipendentemente dal fatto che una determinata procedura chiami [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-152">the system passes messages to each hook procedure, regardless of whether a particular procedure calls [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex).</span></span>

<span data-ttu-id="6f5aa-153">Un *hook globale* monitora i messaggi per tutti i thread nello stesso desktop del thread chiamante.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-153">A *global hook* monitors messages for all threads in the same desktop as the calling thread.</span></span> <span data-ttu-id="6f5aa-154">Un *hook specifico del thread* monitora i messaggi solo per un singolo thread.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-154">A *thread-specific hook* monitors messages for only an individual thread.</span></span> <span data-ttu-id="6f5aa-155">Una procedura di hook globale può essere chiamata nel contesto di qualsiasi applicazione nello stesso desktop del thread chiamante, quindi la procedura deve trovarsi in un modulo DLL separato.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-155">A global hook procedure can be called in the context of any application in the same desktop as the calling thread, so the procedure must be in a separate DLL module.</span></span> <span data-ttu-id="6f5aa-156">Una routine hook specifica del thread viene chiamata solo nel contesto del thread associato.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-156">A thread-specific hook procedure is called only in the context of the associated thread.</span></span> <span data-ttu-id="6f5aa-157">Se un'applicazione installa una routine di hook per uno dei propri thread, è possibile che la procedura di hook sia nello stesso modulo del resto del codice dell'applicazione o in una DLL.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-157">If an application installs a hook procedure for one of its own threads, the hook procedure can be in either the same module as the rest of the application's code or in a DLL.</span></span> <span data-ttu-id="6f5aa-158">Se l'applicazione installa una procedura di hook per un thread di un'applicazione diversa, la stored procedure deve trovarsi in una DLL.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-158">If the application installs a hook procedure for a thread of a different application, the procedure must be in a DLL.</span></span> <span data-ttu-id="6f5aa-159">Per informazioni, vedere [librerie a collegamento dinamico](../dlls/dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-159">For information, see [Dynamic-Link Libraries](../dlls/dynamic-link-libraries.md).</span></span>

> [!Note]  
> <span data-ttu-id="6f5aa-160">È consigliabile utilizzare hook globali solo a scopo di debug; in caso contrario, è consigliabile evitarli.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-160">You should use global hooks only for debugging purposes; otherwise, you should avoid them.</span></span> <span data-ttu-id="6f5aa-161">Gli hook globali danneggiano le prestazioni del sistema e provocano conflitti con altre applicazioni che implementano lo stesso tipo di hook globale.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-161">Global hooks hurt system performance and cause conflicts with other applications that implement the same type of global hook.</span></span>

 

## <a name="hook-types"></a><span data-ttu-id="6f5aa-162">Tipi di hook</span><span class="sxs-lookup"><span data-stu-id="6f5aa-162">Hook Types</span></span>

<span data-ttu-id="6f5aa-163">Ogni tipo di hook consente a un'applicazione di monitorare un aspetto diverso del meccanismo di gestione dei messaggi del sistema.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-163">Each type of hook enables an application to monitor a different aspect of the system's message-handling mechanism.</span></span> <span data-ttu-id="6f5aa-164">Le sezioni seguenti descrivono i Hook disponibili.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-164">The following sections describe the available hooks.</span></span>

-   [<span data-ttu-id="6f5aa-165">WH \_ CALLWNDPROC e WH \_ CALLWNDPROCRET</span><span class="sxs-lookup"><span data-stu-id="6f5aa-165">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>](#wh_callwndproc-and-wh_callwndprocret)
-   [<span data-ttu-id="6f5aa-166">\_CBT WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-166">WH\_CBT</span></span>](#wh_cbt)
-   [<span data-ttu-id="6f5aa-167">DEBUG di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-167">WH\_DEBUG</span></span>](#wh_debug)
-   [<span data-ttu-id="6f5aa-168">FOREGROUNDIDLE di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-168">WH\_FOREGROUNDIDLE</span></span>](#wh_foregroundidle)
-   [<span data-ttu-id="6f5aa-169">WH \_ GETmessage</span><span class="sxs-lookup"><span data-stu-id="6f5aa-169">WH\_GETMESSAGE</span></span>](#wh_getmessage)
-   [<span data-ttu-id="6f5aa-170">JOURNALPLAYBACK di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-170">WH\_JOURNALPLAYBACK</span></span>](#wh_journalplayback)
-   [<span data-ttu-id="6f5aa-171">JOURNALRECORD di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-171">WH\_JOURNALRECORD</span></span>](#wh_journalrecord)
-   [<span data-ttu-id="6f5aa-172">tastiera di WH \_ \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-172">WH\_KEYBOARD\_LL</span></span>](#wh_keyboard_ll)
-   [<span data-ttu-id="6f5aa-173">\_tastiera WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-173">WH\_KEYBOARD</span></span>](#wh_keyboard)
-   [<span data-ttu-id="6f5aa-174">WH \_ mouse \_ ll</span><span class="sxs-lookup"><span data-stu-id="6f5aa-174">WH\_MOUSE\_LL</span></span>](#wh_mouse_ll)
-   [<span data-ttu-id="6f5aa-175">\_mouse WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-175">WH\_MOUSE</span></span>](#wh_mouse)
-   [<span data-ttu-id="6f5aa-176">WH \_ msgfilter e WH \_ SYSMSGFILTER</span><span class="sxs-lookup"><span data-stu-id="6f5aa-176">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>](#wh_msgfilter-and-wh_sysmsgfilter)
-   [<span data-ttu-id="6f5aa-177">\_Shell WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-177">WH\_SHELL</span></span>](#wh_shell)

### <a name="wh_callwndproc-and-wh_callwndprocret"></a><span data-ttu-id="6f5aa-178">WH \_ CALLWNDPROC e WH \_ CALLWNDPROCRET</span><span class="sxs-lookup"><span data-stu-id="6f5aa-178">WH\_CALLWNDPROC and WH\_CALLWNDPROCRET</span></span>

<span data-ttu-id="6f5aa-179">Gli **hook \_ CALLWNDPROC** e **WH \_ CALLWNDPROCRET** consentono di monitorare i messaggi inviati alle routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-179">The **WH\_CALLWNDPROC** and **WH\_CALLWNDPROCRET** hooks enable you to monitor messages sent to window procedures.</span></span> <span data-ttu-id="6f5aa-180">Il sistema chiama una procedura di hook **\_ CALLWNDPROC di WH** prima di passare il messaggio alla routine della finestra ricevente e chiama la procedura hook **\_ CALLWNDPROCRET di WH** dopo che la routine della finestra ha elaborato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-180">The system calls a **WH\_CALLWNDPROC** hook procedure before passing the message to the receiving window procedure, and calls the **WH\_CALLWNDPROCRET** hook procedure after the window procedure has processed the message.</span></span>

<span data-ttu-id="6f5aa-181">L' **hook \_ CALLWNDPROCRET di WH** passa un puntatore a una struttura [**CWPRETSTRUCT**](/windows/win32/api/winuser/ns-winuser-cwpretstruct) alla routine hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-181">The **WH\_CALLWNDPROCRET** hook passes a pointer to a [**CWPRETSTRUCT**](/windows/win32/api/winuser/ns-winuser-cwpretstruct) structure to the hook procedure.</span></span> <span data-ttu-id="6f5aa-182">La struttura contiene il valore restituito dalla routine della finestra che ha elaborato il messaggio, nonché i parametri del messaggio associati al messaggio.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-182">The structure contains the return value from the window procedure that processed the message, as well as the message parameters associated with the message.</span></span> <span data-ttu-id="6f5aa-183">La sottoclasse della finestra non funziona per i messaggi impostati tra i processi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-183">Subclassing the window does not work for messages set between processes.</span></span>

<span data-ttu-id="6f5aa-184">Per ulteriori informazioni, vedere le funzioni di callback [*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)) e [*CallWndRetProc*](/windows/win32/api/winuser/nc-winuser-hookproc) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-184">For more information, see the [*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)) and [*CallWndRetProc*](/windows/win32/api/winuser/nc-winuser-hookproc) callback functions.</span></span>

### <a name="wh_cbt"></a><span data-ttu-id="6f5aa-185">\_CBT WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-185">WH\_CBT</span></span>

<span data-ttu-id="6f5aa-186">Il sistema chiama una procedura di hook del **\_ token** di rete prima di attivare, creare, eliminare, ridurre a icona, massimizzare, spostare o ridimensionare una finestra; prima di completare un comando di sistema, prima di rimuovere un evento del mouse o della tastiera dalla coda dei messaggi di sistema, prima di impostare lo stato attivo per l'input o prima della sincronizzazione con la coda messaggi di sistema.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-186">The system calls a **WH\_CBT** hook procedure before activating, creating, destroying, minimizing, maximizing, moving, or sizing a window; before completing a system command; before removing a mouse or keyboard event from the system message queue; before setting the input focus; or before synchronizing with the system message queue.</span></span> <span data-ttu-id="6f5aa-187">Il valore restituito dalla routine hook determina se il sistema consente o impedisce una di queste operazioni.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-187">The value the hook procedure returns determines whether the system allows or prevents one of these operations.</span></span> <span data-ttu-id="6f5aa-188">L' **hook \_ CBT di WH** è destinato principalmente alle applicazioni di training basato su computer (CBT).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-188">The **WH\_CBT** hook is intended primarily for computer-based training (CBT) applications.</span></span>

<span data-ttu-id="6f5aa-189">Per ulteriori informazioni, vedere la funzione di callback [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-189">For more information, see the [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)) callback function.</span></span>

<span data-ttu-id="6f5aa-190">Per informazioni, vedere [winEvents](/windows/desktop/WinAuto/winevents-infrastructure).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-190">For information, see [WinEvents](/windows/desktop/WinAuto/winevents-infrastructure).</span></span>

### <a name="wh_debug"></a><span data-ttu-id="6f5aa-191">DEBUG di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-191">WH\_DEBUG</span></span>

<span data-ttu-id="6f5aa-192">Il sistema chiama una procedura di hook di **\_ debug WH** prima di chiamare le routine hook associate a qualsiasi altro hook nel sistema.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-192">The system calls a **WH\_DEBUG** hook procedure before calling hook procedures associated with any other hook in the system.</span></span> <span data-ttu-id="6f5aa-193">È possibile utilizzare questo hook per determinare se consentire al sistema di chiamare le routine hook associate ad altri tipi di hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-193">You can use this hook to determine whether to allow the system to call hook procedures associated with other types of hooks.</span></span>

<span data-ttu-id="6f5aa-194">Per ulteriori informazioni, vedere la funzione di callback [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-194">For more information, see the [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) callback function.</span></span>

### <a name="wh_foregroundidle"></a><span data-ttu-id="6f5aa-195">FOREGROUNDIDLE di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-195">WH\_FOREGROUNDIDLE</span></span>

<span data-ttu-id="6f5aa-196">L' **hook \_ FOREGROUNDIDLE di WH** consente di eseguire attività con priorità bassa durante i periodi in cui il thread in primo piano è inattivo.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-196">The **WH\_FOREGROUNDIDLE** hook enables you to perform low priority tasks during times when its foreground thread is idle.</span></span> <span data-ttu-id="6f5aa-197">Il sistema chiama una procedura di hook **\_ FOREGROUNDIDLE di WH** quando il thread in primo piano dell'applicazione sta per diventare inattivo.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-197">The system calls a **WH\_FOREGROUNDIDLE** hook procedure when the application's foreground thread is about to become idle.</span></span>

<span data-ttu-id="6f5aa-198">Per ulteriori informazioni, vedere la funzione di callback [*ForegroundIdleProc*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-198">For more information, see the [*ForegroundIdleProc*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85)) callback function.</span></span>

### <a name="wh_getmessage"></a><span data-ttu-id="6f5aa-199">WH \_ GETmessage</span><span class="sxs-lookup"><span data-stu-id="6f5aa-199">WH\_GETMESSAGE</span></span>

<span data-ttu-id="6f5aa-200">L'hook di **WH \_ GetMessage** consente a un'applicazione di monitorare i messaggi che stanno per essere restituiti dalla funzione [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-200">The **WH\_GETMESSAGE** hook enables an application to monitor messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="6f5aa-201">È possibile utilizzare l'hook di **WH \_ GetMessage** per monitorare l'input da mouse e tastiera e altri messaggi inviati alla coda di messaggi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-201">You can use the **WH\_GETMESSAGE** hook to monitor mouse and keyboard input and other messages posted to the message queue.</span></span>

<span data-ttu-id="6f5aa-202">Per ulteriori informazioni, vedere la funzione di callback [*GetMsgProc*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-202">For more information, see the [*GetMsgProc*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)) callback function.</span></span>

### <a name="wh_journalplayback"></a><span data-ttu-id="6f5aa-203">JOURNALPLAYBACK di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-203">WH\_JOURNALPLAYBACK</span></span>

<span data-ttu-id="6f5aa-204">L'hook **WH \_ JOURNALPLAYBACK** consente a un'applicazione di inserire messaggi nella coda di messaggi di sistema.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-204">The **WH\_JOURNALPLAYBACK** hook enables an application to insert messages into the system message queue.</span></span> <span data-ttu-id="6f5aa-205">È possibile usare questo hook per riprodurre una serie di eventi di mouse e tastiera registrati in precedenza usando [WH \_ JOURNALRECORD](#wh_journalrecord).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-205">You can use this hook to play back a series of mouse and keyboard events recorded earlier by using [WH\_JOURNALRECORD](#wh_journalrecord).</span></span> <span data-ttu-id="6f5aa-206">L'input del mouse e della tastiera normale è disabilitato fino a quando è installato un hook **\_ JOURNALPLAYBACK di WH** .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-206">Regular mouse and keyboard input is disabled as long as a **WH\_JOURNALPLAYBACK** hook is installed.</span></span> <span data-ttu-id="6f5aa-207">Un **hook \_ JOURNALPLAYBACK di WH** è un hook globale, ma non può essere usato come hook specifico del thread.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-207">A **WH\_JOURNALPLAYBACK** hook is a global hook—it cannot be used as a thread-specific hook.</span></span>

<span data-ttu-id="6f5aa-208">L' **hook \_ JOURNALPLAYBACK di WH** restituisce un valore di timeout.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-208">The **WH\_JOURNALPLAYBACK** hook returns a time-out value.</span></span> <span data-ttu-id="6f5aa-209">Questo valore indica al sistema il numero di millisecondi di attesa prima dell'elaborazione del messaggio corrente dall'hook di riproduzione.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-209">This value tells the system how many milliseconds to wait before processing the current message from the playback hook.</span></span> <span data-ttu-id="6f5aa-210">Ciò consente all'hook di controllare la tempistica degli eventi riprodotti.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-210">This enables the hook to control the timing of the events it plays back.</span></span>

<span data-ttu-id="6f5aa-211">Per ulteriori informazioni, vedere la funzione di callback [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-211">For more information, see the [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) callback function.</span></span>

### <a name="wh_journalrecord"></a><span data-ttu-id="6f5aa-212">JOURNALRECORD di WH \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-212">WH\_JOURNALRECORD</span></span>

<span data-ttu-id="6f5aa-213">L' **hook \_ JOURNALRECORD di WH** consente di monitorare e registrare gli eventi di input.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-213">The **WH\_JOURNALRECORD** hook enables you to monitor and record input events.</span></span> <span data-ttu-id="6f5aa-214">In genere, questo hook viene usato per registrare una sequenza di eventi di mouse e tastiera da riprodurre in un secondo momento usando [WH \_ JOURNALPLAYBACK](#wh_journalplayback).</span><span class="sxs-lookup"><span data-stu-id="6f5aa-214">Typically, you use this hook to record a sequence of mouse and keyboard events to play back later by using [WH\_JOURNALPLAYBACK](#wh_journalplayback).</span></span> <span data-ttu-id="6f5aa-215">L' **hook \_ JOURNALRECORD di WH** è un hook globale, ma non può essere usato come hook specifico del thread.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-215">The **WH\_JOURNALRECORD** hook is a global hook—it cannot be used as a thread-specific hook.</span></span>

<span data-ttu-id="6f5aa-216">Per ulteriori informazioni, vedere la funzione di callback [*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-216">For more information, see the [*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) callback function.</span></span>

### <a name="wh_keyboard_ll"></a><span data-ttu-id="6f5aa-217">tastiera di WH \_ \_</span><span class="sxs-lookup"><span data-stu-id="6f5aa-217">WH\_KEYBOARD\_LL</span></span>

<span data-ttu-id="6f5aa-218">L'hook del tasto di scelta rapida di WH consente di monitorare gli eventi di input da tastiera che possono essere inseriti in una coda di input del thread. **\_ \_**</span><span class="sxs-lookup"><span data-stu-id="6f5aa-218">The **WH\_KEYBOARD\_LL** hook enables you to monitor keyboard input events about to be posted in a thread input queue.</span></span>

<span data-ttu-id="6f5aa-219">Per ulteriori informazioni, vedere la funzione di callback [*LowLevelKeyboardProc*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-219">For more information, see the [*LowLevelKeyboardProc*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85)) callback function.</span></span>

### <a name="wh_keyboard"></a><span data-ttu-id="6f5aa-220">\_tastiera WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-220">WH\_KEYBOARD</span></span>

<span data-ttu-id="6f5aa-221">L'hook della **\_ tastiera WH** consente a un'applicazione di monitorare il traffico dei messaggi per i messaggi [**WM \_ KeyDown**](/windows/desktop/inputdev/wm-keydown) e [**WM \_ KEYUP**](/windows/desktop/inputdev/wm-keyup) che stanno per essere restituiti dalla funzione [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-221">The **WH\_KEYBOARD** hook enables an application to monitor message traffic for [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) and [**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup) messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="6f5aa-222">È possibile usare l'hook della **\_ tastiera WH** per monitorare l'input da tastiera inserito in una coda di messaggi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-222">You can use the **WH\_KEYBOARD** hook to monitor keyboard input posted to a message queue.</span></span>

<span data-ttu-id="6f5aa-223">Per ulteriori informazioni, vedere la funzione di callback [*KeyboardProc*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-223">For more information, see the [*KeyboardProc*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85)) callback function.</span></span>

### <a name="wh_mouse_ll"></a><span data-ttu-id="6f5aa-224">WH \_ mouse \_ ll</span><span class="sxs-lookup"><span data-stu-id="6f5aa-224">WH\_MOUSE\_LL</span></span>

<span data-ttu-id="6f5aa-225">L'hook del mouse di WH consente di monitorare gli eventi di input del mouse che stanno per essere inseriti in una coda di input del thread. **\_ \_**</span><span class="sxs-lookup"><span data-stu-id="6f5aa-225">The **WH\_MOUSE\_LL** hook enables you to monitor mouse input events about to be posted in a thread input queue.</span></span>

<span data-ttu-id="6f5aa-226">Per ulteriori informazioni, vedere la funzione di callback [*LowLevelMouseProc*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-226">For more information, see the [*LowLevelMouseProc*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85)) callback function.</span></span>

### <a name="wh_mouse"></a><span data-ttu-id="6f5aa-227">\_mouse WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-227">WH\_MOUSE</span></span>

<span data-ttu-id="6f5aa-228">L' **hook \_ del mouse di WH** consente di monitorare i messaggi del mouse che stanno per essere restituiti dalla funzione [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-228">The **WH\_MOUSE** hook enables you to monitor mouse messages about to be returned by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="6f5aa-229">È possibile utilizzare l'hook del **\_ mouse WH** per monitorare l'input del mouse inviato a una coda di messaggi.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-229">You can use the **WH\_MOUSE** hook to monitor mouse input posted to a message queue.</span></span>

<span data-ttu-id="6f5aa-230">Per ulteriori informazioni, vedere la funzione di callback [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-230">For more information, see the [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)) callback function.</span></span>

### <a name="wh_msgfilter-and-wh_sysmsgfilter"></a><span data-ttu-id="6f5aa-231">WH \_ msgfilter e WH \_ SYSMSGFILTER</span><span class="sxs-lookup"><span data-stu-id="6f5aa-231">WH\_MSGFILTER and WH\_SYSMSGFILTER</span></span>

<span data-ttu-id="6f5aa-232">Gli hook **WH \_ msgfilter** e **WH \_ SYSMSGFILTER** consentono di monitorare i messaggi che verranno elaborati da un menu, una barra di scorrimento, una finestra di messaggio o una finestra di dialogo e per rilevare quando un'altra finestra sta per essere attivata a seguito della pressione della combinazione di tasti ALT + TAB o ALT + ESC.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-232">The **WH\_MSGFILTER** and **WH\_SYSMSGFILTER** hooks enable you to monitor messages about to be processed by a menu, scroll bar, message box, or dialog box, and to detect when a different window is about to be activated as a result of the user's pressing the ALT+TAB or ALT+ESC key combination.</span></span> <span data-ttu-id="6f5aa-233">L' **hook \_ msgfilter di WH** può monitorare solo i messaggi passati a un menu, a una barra di scorrimento, a una finestra di messaggio o a una finestra di dialogo creata dall'applicazione che ha installato la procedura di hook.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-233">The **WH\_MSGFILTER** hook can only monitor messages passed to a menu, scroll bar, message box, or dialog box created by the application that installed the hook procedure.</span></span> <span data-ttu-id="6f5aa-234">L' **hook \_ SYSMSGFILTER di WH** monitora tali messaggi per tutte le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-234">The **WH\_SYSMSGFILTER** hook monitors such messages for all applications.</span></span>

<span data-ttu-id="6f5aa-235">Gli **hook \_ msgfilter** e **WH \_ SYSMSGFILTER** consentono di eseguire il filtro dei messaggi durante i cicli modali equivalenti al filtro eseguito nel ciclo di messaggi principale.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-235">The **WH\_MSGFILTER** and **WH\_SYSMSGFILTER** hooks enable you to perform message filtering during modal loops that is equivalent to the filtering done in the main message loop.</span></span> <span data-ttu-id="6f5aa-236">Ad esempio, un'applicazione esamina spesso un nuovo messaggio nel ciclo principale tra il momento in cui recupera il messaggio dalla coda e il momento in cui invia il messaggio, eseguendo un'elaborazione speciale nel modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-236">For example, an application often examines a new message in the main loop between the time it retrieves the message from the queue and the time it dispatches the message, performing special processing as appropriate.</span></span> <span data-ttu-id="6f5aa-237">Tuttavia, durante un ciclo modale, il sistema recupera e invia i messaggi senza consentire a un'applicazione di filtrare i messaggi nel relativo ciclo di messaggi principale.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-237">However, during a modal loop, the system retrieves and dispatches messages without allowing an application the chance to filter the messages in its main message loop.</span></span> <span data-ttu-id="6f5aa-238">Se un'applicazione installa una routine di hook **\_ msgfilter** o **WH \_ SYSMSGFILTER** , il sistema chiama la procedura durante il ciclo modale.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-238">If an application installs a **WH\_MSGFILTER** or **WH\_SYSMSGFILTER** hook procedure, the system calls the procedure during the modal loop.</span></span>

<span data-ttu-id="6f5aa-239">Un'applicazione può chiamare direttamente l'hook **\_ msgfilter di WH** chiamando la funzione [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-239">An application can call the **WH\_MSGFILTER** hook directly by calling the [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) function.</span></span> <span data-ttu-id="6f5aa-240">Utilizzando questa funzione, l'applicazione può utilizzare lo stesso codice per filtrare i messaggi durante i cicli modali utilizzati nel ciclo di messaggi principale.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-240">By using this function, the application can use the same code to filter messages during modal loops as it uses in the main message loop.</span></span> <span data-ttu-id="6f5aa-241">A tale scopo, incapsulare le operazioni di filtro in una procedura di hook **\_ msgfilter di WH** e chiamare **CallMsgFilter** tra le chiamate alle funzioni [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) e [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-241">To do so, encapsulate the filtering operations in a **WH\_MSGFILTER** hook procedure and call **CallMsgFilter** between the calls to the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) and [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) functions.</span></span>

``` syntax
while (GetMessage(&msg, (HWND) NULL, 0, 0)) 
{ 
    if (!CallMsgFilter(&qmsg, 0)) 
        DispatchMessage(&qmsg); 
} 
```

<span data-ttu-id="6f5aa-242">L'ultimo argomento di [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) viene semplicemente passato alla routine hook; è possibile immettere qualsiasi valore.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-242">The last argument of [**CallMsgFilter**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera) is simply passed to the hook procedure; you can enter any value.</span></span> <span data-ttu-id="6f5aa-243">La routine hook, definendo una costante come **MSGF \_ MAINLOOP**, può utilizzare questo valore per determinare la posizione da cui è stata chiamata la stored procedure.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-243">The hook procedure, by defining a constant such as **MSGF\_MAINLOOP**, can use this value to determine where the procedure was called from.</span></span>

<span data-ttu-id="6f5aa-244">Per ulteriori informazioni, vedere le funzioni di callback [*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)) e [*SysMsgProc*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-244">For more information, see the [*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)) and [*SysMsgProc*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85)) callback functions.</span></span>

### <a name="wh_shell"></a><span data-ttu-id="6f5aa-245">\_Shell WH</span><span class="sxs-lookup"><span data-stu-id="6f5aa-245">WH\_SHELL</span></span>

<span data-ttu-id="6f5aa-246">Un'applicazione shell può usare l'hook della **\_ Shell di WH** per ricevere notifiche importanti.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-246">A shell application can use the **WH\_SHELL** hook to receive important notifications.</span></span> <span data-ttu-id="6f5aa-247">Il sistema chiama una procedura di hook della **\_ Shell di WH** quando sta per essere attivata l'applicazione shell e quando viene creata o distrutta una finestra di primo livello.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-247">The system calls a **WH\_SHELL** hook procedure when the shell application is about to be activated and when a top-level window is created or destroyed.</span></span>

<span data-ttu-id="6f5aa-248">Si noti che le applicazioni shell personalizzate non ricevono messaggi di **WH \_ Shell** .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-248">Note that custom shell applications do not receive **WH\_SHELL** messages.</span></span> <span data-ttu-id="6f5aa-249">Pertanto, qualsiasi applicazione che si registra come shell predefinita deve chiamare la funzione [**SystemParametersInfo**](/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa) prima che (o qualsiasi altra applicazione) possa ricevere messaggi **WH \_ Shell** .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-249">Therefore, any application that registers itself as the default shell must call the [**SystemParametersInfo**](/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa) function before it (or any other application) can receive **WH\_SHELL** messages.</span></span> <span data-ttu-id="6f5aa-250">Questa funzione deve essere chiamata con **\_ SETMINIMIZEDMETRICS SPI** e una struttura [**MINIMIZEDMETRICS**](/windows/win32/api/winuser/ns-winuser-minimizedmetrics) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-250">This function must be called with **SPI\_SETMINIMIZEDMETRICS** and a [**MINIMIZEDMETRICS**](/windows/win32/api/winuser/ns-winuser-minimizedmetrics) structure.</span></span> <span data-ttu-id="6f5aa-251">Impostare il membro **iArrange** della struttura su **ARW \_ Hide**.</span><span class="sxs-lookup"><span data-stu-id="6f5aa-251">Set the **iArrange** member of this structure to **ARW\_HIDE**.</span></span>

<span data-ttu-id="6f5aa-252">Per ulteriori informazioni, vedere la funzione di callback [*ShellProc*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6f5aa-252">For more information, see the [*ShellProc*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) callback function.</span></span>

 

 
