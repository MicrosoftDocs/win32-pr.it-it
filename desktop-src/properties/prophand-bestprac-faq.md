---
description: In questo argomento viene illustrato come creare e registrare gestori di proprietà per utilizzare il sistema di proprietà di Windows.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Procedure consigliate e domande frequenti sul gestore delle proprietà
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5188e66f08f3c6cf449f8bc61feb6aac829d37c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104233607"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="7fc82-103">Procedure consigliate e domande frequenti sul gestore delle proprietà</span><span class="sxs-lookup"><span data-stu-id="7fc82-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="7fc82-104">In questo argomento viene illustrato come creare e registrare gestori di proprietà per utilizzare il sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="7fc82-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="7fc82-105">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="7fc82-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="7fc82-106">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="7fc82-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="7fc82-107">Override delle proprietà del file System</span><span class="sxs-lookup"><span data-stu-id="7fc82-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="7fc82-108">Archiviazione di proprietà nei formati di file basati su XML</span><span class="sxs-lookup"><span data-stu-id="7fc82-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="7fc82-109">Proprietà calcolate</span><span class="sxs-lookup"><span data-stu-id="7fc82-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="7fc82-110">Domande frequenti</span><span class="sxs-lookup"><span data-stu-id="7fc82-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="7fc82-111">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="7fc82-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="7fc82-112">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="7fc82-112">Best Practices</span></span>

<span data-ttu-id="7fc82-113">Le procedure consigliate illustrate di seguito forniscono suggerimenti utili per l'implementazione.</span><span class="sxs-lookup"><span data-stu-id="7fc82-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="7fc82-114">Override delle proprietà del file System</span><span class="sxs-lookup"><span data-stu-id="7fc82-114">Overriding File System Properties</span></span>

<span data-ttu-id="7fc82-115">Alcune proprietà dei file vengono fornite dall'origine dati file system, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="7fc82-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="7fc82-116">\_Nome file pkey</span><span class="sxs-lookup"><span data-stu-id="7fc82-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="7fc82-117">\_Estensione pkey</span><span class="sxs-lookup"><span data-stu-id="7fc82-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="7fc82-118">\_MODIFIEDTIME pkey</span><span class="sxs-lookup"><span data-stu-id="7fc82-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="7fc82-119">In generale, i gestori di proprietà non possono fornire valori per queste proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="7fc82-120">Tuttavia, in alcuni casi è possibile eseguire l'override di queste proprietà in base alle informazioni di registrazione fornite dal gestore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="7fc82-121">I gestori di proprietà popolano le **classi HKEY CLSID \_ \_ radice** \\  \\ *{handler CLSID}* \\ **OverrideFileSystemProperties** con i nomi delle proprietà di cui si desidera eseguire l'override.</span><span class="sxs-lookup"><span data-stu-id="7fc82-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="7fc82-122">Questa operazione è limitata a un set fisso di proprietà mostrato nell'elenco seguente di cui il sistema ha la conoscenza.</span><span class="sxs-lookup"><span data-stu-id="7fc82-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="7fc82-123">L'override di è supportato per i valori di proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="7fc82-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="7fc82-124">System. Kind</span><span class="sxs-lookup"><span data-stu-id="7fc82-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="7fc82-125">System. FileName</span><span class="sxs-lookup"><span data-stu-id="7fc82-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="7fc82-126">System. IsPinnedToNameSpaceTree</span><span class="sxs-lookup"><span data-stu-id="7fc82-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="7fc82-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="7fc82-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="7fc82-128">System. SFGAOFlags</span><span class="sxs-lookup"><span data-stu-id="7fc82-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="7fc82-129">System. ItemPathDisplay</span><span class="sxs-lookup"><span data-stu-id="7fc82-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="7fc82-130">System. ItemPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="7fc82-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="7fc82-131">System. ItemFolderNameDisplay</span><span class="sxs-lookup"><span data-stu-id="7fc82-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="7fc82-132">System. ItemFolderPathDisplay</span><span class="sxs-lookup"><span data-stu-id="7fc82-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="7fc82-133">System. ItemFolderPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="7fc82-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="7fc82-134">Per un elenco completo di tutte le proprietà della shell, vedere [Proprietà](./props.md)della shell.</span><span class="sxs-lookup"><span data-stu-id="7fc82-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7fc82-135">I valori delle proprietà sottoposti a override vengono utilizzati solo quando i file vengono indicizzati.</span><span class="sxs-lookup"><span data-stu-id="7fc82-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="7fc82-136">Di conseguenza, l'esplorazione dei file dall'origine dati file system non rivela i valori sottoposti a override.</span><span class="sxs-lookup"><span data-stu-id="7fc82-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="7fc82-137">Archiviazione di proprietà nei formati di file basati su XML</span><span class="sxs-lookup"><span data-stu-id="7fc82-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="7fc82-138">Sono disponibili due opzioni di base per archiviare le proprietà nei formati di file basati su XML:</span><span class="sxs-lookup"><span data-stu-id="7fc82-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="7fc82-139">Archiviare ogni proprietà usando gli elementi e gli attributi XML in base all'XML Schema del documento.</span><span class="sxs-lookup"><span data-stu-id="7fc82-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="7fc82-140">Questo approccio è più "XML friendly".</span><span class="sxs-lookup"><span data-stu-id="7fc82-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="7fc82-141">Serializzare l'intero archivio delle proprietà in un BLOB (Binary Large Object) di memoria, convertire il BLOB in una stringa con codifica Base64 e quindi archiviare tale stringa nel codice XML.</span><span class="sxs-lookup"><span data-stu-id="7fc82-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="7fc82-142">Questo è il più semplice dei due approcci e può essere usato per fornire il supporto per i metadati aperti.</span><span class="sxs-lookup"><span data-stu-id="7fc82-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="7fc82-143">Alcuni gestori potrebbero combinare questi approcci, archiviando alcuni valori importanti nel formato XML standard e archiviando il resto in un BLOB, ad esempio.</span><span class="sxs-lookup"><span data-stu-id="7fc82-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="7fc82-144">Proprietà calcolate</span><span class="sxs-lookup"><span data-stu-id="7fc82-144">Computed Properties</span></span>

<span data-ttu-id="7fc82-145">Alcune proprietà derivano da attributi specifici di un file.</span><span class="sxs-lookup"><span data-stu-id="7fc82-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="7fc82-146">Ad esempio, la proprietà [System. image. Dimensions](./props-system-image-dimensions.md) è determinata dalle dimensioni effettive dell'immagine in un file di immagine.</span><span class="sxs-lookup"><span data-stu-id="7fc82-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="7fc82-147">Poiché tali valori di proprietà non possono essere modificati dal gestore della proprietà, sono contrassegnati `isInnate="true"` nella descrizione della proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="7fc82-148">Altre proprietà vengono calcolate da una parte di una proprietà specifica o aggregando i valori di più proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="7fc82-149">Poiché gli aggiornamenti a queste proprietà "calcolate" creeranno ambiguità sulla modalità di modifica dei valori di "origine", le proprietà calcolate dovrebbero essere contrassegnate `isInnate="true"` nella descrizione della proprietà o restituite come di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="7fc82-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="7fc82-150">La seconda opzione è disponibile indicando al gestore di restituire \_ false da [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span><span class="sxs-lookup"><span data-stu-id="7fc82-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="7fc82-151">Domande frequenti</span><span class="sxs-lookup"><span data-stu-id="7fc82-151">Frequently Asked Questions</span></span>

<span data-ttu-id="7fc82-152">In questa sezione vengono fornite le risposte alle domande frequenti relative alle proprietà e ai gestori di proprietà e alle risposte correlate.</span><span class="sxs-lookup"><span data-stu-id="7fc82-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="7fc82-153">**Domanda:** Perché il gestore delle proprietà non viene caricato dall'indicizzatore di ricerca di Windows?</span><span class="sxs-lookup"><span data-stu-id="7fc82-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="7fc82-154">L'indicizzatore di ricerca di Windows viene eseguito come servizio di sistema e non è in grado di caricare le dll archiviate nella directory del profilo utente.</span><span class="sxs-lookup"><span data-stu-id="7fc82-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="7fc82-155">Se si compila e si esegue il debug con Microsoft Visual Studio, il file verrà inserito nel profilo utente e pertanto non verrà caricato dall'indicizzatore.</span><span class="sxs-lookup"><span data-stu-id="7fc82-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="7fc82-156">Per ovviare a questo problema, copiare la DLL all'esterno della cartella del profilo, ad esempio in **C: \\ Program Files \\ YourAppName**, e registrarla in tale cartella.</span><span class="sxs-lookup"><span data-stu-id="7fc82-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="7fc82-157">Per indicazioni più specifiche sullo sviluppo di gestori di proprietà per lavorare con l'indicizzatore di ricerca di Windows, vedere [sviluppo di gestori di proprietà per la ricerca di Windows](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="7fc82-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="7fc82-158">**Domanda:** Quali proprietà devono essere individuabili tramite i metodi di enumerazione [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: Geta**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ?</span><span class="sxs-lookup"><span data-stu-id="7fc82-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="7fc82-159">Non tutti i client degli oggetti archivio proprietà utilizzano questi metodi.</span><span class="sxs-lookup"><span data-stu-id="7fc82-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="7fc82-160">Alcuni client sono in grado di riconoscere le proprietà che prevedono di richiedere direttamente (in base al nome PKEY) o di ricevere informazioni sulle proprietà tramite un elenco di descrizioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="7fc82-161">I metodi di individuazione delle proprietà supporto diversi altri scenari.</span><span class="sxs-lookup"><span data-stu-id="7fc82-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="7fc82-162">Se non è necessario che una proprietà partecipi a questi scenari, non è necessario che venga enumerata.</span><span class="sxs-lookup"><span data-stu-id="7fc82-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="7fc82-163">Di conseguenza, un gestore proprietà può produrre un \_ valore vuoto non VT per le proprietà che non vengono individuate tramite i metodi [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: Geta**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="7fc82-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="7fc82-164">Tuttavia, le proprietà devono essere visibili tramite questi metodi se viene soddisfatta una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="7fc82-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="7fc82-165">**Se la proprietà è indicizzata in modo che sia ricercabile:** Ciò significa che è incluso nell'archivio delle proprietà di ricerca di Windows (indicato da `isColumn = "true"` nello schema della descrizione della proprietà) o disponibile per le ricerche full-text ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="7fc82-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="7fc82-166">In assenza di questi flag o dell'assenza di una descrizione della proprietà, le proprietà di tipo "String" verranno aggiunte automaticamente all'indice invertito per consentire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="7fc82-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="7fc82-167">Poiché l'elenco delle proprietà note (quelle con le descrizioni delle proprietà installate) nel sistema di proprietà è molto grande (più di 800 proprietà), non sarebbe pratico chiedere a ogni gestore di proprietà di ogni proprietà registrata nel sistema di proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="7fc82-168">Al contrario, il processo di indicizzazione enumera le proprietà rilevanti dal gestore delle proprietà per ogni elemento indici e usa i valori delle proprietà enumerate per compilare l'indice full-text.</span><span class="sxs-lookup"><span data-stu-id="7fc82-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="7fc82-169">**Se la proprietà deve essere copiata quando il set di proprietà dell'elemento viene duplicato:** Per implementare una funzione "copia set di proprietà", l'elemento di origine rende visibili le proprietà che devono essere copiate tramite i metodi [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: Geta**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="7fc82-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="7fc82-170">Non è necessario includere le proprietà che non devono essere copiate o che non hanno senso di essere copiate.</span><span class="sxs-lookup"><span data-stu-id="7fc82-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="7fc82-171">**Se il valore della proprietà non è vuoto (VT \_ vuoto):** i valori di proprietà vuoti non sono utili per i client.</span><span class="sxs-lookup"><span data-stu-id="7fc82-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="7fc82-172">Quando i client tentano di restituire valori di proprietà vuoti, viene restituito il valore VT \_ Empty.</span><span class="sxs-lookup"><span data-stu-id="7fc82-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="7fc82-173">Pertanto, le proprietà con valori vuoti non devono essere enumerate.</span><span class="sxs-lookup"><span data-stu-id="7fc82-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="7fc82-174">**Se la proprietà deve essere rimossa quando si richiama la funzione "Rimuovi proprietà":** Questa funzionalità è disponibile per proteggere la privacy. individua tutti i valori dal gestore delle proprietà tramite l'enumerazione e rimuove ognuno di essi selezionati per la rimozione da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="7fc82-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="7fc82-175">L'enumerazione delle proprietà non comunica il set di proprietà supportato da un particolare gestore di proprietà se il gestore supporta uno schema fisso (e non i metadati aperti).</span><span class="sxs-lookup"><span data-stu-id="7fc82-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="7fc82-176">Al contrario, questi gestori dovrebbero documentare il set di proprietà supportate.</span><span class="sxs-lookup"><span data-stu-id="7fc82-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="7fc82-177">**Domanda:** Ricerca per categorie informazioni sui formati di file che supportano i metadati aperti?</span><span class="sxs-lookup"><span data-stu-id="7fc82-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="7fc82-178">Per informazioni sul supporto per i metadati aperti, vedere la sezione relativa ai tipi di file che supportano i metadati aperti in [tipi di file](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="7fc82-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="7fc82-179">**Domanda:** È possibile \_ archiviare i valori null del VT usando un gestore proprietà?</span><span class="sxs-lookup"><span data-stu-id="7fc82-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="7fc82-180">No.</span><span class="sxs-lookup"><span data-stu-id="7fc82-180">No.</span></span> <span data-ttu-id="7fc82-181">\_I valori null VT verranno convertiti in VT \_ vuoti per le chiamate a [**IPropertyStore:: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) e [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="7fc82-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="7fc82-182">**Domanda:** Quali formati di stringa di data sono supportati dalla funzione [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) ?</span><span class="sxs-lookup"><span data-stu-id="7fc82-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="7fc82-183">In genere, le proprietà che rappresentano i valori di data/ora devono essere rappresentate utilizzando il \_ FILETIME VT.</span><span class="sxs-lookup"><span data-stu-id="7fc82-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="7fc82-184">Tuttavia, molte origini dati forniscono queste informazioni in formato stringa.</span><span class="sxs-lookup"><span data-stu-id="7fc82-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="7fc82-185">L'API helper [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) supporta la coercizione di alcuni formati di data stringa in valori [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="7fc82-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="7fc82-186">Formato</span><span class="sxs-lookup"><span data-stu-id="7fc82-186">Format</span></span>                  | <span data-ttu-id="7fc82-187">Windows Vista, Windows XP e Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="7fc82-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="7fc82-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="7fc82-188">Windows 7</span></span> | <span data-ttu-id="7fc82-189">Note</span><span class="sxs-lookup"><span data-stu-id="7fc82-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="7fc82-190">aaaa/mm/gg: HH: mm: SS. UUU</span><span class="sxs-lookup"><span data-stu-id="7fc82-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="7fc82-191">Sì</span><span class="sxs-lookup"><span data-stu-id="7fc82-191">Yes</span></span>                                                                   | <span data-ttu-id="7fc82-192">Sì</span><span class="sxs-lookup"><span data-stu-id="7fc82-192">Yes</span></span>       | <span data-ttu-id="7fc82-193">UTC y = anno, m = mese, d = data, h = ore (orario a 24 ore), m = minuti, s = secondi, u = microsecondi</span><span class="sxs-lookup"><span data-stu-id="7fc82-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="7fc82-194">aaaa-mm-ggThh: mm: ssZ</span><span class="sxs-lookup"><span data-stu-id="7fc82-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="7fc82-195">No</span><span class="sxs-lookup"><span data-stu-id="7fc82-195">No</span></span>                                                                    | <span data-ttu-id="7fc82-196">Sì</span><span class="sxs-lookup"><span data-stu-id="7fc82-196">Yes</span></span>       | <span data-ttu-id="7fc82-197">**Specifica del formato ISO8601** UTC (indicata dall'indicatore di fuso orario ' Z '); y = anno, m = mese, d = data, h = ore (orario a 24 ore), m = minuti, s = secondi; ' T'è un delimitatore per la parte relativa all'ora.</span><span class="sxs-lookup"><span data-stu-id="7fc82-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="7fc82-198">**Domanda:** È possibile creare un gestore di proprietà di sola lettura?</span><span class="sxs-lookup"><span data-stu-id="7fc82-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="7fc82-199">Sì.</span><span class="sxs-lookup"><span data-stu-id="7fc82-199">Yes.</span></span> <span data-ttu-id="7fc82-200">Alcune implementazioni di gestori di proprietà non supportano la scrittura di valori di proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="7fc82-201">Questi gestori di proprietà devono restituire STGM \_ E \_ AccessDenied sulle chiamate a **IInitializeXXX:: Initialize** che passano STGM \_ ReadWrite o su qualsiasi chiamata a [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="7fc82-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="7fc82-202">Tutti i gestori di proprietà aperti in \_ modalità di lettura STGM devono restituire STGM \_ E \_ AccessDenied sulle chiamate a [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="7fc82-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="7fc82-203">**Domanda:** Un gestore di proprietà può considerare una proprietà come di sola lettura, anche se lo schema indica che la proprietà è scrivibile?</span><span class="sxs-lookup"><span data-stu-id="7fc82-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="7fc82-204">Sì.</span><span class="sxs-lookup"><span data-stu-id="7fc82-204">Yes.</span></span> <span data-ttu-id="7fc82-205">Nel sistema dello schema le proprietà sono annotate come di sola lettura (incluse quelle con `isInnate = "true"` ) o di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="7fc82-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="7fc82-206">I gestori di proprietà che non supportano la scrittura di una proprietà specifica che lo schema deve essere scrivibile devono implementare [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) e restituire \_ false sulle chiamate a [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) per la proprietà.</span><span class="sxs-lookup"><span data-stu-id="7fc82-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="7fc82-207">Ciò indica che nel contesto di questo gestore e questo file la proprietà non è scrivibile.</span><span class="sxs-lookup"><span data-stu-id="7fc82-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="7fc82-208">L'azione inversa non è possibile.</span><span class="sxs-lookup"><span data-stu-id="7fc82-208">The reverse action is not possible.</span></span> <span data-ttu-id="7fc82-209">Non è possibile abilitare un gestore di proprietà per la scrittura di una proprietà contrassegnata come di sola lettura nello schema</span><span class="sxs-lookup"><span data-stu-id="7fc82-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="7fc82-210">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="7fc82-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7fc82-211">Informazioni sui gestori delle proprietà</span><span class="sxs-lookup"><span data-stu-id="7fc82-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="7fc82-212">Uso dei nomi dei tipi</span><span class="sxs-lookup"><span data-stu-id="7fc82-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="7fc82-213">Uso degli elenchi di proprietà</span><span class="sxs-lookup"><span data-stu-id="7fc82-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="7fc82-214">Inizializzazione di gestori di proprietà</span><span class="sxs-lookup"><span data-stu-id="7fc82-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="7fc82-215">Registrazione e distribuzione di gestori di proprietà</span><span class="sxs-lookup"><span data-stu-id="7fc82-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
