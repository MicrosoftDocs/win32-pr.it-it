### YamlMime:FAQ
metadata:
  description: Questo articolo include procedure consigliate e domande frequenti sulla creazione e la registrazione di gestori di proprietà da usare con il Windows di proprietà.
  ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
  title: Procedure consigliate e domande frequenti sul gestore delle proprietà
  ms.topic: article
  ms.date: 05/31/2018
  ms.openlocfilehash: 6e1b7d22516b1573562b25f2889b6d1ba703483c
  ms.sourcegitcommit: ecd0ba4732f5264aab9baa2839c11f7fea36318f
  ms.translationtype: MT
  ms.contentlocale: it-IT
  ms.lasthandoff: 07/07/2021
  ms.locfileid: "113483662"
title: Procedure consigliate e domande frequenti sul gestore delle proprietà
summary: >
  Questo argomento illustra come creare e registrare gestori di proprietà da usare con il Windows proprietà.


  Questo argomento è organizzato come segue:


  -   [Procedure consigliate](#best-practices)
      -   [Override delle proprietà del file system](#overriding-file-system-properties)
      -   [Archiviazione di proprietà in formati di file basati su XML](#storing-properties-in-xml-based-file-formats)
      -   [Proprietà calcolate](#computed-properties)
  -   [Domande frequenti](#frequently-asked-questions)

  -   [Argomenti correlati](#related-topics)
sections:
- name: Procedure consigliate
  questions:
  - question: >
      Override delle proprietà del file system
    answer: >
      Alcune proprietà per i file vengono fornite dall'origine file system dati, ad esempio:


      -   PKEY \_ FileName

      -   Estensione \_ PKEY

      -   PKEY \_ ModifiedTime


      In generale, i gestori di proprietà non possono fornire valori per queste proprietà. Tuttavia, in alcuni casi queste proprietà possono essere sottoposte a override in base alle informazioni di registrazione fornite dal gestore delle proprietà. I gestori di proprietà popolano **HKEY \_ CLASSES \_ ROOT** \\ **CLSID** \\ *{handler clsid}* \\ **OverrideFileSystemProperties** con i nomi delle proprietà di cui vogliono eseguire l'override. Questo è limitato a un set fisso di proprietà illustrato nell'elenco seguente di cui il sistema dispone di informazioni.


      L'override di è supportato per i valori di proprietà seguenti:


      -   [System.Kind](./props-system-kind.md)

      -   [System.FileName](./props-system-filename.md)

      -   [System.IsPinnedToNameSpaceTree](./props-system-ispinnedtonamespacetree.md)

      -   [System.ItemNameDisplay](./props-system-itemnamedisplay.md)

      -   [System.SFGAOFlags](./props-system-sfgaoflags.md)

      -   [System.ItemPathDisplay](./props-system-itempathdisplay.md)

      -   [System.ItemPathDisplayNarrow](./props-system-itempathdisplaynarrow.md)

      -   [System.ItemFolderNameDisplay](./props-system-itemfoldernamedisplay.md)

      -   [System.ItemFolderPathDisplay](./props-system-itemfolderpathdisplay.md)

      -   [System.ItemFolderPathDisplayNarrow](./props-system-itemfolderpathdisplaynarrow.md)


      Per un elenco completo di tutte le proprietà della shell, vedere [Proprietà della shell.](./props.md)


      > [!IMPORTANT]

      > I valori delle proprietà sottoposte a override vengono usati solo quando i file vengono indicizzati. Di conseguenza, l'esplorazione dei file file system'origine dati non rivela i valori sottoposti a override.

       
  - question: >
      Archiviazione di proprietà in formati di file basati su XML
    answer: >
      Sono disponibili due opzioni di base per l'archiviazione delle proprietà in formati di file basati su XML:


      -   Archiviare ogni proprietà utilizzando elementi e attributi XML in base all'XML Schema del documento. Questo approccio è più "xml friendly".

      -   Serializzare l'intero archivio delle proprietà in un BLOB (Binary large object) in memoria, convertire il BLOB in una stringa con codifica Base64 e quindi archiviare tale stringa nel codice XML. Questo è il più semplice dei due approcci e può essere usato per fornire in modo semplice il supporto per i metadati aperti.


      Alcuni gestori potrebbero combinare questi approcci, archiviando alcuni valori importanti in formato XML standard e archiviando il resto in un BLOB, ad esempio.
  - question: >
      Proprietà calcolate
    answer: >
      Alcune proprietà derivano da attributi specifici di un file. Ad esempio, la [proprietà System.Image.Dimensions](./props-system-image-dimensions.md) è determinata dalle dimensioni effettive dell'immagine in un file di immagine. Poiché tali valori di proprietà non possono essere modificati dal gestore delle proprietà, vengono contrassegnati `isInnate="true"` nella descrizione della proprietà. Altre proprietà vengono calcolate da una parte di una proprietà specifica o aggregando i valori di più proprietà. Poiché gli aggiornamenti a queste proprietà "calcolate" creerebbe ambiguità sulla modalità di modifica dei valori di "origine", le proprietà calcolate devono essere contrassegnate nella descrizione della proprietà o segnalate come di sola `isInnate="true"` lettura. Quest'ultima opzione è disponibile indicando al gestore di restituire S FALSE da \_ [**IPropertyStoreCapabilities::IsPropertyWritable.**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable)
- name: Domande frequenti
  questions:
  - question: >
      Perché il gestore delle proprietà non viene caricato dall'indicizzatore di Windows ricerca?
    answer: >
      L Windows indicizzatore di Ricerca di Microsoft Windows viene eseguito come servizio di sistema e non è in grado di caricare DLL archiviate nella directory del profilo utente. Se si compila e si esegue il debug usando Microsoft Visual Studio, la DLL verrà posizionata nel profilo utente e pertanto non verrà caricata dall'indicizzatore. Per risolvere questo problema, copiare la DLL all'esterno della cartella del profilo ( ad esempio, in **C: \\ Programmi \\ NomeApp**) e registrarla in tale cartella.


      Per indicazioni più specifiche sullo sviluppo di gestori di proprietà da usare con l'indicizzatore di ricerca Windows, vedere Sviluppo di gestori di proprietà per Windows [Ricerca](../search/-search-3x-wds-extidx-propertyhandlers.md).
  - question: >
      Quali proprietà devono essere individuabili tramite i metodi di enumerazione 'IPropertyStore::GetCount' e 'IPropertyStore::GetAt'?
    answer: "Non tutti i client degli oggetti archivio proprietà usano questi metodi. Alcuni client sono a conoscenza delle proprietà che pianificano di richiedere direttamente (in base al nome PKEY) o di ricevere informazioni sulle proprietà tramite un elenco di descrizione delle proprietà. I metodi di individuazione delle proprietà sopportano diversi altri scenari. Se non è necessario che una proprietà partecipi a questi scenari, non è necessario enumerarla. Di conseguenza, un gestore delle proprietà può produrre un valore non VT EMPTY per le proprietà che non vengono individuate tramite i metodi \\_ [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore::GetAt.**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85))\n\nTuttavia, le proprietà devono essere visibili tramite questi metodi se viene soddisfatta una delle condizioni seguenti:\n\n- **Se la proprietà è indicizzata in modo che sia disponibile per la ricerca:** Ciò significa che è incluso nell'archivio delle Windows ricerca di ricerca (denotato da nello schema di descrizione della proprietà) o disponibile per le ricerche `isColumn = \"true\"` full-text ( `inInvertedIndex = \"true\"` ). In assenza di questi flag o in assenza di una descrizione della proprietà, le proprietà di tipo \"string\" verranno aggiunte automaticamente all'indice invertito per abilitare la ricerca. Poiché l'elenco delle proprietà note (quelle con descrizioni delle proprietà installate) nel sistema di proprietà è molto grande (più di 800 proprietà), sarebbe poco pratico chiedere a ogni gestore delle proprietà per ogni proprietà registrata nel sistema di proprietà. Al contrario, il processo di indicizzazione enumera le proprietà pertinenti dal gestore delle proprietà per ogni elemento indicizzato e usa i valori delle proprietà enumerate per compilare l'indice full-text.\n- **Se la proprietà deve essere copiata quando il set di proprietà dell'elemento è duplicato:** Per implementare una funzione di \"copia di un set di proprietà\", l'elemento di origine rende visibili le proprietà che devono essere copiate tramite i metodi [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore::GetAt.**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) Le proprietà che non devono essere copiate o che non hanno senso essere copiate non devono essere incluse.\n- **Se il valore della proprietà non è vuoto (VT \\_ EMPTY):** i valori delle proprietà vuoti non sono utili per i client. Quando i client tentano di restituire valori di proprietà vuoti, viene restituito un valore VT \\_ EMPTY. Di conseguenza, le proprietà con valori vuoti non devono essere enumerate.\n-   **Se la proprietà deve essere rimossa quando si richiama la funzione \"remove properties\":** Questa funzionalità è disponibile per proteggere la privacy. individua tutti i valori dal gestore delle proprietà tramite l'enumerazione e rimuove ogni valore selezionato per la rimozione da parte dell'utente.\n> [!Note]  \n> L'enumerazione delle proprietà non comunica il set di proprietà supportate da un gestore di proprietà specifico se il gestore supporta uno schema fisso (e non i metadati aperti). Tali gestori devono invece documentare il set di proprietà supportate.\n\n \n"
  - question: >
      Ricerca per categorie quali formati di file supportano i metadati aperti?
    answer: >
      Per informazioni sul supporto per i metadati aperti, vedere "Tipi di file che supportano metadati aperti" in [Tipi di file.](../shell/fa-file-types.md)
  - question: >
      I VT_NULL possono essere archiviati usando un gestore delle proprietà?
    answer: >
      No. I valori NULL VT verranno convertiti in VT EMPTY nelle chiamate \_ \_ a [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) e [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).
  - question: >
      Quali formati di stringa di data sono supportati dalla funzione 'PropVariantChangeType'?
    answer: >
      In genere, le proprietà che rappresentano valori di data/ora devono essere rappresentate usando \_ FILETIME VT. Tuttavia, molte origini dati forniscono queste informazioni in formato stringa. L'API helper [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) supporta la coesistenza di alcuni formati di data stringa in [**valori FILETIME,**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) come illustrato nella tabella seguente.




      | Formato                  | Windows Vista, Windows XP e Microsoft Windows Desktop Search (WDS) | Windows 7 | Note                                                                                                                                                                                                 |

      |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|

      | aaaa/mm/gg:hh:mm:ss.uuu | Sì                                                                   | Sì       | UTC; y=year, m=month, d=date, h=hours (formato a 24 ore), m=minuti, s=secondi, u=microsecondi                                                                                                           |

      | aaaa-mm-ggThh:mm:ssZ    | No                                                                    | Sì       | **Specifica di formato ISO8601** UTC (con l'indicatore del fuso orario 'Z'); y=year, m=month, d=date, h=hours (formato a 24 ore), m=minuti, s=secondi; 'T' è un delimitatore per la parte relativa all'ora.<br/> |
  - question: >
      È possibile creare un gestore di proprietà di sola lettura?
    answer: >
      Sì. Alcune implementazioni del gestore proprietà non supportano la scrittura di valori di proprietà. Questi gestori di proprietà devono restituire STGM E ACCESSDENIED nelle chiamate a \_ \_ **IInitializeXXX::Initialize** che passano STGM READWRITE o in qualsiasi chiamata a \_ [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).


      Tutti i gestori di proprietà aperti in modalità STGM \_ READ devono restituire STGM E ACCESSDENIED nelle chiamate a \_ \_ [**IPropertyStore::SetValue.**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))
  - question: >
      Un gestore di proprietà può considerare una proprietà come di sola lettura, anche se lo schema indica che la proprietà è scrivibile?
    answer: "Sì. Nel sistema di schema le proprietà vengono annotate come di sola lettura (incluse quelle con `isInnate = \"true\"` ) o in lettura/scrittura. I gestori di proprietà che non supportano la scrittura di una particolare proprietà che lo schema indica che deve essere scrivibile devono implementare [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) e restituire S FALSE nelle chiamate a \\_ [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) per tale proprietà. Ciò indica che nel contesto di questo gestore e di questo file la proprietà non è scrivibile.\n\n> [!Note]  \n> L'azione inversa non è possibile. Non è possibile abilitare un gestore delle proprietà per scrivere una proprietà contrassegnata come di sola lettura nello schema\n"
additionalContent: "\n## <a name=\"related-topics\"></a>Argomenti correlati\n\n[Informazioni sui gestori delle proprietà](./building-property-handlers-properties.md)\n\n[Uso dei nomi dei tipi](./building-property-handlers-user-friendly-kind-names.md)\n\n[Uso degli elenchi di proprietà](./building-property-handlers-property-lists.md)\n\n[Inizializzazione dei gestori di proprietà](./building-property-handlers-property-handlers.md)\n\n[Registrazione e distribuzione di gestori di proprietà](./prophand-reg-dist.md)"
