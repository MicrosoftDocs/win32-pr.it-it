---
description: Il sistema di proprietà di Windows è un sistema di lettura/scrittura estendibile di definizioni dei dati che fornisce un modo uniforme per esprimere i metadati sugli elementi della shell.
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: Panoramica del sistema di proprietà
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310106"
---
# <a name="property-system-overview"></a><span data-ttu-id="94575-103">Panoramica del sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="94575-103">Property System Overview</span></span>

<span data-ttu-id="94575-104">Il sistema di proprietà di Windows è un sistema di lettura/scrittura estendibile di definizioni dei dati che fornisce un modo uniforme per esprimere i metadati sugli elementi della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="94575-105">Il sistema di proprietà di Windows in Windows Vista e versioni successive consente di archiviare e recuperare metadati per gli elementi della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="94575-106">Un elemento della shell è costituito da qualsiasi singolo contenuto, ad esempio un file, una cartella, un messaggio di posta elettronica o un contatto.</span><span class="sxs-lookup"><span data-stu-id="94575-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="94575-107">Una proprietà è una singola parte di metadati associata a un elemento della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="94575-108">I valori delle proprietà vengono espressi come una struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="94575-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="94575-109">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="94575-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="94575-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="94575-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="94575-111">Scenari di sviluppo</span><span class="sxs-lookup"><span data-stu-id="94575-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="94575-112">Proprietà e Windows Search</span><span class="sxs-lookup"><span data-stu-id="94575-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="94575-113">Nota per gli implementatori</span><span class="sxs-lookup"><span data-stu-id="94575-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="94575-114">Documentazione del sistema di proprietà di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="94575-115">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="94575-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="94575-116">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="94575-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="94575-117">Introduzione</span><span class="sxs-lookup"><span data-stu-id="94575-117">Introduction</span></span>

<span data-ttu-id="94575-118">Le proprietà vengono identificate in modo univoco in base al nome canonico (ad esempio `System.Document.LastAuthor` ) e alla chiave della proprietà (ad esempio `PKEY_Document_LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="94575-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="94575-119">Una chiave di proprietà (PKEY) è la parte del nome di una coppia nome-valore costituita da un PKEY/PROPVARIANT o da una stringa/PROPVARIANT, in cui la stringa è il nome canonico del PKEY (ad esempio `System.Document.LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="94575-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="94575-120">Un PKEY è una definizione che indica al sistema di proprietà tutto ciò che è necessario conoscere sulla proprietà, mentre il valore è un'istanza effettiva della proprietà.</span><span class="sxs-lookup"><span data-stu-id="94575-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="94575-121">Un PKEY contiene internamente un formatID e propID.</span><span class="sxs-lookup"><span data-stu-id="94575-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="94575-122">Una singola proprietà è costituita dalle tre parti seguenti:</span><span class="sxs-lookup"><span data-stu-id="94575-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="94575-123">Nome canonico, ad esempio `System.Music.Artist` .</span><span class="sxs-lookup"><span data-stu-id="94575-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="94575-124">Descrizione dello schema, specificata nel formato di file XML con estensione propdesc ed espressa a livello di codice tramite [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span><span class="sxs-lookup"><span data-stu-id="94575-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="94575-125">Valore, ad esempio il nome di un cantante.</span><span class="sxs-lookup"><span data-stu-id="94575-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="94575-126">La descrizione dello schema è costituita da informazioni sulla proprietà, ad esempio il nome della proprietà, il tipo di dati, i vincoli, le informazioni sul modo in cui la proprietà interagisce con le visualizzazioni e il sistema di ricerca e così via.</span><span class="sxs-lookup"><span data-stu-id="94575-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="94575-127">Il nome e la descrizione dello schema sono definiti a livello globale e sono gli stessi per tutti gli elementi e i tipi.</span><span class="sxs-lookup"><span data-stu-id="94575-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="94575-128">Un valore è specifico di un singolo elemento.</span><span class="sxs-lookup"><span data-stu-id="94575-128">A value is specific to an individual item.</span></span> <span data-ttu-id="94575-129">Ovvero, la `System.Music.Artist` proprietà è sempre definita come stringa multivalore, ma può avere un valore diverso (o nessun valore) per ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="94575-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="94575-130">Un gestore proprietà converte i dati archiviati in un file in uno schema strutturato riconosciuto da e accessibile da Esplora risorse, Windows Search e altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="94575-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="94575-131">Questi sistemi possono quindi interagire con il gestore delle proprietà per scrivere e leggere le proprietà da e verso il file.</span><span class="sxs-lookup"><span data-stu-id="94575-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="94575-132">I dati tradotti vengono esposti a livello di codice e visualizzati all'utente tramite Esplora risorse in diversi contesti, tra cui la visualizzazione dettagli, infotip, il riquadro dei dettagli, le pagine delle proprietà e così via.</span><span class="sxs-lookup"><span data-stu-id="94575-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="94575-133">Ogni gestore di proprietà è associato a un particolare tipo di file, identificato dall'estensione del nome file.</span><span class="sxs-lookup"><span data-stu-id="94575-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="94575-134">Gli sviluppatori devono implementare un gestore di proprietà che produce e utilizza il formato nativo del tipo di file, ad esempio. jpg o. png, oppure utilizza l'In-Memory archivio delle proprietà, che produce e utilizza il formato binario MS-PROPSTORE.</span><span class="sxs-lookup"><span data-stu-id="94575-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="94575-135">Il sistema di proprietà di Windows crea un modello di dati astratto che fornisce un livello di astrazione dai singoli formati di file.</span><span class="sxs-lookup"><span data-stu-id="94575-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="94575-136">Il modello di dati astratto fornito dal sistema di proprietà di Windows è un metodo per la lettura e la scrittura di un set estensibile di valori denominati associati a un elemento della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="94575-137">L'espressione valore è flessibile, supporta molti tipi di dati ed è estendibile, abilitando i dati arbitrari (**\_ BLOB VT**) e gli oggetti da esprimere come valore.</span><span class="sxs-lookup"><span data-stu-id="94575-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="94575-138">A causa dell'astrazione, è possibile eseguire una query sugli attributi o sui metadati di qualsiasi elemento.</span><span class="sxs-lookup"><span data-stu-id="94575-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="94575-139">Esempi di elementi che possono essere estratti includono Microsoft Office documenti, tag ID3 e AutoCAD e altro software proprietario di terze parti.</span><span class="sxs-lookup"><span data-stu-id="94575-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="94575-140">Analogamente, se si dispone di un file con estensione JPEG, è possibile usare i codec. jpeg e EXIF per leggere i byte del file per individuare le dimensioni dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="94575-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="94575-141">Se invece si dispone di un file con estensione png, è necessario disporre di un codec diverso e di codice diverso.</span><span class="sxs-lookup"><span data-stu-id="94575-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="94575-142">L'utilizzo del sistema di proprietà di Windows evita questo tipo di problema.</span><span class="sxs-lookup"><span data-stu-id="94575-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="94575-143">Se si implementa un nuovo tipo di file, è possibile inserire l'astrazione uniforme offerta dal sistema di proprietà di Windows e specificare la modalità di utilizzo dei metadati.</span><span class="sxs-lookup"><span data-stu-id="94575-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="94575-144">Per questi motivi, è sempre preferibile usare la piattaforma comune fornita dal sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="94575-145">Scenari di sviluppo</span><span class="sxs-lookup"><span data-stu-id="94575-145">Development Scenarios</span></span>

<span data-ttu-id="94575-146">Le proprietà sono espresse dai producer e dagli utenti.</span><span class="sxs-lookup"><span data-stu-id="94575-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="94575-147">In questo contesto, i producer sono gli inventori delle proprietà nel sistema di proprietà di Windows e gli utenti sono applicazioni (e i relativi sviluppatori) che utilizzano le informazioni sulle proprietà di questo sistema.</span><span class="sxs-lookup"><span data-stu-id="94575-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="94575-148">Nella tabella seguente vengono indicati gli utilizzi di e dei partecipanti al sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="94575-149">Uso del sistema di proprietà di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="94575-150">Partecipante</span><span class="sxs-lookup"><span data-stu-id="94575-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="94575-151">Un blocco predefinito che fornisce un registro estensibile di descrizioni delle proprietà, un'implementazione di archivio delle proprietà in memoria e i servizi per l'associazione ai gestori di proprietà, alla conversione di tipi e alla serializzazione degli archivi delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="94575-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="94575-152">Consumer</span><span class="sxs-lookup"><span data-stu-id="94575-152">Consumer</span></span>    |
| <span data-ttu-id="94575-153">Applicazioni che desiderano leggere e scrivere le proprietà in modo astratto.</span><span class="sxs-lookup"><span data-stu-id="94575-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="94575-154">Consumer</span><span class="sxs-lookup"><span data-stu-id="94575-154">Consumer</span></span>    |
| <span data-ttu-id="94575-155">Inventori di proprietà che definiscono nuove proprietà per il sistema di proprietà definendo schemi di proprietà personalizzati e sviluppando i propri gestori di proprietà.</span><span class="sxs-lookup"><span data-stu-id="94575-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="94575-156">Producer</span><span class="sxs-lookup"><span data-stu-id="94575-156">Producer</span></span>    |
| <span data-ttu-id="94575-157">Proprietari del formato di file che desiderano consentire l'accesso alle proprietà archiviate nei formati di file personalizzati.</span><span class="sxs-lookup"><span data-stu-id="94575-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="94575-158">Producer</span><span class="sxs-lookup"><span data-stu-id="94575-158">Producer</span></span>    |



 

<span data-ttu-id="94575-159">I consumer utilizzano proprietà, schemi e gestori di proprietà esistenti.</span><span class="sxs-lookup"><span data-stu-id="94575-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="94575-160">Le proprietà disponibili per l'utilizzo includono le proprietà di lettura/scrittura dai gestori di proprietà per i tipi di file supportati e possono includere anche alcune proprietà personalizzate.</span><span class="sxs-lookup"><span data-stu-id="94575-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="94575-161">Gli schemi disponibili includono almeno lo schema del sistema e talvolta anche altri.</span><span class="sxs-lookup"><span data-stu-id="94575-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="94575-162">Un consumer può creare un'applicazione per utilizzare i metadati e creare una vista basata sull'artista, indipendentemente dalle cartelle in cui sono archiviati gli elementi.</span><span class="sxs-lookup"><span data-stu-id="94575-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="94575-163">La gerarchia di cartelle di file è irrilevante.</span><span class="sxs-lookup"><span data-stu-id="94575-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="94575-164">Ad esempio, è possibile specificare tutti gli elementi del brano da un particolare cantante senza preoccuparsi della posizione di tali elementi.</span><span class="sxs-lookup"><span data-stu-id="94575-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="94575-165">Questo complesso scenario end-to-end non è limitato al sistema di proprietà di Windows, ma prevede diversi componenti, ad esempio le cartelle indicizzazione e ricerca.</span><span class="sxs-lookup"><span data-stu-id="94575-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="94575-166">Gli inventori di proprietà o gli sviluppatori di terze parti sono produttori del sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="94575-167">Quando si prepara la definizione di una nuova proprietà, controllare innanzitutto il set di proprietà definite da Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="94575-168">Se ne viene trovato uno che soddisfi le proprie esigenze, del tipo e della semantica corrispondenti all'uso necessario, usare tale proprietà e non inventarne una nuova.</span><span class="sxs-lookup"><span data-stu-id="94575-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="94575-169">Se si definisce una nuova proprietà personalizzata, provare a ottenere un accordo con altri sviluppatori che desiderano utilizzarlo e pubblicare il risultato del presente contratto in modo che possano partecipare alla community degli utenti di tale proprietà.</span><span class="sxs-lookup"><span data-stu-id="94575-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="94575-170">I produttori possono sfruttare le funzionalità di Esplora risorse di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="94575-171">Se, ad esempio, si sta scrivendo un nuovo formato di immagine e si implementa un gestore di proprietà, il nuovo formato di file diventa disponibile in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="94575-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="94575-172">Gli utenti possono quindi contrassegnare le proprie fotografie e trasformare la propria raccolta di fotografie in base a qualsiasi proprietà nel sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="94575-173">In realtà, qualsiasi operazione eseguita da shell con le proprietà, gli sviluppatori di terze parti possono eseguire nelle proprie applicazioni.</span><span class="sxs-lookup"><span data-stu-id="94575-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="94575-174">Sono inclusi il raggruppamento, l'ordinamento, l'esecuzione di query e la visualizzazione delle proprietà complete.</span><span class="sxs-lookup"><span data-stu-id="94575-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="94575-175">L'esperienza utente fornita da Esplora risorse può essere ampiamente implementata da terze parti con API disponibili pubblicamente.</span><span class="sxs-lookup"><span data-stu-id="94575-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="94575-176">Esplora risorse può essere sostituito o esteso con queste API.</span><span class="sxs-lookup"><span data-stu-id="94575-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="94575-177">Dal punto di vista di un'applicazione che usa il modello di dati della shell, esiste una vasta gamma di scenari che implicano l'uso del sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="94575-178">Le applicazioni di gestione del supporto sono un esempio importante.</span><span class="sxs-lookup"><span data-stu-id="94575-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="94575-179">Gli scenari di sistema di proprietà principali includono scenari come la lettura della proprietà keyword di una fotografia o l'impostazione della proprietà DateTaken.</span><span class="sxs-lookup"><span data-stu-id="94575-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="94575-180">Esempi di scenari di integrazione end-to-end abilitati dal sistema di proprietà di Windows, ma che richiedono la funzione di diversi altri componenti, includono la visualizzazione di tutte le immagini o la ricerca di un documento che contiene una parola chiave.</span><span class="sxs-lookup"><span data-stu-id="94575-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="94575-181">Proprietà e Windows Search</span><span class="sxs-lookup"><span data-stu-id="94575-181">Properties and Windows Search</span></span>

<span data-ttu-id="94575-182">Le proprietà servono sia Producer che consumer quando si interfacciano con la ricerca di Windows e l'indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="94575-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="94575-183">Windows Search include una cache di valori di proprietà utilizzati nell'implementazione di Windows servizio di ricerca (WSS).</span><span class="sxs-lookup"><span data-stu-id="94575-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="94575-184">Questi valori di proprietà possono essere sottoposti a query a livello di codice tramite il provider di OLE DB di ricerca di Windows o tramite [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), che rappresenta gli elementi nei risultati della ricerca e nelle viste basate su query.</span><span class="sxs-lookup"><span data-stu-id="94575-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="94575-185">Windows Search raccoglie e archivia le proprietà generate dai gestori di filtro o dai gestori di proprietà quando un elemento, ad esempio un documento di Word, viene indicizzato.</span><span class="sxs-lookup"><span data-stu-id="94575-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="94575-186">Questo archivio viene eliminato e ricompilato quando l'indice viene ricompilato.</span><span class="sxs-lookup"><span data-stu-id="94575-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="94575-187">Tenere presente che quando si registra nuovamente uno schema, le modifiche apportate agli attributi delle proprietà definite in precedenza potrebbero non essere rispettate dall'indicizzatore.</span><span class="sxs-lookup"><span data-stu-id="94575-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="94575-188">La soluzione consiste nel ricompilare l'indice o introdurre nuove proprietà che riflettono le modifiche anziché aggiornare quelle meno recenti (scelta non consigliata).</span><span class="sxs-lookup"><span data-stu-id="94575-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="94575-189">Per ulteriori informazioni, vedere la [Nota sugli implementatori](#note-to-implementers) più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="94575-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="94575-190">Ad esempio, uno sviluppatore che crea un'applicazione multimediale vuole mostrare agli utenti dell'applicazione tutta la musica disponibile da un particolare artista.</span><span class="sxs-lookup"><span data-stu-id="94575-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="94575-191">L'applicazione fornirà all'utente un elenco di artisti disponibili e quindi genererà un elenco di tutte le musiche disponibili dall'artista selezionato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="94575-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="94575-192">Oppure un utente finale potrebbe voler eseguire una query per? Artist: Beethoven? ed essere esposto all'elenco completo delle proprietà disponibili nel corso della ricerca.</span><span class="sxs-lookup"><span data-stu-id="94575-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="94575-193">Questo esempio prevede l'uso dello spazio dei nomi della shell, dei gestori di proprietà e/o dell'esecuzione di query sull'indice tramite uno dei seguenti elementi:</span><span class="sxs-lookup"><span data-stu-id="94575-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="94575-194">Origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-194">A Shell data source.</span></span>
-   <span data-ttu-id="94575-195">Provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="94575-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="94575-196">Un file di ricerca salvato (. search-ms) usato per avviare una query passando al file di ricerca in Esplora risorse o il binding a [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="94575-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="94575-197">Sebbene la `System.Kind` proprietà non partecipi a questo scenario di applicazione multimediale, può essere usata per compilare una query che restituisce tutti i file. search-ms in un determinato ambito.</span><span class="sxs-lookup"><span data-stu-id="94575-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="94575-198">Il modo migliore per accedere alle API di ricerca e creare applicazioni Windows Search consiste nell'usare un'origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="94575-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) è un componente che consente di creare istanze dell'origine dati della cartella di ricerca, ovvero un tipo di origine dati "virtuale" fornita dalla shell che può eseguire query su altre origini dati nello spazio dei nomi della shell ed enumerare i risultati.</span><span class="sxs-lookup"><span data-stu-id="94575-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="94575-200">Questa operazione può essere eseguita utilizzando l'indicizzatore o enumerando e ispezionando manualmente gli elementi negli ambiti specificati.</span><span class="sxs-lookup"><span data-stu-id="94575-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="94575-201">Gli sviluppatori di terze parti possono creare applicazioni che utilizzano i dati nell'indice tramite query a livello di codice e possono estendere i dati nell'indice per i tipi di file e di elemento personalizzati che devono essere indicizzati da ricerca di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="94575-202">Se si desidera visualizzare i risultati della query in Esplora risorse, è necessario implementare un'origine dati della shell prima di poter creare un gestore di protocollo per estendere l'indice.</span><span class="sxs-lookup"><span data-stu-id="94575-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="94575-203">Tuttavia, se tutte le query saranno programmatiche (tramite OLE DB ad esempio) e interpretate dal codice dell'applicazione? invece che dalla shell, lo spazio dei nomi della shell è comunque preferibile ma non obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="94575-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="94575-204">Un gestore di protocollo è necessario per Windows per ottenere informazioni sul contenuto dei file, ad esempio elementi nei database o tipi di file personalizzati.</span><span class="sxs-lookup"><span data-stu-id="94575-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="94575-205">Sebbene Windows Search possa indicizzare il nome e le proprietà del file, Windows non contiene informazioni sul contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="94575-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="94575-206">Di conseguenza, tali elementi non possono essere indicizzati o esposti nella shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="94575-207">Implementando un gestore di protocollo personalizzato, è possibile esporre questi elementi.</span><span class="sxs-lookup"><span data-stu-id="94575-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="94575-208">Per un elenco di gestori identificato dallo scenario di sviluppo che si sta tentando di ottenere, vedere "Panoramica dei gestori" in [Windows Search come piattaforma di sviluppo](../search/-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="94575-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="94575-209">Un'origine dati della shell è talvolta nota come estensione dello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="94575-210">Un gestore è talvolta noto come estensione della shell o gestore di estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="94575-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="94575-211">Nota per gli implementatori</span><span class="sxs-lookup"><span data-stu-id="94575-211">Note to Implementers</span></span>

<span data-ttu-id="94575-212">A causa di potenziali problemi che l'indicizzatore potrebbe avere quando si utilizza lo schema del sistema di proprietà, è fondamentale definire gli attributi in modo accurato e strategico per il primo rilascio dello schema.</span><span class="sxs-lookup"><span data-stu-id="94575-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="94575-213">Eventuali modifiche apportate agli attributi (tipo, larghezza delle colonne, se indicizzabili) non verranno riflesse nel database dopo che uno schema è stato registrato.</span><span class="sxs-lookup"><span data-stu-id="94575-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="94575-214">L'unico modo per riconoscere queste modifiche dopo che lo schema è stato registrato una volta in un sistema sarebbe ricompilare l'indice e quindi registrare il nuovo schema oppure per registrare lo schema e quindi creare una nuova proprietà per ogni versione successiva; ad esempio `PKEY_GroupName_PropertyNameV2` , `PKEY_GroupName_PropertyNameV3` e così via.</span><span class="sxs-lookup"><span data-stu-id="94575-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="94575-215">Non è consigliabile creare nuove proprietà in questo modo, perché più colonne estranee potrebbero avere conseguenze sulle prestazioni del sistema.</span><span class="sxs-lookup"><span data-stu-id="94575-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="94575-216">Documentazione del sistema di proprietà di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-216">Windows Property System Documentation</span></span>

<span data-ttu-id="94575-217">Il resto della documentazione include le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="94575-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="94575-218">Guida per gli sviluppatori del sistema di proprietà di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="94575-219">Viene descritto in dettaglio come implementare gli scenari di sviluppo principali utilizzando il sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="94575-220">Riferimento al sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="94575-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="94575-221">Documenta le [proprietà di Windows](props.md), lo [schema della descrizione della proprietà](property-description-schema.md), le [interfacce](interfaces.md), le [funzioni](functions.md), le [strutture](structures.md)e le [costanti, le enumerazioni e i flag](constants--enumerations--and-flags.md) del sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="94575-222">Esempi di codice del sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="94575-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="94575-223">Vengono descritti esempi che illustrano come utilizzare il sistema di proprietà di Windows.</span><span class="sxs-lookup"><span data-stu-id="94575-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="94575-224">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="94575-224">Additional Resources</span></span>

-   <span data-ttu-id="94575-225">Per informazioni sul riutilizzo del In-Memory archivio delle proprietà, vedere [inizializzazione di gestori di proprietà](building-property-handlers-property-handlers.md) e [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span><span class="sxs-lookup"><span data-stu-id="94575-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="94575-226">Per una specifica del formato di file binario dell'archivio delle proprietà Microsoft, vedere [ \[ MS \_ PROPSTORE \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span><span class="sxs-lookup"><span data-stu-id="94575-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="94575-227">La relazione tra ricerca e indicizzazione di Windows e come estendere l'indice viene illustrata negli argomenti seguenti in Windows Search:</span><span class="sxs-lookup"><span data-stu-id="94575-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="94575-228">Sviluppo di gestori di filtri per la ricerca di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="94575-229">Sviluppo di gestori di protocollo per Windows Search</span><span class="sxs-lookup"><span data-stu-id="94575-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="94575-230">Sviluppo di gestori di proprietà per Windows Search</span><span class="sxs-lookup"><span data-stu-id="94575-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="94575-231">Per il download di Windows 7 o Windows Vista SDK aggiornato, vedere la [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span><span class="sxs-lookup"><span data-stu-id="94575-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="94575-232">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="94575-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="94575-233">Guida per gli sviluppatori del sistema di proprietà di Windows</span><span class="sxs-lookup"><span data-stu-id="94575-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="94575-234">Riferimento al sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="94575-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="94575-235">Esempi di codice del sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="94575-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
