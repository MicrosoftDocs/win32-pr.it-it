---
description: I consumer temporanei e permanenti hanno metodi diversi per proteggere il recapito degli eventi.
ms.assetid: cd02e5db-f9e2-438b-9632-0a1387a6d4e3
ms.tgt_platform: multiple
title: Ricezione di eventi in modo sicuro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f27d156213553ee17a346d780cbea0ff82beca83
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314586"
---
# <a name="receiving-events-securely"></a><span data-ttu-id="aed3a-103">Ricezione di eventi in modo sicuro</span><span class="sxs-lookup"><span data-stu-id="aed3a-103">Receiving Events Securely</span></span>

<span data-ttu-id="aed3a-104">I consumer temporanei e permanenti hanno metodi diversi per proteggere il recapito degli eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-104">Temporary and permanent consumers have different methods of securing event delivery.</span></span>

<span data-ttu-id="aed3a-105">Le sezioni seguenti sono illustrate in questo argomento:</span><span class="sxs-lookup"><span data-stu-id="aed3a-105">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="aed3a-106">Protezione di consumer temporanei</span><span class="sxs-lookup"><span data-stu-id="aed3a-106">Securing Temporary Consumers</span></span>](#securing-temporary-consumers)
-   [<span data-ttu-id="aed3a-107">Protezione di consumer permanenti</span><span class="sxs-lookup"><span data-stu-id="aed3a-107">Securing Permanent Consumers</span></span>](#securing-permanent-consumers)
-   [<span data-ttu-id="aed3a-108">Protezione della sottoscrizione permanente</span><span class="sxs-lookup"><span data-stu-id="aed3a-108">Securing the Permanent Subscription</span></span>](#securing-the-permanent-subscription)
-   [<span data-ttu-id="aed3a-109">Impostazione di un Administrator-Only SD</span><span class="sxs-lookup"><span data-stu-id="aed3a-109">Setting an Administrator-Only SD</span></span>](#setting-an-administrator-only-sd)
-   [<span data-ttu-id="aed3a-110">Rappresentazione dell'identità del provider di eventi</span><span class="sxs-lookup"><span data-stu-id="aed3a-110">Impersonating the Event Provider Identity</span></span>](#impersonating-the-event-provider-identity)
-   [<span data-ttu-id="aed3a-111">SID e sottoscrizioni permanenti</span><span class="sxs-lookup"><span data-stu-id="aed3a-111">SIDs and Permanent Subscriptions</span></span>](#sids-and-permanent-subscriptions)
-   [<span data-ttu-id="aed3a-112">Creazione di sottoscrizioni permanenti tramite account di dominio</span><span class="sxs-lookup"><span data-stu-id="aed3a-112">Creating Permanent Subscriptions Using Domain Accounts</span></span>](#creating-permanent-subscriptions-using-domain-accounts)
-   [<span data-ttu-id="aed3a-113">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="aed3a-113">Related topics</span></span>](#related-topics)

## <a name="securing-temporary-consumers"></a><span data-ttu-id="aed3a-114">Protezione di consumer temporanei</span><span class="sxs-lookup"><span data-stu-id="aed3a-114">Securing Temporary Consumers</span></span>

<span data-ttu-id="aed3a-115">Un [*consumer temporaneo*](gloss-t.md) viene eseguito fino al riavvio del sistema o all'arresto di WMI, ma non può essere avviato se viene generato un evento specifico.</span><span class="sxs-lookup"><span data-stu-id="aed3a-115">A [*temporary consumers*](gloss-t.md) runs until the system is rebooted or WMI is stopped but cannot be started if a specific event is raised.</span></span> <span data-ttu-id="aed3a-116">Ad esempio, una chiamata a [**SWbemServices.ExecNotificationQueryAsync**](swbemservices-execnotificationqueryasync.md) crea un consumer temporaneo.</span><span class="sxs-lookup"><span data-stu-id="aed3a-116">For example, a call to [**SWbemServices.ExecNotificationQueryAsync**](swbemservices-execnotificationqueryasync.md) creates a temporary consumer.</span></span>

<span data-ttu-id="aed3a-117">Chiama [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) o [**IWbemServices:: ExecNotificationQuery**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-execnotificationquery) crea consumer di eventi temporanei.</span><span class="sxs-lookup"><span data-stu-id="aed3a-117">The calls [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) or [**IWbemServices::ExecNotificationQuery**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-execnotificationquery) create temporary event consumers.</span></span> <span data-ttu-id="aed3a-118">I consumer temporanei non possono controllare chi fornisce eventi al [*sink*](gloss-s.md) di evento che crea.</span><span class="sxs-lookup"><span data-stu-id="aed3a-118">Temporary consumers cannot control who provides events to the event [*sink*](gloss-s.md) they create.</span></span>

<span data-ttu-id="aed3a-119">Le chiamate ai metodi [**ExecNotificationQuery**](swbemservices-execnotificationquery.md) possono essere eseguite in modo sincrono, [*semisincrona*](gloss-s.md)o in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="aed3a-119">Calls to [**ExecNotificationQuery**](swbemservices-execnotificationquery.md) methods can be made synchronously, [*semisynchronously*](gloss-s.md), or asynchronously.</span></span> <span data-ttu-id="aed3a-120">Ad esempio, [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) è un metodo sincrono che può essere chiamato semisincrona, a seconda della modalità con cui viene impostato il parametro *iFlags* .</span><span class="sxs-lookup"><span data-stu-id="aed3a-120">For example, [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) is a synchronous method that can be called semisynchronously, depending on how the *iflags* parameter is set.</span></span> <span data-ttu-id="aed3a-121">[**SWbemServices.ExecNotificationQueryAsync**](swbemservices-execnotificationqueryasync.md) è una chiamata asincrona.</span><span class="sxs-lookup"><span data-stu-id="aed3a-121">[**SWbemServices.ExecNotificationQueryAsync**](swbemservices-execnotificationqueryasync.md) is an asynchronous call.</span></span>

<span data-ttu-id="aed3a-122">Tenere presente che il callback al sink per le versioni asincrone di queste chiamate potrebbe non essere restituito allo stesso livello di autenticazione della chiamata eseguita dallo script.</span><span class="sxs-lookup"><span data-stu-id="aed3a-122">Be aware that the callback to the sink for the asynchronous versions of these calls might not be returned at the same authentication level as the call the script made.</span></span> <span data-ttu-id="aed3a-123">È pertanto consigliabile utilizzare semisincrono anziché le chiamate asincrone.</span><span class="sxs-lookup"><span data-stu-id="aed3a-123">Therefore, it is recommended that you use semisynchronous instead of asynchronous calls.</span></span> <span data-ttu-id="aed3a-124">Se è necessaria la comunicazione asincrona, vedere [chiamata di un metodo](calling-a-method.md) e [impostazione della sicurezza in una chiamata asincrona](setting-security-on-an-asynchronous-call.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-124">If you require asynchronous communication, see [Calling a Method](calling-a-method.md) and [Setting Security on an Asynchronous Call](setting-security-on-an-asynchronous-call.md).</span></span>

<span data-ttu-id="aed3a-125">I sottoscrittori di scripting non possono verificare i diritti di accesso di un provider di eventi per fornire eventi al sink creato dallo script.</span><span class="sxs-lookup"><span data-stu-id="aed3a-125">Scripting subscribers cannot check the access rights of an event provider to provide events to the sink created by the script.</span></span> <span data-ttu-id="aed3a-126">È quindi consigliabile che le chiamate a [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) usino il form semisincrono della chiamata e usino impostazioni di sicurezza specifiche.</span><span class="sxs-lookup"><span data-stu-id="aed3a-126">Therefore, it is recommended that calls to [**SWbemServices.ExecNotificationQuery**](swbemservices-execnotificationquery.md) use the semisynchronous form of the call and use specific security settings.</span></span> <span data-ttu-id="aed3a-127">Per ulteriori informazioni, vedere [creazione di una chiamata semisincrono con VBScript](making-a-semisynchronous-call-with-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-127">For more information, see [Making a Semisynchronous Call with VBScript](making-a-semisynchronous-call-with-vbscript.md).</span></span>

## <a name="securing-permanent-consumers"></a><span data-ttu-id="aed3a-128">Protezione di consumer permanenti</span><span class="sxs-lookup"><span data-stu-id="aed3a-128">Securing Permanent Consumers</span></span>

<span data-ttu-id="aed3a-129">Un [*consumer permanente*](gloss-p.md) ha una sottoscrizione permanente agli eventi di un provider di eventi che verrà mantenuto dopo il riavvio del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="aed3a-129">A [*permanent consumers*](gloss-p.md) has a permanent subscription to events from an event provider that will persist after the operating system is restarted.</span></span> <span data-ttu-id="aed3a-130">Un provider di eventi che supporta gli utenti permanenti è un [*provider di consumer di eventi*](gloss-e.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-130">An event provider that supports permanent consumers is a [*event consumer provider*](gloss-e.md).</span></span> <span data-ttu-id="aed3a-131">Se il provider di eventi non è in esecuzione quando si verifica un evento, WMI avvia il provider quando è necessario recapitare gli eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-131">If the event provider is not running when an event occurs, then WMI starts the provider when it needs to deliver events.</span></span> <span data-ttu-id="aed3a-132">WMI identifica il provider di consumer a cui devono essere recapitati gli eventi, in base all'istanza di [**\_ \_ EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) , che associa l'istanza [**\_ \_ Win32Provider**](--win32provider.md) del provider consumer a una [*classe consumer logica*](gloss-l.md) definita dal provider consumer.</span><span class="sxs-lookup"><span data-stu-id="aed3a-132">WMI identifies which consumer provider the events should be delivered to, based on the [**\_\_EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) instance, which associates the consumer provider [**\_\_Win32Provider**](--win32provider.md) instance with a [*logical consumer class*](gloss-l.md) defined by the consumer provider.</span></span> <span data-ttu-id="aed3a-133">Per ulteriori informazioni sul ruolo dei provider di consumer, vedere [scrittura di un provider di consumer di eventi](writing-an-event-consumer-provider.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-133">For more information about the role of consumer providers, see [Writing an Event Consumer Provider](writing-an-event-consumer-provider.md).</span></span>

<span data-ttu-id="aed3a-134">I consumer permanenti possono controllare chi li invia e i provider di eventi possono controllare chi accede agli eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-134">Permanent consumers can control who sends them events and event providers can control who accesses their events.</span></span>

<span data-ttu-id="aed3a-135">Gli script client e le applicazioni creano istanze della classe consumer logica come parte di una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="aed3a-135">Client scripts and applications create instances of the logical consumer class as part of a subscription.</span></span> <span data-ttu-id="aed3a-136">La classe consumer logica definisce le informazioni contenute nell'evento, le operazioni che il client può eseguire con l'evento e il modo in cui viene recapitato l'evento.</span><span class="sxs-lookup"><span data-stu-id="aed3a-136">The logical consumer class defines what information the event contains, what the client can do with the event, and how the event is delivered.</span></span>

<span data-ttu-id="aed3a-137">Le [classi consumer standard](standard-consumer-classes.md) WMI forniscono esempi del ruolo delle classi consumer logiche.</span><span class="sxs-lookup"><span data-stu-id="aed3a-137">The WMI [Standard Consumer Classes](standard-consumer-classes.md) provide examples of the role of logical consumer classes.</span></span> <span data-ttu-id="aed3a-138">Per altre informazioni, vedere [monitoraggio e risposta agli eventi con consumer standard](monitoring-and-responding-to-events-with-standard-consumers.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-138">For more information, see [Monitoring and Responding to Events with Standard Consumers](monitoring-and-responding-to-events-with-standard-consumers.md).</span></span>

## <a name="securing-the-permanent-subscription"></a><span data-ttu-id="aed3a-139">Protezione della sottoscrizione permanente</span><span class="sxs-lookup"><span data-stu-id="aed3a-139">Securing the Permanent Subscription</span></span>

<span data-ttu-id="aed3a-140">Le sottoscrizioni permanenti hanno maggiori possibilità di causare problemi di sicurezza in WMI e pertanto presentano i requisiti di sicurezza seguenti:</span><span class="sxs-lookup"><span data-stu-id="aed3a-140">Permanent subscriptions have greater potential to cause security problems in WMI and therefore have the following security requirements:</span></span>

-   <span data-ttu-id="aed3a-141">L'istanza del consumer logico, le istanze [**\_ \_ EventFilter**](--eventfilter.md)e [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md) devono avere lo stesso ID di sicurezza (SID) singolo nella proprietà **CreatorSID** .</span><span class="sxs-lookup"><span data-stu-id="aed3a-141">The logical consumer instance, the [**\_\_EventFilter**](--eventfilter.md), and the [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md) instances must have the same individual security identifier (SID) in the **CreatorSID** property.</span></span> <span data-ttu-id="aed3a-142">Per altre informazioni, vedere [mantenere lo stesso SID in tutte le istanze di una sottoscrizione permanente](#sids-and-permanent-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="aed3a-142">For more information, see [Keeping the same SID in all instances of a permanent subscription](#sids-and-permanent-subscriptions).</span></span>
-   <span data-ttu-id="aed3a-143">L'account che crea la sottoscrizione deve essere un account di dominio con privilegi di amministratore locale o l'account del gruppo Administrators locale.</span><span class="sxs-lookup"><span data-stu-id="aed3a-143">The account that creates the subscription must be either a domain account with local administrator privileges or the local Administrators group account.</span></span> <span data-ttu-id="aed3a-144">L'utilizzo del SID del gruppo Administrators consente alla sottoscrizione di continuare a lavorare nel computer locale, anche se è disconnesso dalla rete.</span><span class="sxs-lookup"><span data-stu-id="aed3a-144">Using the Administrators group SID allows the subscription to continue to work on the local computer, even if it is disconnected from the network.</span></span> <span data-ttu-id="aed3a-145">L'utilizzo di un account di dominio consente l'identificazione esatta dell'utente.</span><span class="sxs-lookup"><span data-stu-id="aed3a-145">Using a domain account allows exact identification of the user.</span></span>

    <span data-ttu-id="aed3a-146">Tuttavia, se il computer non è connesso e l'account di creazione è un account di dominio, il consumer non riesce perché WMI non è in grado di verificare l'identità dell'account.</span><span class="sxs-lookup"><span data-stu-id="aed3a-146">However, if the computer is not connected and the creating account is a domain account, the consumer fails because WMI cannot verify the identity of the account.</span></span> <span data-ttu-id="aed3a-147">Per evitare errori di sottoscrizione se il computer è disconnesso dalla rete, utilizzare il SID del gruppo Administrators per una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="aed3a-147">To avoid subscription failure if the computer is disconnected from the network, use the Administrators group SID for a subscription.</span></span> <span data-ttu-id="aed3a-148">In tal caso, è necessario assicurarsi che l'account LocalSystem possa accedere ai dati di appartenenza a gruppi nel dominio.</span><span class="sxs-lookup"><span data-stu-id="aed3a-148">In this case, you should ensure that the LocalSystem account can access group membership data on the domain.</span></span> <span data-ttu-id="aed3a-149">Alcuni provider di consumer di eventi hanno requisiti di sicurezza particolarmente elevati, perché una sottoscrizione non autorizzata può causare gravi danni.</span><span class="sxs-lookup"><span data-stu-id="aed3a-149">Some event consumer providers have particularly high security requirements, since a rogue subscription can cause great damage.</span></span> <span data-ttu-id="aed3a-150">Gli esempi sono gli utenti standard, [**ActiveScriptEventConsumer**](activescripteventconsumer.md) e [**CommandLineEventConsumer**](commandlineeventconsumer.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-150">Examples are the standard consumers, [**ActiveScriptEventConsumer**](activescripteventconsumer.md) and [**CommandLineEventConsumer**](commandlineeventconsumer.md).</span></span>

-   <span data-ttu-id="aed3a-151">È possibile configurare la sottoscrizione permanente in modo da accettare solo gli eventi da identità specifiche del provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-151">You can configure the permanent subscription to only accept events from specific event provider identities.</span></span> <span data-ttu-id="aed3a-152">Impostare il descrittore di sicurezza nella proprietà **EventAccess** dell'istanza [**\_ \_ EventFilter**](--eventfilter.md) sulle identità del provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-152">Set the security descriptor in the **EventAccess** property of the [**\_\_EventFilter**](--eventfilter.md) instance to the event provider identities.</span></span> <span data-ttu-id="aed3a-153">Tramite WMI viene confrontata l'identità del provider di eventi con il descrittore di sicurezza per determinare se il provider ha l'accesso a destra per la **\_ \_ pubblicazione** .</span><span class="sxs-lookup"><span data-stu-id="aed3a-153">WMI compares the identity of the event provider to the security descriptor to determine if the provider has **WBEM\_RIGHT\_PUBLISH** access.</span></span> <span data-ttu-id="aed3a-154">Per ulteriori informazioni, vedere la pagina relativa alle [costanti di sicurezza WMI](wmi-security-constants.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-154">For more information, see [WMI Security Constants](wmi-security-constants.md).</span></span>

    <span data-ttu-id="aed3a-155">Se il filtro consente l'accesso all'identità del provider di eventi, viene considerato attendibile anche l'evento.</span><span class="sxs-lookup"><span data-stu-id="aed3a-155">If the filter allows access to the event provider identity, then it also trusts the event.</span></span> <span data-ttu-id="aed3a-156">Ciò consente al consumer che ha ricevuto l'evento di generare un evento delegato.</span><span class="sxs-lookup"><span data-stu-id="aed3a-156">This allows the consumer that received the event to raise a delegated event.</span></span>

    <span data-ttu-id="aed3a-157">**Nota**  Il valore predefinito per il descrittore di sicurezza in **EventAccess** è **null**, che consente l'accesso a tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="aed3a-157">**Note**  The default for the security descriptor in **EventAccess** is **NULL**, which allows access to everyone.</span></span> <span data-ttu-id="aed3a-158">La limitazione dell'accesso nell'istanza di sottoscrizione di [**\_ \_ EventFilter**](--eventfilter.md) è consigliata per una migliore sicurezza degli eventi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-158">Limiting access in the subscription instance of [**\_\_EventFilter**](--eventfilter.md) is recommended for better event security.</span></span>

## <a name="setting-an-administrator-only-sd"></a><span data-ttu-id="aed3a-159">Impostazione di un Administrator-Only SD</span><span class="sxs-lookup"><span data-stu-id="aed3a-159">Setting an Administrator-Only SD</span></span>

<span data-ttu-id="aed3a-160">Nell'esempio di codice C++ riportato di seguito viene creato un descrittore di sicurezza solo amministratore nell'istanza [**\_ \_ EventFilter**](--eventfilter.md) .</span><span class="sxs-lookup"><span data-stu-id="aed3a-160">The following C++ code example creates an administrator-only security descriptor on the [**\_\_EventFilter**](--eventfilter.md) instance.</span></span> <span data-ttu-id="aed3a-161">In questo esempio viene creato il descrittore di sicurezza utilizzando il linguaggio SDDL ( [Security Descriptor Definition Language](/windows/desktop/SecAuthZ/security-descriptor-definition-language) ).</span><span class="sxs-lookup"><span data-stu-id="aed3a-161">This example creates the security descriptor using [Security Descriptor Definition Language](/windows/desktop/SecAuthZ/security-descriptor-definition-language) (SDDL).</span></span> <span data-ttu-id="aed3a-162">Per ulteriori informazioni sulla **\_ \_ sottoscrizione a destra di WBEM**, vedere la pagina relativa alle costanti di [sicurezza WMI](wmi-security-constants.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-162">For more information about **WBEM\_RIGHT\_SUBSCRIBE**, see [WMI Security Constants](wmi-security-constants.md).</span></span>


```C++
// Create SD that allows only administrators 
//    to send events to this filter. 
// The SDDL settings are O:BAG:BAD:(A;;0x80;;;BA)
// Set the EventAccess property in the 
//    IWbemClassObject of the __EventFilter instance. 
   long lMask = WBEM_RIGHT_PUBLISH;
     WCHAR wBuf[MAX_PATH];
     _ltow( lMask, wBuf, 16 );
 
HRESULT hRes = pEventFilterInstance->Put( L"EventAccess", 0,
    &_variant_t( L"O:BAG:BAD:(A;;0x80;;;BA)" ), NULL );
```



<span data-ttu-id="aed3a-163">Nell'esempio di codice precedente sono richieste le seguenti \# istruzioni Reference e include.</span><span class="sxs-lookup"><span data-stu-id="aed3a-163">The previous code example requires the following reference and \#include statements.</span></span>


```C++
#define _WIN32_DCOM
#include <wbemidl.h>
#include <comdef.h>

#pragma comment(lib, "wbemuuid.lib")
```



## <a name="impersonating-the-event-provider-identity"></a><span data-ttu-id="aed3a-164">Rappresentazione dell'identità del provider di eventi</span><span class="sxs-lookup"><span data-stu-id="aed3a-164">Impersonating the Event Provider Identity</span></span>

<span data-ttu-id="aed3a-165">Un consumer permanente potrebbe dover rappresentare il provider di eventi per elaborare l'evento.</span><span class="sxs-lookup"><span data-stu-id="aed3a-165">A permanent consumer may need to impersonate the event provider to process the event.</span></span> <span data-ttu-id="aed3a-166">I consumer permanenti possono rappresentare il provider di eventi solo quando sussistono le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="aed3a-166">Permanent consumers can only impersonate the event provider when the following conditions exist:</span></span>

-   <span data-ttu-id="aed3a-167">L'istanza di [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md) ha la proprietà **MaintainSecurityContext** impostata su **true**.</span><span class="sxs-lookup"><span data-stu-id="aed3a-167">The instance of [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md) has the **MaintainSecurityContext** property set to **True**.</span></span>
-   <span data-ttu-id="aed3a-168">Un evento viene recapitato nello stesso contesto di sicurezza in cui si trovava il provider durante la generazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="aed3a-168">An event is delivered in the same security context that the provider was in when it generated the event.</span></span> <span data-ttu-id="aed3a-169">Solo un consumer implementato come DLL, un consumer in-process, può ricevere eventi nel contesto di sicurezza del provider.</span><span class="sxs-lookup"><span data-stu-id="aed3a-169">Only a consumer implemented as a DLL, an in-process consumer, can receive events in the security context of the provider.</span></span> <span data-ttu-id="aed3a-170">Per ulteriori informazioni sulla sicurezza dei provider e dei consumer in-process, vedere [hosting e sicurezza del provider](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="aed3a-170">For more information about security of in-process providers and consumers, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>
-   <span data-ttu-id="aed3a-171">Il provider di eventi viene eseguito in un processo che consente la rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="aed3a-171">The event provider is running in a process that allows impersonation.</span></span>

<span data-ttu-id="aed3a-172">L'account che esegue il processo consumer deve avere accesso in **\_ scrittura completo** al repository WMI (noto anche come repository CIM).</span><span class="sxs-lookup"><span data-stu-id="aed3a-172">The account running the consumer process must have **FULL\_WRITE** access to the WMI repository (also known as the CIM repository).</span></span> <span data-ttu-id="aed3a-173">Nella sottoscrizione, le istanze [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md), [**\_ \_ EventConsumer**](--eventconsumer.md)e [**\_ \_ EventFilter**](--eventfilter.md) devono avere lo stesso valore SID (Single Security Identifier) nella proprietà **CreatorSID** .</span><span class="sxs-lookup"><span data-stu-id="aed3a-173">In the subscription, the [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md), [**\_\_EventConsumer**](--eventconsumer.md), and [**\_\_EventFilter**](--eventfilter.md) instances must have the same individual security identifier (SID) value in the **CreatorSID** property.</span></span> <span data-ttu-id="aed3a-174">WMI archivia il SID in **CreatorSID** per ogni istanza.</span><span class="sxs-lookup"><span data-stu-id="aed3a-174">WMI stores the SID in the **CreatorSID** for each instance.</span></span>

## <a name="sids-and-permanent-subscriptions"></a><span data-ttu-id="aed3a-175">SID e sottoscrizioni permanenti</span><span class="sxs-lookup"><span data-stu-id="aed3a-175">SIDs and Permanent Subscriptions</span></span>

<span data-ttu-id="aed3a-176">Una sottoscrizione permanente non funziona quando l'associazione, il consumer e il filtro non vengono creati dallo stesso utente, il che significa che [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md), [**\_ \_ EventConsumer**](--eventconsumer.md)e [**\_ \_ EventFilter**](--eventfilter.md) devono avere lo stesso valore SID (Single Security Identifier) della proprietà **CreatorSID** .</span><span class="sxs-lookup"><span data-stu-id="aed3a-176">A permanent subscription does not work when the binding, the consumer, and the filter are not created by the same user, which means that the [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md), [**\_\_EventConsumer**](--eventconsumer.md), and [**\_\_EventFilter**](--eventfilter.md) must have the same individual security identifier (SID) value in the **CreatorSID** property.</span></span> <span data-ttu-id="aed3a-177">In Strumentazione gestione Windows (WMI) viene archiviato questo valore.</span><span class="sxs-lookup"><span data-stu-id="aed3a-177">Windows Management Instrumentation (WMI) stores this value.</span></span>

## <a name="creating-permanent-subscriptions-using-domain-accounts"></a><span data-ttu-id="aed3a-178">Creazione di sottoscrizioni permanenti tramite account di dominio</span><span class="sxs-lookup"><span data-stu-id="aed3a-178">Creating Permanent Subscriptions Using Domain Accounts</span></span>

<span data-ttu-id="aed3a-179">Quando si utilizzano account di dominio per creare sottoscrizioni permanenti, è necessario considerare diversi problemi.</span><span class="sxs-lookup"><span data-stu-id="aed3a-179">Several issues must be considered when using domain accounts to create permanent subscriptions.</span></span> <span data-ttu-id="aed3a-180">Ogni sottoscrizione permanente dovrebbe continuare a funzionare quando nessun utente è connesso, il che significa che funzionano con l'account LocalSystem incorporato.</span><span class="sxs-lookup"><span data-stu-id="aed3a-180">Every permanent subscription should still work when no user is logged on, which means they function under the built-in LocalSystem account.</span></span>

<span data-ttu-id="aed3a-181">Se un utente di dominio è il creatore di una sottoscrizione permanente per i consumer sensibili alla sicurezza ([**ActiveScriptEventConsumer**](activescripteventconsumer.md), [**CommandLineEventConsumer**](commandlineeventconsumer.md)), WMI verifica se la proprietà **CreatorSID** della classe [**\_ \_ EventFilter**](--eventfilter.md) , la classe [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md) e le istanze del consumer appartengono a un utente che è membro del gruppo Administrators locale.</span><span class="sxs-lookup"><span data-stu-id="aed3a-181">If a domain user is the creator of a permanent subscription for security sensitive consumers ([**ActiveScriptEventConsumer**](activescripteventconsumer.md), [**CommandLineEventConsumer**](commandlineeventconsumer.md)), then WMI verifies whether the **CreatorSID** property of the [**\_\_EventFilter**](--eventfilter.md) class, [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md) class, and the consumer instances belong to a user who is member of local Administrators group.</span></span>

<span data-ttu-id="aed3a-182">Nell'esempio di codice riportato di seguito viene illustrato come è possibile specificare la proprietà **CreatorSID** .</span><span class="sxs-lookup"><span data-stu-id="aed3a-182">The following code example shows how you can specify the **CreatorSID** property.</span></span>

``` syntax
 instance of __EventFilter as $FILTER
    {
        // this is the Administrators SID in array of bytes format
        CreatorSID = {1,2,0,0,0,0,0,5,32,0,0,0,32,2,0,0};    
        // Add filter code here ...
    }

    instance of ActiveScriptEventConsumer as $CONSUMER
    {
       CreatorSID = {1,2,0,0,0,0,0,5,32,0,0,0,32,2,0,0};
       // Add consumer code here ...
    }

    instance of __FilterToConsumerBinding
    {
       CreatorSID = {1,2,0,0,0,0,0,5,32,0,0,0,32,2,0,0};
       Consumer = $CONSUMER;
       Filter = $FILTER;
       // Add binding code here ...
    }
```

<span data-ttu-id="aed3a-183">Per le situazioni tra domini, aggiungere utenti autenticati al gruppo di accesso di autorizzazione Windows.</span><span class="sxs-lookup"><span data-stu-id="aed3a-183">For cross domain situations, add Authenticated Users to the "Windows Authorization Access Group".</span></span>

## <a name="related-topics"></a><span data-ttu-id="aed3a-184">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="aed3a-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="aed3a-185">Protezione degli eventi WMI</span><span class="sxs-lookup"><span data-stu-id="aed3a-185">Securing WMI Events</span></span>](securing-wmi-events.md)
</dt> <dt>

[<span data-ttu-id="aed3a-186">Ricezione di un evento WMI</span><span class="sxs-lookup"><span data-stu-id="aed3a-186">Receiving a WMI Event</span></span>](receiving-a-wmi-event.md)
</dt> </dl>

 

 
