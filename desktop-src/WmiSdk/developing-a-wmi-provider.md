---
description: Un provider è un oggetto Component Object Model (COM) che funge da intermediario tra WMI e un oggetto gestito.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Sviluppo di un provider WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9249c251f75f08f9e5142e70a507b0dced8f91df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310373"
---
# <a name="developing-a-wmi-provider"></a><span data-ttu-id="a8f92-103">Sviluppo di un provider WMI</span><span class="sxs-lookup"><span data-stu-id="a8f92-103">Developing a WMI Provider</span></span>

<span data-ttu-id="a8f92-104">Un provider è un oggetto Component Object Model (COM) che funge da intermediario tra WMI e un oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="a8f92-104">A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object.</span></span> <span data-ttu-id="a8f92-105">Ad esempio, quando un'applicazione o uno script richiede dati del disco utilizzando la classe WMI [**Win32 \_ disco logico**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) , i dati vengono ottenuti in modo dinamico tramite il [provider Win32](/windows/desktop/CIMWin32Prov/win32-provider)preinstallato.</span><span class="sxs-lookup"><span data-stu-id="a8f92-105">For example, when an application or script requests disk data using the WMI [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class, the data is obtained dynamically through the preinstalled [Win32 provider](/windows/desktop/CIMWin32Prov/win32-provider).</span></span>

<span data-ttu-id="a8f92-106">Se si desidera fornire dati tramite WMI ad altre applicazioni, è possibile creare un provider di codice non gestito scrivendo un server COM o tramite le **procedure guidate di WMI ATL** in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a8f92-106">If you want to supply data through WMI to other applications, you can create an unmanaged code provider by writing a COM server or through the **WMI ATL wizards** in Visual Studio.</span></span> <span data-ttu-id="a8f92-107">È possibile scrivere un provider di codice gestito utilizzando WMI nel .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a8f92-107">You can write a managed code provider by using WMI in the .NET Framework.</span></span> <span data-ttu-id="a8f92-108">Negli argomenti di questa sezione viene descritto il processo di scrittura di un provider COM non gestito.</span><span class="sxs-lookup"><span data-stu-id="a8f92-108">The topics in this section describe the process of writing an unmanaged COM provider.</span></span>

> [!Note]  
> <span data-ttu-id="a8f92-109">Per assicurarsi che tutte le definizioni delle classi WMI per gli oggetti gestiti vengano ripristinate nel [*repository WMI*](gloss-w.md) se WMI presenta un errore e viene riavviato, usare l'istruzione del preprocessore [**\# pragma autocover**](pragma-autorecover.md) nel file Managed Object Format (MOF).</span><span class="sxs-lookup"><span data-stu-id="a8f92-109">To ensure that all of your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your Managed Object Format (MOF) file.</span></span>

 

<span data-ttu-id="a8f92-110">Un provider è costituito da classi definite nello schema [*Managed Object Format (MOF)*](gloss-m.md) e da un file dll che esegue le funzioni del provider.</span><span class="sxs-lookup"><span data-stu-id="a8f92-110">A provider consists of classes defined in the [*Managed Object Format (MOF)*](gloss-m.md) schema and a DLL file which carries out the functions of the provider.</span></span> <span data-ttu-id="a8f92-111">Ad esempio, il file MOF che definisce le classi del provider Win32 è CIMWin32. mof e la DLL è CIMWin32.dll, entrambi sono presenti in% windir% \\ system32 \\ WBEM.</span><span class="sxs-lookup"><span data-stu-id="a8f92-111">For example, the MOF that defines the classes of the Win32 provider is CIMWin32.mof and the DLL is CIMWin32.dll, both are found in %windir%\\System32\\Wbem.</span></span>

<span data-ttu-id="a8f92-112">Lo schema MOF per il provider può contenere diversi tipi di provider.</span><span class="sxs-lookup"><span data-stu-id="a8f92-112">The MOF schema for the provider may contain several provider types.</span></span> <span data-ttu-id="a8f92-113">Ad esempio, il [provider di log eventi](/previous-versions/windows/desktop/eventlogprov/event-log-provider) dispone di tipi di istanza, metodo e provider di eventi in un file MOF denominato ntevt. mof.</span><span class="sxs-lookup"><span data-stu-id="a8f92-113">For example, the [Event Log Provider](/previous-versions/windows/desktop/eventlogprov/event-log-provider) has instance, method, and event provider types in one MOF file named Ntevt.mof.</span></span> <span data-ttu-id="a8f92-114">È consigliabile che tutte le classi e lo schema di registrazione per i provider correlati vengano assemblati in un unico file, anziché creare un file per classe.</span><span class="sxs-lookup"><span data-stu-id="a8f92-114">It is recommended that all of the classes and registration schema for related providers be assembled in one file, rather than creating one file per class.</span></span>

<span data-ttu-id="a8f92-115">Oltre a usare i provider preinstallati, è possibile creare un provider personalizzato per fornire informazioni su un dispositivo hardware o sulle operazioni del software.</span><span class="sxs-lookup"><span data-stu-id="a8f92-115">In addition to using preinstalled providers, you can create your own provider to supply information about a hardware device or the operations of software.</span></span>

<span data-ttu-id="a8f92-116">Nella tabella seguente sono elencate le attività di base per la creazione di un provider.</span><span class="sxs-lookup"><span data-stu-id="a8f92-116">The following table lists the basic tasks that create a provider.</span></span>



| <span data-ttu-id="a8f92-117">Attività</span><span class="sxs-lookup"><span data-stu-id="a8f92-117">Task</span></span>                                                                                                                                                            | <span data-ttu-id="a8f92-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a8f92-118">Description</span></span>                                                                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a8f92-119">Progettazione di classi Managed Object Format (MOF)</span><span class="sxs-lookup"><span data-stu-id="a8f92-119">Designing Managed Object Format (MOF) Classes</span></span>](designing-managed-object-format--mof--classes.md)                                                              | <span data-ttu-id="a8f92-120">Sviluppare un modello per le entità che si desidera gestire tramite WMI e creare un file di Managed Object Format (MOF) per descrivere lo schema.</span><span class="sxs-lookup"><span data-stu-id="a8f92-120">Develop a model for the entities you want to manage through WMI and create a Managed Object Format (MOF) file to describe the schema.</span></span><br/> |
| [<span data-ttu-id="a8f92-121">Fornire dati a WMI scrivendo un provider</span><span class="sxs-lookup"><span data-stu-id="a8f92-121">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)                                                                  | <span data-ttu-id="a8f92-122">Creare il provider più elementare associato a WMI.</span><span class="sxs-lookup"><span data-stu-id="a8f92-122">Create the most basic provider that is coupled to WMI.</span></span><br/>                                                                                |
| [<span data-ttu-id="a8f92-123">Incorporamento di un provider in un'applicazione</span><span class="sxs-lookup"><span data-stu-id="a8f92-123">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)                                                                    | <span data-ttu-id="a8f92-124">Includere il provider come componente all'interno di un'applicazione, se non viene eseguito in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="a8f92-124">Include the provider as a component within an application if it does not run all of the time.</span></span><br/>                                         |
| [<span data-ttu-id="a8f92-125">Registrazione di un provider</span><span class="sxs-lookup"><span data-stu-id="a8f92-125">Registering a Provider</span></span>](registering-a-provider.md)                                                                                                            | <span data-ttu-id="a8f92-126">Registrare il provider con COM e WMI.</span><span class="sxs-lookup"><span data-stu-id="a8f92-126">Register the provider with COM and WMI.</span></span><br/>                                                                                               |
| [<span data-ttu-id="a8f92-127">Inizializzazione di un provider</span><span class="sxs-lookup"><span data-stu-id="a8f92-127">Initializing a Provider</span></span>](initializing-a-provider.md)                                                                                                          | <span data-ttu-id="a8f92-128">Implementare le interfacce [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) e [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) .</span><span class="sxs-lookup"><span data-stu-id="a8f92-128">Implement the [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) and [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) interfaces.</span></span><br/>   |
| [<span data-ttu-id="a8f92-129">Esecuzione di chiamate a WMI</span><span class="sxs-lookup"><span data-stu-id="a8f92-129">Making Calls to WMI</span></span>](making-calls-to-wmi.md)                                                                                                                  | <span data-ttu-id="a8f92-130">Chiamare le interfacce WMI da un provider.</span><span class="sxs-lookup"><span data-stu-id="a8f92-130">Call WMI interfaces from a provider.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="a8f92-131">Rappresentazione di un client</span><span class="sxs-lookup"><span data-stu-id="a8f92-131">Impersonating a Client</span></span>](impersonating-a-client.md)                                                                                                            | <span data-ttu-id="a8f92-132">Impostare la sicurezza per accedere a un'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="a8f92-132">Set security to access a client application.</span></span><br/>                                                                                          |
| [<span data-ttu-id="a8f92-133">Aggiornamento di un provider</span><span class="sxs-lookup"><span data-stu-id="a8f92-133">Updating a Provider</span></span>](updating-a-provider.md)                                                                                                                  | <span data-ttu-id="a8f92-134">Migliorare il provider in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="a8f92-134">Improve the provider as needed.</span></span><br/>                                                                                                       |
| [<span data-ttu-id="a8f92-135">Scaricamento di un provider</span><span class="sxs-lookup"><span data-stu-id="a8f92-135">Unloading a Provider</span></span>](unloading-a-provider.md)                                                                                                                | <span data-ttu-id="a8f92-136">Rimuovere il provider dalla memoria durante l'arresto o quando il provider è inattivo.</span><span class="sxs-lookup"><span data-stu-id="a8f92-136">Remove the provider from memory during shutdown or when the provider is idle.</span></span><br/>                                                         |
| <span data-ttu-id="a8f92-137">[Provider di debug](debugging-providers.md) e [classi di risoluzione dei problemi e configurazione del provider](provider-configuration-and-troubleshooting-classes.md)</span><span class="sxs-lookup"><span data-stu-id="a8f92-137">[Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md)</span></span> | <span data-ttu-id="a8f92-138">Eseguire il debug del provider utilizzando le funzionalità fornite da WMI.</span><span class="sxs-lookup"><span data-stu-id="a8f92-138">Debug your provider using facilities supplied by WMI.</span></span><br/>                                                                                 |
| [<span data-ttu-id="a8f92-139">Ottenere e fornire dati in un computer a 64 bit</span><span class="sxs-lookup"><span data-stu-id="a8f92-139">Getting and Providing Data on a 64-bit Computer</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)                                                          | <span data-ttu-id="a8f92-140">Valutare se è necessario un provider di compatibilità delle applicazioni a 32 bit o se il provider a 64 bit può fornire dati a entrambi i client.</span><span class="sxs-lookup"><span data-stu-id="a8f92-140">Evaluate whether you need a 32-bit application compatibility provider or if the 64-bit provider can supply data to both clients.</span></span><br/>      |



 

<span data-ttu-id="a8f92-141">Negli argomenti seguenti vengono illustrati i passaggi necessari per scrivere tipi diversi di provider:</span><span class="sxs-lookup"><span data-stu-id="a8f92-141">The following topics discuss the steps needed to write different types of providers:</span></span>

-   [<span data-ttu-id="a8f92-142">Scrittura di un provider di istanze</span><span class="sxs-lookup"><span data-stu-id="a8f92-142">Writing an Instance Provider</span></span>](writing-an-instance-provider.md)
-   [<span data-ttu-id="a8f92-143">Scrittura di un provider di metodi</span><span class="sxs-lookup"><span data-stu-id="a8f92-143">Writing a Method Provider</span></span>](writing-a-method-provider.md)
-   [<span data-ttu-id="a8f92-144">Scrittura di un provider di eventi</span><span class="sxs-lookup"><span data-stu-id="a8f92-144">Writing an Event Provider</span></span>](writing-an-event-provider.md)
-   [<span data-ttu-id="a8f92-145">Scrittura di un provider di consumer di eventi</span><span class="sxs-lookup"><span data-stu-id="a8f92-145">Writing an Event Consumer Provider</span></span>](writing-an-event-consumer-provider.md)
-   [<span data-ttu-id="a8f92-146">Scrittura di un provider di classi</span><span class="sxs-lookup"><span data-stu-id="a8f92-146">Writing a Class Provider</span></span>](writing-a-class-provider.md)
-   [<span data-ttu-id="a8f92-147">Scrittura di un provider di proprietà</span><span class="sxs-lookup"><span data-stu-id="a8f92-147">Writing a Property Provider</span></span>](writing-a-property-provider.md)
-   [<span data-ttu-id="a8f92-148">Creazione di un provider di istanze in un provider di High-Performance</span><span class="sxs-lookup"><span data-stu-id="a8f92-148">Making an Instance Provider into a High-Performance Provider</span></span>](making-an-instance-provider-into-a-high-performance-provider.md)

 

