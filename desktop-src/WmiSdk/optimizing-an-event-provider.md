---
description: Un provider di eventi può dedicare molto tempo alla creazione di eventi.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Ottimizzazione di un provider di eventi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70eaabfbbd462b831059b10590d7959bdef05cbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106318182"
---
# <a name="optimizing-an-event-provider"></a><span data-ttu-id="2c606-103">Ottimizzazione di un provider di eventi</span><span class="sxs-lookup"><span data-stu-id="2c606-103">Optimizing an Event Provider</span></span>

<span data-ttu-id="2c606-104">Un provider di eventi può dedicare molto tempo alla creazione di eventi.</span><span class="sxs-lookup"><span data-stu-id="2c606-104">An event provider may devote a great deal of time to creating events.</span></span> <span data-ttu-id="2c606-105">Se nessuna applicazione client utilizza gli eventi creati, il provider sta sprecando risorse di sistema.</span><span class="sxs-lookup"><span data-stu-id="2c606-105">If no client applications use the created events, then the provider is wasting system resources.</span></span> <span data-ttu-id="2c606-106">Inoltre, WMI impiega una quantità considerevole di risorse che analizzano e inviano query complesse al provider appropriato.</span><span class="sxs-lookup"><span data-stu-id="2c606-106">Further, WMI spends a considerable amount of resources parsing and sending complex queries to the appropriate provider.</span></span> <span data-ttu-id="2c606-107">Per evitare lo spreco di risorse di sistema e migliorare le prestazioni del provider di eventi, è possibile implementare l'interfaccia [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) .</span><span class="sxs-lookup"><span data-stu-id="2c606-107">To avoid the waste of system resources and to improve the performance of your event provider, you can implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface.</span></span> <span data-ttu-id="2c606-108">**IWbemEventProviderQuerySink** monitora le query che le applicazioni client registrano con WMI usando i metodi [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) e [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) .</span><span class="sxs-lookup"><span data-stu-id="2c606-108">**IWbemEventProviderQuerySink** monitors the queries that client applications register with WMI by using the [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) and [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) methods.</span></span> <span data-ttu-id="2c606-109">Monitorando le query client registrate, il provider può determinare cosa accade se è necessario inviare messaggi a WMI.</span><span class="sxs-lookup"><span data-stu-id="2c606-109">By monitoring the registered client queries, your provider can determine what if any messages must be sent to WMI.</span></span>

<span data-ttu-id="2c606-110">WMI chiama [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) su un provider di eventi quando un consumer client registra una query del filtro eventi che contiene riferimenti a eventi supportati da tale provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="2c606-110">WMI calls [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) on an event provider when a client consumer registers an event filter query that contains references to events supported by that event provider.</span></span> <span data-ttu-id="2c606-111">Il provider di eventi responsabile degli eventi di modifica dell'istanza per la classe **EmailClass** può quindi essere configurato per generare notifiche solo per il **mittente**.</span><span class="sxs-lookup"><span data-stu-id="2c606-111">So the event provider responsible for instance modification events for the **EmailClass** class can be set up to generate notifications only for **sender**.</span></span> <span data-ttu-id="2c606-112">Quando il provider riceve una query che richiede la notifica delle modifiche apportate alla proprietà **Subject** , il provider può iniziare a generare tali notifiche.</span><span class="sxs-lookup"><span data-stu-id="2c606-112">When the provider receives a query requesting notification of changes to the **subject** property, the provider can start generating those notifications.</span></span> <span data-ttu-id="2c606-113">In questo scenario non è necessario che WMI elimini le notifiche che segnalano solo le modifiche del **destinatario** .</span><span class="sxs-lookup"><span data-stu-id="2c606-113">In this scenario, WMI is not required to discard the notifications that report **recipient** changes only.</span></span>

<span data-ttu-id="2c606-114">Analogamente, WMI chiama [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) su un provider di eventi quando un consumer client Annulla la registrazione di una query del filtro eventi che contiene riferimenti a eventi supportati dal provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="2c606-114">Similarly, WMI calls [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) on an event provider when a client consumer deregisters an event filter query that contains references to events supported by the event provider.</span></span> <span data-ttu-id="2c606-115">Lo scopo di **CancelQuery** è che il provider di eventi aggiorni l'elenco degli eventi da inviare.</span><span class="sxs-lookup"><span data-stu-id="2c606-115">The purpose of **CancelQuery** is for the event provider to update the list of what events should be sent out.</span></span>

> [!Note]  
> <span data-ttu-id="2c606-116">Se il provider supporta sia [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) che [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), assicurarsi che l'implementazione del metodo **IUnknown:: QueryInterface** restituisca i puntatori a entrambe le interfacce.</span><span class="sxs-lookup"><span data-stu-id="2c606-116">If your provider supports both [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) and [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), ensure that your implementation of the **IUnknown::QueryInterface** method returns pointers to both interfaces.</span></span>

 

 

 



