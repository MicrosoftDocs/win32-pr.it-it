---
description: Potrebbe essere necessario scrivere un'applicazione in grado di reagire agli eventi in qualsiasi momento.
ms.assetid: 475dca47-b1e5-4362-ab00-9ab9383e92f9
ms.tgt_platform: multiple
title: Ricezione di eventi in qualsiasi momento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5559068e1e108c6f4185c31f8858a9e4169c50c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104344731"
---
# <a name="receiving-events-at-all-times"></a><span data-ttu-id="fa769-103">Ricezione di eventi in qualsiasi momento</span><span class="sxs-lookup"><span data-stu-id="fa769-103">Receiving Events at All Times</span></span>

<span data-ttu-id="fa769-104">Potrebbe essere necessario scrivere un'applicazione in grado di reagire agli eventi in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="fa769-104">You may want to write an application that can react to events at any time.</span></span> <span data-ttu-id="fa769-105">Ad esempio, un amministratore potrebbe voler ricevere un messaggio di posta elettronica quando le misure specifiche delle prestazioni diminuiscono nei server di rete.</span><span class="sxs-lookup"><span data-stu-id="fa769-105">For example, an administrator may want to receive an email message when specific performance measures decline on network servers.</span></span> <span data-ttu-id="fa769-106">In questo caso, l'applicazione deve essere eseguita in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="fa769-106">In this case, your application should run at all times.</span></span> <span data-ttu-id="fa769-107">Tuttavia, l'esecuzione continua di un'applicazione non è un uso efficiente delle risorse di sistema.</span><span class="sxs-lookup"><span data-stu-id="fa769-107">However, running an application continuously is not an efficient use of system resources.</span></span> <span data-ttu-id="fa769-108">WMI consente invece di creare un consumer di eventi permanente.</span><span class="sxs-lookup"><span data-stu-id="fa769-108">Instead, WMI allows you to create a permanent event consumer.</span></span> <span data-ttu-id="fa769-109">I consumer di eventi permanenti devono soddisfare requisiti di sicurezza specifici.</span><span class="sxs-lookup"><span data-stu-id="fa769-109">Permanent event consumers must meet special security requirements.</span></span> <span data-ttu-id="fa769-110">Per ulteriori informazioni, vedere [protezione degli eventi WMI](securing-wmi-events.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-110">For more information, see [Securing WMI Events](securing-wmi-events.md).</span></span>

<span data-ttu-id="fa769-111">Un consumer di eventi permanenti riceve gli eventi fino a quando la registrazione non viene annullata esplicitamente</span><span class="sxs-lookup"><span data-stu-id="fa769-111">A permanent event consumer receives events until its registration is explicitly canceled.</span></span>

<span data-ttu-id="fa769-112">Un consumer di eventi permanenti è una combinazione delle classi WMI, dei filtri e degli oggetti COM seguenti che risiedono nel sistema:</span><span class="sxs-lookup"><span data-stu-id="fa769-112">A permanent event consumer is a combination of the following WMI classes, filters, and COM objects that reside on your system:</span></span>

-   <span data-ttu-id="fa769-113">Oggetto COM denominato consumer fisico.</span><span class="sxs-lookup"><span data-stu-id="fa769-113">A COM object called a physical consumer.</span></span> <span data-ttu-id="fa769-114">WMI fornisce diversi consumer permanenti standard.</span><span class="sxs-lookup"><span data-stu-id="fa769-114">WMI supplies several standard permanent consumers.</span></span> <span data-ttu-id="fa769-115">Ad esempio, il consumer di eventi script attivi [esegue uno script quando si verifica un evento](running-a-script-based-on-an-event.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-115">For example, the Active Script Event consumer [runs a script when an event occurs](running-a-script-based-on-an-event.md).</span></span>
-   <span data-ttu-id="fa769-116">Nuova classe consumer permanente.</span><span class="sxs-lookup"><span data-stu-id="fa769-116">A new permanent consumer class.</span></span>
-   <span data-ttu-id="fa769-117">Istanza della classe consumer permanente denominata consumer logico.</span><span class="sxs-lookup"><span data-stu-id="fa769-117">An instance of the permanent consumer class called a logical consumer.</span></span>
-   <span data-ttu-id="fa769-118">Filtro che contiene la query per gli eventi.</span><span class="sxs-lookup"><span data-stu-id="fa769-118">A filter that contains the query for events.</span></span>
-   <span data-ttu-id="fa769-119">Collegamento tra l'utente e il filtro.</span><span class="sxs-lookup"><span data-stu-id="fa769-119">A linkage between the consumer and the filter.</span></span>

<span data-ttu-id="fa769-120">Le proprietà di un consumer di eventi logici specificano le azioni da eseguire quando viene notificato un evento, ma non definiscono le query di eventi a cui sono associate.</span><span class="sxs-lookup"><span data-stu-id="fa769-120">The properties of a logical event consumer specify the actions to perform when notified of an event, but do not define the event queries with which they are associated.</span></span> <span data-ttu-id="fa769-121">Quando viene segnalato, WMI carica automaticamente l'oggetto COM che rappresenta il consumer di eventi permanenti nella memoria attiva.</span><span class="sxs-lookup"><span data-stu-id="fa769-121">When signaled, WMI automatically loads the COM object that represents the permanent event consumer into active memory.</span></span> <span data-ttu-id="fa769-122">In genere, questo errore si verifica durante l'avvio o in risposta a un evento di attivazione.</span><span class="sxs-lookup"><span data-stu-id="fa769-122">Typically, this occurs during startup or in response to a triggering event.</span></span> <span data-ttu-id="fa769-123">Dopo l'attivazione, il consumer di eventi permanenti funge da consumer di eventi normali, ma rimane fino a quando non viene scaricato in modo specifico dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="fa769-123">After being activated, the permanent event consumer acts as a normal event consumer, but remains until specifically unloaded by the operating system.</span></span>

<span data-ttu-id="fa769-124">È possibile scrivere un consumer di eventi permanente oppure utilizzare le [classi di consumer standard](standard-consumer-classes.md)di WMI preinstallate, ad esempio [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-124">You can write your own permanent event consumer or use the WMI preinstalled [Standard Consumer Classes](standard-consumer-classes.md), such as [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span></span> <span data-ttu-id="fa769-125">Per altre informazioni, vedere [classi di consumer standard](standard-consumer-classes.md), [monitoraggio e risposta agli eventi con consumer standard](monitoring-and-responding-to-events-with-standard-consumers.md)e [monitoraggio degli eventi](monitoring-events.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-125">For more information, see [Standard Consumer Classes](standard-consumer-classes.md), [Monitoring and Responding to Events with Standard Consumers](monitoring-and-responding-to-events-with-standard-consumers.md), and [Monitoring Events](monitoring-events.md).</span></span>

<span data-ttu-id="fa769-126">Nella procedura seguente viene descritto come creare un consumer di eventi permanente.</span><span class="sxs-lookup"><span data-stu-id="fa769-126">The following procedure describes how to create your own permanent event consumer.</span></span>

<span data-ttu-id="fa769-127">**Per creare un consumer di eventi permanente**</span><span class="sxs-lookup"><span data-stu-id="fa769-127">**To create your own permanent event consumer**</span></span>

1.  <span data-ttu-id="fa769-128">Determinare il tipo di eventi che si desidera ricevere.</span><span class="sxs-lookup"><span data-stu-id="fa769-128">Determine what kind of events you want to receive.</span></span>

    <span data-ttu-id="fa769-129">WMI supporta eventi intrinseci ed estrinseci.</span><span class="sxs-lookup"><span data-stu-id="fa769-129">WMI supports intrinsic and extrinsic events.</span></span> <span data-ttu-id="fa769-130">Un evento intrinseco è un evento predefinito da WMI, mentre un evento estrinseco è un evento definito da un provider di terze parti.</span><span class="sxs-lookup"><span data-stu-id="fa769-130">An intrinsic event is an event predefined by WMI, whereas an extrinsic event is an event defined by a third party provider.</span></span> <span data-ttu-id="fa769-131">Per ulteriori informazioni, vedere [determinazione del tipo di evento da ricevere](determining-the-type-of-event-to-receive.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-131">For more information, see [Determining the Type of Event to Receive](determining-the-type-of-event-to-receive.md).</span></span>

2.  <span data-ttu-id="fa769-132">[Implementare un consumer fisico](implementing-a-physical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-132">[Implement a physical consumer](implementing-a-physical-consumer.md).</span></span>

    <span data-ttu-id="fa769-133">La differenza principale tra un'applicazione di gestione e un [*consumer fisico*](gloss-p.md) è che un utente carica e Scarica un'applicazione di gestione, mentre WMI carica e Scarica un consumer fisico.</span><span class="sxs-lookup"><span data-stu-id="fa769-133">The main difference between a management application and a [*physical consumer*](gloss-p.md) is that a user loads and unloads a management application, whereas WMI loads and unloads a physical consumer.</span></span> <span data-ttu-id="fa769-134">La maggior parte del codice deve essere nel consumatore fisico.</span><span class="sxs-lookup"><span data-stu-id="fa769-134">Most of your coding should be in the physical consumer.</span></span>

    > [!Note]  
    > <span data-ttu-id="fa769-135">Questo passaggio è il primo nella procedura per semplificare la spiegazione.</span><span class="sxs-lookup"><span data-stu-id="fa769-135">This step is first in the procedure for ease of explanation.</span></span> <span data-ttu-id="fa769-136">In termini di codifica, è necessario creare il consumer fisico per ultimo.</span><span class="sxs-lookup"><span data-stu-id="fa769-136">In terms of coding, you should actually create the physical consumer last.</span></span> <span data-ttu-id="fa769-137">In questo modo è possibile disporre i parametri e la logica per il provider di eventi permanenti prima di iniziare la codifica lunga.</span><span class="sxs-lookup"><span data-stu-id="fa769-137">That way you can lay out your parameters and logic for your permanent event provider before you start lengthy coding.</span></span> <span data-ttu-id="fa769-138">Tuttavia, non esiste alcuna restrizione per la scrittura prima del consumer fisico.</span><span class="sxs-lookup"><span data-stu-id="fa769-138">However, there is no restriction against writing the physical consumer first.</span></span>

     

3.  <span data-ttu-id="fa769-139">[Creare una nuova classe consumer che descrive il consumer fisico](creating-a-new-permanent-event-consumer-class.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-139">[Create a new consumer class describing the physical consumer](creating-a-new-permanent-event-consumer-class.md).</span></span>

    <span data-ttu-id="fa769-140">Analogamente a qualsiasi classe, la classe consumer descrive i parametri generali di un consumer di eventi permanenti in WMI.</span><span class="sxs-lookup"><span data-stu-id="fa769-140">Like any class, the consumer class describes the general parameters of a permanent event consumer to WMI.</span></span>

4.  <span data-ttu-id="fa769-141">[Creare un'istanza della classe consumer](creating-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-141">[Create an instance of the consumer class](creating-a-logical-consumer.md).</span></span>

    <span data-ttu-id="fa769-142">Analogamente a qualsiasi altra classe WMI, è necessario creare un'istanza della classe consumer se si desidera implementare la classe.</span><span class="sxs-lookup"><span data-stu-id="fa769-142">Like any other WMI class, you must create an instance of the consumer class if you want to implement the class.</span></span> <span data-ttu-id="fa769-143">Un'istanza di una classe consumer è nota anche come [*consumer logico*](gloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-143">An instance of a consumer class is also known as a [*logical consumer*](gloss-l.md).</span></span> <span data-ttu-id="fa769-144">Il consumer logico rappresenta il consumer fisico di WMI.</span><span class="sxs-lookup"><span data-stu-id="fa769-144">The logical consumer represents the physical consumer to WMI.</span></span>

5.  <span data-ttu-id="fa769-145">[Creare un filtro evento](creating-an-event-filter.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-145">[Create an event filter](creating-an-event-filter.md).</span></span>

    <span data-ttu-id="fa769-146">Le query di eventi che attivano i consumer di eventi permanenti sono denominate [*filtri eventi*](gloss-e.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-146">The event queries that activate permanent event consumers are called [*event filters*](gloss-e.md).</span></span> <span data-ttu-id="fa769-147">Un singolo filtro eventi può essere associato a più consumer di eventi logici.</span><span class="sxs-lookup"><span data-stu-id="fa769-147">A single event filter can be associated with multiple logical event consumers.</span></span> <span data-ttu-id="fa769-148">Inoltre, è possibile associare più filtri eventi a un singolo consumer di eventi logici.</span><span class="sxs-lookup"><span data-stu-id="fa769-148">Furthermore, multiple event filters can be associated with a single logical event consumer.</span></span> <span data-ttu-id="fa769-149">Il filtro è un'istanza di [**\_ \_ EventFilter**](--eventfilter.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-149">The filter is an instance of [**\_\_EventFilter**](--eventfilter.md).</span></span>

    <span data-ttu-id="fa769-150">Un evento di registro NT viene generato quando la query di un consumer di eventi permanenti ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="fa769-150">An NT Log event is generated when a permanent event consumer's query fails.</span></span> <span data-ttu-id="fa769-151">L'origine dell'evento è WinMgmt, l'ID evento è 10 e il tipo di evento è Error.</span><span class="sxs-lookup"><span data-stu-id="fa769-151">The event's source is WinMgmt, the event ID is 10, and the event type is Error.</span></span>

6.  <span data-ttu-id="fa769-152">[Collegare il filtro eventi al consumer logico](binding-an-event-filter-with-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-152">[Link the event filter to the logical consumer](binding-an-event-filter-with-a-logical-consumer.md).</span></span>

    <span data-ttu-id="fa769-153">Collegando il filtro eventi al consumer logico, è necessario indicare a WMI il modo in cui il filtro eventi appartiene a un consumer logico.</span><span class="sxs-lookup"><span data-stu-id="fa769-153">By linking the event filter to the logical consumer, you instruct WMI about which event filter belongs to which logical consumer.</span></span> <span data-ttu-id="fa769-154">I consumer di eventi logici e i filtri eventi sono collegati da un'istanza della classe di associazione di [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-154">Logical event consumers and event filters are linked by an association class instance of [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span></span> <span data-ttu-id="fa769-155">Quando viene ricevuto un evento che corrisponde a una query di eventi descritta in un filtro eventi, WMI trova il consumer di eventi logici associato esaminando l'istanza della classe Association.</span><span class="sxs-lookup"><span data-stu-id="fa769-155">When an event is received that matches an event query described in an event filter, WMI finds the associated logical event consumer by looking at the association class instance.</span></span> <span data-ttu-id="fa769-156">Una volta individuata l'istanza del consumer di eventi logici, WMI utilizza un'istanza della classe [**\_ \_ EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) per individuare ed eseguire il consumer di eventi fisici associato a questa istanza.</span><span class="sxs-lookup"><span data-stu-id="fa769-156">After the logical event consumer instance is located, WMI uses an instance of the [**\_\_EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) class to locate and run the physical event consumer associated with this instance.</span></span>

7.  <span data-ttu-id="fa769-157">[Scrittura di un provider di consumer di eventi](writing-an-event-consumer-provider.md).</span><span class="sxs-lookup"><span data-stu-id="fa769-157">[Writing an event consumer provider](writing-an-event-consumer-provider.md).</span></span>

    <span data-ttu-id="fa769-158">Il provider di consumer di eventi è un oggetto COM che individua il consumer fisico per WMI.</span><span class="sxs-lookup"><span data-stu-id="fa769-158">The event consumer provider is a COM object that locates the physical consumer for WMI.</span></span>

 

 



