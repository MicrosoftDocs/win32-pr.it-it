---
description: Un provider di eventi è un oggetto COM che fornisce WMI con notifiche di eventi intrinseci ed estrinseci.
ms.assetid: 075bdc65-4ea3-4f91-9823-1d2d0dc13423
ms.tgt_platform: multiple
title: Scrittura di un provider di eventi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb118d89f214e9fc651c1c9d93abfcfe43f49fc7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310315"
---
# <a name="writing-an-event-provider"></a><span data-ttu-id="218a9-103">Scrittura di un provider di eventi</span><span class="sxs-lookup"><span data-stu-id="218a9-103">Writing an Event Provider</span></span>

<span data-ttu-id="218a9-104">Un provider di eventi è un oggetto COM che fornisce WMI con notifiche di eventi intrinseci ed estrinseci.</span><span class="sxs-lookup"><span data-stu-id="218a9-104">An event provider is a COM object that supplies WMI with notifications of intrinsic and extrinsic events.</span></span> <span data-ttu-id="218a9-105">Un evento intrinseco segnala una modifica interna dei dati in WMI, mentre un evento estrinseco segnala un evento definito dall'utente non descritto da un evento intrinseco.</span><span class="sxs-lookup"><span data-stu-id="218a9-105">An intrinsic event reports an internal data change to WMI, while an extrinsic event reports a user-defined event not described by an intrinsic event.</span></span> <span data-ttu-id="218a9-106">Ad esempio, un evento in risposta a modifiche, creazione o eliminazione della classe [**Win32 \_ disco logico**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) verrebbe classificato come un evento intrinseco.</span><span class="sxs-lookup"><span data-stu-id="218a9-106">For example, an event in response to changes, creation, or deletion of the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class would classify as an intrinsic event.</span></span> <span data-ttu-id="218a9-107">Un evento generato in base a elementi diversi dalla modifica, creazione o eliminazione di un oggetto WMI esistente è un evento estrinseco.</span><span class="sxs-lookup"><span data-stu-id="218a9-107">An event that is generated on the basis of something other than the modification, creation, or deletion of an existing WMI object is an extrinsic event.</span></span> <span data-ttu-id="218a9-108">Indipendentemente dalla classe supportata, è possibile implementare tutti i provider di eventi nello stesso modo.</span><span class="sxs-lookup"><span data-stu-id="218a9-108">Regardless of the supported class, you can implement all event providers in the same manner.</span></span>

<span data-ttu-id="218a9-109">Nella procedura riportata di seguito viene descritto come implementare un provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="218a9-109">The following procedure describes how to implement an event provider.</span></span>

<span data-ttu-id="218a9-110">**Per implementare un provider di eventi**</span><span class="sxs-lookup"><span data-stu-id="218a9-110">**To implement an event provider**</span></span>

1.  <span data-ttu-id="218a9-111">Progettare e registrare il provider di classi con WMI.</span><span class="sxs-lookup"><span data-stu-id="218a9-111">Design and register your class provider with WMI.</span></span>

    <span data-ttu-id="218a9-112">I provider di classi si registrano con WMI creando un'istanza di [**\_ \_ Win32Provider**](--win32provider.md) e una classe [**\_ \_ EventProviderRegistration**](--eventproviderregistration.md) .</span><span class="sxs-lookup"><span data-stu-id="218a9-112">Class providers register with WMI by creating a [**\_\_Win32Provider**](--win32provider.md) instance and an [**\_\_EventProviderRegistration**](--eventproviderregistration.md) class.</span></span> <span data-ttu-id="218a9-113">Per ulteriori informazioni, vedere la pagina relativa alla [registrazione di un provider di eventi](registering-an-event-provider.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-113">For more information, see [Registering an Event Provider](registering-an-event-provider.md).</span></span>

2.  <span data-ttu-id="218a9-114">Implementare l'interfaccia [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) per il provider.</span><span class="sxs-lookup"><span data-stu-id="218a9-114">Implement the [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) interface for your provider.</span></span>

    <span data-ttu-id="218a9-115">L'interfaccia [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) è un'interfaccia comune utilizzata da WMI per caricare e inizializzare tutti i provider.</span><span class="sxs-lookup"><span data-stu-id="218a9-115">The [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) interface is a common interface WMI uses to load and initialize all providers.</span></span> <span data-ttu-id="218a9-116">Per ulteriori informazioni, vedere [inizializzazione di un provider](initializing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-116">For more information, see [Initializing a Provider](initializing-a-provider.md).</span></span>

3.  <span data-ttu-id="218a9-117">Implementare [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) come interfaccia principale per il provider.</span><span class="sxs-lookup"><span data-stu-id="218a9-117">Implement the [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) as the primary interface for your provider.</span></span>

    <span data-ttu-id="218a9-118">L'interfaccia [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) usa il metodo **ProviderEvents** per fornire eventi a WMI.</span><span class="sxs-lookup"><span data-stu-id="218a9-118">The [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) interface uses the **ProviderEvents** method to supply events to WMI.</span></span> <span data-ttu-id="218a9-119">Per ulteriori informazioni, vedere [Implementing the primary interface for a event provider](implementing-the-primary-interface-for-an-event-provider.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-119">For more information, see [Implementing the Primary Interface for an Event Provider](implementing-the-primary-interface-for-an-event-provider.md).</span></span>

    > [!Note]  
    > <span data-ttu-id="218a9-120">I provider di eventi devono usare il modello di multithreading "both".</span><span class="sxs-lookup"><span data-stu-id="218a9-120">Event providers must use the multithreading model "Both".</span></span>

     

4.  <span data-ttu-id="218a9-121">Facoltativamente, è anche possibile implementare l'interfaccia [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) per migliorare le prestazioni del provider di eventi.</span><span class="sxs-lookup"><span data-stu-id="218a9-121">Optionally, you may also implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface to increase the performance of your event provider.</span></span>

    <span data-ttu-id="218a9-122">L'interfaccia [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) consente al provider di ottimizzare le query prima di inviare una risposta a WMI ed è particolarmente utile per un provider che fornisce eventi di più tipi e che deve eseguire il maggior numero possibile di ottimizzazioni interne.</span><span class="sxs-lookup"><span data-stu-id="218a9-122">The [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface allows the provider to optimize queries before sending a response to WMI, and is most useful for a provider that supplies events of multiple types and that needs to perform as many internal optimizations as possible.</span></span> <span data-ttu-id="218a9-123">Per ulteriori informazioni, vedere [ottimizzazione di un provider di eventi](optimizing-an-event-provider.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-123">For more information, see [Optimizing an Event Provider](optimizing-an-event-provider.md).</span></span>

5.  <span data-ttu-id="218a9-124">Implementare l'interfaccia [**IWbemEventProviderSecurity**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) per limitare gli utenti a determinati ID di sicurezza (SID) o implementare [**IWbemEventSink:: SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) per proteggere il sink stesso.</span><span class="sxs-lookup"><span data-stu-id="218a9-124">Implement the [**IWbemEventProviderSecurity**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) interface to limit consumers to certain security identifiers (SIDs) or implement [**IWbemEventSink::SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) to secure the sink itself.</span></span> <span data-ttu-id="218a9-125">Il provider può inoltre impostare la proprietà del **\_ descrittore di sicurezza** nella classe di evento per proteggere i singoli eventi nel codice MOF.</span><span class="sxs-lookup"><span data-stu-id="218a9-125">The provider can also set the **SECURITY\_DESCRIPTOR** property in the event class to secure individual events in the MOF code.</span></span> <span data-ttu-id="218a9-126">Per ulteriori informazioni, vedere [protezione degli eventi WMI](securing-wmi-events.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-126">For more information, see [Securing WMI Events](securing-wmi-events.md).</span></span>
6.  <span data-ttu-id="218a9-127">Aggiungere il codice aggiuntivo necessario per il provider.</span><span class="sxs-lookup"><span data-stu-id="218a9-127">Add any additional code necessary for your provider.</span></span>

    <span data-ttu-id="218a9-128">Quando si progetta il provider, è molto probabile che sia necessario chiamare le interfacce WMI.</span><span class="sxs-lookup"><span data-stu-id="218a9-128">When designing your provider, you most likely need to call WMI interfaces.</span></span> <span data-ttu-id="218a9-129">Per ulteriori informazioni, vedere [chiamata a un metodo](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-129">For more information, see [Calling a Method](calling-a-method.md).</span></span>

    <span data-ttu-id="218a9-130">Quando si recuperano informazioni per un client, potrebbe essere necessario accedere ai livelli di sicurezza per il client.</span><span class="sxs-lookup"><span data-stu-id="218a9-130">When retrieving information for a client, you may need to access the security levels for that client.</span></span> <span data-ttu-id="218a9-131">Per ulteriori informazioni, vedere [rappresentazione di un client](impersonating-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-131">For more information, see [Impersonating a Client](impersonating-a-client.md).</span></span>

7.  <span data-ttu-id="218a9-132">Sostituire il provider preesistente con il nuovo codice.</span><span class="sxs-lookup"><span data-stu-id="218a9-132">Replace the preexisting provider with your new code.</span></span>

    <span data-ttu-id="218a9-133">Non è necessario eseguire questo passaggio se non si dispone di un provider preesistente per la copia.</span><span class="sxs-lookup"><span data-stu-id="218a9-133">You do not need to perform this step if you do not have a preexisting provider to copy over.</span></span> <span data-ttu-id="218a9-134">Per ulteriori informazioni, vedere [aggiornamento di un provider](updating-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-134">For more information, see [Updating a Provider](updating-a-provider.md).</span></span>

<span data-ttu-id="218a9-135">Un'applicazione client può richiedere un evento registrandosi con WMI come consumer di eventi.</span><span class="sxs-lookup"><span data-stu-id="218a9-135">A client application can request an event by registering itself with WMI as an event consumer.</span></span> <span data-ttu-id="218a9-136">Per ulteriori informazioni, vedere [ricezione di un evento WMI](receiving-a-wmi-event.md).</span><span class="sxs-lookup"><span data-stu-id="218a9-136">For more information, see [Receiving a WMI Event](receiving-a-wmi-event.md).</span></span>

 

 
