---
description: Per creare un provider di classi WMI, è necessario registrare l' \_ \_ istanza di Win32Provider che rappresenta il provider utilizzando un'istanza di \_ \_ ClassProviderRegistration.
ms.assetid: ed834969-47e9-47df-9db8-c805b2eb71da
ms.tgt_platform: multiple
title: Registrazione di un provider di classi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bc15893e654f96f8c4e476219389a1f8f2c464a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967083"
---
# <a name="registering-a-class-provider"></a><span data-ttu-id="9b8e1-103">Registrazione di un provider di classi</span><span class="sxs-lookup"><span data-stu-id="9b8e1-103">Registering a Class Provider</span></span>

<span data-ttu-id="9b8e1-104">Per creare un provider di classi WMI, è necessario registrare l'istanza di [**\_ \_ Win32Provider**](--win32provider.md) che rappresenta il provider utilizzando un'istanza di [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="9b8e1-104">To create a WMI class provider you must register the [**\_\_Win32Provider**](--win32provider.md) instance that represents your provider using an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span> <span data-ttu-id="9b8e1-105">Come oggetto COM, il provider deve eseguire la registrazione con il sistema operativo e WMI.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-105">As a COM object, your provider must register with the operating system and WMI.</span></span> <span data-ttu-id="9b8e1-106">Nella procedura seguente si presuppone che il processo di registrazione sia già stato implementato come descritto in [registrazione di un provider](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="9b8e1-106">The following procedure assumes that you have already implemented the registration process as described in [Registering a Provider](registering-a-provider.md).</span></span> <span data-ttu-id="9b8e1-107">Se il provider archivia la maggior parte dei dati nel repository WMI e i dati vengono aggiornati solo nell'inizializzazione WMI, registrare la classe come provider di classi push.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-107">If your provider stores most data in the WMI repository and that data is updated only on WMI initialization, then register your class as a push class provider.</span></span> <span data-ttu-id="9b8e1-108">Se i dati che si forniscono cambiano di frequente e vengono recuperati in modo dinamico dal codice a ogni richiesta di WMI, registrare il provider come provider di classi pull.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-108">If the data you are providing changes frequently and is retrieved dynamically by your code on every request from WMI, then register your provider as a pull class provider.</span></span>

<span data-ttu-id="9b8e1-109">Nella procedura seguente viene descritto come registrare un provider di classi push.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-109">The following procedure describes how to register a push class provider.</span></span>

<span data-ttu-id="9b8e1-110">**Per registrare un provider di classi push**</span><span class="sxs-lookup"><span data-stu-id="9b8e1-110">**To register a push class provider**</span></span>

-   <span data-ttu-id="9b8e1-111">Impostare la proprietà **InteractionType** dell'istanza [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) su 1.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-111">Set the **InteractionType** property of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance to 1.</span></span>

    <span data-ttu-id="9b8e1-112">La creazione di un'istanza di [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) fa parte del processo di registrazione.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-112">Creating an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md) is part of the registration process.</span></span>

<span data-ttu-id="9b8e1-113">Nella procedura seguente viene descritto come registrare un provider di classi pull.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-113">The following procedure describes how to register a pull class provider.</span></span>

<span data-ttu-id="9b8e1-114">**Per registrare un provider di classi pull**</span><span class="sxs-lookup"><span data-stu-id="9b8e1-114">**To register a pull class provider**</span></span>

1.  <span data-ttu-id="9b8e1-115">Creare un'istanza della classe [**\_ \_ Win32Provider**](--win32provider.md) che descrive il provider.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-115">Create an instance of the [**\_\_Win32Provider**](--win32provider.md) class that describes the provider.</span></span>
2.  <span data-ttu-id="9b8e1-116">Creare un'istanza della classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) che descrive il set di funzionalità del provider.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-116">Create an instance of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class that describes the feature set of the provider.</span></span>

    <span data-ttu-id="9b8e1-117">All'interno dell'istanza di [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) :</span><span class="sxs-lookup"><span data-stu-id="9b8e1-117">Within the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance:</span></span>

    1.  <span data-ttu-id="9b8e1-118">Impostare la proprietà **InteractionType** per indicare se il provider è un provider push o pull.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-118">Set the **InteractionType** property to indicate whether the provider is a push or pull provider.</span></span>
    2.  <span data-ttu-id="9b8e1-119">Contrassegnare la classe con i qualificatori [**dinamici**](standard-wmi-qualifiers.md) e del [**provider**](/windows/desktop/api/Provider/nl-provider-provider) .</span><span class="sxs-lookup"><span data-stu-id="9b8e1-119">Tag the class with both the [**Dynamic**](standard-wmi-qualifiers.md) and [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifiers.</span></span>

        <span data-ttu-id="9b8e1-120">Il qualificatore [**dinamico**](standard-wmi-qualifiers.md) segnala che WMI deve usare un provider per recuperare le istanze della classe.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-120">The [**Dynamic**](standard-wmi-qualifiers.md) qualifier signals that WMI should use a provider to retrieve the class instances.</span></span> <span data-ttu-id="9b8e1-121">Il qualificatore del [**provider**](/windows/desktop/api/Provider/nl-provider-provider) specifica il nome del provider che WMI deve utilizzare.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-121">The [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifier specifies the name of the provider that WMI should use.</span></span>

    3.  <span data-ttu-id="9b8e1-122">Definire le proprietà **ResultSetQueries**, **ReferencedSetQueries** e **UnsupportedQueries** .</span><span class="sxs-lookup"><span data-stu-id="9b8e1-122">Define the **ResultSetQueries**, **ReferencedSetQueries**, and **UnsupportedQueries** properties.</span></span>

        <span data-ttu-id="9b8e1-123">Queste proprietà di query descrivono informazioni dettagliate sulla classe supportata.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-123">These query properties describe detailed information about the supported class.</span></span>

<span data-ttu-id="9b8e1-124">Oltre a descrivere i vari metodi supportati di una classe, la classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) dispone anche di tre proprietà che descrivono una serie di query.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-124">In addition to describing the various supported methods of a class, the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class also has three properties that describe a series of queries.</span></span> <span data-ttu-id="9b8e1-125">Se utilizzate insieme, queste tre proprietà descrivono l'intero intervallo di classi fornito dal provider di classi.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-125">When used together, these three properties describe the entire range of classes supplied by the class provider.</span></span> <span data-ttu-id="9b8e1-126">Ogni proprietà di query contiene un'istruzione SELECT WQL, denominata "query dello schema", per specificare i tipi di classi supportate.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-126">Each query property contains a WQL SELECT statement, called a "schema query," to specify the types of supported classes.</span></span> <span data-ttu-id="9b8e1-127">Le query dello schema specificano un nome di classe speciale denominato meta \_ Class.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-127">Schema queries specify a special class name called meta\_class.</span></span> <span data-ttu-id="9b8e1-128">Nella tabella seguente sono elencate le proprietà delle query.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-128">The following table lists the query properties.</span></span>



| <span data-ttu-id="9b8e1-129">Proprietà</span><span class="sxs-lookup"><span data-stu-id="9b8e1-129">Property</span></span>                 | <span data-ttu-id="9b8e1-130">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9b8e1-130">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9b8e1-131">**ResultSetQueries**</span><span class="sxs-lookup"><span data-stu-id="9b8e1-131">**ResultSetQueries**</span></span>     | <span data-ttu-id="9b8e1-132">Contiene informazioni sul set di risultati fornito dal provider.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-132">Contains information about the result set the provider supplies.</span></span> <span data-ttu-id="9b8e1-133">WMI utilizza le informazioni per determinare se richiamare il provider per soddisfare una query da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-133">WMI uses the information to determine whether to invoke the provider to satisfy a query from an application.</span></span> <span data-ttu-id="9b8e1-134">Questa proprietà descrive il set di tutte le classi che possono essere fornite dal provider o un superset delle classi disponibili, ma mai un subset.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-134">This property describes either the set of all classes that the provider can supply or a superset of the available classes, but never a subset.</span></span> <span data-ttu-id="9b8e1-135">WMI richiede che un provider specifichi almeno una query in questa proprietà.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-135">WMI requires a provider to specify at least one query in this property.</span></span><br/> <span data-ttu-id="9b8e1-136">Nell'esempio seguente viene illustrato come impostare **ResultSetQueries** quando un provider fornisce una classe di associazione che fa riferimento alla classe [**\_ disco logico Win32**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) .</span><span class="sxs-lookup"><span data-stu-id="9b8e1-136">The following example shows how to set **ResultSetQueries** when a provider supplies an association class that references the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class.</span></span><br/> `SELECT * FROM meta_class WHERE __Class = "Win32_LogicalDisk"`<br/> <span data-ttu-id="9b8e1-137">Nell'esempio seguente viene illustrato come specificare una query generale quando un provider fornisce classi che fanno riferimento ad altre classi sconosciute.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-137">The following example shows how to specify a general query when a provider supplies classes that reference other unknown classes.</span></span><br/> `SELECT * FROM meta_class`<br/> <span data-ttu-id="9b8e1-138">Nell'esempio seguente viene illustrato come impostare **ResultSetQueries** quando un provider fornisce solo le sottoclassi, ma non la classe padre di una classe specificata.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-138">The following example shows how to set **ResultSetQueries** when a provider supplies only subclasses, but not the parent class of a given class.</span></span><br/> `SELECT * FROM meta_class WHERE __Dynasty = "MyClass"`<br/> <span data-ttu-id="9b8e1-139">Nell'esempio seguente viene illustrato come utilizzare \_ \_ questa proprietà speciale e impostare **ResultSetQueries** quando un provider fornisce tutte le classi e sottoclassi.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-139">The following example shows how to use the special \_\_this property and set **ResultSetQueries** when a provider supplies all class and subclasses.</span></span><br/> `SELECT * FROM meta_class WHERE __this ISA "MyClass"`<br/> |
| <span data-ttu-id="9b8e1-140">**ReferencedSetQueries**</span><span class="sxs-lookup"><span data-stu-id="9b8e1-140">**ReferencedSetQueries**</span></span> | <span data-ttu-id="9b8e1-141">Determina se ignorare il provider nelle query dello schema in cui vengono richieste associazioni e riferimenti.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-141">Determines whether to bypass the provider in schema queries where associations and references are being requested.</span></span> <span data-ttu-id="9b8e1-142">I provider che possono fornire classi di associazione devono includere almeno una query nella relativa proprietà **ReferencedSetQueries** .</span><span class="sxs-lookup"><span data-stu-id="9b8e1-142">Providers that can supply association classes must include at least one query in their **ReferencedSetQueries** property.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="9b8e1-143">**UnsupportedQueries**</span><span class="sxs-lookup"><span data-stu-id="9b8e1-143">**UnsupportedQueries**</span></span>   | <span data-ttu-id="9b8e1-144">Contiene informazioni sul set di risultati non fornito da un provider di classi.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-144">Contains information about the result set that a class provider does not supply.</span></span> <span data-ttu-id="9b8e1-145">WMI utilizza questa proprietà per sottrarre dal set di classi implicito da **ResultSetQueries**.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-145">WMI uses this property to subtract from the set of classes implied by **ResultSetQueries**.</span></span> <span data-ttu-id="9b8e1-146">Un provider di classi può ad esempio specificare nel supporto **ResultSetQueries** per tutte le classi derivate da MyClass e specificare in **UnsupportedQueries** una mancanza di supporto per una determinata classe derivata.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-146">For example, a class provider can specify in **ResultSetQueries** support for all classes derived from MyClass and specify in **UnsupportedQueries** a lack of support for one particular derived class.</span></span><br/> <span data-ttu-id="9b8e1-147">Maggiori sono le informazioni che un provider è in grado di registrare sulle funzionalità di elaborazione delle query, più velocemente viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-147">The more information that a provider can register about its query processing capabilities, the faster it runs.</span></span> <span data-ttu-id="9b8e1-148">L'immissione di una o più query nella proprietà **UnsupportedQueries** è un modo specifico ed è particolarmente importante quando un provider si basa su una classe non fornita.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-148">Entering one or more queries in the **UnsupportedQueries** property is one way to be specific and is particularly important when a provider relies on a class that it does not supply.</span></span> <span data-ttu-id="9b8e1-149">Quando viene effettuata una richiesta per una classe elencata in una query nella proprietà **UnsupportedQueries** , WMI può fornire la classe stessa o richiamare un provider alternativo per fornirla.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-149">When a request is made for a class that is listed in a query in the **UnsupportedQueries** property, WMI can supply the class itself or invoke an alternate provider to supply it.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="9b8e1-150">Poiché WMI non supporta la clausola o, è necessario creare una query separata per ogni classe.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-150">Because WMI does not support the OR clause, you must create a separate query for each class.</span></span>

<span data-ttu-id="9b8e1-151">Le query seguenti vengono specificate in **ResultSetQueries** quando un provider di classi fornisce Class1, MyClass2 e MyClass3.</span><span class="sxs-lookup"><span data-stu-id="9b8e1-151">The following queries are specified in **ResultSetQueries** when a class provider supplies MyClass1, MyClass2, and MyClass3.</span></span>


```sql
SELECT * FROM meta_class WHERE __Class = "MyClass1"
SELECT * FROM meta_class WHERE __Class = "MyClass2"
SELECT * FROM meta_class WHERE __Class = "MyClass3"
```



<span data-ttu-id="9b8e1-152">Solo gli amministratori possono registrare o eliminare un provider creando un'istanza di [**\_ \_ Win32Provider**](--win32provider.md) e [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="9b8e1-152">Only administrators can register or delete a provider by creating an instance of [**\_\_Win32Provider**](--win32provider.md) and [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span>

 

