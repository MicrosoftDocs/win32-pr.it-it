---
description: Le applicazioni client che chiamano interfacce WMI possono controllare i livelli di sicurezza dei propri processi.
ms.assetid: 790b4e40-9b92-464a-a774-dec0b75cedee
ms.tgt_platform: multiple
title: Impostazione della sicurezza del processo dell'applicazione client
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bfa0a42390ffa433cff01300b0976d40553665c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104232393"
---
# <a name="setting-client-application-process-security"></a><span data-ttu-id="83d4b-103">Impostazione della sicurezza del processo dell'applicazione client</span><span class="sxs-lookup"><span data-stu-id="83d4b-103">Setting Client Application Process Security</span></span>

<span data-ttu-id="83d4b-104">Le applicazioni client che chiamano interfacce WMI possono controllare i livelli di sicurezza dei propri processi.</span><span class="sxs-lookup"><span data-stu-id="83d4b-104">Client applications that call WMI interfaces can control the security levels of their processes.</span></span> <span data-ttu-id="83d4b-105">Tutte le applicazioni WMI accedono a WMI tramite COM ed è possibile chiamare la funzione COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) per impostare la sicurezza per i processi.</span><span class="sxs-lookup"><span data-stu-id="83d4b-105">All WMI applications access WMI through COM, and you can call the COM function [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for your processes.</span></span> <span data-ttu-id="83d4b-106">Le applicazioni che effettuano chiamate asincrone a WMI e alle applicazioni che si registrano come consumer di eventi impostano livelli di sicurezza sulla chiamata in WMI.</span><span class="sxs-lookup"><span data-stu-id="83d4b-106">Applications that make asynchronous calls to WMI and applications that register as event consumers set security levels on the call into WMI.</span></span>

<span data-ttu-id="83d4b-107">Se non si effettua una chiamata esplicita a [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity), com lo chiama in modo implicito con i valori del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="83d4b-107">If you do not make an explicit call to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity), COM calls it implicitly with values from the registry.</span></span> <span data-ttu-id="83d4b-108">Tuttavia, i valori del registro di sistema possono avere impostazioni inferiori per la rappresentazione e l'autenticazione che non forniscono la sicurezza necessaria per WMI.</span><span class="sxs-lookup"><span data-stu-id="83d4b-108">However, the registry values may have lower settings for impersonation and authentication that do not provide the security required for WMI.</span></span> <span data-ttu-id="83d4b-109">Per ulteriori informazioni, vedere [impostazione del livello di sicurezza del processo predefinito mediante C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="83d4b-109">For more information, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span>

<span data-ttu-id="83d4b-110">L'accesso asincrono a WMI non è consigliato.</span><span class="sxs-lookup"><span data-stu-id="83d4b-110">Asynchronous access to WMI is not recommended.</span></span> <span data-ttu-id="83d4b-111">Un callback asincrono consente a un utente non autenticato di fornire dati al sink.</span><span class="sxs-lookup"><span data-stu-id="83d4b-111">An asynchronous callback allows a non-authenticated user to provide data to the sink.</span></span> <span data-ttu-id="83d4b-112">Questo comporta rischi per la sicurezza per gli script e le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="83d4b-112">This poses security risks to your scripts and applications.</span></span> <span data-ttu-id="83d4b-113">Per eliminare i rischi, usare la comunicazione sincrona o semisincrono o eseguire controlli di accesso appropriati nell'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="83d4b-113">To eliminate the risks, use semisynchronous or synchronous communication, or perform proper access checks in your client application.</span></span> <span data-ttu-id="83d4b-114">Per ulteriori informazioni, vedere [chiamata a un metodo](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="83d4b-114">For more information, see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="83d4b-115">Le chiamate a qualsiasi proxy WMI ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**IEnumWbemClassObject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**IWbemCallResult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult)o [**IWbemRefresher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) utilizzano un puntatore out-of-process.</span><span class="sxs-lookup"><span data-stu-id="83d4b-115">Calls to any of the WMI proxies ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**IEnumWbemClassObject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**IWbemCallResult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult), or [**IWbemRefresher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) use an out-of-process pointer.</span></span> <span data-ttu-id="83d4b-116">Per ulteriori informazioni sui valori predefiniti e sulle raccomandazioni, vedere [impostazione della sicurezza su IWbemServices e altri proxy](setting-the-security-on-iwbemservices-and-other-proxies.md).</span><span class="sxs-lookup"><span data-stu-id="83d4b-116">For more information about the defaults and recommendations, see [Setting the Security on IWbemServices and Other Proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span></span>

<span data-ttu-id="83d4b-117">Nella procedura riportata di seguito vengono descritti i passaggi da eseguire per impostare la sicurezza per WMI nel processo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="83d4b-117">The following procedure describes the steps you must perform to set the security for WMI on your application process.</span></span>

<span data-ttu-id="83d4b-118">**Per impostare la sicurezza per WMI nel processo dell'applicazione**</span><span class="sxs-lookup"><span data-stu-id="83d4b-118">**To set security for WMI on your application process**</span></span>

1.  <span data-ttu-id="83d4b-119">Determinare i livelli di sicurezza necessari per i sistemi operativi Windows in cui è in esecuzione l'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="83d4b-119">Determine the security levels required for the Windows operating systems on which your client application runs.</span></span>
2.  <span data-ttu-id="83d4b-120">Chiamare la funzione COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) per impostare la sicurezza predefinita per il processo in cui viene eseguita l'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="83d4b-120">Call the COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function to set the default security for the process in which the client application runs.</span></span> <span data-ttu-id="83d4b-121">In questo modo viene dichiarata la sicurezza richiesta dalle altre applicazioni per accedere al processo in cui viene eseguita l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="83d4b-121">This declares how much security other applications require to access the process in which your application runs.</span></span>
3.  <span data-ttu-id="83d4b-122">Se è necessario modificare la sicurezza in un singolo proxy, ad esempio in un'altra chiamata a [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), chiamare [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span><span class="sxs-lookup"><span data-stu-id="83d4b-122">If you need to change the security on an individual proxy, for example on another call to [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), call [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span></span>
4.  <span data-ttu-id="83d4b-123">Se è necessario controllare l'hardware remoto o un oggetto di sistema che richiede un maggior numero di privilegi, utilizzare la funzione [**AdjustTokenPrivileges**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) per abilitare i privilegi necessari.</span><span class="sxs-lookup"><span data-stu-id="83d4b-123">If you need to control remote hardware or a system object that requires more privilege, use the [**AdjustTokenPrivileges**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) function to enable the necessary privileges.</span></span> <span data-ttu-id="83d4b-124">Si noti che non è possibile abilitare un privilegio a cui il processo non è già stato assegnato.</span><span class="sxs-lookup"><span data-stu-id="83d4b-124">Note that you cannot enable a privilege that the process does not already have assigned to it.</span></span> <span data-ttu-id="83d4b-125">Per ulteriori informazioni, vedere [controllo dell'accesso a oggetti privati](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span><span class="sxs-lookup"><span data-stu-id="83d4b-125">For more information, see [Checking Access to Private Objects](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span></span>

<span data-ttu-id="83d4b-126">Per ulteriori informazioni sull'impostazione del livello di sicurezza del processo predefinito, vedere Impostazione del livello di sicurezza [del processo predefinito mediante C++](setting-the-default-process-security-level-using-c-.md) e [impostazione del livello di sicurezza del processo predefinito tramite VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="83d4b-126">For further information about setting the default process security level, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md) and [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

 

 
