---
description: Non è più consigliabile usare le classi C++ WMI che fanno parte del Framework del provider WMI.
ms.assetid: d2414a72-3435-4035-bcd9-b3ec87f5709c
ms.tgt_platform: multiple
title: Classi di utilità del Framework del provider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cab09c99fe2597cacd81e55a4ed18bd4e286ff16
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106318551"
---
# <a name="provider-framework-utility-classes"></a><span data-ttu-id="d0e1f-103">Classi di utilità del Framework del provider</span><span class="sxs-lookup"><span data-stu-id="d0e1f-103">Provider Framework Utility Classes</span></span>

<span data-ttu-id="d0e1f-104">\[Classi C++ WMI che fanno parte del Framework del provider WMI, che è ora considerato nello stato finale e non sono disponibili ulteriori attività di sviluppo, miglioramenti o aggiornamenti per i problemi non correlati alla sicurezza che interessano queste librerie.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-104">\[WMI C++ classes that are part of the WMI Provider Framework which is now considered in final state, and no further development, enhancements, or updates will be available for non-security related issues affecting these libraries.</span></span> <span data-ttu-id="d0e1f-105">Le [API mi](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) devono essere usate per tutte le nuove attività di sviluppo.\]</span><span class="sxs-lookup"><span data-stu-id="d0e1f-105">The [MI APIs](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) should be used for all new development.\]</span></span>

<span data-ttu-id="d0e1f-106">Le librerie del Framework del provider Framedyd.dll (versione di debug) e Framedyn.dll (versione finale) implementano diverse classi helper del provider.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-106">The provider framework libraries Framedyd.dll (debug version) and Framedyn.dll (release version) implement several provider helper classes.</span></span> <span data-ttu-id="d0e1f-107">Alcune funzioni in Framedyn.dll sono state rimosse dai file di intestazione.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-107">Some functions in Framedyn.dll have been removed from the header files.</span></span> <span data-ttu-id="d0e1f-108">Per continuare a usare queste funzioni, aggiungere `#define FRAMEWORK_ALLOW_DEPRECATED` al codice prima di includere Fwcommon. h.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-108">To continue to use these functions, add `#define FRAMEWORK_ALLOW_DEPRECATED` to your code before including Fwcommon.h.</span></span>

<span data-ttu-id="d0e1f-109">È possibile scaricare i singoli provider che non sono più necessari.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-109">You can unload individual providers that are no longer required.</span></span>

<span data-ttu-id="d0e1f-110">Per usare questa funzionalità, è necessario apportare le tre modifiche seguenti al provider in MainDll. cpp:</span><span class="sxs-lookup"><span data-stu-id="d0e1f-110">To use this capability, you must make the three following changes to your provider in MainDll.cpp:</span></span>

-   <span data-ttu-id="d0e1f-111">Nella funzione **DllMain** in cui viene chiamato [**CWbemProviderGlue:: FrameworkLoginDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong)), è necessario aggiungere un secondo parametro che è un puntatore a un Long.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-111">In the function **DllMain** where you call [**CWbemProviderGlue::FrameworkLoginDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="d0e1f-112">Nella funzione **DllCanUnloadNow** dove si chiama [**CWbemProviderGlue:: FrameworkLogoffDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong)), è necessario aggiungere un secondo parametro che è un puntatore a Long.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-112">In the function **DllCanUnloadNow** where you call [**CWbemProviderGlue::FrameworkLogoffDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="d0e1f-113">Nella funzione **DllGetClassObject** in cui si crea un'istanza di **CWbemGlueFactory** è necessario aggiungere un parametro che è un puntatore a un Long.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-113">In the function **DllGetClassObject** where you create an instance of **CWbemGlueFactory**, you must add a parameter which is a pointer to a long.</span></span>

<span data-ttu-id="d0e1f-114">In tutti e tre i casi, il puntatore a un oggetto Long deve essere lo stesso puntatore.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-114">In all three cases, the pointer to a long must be the same pointer.</span></span>

> [!Note]  
> <span data-ttu-id="d0e1f-115">In maindll. cpp, le routine **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** e **DllMain** devono essere incapsulate in un blocco try/catch.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-115">In Maindll.cpp, **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** and **DllMain** routines must be wrapped in a try/catch block.</span></span>

 

> [!Caution]  
> <span data-ttu-id="d0e1f-116">Il collegamento delle build di debug del provider con Framedyd. lib per Framedyd.dll.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-116">Provider debug builds link with Framedyd.lib for Framedyd.dll.</span></span> <span data-ttu-id="d0e1f-117">Framedyd.dll si trova nella directory bin di Microsoft Windows Software Development Kit (SDK) \\ che non è inclusa nel percorso di sistema.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-117">Framedyd.dll is in the Microsoft Windows Software Development Kit (SDK) \\bin directory which is not included in the system path.</span></span> <span data-ttu-id="d0e1f-118">Quando una build di debug di un provider viene testata con il servizio di gestione Windows, il provider del Framework non verrà caricato perché Framedyd.dll o una delle relative dipendenze non verranno individuate.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-118">When a debug build of a provider is tested with the Windows Management service, the framework provider will fail to load because Framedyd.dll or one of its dependencies will not be located.</span></span> <span data-ttu-id="d0e1f-119">Pertanto, è necessario copiare Framedyd.dll dalla \\ directory Windows SDK bin alla \\ directory system32 di system32 \\ o aggiungere la directory Windows SDK \\ bin al percorso di ricerca del sistema.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-119">Therefore, you must either copy Framedyd.dll from the Windows SDK \\bin directory to the \\system32\\wbem directory or add the Windows SDK \\bin directory to the system search path.</span></span>

 

<span data-ttu-id="d0e1f-120">Nella tabella seguente sono elencate le classi di utilità del Framework del provider.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-120">The following table lists the provider framework utility classes.</span></span>



| <span data-ttu-id="d0e1f-121">Classe di utilità</span><span class="sxs-lookup"><span data-stu-id="d0e1f-121">Utility class</span></span>                                          | <span data-ttu-id="d0e1f-122">Descrizione</span><span class="sxs-lookup"><span data-stu-id="d0e1f-122">Description</span></span>                                                                                                                     |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d0e1f-123">**CHString**</span><span class="sxs-lookup"><span data-stu-id="d0e1f-123">**CHString**</span></span>](chstring.md)                           | <span data-ttu-id="d0e1f-124">Fornisce funzioni di confronto e manipolazione di stringhe per WMI.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-124">Provides string comparison and manipulation functions for WMI.</span></span>                                                                  |
| [<span data-ttu-id="d0e1f-125">**CHStringArray**</span><span class="sxs-lookup"><span data-stu-id="d0e1f-125">**CHStringArray**</span></span>](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray)                 | <span data-ttu-id="d0e1f-126">Contiene per la creazione e la modifica di matrici di CHString.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-126">Contains for creating and manipulating arrays of CHString.</span></span>                                                                      |
| [<span data-ttu-id="d0e1f-127">**TRefPointerCollection**</span><span class="sxs-lookup"><span data-stu-id="d0e1f-127">**TRefPointerCollection**</span></span>](/windows/desktop/api/RefPtrCo/nl-refptrco-trefpointercollection) | <span data-ttu-id="d0e1f-128">Concede l'accesso a una classe contenitore per i puntatori.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-128">Grants access to a container class for pointers.</span></span>                                                                                |
| [<span data-ttu-id="d0e1f-129">**WBEMTime**</span><span class="sxs-lookup"><span data-stu-id="d0e1f-129">**WBEMTime**</span></span>](wbemtime.md)                           | <span data-ttu-id="d0e1f-130">Semplifica le conversioni tra diversi formati di runtime del linguaggio C di Windows e ANSI.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-130">Facilitates conversions between various Windows and ANSI C run-time time formats.</span></span>                                               |
| [<span data-ttu-id="d0e1f-131">**WBEMTimeSpan**</span><span class="sxs-lookup"><span data-stu-id="d0e1f-131">**WBEMTimeSpan**</span></span>](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan)                   | <span data-ttu-id="d0e1f-132">Contiene funzioni helper utilizzate per calcolare e mantenere la differenza di intervallo di tempo tra due oggetti [**WBEMTime**](wbemtime.md) .</span><span class="sxs-lookup"><span data-stu-id="d0e1f-132">Contains helper functions used to calculate and hold the time span difference between two [**WBEMTime**](wbemtime.md) objects.</span></span> |



 

> [!Note]  
> <span data-ttu-id="d0e1f-133">Le classi [**CHString**](chstring.md) e [**CHStringArray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) sono simili a Microsoft Foundation Classes (MFC) **CString** e **CStringArray**.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-133">The [**CHString**](chstring.md) and [**CHStringArray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) classes are similar to the Microsoft Foundation Classes (MFC) **CString** and **CStringArray**.</span></span> <span data-ttu-id="d0e1f-134">Sono disponibili le versioni WMI in modo che gli sviluppatori possano accedere ai metodi di confronto e di manipolazione delle stringhe senza dover accedere a MFC.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-134">The WMI versions exist so that developers can access to string manipulation and comparison methods without having to access MFC.</span></span> <span data-ttu-id="d0e1f-135">Anche le classi [**WBEMTime**](wbemtime.md) e [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) sono simili alle classi **CTime** e **CTimeSpan** MFC.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-135">The [**WBEMTime**](wbemtime.md) and [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) classes are also similar to the MFC **CTime** and **CTimeSpan** classes.</span></span> <span data-ttu-id="d0e1f-136">Le versioni WMI sono in grado di archiviare tempi di accuratezza nanosecondi e possono anche eseguire la conversione da e verso **BSTR**.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-136">The WMI versions are capable of storing time to nanosecond accuracy, and can also convert to and from **BSTR**.</span></span> <span data-ttu-id="d0e1f-137">Per ulteriori informazioni sulle classi CString, CStringArray, CTime e CTimeSpan, vedere il [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) su MSDN.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-137">For more information about the CString, CStringArray, CTime, and CTimeSpan classes, see the [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) on MSDN.</span></span>

 

<span data-ttu-id="d0e1f-138">I valori **BSTR** restituiti dai metodi [**WBEMTime**](wbemtime.md) sono nel [formato di data e ora](date-and-time-format.md): "ad aaaammgghhmmss. mmmmmmsUUU"</span><span class="sxs-lookup"><span data-stu-id="d0e1f-138">**BSTR** values returned by [**WBEMTime**](wbemtime.md) methods are in [Date and Time Format](date-and-time-format.md): "yyyymmddHHMMSS.mmmmmmsUUU"</span></span>

<span data-ttu-id="d0e1f-139">I valori **BSTR** restituiti dai metodi [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) sono in [Formato intervallo](interval-format.md): "ddddddddHHMMSS. mmmmmm: 000"</span><span class="sxs-lookup"><span data-stu-id="d0e1f-139">**BSTR** values returned by [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) methods are in [Interval Format](interval-format.md): "ddddddddHHMMSS.mmmmmm:000"</span></span>

<span data-ttu-id="d0e1f-140">Sebbene i tempi e gli intervalli di tempo siano archiviati internamente come nanosecondi, non vengono necessariamente archiviati con una precisione di nanosecondi.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-140">Although times and time spans are stored internally as nanoseconds, they are not necessarily stored with nanosecond accuracy.</span></span> <span data-ttu-id="d0e1f-141">Ciò è dovuto al fatto che gli oggetti [**WBEMTime**](wbemtime.md) possono essere costruiti utilizzando formati di ora accurati a un secondo (**struct TM** e **time \_ t**).</span><span class="sxs-lookup"><span data-stu-id="d0e1f-141">This is because [**WBEMTime**](wbemtime.md) objects can be constructed using time formats that are accurate to a second (**struct tm**, and **time\_t**).</span></span> <span data-ttu-id="d0e1f-142">L'aggiunta di posizioni decimali artificiali non aumenta l'accuratezza.</span><span class="sxs-lookup"><span data-stu-id="d0e1f-142">Adding artificial decimal places does not increase the accuracy.</span></span>

 

 
