---
description: Un provider WMI è costituito da un file Managed Object Format (MOF) e da un file DLL. Il file MOF definisce le classi per le quali l'implementazione del provider fornisce i dati.
ms.assetid: 20ef6b88-2aaa-4e86-bc4a-bebc34069672
ms.tgt_platform: multiple
title: Progettazione di classi Managed Object Format (MOF)
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 201f8c45f7a247fbca5695baa6dd440fc5dc323f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104232405"
---
# <a name="designing-managed-object-format-mof-classes"></a><span data-ttu-id="b860a-104">Progettazione di classi Managed Object Format (MOF)</span><span class="sxs-lookup"><span data-stu-id="b860a-104">Designing Managed Object Format (MOF) Classes</span></span>

<span data-ttu-id="b860a-105">Un [*provider WMI*](gloss-p.md) è costituito da un file Managed Object Format (MOF) e da un file dll.</span><span class="sxs-lookup"><span data-stu-id="b860a-105">A [*WMI provider*](gloss-p.md) consists of a Managed Object Format (MOF) file and DLL file.</span></span> <span data-ttu-id="b860a-106">Il file MOF definisce le classi per le quali l'implementazione del provider fornisce i dati.</span><span class="sxs-lookup"><span data-stu-id="b860a-106">The MOF file defines the classes for which the provider implementation supplies data.</span></span>

<span data-ttu-id="b860a-107">Le definizioni delle classi MOF vengono compilate dall'utilità [**mofcomp**](mofcomp.md) e archiviate nel [*repository WMI*](gloss-w.md), noto anche come repository Common Information Model (CIM).</span><span class="sxs-lookup"><span data-stu-id="b860a-107">The MOF class definitions are compiled by the [**mofcomp**](mofcomp.md) utility and stored in the [*WMI repository*](gloss-w.md), also known as the Common Information Model (CIM) repository.</span></span> <span data-ttu-id="b860a-108">Un modo meno comune per creare classi consiste nell'usare i metodi dell' [API com per WMI](com-api-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-108">A less common way to create classes is through the methods of the [COM API for WMI](com-api-for-wmi.md).</span></span>

> [!Note]  
> <span data-ttu-id="b860a-109">Per assicurarsi che tutte le definizioni di classe WMI per gli oggetti gestiti vengano ripristinate nel [*repository WMI*](gloss-w.md) se WMI presenta un errore e viene riavviato, usare l'istruzione del preprocessore [**\# pragma autocover**](pragma-autorecover.md) nel file MOF.</span><span class="sxs-lookup"><span data-stu-id="b860a-109">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your MOF file.</span></span>

 

<span data-ttu-id="b860a-110">Le sezioni seguenti sono illustrate in questo argomento:</span><span class="sxs-lookup"><span data-stu-id="b860a-110">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="b860a-111">Definizione degli oggetti da gestire</span><span class="sxs-lookup"><span data-stu-id="b860a-111">Defining the Objects to Manage</span></span>](#defining-the-objects-to-manage)
-   [<span data-ttu-id="b860a-112">Definizione di proprietà o metodi</span><span class="sxs-lookup"><span data-stu-id="b860a-112">Defining Properties or Methods</span></span>](#defining-properties-or-methods)
-   [<span data-ttu-id="b860a-113">Correlazione tra oggetti</span><span class="sxs-lookup"><span data-stu-id="b860a-113">Relating Objects to Each Other</span></span>](#relating-objects-to-each-other)
-   [<span data-ttu-id="b860a-114">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b860a-114">Related topics</span></span>](#related-topics)

## <a name="defining-the-objects-to-manage"></a><span data-ttu-id="b860a-115">Definizione degli oggetti da gestire</span><span class="sxs-lookup"><span data-stu-id="b860a-115">Defining the Objects to Manage</span></span>

<span data-ttu-id="b860a-116">Dopo aver identificato la parte dell'organizzazione da gestire, definire gli oggetti da gestire.</span><span class="sxs-lookup"><span data-stu-id="b860a-116">After you identify the part of your enterprise to manage, define the objects to manage.</span></span> <span data-ttu-id="b860a-117">La definizione deve includere i dati necessari e consente di implementare accuratamente le regole business pertinenti.</span><span class="sxs-lookup"><span data-stu-id="b860a-117">The definition must include the required data, and allow you to implement the relevant business rules accurately.</span></span> <span data-ttu-id="b860a-118">È possibile definire oggetti a livello granulare, ma è preferibile decidere tra il livello di dettaglio contenuto nella definizione e la necessità di fornire dettagli sufficienti per essere utili.</span><span class="sxs-lookup"><span data-stu-id="b860a-118">You can define objects at a granular level, but it is best to decide between the level of detail contained in the definition, and the need to provide enough detail to be useful.</span></span> <span data-ttu-id="b860a-119">I collegamenti nelle fasi iniziali del processo possono risparmiare tempo, ma potrebbero causare un maggiore lavoro in futuro.</span><span class="sxs-lookup"><span data-stu-id="b860a-119">Shortcuts early in the process may save time, but may be cause more work in the future.</span></span>

<span data-ttu-id="b860a-120">L'esercitazione CIM nel sito Web Distributed Management Task Force (DMTF) contiene informazioni ottimali sul processo di progettazione.</span><span class="sxs-lookup"><span data-stu-id="b860a-120">The CIM Tutorial at the Distributed Management Task Force (DMTF) website contains excellent information about the design process.</span></span> <span data-ttu-id="b860a-121">Per ulteriori informazioni, vedere [www.DMTF.org](https://www.dmtf.org/).</span><span class="sxs-lookup"><span data-stu-id="b860a-121">For more information, see [www.dmtf.org](https://www.dmtf.org/).</span></span>

<span data-ttu-id="b860a-122">Quando si sviluppa e si implementa una progettazione dello schema, tenere presenti i seguenti fattori:</span><span class="sxs-lookup"><span data-stu-id="b860a-122">Consider the following factors when you develop and implement a schema design:</span></span>

-   <span data-ttu-id="b860a-123">Qualificatori</span><span class="sxs-lookup"><span data-stu-id="b860a-123">Qualifiers</span></span>

    <span data-ttu-id="b860a-124">I qualificatori forniscono informazioni su come descrivere classi, oggetti, proprietà, metodi e parametri. e vengono applicati alle definizioni di classi e proprietà.</span><span class="sxs-lookup"><span data-stu-id="b860a-124">Qualifiers provide information about how to describe classes, objects, properties, methods, and parameters; and they are applied to class and property definitions.</span></span> <span data-ttu-id="b860a-125">Nel codice MOF i qualificatori sono racchiusi tra parentesi quadre e possono includere la \[ chiave \] o l' \[ associazione \] .</span><span class="sxs-lookup"><span data-stu-id="b860a-125">In MOF code, qualifiers are enclosed in brackets and may include \[key\] or \[association\].</span></span> <span data-ttu-id="b860a-126">Per ulteriori informazioni, vedere [aggiunta di un qualificatore](adding-a-qualifier.md) e [qualificatori WMI](wmi-qualifiers.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-126">For more information, see [Adding a Qualifier](adding-a-qualifier.md) and [WMI Qualifiers](wmi-qualifiers.md).</span></span>

-   <span data-ttu-id="b860a-127">Spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="b860a-127">Namespace</span></span>

    <span data-ttu-id="b860a-128">Uno spazio dei nomi è un'unità logica per raggruppare classi e oggetti, nonché l'ambito e la visibilità del controllo.</span><span class="sxs-lookup"><span data-stu-id="b860a-128">A namespace is a logical unit to group classes and objects, and control scope and visibility.</span></span> <span data-ttu-id="b860a-129">In genere, uno spazio dei nomi contiene un set di classi e oggetti che rappresentano oggetti gestiti in un ambiente specifico.</span><span class="sxs-lookup"><span data-stu-id="b860a-129">Typically, a namespace contains a set of classes and objects that represent managed objects in a specific environment.</span></span> <span data-ttu-id="b860a-130">Per ulteriori informazioni, vedere [creazione di gerarchie all'interno di WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-130">For more information, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

-   <span data-ttu-id="b860a-131">Oggetto</span><span class="sxs-lookup"><span data-stu-id="b860a-131">Object</span></span>

    <span data-ttu-id="b860a-132">Un oggetto modellato può essere un elemento fisico o logico dello schema.</span><span class="sxs-lookup"><span data-stu-id="b860a-132">A modeled object might be a physical or logical element of the schema.</span></span> <span data-ttu-id="b860a-133">Ad esempio, è possibile modellare un'unità disco fisica, ad esempio un'unità disco rigido, o un disco logico che può essere una partizione su un disco fisico.</span><span class="sxs-lookup"><span data-stu-id="b860a-133">For example, you can model a physical disk drive such as a hard disk drive, or a logical disk that can be a partition on a physical disk.</span></span> <span data-ttu-id="b860a-134">Una progettazione che utilizza una classe per modellare un'unità disco fisica e quindi estende tale classe per modellare un disco logico è più estendibile di quella che tenta di creare una classe separata per ogni tipo di disco.</span><span class="sxs-lookup"><span data-stu-id="b860a-134">A design that uses a class to model a physical disk drive, and then extends that class to model a logical disk is more extensible than one that attempts to create a separate class for each type of disk.</span></span>

-   <span data-ttu-id="b860a-135">Data</span><span class="sxs-lookup"><span data-stu-id="b860a-135">Data</span></span>

    <span data-ttu-id="b860a-136">I dati possono essere dinamici o statici.</span><span class="sxs-lookup"><span data-stu-id="b860a-136">Data may be dynamic or static.</span></span> <span data-ttu-id="b860a-137">Se i dati sono dinamici, è necessario creare un provider di classi per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="b860a-137">If the data is dynamic, you must create a class provider for it.</span></span>

    <span data-ttu-id="b860a-138">Per consentire all'utente di modificare i dati, è necessario determinare se si desidera che una proprietà sia direttamente scrivibile o modificabile solo utilizzando un metodo chiamato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="b860a-138">To enable the user to modify data, you must determine whether or not you want a property to be directly writable or modifiable only by using a method that the user calls.</span></span>

## <a name="defining-properties-or-methods"></a><span data-ttu-id="b860a-139">Definizione di proprietà o metodi</span><span class="sxs-lookup"><span data-stu-id="b860a-139">Defining Properties or Methods</span></span>

<span data-ttu-id="b860a-140">In genere, una proprietà della classe WMI è simile a una proprietà in una classe C++.</span><span class="sxs-lookup"><span data-stu-id="b860a-140">Generally, a WMI class property is similar to a property in a C++ class.</span></span> <span data-ttu-id="b860a-141">Se le uniche azioni implementate dal codice per i dati sono l'ottenimento del valore o l'impostazione del valore, i dati devono essere definiti come proprietà della classe WMI.</span><span class="sxs-lookup"><span data-stu-id="b860a-141">If the only actions your code implements for the piece of data is to get the value or set the value, then the data should be defined as a property of the WMI class.</span></span>

<span data-ttu-id="b860a-142">Un metodo WMI esegue in genere un'azione che modifica lo stato di un oggetto gestito.</span><span class="sxs-lookup"><span data-stu-id="b860a-142">A WMI method generally performs an action that changes the state of a managed object.</span></span> <span data-ttu-id="b860a-143">Se, ad esempio, l'azione prevede l'abilitazione o la disabilitazione dell'operazione di un oggetto hardware, un metodo è probabilmente preferibile alla creazione di una proprietà di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="b860a-143">For example, if the action is to enable or disable the operation of a hardware object, then a method is probably preferable to creating a read/write property.</span></span> <span data-ttu-id="b860a-144">È anche possibile decidere di creare una proprietà che visualizza lo stato dell'hardware.</span><span class="sxs-lookup"><span data-stu-id="b860a-144">You may decide also to create a property that displays the state of the hardware.</span></span>

<span data-ttu-id="b860a-145">Quando si crea una classe o un'istanza di, è possibile includere commenti.</span><span class="sxs-lookup"><span data-stu-id="b860a-145">When you create a class or an instance, you can include comments.</span></span> <span data-ttu-id="b860a-146">Usare questa tecnica per documentare la classe o spiegare le tecniche di programmazione.</span><span class="sxs-lookup"><span data-stu-id="b860a-146">Use this technique to document your class or explain your programming techniques.</span></span> <span data-ttu-id="b860a-147">Per ulteriori informazioni, vedere [creazione di un commento](creating-a-comment.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-147">For more information, see [Creating a Comment](creating-a-comment.md).</span></span> <span data-ttu-id="b860a-148">Inoltre, è possibile aggiungere dati per qualificare lo scopo di un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="b860a-148">In addition, you can add data to qualify the purpose of a data object.</span></span> <span data-ttu-id="b860a-149">Per ulteriori informazioni, vedere [aggiunta di un qualificatore](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-149">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="relating-objects-to-each-other"></a><span data-ttu-id="b860a-150">Correlazione tra oggetti</span><span class="sxs-lookup"><span data-stu-id="b860a-150">Relating Objects to Each Other</span></span>

<span data-ttu-id="b860a-151">Esistono due modi per correlare gli oggetti tra loro: creando oggetti separati e un oggetto di associazione che li mette in correlazione o incorporando un oggetto nell'altro.</span><span class="sxs-lookup"><span data-stu-id="b860a-151">There are two ways to relate objects to each other: by creating separate objects and an association object that relates them, or by embedding one object in the other.</span></span> <span data-ttu-id="b860a-152">CIM non supporta gli oggetti incorporati, pertanto è necessario utilizzare il primo metodo per essere conforme a CIM.</span><span class="sxs-lookup"><span data-stu-id="b860a-152">CIM does not support embedded objects, so to be CIM-compliant you must use the first method.</span></span> <span data-ttu-id="b860a-153">Tuttavia, WMI supporta oggetti incorporati, quindi utilizzare uno di questi metodi per rappresentare una relazione tra oggetti.</span><span class="sxs-lookup"><span data-stu-id="b860a-153">However, WMI supports embedded objects so use either method to represent a relationship between objects.</span></span> <span data-ttu-id="b860a-154">È possibile trovare esempi di oggetti incorporati nelle [classi Win32](/windows/desktop/CIMWin32Prov/win32-provider).</span><span class="sxs-lookup"><span data-stu-id="b860a-154">You can find examples of embedded objects in the [Win32 Classes](/windows/desktop/CIMWin32Prov/win32-provider).</span></span> <span data-ttu-id="b860a-155">Ad esempio, [**Win32 \_ securityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) ha l'oggetto incorporato [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), che ha un altro oggetto incorporato [**, \_ trustee Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span><span class="sxs-lookup"><span data-stu-id="b860a-155">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) has the embedded object [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace), which has another embedded object, [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee).</span></span>

<span data-ttu-id="b860a-156">Quando si decide come rappresentare le relazioni tra oggetti, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="b860a-156">Consider the following when deciding how to represent relationships between objects:</span></span>

-   <span data-ttu-id="b860a-157">Se un'istanza è utile da sola, un'associazione funziona in modo ottimale.</span><span class="sxs-lookup"><span data-stu-id="b860a-157">If an instance is useful by itself, then an association works best.</span></span> <span data-ttu-id="b860a-158">Ad esempio, [**Win32 \_ Process**](/windows/desktop/CIMWin32Prov/win32-process) e [**Win32 \_ AccountUtente**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span><span class="sxs-lookup"><span data-stu-id="b860a-158">For example, [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) and [**Win32\_UserAccount**](/windows/desktop/CIMWin32Prov/win32-useraccount).</span></span> <span data-ttu-id="b860a-159">Per ulteriori informazioni, vedere [dichiarazione di una classe di associazione](declaring-an-association-class.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-159">For more information, see [Declaring an Association Class](declaring-an-association-class.md).</span></span>
-   <span data-ttu-id="b860a-160">Se un'istanza non esiste all'esterno dell'oggetto padre, un oggetto incorporato funziona in modo ottimale.</span><span class="sxs-lookup"><span data-stu-id="b860a-160">If an instance does not exist outside of the parent object, an embedded object works best.</span></span> <span data-ttu-id="b860a-161">Ad esempio [**Win32 \_ securityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) e [**Win32 \_ ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span><span class="sxs-lookup"><span data-stu-id="b860a-161">For example, [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor) and [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace).</span></span> <span data-ttu-id="b860a-162">Per altre informazioni, vedere [incorporamento di oggetti in una classe](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b860a-162">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b860a-163">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b860a-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b860a-164">Sviluppo di un provider WMI</span><span class="sxs-lookup"><span data-stu-id="b860a-164">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="b860a-165">Invio di dati a WMI</span><span class="sxs-lookup"><span data-stu-id="b860a-165">Providing Data to WMI</span></span>](providing-data-to-wmi.md)
</dt> <dt>

[<span data-ttu-id="b860a-166">Tipi di dati MOF</span><span class="sxs-lookup"><span data-stu-id="b860a-166">MOF Data Types</span></span>](mof-data-types.md)
</dt> </dl>

 

 
