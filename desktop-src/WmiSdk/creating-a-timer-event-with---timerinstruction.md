---
description: Si crea un evento timer creando un'istanza delle classi derivate dalla \_ \_ classe TimerInstruction in qualsiasi spazio dei nomi WMI.
ms.assetid: 3df2a75a-5231-40d7-ae9d-a7a735fbf316
ms.tgt_platform: multiple
title: Creazione di un evento timer con __TimerInstruction
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e502678525569dae272edb7b03c0916db25edfd0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104233468"
---
# <a name="creating-a-timer-event-with-__timerinstruction"></a><span data-ttu-id="e1f8f-103">Creazione di un evento timer con \_ \_ TimerInstruction</span><span class="sxs-lookup"><span data-stu-id="e1f8f-103">Creating a Timer Event with \_\_TimerInstruction</span></span>

<span data-ttu-id="e1f8f-104">Si crea un evento timer creando un'istanza delle classi derivate dalla classe [**\_ \_ TimerInstruction**](--timerinstruction.md) in qualsiasi spazio dei nomi WMI.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-104">You create a timer event by creating an instance of classes derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class in any WMI namespace.</span></span> <span data-ttu-id="e1f8f-105">WMI genera quindi l'evento timer al momento appropriato.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-105">WMI then generates the timer event at the appropriate time.</span></span> <span data-ttu-id="e1f8f-106">Se si perde un evento timer a causa di tempi di inattività del computer, WMI invia una notifica all'utente sull'evento mancante.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-106">If you miss a timer event due to computer downtime, WMI notifies you about the missed event.</span></span> <span data-ttu-id="e1f8f-107">WMI supporta gli eventi timer per la compatibilità con le versioni precedenti e per gli scenari in cui è necessario verificare il numero di eventi mancanti dall'ultimo evento recapitato.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-107">WMI supports timer events for backward compatibility and for scenarios where you must know how many events you have missed since the last delivered event.</span></span> <span data-ttu-id="e1f8f-108">Per la maggior parte degli eventi timer, tuttavia, è necessario creare un filtro eventi per [**Win32 \_ localtime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) o [**\_ UTCTime Win32**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span><span class="sxs-lookup"><span data-stu-id="e1f8f-108">For most timer events, however, you should create an event filter for [**Win32\_LocalTime**](/previous-versions/windows/desktop/wmitimepprov/win32-localtime) or [**Win32\_UTCTime**](/previous-versions/windows/desktop/wmitimepprov/win32-utctime).</span></span> <span data-ttu-id="e1f8f-109">Per ulteriori informazioni, vedere [creazione di un evento timer con Win32 \_ LocalTime o Win32 \_ UTCTime](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span><span class="sxs-lookup"><span data-stu-id="e1f8f-109">For more information, see [Creating a Timer Event with Win32\_LocalTime or Win32\_UTCTime](creating-a-timer-event-with-win32-localtime-or-win32-utctime.md).</span></span>

<span data-ttu-id="e1f8f-110">Nella procedura seguente viene descritto come creare e ricevere un evento timer con \_ \_ TimerInstruction.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-110">The following procedure describes how to create and receive a timer event with \_\_TimerInstruction.</span></span>

<span data-ttu-id="e1f8f-111">**Per creare e ricevere un evento timer con \_ \_ TimerInstruction**</span><span class="sxs-lookup"><span data-stu-id="e1f8f-111">**To create and receive a timer event with \_\_TimerInstruction**</span></span>

1.  <span data-ttu-id="e1f8f-112">Creare un'istanza delle classi [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) o [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) .</span><span class="sxs-lookup"><span data-stu-id="e1f8f-112">Create an instance of the [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) or [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes.</span></span>

    <span data-ttu-id="e1f8f-113">Le classi [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) e [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) sono derivate dalla classe [**\_ \_ TimerInstruction**](--timerinstruction.md) , che contiene una stringa assegnata dallo sviluppatore univoca che identifica il tipo di evento del timer.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-113">The [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) and [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) classes are derived from the [**\_\_TimerInstruction**](--timerinstruction.md) class, which contains a unique developer-assigned string that identifies the type of timer event.</span></span> <span data-ttu-id="e1f8f-114">La classe **\_ \_ TimerInstruction** contiene inoltre un valore che specifica se WMI deve inviare una notifica tardiva se l'evento timer si verifica quando WMI non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-114">The **\_\_TimerInstruction** class also contains a value that specifies whether WMI should send a belated notification if the timer event occurs when WMI is unavailable.</span></span>

    <span data-ttu-id="e1f8f-115">Usare [**\_ \_ AbsoluteTimerInstruction**](--absolutetimerinstruction.md) per inviare eventi del timer assoluti, che si verificano in una data specifica in un momento specifico.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-115">Use [**\_\_AbsoluteTimerInstruction**](--absolutetimerinstruction.md) to send absolute timer events, which occur on a specific date at a specific time.</span></span> <span data-ttu-id="e1f8f-116">Usare [**\_ \_ IntervalTimerInstruction**](--intervaltimerinstruction.md) per inviare eventi timer di intervallo, che si verificano regolarmente.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-116">Use [**\_\_IntervalTimerInstruction**](--intervaltimerinstruction.md) to send interval timer events, which occur on a regular basis.</span></span>

2.  <span data-ttu-id="e1f8f-117">Impostare l'applicazione in modo che riceva un'istanza di [**\_ \_ TimerEvent**](--timerevent.md) .</span><span class="sxs-lookup"><span data-stu-id="e1f8f-117">Set your application to receive a [**\_\_TimerEvent**](--timerevent.md) instance.</span></span>

    <span data-ttu-id="e1f8f-118">Per generare un evento, WMI crea un'istanza della classe [**\_ \_ TimerEvent**](--timerevent.md) e la trasmette al consumer.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-118">To generate an event, WMI creates an instance of the [**\_\_TimerEvent**](--timerevent.md) class and forwards the instance to your consumer.</span></span> <span data-ttu-id="e1f8f-119">L'istanza di **\_ \_ TimerEvent** contiene l'identificatore dell'istruzione del timer del consumer.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-119">The **\_\_TimerEvent** instance contains the timer instruction identifier from the consumer.</span></span> <span data-ttu-id="e1f8f-120">L'istanza contiene inoltre un valore che specifica il numero di volte in cui WMI deve inviare la notifica degli eventi del timer durante qualsiasi intervallo quando WMI non riesce a raggiungere il consumer.</span><span class="sxs-lookup"><span data-stu-id="e1f8f-120">The instance also contains a value that specifies how many times WMI should send the timer event notification during any interval when WMI cannot reach the consumer.</span></span>

 

 
