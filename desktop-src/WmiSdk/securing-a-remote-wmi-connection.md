---
description: Per connettersi a un computer remoto tramite WMI, verificare che le impostazioni di sicurezza dello spazio dei nomi WMI e delle impostazioni DCOM corrette siano abilitate per la connessione.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Protezione di una connessione WMI remota
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528495"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="14a41-103">Protezione di una connessione WMI remota</span><span class="sxs-lookup"><span data-stu-id="14a41-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="14a41-104">Per connettersi a un computer remoto tramite WMI, verificare che le impostazioni di sicurezza dello spazio dei nomi WMI e delle impostazioni DCOM corrette siano abilitate per la connessione.</span><span class="sxs-lookup"><span data-stu-id="14a41-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="14a41-105">In WMI sono disponibili impostazioni predefinite per la rappresentazione, l'autenticazione e il servizio di autenticazione (NTLM o Kerberos) richieste dal computer di destinazione in una connessione remota.</span><span class="sxs-lookup"><span data-stu-id="14a41-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="14a41-106">Il computer locale può utilizzare impostazioni predefinite diverse che non vengono accettate dal sistema di destinazione.</span><span class="sxs-lookup"><span data-stu-id="14a41-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="14a41-107">È possibile modificare queste impostazioni nella chiamata di connessione.</span><span class="sxs-lookup"><span data-stu-id="14a41-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="14a41-108">Le sezioni seguenti sono illustrate in questo argomento:</span><span class="sxs-lookup"><span data-stu-id="14a41-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="14a41-109">Impostazioni di autenticazione e rappresentazione DCOM per WMI</span><span class="sxs-lookup"><span data-stu-id="14a41-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="14a41-110">Impostazione della sicurezza DCOM per consentire a un utente di accedere a un computer in modalità remota</span><span class="sxs-lookup"><span data-stu-id="14a41-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="14a41-111">Consentire agli utenti di accedere a uno spazio dei nomi WMI specifico</span><span class="sxs-lookup"><span data-stu-id="14a41-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="14a41-112">Impostazione della sicurezza dello spazio dei nomi per richiedere la crittografia dei dati per le connessioni remote</span><span class="sxs-lookup"><span data-stu-id="14a41-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="14a41-113">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="14a41-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="14a41-114">Impostazioni di autenticazione e rappresentazione DCOM per WMI</span><span class="sxs-lookup"><span data-stu-id="14a41-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="14a41-115">In WMI sono disponibili impostazioni predefinite per la rappresentazione DCOM, l'autenticazione e il servizio di autenticazione (NTLM o Kerberos) richieste dal sistema remoto.</span><span class="sxs-lookup"><span data-stu-id="14a41-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="14a41-116">Il sistema locale può utilizzare impostazioni predefinite diverse che non vengono accettate dal sistema remoto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="14a41-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="14a41-117">È possibile modificare queste impostazioni nella chiamata di connessione.</span><span class="sxs-lookup"><span data-stu-id="14a41-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="14a41-118">Per ulteriori informazioni, vedere [impostazione della sicurezza del processo dell'applicazione client](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="14a41-119">Per il servizio di autenticazione, tuttavia, è consigliabile specificare il **\_ \_ \_ valore predefinito** di autenticazione di RPC C e consentire a DCOM di scegliere il servizio appropriato per il computer di destinazione.</span><span class="sxs-lookup"><span data-stu-id="14a41-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="14a41-120">È possibile specificare le impostazioni nei parametri per le chiamate a [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) o [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span><span class="sxs-lookup"><span data-stu-id="14a41-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="14a41-121">Negli script è possibile definire impostazioni di sicurezza nelle chiamate a [**SWbemLocator. ConnectServer**](swbemlocator-connectserver.md), in un oggetto [**SWbemSecurity**](swbemsecurity.md) o nella stringa del [moniker](constructing-a-moniker-string.md) di scripting.</span><span class="sxs-lookup"><span data-stu-id="14a41-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="14a41-122">Per un elenco di tutte le costanti di rappresentazione C++, vedere [impostazione del livello di sicurezza del processo predefinito con c++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="14a41-123">Per le costanti Visual Basic e le stringhe di scripting per l'utilizzo della connessione del moniker, vedere [impostazione del livello di sicurezza del processo predefinito tramite VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="14a41-124">Nella tabella seguente sono elencate le impostazioni predefinite del servizio di autenticazione, autenticazione e rappresentazione DCOM richieste dal computer di destinazione (computer B) in una connessione remota.</span><span class="sxs-lookup"><span data-stu-id="14a41-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="14a41-125">Per ulteriori informazioni, vedere protezione di una connessione WMI remota.</span><span class="sxs-lookup"><span data-stu-id="14a41-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="14a41-126">Sistema operativo del computer B</span><span class="sxs-lookup"><span data-stu-id="14a41-126">Computer B operating system</span></span> | <span data-ttu-id="14a41-127">Stringa di scripting del livello di rappresentazione</span><span class="sxs-lookup"><span data-stu-id="14a41-127">Impersonation level scripting string</span></span> | <span data-ttu-id="14a41-128">Stringa di scripting del livello di autenticazione</span><span class="sxs-lookup"><span data-stu-id="14a41-128">Authentication level scripting string</span></span> | <span data-ttu-id="14a41-129">Servizio di autenticazione</span><span class="sxs-lookup"><span data-stu-id="14a41-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="14a41-130">Windows Vista o versioni successive</span><span class="sxs-lookup"><span data-stu-id="14a41-130">Windows Vista or later</span></span>      | <span data-ttu-id="14a41-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="14a41-131">Impersonate</span></span>                          | <span data-ttu-id="14a41-132">PKT</span><span class="sxs-lookup"><span data-stu-id="14a41-132">Pkt</span></span>                                   | <span data-ttu-id="14a41-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="14a41-133">Kerberos</span></span>               |



 

<span data-ttu-id="14a41-134">Le connessioni remote WMI sono interessate da [controllo dell'account utente (UAC)](/previous-versions/aa905108(v=msdn.10)) e [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span><span class="sxs-lookup"><span data-stu-id="14a41-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="14a41-135">Per ulteriori informazioni, vedere [connessione a WMI in modalità remota a partire da vista](connecting-to-wmi-remotely-starting-with-vista.md) e [connessione tramite Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="14a41-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="14a41-136">Tenere presente che la connessione a WMI nel computer locale dispone di un livello di autenticazione predefinito di **su PktPrivacy**.</span><span class="sxs-lookup"><span data-stu-id="14a41-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="14a41-137">Impostazione della sicurezza DCOM per consentire a un utente di accedere a un computer in modalità remota</span><span class="sxs-lookup"><span data-stu-id="14a41-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="14a41-138">La sicurezza in WMI è correlata alla connessione a uno spazio dei nomi WMI.</span><span class="sxs-lookup"><span data-stu-id="14a41-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="14a41-139">WMI utilizza DCOM per gestire le chiamate remote.</span><span class="sxs-lookup"><span data-stu-id="14a41-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="14a41-140">Un motivo per cui non è possibile connettersi a un computer remoto è dovuto a un errore DCOM (errore "accesso DCOM negato" decimale-2147024891 o esadecimale 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="14a41-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="14a41-141">Per ulteriori informazioni sulla sicurezza DCOM in WMI per le applicazioni C++, vedere [impostazione della sicurezza del processo dell'applicazione client](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="14a41-142">È possibile configurare le impostazioni DCOM per WMI utilizzando l'utilità di configurazione DCOM (**DCOMCnfg.exe**) disponibile in **strumenti di amministrazione** nel **Pannello di controllo**.</span><span class="sxs-lookup"><span data-stu-id="14a41-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="14a41-143">Questa utilità espone le impostazioni che consentono a determinati utenti di connettersi al computer in modalità remota tramite DCOM.</span><span class="sxs-lookup"><span data-stu-id="14a41-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="14a41-144">Per impostazione predefinita, i membri del gruppo Administrators possono connettersi in remoto al computer.</span><span class="sxs-lookup"><span data-stu-id="14a41-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="14a41-145">Con questa utilità è possibile impostare la sicurezza per l'avvio, l'accesso e la configurazione del servizio WMI.</span><span class="sxs-lookup"><span data-stu-id="14a41-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="14a41-146">Nella procedura seguente viene descritto come concedere le autorizzazioni di avvio e attivazione remota DCOM per determinati utenti e gruppi.</span><span class="sxs-lookup"><span data-stu-id="14a41-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="14a41-147">Se il computer A si connette in modalità remota al computer B, è possibile impostare queste autorizzazioni sul computer B per consentire a un utente o a un gruppo che non fa parte del gruppo Administrators nel computer B di eseguire chiamate di avvio e attivazione DCOM sul computer B.</span><span class="sxs-lookup"><span data-stu-id="14a41-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="14a41-148">**Per concedere autorizzazioni di avvio e attivazione remote DCOM per un utente o un gruppo**</span><span class="sxs-lookup"><span data-stu-id="14a41-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="14a41-149">Fare clic sul pulsante **Start**, scegliere **Esegui**, digitare **DCOMCNFG**, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="14a41-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="14a41-150">Nella finestra di dialogo **Servizi componenti** espandere **Servizi componenti**, espandere **computer**, quindi fare clic con il pulsante destro del mouse su **computer locale** e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="14a41-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="14a41-151">Nella finestra di dialogo **proprietà computer locale** fare clic sulla scheda **protezione com** .</span><span class="sxs-lookup"><span data-stu-id="14a41-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="14a41-152">In **Autorizzazioni di esecuzione e attivazione**, fare clic su **Modifica limiti**.</span><span class="sxs-lookup"><span data-stu-id="14a41-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="14a41-153">Nella finestra di dialogo **autorizzazione di avvio** , attenersi alla procedura seguente se il nome o il gruppo non viene visualizzato nell' **elenco gruppi o nomi utente**:</span><span class="sxs-lookup"><span data-stu-id="14a41-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="14a41-154">Nella finestra di dialogo **autorizzazione di avvio** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="14a41-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="14a41-155">Nella finestra di dialogo **Seleziona utenti, computer o gruppi** , aggiungere il nome e il gruppo nella casella **immettere i nomi degli oggetti da selezionare** , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="14a41-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="14a41-156">Nella finestra di dialogo **autorizzazione di avvio** selezionare l'utente e il gruppo nella casella **nome gruppo o utente** .</span><span class="sxs-lookup"><span data-stu-id="14a41-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="14a41-157">Nella colonna **Consenti** in **autorizzazioni per utente** Selezionare **avvio remoto** e selezionare **attivazione remota**, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="14a41-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="14a41-158">Nella procedura seguente viene descritto come concedere le autorizzazioni di accesso remoto DCOM per determinati utenti e gruppi.</span><span class="sxs-lookup"><span data-stu-id="14a41-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="14a41-159">Se il computer A si connette in modalità remota al computer B, è possibile impostare queste autorizzazioni sul computer B per consentire a un utente o a un gruppo che non fa parte del gruppo Administrators nel computer B di connettersi al computer B.</span><span class="sxs-lookup"><span data-stu-id="14a41-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="14a41-160">**Per concedere autorizzazioni di accesso remoto DCOM**</span><span class="sxs-lookup"><span data-stu-id="14a41-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="14a41-161">Fare clic sul pulsante **Start**, scegliere **Esegui**, digitare **DCOMCNFG**, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="14a41-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="14a41-162">Nella finestra di dialogo **Servizi componenti** espandere **Servizi componenti**, espandere **computer**, quindi fare clic con il pulsante destro del mouse su **computer locale** e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="14a41-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="14a41-163">Nella finestra di dialogo **proprietà computer locale** fare clic sulla scheda **protezione com** .</span><span class="sxs-lookup"><span data-stu-id="14a41-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="14a41-164">In **Autorizzazioni di accesso**, fare clic su **Modifica limiti**.</span><span class="sxs-lookup"><span data-stu-id="14a41-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="14a41-165">Nella finestra di dialogo **autorizzazioni di accesso** selezionare nome **accesso anonimo** nella casella nome **gruppo o utente** .</span><span class="sxs-lookup"><span data-stu-id="14a41-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="14a41-166">Nella colonna **Consenti** in **autorizzazioni per utente** Selezionare **accesso remoto** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="14a41-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="14a41-167">Consentire agli utenti di accedere a uno spazio dei nomi WMI specifico</span><span class="sxs-lookup"><span data-stu-id="14a41-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="14a41-168">È possibile consentire o impedire agli utenti di accedere a uno specifico spazio dei nomi WMI impostando l'autorizzazione "Remote Enable" nel controllo WMI per uno spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="14a41-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="14a41-169">Se un utente tenta di connettersi a uno spazio dei nomi a cui non è consentito accedere, riceverà un errore 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="14a41-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="14a41-170">Per impostazione predefinita, questa autorizzazione è abilitata solo per gli amministratori.</span><span class="sxs-lookup"><span data-stu-id="14a41-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="14a41-171">Un amministratore può abilitare l'accesso remoto a specifici spazi dei nomi WMI per un utente non amministratore.</span><span class="sxs-lookup"><span data-stu-id="14a41-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="14a41-172">La procedura seguente imposta le autorizzazioni di abilitazione remota per un utente non amministratore.</span><span class="sxs-lookup"><span data-stu-id="14a41-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="14a41-173">**Per impostare le autorizzazioni di abilitazione remota**</span><span class="sxs-lookup"><span data-stu-id="14a41-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="14a41-174">Connettersi al computer remoto utilizzando il controllo WMI.</span><span class="sxs-lookup"><span data-stu-id="14a41-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="14a41-175">Per ulteriori informazioni sul controllo WMI, vedere [impostazione della sicurezza dello spazio dei nomi con il controllo WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="14a41-176">Nella scheda **sicurezza** selezionare lo spazio dei nomi e fare clic su **sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="14a41-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="14a41-177">Individuare l'account appropriato e selezionare **Abilita remoto** nell'elenco **autorizzazioni** .</span><span class="sxs-lookup"><span data-stu-id="14a41-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="14a41-178">Impostazione della sicurezza dello spazio dei nomi per richiedere la crittografia dei dati per le connessioni remote</span><span class="sxs-lookup"><span data-stu-id="14a41-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="14a41-179">Un amministratore o un file MOF può configurare uno spazio dei nomi WMI in modo che non venga restituito alcun dato, a meno che non si usi la riservatezza dei pacchetti (**RPC \_ C Authentication \_ \_ level \_ PKT \_ privacy** o **su PktPrivacy** come moniker in uno script) in una connessione a tale spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="14a41-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="14a41-180">In questo modo si garantisce che i dati vengano crittografati quando attraversa la rete.</span><span class="sxs-lookup"><span data-stu-id="14a41-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="14a41-181">Se si tenta di impostare un livello di autenticazione inferiore, si otterrà un messaggio di accesso negato.</span><span class="sxs-lookup"><span data-stu-id="14a41-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="14a41-182">Per ulteriori informazioni, vedere la pagina relativa [alla richiesta di una connessione crittografata a uno spazio dei nomi](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="14a41-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="14a41-183">Nell'esempio di codice VBScript riportato di seguito viene illustrato come connettersi a uno spazio dei nomi crittografato utilizzando "su PktPrivacy".</span><span class="sxs-lookup"><span data-stu-id="14a41-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="14a41-184">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="14a41-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="14a41-185">Delega con WMI</span><span class="sxs-lookup"><span data-stu-id="14a41-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="14a41-186">Creazione di processi in modalità remota con WMI</span><span class="sxs-lookup"><span data-stu-id="14a41-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="14a41-187">Protezione di client e provider C++</span><span class="sxs-lookup"><span data-stu-id="14a41-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="14a41-188">Protezione dei client di scripting</span><span class="sxs-lookup"><span data-stu-id="14a41-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
