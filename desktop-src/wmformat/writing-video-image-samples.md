---
title: Creazione di esempi di immagini video
description: Creazione di esempi di immagini video
ms.assetid: 1d375186-230a-4a18-a995-b331c72a76e7
keywords:
- ASF (Advanced Systems Format), scrittura di esempi di immagini video
- ASF (Advanced Systems Format), scrittura di esempi di immagini video
- immagini video, scrittura di esempi
- flussi, scrittura di esempi di immagini video
- codec, scrittura di esempi di immagini video
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0fbac644d7938477ba3d2e8b21ebb6e631a47708
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/19/2020
ms.locfileid: "104336297"
---
# <a name="writing-video-image-samples"></a><span data-ttu-id="cf7b1-108">Creazione di esempi di immagini video</span><span class="sxs-lookup"><span data-stu-id="cf7b1-108">Writing Video Image Samples</span></span>

<span data-ttu-id="cf7b1-109">Un flusso di immagini video è un video che contiene una serie di immagini ancora.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-109">A Video Image stream is a video that contains a series of still images.</span></span> <span data-ttu-id="cf7b1-110">Le immagini possono essere spostate all'interno del frame e ogni immagine può essere fusa nella successiva.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-110">The images can move within the frame, and each image can blend into the next.</span></span> <span data-ttu-id="cf7b1-111">I flussi di immagini video vengono codificati con il codec Windows Media Video 9 image V2.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-111">Video Image streams are encoded using the Windows Media Video 9 Image v2 codec.</span></span> <span data-ttu-id="cf7b1-112">Il video di output è simile a quello creato dal codec Windows Media Video 9.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-112">The output video is similar to that created by the Windows Media Video 9 codec.</span></span>

<span data-ttu-id="cf7b1-113">Per creare un profilo che contiene un flusso di immagini video, iniziare con l'enumerazione dei codec video, come descritto in [recupero delle informazioni di configurazione del flusso dai codec](getting-stream-configuration-information-from-codecs.md).</span><span class="sxs-lookup"><span data-stu-id="cf7b1-113">To create a profile that contains a Video Image stream, start by enumerating the video codecs as described in [Getting Stream Configuration Information from Codecs](getting-stream-configuration-information-from-codecs.md).</span></span> <span data-ttu-id="cf7b1-114">Cercare il codec che supporta il \_ sottotipo WVP2 di WMMEDIASUBTYPE.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-114">Search for the codec that supports the WMMEDIASUBTYPE\_WVP2 subtype.</span></span>

<span data-ttu-id="cf7b1-115">Dopo aver impostato il profilo sull'oggetto writer, chiamare [**IWMWriter:: GetInputProps**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-getinputprops) per ottenere le proprietà del supporto per il flusso di input dell'immagine video.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-115">After you set the profile on the writer object, call [**IWMWriter::GetInputProps**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-getinputprops) to get the media properties for the Video Image input stream.</span></span> <span data-ttu-id="cf7b1-116">Ottenere il tipo di supporto dall'oggetto proprietà del supporto, chiamando [**IWMMediaProps:: GetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-getmediatype)e impostare il sottotipo su WMMEDIASUBTYPE \_ VIDEOIMAGE.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-116">Get the media type from the media properties object, by calling [**IWMMediaProps::GetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-getmediatype), and change the subtype to WMMEDIASUBTYPE\_VIDEOIMAGE.</span></span> <span data-ttu-id="cf7b1-117">È necessario impostare la larghezza e l'altezza del video sulle dimensioni massime necessarie per includere le immagini che verranno aggiunte al flusso.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-117">You should set the video width and height to the maximum dimensions needed to encompass the images you will add to the stream.</span></span> <span data-ttu-id="cf7b1-118">Chiamare quindi [**IWMMediaProps:: SetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-setmediatype) con il tipo di input modificato.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-118">Then call [**IWMMediaProps::SetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-setmediatype) with the modified input type.</span></span> <span data-ttu-id="cf7b1-119">A questo punto è possibile iniziare a inviare esempi all'oggetto writer.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-119">Now you are ready to begin sending samples to the writer object.</span></span>

<span data-ttu-id="cf7b1-120">Ogni esempio deve iniziare con una struttura **WMT \_ VIDEOIMAGE \_ SAMPLE2** .</span><span class="sxs-lookup"><span data-stu-id="cf7b1-120">Each sample must begin with a **WMT\_VIDEOIMAGE\_SAMPLE2** structure.</span></span> <span data-ttu-id="cf7b1-121">Inoltre, gli esempi possono contenere immagini bitmap.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-121">Additionally, samples may contain bitmap images.</span></span> <span data-ttu-id="cf7b1-122">Un'immagine è associata solo a un esempio per il primo frame in cui viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-122">An image is only attached to a sample for the first frame in which it appears.</span></span> <span data-ttu-id="cf7b1-123">Tutti i frame aggiuntivi che usano tale immagine necessitano solo di informazioni nella struttura.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-123">All additional frames using that image need only information in the structure.</span></span> <span data-ttu-id="cf7b1-124">Le bitmap di input devono essere formattate come RGB, 24 bit per pixel.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-124">Input bitmaps must be formatted as RGB, 24 bits per pixel.</span></span>

<span data-ttu-id="cf7b1-125">I file bitmap archiviano i dati dell'immagine in modo che i dati di ogni riga dell'immagine accettino un numero di byte divisibile per quattro.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-125">Bitmap files store the image data so that the data for each row of the image takes a number of bytes divisible by four.</span></span> <span data-ttu-id="cf7b1-126">Questa operazione è denominata stride della bitmap. Questa operazione impone l'inizio di ogni riga di video a un limite **DWORD** , rendendo più efficiente la copia.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-126">(This is called the stride of the bitmap.) This forces the beginning of every row of video to a **DWORD** boundary, which makes copying more efficient.</span></span> <span data-ttu-id="cf7b1-127">Se le righe dell'immagine non sono divisibile in modo uniforme per quattro, la riga viene riempita al multiplo più alto successivo di quattro byte.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-127">If the image rows are not evenly divisible by four, the row is padded to the next highest multiple of four bytes.</span></span> <span data-ttu-id="cf7b1-128">Quando si allineano i dati dell'immagine, è necessario rimuovere qualsiasi riempimento presente alla fine dei dati per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-128">When you attach image data, you must remove any padding that exists at the end of the data for each row.</span></span>

<span data-ttu-id="cf7b1-129">Il codec Windows Media Video 9 image V2 gestisce fino a due immagini in memoria alla volta.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-129">The Windows Media Video 9 Image v2 codec maintains up to two images in memory at a time.</span></span> <span data-ttu-id="cf7b1-130">Queste immagini sono denominate immagine precedente e immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-130">These images are called the previous image and the current image.</span></span> <span data-ttu-id="cf7b1-131">Ogni immagine include un set di membri nella struttura **WMT \_ VIDEOIMAGE \_ SAMPLE2** , che determinano la modalità di presentazione dell'immagine nel frame.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-131">Each image has a set of members in the **WMT\_VIDEOIMAGE\_SAMPLE2** structure, which dictate how the image is presented in the frame.</span></span> <span data-ttu-id="cf7b1-132">È possibile aggiungere un'immagine impostando il membro dwControlFlags di **WMT \_ VIDEOIMAGE \_ SAMPLE2** su WMT \_ VIDEOIMAGE \_ Sample \_ input \_ frame.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-132">You can add an image by setting the dwControlFlags member of **WMT\_VIDEOIMAGE\_SAMPLE2** to WMT\_VIDEOIMAGE\_SAMPLE\_INPUT\_FRAME.</span></span> <span data-ttu-id="cf7b1-133">Quando si passa un frame di input al codec, l'immagine diventa l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-133">When you pass an input frame to the codec, that image becomes the current image.</span></span> <span data-ttu-id="cf7b1-134">L'immagine che rappresenta l'immagine corrente nell'esempio precedente viene in genere convertita nell'immagine precedente e l'immagine precedente nell'esempio precedente viene eliminata.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-134">The image that was the current image in the previous sample usually becomes the previous image, and the image that was the previous image in the previous sample is discarded.</span></span> <span data-ttu-id="cf7b1-135">È possibile configurare il codec in modo che mantenga la vecchia immagine precedente impostando il membro **bKeepPrevImage** su **true**.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-135">You can configure the codec to retain the old previous image by setting the **bKeepPrevImage** member to **TRUE**.</span></span> <span data-ttu-id="cf7b1-136">In tal caso, l'immagine che rappresenta l'immagine corrente nell'esempio precedente viene eliminata.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-136">In that case, the image that was the current image in the previous sample is discarded.</span></span>

<span data-ttu-id="cf7b1-137">La composizione di base di un frame di immagini video è determinata da due fattori per ogni immagine, ovvero l'area di interesse e il coefficiente di Blend.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-137">The basic composition of a Video Image frame is determined by two factors for each image: region of interest and blend coefficient.</span></span> <span data-ttu-id="cf7b1-138">L'area di interesse per un'immagine è definita da un punto di origine, una larghezza e un'altezza.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-138">The region of interest for an image is defined by an origin point, width, and height.</span></span> <span data-ttu-id="cf7b1-139">La parte di un'immagine descritta dall'area di interesse riempie il frame di output.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-139">The part of an image described by the region of interest fills the output frame.</span></span> <span data-ttu-id="cf7b1-140">Se l'area di interesse ha dimensioni diverse rispetto al frame di output, il codec lo ridimensiona.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-140">If the region of interest is a different size than the output frame, the codec resizes it.</span></span> <span data-ttu-id="cf7b1-141">Il coefficiente di Blend dell'immagine determina la fusione delle due immagini.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-141">The blend coefficient of the image determines the blending of the two images.</span></span> <span data-ttu-id="cf7b1-142">I coefficienti di Blend per le immagini correnti e precedenti devono essere totali di 1,0.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-142">The blend coefficients for the current and previous images must total 1.0.</span></span> <span data-ttu-id="cf7b1-143">Ad esempio, se **fCurrBlendCoef** è impostato su 0,5 e **fPrevBlendCoef** è impostato su 0,5, il frame di output è costituito da una combinazione uguale delle aree di interesse di entrambe le immagini.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-143">For example, if **fCurrBlendCoef** is set to 0.5 and **fPrevBlendCoef** is set to 0.5, then the output frame is composed of an equal blend of the regions of interest from both images.</span></span>

<span data-ttu-id="cf7b1-144">Modificando l'area di interesse per un'immagine, è possibile creare effetti di zoom e panning.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-144">By manipulating the region of interest for an image, you can create pan and zoom effects.</span></span> <span data-ttu-id="cf7b1-145">I coefficienti di Blend consentono di dissolvenza incrociata (dissolvenza) tra le immagini.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-145">The blend coefficients enable you to cross-fade (dissolve) between images.</span></span> <span data-ttu-id="cf7b1-146">Oltre a questi effetti, è possibile usare una delle transizioni predefinite per creare frame più complessi.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-146">In addition to these effects, you can use one of the predefined transitions to create more complex frames.</span></span> <span data-ttu-id="cf7b1-147">Le transizioni disponibili sono descritte nella sezione [transizioni di immagini video](video-image-transitions.md) di questa documentazione.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-147">The available transitions are described in the [Video Image Transitions](video-image-transitions.md) section of this documentation.</span></span> <span data-ttu-id="cf7b1-148">Quando si usa una transizione, è necessario configurare ogni frame.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-148">When using a transition, you must configure each frame.</span></span> <span data-ttu-id="cf7b1-149">Il modo più semplice per eseguire questa operazione consiste nel creare una funzione che modifichi in modo incrementale i membri della struttura **WMT \_ VIDEOIMAGE \_ SAMPLE2** per un effetto completo.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-149">The easiest way to do this is to create a function that incrementally changes members of the **WMT\_VIDEOIMAGE\_SAMPLE2** structure for a complete effect.</span></span>

<span data-ttu-id="cf7b1-150">Per ulteriori informazioni sui valori da impostare per le deformazioni, vedere [**WMT \_ VIDEOIMAGE \_ SAMPLE2**](/previous-versions/windows/desktop/api/Wmsdkidl/ns-wmsdkidl-wmt_videoimage_sample2).</span><span class="sxs-lookup"><span data-stu-id="cf7b1-150">For more information about the values to set for deformations, see [**WMT\_VIDEOIMAGE\_SAMPLE2**](/previous-versions/windows/desktop/api/Wmsdkidl/ns-wmsdkidl-wmt_videoimage_sample2).</span></span>

<span data-ttu-id="cf7b1-151">**Nota** Se si vuole includere audio in un file con un flusso di immagini video, è necessario usare l'input audio non compresso.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-151">**Note** If you want to include audio in a file with a Video Image stream, you must use uncompressed audio input.</span></span> <span data-ttu-id="cf7b1-152">Per combinare un flusso di immagini video con un flusso audio compresso esistente, è necessario decomprimere l'audio e passare gli esempi in non compressi.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-152">To combine a Video Image stream with an existing compressed audio stream, you must decompress the audio and pass the samples in uncompressed.</span></span> <span data-ttu-id="cf7b1-153">Se si passano esempi compressi al writer durante la scrittura di un flusso di immagini video, si verificherà un errore, causando l'eliminazione di campioni dal video.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-153">If you pass compressed samples to the writer when writing a Video Image stream, an error will occur, resulting in samples being dropped from the video.</span></span>

<span data-ttu-id="cf7b1-154">Inoltre, i file di immagine video compressi senza flussi audio possono contenere diversi frame video molto piccoli e altamente compressi in un unico pacchetto ASF, che può comportare un'esperienza di riproduzione insufficiente nelle versioni precedenti di Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-154">Also, compressed Video Image files with no audio streams can contain several very small, highly compressed video frames in a single ASF packet, which can result in a poor playback experience on previous versions of Windows Media Player.</span></span> <span data-ttu-id="cf7b1-155">Per evitare questo problema, la soluzione migliore consiste nell'inserire un flusso audio invisibile all'utente nel file, anche se ciò aumenterà anche le dimensioni del file.</span><span class="sxs-lookup"><span data-stu-id="cf7b1-155">To avoid this problem, the best solution is to insert a silent audio stream into the file, although this will also increase the file size.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cf7b1-156">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cf7b1-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cf7b1-157">**Immagine video**</span><span class="sxs-lookup"><span data-stu-id="cf7b1-157">**Video Image**</span></span>](video-image.md)
</dt> <dt>

[<span data-ttu-id="cf7b1-158">**Scrittura di file ASF**</span><span class="sxs-lookup"><span data-stu-id="cf7b1-158">**Writing ASF Files**</span></span>](writing-asf-files.md)
</dt> </dl>

 

 




