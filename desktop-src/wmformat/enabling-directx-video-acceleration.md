---
title: Attivazione dell'accelerazione video DirectX
description: Attivazione dell'accelerazione video DirectX
ms.assetid: 5cb2f564-88e3-4b60-bde3-6ccf69c97c48
keywords:
- Windows Media Format SDK, abilitazione di DXVA
- Windows Media Format SDK, accelerazione video DirectX (DXVA)
- Windows Media Format SDK, accelerazione video
- Formato Advanced Systems (ASF), abilitazione di DXVA
- ASF (Advanced Systems Format), abilitazione di DXVA
- Advanced Systems Format (ASF), accelerazione video DirectX (DXVA)
- ASF (Advanced Systems Format), accelerazione video DirectX (DXVA)
- ASF (Advanced Systems Format), accelerazione video
- ASF (Advanced Systems Format), accelerazione video
- Accelerazione video DirectX (DXVA), abilitazione
- DXVA (accelerazione video DirectX), abilitazione
- Accelerazione video DirectX (DXVA), ordine delle operazioni
- DXVA (accelerazione video DirectX), ordine delle operazioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 896147fe11b4b7f5fb91d8dc288e616b643bd5ce
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/19/2020
ms.locfileid: "104398550"
---
# <a name="enabling-directx-video-acceleration"></a><span data-ttu-id="a7ed1-116">Attivazione dell'accelerazione video DirectX</span><span class="sxs-lookup"><span data-stu-id="a7ed1-116">Enabling DirectX Video Acceleration</span></span>

<span data-ttu-id="a7ed1-117">Questa sezione descrive come abilitare Microsoft® DirectX® accelerazione video quando si riproduce contenuto trasmesso in un lettore personalizzato.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-117">This section describes how to enable Microsoft® DirectX® Video Acceleration when playing streamed content in a custom player.</span></span>

## <a name="background"></a><span data-ttu-id="a7ed1-118">Sfondo</span><span class="sxs-lookup"><span data-stu-id="a7ed1-118">Background</span></span>

<span data-ttu-id="a7ed1-119">DirectX Video Acceleration (DirectX VA) è una specifica API per l'accelerazione hardware di operazioni di decodifica 2D.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-119">DirectX Video Acceleration (DirectX VA) is an API specification for hardware acceleration of 2-D decoding operations.</span></span> <span data-ttu-id="a7ed1-120">Consente ai decodificatori software di eseguire l'offload di alcune operazioni con utilizzo intensivo della CPU nella scheda grafica per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-120">It enables software decoders to offload certain CPU-intensive operations to the graphics card for processing.</span></span> <span data-ttu-id="a7ed1-121">Per gli utenti finali, questo rende possibile un video ad alta velocità, ad esempio la riproduzione di DVD a schermo intero in computer meno recenti dotati di schede grafiche compatibili con DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-121">For end users, this makes possible high-bit-rate video such as full-screen DVD playback on older computers equipped with DirectX VA-compatible graphics cards.</span></span>

<span data-ttu-id="a7ed1-122">A partire da Windows Media Format 9 Series SDK, il filtro wrapper DMO supporta DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-122">Beginning with the Windows Media Format 9 Series SDK, the DMO Wrapper filter supports DirectX VA.</span></span> <span data-ttu-id="a7ed1-123">Ciò significa che, per la riproduzione locale, le applicazioni possono usare il filtro per i lettori ASF WM per riprodurre contenuti basati su Windows Media e l'accelerazione hardware di DirectX VA richiamata automaticamente se la scheda grafica la supporta.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-123">This means that, for local playback, applications can use the WM ASF Reader filter to play Windows Media-based content and DirectX VA hardware acceleration will be invoked automatically if the graphics card supports it.</span></span> <span data-ttu-id="a7ed1-124">Tuttavia, il filtro WM ASF Reader non supporta la riproduzione di contenuto trasmesso.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-124">However, the WM ASF Reader filter does not support playback of streamed content.</span></span> <span data-ttu-id="a7ed1-125">Pertanto, se si desidera supportare DirectX VA quando si riproduce contenuto trasmesso in un lettore personalizzato, è necessario utilizzare un meccanismo alternativo, ovvero quello utilizzato da Windows Media Player a partire dalla serie Windows Media 9.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-125">Therefore, if you want to support DirectX VA when playing streamed content in a custom player, you must use an alternate mechanism, which is the one used by Windows Media Player beginning with the Windows Media 9 Series.</span></span>

<span data-ttu-id="a7ed1-126">Poiché Windows Media Player è stato progettato prima dello sviluppo dei filtri QASF, Windows Media Player dispone di un proprio filtro di origine, basato su Windows Media Format SDK, per la riproduzione di contenuto basato su Windows Media.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-126">Because Windows Media Player was designed before the QASF filters had been developed, Windows Media Player has its own source filter, based on the Windows Media Format SDK, for playing Windows Media-based content.</span></span> <span data-ttu-id="a7ed1-127">Il filtro origine Windows Media di WMP recapita i dati decompressi a valle direttamente ai renderer audio e video.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-127">The WMP Windows Media Source Filter delivers decompressed data downstream directly to the audio and video renderers.</span></span> <span data-ttu-id="a7ed1-128">Al contrario, il lettore WM ASF recapita contenuti compressi a valle di Windows Media Decoder DirectX Media Objects (DMOs), che sono ospitati all'interno del wrapper DMO.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-128">By contrast, the WM ASF Reader delivers compressed content downstream to the Windows Media Decoder DirectX Media Objects (DMOs), which are hosted inside the DMO Wrapper.</span></span> <span data-ttu-id="a7ed1-129">I diagrammi seguenti illustrano le differenze tra il lettore WM ASF e il filtro di origine Windows Media di WMP.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-129">The following diagrams illustrate the differences between the WM ASF Reader and the WMP Windows Media Source Filter.</span></span>

![il filtro di origine personalizzato genera esempi non compressi](images/wmp-dxva-graph.png)

![il filtro di origine qasf genera esempi compressi](images/qasf-dxva-graph.png)

<span data-ttu-id="a7ed1-132">Per abilitare DirectX VA per il contenuto trasmesso, è necessario creare un filtro di origine personalizzato come quello nel diagramma superiore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-132">To enable DirectX VA for streamed content, you must create a custom source filter like the one in the top diagram.</span></span> <span data-ttu-id="a7ed1-133">In sostanza, questo filtro userà Windows Media Format SDK per creare un'istanza di un oggetto WM Reader, decomprimere gli esempi e inviarli a valle sui pin di output.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-133">Basically, this filter will use the Windows Media Format SDK to instantiate a WM Reader object, decompress the samples, and send them downstream on its output pins.</span></span> <span data-ttu-id="a7ed1-134">In questa discussione si presuppone che il filtro di origine sia già stato creato e che ora è possibile implementare il supporto di DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-134">This discussion assumes that you have created the source filter already and are now ready to implement the DirectX VA support.</span></span>

<span data-ttu-id="a7ed1-135">Per abilitare DirectX VA, l'attività di base del filtro di origine è fornire il renderer video e il decodificatore WMV DMO con le interfacce necessarie per negoziare la connessione DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-135">To enable DirectX VA, the basic task of the source filter is to provide the Video Renderer and the WMV Decoder DMO with the interfaces they will need to negotiate the DirectX VA connection.</span></span> <span data-ttu-id="a7ed1-136">Il filtro di origine non partecipa a tali negoziazioni.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-136">The source filter does not participate in those negotiations.</span></span> <span data-ttu-id="a7ed1-137">Dopo l'avvio del flusso, l'unica attività correlata a DirectX che può essere eseguita dal filtro di origine consiste nel modificare i timestamp degli esempi video prima che il decodificatore WMV li recapita al renderer video.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-137">After streaming starts, the only DirectX VA-related task that the source filter can perform is to modify the time stamps on the video samples before the WMV decoder delivers them to the Video Renderer.</span></span> <span data-ttu-id="a7ed1-138">Il motivo principale è quello di fornire un controllo della sequenza temporale personalizzato oltre a quello abilitato dalle interfacce di® DirectShow standard.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-138">The primary reason for doing this is to provide custom timeline control beyond what the standard DirectShow® interfaces enable.</span></span>

<span data-ttu-id="a7ed1-139">Sono state definite tre interfacce per abilitare le comunicazioni necessarie tra Windows Media Format SDK, il filtro di origine del lettore, il decodificatore Windows Media Video DMO e il renderer di mixer o video mixing.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-139">Three interfaces are defined to enable the necessary communications between the Windows Media Format SDK, the player's source filter, the Windows Media Video decoder DMO, and the Overlay Mixer or Video Mixing Renderer.</span></span> <span data-ttu-id="a7ed1-140">Queste interfacce sono descritte nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-140">These interfaces are described in the following table.</span></span>



| <span data-ttu-id="a7ed1-141">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="a7ed1-141">Interface</span></span>                                                        | <span data-ttu-id="a7ed1-142">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a7ed1-142">Description</span></span>                                                                                                                                                                                        |
|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a7ed1-143">**IWMCodecAMVideoAccelerator**</span><span class="sxs-lookup"><span data-stu-id="a7ed1-143">**IWMCodecAMVideoAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmcodecamvideoaccelerator) | <span data-ttu-id="a7ed1-144">Esposto da Windows Media Decoder DMO e chiamato dal filtro di origine di un Media Player per configurare le varie connessioni necessarie per abilitare DirectX VA per la decodifica del contenuto Windows Media Video.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-144">Exposed by the Windows Media Decoder DMO and called by a media player's source filter to set up the various connections required to enable DirectX VA for decoding of Windows Media Video content.</span></span> |
| [<span data-ttu-id="a7ed1-145">**IWMPlayerTimestampHook**</span><span class="sxs-lookup"><span data-stu-id="a7ed1-145">**IWMPlayerTimestampHook**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmplayertimestamphook)         | <span data-ttu-id="a7ed1-146">Implementato nel filtro di origine del lettore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-146">Implemented on the player's source filter.</span></span> <span data-ttu-id="a7ed1-147">Consente al filtro di modificare i timestamp degli esempi video prima di distribuirli a valle.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-147">It enables the filter to modify the time stamps on the video samples before delivering them downstream.</span></span>                                                 |
| [<span data-ttu-id="a7ed1-148">**IWMReaderAccelerator**</span><span class="sxs-lookup"><span data-stu-id="a7ed1-148">**IWMReaderAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreaderaccelerator)             | <span data-ttu-id="a7ed1-149">Implementato nell'oggetto WM Reader.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-149">Implemented on the WM Reader object.</span></span> <span data-ttu-id="a7ed1-150">Viene chiamato da un filtro di origine del lettore per ottenere le interfacce dal decodificatore DMO.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-150">It is called by a player source filter to obtain interfaces from the decoder DMO.</span></span>                                                                             |



 

## <a name="order-of-operations-in-directx-vaenabled-playback"></a><span data-ttu-id="a7ed1-151">Ordine delle operazioni in DirectX VA-abilitata la riproduzione</span><span class="sxs-lookup"><span data-stu-id="a7ed1-151">Order of Operations in DirectX VA–enabled Playback</span></span>

<span data-ttu-id="a7ed1-152">In questa sezione viene descritto l'ordine generale delle operazioni in fase di esecuzione per un lettore DirectX abilitata e il relativo filtro di origine.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-152">This section describes the general order of operations at run time for a DirectX VA-enabled player and its source filter.</span></span> <span data-ttu-id="a7ed1-153">I componenti a cui si fa riferimento in questa sezione sono:</span><span class="sxs-lookup"><span data-stu-id="a7ed1-153">The components referred to in this section are:</span></span>

-   <span data-ttu-id="a7ed1-154">Un lettore multimediale di terze parti, indicato come lettore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-154">A third-party media player, referred to as the player.</span></span>
-   <span data-ttu-id="a7ed1-155">Filtro di origine personalizzato, di cui è stata creata un'istanza dal lettore, che usa Windows Media Format SDK per decomprimere il contenuto basato su Windows Media.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-155">A custom source filter, instantiated by the player, that uses the Windows Media Format SDK to decompress Windows Media-based content.</span></span>
-   <span data-ttu-id="a7ed1-156">Pin di output del video del filtro di origine del lettore, denominato PIN di output.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-156">The video output pin of the player's source filter, referred to as the output pin.</span></span>
-   <span data-ttu-id="a7ed1-157">Il grafico del filtro per la riproduzione video DirectShow, denominato grafico.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-157">The DirectShow video playback filter graph, referred to as the graph.</span></span>
-   <span data-ttu-id="a7ed1-158">Renderer di mixaggio video, denominato VMR.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-158">The Video Mixing Renderer, referred to as the VMR.</span></span>
-   <span data-ttu-id="a7ed1-159">Oggetto Reader asincrono di Windows Media Format SDK, denominato Reader.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-159">The Windows Media Format SDK Asynchronous Reader object, referred to as the reader.</span></span>
-   <span data-ttu-id="a7ed1-160">Oggetto multimediale DirectX decodificatore Windows Media Video, denominato DMO del decodificatore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-160">The Windows Media Video Decoder DirectX Media Object, referred to as the decoder DMO.</span></span>

<span data-ttu-id="a7ed1-161">L'ordine delle operazioni è il seguente:</span><span class="sxs-lookup"><span data-stu-id="a7ed1-161">The order of operations is as follows:</span></span>

1.  <span data-ttu-id="a7ed1-162">Il lettore crea un'istanza del filtro di origine e di un oggetto Reader.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-162">The player instantiates its source filter and a reader object.</span></span> <span data-ttu-id="a7ed1-163">Il lettore crea un decodificatore video DMO e imposta il tipo di input (compresso) su di esso.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-163">The reader creates a video decoder DMO and sets the (compressed) input type on it.</span></span> <span data-ttu-id="a7ed1-164">Questa operazione deve verificarsi prima che il giocatore tenti di configurare il grafico di riproduzione video perché l'SDK e il decodificatore DMO devono essere interessati nel processo di negoziazione con il grafo e DMO deve essere in grado di rilevare il formato di input durante il passaggio 9.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-164">This must happen before the player attempts to configure its video playback graph because the SDK and the decoder DMO must be involved in the negotiation process with the graph, and the DMO must know the input format during step 9.</span></span>
2.  <span data-ttu-id="a7ed1-165">Il lettore chiama **IGraphBuilder:: Render**, specificando il pin di output del filtro origine video.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-165">The player calls **IGraphBuilder::Render**, providing it the video source filter's output pin.</span></span> <span data-ttu-id="a7ed1-166">A questo punto, la gestione del grafo del filtro DirectShow tenta di connettere il VMR al filtro di origine video del lettore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-166">At this point, the DirectShow filter graph manager tries to connect the VMR to the player's video source filter.</span></span>
3.  <span data-ttu-id="a7ed1-167">Filter Graph Manager chiama **Ipin:: Connect** sul pin di output del filtro di origine video del lettore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-167">The filter graph manager calls **IPin::Connect** on the output pin of the player's video source filter.</span></span>

<span data-ttu-id="a7ed1-168">I passaggi da 4 a 10 si verificano all'interno di **Ipin:: Connect**.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-168">Steps 4 through 10 occur inside of **IPin::Connect**.</span></span>

1.  <span data-ttu-id="a7ed1-169">Il filtro di origine Ottiene l'interfaccia **IWMCodecAMVideoAccelerator** dal metodo **IWMReaderAccelerator:: GetCodecInterface** del Reader.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-169">The source filter obtains the **IWMCodecAMVideoAccelerator** interface from the reader's **IWMReaderAccelerator::GetCodecInterface** method.</span></span> <span data-ttu-id="a7ed1-170">Se il codec non supporta DirectX VA, la chiamata a **GetCodecInterface** potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-170">If the codec does not support DirectX VA, the call to **GetCodecInterface** may fail.</span></span> <span data-ttu-id="a7ed1-171">In questo caso, la negoziazione procede come di consueto, senza il supporto di DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-171">In this case, negotiation proceeds as usual, without DirectX VA support.</span></span>
2.  <span data-ttu-id="a7ed1-172">Il filtro di origine passa il puntatore **IAMVideoAccelerator** dal pin passato in **Connect** al decodificatore DMO tramite **IWMCodecAMVideoAccelerator:: SetAcceleratorInterface**.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-172">The source filter passes the **IAMVideoAccelerator** pointer from the pin passed into **Connect** to the decoder DMO through **IWMCodecAMVideoAccelerator::SetAcceleratorInterface**.</span></span>
3.  <span data-ttu-id="a7ed1-173">Il filtro di origine delega quindi il resto dell'operazione **Ipin:: Connect** al metodo **CBaseOutputPin:: Connect** .</span><span class="sxs-lookup"><span data-stu-id="a7ed1-173">The source filter then delegates the remainder of the **IPin::Connect** operation to the **CBaseOutputPin::Connect** method.</span></span> <span data-ttu-id="a7ed1-174">L'enumerazione del formato con l'SDK continua come attualmente.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-174">The format enumeration with the SDK proceeds as it does today.</span></span> <span data-ttu-id="a7ed1-175">Se il codec supporta DirectX VA per il contenuto connesso, il codec DMO presenta prima i sottotipi DirectX VA, prima dei tipi YUV e RGB supportati.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-175">If the codec supports DirectX VA for the content being connected, the codec DMO presents those DirectX VA subtypes first, prior to the YUV and RGB types supported.</span></span> <span data-ttu-id="a7ed1-176">Se è disponibile il supporto per DirectX VA, si tentano i passaggi da 7 a 11 nel contesto di un sottotipo di DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-176">If DirectX VA support is available, steps 7 through 11 are attempted in the context of a DirectX VA subtype.</span></span> <span data-ttu-id="a7ed1-177">Il frammento di codice seguente mostra come identificare un sottotipo di supporto DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-177">The following code snippet shows how to identify a DirectX VA media subtype.</span></span>
    ```C++
    bool IsDXVASubtype( AM_MEDIA_TYPE * pmt )
    {
        // All DXVA types have the same last 3 DWORDs.
        // guidDXVA is the base GUID for all DXVA subtypes.

        GUID guidDXVA = { 0x00000000, 0xa0c7, 0x11d3, { 0xb9,0x84,0x00,0xc0,0x4f,0x2e,0x73,0xc5 } };

        unsigned long const * plguid;
        unsigned long const * plguidDXVA;
        plguid = (unsigned long const *)&pmt->subtype;
        plguidDXVA = (unsigned long *)&guidDXVA;

        if( ( plguid[1] == plguidDXVA[1] ) &&
            ( plguid[2] == plguidDXVA[2] ) &&
            ( plguid[3] == plguidDXVA[3] ) )
        {
            return true;
        }

        return false;
    }
    
    ```

    

4.  <span data-ttu-id="a7ed1-178">L'implementazione di **CBaseOutputPin:: Connect** chiama **Ipin:: CompleteConnect** durante il passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-178">The **CBaseOutputPin::Connect** implementation calls **IPin::CompleteConnect** during step 3.</span></span> <span data-ttu-id="a7ed1-179">Se viene considerato un sottotipo di DirectX VA, viene tentata la negoziazione di DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-179">If a DirectX VA subtype is being considered, the DirectX VA negotiation is attempted.</span></span> <span data-ttu-id="a7ed1-180">Il pin di output chiama **IWMCodecAMVideoAccelerator:: NegotiateConnection**, passando il tipo di supporto di output corrente.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-180">The output pin calls **IWMCodecAMVideoAccelerator::NegotiateConnection**, passing it the current output media type.</span></span>
5.  <span data-ttu-id="a7ed1-181">Il decodificatore DMO esegue la negoziazione richiesta con VMR tramite l'interfaccia **IAMVideoAccelerator** e restituisce il GUID del sottotipo video che i due hanno concordato.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-181">The decoder DMO performs the required negotiation with the VMR through the **IAMVideoAccelerator** interface, and returns the video subtype GUID that the two have agreed on.</span></span> <span data-ttu-id="a7ed1-182">Il pin di output delega tutte le chiamate **IAMVideoAcceleratorNotify** ricevute durante questo processo all'interfaccia **IAMVideoAcceleratorNotify** del decodificatore DMO, che può essere ottenuta anche tramite il metodo **IWMReaderAccelerator:: GetCodecInterface** .</span><span class="sxs-lookup"><span data-stu-id="a7ed1-182">The output pin delegates all **IAMVideoAcceleratorNotify** calls received during this process to the decoder DMO's **IAMVideoAcceleratorNotify** interface, which can also be obtained through the **IWMReaderAccelerator::GetCodecInterface** method.</span></span>
6.  <span data-ttu-id="a7ed1-183">Se **NegotiateConnection** ha esito positivo, il pin di output chiama **IWMCodecAMVideoAccelerator:: SetPlayerNotify** con un'interfaccia **IWMPlayerTimestampHook** .</span><span class="sxs-lookup"><span data-stu-id="a7ed1-183">If **NegotiateConnection** succeeds, the output pin calls **IWMCodecAMVideoAccelerator::SetPlayerNotify** with an **IWMPlayerTimestampHook** interface.</span></span> <span data-ttu-id="a7ed1-184">Questo hook consente al filtro di origine di aggiornare i timestamp sugli esempi prima che vengano passati al renderer.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-184">This hook allows the source filter to update the time stamps on the samples before they are handed to the renderer.</span></span>
7.  <span data-ttu-id="a7ed1-185">Il filtro di origine chiama **IWMReaderAccelerator:: Notify** con il tipo di supporto negoziato.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-185">The source filter calls **IWMReaderAccelerator::Notify** with the negotiated media type.</span></span> <span data-ttu-id="a7ed1-186">Ciò consente al lettore di aggiornare le variabili interne e di eseguire il commit in DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-186">This allows the reader to update its internal variables and commit to DirectX VA.</span></span> <span data-ttu-id="a7ed1-187">Questa è l'ultima posizione in cui il codec o il lettore può avere esito negativo.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-187">This is the last place the codec or reader can fail.</span></span> <span data-ttu-id="a7ed1-188">Se uno dei passaggi precedenti ha esito negativo, il filtro di origine deve tornare al passaggio 3 e provare il tipo successivo enumerato dal lettore.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-188">If any of the above steps fail, the source filter should return to step 3 and try the next type enumerated by the reader.</span></span>
8.  <span data-ttu-id="a7ed1-189">La riproduzione viene avviata.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-189">Playback starts.</span></span> <span data-ttu-id="a7ed1-190">Il lettore ignora i buffer di output dal decodificatore DMO se il tipo di output della connessione è DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-190">The reader ignores output buffers from the decoder DMO if the connection output type is DirectX VA.</span></span>
9.  <span data-ttu-id="a7ed1-191">Quando **Ipin::D** si verifica la connessione, il filtro di origine chiama **IWMCodecAMVideoAccelerator:: SetAcceleratorInterface** con un **valore null**.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-191">When **IPin::Disconnect** occurs, the source filter calls **IWMCodecAMVideoAccelerator::SetAcceleratorInterface** with a **NULL**.</span></span> <span data-ttu-id="a7ed1-192">Questa operazione interrompe la connessione di DirectX VA tra il codec e il renderer.</span><span class="sxs-lookup"><span data-stu-id="a7ed1-192">This breaks the DirectX VA connection between the codec and the renderer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a7ed1-193">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="a7ed1-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a7ed1-194">**Lettura di file ASF**</span><span class="sxs-lookup"><span data-stu-id="a7ed1-194">**Reading ASF Files**</span></span>](reading-asf-files.md)
</dt> </dl>

 

 




