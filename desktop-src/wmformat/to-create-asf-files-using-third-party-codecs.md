---
title: Per creare file ASF con codec di terze parti
description: Per creare file ASF con codec di terze parti
ms.assetid: 5cd348ca-1f86-429d-92ee-4eab4ced8571
keywords:
- Windows Media Format SDK, creazione di file ASF
- Windows Media Format SDK, codec di terze parti
- ASF (Advanced Systems Format), creazione di file
- ASF (Advanced Systems Format), creazione di file
- ASF (Advanced Systems Format), codec di terze parti
- ASF (Advanced Systems Format), codec di terze parti
- codec di terze parti
- codec, terze parti
- codec, creazione di file ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d6c057f1785ed50e328ac6094ff7dbe078e98fc
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/25/2020
ms.locfileid: "104336634"
---
# <a name="to-create-asf-files-using-third-party-codecs"></a><span data-ttu-id="8684b-112">Per creare file ASF con codec di terze parti</span><span class="sxs-lookup"><span data-stu-id="8684b-112">To Create ASF Files Using Third-Party Codecs</span></span>

<span data-ttu-id="8684b-113">È possibile utilizzare Windows Media Format SDK per creare file ASF contenenti supporti digitali codificati con i codec scelti.</span><span class="sxs-lookup"><span data-stu-id="8684b-113">You can use the Windows Media Format SDK to create ASF files that contain digital media encoded with any codec you choose.</span></span> <span data-ttu-id="8684b-114">Quando si usa un codec diverso da uno incluso in questo SDK, è necessario eseguire i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="8684b-114">When using a codec other than one included with this SDK, you must perform the following steps.</span></span>

1.  <span data-ttu-id="8684b-115">Codificare il contenuto con il codec desiderato.</span><span class="sxs-lookup"><span data-stu-id="8684b-115">Encode the content with the desired codec.</span></span>
2.  <span data-ttu-id="8684b-116">Trovare o creare un valore GUID per identificare il contenuto codificato con il codec usato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="8684b-116">Find or create a GUID value to identify content encoded with the codec used in step 1.</span></span>
3.  <span data-ttu-id="8684b-117">Creare un nuovo profilo o modificare un profilo esistente da usare con il contenuto codificato.</span><span class="sxs-lookup"><span data-stu-id="8684b-117">Create a new profile, or modify an existing profile for use with the encoded content.</span></span>
    -   <span data-ttu-id="8684b-118">Creare un flusso per il contenuto codificato con il tipo principale appropriato.</span><span class="sxs-lookup"><span data-stu-id="8684b-118">Create a stream for the encoded content with the appropriate major type.</span></span> <span data-ttu-id="8684b-119">Per ulteriori informazioni sui tipi di supporti principali, vedere [tipi di supporti](media-types.md).</span><span class="sxs-lookup"><span data-stu-id="8684b-119">For more information about major media types, see [Media Types](media-types.md).</span></span> <span data-ttu-id="8684b-120">Usare il GUID identificato nel passaggio 2 come sottotipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="8684b-120">Use the GUID identified in step 2 as the media subtype.</span></span>
    -   <span data-ttu-id="8684b-121">Impostare la velocità in bit e la finestra del buffer per il flusso su valori che non comporteranno un overflow del buffer.</span><span class="sxs-lookup"><span data-stu-id="8684b-121">Set the bit rate and buffer window for the stream to values that will not result in buffer overflow.</span></span> <span data-ttu-id="8684b-122">Dovrebbe essere possibile ottenere questi valori dal codec al momento della codifica.</span><span class="sxs-lookup"><span data-stu-id="8684b-122">You should be able to obtain these values from the codec at the time of encoding.</span></span> <span data-ttu-id="8684b-123">I componenti Runtime SDK controllano i valori della finestra bitrate/buffer ed eliminano gli esempi, se necessario, per adattare i dati specificati con questi valori.</span><span class="sxs-lookup"><span data-stu-id="8684b-123">The SDK runtime components check the bitrate/buffer window values and drop samples if necessary to make the given data fit in with these values.</span></span> <span data-ttu-id="8684b-124">Se si impostano i valori in modo errato, il file non viene trasmesso correttamente, causando una riproduzione insufficiente.</span><span class="sxs-lookup"><span data-stu-id="8684b-124">If you set the values incorrectly, the file will not stream properly, resulting in poor playback.</span></span>
    -   <span data-ttu-id="8684b-125">Per i flussi video, è necessario impostare il membro della **bicompressione** della struttura **BITMAPINFOHEADER** contenuto nella struttura [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) sul valore FourCC appropriato per il contenuto.</span><span class="sxs-lookup"><span data-stu-id="8684b-125">For video streams, you must set the **biCompression** member of the **BITMAPINFOHEADER** structure contained in the [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) structure to the appropriate FOURCC value for the content.</span></span> <span data-ttu-id="8684b-126">Questo valore deve essere uguale ai primi quattro byte del GUID del sottotipo.</span><span class="sxs-lookup"><span data-stu-id="8684b-126">This value must be equal to the first four bytes of the subtype GUID.</span></span> <span data-ttu-id="8684b-127">Se, ad esempio, la funzione **biCompression** è MAKEFOURCC (' T',' È,',' t') = 0x54455354, il GUID del sottotipo inizierà come segue: 54455354-XXXX-XXXX-XXXX-XXXXXXXXXXXX.</span><span class="sxs-lookup"><span data-stu-id="8684b-127">For example, if **biCompression** is MAKEFOURCC('T','E','S','T')=0x54455354, then the subtype GUID will begin like this: 54455354-XXXX-XXXX-XXXX-XXXXXXXXXXXX.</span></span>
4.  <span data-ttu-id="8684b-128">Creare un oggetto writer e caricare il profilo creato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="8684b-128">Create a writer object and load the profile created in the previous step.</span></span> <span data-ttu-id="8684b-129">Per ulteriori informazioni sulla scrittura di file, vedere la pagina relativa alla [scrittura di file ASF](writing-asf-files.md).</span><span class="sxs-lookup"><span data-stu-id="8684b-129">For more information about writing files, see [Writing ASF Files](writing-asf-files.md).</span></span>
5.  <span data-ttu-id="8684b-130">Scorrere gli input del file e assegnare le proprietà di input per ognuno di essi normalmente.</span><span class="sxs-lookup"><span data-stu-id="8684b-130">Loop through the inputs of the file and assign input properties for each as you normally would.</span></span> <span data-ttu-id="8684b-131">Per ulteriori informazioni sugli input, vedere [utilizzo degli input](working-with-inputs.md).</span><span class="sxs-lookup"><span data-stu-id="8684b-131">For more information about inputs, see [Working with Inputs](working-with-inputs.md).</span></span> <span data-ttu-id="8684b-132">Per il flusso codificato con un codec di terze parti, impostare il puntatore all'interfaccia [**IWMInputMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) su **null** prima di chiamare [**IWMWriter:: BeginWriting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting).</span><span class="sxs-lookup"><span data-stu-id="8684b-132">For the stream encoded with a third-party codec, set the [**IWMInputMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) interface pointer to **NULL** before calling [**IWMWriter::BeginWriting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting).</span></span>
6.  <span data-ttu-id="8684b-133">Usare il nuovo profilo creato nel passaggio precedente per scrivere il file.</span><span class="sxs-lookup"><span data-stu-id="8684b-133">Use the new profile created in the previous step to write the file.</span></span> <span data-ttu-id="8684b-134">Passare gli esempi compressi usando [**IWMWriterAdvanced:: WriteStreamSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) anziché [**IWMWriter:: WriteSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample).</span><span class="sxs-lookup"><span data-stu-id="8684b-134">Pass the compressed samples using [**IWMWriterAdvanced::WriteStreamSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) instead of [**IWMWriter::WriteSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample).</span></span> <span data-ttu-id="8684b-135">Per il video, è necessario specificare quali esempi sono fotogrammi chiave passando WM \_ SF \_ CLEANPOINT come parametro *dwFlags* .</span><span class="sxs-lookup"><span data-stu-id="8684b-135">For video, you must specify which samples are key frames by passing WM\_SF\_CLEANPOINT as the *dwFlags* parameter.</span></span>

<span data-ttu-id="8684b-136">Per elaborare e decomprimere il flusso codificato con un codec di terze parti, è necessario leggere gli esempi di flussi compressi.</span><span class="sxs-lookup"><span data-stu-id="8684b-136">To process and decompress the stream encoded with a third-party codec, you must read compressed stream samples.</span></span> <span data-ttu-id="8684b-137">L'applicazione di lettura deve gestire anche la decompressione di esempio per il flusso.</span><span class="sxs-lookup"><span data-stu-id="8684b-137">Your reading application must handle sample decompression for the stream as well.</span></span>

## <a name="putting-mpeg-2-streams-into-asf"></a><span data-ttu-id="8684b-138">Inserimento di flussi MPEG-2 in ASF</span><span class="sxs-lookup"><span data-stu-id="8684b-138">Putting MPEG-2 streams into ASF</span></span>

> [!Note]  
> <span data-ttu-id="8684b-139">Questo argomento si applica alle applicazioni che usano Windows Media Format SDK per inserire MPEG-2 (o altri formati di compressione che usano i frame B) nel contenitore di file ASF.</span><span class="sxs-lookup"><span data-stu-id="8684b-139">This topic applies to applications that use the Windows Media Format SDK to put MPEG-2 (or other compression formats that use B frames) into the ASF file container.</span></span>

 

<span data-ttu-id="8684b-140">Per l'oggetto writer è necessario che tutti gli esempi di input abbiano timestamp e che ogni esempio di input abbia un tempo di presentazione successivo a quello che lo precede.</span><span class="sxs-lookup"><span data-stu-id="8684b-140">The writer object requires that all input samples have time stamps, and it assumes that each input sample has a presentation time later than the one that preceded it.</span></span> <span data-ttu-id="8684b-141">Sebbene praticamente tutti i video non compressi e anche alcuni flussi video compressi soddisfino queste condizioni, i flussi MPEG-2 non lo sono.</span><span class="sxs-lookup"><span data-stu-id="8684b-141">While virtually all uncompressed video and even some compressed video streams meet these conditions, MPEG-2 streams do not.</span></span> <span data-ttu-id="8684b-142">In MPEG-2 non tutti gli esempi hanno timestamp e quando sono presenti frame B, l'ordine di decodifica di esempio non corrisponde all'ordine di rendering.</span><span class="sxs-lookup"><span data-stu-id="8684b-142">In MPEG-2, not all samples are time stamped, and when B frames are present, the sample decoding order is not the same as the rendering order.</span></span> <span data-ttu-id="8684b-143">Quando l'oggetto writer rileva gli esempi non ordinati, li riorganizza nell'ordine "corretto".</span><span class="sxs-lookup"><span data-stu-id="8684b-143">When the writer object encounters out-of-order samples, it rearranges them into the "correct" order.</span></span> <span data-ttu-id="8684b-144">Per archiviare i flussi MPEG-2 in modalità nativa (non decodificata) in un contenitore ASF, è pertanto necessario eseguire i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="8684b-144">Therefore, to store MPEG-2 streams natively (not decoded) in an ASF container, you must perform the following steps:</span></span>

<span data-ttu-id="8684b-145">Quando si scrive il file:</span><span class="sxs-lookup"><span data-stu-id="8684b-145">When writing the file:</span></span>

1.  <span data-ttu-id="8684b-146">Aggiungere un'estensione di unità dati a dimensione fissa (a causa) a ogni esempio di input che conterrà una struttura che contiene i valori effettivi dell'ora di inizio e dell'ora di inizio del timestamp MPEG per l'esempio.</span><span class="sxs-lookup"><span data-stu-id="8684b-146">Add a fixed-size data unit extension (DUE) to each input sample that will hold a structure that contains the actual MPEG time-stamp start-time and stop-time values for the sample.</span></span> <span data-ttu-id="8684b-147">Utilizzare-1 per questi valori se per l'esempio non è presente alcun timestamp.</span><span class="sxs-lookup"><span data-stu-id="8684b-147">Use -1 for these values if the sample has no time stamp.</span></span>
2.  <span data-ttu-id="8684b-148">Assegnare all'oggetto writer i timestamp di input "fittizi" che aumentano sempre in modo da scrivere gli esempi nel file esattamente nello stesso ordine in cui vengono ricevuti.</span><span class="sxs-lookup"><span data-stu-id="8684b-148">Give the writer object "dummy" input time stamps that are always increasing so that it will write the samples to the file in exactly the same order as they are received.</span></span> <span data-ttu-id="8684b-149">I timestamp fittizi devono corrispondere approssimativamente ai tempi di presentazione effettivi, calcolati in media nel tempo.</span><span class="sxs-lookup"><span data-stu-id="8684b-149">The dummy time stamps should correspond approximately to the actual presentation times, as averaged over time.</span></span> <span data-ttu-id="8684b-150">I timestamp fittizi saranno costituiti dalla sequenza temporale di ricerca, pertanto se si differenziano in base ai timestamp in tempo reale, le operazioni di ricerca nel file produrranno risultati imprevisti.</span><span class="sxs-lookup"><span data-stu-id="8684b-150">The dummy time stamps will form the seeking timeline, so if they diverge relative to the real time stamps, seek operations on the file will produce unexpected results.</span></span> <span data-ttu-id="8684b-151">Tuttavia, una quantità limitata di jitter tra i tempi di campionamento non influirà seriamente sulle operazioni di ricerca.</span><span class="sxs-lookup"><span data-stu-id="8684b-151">However, a limited amount of jitter between the sample times will not seriously affect seek operations.</span></span>

<span data-ttu-id="8684b-152">Durante la lettura del file:</span><span class="sxs-lookup"><span data-stu-id="8684b-152">When reading the file:</span></span>

-   <span data-ttu-id="8684b-153">Per ogni esempio letto dal file, esaminare la causa.</span><span class="sxs-lookup"><span data-stu-id="8684b-153">For each sample read from the file, examine the DUE.</span></span> <span data-ttu-id="8684b-154">Se contiene un'ora di inizio maggiore o uguale a zero, copiare tale valore nel timestamp per l'esempio di output prima che venga recapitato al decodificatore.</span><span class="sxs-lookup"><span data-stu-id="8684b-154">If it contains a start time that is greater than or equal to zero, copy that value to the time stamp for the output sample before it is delivered to the decoder.</span></span> <span data-ttu-id="8684b-155">Impostare tutti gli altri timestamp sugli esempi di output su **null**.</span><span class="sxs-lookup"><span data-stu-id="8684b-155">Set all other time stamps on the output samples to **NULL**.</span></span> <span data-ttu-id="8684b-156">In DirectShow questa operazione viene eseguita chiamando **IMediaSample:: setime**(**null**,**null**).</span><span class="sxs-lookup"><span data-stu-id="8684b-156">In DirectShow, this is done by calling **IMediaSample::SetTime**(**NULL**,**NULL**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8684b-157">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8684b-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8684b-158">**Contenuto del buffer**</span><span class="sxs-lookup"><span data-stu-id="8684b-158">**Buffering Content**</span></span>](buffering-content.md)
</dt> <dt>

[<span data-ttu-id="8684b-159">**Interfaccia IWMWriter**</span><span class="sxs-lookup"><span data-stu-id="8684b-159">**IWMWriter Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter)
</dt> <dt>

[<span data-ttu-id="8684b-160">**Interfaccia IWMWriterAdvanced**</span><span class="sxs-lookup"><span data-stu-id="8684b-160">**IWMWriterAdvanced Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced)
</dt> <dt>

[<span data-ttu-id="8684b-161">**Per recapitare esempi compressi con il lettore asincrono**</span><span class="sxs-lookup"><span data-stu-id="8684b-161">**To Deliver Compressed Samples with the Asynchronous Reader**</span></span>](to-deliver-compressed-samples-with-the-asynchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="8684b-162">**Per recuperare esempi di flusso con il lettore sincrono**</span><span class="sxs-lookup"><span data-stu-id="8684b-162">**To Retrieve Stream Samples with the Synchronous Reader**</span></span>](to-retrieve-stream-samples-with-the-synchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="8684b-163">**WMVIDEOINFOHEADER**</span><span class="sxs-lookup"><span data-stu-id="8684b-163">**WMVIDEOINFOHEADER**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader)
</dt> <dt>

[<span data-ttu-id="8684b-164">**Utilizzo dei profili**</span><span class="sxs-lookup"><span data-stu-id="8684b-164">**Working with Profiles**</span></span>](working-with-profiles.md)
</dt> <dt>

[<span data-ttu-id="8684b-165">**Scrittura di file ASF**</span><span class="sxs-lookup"><span data-stu-id="8684b-165">**Writing ASF Files**</span></span>](writing-asf-files.md)
</dt> </dl>

 

 




