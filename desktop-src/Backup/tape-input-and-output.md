---
title: Input e output su nastro
description: Sono disponibili diverse funzioni che possono essere utilizzate dalle applicazioni per eseguire l'input e l'output (I/O) su un'unità nastro. Le operazioni di I/O su nastro sono simili a quelle eseguite su un dispositivo di comunicazione.
ms.assetid: 1862c267-0070-4fe8-bb77-40167913978a
keywords:
- Backup di input e output su nastro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5946659f1ad0246e37981201e4e08611b45b70b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338494"
---
# <a name="tape-input-and-output"></a><span data-ttu-id="1280e-105">Input e output su nastro</span><span class="sxs-lookup"><span data-stu-id="1280e-105">Tape Input and Output</span></span>

<span data-ttu-id="1280e-106">Sono disponibili diverse funzioni che possono essere utilizzate dalle applicazioni per eseguire l'input e l'output (I/O) su un'unità nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-106">There are several functions that applications can use to perform input and output (I/O) on a tape drive.</span></span> <span data-ttu-id="1280e-107">Le operazioni di I/O su nastro sono simili a quelle eseguite su un dispositivo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="1280e-107">Tape I/O is similar to I/O performed on a communications device.</span></span>

<span data-ttu-id="1280e-108">Quando si eseguono le operazioni di I/O su nastro, alcune unità nastro archiviano le informazioni del firmware del nastro nei primi blocchi su un nastro, in genere utilizzando una parte dei primi 100 blocchi.</span><span class="sxs-lookup"><span data-stu-id="1280e-108">When performing tape I/O, some tape drives store tape firmware information in the first few blocks on a tape, typically using some portion of the first 100 blocks.</span></span> <span data-ttu-id="1280e-109">Le applicazioni non devono utilizzare tali blocchi.</span><span class="sxs-lookup"><span data-stu-id="1280e-109">Applications should not use those blocks.</span></span> <span data-ttu-id="1280e-110">Informazioni più specifiche su questo argomento sono disponibili nei singoli produttori di sistemi a nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-110">More specific information on this subject is available from individual tape system manufacturers.</span></span> <span data-ttu-id="1280e-111">In generale, un'applicazione che ignora i primi 100 blocchi su un nastro eviterà le idiosincrasie dell'unità nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-111">In general, an application that skips the first 100 blocks on a tape will avoid tape drive idiosyncrasies.</span></span>

<span data-ttu-id="1280e-112">Le funzioni [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) e [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) recuperano e spostano la posizione corrente del nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-112">The [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) and [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) functions retrieve and move the current tape position.</span></span> <span data-ttu-id="1280e-113">La funzione [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) scrive un numero specificato di segni di spunta, filemark, brevi filemark e filemarks lunghi.</span><span class="sxs-lookup"><span data-stu-id="1280e-113">The [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) function writes a specified number of setmarks, filemarks, short filemarks, and long filemarks.</span></span> <span data-ttu-id="1280e-114">La funzione [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) Cancella tutto o parte di un nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-114">The [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) function erases all or part of a tape.</span></span>

<span data-ttu-id="1280e-115">Le funzioni [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) leggono e scrivono i dati dei file da e verso il nastro.</span><span class="sxs-lookup"><span data-stu-id="1280e-115">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) functions read and write file data from and to the tape.</span></span> <span data-ttu-id="1280e-116">I dati vengono letti e scritti in blocchi completi.</span><span class="sxs-lookup"><span data-stu-id="1280e-116">The data is read and written in complete blocks.</span></span> <span data-ttu-id="1280e-117">Se le dimensioni del blocco del nastro sono pari a 512 byte, tutte le operazioni di lettura e scrittura devono usare i buffer che sono semplici multipli Integer della dimensione del blocco: 512, 1024, 1536, 2048 e così via.</span><span class="sxs-lookup"><span data-stu-id="1280e-117">If the tape's block size is 512 bytes, all read and write operations must use buffers that are simple integer multiples of that block size: 512, 1024, 1536, 2048, and so on.</span></span> <span data-ttu-id="1280e-118">Nella maggior parte dei casi, le unità consentono solo un'operazione di scrittura dopo che il nastro viene riavvolto o dopo che un'operazione di lettura produce un messaggio di errore di fine dei dati.</span><span class="sxs-lookup"><span data-stu-id="1280e-118">Most, if not all, drives only allow a write operation after the tape is rewound or after a read operation produces an end-of-data error message.</span></span>

<span data-ttu-id="1280e-119">Per leggere o scrivere dati di file in o da un nastro in modalità blocco a lunghezza variabile, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="1280e-119">To read or write file data to or from a tape in variable-length block mode, perform the following steps:</span></span>

1.  <span data-ttu-id="1280e-120">Determinare se l'unità nastro supporta la modalità a blocchi a lunghezza variabile chiamando la funzione [**GetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) e controllando \_ il \_ \_ bit di blocco della variabile dell'unità nastro del membro **FeaturesLow** della struttura dei [**\_ \_ \_ parametri di unità del nastro**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) restituito.</span><span class="sxs-lookup"><span data-stu-id="1280e-120">Determine whether the tape drive supports variable-length block mode by calling the [**GetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) function and checking the TAPE\_DRIVE\_VARIABLE\_BLOCK bit of the **FeaturesLow** member of the returned [**TAPE\_GET\_DRIVE\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) structure.</span></span>
2.  <span data-ttu-id="1280e-121">Specificare la modalità dimensione blocco variabili chiamando la funzione [**SetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) , impostando il membro **blockSize** della struttura [**dei \_ \_ \_ parametri del supporto del set di nastri**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) su zero.</span><span class="sxs-lookup"><span data-stu-id="1280e-121">Specify the variable block size mode by calling the [**SetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) function, setting the **BlockSize** member of the [**TAPE\_SET\_MEDIA\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) structure to zero.</span></span> <span data-ttu-id="1280e-122">Quindi, usare [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) o [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) per leggere o scrivere i dati del file.</span><span class="sxs-lookup"><span data-stu-id="1280e-122">Then, use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) or [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) to read or write the file data.</span></span>

<span data-ttu-id="1280e-123">Se [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) rileva un filemark, i dati fino al filemark vengono letti e la funzione ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="1280e-123">If [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) encounters a filemark, the data up to the filemark is read and the function fails.</span></span> <span data-ttu-id="1280e-124">La funzione [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) restituisce un codice di errore che indica il tipo di filemark rilevato. Il sistema operativo sposta il nastro oltre il filemark e un'applicazione può chiamare nuovamente **ReadFile** per continuare a leggere.</span><span class="sxs-lookup"><span data-stu-id="1280e-124">(The [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns an error code indicating the type of filemark that was encountered.) The operating system moves the tape past the filemark, and an application can call **ReadFile** again to continue reading.</span></span>

<span data-ttu-id="1280e-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) leggono e scrivono solo il flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="1280e-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) read and write only the data stream.</span></span> <span data-ttu-id="1280e-126">Le funzioni [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) e [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) leggono e scrivono tutti i flussi associati a un file.</span><span class="sxs-lookup"><span data-stu-id="1280e-126">The [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) functions read and write all the streams associated with a file.</span></span> <span data-ttu-id="1280e-127">Sono inclusi dati, attributi estesi, sicurezza e flussi di dati alternativi.</span><span class="sxs-lookup"><span data-stu-id="1280e-127">These include data, extended attributes, security, and alternative data streams.</span></span> <span data-ttu-id="1280e-128">I flussi di dati di sicurezza e alternativi sono rilevanti solo per la partizione file system NTFS.</span><span class="sxs-lookup"><span data-stu-id="1280e-128">The security and alternate data streams are relevant only on the NTFS file system partition.</span></span>

<span data-ttu-id="1280e-129">La funzione [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) Cerca in futuro in un file a cui si accede inizialmente da [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) o [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span><span class="sxs-lookup"><span data-stu-id="1280e-129">The [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) function seeks forward in a file initially accessed by [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) or [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span></span> <span data-ttu-id="1280e-130">Questa funzione consente a un'applicazione di ignorare le informazioni che causano errori di accesso.</span><span class="sxs-lookup"><span data-stu-id="1280e-130">This function enables an application to skip information that causes access errors.</span></span>

<span data-ttu-id="1280e-131">Se un'applicazione deve accedere solo ai dati dei file, deve usare [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span><span class="sxs-lookup"><span data-stu-id="1280e-131">If an application needs to access only the file data, it should use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span></span> <span data-ttu-id="1280e-132">Queste funzioni possono anche leggere flussi di dati alternativi se i flussi sono stati creati usando la funzione [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="1280e-132">These functions can also read alternative data streams if the streams were created by using the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="1280e-133">Un'applicazione di backup su nastro deve usare [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) e [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) per copiare tutte le informazioni relative a un file.</span><span class="sxs-lookup"><span data-stu-id="1280e-133">A tape-backup application must use [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) to copy all information pertaining to a file.</span></span> <span data-ttu-id="1280e-134">Tuttavia, queste funzioni non leggono o scrivono le caratteristiche dei file, ad esempio attributi, ora di creazione del file e così via.</span><span class="sxs-lookup"><span data-stu-id="1280e-134">However, these functions do not read or write file characteristics such as attributes, file creation time, and so on.</span></span> <span data-ttu-id="1280e-135">Le applicazioni devono usare le funzioni di input e output dei file, ad esempio [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) e [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), per recuperare e impostare tali valori.</span><span class="sxs-lookup"><span data-stu-id="1280e-135">Applications must use the file input and output functions, such as [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) and [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), to retrieve and set those values.</span></span>

 

 