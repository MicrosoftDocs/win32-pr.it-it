---
title: Implementazione della pagina delle proprietà per un plug-in DSP
description: Implementazione della pagina delle proprietà per un plug-in DSP
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Plug-in di Windows Media Player, DSP audio
- plug-in, audio DSP
- plug-in di elaborazione dei segnali digitali, proprietà audio
- Plug-in DSP, proprietà audio
- plug-in DSP audio, proprietà
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103855798"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="df006-108">Implementazione della pagina delle proprietà per un plug-in DSP</span><span class="sxs-lookup"><span data-stu-id="df006-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="df006-109">Windows Media Player può visualizzare una pagina delle proprietà per ogni plug-in DSP per consentire agli utenti di impostare valori che modificano il comportamento del plug-in.</span><span class="sxs-lookup"><span data-stu-id="df006-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="df006-110">Gli utenti possono accedere alla pagina delle proprietà dalla scheda **plug-** in della finestra di dialogo Opzioni facendo clic sul nome del plug-in DSP per selezionarlo e quindi fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="df006-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="df006-111">Il codice di esempio della procedura guidata plug-in di Windows Media Player fornisce un'implementazione predefinita di una pagina delle proprietà che include una singola casella di modifica che riceve dall'utente un valore che rappresenta un fattore di scala per il volume audio.</span><span class="sxs-lookup"><span data-stu-id="df006-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="df006-112">Quando l'utente fa clic su **applica**, la pagina delle proprietà passa questo valore all'oggetto plug-in in modo che il plug-in possa modificare il valore usato per la scalabilità del volume durante l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="df006-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="df006-113">Informazioni sull'oggetto pagina delle proprietà</span><span class="sxs-lookup"><span data-stu-id="df006-113">About the Property Page Object</span></span>

<span data-ttu-id="df006-114">L'oggetto pagina delle proprietà è un oggetto COM che implementa l'interfaccia **IPropertyPage** .</span><span class="sxs-lookup"><span data-stu-id="df006-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="df006-115">Il codice di esempio generato dalla procedura guidata per il plug-in utilizza l'implementazione ATL di **IPropertyPage**, documentata nella documentazione di Visual C++ su MSDN.</span><span class="sxs-lookup"><span data-stu-id="df006-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="df006-116">Il codice deve almeno fornire implementazioni di override per **IPropertyPage:: OnInitDialog**, che gestisce l'evento che si verifica quando viene visualizzata la pagina delle proprietà e **IPropertyPage:: Apply**, che gestisce l'evento che si verifica quando l'utente fa clic su **applica**.</span><span class="sxs-lookup"><span data-stu-id="df006-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="df006-117">La creazione guidata plug-in genera codice di esempio per ognuno di questi gestori di eventi.</span><span class="sxs-lookup"><span data-stu-id="df006-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="df006-118">L'implementazione di esempio di **OnInitDialog** recupera un valore dal registro di sistema in modo che possa visualizzare l'impostazione del fattore di scala corrente.</span><span class="sxs-lookup"><span data-stu-id="df006-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="df006-119">L'implementazione di esempio di **Apply** convalida l'input dell'utente eseguendo un test per assicurarsi che rientri in un intervallo specificato, quindi Salva in modo permanente il valore nel registro di sistema, quindi passa il valore (se valido) al metodo Put della proprietà del plug-in DSP, denominato **\_ scale put**.</span><span class="sxs-lookup"><span data-stu-id="df006-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="df006-120">Sarà inoltre necessario aggiungere il codice per gestire l'evento che si verifica quando l'utente modifica un valore in un controllo fornito nella pagina delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="df006-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="df006-121">Ad esempio, la procedura guidata plug-in implementa una funzione denominata **OnChangeScale**, che Abilita semplicemente il pulsante **applica** quando l'utente modifica il testo nella casella di modifica nella pagina delle proprietà chiamando il metodo **IsDirty** con un valore di argomento **true**.</span><span class="sxs-lookup"><span data-stu-id="df006-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="df006-122">Informazioni sulla risorsa finestra di dialogo della pagina delle proprietà</span><span class="sxs-lookup"><span data-stu-id="df006-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="df006-123">L'interfaccia utente per la pagina delle proprietà viene archiviata come una risorsa finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="df006-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="df006-124">È possibile visualizzare e modificare facilmente la finestra di dialogo della pagina delle proprietà in Visual Studio selezionando la scheda **ResourceView** nella finestra dell'area di lavoro del progetto, quindi aprendo la cartella della **finestra di dialogo** e quindi facendo doppio clic sul nome della risorsa della pagina delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="df006-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="df006-125">L'editor di risorse della finestra di dialogo in Visual Studio fornisce gli strumenti necessari per aggiungere controlli alla finestra di dialogo della pagina delle proprietà e per creare gestori di eventi di cui è stato eseguito il mapping ai messaggi Windows appropriati.</span><span class="sxs-lookup"><span data-stu-id="df006-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="df006-126">Per informazioni dettagliate su come usare l'editor di risorse in Visual Studio, vedere la Guida di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="df006-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="df006-127">Informazioni su ISpecifyPropertyPages</span><span class="sxs-lookup"><span data-stu-id="df006-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="df006-128">Se un plug-in DSP fornisce una pagina delle proprietà, il plug-in deve implementare l'interfaccia **ISpecifyPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="df006-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="df006-129">Questa interfaccia contiene un solo metodo: **ISpecifyPropertyPages:: GetPages**.</span><span class="sxs-lookup"><span data-stu-id="df006-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="df006-130">Si tratta del metodo che associa la pagina delle proprietà al plug-in DSP.</span><span class="sxs-lookup"><span data-stu-id="df006-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="df006-131">Windows Media Player chiama questo metodo quando l'utente richiama la pagina delle proprietà, passando un parametro di tipo CAUUID, che è una matrice conteggiata di GUID.</span><span class="sxs-lookup"><span data-stu-id="df006-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="df006-132">L'implementazione del plug-in di esempio di **GetPages** riempie questa struttura con un solo GUID che rappresenta l'ID di classe dell'oggetto della pagina delle proprietà del plug-in.</span><span class="sxs-lookup"><span data-stu-id="df006-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="df006-133">Windows Media Player usa quindi l'ID di classe per creare l'oggetto pagina delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="df006-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="df006-134">Si può notare che l'implementazione di esempio di **GetPages** USA **CoTaskMemAlloc** per allocare memoria per la struttura Guid.</span><span class="sxs-lookup"><span data-stu-id="df006-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="df006-135">È responsabilità del chiamante, in questo caso Windows Media Player, di usare **CoTaskMemFree** per rilasciare la memoria.</span><span class="sxs-lookup"><span data-stu-id="df006-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="df006-136">Per informazioni dettagliate sulla struttura CAUUID, vedere la documentazione di Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="df006-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="df006-137">Informazioni sulla DLL proxy/stub</span><span class="sxs-lookup"><span data-stu-id="df006-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="df006-138">Per il funzionamento di un plug-in DSP in Windows Media Player 11 in esecuzione in Windows Vista, è necessario fornire una DLL proxy/stub per le interfacce personalizzate utilizzate per comunicare le modifiche nelle impostazioni da una finestra di dialogo della pagina delle proprietà alla classe del plug-in.</span><span class="sxs-lookup"><span data-stu-id="df006-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="df006-139">È necessario effettuare il marshalling delle chiamate al metodo effettuate tramite tali interfacce quando le chiamate vengono effettuate tra i limiti del processo o dell'Apartment.</span><span class="sxs-lookup"><span data-stu-id="df006-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="df006-140">Con la versione più recente della procedura guidata plug-in viene creato un progetto di DLL proxy/stub di esempio.</span><span class="sxs-lookup"><span data-stu-id="df006-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="df006-141">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="df006-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="df006-142">**Implementazione di un plug-in DSP audio**</span><span class="sxs-lookup"><span data-stu-id="df006-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




