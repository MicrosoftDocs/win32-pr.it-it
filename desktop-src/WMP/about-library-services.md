---
title: Informazioni sui servizi di libreria
description: Informazioni sui servizi di libreria
ms.assetid: 2334aa4a-7988-481d-9b21-9f7b432fbd05
keywords:
- Windows Media Player, libreria
- Modello a oggetti di Windows Media Player, libreria
- modello a oggetti, libreria
- Controllo ActiveX di Windows Media Player, libreria per il modello a oggetti
- Controllo ActiveX, libreria per il modello a oggetti
- Controllo ActiveX Windows Media Player Mobile, libreria per il modello a oggetti
- Windows Media Player Mobile, libreria per il modello a oggetti
- Windows Media Player Library, informazioni
- Windows Media Player Library, servizi
- libreria, servizi
- libreria, informazioni
- versioni di Windows Media Player, servizi di libreria
- enumerazioni, servizi di libreria
- eventi, servizi di libreria
- esempi, servizi di libreria
- interfacce, servizi di libreria
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 743efc8ae5cb464aa38655314c52112bc9541de6
ms.sourcegitcommit: b04e152a7f51618fc174ffa872654623fe088db2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/21/2020
ms.locfileid: "106299501"
---
# <a name="about-library-services"></a><span data-ttu-id="e266a-119">Informazioni sui servizi di libreria</span><span class="sxs-lookup"><span data-stu-id="e266a-119">About Library Services</span></span>

<span data-ttu-id="e266a-120">Nelle versioni precedenti di Windows Media Player, il software usava un singolo database di libreria per ogni utente.</span><span class="sxs-lookup"><span data-stu-id="e266a-120">In earlier versions of Windows Media Player, the software used a single library database for each user.</span></span> <span data-ttu-id="e266a-121">Questo database è stato archiviato nel computer dell'utente ed è stato concettualmente associato all'utente e a una particolare istanza del lettore.</span><span class="sxs-lookup"><span data-stu-id="e266a-121">This database was stored on the user's computer and was conceptually tied to the user and a particular instance of the Player.</span></span>

<span data-ttu-id="e266a-122">Windows Media Player 11 introduce i concetti di librerie multiple e remote.</span><span class="sxs-lookup"><span data-stu-id="e266a-122">Windows Media Player 11 introduces the concepts of multiple and remote libraries.</span></span> <span data-ttu-id="e266a-123">Ora, oltre alla libreria predefinita o *locale*, Windows Media Player può visualizzare il contenuto recuperato dalle librerie in altri computer connessi a una rete, che potrebbero includere altri utenti connessi allo stesso computer.</span><span class="sxs-lookup"><span data-stu-id="e266a-123">Now, in addition to its default, or *local*, library, Windows Media Player can display content retrieved from libraries on other computers connected to a network, which might include other users logged on to the same computer.</span></span> <span data-ttu-id="e266a-124">Il lettore può anche visualizzare le visualizzazioni delle librerie da altre origini, ad esempio i dispositivi abilitati per MTP o i CD di dati.</span><span class="sxs-lookup"><span data-stu-id="e266a-124">The Player can also display library views from other sources, such as MTP-enabled devices or data CDs.</span></span> <span data-ttu-id="e266a-125">Dal punto di vista dell'utente finale, ciò significa che il contenuto multimediale digitale presente in molte posizioni diverse può essere gestito da più posizioni usando la stessa interfaccia utente di Windows Media Player familiare.</span><span class="sxs-lookup"><span data-stu-id="e266a-125">From the end user's perspective, this means that digital media content located in many different places can be managed from multiple locations by using the same, familiar Windows Media Player user interface.</span></span> <span data-ttu-id="e266a-126">Dal punto di vista dello sviluppatore, ciò significa che è possibile utilizzare le interfacce COM di Windows Media Player SDK per enumerare le librerie disponibili e quindi utilizzarle come la libreria locale nelle versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="e266a-126">From the developer's perspective, this means that you can use the Windows Media Player SDK COM interfaces to enumerate the available libraries and then use them like you have used the local library in earlier versions.</span></span>

<span data-ttu-id="e266a-127">Per enumerare le librerie disponibili, usare l'interfaccia **IWMPLibraryServices** .</span><span class="sxs-lookup"><span data-stu-id="e266a-127">To enumerate the available libraries, use the **IWMPLibraryServices** interface.</span></span> <span data-ttu-id="e266a-128">Questa interfaccia espone il metodo [IWMPLibraryServices:: getCountByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) , che recupera il numero di librerie di un determinato tipo.</span><span class="sxs-lookup"><span data-stu-id="e266a-128">This interface exposes the [IWMPLibraryServices::getCountByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) method, which retrieves the count of libraries of a given type.</span></span> <span data-ttu-id="e266a-129">I tipi di libreria sono definiti dall'enumerazione [WMPLibraryType](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) .</span><span class="sxs-lookup"><span data-stu-id="e266a-129">Library types are defined by the [WMPLibraryType](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) enumeration.</span></span> <span data-ttu-id="e266a-130">Questa enumerazione include un valore per la libreria locale, wmpltLocal.</span><span class="sxs-lookup"><span data-stu-id="e266a-130">This enumeration includes a value for the local library, wmpltLocal.</span></span> <span data-ttu-id="e266a-131">Ciò è dovuto al fatto che la funzionalità Servizi di libreria consente sempre di utilizzare la libreria locale utilizzando **IWMPLibraryServices** e le interfacce correlate.</span><span class="sxs-lookup"><span data-stu-id="e266a-131">This is because the library services feature always enables you work with the local library by using **IWMPLibraryServices** and the related interfaces.</span></span>

> [!Note]  
> <span data-ttu-id="e266a-132">L'enumerazione **WMPLibraryType** include il valore wmpltRemote, che rappresenta le librerie multimediali condivise dalla rete.</span><span class="sxs-lookup"><span data-stu-id="e266a-132">The **WMPLibraryType** enumeration includes the value wmpltRemote, which represents media libraries shared by the network.</span></span> <span data-ttu-id="e266a-133">Per accedere a queste librerie condivise, il controllo Player deve essere eseguito in modalità remota.</span><span class="sxs-lookup"><span data-stu-id="e266a-133">To access those shared libraries, the Player control must be running in remote mode.</span></span> <span data-ttu-id="e266a-134">Per informazioni sull'esecuzione del controllo Player in modalità remota, vedere [la pagina relativa alla comunicazione remota del controllo Windows Media Player](remoting-the-windows-media-player-control.md).</span><span class="sxs-lookup"><span data-stu-id="e266a-134">For information about running the Player control in remote mode, see [Remoting the Windows Media Player Control](remoting-the-windows-media-player-control.md).</span></span>

 

<span data-ttu-id="e266a-135">Dopo aver recuperato il numero di librerie, è possibile eseguire l'iterazione della raccolta di librerie disponibili chiamando ripetutamente [IWMPLibraryServices:: getLibraryByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) in un ciclo, passando un nuovo valore di indice a ogni iterazione.</span><span class="sxs-lookup"><span data-stu-id="e266a-135">After you retrieve the library count, you can iterate the collection of available libraries by repeatedly calling [IWMPLibraryServices::getLibraryByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) in a loop, passing a new index value with each iteration.</span></span> <span data-ttu-id="e266a-136">Questo metodo recupera un puntatore a un'interfaccia [IWMPLibrary](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) , che rappresenta la singola libreria.</span><span class="sxs-lookup"><span data-stu-id="e266a-136">This method retrieves a pointer to an [IWMPLibrary](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) interface, which represents the individual library.</span></span>

<span data-ttu-id="e266a-137">Dopo aver recuperato un puntatore a **IWMPLibrary**, è possibile chiamare [IWMPLibrary:: Get \_ mediacollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) per recuperare un puntatore a un'interfaccia **IWMPMediaCollection** .</span><span class="sxs-lookup"><span data-stu-id="e266a-137">After you retrieve a pointer to **IWMPLibrary**, you can call [IWMPLibrary::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) to retrieve a pointer to an **IWMPMediaCollection** interface.</span></span> <span data-ttu-id="e266a-138">Con questo puntatore di interfaccia è possibile usare una singola libreria in modo analogo alla libreria locale.</span><span class="sxs-lookup"><span data-stu-id="e266a-138">With this interface pointer, you can work with an individual library much like you would use the local library.</span></span> <span data-ttu-id="e266a-139">È anche possibile recuperare una stringa contenente il nome della libreria chiamando [IWMPLibrary:: Get \_ Name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), che è utile se è necessario visualizzare il nome della libreria per l'utente.</span><span class="sxs-lookup"><span data-stu-id="e266a-139">You can also retrieve a string containing the name of the library by calling [IWMPLibrary::get\_name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), which is useful if you need to display the library name to the user.</span></span> <span data-ttu-id="e266a-140">È possibile chiamare [IWMPLibrary:: Get \_ Type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) per ottenere il **WMPLibraryType** di una determinata libreria.</span><span class="sxs-lookup"><span data-stu-id="e266a-140">You can call [IWMPLibrary::get\_type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) to get the **WMPLibraryType** of a particular library.</span></span>

<span data-ttu-id="e266a-141">È possibile gestire l'evento [IWMPEvents3:: LibraryConnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) per stabilire quando una raccolta diventa disponibile e l'evento [IWMPEvents3:: LibraryDisconnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) per stabilire quando una libreria si disconnette.</span><span class="sxs-lookup"><span data-stu-id="e266a-141">You can handle the [IWMPEvents3::LibraryConnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) event to know when a library becomes available and the [IWMPEvents3::LibraryDisconnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) event to know when a library disconnects.</span></span> <span data-ttu-id="e266a-142">Ognuno di questi eventi fornisce un puntatore **IWMPLibrary** che rappresenta la libreria connessa o disconnessa.</span><span class="sxs-lookup"><span data-stu-id="e266a-142">Each of these events provides an **IWMPLibrary** pointer that represents the library that connected or disconnected.</span></span> <span data-ttu-id="e266a-143">È possibile chiamare [IWMPLibrary:: è identico](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) per determinare se la libreria connessa o disconnessa è una libreria attualmente in uso.</span><span class="sxs-lookup"><span data-stu-id="e266a-143">You can call [IWMPLibrary::isIdentical](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) to determine whether the library that connected or disconnected is a library that you are currently using.</span></span>

<span data-ttu-id="e266a-144">Esistono alcune differenze importanti quando si lavora con una libreria recuperata tramite l'interfaccia **IWMPLibraryServices** rispetto all'uso di una libreria recuperata tramite [IWMPCore:: Get \_ mediacollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span><span class="sxs-lookup"><span data-stu-id="e266a-144">There are some important differences when you work with a library retrieved through the **IWMPLibraryServices** interface compared to working with a library retrieved by using [IWMPCore::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span></span> <span data-ttu-id="e266a-145">Si applicano le differenze seguenti:</span><span class="sxs-lookup"><span data-stu-id="e266a-145">The following differences apply:</span></span>

-   <span data-ttu-id="e266a-146">È in genere possibile recuperare i risultati delle query molto più velocemente dalle librerie recuperate tramite **IWMPLibraryServices**.</span><span class="sxs-lookup"><span data-stu-id="e266a-146">You can usually retrieve query results much faster from libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="e266a-147">Si presuppone che altri fattori, ad esempio i tempi di accesso alla rete e al disco rigido, siano uguali.</span><span class="sxs-lookup"><span data-stu-id="e266a-147">(This assumes that other factors such as network and hard disk access times are equal.)</span></span>
-   <span data-ttu-id="e266a-148">L'elenco degli attributi dei metadati degli elementi multimediali disponibili dalle librerie recuperate tramite **IWMPLibraryServices** è in genere un subset di quelli disponibili dalla libreria locale recuperata tramite [IWMPCore](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span><span class="sxs-lookup"><span data-stu-id="e266a-148">The list of media item metadata attributes available from libraries retrieved through **IWMPLibraryServices** is usually a subset of those available from the local library retrieved through [IWMPCore](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span></span>
-   <span data-ttu-id="e266a-149">Se si recupera la libreria locale tramite **IWMPLibraryServices**, tutti gli stessi attributi sono disponibili per l'uso come quelli disponibili quando si recupera la libreria locale tramite **IWMPCore**.</span><span class="sxs-lookup"><span data-stu-id="e266a-149">If you retrieve the local library through **IWMPLibraryServices**, all of the same attributes are available for your use as those available when you retrieve the local library through **IWMPCore**.</span></span> <span data-ttu-id="e266a-150">Tuttavia, sarà possibile recuperare i risultati della query molto più velocemente per gli attributi più usati.</span><span class="sxs-lookup"><span data-stu-id="e266a-150">However, you will be able to retrieve query results much faster for the most commonly-used attributes.</span></span>
-   <span data-ttu-id="e266a-151">È consigliabile usare le raccolte di stringhe per creare elementi dell'interfaccia utente quando si lavora con le librerie recuperate tramite **IWMPLibraryServices**.</span><span class="sxs-lookup"><span data-stu-id="e266a-151">You should use string collections to create user interface elements when you work with libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="e266a-152">Ad esempio, [IWMPMediaCollection2:: getStringCollectionByQuery](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) consente di usare una query personalizzata, rappresentata dall'interfaccia **IWMPQuery** , per recuperare una raccolta di stringhe.</span><span class="sxs-lookup"><span data-stu-id="e266a-152">For example, [IWMPMediaCollection2::getStringCollectionByQuery](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) enables you to use a custom query (represented by the **IWMPQuery** interface) to retrieve a string collection.</span></span>
-   <span data-ttu-id="e266a-153">Le librerie Remote recuperate tramite l'interfaccia **IWMPLibraryServices** potrebbero non essere sempre connesse all'istanza corrente del lettore.</span><span class="sxs-lookup"><span data-stu-id="e266a-153">Remote libraries retrieved through the **IWMPLibraryServices** interface might not always be connected to the current Player instance.</span></span> <span data-ttu-id="e266a-154">Ciò significa che è importante gestire gli eventi **LibraryConnect** e **LibraryDisconnect** per capire quando viene modificata la disponibilità della libreria e per gestire l'evento [IWMPEvents3:: StringCollectionChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) per stabilire quando le stringhe vengono aggiunte o rimosse dalle raccolte di stringhe usate per visualizzare gli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="e266a-154">This means that it is important to handle the **LibraryConnect** and **LibraryDisconnect** events to know when library availability changes, and to handle the [IWMPEvents3::StringCollectionChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) event to know when strings are added to or removed from the string collections you use to display user interface elements.</span></span> <span data-ttu-id="e266a-155">È inoltre necessario gestire gli eventi **StringCollectionChange** per la libreria locale per motivi analoghi.</span><span class="sxs-lookup"><span data-stu-id="e266a-155">You should also handle **StringCollectionChange** events for the local library for similar reasons.</span></span>

<span data-ttu-id="e266a-156">È importante comprendere che le raccolte di stringhe per una determinata libreria possono cambiare in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="e266a-156">It is important to understand that string collections for a particular library can change at any time.</span></span> <span data-ttu-id="e266a-157">Una raccolta di stringhe può essere vuota quando la si recupera per la prima volta, come nel caso di una libreria che è stata recentemente connessa, ma il lettore non ne ha ancora enumerato il contenuto.</span><span class="sxs-lookup"><span data-stu-id="e266a-157">A string collection could be empty when you first retrieve it, as in the case of a library that has recently connected but the Player has not yet enumerated its contents.</span></span> <span data-ttu-id="e266a-158">Viceversa, una raccolta di stringhe potrebbe già contenere tutte le informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="e266a-158">Conversely, a string collection might already contain all the information you need.</span></span> <span data-ttu-id="e266a-159">In questo caso, è possibile che non si riceva mai un evento **StringCollectionChange** perché il contenuto della libreria è stato completamente enumerato prima della creazione della query e non sono state apportate altre modifiche.</span><span class="sxs-lookup"><span data-stu-id="e266a-159">In this case, you might never receive a **StringCollectionChange** event because the library's contents had been completely enumerated before you created your query and nothing else is changing.</span></span>

<span data-ttu-id="e266a-160">Pertanto, per tenere aggiornata l'interfaccia utente, è necessario enumerare il contenuto della raccolta di stringhe quando si recupera l'interfaccia **IWMPStringCollection** e gestire l'evento **StringCollectionChange** per conoscere gli aggiornamenti quando si verificano.</span><span class="sxs-lookup"><span data-stu-id="e266a-160">Therefore, to keep your user interface current, you must both enumerate the string collection contents when you retrieve the **IWMPStringCollection** interface and handle the **StringCollectionChange** event to know about updates when they happen.</span></span>

## <a name="sample"></a><span data-ttu-id="e266a-161">Esempio</span><span class="sxs-lookup"><span data-stu-id="e266a-161">Sample</span></span>

<span data-ttu-id="e266a-162">Nell'esempio denominato WMPML viene illustrato come utilizzare i servizi di libreria.</span><span class="sxs-lookup"><span data-stu-id="e266a-162">The sample named WMPML demonstrates how to work with library services.</span></span> <span data-ttu-id="e266a-163">Per ulteriori informazioni sugli esempi di Windows Media Player SDK, vedere [esempi](samples.md).</span><span class="sxs-lookup"><span data-stu-id="e266a-163">For more information about Windows Media Player SDK samples, see [Samples](samples.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e266a-164">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="e266a-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e266a-165">**Informazioni sulla libreria**</span><span class="sxs-lookup"><span data-stu-id="e266a-165">**About the Library**</span></span>](about-the-library.md)
</dt> <dt>

[<span data-ttu-id="e266a-166">**Informazioni sull'oggetto query**</span><span class="sxs-lookup"><span data-stu-id="e266a-166">**About the Query Object**</span></span>](about-the-query-object.md)
</dt> <dt>

[<span data-ttu-id="e266a-167">**Interfaccia IWMPEvents3**</span><span class="sxs-lookup"><span data-stu-id="e266a-167">**IWMPEvents3 Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[<span data-ttu-id="e266a-168">**Interfaccia IWMPLibrary**</span><span class="sxs-lookup"><span data-stu-id="e266a-168">**IWMPLibrary Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary)
</dt> <dt>

[<span data-ttu-id="e266a-169">**Interfaccia IWMPLibrary (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="e266a-169">**IWMPLibrary Interface (VB and C#)**</span></span>](iwmplibrary--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="e266a-170">**Interfaccia IWMPLibraryServices**</span><span class="sxs-lookup"><span data-stu-id="e266a-170">**IWMPLibraryServices Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibraryservices)
</dt> <dt>

[<span data-ttu-id="e266a-171">**Interfaccia IWMPLibraryServices (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="e266a-171">**IWMPLibraryServices Interface (VB and C#)**</span></span>](iwmplibraryservices--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="e266a-172">**Interfaccia IWMPMediaCollection**</span><span class="sxs-lookup"><span data-stu-id="e266a-172">**IWMPMediaCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmediacollection)
</dt> <dt>

[<span data-ttu-id="e266a-173">**Interfaccia IWMPMediaCollection (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="e266a-173">**IWMPMediaCollection Interface (VB and C#)**</span></span>](iwmpmediacollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="e266a-174">**Interfaccia IWMPStringCollection**</span><span class="sxs-lookup"><span data-stu-id="e266a-174">**IWMPStringCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpstringcollection)
</dt> <dt>

[<span data-ttu-id="e266a-175">**Interfaccia IWMPStringCollection (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="e266a-175">**IWMPStringCollection Interface (VB and C#)**</span></span>](iwmpstringcollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="e266a-176">**Interfaccia IWMPQuery**</span><span class="sxs-lookup"><span data-stu-id="e266a-176">**IWMPQuery Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpquery)
</dt> <dt>

[<span data-ttu-id="e266a-177">**Interfaccia IWMPQuery (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="e266a-177">**IWMPQuery Interface (VB and C#)**</span></span>](iwmpquery--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="e266a-178">**Utilizzo della libreria**</span><span class="sxs-lookup"><span data-stu-id="e266a-178">**Working with the Library**</span></span>](working-with-the-library.md)
</dt> </dl>

 

 




