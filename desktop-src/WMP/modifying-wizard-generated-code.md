---
title: Modifica del codice generato dalla procedura guidata
description: Modifica del codice generato dalla procedura guidata
ms.assetid: 391a7773-c3e2-499a-bb63-e5934537d963
keywords:
- Windows Media Player Mobile, plug-in
- Plug-in di Windows Media Player Mobile, interfaccia utente
- Plug-in di Windows Media Player Mobile
- plug-in, interfaccia utente
- plug-in, Windows Media Player Mobile
- plug-in dell'interfaccia utente, Windows Media Player Mobile
- Plug-in dell'interfaccia utente, Windows Media Player Mobile
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a83bda7cb265d0c2e039ada6d9d827c6da3faf63
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106298603"
---
# <a name="modifying-wizard-generated-code"></a><span data-ttu-id="43a88-110">Modifica del codice generato dalla procedura guidata</span><span class="sxs-lookup"><span data-stu-id="43a88-110">Modifying Wizard-generated Code</span></span>

<span data-ttu-id="43a88-111">Esistono diverse posizioni nel codice del plug-in generato dalla procedura guidata che è necessario modificare prima che il plug-in funzioni con Windows Media Player 10 Mobile.</span><span class="sxs-lookup"><span data-stu-id="43a88-111">There are several places in the wizard-generated plug-in code that you must modify before your plug-in will work with Windows Media Player 10 Mobile.</span></span> <span data-ttu-id="43a88-112">Il codice che è necessario modificare è in grassetto negli esempi seguenti.</span><span class="sxs-lookup"><span data-stu-id="43a88-112">The code you must modify is bold in the following examples.</span></span>

## <a name="changes-to-wmpplugh"></a><span data-ttu-id="43a88-113">Modifiche a wmpplug. h</span><span class="sxs-lookup"><span data-stu-id="43a88-113">Changes to wmpplug.h</span></span>

<span data-ttu-id="43a88-114">I metodi ANSI non sono supportati nei dispositivi che eseguono Windows CE, quindi è necessario modificare il metodo ANSI seguente generato dalla procedura guidata in wmpplug. h:</span><span class="sxs-lookup"><span data-stu-id="43a88-114">ANSI methods are not supported on devices running Windows CE, so you must modify the following ANSI method generated by the wizard in wmpplug.h:</span></span>


```C++
return( ::PostMessage( HWND_BROADCAST, ::RegisterWindowMessageA( "WMPlayer_PluginAddRemove" ), 0, 0 ) );
```



<span data-ttu-id="43a88-115">Modificarlo come illustrato di seguito in modo che diventi un metodo Unicode:</span><span class="sxs-lookup"><span data-stu-id="43a88-115">Modify it as shown in the following so that it becomes a Unicode method:</span></span>


```C++
return( ::PostMessage( HWND_BROADCAST, ::RegisterWindowMessageW( L"WMPlayer_PluginAddRemove" ), 0, 0 ) );
```



## <a name="changes-to-networkpluginh"></a><span data-ttu-id="43a88-116">Modifiche a NetworkPlugin. h</span><span class="sxs-lookup"><span data-stu-id="43a88-116">Changes to NetworkPlugin.h</span></span>

<span data-ttu-id="43a88-117">Trovare il codice seguente in NetworkPlugin. h:</span><span class="sxs-lookup"><span data-stu-id="43a88-117">Find the following code in NetworkPlugin.h:</span></span>


```C++
BEGIN_COM_MAP(CNetworkPlugin)
    COM_INTERFACE(IWMPPluginUI)
END_COM_MAP()
```



<span data-ttu-id="43a88-118">Modificare il codice in modo che abbia un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="43a88-118">Modify the code so that it looks like this:</span></span>


```C++
BEGIN_COM_MAP(CNetworkPlugin)
    
COM_INTERFACE_ENTRY_IID(__uuidof(IWMPPluginUI), IWMPPluginUI)
END_COM_MAP()
```



## <a name="changes-to-networkplugindllcpp"></a><span data-ttu-id="43a88-119">Modifiche a NetworkPlugindll. cpp</span><span class="sxs-lookup"><span data-stu-id="43a88-119">Changes to NetworkPlugindll.cpp</span></span>

<span data-ttu-id="43a88-120">Trovare la funzione **DllMain** in NetworkPlugindll. cpp:</span><span class="sxs-lookup"><span data-stu-id="43a88-120">Find the **DllMain** function in NetworkPlugindll.cpp:</span></span>


```C++
extern "C" BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD dwReason, LPVOID /*lpReserved*/)
{
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        _Module.Init(ObjectMap, hInstance);
        DisableThreadLibraryCalls(hInstance);
    }
    else if (dwReason == DLL_PROCESS_DETACH)
        _Module.Term();
    return TRUE;    // ok
}
```



<span data-ttu-id="43a88-121">Modificare il codice in modo che abbia un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="43a88-121">Modify the code so that it looks like this:</span></span>


```C++
extern "C" BOOL WINAPI DllMain(HANDLE hInstance, DWORD dwReason, LPVOID /*lpReserved*/)
{
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        _Module.Init(ObjectMap, (HINSTANCE)hInstance);
#ifndef UNDER_CE
        DisableThreadLibraryCalls((HINSTANCE)hInstance);
#endif
    }
    else if (dwReason == DLL_PROCESS_DETACH)
        _Module.Term();
    return TRUE;    // ok
}
```



## <a name="changes-to-networkplugincpp"></a><span data-ttu-id="43a88-122">Modifiche a NetworkPlugin. cpp</span><span class="sxs-lookup"><span data-stu-id="43a88-122">Changes to NetworkPlugin.cpp</span></span>

<span data-ttu-id="43a88-123">Trovare il codice seguente in NetworkPlugin. cpp:</span><span class="sxs-lookup"><span data-stu-id="43a88-123">Find the following code in NetworkPlugin.cpp:</span></span>


```C++
hr = m_spCore->QueryInterface(&spConnectionContainer);
```



<span data-ttu-id="43a88-124">Modificare il codice in modo che abbia un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="43a88-124">Modify the code so that it looks like this:</span></span>


```C++
hr = m_spCore->QueryInterface(__uuidof(IConnectionPointContainer), (void**)&spConnectionContainer);
```



## <a name="change-the-threading-model"></a><span data-ttu-id="43a88-125">Modificare il modello di threading</span><span class="sxs-lookup"><span data-stu-id="43a88-125">Change the Threading Model</span></span>

<span data-ttu-id="43a88-126">Diversamente da ATL per Windows, ATL per Windows CE non supporta il modello di threading dell'Apartment perché il modello di Apartment richiede più risorse di memoria rispetto ai modelli a thread singolo e a thread libero.</span><span class="sxs-lookup"><span data-stu-id="43a88-126">Unlike ATL for Windows, ATL for Windows CE does not support the apartment threading model because the apartment model requires more memory resources than the single threading and free threading models.</span></span> <span data-ttu-id="43a88-127">Pertanto, è necessario trovare tutte le istanze del threading Apartment in StdAfx. h e NetworkPlugin. RGS e modificarle per indicare il threading libero.</span><span class="sxs-lookup"><span data-stu-id="43a88-127">Therefore, you must find all instances of apartment threading in StdAfx.h and NetworkPlugin.rgs and change them to indicate free threading.</span></span>

<span data-ttu-id="43a88-128">Inoltre, è possibile chiamare solo il controllo Windows Media Player 10 Mobile dal thread in cui è stato creato.</span><span class="sxs-lookup"><span data-stu-id="43a88-128">Also, you can only call the Windows Media Player 10 Mobile control from the thread on which it was created.</span></span>

## <a name="build-and-test-the-project"></a><span data-ttu-id="43a88-129">Compilare e testare il progetto</span><span class="sxs-lookup"><span data-stu-id="43a88-129">Build and Test the Project</span></span>

<span data-ttu-id="43a88-130">Dopo aver apportato queste modifiche, è possibile compilare il progetto per verificarne la compilazione prima di aggiungere qualsiasi codice personalizzato.</span><span class="sxs-lookup"><span data-stu-id="43a88-130">After making these changes outlined here, you can build your project to verify that it compiles before you add any custom code.</span></span>

1.  <span data-ttu-id="43a88-131">Impostare la configurazione del progetto attivo sulla versione Win32 (WCE ARMV4) debug o Win32 (WCE ARMV4).</span><span class="sxs-lookup"><span data-stu-id="43a88-131">Set the active project configuration to Win32 (WCE ARMV4) Debug or Win32 (WCE ARMV4) Release.</span></span>
2.  <span data-ttu-id="43a88-132">Impostare la piattaforma attiva su Pocket PC 2003.</span><span class="sxs-lookup"><span data-stu-id="43a88-132">Set the active platform to Pocket PC 2003.</span></span>
3.  <span data-ttu-id="43a88-133">Fare clic sulla voce di menu **Compila** , quindi selezionare **Compila NetworkPlugin.dll**.</span><span class="sxs-lookup"><span data-stu-id="43a88-133">Click the **Build** menu item, and then select **Build NetworkPlugin.dll**.</span></span> <span data-ttu-id="43a88-134">Deve compilare, scaricare e registrare se stesso nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="43a88-134">It should compile, download, and register itself on your device.</span></span>

## <a name="related-topics"></a><span data-ttu-id="43a88-135">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="43a88-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="43a88-136">**Creazione di un plug-in dell'interfaccia utente per Windows Media Player 10 Mobile**</span><span class="sxs-lookup"><span data-stu-id="43a88-136">**Creating a User Interface Plug-in for Windows Media Player 10 Mobile**</span></span>](creating-a-user-interface-plug-in-for-windows-media-player-10-mobile.md)
</dt> </dl>

 

 




