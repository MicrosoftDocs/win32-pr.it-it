---
description: Una funzionalità importante della telefonia è la piccola serie di funzioni denominate telefonia assistita.
ms.assetid: 1c41f52b-f8bf-410e-a966-9323a690a4d5
title: Panoramica della telefonia assistita
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b6a8826fd0c273936204d9250fb91504333d807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103967861"
---
# <a name="assisted-telephony-overview"></a><span data-ttu-id="07513-103">Panoramica della telefonia assistita</span><span class="sxs-lookup"><span data-stu-id="07513-103">Assisted Telephony Overview</span></span>

<span data-ttu-id="07513-104">Una funzionalità importante della telefonia è la piccola serie di funzioni denominate telefonia assistita.</span><span class="sxs-lookup"><span data-stu-id="07513-104">A valuable feature of telephony is the small set of functions called Assisted Telephony.</span></span> <span data-ttu-id="07513-105">La telefonia assistita è progettata per facilitare la creazione di chiamate vocali e di chiamate multimediali disponibili per qualsiasi applicazione, non solo per quelle dedicate alla funzionalità di telefonia.</span><span class="sxs-lookup"><span data-stu-id="07513-105">Assisted Telephony is designed to make the establishment of voice calls and of media calls available to any application, not just those dedicated to telephonic functionality.</span></span> <span data-ttu-id="07513-106">In altre parole, la telefonia assistita consente alle applicazioni di effettuare chiamate telefoniche senza che sia necessario conoscere i dettagli dei servizi dell'API di telefonia completa.</span><span class="sxs-lookup"><span data-stu-id="07513-106">In other words, Assisted Telephony lets applications make telephone calls without needing to be aware of the details of the services of the full Telephony API.</span></span> <span data-ttu-id="07513-107">Consente di estendere la telefonia a applicazioni di elaborazione di testo, fogli di calcolo, database, Personal Information Manager e altre applicazioni non di telefonia.</span><span class="sxs-lookup"><span data-stu-id="07513-107">It extends telephony to word-processing applications, spreadsheets, databases, personal information managers, and other non-telephony applications.</span></span>

<span data-ttu-id="07513-108">Per un elenco delle funzioni di telefonia assistita di TAPI 2. x della telefonia di base, vedere la Guida di riferimento alle funzioni [rapide TAPI](./tapi-quick-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="07513-108">For a list of TAPI 2.x Assisted Telephony functions of Basic Telephony, see [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span> <span data-ttu-id="07513-109">TAPI 3. x supporta la telefonia assistita tramite l'interfaccia [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) .</span><span class="sxs-lookup"><span data-stu-id="07513-109">TAPI 3.x supports assisted telephony through the [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) interface.</span></span>

<span data-ttu-id="07513-110">L'utilità della telefonia assistita può essere illustrata nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="07513-110">The usefulness of Assisted Telephony can be illustrated by the following example.</span></span> <span data-ttu-id="07513-111">Un'applicazione per fogli di calcolo può incorporare funzioni che compongono un numero di telefono per una chiamata vocale.</span><span class="sxs-lookup"><span data-stu-id="07513-111">A spreadsheet application can incorporate functions that dial a telephone number for a speech call.</span></span> <span data-ttu-id="07513-112">Fino a quando l'applicazione non necessita di alcun controllo di chiamata dettagliato fornito dall'API di telefonia completa, la telefonia assistita è il modo più semplice ed efficiente per fornire funzionalità di telefonia it.</span><span class="sxs-lookup"><span data-stu-id="07513-112">As long as the application needs none of the detailed call control provided by the full Telephony API, Assisted Telephony is the easiest and most efficient way to give it telephonic functionality.</span></span>

![telefonia assistita con un'applicazione foglio di calcolo](images/assist4.png)

<span data-ttu-id="07513-114">La telefonia assistita e l'API di telefonia completa vengono utilizzate e implementate in modi diversi, pertanto non è consigliabile combinare chiamate di funzione di telefonia assistita e chiamate di funzioni API di telefonia all'interno di una singola applicazione.</span><span class="sxs-lookup"><span data-stu-id="07513-114">Assisted Telephony and the full Telephony API are used and implemented in different ways, so it is not advised to mix Assisted Telephony function calls and Telephony API function calls within a single application.</span></span>

## <a name="using-assisted-telephony"></a><span data-ttu-id="07513-115">Uso della telefonia assistita</span><span class="sxs-lookup"><span data-stu-id="07513-115">Using Assisted Telephony</span></span>

<span data-ttu-id="07513-116">Le applicazioni che utilizzano servizi di telefonia assistita avviano solo richieste di chiamata temporaneamente accodate da TAPI.</span><span class="sxs-lookup"><span data-stu-id="07513-116">Applications that use Assisted Telephony services only initiate call requests that are temporarily queued by TAPI.</span></span> <span data-ttu-id="07513-117">L'applicazione Richiedi destinatario recupera queste richieste e le esegue per conto dell'applicazione di telefonia assistita.</span><span class="sxs-lookup"><span data-stu-id="07513-117">The request recipient application retrieves these requests and executes them on behalf of the Assisted Telephony application.</span></span> <span data-ttu-id="07513-118">La funzione [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) richiede la creazione di una chiamata vocale.</span><span class="sxs-lookup"><span data-stu-id="07513-118">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests the establishment of a voice call.</span></span> <span data-ttu-id="07513-119">L'applicazione richiedente non controlla la chiamata.</span><span class="sxs-lookup"><span data-stu-id="07513-119">The requesting application does not control the call.</span></span>

<span data-ttu-id="07513-120">TAPI consente all'utente di definire applicazioni destinatarie diverse o identiche per ognuno di questi servizi.</span><span class="sxs-lookup"><span data-stu-id="07513-120">TAPI allows the user to establish different or the same request recipient applications for each of these services.</span></span> <span data-ttu-id="07513-121">Un'applicazione diventa un destinatario della richiesta mediante la registrazione con [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), in cui **true** viene specificato come valore per il parametro *bEnable*.</span><span class="sxs-lookup"><span data-stu-id="07513-121">An application becomes a request recipient by registering with [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), in which **TRUE** is specified as the value for the parameter *bEnable*.</span></span> <span data-ttu-id="07513-122">(Se si specifica **false** , l'applicazione viene annullata come destinatario della richiesta, operazione che deve essere eseguita quando è stato determinato che i compiti del destinatario passano per la sessione corrente). L'applicazione seleziona i servizi che desidera gestire nel parametro *dwRequestMode* di **lineRegisterRequestRecipient**.</span><span class="sxs-lookup"><span data-stu-id="07513-122">(Specifying **FALSE** deregisters the application as a request recipient, which it should do when it has determined that its recipient duties are through for the current session.) The application selects the services it wants to handle in the *dwRequestMode* parameter of **lineRegisterRequestRecipient**.</span></span> <span data-ttu-id="07513-123">Un possibile valore per una richiesta è LINEREQUESTMODE \_ MAKECALL, per indicare che l'applicazione gestirà le richieste [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) .</span><span class="sxs-lookup"><span data-stu-id="07513-123">A possible value for a request is LINEREQUESTMODE\_MAKECALL, to show that the application will handle [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) requests.</span></span> <span data-ttu-id="07513-124">Se più applicazioni si registrano per gli stessi servizi, viene utilizzato uno schema di priorità per consentire all'utente di selezionare quale applicazione è preferibile per la gestione delle richieste.</span><span class="sxs-lookup"><span data-stu-id="07513-124">If multiple applications register for the same services, a priority scheme is used to allow the user to select which application is preferred for handling requests.</span></span> <span data-ttu-id="07513-125">Questo schema di priorità è identico a quello usato per la consegna delle chiamate e il routing delle chiamate in ingresso in base a un elenco di nomi di file in **HandoffPriorities** nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="07513-125">This priority scheme is identical to that used for call handoff and the routing of incoming calls based on a list of file names in **HandoffPriorities** in the registry.</span></span>

## <a name="call-requests"></a><span data-ttu-id="07513-126">Richieste di chiamata</span><span class="sxs-lookup"><span data-stu-id="07513-126">Call Requests</span></span>

<span data-ttu-id="07513-127">La telefonia assistita offre applicazioni abilitate per la telefonia con un meccanismo di facile utilizzo per effettuare chiamate telefoniche senza richiedere che lo sviluppatore diventi completamente alfabetizzato nella telefonia.</span><span class="sxs-lookup"><span data-stu-id="07513-127">Assisted Telephony provides telephony-enabled applications with an easy-to-use mechanism for making phone calls without requiring the developer to become fully literate in telephony.</span></span>

<span data-ttu-id="07513-128">La funzione [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) richiede una chiamata vocale tra l'utente e una parte remota specificata dal numero di telefono.</span><span class="sxs-lookup"><span data-stu-id="07513-128">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests a voice call between the user and a remote party specified by its phone number.</span></span> <span data-ttu-id="07513-129">La richiesta viene effettuata a TAPI, che la passa a un'applicazione registrata come destinatario di tali richieste.</span><span class="sxs-lookup"><span data-stu-id="07513-129">The request is made to TAPI, which passes it to an application that is registered as a recipient of such requests.</span></span> <span data-ttu-id="07513-130">Questo destinatario è un'applicazione Call Manager.</span><span class="sxs-lookup"><span data-stu-id="07513-130">This recipient is a call manager application.</span></span>

<span data-ttu-id="07513-131">Dopo che l'applicazione ha effettuato la richiesta, la chiamata viene controllata interamente dall'applicazione Call Manager perché le applicazioni di telefonia assistita non possono gestire le chiamate.</span><span class="sxs-lookup"><span data-stu-id="07513-131">After the application has made the request, the call is controlled entirely from the call manager application because Assisted Telephony applications cannot manage calls.</span></span> <span data-ttu-id="07513-132">Poiché gli aspetti più complessi della telefonia e tutte le operazioni dell'interfaccia utente vengono gestiti dall'applicazione Call Manager, le applicazioni abilitate per la telefonia non devono essere modificate in alcun modo sostanziale.</span><span class="sxs-lookup"><span data-stu-id="07513-132">Because the more complex aspects of telephony and all user-interface operations are handled by the call manager application, telephony-enabled applications need not be modified in any substantial way.</span></span> <span data-ttu-id="07513-133">Infatti, le applicazioni che consentono di richiamare questa operazione dal linguaggio di script predefinito potrebbero non essere necessariamente modificate.</span><span class="sxs-lookup"><span data-stu-id="07513-133">In fact, applications that allow this operation to be invoked from their built-in script language may not need to be modified at all.</span></span>

<span data-ttu-id="07513-134">La funzione [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) restituisce all'applicazione il codice del paese o dell'area geografica e il codice della città (area) che l'utente ha impostato nei parametri del percorso corrente nel pannello di controllo della telefonia.</span><span class="sxs-lookup"><span data-stu-id="07513-134">The [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) function returns to the application the country or region code and city (area) code that the user has set in the current location parameters in the Telephony Control Panel.</span></span> <span data-ttu-id="07513-135">L'applicazione può utilizzare queste informazioni per aiutare l'utente a formare numeri di telefono canonico appropriati, ad esempio offrendo questi valori come predefiniti quando vengono immessi nuovi numeri in una voce della rubrica telefonica o in un record di database.</span><span class="sxs-lookup"><span data-stu-id="07513-135">The application can use this information to assist the user in forming proper canonical telephone numbers, such as by offering these as defaults when new numbers are entered in a phone book entry or database record.</span></span>

## <a name="request-recipients"></a><span data-ttu-id="07513-136">Destinatari richieste</span><span class="sxs-lookup"><span data-stu-id="07513-136">Request Recipients</span></span>

<span data-ttu-id="07513-137">Per eseguire la telefonia assistita sono necessari due tipi di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="07513-137">Two kinds of applications are needed to run Assisted Telephony.</span></span> <span data-ttu-id="07513-138">I *client* di telefonia assistita sono applicazioni che utilizzano la telefonia assistita chiamando le funzioni con prefisso "TAPI".</span><span class="sxs-lookup"><span data-stu-id="07513-138">Assisted Telephony *clients* are applications that use Assisted Telephony by calling the functions that have the prefix "tapi."</span></span> <span data-ttu-id="07513-139">Un esempio di tale applicazione client può essere un foglio di calcolo a cui viene aggiunto un comando di menu di **selezione** o un pulsante della barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="07513-139">An example of such a client application would be a spreadsheet to which a **Dial** menu command or toolbar button is added.</span></span>

<span data-ttu-id="07513-140">I *Server* di telefonia assistita sono applicazioni in grado di eseguire funzioni API di telefonia derivanti da una chiamata di un'altra applicazione a una funzione con prefisso "TAPI".</span><span class="sxs-lookup"><span data-stu-id="07513-140">Assisted Telephony *servers* are applications that can execute Telephony API functions that result from another application's call to a "tapi"-prefixed function.</span></span> <span data-ttu-id="07513-141">Per rendersi noto come server di telefonia assistito, un'applicazione di questo tipo viene registrata come un server utilizzando la funzione [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) .</span><span class="sxs-lookup"><span data-stu-id="07513-141">To make itself known as an Assisted Telephony server, such an application registers as one using the [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) function.</span></span>

<span data-ttu-id="07513-142">Le funzioni della telefonia assistita, che iniziano con il prefisso "TAPI", sono note come *funzioni di richiesta*.</span><span class="sxs-lookup"><span data-stu-id="07513-142">The functions of Assisted Telephony (which begin with the prefix "tapi") are known as *request functions*.</span></span> <span data-ttu-id="07513-143">Le applicazioni di telefonia assistita che elaborano queste richieste, ovvero i server di telefonia assistita, vengono chiamate *destinatari della richiesta*.</span><span class="sxs-lookup"><span data-stu-id="07513-143">Assisted Telephony applications that process these requests—Assisted Telephony servers—are called *request recipients*.</span></span>

## <a name="processing-assisted-telephony-requests"></a><span data-ttu-id="07513-144">Elaborazione di richieste di telefonia assistita</span><span class="sxs-lookup"><span data-stu-id="07513-144">Processing Assisted Telephony Requests</span></span>

<span data-ttu-id="07513-145">Il processo con cui vengono recapitate e gestite le richieste è il seguente:</span><span class="sxs-lookup"><span data-stu-id="07513-145">The process with which requests are delivered and serviced is as follows:</span></span>

1.  <span data-ttu-id="07513-146">Quando TAPI riceve una richiesta di telefonia assistita, verifica la presenza di un destinatario della richiesta, ovvero un'applicazione attualmente registrata per elaborare quel tipo di richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-146">When TAPI receives an Assisted Telephony request, it checks for a request recipient, that is, an application currently registered to process that type of request.</span></span> <span data-ttu-id="07513-147">Se è presente un destinatario della richiesta, la richiesta viene accodata e l'applicazione con la priorità più alta registrata per il servizio della richiesta riceve un messaggio [**di \_ richiesta di riga**](./line-request.md) .</span><span class="sxs-lookup"><span data-stu-id="07513-147">If there is a request recipient, the request is queued, and the highest-priority application that has registered for that request's service is sent a [**LINE\_REQUEST**](./line-request.md) message.</span></span> <span data-ttu-id="07513-148">Il messaggio notifica al destinatario della richiesta che è arrivata una nuova richiesta e contiene un'indicazione della modalità della richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-148">The message notifies the request recipient that a new request has arrived, and it carries an indication of the request's mode.</span></span>
2.  <span data-ttu-id="07513-149">Se TAPI non riesce a trovare un'applicazione attualmente in esecuzione per elaborare una richiesta di questo tipo, tenta di avviare un'applicazione registrata come in grado di eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="07513-149">If TAPI cannot find a currently running application to process such a request, it tries to launch an application that has been registered as capable of doing so.</span></span> <span data-ttu-id="07513-150">Le informazioni di registrazione vengono registrate in **HandoffPriorities** nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="07513-150">This registration information is recorded in **HandoffPriorities** in the registry.</span></span> <span data-ttu-id="07513-151">TAPI tenta di avviare le applicazioni nell'ordine in cui sono elencate nella sezione **HandoffPriorities** .</span><span class="sxs-lookup"><span data-stu-id="07513-151">TAPI tries to launch applications in the order in which they are listed in the **HandoffPriorities** section.</span></span> <span data-ttu-id="07513-152">(Vedere il passaggio successivo).</span><span class="sxs-lookup"><span data-stu-id="07513-152">(See the following step.)</span></span>

    <span data-ttu-id="07513-153">Se non è attualmente registrata alcuna applicazione, TAPI esamina l'elenco di applicazioni di elaborazione richieste sulla voce associata in **HandoffPriorities**.</span><span class="sxs-lookup"><span data-stu-id="07513-153">If no application is currently registered, TAPI examines the list of request-processing applications on the associated entry in **HandoffPriorities**.</span></span> <span data-ttu-id="07513-154">Se la riga associata non è presente nel file, se non vi sono applicazioni elencate o se non è possibile avviare nessuna delle applicazioni nell'elenco, la richiesta viene rifiutata con l'errore TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="07513-154">If the associated line is missing from the file, if there are no applications listed on it, or if none of the applications in the list can be launched, the request is rejected with the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

    <span data-ttu-id="07513-155">Quando viene avviato un destinatario della richiesta (indipendentemente dal fatto che sia stato avviato da TAPI), è doveroso chiamare [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) durante il processo di avvio e registrarsi come destinatario della richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-155">When a request recipient is launched (whether or not it has been launched by TAPI) it is its duty to call [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) during the startup process and register itself as a request recipient.</span></span>

3.  <span data-ttu-id="07513-156">Se nella voce sono elencate una o più applicazioni, TAPI inizia con la prima applicazione elencata (priorità più alta) e tenta di avviarla utilizzando la funzione [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="07513-156">If one or more applications are listed in the entry, TAPI begins with the first listed application (highest priority), and attempts to launch it using the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="07513-157">Se il tentativo di avviare l'applicazione ha esito negativo, TAPI tenta di avviare l'applicazione successiva nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="07513-157">If the attempt to launch the application fails, TAPI attempts to launch the next application in the list.</span></span> <span data-ttu-id="07513-158">Quando un'applicazione viene avviata correttamente, TAPI Accoda semplicemente la richiesta e restituisce un'indicazione di esito positivo all'applicazione anche se la richiesta non è stata ancora segnalata al destinatario della richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-158">When any application launches successfully, TAPI simply queues the request and returns a success indication to the application even though the request hasn't yet been signaled to the request recipient.</span></span>

    <span data-ttu-id="07513-159">Una volta avviata, l'applicazione del destinatario della richiesta chiama [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), che causa l'invio di un messaggio di [**\_ richiesta di riga**](./line-request.md) , segnalando che la richiesta è stata accodata.</span><span class="sxs-lookup"><span data-stu-id="07513-159">After the request recipient application is launched, it calls [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), which causes a [**LINE\_REQUEST**](./line-request.md) message to be sent, signaling that the request is queued.</span></span> <span data-ttu-id="07513-160">Se per qualche motivo l'applicazione avviata non viene mai registrata, la richiesta rimane in coda e rimane nella coda per un periodo illimitato fino a quando un'applicazione non si registra per quel tipo di richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-160">If for some reason the launched application never registers, the request remains queued and remains in the queue indefinitely until an application registers for that type of request.</span></span>

4.  <span data-ttu-id="07513-161">Se TAPI trova una tale applicazione registrata già in esecuzione o ne avvia una correttamente, Accoda la richiesta, invia un \_ messaggio di richiesta di riga all'applicazione server e restituisce un'indicazione di esito positivo per la chiamata di funzione all'applicazione di telefonia assistita.</span><span class="sxs-lookup"><span data-stu-id="07513-161">If TAPI finds such a registered application already running or successfully launches one, it queues the request, sending a LINE\_REQUEST message to the server application, and returns a success indication for the function call to the Assisted Telephony application.</span></span> <span data-ttu-id="07513-162">Questo messaggio di esito positivo indica solo che la richiesta è stata accettata e accodata e non è stata eseguita correttamente.</span><span class="sxs-lookup"><span data-stu-id="07513-162">This success message states only that the request has been accepted and queued, not that it has been successfully executed.</span></span>

<span data-ttu-id="07513-163">Quando l'applicazione server è pronta per l'elaborazione di una richiesta, chiama la funzione [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) .</span><span class="sxs-lookup"><span data-stu-id="07513-163">When the server application is ready to process a request, it calls the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function.</span></span> <span data-ttu-id="07513-164">Ciò consente di ricevere tutte le informazioni necessarie, ad esempio un indirizzo da comporre.</span><span class="sxs-lookup"><span data-stu-id="07513-164">This lets it receive any information it needs, such as an address to dial.</span></span> <span data-ttu-id="07513-165">Elabora quindi la richiesta, usando le funzioni TAPI, ad esempio [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) e [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop), che altrimenti verrebbero usate per inserire la chiamata.</span><span class="sxs-lookup"><span data-stu-id="07513-165">It then processes the request, using the TAPI functions (such as [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) and [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) that would otherwise be used to place the call.</span></span> <span data-ttu-id="07513-166">Richiamando **lineGetRequest** viene rimossa la richiesta da TAPI e i parametri della richiesta vengono copiati in un buffer di richiesta allocato dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="07513-166">Invoking **lineGetRequest** removes the request from TAPI, and the request parameters are copied in an application-allocated request buffer.</span></span> <span data-ttu-id="07513-167">Le dimensioni e l'interpretazione del contenuto del buffer dipendono dalla modalità di richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-167">The size and interpretation of the contents of the buffer depend on the request mode.</span></span>

<span data-ttu-id="07513-168">Il server deve assicurarsi che usi i parametri corretti durante l'esecuzione delle richieste.</span><span class="sxs-lookup"><span data-stu-id="07513-168">The server must ensure that it uses the correct parameters when executing requests.</span></span> <span data-ttu-id="07513-169">Quando si esegue questa operazione, vengono seguiti i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="07513-169">When doing so, these steps are followed:</span></span>

1.  <span data-ttu-id="07513-170">Il destinatario della richiesta riceve prima di tutto un messaggio di [**\_ richiesta di riga**](./line-request.md) che informa che è possibile che esistano richieste nella coda di richieste.</span><span class="sxs-lookup"><span data-stu-id="07513-170">The request recipient first receives a [**LINE\_REQUEST**](./line-request.md) message informing it that requests can exist for it in the request queue.</span></span> <span data-ttu-id="07513-171">In questo modo, l'applicazione chiama [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) e continua a chiamarla finché la coda non viene svuotata (se la richiesta è per effettuare una nuova chiamata) o per eliminare una chiamata esistente.</span><span class="sxs-lookup"><span data-stu-id="07513-171">This tells the application to call [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) and keep calling it until the queue is drained (if the request is for making a new call), or to drop an existing call.</span></span> <span data-ttu-id="07513-172">Questo messaggio non contiene i parametri per la richiesta, tranne nel caso di una richiesta di eliminazione di una chiamata esistente.</span><span class="sxs-lookup"><span data-stu-id="07513-172">This message does not contain the parameters for the request, except in the case of a request to drop an existing call.</span></span>
2.  <span data-ttu-id="07513-173">Se la richiesta deve effettuare una nuova chiamata, il server di telefonia assistita usa la funzione [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) per recuperare la richiesta completa, che include i parametri della richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-173">If the request is to make a new call, the Assisted Telephony server uses the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function to retrieve the full request, which includes the request's parameters.</span></span> <span data-ttu-id="07513-174">Il server ha ora tutte le informazioni necessarie, ad esempio il numero da comporre o l'identificazione del creatore della richiesta.</span><span class="sxs-lookup"><span data-stu-id="07513-174">The server now has all the information it needs, such as the number to dial or the identification of the maker of the request.</span></span> <span data-ttu-id="07513-175">Prima di tutto, tuttavia, il server deve allocare la memoria necessaria per archiviare queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="07513-175">First, however, the server must allocate the memory needed to store this information.</span></span>
3.  <span data-ttu-id="07513-176">Infine, il server esegue la richiesta richiamando la funzione o il set di funzioni TAPI appropriato.</span><span class="sxs-lookup"><span data-stu-id="07513-176">Finally, the server executes the request by invoking the appropriate TAPI function or set of functions.</span></span>

<span data-ttu-id="07513-177">Se TAPI non può avviare un'applicazione in grado di fungere da destinatario della richiesta, la chiamata di telefonia assistita ha esito negativo e restituisce l'errore TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="07513-177">If TAPI cannot launch an application capable of serving as a request recipient, the Assisted Telephony call fails and returns the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

## <a name="notes-on-request-recipient-operations"></a><span data-ttu-id="07513-178">Note sulle operazioni del destinatario della richiesta</span><span class="sxs-lookup"><span data-stu-id="07513-178">Notes on Request Recipient Operations</span></span>

<span data-ttu-id="07513-179">Le informazioni seguenti riguardano i sistemi in cui vengono elaborate le richieste di telefonia assistita:</span><span class="sxs-lookup"><span data-stu-id="07513-179">The following information concerns systems on which Assisted Telephony requests are processed:</span></span>

-   <span data-ttu-id="07513-180">Il registro di sistema predefinito dovrebbe elencare un'applicazione Call Manager nell'elenco di priorità per [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span><span class="sxs-lookup"><span data-stu-id="07513-180">The default registry should list a call manager application in the priority list for [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span></span> <span data-ttu-id="07513-181">Sarebbe utile, ma non essenziale, che l'applicazione Call Manager disponga di un'opzione di menu che consente agli utenti di impostarla sulla priorità più elevata.</span><span class="sxs-lookup"><span data-stu-id="07513-181">It would be helpful, but not essential, for the call manager application to have a menu option that allows users to set it to the highest priority.</span></span>
-   <span data-ttu-id="07513-182">Quando un'applicazione del destinatario della telefonia assistita viene avviata automaticamente da TAPI e se è l'unica applicazione TAPI nel sistema, questa azione Inizializza TAPI.</span><span class="sxs-lookup"><span data-stu-id="07513-182">When an Assisted Telephony recipient application is launched automatically by TAPI and if it is the only TAPI application in the system, this action initializes TAPI.</span></span> <span data-ttu-id="07513-183">Se l'applicazione del destinatario di telefonia assistita Inizializza e arresta il dispositivo di linea prima di eseguire la registrazione per le richieste di telefonia assistita, viene arrestato anche TAPI e la richiesta di telefonia assistita viene persa.</span><span class="sxs-lookup"><span data-stu-id="07513-183">If the Assisted Telephony recipient application initializes and shuts down the line device before registering for Assisted Telephony requests, TAPI is shut down as well, and the Assisted Telephony request is lost.</span></span> <span data-ttu-id="07513-184">Anche le richieste di telefonia assistita possono andare perse quando un'altra applicazione TAPI avviata esegue un inizializzazione e una chiusura.</span><span class="sxs-lookup"><span data-stu-id="07513-184">Assisted Telephony requests might also be lost when another TAPI application that is launched performs an initialize and shutdown.</span></span>

 

 
