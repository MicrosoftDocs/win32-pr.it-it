---
description: La natura interattiva della telefonia richiede che TAPI sia un ambiente operativo in tempo reale.
ms.assetid: b8512588-ec28-4fbe-b47f-b900e2dba1f2
title: Modello sincrono/asincrono
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 02b3d3b58e9704719e502fa3efc11bc4dc216479
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311866"
---
# <a name="synchronousasynchronous-model"></a><span data-ttu-id="142d2-103">Modello sincrono/asincrono</span><span class="sxs-lookup"><span data-stu-id="142d2-103">Synchronous/Asynchronous Model</span></span>

<span data-ttu-id="142d2-104">La natura interattiva della telefonia richiede che TAPI sia un ambiente operativo in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="142d2-104">The interactive nature of telephony requires TAPI to be a real-time operating environment.</span></span> <span data-ttu-id="142d2-105">Molte delle funzioni TAPI sono necessarie per il completamento rapido e la restituzione dei risultati all'applicazione in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="142d2-105">Many of the TAPI functions are required to complete quickly and return their results to the application synchronously.</span></span> <span data-ttu-id="142d2-106">Altre funzioni (ad esempio, la composizione) potrebbero non essere in grado di essere completate in modo rapido e pertanto funzionare in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="142d2-106">Other functions (such as dialing) may not be able to complete as quickly and therefore operate asynchronously.</span></span>

<span data-ttu-id="142d2-107">Le operazioni di telefonia vengono completate in modo sincrono o asincrono.</span><span class="sxs-lookup"><span data-stu-id="142d2-107">Telephony operations complete either synchronously or asynchronously.</span></span> <span data-ttu-id="142d2-108">Questi due modelli sono diversi da quelli indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="142d2-108">These two models differ as follows.</span></span> <span data-ttu-id="142d2-109">Le *funzioni sincrone* eseguono l'intera richiesta prima che il thread del chiamante possa restituire dalla chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="142d2-109">*Synchronous functions* execute the entire request before the caller's thread is allowed to return from the function call.</span></span> <span data-ttu-id="142d2-110">Le *funzioni asincrone* restituiscono prima che la richiesta venga eseguita completamente.</span><span class="sxs-lookup"><span data-stu-id="142d2-110">*Asynchronous functions* return before the request has executed in its entirety.</span></span> <span data-ttu-id="142d2-111">Quando la richiesta asincrona viene completata in un secondo momento, il provider di servizi segnala il completamento chiamando una routine di callback inizialmente fornita da TAPI all'inizio della sequenza di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="142d2-111">When the asynchronous request later completes, the service provider reports the completion by calling a callback procedure that TAPI originally supplied to it early in the initialization sequence.</span></span>

-   <span data-ttu-id="142d2-112">Le operazioni asincrone hanno un parametro denominato *dwRequestID* del tipo definito [drv \_ RequestId](./drv-requestid.md) come primo parametro.</span><span class="sxs-lookup"><span data-stu-id="142d2-112">Asynchronous operations have a parameter named *dwRequestID* of the defined type [DRV\_REQUESTID](./drv-requestid.md) as their first parameter.</span></span> <span data-ttu-id="142d2-113">Tale operazione esegue parte dell'elaborazione nella chiamata di funzione e il resto della relativa elaborazione in un thread di esecuzione indipendente dopo che è stata restituita la chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="142d2-113">Such an operation performs part of its processing in the function call and the remainder of its processing in an independent execution thread after the function call has returned.</span></span> <span data-ttu-id="142d2-114">Quando la funzione restituisce, restituisce un risultato di errore negativo o il *dwRequestID* (positivo) passato nella chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="142d2-114">When the function returns, it returns either a negative error result or the (positive) *dwRequestID* that was passed in the function call.</span></span> <span data-ttu-id="142d2-115">Il risultato dell'errore negativo indica che l'operazione è stata completata e non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="142d2-115">The negative error result indicates that the operation is complete (and failed).</span></span> <span data-ttu-id="142d2-116">Il *dwRequestID* positivo restituito indica che l'operazione continua nel thread indipendente.</span><span class="sxs-lookup"><span data-stu-id="142d2-116">The positive *dwRequestID* returned indicates that the operation continues in the independent thread.</span></span> <span data-ttu-id="142d2-117">In tal caso, il provider di servizi chiama infine la procedura di [**\_ completamento asincrono**](/windows/win32/api/tspi/nc-tspi-async_completion) , passando *dwRequestID* e un codice risultato per indicare il risultato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="142d2-117">In such a case, the service provider eventually calls the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) procedure, passing the *dwRequestID* and a result code to indicate the outcome of the operation.</span></span> <span data-ttu-id="142d2-118">Il codice risultato è zero per l'esito positivo o uno dello stesso set di risultati di errore (negativo).</span><span class="sxs-lookup"><span data-stu-id="142d2-118">The result code is zero for success or one of the same set of (negative) error results.</span></span> <span data-ttu-id="142d2-119">In ogni caso, il provider di servizi non deve mai restituire zero o un valore positivo diverso da *dwRequestID* da una funzione designata come asincrona perché questa operazione può produrre risultati imprevisti.</span><span class="sxs-lookup"><span data-stu-id="142d2-119">In any case, the service provider must never return zero or any positive value other than *dwRequestID* from a function designated as asynchronous because doing so can produce unexpected results.</span></span> <span data-ttu-id="142d2-120">I provider di servizi devono copiare sempre i dati di input dalla memoria dell'applicazione nella memoria del provider di servizi prima di restituire una funzione asincrona.</span><span class="sxs-lookup"><span data-stu-id="142d2-120">Service providers should always copy input data from application memory into service provider memory before returning from an asynchronous function.</span></span>
-   <span data-ttu-id="142d2-121">Le operazioni sincrone non hanno *dwRequestID* come primo parametro.</span><span class="sxs-lookup"><span data-stu-id="142d2-121">Synchronous operations do not have *dwRequestID* as their first parameter.</span></span> <span data-ttu-id="142d2-122">Tale operazione esegue tutta la relativa elaborazione nel thread di esecuzione del chiamante, restituendo il risultato finale quando restituisce.</span><span class="sxs-lookup"><span data-stu-id="142d2-122">Such an operation performs all of its processing in the caller's execution thread, returning the final result when it returns.</span></span> <span data-ttu-id="142d2-123">Il risultato è zero per l'esito positivo o un codice di errore negativo per l'errore.</span><span class="sxs-lookup"><span data-stu-id="142d2-123">The result is zero for success or a negative error code for failure.</span></span> <span data-ttu-id="142d2-124">Il provider di servizi non chiama [**il \_ completamento asincrono**](/windows/win32/api/tspi/nc-tspi-async_completion) per le operazioni sincrone.</span><span class="sxs-lookup"><span data-stu-id="142d2-124">The service provider does not call [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) for synchronous operations.</span></span>

<span data-ttu-id="142d2-125">È interessante considerare la tempistica di un callback di completamento rispetto a quando la richiesta originale restituisce.</span><span class="sxs-lookup"><span data-stu-id="142d2-125">It is interesting to consider the timing of a "completion" callback relative to when the original request returns.</span></span> <span data-ttu-id="142d2-126">Una tipica richiesta asincrona viene implementata dal provider di servizi come nel seguente pseudocodice:</span><span class="sxs-lookup"><span data-stu-id="142d2-126">A typical asynchronous request would be implemented by the service provider as in the following pseudocode:</span></span>

``` syntax
Some_request(Request_ID, ...) {
  check parameters for validity
  check device state for validity
  store Request_ID for Completion Interrupt Handler's use
  manipulate device registers to start physical operation
  return Request_ID  // to indicate asynch operation
}
Operation Completion Interrupt Handler: {
  if operation was successful then
    call "completion" callback passing Request_ID and "success"
  else
    call "completion" callback passing Request_ID and "error num"
  endif
}
```

<span data-ttu-id="142d2-127">Se l'operazione viene completata molto rapidamente (o la richiesta originale restituisce molto lentamente), è possibile che il gestore di interrupt eseguito al termine di un'operazione fisica venga attivato prima che la richiesta originale venga restituita all'applicazione o anche a TAPI.</span><span class="sxs-lookup"><span data-stu-id="142d2-127">If the operation completes very rapidly (or the original request returns very slowly), it is possible that the interrupt handler that runs when a physical operation completes may be triggered before the original request returns to the application or even to TAPI.</span></span> <span data-ttu-id="142d2-128">Questo comportamento è consentito.</span><span class="sxs-lookup"><span data-stu-id="142d2-128">This behavior is allowed.</span></span> <span data-ttu-id="142d2-129">TAPI garantisce che la notifica di completamento finale per l'applicazione venga recapitata dopo la restituzione della richiesta originale.</span><span class="sxs-lookup"><span data-stu-id="142d2-129">TAPI guarantees that the eventual completion notification to the application is delivered after the original request returns.</span></span>

<span data-ttu-id="142d2-130">**TAPI 2. x:** Elenca lo stato che indica se ogni funzione viene completata in modo sincrono o asincrono nella [Guida di riferimento alle funzioni rapide TAPI](./tapi-quick-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="142d2-130">**TAPI 2.x:** Lists which state whether each function completes synchronously or asynchronously appear in [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span>

 

 
