---
description: Le applicazioni TAPI si trovano nello spazio di processo.
ms.assetid: 57dedad1-7264-48fc-9ac2-c6c72f7fee27
title: Panoramica del provider di servizi TAPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e847ed49879e9ff55662477a762fa7297443d12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104564454"
---
# <a name="tapi-service-provider-overview"></a><span data-ttu-id="ccc6d-103">Panoramica del provider di servizi TAPI</span><span class="sxs-lookup"><span data-stu-id="ccc6d-103">TAPI Service Provider Overview</span></span>

<span data-ttu-id="ccc6d-104">Le applicazioni TAPI si trovano nello spazio di processo.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-104">TAPI applications reside in their own process space.</span></span> <span data-ttu-id="ccc6d-105">Le applicazioni TAPI caricano il Tapi32.dll o Tapi3.dll nel loro processo e TAPI comunica con TAPISRV tramite un'interfaccia RPC privata.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-105">TAPI applications load the Tapi32.dll or Tapi3.dll into their process, and TAPI communicates with TAPISRV through a private RPC interface.</span></span> <span data-ttu-id="ccc6d-106">Un TSP viene eseguito nel contesto di TAPISRV.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-106">A TSP runs in the context of TAPISRV.</span></span> <span data-ttu-id="ccc6d-107">Un determinato TSP può trovarsi in un computer diverso dal computer dell'utente ed è possibile accedervi usando un TSP remoto.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-107">A given TSP may reside on a machine other than the user's machine and is accessed using a remote TSP.</span></span> <span data-ttu-id="ccc6d-108">TAPISRV viene implementato come processo del servizio all'interno di SVCHOST.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-108">TAPISRV is implemented as a service process within SVCHOST.</span></span> <span data-ttu-id="ccc6d-109">Un MSP risiede nello spazio di processo dell'applicazione ed è sempre locale.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-109">An MSP lives within the process space of the application and is always local.</span></span>

<span data-ttu-id="ccc6d-110">Una coppia TSP/MSP può essere considerata come avente un percorso di comunicazione privato virtuale.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-110">A TSP/MSP pair can be regarded as having a virtual private communication path.</span></span> <span data-ttu-id="ccc6d-111">È possibile inviare informazioni tra i due usando buffer opachi che non vengono interpretati da TAPISRV o dalla DLL TAPI.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-111">Information can be sent between the two using opaque buffers that are not interpreted by either TAPISRV or the TAPI DLL.</span></span>

<span data-ttu-id="ccc6d-112">Alcuni provider di servizi implementano operazioni specifiche per l'hardware necessario.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-112">Some service providers implement operations specific to the hardware involved.</span></span> <span data-ttu-id="ccc6d-113">TAPI 2. x consente di accedere a tali operazioni tramite la funzione [**lineDevSpecific**](/windows/win32/api/tapi/nf-tapi-linedevspecific) o [**phoneDevSpecific**](/windows/win32/api/tapi/nf-tapi-phonedevspecific) .</span><span class="sxs-lookup"><span data-stu-id="ccc6d-113">TAPI 2.x provides access to such operations through the [**lineDevSpecific**](/windows/win32/api/tapi/nf-tapi-linedevspecific) or [**phoneDevSpecific**](/windows/win32/api/tapi/nf-tapi-phonedevspecific) function.</span></span> <span data-ttu-id="ccc6d-114">TAPI 3. x espone [interfacce specifiche del provider](./provider-specific-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="ccc6d-114">TAPI 3.x exposes [provider-specific Interfaces](./provider-specific-interfaces.md).</span></span>

<span data-ttu-id="ccc6d-115">Il diagramma seguente illustra il flusso di controlli e informazioni, mostrando un TSP autonomo (Unimodem) e una coppia TSP/MSP (H. 323).</span><span class="sxs-lookup"><span data-stu-id="ccc6d-115">The following diagram illustrates the flow of controls and information, showing one stand-alone TSP (Unimodem) and one TSP/MSP pair (H.323).</span></span>

![un TSP autonomo e un flusso di controllo e di informazioni di un TSP/msp associato](images/tsp-msp1.png)

<span data-ttu-id="ccc6d-117">Il diagramma seguente illustra lo stato di avanzamento di una chiamata in ingresso che prevede sia un TSP che un MSP.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-117">The following diagram illustrates the progress of an incoming call that involves both a TSP and an MSP.</span></span>

![chiamata in ingresso con un TSP e un MSP](images/tspmspin.png)

## <a name="incoming-call-setup"></a><span data-ttu-id="ccc6d-119">Impostazione delle chiamate in ingresso</span><span class="sxs-lookup"><span data-stu-id="ccc6d-119">Incoming Call Setup</span></span>

-   <span data-ttu-id="ccc6d-120">Il TSP Invia un messaggio di [**riga \_ NEWCALL**](line-newcall.md) a tapisrv.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-120">The TSP sends a [**LINE\_NEWCALL**](line-newcall.md) message to TAPISRV.</span></span> <span data-ttu-id="ccc6d-121">Lo [**stato della chiamata**](./linecallstate--constants.md) è LINECALLSTATE \_ offering.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-121">The [**call state**](./linecallstate--constants.md) is LINECALLSTATE\_OFFERING.</span></span>
-   <span data-ttu-id="ccc6d-122">TAPISRV notifica ai client la chiamata.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-122">TAPISRV notifies clients of the call.</span></span>
-   <span data-ttu-id="ccc6d-123">TAPI3 crea l'oggetto chiamata TAPI, quindi chiama [**ITMSPAddress:: CreateMSPCall**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-createmspcall), che viene implementato da msp.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-123">TAPI3 creates the TAPI Call object, then calls [**ITMSPAddress::CreateMSPCall**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-createmspcall), which is implemented by the MSP.</span></span>
-   <span data-ttu-id="ccc6d-124">MSP crea un oggetto chiamata MSP e flussi predefiniti in base ai [**tipi di supporto**](./tapimediatype--constants.md) richiesti per la chiamata.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-124">The MSP creates an MSP Call object and default streams based on the [**media types**](./tapimediatype--constants.md) required for the call.</span></span> <span data-ttu-id="ccc6d-125">Restituisce un puntatore IUnknown all'oggetto chiamata MSP.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-125">It returns an IUnknown pointer to the MSP call object.</span></span>
-   <span data-ttu-id="ccc6d-126">TAPI3 aggrega l'oggetto chiamata MSP nell'oggetto chiamata TAPI, rendendo disponibili le interfacce come [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-126">TAPI3 aggregates the MSP Call object into the TAPI Call object, making interfaces such as [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) available to the application.</span></span> <span data-ttu-id="ccc6d-127">Viene quindi inviata una notifica all'applicazione della nuova chiamata.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-127">It then notifies the application of the new call.</span></span>

<span data-ttu-id="ccc6d-128">L'applicazione può quindi usare metodi come [**ITStream:: SelectTerminal**](/windows/win32/api/tapi3if/nf-tapi3if-itstream-selectterminal) per completare i preparativi per il completamento della chiamata.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-128">The application may then use methods such as [**ITStream::SelectTerminal**](/windows/win32/api/tapi3if/nf-tapi3if-itstream-selectterminal) to complete preparations for call completion.</span></span>

## <a name="incoming-call-completion"></a><span data-ttu-id="ccc6d-129">Completamento delle chiamate in ingresso</span><span class="sxs-lookup"><span data-stu-id="ccc6d-129">Incoming Call Completion</span></span>

-   <span data-ttu-id="ccc6d-130">L'applicazione chiama [**ITBasicCallControl:: Answer**](/windows/win32/api/tapi3if/nf-tapi3if-itbasiccallcontrol-answer).</span><span class="sxs-lookup"><span data-stu-id="ccc6d-130">The application calls [**ITBasicCallControl::Answer**](/windows/win32/api/tapi3if/nf-tapi3if-itbasiccallcontrol-answer).</span></span>
-   <span data-ttu-id="ccc6d-131">TAPI3 chiama [**lineAnswer**](/windows/win32/api/tapi/nf-tapi-lineanswer).</span><span class="sxs-lookup"><span data-stu-id="ccc6d-131">TAPI3 calls [**lineAnswer**](/windows/win32/api/tapi/nf-tapi-lineanswer).</span></span>
-   <span data-ttu-id="ccc6d-132">TAPISERV chiama [**TSPI \_ lineAnswer**](/windows/win32/api/tspi/nf-tspi-tspi_lineanswer).</span><span class="sxs-lookup"><span data-stu-id="ccc6d-132">TAPISERV calls [**TSPI\_lineAnswer**](/windows/win32/api/tspi/nf-tspi-tspi_lineanswer).</span></span>
-   <span data-ttu-id="ccc6d-133">Il TSP avvia lo streaming delle chiamate.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-133">The TSP initiates call streaming.</span></span> <span data-ttu-id="ccc6d-134">In genere, il TSP Invia un messaggio al MSP corrispondente e il MSP avvia i flussi.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-134">Usually, the TSP sends a message to the corresponding MSP, and the MSP starts the streams.</span></span> <span data-ttu-id="ccc6d-135">In alcune implementazioni di TSP/MSP, il TSP avvia i flussi.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-135">In some TSP/MSP implementations, the TSP starts the streams.</span></span>

## <a name="tspmsp-communication-during-call-progress"></a><span data-ttu-id="ccc6d-136">Comunicazione TSP/MSP durante lo stato della chiamata</span><span class="sxs-lookup"><span data-stu-id="ccc6d-136">TSP/MSP Communication During Call Progress</span></span>

<span data-ttu-id="ccc6d-137">Dopo che è in corso la chiamata, il TSP e il MSP comunicano passando buffer opachi attraverso TAPISRV e TAPI3.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-137">After the call is in progress, the TSP and the MSP communicate by passing opaque buffers through TAPISRV and TAPI3.</span></span>

-   <span data-ttu-id="ccc6d-138">Il TSP Invia le informazioni al MSP inviando il messaggio di [**riga \_ SENDMSPDATA**](line-sendmspdata.md) a tapisrv.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-138">The TSP sends information to the MSP by sending the [**LINE\_SENDMSPDATA**](line-sendmspdata.md) message to TAPISRV.</span></span>
-   <span data-ttu-id="ccc6d-139">Il MSP riceve informazioni da TSP tramite il metodo [**ITMSPAddress:: ReceiveTSPData**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-receivetspdata) .</span><span class="sxs-lookup"><span data-stu-id="ccc6d-139">The MSP receives information from the TSP through the [**ITMSPAddress::ReceiveTSPData**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-receivetspdata) method.</span></span> <span data-ttu-id="ccc6d-140">Se i dati sono correlati a un oggetto chiamata MSP, un puntatore di interfaccia all'oggetto chiamata MSP viene fornito come parametro di tale metodo.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-140">If the data is related to a MSP call object, an interface pointer to the MSP call object is provided as a parameter of that method.</span></span>
-   <span data-ttu-id="ccc6d-141">Il MSP invia informazioni al TSP inviando \_ a TAPI 3 un evento di dati del tsp di msp \_ .</span><span class="sxs-lookup"><span data-stu-id="ccc6d-141">The MSP sends information to the TSP by sending a MSP\_TSP\_DATA event to TAPI 3.</span></span>
-   <span data-ttu-id="ccc6d-142">Il TSP riceve informazioni da MSP tramite la funzione [**TSPI \_ lineReceiveMSPData**](/windows/win32/api/tspi/nf-tspi-tspi_linereceivemspdata) .</span><span class="sxs-lookup"><span data-stu-id="ccc6d-142">The TSP receives information from the MSP through the [**TSPI\_lineReceiveMSPData**](/windows/win32/api/tspi/nf-tspi-tspi_linereceivemspdata) function.</span></span>

<span data-ttu-id="ccc6d-143">Il processo esatto e il contenuto della comunicazione tra i provider di servizi sono specifici di un determinato set di TSP/MSP.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-143">The exact process and content of communication between service providers is specific to a given TSP/MSP set.</span></span>

> [!Note]  
> <span data-ttu-id="ccc6d-144">Per le chiamate in uscita, il MSP è in genere in grado di riconoscere la chiamata prima del TSP.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-144">For outgoing calls, the MSP typically knows about the call before the TSP.</span></span> <span data-ttu-id="ccc6d-145">Se il MSP tenta di comunicare con il TSP prima che il TSP venga informato su una chiamata, la comunicazione avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-145">If the MSP tries to communicate with the TSP before the TSP is informed about a call, the communication will fail.</span></span> <span data-ttu-id="ccc6d-146">Quando il MSP e il TSP devono scambiare informazioni relative a una chiamata specifica, il TSP deve avviare la comunicazione.</span><span class="sxs-lookup"><span data-stu-id="ccc6d-146">When the MSP and the TSP need to exchange information concerning a specific call, the TSP should initiate communication.</span></span>

 

 

 
