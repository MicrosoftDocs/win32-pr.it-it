---
description: Quando un'applicazione chiama la funzione lineClose con una o più operazioni asincrone in attesa, TAPI può indirizzare il provider di servizi per terminare le operazioni asincrone associate a una chiamata.
ms.assetid: b26ce074-76dc-4a50-8c17-d3412c336d59
title: Chiusura di operazioni asincrone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f8ed2acb0f442e5f4f07427f0e224d7a288087d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106319848"
---
# <a name="termination-of-asynchronous-operations"></a><span data-ttu-id="b2023-103">Chiusura di operazioni asincrone</span><span class="sxs-lookup"><span data-stu-id="b2023-103">Termination of Asynchronous Operations</span></span>

<span data-ttu-id="b2023-104">Quando un'applicazione chiama la funzione [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) con una o più operazioni asincrone in attesa, TAPI può indirizzare il provider di servizi per terminare le operazioni asincrone associate a una chiamata, a seconda che l'applicazione sia l'unico proprietario della chiamata e disponga dell'unico handle della chiamata.</span><span class="sxs-lookup"><span data-stu-id="b2023-104">When an application calls the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function with one or more outstanding asynchronous operations, TAPI may direct the service provider to terminate asynchronous operations associated with a call, depending on whether the application is the sole owner of the call and has the only handle to the call.</span></span>

<span data-ttu-id="b2023-105">Se l'applicazione è l'unico proprietario di una chiamata, TAPI chiama [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (a seconda del provider) per ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="b2023-105">If the application is the sole owner of a call, TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (depending on the provider) for each such call.</span></span> <span data-ttu-id="b2023-106">Il provider di servizi deve verificare la presenza di eventuali operazioni asincrone in sospeso associate alla chiamata eliminata.</span><span class="sxs-lookup"><span data-stu-id="b2023-106">The service provider should check for any pending asynchronous operations associated with the call being dropped.</span></span> <span data-ttu-id="b2023-107">Se esiste un'operazione in sospeso, il provider di servizi deve intraprendere l'azione appropriata, eventualmente terminando l'operazione in corso.</span><span class="sxs-lookup"><span data-stu-id="b2023-107">If a pending operation exists, the service provider should take the appropriate action, possibly terminating the operation in progress.</span></span>

<span data-ttu-id="b2023-108">Se l'applicazione ha l'unico handle per una chiamata, ovvero non sono presenti altri proprietari o monitoraggi, TAPI chiama la funzione [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="b2023-108">If the application has the only handle to a call (that is, there are no other owners or monitors), TAPI calls the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="b2023-109">Il provider di servizi deve considerare questa chiamata come indicazione assoluta che è necessario abbandonare le operazioni asincrone in sospeso.</span><span class="sxs-lookup"><span data-stu-id="b2023-109">The service provider must consider this call to be the absolute indication that pending asynchronous operations must be abandoned.</span></span> <span data-ttu-id="b2023-110">Il provider di servizi deve garantire un completamento ordinato della chiamata e deve chiamare la funzione di callback di [**\_ completamento asincrono**](/windows/win32/api/tspi/nc-tspi-async_completion) per tutte le operazioni asincrone in attesa, specificando il \_ valore di errore OPERATIONFAILED di LINEERR.</span><span class="sxs-lookup"><span data-stu-id="b2023-110">The service provider must ensure an orderly completion of the call, and must call the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback function for all outstanding asynchronous operations, specifying the LINEERR\_OPERATIONFAILED error value.</span></span> <span data-ttu-id="b2023-111">Se TAPI ha precedentemente chiamato la funzione [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) , chiama **TSPI \_ lineCloseCall** immediatamente dopo che il provider di servizi ha restituito l'altra chiamata. non attende il completamento dell'operazione asincrona associata alla funzione TSPI **\_ lineDrop** .</span><span class="sxs-lookup"><span data-stu-id="b2023-111">If TAPI previously called the [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) function, it calls **TSPI\_lineCloseCall** immediately after the service provider returns from the other call; it does not wait for the asynchronous operation associated with the **TSPI\_lineDrop** function to complete.</span></span>

<span data-ttu-id="b2023-112">Se l'applicazione non è l'unico proprietario della chiamata, TAPI non chiama [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span><span class="sxs-lookup"><span data-stu-id="b2023-112">If the application is not the sole owner of the call, TAPI does not call [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span></span> <span data-ttu-id="b2023-113">Se l'applicazione non ha l'unico handle per la chiamata, TAPI non chiama la funzione [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="b2023-113">If the application does not have the only handle to the call, TAPI does not call the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="b2023-114">Se l'applicazione non è né l'unico proprietario né l'unico proprietario di un handle per la chiamata, TAPI non invia alcuna notifica al provider di servizi e pertanto tutte le operazioni asincrone in sospeso rimangono intatte.</span><span class="sxs-lookup"><span data-stu-id="b2023-114">If the application is neither the sole owner nor the sole possessor of a handle to the call, TAPI sends no notification to the service provider, and therefore, any pending asynchronous operations remain intact.</span></span> <span data-ttu-id="b2023-115">Ciò significa che tali applicazioni non possono terminare le operazioni asincrone avviate tramite la funzione [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) .</span><span class="sxs-lookup"><span data-stu-id="b2023-115">This means that such applications cannot terminate asynchronous operations that they have started by using the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function.</span></span> <span data-ttu-id="b2023-116">Tuttavia, poiché ogni operazione asincrona richiede che l'applicazione chiamante sia un proprietario della chiamata, la probabilità che un'applicazione non sia in grado di terminare le operazioni asincrone è molto rara.</span><span class="sxs-lookup"><span data-stu-id="b2023-116">However, because every asynchronous operation requires the invoking application to be an owner of the call, the likelihood of an application not being able to terminate asynchronous operations is very rare.</span></span> <span data-ttu-id="b2023-117">In caso contrario, gli altri proprietari delle chiamate devono assumersi la responsabilità della disposizione delle chiamate (s).</span><span class="sxs-lookup"><span data-stu-id="b2023-117">If it does occur, the other owner(s) of the call(s) must take responsibility for the disposition of the call(s).</span></span>

<span data-ttu-id="b2023-118">Se TAPI chiama [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), il provider di servizi deve inviare un \_ messaggio inattivo LINECALLSTATE per la chiamata associata (a meno che [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) non venga chiamato per primo) in modo che i monitoraggi della chiamata possano effettuare la pulizia.</span><span class="sxs-lookup"><span data-stu-id="b2023-118">If TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), the service provider must eventually send a LINECALLSTATE\_IDLE message for the associated call (unless [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) is called first) so that monitors on the call can clean up.</span></span> <span data-ttu-id="b2023-119">Quando l'ultimo monitoraggio ha chiamato la funzione [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) , TAPI chiama la funzione **TSPI \_ lineCloseCall** ; tutte le operazioni in sospeso devono essere completate o terminate e il [**\_ completamento asincrono**](/windows/win32/api/tspi/nc-tspi-async_completion) è stato chiamato, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="b2023-119">When the last monitor has called the [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) function, TAPI calls the **TSPI\_lineCloseCall** function; any pending operations must be completed or terminated and [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) called, as described earlier.</span></span>

 

 
