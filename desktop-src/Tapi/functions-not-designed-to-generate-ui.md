---
description: Si supponga che il provider di servizi debba visualizzare una finestra di dialogo (come la finestra di dialogo UniModel o ATSP Talk/hangup) durante l'elaborazione di lineMakeCall o lineDial.
ms.assetid: 46f87947-bfcd-48ad-8c33-7ea4d9caa34c
title: Funzioni non progettate per generare l'interfaccia utente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70bd7ed1395136d1a2d2a31b060127395e8804ac
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104529065"
---
# <a name="functions-not-designed-to-generate-ui"></a><span data-ttu-id="6786c-103">Funzioni non progettate per generare l'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="6786c-103">Functions Not Designed to Generate UI</span></span>

<span data-ttu-id="6786c-104">Si supponga che il provider di servizi debba visualizzare una finestra di dialogo (come la finestra di dialogo UniModel o ATSP **Talk/hangup** ) durante l'elaborazione di [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) o [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial).</span><span class="sxs-lookup"><span data-stu-id="6786c-104">Assume that the service provider must display a dialog box (like the Unimodem or ATSP **Talk/Hangup** dialog box) during the processing of [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) or [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial).</span></span> <span data-ttu-id="6786c-105">In questo caso, è il provider di servizi, non l'applicazione, che decide che l'interfaccia utente deve essere visualizzata.</span><span class="sxs-lookup"><span data-stu-id="6786c-105">In this case, it is the service provider, not the application, that decides that UI must be displayed.</span></span>

<span data-ttu-id="6786c-106">Per richiamare la DLL dell'interfaccia utente nel processo dell'applicazione, il provider di servizi chiama il callback dell' [*\_ evento della riga*](/windows/win32/api/tspi/nc-tspi-lineevent) TSPI, generando un messaggio di [**\_ CREATEDIALOGINSTANCE di riga**](line-createdialoginstance.md) , passando un puntatore a una struttura di tipo [**TUISPICREATEDIALOGINSTANCEPARAMS**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams).</span><span class="sxs-lookup"><span data-stu-id="6786c-106">To invoke the UI DLL in the application process, the service provider calls the TSPI [*Line\_Event*](/windows/win32/api/tspi/nc-tspi-lineevent) callback, generating a [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message, passing in a pointer to a structure of type [**TUISPICREATEDIALOGINSTANCEPARAMS**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams).</span></span> <span data-ttu-id="6786c-107">Questa struttura contiene l' **dwRequestID** della funzione a cui è associata l'interfaccia utente, consentendo a tapisrv di identificare l'applicazione client in cui deve essere generata l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="6786c-107">This structure contains the **dwRequestID** of the function with which the UI is associated, allowing TAPISRV to identify the client application in which the UI is to be generated.</span></span>

<span data-ttu-id="6786c-108">TAPISRV richiede l'istanza dell'applicazione corretta di TAPI per caricare la DLL dell'interfaccia utente e creare un thread per l'interfaccia utente all'interno del processo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6786c-108">TAPISRV requests the correct application's instance of TAPI to load the UI DLL and create a thread for the UI within the application's process.</span></span> <span data-ttu-id="6786c-109">Da questo nuovo thread dell'interfaccia utente, TAPI chiama la funzione [**TUISPI \_ PROVIDERGENERICDIALOG**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) della DLL dell'interfaccia utente, passando i dati specificati dal provider del servizio di telefonia nella struttura passata con il messaggio di [**riga \_ CREATEDIALOGINSTANCE**](line-createdialoginstance.md) . nella DLL dell'interfaccia utente viene visualizzata la finestra di dialogo appropriata, che è importante per la progettazione privata tra la DLL dell'interfaccia utente e il provider del servizio di telefonia.</span><span class="sxs-lookup"><span data-stu-id="6786c-109">From this new UI thread, TAPI calls the UI DLL's [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) function, passing in data that was specified by the telephony service provider in the structure passed in with the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message; the UI DLL displays the appropriate dialog box (which is a matter for private design between the UI DLL and the telephony service provider).</span></span> <span data-ttu-id="6786c-110">La DLL dell'interfaccia utente non restituisce da **TUISPI \_ providerGenericDialog** fino a quando la finestra di dialogo non viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="6786c-110">The UI DLL does not return from **TUISPI\_providerGenericDialog** until the dialog box is closed.</span></span>

<span data-ttu-id="6786c-111">Il provider di servizi di telefonia può generare dati aggiornati da visualizzare nella finestra di dialogo (o, ad esempio, indicare la chiusura della finestra di dialogo, se la chiamata viene abbandonata o se si verificano altri eventi) inviando un messaggio [**\_ SENDDIALOGINSTANCEDATA di riga**](line-senddialoginstancedata.md) .</span><span class="sxs-lookup"><span data-stu-id="6786c-111">The telephony service provider can generate updated data to display in the dialog box (or, for example, instruct the dialog box to be closed, if the call is abandoned or other events occur) by sending a [**LINE\_SENDDIALOGINSTANCEDATA**](line-senddialoginstancedata.md) message.</span></span> <span data-ttu-id="6786c-112">TAPISRV trasmette i dati a TAPI, che chiama la funzione [**TUISPI \_ PROVIDERGENERICDIALOGDATA**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) della DLL dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="6786c-112">TAPISRV conveys the data to TAPI, which calls the UI DLL's [**TUISPI\_providerGenericDialogData**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) function.</span></span> <span data-ttu-id="6786c-113">Questo meccanismo fornisce una "trasmissione" unidirezionale alla DLL dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="6786c-113">This mechanism provides a unidirectional "send" to the UI DLL.</span></span> <span data-ttu-id="6786c-114">Se la DLL dell'interfaccia utente desidera informare il provider di servizi di telefonia dei risultati della finestra di dialogo o ottenere altri dati, è possibile chiamare la funzione [*DllCallbackProc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) (un puntatore al quale è stato ricevuto quando è stato chiamato [**TUISPI \_ providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) ).</span><span class="sxs-lookup"><span data-stu-id="6786c-114">If the UI DLL wants to inform the telephony service provider of the results of the dialog box or obtain other data, it can call the [*DllCallbackProc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) function (a pointer to which it received when [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) was called).</span></span>

<span data-ttu-id="6786c-115">Quando la finestra di dialogo viene rilasciata, [**TUISPI \_ providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) torna a TAPI.</span><span class="sxs-lookup"><span data-stu-id="6786c-115">When the dialog box is dismissed, [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) returns to TAPI.</span></span> <span data-ttu-id="6786c-116">TAPI chiama [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) per rilasciare la DLL dell'interfaccia utente e chiude il thread dell'interfaccia utente creato nel contesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6786c-116">TAPI calls [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) to release the UI DLL, and exits the UI thread it had created in the application context.</span></span> <span data-ttu-id="6786c-117">Richiede quindi a TAPISRV di chiamare la funzione [**TSPI \_ providerFreeDialogInstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) del provider di servizi di telefonia per annullare l'associazione dell'associazione creata quando il provider del servizio di telefonia ha inviato originariamente il messaggio di [**riga \_ CREATEDIALOGINSTANCE**](line-createdialoginstance.md) .</span><span class="sxs-lookup"><span data-stu-id="6786c-117">It then requests TAPISRV to call the telephony service provider's [**TSPI\_providerFreeDialogInstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) function to unbind the association created when the telephony service provider originally sent the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message.</span></span> <span data-ttu-id="6786c-118">Questa funzione viene chiamata anche se il processo dell'applicazione termina in modo imprevisto prima della restituzione di **TUISPI \_ providerGenericDialog** .</span><span class="sxs-lookup"><span data-stu-id="6786c-118">This function is also called if the application process terminates unexpectedly before **TUISPI\_providerGenericDialog** returns.</span></span>

 

 
