---
description: Quando una chiamata è attiva in LINEBEARERMODE \_ PassThrough, il provider di servizi fornisce accesso diretto all'hardware collegato per il controllo da parte dell'applicazione.
ms.assetid: 75e31241-c782-4d50-9590-cf68c0505add
title: Modalità passthrough
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 985e1caf666fcb3278bacf5c5cfe9d8a4e847dbb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308600"
---
# <a name="passthrough-mode"></a><span data-ttu-id="c7bee-103">Modalità passthrough</span><span class="sxs-lookup"><span data-stu-id="c7bee-103">Passthrough Mode</span></span>

<span data-ttu-id="c7bee-104">Quando una chiamata è attiva in **LINEBEARERMODE \_ PassThrough**, il provider di servizi fornisce accesso diretto all'hardware collegato per il controllo da parte dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7bee-104">When a call is active in **LINEBEARERMODE\_PASSTHROUGH**, the service provider gives direct access to the attached hardware for control by the application.</span></span> <span data-ttu-id="c7bee-105">Le applicazioni possono utilizzare questa modalità per un controllo diretto temporaneo sui modem asincroni, a cui si accede tramite le [funzioni di comunicazione](/windows/desktop/DevIO/communications-functions), allo scopo di configurare o utilizzare funzionalità speciali non altrimenti supportate dal provider di servizi, ad esempio facsimile (classe 1, 2 e così via).</span><span class="sxs-lookup"><span data-stu-id="c7bee-105">Applications can use this mode for temporary direct control over asynchronous modems, accessed through the [communications functions](/windows/desktop/DevIO/communications-functions), for the purpose of configuring or using special features not otherwise supported by the service provider, such as facsimile (Class 1, 2, and so on).</span></span> <span data-ttu-id="c7bee-106">Questa modalità di connessione è supportata dal provider di servizi Universal Modem driver (Unimodem).</span><span class="sxs-lookup"><span data-stu-id="c7bee-106">This bearer mode is supported by the Universal Modem Driver (UNIMODEM) service provider.</span></span>

<span data-ttu-id="c7bee-107">I provider di servizi che supportano **LINEBEARERMODE \_ PassThrough** lo indicano nel membro **dwBearerModes** della struttura [**LINEDEVCAPS**](/windows/desktop/api/Tapi/ns-tapi-linedevcaps) .</span><span class="sxs-lookup"><span data-stu-id="c7bee-107">Service providers that support **LINEBEARERMODE\_PASSTHROUGH** indicate it in the **dwBearerModes** member of the [**LINEDEVCAPS**](/windows/desktop/api/Tapi/ns-tapi-linedevcaps) structure.</span></span> <span data-ttu-id="c7bee-108">Quando è indicato il **\_ pass-through LINEBEARERMODE** , il provider di servizi Unimodem includerà anche nell'area **devSpecific** della struttura **LINEDEVCAPS** la chiave del registro di sistema usata per accedere ai dati sul modem associato al dispositivo a linee, nel formato seguente:</span><span class="sxs-lookup"><span data-stu-id="c7bee-108">When **LINEBEARERMODE\_PASSTHROUGH** is indicated, the Unimodem service provider will also include in the **DevSpecific** area of the **LINEDEVCAPS** structure the registry key used to access data about the modem associated with the line device, in the following format:</span></span>

``` syntax
struct {
    DWORD dwContents;   // Set to 1 (indicates containing key).
    DWORD dwKeyOffset;  // Offset to key from start of this
                        // structure (not from start of
                        // LINEDEVCAPS structure).
                        // 8 in this case. 
    BYTE rgby[...];     // Place that contains null-terminated
                        // registry key. 
}
```

<span data-ttu-id="c7bee-109">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c7bee-109">For example:</span></span>

``` syntax
    00000001 00000008 74737953 435c6d65  ........System\C
    65727275 6f43746e 6f72746e 7465536c  urrentControlSet
    7265535c 65636976 6c435c73 5c737361  urrentControlSet
    65646f4d 30305c6d xx003030 xxxxxxxx  Modem\0000.
```

<span data-ttu-id="c7bee-110">Questa chiave del registro di sistema può quindi essere aperta usando la funzione [**RegOpenKey**](/windows/desktop/api/winreg/nf-winreg-regopenkeya) .</span><span class="sxs-lookup"><span data-stu-id="c7bee-110">This registry key could then be opened using the [**RegOpenKey**](/windows/desktop/api/winreg/nf-winreg-regopenkeya) function.</span></span>

<span data-ttu-id="c7bee-111">La modalità passthrough viene richiamata più spesso tramite la funzione [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) , impostando il bit **\_ PassThrough LINEBEARERMODE** nel membro **dwBearerMode** della struttura [**LINECALLPARAMS**](/windows/desktop/api/Tapi/ns-tapi-linecallparams) a cui punta il parametro *lpCallParams* .</span><span class="sxs-lookup"><span data-stu-id="c7bee-111">Passthrough mode is invoked most often using the [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) function, by setting the **LINEBEARERMODE\_PASSTHROUGH** bit in the **dwBearerMode** member of the [**LINECALLPARAMS**](/windows/desktop/api/Tapi/ns-tapi-linecallparams) structure pointed to by the *lpCallParams* parameter.</span></span> <span data-ttu-id="c7bee-112">Al termine di questa operazione, il provider di servizi apre la porta seriale al modem e inserisce immediatamente la chiamata in **LINECALLSTATE \_ connessa**.</span><span class="sxs-lookup"><span data-stu-id="c7bee-112">When this is done, the service provider opens the serial port to the modem and immediately place the call into **LINECALLSTATE\_CONNECTED**.</span></span> <span data-ttu-id="c7bee-113">L'applicazione può quindi usare la funzione [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid) con la classe Device "comm/DataModel" per ottenere un handle di file aperto per la lettura e la scrittura nella porta di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="c7bee-113">The application can then use the [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid) function with the device class "comm/datamodem" to obtain an open file handle to read from and write to the comm port.</span></span>

<span data-ttu-id="c7bee-114">La modalità passthrough può essere richiamata anche in risposta a una chiamata in ingresso.</span><span class="sxs-lookup"><span data-stu-id="c7bee-114">Passthrough mode can be invoked in response to an incoming call as well.</span></span> <span data-ttu-id="c7bee-115">In genere, le applicazioni richiamano la modalità passthrough mentre la chiamata si trova nell' **\_ offerta LINECALLSTATE**, prima della risposta alla chiamata.</span><span class="sxs-lookup"><span data-stu-id="c7bee-115">Generally, applications will invoke passthrough mode while the call is in **LINECALLSTATE\_OFFERING**, before the call has been answered.</span></span> <span data-ttu-id="c7bee-116">Anziché chiamare [**lineAnswer**](/windows/desktop/api/Tapi/nf-tapi-lineanswer), l'applicazione chiama [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams)passando il **pass- \_ through LINEBEARERMODE** come parametro *dwBearerMode* .</span><span class="sxs-lookup"><span data-stu-id="c7bee-116">Instead of calling [**lineAnswer**](/windows/desktop/api/Tapi/nf-tapi-lineanswer), the application calls [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams), passing **LINEBEARERMODE\_PASSTHROUGH** as the *dwBearerMode* parameter.</span></span> <span data-ttu-id="c7bee-117">Al termine di questa operazione, come per [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall), la chiamata viene immediatamente posizionata in **LINECALLSTATE \_ connessa** dal provider di servizi e l'applicazione può ottenere un handle per la porta aperta usando [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span><span class="sxs-lookup"><span data-stu-id="c7bee-117">When this is done, as with [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall), the call is immediately placed into **LINECALLSTATE\_CONNECTED** by the service provider, and the application can obtain a handle to the open port using [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span></span> <span data-ttu-id="c7bee-118">La funzione **lineSetCallParams** può essere chiamata quando la chiamata si trova in **LINECALLSTATE \_ offering**, **LINECALLSTATE \_ accepted** o **LINECALLSTATE \_ Connected**.</span><span class="sxs-lookup"><span data-stu-id="c7bee-118">The **lineSetCallParams** function can be called when the call is in **LINECALLSTATE\_OFFERING**, **LINECALLSTATE\_ACCEPTED**, or **LINECALLSTATE\_CONNECTED**.</span></span>

<span data-ttu-id="c7bee-119">La modalità passthrough viene normalmente terminata chiamando [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) sull'handle di chiamata ottenuto da [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) o il primo messaggio [**\_ CALLSTATE di riga**](line-callstate.md) , se la chiamata è una chiamata in ingresso.</span><span class="sxs-lookup"><span data-stu-id="c7bee-119">Passthrough mode is normally terminated by calling [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) on the call handle obtained from [**lineMakeCall**](/windows/desktop/api/Tapi/nf-tapi-linemakecall) or the first [**LINE\_CALLSTATE**](line-callstate.md) message, if the call was an incoming call.</span></span> <span data-ttu-id="c7bee-120">Il provider di servizi chiuderà la porta e ripristinerà lo stato predefinito del modem.</span><span class="sxs-lookup"><span data-stu-id="c7bee-120">The service provider will close the port, and restore the modem to its default state.</span></span> <span data-ttu-id="c7bee-121">L'applicazione deve chiamare [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) sull'handle ricevuto da [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span><span class="sxs-lookup"><span data-stu-id="c7bee-121">The application must call [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) on the handle it received from [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid).</span></span>

<span data-ttu-id="c7bee-122">La modalità passthrough può anche essere terminata chiamando [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams) con il parametro *DwBearerMode* impostato su **LINEBEARERMODE \_ Voice**.</span><span class="sxs-lookup"><span data-stu-id="c7bee-122">Passthrough mode can also be terminated by calling [**lineSetCallParams**](/windows/desktop/api/Tapi/nf-tapi-linesetcallparams) with the *dwBearerMode* parameter set to **LINEBEARERMODE\_VOICE**.</span></span> <span data-ttu-id="c7bee-123">È probabile che il tipo di supporto (Mode) impostato da [**lineSetMediaMode**](/windows/desktop/api/Tapi/nf-tapi-linesetmediamode) sia attivo.</span><span class="sxs-lookup"><span data-stu-id="c7bee-123">The media type (mode) set by [**lineSetMediaMode**](/windows/desktop/api/Tapi/nf-tapi-linesetmediamode) is presumed to be in effect.</span></span> <span data-ttu-id="c7bee-124">Se **LINEMEDIAMODE \_ DataModel** è attivo, il provider di servizi assume la funzione di chiamata come se si trattasse di una chiamata al modem dati già in corso; se [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) viene chiamato successivamente, il provider di servizi emetterà i comandi del modem appropriati o le modifiche dello stato dell'interfaccia per eliminare una chiamata dati.</span><span class="sxs-lookup"><span data-stu-id="c7bee-124">If **LINEMEDIAMODE\_DATAMODEM** is active, the service provider will take over the call as though it was a data modem call already in progress; if [**lineDrop**](/windows/desktop/api/Tapi/nf-tapi-linedrop) is subsequently called, the service provider will issue the appropriate modem commands or interface state changes to drop a data call.</span></span>

> [!Note]  
> <span data-ttu-id="c7bee-125">Se la modalità passthrough viene terminata mentre è in corso la chiamata, il provider di servizi TAPI (TSP) per la riga potrebbe ripristinare lo stato predefinito delle impostazioni del modem.</span><span class="sxs-lookup"><span data-stu-id="c7bee-125">If Passthrough mode is terminated while the call is in progress, the TAPI service provider (TSP) for the line may restore the modem settings to their default state.</span></span> <span data-ttu-id="c7bee-126">UniModel è un esempio di un TSP che ripristina sempre le impostazioni del modem quando termina la modalità passthrough.</span><span class="sxs-lookup"><span data-stu-id="c7bee-126">Unimodem is an example of a TSP that always restores the modem settings when terminating passthrough mode.</span></span> <span data-ttu-id="c7bee-127">Per questo motivo, non è possibile usare la modalità passthrough come metodo per configurare il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c7bee-127">For this reason, Passthrough mode cannot be used as a method to configure the device.</span></span> <span data-ttu-id="c7bee-128">La modalità passthrough deve essere utilizzata solo per le attività distinte che possono essere considerate complete quando il passthrough viene terminato.</span><span class="sxs-lookup"><span data-stu-id="c7bee-128">Passthrough mode should only be used for distinct activities that can be considered complete when Passthrough is terminated.</span></span> <span data-ttu-id="c7bee-129">Esempi di attività che possono usare la modalità passthrough includono l'invio di un fax o la riproduzione di dati Wave/audio tramite un protocollo modem proprietario.</span><span class="sxs-lookup"><span data-stu-id="c7bee-129">Examples of activities that can use passthrough mode include sending a fax or playing wave/audio data through a proprietary modem protocol.</span></span>

 

 

 
