---
description: Quando un'applicazione dispone del privilegio proprietario per una sessione di comunicazione, l'applicazione può scegliere di passare la proprietà a un'altra applicazione.
ms.assetid: d6d188c9-9cbd-45af-93f0-b78850374919
title: Handoff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 343815e35f1fc331c57c4aa2d9d311697cab7022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308613"
---
# <a name="handoffs"></a><span data-ttu-id="46511-103">Handoff</span><span class="sxs-lookup"><span data-stu-id="46511-103">Handoffs</span></span>

<span data-ttu-id="46511-104">Quando un'applicazione dispone del [privilegio](privilege-ovr.md) proprietario per una sessione di comunicazione, l'applicazione può scegliere di passare la proprietà a un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="46511-104">When an application has owner [privilege](privilege-ovr.md) for a communications session, the application may choose to hand off ownership to another application.</span></span> <span data-ttu-id="46511-105">L'operazione di consegna viene in genere utilizzata per consentire la modifica del tipo di supporto della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-105">The handoff operation is normally used to allow the call's media type to be changed.</span></span> <span data-ttu-id="46511-106">L'applicazione con priorità più elevata per il nuovo tipo di supporto deve eseguire e gestire la chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-106">The highest-priority application for the new media type should take and handle the call.</span></span> <span data-ttu-id="46511-107">La modifica del tipo di supporto in genere viene eseguita per uno dei motivi seguenti.</span><span class="sxs-lookup"><span data-stu-id="46511-107">Media type changing usually occurs for one of the following reasons.</span></span>

<span data-ttu-id="46511-108">**Comando utente:** Tramite un'interfaccia utente o i messaggi della finestra, l'applicazione apprende che l'utente locale desidera modificare il tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-108">**User command:** Through a user interface or through window messages, the application learns that the local user wants to change media type.</span></span> <span data-ttu-id="46511-109">Ad esempio, l'utente ha comunicato alla nuova applicazione di destinazione, che non è ancora un proprietario, di ottenere una chiamata vocale esistente per la trasmissione dei dati.</span><span class="sxs-lookup"><span data-stu-id="46511-109">For example, the user has told the new target application (which is not yet an owner) to obtain an existing voice call for transmitting data.</span></span> <span data-ttu-id="46511-110">L'applicazione di destinazione deve ora assumere il controllo della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-110">The target application must now take control of the call.</span></span> <span data-ttu-id="46511-111">In questo caso, il proprietario corrente rileva il numero di proprietari che aumentano e quindi cede il controllo della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-111">In this case, the current owner notices the number of owners increase, and then relinquishes its control of the call.</span></span> <span data-ttu-id="46511-112">In alternativa, l'utente può indicare al proprietario corrente della chiamata di passarlo a un'applicazione in grado di gestire il nuovo tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-112">Alternatively, the user could instruct the current owner of the call to hand it off to an application that can handle the new media type.</span></span>

<span data-ttu-id="46511-113">**Modifica del tipo di supporto:** Il provider di servizi può rilevare una modifica del tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-113">**Media type change:** The service provider can detect a media type change.</span></span> <span data-ttu-id="46511-114">Ad esempio, l'applicazione locale sta riproducendo un messaggio vocale registrato al chiamante.</span><span class="sxs-lookup"><span data-stu-id="46511-114">For example, the local application is playing a recorded voice message to the caller.</span></span> <span data-ttu-id="46511-115">Durante questo messaggio, il chiamante decide spontaneamente di trasmettere un tono di chiamata fax e l'applicazione locale può rispondere di conseguenza modificando il tipo di supporto in fax e, se necessario, passando la chiamata a un'applicazione fax.</span><span class="sxs-lookup"><span data-stu-id="46511-115">During this message, the caller spontaneously decides to transmit a fax calling tone, and the local application can respond accordingly by changing the media type to fax and, if necessary, handing the call off to a fax application.</span></span> <span data-ttu-id="46511-116">Un altro modo per eseguire questa operazione è che un'applicazione di monitoraggio possa abilitare il monitoraggio del tipo di supporto e, quando il tipo di supporto di cui è interessato viene rilevato in una chiamata, può richiedere la proprietà della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-116">Another way this can work is for a monitoring application to enable media type monitoring, and, when the media type in which it is interested is detected on a call, it can request ownership of the call.</span></span> <span data-ttu-id="46511-117">Questo meccanismo rende superfluo per ogni applicazione monitorare ogni chiamata per ogni tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-117">This mechanism makes it unnecessary for every application to monitor every call for every media type.</span></span>

<span data-ttu-id="46511-118">**Comando entità remota:** La parte remota può indicare in modo interattivo una modifica nei tipi di supporto durante una chiamata esistente, ad esempio se l'applicazione locale monitora l'input DTMF da parte del chiamante remoto.</span><span class="sxs-lookup"><span data-stu-id="46511-118">**Remote party command:** The remote party can interactively indicate a change in media types during an existing call, such as if the local application is monitoring DTMF input by the remote caller.</span></span> <span data-ttu-id="46511-119">Tramite questo monitoraggio, il chiamante indica, ad esempio, che è in corso l'invio di un fax.</span><span class="sxs-lookup"><span data-stu-id="46511-119">Through this monitoring, the caller indicates, for example, that a fax is about to be sent.</span></span> <span data-ttu-id="46511-120">Gli altri modi in cui il chiamante può controllare le applicazioni locali sono i comandi ricevuti su altre connessioni dati e i messaggi informativi dell'utente ISDN.</span><span class="sxs-lookup"><span data-stu-id="46511-120">Other ways the caller can control local applications are with commands received on other data connections and through ISDN user-user information messages.</span></span>

<span data-ttu-id="46511-121">Una chiamata di consegna avrà uno dei seguenti risultati:</span><span class="sxs-lookup"><span data-stu-id="46511-121">A call handoff will have one of these outcomes:</span></span>

-   <span data-ttu-id="46511-122">La chiamata viene assegnata a un'altra applicazione (ESITo positivo).</span><span class="sxs-lookup"><span data-stu-id="46511-122">The call is given to another application (SUCCESS).</span></span>
-   <span data-ttu-id="46511-123">L'applicazione di gestione è la destinazione (TARGETSELF).</span><span class="sxs-lookup"><span data-stu-id="46511-123">The handing-off application is itself the target (TARGETSELF).</span></span>
-   <span data-ttu-id="46511-124">La consegna ha esito negativo (TARGETNOTFOUND).</span><span class="sxs-lookup"><span data-stu-id="46511-124">The handoff fails (TARGETNOTFOUND).</span></span>

<span data-ttu-id="46511-125">Se l'applicazione che riceve la chiamata gestita ha già un handle di chiamata alla chiamata, viene usato questo handle di chiamata precedente.</span><span class="sxs-lookup"><span data-stu-id="46511-125">If the application that is receiving the handed-off call already has a call handle to the call, this old call handle is used.</span></span> <span data-ttu-id="46511-126">In caso contrario, viene creato un nuovo handle di chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-126">Otherwise, a new call handle is created.</span></span> <span data-ttu-id="46511-127">In entrambi i casi, l'applicazione termina con privilegi di proprietario per la chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-127">In either case, the application ends up with owner privileges to the call.</span></span> <span data-ttu-id="46511-128">Ogni volta che l'applicazione di destinazione non corrisponde all'applicazione di destinazione, la destinazione viene informata sulla consegna in un messaggio di stato della sessione come se ricevesse una nuova chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-128">Whenever the handing-off application is not the same as the target application, the target is informed about the handoff in a session state message as if it were receiving a new call.</span></span>

<span data-ttu-id="46511-129">Se all'applicazione del proprietario corrente viene richiesto di modificare i tipi di supporti, viene eseguita la chiamata a un'applicazione utilizzata per il tipo di supporto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="46511-129">If the current owner application is told to change media types, it does so by handing off the call to an application used for the target media type.</span></span> <span data-ttu-id="46511-130">I due tipi di chiamata handoff sono descritti in [handoff diretto](#directed-handoffs) e [Media Type handoff](#media-type-handoffs).</span><span class="sxs-lookup"><span data-stu-id="46511-130">The two types of call handoffs are described in [Directed Handoffs](#directed-handoffs) and [Media type Handoffs](#media-type-handoffs).</span></span>

<span data-ttu-id="46511-131">Non tutti i provider di servizi supportano l'utilizzo di questa operazione.</span><span class="sxs-lookup"><span data-stu-id="46511-131">Not all service providers support use of this operation.</span></span>

<span data-ttu-id="46511-132">**TAPI 2. x:** Vedere [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), con *lpszFileName* impostato sul nome dell'applicazione per una consegna diretta o *dwMediaMode* impostato su un tipo di supporto per una consegna indiretta.</span><span class="sxs-lookup"><span data-stu-id="46511-132">**TAPI 2.x:** See [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), with *lpszFileName* set to the application name for a direct handoff or *dwMediaMode* set to one media type for an indirect handoff.</span></span>

<span data-ttu-id="46511-133">**TAPI 3. x:** Vedere [**ITBasicCallControl:: HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl:: HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span><span class="sxs-lookup"><span data-stu-id="46511-133">**TAPI 3.x:** See [**ITBasicCallControl::HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl::HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span></span>

## <a name="directed-handoffs"></a><span data-ttu-id="46511-134">Handoff diretto</span><span class="sxs-lookup"><span data-stu-id="46511-134">Directed Handoffs</span></span>

<span data-ttu-id="46511-135">Una consegna *diretta* si verifica quando l'applicazione di destinazione è nota per nome all'applicazione originale.</span><span class="sxs-lookup"><span data-stu-id="46511-135">A *directed handoff* takes place when the target application is known by name to the original application.</span></span> <span data-ttu-id="46511-136">Questa situazione si verifica, ad esempio, tra un set di applicazioni scritte dallo stesso fornitore.</span><span class="sxs-lookup"><span data-stu-id="46511-136">This situation would occur, for example, among a set of applications written by the same vendor.</span></span> <span data-ttu-id="46511-137">L'utente può in genere configurare il controllo dei handoff diretti.</span><span class="sxs-lookup"><span data-stu-id="46511-137">The user can usually configure control of directed handoffs.</span></span> <span data-ttu-id="46511-138">Con tale operazione, la chiamata viene assegnata all'applicazione specificata se ha aperto la riga in cui è presente la chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-138">With such a handoff, the call is given to the specified application if it has opened the line on which the call exists.</span></span> <span data-ttu-id="46511-139">Il tipo di supporto specificato al momento dell'apertura dell'applicazione la riga viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="46511-139">The media type specified at the time the application opened the line is ignored.</span></span> <span data-ttu-id="46511-140">Un esempio comune è una chiamata vocale seguita da una trasmissione fax nella stessa chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-140">One common example is a voice call followed by a fax transmission in the same call.</span></span> <span data-ttu-id="46511-141">La consegna diretta verrà utilizzata più spesso dalle applicazioni dello stesso sviluppatore collegate anche in altri modi.</span><span class="sxs-lookup"><span data-stu-id="46511-141">Directed handoff would most often be used by applications from the same developer that are linked in other ways as well.</span></span>

<span data-ttu-id="46511-142">La consegna diretta può essere usata anche nelle versioni future come parte del processo di arbitrali di più applicazioni in attesa di chiamate in ingresso dello stesso tipo di supporto, con la selezione dell'applicazione per gestire la chiamata in base al rilevamento del protocollo di collegamento dati o di livello superiore anziché al tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-142">Directed handoff may also be used in future versions as part of the process of arbitrating multiple applications waiting for incoming calls of the same media type, with the selection of the application to handle the call being based on data-link or higher-level protocol detection rather than media type.</span></span> <span data-ttu-id="46511-143">Un esempio di utilizzo è costituito da una linea di modem dati in ingresso con applicazioni quali l'acquisizione remota, la bacheca, l'accesso alla rete remota e l'accesso remoto alla posta elettronica in attesa di chiamate simultanee.</span><span class="sxs-lookup"><span data-stu-id="46511-143">An example of its use would be an incoming data modem line with applications such as remote takeover, bulletin board, remote network access, and remote e-mail access all waiting for calls simultaneously.</span></span>

## <a name="media-type-handoffs"></a><span data-ttu-id="46511-144">Tipo di supporto handoff</span><span class="sxs-lookup"><span data-stu-id="46511-144">Media Type Handoffs</span></span>

<span data-ttu-id="46511-145">Una consegna del *tipo di supporto* si verifica quando è presente un nuovo tipo di supporto di destinazione, in genere quando l'applicazione proprietaria stabilisce che il tipo di supporto necessario per la chiamata non è presente o sta per essere modificato.</span><span class="sxs-lookup"><span data-stu-id="46511-145">A *media type handoff* takes place when there is a new, targeted media type, usually when the owning application determines that the media type needed for the call is not present or is about to change.</span></span>

<span data-ttu-id="46511-146">Il processo di una consegna dipendente dal supporto può essere un processo di sondaggio se il tipo di supporto è sconosciuto.</span><span class="sxs-lookup"><span data-stu-id="46511-146">The process for a media-dependent handoff can be a probing process if the media type UNKNOWN bit is on.</span></span> <span data-ttu-id="46511-147">È responsabilità dell'applicazione proprietario scorrere i tipi di supporto per trovare l'applicazione con priorità più elevata.</span><span class="sxs-lookup"><span data-stu-id="46511-147">It is the responsibility of the owning application to cycle through media types to find the highest-priority application.</span></span> <span data-ttu-id="46511-148">TAPI esegue questa operazione in modo ciclico solo sulla chiamata iniziale in ingresso per trovare il primo proprietario.</span><span class="sxs-lookup"><span data-stu-id="46511-148">TAPI does this cycling only on the initial incoming call to find the first owner.</span></span> <span data-ttu-id="46511-149">Questa operazione non viene eseguita per un'operazione di continuità.</span><span class="sxs-lookup"><span data-stu-id="46511-149">It does not do this for a handoff operation.</span></span> <span data-ttu-id="46511-150">In caso contrario, la consegna è praticamente identica a quella dell'assegnazione iniziale di una chiamata a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="46511-150">Otherwise, a handoff is virtually the same as for the initial assignment of a call to an application.</span></span> <span data-ttu-id="46511-151">La differenza consiste nel fatto che è possibile impostare un solo tipo di supporto per una consegna indiretta (tipo di supporto).</span><span class="sxs-lookup"><span data-stu-id="46511-151">The difference is the fact that only one media type can be set for an indirect (media type) handoff.</span></span>

<span data-ttu-id="46511-152">Poiché è possibile specificare un solo bit di tipo di supporto, la chiamata viene assegnata all'applicazione con priorità più elevata per quel tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-152">Because only a single media type bit can be specified, the call is given to the highest priority application for that media type.</span></span> <span data-ttu-id="46511-153">Tuttavia, è possibile che più di un tipo di supporto debba essere considerato per la consegna.</span><span class="sxs-lookup"><span data-stu-id="46511-153">However, it is possible that more than one media type is to be considered for the handoff.</span></span> <span data-ttu-id="46511-154">In questo caso, l'applicazione di gestione deve specificare la priorità più alta dei tipi di supporti possibili come parametro.</span><span class="sxs-lookup"><span data-stu-id="46511-154">In this case, the handing-off application should specify the highest priority of the possible media types as a parameter.</span></span>

<span data-ttu-id="46511-155">Se un'applicazione specifica il bit sconosciuto quando si esegue una consegna del tipo di supporto e la consegna ha esito negativo, significa che un'applicazione sconosciuta in grado di eseguire la determinazione del tipo di supporto non è attualmente in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="46511-155">If an application specifies the UNKNOWN bit when performing a media-type handoff and the handoff fails, this means that an unknown application capable of performing media type determination is not currently running.</span></span> <span data-ttu-id="46511-156">L'applicazione che viene gestita deve quindi provare a consegnare la chiamata all'applicazione con la priorità più alta registrata per il tipo di supporto successivo.</span><span class="sxs-lookup"><span data-stu-id="46511-156">The application that is handing off should then try to hand the call off to the highest-priority application registered for the next-higher media type.</span></span>

<span data-ttu-id="46511-157">L'applicazione ricevente è ora responsabile della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-157">The receiving application is now responsible for the call.</span></span> <span data-ttu-id="46511-158">Ora esegue il probe per il tipo di supporto effettivo della chiamata.</span><span class="sxs-lookup"><span data-stu-id="46511-158">It now probes for the call's actual media type.</span></span> <span data-ttu-id="46511-159">Se l'applicazione è in grado di gestire il tipo di supporto della chiamata, è necessario assicurarsi che sia l'applicazione con priorità più elevata registrata per tale tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-159">If the application can handle the call's media type, it must ensure that it is the highest-priority application registered for that media type.</span></span> <span data-ttu-id="46511-160">In tal caso, mantiene la chiamata e la elabora normalmente.</span><span class="sxs-lookup"><span data-stu-id="46511-160">If so, it keeps the call and processes it normally.</span></span> <span data-ttu-id="46511-161">In caso contrario, passa la chiamata a un'altra applicazione registrata per quel tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-161">If not, it hands the call off to another application registered for that media type.</span></span>

<span data-ttu-id="46511-162">Se, tuttavia, il probe per quel tipo di supporto ha esito negativo, l'applicazione esegue nuovamente il probe, tentando di eseguire le rimanenti opzioni della modalità supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-162">If, however, the probe for that media type fails, the application probes again, attempting the remaining media-mode possibilities.</span></span> <span data-ttu-id="46511-163">Prima di tutto, è necessario disattivare il bit del tipo di supporto corrente, quindi provare a eseguire un'altra consegna con un tipo diverso.</span><span class="sxs-lookup"><span data-stu-id="46511-163">It must first turn off the current media type bit, then try another handoff with a different type.</span></span>

<span data-ttu-id="46511-164">Questo processo di probe e disattivazione continua e i restanti tipi di supporti vengono eliminati uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="46511-164">This process of probing and handing off continues, and the remaining media types are eliminated one by one.</span></span> <span data-ttu-id="46511-165">Lungo il percorso, una delle applicazioni potrebbe vedere che il tipo di supporto che gestisce si trova nella chiamata e la consegna è riuscita.</span><span class="sxs-lookup"><span data-stu-id="46511-165">Along the way, one of the applications may see that the media type it handles is on the call, and the handoff is successful.</span></span>

<span data-ttu-id="46511-166">L'applicazione deve quindi impostare il tipo di supporto corretto e deselezionare tutti gli altri bit del tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="46511-166">The application should then set the correct media type and clear all other media-type bits.</span></span> <span data-ttu-id="46511-167">Ciò informa le altre applicazioni interessate del tipo di supporto corretto.</span><span class="sxs-lookup"><span data-stu-id="46511-167">This informs other interested applications of the correct media type.</span></span> <span data-ttu-id="46511-168">Queste altre applicazioni ricevono un messaggio di notifica degli eventi che indica che il tipo di supporto della chiamata è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="46511-168">These other applications receive an event notification message stating that the call's media type has changed.</span></span>

 

 
