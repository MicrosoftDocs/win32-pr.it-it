---
title: Costanti PROPSETFLAG (Propidl.h)
description: Definire le caratteristiche di un set di proprietà.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ca7c2f3566ca55dd82bc86cfbc7aa141eec629a47258f89662eef3d347ee5408
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "117960703"
---
# <a name="propsetflag-constants"></a>Costanti PROPSETFLAG

Le costanti PROPSETFLAG definiscono le caratteristiche di un set di proprietà. I valori, elencati nella tabella seguente, vengono usati nel parametro *grfFlags* dei metodi [**IPropertySetStorage,**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) nella funzione [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) e nella funzione [**StgOpenPropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)



| Costante/valore                                                                                                                                                                                                                                               | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**PROPSETFLAG \_ DEFAULT**</dt> <dt>0</dt> </dl>                       | Se non viene specificato, per impostazione predefinita solo i valori di proprietà semplici possono essere scritti nel set di proprietà. L'uso di valori di proprietà semplici impedisce la transazione dei set di proprietà nel file composto e nelle implementazioni autonome di [**IPropertySetStorage.**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) A questo scopo, è necessario usare valori di proprietà non e.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**PROPSETFLAG \_ NONSIMPLE**</dt> <dt>1</dt> </dl>                 | Se specificato, i valori delle proprietà non semplice possono essere scritti nel set di proprietà e il set di proprietà viene salvato in un oggetto di archiviazione. I valori di proprietà non semplici includono quelli con VARTYPE storage \_ VT, VT \_ STREAM, VT \_ STORED OBJECT o \_ VT \_ STREAMED \_ OBJECT. Se questo flag non viene specificato, non è possibile scrivere tipi non semplici nel set di proprietà. Nel file composto e nelle implementazioni autonome, i set di proprietà possono essere transazionati solo se **si specifica PROPSETFLAG \_ NONSIMPLE.**<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**PROPSETFLAG \_ ANSI**</dt> <dt>2</dt> </dl>                                | Se specificato, tutti i valori stringa nel set di proprietà che non sono unicode in modo esplicito, ad esempio quelli diversi da VT LPWSTR, vengono archiviati con la tabella codici \_ ANSI di sistema corrente. Per altre informazioni, vedere [**GetACP.**](/windows/desktop/api/winnls/nf-winnls-getacp) L'uso di questo valore non è consigliato. Per altre informazioni, vedere la sezione Osservazioni.<br/> Se questo valore è assente, i valori stringa nel nuovo set di proprietà vengono archiviati in Unicode. Il livello di controllo fornito da questo valore è necessario in modo che i client che usano le interfacce correlate alle proprietà possano interagire con set di proprietà standard, ad esempio le informazioni di riepilogo OLE2, che possono esistere nella tabella codici ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**PROPSETFLAG \_ UNBUFFERED**</dt> <dt>4</dt> </dl>              | Usato solo con le [**funzioni StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) [**e StgOpenPropStg;**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) ciò significa che nelle implementazioni autonome delle interfacce del set di proprietà. Se specificato in queste funzioni, le modifiche apportate al set di proprietà non vengono memorizzate nel buffer. Al contrario, le modifiche vengono sempre scritte direttamente nel set di proprietà. Le chiamate ai metodi [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) di un set di proprietà lo modificheranno. Tuttavia, per impostazione predefinita, le modifiche vengono memorizzate nel buffer in una cache interna del set di proprietà e successivamente scritte nella proprietà impostata quando viene chiamato il metodo [**IPropertyStorage::Commit.**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) <br/> **L'impostazione di PROPSETFLAG \_ UNBUFFERED** riduce le prestazioni perché il buffer interno del set di proprietà viene scaricato automaticamente dopo ogni modifica apportata al set di proprietà. Tuttavia, la scrittura diretta delle modifiche impedirà problemi di coordinamento. Ad esempio, se l'oggetto di archiviazione viene aperto in modalità transazione e il set di proprietà viene memorizzato nel buffer. Quindi, se si chiama il metodo [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) sull'oggetto di archiviazione, le modifiche del set di proprietà non verranno prelevate come parte della transazione, perché sono in un buffer che non è stato ancora scaricato. È necessario chiamare [**IPropertyStorage::Commit prima**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) di chiamare **IStorage::Commit** per scaricare il buffer del set di proprietà prima di eseguire il commit delle modifiche nell'archiviazione. In alternativa all'esecuzione di due chiamate, è possibile impostare **PROPSETFLAG \_ UNBUFFERED** in modo che le modifiche siano sempre scritte direttamente nel set di proprietà e non siano mai memorizzate nel buffer nella cache interna del set di proprietà. Le modifiche verranno quindi prelevate quando viene eseguito il commit dell'archiviazione transazione.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**PROPSETFLAG \_ DISTINZIONE \_ TRA MAIUSCOLE E MINUSCOLE**</dt> <dt>8</dt> </dl> | Se specificato, per i nomi delle proprietà viene fatto distinzione tra maiuscole e minuscole. I nomi delle proprietà con distinzione tra maiuscole e minuscole sono possibili solo nel formato di serializzazione del set di proprietà della versione 1. Per altre informazioni, vedere [Serializzazione di set di proprietà.](version-0-vs--version-1-property-set-serialization.md)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Commenti

Questi valori possono essere impostati e controllati usando operazioni bit per bit che determinano la modalità di creazione e apertura dei set di proprietà. I set di proprietà vengono creati [**usando il metodo IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) o [**la funzione StgCreatePropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) Vengono aperti usando il [**metodo IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) o la [**funzione StgOpenPropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)

È consigliabile creare set di proprietà come Unicode non impostando il flag **\_ ANSI PROPSETFLAG** nel *parametro grfFlags.* È anche consigliabile evitare di usare valori LPSTR VT e usare invece valori \_ \_ LPWSTR VT. Quando la tabella codici del set di proprietà è Unicode, i valori stringa LPSTR VT vengono convertiti in Unicode quando vengono archiviati e convertiti nuovamente in valori stringa multibyte quando \_ vengono recuperati. Quando la tabella codici del set di proprietà non è Unicode, i nomi delle proprietà, le stringhe BSTR VT e i valori delle proprietà nonsimple vengono convertiti in stringhe multibyte quando vengono archiviati e convertiti nuovamente in Unicode al momento del recupero, il tutto usando la tabella codici ANSI di sistema \_ corrente.

## <a name="requirements"></a>Requisiti



| Requisito | Valore |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimo supportato<br/> | Windows 2000 Professional \[solo app desktop\]<br/>                           |
| Server minimo supportato<br/> | Windows 2000 Server \[solo app desktop\]<br/>                                 |
| Intestazione<br/>                   | <dl> <dt>Propidl.h</dt> </dl> |



## <a name="see-also"></a>Vedi anche

<dl> <dt>

[**FmtIdToPropStgName**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**PropStgNameToFmtId**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**StgCreatePropSetStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

