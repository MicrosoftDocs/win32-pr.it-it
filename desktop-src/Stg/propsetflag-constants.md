---
title: Costanti PROPSETFLAG (propidl. h)
description: Definire le caratteristiche di un set di proprietà.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/12/2020
ms.locfileid: "103964272"
---
# <a name="propsetflag-constants"></a>Costanti PROPSETFLAG

Le costanti PROPSETFLAG definiscono le caratteristiche di un set di proprietà. I valori, elencati nella tabella seguente, vengono usati nel parametro *grfFlags* dei metodi [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , della funzione [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) e della funzione [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .



| Costante/valore                                                                                                                                                                                                                                               | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**PROPSETFLAG \_ Valore predefinito**</dt> <dt>0</dt> </dl>                       | Se non è specificato, per impostazione predefinita solo i valori di proprietà semplici possono essere scritti nel set di proprietà. L'utilizzo di valori di proprietà semplici impedisce che i set di proprietà vengano sottoposti a transazione nel file composto e nelle implementazioni autonome di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage). Per questo scopo è necessario utilizzare i valori delle proprietà non e.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**PROPSETFLAG \_ Non semplice**</dt> <dt>1</dt> </dl>                 | Se specificato, i valori di proprietà non semplici possono essere scritti nel set di proprietà e il set di proprietà viene salvato in un oggetto di archiviazione. I valori di proprietà non semplici includono quelli con un VARTYPE di \_ archiviazione VT, un \_ flusso VT, un \_ oggetto archiviato VT o un oggetto con \_ \_ flusso VT \_ . Se questo flag non è specificato, non è possibile scrivere tipi non semplici nel set di proprietà. Nel file composto e nelle implementazioni autonome, i set di proprietà possono essere sottoposti a transazione solo se viene specificato **PROPSETFLAG non \_ semplice** .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**PROPSETFLAG \_ ANSI**</dt> <dt>2</dt> </dl>                                | Se specificato, tutti i valori stringa nel set di proprietà che non sono Unicode in modo esplicito, ovvero quelli diversi da VT \_ LPWSTR, vengono archiviati con la tabella codici ANSI di sistema corrente. Per ulteriori informazioni, vedere [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp). Non è consigliabile usare questo valore. Per altre informazioni, vedere la sezione Osservazioni.<br/> Se questo valore è assente, i valori stringa nel nuovo set di proprietà vengono archiviati in formato Unicode. Il grado di controllo fornito da questo valore è necessario in modo che i client che utilizzano le interfacce correlate alle proprietà possano interagire con i set di proprietà standard, ad esempio le informazioni di riepilogo OLE2, che possono esistere nella tabella codici ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**PROPSETFLAG \_ Senza BUFFER**</dt> <dt>4</dt> </dl>              | Utilizzato solo con le funzioni [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) e [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) . ovvero nelle implementazioni autonome delle interfacce dei set di proprietà. Se specificato in queste funzioni, le modifiche apportate al set di proprietà non vengono memorizzate nel buffer. Al contrario, le modifiche vengono sempre scritte direttamente nel set di proprietà. Le chiamate a un set di proprietà [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) metodi lo modificheranno. Per impostazione predefinita, tuttavia, le modifiche vengono memorizzate nel buffer in una cache di set di proprietà interna e successivamente vengono scritte nella proprietà impostata quando viene chiamato il metodo [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) . <br/> L'impostazione di **PROPSETFLAG senza \_ buffer** comporta una riduzione delle prestazioni in quanto il buffer interno del set di proprietà viene scaricato automaticamente dopo ogni modifica apportata al set di proprietà. Tuttavia, la scrittura diretta delle modifiche eviterà problemi di coordinamento. Ad esempio, se l'oggetto di archiviazione viene aperto in modalità transazionale e il set di proprietà viene memorizzato nel buffer. Quindi, se si chiama il metodo [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) sull'oggetto di archiviazione, le modifiche apportate al set di proprietà non verranno rilevate come parte della transazione, perché si trovano in un buffer che non è ancora stato scaricato. È necessario chiamare [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) prima di chiamare **IStorage:: commit** per scaricare il buffer del set di proprietà prima di eseguire il commit delle modifiche nell'archivio. In alternativa all'esecuzione di due chiamate, è possibile impostare **PROPSETFLAG senza \_ buffer** , in modo che le modifiche vengano sempre scritte direttamente nel set di proprietà e non vengano mai memorizzate nel buffer nella cache interna del set di proprietà. Quindi, le modifiche verranno selezionate quando viene eseguito il commit dell'archiviazione transazionale.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**PROPSETFLAG \_ Distinzione MAIUSCOLe/ \_ minuscole**</dt> <dt>8</dt> </dl> | Se specificato, i nomi delle proprietà fanno distinzione tra maiuscole e minuscole. I nomi di proprietà con distinzione tra maiuscole e minuscole sono possibili solo nel formato di serializzazione del set di proprietà versione 1 Per ulteriori informazioni, vedere [serializzazione del set di proprietà](version-0-vs--version-1-property-set-serialization.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Commenti

Questi valori possono essere impostati e controllati utilizzando operazioni bit per bit che determinano la modalità di creazione e apertura dei set di proprietà. I set di proprietà vengono creati usando il metodo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) o la funzione [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) . Vengono aperti usando il metodo [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) o la funzione [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .

È consigliabile creare set di proprietà come Unicode non impostando il flag **\_ ANSI PROPSETFLAG** nel parametro *grfFlags* . È inoltre consigliabile evitare di usare \_ i valori LPSTR di VT e usare \_ invece i valori LPWSTR di VT. Quando la tabella codici del set di proprietà è Unicode, \_ i valori di stringa VT LPSTR vengono convertiti in Unicode quando vengono archiviati e riconvertiti in valori stringa multibyte quando vengono recuperati. Quando la tabella codici della proprietà impostata non è di tipo Unicode, i nomi delle proprietà, le stringhe del VT \_ BSTR e i valori di proprietà non semplici vengono convertiti in stringhe multibyte quando vengono archiviati e riconvertiti in Unicode quando vengono recuperati, tutti utilizzando la tabella codici ANSI di sistema corrente.

## <a name="requirements"></a>Requisiti



| Requisito | Valore |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimo supportato<br/> | Windows 2000 Professional \[solo app desktop\]<br/>                           |
| Server minimo supportato<br/> | Windows 2000 Server \[solo app desktop\]<br/>                                 |
| Intestazione<br/>                   | <dl> <dt>Propidl. h</dt> </dl> |



## <a name="see-also"></a>Vedi anche

<dl> <dt>

[**FmtIdToPropStgName**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**PropStgNameToFmtId**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**StgCreatePropSetStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

