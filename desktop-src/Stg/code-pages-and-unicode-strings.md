---
title: Tabelle codici e stringhe Unicode
description: Un'altra considerazione nell'implementazione di IPropertySetStorage è il modo in cui i nomi delle proprietà Unicode vengono archiviati nell'ID di proprietà 0 (il dizionario del nome della proprietà), che non utilizza stringhe Unicode.
ms.assetid: 830c90c9-d2a5-4ecf-8cb6-9950ed5320bf
keywords:
- Tabelle codici e stringhe Unicode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 508d508ec21e7e763a683e534cf485ebbeec018d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104328719"
---
# <a name="code-pages-and-unicode-strings"></a><span data-ttu-id="e6b29-104">Tabelle codici e stringhe Unicode</span><span class="sxs-lookup"><span data-stu-id="e6b29-104">Code Pages and Unicode Strings</span></span>

<span data-ttu-id="e6b29-105">Un'altra considerazione nell'implementazione di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) è il modo in cui i nomi delle proprietà Unicode vengono archiviati nell'ID di proprietà 0 (il dizionario del nome della proprietà), che non utilizza stringhe Unicode.</span><span class="sxs-lookup"><span data-stu-id="e6b29-105">Another consideration in implementing [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is how Unicode property names are stored in the property ID 0 (the property name dictionary), which does not use Unicode strings.</span></span>

<span data-ttu-id="e6b29-106">Unicode ha ufficialmente un valore della tabella codici 1200.</span><span class="sxs-lookup"><span data-stu-id="e6b29-106">Unicode officially has a code page value of 1200.</span></span> <span data-ttu-id="e6b29-107">Per archiviare i valori Unicode nel dizionario nome proprietà, usare un valore della tabella codici 1200 per l'intero set di proprietà (in ID proprietà 1), specificato dall'assenza del flag **\_ ANSI PROPSETFLAG** in [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="e6b29-107">To store Unicode values in the property name dictionary, use a code page value of 1200 for the whole property set (in property ID 1), specified by the absence of the **PROPSETFLAG\_ANSI** flag in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="e6b29-108">Tenere presente che questa operazione ha effetto collaterale sull'archiviazione di tutti i valori stringa nella proprietà impostata in Unicode.</span><span class="sxs-lookup"><span data-stu-id="e6b29-108">Be aware that this has the side effect of storing all string values in the property set in Unicode.</span></span> <span data-ttu-id="e6b29-109">In tutte le tabelle codici il conteggio rilevato all'inizio di un **\_ LPSTR VT** è un conteggio di byte, non un conteggio di caratteri.</span><span class="sxs-lookup"><span data-stu-id="e6b29-109">In all code pages, the count found at the start of a **VT\_LPSTR** is a byte count, not a character count.</span></span> <span data-ttu-id="e6b29-110">Questa operazione è necessaria per garantire la compatibilità con i client di versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="e6b29-110">This is necessary to provide for compatibility with earlier-version clients.</span></span>

<span data-ttu-id="e6b29-111">L'implementazione del file composto di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) crea completamente tutti i nuovi set di proprietà in formato Unicode (tabella codici 1200) o nella tabella codici ANSI di sistema corrente.</span><span class="sxs-lookup"><span data-stu-id="e6b29-111">The compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) creates all new property sets completely either in Unicode (code page 1200) or in the current system ANSI code page.</span></span> <span data-ttu-id="e6b29-112">Questa operazione è controllata dall'assenza o dalla presenza del **flag \_ ANSI PROPSETFLAG** nel parametro *grfFlags* di [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="e6b29-112">This is controlled by the absence or presence of the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span>

<span data-ttu-id="e6b29-113">Creare e aprire i set di proprietà come Unicode.</span><span class="sxs-lookup"><span data-stu-id="e6b29-113">Create and open property sets as Unicode.</span></span> <span data-ttu-id="e6b29-114">Per implementare questo, non impostare il flag **\_ ANSI PROPSETFLAG** nel parametro *grfFlags* di [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="e6b29-114">To implement this, do not set the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="e6b29-115">Evitare di usare i valori **\_ LPSTR di VT** e usare invece i valori **\_ LPWSTR di VT** .</span><span class="sxs-lookup"><span data-stu-id="e6b29-115">Avoid using **VT\_LPSTR** values, and instead use **VT\_LPWSTR** values.</span></span> <span data-ttu-id="e6b29-116">Quando la tabella codici della proprietà è impostata su Unicode, i valori di stringa **VT \_ LPSTR** vengono convertiti in Unicode quando vengono archiviati e restituiti a valori stringa multibyte quando vengono recuperati.</span><span class="sxs-lookup"><span data-stu-id="e6b29-116">When the code page of the property set is Unicode, **VT\_LPSTR** string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span>

<span data-ttu-id="e6b29-117">L'impostazione del flag **\_ ANSI PROPSETFLAG** come segnalato tramite una chiamata a [**IPropertyStorage:: stat indica**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) se la tabella codici sottostante è o non è Unicode.</span><span class="sxs-lookup"><span data-stu-id="e6b29-117">Setting the **PROPSETFLAG\_ANSI** flag as reported through a call to [**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflects whether the underlying code page is or is not Unicode.</span></span> <span data-ttu-id="e6b29-118">Tenere presente che l'ID di proprietà 1 può essere letto in modo esplicito per apprendere la tabella codici.</span><span class="sxs-lookup"><span data-stu-id="e6b29-118">Be aware that Property ID 1 can be explicitly read to learn the code page.</span></span>

<span data-ttu-id="e6b29-119">È possibile accedere all'ID di proprietà 1 tramite una chiamata a [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span><span class="sxs-lookup"><span data-stu-id="e6b29-119">You can access Property ID 1 through a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="e6b29-120">Tuttavia, è di sola lettura e non può essere aggiornato con [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span><span class="sxs-lookup"><span data-stu-id="e6b29-120">However, it is read-only, and may not be updated with [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="e6b29-121">Inoltre, non può essere eliminato con [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span><span class="sxs-lookup"><span data-stu-id="e6b29-121">Furthermore, it may not be deleted with [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span></span>

 

 




