---
title: Gestione delle proprietà
description: Ogni proprietà è costituita da un identificatore di proprietà (univoco all'interno del set di proprietà), da un tag di tipo Variant (VT o VarType) che rappresenta il tipo di un valore e dal valore stesso.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Archiviazione strutturata Strctd STG, uso, gestione delle proprietà
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103872649"
---
# <a name="managing-properties"></a><span data-ttu-id="4e0ac-104">Gestione delle proprietà</span><span class="sxs-lookup"><span data-stu-id="4e0ac-104">Managing Properties</span></span>

<span data-ttu-id="4e0ac-105">Ogni proprietà è costituita da un *identificatore di proprietà* (univoco all'interno del set di proprietà), da un *tag di tipo Variant (VT o VarType)* che rappresenta il tipo di un valore e dal *valore* stesso.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="4e0ac-106">Il tag di tipo Variant descrive la rappresentazione dei dati nel valore.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="4e0ac-107">Inoltre, a una proprietà può essere assegnato un *nome di stringa* che può essere usato per identificare la proprietà, anziché usare l'identificatore di proprietà numerico (ID) obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="4e0ac-108">Per creare e gestire le proprietà, COM definisce l'interfaccia [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="4e0ac-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="4e0ac-109">L'interfaccia [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) include metodi per la lettura e la scrittura di matrici di proprietà o nomi di proprietà.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="4e0ac-110">L'interfaccia include metodi di [**commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) e [**ripristino**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) simili a metodi [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="4e0ac-111">Sono disponibili metodi di utilità che consentono di impostare l'identificatore di classe (CLSID) del set di proprietà, impostare le ore associate al set e ottenere le statistiche relative al set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="4e0ac-112">Infine, il metodo [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) crea un enumeratore e restituisce un puntatore alla relativa interfaccia [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) .</span><span class="sxs-lookup"><span data-stu-id="4e0ac-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="4e0ac-113">È possibile chiamare i metodi di questa interfaccia per enumerare le strutture [**Campo STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) sull'oggetto, in modo da fornire informazioni su tutte le proprietà nel set di proprietà corrente.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="4e0ac-114">Di seguito è riportato un esempio di come vengono rappresentate le proprietà.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="4e0ac-115">Se una proprietà specifica in un set di proprietà include il nome scientifico di un animale, tale nome può essere archiviato come stringa con terminazione zero.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="4e0ac-116">Memorizzato insieme al nome sarebbe un indicatore di tipo per indicare che il valore è una stringa con terminazione zero.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="4e0ac-117">Queste proprietà possono avere le seguenti caratteristiche:</span><span class="sxs-lookup"><span data-stu-id="4e0ac-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="4e0ac-118">ID proprietà</span><span class="sxs-lookup"><span data-stu-id="4e0ac-118">Property ID</span></span> | <span data-ttu-id="4e0ac-119">Identificatore di stringa</span><span class="sxs-lookup"><span data-stu-id="4e0ac-119">String identifier</span></span> | <span data-ttu-id="4e0ac-120">Indicatore del tipo</span><span class="sxs-lookup"><span data-stu-id="4e0ac-120">Type indicator</span></span> | <span data-ttu-id="4e0ac-121">Valore rappresentato</span><span class="sxs-lookup"><span data-stu-id="4e0ac-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="4e0ac-122">02</span><span class="sxs-lookup"><span data-stu-id="4e0ac-122">02</span></span>          | <span data-ttu-id="4e0ac-123">PID \_ animalname</span><span class="sxs-lookup"><span data-stu-id="4e0ac-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="4e0ac-124">\_LPWSTR VT</span><span class="sxs-lookup"><span data-stu-id="4e0ac-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="4e0ac-125">Stringa Unicode con terminazione zero</span><span class="sxs-lookup"><span data-stu-id="4e0ac-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="4e0ac-126">03</span><span class="sxs-lookup"><span data-stu-id="4e0ac-126">03</span></span>          | <span data-ttu-id="4e0ac-127">\_LEGCOUNT PID</span><span class="sxs-lookup"><span data-stu-id="4e0ac-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="4e0ac-128">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="4e0ac-128">VT\_I2</span></span>         | <span data-ttu-id="4e0ac-129">WORD</span><span class="sxs-lookup"><span data-stu-id="4e0ac-129">WORD</span></span>                           |



 

<span data-ttu-id="4e0ac-130">Qualsiasi applicazione che riconosce il formato del set di proprietà, che lo identifica tramite il relativo identificatore di formato (FMTID), può esaminare la proprietà con un identificatore di PID \_ animalname, determinare che si tratta di una stringa con terminazione zero, quindi leggere e scrivere il valore.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="4e0ac-131">Sebbene l'applicazione sia in grado di chiamare [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) per leggere uno o tutti i set di proprietà (ottenendo prima un puntatore), è necessario che l'applicazione sappia come interpretare il set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="4e0ac-132">Il valore di una proprietà viene passato tramite le interfacce di proprietà come istanza del tipo [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span><span class="sxs-lookup"><span data-stu-id="4e0ac-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="4e0ac-133">È importante distinguere tra queste proprietà archiviate (persistenti) e le proprietà della fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="4e0ac-134">Le costanti con valori di tipo Variant hanno nomi che iniziano con VT \_ .</span><span class="sxs-lookup"><span data-stu-id="4e0ac-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="4e0ac-135">Il set di PROPVARIANTs validi, tuttavia, non è interamente equivalente al set di varianti usato nei controlli ActiveX e di automazione.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="4e0ac-136">L'unica differenza tra le due strutture è il set consentito di Tag VT \_ (tipo Variant/VARTYPE) in ognuno di essi.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="4e0ac-137">Se un determinato tipo di proprietà può essere usato sia in una variante che in un PROPVARIANT, il tag del tipo (il \_ valore VT) ha sempre un valore identico.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="4e0ac-138">Per un determinato valore VT, inoltre, \_ la rappresentazione in memoria usata nelle varianti e PROPVARIANTs è identica.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="4e0ac-139">Insieme, questo approccio consente al sistema di tipi di intercettare i tag dei tipi non consentiti, mentre allo stesso tempo consente a un client esperto di implementare un cast del puntatore quando appropriato.</span><span class="sxs-lookup"><span data-stu-id="4e0ac-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="4e0ac-140">Per ulteriori informazioni, vedere la sezione seguente [considerazioni sull'archiviazione delle proprietà](property-storage-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="4e0ac-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 