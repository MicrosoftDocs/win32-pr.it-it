---
title: Implementazione di IPropertySetStorage-Compound file
description: L'implementazione dell'oggetto di archiviazione file composto COM include un'implementazione di IPropertyStorage, l'interfaccia che gestisce un singolo set di proprietà permanenti e IPropertySetStorage, l'interfaccia che gestisce i gruppi di set di proprietà permanenti.
ms.assetid: de2cb778-c6eb-4487-996b-87405674f603
keywords:
- IPropertySetStorage Strctd STG, implementazioni, file composto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9053a7cf6bf1ae7e4230b15eb0117c428acb08da
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103729082"
---
# <a name="ipropertysetstorage-compound-file-implementation"></a><span data-ttu-id="0afb0-104">Implementazione di IPropertySetStorage-Compound file</span><span class="sxs-lookup"><span data-stu-id="0afb0-104">IPropertySetStorage-Compound File Implementation</span></span>

<span data-ttu-id="0afb0-105">L' [implementazione dell'oggetto di archiviazione file composto com](ipropertystorage-compound-file-implementation.md) include un'implementazione di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), l'interfaccia che gestisce un singolo set di proprietà permanenti e [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), l'interfaccia che gestisce i gruppi di set di proprietà permanenti.</span><span class="sxs-lookup"><span data-stu-id="0afb0-105">The [COM compound file storage object implementation](ipropertystorage-compound-file-implementation.md) includes an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span>

<span data-ttu-id="0afb0-106">Per ottenere un puntatore all'implementazione del file composto di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), specificare il nome definito dall'intestazione per l'identificatore IID \_ IStorage come parametro *riid* oppure utilizzare le funzioni [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-106">To get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), specify the header-defined name for the identifier IID\_IStorage as the *riid* parameter, or use the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions.</span></span> <span data-ttu-id="0afb0-107">In entrambi i casi, specificare STGFMT \_ storage come parametro *STGFMT* .</span><span class="sxs-lookup"><span data-stu-id="0afb0-107">In both cases, specify STGFMT\_STORAGE as the *stgfmt* parameter.</span></span> <span data-ttu-id="0afb0-108">(STGFMT \_ In alternativa, è possibile specificare qualsiasi nel caso di **StgOpenStorageEx**. Specificare anche il nome definito dall'intestazione per l'IID (Interface Identifier) IID \_ IPropertySetStorage come parametro *riid* .</span><span class="sxs-lookup"><span data-stu-id="0afb0-108">(STGFMT\_ANY can alternatively be specified in the case of **StgOpenStorageEx**.) Also, specify the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage as the *riid* parameter.</span></span> <span data-ttu-id="0afb0-109">Entrambe le funzioni forniscono un puntatore all'interfaccia **IPropertySetStorage** dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="0afb0-109">Both functions supply a pointer to the object **IPropertySetStorage** interface.</span></span>

<span data-ttu-id="0afb0-110">Un altro modo per ottenere un puntatore all'implementazione del file composto è quello di specificare il nome definito dall'intestazione per l'identificatore IID \_ IStorage come parametro *riid* o di usare le funzioni [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) o [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-110">Another way to get a pointer to the compound file implementation is to specify the header-defined name for the identifier IID\_IStorage as the *riid* parameter, or to use the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) or [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions.</span></span> <span data-ttu-id="0afb0-111">Verrà fornito un puntatore all'interfaccia [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="0afb0-111">This will supply a pointer to the object [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface.</span></span> <span data-ttu-id="0afb0-112">Quando si desidera gestire i set di proprietà permanenti, chiamare [**IStorage:: QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per l'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-112">When you want to deal with persistent property sets, call [**IStorage::QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span>

## <a name="when-to-use-ipropertysetstorage"></a><span data-ttu-id="0afb0-113">Quando usare IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="0afb0-113">When to Use IPropertySetStorage</span></span>

<span data-ttu-id="0afb0-114">Chiamare i metodi di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) per creare, aprire o eliminare set di proprietà nella risorsa di archiviazione del set di proprietà del file composto corrente.</span><span class="sxs-lookup"><span data-stu-id="0afb0-114">Call the methods of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) to create, open, or delete property sets in the current compound-file property set storage.</span></span> <span data-ttu-id="0afb0-115">Esiste anche un metodo, [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), che fornisce un puntatore a un enumeratore che può essere usato per enumerare i set di proprietà nell'archivio.</span><span class="sxs-lookup"><span data-stu-id="0afb0-115">There is also a method, [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), that supplies a pointer to an enumerator that can be used to enumerate the property sets in the storage.</span></span>

## <a name="methods"></a><span data-ttu-id="0afb0-116">Metodi</span><span class="sxs-lookup"><span data-stu-id="0afb0-116">Methods</span></span>

[<span data-ttu-id="0afb0-117">**IPropertySetStorage:: create**</span><span class="sxs-lookup"><span data-stu-id="0afb0-117">**IPropertySetStorage::Create**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)

<span data-ttu-id="0afb0-118">Crea un nuovo set di proprietà nell'archivio file composto corrente e, al ritorno, fornisce un puntatore di interfaccia all'implementazione del file composto [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-118">Creates a new property set in the current compound file storage and, on return, supplies an interface pointer to the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) compound-file implementation.</span></span> <span data-ttu-id="0afb0-119">In questa implementazione i set di proprietà possono essere sottoposti a transazione solo se \_ viene specificato PROPSETFLAG non semplice.</span><span class="sxs-lookup"><span data-stu-id="0afb0-119">In this implementation, property sets may be transacted only if PROPSETFLAG\_NONSIMPLE is specified.</span></span> <span data-ttu-id="0afb0-120">Questo metodo richiede che la modalità di condivisione specificata nel parametro *grfMode* sia STGM \_ share \_ Exclusive e che la modalità di accesso sia STGM \_ Read o STGM \_ ReadWrite ( \_ la modalità di scrittura STGM non è supportata).</span><span class="sxs-lookup"><span data-stu-id="0afb0-120">This method requires that the sharing mode specified in the *grfMode* parameter be STGM\_SHARE\_EXCLUSIVE, and that the access mode be either STGM\_READ or STGM\_READWRITE (STGM\_WRITE mode is not supported).</span></span>

[<span data-ttu-id="0afb0-121">**IPropertySetStorage:: Open**</span><span class="sxs-lookup"><span data-stu-id="0afb0-121">**IPropertySetStorage::Open**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)

<span data-ttu-id="0afb0-122">Apre un set di proprietà esistente nell'archivio della proprietà corrente.</span><span class="sxs-lookup"><span data-stu-id="0afb0-122">Opens an existing property set in the current property storage.</span></span> <span data-ttu-id="0afb0-123">Al ritorno, fornisce un puntatore di interfaccia all'implementazione del file composito di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span><span class="sxs-lookup"><span data-stu-id="0afb0-123">On return, it supplies an interface pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span></span> <span data-ttu-id="0afb0-124">Questo metodo richiede che la modalità di condivisione specificata nel parametro *grfMode* sia STGM \_ share \_ Exclusive e che la modalità di accesso sia STGM \_ Read o STGM \_ ReadWrite (STGM \_ Write non è supportata).</span><span class="sxs-lookup"><span data-stu-id="0afb0-124">This method requires that the sharing mode specified in the *grfMode* parameter be STGM\_SHARE\_EXCLUSIVE, and that the access mode be either STGM\_READ or STGM\_READWRITE (STGM\_WRITE is not supported).</span></span>

[<span data-ttu-id="0afb0-125">**IPropertySetStorage::D Elimina**</span><span class="sxs-lookup"><span data-stu-id="0afb0-125">**IPropertySetStorage::Delete**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)

<span data-ttu-id="0afb0-126">Elimina un set di proprietà in questo archivio delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="0afb0-126">Deletes a property set in this property storage.</span></span>

[<span data-ttu-id="0afb0-127">**IPropertySetStorage:: enum**</span><span class="sxs-lookup"><span data-stu-id="0afb0-127">**IPropertySetStorage::Enum**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)

<span data-ttu-id="0afb0-128">Crea un oggetto utilizzato per enumerare le strutture [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-128">Creates an object used to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures.</span></span> <span data-ttu-id="0afb0-129">Ogni struttura **STATPROPSETSTG** fornisce dati su un singolo set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="0afb0-129">Each **STATPROPSETSTG** structure provides data about a single property set.</span></span>

## <a name="remarks"></a><span data-ttu-id="0afb0-130">Commenti</span><span class="sxs-lookup"><span data-stu-id="0afb0-130">Remarks</span></span>

<span data-ttu-id="0afb0-131">A partire da Windows 2000, l'implementazione del file composto di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supporta la modalità semplice.</span><span class="sxs-lookup"><span data-stu-id="0afb0-131">Starting with Windows 2000, the compound-file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supports simple mode.</span></span> <span data-ttu-id="0afb0-132">La modalità semplice è indicata specificando il \_ flag semplice STGM per le funzioni [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) e [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="0afb0-132">Simple mode is indicated by specifying the STGM\_SIMPLE flag for the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) and [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions.</span></span> <span data-ttu-id="0afb0-133">Se il file composto viene aperto in modalità semplice, l'implementazione di **IPropertySetStorage** associata è limitata come segue:</span><span class="sxs-lookup"><span data-stu-id="0afb0-133">If the compound file is opened in simple mode, the associated **IPropertySetStorage** implementation is limited as follows:</span></span>

-   <span data-ttu-id="0afb0-134">È possibile creare solo set di proprietà semplici.</span><span class="sxs-lookup"><span data-stu-id="0afb0-134">Only simple property sets can be created.</span></span> <span data-ttu-id="0afb0-135">Ovvero, se si specifica il \_ valore PROPSETFLAG non semplice nel parametro *grfFlags* per il metodo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="0afb0-135">That is, specifying the PROPSETFLAG\_NONSIMPLE value in the *grfFlags* parameter for the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method results in an error.</span></span>
-   <span data-ttu-id="0afb0-136">Dopo aver creato un file composto con [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) usando STGM \_ Simple ed eseguendo una query per l'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , è possibile chiamare solo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) una sola volta.</span><span class="sxs-lookup"><span data-stu-id="0afb0-136">After you create a compound file with [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) using STGM\_SIMPLE and query for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface, you can only call [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) once.</span></span> <span data-ttu-id="0afb0-137">Quindi è necessario rilasciare l'interfaccia [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) prima di chiamare di nuovo il metodo **create** .</span><span class="sxs-lookup"><span data-stu-id="0afb0-137">Then you must release the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface before calling the **Create** method again.</span></span> <span data-ttu-id="0afb0-138">Per altre informazioni sulla modalità semplice, vedere [**costanti STGM**](stgm-constants.md).</span><span class="sxs-lookup"><span data-stu-id="0afb0-138">For more information about simple mode, see [**STGM Constants**](stgm-constants.md).</span></span>
-   <span data-ttu-id="0afb0-139">Non è possibile usare il metodo [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) per aprire un set di proprietà dopo l'uso di [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) per creare l'oggetto di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0afb0-139">You cannot use the [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method to open a property set after using [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create the storage object.</span></span> <span data-ttu-id="0afb0-140">È invece necessario usare [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) prima di eseguire una query su [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) e chiamare il metodo **Open** .</span><span class="sxs-lookup"><span data-stu-id="0afb0-140">Instead you must use [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) before querying for [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and calling the **Open** method.</span></span>
-   <span data-ttu-id="0afb0-141">Dopo aver aperto un file composto con [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) usando il \_ flag semplice STGM e la query per l'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , è possibile aprire un set di proprietà alla volta usando [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open).</span><span class="sxs-lookup"><span data-stu-id="0afb0-141">After you open a compound file with [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) using the STGM\_SIMPLE flag and query for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface, you can open one property set at a time using [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open).</span></span> <span data-ttu-id="0afb0-142">Inoltre, potrebbe non essere possibile aumentare la dimensione totale del set di proprietà quando il set di proprietà è aperto.</span><span class="sxs-lookup"><span data-stu-id="0afb0-142">Also, it may not be possible for the total size of the property set to be increased while the property set is open.</span></span>

<span data-ttu-id="0afb0-143">I set di proprietà semplici non possono essere sottoposti a transazione.</span><span class="sxs-lookup"><span data-stu-id="0afb0-143">Simple property sets cannot be transacted.</span></span> <span data-ttu-id="0afb0-144">Non è possibile specificare STGM \_ transazionale nel parametro *grfMode* dei metodi [**create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) e [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) , a meno che non si specifichi anche PROPSETFLAG \_ nonsimple nel parametro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="0afb0-144">You cannot specify STGM\_TRANSACTED in the *grfmode* parameter of the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods unless you also specify PROPSETFLAG\_NONSIMPLE in the *grfFlags* parameter.</span></span> <span data-ttu-id="0afb0-145">Tenere presente che i set di proprietà semplici e non semplici non sono correlati ai set di proprietà in modalità semplice descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0afb0-145">Be aware that simple and non-simple property sets are unrelated to the simple-mode property sets described above.</span></span> <span data-ttu-id="0afb0-146">Per altre informazioni sui set di proprietà semplici e non semplici, vedere [oggetti di archiviazione e di flusso per un set di proprietà](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="0afb0-146">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

> [!Note]  
> <span data-ttu-id="0afb0-147">I set di proprietà DocumentSummaryInformation e UserDefined sono univoci in quanto possono avere due sezioni set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="0afb0-147">The DocumentSummaryInformation and UserDefined property sets are unique in that they may have two property set sections.</span></span> <span data-ttu-id="0afb0-148">Per ulteriori informazioni, vedere [i set di proprietà DocumentSummaryInformation e UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="0afb0-148">For more information, see [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="0afb0-149">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0afb0-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0afb0-150">IPropertyStorage-implementazione del file composto</span><span class="sxs-lookup"><span data-stu-id="0afb0-150">IPropertyStorage - Compound File Implementation</span></span>](ipropertystorage-compound-file-implementation.md)
</dt> <dt>

[<span data-ttu-id="0afb0-151">**IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="0afb0-151">**IPropertySetStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)
</dt> <dt>

[<span data-ttu-id="0afb0-152">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="0afb0-152">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="0afb0-153">**IStorage:: EnumElements**</span><span class="sxs-lookup"><span data-stu-id="0afb0-153">**IStorage::EnumElements**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)
</dt> <dt>

[<span data-ttu-id="0afb0-154">**Costanti PROPSETFLAG**</span><span class="sxs-lookup"><span data-stu-id="0afb0-154">**PROPSETFLAG Constants**</span></span>](propsetflag-constants.md)
</dt> <dt>

[<span data-ttu-id="0afb0-155">**STATPROPSETSTG**</span><span class="sxs-lookup"><span data-stu-id="0afb0-155">**STATPROPSETSTG**</span></span>](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)
</dt> </dl>

 

 