---
title: Caratteristiche di prestazioni
description: Una chiamata all'implementazione del file composto COM dell'interfaccia IPropertySetStorage per creare un set di proprietà comporta la creazione di un flusso o di una risorsa di archiviazione tramite una chiamata a IStorage CreateStream o IStorage CreateStorage.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103963233"
---
# <a name="performance-characteristics"></a><span data-ttu-id="52626-103">Caratteristiche di prestazioni</span><span class="sxs-lookup"><span data-stu-id="52626-103">Performance Characteristics</span></span>

<span data-ttu-id="52626-104">Una chiamata all'implementazione del file composto COM dell'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) per creare un set di proprietà comporta la creazione di un flusso o di una risorsa di archiviazione tramite una chiamata a [**IStorage:: CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) o [**IStorage:: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span><span class="sxs-lookup"><span data-stu-id="52626-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="52626-105">Un set di proprietà predefinito viene creato in memoria, ma non viene scaricato su disco.</span><span class="sxs-lookup"><span data-stu-id="52626-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="52626-106">Quando viene eseguita una chiamata a [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), questo opera all'interno del buffer.</span><span class="sxs-lookup"><span data-stu-id="52626-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="52626-107">Quando viene aperto un set di proprietà, viene usato [IStorage:: OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) o [IStorage:: OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) .</span><span class="sxs-lookup"><span data-stu-id="52626-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="52626-108">L'intero flusso del set di proprietà viene letto nella memoria contigua.</span><span class="sxs-lookup"><span data-stu-id="52626-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="52626-109">Le operazioni [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) quindi operano leggendo il buffer di memoria.</span><span class="sxs-lookup"><span data-stu-id="52626-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="52626-110">Pertanto, il primo accesso è dispendioso in termini di tempo (a causa delle letture su disco), ma gli accessi successivi sono molto efficienti.</span><span class="sxs-lookup"><span data-stu-id="52626-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="52626-111">Le scritture possono essere leggermente più onerose perché è possibile che le operazioni di ridimensionamento nel flusso sottostante garantiscano la disponibilità di spazio su disco in caso di aggiunta di dati.</span><span class="sxs-lookup"><span data-stu-id="52626-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="52626-112">Non viene garantita alcuna garanzia in merito al fatto che [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) effettui lo scaricamento degli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="52626-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="52626-113">In generale, il client deve presupporre che **IPropertyStorage:: WriteMultiple** aggiorni solo il buffer in memoria.</span><span class="sxs-lookup"><span data-stu-id="52626-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="52626-114">Per svuotare i dati, è necessario chiamare [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) o [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (ultima versione).</span><span class="sxs-lookup"><span data-stu-id="52626-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="52626-115">Questo progetto significa che [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) può avere esito positivo, ma i dati non vengono effettivamente scritti in modo permanente.</span><span class="sxs-lookup"><span data-stu-id="52626-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="52626-116">Questa dimensione del flusso del set di proprietà non può superare 256K byte.</span><span class="sxs-lookup"><span data-stu-id="52626-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 