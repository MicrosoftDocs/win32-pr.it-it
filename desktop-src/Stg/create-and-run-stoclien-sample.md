---
title: Creare ed eseguire l'esempio StoClien
description: StoClien funziona in collaborazione con un oggetto della carta in un server COM per ottenere l'archiviazione persistente dei disegni nei file composti COM.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Creare ed eseguire l'esempio StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f00274293c05e21e660dc8e9448ca95946cab8a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106298070"
---
# <a name="create-and-run-stoclien-sample"></a><span data-ttu-id="69ff8-104">Creare ed eseguire l'esempio StoClien</span><span class="sxs-lookup"><span data-stu-id="69ff8-104">Create and Run StoClien Sample</span></span>

<span data-ttu-id="69ff8-105">**StoClien** funziona in collaborazione con un oggetto della carta in un server com per ottenere l'archiviazione persistente dei disegni nei file composti com.</span><span class="sxs-lookup"><span data-stu-id="69ff8-105">**StoClien** works in cooperation with a COPaper object in a COM server to achieve persistent storage of drawings in COM compound files.</span></span> <span data-ttu-id="69ff8-106">Per ulteriori informazioni sull'utilizzo dei flussi nel file composto fornito da **StoClien**, vedere l'esempio [**StoServe**](structured-storage-server-sample--stoserve-.md) e STOSERVE.HTM.</span><span class="sxs-lookup"><span data-stu-id="69ff8-106">For more information about COPaper's use of streams in the compound file provided to COPaper by **StoClien**, see [**StoServe**](structured-storage-server-sample--stoserve-.md) sample and STOSERVE.HTM.</span></span> <span data-ttu-id="69ff8-107">La costruzione della cocarta e la relativa interfaccia IPaper sono descritte anche nell'esempio **StoServe** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-107">COPaper's construction and its IPaper interface are also covered in the **StoServe** sample.</span></span>

## <a name="code-tour"></a><span data-ttu-id="69ff8-108">Tour del codice</span><span class="sxs-lookup"><span data-stu-id="69ff8-108">Code Tour</span></span>

<span data-ttu-id="69ff8-109">Gli argomenti principali trattati in questa presentazione del codice sono:</span><span class="sxs-lookup"><span data-stu-id="69ff8-109">The major topics covered in this code tour are:</span></span>

-   <span data-ttu-id="69ff8-110">Come **CGuiPaper** incapsula il comportamento dell'interfaccia utente grafica del documento di disegno elettronico di **StoClien**</span><span class="sxs-lookup"><span data-stu-id="69ff8-110">How **CGuiPaper** encapsulates the GUI behavior of **StoClien**'s electronic drawing paper</span></span>
-   <span data-ttu-id="69ff8-111">Come **StoClien** acquisisce e visualizza l'attività di disegno interattivo</span><span class="sxs-lookup"><span data-stu-id="69ff8-111">How **StoClien** captures and displays interactive drawing activity</span></span>
-   <span data-ttu-id="69ff8-112">Modalità di utilizzo del documento da parte dell'oggetto **CGuiPaper** per registrare i dati di disegno</span><span class="sxs-lookup"><span data-stu-id="69ff8-112">How the **CGuiPaper** object uses COPaper to record drawing data</span></span>
-   <span data-ttu-id="69ff8-113">Modalità di utilizzo di una connessione IPaperSink nella ridisegno</span><span class="sxs-lookup"><span data-stu-id="69ff8-113">How an IPaperSink connection is used in repainting</span></span>
-   <span data-ttu-id="69ff8-114">Come i metodi **Load** e **Save** di CPapFile usano l'archiviazione strutturata nei file composti</span><span class="sxs-lookup"><span data-stu-id="69ff8-114">How the CPapFile **Load** and **Save** methods use the structured storage in compound files</span></span>

<span data-ttu-id="69ff8-115">Poiché la classe **CGuiBall** utilizzata negli esempi FRECLIEN e CONCLIEN incapsula il comportamento di una palla da rimbalzo, **StoClien** utilizza una classe C++ **CGuiPaper** per incapsulare i dati e il comportamento dell'interfaccia utente grafica del documento di disegno elettronico.</span><span class="sxs-lookup"><span data-stu-id="69ff8-115">As the **CGuiBall** class used in the FRECLIEN and CONCLIEN samples encapsulated the behavior of a bouncing ball, **StoClien** uses a **CGuiPaper** C++ class to encapsulate the data and GUI behavior of electronic drawing paper.</span></span>

<span data-ttu-id="69ff8-116">La tabella seguente elenca i file pertinenti per l'esempio **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-116">The following table lists the files pertinent to the **StoClien** sample.</span></span>



| <span data-ttu-id="69ff8-117">File</span><span class="sxs-lookup"><span data-stu-id="69ff8-117">Files</span></span>        | <span data-ttu-id="69ff8-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="69ff8-118">Description</span></span>                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="69ff8-119">STOCLIEN.TXT</span><span class="sxs-lookup"><span data-stu-id="69ff8-119">STOCLIEN.TXT</span></span> | <span data-ttu-id="69ff8-120">Breve descrizione di esempio.</span><span class="sxs-lookup"><span data-stu-id="69ff8-120">Short sample description.</span></span>                                                                                                        |
| <span data-ttu-id="69ff8-121">MAKEFILE</span><span class="sxs-lookup"><span data-stu-id="69ff8-121">MAKEFILE</span></span>     | <span data-ttu-id="69ff8-122">Il makefile generico per la compilazione dell'esempio di codice.</span><span class="sxs-lookup"><span data-stu-id="69ff8-122">The generic makefile for building the code sample.</span></span>                                                                               |
| <span data-ttu-id="69ff8-123">STOCLIEN. H</span><span class="sxs-lookup"><span data-stu-id="69ff8-123">STOCLIEN.H</span></span>   | <span data-ttu-id="69ff8-124">File di inclusione per l'applicazione **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-124">The include file for the **StoClien** application.</span></span> <span data-ttu-id="69ff8-125">Contiene le dichiarazioni di classe, i prototipi di funzione e gli identificatori di risorsa.</span><span class="sxs-lookup"><span data-stu-id="69ff8-125">Contains class declarations, function prototypes, and resource identifiers.</span></span>   |
| <span data-ttu-id="69ff8-126">STOCLIEN. CPP</span><span class="sxs-lookup"><span data-stu-id="69ff8-126">STOCLIEN.CPP</span></span> | <span data-ttu-id="69ff8-127">File di implementazione principale per STOCLIEN.EXE.</span><span class="sxs-lookup"><span data-stu-id="69ff8-127">The main implementation file for STOCLIEN.EXE.</span></span> <span data-ttu-id="69ff8-128">Dispone dell'implementazione di WinMain e CMainWindow, nonché dell'invio del menu principale.</span><span class="sxs-lookup"><span data-stu-id="69ff8-128">Has WinMain and CMainWindow implementation, as well as the main menu dispatching.</span></span> |
| <span data-ttu-id="69ff8-129">STOCLIEN. RC</span><span class="sxs-lookup"><span data-stu-id="69ff8-129">STOCLIEN.RC</span></span>  | <span data-ttu-id="69ff8-130">Il file di definizione della risorsa dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="69ff8-130">The application resource definition file.</span></span>                                                                                        |
| <span data-ttu-id="69ff8-131">STOCLIEN. ICO</span><span class="sxs-lookup"><span data-stu-id="69ff8-131">STOCLIEN.ICO</span></span> | <span data-ttu-id="69ff8-132">Risorsa icona dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="69ff8-132">The application icon resource.</span></span>                                                                                                   |
| <span data-ttu-id="69ff8-133">STOCLIEN. PAP</span><span class="sxs-lookup"><span data-stu-id="69ff8-133">STOCLIEN.PAP</span></span> | <span data-ttu-id="69ff8-134">Un file di disegno cartaceo predefinito per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="69ff8-134">A default paper drawing file for the application.</span></span>                                                                                |
| <span data-ttu-id="69ff8-135">Matita. CUR</span><span class="sxs-lookup"><span data-stu-id="69ff8-135">PENCIL.CUR</span></span>   | <span data-ttu-id="69ff8-136">Immagine a matita per il cursore della finestra client.</span><span class="sxs-lookup"><span data-stu-id="69ff8-136">A pencil image for the client window cursor.</span></span>                                                                                     |
| <span data-ttu-id="69ff8-137">SINK. H</span><span class="sxs-lookup"><span data-stu-id="69ff8-137">SINK.H</span></span>       | <span data-ttu-id="69ff8-138">Dichiarazione di classe per la classe di oggetti COM COPaperSink.</span><span class="sxs-lookup"><span data-stu-id="69ff8-138">The class declaration for the COPaperSink COM object class.</span></span>                                                                      |
| <span data-ttu-id="69ff8-139">SINK. CPP</span><span class="sxs-lookup"><span data-stu-id="69ff8-139">SINK.CPP</span></span>     | <span data-ttu-id="69ff8-140">File di implementazione per la classe di oggetti COM COPaperSink.</span><span class="sxs-lookup"><span data-stu-id="69ff8-140">Implementation file for the COPaperSink COM object class.</span></span>                                                                        |
| <span data-ttu-id="69ff8-141">PAPFILE. H</span><span class="sxs-lookup"><span data-stu-id="69ff8-141">PAPFILE.H</span></span>    | <span data-ttu-id="69ff8-142">Dichiarazione di classe per la classe C++ **CPapFile** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-142">The class declaration for the **CPapFile** C++ class.</span></span>                                                                            |
| <span data-ttu-id="69ff8-143">PAPFILE. CPP</span><span class="sxs-lookup"><span data-stu-id="69ff8-143">PAPFILE.CPP</span></span>  | <span data-ttu-id="69ff8-144">File di implementazione per la classe C++ **CPapFile** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-144">Implementation file for the **CPapFile** C++ class.</span></span>                                                                              |
| <span data-ttu-id="69ff8-145">GUIPAPER. H</span><span class="sxs-lookup"><span data-stu-id="69ff8-145">GUIPAPER.H</span></span>   | <span data-ttu-id="69ff8-146">Dichiarazione di classe per la classe C++ **CGuiPaper** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-146">The class declaration for the **CGuiPaper** C++ class.</span></span>                                                                           |
| <span data-ttu-id="69ff8-147">GUIPAPER. CPP</span><span class="sxs-lookup"><span data-stu-id="69ff8-147">GUIPAPER.CPP</span></span> | <span data-ttu-id="69ff8-148">File di implementazione per la classe C++ **CGuiPaper** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-148">Implementation file for the **CGuiPaper** C++ class.</span></span>                                                                             |
| <span data-ttu-id="69ff8-149">STOCLIEN. DSP</span><span class="sxs-lookup"><span data-stu-id="69ff8-149">STOCLIEN.DSP</span></span> | <span data-ttu-id="69ff8-150">Microsoft Visual Studio file di progetto.</span><span class="sxs-lookup"><span data-stu-id="69ff8-150">Microsoft Visual Studio Project file.</span></span>                                                                                            |



 

## <a name="compound-files"></a><span data-ttu-id="69ff8-151">file compositi</span><span class="sxs-lookup"><span data-stu-id="69ff8-151">Compound Files</span></span>

<span data-ttu-id="69ff8-152">**StoClien** si basa sulla cocarta per registrare i dati di disegno.</span><span class="sxs-lookup"><span data-stu-id="69ff8-152">**StoClien** relies on COPaper to record drawing data.</span></span> <span data-ttu-id="69ff8-153">Si basa inoltre sulla cocarta per archiviare i dati in un file composto.</span><span class="sxs-lookup"><span data-stu-id="69ff8-153">It also relies on COPaper to store the data in a compound file.</span></span> <span data-ttu-id="69ff8-154">Tuttavia, in una tipica divisione del lavoro tra client e server COM, **StoClien** condivide parte della responsabilità per l'archiviazione di file.</span><span class="sxs-lookup"><span data-stu-id="69ff8-154">However, in a typical division of labor between COM client and server, **StoClien** shares part of the responsibility for file storage.</span></span> <span data-ttu-id="69ff8-155">Questa divisione del lavoro è importante nelle applicazioni COM in cui il client è un contenitore e il server è un oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="69ff8-155">This division of labor is important in COM applications where the client is a container and the server is an embedded object.</span></span> <span data-ttu-id="69ff8-156">In questo accordo, il client è responsabile della creazione o dell'apertura di un file di archiviazione strutturata, mentre l'oggetto server è responsabile dell'uso di tale archiviazione per scopi di archiviazione dei dati propri.</span><span class="sxs-lookup"><span data-stu-id="69ff8-156">In this arrangement, the client is responsible for creating or opening a structured storage file, while the server object is responsible for using that storage for its own data storage purposes.</span></span> <span data-ttu-id="69ff8-157">Questo può comportare l'oggetto server che crea le sottoarchiviazioni nello spazio di archiviazione fornito.</span><span class="sxs-lookup"><span data-stu-id="69ff8-157">This may involve the server object creating substorages in the storage that is given to it.</span></span> <span data-ttu-id="69ff8-158">In genere, l'oggetto server crea oggetti flusso nell'archivio.</span><span class="sxs-lookup"><span data-stu-id="69ff8-158">It usually involves the server object creating stream objects in the storage.</span></span> <span data-ttu-id="69ff8-159">L'uso dei flussi di archiviazione da parte di un documento è dettagliato nell'esempio **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="69ff8-159">COPaper's use of storage streams is detailed in the **StoClien** sample.</span></span>

<span data-ttu-id="69ff8-160">L'interfaccia [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) viene utilizzata sia dal client che dall'oggetto server per eseguire operazioni sui file.</span><span class="sxs-lookup"><span data-stu-id="69ff8-160">The [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is used by both client and server object to perform file operations.</span></span> <span data-ttu-id="69ff8-161">Viene usata l'implementazione dei file composti dell'architettura di archiviazione strutturata.</span><span class="sxs-lookup"><span data-stu-id="69ff8-161">The compound files implementation of the Structured Storage architecture is used.</span></span> <span data-ttu-id="69ff8-162">Le funzioni di servizio standard vengono utilizzate per le operazioni sui file composti.</span><span class="sxs-lookup"><span data-stu-id="69ff8-162">Standard service functions are used for operations on compound files.</span></span> <span data-ttu-id="69ff8-163">Ad esempio, la funzione [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) crea inizialmente un file composto e passa di nuovo un puntatore **IStorage** che può essere usato per modificare il file.</span><span class="sxs-lookup"><span data-stu-id="69ff8-163">For example, the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) function initially creates a compound file and passes back an **IStorage** pointer that can be used to manipulate the file.</span></span> <span data-ttu-id="69ff8-164">Questa particolare funzione viene chiamata in **StoClien**.</span><span class="sxs-lookup"><span data-stu-id="69ff8-164">This particular function is called in **StoClien**.</span></span> <span data-ttu-id="69ff8-165">L'interfaccia **IStorage** ottenuta viene passata come parametro a un documento per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="69ff8-165">The **IStorage** interface it obtains is passed as a parameter to COPaper for its use.</span></span> <span data-ttu-id="69ff8-166">L'oggetto Copaper non crea né apre i file composti in modo autonomo: usa le interfacce **IStorage** e [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) per lavorare nei file composti che vi sono assegnati.</span><span class="sxs-lookup"><span data-stu-id="69ff8-166">The COPaper object does not create or open compound files on its own: It uses the **IStorage** and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces to work in compound files that are given to it.</span></span>

<span data-ttu-id="69ff8-167">Queste interfacce [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) e [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) non sono implementate all'interno di **StoClien** o **StoServe**.</span><span class="sxs-lookup"><span data-stu-id="69ff8-167">These [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces are not implemented within **StoClien** or **StoServe**.</span></span> <span data-ttu-id="69ff8-168">Vengono implementate all'interno delle librerie COM.</span><span class="sxs-lookup"><span data-stu-id="69ff8-168">They are implemented within the COM libraries.</span></span> <span data-ttu-id="69ff8-169">Quando viene ottenuto un puntatore a una di queste interfacce, i relativi metodi vengono essenzialmente usati come set di servizi per operare su un file composto.</span><span class="sxs-lookup"><span data-stu-id="69ff8-169">When a pointer to one of these interfaces is obtained, their methods are essentially used as a set of services to operate on a compound file.</span></span>

 

 




