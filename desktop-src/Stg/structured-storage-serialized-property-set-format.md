---
title: Formato set di proprietà serializzato di archiviazione strutturata
description: I set di proprietà permanenti forniscono un'opzione per archiviare i dati all'interno di file system entità. Per crearli e gestirli, è consigliabile usare le interfacce IPropertySetStorage e IPropertyStorage descritte in proprietà e set di proprietà.
ms.assetid: f22abe40-535f-4178-9460-59bbe26ff178
keywords:
- Archiviazione strutturata Strctd STG, nozioni fondamentali, formato set di proprietà serializzato
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ea03d5ccab337897be801840080e83a6fa86880
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300072"
---
# <a name="structured-storage-serialized-property-set-format"></a><span data-ttu-id="a6b04-105">Formato set di proprietà serializzato di archiviazione strutturata</span><span class="sxs-lookup"><span data-stu-id="a6b04-105">Structured Storage Serialized Property Set Format</span></span>

<span data-ttu-id="a6b04-106">I set di proprietà permanenti forniscono un'opzione per archiviare i dati all'interno di file system entità.</span><span class="sxs-lookup"><span data-stu-id="a6b04-106">Persistent property sets provide an option to store data within file system entities.</span></span> <span data-ttu-id="a6b04-107">Per crearli e gestirli, è consigliabile usare le interfacce [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) e [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) descritte in [proprietà e set di proprietà](properties-and-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="a6b04-107">It is recommended that, to create and manage them, you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces described in [Properties and Property Sets](properties-and-property-sets.md).</span></span>

<span data-ttu-id="a6b04-108">I set di proprietà sono composti da una sezione con tag di valori, con la sezione identificata in modo univoco da un identificatore di formato (FMTID).</span><span class="sxs-lookup"><span data-stu-id="a6b04-108">Property sets are composed of a tagged section of values, with the section uniquely identified by a format identifier (FMTID).</span></span> <span data-ttu-id="a6b04-109">Ogni proprietà è costituita da un identificatore di proprietà e da un indicatore di tipo che rappresenta un valore.</span><span class="sxs-lookup"><span data-stu-id="a6b04-109">Every property consists of a property identifier and a type indicator that represents a value.</span></span> <span data-ttu-id="a6b04-110">Ogni valore archiviato in un set di proprietà ha un identificatore di proprietà univoco che distingue la proprietà.</span><span class="sxs-lookup"><span data-stu-id="a6b04-110">Each value stored in a property set has a unique property identifier that distinguishes the property.</span></span> <span data-ttu-id="a6b04-111">L'indicatore di tipo descrive la rappresentazione dei dati nel valore.</span><span class="sxs-lookup"><span data-stu-id="a6b04-111">The type indicator describes the representation of the data in the value.</span></span>

<span data-ttu-id="a6b04-112">Quando si utilizzano le interfacce [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) e [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , non è necessario gestire la struttura del formato del set di proprietà serializzato com.</span><span class="sxs-lookup"><span data-stu-id="a6b04-112">When you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, you do not have to handle the COM serialized property set format structure.</span></span> <span data-ttu-id="a6b04-113">Per ulteriori informazioni, vedere gli argomenti elencati di seguito:</span><span class="sxs-lookup"><span data-stu-id="a6b04-113">For more information, see the listed topics:</span></span>

<span data-ttu-id="a6b04-114">Tutti gli elementi dati all'interno di un set di proprietà vengono archiviati in una rappresentazione Intel, ovvero in ordine di byte little-endian.</span><span class="sxs-lookup"><span data-stu-id="a6b04-114">All data elements within a property set are stored in Intel representation (that is, in little-endian byte order).</span></span>

<span data-ttu-id="a6b04-115">COM definisce un formato di dati serializzato standard per i set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="a6b04-115">COM defines a standard, serialized data format for property sets.</span></span> <span data-ttu-id="a6b04-116">Quando si gestisce il formato serializzato e non con le interfacce, i set di proprietà hanno le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="a6b04-116">When handling the serialized format, and not with the interfaces, property sets have the following characteristics:</span></span>

-   <span data-ttu-id="a6b04-117">I set di proprietà consentono a diverse applicazioni di creare set di proprietà indipendenti per gestire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a6b04-117">Property sets allow for different applications to create their own independent property sets to serve the application.</span></span>
-   <span data-ttu-id="a6b04-118">I set di proprietà possono essere archiviati in una singola istanza di [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) o in un'istanza di [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) contenente più flussi.</span><span class="sxs-lookup"><span data-stu-id="a6b04-118">Property sets can be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance that contains multiple streams.</span></span> <span data-ttu-id="a6b04-119">I set di proprietà sono semplicemente un altro tipo di dati che può essere archiviato in molte forme diverse di un'archiviazione in memoria o su disco.</span><span class="sxs-lookup"><span data-stu-id="a6b04-119">Property sets are simply another data type that can be stored in many different forms of an in-memory or on-disk storage.</span></span> <span data-ttu-id="a6b04-120">Per altre informazioni e le convenzioni consigliate per la creazione del nome di stringa per l'oggetto di archiviazione, vedere [convenzioni di denominazione degli oggetti di archiviazione](storage-object-naming-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="a6b04-120">For more information and recommended conventions for creating the string name for the storage object, see [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
-   <span data-ttu-id="a6b04-121">I set di proprietà consentono di includere un dizionario di nomi visualizzati che descrivono il contenuto.</span><span class="sxs-lookup"><span data-stu-id="a6b04-121">Property sets allow for a dictionary of display names to be included that describe the contents.</span></span> <span data-ttu-id="a6b04-122">È consigliabile un set di convenzioni per la scelta dei nomi di proprietà.</span><span class="sxs-lookup"><span data-stu-id="a6b04-122">A set of conventions for choosing property names is recommended.</span></span> <span data-ttu-id="a6b04-123">Per altre informazioni su questo dizionario facoltativo, vedere [identificatori di proprietà riservati](reserved-property-identifiers.md), incluso [ID proprietà 0](/windows/desktop/Stg/reserved-property-identifiers).</span><span class="sxs-lookup"><span data-stu-id="a6b04-123">For more information about this optional dictionary, see [Reserved Property Identifiers](reserved-property-identifiers.md), including [Property ID 0](/windows/desktop/Stg/reserved-property-identifiers).</span></span>

<span data-ttu-id="a6b04-124">Il flusso del set di proprietà è suddiviso in tre parti principali:</span><span class="sxs-lookup"><span data-stu-id="a6b04-124">The property set stream is divided into three major parts:</span></span>

-   <span data-ttu-id="a6b04-125">Intestazione</span><span class="sxs-lookup"><span data-stu-id="a6b04-125">Header</span></span>
-   <span data-ttu-id="a6b04-126">Coppia FORMATID/offset</span><span class="sxs-lookup"><span data-stu-id="a6b04-126">FORMATID/offset pair</span></span>
-   <span data-ttu-id="a6b04-127">Sezione che contiene i valori effettivi del set di proprietà</span><span class="sxs-lookup"><span data-stu-id="a6b04-127">Section containing the actual property set values</span></span>

<span data-ttu-id="a6b04-128">La lunghezza complessiva del flusso del set di proprietà deve essere minore o uguale a 256K.</span><span class="sxs-lookup"><span data-stu-id="a6b04-128">The overall length of the property set stream must be less than or equal to 256K.</span></span> <span data-ttu-id="a6b04-129">Le sezioni seguenti, l' [intestazione del set di proprietà](property-set-header.md), la [coppia identificatore/offset di formato](format-identifier-offset-pair.md)e la [sezione](section.md) (inclusi gli [identificatori di proprietà/coppie di offset](property-identifiers-offset-pairs.md)), con argomenti di supporto, descrivono i singoli componenti che compongono il formato dati del set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="a6b04-129">The following sections, [Property Set Header](property-set-header.md), [Format Identifier/Offset Pair](format-identifier-offset-pair.md), and [Section](section.md) (including [Property Identifiers/Offset Pairs](property-identifiers-offset-pairs.md)), with supporting topics, describe the individual components that compose the property-set data format.</span></span>

> [!Note]  
> <span data-ttu-id="a6b04-130">Nelle versioni precedenti di questo documento sono descritte le estensioni al flusso del set di proprietà con più di una sezione consentita, ma che è stata riveduta per fornire una sezione nel flusso di proprietà.</span><span class="sxs-lookup"><span data-stu-id="a6b04-130">Previous versions of this document described extensions to the property set stream with more than one section allowed, but that has been revised to provide for one section in the property stream.</span></span> <span data-ttu-id="a6b04-131">L'unica eccezione è rappresentata [dai set di proprietà DocumentSummaryInformation e UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="a6b04-131">The one exception is [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span>

 

 

 