---
title: Oggetti di archiviazione e di flusso per un set di proprietà
description: Il programmatore specifica se un set di proprietà viene archiviato in una risorsa di archiviazione o in un flusso quando viene creato il set di proprietà.
ms.assetid: d0ca649a-d405-4c34-af02-9c2ca8b2790e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4ebd5d03c3b17e02aa47a7a859576b4cc04607a
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/08/2020
ms.locfileid: "104047517"
---
# <a name="storage-and-stream-objects-for-a-property-set"></a><span data-ttu-id="d15c6-103">Oggetti di archiviazione e di flusso per un set di proprietà</span><span class="sxs-lookup"><span data-stu-id="d15c6-103">Storage and Stream Objects for a Property Set</span></span>

<span data-ttu-id="d15c6-104">Il programmatore specifica se un set di proprietà viene archiviato in una risorsa di archiviazione o in un flusso quando viene creato il set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="d15c6-104">The programmer specifies whether a property set is stored in a storage or a stream when the property set is created.</span></span> <span data-ttu-id="d15c6-105">Il \_ valore di enumerazione PROPSETFLAG non semplice, passato nel parametro *grfFlags* al metodo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) , indica this.</span><span class="sxs-lookup"><span data-stu-id="d15c6-105">The PROPSETFLAG\_NONSIMPLE enumeration value, passed in the *grfFlags* parameter to the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method, indicates this.</span></span> <span data-ttu-id="d15c6-106">L'impostazione della posizione in cui viene archiviato il set di proprietà fornisce controlli dell'applicazione appropriati per l'interoperabilità completa tramite l'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) con il set di proprietà com.</span><span class="sxs-lookup"><span data-stu-id="d15c6-106">Setting where the property set is stored provides proper application controls to fully interoperate through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface with the COM property set.</span></span>

<span data-ttu-id="d15c6-107">Se \_ viene impostato il flag PROPSETFLAG non semplice, il set di proprietà viene archiviato in un oggetto di archiviazione e i valori di proprietà non semplici possono essere scritti.</span><span class="sxs-lookup"><span data-stu-id="d15c6-107">If the PROPSETFLAG\_NONSIMPLE flag is set, the property set is stored in a storage object, and nonsimple property values can be written to it.</span></span> <span data-ttu-id="d15c6-108">I valori non semplici includono valori con un **VarType** di \_ archiviazione VT, un \_ flusso VT, un \_ oggetto archiviato VT o un oggetto con \_ \_ flusso VT \_ .</span><span class="sxs-lookup"><span data-stu-id="d15c6-108">Nonsimple values include values with a **VARTYPE** of VT\_STORAGE, VT\_STREAM, VT\_STORED\_OBJECT, or VT\_STREAMED\_OBJECT.</span></span> <span data-ttu-id="d15c6-109">Per ulteriori informazioni sui valori **VarType** e su come utilizzarli, vedere la struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="d15c6-109">For more information about **VARTYPE** values and how to use them, see the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="d15c6-110">Se il \_ flag PROPSETFLAG non semplice non è impostato, nel set di proprietà è possibile scrivere solo valori semplici.</span><span class="sxs-lookup"><span data-stu-id="d15c6-110">If the PROPSETFLAG\_NONSIMPLE flag is not set, only simple values can be written to the property set.</span></span>

<span data-ttu-id="d15c6-111">Nell'oggetto di archiviazione di un set di proprietà non semplice, viene creato un flusso denominato contenuto.</span><span class="sxs-lookup"><span data-stu-id="d15c6-111">In the storage object of a nonsimple property set, a stream is created named Contents.</span></span> <span data-ttu-id="d15c6-112">Questo è il flusso primario del set di proprietà e include tutti i valori di proprietà semplici.</span><span class="sxs-lookup"><span data-stu-id="d15c6-112">This is the primary stream of the property set, and holds all simple property values.</span></span> <span data-ttu-id="d15c6-113">I valori di proprietà non semplici (flussi e archivi) vengono archiviati nell'oggetto di archiviazione principale del set di proprietà come sottoflussi e archivi.</span><span class="sxs-lookup"><span data-stu-id="d15c6-113">Nonsimple property values (streams and storages) are stored under the main storage object of the property set as substreams and storages.</span></span> <span data-ttu-id="d15c6-114">Ovvero, questi valori non semplici vengono archiviati come elementi di pari livello nel flusso di contenuti.</span><span class="sxs-lookup"><span data-stu-id="d15c6-114">That is, these nonsimple values are stored as siblings to the Contents stream.</span></span> <span data-ttu-id="d15c6-115">Il nome dei flussi e delle archiviazioni di pari livello è determinato dall'implementazione e viene archiviato nel flusso di contenuto in modo analogo a come viene archiviata una proprietà stringa semplice.</span><span class="sxs-lookup"><span data-stu-id="d15c6-115">The name of the sibling streams and storages is determined by the implementation, and stored in the Contents stream similar to the way a simple string property is stored.</span></span>

 

 