---
title: Implementazione di IPropertyStorage-Compound file
description: L'implementazione COM dell'architettura di archiviazione strutturata è denominata file composti.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage Strctd STG, implementazioni, file composto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103872650"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="119f5-104">Implementazione di IPropertyStorage-Compound file</span><span class="sxs-lookup"><span data-stu-id="119f5-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="119f5-105">L'implementazione COM dell'architettura di archiviazione strutturata è denominata [file composti](istorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="119f5-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="119f5-106">Gli oggetti di archiviazione implementati nei file composti includono un'implementazione di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), l'interfaccia che gestisce un singolo set di proprietà permanenti e [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), l'interfaccia che gestisce i gruppi di set di proprietà permanenti.</span><span class="sxs-lookup"><span data-stu-id="119f5-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="119f5-107">Per ulteriori informazioni sull'interfaccia **IPropertyStorage** , vedere [considerazioni sull'archiviazione delle proprietà](property-storage-considerations.md)e di **IPropertyStorage** .</span><span class="sxs-lookup"><span data-stu-id="119f5-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="119f5-108">Per ottenere un puntatore all'implementazione del file composto di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), chiamare [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) per creare un nuovo oggetto file composto o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) per aprire un oggetto file composto creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="119f5-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="119f5-109">Nel caso di **StgCreateStorageEx**, il parametro *stgfmt* deve essere impostato su stgfmt \_ storage.</span><span class="sxs-lookup"><span data-stu-id="119f5-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="119f5-110">Nel caso di **StgOpenStorageEx**, il parametro *stgfmt* deve essere impostato su stgfmt \_ storage o stgfmt \_ any.</span><span class="sxs-lookup"><span data-stu-id="119f5-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="119f5-111">In entrambi i casi, il parametro *riid* deve essere impostato su IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="119f5-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="119f5-112">Entrambe le funzioni forniscono un puntatore all'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="119f5-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="119f5-113">Chiamando il metodo [**create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) o [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) dell'interfaccia, si otterrà un puntatore all'interfaccia **IPropertyStorage** , che è possibile usare per chiamare uno dei metodi.</span><span class="sxs-lookup"><span data-stu-id="119f5-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="119f5-114">Un metodo alternativo per ottenere un puntatore all'implementazione del file composto di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) consiste nel chiamare le funzioni [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) e [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) precedenti oppure per specificare un parametro *riid* di IID \_ IStorage per la funzione [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="119f5-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="119f5-115">In entrambi i casi, viene restituito un puntatore all'interfaccia [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="119f5-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="119f5-116">Con i set di proprietà permanenti, chiamare [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per l'interfaccia **IPropertySetStorage** , specificando il nome definito dall'intestazione per l'IID dell'identificatore di interfaccia (IID) \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="119f5-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="119f5-117">Utilizzo</span><span class="sxs-lookup"><span data-stu-id="119f5-117">When to Use</span></span>

<span data-ttu-id="119f5-118">Utilizzare [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) per gestire le proprietà all'interno di un singolo set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="119f5-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="119f5-119">I metodi supportano la lettura, la scrittura e l'eliminazione di entrambe le proprietà e i nomi di stringa facoltativi che possono essere associati a identificatori di proprietà.</span><span class="sxs-lookup"><span data-stu-id="119f5-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="119f5-120">Altri metodi supportano le operazioni di commit e ripristino standard.</span><span class="sxs-lookup"><span data-stu-id="119f5-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="119f5-121">È inoltre disponibile un metodo che consente di impostare gli orari associati all'archiviazione delle proprietà e un altro che consente l'assegnazione di un CLSID che può essere utilizzato per associare altro codice, ad esempio il codice dell'interfaccia utente, con il set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="119f5-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="119f5-122">La chiamata al metodo [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) fornisce un puntatore all'implementazione del file composto di [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), che consente di enumerare le proprietà nel set.</span><span class="sxs-lookup"><span data-stu-id="119f5-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="119f5-123">Se si ottiene un puntatore a [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) chiamando [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) in una risorsa di archiviazione con set di proprietà in modalità semplice, i metodi **IPropertyStorage** rispettano le regole dei flussi in modalità semplice.</span><span class="sxs-lookup"><span data-stu-id="119f5-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="119f5-124">La modalità di archiviazione del set di proprietà è semplice se è stata ottenuta per un file che è stato creato o aperto con il \_ flag semplice STGM.</span><span class="sxs-lookup"><span data-stu-id="119f5-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="119f5-125">In questo caso, non è sempre possibile rendere il flusso sottostante più grande e non è possibile sostituire le proprietà esistenti con proprietà più grandi.</span><span class="sxs-lookup"><span data-stu-id="119f5-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="119f5-126">Per altre informazioni, vedere [IPropertySetStorage-implementazione del file composto](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="119f5-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="119f5-127">IPropertyStorage e Caching</span><span class="sxs-lookup"><span data-stu-id="119f5-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="119f5-128">L'implementazione del file composto di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) memorizza nella cache i set di proprietà aperti in memoria per migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="119f5-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="119f5-129">Di conseguenza, le modifiche apportate a un set di proprietà non vengono scritte nel file composto fino a quando non vengono chiamati i metodi di [**commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) o di **rilascio** (ultimo riferimento).</span><span class="sxs-lookup"><span data-stu-id="119f5-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="119f5-130">Set di proprietà in modalità semplice</span><span class="sxs-lookup"><span data-stu-id="119f5-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="119f5-131">Un oggetto di archiviazione proprietà è in modalità semplice se viene creato da un oggetto di archiviazione del set di proprietà in modalità semplice.</span><span class="sxs-lookup"><span data-stu-id="119f5-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="119f5-132">Ad esempio, un oggetto di archiviazione del set di proprietà è in modalità semplice se è stato ottenuto dalla funzione [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) con il \_ flag STGM Simple impostato nel parametro *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="119f5-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="119f5-133">Si noti che "Simple Mode" non è correlato a "Simple Property Sets".</span><span class="sxs-lookup"><span data-stu-id="119f5-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="119f5-134">Un set di proprietà è semplice se viene creato chiamando [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) con il flag PROPSETFLAG non \_ semplice impostato nel parametro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="119f5-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="119f5-135">Per altre informazioni sui set di proprietà semplici e non semplici, vedere [oggetti di archiviazione e di flusso per un set di proprietà](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="119f5-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="119f5-136">Quando viene creato un oggetto di archiviazione della proprietà in modalità semplice, non sono previste restrizioni per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="119f5-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="119f5-137">Quando viene aperto un oggetto di archiviazione proprietà in modalità semplice esistente, l'oggetto flusso sottostante che archivia il set di proprietà non può essere aumentato.</span><span class="sxs-lookup"><span data-stu-id="119f5-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="119f5-138">Di conseguenza, non è sempre possibile modificare tale oggetto di archiviazione proprietà se la modifica richiede un flusso più grande.</span><span class="sxs-lookup"><span data-stu-id="119f5-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="119f5-139">Formati di set di proprietà</span><span class="sxs-lookup"><span data-stu-id="119f5-139">Property Set Formats</span></span>

<span data-ttu-id="119f5-140">L'implementazione del file composto di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supporta sia la versione 0 che i formati di serializzazione del set di proprietà versione 1.</span><span class="sxs-lookup"><span data-stu-id="119f5-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="119f5-141">Il formato versione 1 è supportato nei computer che eseguono Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="119f5-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="119f5-142">Per ulteriori informazioni, vedere [serializzazione del set di proprietà](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="119f5-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="119f5-143">I set di proprietà vengono creati nel formato versione 0 e rimangono in tale formato a meno che non vengano richieste nuove funzionalità.</span><span class="sxs-lookup"><span data-stu-id="119f5-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="119f5-144">In tal caso, il formato verrà aggiornato alla versione 1.</span><span class="sxs-lookup"><span data-stu-id="119f5-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="119f5-145">Se, ad esempio, viene creato un set di proprietà con il \_ flag predefinito PROPSETFLAG, il formato è la versione 0.</span><span class="sxs-lookup"><span data-stu-id="119f5-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="119f5-146">Fino a quando i tipi di proprietà conformi al formato versione 0 vengono scritti e letti dal set di proprietà, il set di proprietà rimane nel formato versione 0.</span><span class="sxs-lookup"><span data-stu-id="119f5-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="119f5-147">Se un tipo di proprietà della versione 1 viene scritto nel set di proprietà, il set di proprietà viene aggiornato automaticamente alla versione 1.</span><span class="sxs-lookup"><span data-stu-id="119f5-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="119f5-148">Successivamente, il set di proprietà non può più essere letto dalle implementazioni che riconoscono solo la versione 0.</span><span class="sxs-lookup"><span data-stu-id="119f5-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="119f5-149">Tipi IPropertyStorage e Variant</span><span class="sxs-lookup"><span data-stu-id="119f5-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="119f5-150">L'implementazione del file composito di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) non supporta i tipi varianti VT \_ Unknown o VT \_ Dispatch nel membro **VT** della struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="119f5-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="119f5-151">Nella tabella seguente sono elencati i tipi Variant supportati all'interno di SafeArray; ovvero, questi valori possono essere combinati con \_ una matrice VT nel membro **VT** della struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="119f5-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="119f5-152">Tipi Variant supportati all'interno di SafeArray mediante l'implementazione del file composto di IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="119f5-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="119f5-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="119f5-153">VT\_I1</span></span>

<span data-ttu-id="119f5-154">\_Ui1 VT</span><span class="sxs-lookup"><span data-stu-id="119f5-154">VT\_UI1</span></span>

<span data-ttu-id="119f5-155">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="119f5-155">VT\_I2</span></span>

<span data-ttu-id="119f5-156">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="119f5-156">VT\_UI2</span></span>

<span data-ttu-id="119f5-157">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="119f5-157">VT\_I4</span></span>

<span data-ttu-id="119f5-158">\_UI4 VT</span><span class="sxs-lookup"><span data-stu-id="119f5-158">VT\_UI4</span></span>

<span data-ttu-id="119f5-159">\_int VT</span><span class="sxs-lookup"><span data-stu-id="119f5-159">VT\_INT</span></span>

<span data-ttu-id="119f5-160">\_uint VT</span><span class="sxs-lookup"><span data-stu-id="119f5-160">VT\_UINT</span></span>

<span data-ttu-id="119f5-161">\_R4 VT</span><span class="sxs-lookup"><span data-stu-id="119f5-161">VT\_R4</span></span>

<span data-ttu-id="119f5-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="119f5-162">VT\_R8</span></span>

<span data-ttu-id="119f5-163">\_CY VT</span><span class="sxs-lookup"><span data-stu-id="119f5-163">VT\_CY</span></span>

<span data-ttu-id="119f5-164">\_Data VT</span><span class="sxs-lookup"><span data-stu-id="119f5-164">VT\_DATE</span></span>

<span data-ttu-id="119f5-165">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="119f5-165">VT\_BSTR</span></span>

<span data-ttu-id="119f5-166">\_bool VT</span><span class="sxs-lookup"><span data-stu-id="119f5-166">VT\_BOOL</span></span>

<span data-ttu-id="119f5-167">\_decimale VT</span><span class="sxs-lookup"><span data-stu-id="119f5-167">VT\_DECIMAL</span></span>

<span data-ttu-id="119f5-168">\_errore VT</span><span class="sxs-lookup"><span data-stu-id="119f5-168">VT\_ERROR</span></span>

<span data-ttu-id="119f5-169">\_variante VT</span><span class="sxs-lookup"><span data-stu-id="119f5-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="119f5-170">Quando \_ la variante VT viene combinata con \_ la matrice VT, il SAFEARRAY stesso include le strutture [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="119f5-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="119f5-171">Tuttavia, i tipi di questi elementi devono essere ricavati dall'elenco precedente, non possono essere \_ varianti VT e non possono includere gli \_ indicatori del vettore VT, dell'array VT o del \_ \_ ByRef VT.</span><span class="sxs-lookup"><span data-stu-id="119f5-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="119f5-172">Metodi IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="119f5-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="119f5-173">L'implementazione del file composto di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supporta i metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="119f5-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="119f5-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="119f5-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-175">Legge le proprietà specificate nella matrice *rgpspec* e fornisce i valori di tutte le proprietà valide nella matrice *rgvar* di PROPVARIANTs.</span><span class="sxs-lookup"><span data-stu-id="119f5-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="119f5-176">Nell'implementazione del file composto COM, gli identificatori di proprietà duplicati che fanno riferimento ai tipi di flusso o di archiviazione generano più chiamate a [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) o [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) e l'esito positivo o negativo di **ReadMultiple** dipende dalla capacità dell'implementazione di archiviazione sottostante di condividere le operazioni di apertura.</span><span class="sxs-lookup"><span data-stu-id="119f5-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="119f5-177">Poiché in un file composto \_ è stata forzata la condivisione \_ esclusiva, più tentativi di apertura non riusciranno.</span><span class="sxs-lookup"><span data-stu-id="119f5-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="119f5-178">Non è possibile aprire lo stesso oggetto di archiviazione più di una volta dallo stesso archivio padre.</span><span class="sxs-lookup"><span data-stu-id="119f5-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="119f5-179">\_ \_ È necessario specificare il flag STGM Share Exclusive.</span><span class="sxs-lookup"><span data-stu-id="119f5-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="119f5-180">Inoltre, per garantire un'operazione thread-safe se la stessa proprietà con valori di flusso o di archiviazione viene richiesta più volte tramite lo stesso puntatore [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) nell'implementazione del file composto com, l'operazione di apertura avrà esito positivo o negativo a seconda che la proprietà sia già aperta e che il file system sottostante gestisca più aperture di un flusso o di un'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="119f5-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="119f5-181">Pertanto, l'operazione **ReadMultiple** su una proprietà con valori di flusso o di archiviazione restituisce sempre una chiamata a [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)o [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), che passa l'accesso (STGM \_ ReadWrite e così via) e i flag di condivisione (STGM \_ share \_ Exclusive e così via) specificati al momento dell'apertura o della creazione del set di proprietà originale.</span><span class="sxs-lookup"><span data-stu-id="119f5-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="119f5-182">Se il metodo ha esito negativo, i valori scritti in *rgvar* non \[ \] sono definiti.</span><span class="sxs-lookup"><span data-stu-id="119f5-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="119f5-183">Se alcune proprietà con valori di flusso o di archiviazione vengono aperte correttamente, ma si verifica un errore prima del completamento dell'esecuzione, questi devono essere rilasciati prima che il metodo venga restituito.</span><span class="sxs-lookup"><span data-stu-id="119f5-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="119f5-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-185">Scrive le proprietà specificate nella matrice *rgpspec* \[ \] , assegnando loro i tag e i valori [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) specificati in *rgvar* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="119f5-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="119f5-186">Alle proprietà già esistenti vengono assegnati i valori **PROPVARIANT** specificati.</span><span class="sxs-lookup"><span data-stu-id="119f5-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="119f5-187">Vengono create proprietà che attualmente non esistono.</span><span class="sxs-lookup"><span data-stu-id="119f5-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::D eleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="119f5-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-189">Elimina le proprietà specificate in *rgpspec* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="119f5-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="119f5-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage:: ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="119f5-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-191">Legge i nomi di stringa esistenti associati agli ID di proprietà specificati nella matrice *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="119f5-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage:: WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="119f5-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-193">Assegna i nomi di stringa specificati nella matrice *rglpwstrName* agli ID di proprietà specificati nella matrice *rgpropid* .</span><span class="sxs-lookup"><span data-stu-id="119f5-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::D eletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="119f5-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-195">Elimina i nomi di proprietà per le proprietà specificate nella matrice *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="119f5-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage:: seclasse**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="119f5-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-197">Imposta il **CLSID** del flusso del set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="119f5-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="119f5-198">Nell'implementazione del file composto, impostando il CLSID su un set di proprietà non semplice, che può contenere legalmente proprietà con valori di archiviazione o flusso, come descritto in [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), imposta anche il CLSID sulla sottoarchiviazione sottostante in modo che sia possibile ottenerlo tramite una chiamata a [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span><span class="sxs-lookup"><span data-stu-id="119f5-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="119f5-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="119f5-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-200">Per i set di proprietà semplici e non semplici, Scarica l'immagine della memoria del set di proprietà nell'archivio sottostante.</span><span class="sxs-lookup"><span data-stu-id="119f5-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="119f5-201">Inoltre, per i set di proprietà non semplici in modalità transazionale, questo metodo esegue un commit (come in [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) nella risorsa di archiviazione che contiene il set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="119f5-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage:: Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="119f5-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-203">Solo per set di proprietà non semplici, chiama il metodo [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) dell'archiviazione sottostante e riapre il flusso "Contents".</span><span class="sxs-lookup"><span data-stu-id="119f5-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="119f5-204">Per i set di proprietà semplici, questa interfaccia restituisce sempre \_ OK.</span><span class="sxs-lookup"><span data-stu-id="119f5-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="119f5-205">I set di proprietà non semplici sono quelli creati usando il flag PROPSETFLAG non \_ semplice nel metodo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="119f5-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="119f5-206">Per altre informazioni, vedere [oggetti di archiviazione e di flusso per un set di proprietà](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="119f5-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="119f5-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="119f5-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-208">Costruisce un'istanza di [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), i metodi di cui è possibile chiamare per enumerare le strutture [**Campo STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) che forniscono informazioni su ognuna delle proprietà nel set.</span><span class="sxs-lookup"><span data-stu-id="119f5-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="119f5-209">Questa implementazione crea una matrice in cui viene letto l'intero set di proprietà e che può essere condiviso quando viene chiamato **IEnumSTATPROPSTG:: Clone** .</span><span class="sxs-lookup"><span data-stu-id="119f5-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="119f5-210">Le modifiche apportate al set di proprietà non vengono riflesse in un'istanza di **IEnumSTATPROPSTG** aperta.</span><span class="sxs-lookup"><span data-stu-id="119f5-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="119f5-211">Per visualizzare tali modifiche, è necessario costruire una nuova istanza di questo enumeratore.</span><span class="sxs-lookup"><span data-stu-id="119f5-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="119f5-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-213">Compila i membri di una struttura [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , che contiene i dati relativi al set di proprietà nel suo complesso.</span><span class="sxs-lookup"><span data-stu-id="119f5-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="119f5-214">Al ritorno, fornisce un puntatore alla struttura.</span><span class="sxs-lookup"><span data-stu-id="119f5-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="119f5-215">Per i set di archiviazione non semplici, questa implementazione chiama [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (o [**IStream:: stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) per ottenere gli orari dall'archiviazione o dal flusso sottostante.</span><span class="sxs-lookup"><span data-stu-id="119f5-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="119f5-216">Per i set di archiviazione semplici, non vengono mantenuti orari.</span><span class="sxs-lookup"><span data-stu-id="119f5-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="119f5-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage:: setimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="119f5-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="119f5-218">Solo per set di proprietà non semplici, imposta le ore supportate dall'archiviazione sottostante.</span><span class="sxs-lookup"><span data-stu-id="119f5-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="119f5-219">L'implementazione dell'archiviazione file composta supporta tutte e tre le operazioni: modifica, accesso e creazione.</span><span class="sxs-lookup"><span data-stu-id="119f5-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="119f5-220">Questa implementazione di [**Timers**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) chiama il metodo [**IStorage:: SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) dell'archiviazione sottostante per recuperare tali orari.</span><span class="sxs-lookup"><span data-stu-id="119f5-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="119f5-221">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="119f5-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="119f5-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="119f5-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="119f5-223">**IStorage:: SetElementTimes**</span><span class="sxs-lookup"><span data-stu-id="119f5-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 