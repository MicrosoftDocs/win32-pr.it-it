---
title: File composti asincroni
description: I file composti asincroni, l'implementazione fornita dal sistema di archiviazione asincrona, consentono il download efficiente di file composti da Internet in generale e il Web in particolare.
ms.assetid: 6cad074e-07a8-434f-a402-e29cb66a1a18
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04de2162b50283b12bc8deed6ec908d92e7584d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399502"
---
# <a name="asynchronous-compound-files"></a><span data-ttu-id="5e033-103">File composti asincroni</span><span class="sxs-lookup"><span data-stu-id="5e033-103">Asynchronous Compound Files</span></span>

<span data-ttu-id="5e033-104">I file composti asincroni, l'implementazione fornita dal sistema di archiviazione asincrona, consentono il download efficiente di file composti da Internet in generale e il Web in particolare.</span><span class="sxs-lookup"><span data-stu-id="5e033-104">Asynchronous Compound Files, the system-provided implementation of asynchronous storage, enables the efficient downloading of compound files from the Internet in general and the Web in particular.</span></span> <span data-ttu-id="5e033-105">Il diagramma seguente illustra l'architettura di base dei file composti asincroni.</span><span class="sxs-lookup"><span data-stu-id="5e033-105">The basic architecture of Asynchronous Compound Files is shown in the following diagram.</span></span>

![architettura di base dei file composti asincroni](images/asy-stor.png)

<span data-ttu-id="5e033-107">L'implementazione asincrona dei file composti può funzionare con nuovi tipi di moniker asincroni che conoscono i protocolli Internet e possono essere associati a un oggetto identificato da un URL.</span><span class="sxs-lookup"><span data-stu-id="5e033-107">The Asynchronous Compound Files implementation can work with new asynchronous moniker types that understand Internet protocols and can bind to an object identified by a URL.</span></span> <span data-ttu-id="5e033-108">Tale moniker restituisce un puntatore [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) o [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) asincrono dalla chiamata del client a [**IMoniker:: BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="5e033-108">Such a moniker would return an asynchronous [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) or [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pointer from the client's call to [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span></span>

<span data-ttu-id="5e033-109">I file composti in generale vengono implementati sopra un oggetto matrice di byte, un'astrazione di un file che rappresenta i dati di un oggetto come matrice di byte flat.</span><span class="sxs-lookup"><span data-stu-id="5e033-109">Compound Files in general are implemented on top of a byte array object, an abstraction of a file that represents an object's data as a flat byte array.</span></span> <span data-ttu-id="5e033-110">L'oggetto matrice di byte ne espone la funzionalità tramite l'interfaccia [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) .</span><span class="sxs-lookup"><span data-stu-id="5e033-110">The byte array object exposes its functionality through the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) interface.</span></span> <span data-ttu-id="5e033-111">Se una matrice di byte supporta l'archiviazione asincrona non bloccata, restituisce E in \_ sospeso all'implementazione del file composto, che a sua volta propaga di nuovo l'errore al chiamante.</span><span class="sxs-lookup"><span data-stu-id="5e033-111">If a byte array supports nonblocking asynchronous storage, it returns E\_PENDING to the compound-file implementation, which in turn propagates the error back to the caller.</span></span>

<span data-ttu-id="5e033-112">Per tenere traccia dei dati disponibili durante il download, una matrice di byte che supporta l'archiviazione asincrona espone l'interfaccia [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) su un oggetto wrapper fornito dal sistema in modo specifico per questo scopo.</span><span class="sxs-lookup"><span data-stu-id="5e033-112">To keep track of the data available during a download, a byte array that supports asynchronous storage exposes the [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface on a wrapper object provided by the system specifically for this purpose.</span></span> <span data-ttu-id="5e033-113">Il codice di download fornito da un moniker asincrono chiama questa interfaccia per riempire la matrice di byte in modo asincrono, perché i dati sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="5e033-113">The downloading code provided by an asynchronous moniker calls this interface to fill the byte array asynchronously, as data is available.</span></span> <span data-ttu-id="5e033-114">L'oggetto wrapper espone anche un'interfaccia **ILockBytes** , che viene usata dall'implementazione asincrona dei file composti per leggere e scrivere dati da e verso la matrice.</span><span class="sxs-lookup"><span data-stu-id="5e033-114">The wrapper object also exposes an **ILockBytes** interface, which the Asynchronous Compound Files implementation uses to read and write data from and to the array.</span></span>

<span data-ttu-id="5e033-115">Gli oggetti di archiviazione e di flusso asincroni forniscono un punto di connessione per l'interfaccia [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) , implementata dal codice di download del moniker asincrono.</span><span class="sxs-lookup"><span data-stu-id="5e033-115">Asynchronous storage and stream objects provide a connection point for the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface, which is implemented by the asynchronous moniker's downloading code.</span></span> <span data-ttu-id="5e033-116">L'implementazione asincrona dei file composti chiama **IProgressNotify** per fornire al Downloader informazioni sullo stato dell'operazione di download.</span><span class="sxs-lookup"><span data-stu-id="5e033-116">The Asynchronous Compound Files implementation calls **IProgressNotify** to provide the downloader with information about the status of the downloading operation.</span></span>

 

 