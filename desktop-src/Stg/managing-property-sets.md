---
title: Gestione dei set di proprietà
description: Un set di proprietà permanenti contiene dati correlati come proprietà.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:
- Gestione dei set di proprietà
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af3f9862d3074a5221bf1d5d975754486a562f87
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106299987"
---
# <a name="managing-property-sets"></a><span data-ttu-id="b8bb9-104">Gestione dei set di proprietà</span><span class="sxs-lookup"><span data-stu-id="b8bb9-104">Managing Property Sets</span></span>

<span data-ttu-id="b8bb9-105">Un set di proprietà permanenti contiene dati correlati come proprietà.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-105">A persistent property set contains related data as properties.</span></span> <span data-ttu-id="b8bb9-106">Ogni set di proprietà viene identificato con un FMTID e un identificatore univoco globale (GUID) che consente alle applicazioni di accedere al set di proprietà per identificare il set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-106">Each property set is identified with an FMTID, and a globally unique identifier (GUID) that enables applications, accessing the property set, to identify the property set.</span></span> <span data-ttu-id="b8bb9-107">Tramite questa identificazione, l'applicazione interpreta le proprietà contenute nel set.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-107">Through this identification, the application interprets the properties that the set contains.</span></span>

<span data-ttu-id="b8bb9-108">Ad esempio, le proprietà di formattazione dei caratteri in un elaboratore di testo o gli attributi di rendering di un elemento in un programma di disegno sono set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-108">For example, the character-formatting properties in a word processor or the rendering attributes of an element in a drawing program are property sets.</span></span>

<span data-ttu-id="b8bb9-109">COM definisce l'interfaccia [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) per semplificare la gestione dei set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-109">COM defines the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to facilitate management of property sets.</span></span> <span data-ttu-id="b8bb9-110">Tramite i metodi di questa interfaccia, è possibile creare un nuovo set di proprietà oppure aprire o eliminare un set di proprietà esistente.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-110">Through the methods of this interface, you can create a new property set, or open or delete an existing property set.</span></span> <span data-ttu-id="b8bb9-111">Fornisce inoltre un metodo che crea un enumeratore e fornisce un puntatore alla relativa interfaccia [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="b8bb9-111">In addition, it provides a method that creates an enumerator and supplies a pointer to its [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface.</span></span> <span data-ttu-id="b8bb9-112">È possibile chiamare i metodi di questa interfaccia per enumerare le strutture [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) sull'oggetto, in modo da fornire informazioni su tutti i set di proprietà nell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-112">You can call the methods of this interface to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures on your object, which will provide information about all of the property sets on the object.</span></span>

<span data-ttu-id="b8bb9-113">Quando si crea o si apre un'istanza di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), è simile all'apertura di un oggetto che supporta [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) o [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), perché è necessario specificare la modalità di archiviazione in cui si apre l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-113">When you create or open an instance of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), it is similar to opening an object that supports [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), because you need to specify the storage mode in which you are opening the interface.</span></span> <span data-ttu-id="b8bb9-114">Per **IStorage** sono inclusi la modalità di transazione, la modalità di lettura/scrittura e la modalità di condivisione.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-114">For **IStorage**, these include the transaction mode, the read/write mode, and the sharing mode.</span></span>

<span data-ttu-id="b8bb9-115">Quando si crea un set di proprietà con una chiamata a [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), specificare se il set di proprietà deve essere semplice o non semplice.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-115">When you create a property set with a call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), specify whether the property set is to be simple or nonsimple.</span></span> <span data-ttu-id="b8bb9-116">Un set di proprietà semplice contiene tipi che possono essere scritti completamente all'interno del flusso di set di proprietà, che deve avere una dimensione limitata e che non può essere superiore a 256 KB in Windows NT 4,0 e versioni precedenti o 1 MB in Windows 2000, Windows XP e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-116">A simple property set contains types that can be written fully within the property set stream, which is intended to be limited in size, and can be no larger than 256 KB in Windows NT 4.0 and earlier, or 1 MB in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="b8bb9-117">Tuttavia, quando è necessario archiviare una quantità maggiore di informazioni nel set di proprietà, è possibile specificare che il set di proprietà sia non semplice.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-117">However, when you need to store a larger amount of information in the property set, you can specify that the property set be nonsimple.</span></span> <span data-ttu-id="b8bb9-118">In questo modo è possibile usare uno o più tipi che specificano solo un puntatore a un oggetto di archiviazione o di flusso.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-118">This allows you to use one or more of the types that specify only a pointer to a storage or stream object.</span></span> <span data-ttu-id="b8bb9-119">Questi tipi sono \_ flusso VT, \_ oggetto trasmesso tramite VT, \_ archiviazione VT e \_ oggetto archiviato VT \_ .</span><span class="sxs-lookup"><span data-stu-id="b8bb9-119">These types are VT\_STREAM, VT\_STREAMED OBJECT, VT\_STORAGE and VT\_STORED\_OBJECT.</span></span>

<span data-ttu-id="b8bb9-120">I dati archiviati in queste proprietà non vengono conteggiati in base al limite delle dimensioni del set di proprietà di 256 KB in Windows NT 4,0 o versioni precedenti oppure al limite di 1 MB in Windows 2000, Windows XP e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-120">Data stored in these properties is not counted against the 256 KB property-set size limit in Windows NT 4.0 or earlier, or the 1 MB limit in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="b8bb9-121">Tuttavia, vengono applicati i dati sulla proprietà, ad esempio il relativo nome.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-121">However, data about the property, such as its name, does apply.</span></span> <span data-ttu-id="b8bb9-122">Inoltre, se è necessario un aggiornamento transazionale, il set di proprietà deve essere non semplice.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-122">Also, if you need a transacted update, the property set must be nonsimple.</span></span> <span data-ttu-id="b8bb9-123">Naturalmente, esiste una certa riduzione delle prestazioni per l'apertura di questi tipi, perché richiede l'apertura del flusso o dell'oggetto di archiviazione a cui è associato il puntatore.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-123">There is, of course, a certain performance penalty for opening these types, because it requires opening the stream or storage object to which you have the pointer.</span></span>

<span data-ttu-id="b8bb9-124">Se l'applicazione usa file composti, è possibile usare l'implementazione fornita da COM di queste interfacce, che vengono implementate nell'oggetto di archiviazione file composto COM.</span><span class="sxs-lookup"><span data-stu-id="b8bb9-124">If your application uses compound files, you can use the COM-provided implementation of these interfaces, which are implemented on the COM compound file storage object.</span></span>

<span data-ttu-id="b8bb9-125">Ogni set di proprietà è costituito principalmente da un gruppo di proprietà connesse logicamente, come descritto in [gestione delle proprietà](managing-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b8bb9-125">Each property set consists primarily of a logically connected group of properties, as described in [Managing Properties](managing-properties.md).</span></span>

<span data-ttu-id="b8bb9-126">Per ulteriori informazioni sui set di proprietà in COM, vedere:</span><span class="sxs-lookup"><span data-stu-id="b8bb9-126">For more information about property sets in COM, see:</span></span>

-   [<span data-ttu-id="b8bb9-127">Implementazioni di set di proprietà in COM</span><span class="sxs-lookup"><span data-stu-id="b8bb9-127">Property Set Implementations in COM</span></span>](property-set-implementations-in-com.md)
-   [<span data-ttu-id="b8bb9-128">Considerazioni sui set di proprietà</span><span class="sxs-lookup"><span data-stu-id="b8bb9-128">Property Set Considerations</span></span>](property-set-considerations.md)
-   [<span data-ttu-id="b8bb9-129">Considerazioni sull'implementazione di IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="b8bb9-129">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)
-   [<span data-ttu-id="b8bb9-130">Archiviazione di set di proprietà</span><span class="sxs-lookup"><span data-stu-id="b8bb9-130">Storing Property Sets</span></span>](storing-property-sets.md)
-   [<span data-ttu-id="b8bb9-131">Caratteristiche di prestazioni</span><span class="sxs-lookup"><span data-stu-id="b8bb9-131">Performance Characteristics</span></span>](performance-characteristics.md)
-   [<span data-ttu-id="b8bb9-132">Implementazione del set di proprietà informazioni di riepilogo</span><span class="sxs-lookup"><span data-stu-id="b8bb9-132">Implementing the Summary Information Property Set</span></span>](implementing-the-summary-information-property-set.md)

 

 