---
title: Implementazione di IEnumSTATPROPSETSTG-Compound file
description: L'implementazione del file composto dell'interfaccia IEnumSTATPROPSETSTG viene utilizzata per enumerare una matrice di strutture STATPROPSETSTG che contengono dati statistici della proprietà.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- IEnumSTATPROPSETSTG Strctd STG, implementazione del file composto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104337742"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="7e94c-104">Implementazione di IEnumSTATPROPSETSTG-Compound file</span><span class="sxs-lookup"><span data-stu-id="7e94c-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="7e94c-105">L'implementazione del file composto dell'interfaccia [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) viene utilizzata per enumerare una matrice di strutture [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) che contengono dati statistici della proprietà.</span><span class="sxs-lookup"><span data-stu-id="7e94c-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="7e94c-106">L'implementazione di [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) gestisce i dati statistici ed è associata a un oggetto di archiviazione file composto corrente.</span><span class="sxs-lookup"><span data-stu-id="7e94c-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="7e94c-107">Utilizzo</span><span class="sxs-lookup"><span data-stu-id="7e94c-107">When to Use</span></span>

<span data-ttu-id="7e94c-108">Chiamare i metodi di [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) per enumerare le strutture [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , ognuna delle quali fornisce dati su uno dei set di proprietà associati all'oggetto di archiviazione file composto.</span><span class="sxs-lookup"><span data-stu-id="7e94c-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="7e94c-109">Commenti</span><span class="sxs-lookup"><span data-stu-id="7e94c-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="7e94c-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="7e94c-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="7e94c-111">Ottiene le successive strutture [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) (il numero viene specificato dal parametro *celt* ).</span><span class="sxs-lookup"><span data-stu-id="7e94c-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="7e94c-112">Gli elementi **STATPROPSETSTG** forniti tramite una chiamata all'implementazione del file composto di [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) seguono le regole seguenti:</span><span class="sxs-lookup"><span data-stu-id="7e94c-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="7e94c-113">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) non è in grado di fornire STATPROPSETSTG. fmtid, gli zeri vengono scritti in quel membro.</span><span class="sxs-lookup"><span data-stu-id="7e94c-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="7e94c-114">Questo errore si verifica quando il set di proprietà non dispone di un nome predefinito, ad esempio \\ 005SummaryInformation, e non è un valore valido.</span><span class="sxs-lookup"><span data-stu-id="7e94c-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="7e94c-115">Il set di proprietà DocumentSummaryInformation e UserDefined è speciale, in quanto può includere due sezioni set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="7e94c-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="7e94c-116">Questo set di proprietà è descritto nella sezione [set di proprietà DocumentSummaryInformation e UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="7e94c-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="7e94c-117">La seconda sezione è indicata come proprietà User-Defined.</span><span class="sxs-lookup"><span data-stu-id="7e94c-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="7e94c-118">Ogni sezione viene identificata con un identificatore di formato univoco (FMTID).</span><span class="sxs-lookup"><span data-stu-id="7e94c-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="7e94c-119">Quando [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) viene usato per enumerare i set di proprietà, il set di proprietà User-Defined non verrà enumerato.</span><span class="sxs-lookup"><span data-stu-id="7e94c-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="7e94c-120">Se si crea sempre un set di proprietà usando [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), quindi, poiché viene creato un "GUID di tipo carattere" per il nome di archiviazione, [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) restituirà un fmtid valido diverso da zero per il set di proprietà \[ STATPROPSETSTG. fmtid \] .</span><span class="sxs-lookup"><span data-stu-id="7e94c-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="7e94c-121">Il membro STATPROPSETSTG. grfFlags non riflette necessariamente se il set di proprietà è ANSI o meno.</span><span class="sxs-lookup"><span data-stu-id="7e94c-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="7e94c-122">Se \_ è impostato PROPSETFLAG ANSI, il set di proprietà è sicuramente ANSI.</span><span class="sxs-lookup"><span data-stu-id="7e94c-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="7e94c-123">Se PROPSETFLAG \_ ANSI è chiaro, il set di proprietà potrebbe essere Unicode o non Unicode, perché non è possibile stabilire se è ANSI senza aprirlo.</span><span class="sxs-lookup"><span data-stu-id="7e94c-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="7e94c-124">Il membro STATPROPSETSTG. grfFlags riflette se il set di proprietà è semplice o meno, quindi l'impostazione del flag PROPSETFLAG non \_ semplice è sempre valida.</span><span class="sxs-lookup"><span data-stu-id="7e94c-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="7e94c-125">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) non è in grado di fornire STATPROPSETSTG. CLSID, viene impostato su tutti zeri (CLSID \_ null).</span><span class="sxs-lookup"><span data-stu-id="7e94c-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="7e94c-126">Nell'implementazione del file composto COM, questo errore si verifica quando il set di proprietà è semplice (il \_ flag PROPSETFLAG non semplice non è impostato) o è non semplice, ma il CLSID non è stato impostato in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="7e94c-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="7e94c-127">Per i set di proprietà non semplici, il CLSID ricevuto è quello gestito dal [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e94c-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="7e94c-128">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) non è in grado di fornire i campi di tempo \[ **CTime**, **mtime**, **dell'atime** \] , ogni ora non supportata verrà impostata su zero.</span><span class="sxs-lookup"><span data-stu-id="7e94c-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="7e94c-129">Nell'implementazione del file composto COM, ottenere questi valori dipende dal recupero dall'implementazione [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) sottostante.</span><span class="sxs-lookup"><span data-stu-id="7e94c-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="7e94c-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG:: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="7e94c-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="7e94c-131">Ignora il numero di elementi specificato in *celt*.</span><span class="sxs-lookup"><span data-stu-id="7e94c-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="7e94c-132">Restituisce \_ OK se il numero di elementi specificato viene ignorato, restituisce \_ false se vengono ignorati meno elementi di quelli richiesti.</span><span class="sxs-lookup"><span data-stu-id="7e94c-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="7e94c-133">In tutti gli altri casi, restituisce l'errore appropriato.</span><span class="sxs-lookup"><span data-stu-id="7e94c-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="7e94c-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG:: Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="7e94c-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="7e94c-135">Imposta il cursore all'inizio dell'enumerazione.</span><span class="sxs-lookup"><span data-stu-id="7e94c-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="7e94c-136">Se ha esito positivo, restituisce S \_ OK. in caso contrario, restituisce STG \_ E \_ INVALIDHANDLE.</span><span class="sxs-lookup"><span data-stu-id="7e94c-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="7e94c-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG:: Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="7e94c-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="7e94c-138">Copia lo stato di enumerazione corrente dell'enumeratore.</span><span class="sxs-lookup"><span data-stu-id="7e94c-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 