---
title: Metodi CGuiPaper
description: I metodi di CGuiPaper sono riepilogati come indicato di seguito. Questi metodi sono tutti implementati in GUIPAPER. CPP.
ms.assetid: 965a60d4-2737-4a2d-8790-bee70bceaeeb
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1303ca38ffe02da0dc747e1a8834d36419452209
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103708206"
---
# <a name="cguipaper-methods"></a><span data-ttu-id="4afcd-104">Metodi CGuiPaper</span><span class="sxs-lookup"><span data-stu-id="4afcd-104">CGuiPaper Methods</span></span>

<span data-ttu-id="4afcd-105">I metodi di CGuiPaper sono riepilogati come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4afcd-105">CGuiPaper's methods are summarized as follows.</span></span> <span data-ttu-id="4afcd-106">Questi metodi sono tutti implementati in GUIPAPER. CPP.</span><span class="sxs-lookup"><span data-stu-id="4afcd-106">These methods are all implemented in GUIPAPER.CPP.</span></span>



| <span data-ttu-id="4afcd-107">Metodo</span><span class="sxs-lookup"><span data-stu-id="4afcd-107">Method</span></span>                                                         | <span data-ttu-id="4afcd-108">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4afcd-108">Description</span></span>                                                                                                           |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4afcd-109">BOOL init (HINSTANCE hInst, HWND hWnd, TCHAR \* pszCmdLineFile);</span><span class="sxs-lookup"><span data-stu-id="4afcd-109">BOOL Init(HINSTANCE hInst, HWND hWnd, TCHAR\* pszCmdLineFile);</span></span> | <span data-ttu-id="4afcd-110">Inizializza GuiPaper.</span><span class="sxs-lookup"><span data-stu-id="4afcd-110">Initializes the GuiPaper.</span></span> <span data-ttu-id="4afcd-111">Chiede al server di creare un oggetto Copaper.</span><span class="sxs-lookup"><span data-stu-id="4afcd-111">Asks server to create a COPaper object.</span></span>                                                     |
| <span data-ttu-id="4afcd-112">HRESULT DrawOn (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-112">HRESULT DrawOn(void);</span></span>                                          | <span data-ttu-id="4afcd-113">Blocca la carta per il disegno esclusivo del client.</span><span class="sxs-lookup"><span data-stu-id="4afcd-113">Locks paper for drawing exclusively by this client.</span></span>                                                                   |
| <span data-ttu-id="4afcd-114">HRESULT DrawOff (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-114">HRESULT DrawOff(void);</span></span>                                         | <span data-ttu-id="4afcd-115">Sblocca la carta per consentire l'estrazione di altri client.</span><span class="sxs-lookup"><span data-stu-id="4afcd-115">Unlocks paper to allow other clients to draw.</span></span>                                                                         |
| <span data-ttu-id="4afcd-116">HRESULT ClearWin (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-116">HRESULT ClearWin(void);</span></span>                                        | <span data-ttu-id="4afcd-117">Cancella la finestra di visualizzazione, ma conserva i dati dell'input penna.</span><span class="sxs-lookup"><span data-stu-id="4afcd-117">Clears display window but retains ink data.</span></span>                                                                           |
| <span data-ttu-id="4afcd-118">HRESULT PaintWin (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-118">HRESULT PaintWin(void);</span></span>                                        | <span data-ttu-id="4afcd-119">Cancella la finestra e i ridisegni con i dati di input penna correnti.</span><span class="sxs-lookup"><span data-stu-id="4afcd-119">Clears window and repaints with current ink data.</span></span>                                                                     |
| <span data-ttu-id="4afcd-120">HRESULT Erase (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-120">HRESULT Erase(void);</span></span>                                           | <span data-ttu-id="4afcd-121">Cancella il contenuto del disegno corrente e cancella la finestra di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="4afcd-121">Erases current drawing content and clears display window.</span></span>                                                             |
| <span data-ttu-id="4afcd-122">HRESULT Resize (WORD wWidth, WORD peso);</span><span class="sxs-lookup"><span data-stu-id="4afcd-122">HRESULT Resize(WORD wWidth, WORD wHeight);</span></span>                     | <span data-ttu-id="4afcd-123">Ridimensiona la finestra di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="4afcd-123">Resizes the display window.</span></span>                                                                                           |
| <span data-ttu-id="4afcd-124">HRESULT InkWidth (SHORT nInkWidth);</span><span class="sxs-lookup"><span data-stu-id="4afcd-124">HRESULT InkWidth(SHORT nInkWidth);</span></span>                             | <span data-ttu-id="4afcd-125">Imposta la larghezza dell'input penna corrente per il disegno.</span><span class="sxs-lookup"><span data-stu-id="4afcd-125">Sets current ink width for drawing.</span></span>                                                                                   |
| <span data-ttu-id="4afcd-126">HRESULT InkColor (COLORREF crInkColor);</span><span class="sxs-lookup"><span data-stu-id="4afcd-126">HRESULT InkColor(COLORREF crInkColor);</span></span>                         | <span data-ttu-id="4afcd-127">Imposta il colore dell'input penna corrente per il disegno.</span><span class="sxs-lookup"><span data-stu-id="4afcd-127">Sets current ink color for drawing.</span></span>                                                                                   |
| <span data-ttu-id="4afcd-128">HRESULT InkSaving (BOOL bInkSaving);</span><span class="sxs-lookup"><span data-stu-id="4afcd-128">HRESULT InkSaving(BOOL bInkSaving);</span></span>                            | <span data-ttu-id="4afcd-129">Attiva e disattiva il salvataggio dei dati di input penna in un documento.</span><span class="sxs-lookup"><span data-stu-id="4afcd-129">Turns ink data saving in COPaper on and off.</span></span>                                                                          |
| <span data-ttu-id="4afcd-130">HRESULT InkStart (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="4afcd-130">HRESULT InkStart(SHORT nX, SHORT nY);</span></span>                          | <span data-ttu-id="4afcd-131">Avvia la sequenza di disegno dell'input penna.</span><span class="sxs-lookup"><span data-stu-id="4afcd-131">Starts ink drawing sequence.</span></span>                                                                                          |
| <span data-ttu-id="4afcd-132">HRESULT InkDraw (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="4afcd-132">HRESULT InkDraw(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="4afcd-133">Disegna i dati della sequenza di input penna.</span><span class="sxs-lookup"><span data-stu-id="4afcd-133">Draws ink sequence data.</span></span>                                                                                              |
| <span data-ttu-id="4afcd-134">HRESULT InkStop (SHORT nX, SHORT nY);</span><span class="sxs-lookup"><span data-stu-id="4afcd-134">HRESULT InkStop(SHORT nX, SHORT nY);</span></span>                           | <span data-ttu-id="4afcd-135">Arresta la sequenza di disegno dell'input penna.</span><span class="sxs-lookup"><span data-stu-id="4afcd-135">Stops ink drawing sequence.</span></span>                                                                                           |
| <span data-ttu-id="4afcd-136">HRESULT ConnectPaperSink (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-136">HRESULT ConnectPaperSink(void);</span></span>                                | <span data-ttu-id="4afcd-137">Connette l'oggetto PaperSink del client all'origine del documento del server.</span><span class="sxs-lookup"><span data-stu-id="4afcd-137">Connects the client PaperSink object to the server COPaper source.</span></span>                                                    |
| <span data-ttu-id="4afcd-138">HRESULT DisconnectPaperSink (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-138">HRESULT DisconnectPaperSink(void);</span></span>                             | <span data-ttu-id="4afcd-139">Disconnettere l'oggetto PaperSink del client dall'origine del documento del server.</span><span class="sxs-lookup"><span data-stu-id="4afcd-139">Disconnect the client PaperSink object from the server COPaper source.</span></span>                                                |
| <span data-ttu-id="4afcd-140">Carico HRESULT (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-140">HRESULT Load(void);</span></span>                                            | <span data-ttu-id="4afcd-141">Carica i dati dell'input penna dal file composto corrente.</span><span class="sxs-lookup"><span data-stu-id="4afcd-141">Loads ink data from current compound file.</span></span>                                                                            |
| <span data-ttu-id="4afcd-142">HRESULT Save (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-142">HRESULT Save(void);</span></span>                                            | <span data-ttu-id="4afcd-143">Salva i dati Ink esistenti nel file composto corrente.</span><span class="sxs-lookup"><span data-stu-id="4afcd-143">Saves existing ink data to current compound file.</span></span>                                                                     |
| <span data-ttu-id="4afcd-144">HRESULT AskSave (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-144">HRESULT AskSave(void);</span></span>                                         | <span data-ttu-id="4afcd-145">Controlla se il disegno è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="4afcd-145">Checks if drawing changed.</span></span> <span data-ttu-id="4afcd-146">In tal caso, viene visualizzata la finestra di dialogo in cui viene chiesto all'utente se salvare le modifiche e rispondere in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="4afcd-146">If so, displays dialog box asking user whether to save changes and responds appropriately.</span></span> |
| <span data-ttu-id="4afcd-147">HRESULT aperto (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-147">HRESULT Open(void);</span></span>                                            | <span data-ttu-id="4afcd-148">Mostra la finestra di dialogo comune Win32.</span><span class="sxs-lookup"><span data-stu-id="4afcd-148">Shows Win32 common dialog box.</span></span> <span data-ttu-id="4afcd-149">Apre un file composto di dati cartacei esistente.</span><span class="sxs-lookup"><span data-stu-id="4afcd-149">Opens existing paper data compound file.</span></span>                                               |
| <span data-ttu-id="4afcd-150">SaveAs di HRESULT (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-150">HRESULT SaveAs(void);</span></span>                                          | <span data-ttu-id="4afcd-151">Mostra la finestra di dialogo comune Win32.</span><span class="sxs-lookup"><span data-stu-id="4afcd-151">Shows Win32 common dialog box.</span></span> <span data-ttu-id="4afcd-152">Salva i dati cartacei correnti in un file rinominato.</span><span class="sxs-lookup"><span data-stu-id="4afcd-152">Saves current paper data in renamed file.</span></span>                                              |
| <span data-ttu-id="4afcd-153">COLORREF PickColor (void);</span><span class="sxs-lookup"><span data-stu-id="4afcd-153">COLORREF PickColor(void);</span></span>                                      | <span data-ttu-id="4afcd-154">Mostra la finestra di dialogo Pratolina Win32.</span><span class="sxs-lookup"><span data-stu-id="4afcd-154">Shows Win32 ommon dialog box.</span></span> <span data-ttu-id="4afcd-155">Chiede all'utente di scegliere il nuovo colore della penna.</span><span class="sxs-lookup"><span data-stu-id="4afcd-155">Asks user to choose new pen color.</span></span>                                                      |



 

<span data-ttu-id="4afcd-156">Il metodo **init** crea l'oggetto Copaper basato su server e assegna il \_ membro pIPaper di CGuiPaper.</span><span class="sxs-lookup"><span data-stu-id="4afcd-156">The **Init** method creates the server-based COPaper object and assigns CGuiPaper's m\_pIPaper member.</span></span>

<span data-ttu-id="4afcd-157">I metodi **AskSave**, **Open**, **SaveAs** e **PickColor** forniscono un comportamento familiare dell'interfaccia utente grafica usando le finestre di dialogo comuni di Win32.</span><span class="sxs-lookup"><span data-stu-id="4afcd-157">The **AskSave**, **Open**, **SaveAs**, and **PickColor** methods provide familiar GUI behavior using Win32 common dialogs.</span></span> <span data-ttu-id="4afcd-158">Ad esempio, il metodo **Open** usa la finestra di dialogo Apri nome file Win32 per chiedere all'utente di specificare un nome di file per l'apertura.</span><span class="sxs-lookup"><span data-stu-id="4afcd-158">For example, the **Open** method uses the Win32 Open File Name dialog box to ask the user to specify a file name for opening.</span></span>

<span data-ttu-id="4afcd-159">I metodi **Load** e **Save** verranno descritti in dettaglio più avanti in questa presentazione.</span><span class="sxs-lookup"><span data-stu-id="4afcd-159">The **Load** and **Save** methods will be covered in detail later in this tour.</span></span>

<span data-ttu-id="4afcd-160">**InkSaving**, **InkStart**, **InkDraw** e **InkStop** sono i metodi centrali per la funzionalità di disegno dell'applicazione **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="4afcd-160">**InkSaving**, **InkStart**, **InkDraw**, and **InkStop** are the central methods for the drawing functionality of the **StoClien** application.</span></span> <span data-ttu-id="4afcd-161">**StoClien** utilizza questi metodi CGuiPaper per acquisire, visualizzare e archiviare i dati di disegno interattivo come avviene nel controllo utente.</span><span class="sxs-lookup"><span data-stu-id="4afcd-161">**StoClien** uses these CGuiPaper methods to capture, display, and store the interactive drawing data as it occurs under user control.</span></span> <span data-ttu-id="4afcd-162">Eseguono un doppio ruolo di disegnare l'immagine disegnata nella finestra del client, nonché di passare i dati di disegno a un documento nel server.</span><span class="sxs-lookup"><span data-stu-id="4afcd-162">They perform a dual role of painting the drawn image to the client window as well as passing the drawing data to COPaper in the server.</span></span> <span data-ttu-id="4afcd-163">Il documento converte i dati di disegno in pacchetti di dati di input penna per l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="4afcd-163">COPaper translates the drawing data into ink data packets for storage.</span></span>

 

 




