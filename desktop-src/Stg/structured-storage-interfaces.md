---
title: Interfacce di archiviazione strutturate
description: I servizi di archiviazione strutturati sono organizzati in tre categorie di interfacce.
ms.assetid: a4281f07-eae4-4bcb-8d16-b6c0bd3c5b21
keywords:
- Interfacce di archiviazione strutturate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0010a0d4dec4908111c8a5bb939f795f0a2b2eb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300073"
---
# <a name="structured-storage-interfaces"></a><span data-ttu-id="3126d-104">Interfacce di archiviazione strutturate</span><span class="sxs-lookup"><span data-stu-id="3126d-104">Structured Storage Interfaces</span></span>

<span data-ttu-id="3126d-105">I servizi di archiviazione strutturati sono organizzati in tre categorie di [interfacce](interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="3126d-105">Structured Storage services are organized into three categories of [interfaces](interfaces.md).</span></span> <span data-ttu-id="3126d-106">Ogni set rappresenta un livello di riferimento indiretto o di astrazione successivo tra un file composto, gli oggetti in esso contenuti e il supporto fisico in cui sono archiviati questi singoli componenti.</span><span class="sxs-lookup"><span data-stu-id="3126d-106">Each set represents a successive level of indirection or abstraction between a compound file, the objects it contains, and the physical media in which these individual components are stored.</span></span>

<span data-ttu-id="3126d-107">La prima categoria di interfacce è costituita da [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream)e [**IRootStorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span><span class="sxs-lookup"><span data-stu-id="3126d-107">The first category of interfaces consists of [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), and [**IRootStorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span></span> <span data-ttu-id="3126d-108">Le prime due interfacce definiscono la modalità di archiviazione degli oggetti all'interno di un file composto.</span><span class="sxs-lookup"><span data-stu-id="3126d-108">The first two interfaces define how objects are stored within a compound file.</span></span> <span data-ttu-id="3126d-109">Queste interfacce forniscono metodi per l'apertura di elementi di archiviazione, il commit e il ripristino di modifiche, la copia e lo sviluppo di elementi, la lettura e la scrittura di flussi.</span><span class="sxs-lookup"><span data-stu-id="3126d-109">These interfaces provide methods for opening storage elements, committing and reverting changes, copying and moving elements, and reading and writing streams.</span></span> <span data-ttu-id="3126d-110">Queste interfacce non riconoscono i formati di dati nativi dei singoli oggetti e pertanto non dispongono di metodi per salvare tali oggetti nell'archivio permanente.</span><span class="sxs-lookup"><span data-stu-id="3126d-110">These interfaces do not recognize the native data formats of the individual objects and therefore have no methods for saving those objects to persistent storage.</span></span> <span data-ttu-id="3126d-111">L'interfaccia **IRootStorage** ha un singolo metodo per associare un documento composto con un nome di file system sottostante.</span><span class="sxs-lookup"><span data-stu-id="3126d-111">The **IRootStorage** interface has a single method for associating a compound document with an underlying file system name.</span></span> <span data-ttu-id="3126d-112">I client devono implementare queste interfacce per i file composti.</span><span class="sxs-lookup"><span data-stu-id="3126d-112">Clients must implement these interfaces for their compound files.</span></span>

<span data-ttu-id="3126d-113">La seconda categoria di interfacce è costituita dalle interfacce [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) , che gli oggetti implementano per gestire i dati persistenti.</span><span class="sxs-lookup"><span data-stu-id="3126d-113">The second category of interfaces consists of the [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) interfaces, which objects implement to manage their persistent data.</span></span> <span data-ttu-id="3126d-114">Queste interfacce forniscono metodi per leggere i formati di dati dei singoli oggetti e pertanto sono in grado di archiviarli.</span><span class="sxs-lookup"><span data-stu-id="3126d-114">These interfaces provide methods to read the data formats of individual objects and therefore know how to store them.</span></span> <span data-ttu-id="3126d-115">Gli oggetti sono responsabili dell'implementazione di queste interfacce perché i client non conoscono i formati di dati nativi degli oggetti annidati.</span><span class="sxs-lookup"><span data-stu-id="3126d-115">Objects are responsible for implementing these interfaces because clients do not know the native data formats of their nested objects.</span></span> <span data-ttu-id="3126d-116">Queste interfacce, tuttavia, non conoscono supporti di archiviazione fisici specifici.</span><span class="sxs-lookup"><span data-stu-id="3126d-116">These interfaces, however, have no knowledge of specific physical storage media.</span></span>

<span data-ttu-id="3126d-117">Una terza categoria è costituita da una singola interfaccia, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), che fornisce metodi per la scrittura di file in supporti fisici specifici, ad esempio un disco rigido o un'unità nastro.</span><span class="sxs-lookup"><span data-stu-id="3126d-117">A third category consists of a single interface, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), which provides methods for writing files to specific physical media, such as a hard disk or tape drive.</span></span> <span data-ttu-id="3126d-118">Tuttavia, la maggior parte delle applicazioni non implementa l'interfaccia **ILockBytes** poiché com fornisce già implementazioni per le due situazioni più comuni, ovvero l'implementazione basata su file e l'implementazione basata sulla memoria.</span><span class="sxs-lookup"><span data-stu-id="3126d-118">However, most applications will not implement the **ILockBytes** interface because COM already provides implementations for the two most common situations, which are File-based implementation and Memory-based implementation.</span></span> <span data-ttu-id="3126d-119">L'oggetto di archiviazione file composto chiama i metodi **ILockBytes** che non vengono chiamati direttamente nell'implementazione.</span><span class="sxs-lookup"><span data-stu-id="3126d-119">The compound file storage object calls the **ILockBytes** methods you do not call them directly in the implementation.</span></span>

## <a name="compound-file-implementation-limits"></a><span data-ttu-id="3126d-120">Limiti di implementazione dei file composti</span><span class="sxs-lookup"><span data-stu-id="3126d-120">Compound File Implementation Limits</span></span>

<span data-ttu-id="3126d-121">L'implementazione COM di architettura di archiviazione strutturata è denominata *file composti*.</span><span class="sxs-lookup"><span data-stu-id="3126d-121">The COM implementation of Structured Storage architecture is called *compound files*.</span></span> <span data-ttu-id="3126d-122">Gli oggetti di archiviazione, come implementato nei file composti, includono un'implementazione delle interfacce [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) e [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="3126d-122">Storage objects, as implemented in compound files, include an implementation of the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interfaces.</span></span>

<span data-ttu-id="3126d-123">I puntatori all'implementazione del file composto di queste interfacce vengono acquisiti chiamando la funzione [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) per creare un nuovo oggetto file composto o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) per aprire un file composto creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="3126d-123">Pointers to the compound file implementation of these interfaces are acquired by calling the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) function to create a new compound file object, or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file.</span></span>

<span data-ttu-id="3126d-124">Un metodo alternativo per l'acquisizione di un puntatore all'implementazione del file composto di queste interfacce consiste nel chiamare la funzione [**StgCreateDocFile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) o [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) meno recente e più limitata.</span><span class="sxs-lookup"><span data-stu-id="3126d-124">An alternative method for acquiring a pointer to the compound file implementation of these interfaces is by calling the older and more limited [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) or [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) function.</span></span> <span data-ttu-id="3126d-125">Tutte e quattro le funzioni vengono considerate come implementazioni di file composte.</span><span class="sxs-lookup"><span data-stu-id="3126d-125">All four functions are treated as compound file implementations.</span></span>

<span data-ttu-id="3126d-126">L'implementazione del file composto può essere configurata in modo da usare i settori 512 o 4096 byte, come definito nella struttura [**STGOPTIONS**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) .</span><span class="sxs-lookup"><span data-stu-id="3126d-126">The compound file implementation can be configured to use 512 or 4096 byte sectors, as defined in the [**STGOPTIONS**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) structure.</span></span>

<span data-ttu-id="3126d-127">L'implementazione del file composto dei file composti è soggetta ai vincoli di implementazione seguenti.</span><span class="sxs-lookup"><span data-stu-id="3126d-127">The compound file implementation of compound files is subject to the following implementation constraints.</span></span>



| <span data-ttu-id="3126d-128">Limite</span><span class="sxs-lookup"><span data-stu-id="3126d-128">Limit</span></span>                                           | <span data-ttu-id="3126d-129">File composto</span><span class="sxs-lookup"><span data-stu-id="3126d-129">Compound file</span></span>                                                                                                                                                                      |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3126d-130">Limiti per le dimensioni dei file:</span><span class="sxs-lookup"><span data-stu-id="3126d-130">File size limits:</span></span>                               | <span data-ttu-id="3126d-131">512:2 gigabyte (GB) 4096: limiti fino a file system</span><span class="sxs-lookup"><span data-stu-id="3126d-131">512: 2 gigabytes (GB) 4096: Up to file system limits</span></span><br/>                                                                                                                    |
| <span data-ttu-id="3126d-132">Dimensioni massime heap richieste per gli elementi aperti:</span><span class="sxs-lookup"><span data-stu-id="3126d-132">Maximum heap size required for open elements:</span></span>   | <span data-ttu-id="3126d-133">512:4 megabyte (MB) 4096: fino a limiti di memoria virtuale</span><span class="sxs-lookup"><span data-stu-id="3126d-133">512: 4 megabytes (MB) 4096: Up to virtual memory limits</span></span><br/>                                                                                                                 |
| <span data-ttu-id="3126d-134">Si apre la radice simultanea (si apre lo stesso file):</span><span class="sxs-lookup"><span data-stu-id="3126d-134">Concurrent root opens (opens of the same file):</span></span> | <span data-ttu-id="3126d-135">Se \_ vengono specificati STGM Read e STGM \_ share \_ Deny \_ Write, i limiti sono determinati dai limiti del file System.</span><span class="sxs-lookup"><span data-stu-id="3126d-135">If STGM\_READ and STGM\_SHARE\_DENY\_WRITE are specified, limits are dictated by the file-system limits.</span></span> <span data-ttu-id="3126d-136">In caso contrario, è previsto un limite di 20 aperture radice simultanee dello stesso file.</span><span class="sxs-lookup"><span data-stu-id="3126d-136">Otherwise, there is a limit of 20 concurrent root opens of the same file.</span></span> |
| <span data-ttu-id="3126d-137">Numero di elementi in un file:</span><span class="sxs-lookup"><span data-stu-id="3126d-137">Number of elements in a file:</span></span>                   | <span data-ttu-id="3126d-138">512: illimitato, ma le prestazioni possono peggiorare se il numero di elementi nelle migliaia 4096: illimitato</span><span class="sxs-lookup"><span data-stu-id="3126d-138">512: Unlimited, but performance may degrade if elements number in the thousands 4096: Unlimited</span></span><br/>                                                                         |



 

<span data-ttu-id="3126d-139">A causa del limite delle dimensioni dell'heap di 4 MB, il numero di elementi aperti in modalità transazionale è in genere limitato a diverse migliaia di elementi.</span><span class="sxs-lookup"><span data-stu-id="3126d-139">Due to the 4-MB heap-size limit, the number of open elements in transacted mode is typically limited to several thousand elements.</span></span>

 

