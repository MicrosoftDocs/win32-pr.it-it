---
title: Serializzazione del set di proprietà
description: Sono disponibili due versioni del formato di serializzazione del set di proprietà.
ms.assetid: 10544118-5e80-47e2-b75b-c1a43be15b2e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49c635728e169cdddb20437323a49a18496b3459
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104223947"
---
# <a name="property-set-serialization"></a><span data-ttu-id="5b035-103">Serializzazione del set di proprietà</span><span class="sxs-lookup"><span data-stu-id="5b035-103">Property Set Serialization</span></span>

<span data-ttu-id="5b035-104">Sono disponibili due versioni del formato di serializzazione del set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="5b035-104">There are two versions of the property set serialization format.</span></span> <span data-ttu-id="5b035-105">La specifica originale descrive la versione 0 del formato.</span><span class="sxs-lookup"><span data-stu-id="5b035-105">The original specification describes version 0 of the format.</span></span> <span data-ttu-id="5b035-106">Per ulteriori informazioni, vedere [format version](format-version.md) .</span><span class="sxs-lookup"><span data-stu-id="5b035-106">See [Format Version](format-version.md) for more information.</span></span> <span data-ttu-id="5b035-107">La versione 1 estende la versione originale.</span><span class="sxs-lookup"><span data-stu-id="5b035-107">Version 1 extends the original version.</span></span> <span data-ttu-id="5b035-108">Tutti i set di proprietà della versione 0 sono validi come set di proprietà versione 1.</span><span class="sxs-lookup"><span data-stu-id="5b035-108">All version 0 property sets are valid as version 1 property sets.</span></span> <span data-ttu-id="5b035-109">Il campo della **versione del formato** nell'intestazione di un set di proprietà serializzate indica la versione.</span><span class="sxs-lookup"><span data-stu-id="5b035-109">The **Format Version** field in the header of a serialized property set indicates the version.</span></span>

<span data-ttu-id="5b035-110">Gli elementi seguenti identificano le differenze tra i formati di serializzazione del set di proprietà versione 0 e 1.</span><span class="sxs-lookup"><span data-stu-id="5b035-110">The following items identify the differences between version 0 and version 1 property set serialization formats.</span></span>

-   <span data-ttu-id="5b035-111">Supporto per nuovi valori **VarType** .</span><span class="sxs-lookup"><span data-stu-id="5b035-111">Support for new **VARTYPE** values.</span></span> <span data-ttu-id="5b035-112">Per ulteriori informazioni sui valori **VarType** e su come utilizzarli, vedere l'argomento [tipi di dati e strutture di IDispatch]( /previous-versions/ms221600(v=vs.100)) e la struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5b035-112">For more information about **VARTYPE** values and how to use them, see the topic [IDispatch Data Types and Structures]( /previous-versions/ms221600(v=vs.100)) and the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

    <span data-ttu-id="5b035-113">I valori **VarType** seguenti non sono supportati nei set di proprietà della versione 0, ma sono supportati nella versione 1:</span><span class="sxs-lookup"><span data-stu-id="5b035-113">The following **VARTYPE** values are not supported in version 0 property sets, but are supported in version 1:</span></span>

    <span data-ttu-id="5b035-114">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="5b035-114">VT\_I1</span></span>

    <span data-ttu-id="5b035-115">VT \_ vettore \| VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="5b035-115">VT\_VECTOR \| VT\_I1</span></span>

    <span data-ttu-id="5b035-116">\_int VT</span><span class="sxs-lookup"><span data-stu-id="5b035-116">VT\_INT</span></span>

    <span data-ttu-id="5b035-117">\_uint VT</span><span class="sxs-lookup"><span data-stu-id="5b035-117">VT\_UINT</span></span>

    <span data-ttu-id="5b035-118">\_decimale VT</span><span class="sxs-lookup"><span data-stu-id="5b035-118">VT\_DECIMAL</span></span>

    <span data-ttu-id="5b035-119">È inoltre possibile serializzare SafeArrays in un set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="5b035-119">Additionally, SafeArrays can be serialized in a property set.</span></span> <span data-ttu-id="5b035-120">La presenza di un SafeArray è indicata dal bit di \_ matrice VT combinato, tramite un'operazione **or** , con gli elementi della matrice nel membro **VT** della struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5b035-120">The presence of a SafeArray is indicated by the VT\_ARRAY bit combined, using an **OR** operation, with the array elements in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span> <span data-ttu-id="5b035-121">Ad esempio, un SafeArray di interi con segno a 4 byte ha un tipo di VT di \_ matrice VT \| \_ i4.</span><span class="sxs-lookup"><span data-stu-id="5b035-121">For example, a SafeArray of 4-byte signed integers has a type of VT\_ARRAY \| VT\_I4.</span></span>

    <span data-ttu-id="5b035-122">I tipi di elemento seguenti sono validi per un SafeArray in un set di proprietà serializzate:</span><span class="sxs-lookup"><span data-stu-id="5b035-122">The following element types are valid for a SafeArray in a serialized property set:</span></span>



|             |          |             |           |
|-------------|----------|-------------|-----------|
| <span data-ttu-id="5b035-123">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="5b035-123">VT\_I1</span></span>      | <span data-ttu-id="5b035-124">\_Ui1 VT</span><span class="sxs-lookup"><span data-stu-id="5b035-124">VT\_UI1</span></span>  | <span data-ttu-id="5b035-125">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="5b035-125">VT\_I2</span></span>      | <span data-ttu-id="5b035-126">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="5b035-126">VT\_UI2</span></span>   |
| <span data-ttu-id="5b035-127">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5b035-127">VT\_I4</span></span>      | <span data-ttu-id="5b035-128">\_UI4 VT</span><span class="sxs-lookup"><span data-stu-id="5b035-128">VT\_UI4</span></span>  | <span data-ttu-id="5b035-129">\_int VT</span><span class="sxs-lookup"><span data-stu-id="5b035-129">VT\_INT</span></span>     | <span data-ttu-id="5b035-130">\_uint VT</span><span class="sxs-lookup"><span data-stu-id="5b035-130">VT\_UINT</span></span>  |
| <span data-ttu-id="5b035-131">\_R4 VT</span><span class="sxs-lookup"><span data-stu-id="5b035-131">VT\_R4</span></span>      | <span data-ttu-id="5b035-132">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="5b035-132">VT\_R8</span></span>   | <span data-ttu-id="5b035-133">\_CY VT</span><span class="sxs-lookup"><span data-stu-id="5b035-133">VT\_CY</span></span>      | <span data-ttu-id="5b035-134">\_Data VT</span><span class="sxs-lookup"><span data-stu-id="5b035-134">VT\_DATE</span></span>  |
| <span data-ttu-id="5b035-135">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="5b035-135">VT\_BSTR</span></span>    | <span data-ttu-id="5b035-136">\_bool VT</span><span class="sxs-lookup"><span data-stu-id="5b035-136">VT\_BOOL</span></span> | <span data-ttu-id="5b035-137">\_decimale VT</span><span class="sxs-lookup"><span data-stu-id="5b035-137">VT\_DECIMAL</span></span> | <span data-ttu-id="5b035-138">\_errore VT</span><span class="sxs-lookup"><span data-stu-id="5b035-138">VT\_ERROR</span></span> |
| <span data-ttu-id="5b035-139">\_variante VT</span><span class="sxs-lookup"><span data-stu-id="5b035-139">VT\_VARIANT</span></span> |          |             |           |



 

<span data-ttu-id="5b035-140">Quando \_ viene specificato il tipo di dati Variant VT, il SAFEARRAY stesso include le strutture [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5b035-140">When the VT\_VARIANT data type is specified, it indicates that the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="5b035-141">I tipi per questi elementi devono provenire dall'elenco precedente, ad eccezione del fatto che non possono contenere tipi varianti VT annidati \_ .</span><span class="sxs-lookup"><span data-stu-id="5b035-141">The types for these elements must be from the preceding list, except they cannot contain nested VT\_VARIANT types.</span></span>

<span data-ttu-id="5b035-142">Si noti che le implementazioni di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) devono essere in grado di eseguire il ripristino normalmente restituendo un errore quando viene rilevato un nuovo tipo. ad esempio, i tipi VARENUM.</span><span class="sxs-lookup"><span data-stu-id="5b035-142">Note that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) must be able to recover gracefully by returning an error when a new type is encountered; for example, VARENUM types.</span></span>

-   <span data-ttu-id="5b035-143">Nomi proprietà con distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="5b035-143">Case sensitive property names.</span></span> <span data-ttu-id="5b035-144">I nomi delle proprietà, ad esempio quelli specificati nel metodo [**IPropertyStorage:: WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) , non fanno distinzione tra maiuscole e minuscole nei set di proprietà della versione 0.</span><span class="sxs-lookup"><span data-stu-id="5b035-144">Property names, for example those specified in the [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) method, are not case sensitive in version 0 property sets.</span></span> <span data-ttu-id="5b035-145">Nei set di proprietà della versione 1 i nomi di proprietà possono fare distinzione tra maiuscole e minuscole a seconda del valore della nuova proprietà Behavior.</span><span class="sxs-lookup"><span data-stu-id="5b035-145">In version 1 property sets, property names can be case-sensitive depending on the value of the new Behavior property.</span></span>

    <span data-ttu-id="5b035-146">La proprietà Behavior è [ID di proprietà 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) con un tipo di \_ UI4 VT.</span><span class="sxs-lookup"><span data-stu-id="5b035-146">The Behavior property is [Property ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) with a type of VT\_UI4.</span></span> <span data-ttu-id="5b035-147">Se viene impostato il bit più basso di questo valore, i nomi dei set di proprietà fanno distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="5b035-147">If the lowest bit of this value is set, the property set names are case sensitive.</span></span> <span data-ttu-id="5b035-148">Impostare il flag PROPSETFLAG maiuscole \_ \_ /minuscole nel parametro *GrfFlags* del metodo [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) per specificare un set di proprietà con distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="5b035-148">Set the PROPSETFLAG\_CASE\_SENSITIVE flag in the *grfFlags* parameter of the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method to specify a case-sensitive property set.</span></span>

-   <span data-ttu-id="5b035-149">Nomi di proprietà Long.</span><span class="sxs-lookup"><span data-stu-id="5b035-149">Long property names.</span></span> <span data-ttu-id="5b035-150">I nomi di proprietà per i set di proprietà della versione 0 devono essere minori o uguali a 256 caratteri, incluso il carattere di terminazione della stringa, per i set di proprietà nella tabella codici Unicode.</span><span class="sxs-lookup"><span data-stu-id="5b035-150">Property names for version 0 property sets must be less than or equal to 256 characters, including the string terminator, for property sets in the Unicode code page.</span></span> <span data-ttu-id="5b035-151">Se non è presente nella tabella codici Unicode, è necessario che siano inferiori a 256 byte.</span><span class="sxs-lookup"><span data-stu-id="5b035-151">If not in the Unicode code page, they must be less than 256 bytes.</span></span> <span data-ttu-id="5b035-152">I set di proprietà della versione 1, d'altra parte, possono avere nomi di proprietà di lunghezza illimitata, anche se sono comunque limitati dal limite complessivo delle dimensioni del set di proprietà di 256 kilobyte (KB).</span><span class="sxs-lookup"><span data-stu-id="5b035-152">Version 1 property sets, on the other hand, can have property names of unlimited length, although they are still limited by the overall property set size limit of 256 kilobytes (KB).</span></span>

<span data-ttu-id="5b035-153">Per impostazione predefinita, è consigliabile che le implementazioni di [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) creino e gestiscano i set di proprietà della versione 0.</span><span class="sxs-lookup"><span data-stu-id="5b035-153">It is recommended that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) create and maintain version 0 property sets by default.</span></span> <span data-ttu-id="5b035-154">Se successivamente un chiamante richiede una funzionalità specifica del formato versione 1, solo la versione del set di proprietà deve essere aggiornata.</span><span class="sxs-lookup"><span data-stu-id="5b035-154">If a caller subsequently requests a feature specific to the version 1 format, only then should the version of the property set be updated.</span></span> <span data-ttu-id="5b035-155">Se, ad esempio, viene scritta una proprietà di tipo VT \_ Array o se viene scritto un nome di proprietà Long, l'implementazione deve aggiornare il formato del set di proprietà alla versione 1.</span><span class="sxs-lookup"><span data-stu-id="5b035-155">For example, if a property of type VT\_ARRAY is written or if a long property name is written, then the implementation should update the property set format to version 1.</span></span> <span data-ttu-id="5b035-156">Un'eccezione a questa linea guida si verifica se il \_ valore di enumerazione con distinzione tra maiuscole e \_ minuscole PROPSETFLAG viene specificato nella chiamata a [**IPropertySetStorage:: create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="5b035-156">One exception to this guideline occurs if the PROPSETFLAG\_CASE\_SENSITIVE enumeration value is specified in the call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="5b035-157">In questo caso, è necessario creare il set di proprietà come set di proprietà della versione 1.</span><span class="sxs-lookup"><span data-stu-id="5b035-157">In this case, the property set must be created as a version 1 property set.</span></span>

 

 