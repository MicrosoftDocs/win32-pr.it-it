---
title: Panoramica di StoClien
description: L'esempio StoClien illustra come il client usa l'archiviazione strutturata e come indirizza un componente server a usare questa risorsa di archiviazione.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Panoramica di StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106297755"
---
# <a name="stoclien-overview"></a><span data-ttu-id="e8f55-104">Panoramica di StoClien</span><span class="sxs-lookup"><span data-stu-id="e8f55-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="e8f55-105">Scopo</span><span class="sxs-lookup"><span data-stu-id="e8f55-105">Purpose</span></span>

<span data-ttu-id="e8f55-106">L'obiettivo principale dell'esempio [StoClien](structured-storage-client-sample--stoclien-.md) è il modo in cui il client usa l'archiviazione strutturata e come indica a un componente server di usare questa risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="e8f55-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="e8f55-107">L'esempio StoClien illustra un modello di programmazione di servizi di archiviazione strutturati.</span><span class="sxs-lookup"><span data-stu-id="e8f55-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="e8f55-108">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="e8f55-108">Functionality</span></span>

<span data-ttu-id="e8f55-109">La funzionalità [StoClien](structured-storage-client-sample--stoclien-.md) è simile a quella degli esempi "Scribble" in alcune versioni di Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="e8f55-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="e8f55-110">La differenza tra l'esempio StoClien e l'esempio [StoServe](structured-storage-server-sample--stoserve-.md) è un'architettura interna basata sulla tecnologia com.</span><span class="sxs-lookup"><span data-stu-id="e8f55-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="e8f55-111">Una chiara distinzione architetturale viene mantenuta tra client COM e server COM.</span><span class="sxs-lookup"><span data-stu-id="e8f55-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="e8f55-112">[StoClien](structured-storage-client-sample--stoclien-.md) carica e salva i relativi disegni nell'archivio strutturato dei file composti com.</span><span class="sxs-lookup"><span data-stu-id="e8f55-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="e8f55-113">L'esempio [StoClien](structured-storage-client-sample--stoclien-.md) crea e usa l'oggetto com della cocarta collegabile fornito come \_ componente DllPaper CLSID nel server [StoServe](structured-storage-server-sample--stoserve-.md) .</span><span class="sxs-lookup"><span data-stu-id="e8f55-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="e8f55-114">Il client StoClien crea un oggetto Copaper e lo controlla tramite l'interfaccia IPaper esposta dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e8f55-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="e8f55-115">StoClien ottiene i dati di disegno dall'utente e li rappresenta graficamente in una finestra gestita.</span><span class="sxs-lookup"><span data-stu-id="e8f55-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="e8f55-116">StoClien usa l'interfaccia IPaper di Copaper per salvare i dati di disegno in un documento e per indirizzare le operazioni di archiviazione file su questi dati.</span><span class="sxs-lookup"><span data-stu-id="e8f55-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="e8f55-117">Un oggetto COM di cocarta incapsula solo l'archiviazione basata su server dei dati della carta di disegno: non viene fornito alcun comportamento dell'interfaccia utente grafica (GUI) sul lato server.</span><span class="sxs-lookup"><span data-stu-id="e8f55-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="e8f55-118">Tutto il comportamento dell'interfaccia utente grafica è isolato nel client.</span><span class="sxs-lookup"><span data-stu-id="e8f55-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="e8f55-119">Le funzionalità di gestione e archiviazione dei dati degli oggetti di un documento sono disponibili solo tramite un'interfaccia personalizzata COM, IPaper.</span><span class="sxs-lookup"><span data-stu-id="e8f55-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="e8f55-120">[StoClien](structured-storage-client-sample--stoclien-.md) coopera con il Copaper per caricare e salvare i dati di disegno del documento.</span><span class="sxs-lookup"><span data-stu-id="e8f55-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="e8f55-121">StoClien ottiene un'interfaccia [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) per l'oggetto di archiviazione in un file composto.</span><span class="sxs-lookup"><span data-stu-id="e8f55-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="e8f55-122">Nelle operazioni di caricamento e salvataggio, StoClien passa un puntatore all'interfaccia **IStorage** per la cocarta nel server.</span><span class="sxs-lookup"><span data-stu-id="e8f55-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="e8f55-123">Il Copaper usa il **IStorage** fornito per creare flussi nell'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="e8f55-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="e8f55-124">Un documento può quindi usare l'interfaccia [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) standard per la lettura e la scrittura dei dati di disegno gestiti.</span><span class="sxs-lookup"><span data-stu-id="e8f55-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="e8f55-125">Il Copaper gestisce solo i dati di disegno; non esegue alcuna azione GUI.</span><span class="sxs-lookup"><span data-stu-id="e8f55-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="e8f55-126">[StoClien](structured-storage-client-sample--stoclien-.md) fornisce l'interfaccia utente grafica per l'applicazione di disegno.</span><span class="sxs-lookup"><span data-stu-id="e8f55-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="e8f55-127">Incapsula questo oggetto in un oggetto C++ CGuiPaper centrale.</span><span class="sxs-lookup"><span data-stu-id="e8f55-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="e8f55-128">[StoClien](structured-storage-client-sample--stoclien-.md) implementa anche l'interfaccia IPaperSink personalizzata in un oggetto com COPaperSink e connette questa interfaccia a un punto di connessione appropriato nell'oggetto della cocarta del server.</span><span class="sxs-lookup"><span data-stu-id="e8f55-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="e8f55-129">Il Copaper usa l'interfaccia IPaperSink connessa per inviare le notifiche a StoClien.</span><span class="sxs-lookup"><span data-stu-id="e8f55-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="e8f55-130">Il ridisegno della GUI normale dei dati di disegno della cocarta viene eseguito in StoClien usando la tecnologia di oggetti collegabile per la stampa.</span><span class="sxs-lookup"><span data-stu-id="e8f55-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="e8f55-131">[StoClien](structured-storage-client-sample--stoclien-.md) è un'applicazione che è possibile eseguire direttamente nel modo normale o dalla finestra del prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="e8f55-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="e8f55-132">StoClien accetta un parametro di nome file facoltativo nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="e8f55-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="e8f55-133">Nell'esempio seguente Drawing. PAP è un file composto che contiene l'archiviazione strutturata compatibile con DllPaper di dati del disegno.</span><span class="sxs-lookup"><span data-stu-id="e8f55-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="e8f55-134">Se non viene specificato alcun parametro del nome file della riga di comando, [StoClien](structured-storage-client-sample--stoclien-.md) usa il nome file predefinito StoClien. PAP e tenta di aprirlo nella stessa directory del Stoclien.exe in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e8f55-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="e8f55-135">**StoClien c: \\ \\ Drawings Drawing. pap**</span><span class="sxs-lookup"><span data-stu-id="e8f55-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="e8f55-136">Informazioni relative al supporto</span><span class="sxs-lookup"><span data-stu-id="e8f55-136">Support Information</span></span>

<span data-ttu-id="e8f55-137">Per ulteriori informazioni, descrizioni funzionali e un'esercitazione sul codice per [StoClien](structured-storage-client-sample--stoclien-.md), vedere la sezione relativa alla presentazione del codice in Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="e8f55-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="e8f55-138">Per ulteriori informazioni sul funzionamento dell'utente esterno di StoClien, vedere le sezioni utilizzo e operazione in Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="e8f55-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="e8f55-139">Per leggere Stoclient.htm, eseguire Tutorial.exe nella directory Main tutorial e fare clic sulla lezione StoClien nella tabella lessons.</span><span class="sxs-lookup"><span data-stu-id="e8f55-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="e8f55-140">In alternativa, fare clic su Stoclien.htm dopo aver individuato la directory principale dell'esercitazione in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="e8f55-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="e8f55-141">Per ulteriori informazioni sul funzionamento di [**StoServe**](structured-storage-server-sample--stoserve-.md) ed espone i servizi a StoClien, vedere Stoserve.htm nella directory principale dell'esercitazione.</span><span class="sxs-lookup"><span data-stu-id="e8f55-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="e8f55-142">Tenere presente che è necessario compilare il Stoserve.dll prima di compilare StoClien.</span><span class="sxs-lookup"><span data-stu-id="e8f55-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="e8f55-143">Il makefile per [**StoServe**](structured-storage-server-sample--stoserve-.md) registra il server nel registro di sistema, pertanto è necessario compilare [**StoServe**](structured-storage-server-sample--stoserve-.md) prima di provare a eseguire StoClien.</span><span class="sxs-lookup"><span data-stu-id="e8f55-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="e8f55-144">Per ulteriori informazioni sulla configurazione di un sistema per compilare e testare gli esempi di codice in questa serie di esercitazioni COM, vedere [How to Build Samples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="e8f55-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="e8f55-145">Il Makefile fornito è compatibile con Microsoft NMAKE.</span><span class="sxs-lookup"><span data-stu-id="e8f55-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="e8f55-146">Per creare una build di debug, eseguire il comando NMAKE nella finestra del prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="e8f55-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="e8f55-147">Per praticità, viene fornito un file di progetto per ogni esempio da utilizzare in Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e8f55-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="e8f55-148">Per caricare il progetto per l'esempio [StoClien](structured-storage-client-sample--stoclien-.md) , eseguire Visual Studio al prompt dei comandi nella directory di esempio come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="e8f55-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="e8f55-149">STOCLIEN MSDEV. DSP</span><span class="sxs-lookup"><span data-stu-id="e8f55-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="e8f55-150">È anche possibile fare doppio clic sul file Stoclient. DSP in Esplora risorse per caricare un progetto di esempio in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e8f55-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="e8f55-151">In Visual Studio è possibile esplorare le classi C++ dell'origine di esempio e in genere eseguire le altre operazioni di modifica-compilazione-debug.</span><span class="sxs-lookup"><span data-stu-id="e8f55-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="e8f55-152">Tenere presente che, nell'ambito dell'SDK del server, la compilazione di questi esempi da Visual Studio richiede l'impostazione appropriata dei percorsi di directory in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e8f55-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="e8f55-153">Per ulteriori informazioni, vedere [How to Build Samples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="e8f55-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="e8f55-154">Commenti</span><span class="sxs-lookup"><span data-stu-id="e8f55-154">Remarks</span></span>

<span data-ttu-id="e8f55-155">Prima di poter eseguire il client, è necessario compilare l'esempio client e altri esempi correlati.</span><span class="sxs-lookup"><span data-stu-id="e8f55-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="e8f55-156">Per ulteriori informazioni sulla compilazione degli esempi, vedere [How to Build Samples](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="e8f55-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="e8f55-157">Se sono stati compilati gli esempi appropriati, Stoclien.exe è l'eseguibile del client da eseguire per questo esempio.</span><span class="sxs-lookup"><span data-stu-id="e8f55-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="e8f55-158">L'applicazione Stoclien.exe fornisce l'interfaccia utente per questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="e8f55-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="e8f55-159">Viene esercitato il Stoserve.dll associato, ma indipendente, per illustrare l'utilizzo del client e del server dell'archiviazione strutturata COM nei file composti.</span><span class="sxs-lookup"><span data-stu-id="e8f55-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




