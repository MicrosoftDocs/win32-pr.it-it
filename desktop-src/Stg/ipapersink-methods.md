---
title: Metodi IPaperSink
description: Il Copaper espone l'interfaccia IConnectionPointContainer, in modo che i client possano connettersi a un documento per ricevere le notifiche degli eventi specificati che si verificano in un documento.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104223981"
---
# <a name="ipapersink-methods"></a><span data-ttu-id="0ea41-103">Metodi IPaperSink</span><span class="sxs-lookup"><span data-stu-id="0ea41-103">IPaperSink Methods</span></span>

<span data-ttu-id="0ea41-104">Il Copaper espone l'interfaccia [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) , in modo che i client possano connettersi a un documento per ricevere le notifiche degli eventi specificati che si verificano in un documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-104">COPaper exposes the [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) interface so clients can connect to COPaper in order to receive notifications of specified events that occur in COPaper.</span></span> <span data-ttu-id="0ea41-105">Esponendo questa interfaccia, il Copaper diventa un oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="0ea41-105">By exposing this interface, COPaper becomes a connectable object.</span></span> <span data-ttu-id="0ea41-106">Un client può chiamare [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per questa interfaccia e usarlo per ottenere i punti di connessione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="0ea41-106">A client can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for this interface and use it to obtain the object's connection points.</span></span> <span data-ttu-id="0ea41-107">La partecipazione client in questo schema è illustrata nell'esempio **StoClien** associato.</span><span class="sxs-lookup"><span data-stu-id="0ea41-107">The client participation in this scheme is covered in the associated **StoClien** sample.</span></span>

<span data-ttu-id="0ea41-108">In sostanza, il client implementa il cosiddetto sink sotto forma di oggetto sink con un'interfaccia sink.</span><span class="sxs-lookup"><span data-stu-id="0ea41-108">Basically, the client implements what is called a sink in the form of a sink object with a sink interface.</span></span> <span data-ttu-id="0ea41-109">L'interfaccia di sink riceve le chiamate di notifica degli eventi in uscita da un foglio di lavoro dopo che il sink è stato connesso correttamente dal client a un'istanza di Copaper.</span><span class="sxs-lookup"><span data-stu-id="0ea41-109">The sink interface receives outgoing event notification calls from COPaper after the sink is properly connected by the client to a COPaper instance.</span></span> <span data-ttu-id="0ea41-110">Il client esegue la connessione utilizzando un oggetto punto di connessione gestito da un documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-110">The client makes the connection by using a connection point object that is managed by COPaper.</span></span> <span data-ttu-id="0ea41-111">In un singolo oggetto COM collegabile possono essere presenti numerosi punti di connessione.</span><span class="sxs-lookup"><span data-stu-id="0ea41-111">There can be numerous connection points on a single connectable COM object.</span></span> <span data-ttu-id="0ea41-112">Nell'esempio **StoServe** , il Copaper dispone di un solo punto di connessione che gestisce gli eventi della carta di disegno.</span><span class="sxs-lookup"><span data-stu-id="0ea41-112">In the **StoServe** sample, COPaper has only one connection point, which handles drawing paper events.</span></span>

<span data-ttu-id="0ea41-113">Un numero qualsiasi di client può connettersi a un solo punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="0ea41-113">Any number of clients can connect to a single connection point.</span></span> <span data-ttu-id="0ea41-114">Il \_ punto di connessione PAPERSINK di CONNPOINT in un documento gestisce un gruppo di connessioni che possono aumentare dinamicamente in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="0ea41-114">The CONNPOINT\_PAPERSINK connection point in COPaper maintains a group of connections that can grow dynamically at run time.</span></span> <span data-ttu-id="0ea41-115">I dettagli completi sul supporto degli oggetti collegabili della cocarta sono codificati in file CONNECT. H e CONNECT. CPP e non verrà analizzato qui.</span><span class="sxs-lookup"><span data-stu-id="0ea41-115">The full details on COPaper's connectable object support is coded in files CONNECT.H and CONNECT.CPP and will not be covered here.</span></span> <span data-ttu-id="0ea41-116">La costruzione è molto simile a quella che è stata studiata nell'esempio di codice di conservazione.</span><span class="sxs-lookup"><span data-stu-id="0ea41-116">The construction is very similar to what was studied in the CONSERVE code sample.</span></span>

<span data-ttu-id="0ea41-117">Il client **StoClien** implementa gli oggetti sink appropriati per i punti di connessione che si prevede di trovare in un documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-117">The **StoClien** client implements appropriate sink objects for the connection points it expects to find in COPaper.</span></span> <span data-ttu-id="0ea41-118">Dal contesto del documento, l'oggetto sink importante implementato da **StoClien** espone l'interfaccia **IPaperSink** .</span><span class="sxs-lookup"><span data-stu-id="0ea41-118">From the context of COPaper, the important sink object that **StoClien** implements exposes the **IPaperSink** interface.</span></span> <span data-ttu-id="0ea41-119">Si tratta dell'interfaccia in uscita usata da Copaper per notificare **StoClien** di vari eventi in un documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-119">This is the outgoing interface used by COPaper to notify **StoClien** of various events in COPaper.</span></span>

<span data-ttu-id="0ea41-120">Di seguito è riportato un riepilogo dei metodi di **IPaperSink** da IPAPER. H nella \\ directory di pari livello Inc.</span><span class="sxs-lookup"><span data-stu-id="0ea41-120">Here is a summary of the methods in **IPaperSink** from IPAPER.H in the \\INC sibling directory.</span></span>



| <span data-ttu-id="0ea41-121">Metodo</span><span class="sxs-lookup"><span data-stu-id="0ea41-121">Method</span></span>   | <span data-ttu-id="0ea41-122">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0ea41-122">Description</span></span>                                                   |
|----------|---------------------------------------------------------------|
| <span data-ttu-id="0ea41-123">Bloccato</span><span class="sxs-lookup"><span data-stu-id="0ea41-123">Locked</span></span>   | <span data-ttu-id="0ea41-124">Un client ha assunto il controllo e bloccato il documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-124">A client has taken control of and locked the paper.</span></span>           |
| <span data-ttu-id="0ea41-125">Sbloccato</span><span class="sxs-lookup"><span data-stu-id="0ea41-125">Unlocked</span></span> | <span data-ttu-id="0ea41-126">Un client ha ceduto il controllo del documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-126">A client has relinquished control of the paper.</span></span>               |
| <span data-ttu-id="0ea41-127">Loaded</span><span class="sxs-lookup"><span data-stu-id="0ea41-127">Loaded</span></span>   | <span data-ttu-id="0ea41-128">Un client ha caricato il contenuto della carta dal relativo file composto.</span><span class="sxs-lookup"><span data-stu-id="0ea41-128">A client has loaded paper content from its own compound file.</span></span> |
| <span data-ttu-id="0ea41-129">Salvato</span><span class="sxs-lookup"><span data-stu-id="0ea41-129">Saved</span></span>    | <span data-ttu-id="0ea41-130">Un client ha salvato il contenuto cartaceo nel proprio file composto.</span><span class="sxs-lookup"><span data-stu-id="0ea41-130">A client has saved paper content to its own compound file.</span></span>    |
| <span data-ttu-id="0ea41-131">InkStart</span><span class="sxs-lookup"><span data-stu-id="0ea41-131">InkStart</span></span> | <span data-ttu-id="0ea41-132">Un client ha avviato una sequenza di disegno inchiostro a colori sul foglio.</span><span class="sxs-lookup"><span data-stu-id="0ea41-132">A client started a color ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="0ea41-133">InkDraw</span><span class="sxs-lookup"><span data-stu-id="0ea41-133">InkDraw</span></span>  | <span data-ttu-id="0ea41-134">Un client sta inserendo punti dati Ink sulla superficie della carta.</span><span class="sxs-lookup"><span data-stu-id="0ea41-134">A client is putting ink data points on the paper surface.</span></span>     |
| <span data-ttu-id="0ea41-135">InkStop</span><span class="sxs-lookup"><span data-stu-id="0ea41-135">InkStop</span></span>  | <span data-ttu-id="0ea41-136">Un client ha interrotto la sequenza di disegno input penna sulla carta.</span><span class="sxs-lookup"><span data-stu-id="0ea41-136">A client has stopped its ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="0ea41-137">Cancellati</span><span class="sxs-lookup"><span data-stu-id="0ea41-137">Erased</span></span>   | <span data-ttu-id="0ea41-138">Un client ha cancellato tutti i dati dell'input penna dal documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-138">A client has erased all ink data from the paper.</span></span>              |
| <span data-ttu-id="0ea41-139">Ridimensionata</span><span class="sxs-lookup"><span data-stu-id="0ea41-139">Resized</span></span>  | <span data-ttu-id="0ea41-140">Un client ha ridimensionato il documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-140">A client has resized the paper.</span></span>                               |



 

<span data-ttu-id="0ea41-141">Questi metodi sono ampiamente esplicativi.</span><span class="sxs-lookup"><span data-stu-id="0ea41-141">These methods are largely self-explanatory.</span></span> <span data-ttu-id="0ea41-142">Sebbene il sink debba implementare tutti questi metodi in un certo modo, molti sono implementati come stub e non vengono usati negli esempi di / **StoClien** StoServe.</span><span class="sxs-lookup"><span data-stu-id="0ea41-142">Although the sink must implement all these methods in some fashion, many are implemented as stubs and are not used in the **StoServe**/**StoClien** samples.</span></span>

<span data-ttu-id="0ea41-143">Un metodo importante utilizzato in questi esempi è il metodo Loaded.</span><span class="sxs-lookup"><span data-stu-id="0ea41-143">An important method used in these samples is the Loaded method.</span></span> <span data-ttu-id="0ea41-144">Quando viene indicato al client di caricare un nuovo disegno da un file, è necessario un modo per notificare al client quando vengono caricati i nuovi dati.</span><span class="sxs-lookup"><span data-stu-id="0ea41-144">When COPaper is told by the client to load a new drawing from file, it needs a way to notify the client when the new data is loaded.</span></span> <span data-ttu-id="0ea41-145">A tale scopo, il Copaper chiama **IPaperSink:: Loaded** sul sink client.</span><span class="sxs-lookup"><span data-stu-id="0ea41-145">To do this, COPaper Calls **IPaperSink::Loaded** on the client sink.</span></span> <span data-ttu-id="0ea41-146">Il client può quindi chiamare [**iPaper:: redisegnato**](ipaper--redraw.md) per richiedere che il Copaper riproduca i nuovi dati nel client.</span><span class="sxs-lookup"><span data-stu-id="0ea41-146">The client can then call [**IPaper::Redraw**](ipaper--redraw.md) to request that COPaper play back the new data to the client.</span></span> <span data-ttu-id="0ea41-147">Il ridisegno fa sì che il disegno caricato nella visualizzazione del client venga ridisegnato.</span><span class="sxs-lookup"><span data-stu-id="0ea41-147">Redraw causes the loaded drawing in the client's display to be repainted.</span></span> <span data-ttu-id="0ea41-148">Al termine del caricamento, il disegno appena caricato viene visualizzato automaticamente nella finestra fornita dal client.</span><span class="sxs-lookup"><span data-stu-id="0ea41-148">When the load is completed, the newly loaded drawing is displayed automatically in the window provided by the client.</span></span>

<span data-ttu-id="0ea41-149">Vedere [**iPaper:: redisegnato**](ipaper--redraw.md) per informazioni complete sulla connettività di questo metodo iPaper a **IPaperSink**.</span><span class="sxs-lookup"><span data-stu-id="0ea41-149">See [**IPaper::Redraw**](ipaper--redraw.md) for complete information of this IPaper method's connectivity to **IPaperSink**.</span></span>

<span data-ttu-id="0ea41-150">I  metodi IPaperSink **InkStart**, **InkDraw** e **InkStop** vengono usati per inviare i singoli pacchetti di dati Ink al client.</span><span class="sxs-lookup"><span data-stu-id="0ea41-150">The **IPaperSink** methods **InkStart**, **InkDraw**, and **InkStop** are used to send individual ink data packets back to the client.</span></span> <span data-ttu-id="0ea41-151">Al momento della ricezione, il client dipinge tali elementi nella visualizzazione nello stesso modo in cui sono stati originariamente inviati al documento.</span><span class="sxs-lookup"><span data-stu-id="0ea41-151">On reception, the client paints them in its display in the same manner as when it originally sent them to COPaper.</span></span> <span data-ttu-id="0ea41-152">La logica precedente è sufficientemente generale da consentire a più client che sono tutti in ascolto sullo stesso \_ punto di connessione PAPERSINK CONNPOINT.</span><span class="sxs-lookup"><span data-stu-id="0ea41-152">The above logic is general enough to allow for multiple clients that are all listening on the same CONNPOINT\_PAPERSINK connection point.</span></span> <span data-ttu-id="0ea41-153">Se un'istanza di un documento comune è stata condivisa da questi client, è possibile che tutti visualizzino lo stesso disegno connettendosi a questo punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="0ea41-153">If a common COPaper instance was shared by these clients, they could all display the same drawing by connecting to this connection point.</span></span>

 

 