---
description: Un file contrassegnato come crittografato viene crittografato dall'file system NTFS usando il driver di crittografia corrente.
ms.assetid: 166bfb8c-b97d-4cc7-bf6b-399837cb8ad0
title: Gestione di file e directory crittografati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2718656a28eb678c10076e228e08a2a95cabd1fc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103968400"
---
# <a name="handling-encrypted-files-and-directories"></a><span data-ttu-id="8cc53-103">Gestione di file e directory crittografati</span><span class="sxs-lookup"><span data-stu-id="8cc53-103">Handling Encrypted Files and Directories</span></span>

<span data-ttu-id="8cc53-104">Un programmatore o un utente può contrassegnare una directory o un file come crittografato.</span><span class="sxs-lookup"><span data-stu-id="8cc53-104">A programmer or user may mark a directory or file as encrypted.</span></span> <span data-ttu-id="8cc53-105">Un file contrassegnato come crittografato viene crittografato dall'file system NTFS usando il driver di crittografia corrente.</span><span class="sxs-lookup"><span data-stu-id="8cc53-105">A file marked encrypted is encrypted by the NTFS file system by using the current encryption driver.</span></span> <span data-ttu-id="8cc53-106">Se in un secondo momento il file viene contrassegnato come non crittografato, viene decrittografato e lasciato in uno stato di testo normale (non protetto).</span><span class="sxs-lookup"><span data-stu-id="8cc53-106">If at a later date the file is marked as not encrypted, it is decrypted and left in a plain text (unsecured) state.</span></span>

<span data-ttu-id="8cc53-107">Le directory non vengono crittografate.</span><span class="sxs-lookup"><span data-stu-id="8cc53-107">Directories are not themselves encrypted.</span></span> <span data-ttu-id="8cc53-108">Per impostazione predefinita, invece, in una directory "crittografata" tutti i nuovi file nella directory vengono crittografati al momento della creazione.</span><span class="sxs-lookup"><span data-stu-id="8cc53-108">Rather, by default, in an "encrypted" directory all new files in the directory are encrypted at creation.</span></span> <span data-ttu-id="8cc53-109">Un utente deve modificare in modo specifico lo stato di un nuovo file in decrittografato se l'utente non vuole crittografare il file.</span><span class="sxs-lookup"><span data-stu-id="8cc53-109">A user must specifically change the status of a new file to decrypted if the user does not want the file to be encrypted.</span></span> <span data-ttu-id="8cc53-110">Una directory crittografata è visibile.</span><span class="sxs-lookup"><span data-stu-id="8cc53-110">An encrypted directory is visible.</span></span> <span data-ttu-id="8cc53-111">Per rendere una directory inaccessibile ad altri utenti, utilizzare i metodi standard di controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="8cc53-111">To make a directory inaccessible to other users, use the standard methods of access control.</span></span>

<span data-ttu-id="8cc53-112">Non è possibile usare le funzioni di crittografia con l' [API di backup](/windows/desktop/Backup/backup).</span><span class="sxs-lookup"><span data-stu-id="8cc53-112">The encryption functions cannot be used with the [Backup API](/windows/desktop/Backup/backup).</span></span>

<span data-ttu-id="8cc53-113">Per crittografare un nuovo file, utilizzare la funzione [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) con il flag **\_ \_ crittografato dell'attributo file** .</span><span class="sxs-lookup"><span data-stu-id="8cc53-113">To encrypt a new file, use the [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) function with the **FILE\_ATTRIBUTE\_ENCRYPTED** flag.</span></span> <span data-ttu-id="8cc53-114">Per crittografare un file esistente, usare la funzione [**EncryptFile**](/windows/desktop/api/WinBase/nf-winbase-encryptfilea) .</span><span class="sxs-lookup"><span data-stu-id="8cc53-114">To encrypt an existing file, use the [**EncryptFile**](/windows/desktop/api/WinBase/nf-winbase-encryptfilea) function.</span></span> <span data-ttu-id="8cc53-115">Tutti i flussi di dati nel file sono crittografati.</span><span class="sxs-lookup"><span data-stu-id="8cc53-115">All data streams in the file are encrypted.</span></span> <span data-ttu-id="8cc53-116">Se il file è già crittografato, **EncryptFile** non esegue alcuna operazione ma restituisce un valore diverso da zero, che indica l'esito positivo.</span><span class="sxs-lookup"><span data-stu-id="8cc53-116">If the file is already encrypted, **EncryptFile** does nothing but returns a nonzero value, which indicates success.</span></span> <span data-ttu-id="8cc53-117">Se il file è compresso, **EncryptFile** decomprime il file prima di crittografarlo.</span><span class="sxs-lookup"><span data-stu-id="8cc53-117">If the file is compressed, **EncryptFile** decompresses the file before encrypting it.</span></span>

<span data-ttu-id="8cc53-118">Per decrittografare un file crittografato, usare la funzione [**DecryptFile**](/windows/desktop/api/WinBase/nf-winbase-decryptfilea) .</span><span class="sxs-lookup"><span data-stu-id="8cc53-118">To decrypt an encrypted file, use the [**DecryptFile**](/windows/desktop/api/WinBase/nf-winbase-decryptfilea) function.</span></span> <span data-ttu-id="8cc53-119">Se il file non è crittografato, **DecryptFile** non esegue alcuna operazione ma restituisce un valore diverso da zero che indica l'esito positivo.</span><span class="sxs-lookup"><span data-stu-id="8cc53-119">If the file is not encrypted, **DecryptFile** does nothing but returns a nonzero value indicating success.</span></span>

<span data-ttu-id="8cc53-120">La funzione [**EncryptionDisable**](/windows/desktop/api/WinEfs/nf-winefs-encryptiondisable) Disabilita o Abilita la crittografia della directory indicata e dei file al suo interno.</span><span class="sxs-lookup"><span data-stu-id="8cc53-120">The [**EncryptionDisable**](/windows/desktop/api/WinEfs/nf-winefs-encryptiondisable) function disables or enables the encryption of the indicated directory and the files in it.</span></span> <span data-ttu-id="8cc53-121">Non influisce sulla crittografia delle sottodirectory sotto la directory indicata.</span><span class="sxs-lookup"><span data-stu-id="8cc53-121">It does not affect the encryption of subdirectories below the indicated directory.</span></span>

<span data-ttu-id="8cc53-122">Per recuperare lo stato di crittografia di un file, usare la funzione [**FileEncryptionStatus**](/windows/desktop/api/WinBase/nf-winbase-fileencryptionstatusa) .</span><span class="sxs-lookup"><span data-stu-id="8cc53-122">To retrieve the encryption status of a file, use the [**FileEncryptionStatus**](/windows/desktop/api/WinBase/nf-winbase-fileencryptionstatusa) function.</span></span> <span data-ttu-id="8cc53-123">In alternativa, chiamare la funzione [**GetFileAttributes**](/windows/desktop/api/FileAPI/nf-fileapi-getfileattributesa) ed esaminare il flag di **\_ attributo \_ crittografato del file** nel valore restituito.</span><span class="sxs-lookup"><span data-stu-id="8cc53-123">Alternatively, call the [**GetFileAttributes**](/windows/desktop/api/FileAPI/nf-fileapi-getfileattributesa) function and examine the **FILE\_ATTRIBUTE\_ENCRYPTED** flag in the return value.</span></span>

<span data-ttu-id="8cc53-124">[**CopyFile**](/windows/desktop/api/WinBase/nf-winbase-copyfile) e [**CopyFileEx**](/windows/desktop/api/WinBase/nf-winbase-copyfileexa) tentano di crittografare il file di destinazione con le chiavi usate nella crittografia del file di origine.</span><span class="sxs-lookup"><span data-stu-id="8cc53-124">[**CopyFile**](/windows/desktop/api/WinBase/nf-winbase-copyfile) and [**CopyFileEx**](/windows/desktop/api/WinBase/nf-winbase-copyfileexa) attempt to encrypt the destination file with the keys used in the encryption of the source file.</span></span> <span data-ttu-id="8cc53-125">Se non è possibile eseguire questa operazione, entrambe le funzioni tentano di crittografare il file di destinazione con le chiavi predefinite.</span><span class="sxs-lookup"><span data-stu-id="8cc53-125">If this cannot be done, both functions attempt to encrypt the destination file with default keys.</span></span> <span data-ttu-id="8cc53-126">Se non è possibile eseguire entrambi questi metodi, **CopyFile** e **CopyFileEx** hanno esito negativo e si **\_ \_ è verificato** un errore di crittografia degli errori.</span><span class="sxs-lookup"><span data-stu-id="8cc53-126">If both of these methods cannot be done, **CopyFile** and **CopyFileEx** fail with an **ERROR\_ENCRYPTION\_FAILED** error.</span></span> <span data-ttu-id="8cc53-127">Se si vuole che **CopyFileEx** completi l'operazione di copia anche quando il file di destinazione non può essere crittografato, includere il flag di **\_ \_ \_ \_ destinazione Consenti decrittografia del file** nel valore del parametro *dwCopyFlags* nella chiamata a **CopyFileEx**.</span><span class="sxs-lookup"><span data-stu-id="8cc53-127">If you want **CopyFileEx** to complete the copy operation even when the destination file cannot be encrypted, include the **COPY\_FILE\_ALLOW\_DECRYPTED\_DESTINATION** flag in the value of the *dwCopyFlags* parameter in your call to **CopyFileEx**.</span></span>

 

 
