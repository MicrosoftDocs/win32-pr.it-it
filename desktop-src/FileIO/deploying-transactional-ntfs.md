---
description: Controllo della memorizzazione nella cache in Transactional NTFS.
ms.assetid: 0fd272ee-cf5f-4ba9-b8aa-ff0016f51d4b
title: Distribuzione di Transactional NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd7c44e0ad3b83854e56d18171072a7cb4615d5c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967107"
---
# <a name="deploying-transactional-ntfs"></a><span data-ttu-id="f8518-103">Distribuzione di Transactional NTFS</span><span class="sxs-lookup"><span data-stu-id="f8518-103">Deploying Transactional NTFS</span></span>

<span data-ttu-id="f8518-104">Transactional NTFS (TxF), come la maggior parte dei meccanismi di transazione, dipende dall'ordinamento corretto delle Scritture di dati.</span><span class="sxs-lookup"><span data-stu-id="f8518-104">Transactional NTFS (TxF), like most transaction mechanisms, depends upon correct ordering of data writes.</span></span> <span data-ttu-id="f8518-105">Verificare che l'ordine di scrittura appropriato richieda il controllo esplicito della memorizzazione nella cache dei dati</span><span class="sxs-lookup"><span data-stu-id="f8518-105">Ensuring proper write ordering requires explicit control of data caching.</span></span> <span data-ttu-id="f8518-106">Per soddisfare questo requisito, TxF richiede che le unità disco implementino i meccanismi di controllo della memorizzazione nella cache che fanno parte di interfacce di unità standardizzate come SCSI, SATA e ATA.</span><span class="sxs-lookup"><span data-stu-id="f8518-106">To meet this requirement, TxF requires that disk drives implement the caching control mechanisms that are part of standardized drive interfaces such as SCSI, SATA, and ATA.</span></span>

<span data-ttu-id="f8518-107">Il meccanismo di controllo della memorizzazione nella cache usato da TxF è un flag noto come funzione FUA (Force Unit Access).</span><span class="sxs-lookup"><span data-stu-id="f8518-107">The caching control mechanism used by TxF is a flag known as the Force Unit Access (FUA) function.</span></span> <span data-ttu-id="f8518-108">Questo flag specifica che l'unità deve scrivere i dati in un archivio multimediale stabile prima del completamento della segnalazione.</span><span class="sxs-lookup"><span data-stu-id="f8518-108">This flag specifies that the drive should write the data to stable media storage before signaling complete.</span></span> <span data-ttu-id="f8518-109">In alcuni punti critici all'interno di una transazione, TxF deve emettere un FUA per garantire che alcuni dati di controllo necessari per eseguire correttamente il rollback di una transazione non vadano persi se si verifica un errore di alimentazione.</span><span class="sxs-lookup"><span data-stu-id="f8518-109">At certain critical points within a transaction, TxF needs to issue an FUA to ensure that some control data necessary to successfully rollback a transaction is not lost if a power failure occurs.</span></span>

<span data-ttu-id="f8518-110">Le unità disco di classe server (SCSI e Fiber Channel) supportano in genere il flag FUA.</span><span class="sxs-lookup"><span data-stu-id="f8518-110">Server-class disk drives (SCSI and Fiber Channel) generally support the FUA flag.</span></span> <span data-ttu-id="f8518-111">A partire da vista, Windows supporta il flag FUA solo per i dischi SCSI e Fibre Channel.</span><span class="sxs-lookup"><span data-stu-id="f8518-111">Starting in Vista, Windows supports the FUA flag only for SCSI and Fiber Channel disks.</span></span>

<span data-ttu-id="f8518-112">Nelle unità di prodotti (ATA/SATA/USB) TxF presenta periodi di vulnerabilità durante i quali un'interruzione dell'alimentazione di un'unità può comportare la mancata esecuzione del rollback della transazione da parte di TxF, in modo da lasciare i dati in uno stato incoerente, a meno che la cache di scrittura dell'unità non sia disabilitata.</span><span class="sxs-lookup"><span data-stu-id="f8518-112">On commodity drives (ATA/SATA/USB), TxF has periods of vulnerability during which a drive power failure can result in TxF being unable to correctly rollback the transaction, thus leaving data in an inconsistent state unless the drive's write cache is disabled.</span></span>

<span data-ttu-id="f8518-113">Alcune schede bus host (HBA) e i controller di archiviazione (ad esempio, i sistemi RAID) dispongono di cache con supporto integrato per le batterie.</span><span class="sxs-lookup"><span data-stu-id="f8518-113">Some Host Bus Adapters (HBAs) and storage controllers (for example, RAID systems) have built-in battery-backed caches.</span></span> <span data-ttu-id="f8518-114">Poiché questi dispositivi conservano i dati memorizzati nella cache se si verifica un errore di alimentazione, non è necessario che i dischi connessi a tali dispositivi rispettino il flag FUA.</span><span class="sxs-lookup"><span data-stu-id="f8518-114">Because these devices preserve cached data if a power fault occurs, any disks connected to them are not required to honor the FUA flag.</span></span> <span data-ttu-id="f8518-115">Inoltre, un disco il cui alimentatore è protetto da un alimentatore senza interruzioni (UPS) non deve rispettare il flag FUA.</span><span class="sxs-lookup"><span data-stu-id="f8518-115">Further, a disk whose power supply is protected by an uninterruptable power supply (UPS) does not need to honor the FUA flag.</span></span> <span data-ttu-id="f8518-116">Ciò è dovuto al fatto che il gruppo di continuità manterrà il consumo di energia sufficiente affinché il disco scarichi la cache sul supporto.</span><span class="sxs-lookup"><span data-stu-id="f8518-116">This is because the UPS will maintain power long enough for the disk to flush its cache to the media.</span></span>

<span data-ttu-id="f8518-117">La disabilitazione della cache di scrittura di un'unità elimina la necessità per l'unità di rispettare il flag FUA.</span><span class="sxs-lookup"><span data-stu-id="f8518-117">Disabling a drive's write cache eliminates the requirement for the drive to honor the FUA flag.</span></span> <span data-ttu-id="f8518-118">È possibile disabilitare la memorizzazione nella cache di scrittura di un disco tramite il codice di controllo delle [**informazioni della cache del \_ set di dischi \_ \_ \_ IOCTL**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) sul disco.</span><span class="sxs-lookup"><span data-stu-id="f8518-118">You can disable a disk's write caching by issuing the [**IOCTL\_DISK\_SET\_CACHE\_INFORMATION**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) control code to the disk.</span></span> <span data-ttu-id="f8518-119">Lo stato della cache di scrittura (on/off) verrà mantenuto tra i riavvii del sistema.</span><span class="sxs-lookup"><span data-stu-id="f8518-119">The state of the write cache (on/off) will be preserved across system reboots.</span></span> <span data-ttu-id="f8518-120">Il rilascio di questo codice di controllo avrà conseguenze molto significative sulle prestazioni per tutte le I/O rilasciate su tale disco, il che probabilmente sarà un notevole calo delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="f8518-120">Issuing this control code will have very significant performance consequences for all I/O issued to that disk, which will most likely be a noticeable performance degradation.</span></span> <span data-ttu-id="f8518-121">L'uso di questo codice di controllo deve essere considerato attentamente prima della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="f8518-121">Use of this control code should be carefully considered prior to deployment.</span></span>

> [!Note]  
> <span data-ttu-id="f8518-122">Affinché TxF sia in grado di proteggere costantemente l'integrità dei dati tramite errori di alimentazione, il sistema deve soddisfare almeno uno dei criteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="f8518-122">For TxF to be capable of consistently protecting your data's integrity through power faults, the system must satisfy at least one of the following criteria:</span></span>
>
> -   <span data-ttu-id="f8518-123">Usare dischi di classe server (SCSI, Fibre Channel).</span><span class="sxs-lookup"><span data-stu-id="f8518-123">Use server-class disks (SCSI, Fiber Channel).</span></span>
> -   <span data-ttu-id="f8518-124">Assicurarsi che i dischi siano connessi a una scheda HBA di Caching con batteria.</span><span class="sxs-lookup"><span data-stu-id="f8518-124">Make sure the disks are connected to a battery-backed caching HBA.</span></span>
> -   <span data-ttu-id="f8518-125">Utilizzare un controller di archiviazione (ad esempio, sistema RAID) come dispositivo di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="f8518-125">Use a storage controller (for example, RAID system) as the storage device.</span></span>
> -   <span data-ttu-id="f8518-126">Assicurarsi che l'alimentazione del disco sia protetta da un UPS.</span><span class="sxs-lookup"><span data-stu-id="f8518-126">Ensure power to the disk is protected by a UPS.</span></span>
> -   <span data-ttu-id="f8518-127">Verificare che la funzionalità di memorizzazione nella cache in scrittura del disco sia disabilitata.</span><span class="sxs-lookup"><span data-stu-id="f8518-127">Ensure that the disk's write caching feature is disabled.</span></span>

 

 

 



