---
description: Quando vengono aggiunti, eliminati e modificati file, directory e altri oggetti di file system NTFS, il file system NTFS immette i record del journal delle modifiche nei flussi, uno per ogni volume del computer.
ms.assetid: c41aa3a8-c8d8-4bf2-9bbb-d6a6a556c5e4
title: Modificare i record del Journal
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 56580a28c01ca164af4598cb290a37c8e36828f5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317804"
---
# <a name="change-journal-records"></a><span data-ttu-id="9ebfd-103">Modificare i record del Journal</span><span class="sxs-lookup"><span data-stu-id="9ebfd-103">Change Journal Records</span></span>

<span data-ttu-id="9ebfd-104">Quando vengono aggiunti, eliminati e modificati file, directory e altri oggetti di file system NTFS, il file system NTFS immette i record del journal delle modifiche nei flussi, uno per ogni volume del computer.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-104">As files, directories, and other NTFS file system objects are added, deleted, and modified, the NTFS file system enters change journal records in streams, one for each volume on the computer.</span></span> <span data-ttu-id="9ebfd-105">In ogni record sono indicati il tipo di modifica e l'oggetto modificato.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-105">Each record indicates the type of change and the object changed.</span></span> <span data-ttu-id="9ebfd-106">L'offset dall'inizio del flusso per un record specifico viene chiamato numero di sequenza di aggiornamento (USN) per il record specifico.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-106">The offset from the beginning of the stream for a particular record is called the update sequence number (USN) for the particular record.</span></span> <span data-ttu-id="9ebfd-107">I nuovi record vengono aggiunti alla fine del flusso.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-107">New records are appended to the end of the stream.</span></span>

<span data-ttu-id="9ebfd-108">Il file system NTFS potrebbe eliminare i record obsoleti per conservare spazio.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-108">The NTFS file system may delete old records to conserve space.</span></span> <span data-ttu-id="9ebfd-109">Se sono stati eliminati record necessari, il servizio di indicizzazione esegue nuovamente l'indicizzazione del volume, come avviene quando non esiste alcun Journal delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-109">If needed records have been deleted, the indexing service recovers by re-indexing the volume, as it does when no change journal exists.</span></span>

<span data-ttu-id="9ebfd-110">Nel journal delle modifiche viene registrato solo il fatto di una modifica a un file e il motivo della modifica, ad esempio operazioni di scrittura, troncamento, allungamento, eliminazione e così via.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-110">The change journal logs only the fact of a change to a file and the reason for the change (for example, write operations, truncation, lengthening, deletion, and so on).</span></span> <span data-ttu-id="9ebfd-111">Non registra informazioni sufficienti per consentire l'inversione della modifica.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-111">It does not record enough information to allow reversing the change.</span></span>

<span data-ttu-id="9ebfd-112">Inoltre, più modifiche allo stesso file possono causare l'aggiunta di un solo flag Reason al record corrente.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-112">In addition, multiple changes to the same file may result in only one reason flag being added to the current record.</span></span> <span data-ttu-id="9ebfd-113">Se lo stesso tipo di modifica si verifica più di una volta, il file system NTFS non scrive un nuovo record per le modifiche dopo la prima.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-113">If the same kind of change occurs more than once, the NTFS file system does not write a new record for the changes after the first.</span></span> <span data-ttu-id="9ebfd-114">Ad esempio, diverse operazioni di scrittura senza operazioni di chiusura e riapertura che interessano il risultato di un solo record delle modifiche con il motivo per cui la \_ \_ sovrascrittura dei dati è impostata sul motivo del flag USN \_ .</span><span class="sxs-lookup"><span data-stu-id="9ebfd-114">For example, several write operations with no intervening close and reopen operations result in only one change record with the reason flag USN\_REASON\_DATA\_OVERWRITE set.</span></span>

<span data-ttu-id="9ebfd-115">Per illustrare il funzionamento del journal delle modifiche, si supponga che un utente acceda a un file nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="9ebfd-115">To illustrate how the change journal works, suppose a user accesses a file in the following order:</span></span>

1.  <span data-ttu-id="9ebfd-116">Scrive nel file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-116">Writes to the file.</span></span>
2.  <span data-ttu-id="9ebfd-117">Imposta il timestamp per il file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-117">Sets the time stamp for the file.</span></span>
3.  <span data-ttu-id="9ebfd-118">Scrive nel file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-118">Writes to the file.</span></span>
4.  <span data-ttu-id="9ebfd-119">Tronca il file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-119">Truncates the file.</span></span>
5.  <span data-ttu-id="9ebfd-120">Scrive nel file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-120">Writes to the file.</span></span>
6.  <span data-ttu-id="9ebfd-121">Chiude il file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-121">Closes the file.</span></span>

<span data-ttu-id="9ebfd-122">In questo caso, il file system NTFS esegue le azioni seguenti nel journal delle modifiche (dove \| indica un'operazione OR bit per bit).</span><span class="sxs-lookup"><span data-stu-id="9ebfd-122">In this case, the NTFS file system takes the following actions in the change journal (where \| indicates a bitwise OR operation).</span></span>



| <span data-ttu-id="9ebfd-123">Evento</span><span class="sxs-lookup"><span data-stu-id="9ebfd-123">Event</span></span>                                 | <span data-ttu-id="9ebfd-124">Azione file system NTFS</span><span class="sxs-lookup"><span data-stu-id="9ebfd-124">NTFS file system action</span></span>                                                                                                                                                                                                                                                    |
|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ebfd-125">Operazione di scrittura iniziale</span><span class="sxs-lookup"><span data-stu-id="9ebfd-125">Initial write operation</span></span><br/>    | <span data-ttu-id="9ebfd-126">Il file system NTFS scrive un nuovo record USN con il flag motivo di \_ \_ sovrascrittura dei dati del motivo USN \_ impostato.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-126">The NTFS file system writes a new USN record with the USN\_REASON\_DATA\_OVERWRITE reason flag set.</span></span> <span data-ttu-id="9ebfd-127">Per ulteriori informazioni sui flag di motivo possibili, vedere la struttura dei [**\_ record USN**](/windows/desktop/api/WinIoCtl/ns-winioctl-usn_record_v2) .</span><span class="sxs-lookup"><span data-stu-id="9ebfd-127">For more information on possible reason flags, see the [**USN\_RECORD**](/windows/desktop/api/WinIoCtl/ns-winioctl-usn_record_v2) structure.</span></span><br/>                                                     |
| <span data-ttu-id="9ebfd-128">Impostazione dell'indicatore di data e ora del file</span><span class="sxs-lookup"><span data-stu-id="9ebfd-128">Setting of file time stamp</span></span><br/> | <span data-ttu-id="9ebfd-129">Il file system NTFS scrive un nuovo record USN con il flag impostazione \_ motivo USN \_ \_ Sovrascrivi \| \_ motivo USN \_ motivo \_ modifica informazioni di base \_ .</span><span class="sxs-lookup"><span data-stu-id="9ebfd-129">The NTFS file system writes a new USN record with the flag setting USN\_REASON\_DATA\_OVERWRITE \| USN\_REASON\_BASIC\_INFO\_CHANGE.</span></span><br/>                                                                                                                            |
| <span data-ttu-id="9ebfd-130">Seconda operazione di scrittura</span><span class="sxs-lookup"><span data-stu-id="9ebfd-130">Second write operation</span></span><br/>     | <span data-ttu-id="9ebfd-131">Il file system NTFS non scrive un nuovo record USN.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-131">The NTFS file system does not write a new USN record.</span></span> <span data-ttu-id="9ebfd-132">Poiché la \_ \_ sovrascrittura dei dati del motivo USN \_ è già impostata per il record esistente, non viene apportata alcuna modifica al record.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-132">Because USN\_REASON\_DATA\_OVERWRITE is already set for the existing record, no changes are made to the record.</span></span><br/>                                                                                           |
| <span data-ttu-id="9ebfd-133">Troncamento file</span><span class="sxs-lookup"><span data-stu-id="9ebfd-133">File truncation</span></span><br/>            | <span data-ttu-id="9ebfd-134">Il file system NTFS scrive un nuovo record USN con il flag impostazione \_ motivo USN \_ \_ Sovrascrivi motivo \| USN \_ motivo informazioni di \_ base \_ \_ modifica \| USN \_ motivo \_ dati \_ troncamento.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-134">The NTFS file system writes a new USN record with the flag setting USN\_REASON\_DATA\_OVERWRITE \| USN\_REASON\_BASIC\_INFO\_CHANGE \| USN\_REASON\_DATA\_TRUNCATION.</span></span><br/>                                                                                           |
| <span data-ttu-id="9ebfd-135">Terza operazione di scrittura</span><span class="sxs-lookup"><span data-stu-id="9ebfd-135">Third write operation</span></span><br/>      | <span data-ttu-id="9ebfd-136">Il file system NTFS non scrive un nuovo record USN.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-136">The NTFS file system does not write a new USN record.</span></span> <span data-ttu-id="9ebfd-137">Poiché la \_ \_ sovrascrittura dei dati del motivo USN \_ è già impostata per il record esistente, non viene apportata alcuna modifica al record.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-137">Because USN\_REASON\_DATA\_OVERWRITE is already set for the existing record, no changes are made to the record.</span></span><br/>                                                                                           |
| <span data-ttu-id="9ebfd-138">Chiudi operazione</span><span class="sxs-lookup"><span data-stu-id="9ebfd-138">Close operation</span></span><br/>            | <span data-ttu-id="9ebfd-139">Se l'utente che sta apportando modifiche è l'unico utente del file, il file system NTFS scrive un nuovo record USN con l'impostazione del flag seguente: USN \_ motivo per la \_ \_ sovrascrittura del \| \_ motivo per le \_ informazioni di base \_ \_ modifica USN motivo per il \| \_ \_ \_ troncamento dei dati \| USN \_ motivo \_ chiusura.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-139">If the user making changes is the only user of the file, the NTFS file system writes a new USN record with the following flag setting: USN\_REASON\_DATA\_OVERWRITE \| USN\_REASON\_BASIC\_INFO\_CHANGE \| USN\_REASON\_DATA\_TRUNCATION \| USN\_REASON\_CLOSE.</span></span><br/> |



 

<span data-ttu-id="9ebfd-140">Il Journal delle modifiche accumula una serie di record tra la prima apertura e l'ultima chiusura di un file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-140">The change journal accumulates a series of records between the first opening and last closing of a file.</span></span> <span data-ttu-id="9ebfd-141">Per ogni record è stato impostato un nuovo flag Reason, che indica che si è verificato un nuovo tipo di modifica.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-141">Each record has a new reason flag set, indicating that a new kind of change has occurred.</span></span> <span data-ttu-id="9ebfd-142">La sequenza di record fornisce una cronologia parziale del file.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-142">The sequence of records gives a partial history of the file.</span></span> <span data-ttu-id="9ebfd-143">Il record finale, creato quando il file viene chiuso, aggiunge il \_ flag di chiusura del motivo USN \_ .</span><span class="sxs-lookup"><span data-stu-id="9ebfd-143">The final record, created when the file is closed, adds the USN\_REASON\_CLOSE flag.</span></span> <span data-ttu-id="9ebfd-144">Questo record rappresenta un riepilogo delle modifiche apportate al file ma, a differenza dei record precedenti, non indica l'ordine delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-144">This record represents a summary of changes to the file, but unlike the prior records, gives no indication of the order of the changes.</span></span>

<span data-ttu-id="9ebfd-145">L'utente successivo per accedere e modificare il file genera un nuovo record USN con un solo flag motivo.</span><span class="sxs-lookup"><span data-stu-id="9ebfd-145">The next user to access and change the file generates a new USN record with a single reason flag.</span></span>

 

 




