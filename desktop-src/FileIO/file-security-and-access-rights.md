---
description: Poiché i file sono oggetti a protezione diretta, l'accesso viene regolato dal modello di controllo di accesso che regola l'accesso a tutti gli altri oggetti a protezione diretta di Windows.
ms.assetid: 991d7d94-fae7-406f-b2e3-dee811279366
title: Sicurezza file e diritti di accesso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b161dd78c7585cf6de2781d7339787a22bde95dc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310023"
---
# <a name="file-security-and-access-rights"></a><span data-ttu-id="f7a04-103">Sicurezza file e diritti di accesso</span><span class="sxs-lookup"><span data-stu-id="f7a04-103">File Security and Access Rights</span></span>

<span data-ttu-id="f7a04-104">Poiché i file sono [oggetti a protezione diretta](/windows/desktop/SecAuthZ/securable-objects), l'accesso viene regolato dal modello di controllo di accesso che regola l'accesso a tutti gli altri oggetti a protezione diretta di Windows.</span><span class="sxs-lookup"><span data-stu-id="f7a04-104">Because files are [securable objects](/windows/desktop/SecAuthZ/securable-objects), access to them is regulated by the access-control model that governs access to all other securable objects in Windows.</span></span> <span data-ttu-id="f7a04-105">Per una spiegazione dettagliata di questo modello, vedere [Access Control](/windows/desktop/SecAuthZ/access-control).</span><span class="sxs-lookup"><span data-stu-id="f7a04-105">For a detailed explanation of this model, see [Access Control](/windows/desktop/SecAuthZ/access-control).</span></span>

<span data-ttu-id="f7a04-106">È possibile specificare un [descrittore di sicurezza](/windows/desktop/api/winnt/ns-winnt-security_descriptor) per un file o una directory quando si chiama la funzione [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**CreateDirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya)o [**CreateDirectoryEx**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) .</span><span class="sxs-lookup"><span data-stu-id="f7a04-106">You can specify a [security descriptor](/windows/desktop/api/winnt/ns-winnt-security_descriptor) for a file or directory when you call the [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**CreateDirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya), or [**CreateDirectoryEx**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) function.</span></span> <span data-ttu-id="f7a04-107">Se si specifica **null** per il parametro *lpSecurityAttributes* , il file o la directory ottiene un descrittore di sicurezza predefinito.</span><span class="sxs-lookup"><span data-stu-id="f7a04-107">If you specify **NULL** for the *lpSecurityAttributes* parameter, the file or directory gets a default security descriptor.</span></span> <span data-ttu-id="f7a04-108">Gli elenchi di controllo di accesso (ACL) nel descrittore di sicurezza predefinito per un file o una directory vengono ereditati dalla relativa directory padre.</span><span class="sxs-lookup"><span data-stu-id="f7a04-108">The access control lists (ACL) in the default security descriptor for a file or directory are inherited from its parent directory.</span></span> <span data-ttu-id="f7a04-109">Si noti che un descrittore di sicurezza predefinito viene assegnato solo quando viene appena creato un file o una directory e non quando viene rinominato o spostato.</span><span class="sxs-lookup"><span data-stu-id="f7a04-109">Note that a default security descriptor is assigned only when a file or directory is newly created, and not when it is renamed or moved.</span></span>

<span data-ttu-id="f7a04-110">Per recuperare il descrittore di sicurezza di un oggetto file o directory, chiamare la funzione [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) o [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="f7a04-110">To retrieve the security descriptor of a file or directory object, call the [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) or [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="f7a04-111">Per modificare il descrittore di sicurezza di un oggetto file o directory, chiamare la funzione [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) o [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="f7a04-111">To change the security descriptor of a file or directory object, call the [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) or [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="f7a04-112">I diritti di accesso validi per file e directory includono **l'eliminazione**, il **\_ controllo di lettura**, la scrittura dell' **\_ applicazione livello dati**, la scrittura del **\_ proprietario** e la **sincronizzazione** [dei diritti di accesso standard](/windows/desktop/SecAuthZ/standard-access-rights).</span><span class="sxs-lookup"><span data-stu-id="f7a04-112">The valid access rights for files and directories include the **DELETE**, **READ\_CONTROL**, **WRITE\_DAC**, **WRITE\_OWNER**, and **SYNCHRONIZE** [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights).</span></span> <span data-ttu-id="f7a04-113">La tabella nelle [**costanti dei diritti di accesso ai file**](file-access-rights-constants.md) elenca i diritti di accesso specifici per i file e le directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-113">The table in [**File Access Rights Constants**](file-access-rights-constants.md) lists the access rights that are specific to files and directories.</span></span>

<span data-ttu-id="f7a04-114">Sebbene il diritto di accesso **sincronizzato** venga definito nell'elenco [dei diritti di accesso standard](/windows/desktop/SecAuthZ/standard-access-rights) come diritto di specificare un handle di file in una delle funzioni di attesa, quando si usano operazioni di I/O di file asincrone è necessario attendere l'handle di evento contenuto in una struttura [**sovrapposta**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) configurata correttamente invece di usare l'handle di file con il diritto di accesso **Synchronize** per la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="f7a04-114">Although the **SYNCHRONIZE** access right is defined within the [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights) list as the right to specify a file handle in one of the wait functions, when using asynchronous file I/O operations you should wait on the event handle contained in a properly configured [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure rather than using the file handle with the **SYNCHRONIZE** access right for synchronization.</span></span>

<span data-ttu-id="f7a04-115">Di seguito sono indicati i [diritti di accesso generici](/windows/desktop/SecAuthZ/generic-access-rights) per file e directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-115">The following are the [generic access rights](/windows/desktop/SecAuthZ/generic-access-rights) for files and directories.</span></span>



<table>
<thead>
<tr class="header">
<th><span data-ttu-id="f7a04-116">Diritto di accesso</span><span class="sxs-lookup"><span data-stu-id="f7a04-116">Access right</span></span></th>
<th><span data-ttu-id="f7a04-117">Descrizione</span><span class="sxs-lookup"><span data-stu-id="f7a04-117">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="f7a04-118"><strong>FILE_GENERIC_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-118"><strong>FILE_GENERIC_EXECUTE</strong></span></span></td>
<td><dl> <span data-ttu-id="f7a04-119"><strong>FILE_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-119"><strong>FILE_EXECUTE</strong></span></span><br /><span data-ttu-id="f7a04-120">
<strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-120">
<strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="f7a04-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span></span><br /><span data-ttu-id="f7a04-122">
<strong>SINCRONIZZARE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-122">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="f7a04-123"><strong>FILE_GENERIC_READ</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-123"><strong>FILE_GENERIC_READ</strong></span></span></td>
<td><dl> <span data-ttu-id="f7a04-124"><strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-124"><strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="f7a04-125">
<strong>FILE_READ_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-125">
<strong>FILE_READ_DATA</strong></span></span><br /><span data-ttu-id="f7a04-126">
<strong>FILE_READ_EA</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-126">
<strong>FILE_READ_EA</strong></span></span><br /><span data-ttu-id="f7a04-127">
<strong>STANDARD_RIGHTS_READ</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-127">
<strong>STANDARD_RIGHTS_READ</strong></span></span><br /><span data-ttu-id="f7a04-128">
<strong>SINCRONIZZARE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-128">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="f7a04-129"><strong>FILE_GENERIC_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-129"><strong>FILE_GENERIC_WRITE</strong></span></span></td>
<td><dl> <span data-ttu-id="f7a04-130"><strong>FILE_APPEND_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-130"><strong>FILE_APPEND_DATA</strong></span></span><br /><span data-ttu-id="f7a04-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="f7a04-132">
<strong>FILE_WRITE_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-132">
<strong>FILE_WRITE_DATA</strong></span></span><br /><span data-ttu-id="f7a04-133">
<strong>FILE_WRITE_EA</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-133">
<strong>FILE_WRITE_EA</strong></span></span><br /><span data-ttu-id="f7a04-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span></span><br /><span data-ttu-id="f7a04-135">
<strong>SINCRONIZZARE</strong></span><span class="sxs-lookup"><span data-stu-id="f7a04-135">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="f7a04-136">Windows confronta i diritti di accesso richiesti e le informazioni contenute nel token di accesso del thread con le informazioni contenute nel descrittore di sicurezza dell'oggetto file o directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-136">Windows compares the requested access rights and the information in the thread's access token with the information in the file or directory object's security descriptor.</span></span> <span data-ttu-id="f7a04-137">Se il confronto non impedisce la concessione di tutti i diritti di accesso richiesti, al thread viene restituito un handle per l'oggetto e vengono concessi i diritti di accesso.</span><span class="sxs-lookup"><span data-stu-id="f7a04-137">If the comparison does not prohibit all of the requested access rights from being granted, a handle to the object is returned to the thread and the access rights are granted.</span></span> <span data-ttu-id="f7a04-138">Per ulteriori informazioni su questo processo, vedere [interazione tra thread e oggetti a protezione diretta](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span><span class="sxs-lookup"><span data-stu-id="f7a04-138">For more information about this process, see [Interaction between Threads and Securable Objects](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span></span>

<span data-ttu-id="f7a04-139">Per impostazione predefinita, l'autorizzazione per l'accesso a un file o a una directory viene controllata esclusivamente dagli ACL nel descrittore di sicurezza associato a tale file o directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-139">By default, authorization for access to a file or directory is controlled strictly by the ACLs in the security descriptor associated with that file or directory.</span></span> <span data-ttu-id="f7a04-140">In particolare, il descrittore di sicurezza di una directory padre non viene utilizzato per controllare l'accesso a un file o a una directory figlio.</span><span class="sxs-lookup"><span data-stu-id="f7a04-140">In particular, the security descriptor of a parent directory is not used to control access to any child file or directory.</span></span> <span data-ttu-id="f7a04-141">Il [diritto di accesso](/windows/desktop/SecAuthZ/access-rights-and-access-masks) all' **\_ attraversamento file** può essere applicato rimuovendo il [privilegio](/windows/desktop/SecAuthZ/privileges) **Ignora \_ \_ controllo incrociato** dagli utenti.</span><span class="sxs-lookup"><span data-stu-id="f7a04-141">The **FILE\_TRAVERSE** [access right](/windows/desktop/SecAuthZ/access-rights-and-access-masks) can be enforced by removing the **BYPASS\_TRAVERSE\_CHECKING** [privilege](/windows/desktop/SecAuthZ/privileges) from users.</span></span> <span data-ttu-id="f7a04-142">Questa operazione non è consigliata nel caso generale, in quanto molti programmi non gestiscono correttamente gli errori di attraversamento delle directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-142">This is not recommended in the general case, as many programs do not correctly handle directory traversal errors.</span></span> <span data-ttu-id="f7a04-143">L'uso principale per l'accesso ai file direttamente nelle directory consiste nell'abilitare la conformità a determinati standard POSIX IEEE e ISO quando l'interoperabilità con i sistemi UNIX è un requisito. **\_**</span><span class="sxs-lookup"><span data-stu-id="f7a04-143">The primary use for the **FILE\_TRAVERSE** access right on directories is to enable conformance to certain IEEE and ISO POSIX standards when interoperability with Unix systems is a requirement.</span></span>

<span data-ttu-id="f7a04-144">Il modello di sicurezza di Windows consente a una directory figlio di ereditare o di impedire l'ereditarietà di una o più voci ACE nel descrittore di sicurezza della directory padre.</span><span class="sxs-lookup"><span data-stu-id="f7a04-144">The Windows security model provides a way for a child directory to inherit, or to be prevented from inheriting, one or more of the ACEs in the parent directory's security descriptor.</span></span> <span data-ttu-id="f7a04-145">Ogni voce ACE contiene informazioni che determinano come ereditarle e se avranno effetto sull'oggetto directory che eredita.</span><span class="sxs-lookup"><span data-stu-id="f7a04-145">Each ACE contains information that determines how it can be inherited, and whether it will have an effect on the inheriting directory object.</span></span> <span data-ttu-id="f7a04-146">Ad esempio, alcune voci ACE ereditate controllano l'accesso all'oggetto directory ereditato e sono chiamate *voci ACE effettive*.</span><span class="sxs-lookup"><span data-stu-id="f7a04-146">For example, some inherited ACEs control access to the inherited directory object, and these are called *effective ACEs*.</span></span> <span data-ttu-id="f7a04-147">Tutte le altre voci ACE sono denominate *ACE con solo ereditarietà*.</span><span class="sxs-lookup"><span data-stu-id="f7a04-147">All other ACEs are called *inherit-only ACEs*.</span></span>

<span data-ttu-id="f7a04-148">Il modello di sicurezza di Windows applica anche l'ereditarietà automatica delle voci ACE agli oggetti figlio in base alle [regole di ereditarietà Ace](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span><span class="sxs-lookup"><span data-stu-id="f7a04-148">The Windows security model also enforces the automatic inheritance of ACEs to child objects according to the [ACE inheritance rules](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span></span> <span data-ttu-id="f7a04-149">Questa ereditarietà automatica, insieme alle informazioni sull'ereditarietà in ogni voce ACE, determina il modo in cui le restrizioni di sicurezza vengono passate alla gerarchia di directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-149">This automatic inheritance, along with the inheritance information in each ACE, determines how security restrictions are passed down the directory hierarchy.</span></span>

<span data-ttu-id="f7a04-150">Si noti che non è possibile usare una voce ACE con accesso negato per negare solo l'accesso **generico in \_ lettura** o in **\_ scrittura generico** a un file.</span><span class="sxs-lookup"><span data-stu-id="f7a04-150">Note that you cannot use an access-denied ACE to deny only **GENERIC\_READ** or only **GENERIC\_WRITE** access to a file.</span></span> <span data-ttu-id="f7a04-151">Ciò è dovuto al fatto che per gli oggetti file, i mapping generici per la scrittura **generica o \_** **generica \_** includono il diritto di accesso **Synchronize** .</span><span class="sxs-lookup"><span data-stu-id="f7a04-151">This is because for file objects, the generic mappings for both **GENERIC\_READ** or **GENERIC\_WRITE** include the **SYNCHRONIZE** access right.</span></span> <span data-ttu-id="f7a04-152">Se una voce ACE nega l'accesso in **\_ scrittura generico** a un trustee e il trustee richiede l'accesso in **\_ lettura generico** , la richiesta avrà esito negativo perché la richiesta include in modo implicito l'accesso **Synchronize** , che viene negato in modo implicito dalla voce ACE e viceversa.</span><span class="sxs-lookup"><span data-stu-id="f7a04-152">If an ACE denies **GENERIC\_WRITE** access to a trustee, and the trustee requests **GENERIC\_READ** access, the request will fail because the request implicitly includes **SYNCHRONIZE** access which is implicitly denied by the ACE, and vice versa.</span></span> <span data-ttu-id="f7a04-153">Invece di usare le voci ACE con accesso negato, usare le voci ACE consentite per consentire esplicitamente i diritti di accesso consentiti.</span><span class="sxs-lookup"><span data-stu-id="f7a04-153">Instead of using access-denied ACEs, use access-allowed ACEs to explicitly allow the permitted access rights.</span></span>

<span data-ttu-id="f7a04-154">Un altro mezzo per gestire l'accesso agli oggetti di archiviazione è la crittografia.</span><span class="sxs-lookup"><span data-stu-id="f7a04-154">Another means of managing access to storage objects is encryption.</span></span> <span data-ttu-id="f7a04-155">L'implementazione di file system crittografia in Windows è il file system crittografato o EFS.</span><span class="sxs-lookup"><span data-stu-id="f7a04-155">The implementation of file system encryption in Windows is the Encrypted File System, or EFS.</span></span> <span data-ttu-id="f7a04-156">EFS crittografa solo i file e non le directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-156">EFS encrypts only files and not directories.</span></span> <span data-ttu-id="f7a04-157">Il vantaggio della crittografia è che fornisce protezione aggiuntiva ai file applicati sui supporti e non tramite il file system e l'architettura standard di controllo di accesso di Windows.</span><span class="sxs-lookup"><span data-stu-id="f7a04-157">The advantage of encryption is that it provides additional protection to files that is applied on the media and not through the file system and the standard Windows access control architecture.</span></span> <span data-ttu-id="f7a04-158">Per ulteriori informazioni sulla crittografia dei file, vedere [crittografia dei file](file-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="f7a04-158">For more information on file encryption, see [File Encryption](file-encryption.md).</span></span>

<span data-ttu-id="f7a04-159">Nella maggior parte dei casi, la possibilità di leggere e scrivere le impostazioni di sicurezza di un oggetto file o directory è limitata ai processi in modalità kernel.</span><span class="sxs-lookup"><span data-stu-id="f7a04-159">In most cases, the ability to read and write the security settings of a file or directory object is restricted to kernel-mode processes.</span></span> <span data-ttu-id="f7a04-160">Ovviamente, non si vuole che un processo utente possa modificare la proprietà o la restrizione di accesso nel file o nella directory privata.</span><span class="sxs-lookup"><span data-stu-id="f7a04-160">Clearly, you would not want any user process to be able to change the ownership or access restriction on your private file or directory.</span></span> <span data-ttu-id="f7a04-161">Tuttavia, un'applicazione di backup non è in grado di completare il processo di backup del file se le restrizioni di accesso immesse nel file o nella directory non consentono al processo in modalità utente dell'applicazione di leggerlo.</span><span class="sxs-lookup"><span data-stu-id="f7a04-161">However, a backup application would not be able to complete its job of backing up your file if the access restrictions you have placed on your file or directory does not allow the application's user-mode process to read it.</span></span> <span data-ttu-id="f7a04-162">Le applicazioni di backup devono essere in grado di eseguire l'override delle impostazioni di sicurezza degli oggetti file e directory per garantire un backup completo.</span><span class="sxs-lookup"><span data-stu-id="f7a04-162">Backup applications must be able to override the security settings of file and directory objects to ensure a complete backup.</span></span> <span data-ttu-id="f7a04-163">Analogamente, se un'applicazione di backup tenta di scrivere una copia di backup del file tramite la copia del disco residente e si nega in modo esplicito i privilegi di scrittura al processo dell'applicazione di backup, non è possibile completare l'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="f7a04-163">Similarly, if a backup application attempts to write a backup copy of your file over the disk-resident copy, and you explicitly deny write privileges to the backup application process, the restore operation cannot complete.</span></span> <span data-ttu-id="f7a04-164">In questo caso, inoltre, l'applicazione di backup deve essere in grado di sostituire le impostazioni di controllo di accesso del file.</span><span class="sxs-lookup"><span data-stu-id="f7a04-164">In this case also, the backup application must be able to override the access control settings of your file.</span></span>

<span data-ttu-id="f7a04-165">Il **\_ \_ nome del backup se** e i privilegi di accesso per il **\_ \_ nome del ripristino** sono stati creati appositamente per offrire la possibilità di eseguire il backup delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="f7a04-165">The **SE\_BACKUP\_NAME** and **SE\_RESTORE\_NAME** access privileges were specifically created to provide this ability to backup applications.</span></span> <span data-ttu-id="f7a04-166">Se questi privilegi sono stati concessi e abilitati nel token di accesso del processo dell'applicazione di backup, è possibile chiamare [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) per aprire il file o la directory per il backup, specificando il diritto di accesso al **\_ controllo di lettura** standard come valore del parametro *dwDesiredAccess* .</span><span class="sxs-lookup"><span data-stu-id="f7a04-166">If these privileges have been granted and enabled in the access token of the backup application process, it can then call [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) to open your file or directory for backup, specifying the standard **READ\_CONTROL** access right as the value of the *dwDesiredAccess* parameter.</span></span> <span data-ttu-id="f7a04-167">Tuttavia, per identificare il processo chiamante come processo di backup, è necessario che la chiamata a **CreateFile** includa il flag di **\_ \_ \_ semantica di backup del flag file** nel parametro *dwFlagsAndAttributes* .</span><span class="sxs-lookup"><span data-stu-id="f7a04-167">However, to identify the calling process as a backup process, the call to **CreateFile** must include the **FILE\_FLAG\_BACKUP\_SEMANTICS** flag in the *dwFlagsAndAttributes* parameter.</span></span> <span data-ttu-id="f7a04-168">La sintassi completa della chiamata di funzione è la seguente:</span><span class="sxs-lookup"><span data-stu-id="f7a04-168">The full syntax of the function call is the following:</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           READ_CONTROL,               // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           OPEN_EXISTING,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="f7a04-169">Questo consentirà al processo dell'applicazione di backup di aprire il file ed eseguire l'override del controllo di sicurezza standard.</span><span class="sxs-lookup"><span data-stu-id="f7a04-169">This will allow the backup application process to open your file and override the standard security checking.</span></span> <span data-ttu-id="f7a04-170">Per ripristinare il file, l'applicazione di backup utilizzerà la sintassi di chiamata [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) seguente all'apertura del file da scrivere.</span><span class="sxs-lookup"><span data-stu-id="f7a04-170">To restore your file, the backup application would use the following [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) call syntax when opening your file to be written.</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           WRITE_OWNER | WRITE_DAC,    // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           CREATE_ALWAYS,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="f7a04-171">In alcune situazioni, un'applicazione di backup deve essere in grado di modificare le impostazioni di controllo di accesso di un file o di una directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-171">There are situations when a backup application must be able to change the access control settings of a file or directory.</span></span> <span data-ttu-id="f7a04-172">Un esempio è quando le impostazioni di controllo di accesso della copia del disco residente di un file o di una directory sono diverse dalla copia di backup.</span><span class="sxs-lookup"><span data-stu-id="f7a04-172">An example is when the access control settings of the disk-resident copy of a file or directory is different from the backup copy.</span></span> <span data-ttu-id="f7a04-173">Questo problema si verifica se queste impostazioni sono state modificate dopo il backup del file o della directory o se sono state danneggiate.</span><span class="sxs-lookup"><span data-stu-id="f7a04-173">This would happen if these settings were changed after the file or directory was backed up, or if it was corrupted.</span></span>

<span data-ttu-id="f7a04-174">Il flag per la **\_ \_ \_ semantica di backup del flag file** specificato nella chiamata a [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) consente all'applicazione di backup di leggere le impostazioni di controllo di accesso del file o della directory.</span><span class="sxs-lookup"><span data-stu-id="f7a04-174">The **FILE\_FLAG\_BACKUP\_SEMANTICS** flag specified in the call to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) gives the backup application process permission to read the access-control settings of the file or directory.</span></span> <span data-ttu-id="f7a04-175">Con questa autorizzazione, il processo dell'applicazione di backup può quindi chiamare [**GetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) e [**SetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) per la lettura e la reimpostazione delle impostazioni di controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="f7a04-175">With this permission, the backup application process can then call [**GetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) and [**SetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) to read and than reset the access-control settings.</span></span>

<span data-ttu-id="f7a04-176">Se un'applicazione di backup deve avere accesso alle [impostazioni di controllo di accesso](/windows/desktop/SecAuthZ/access-control-lists)a livello di sistema, il flag di **\_ \_ sicurezza del sistema di accesso** deve essere specificato nel valore del parametro *dwDesiredAccess* passato a [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea).</span><span class="sxs-lookup"><span data-stu-id="f7a04-176">If a backup application must have access to the system-level [access control settings](/windows/desktop/SecAuthZ/access-control-lists), the **ACCESS\_SYSTEM\_SECURITY** flag must be specified in the *dwDesiredAccess* parameter value passed to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea).</span></span>

<span data-ttu-id="f7a04-177">Le applicazioni di backup chiamano [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) per leggere i file e le directory specificati per l'operazione di ripristino e [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) per scriverli.</span><span class="sxs-lookup"><span data-stu-id="f7a04-177">Backup applications call [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) to read the files and directories specified for the restore operation, and [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) to write them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f7a04-178">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="f7a04-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f7a04-179">diritti di accesso standard</span><span class="sxs-lookup"><span data-stu-id="f7a04-179">standard access rights</span></span>](/windows/desktop/SecAuthZ/standard-access-rights)
</dt> </dl>

 

 
