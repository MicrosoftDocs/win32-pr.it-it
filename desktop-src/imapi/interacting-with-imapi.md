---
title: Interazione con IMAPi
description: Nei passaggi seguenti viene descritta una tipica interazione tra un'applicazione e IMAPi.
ms.assetid: e57a86c4-7e27-40cf-a9c1-081b3f20d9d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e68bee24cfe0724ed14d439b0789f5023338853
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103955541"
---
# <a name="interacting-with-imapi"></a><span data-ttu-id="41340-103">Interazione con IMAPi</span><span class="sxs-lookup"><span data-stu-id="41340-103">Interacting with IMAPI</span></span>

<span data-ttu-id="41340-104">Nei passaggi seguenti viene descritta una tipica interazione tra un'applicazione e IMAPi.</span><span class="sxs-lookup"><span data-stu-id="41340-104">The following steps describe a typical interaction between an application and IMAPI.</span></span>

1.  <span data-ttu-id="41340-105">Creare un'istanza di **MSDiscMasterObj** (usando **CoCreateInstance**, i puntatori intelligenti da un'importazione e così via) e richiedere l'interfaccia [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) .</span><span class="sxs-lookup"><span data-stu-id="41340-105">Create an instance of the **MSDiscMasterObj** (using **CoCreateInstance**, smart pointers from an import, and so on) and request the [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) interface.</span></span>
2.  <span data-ttu-id="41340-106">Acquisire l'accesso a IMAPi chiamando [**IDiscMaster:: Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span><span class="sxs-lookup"><span data-stu-id="41340-106">Acquire access to IMAPI by calling [**IDiscMaster::Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span></span> <span data-ttu-id="41340-107">Se la chiamata ha esito positivo, l'applicazione ha accesso completo a tutte le interfacce e i metodi implementati in **MSDiscMasterObj**.</span><span class="sxs-lookup"><span data-stu-id="41340-107">If this call succeeds, the application has full access to all the interfaces and methods implemented in **MSDiscMasterObj**.</span></span>
3.  <span data-ttu-id="41340-108">Recuperare l'enumeratore del formato master del disco utilizzando [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span><span class="sxs-lookup"><span data-stu-id="41340-108">Retrieve the disc master format enumerator using [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span></span> <span data-ttu-id="41340-109">Enumerare il set di formati supportato dall'oggetto master del disco, quindi selezionare il formato attivo.</span><span class="sxs-lookup"><span data-stu-id="41340-109">Enumerate the set of formats that the disc master object supports, then select the active format.</span></span> <span data-ttu-id="41340-110">I formati restituiti dall'enumeratore sono IID delle interfacce per [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) e [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span><span class="sxs-lookup"><span data-stu-id="41340-110">The formats returned from the enumerator are the IIDs of the interfaces for [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) and [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span></span>
4.  <span data-ttu-id="41340-111">Recuperare l'enumeratore del registratore di dischi utilizzando [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span><span class="sxs-lookup"><span data-stu-id="41340-111">Retrieve the disc recorder enumerator using [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span></span> <span data-ttu-id="41340-112">Enumerare l'elenco di masterizzatori di dischi supportati (specifici del formato attivo), quindi selezionare il registratore attivo.</span><span class="sxs-lookup"><span data-stu-id="41340-112">Enumerate the list of supported disc recorders (specific to the active format), then select the active recorder.</span></span> <span data-ttu-id="41340-113">L'interfaccia [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) rappresenta un dispositivo fisico.</span><span class="sxs-lookup"><span data-stu-id="41340-113">The [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) interface represents a physical device.</span></span>
5.  <span data-ttu-id="41340-114">Usare [**IDiscMaster::P rogressadvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) per la registrazione per i callback di stato.</span><span class="sxs-lookup"><span data-stu-id="41340-114">Use [**IDiscMaster::ProgressAdvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) to register for progress callbacks.</span></span>
6.  <span data-ttu-id="41340-115">Usare l'interfaccia per il formato selezionato per compilare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="41340-115">Use the interface for the selected format to build up content.</span></span> <span data-ttu-id="41340-116">Il contenuto viene compilato in modo incrementale, quindi è possibile aggiungere tracce o contenuto di cartelle a un disco.</span><span class="sxs-lookup"><span data-stu-id="41340-116">Content builds incrementally, so tracks or folder contents can be added to a disc piece by piece.</span></span> <span data-ttu-id="41340-117">La creazione di questo contenuto è detta *staging di un'immagine*.</span><span class="sxs-lookup"><span data-stu-id="41340-117">Building up this content is called *staging an image*.</span></span> <span data-ttu-id="41340-118">Il contenuto dell'immagine di gestione temporanea non può essere eliminato in modo incrementale (non è possibile rimuovere una traccia aggiunta), ma è possibile cancellare il contenuto di un'immagine di gestione temporanea in modo che sia possibile avviare di nuovo la gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="41340-118">The contents of the staged image cannot be incrementally deleted (you cannot remove a track that has been added), but it is possible to clear the contents of a staged image so that staging can start again.</span></span> <span data-ttu-id="41340-119">Usare [**IDiscMaster:: ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) per riavviare la gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="41340-119">Use [**IDiscMaster::ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) to restart staging.</span></span>

<span data-ttu-id="41340-120">**Per audio:  **</span><span class="sxs-lookup"><span data-stu-id="41340-120">**For Audio:  **</span></span>

1.  <span data-ttu-id="41340-121">Usare [**IRedbookDiscMaster:: CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) per indicare che è in corso l'avvio di una nuova traccia audio sul disco.</span><span class="sxs-lookup"><span data-stu-id="41340-121">Use [**IRedbookDiscMaster::CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) to indicate a new audio track is being started on the disc.</span></span>
2.  <span data-ttu-id="41340-122">Usare [**IRedbookDiscMaster:: AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) per aggiungere dati audio non elaborati a una traccia. L'applicazione può usare [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks)e [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) per recuperare le informazioni statistiche.</span><span class="sxs-lookup"><span data-stu-id="41340-122">Use [**IRedbookDiscMaster::AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) to add raw audio data to a track. The application can use [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks), and [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) to retrieve statistical information.</span></span>
3.  <span data-ttu-id="41340-123">Usare [**IRedbookDiscMaster:: CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) per chiudere una traccia audio.</span><span class="sxs-lookup"><span data-stu-id="41340-123">Use [**IRedbookDiscMaster::CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) to close an audio track.</span></span>
4.  <span data-ttu-id="41340-124">Ripetere i passaggi 1-3 fino a esaurire lo spazio o tutte le tracce audio sono state scritte.</span><span class="sxs-lookup"><span data-stu-id="41340-124">Repeat steps 1-3 until out of space or all audio tracks have been written.</span></span>

<span data-ttu-id="41340-125">**Per i dati:  **</span><span class="sxs-lookup"><span data-stu-id="41340-125">**For Data:  **</span></span>

1.  <span data-ttu-id="41340-126">Usare [**IJolietDiscMaster:: AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) per aggiungere il contenuto di una cartella all'immagine.</span><span class="sxs-lookup"><span data-stu-id="41340-126">Use [**IJolietDiscMaster::AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) to add the contents of a folder to the image.</span></span> <span data-ttu-id="41340-127">Gli elementi all'interno di una cartella vengono inseriti nella radice del file di immagine.</span><span class="sxs-lookup"><span data-stu-id="41340-127">The items within a folder are placed in the root of the image file.</span></span> <span data-ttu-id="41340-128">Usare [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) e [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) per recuperare le informazioni statistiche.</span><span class="sxs-lookup"><span data-stu-id="41340-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) and [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) to retrieve statistical information.</span></span>
2.  <span data-ttu-id="41340-129">Ripetere il passaggio precedente fino a esaurire lo spazio o tutti i dati aggiunti.</span><span class="sxs-lookup"><span data-stu-id="41340-129">Repeat the above step until out of space or all data has been added.</span></span>

<span data-ttu-id="41340-130">**Per tutti i dischi:  **</span><span class="sxs-lookup"><span data-stu-id="41340-130">**For All Discs:  **</span></span>

1.  <span data-ttu-id="41340-131">Usare [**IDiscMaster:: RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) per registrare il disco.</span><span class="sxs-lookup"><span data-stu-id="41340-131">Use [**IDiscMaster::RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) to record the disc.</span></span>
2.  <span data-ttu-id="41340-132">Chiudere la sessione IMAPi usando [**IDiscMaster:: Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span><span class="sxs-lookup"><span data-stu-id="41340-132">Close the IMAPI session using [**IDiscMaster::Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span></span> <span data-ttu-id="41340-133">Chiudendo la sessione si cancella il contenuto del Stash del disco.</span><span class="sxs-lookup"><span data-stu-id="41340-133">Closing the session clears the contents of the disc stash.</span></span>

 

 




