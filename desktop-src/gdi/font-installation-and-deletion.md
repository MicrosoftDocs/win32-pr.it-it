---
description: Un'applicazione può usare un tipo di carattere per creare testo solo se il tipo di carattere è residente in un dispositivo specificato o installato nella tabella dei tipi di carattere di sistema.
ms.assetid: b422b981-8760-4484-9965-f212287c421e
title: Installazione ed eliminazione dei tipi di carattere
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0184054973c769462ed8c1620e5534ff909576ca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994021"
---
# <a name="font-installation-and-deletion"></a><span data-ttu-id="1e96b-103">Installazione ed eliminazione dei tipi di carattere</span><span class="sxs-lookup"><span data-stu-id="1e96b-103">Font Installation and Deletion</span></span>

<span data-ttu-id="1e96b-104">Un'applicazione può usare un tipo di carattere per creare testo solo se il tipo di carattere è residente in un dispositivo specificato o installato nella tabella dei tipi di carattere di sistema.</span><span class="sxs-lookup"><span data-stu-id="1e96b-104">An application can use a font to draw text only if that font is either resident on a specified device or installed in the system font table.</span></span> <span data-ttu-id="1e96b-105">La tabella font è una matrice interna che identifica tutti i tipi di carattere non dispositivo disponibili per un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1e96b-105">The font table is an internal array that identifies all nondevice fonts that are available to an application.</span></span> <span data-ttu-id="1e96b-106">Un'applicazione può recuperare i nomi dei tipi di carattere attualmente installati in un dispositivo o archiviati nella tabella dei tipi di carattere interna chiamando le funzioni [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) o [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="1e96b-106">An application can retrieve the names of fonts currently installed on a device or stored in the internal font table by calling the [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) or [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) functions.</span></span>

<span data-ttu-id="1e96b-107">Per installare temporaneamente un tipo di carattere, chiamare [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) o [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="1e96b-107">To temporarily install a font, call [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="1e96b-108">Queste funzioni caricano un tipo di carattere archiviato in un file di risorse del tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-108">These functions load a font that is stored in a font-resource file.</span></span> <span data-ttu-id="1e96b-109">Tuttavia, si tratta di un'installazione temporanea perché, dopo un riavvio, il tipo di carattere non sarà presente.</span><span class="sxs-lookup"><span data-stu-id="1e96b-109">However, this is a temporary installation because after a reboot the font will not be present.</span></span>

<span data-ttu-id="1e96b-110">Per installare un tipo di carattere che resterà dopo il riavvio del sistema, usare uno dei metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="1e96b-110">To install a font that will remain after the system is rebooted, use one of the following methods:</span></span>

-   <span data-ttu-id="1e96b-111">Passare al pannello di controllo, fare clic sull'icona dei **tipi di carattere** e selezionare **Installa nuovi tipi di carattere** dal menu **file** .</span><span class="sxs-lookup"><span data-stu-id="1e96b-111">Go to the Control Panel, click the **Fonts** icon, and select **Install New Fonts** from the **File** menu.</span></span> <span data-ttu-id="1e96b-112">Il tipo di carattere è disponibile per un'applicazione anche prima del riavvio.</span><span class="sxs-lookup"><span data-stu-id="1e96b-112">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="1e96b-113">In una situazione di Terminal Server, tuttavia, il tipo di carattere è disponibile per la sessione corrente, ma non è disponibile per altre sessioni fino al riavvio.</span><span class="sxs-lookup"><span data-stu-id="1e96b-113">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span>
-   <span data-ttu-id="1e96b-114">Copiare il tipo di carattere nella cartella% windir% \\ fonts.</span><span class="sxs-lookup"><span data-stu-id="1e96b-114">Copy the font into the %windir%\\fonts folder.</span></span> <span data-ttu-id="1e96b-115">Quindi, passare al pannello di controllo e fare clic sull'icona dei **tipi di carattere** oppure chiamare [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) o [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="1e96b-115">Then, either go to the Control Panel and click the **Fonts** icon, or call [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="1e96b-116">Il tipo di carattere è disponibile per un'applicazione anche prima del riavvio.</span><span class="sxs-lookup"><span data-stu-id="1e96b-116">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="1e96b-117">In una situazione di Terminal Server, tuttavia, il tipo di carattere è disponibile per la sessione corrente, ma non è disponibile per altre sessioni fino al riavvio.</span><span class="sxs-lookup"><span data-stu-id="1e96b-117">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span> <span data-ttu-id="1e96b-118">Se si copia solo il tipo di carattere nella cartella% windir% \\ Fonts, il tipo di carattere sarà disponibile solo dopo il riavvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="1e96b-118">If you only copy the font into the %windir%\\fonts folder, the font will be available only after the system is rebooted.</span></span>

<span data-ttu-id="1e96b-119">Quando un'applicazione termina usando un tipo di carattere installato, deve rimuovere tale tipo di carattere chiamando la funzione [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) .</span><span class="sxs-lookup"><span data-stu-id="1e96b-119">When an application finishes using an installed font, it must remove that font by calling the [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) function.</span></span>

<span data-ttu-id="1e96b-120">Non è possibile modificare un tipo di carattere installato da una posizione diversa dalla cartella% windir% \\ Fonts quando viene caricato in una sessione attiva, inclusa la sessione 0.</span><span class="sxs-lookup"><span data-stu-id="1e96b-120">A font installed from a location other than the %windir%\\fonts folder cannot be modified when loaded in any active session, including session 0.</span></span> <span data-ttu-id="1e96b-121">Qualsiasi tentativo di modificare, sostituire o eliminare sarà pertanto bloccato.</span><span class="sxs-lookup"><span data-stu-id="1e96b-121">Any attempt to change, replace, or delete will, therefore, be blocked.</span></span> <span data-ttu-id="1e96b-122">Se è necessaria una modifica a un tipo di carattere:</span><span class="sxs-lookup"><span data-stu-id="1e96b-122">If modification to a font is necessary:</span></span>

-   <span data-ttu-id="1e96b-123">I *tipi di carattere temporanei* vengono caricati solo nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="1e96b-123">*Temporary fonts* get loaded only in the current session.</span></span> <span data-ttu-id="1e96b-124">Prima di provare le modifiche ai tipi di carattere, chiamare [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) per forzare la sessione corrente a scaricare il tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-124">Before attempting any font modifications, call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span>
-   <span data-ttu-id="1e96b-125">I *tipi di carattere permanenti* rimangono installati dopo il riavvio e vengono caricati da tutte le sessioni create.</span><span class="sxs-lookup"><span data-stu-id="1e96b-125">*Permanent fonts* remain installed after reboot and are loaded by all created sessions.</span></span> <span data-ttu-id="1e96b-126">Chiamare [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) per forzare la sessione corrente a scaricare il tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-126">Call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span> <span data-ttu-id="1e96b-127">Quindi, nella chiave del registro di sistema Font (**HKEY \_ Local \_ Machine \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Fonts**) trovare e rimuovere il valore del registro di sistema associato al tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-127">Then, in the font registry key (**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts**) find and remove the registry value associated with the font.</span></span> <span data-ttu-id="1e96b-128">Infine, riavviare il computer per assicurarsi che il tipo di carattere non venga caricato in nessuna sessione.</span><span class="sxs-lookup"><span data-stu-id="1e96b-128">Finally, reboot the machine to ensure the font isn't loaded in any session.</span></span> <span data-ttu-id="1e96b-129">Dopo il riavvio, procedere con la modifica o l'eliminazione dei tipi di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-129">After reboot, proceed with your font modification/deletion.</span></span>

<span data-ttu-id="1e96b-130">Ogni volta che un'applicazione chiama le funzioni che aggiungono ed eliminano le risorse del tipo di carattere, deve chiamare anche la funzione [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) e inviare un messaggio [**WM \_ FONTCHANGE**](wm-fontchange.md) a tutte le finestre di primo livello del sistema.</span><span class="sxs-lookup"><span data-stu-id="1e96b-130">Whenever an application calls the functions that add and delete font resources, it should also call the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function and send a [**WM\_FONTCHANGE**](wm-fontchange.md) message to all top-level windows in the system.</span></span> <span data-ttu-id="1e96b-131">Questo messaggio notifica ad altre applicazioni che la tabella dei tipi di carattere interna è stata modificata da un'applicazione che ha aggiunto o rimosso un tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1e96b-131">This message notifies other applications that the internal font table has been altered by an application that added or removed a font.</span></span>

 

 
