---
description: Per creare un metafile avanzato, è possibile usare la funzione CreateEnhMetaFile, fornendo gli argomenti appropriati.
ms.assetid: b012e50e-a7f5-4687-9833-38dacc113d77
title: Creazione di metafile migliorata
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 080c350e41e895c5d4bf834a6f407cca5907743d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103754415"
---
# <a name="enhanced-metafile-creation"></a><span data-ttu-id="5da74-103">Creazione di metafile migliorata</span><span class="sxs-lookup"><span data-stu-id="5da74-103">Enhanced Metafile Creation</span></span>

<span data-ttu-id="5da74-104">Per creare un metafile avanzato, è possibile usare la funzione [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) , fornendo gli argomenti appropriati.</span><span class="sxs-lookup"><span data-stu-id="5da74-104">You create an enhanced metafile by using the [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) function, supplying the appropriate arguments.</span></span> <span data-ttu-id="5da74-105">Il sistema utilizza questi argomenti per mantenere le dimensioni immagine, determinare se il metafile deve essere archiviato in un disco o in memoria e così via.</span><span class="sxs-lookup"><span data-stu-id="5da74-105">The system uses these arguments to maintain picture dimensions, determine whether the metafile should be stored on a disk or in memory, and so on.</span></span>

<span data-ttu-id="5da74-106">Per gestire le dimensioni immagine tra dispositivi di output, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) richiede la risoluzione del dispositivo di riferimento.</span><span class="sxs-lookup"><span data-stu-id="5da74-106">To maintain picture dimensions across output devices, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) requires the resolution of the reference device.</span></span> <span data-ttu-id="5da74-107">Questo *dispositivo di riferimento* è il dispositivo in cui è apparsa la prima immagine e il controller di dominio di *riferimento* è il *contesto di dispositivo* associato al dispositivo di riferimento.</span><span class="sxs-lookup"><span data-stu-id="5da74-107">This *reference device* is the device on which the picture first appeared, and the *reference DC* is the *device context* associated with the reference device.</span></span> <span data-ttu-id="5da74-108">Quando si chiama la funzione **CreateEnhMetaFile** , è necessario fornire un handle che identifichi il controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="5da74-108">When calling the **CreateEnhMetaFile** function, you must supply a handle that identifies this DC.</span></span> <span data-ttu-id="5da74-109">È possibile ottenere questo handle chiamando la funzione [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) o [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) .</span><span class="sxs-lookup"><span data-stu-id="5da74-109">You can get this handle by calling the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) or [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) function.</span></span> <span data-ttu-id="5da74-110">È anche possibile specificare **null** come handle per usare il dispositivo di visualizzazione corrente per il dispositivo di riferimento.</span><span class="sxs-lookup"><span data-stu-id="5da74-110">You can also specify **NULL** as the handle to use the current display device for the reference device.</span></span>

<span data-ttu-id="5da74-111">La maggior parte delle applicazioni archivia le immagini in modo permanente e quindi crea un metafile migliorato archiviato in un disco; Tuttavia, in alcuni casi questa operazione non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="5da74-111">Most applications store pictures permanently and therefore create an enhanced metafile that is stored on a disk; however, there are some instances when this is not necessary.</span></span> <span data-ttu-id="5da74-112">Ad esempio, un'applicazione per l'elaborazione di testi che fornisce funzionalità di disegno dei grafici può archiviare un grafico definito dall'utente in memoria come Enhanced Metafile, quindi copiare i bit di metafile avanzati dalla memoria nel file di documento dell'utente.</span><span class="sxs-lookup"><span data-stu-id="5da74-112">For example, a word-processing application that provides chart-drawing capabilities could store a user-defined chart in memory as an enhanced metafile and then copy the enhanced metafile bits from memory into the user's document file.</span></span> <span data-ttu-id="5da74-113">Un'applicazione che richiede un metafile archiviato in modo permanente su un disco deve fornire il nome del file quando chiama [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span><span class="sxs-lookup"><span data-stu-id="5da74-113">An application that requires a metafile that is stored permanently on a disk must supply the file name when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span> <span data-ttu-id="5da74-114">Se non si specifica un nome di file, il sistema considera automaticamente il metafile come un file temporaneo e lo archivia in memoria.</span><span class="sxs-lookup"><span data-stu-id="5da74-114">If you do not supply a file name, the system automatically treats the metafile as a temporary file and stores it in memory.</span></span>

<span data-ttu-id="5da74-115">È possibile aggiungere una descrizione di testo facoltativa a un metafile contenente le informazioni sull'immagine e sull'autore.</span><span class="sxs-lookup"><span data-stu-id="5da74-115">You can add an optional text description to a metafile containing information about the picture and the author.</span></span> <span data-ttu-id="5da74-116">Un'applicazione può visualizzare queste stringhe nella finestra di dialogo Apri file per fornire all'utente informazioni sul contenuto del metafile che consente di selezionare il file appropriato.</span><span class="sxs-lookup"><span data-stu-id="5da74-116">An application can display these strings in the File Open dialog box to provide the user with information about metafile content that will help in selecting the appropriate file.</span></span> <span data-ttu-id="5da74-117">Se un'applicazione include la descrizione del testo, deve fornire un puntatore alla stringa quando chiama [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span><span class="sxs-lookup"><span data-stu-id="5da74-117">If an application includes the text description, it must supply a pointer to the string when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span>

<span data-ttu-id="5da74-118">Quando [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) ha esito positivo, restituisce un handle che identifica un contesto di dispositivo metafile speciale.</span><span class="sxs-lookup"><span data-stu-id="5da74-118">When [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) succeeds, it returns a handle that identifies a special metafile device context.</span></span> <span data-ttu-id="5da74-119">Un contesto di dispositivo metafile è univoco in quanto è associato a un file anziché a un dispositivo di output.</span><span class="sxs-lookup"><span data-stu-id="5da74-119">A metafile device context is unique in that it is associated with a file rather than with an output device.</span></span> <span data-ttu-id="5da74-120">Quando il sistema elabora una funzione GDI che ha ricevuto un handle per un contesto di dispositivo metafile, la funzione GDI viene convertita in un record Enhanced-Metafile e il record viene accodato alla fine del metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="5da74-120">When the system processes a GDI function that received a handle to a metafile device context, it converts the GDI function into an enhanced-metafile record and appends the record to the end of the enhanced metafile.</span></span>

<span data-ttu-id="5da74-121">Una volta completata un'immagine e l'ultimo record viene aggiunto al metafile avanzato, l'applicazione può chiudere il file chiamando la funzione [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="5da74-121">After a picture is complete and the last record is appended to the enhanced metafile, the application can close the file by calling the [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) function.</span></span> <span data-ttu-id="5da74-122">Questa funzione chiude ed Elimina il contesto di dispositivo metafile speciale e restituisce un handle che identifica il metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="5da74-122">This function closes and deletes the special metafile device context and returns a handle identifying the enhanced metafile.</span></span>

<span data-ttu-id="5da74-123">Per eliminare un metafile con formato avanzato o un handle di metafile in formato avanzato, chiamare la funzione [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="5da74-123">To delete an enhanced-format metafile or an enhanced-format metafile handle, call the [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) function.</span></span>

 

 



