---
description: Il sistema gestisce una tavolozza di sistema per ogni dispositivo che usa tavolozze.
ms.assetid: 4c93ce8c-6b3a-4016-bb47-786c25b93374
title: Tavolozza di sistema
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d8738cf63eef0b77f2d184f2cf95b6550b81053
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994576"
---
# <a name="system-palette"></a><span data-ttu-id="9321e-103">Tavolozza di sistema</span><span class="sxs-lookup"><span data-stu-id="9321e-103">System Palette</span></span>

<span data-ttu-id="9321e-104">Il sistema gestisce una *tavolozza di sistema* per ogni dispositivo che usa tavolozze.</span><span class="sxs-lookup"><span data-stu-id="9321e-104">The system maintains a *system palette* for each device that uses palettes.</span></span> <span data-ttu-id="9321e-105">La tavolozza di sistema contiene i valori di colore per tutti i colori che attualmente possono essere visualizzati o disegnati dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="9321e-105">The system palette contains the color values for all colors that can currently be displayed or drawn by the device.</span></span> <span data-ttu-id="9321e-106">Oltre a visualizzare il contenuto della tavolozza di sistema, le applicazioni non possono accedere direttamente alla tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="9321e-106">Other than viewing the contents of the system palette, applications cannot access the system palette directly.</span></span> <span data-ttu-id="9321e-107">Al contrario, il sistema ha il controllo completo della tavolozza di sistema e consente l'accesso solo tramite l'uso di tavolozze logiche.</span><span class="sxs-lookup"><span data-stu-id="9321e-107">Instead, the system has complete control of the system palette and permits access only through the use of logical palettes.</span></span>

<span data-ttu-id="9321e-108">Un'applicazione può visualizzare il contenuto della tavolozza di sistema tramite la funzione [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) .</span><span class="sxs-lookup"><span data-stu-id="9321e-108">An application can view the contents of the system palette by using the [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) function.</span></span> <span data-ttu-id="9321e-109">Questa funzione recupera il contenuto di una o più voci, fino al numero totale di voci nella tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="9321e-109">This function retrieves the contents of one or more entries, up to the total number of entries in the system palette.</span></span> <span data-ttu-id="9321e-110">Il totale è sempre uguale al numero restituito per il valore SIZEPALETTE dalla funzione [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) ed è uguale alla dimensione massima per qualsiasi tavolozza logica specificata.</span><span class="sxs-lookup"><span data-stu-id="9321e-110">The total is always equal to the number returned for the SIZEPALETTE value by the [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function and is the same as the maximum size for any given logical palette.</span></span>

<span data-ttu-id="9321e-111">Sebbene le applicazioni non possano modificare i colori direttamente nella tavolozza di sistema, possono causare modifiche durante la realizzazione di tavolozze logiche.</span><span class="sxs-lookup"><span data-stu-id="9321e-111">Although applications cannot change colors in the system palette directly, they may cause changes when realizing logical palettes.</span></span> <span data-ttu-id="9321e-112">Per realizzare una tavolozza, il sistema esamina ogni colore richiesto e tenta di trovare una voce nella tavolozza di sistema che contiene una corrispondenza esatta.</span><span class="sxs-lookup"><span data-stu-id="9321e-112">To realize a palette, the system examines each requested color and attempts to find an entry in the system palette that contains an exact match.</span></span> <span data-ttu-id="9321e-113">Se il sistema trova un colore corrispondente, esegue il mapping dell'indice della tavolozza logica all'indice della tavolozza di sistema corrispondente.</span><span class="sxs-lookup"><span data-stu-id="9321e-113">If the system finds a matching color, it maps the logical palette index to the corresponding system palette index.</span></span> <span data-ttu-id="9321e-114">Se il sistema non trova una corrispondenza esatta, copia il colore richiesto in una voce della tavolozza di sistema inutilizzata prima di eseguire il mapping degli indici.</span><span class="sxs-lookup"><span data-stu-id="9321e-114">If the system does not find an exact match, it copies the requested color to an unused system palette entry before mapping the indexes.</span></span> <span data-ttu-id="9321e-115">Se sono in uso tutte le voci della tavolozza di sistema, il sistema esegue il mapping dell'indice della tavolozza logica alla voce della tavolozza di sistema il cui colore corrisponde maggiormente al colore richiesto.</span><span class="sxs-lookup"><span data-stu-id="9321e-115">If all system palette entries are in use, the system maps the logical palette index to the system palette entry whose color most closely matches the requested color.</span></span> <span data-ttu-id="9321e-116">Una volta impostato questo mapping, le applicazioni non possono eseguirne l'override.</span><span class="sxs-lookup"><span data-stu-id="9321e-116">After this mapping is set, applications cannot override it.</span></span> <span data-ttu-id="9321e-117">Ad esempio, le applicazioni non possono usare gli indici della tavolozza di sistema per specificare i colori; sono consentiti solo indici tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="9321e-117">For example, applications cannot use system palette indexes to specify colors; only logical palette indexes are permitted.</span></span>

<span data-ttu-id="9321e-118">Le applicazioni possono modificare il modo in cui viene eseguito il mapping degli indici impostando il membro **peFlags** della struttura [**PaletteEntry**](/previous-versions//dd162769(v=vs.85)) su valori selezionati durante la creazione della tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="9321e-118">Applications can modify the way indexes are mapped by setting the **peFlags** member of the [**PALETTEENTRY**](/previous-versions//dd162769(v=vs.85)) structure to selected values when creating the logical palette.</span></span> <span data-ttu-id="9321e-119">Ad esempio, il \_ flag NOCOLLAPSE PC indica al sistema di copiare immediatamente il colore richiesto in una voce della tavolozza di sistema non utilizzata, indipendentemente dal fatto che una voce della tavolozza di sistema contenga già tale colore.</span><span class="sxs-lookup"><span data-stu-id="9321e-119">For example, the PC\_NOCOLLAPSE flag directs the system to immediately copy the requested color to an unused system palette entry regardless of whether a system palette entry already contains that color.</span></span> <span data-ttu-id="9321e-120">Inoltre, il \_ flag esplicito PC indica al sistema di eseguire il mapping dell'indice della tavolozza logica a un indice della tavolozza di sistema specificato in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="9321e-120">Also, the PC\_EXPLICIT flag directs the system to map the logical palette index to an explicitly given system palette index.</span></span> <span data-ttu-id="9321e-121">(L'applicazione fornisce l'indice della tavolozza di sistema nella parola di ordine inferiore della struttura **PaletteEntry** ).</span><span class="sxs-lookup"><span data-stu-id="9321e-121">(The application gives the system palette index in the low-order word of the **PALETTEENTRY** structure.)</span></span>

<span data-ttu-id="9321e-122">Le tavolozze possono essere realizzate come tavolozza di sfondo o tavolozza specificando rispettivamente **true** o **false** per il parametro *bForceBackground* nella funzione [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) .</span><span class="sxs-lookup"><span data-stu-id="9321e-122">Palettes can be realized as either a background palette or a foreground palette by specifying **TRUE** or **FALSE** respectively for the *bForceBackground* parameter in the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) function.</span></span> <span data-ttu-id="9321e-123">Nel sistema può essere presente una sola tavolozza in primo piano alla volta.</span><span class="sxs-lookup"><span data-stu-id="9321e-123">There can be only one foreground palette in the system at a time.</span></span> <span data-ttu-id="9321e-124">Se la finestra è la finestra attualmente attiva o un discendente della finestra attualmente attiva, può realizzare una tavolozza in primo piano.</span><span class="sxs-lookup"><span data-stu-id="9321e-124">If the window is the currently active window or a descendent of the currently active window, it can realize a foreground palette.</span></span> <span data-ttu-id="9321e-125">In caso contrario, la tavolozza viene realizzata come tavolozza di sfondo indipendentemente dal valore del parametro *bForceBackground* .</span><span class="sxs-lookup"><span data-stu-id="9321e-125">Otherwise the palette is realized as a background palette regardless of the value of the *bForceBackground* parameter.</span></span> <span data-ttu-id="9321e-126">La proprietà critica di una tavolozza in primo piano è che, quando viene realizzata, può sovrascrivere tutte le voci (ad eccezione delle voci statiche) nella tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="9321e-126">The critical property of a foreground palette is that, when realized, it can overwrite all entries (except for the static entries) in the system palette.</span></span> <span data-ttu-id="9321e-127">Il sistema esegue questa operazione contrassegnando tutte le voci che non sono statiche nella tavolozza di sistema come non utilizzate prima della realizzazione di una tavolozza in primo piano, eliminando così tutte le voci utilizzate.</span><span class="sxs-lookup"><span data-stu-id="9321e-127">The system accomplishes this by marking all of the entries that are not static in the system palette as unused before the realization of a foreground palette, thereby eliminating all of the used entries.</span></span> <span data-ttu-id="9321e-128">Non viene eseguita alcuna pre-elaborazione nella tavolozza di sistema per la realizzazione di una tavolozza in background.</span><span class="sxs-lookup"><span data-stu-id="9321e-128">No preprocessing occurs on the system palette for a background palette realization.</span></span> <span data-ttu-id="9321e-129">La tavolozza in primo piano imposta tutti i possibili colori non statici.</span><span class="sxs-lookup"><span data-stu-id="9321e-129">The foreground palette sets all of the possible nonstatic colors.</span></span> <span data-ttu-id="9321e-130">Le tavolozze in background possono impostare solo gli elementi che restano aperti e vengono classificate in ordine di priorità in primo piano.</span><span class="sxs-lookup"><span data-stu-id="9321e-130">Background palettes can set only what remains open and are prioritized in a first-come, first-serve manner.</span></span> <span data-ttu-id="9321e-131">In genere, le applicazioni utilizzano tavolozze in background per le finestre figlio che realizzano singole tavolozze.</span><span class="sxs-lookup"><span data-stu-id="9321e-131">Typically, applications use background palettes for child windows which realize their own individual palettes.</span></span> <span data-ttu-id="9321e-132">Questo consente di ridurre al minimo il numero di modifiche apportate alla tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="9321e-132">This helps minimize the number of changes that occur to the system palette.</span></span>

<span data-ttu-id="9321e-133">Una voce della tavolozza di sistema inutilizzata è qualsiasi voce non riservata e non contiene un colore statico.</span><span class="sxs-lookup"><span data-stu-id="9321e-133">An unused system palette entry is any entry that is not reserved and does not contain a static color.</span></span> <span data-ttu-id="9321e-134">Le voci riservate sono contrassegnate in modo esplicito con il \_ valore riservato PC.</span><span class="sxs-lookup"><span data-stu-id="9321e-134">Reserved entries are explicitly marked with the PC\_RESERVED value.</span></span> <span data-ttu-id="9321e-135">Queste voci vengono create quando un'applicazione realizza una tavolozza logica per l'animazione della tavolozza.</span><span class="sxs-lookup"><span data-stu-id="9321e-135">These entries are created when an application realizes a logical palette for palette animation.</span></span> <span data-ttu-id="9321e-136">Le voci di colore statiche vengono create dal sistema e corrispondono ai colori nella tavolozza predefinita.</span><span class="sxs-lookup"><span data-stu-id="9321e-136">Static color entries are created by the system and correspond to the colors in the default palette.</span></span> <span data-ttu-id="9321e-137">La funzione [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) può essere utilizzata per recuperare il valore NUMRESERVED, che specifica il numero di voci della tavolozza di sistema riservate per i colori statici.</span><span class="sxs-lookup"><span data-stu-id="9321e-137">The [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) function can be used to retrieve the NUMRESERVED value, which specifies the number of system palette entries reserved for static colors.</span></span>

<span data-ttu-id="9321e-138">Poiché la tavolozza di sistema ha un numero limitato di voci, la selezione e la realizzazione di una tavolozza logica per un determinato dispositivo potrebbero influire sui colori associati ad altre tavolozze logiche per lo stesso dispositivo.</span><span class="sxs-lookup"><span data-stu-id="9321e-138">Because the system palette has a limited number of entries, selecting and realizing a logical palette for a given device may affect the colors associated with other logical palettes for the same device.</span></span> <span data-ttu-id="9321e-139">Queste modifiche ai colori sono particolarmente drammatiche quando si verificano sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="9321e-139">These color changes are especially dramatic when they occur on the display.</span></span> <span data-ttu-id="9321e-140">Un'applicazione può verificare che vengano utilizzati colori ragionevoli per la tavolozza logica attualmente selezionata reimpostando la tavolozza prima di ogni utilizzo.</span><span class="sxs-lookup"><span data-stu-id="9321e-140">An application can make sure that reasonable colors are used for its currently selected logical palette by resetting the palette before each use.</span></span> <span data-ttu-id="9321e-141">Un'applicazione Reimposta la tavolozza chiamando le funzioni [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) .</span><span class="sxs-lookup"><span data-stu-id="9321e-141">An application resets the palette by calling the [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions.</span></span> <span data-ttu-id="9321e-142">Utilizzando queste funzioni, il sistema esegue il mapping dei colori della tavolozza logica ai colori ragionevoli della tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="9321e-142">Using these functions causes the system to remap the colors in the logical palette to reasonable colors in the system palette.</span></span>

 

 
