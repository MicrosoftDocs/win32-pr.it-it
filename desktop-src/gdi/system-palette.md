---
description: Il sistema gestisce una tavolozza di sistema per ogni dispositivo che usa tavolozze.
ms.assetid: 4c93ce8c-6b3a-4016-bb47-786c25b93374
title: Tavolozza di sistema
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d8738cf63eef0b77f2d184f2cf95b6550b81053
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994576"
---
# <a name="system-palette"></a>Tavolozza di sistema

Il sistema gestisce una *tavolozza di sistema* per ogni dispositivo che usa tavolozze. La tavolozza di sistema contiene i valori di colore per tutti i colori che attualmente possono essere visualizzati o disegnati dal dispositivo. Oltre a visualizzare il contenuto della tavolozza di sistema, le applicazioni non possono accedere direttamente alla tavolozza di sistema. Al contrario, il sistema ha il controllo completo della tavolozza di sistema e consente l'accesso solo tramite l'uso di tavolozze logiche.

Un'applicazione può visualizzare il contenuto della tavolozza di sistema tramite la funzione [**GetSystemPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteentries) . Questa funzione recupera il contenuto di una o più voci, fino al numero totale di voci nella tavolozza di sistema. Il totale è sempre uguale al numero restituito per il valore SIZEPALETTE dalla funzione [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) ed è uguale alla dimensione massima per qualsiasi tavolozza logica specificata.

Sebbene le applicazioni non possano modificare i colori direttamente nella tavolozza di sistema, possono causare modifiche durante la realizzazione di tavolozze logiche. Per realizzare una tavolozza, il sistema esamina ogni colore richiesto e tenta di trovare una voce nella tavolozza di sistema che contiene una corrispondenza esatta. Se il sistema trova un colore corrispondente, esegue il mapping dell'indice della tavolozza logica all'indice della tavolozza di sistema corrispondente. Se il sistema non trova una corrispondenza esatta, copia il colore richiesto in una voce della tavolozza di sistema inutilizzata prima di eseguire il mapping degli indici. Se sono in uso tutte le voci della tavolozza di sistema, il sistema esegue il mapping dell'indice della tavolozza logica alla voce della tavolozza di sistema il cui colore corrisponde maggiormente al colore richiesto. Una volta impostato questo mapping, le applicazioni non possono eseguirne l'override. Ad esempio, le applicazioni non possono usare gli indici della tavolozza di sistema per specificare i colori; sono consentiti solo indici tavolozza logica.

Le applicazioni possono modificare il modo in cui viene eseguito il mapping degli indici impostando il membro **peFlags** della struttura [**PaletteEntry**](/previous-versions//dd162769(v=vs.85)) su valori selezionati durante la creazione della tavolozza logica. Ad esempio, il \_ flag NOCOLLAPSE PC indica al sistema di copiare immediatamente il colore richiesto in una voce della tavolozza di sistema non utilizzata, indipendentemente dal fatto che una voce della tavolozza di sistema contenga già tale colore. Inoltre, il \_ flag esplicito PC indica al sistema di eseguire il mapping dell'indice della tavolozza logica a un indice della tavolozza di sistema specificato in modo esplicito. (L'applicazione fornisce l'indice della tavolozza di sistema nella parola di ordine inferiore della struttura **PaletteEntry** ).

Le tavolozze possono essere realizzate come tavolozza di sfondo o tavolozza specificando rispettivamente **true** o **false** per il parametro *bForceBackground* nella funzione [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette) . Nel sistema può essere presente una sola tavolozza in primo piano alla volta. Se la finestra è la finestra attualmente attiva o un discendente della finestra attualmente attiva, può realizzare una tavolozza in primo piano. In caso contrario, la tavolozza viene realizzata come tavolozza di sfondo indipendentemente dal valore del parametro *bForceBackground* . La proprietà critica di una tavolozza in primo piano è che, quando viene realizzata, può sovrascrivere tutte le voci (ad eccezione delle voci statiche) nella tavolozza di sistema. Il sistema esegue questa operazione contrassegnando tutte le voci che non sono statiche nella tavolozza di sistema come non utilizzate prima della realizzazione di una tavolozza in primo piano, eliminando così tutte le voci utilizzate. Non viene eseguita alcuna pre-elaborazione nella tavolozza di sistema per la realizzazione di una tavolozza in background. La tavolozza in primo piano imposta tutti i possibili colori non statici. Le tavolozze in background possono impostare solo gli elementi che restano aperti e vengono classificate in ordine di priorità in primo piano. In genere, le applicazioni utilizzano tavolozze in background per le finestre figlio che realizzano singole tavolozze. Questo consente di ridurre al minimo il numero di modifiche apportate alla tavolozza di sistema.

Una voce della tavolozza di sistema inutilizzata è qualsiasi voce non riservata e non contiene un colore statico. Le voci riservate sono contrassegnate in modo esplicito con il \_ valore riservato PC. Queste voci vengono create quando un'applicazione realizza una tavolozza logica per l'animazione della tavolozza. Le voci di colore statiche vengono create dal sistema e corrispondono ai colori nella tavolozza predefinita. La funzione [**GetDeviceCaps**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) può essere utilizzata per recuperare il valore NUMRESERVED, che specifica il numero di voci della tavolozza di sistema riservate per i colori statici.

Poiché la tavolozza di sistema ha un numero limitato di voci, la selezione e la realizzazione di una tavolozza logica per un determinato dispositivo potrebbero influire sui colori associati ad altre tavolozze logiche per lo stesso dispositivo. Queste modifiche ai colori sono particolarmente drammatiche quando si verificano sullo schermo. Un'applicazione può verificare che vengano utilizzati colori ragionevoli per la tavolozza logica attualmente selezionata reimpostando la tavolozza prima di ogni utilizzo. Un'applicazione Reimposta la tavolozza chiamando le funzioni [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) . Utilizzando queste funzioni, il sistema esegue il mapping dei colori della tavolozza logica ai colori ragionevoli della tavolozza di sistema.

 

 
