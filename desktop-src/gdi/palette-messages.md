---
description: Le modifiche alla tavolozza di sistema per il dispositivo di visualizzazione possono avere effetti significativi e talvolta indesiderati sui colori usati in Windows sul desktop.
ms.assetid: 9c470b6f-c0d3-462e-9649-1f39b06bd543
title: Messaggi tavolozza
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f19a5458ec89d8d9a0524fd2ec383de740c0179
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104978450"
---
# <a name="palette-messages"></a><span data-ttu-id="ebdfd-103">Messaggi tavolozza</span><span class="sxs-lookup"><span data-stu-id="ebdfd-103">Palette Messages</span></span>

<span data-ttu-id="ebdfd-104">Le modifiche alla tavolozza di sistema per il dispositivo di visualizzazione possono avere effetti significativi e talvolta indesiderati sui colori usati in Windows sul desktop.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-104">Changes to the system palette for the display device can have dramatic and sometimes undesirable effects on the colors used in windows on the desktop.</span></span> <span data-ttu-id="ebdfd-105">Per ridurre al minimo l'effetto di queste modifiche, il sistema fornisce un set di messaggi che consentono alle applicazioni di gestire le tavolozze logiche garantendo al contempo che i colori nella finestra attiva siano il più vicino possibile ai colori previsti.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-105">To minimize the impact of these changes, the system provides a set of messages that help applications manage their logical palettes while ensuring that colors in the active window are as close as possible to the colors intended.</span></span>

<span data-ttu-id="ebdfd-106">Il sistema invia un messaggio [**WM \_ QUERYNEWPALETTE**](wm-querynewpalette.md) a una finestra di primo livello o sovrapposta appena prima di attivare la finestra.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-106">The system sends a [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message to a top-level or overlapped window just before activating the window.</span></span> <span data-ttu-id="ebdfd-107">Questo messaggio fornisce a un'applicazione la possibilità di selezionare e realizzare la relativa tavolozza logica in modo che riceva il migliore mapping possibile dei colori per la tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-107">This message gives an application the opportunity to select and realize its logical palette so that it receives the best possible mapping of colors for its logical palette.</span></span> <span data-ttu-id="ebdfd-108">Quando l'applicazione riceve il messaggio, deve usare le funzioni [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject)e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) per selezionare e realizzare la tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-108">When the application receives the message, it should use the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject), and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions to select and realize the logical palette.</span></span> <span data-ttu-id="ebdfd-109">In questo modo, il sistema deve aggiornare i colori nella tavolozza di sistema in modo che i colori corrispondano a tutti i colori disponibili nella tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-109">Doing so directs the system to update colors in the system palette so that its colors match as many colors in the logical palette as possible.</span></span>

<span data-ttu-id="ebdfd-110">Quando un'applicazione causa modifiche alla tavolozza di sistema in seguito alla realizzazione della tavolozza logica, il sistema invia un messaggio [**WM \_ PALETTECHANGED**](wm-palettechanged.md) a tutte le finestre di primo livello e sovrapposte.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-110">When an application causes changes to the system palette as a result of realizing its logical palette, the system sends a [**WM\_PALETTECHANGED**](wm-palettechanged.md) message to all top-level and overlapped windows.</span></span> <span data-ttu-id="ebdfd-111">Questo messaggio offre alle applicazioni la possibilità di aggiornare i colori nelle aree client delle rispettive finestre, sostituendo i colori che sono stati modificati con colori che corrispondono maggiormente ai colori desiderati.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-111">This message gives applications the opportunity to update the colors in the client areas of their windows, replacing colors that have changed with colors that more closely match the intended colors.</span></span> <span data-ttu-id="ebdfd-112">Un'applicazione che riceve il **messaggio WM \_ PALETTECHANGED** deve usare [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) per reimpostare le tavolozze logiche associate a tutte le finestre inattive e quindi aggiornare i colori nell'area client per ogni finestra inattiva usando la funzione [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) .</span><span class="sxs-lookup"><span data-stu-id="ebdfd-112">An application that receives the **WM\_PALETTECHANGED** message should use [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) to reset the logical palettes associated with all inactive windows and then update the colors in the client area for each inactive window by using the [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function.</span></span> <span data-ttu-id="ebdfd-113">Questa tecnica non garantisce il maggior numero di corrispondenze esatte dei colori; Tuttavia, garantisce la mappatura dei colori della tavolozza logica ai colori ragionevoli della tavolozza di sistema.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-113">This technique does not guarantee the greatest number of exact color matches; however, it does ensure that colors in the logical palette are mapped to reasonable colors in the system palette.</span></span>

> [!Note]  
> <span data-ttu-id="ebdfd-114">Per evitare di creare un ciclo infinito, un'applicazione non deve mai realizzare la tavolozza per la finestra il cui handle corrisponde all'handle passato nel parametro *wParam* del messaggio [**WM \_ PALETTECHANGED**](wm-palettechanged.md) .</span><span class="sxs-lookup"><span data-stu-id="ebdfd-114">To avoid creating an infinite loop, an application should never realize the palette for the window whose handle matches the handle passed in the *wParam* parameter of the [**WM\_PALETTECHANGED**](wm-palettechanged.md) message.</span></span>

 

<span data-ttu-id="ebdfd-115">La funzione [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) aggiorna in genere un'area client di una finestra inattiva più velocemente rispetto al ridisegno dell'area.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-115">The [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function typically updates a client area of an inactive window faster than redrawing the area.</span></span> <span data-ttu-id="ebdfd-116">Tuttavia, poiché **UpdateColors** esegue la conversione dei colori in base al colore di ogni pixel prima che la tavolozza di sistema venga modificata, ogni chiamata a questa funzione comporta la perdita di una certa accuratezza del colore.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-116">However, because **UpdateColors** performs color translation based on the color of each pixel before the system palette changed, each call to this function results in the loss of some color accuracy.</span></span> <span data-ttu-id="ebdfd-117">Ciò significa che non è possibile usare **UpdateColors** per aggiornare i colori quando la finestra diventa attiva.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-117">This means **UpdateColors** cannot be used to update colors when the window becomes active.</span></span> <span data-ttu-id="ebdfd-118">In questi casi, l'applicazione deve ricreare l'area client.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-118">In such cases, the application should redraw the client area.</span></span>

<span data-ttu-id="ebdfd-119">Il sistema può inviare il messaggio [**WM \_ QUERYNEWPALETTE**](wm-querynewpalette.md) quando vengono apportate modifiche alla tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-119">The system may send the [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message when changes to the logical palette are made.</span></span> <span data-ttu-id="ebdfd-120">Inoltre, il sistema può inviare il messaggio [**WM \_ PALETTEISCHANGING**](wm-paletteischanging.md) a tutte le finestre di primo livello e sovrapposte quando la tavolozza di sistema sta per cambiare.</span><span class="sxs-lookup"><span data-stu-id="ebdfd-120">Also, the system may send the [**WM\_PALETTEISCHANGING**](wm-paletteischanging.md) message to all top-level and overlapped windows when the system palette is about to change.</span></span>

 

 



