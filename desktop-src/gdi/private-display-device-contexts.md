---
description: Un contesto di dispositivo privato consente a un'applicazione di evitare il recupero e l'inizializzazione di un contesto di dispositivo di visualizzazione ogni volta che l'applicazione deve creare in una finestra.
ms.assetid: 8de5a14b-a8b3-42a5-81f3-bf3c357052cb
title: Contesti di dispositivo di visualizzazione privati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 451dbd3c0a232610026740d0ea0fa817ea2034b8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528285"
---
# <a name="private-display-device-contexts"></a><span data-ttu-id="d4090-103">Contesti di dispositivo di visualizzazione privati</span><span class="sxs-lookup"><span data-stu-id="d4090-103">Private Display Device Contexts</span></span>

<span data-ttu-id="d4090-104">Un *contesto di dispositivo privato* consente a un'applicazione di evitare il recupero e l'inizializzazione di un contesto di dispositivo di visualizzazione ogni volta che l'applicazione deve creare in una finestra.</span><span class="sxs-lookup"><span data-stu-id="d4090-104">A *private device context* enables an application to avoid retrieving and initializing a display device context each time the application must draw in a window.</span></span> <span data-ttu-id="d4090-105">I contesti di dispositivi privati sono utili per Windows che richiedono molte modifiche ai valori degli attributi del contesto di dispositivo per prepararlo per il disegno.</span><span class="sxs-lookup"><span data-stu-id="d4090-105">Private device contexts are useful for windows that require many changes to the values of the attributes of the device context to prepare it for drawing.</span></span> <span data-ttu-id="d4090-106">I contesti di dispositivi privati riducono il tempo necessario per preparare il contesto di dispositivo e quindi il tempo necessario per eseguire il disegno nella finestra.</span><span class="sxs-lookup"><span data-stu-id="d4090-106">Private device contexts reduce the time required to prepare the device context and therefore the time needed to carry out drawing in the window.</span></span>

<span data-ttu-id="d4090-107">Un'applicazione indica al sistema di creare un contesto di dispositivo privato per una finestra specificando lo \_ stile cs OWNDC nella classe Window.</span><span class="sxs-lookup"><span data-stu-id="d4090-107">An application directs the system to create a private device context for a window by specifying the CS\_OWNDC style in the window class.</span></span> <span data-ttu-id="d4090-108">Il sistema crea un contesto di dispositivo privato univoco ogni volta che viene creata una nuova finestra appartenente alla classe.</span><span class="sxs-lookup"><span data-stu-id="d4090-108">The system creates a unique private device context each time it creates a new window belonging to the class.</span></span> <span data-ttu-id="d4090-109">Inizialmente, il contesto di dispositivo privato ha gli stessi valori predefiniti per gli attributi di un contesto di dispositivo comune, ma l'applicazione può modificarli in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="d4090-109">Initially, the private device context has the same default values for attributes as a common device context, but the application can modify these at any time.</span></span> <span data-ttu-id="d4090-110">Il sistema conserva le modifiche apportate al contesto di dispositivo per la durata della finestra o fino a quando l'applicazione non apporta modifiche aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="d4090-110">The system preserves changes to the device context for the life of the window or until the application makes additional changes.</span></span>

<span data-ttu-id="d4090-111">Un'applicazione può recuperare un handle per il contesto di dispositivo privato utilizzando la funzione [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) in qualsiasi momento dopo la creazione della finestra.</span><span class="sxs-lookup"><span data-stu-id="d4090-111">An application can retrieve a handle to the private device context by using the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) function any time after the window is created.</span></span> <span data-ttu-id="d4090-112">L'applicazione deve recuperare l'handle una sola volta.</span><span class="sxs-lookup"><span data-stu-id="d4090-112">The application must retrieve the handle only once.</span></span> <span data-ttu-id="d4090-113">In seguito, può contenere e utilizzare l'handle per un numero qualsiasi di volte.</span><span class="sxs-lookup"><span data-stu-id="d4090-113">Thereafter, it can keep and use the handle any number of times.</span></span> <span data-ttu-id="d4090-114">Poiché un contesto di dispositivo privato non fa parte della cache del contesto del dispositivo di visualizzazione, un'applicazione non deve mai rilasciare il contesto di dispositivo tramite la funzione [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) .</span><span class="sxs-lookup"><span data-stu-id="d4090-114">Because a private device context is not part of the display device context cache, an application need never release the device context by using the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function.</span></span>

<span data-ttu-id="d4090-115">Il sistema regola automaticamente il contesto di dispositivo in modo da riflettere le modifiche apportate alla finestra, ad esempio lo spostare o il ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="d4090-115">The system automatically adjusts the device context to reflect changes to the window, such as moving or sizing.</span></span> <span data-ttu-id="d4090-116">In questo modo si garantisce che tutte le finestre sovrapposte vengano sempre ritagliate correttamente; ovvero non è richiesta alcuna azione da parte dell'applicazione per garantire il ritaglio.</span><span class="sxs-lookup"><span data-stu-id="d4090-116">This ensures that any overlapping windows are always properly clipped; that is, no action is required by the application to ensure clipping.</span></span> <span data-ttu-id="d4090-117">Tuttavia, il sistema non modifica il contesto di dispositivo per includere l'area di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="d4090-117">However, the system does not revise the device context to include the update region.</span></span> <span data-ttu-id="d4090-118">Pertanto, quando si elabora un messaggio di [**\_ disegno WM**](wm-paint.md) , l'applicazione deve incorporare l'area di aggiornamento chiamando [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) o recuperando l'area di aggiornamento e intersecando l'area di visualizzazione corrente.</span><span class="sxs-lookup"><span data-stu-id="d4090-118">Therefore, when processing a [**WM\_PAINT**](wm-paint.md) message, the application must incorporate the update region either by calling [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) or by retrieving the update region and intersecting it with the current clipping region.</span></span> <span data-ttu-id="d4090-119">Se l'applicazione non chiama **BeginPaint**, deve convalidare in modo esplicito l'area di aggiornamento utilizzando la funzione [**ValidateRect**](/windows/desktop/api/Winuser/nf-winuser-validaterect) o [**ValidateRgn**](/windows/desktop/api/Winuser/nf-winuser-validatergn) .</span><span class="sxs-lookup"><span data-stu-id="d4090-119">If the application does not call **BeginPaint**, it must explicitly validate the update region by using the [**ValidateRect**](/windows/desktop/api/Winuser/nf-winuser-validaterect) or [**ValidateRgn**](/windows/desktop/api/Winuser/nf-winuser-validatergn) function.</span></span> <span data-ttu-id="d4090-120">Se l'applicazione non convalida l'area di aggiornamento, la finestra riceve una serie infinita di messaggi di **\_ disegno WM** .</span><span class="sxs-lookup"><span data-stu-id="d4090-120">If the application does not validate the update region, the window receives an endless series of **WM\_PAINT** messages.</span></span>

<span data-ttu-id="d4090-121">Poiché [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) nasconde il punto di inserimento se viene visualizzato in una finestra, un'applicazione che chiama **BeginPaint** deve chiamare anche la funzione [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) per ripristinare il punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="d4090-121">Because [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) hides the caret if a window is showing it, an application that calls **BeginPaint** should also call the [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) function to restore the caret.</span></span> <span data-ttu-id="d4090-122">**EndPaint** non ha alcun effetto su un contesto di dispositivo privato.</span><span class="sxs-lookup"><span data-stu-id="d4090-122">**EndPaint** has no other effect on a private device context.</span></span>

<span data-ttu-id="d4090-123">Anche se un contesto di dispositivo privato è pratico da usare, è un utilizzo intensivo della memoria in termini di risorse di sistema, che richiedono 800 o più byte da archiviare.</span><span class="sxs-lookup"><span data-stu-id="d4090-123">Although a private device context is convenient to use, it is memory-intensive in terms of system resources, requiring 800 or more bytes to store.</span></span> <span data-ttu-id="d4090-124">Quando considerazioni sulle prestazioni superano i costi di archiviazione, è consigliabile usare contesti di dispositivo privati.</span><span class="sxs-lookup"><span data-stu-id="d4090-124">Private device contexts are recommended when performance considerations outweigh storage costs.</span></span>

<span data-ttu-id="d4090-125">Il sistema include il contesto di dispositivo privato durante l'invio del messaggio [**WM \_ ERASEBKGND**](../winmsg/wm-erasebkgnd.md) all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d4090-125">The system includes the private device context when sending the [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) message to the application.</span></span> <span data-ttu-id="d4090-126">Le selezioni correnti del contesto di dispositivo privato, inclusa la modalità di mapping, sono attive quando l'applicazione o il sistema elabora questi messaggi.</span><span class="sxs-lookup"><span data-stu-id="d4090-126">The current selections of the private device context, including mapping mode, are in effect when the application or the system processes these messages.</span></span> <span data-ttu-id="d4090-127">Per evitare effetti indesiderati, il sistema utilizza coordinate logiche quando si cancella lo sfondo; ad esempio, usa la funzione [**GetClipBox**](/windows/desktop/api/Wingdi/nf-wingdi-getclipbox) per recuperare le coordinate logiche dell'area da cancellare e passa queste coordinate alla funzione [**fillRect**](/windows/desktop/api/Winuser/nf-winuser-fillrect) .</span><span class="sxs-lookup"><span data-stu-id="d4090-127">To avoid undesirable effects, the system uses logical coordinates when erasing the background; for example, it uses the [**GetClipBox**](/windows/desktop/api/Wingdi/nf-wingdi-getclipbox) function to retrieve the logical coordinates of the area to erase and passes these coordinates to the [**FillRect**](/windows/desktop/api/Winuser/nf-winuser-fillrect) function.</span></span> <span data-ttu-id="d4090-128">Le applicazioni che elaborano questi messaggi possono utilizzare tecniche simili.</span><span class="sxs-lookup"><span data-stu-id="d4090-128">Applications that process these messages can use similar techniques.</span></span>

<span data-ttu-id="d4090-129">Un'applicazione può usare la funzione [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) per forzare il sistema a restituire un contesto di dispositivo comune per la finestra con un contesto di dispositivo privato.</span><span class="sxs-lookup"><span data-stu-id="d4090-129">An application can use the [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function to force the system to return a common device context for the window that has a private device context.</span></span> <span data-ttu-id="d4090-130">Questa operazione è utile per eseguire rapidi ritocchi a una finestra senza modificare i valori correnti degli attributi del contesto di dispositivo privato.</span><span class="sxs-lookup"><span data-stu-id="d4090-130">This is useful for carrying out quick touch-ups to a window without changing the current values of the attributes of the private device context.</span></span>

 

 
