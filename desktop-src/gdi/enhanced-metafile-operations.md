---
description: "È possibile usare l'handle per un metafile migliorato per eseguire le attività seguenti:"
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Operazioni di Metafile avanzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130779"
---
# <a name="enhanced-metafile-operations"></a><span data-ttu-id="14d6b-103">Operazioni di Metafile avanzate</span><span class="sxs-lookup"><span data-stu-id="14d6b-103">Enhanced Metafile Operations</span></span>

<span data-ttu-id="14d6b-104">È possibile usare l'handle per un metafile migliorato per eseguire le attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="14d6b-104">You can use the handle to an enhanced metafile to accomplish the following tasks:</span></span>

-   <span data-ttu-id="14d6b-105">Visualizza l'immagine archiviata in un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-105">Display the picture stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="14d6b-106">Creazione di copie di un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-106">Create copies of an enhanced metafile.</span></span>
-   <span data-ttu-id="14d6b-107">Modificare un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-107">Edit an enhanced metafile.</span></span>
-   <span data-ttu-id="14d6b-108">Recuperare la descrizione facoltativa archiviata in un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-108">Retrieve the optional description stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="14d6b-109">Recuperare una copia di un'intestazione Enhanced Metafile.</span><span class="sxs-lookup"><span data-stu-id="14d6b-109">Retrieve a copy of an enhanced-metafile header.</span></span>
-   <span data-ttu-id="14d6b-110">Recuperare una versione binaria di un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-110">Retrieve a binary version of an enhanced metafile.</span></span>
-   <span data-ttu-id="14d6b-111">Enumerare i colori nella tavolozza facoltativa.</span><span class="sxs-lookup"><span data-stu-id="14d6b-111">Enumerate the colors in the optional palette.</span></span>

<span data-ttu-id="14d6b-112">Queste attività vengono descritte nelle sezioni della parte restante di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="14d6b-112">These tasks are discussed in the sections in the remainder of this topic.</span></span>

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a><span data-ttu-id="14d6b-113">Visualizza l'immagine archiviata in un metafile avanzato</span><span class="sxs-lookup"><span data-stu-id="14d6b-113">Display the Picture Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="14d6b-114">È possibile visualizzare l'immagine archiviata in un metafile migliorato usando la funzione [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="14d6b-114">You can display the picture stored in an enhanced metafile using the [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) function.</span></span> <span data-ttu-id="14d6b-115">Passare alla funzione un handle per il metafile migliorato, senza preoccuparsi del formato dei record di metafile avanzati.</span><span class="sxs-lookup"><span data-stu-id="14d6b-115">Pass the function a handle to the enhanced metafile, without being concerned with the format of the enhanced metafile records.</span></span> <span data-ttu-id="14d6b-116">Tuttavia, a volte è consigliabile enumerare i record del metafile migliorato per cercare una particolare funzione GDI e modificare i parametri della funzione in qualche modo.</span><span class="sxs-lookup"><span data-stu-id="14d6b-116">However, it is sometimes desirable to enumerate the records in the enhanced metafile to search for a particular GDI function and modify the parameters of the function in some manner.</span></span> <span data-ttu-id="14d6b-117">A tale scopo, è possibile utilizzare [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) e fornire una funzione di callback, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), per elaborare i record metafile avanzati.</span><span class="sxs-lookup"><span data-stu-id="14d6b-117">To do this, you can use [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) and provide a callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), to process the enhanced metafile records.</span></span> <span data-ttu-id="14d6b-118">Per modificare i parametri per un record di metafile avanzato, è necessario essere a conoscenza del formato dei parametri all'interno del record.</span><span class="sxs-lookup"><span data-stu-id="14d6b-118">To modify the parameters for an enhanced metafile record, you must know the format of the parameters within the record.</span></span>

## <a name="create-copies-of-an-enhanced-metafile"></a><span data-ttu-id="14d6b-119">Creazione di copie di un metafile avanzato</span><span class="sxs-lookup"><span data-stu-id="14d6b-119">Create Copies of an Enhanced Metafile</span></span>

<span data-ttu-id="14d6b-120">Alcune applicazioni creano copie di un file di backup temporaneo (o duplicate) prima di consentire all'utente di modificare l'originale.</span><span class="sxs-lookup"><span data-stu-id="14d6b-120">Some applications create temporary backup (or duplicate) copies of a file before enabling the user to alter the original.</span></span> <span data-ttu-id="14d6b-121">Un'applicazione può creare una copia di backup di un metafile migliorato chiamando la funzione [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) , fornendo un handle che identifica il metafile migliorato e fornendo un puntatore al nome del nuovo file.</span><span class="sxs-lookup"><span data-stu-id="14d6b-121">An application can create a backup copy of an enhanced metafile by calling the [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) function, supplying a handle that identifies the enhanced metafile, and supplying a pointer to the name of the new file.</span></span>

<span data-ttu-id="14d6b-122">Per creare un metafile in formato avanzato basato sulla memoria, chiamare la funzione [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) .</span><span class="sxs-lookup"><span data-stu-id="14d6b-122">To create a memory-based enhanced-format metafile, call the [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) function.</span></span>

## <a name="edit-an-enhanced-metafile"></a><span data-ttu-id="14d6b-123">Modificare un metafile avanzato</span><span class="sxs-lookup"><span data-stu-id="14d6b-123">Edit an Enhanced Metafile</span></span>

<span data-ttu-id="14d6b-124">La maggior parte delle applicazioni di disegno, illustrazione e progettazione assistita da computer (CAD) richiede un mezzo per modificare un'immagine archiviata in un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-124">Most drawing, illustration, and computer-aided design (CAD) applications require a means of editing a picture stored in an enhanced metafile.</span></span> <span data-ttu-id="14d6b-125">Anche se la modifica di un metafile avanzato è un'attività complessa, è possibile usare la funzione [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) in combinazione con altre funzioni per fornire questa funzionalità nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="14d6b-125">Although editing an enhanced metafile is a complex task, you can use the [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) function in combination with other functions to provide this capability in your application.</span></span> <span data-ttu-id="14d6b-126">La funzione **EnumEnhMetaFile** e la funzione di callback associata, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), consentono all'applicazione di elaborare singoli record in un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-126">The **EnumEnhMetaFile** function and its associated callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), enable the application to process individual records in an enhanced metafile.</span></span>

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a><span data-ttu-id="14d6b-127">Recuperare la descrizione facoltativa archiviata in un metafile avanzato</span><span class="sxs-lookup"><span data-stu-id="14d6b-127">Retrieve the Optional Description Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="14d6b-128">In alcune applicazioni viene visualizzata la descrizione testuale di un metafile migliorato con il nome file corrispondente nella finestra di dialogo **Apri** .</span><span class="sxs-lookup"><span data-stu-id="14d6b-128">Some applications display the text description of an enhanced metafile with the corresponding file name in the **Open** dialog box.</span></span> <span data-ttu-id="14d6b-129">È possibile determinare se questa stringa è presente in un metafile migliorato recuperando l'intestazione metafile con la funzione [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) ed esaminando uno dei relativi membri.</span><span class="sxs-lookup"><span data-stu-id="14d6b-129">You can determine whether this string exists in an enhanced metafile by retrieving the metafile header with the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examining one of its members.</span></span> <span data-ttu-id="14d6b-130">Se la stringa esiste, l'applicazione la recupera chiamando la funzione [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) .</span><span class="sxs-lookup"><span data-stu-id="14d6b-130">If the string exists, the application retrieves it by calling the [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) function.</span></span>

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a><span data-ttu-id="14d6b-131">Recuperare una versione binaria di un metafile avanzato</span><span class="sxs-lookup"><span data-stu-id="14d6b-131">Retrieve a Binary Version of an Enhanced Metafile</span></span>

<span data-ttu-id="14d6b-132">È possibile recuperare il contenuto di un metafile chiamando la funzione [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) . Tuttavia, prima di recuperare il contenuto, è necessario specificare le dimensioni del file.</span><span class="sxs-lookup"><span data-stu-id="14d6b-132">You can retrieve the contents of a metafile by calling the [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) function; however, before retrieving the contents, you must specify the size of the file.</span></span> <span data-ttu-id="14d6b-133">Per ottenere le dimensioni, è possibile usare la funzione [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) ed esaminare il membro appropriato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-133">To get the size, you can use the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examine the appropriate member.</span></span>

## <a name="enumerate-the-colors-in-the-optional-palette"></a><span data-ttu-id="14d6b-134">Enumerare i colori nella tavolozza facoltativa</span><span class="sxs-lookup"><span data-stu-id="14d6b-134">Enumerate the Colors in the Optional Palette</span></span>

<span data-ttu-id="14d6b-135">Per ottenere colori coerenti quando un'immagine viene visualizzata in diversi dispositivi di output, è possibile chiamare la funzione [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) e archiviare una tavolozza logica in un metafile avanzato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-135">To achieve consistent colors when a picture is displayed on various output devices, you can call the [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) function and store a logical palette in an enhanced metafile.</span></span> <span data-ttu-id="14d6b-136">Un'applicazione che Visualizza l'immagine archiviata nel metafile avanzato recupera questa tavolozza e chiama la funzione [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) prima di visualizzare l'immagine.</span><span class="sxs-lookup"><span data-stu-id="14d6b-136">An application that displays the picture stored in the enhanced metafile retrieves this palette and calls the [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) function before displaying the picture.</span></span> <span data-ttu-id="14d6b-137">Per determinare se una tavolozza è archiviata in un metafile migliorato, recuperare l'intestazione metafile ed esaminare il membro appropriato.</span><span class="sxs-lookup"><span data-stu-id="14d6b-137">To determine whether a palette is stored in an enhanced metafile, retrieve the metafile header and examine the appropriate member.</span></span> <span data-ttu-id="14d6b-138">Se è presente una tavolozza, è possibile chiamare la funzione [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) per recuperare la tavolozza logica.</span><span class="sxs-lookup"><span data-stu-id="14d6b-138">If a palette exists, you can call the [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) function to retrieve the logical palette.</span></span>

 

 
