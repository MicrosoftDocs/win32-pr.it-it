---
description: In genere, un'applicazione viene disegnata in una finestra in risposta a un \_ messaggio di disegno WM.
ms.assetid: b2317ce9-e775-450e-91f5-00f735f256a3
title: Messaggio di WM_PAINT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a69f7dab736972d8b7226890144efd8763de856a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104995120"
---
# <a name="the-wm_paint-message"></a><span data-ttu-id="3f521-103">Messaggio di \_ disegno WM</span><span class="sxs-lookup"><span data-stu-id="3f521-103">The WM\_PAINT Message</span></span>

<span data-ttu-id="3f521-104">In genere, un'applicazione viene disegnata in una finestra in risposta a un messaggio di [**\_ disegno WM**](wm-paint.md) .</span><span class="sxs-lookup"><span data-stu-id="3f521-104">Typically, an application draws in a window in response to a [**WM\_PAINT**](wm-paint.md) message.</span></span> <span data-ttu-id="3f521-105">Il sistema invia questo messaggio a una procedura della finestra quando le modifiche apportate alla finestra hanno modificato il contenuto dell'area client.</span><span class="sxs-lookup"><span data-stu-id="3f521-105">The system sends this message to a window procedure when changes to the window have altered the content of the client area.</span></span> <span data-ttu-id="3f521-106">Il sistema invia il messaggio solo se non sono presenti altri messaggi nella coda di messaggi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3f521-106">The system sends the message only if there are no other messages in the application message queue.</span></span>

<span data-ttu-id="3f521-107">Al momento della ricezione di un messaggio di [**\_ disegno WM**](wm-paint.md) , un'applicazione può chiamare [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) per recuperare il contesto del dispositivo di visualizzazione per l'area client e utilizzarlo nelle chiamate alle funzioni GDI per eseguire tutte le operazioni di disegno necessarie per aggiornare l'area client.</span><span class="sxs-lookup"><span data-stu-id="3f521-107">Upon receiving a [**WM\_PAINT**](wm-paint.md) message, an application can call [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) to retrieve the display device context for the client area and use it in calls to GDI functions to carry out whatever drawing operations are necessary to update the client area.</span></span> <span data-ttu-id="3f521-108">Dopo aver completato le operazioni di disegno, l'applicazione chiama la funzione [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) per rilasciare il contesto del dispositivo di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="3f521-108">After completing the drawing operations, the application calls the [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) function to release the display device context.</span></span>

<span data-ttu-id="3f521-109">Prima che [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) restituisca il contesto del dispositivo di visualizzazione, il sistema prepara il contesto di dispositivo per la finestra specificata.</span><span class="sxs-lookup"><span data-stu-id="3f521-109">Before [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) returns the display device context, the system prepares the device context for the specified window.</span></span> <span data-ttu-id="3f521-110">Innanzitutto, imposta l'area di ridimensionamento affinché il contesto di dispositivo sia uguale all'intersezione della parte della finestra che deve essere aggiornata e alla parte visibile per l'utente.</span><span class="sxs-lookup"><span data-stu-id="3f521-110">It first sets the clipping region for the device context to be equal to the intersection of the portion of the window that needs updating and the portion that is visible to the user.</span></span> <span data-ttu-id="3f521-111">Vengono ridisegnato solo le parti della finestra modificate.</span><span class="sxs-lookup"><span data-stu-id="3f521-111">Only those portions of the window that have changed are redrawn.</span></span> <span data-ttu-id="3f521-112">I tentativi di estrazione al di fuori di questa area vengono ritagliati e non vengono visualizzati sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="3f521-112">Attempts to draw outside this region are clipped and do not appear on the screen.</span></span>

<span data-ttu-id="3f521-113">Il sistema può anche inviare messaggi [**WM \_ NCPAINT**](wm-ncpaint.md) e [**WM \_ ERASEBKGND**](../winmsg/wm-erasebkgnd.md) alla routine della finestra prima che [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) restituisca.</span><span class="sxs-lookup"><span data-stu-id="3f521-113">The system can also send [**WM\_NCPAINT**](wm-ncpaint.md) and [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) messages to the window procedure before [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) returns.</span></span> <span data-ttu-id="3f521-114">Questi messaggi indirizzano l'applicazione per creare l'area non client e lo sfondo della finestra.</span><span class="sxs-lookup"><span data-stu-id="3f521-114">These messages direct the application to draw the nonclient area and window background.</span></span> <span data-ttu-id="3f521-115">L' *area non client* è la parte di una finestra che si trova al di fuori dell'area client.</span><span class="sxs-lookup"><span data-stu-id="3f521-115">The *nonclient area* is the part of a window that is outside of the client area.</span></span> <span data-ttu-id="3f521-116">L'area include funzionalità quali la barra del titolo, il menu finestra (noto anche come menu di **sistema** ) e le barre di scorrimento.</span><span class="sxs-lookup"><span data-stu-id="3f521-116">The area includes features such as the title bar, window menu (also known as the **System** menu), and scroll bars.</span></span> <span data-ttu-id="3f521-117">La maggior parte delle applicazioni si basa sulla funzione finestra predefinita, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), per creare quest'area e quindi passare il messaggio **WM \_ NCPAINT** a questa funzione.</span><span class="sxs-lookup"><span data-stu-id="3f521-117">Most applications rely on the default window function, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), to draw this area and therefore pass the **WM\_NCPAINT** message to this function.</span></span> <span data-ttu-id="3f521-118">Lo *sfondo della finestra* è il colore o il motivo per cui una finestra viene riempita prima che vengano avviate altre operazioni di disegno.</span><span class="sxs-lookup"><span data-stu-id="3f521-118">The *window background* is the color or pattern that a window is filled with before other drawing operations begin.</span></span> <span data-ttu-id="3f521-119">Lo sfondo copre tutte le immagini precedentemente presenti nella finestra o sullo schermo sotto la finestra.</span><span class="sxs-lookup"><span data-stu-id="3f521-119">The background covers any images previously in the window or on the screen under the window.</span></span> <span data-ttu-id="3f521-120">Se una finestra appartiene a una classe della finestra con un pennello per lo sfondo della classe, la funzione **DefWindowProc** disegna automaticamente lo sfondo della finestra.</span><span class="sxs-lookup"><span data-stu-id="3f521-120">If a window belongs to a window class having a class background brush, the **DefWindowProc** function draws the window background automatically.</span></span>

<span data-ttu-id="3f521-121">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) riempie una struttura [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) con informazioni quali le dimensioni della parte della finestra da aggiornare e un flag che indica se lo sfondo della finestra è stato disegnato.</span><span class="sxs-lookup"><span data-stu-id="3f521-121">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) fills a [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) structure with information such as the dimensions of the portion of the window to be updated and a flag indicating whether the window background has been drawn.</span></span> <span data-ttu-id="3f521-122">L'applicazione può utilizzare queste informazioni per ottimizzare il disegno.</span><span class="sxs-lookup"><span data-stu-id="3f521-122">The application can use this information to optimize drawing.</span></span> <span data-ttu-id="3f521-123">Ad esempio, può usare le dimensioni dell'area di aggiornamento, specificate dal membro **rcPaint** , per limitare il disegno solo alle parti della finestra che devono essere aggiornate.</span><span class="sxs-lookup"><span data-stu-id="3f521-123">For example, it can use the dimensions of the update region, specified by the **rcPaint** member, to limit drawing to only those portions of the window that need updating.</span></span> <span data-ttu-id="3f521-124">Se un'applicazione dispone di un output molto semplice, può ignorare l'area di aggiornamento e creare nell'intera finestra, basandosi sul sistema per eliminare (ritagliare) qualsiasi output non necessario.</span><span class="sxs-lookup"><span data-stu-id="3f521-124">If an application has very simple output, it can ignore the update region and draw in the entire window, relying on the system to discard (clip) any unneeded output.</span></span> <span data-ttu-id="3f521-125">Poiché il disegno delle clip di sistema che si estende al di fuori dell'area di visualizzazione, è visibile solo il disegno che si trova nell'area di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="3f521-125">Because the system clips drawing that extends outside the clipping region, only drawing that is in the update region is visible.</span></span>

<span data-ttu-id="3f521-126">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) imposta l'area di aggiornamento di una finestra su **null**.</span><span class="sxs-lookup"><span data-stu-id="3f521-126">[**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) sets the update region of a window to **NULL**.</span></span> <span data-ttu-id="3f521-127">Questa operazione cancella l'area e impedisce la generazione di messaggi [**di \_ disegno WM**](wm-paint.md) successivi.</span><span class="sxs-lookup"><span data-stu-id="3f521-127">This clears the region, preventing it from generating subsequent [**WM\_PAINT**](wm-paint.md) messages.</span></span> <span data-ttu-id="3f521-128">Se un'applicazione elabora un messaggio di **\_ disegno WM** ma non chiama **BeginPaint** o cancella altrimenti l'area di aggiornamento, l'applicazione continua a ricevere i messaggi di **\_ disegno WM** finché l'area non è vuota.</span><span class="sxs-lookup"><span data-stu-id="3f521-128">If an application processes a **WM\_PAINT** message but does not call **BeginPaint** or otherwise clear the update region, the application continues to receive **WM\_PAINT** messages as long as the region is not empty.</span></span> <span data-ttu-id="3f521-129">In tutti i casi, un'applicazione deve cancellare l'area di aggiornamento prima di restituire il messaggio di **\_ disegno WM** .</span><span class="sxs-lookup"><span data-stu-id="3f521-129">In all cases, an application must clear the update region before returning from the **WM\_PAINT** message.</span></span>

<span data-ttu-id="3f521-130">Al termine del disegno, l'applicazione deve chiamare [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint).</span><span class="sxs-lookup"><span data-stu-id="3f521-130">After the application finishes drawing, it should call [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint).</span></span> <span data-ttu-id="3f521-131">Per la maggior parte delle finestre, **EndPaint** rilascia il contesto del dispositivo di visualizzazione, rendendolo disponibile ad altre finestre.</span><span class="sxs-lookup"><span data-stu-id="3f521-131">For most windows, **EndPaint** releases the display device context, making it available to other windows.</span></span> <span data-ttu-id="3f521-132">**EndPaint** Mostra anche il cursore, se è stato precedentemente nascosto da [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint).</span><span class="sxs-lookup"><span data-stu-id="3f521-132">**EndPaint** also shows the caret, if it was previously hidden by [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint).</span></span> <span data-ttu-id="3f521-133">**BeginPaint** nasconde il punto di inserimento per evitare che le operazioni di disegno danneggino il punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="3f521-133">**BeginPaint** hides the caret to prevent drawing operations from corrupting it.</span></span>

-   [<span data-ttu-id="3f521-134">Area di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="3f521-134">The Update Region</span></span>](the-update-region.md)
-   [<span data-ttu-id="3f521-135">Invalidare e convalidare l'area di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="3f521-135">Invalidating and Validating the Update Region</span></span>](invalidating-and-validating-the-update-region.md)
-   [<span data-ttu-id="3f521-136">Recupero dell'area di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="3f521-136">Retrieving the Update Region</span></span>](retrieving-the-update-region.md)
-   [<span data-ttu-id="3f521-137">Esclusione dell'area di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="3f521-137">Excluding the Update Region</span></span>](excluding-the-update-region.md)
-   [<span data-ttu-id="3f521-138">Disegno sincrono e asincrono</span><span class="sxs-lookup"><span data-stu-id="3f521-138">Synchronous and Asynchronous Drawing</span></span>](synchronous-and-asynchronous-drawing.md)

 

 
