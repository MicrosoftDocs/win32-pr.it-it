---
title: Opzioni Bluetooth e socket
description: Bluetooth per Windows supporta le seguenti opzioni di socket.
ms.assetid: e2e305c2-e749-4566-8e24-c07a7a29c612
keywords:
- Opzioni Bluetooth e Socket Bluetooth
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84040a98c3dae1fec292e4f0a7086f11d1ee546c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103963172"
---
# <a name="bluetooth-and-socket-options"></a><span data-ttu-id="38b5e-104">Opzioni Bluetooth e socket</span><span class="sxs-lookup"><span data-stu-id="38b5e-104">Bluetooth and Socket Options</span></span>

<span data-ttu-id="38b5e-105">Bluetooth per Windows supporta le seguenti opzioni di socket.</span><span class="sxs-lookup"><span data-stu-id="38b5e-105">Bluetooth for Windows supports the following socket options.</span></span> <span data-ttu-id="38b5e-106">Le opzioni socket vengono impostate e sottoposte a query usando rispettivamente le funzioni [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) e [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) .</span><span class="sxs-lookup"><span data-stu-id="38b5e-106">Socket options are set and queried using the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) and [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) functions, respectively.</span></span> <span data-ttu-id="38b5e-107">Con la funzione **setsockopt** è possibile usare tutte le opzioni seguenti, ma solo l'opzione **\_ BTH \_ MTU** è disponibile per l'uso con la funzione **getsockopt** .</span><span class="sxs-lookup"><span data-stu-id="38b5e-107">All of the following options can be used with the **setsockopt** function, but only the **SO\_BTH\_MTU** option is available for use with the **getsockopt** function.</span></span>

<span data-ttu-id="38b5e-108">Le impostazioni seguenti sono necessarie per usare le opzioni del Socket Bluetooth:</span><span class="sxs-lookup"><span data-stu-id="38b5e-108">The following settings are required for working with Bluetooth socket options:</span></span>

-   <span data-ttu-id="38b5e-109">Il parametro *s* deve essere un Socket Bluetooth.</span><span class="sxs-lookup"><span data-stu-id="38b5e-109">The *s* parameter must be a Bluetooth socket.</span></span>
-   <span data-ttu-id="38b5e-110">Il parametro *Level* deve essere **Sol \_ rfcomm**.</span><span class="sxs-lookup"><span data-stu-id="38b5e-110">The *level* parameter must be **SOL\_RFCOMM**.</span></span>

## <a name="so_bth_authenticate"></a><span data-ttu-id="38b5e-111">\_BTH l' \_ autenticazione</span><span class="sxs-lookup"><span data-stu-id="38b5e-111">SO\_BTH\_AUTHENTICATE</span></span>

<span data-ttu-id="38b5e-112">Per i socket disconnessi, il modo in cui l'autenticazione di **\_ BTH \_** specifica che l'autenticazione è necessaria per il corretto completamento di un'operazione di [**connessione**](/windows/desktop/api/winsock2/nf-winsock2-connect) o [**accettazione**](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="38b5e-112">For disconnected sockets, the **SO\_BTH\_AUTHENTICATE** specifies that authentication is required for a [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) or [**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) operation to complete successfully.</span></span> <span data-ttu-id="38b5e-113">L'impostazione di questa opzione socket avvia attivamente l'autenticazione durante la creazione della connessione, se i due dispositivi Bluetooth non sono stati autenticati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="38b5e-113">Setting this socket option actively initiates authentication during connection establishment, if the two Bluetooth devices were not previously authenticated.</span></span> <span data-ttu-id="38b5e-114">L'interfaccia utente per lo scambio di passkey, se necessario, viene fornita dal sistema operativo all'esterno del contesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-114">The user interface for passkey exchange, if necessary, is provided by the operating system outside the application context.</span></span>

<span data-ttu-id="38b5e-115">Per le connessioni in uscita che richiedono l'autenticazione, l'operazione di [**connessione**](/windows/desktop/api/winsock2/nf-winsock2-connect) ha esito negativo con **WSAEACCES** se l'autenticazione non riesce.</span><span class="sxs-lookup"><span data-stu-id="38b5e-115">For outgoing connections that require authentication, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) operation fails with **WSAEACCES** if authentication is not successful.</span></span> <span data-ttu-id="38b5e-116">In risposta, l'applicazione potrebbe richiedere all'utente di autenticare i due dispositivi Bluetooth prima della connessione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-116">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span>

<span data-ttu-id="38b5e-117">Per le connessioni in ingresso, la connessione viene rifiutata se non è possibile stabilire l'autenticazione e restituisce un errore **WSAEHOSTDOWN** .</span><span class="sxs-lookup"><span data-stu-id="38b5e-117">For incoming connections, the connection is rejected if authentication cannot be established and returns a **WSAEHOSTDOWN** error.</span></span> <span data-ttu-id="38b5e-118">Per ulteriori informazioni sull'autenticazione dei dispositivi Bluetooth, vedere [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="38b5e-118">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="38b5e-119">Per l' **opzione \_ BTH \_ Authenticate** socket, *OPTVAL* è un puntatore a ULONG bAuthenticate e deve essere **true**; *optlen* è equivalente a "sizeof (ulong)".</span><span class="sxs-lookup"><span data-stu-id="38b5e-119">For the **SO\_BTH\_AUTHENTICATE** socket option, *optval* is a pointer to ULONG bAuthenticate and must be **TRUE**; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

<span data-ttu-id="38b5e-120">**Windows XP con SP2: \_ BTH \_ Authenticate** avvia l'autenticazione per i socket connessi e impone l'autenticazione al momento della connessione per i socket non connessi.</span><span class="sxs-lookup"><span data-stu-id="38b5e-120">**Windows XP with SP2:  SO\_BTH\_AUTHENTICATE** starts authentication for connected sockets, and forces authentication upon connection for unconnected sockets.</span></span> <span data-ttu-id="38b5e-121">Per le connessioni in ingresso, la connessione viene rifiutata se non è possibile eseguire l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-121">For incoming connections, the connection is rejected if authentication cannot be performed.</span></span>

## <a name="so_bth_encrypt"></a><span data-ttu-id="38b5e-122">QUINDI, \_ BTH \_ Crittografa</span><span class="sxs-lookup"><span data-stu-id="38b5e-122">SO\_BTH\_ENCRYPT</span></span>

<span data-ttu-id="38b5e-123">Nei socket non connessi, l'opzione di crittografia socket di **\_ BTH \_** consente di applicare la crittografia per stabilire una connessione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-123">On unconnected sockets, the **SO\_BTH\_ENCRYPT** socket option enforces encryption to establish a connection.</span></span> <span data-ttu-id="38b5e-124">La crittografia è disponibile solo per le connessioni autenticate.</span><span class="sxs-lookup"><span data-stu-id="38b5e-124">Encryption is only available for authenticated connections.</span></span> <span data-ttu-id="38b5e-125">Per le connessioni in ingresso, una connessione per la quale non è possibile stabilire la crittografia viene rifiutata automaticamente e restituisce **WSAEHOSTDOWN** come errore.</span><span class="sxs-lookup"><span data-stu-id="38b5e-125">For incoming connections, a connection for which encryption cannot be established is automatically rejected and returns **WSAEHOSTDOWN** as the error.</span></span> <span data-ttu-id="38b5e-126">Per le connessioni in uscita, la funzione [**Connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) ha esito negativo con **WSAEACCES** se non è possibile stabilire la crittografia.</span><span class="sxs-lookup"><span data-stu-id="38b5e-126">For outgoing connections, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function fails with **WSAEACCES** if encryption cannot be established.</span></span> <span data-ttu-id="38b5e-127">In risposta, l'applicazione potrebbe richiedere all'utente di autenticare i due dispositivi Bluetooth prima della connessione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-127">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span> <span data-ttu-id="38b5e-128">Per ulteriori informazioni sull'autenticazione dei dispositivi Bluetooth, vedere [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="38b5e-128">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="38b5e-129">Per l' \_ opzione BTH \_ Encrypt socket, *optVal* è un puntatore a ULONG **bEncrypt** e deve essere **true**; *optlen* è equivalente a sizeof (ulong).</span><span class="sxs-lookup"><span data-stu-id="38b5e-129">For the SO\_BTH\_ENCRYPT socket option, *optval* is a pointer to ULONG **bEncrypt** and must be **TRUE**; *optlen* is equivalent to sizeof(ULONG).</span></span>

<span data-ttu-id="38b5e-130">**Windows XP con SP2:** Per un socket connesso e autenticato, **\_ BTH \_ Encrypt** avvia la crittografia.</span><span class="sxs-lookup"><span data-stu-id="38b5e-130">**Windows XP with SP2:** For a socket that is connected and authenticated, **SO\_BTH\_ENCRYPT** starts encryption.</span></span>

## <a name="so_bth_mtu"></a><span data-ttu-id="38b5e-131">\_BTH \_ MTU</span><span class="sxs-lookup"><span data-stu-id="38b5e-131">SO\_BTH\_MTU</span></span>

<span data-ttu-id="38b5e-132">L'opzione di socket **\_ \_ MTU BTH** è un'opzione avanzata utilizzata principalmente per la convalida.</span><span class="sxs-lookup"><span data-stu-id="38b5e-132">The **SO\_BTH\_MTU** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="38b5e-133">L' **opzione \_ BTH \_ MTU** consente di ottenere o impostare la MTU rfcomm predefinita (unità di trasmissione massima) per la negoziazione della connessione a un valore diverso da quello del protocollo RFCOMM-valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="38b5e-133">The **SO\_BTH\_MTU** option obtains or sets default RFCOMM MTU (maximum transmission unit) for connection negotiation to a value different than the RFCOMM protocol-default value.</span></span>

<span data-ttu-id="38b5e-134">Poiché l'MTU RFCOMM è influenzato dal valore MTU L2CAP sottostante e dai valori minimi e massimi del protocollo e dell'applicazione, il valore predefinito per **\_ BTH \_ MTU** è solo un punto di partenza per la negoziazione con il peer remoto e la MTU negoziata finale è probabilmente diversa da quella predefinita.</span><span class="sxs-lookup"><span data-stu-id="38b5e-134">Because RFCOMM MTU is affected by the underlying L2CAP MTU, and protocol and application minimums and maximums, the default value for **SO\_BTH\_MTU** is only a starting point for negotiation with the remote peer, and the final negotiated MTU is likely to vary from the default.</span></span> <span data-ttu-id="38b5e-135">L'impostazione del valore **\_ \_ MTU BTH** può influire negativamente sulla velocità effettiva e, di conseguenza, qualsiasi modifica deve essere eseguita con la conoscenza del protocollo Bluetooth sottostante.</span><span class="sxs-lookup"><span data-stu-id="38b5e-135">Setting the **SO\_BTH\_MTU** value may negatively affect throughput, and as such, any modification should be performed with knowledge of the underlying Bluetooth protocol.</span></span>

<span data-ttu-id="38b5e-136">L'opzione di socket **\_ \_ MTU BTH** può essere eseguita sui socket connessi, ma non ha alcun effetto se la negoziazione è già stata completata.</span><span class="sxs-lookup"><span data-stu-id="38b5e-136">The **SO\_BTH\_MTU** socket option can be performed on connected sockets, but has no effect if the negotiation has already completed.</span></span> <span data-ttu-id="38b5e-137">L'impostazione del socket in ascolto (Server) non ha alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="38b5e-137">Setting it on the listening (server) socket has no effect.</span></span>

<span data-ttu-id="38b5e-138">La quantità di dati che un'applicazione può inviare o ricevere in una singola chiamata al socket non è interessata dalla MTU; MTU influiscono solo sul modo in cui il provider del servizio Windows Sockets sottostante suddivide i pacchetti per il trasporto.</span><span class="sxs-lookup"><span data-stu-id="38b5e-138">The amount of data that an application can send or receive in a single socket call is not affected by the MTU; MTU only affects how the underlying Windows Sockets service provider segments packets for transport.</span></span> <span data-ttu-id="38b5e-139">Sia la MTU proposta che la MTU finale negoziata devono essere comprese tra **rfcomm \_ Min \_ MTU** e **rfcomm \_ Max \_ MTU**, come definito nel file di intestazione Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="38b5e-139">Both the proposed MTU and the MTU ultimately negotiated must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="38b5e-140">Per l'opzione di socket **\_ \_ MTU BTH** , *OPTVAL* è un puntatore a ULONG MTU; *optlen* è equivalente a "sizeof (ulong)".</span><span class="sxs-lookup"><span data-stu-id="38b5e-140">For the **SO\_BTH\_MTU** socket option, *optval* is a pointer to ULONG mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_max"></a><span data-ttu-id="38b5e-141">\_BTH \_ MTU \_ Max</span><span class="sxs-lookup"><span data-stu-id="38b5e-141">SO\_BTH\_MTU\_MAX</span></span>

<span data-ttu-id="38b5e-142">L'opzione di socket **\_ BTH \_ MTU \_ Max** è un'opzione avanzata utilizzata principalmente per la convalida.</span><span class="sxs-lookup"><span data-stu-id="38b5e-142">The **SO\_BTH\_MTU\_MAX** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="38b5e-143">L' **opzione \_ BTH \_ MTU \_ Max** Socket imposta il numero massimo di rfcomm MTU (Maximum Transmission Unit) per la negoziazione della connessione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-143">The **SO\_BTH\_MTU\_MAX** socket option sets the maximum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="38b5e-144">Le connessioni con un valore MTU rfcomm maggiore o uguale a questo valore hanno esito negativo durante il processo di accettazione della [**connessione**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="38b5e-144">Connections with an RFCOMM MTU equal to or greater than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="38b5e-145">Quando è consentita l'impostazione di questa opzione socket per un socket connesso, non ha alcun effetto se la negoziazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="38b5e-145">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="38b5e-146">L'impostazione di questa opzione socket su un socket di ascolto propaga il valore per tutte le connessioni in ingresso.</span><span class="sxs-lookup"><span data-stu-id="38b5e-146">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span> <span data-ttu-id="38b5e-147">Il valore MTU massimo deve essere compreso tra **rfcomm \_ Min \_ MTU** e **rfcomm \_ Max \_ MTU**, come definito nel file di intestazione Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="38b5e-147">The MAX MTU value must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="38b5e-148">Per l'opzione di socket **\_ \_ \_ Max BTH MTU** , *optVal* è un puntatore a ULONG Max \_ MTU; *optlen* è equivalente a "sizeof (ulong)".</span><span class="sxs-lookup"><span data-stu-id="38b5e-148">For the **SO\_BTH\_MTU\_MAX** socket option, *optval* is a pointer to ULONG max\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_min"></a><span data-ttu-id="38b5e-149">\_BTH \_ MTU \_ min</span><span class="sxs-lookup"><span data-stu-id="38b5e-149">SO\_BTH\_MTU\_MIN</span></span>

<span data-ttu-id="38b5e-150">L' **opzione \_ BTH \_ MTU \_ min** socket è un'opzione avanzata utilizzata principalmente per la convalida.</span><span class="sxs-lookup"><span data-stu-id="38b5e-150">The **SO\_BTH\_MTU\_MIN** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="38b5e-151">L' **opzione \_ BTH \_ MTU \_ min** Socket imposta il valore minimo rfcomm MTU (Maximum Transmission Unit) per la negoziazione della connessione.</span><span class="sxs-lookup"><span data-stu-id="38b5e-151">The **SO\_BTH\_MTU\_MIN** socket option sets the minimum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="38b5e-152">Le connessioni con un valore MTU rfcomm inferiore a questo valore hanno esito negativo durante il processo di accettazione della [**connessione**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="38b5e-152">Connections with an RFCOMM MTU smaller than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="38b5e-153">Quando è consentita l'impostazione di questa opzione socket per un socket connesso, non ha alcun effetto se la negoziazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="38b5e-153">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="38b5e-154">L'impostazione di questa opzione socket su un socket di ascolto propaga il valore per tutte le connessioni in ingresso.</span><span class="sxs-lookup"><span data-stu-id="38b5e-154">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span>

<span data-ttu-id="38b5e-155">Solo un socket in ascolto può rivedere l'MTU verso il basso, pertanto se il valore proposto dal socket di connessione è inferiore al valore impostato **per \_ BTH \_ MTU \_ min** sul socket in ascolto, la connessione viene rifiutata.</span><span class="sxs-lookup"><span data-stu-id="38b5e-155">Only a listening socket can revise the MTU downward, therefore if the value proposed by the connecting socket is less than the value set for **SO\_BTH\_MTU\_MIN** on the listening socket, the connection is refused.</span></span> <span data-ttu-id="38b5e-156">Il valore MTU minimo deve essere compreso tra **rfcomm \_ Min \_ MTU** e **rfcomm \_ Max \_ MTU**, come definito nel file di intestazione Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="38b5e-156">The minimum MTU must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="38b5e-157">Per l' \_ opzione BTH \_ MTU \_ min socket, *optVal* è un puntatore a ULONG min \_ MTU; *optlen* è equivalente a "sizeof (ulong)".</span><span class="sxs-lookup"><span data-stu-id="38b5e-157">For the SO\_BTH\_MTU\_MIN socket option, *optval* is a pointer to ULONG min\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="related-topics"></a><span data-ttu-id="38b5e-158">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="38b5e-158">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="38b5e-159">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="38b5e-159">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> <dt>

[<span data-ttu-id="38b5e-160">**getsockopt**</span><span class="sxs-lookup"><span data-stu-id="38b5e-160">**getsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-getsockopt)
</dt> <dt>

[<span data-ttu-id="38b5e-161">**setsockopt**</span><span class="sxs-lookup"><span data-stu-id="38b5e-161">**setsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-setsockopt)
</dt> <dt>

[<span data-ttu-id="38b5e-162">**BluetoothAuthenticateDevice**</span><span class="sxs-lookup"><span data-stu-id="38b5e-162">**BluetoothAuthenticateDevice**</span></span>](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice)
</dt> <dt>

[<span data-ttu-id="38b5e-163">**connessione**</span><span class="sxs-lookup"><span data-stu-id="38b5e-163">**connect**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-connect)
</dt> <dt>

[<span data-ttu-id="38b5e-164">**accettare**</span><span class="sxs-lookup"><span data-stu-id="38b5e-164">**accept**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-accept)
</dt> </dl>

 

 