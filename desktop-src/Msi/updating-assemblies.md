---
description: Le informazioni contenute in questo argomento identificano le linee guida consigliate per l'aggiornamento degli assembly mediante Windows Installer patch.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Aggiornamento degli assembly
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104058353"
---
# <a name="updating-assemblies"></a><span data-ttu-id="65a8f-103">Aggiornamento degli assembly</span><span class="sxs-lookup"><span data-stu-id="65a8f-103">Updating Assemblies</span></span>

<span data-ttu-id="65a8f-104">Le informazioni contenute in questo argomento identificano le linee guida consigliate per l'aggiornamento degli assembly mediante Windows Installer patch.</span><span class="sxs-lookup"><span data-stu-id="65a8f-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="65a8f-105">Gli autori degli aggiornamenti degli assembly possono utilizzare le linee guida seguenti, applicabili a tutti i tipi di assembly:</span><span class="sxs-lookup"><span data-stu-id="65a8f-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="65a8f-106">Il metodo consigliato per l'aggiornamento di un assembly consiste nel modificare il nome sicuro dell'assembly nella [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="65a8f-107">La nuova versione dell'assembly può essere fornita da un nuovo componente o dallo stesso componente che fornisce la versione precedente.</span><span class="sxs-lookup"><span data-stu-id="65a8f-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="65a8f-108">Se la nuova versione dell'assembly viene fornita dallo stesso componente, non modificare il tipo di assembly da un assembly .NET Framework a un assembly Win32 o viceversa.</span><span class="sxs-lookup"><span data-stu-id="65a8f-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="65a8f-109">Se tutte le applicazioni nel sistema devono utilizzare l'assembly aggiornato, è necessario distribuire un assembly dei criteri.</span><span class="sxs-lookup"><span data-stu-id="65a8f-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="65a8f-110">Un assembly di criteri può reindirizzare le applicazioni nel sistema per utilizzare la nuova versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="65a8f-111">Gli assembly di criteri devono essere forniti creando un nuovo componente.</span><span class="sxs-lookup"><span data-stu-id="65a8f-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="65a8f-112">Per disinstallare gli aggiornamenti degli assembly è necessario Windows Installer 3,0 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="65a8f-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="65a8f-113">Per altre informazioni, vedere [rimozione di patch](removing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="65a8f-114">La versione più recente dell'assembly deve contenere le stesse versioni di file o versioni successive di assembly rilasciati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="65a8f-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="65a8f-115">Windows Installer 3,0 può servire .NET Framework e assembly Win32 mediante una sostituzione completa dei file o un aggiornamento delta più piccolo.</span><span class="sxs-lookup"><span data-stu-id="65a8f-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="65a8f-116">Per altre informazioni, vedere [riduzione delle dimensioni delle patch](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="65a8f-117">Se l'aggiornamento modifica il nome sicuro dell'assembly, la tabella [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) e la tabella [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) sono obbligatorie se per il pacchetto di patch non è presente una tabella [MsiPatchSequence](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="65a8f-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="65a8f-118">La tabella MsiPatchOldAssemblyFile e la tabella MsiPatchOldAssemblyName non sono necessarie se il pacchetto di patch contiene informazioni di sequenziazione delle patch in una tabella MsiPatchSequence.</span><span class="sxs-lookup"><span data-stu-id="65a8f-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="65a8f-119">Prima di rilasciare una nuova patch, testare la patch applicando l'applicazione a tutte le patch rilasciate in precedenza.</span><span class="sxs-lookup"><span data-stu-id="65a8f-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="65a8f-120">Aggiornamento degli assembly Win32</span><span class="sxs-lookup"><span data-stu-id="65a8f-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="65a8f-121">Quando si aggiornano gli assembly Win32, attenersi alle seguenti linee guida:</span><span class="sxs-lookup"><span data-stu-id="65a8f-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="65a8f-122">Modificare il nome sicuro del nuovo assembly specificato nella [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="65a8f-123">Se si desidera che l'applicazione utilizzi sempre la nuova versione dell'assembly senza influire sulla versione dell'assembly utilizzata da altre applicazioni nel sistema, utilizzare lo stesso componente per contenere la nuova versione dell'assembly utilizzata per la versione precedente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="65a8f-124">Mantiene lo stesso ComponentId nella tabella dei [componenti](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="65a8f-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="65a8f-125">Dopo che l'applicazione è stata applicata alla patch, esso include solo un riferimento alla nuova versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="65a8f-126">La versione precedente dell'assembly può rimanere con la nuova versione nella Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="65a8f-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="65a8f-127">Questo non influisce sulle altre applicazioni del sistema che usano la versione precedente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="65a8f-128">Quando si usa lo stesso componente per le versioni nuove e precedenti dell'assembly, l'aggiornamento può essere una patch Delta più piccola.</span><span class="sxs-lookup"><span data-stu-id="65a8f-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="65a8f-129">Se la nuova versione dell'assembly non è compatibile con tutti i sistemi in cui si desidera installare l'applicazione, è possibile installare le versioni nuove e precedenti dell'assembly come assembly side-by-side.</span><span class="sxs-lookup"><span data-stu-id="65a8f-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="65a8f-130">Per installare entrambe le versioni di assembly side-by-Side, creare un nuovo componente per contenere la nuova versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="65a8f-131">Il ComponentId nella tabella dei [componenti](component-table.md) per il nuovo componente deve essere diverso da quello della ComponentID del componente con la versione precedente.</span><span class="sxs-lookup"><span data-stu-id="65a8f-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="65a8f-132">Dopo che l'applicazione è stata applicata a patch, include riferimenti a entrambe le versioni degli assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="65a8f-133">L'applicazione può quindi essere indirizzata alla versione compatibile dell'assembly da un manifesto.</span><span class="sxs-lookup"><span data-stu-id="65a8f-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="65a8f-134">Quando vengono usati componenti diversi per le versioni nuove e precedenti dell'assembly, l'aggiornamento usa la sostituzione completa dei file.</span><span class="sxs-lookup"><span data-stu-id="65a8f-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="65a8f-135">Aggiornamento di assembly .NET Framework</span><span class="sxs-lookup"><span data-stu-id="65a8f-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="65a8f-136">Usare le linee guida seguenti quando si aggiornano .NET Framework assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="65a8f-137">Modificare il nome sicuro del nuovo assembly specificato nella [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="65a8f-138">Se si desidera che l'applicazione utilizzi sempre la nuova versione dell'assembly senza influire sulla versione dell'assembly utilizzata da altre applicazioni nel sistema, modificare il nome sicuro del nuovo assembly specificato nella [tabella MsiAssemblyName](msiassemblyname-table.md)e utilizzare lo stesso componente per contenere la nuova versione dell'assembly utilizzata per la versione precedente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="65a8f-139">Mantiene lo stesso ComponentId nella tabella dei [componenti](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="65a8f-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="65a8f-140">Dopo che l'applicazione è stata applicata alla patch, esso include solo un riferimento alla nuova versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="65a8f-141">La versione precedente dell'assembly può rimanere con la nuova versione nella global assembly cache.</span><span class="sxs-lookup"><span data-stu-id="65a8f-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="65a8f-142">Questo non influisce sulle altre applicazioni del sistema che usano la versione precedente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="65a8f-143">Quando si usa lo stesso componente per le versioni nuove e precedenti dell'assembly, l'aggiornamento può essere una patch Delta più piccola.</span><span class="sxs-lookup"><span data-stu-id="65a8f-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="65a8f-144">Se la nuova versione dell'assembly non è compatibile con tutti i sistemi in cui si desidera installare l'applicazione, è possibile installare le versioni nuove e precedenti dell'assembly come assembly side-by-side.</span><span class="sxs-lookup"><span data-stu-id="65a8f-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="65a8f-145">Per installare entrambe le versioni di assembly side-by-Side, modificare il nome sicuro del nuovo assembly specificato nella [tabella MsiAssemblyName](msiassemblyname-table.md)e creare un nuovo componente che contenga la nuova versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="65a8f-146">Il ComponentId nella tabella dei [componenti](component-table.md) per il nuovo componente deve essere diverso da quello di ComponentID del componente con la versione precedente.</span><span class="sxs-lookup"><span data-stu-id="65a8f-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="65a8f-147">Dopo che l'applicazione è stata applicata a patch, include riferimenti a entrambe le versioni degli assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="65a8f-148">L'applicazione può quindi essere indirizzata alla versione compatibile dell'assembly da un manifesto.</span><span class="sxs-lookup"><span data-stu-id="65a8f-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="65a8f-149">Quando vengono usati componenti diversi per le versioni nuove e precedenti dell'assembly, l'aggiornamento usa la sostituzione completa dei file.</span><span class="sxs-lookup"><span data-stu-id="65a8f-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="65a8f-150">Un aggiornamento sul posto sovrascrive la copia di un assembly .NET Framework nel Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="65a8f-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="65a8f-151">Questo tipo di aggiornamento dell'assembly non modifica il nome sicuro dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="65a8f-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="65a8f-152">Viene modificato solo il valore nel campo FileVersion della [tabella MsiAssemblyName](msiassemblyname-table.md) .</span><span class="sxs-lookup"><span data-stu-id="65a8f-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="65a8f-153">L'aggiornamento sul posto di un assembly di .NET Framework richiede .NET Framework 1,1 SP1 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="65a8f-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="65a8f-154">Il tipo di aggiornamento sul posto sovrascrive la copia dell'assembly nella cache globale e può interrompere altre applicazioni se la nuova versione dell'assembly non è completamente compatibile con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="65a8f-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="65a8f-155">Il metodo consigliato per l'aggiornamento di un assembly consiste nel modificare il nome sicuro dell'assembly nella [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="65a8f-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



