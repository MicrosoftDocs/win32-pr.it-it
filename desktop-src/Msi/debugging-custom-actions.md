---
description: È possibile eseguire il debug di azioni personalizzate basate su librerie a collegamento dinamico mediante gli strumenti di debug per Windows. Non è possibile utilizzare il debug dinamico con azioni personalizzate basate su file eseguibili o script.
ms.assetid: 4241a27a-c127-4c65-96a2-1d655b343eba
title: Debug di azioni personalizzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ddfbc9952f0dd7fc1b85b5c64fa6a23381ceafe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314294"
---
# <a name="debugging-custom-actions"></a><span data-ttu-id="7dda1-104">Debug di azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="7dda1-104">Debugging Custom Actions</span></span>

<span data-ttu-id="7dda1-105">È possibile eseguire il debug di azioni personalizzate basate su [librerie a collegamento dinamico](dynamic-link-libraries.md) mediante [gli strumenti di debug per Windows](https://www.microsoft.com/?ref=go).</span><span class="sxs-lookup"><span data-stu-id="7dda1-105">You can debug custom actions that are based on [dynamic-link libraries](dynamic-link-libraries.md) by using [Debugging Tools for Windows](https://www.microsoft.com/?ref=go).</span></span> <span data-ttu-id="7dda1-106">Non è possibile utilizzare il debug dinamico con azioni personalizzate basate su [file eseguibili](executable-files.md) o [script](scripts.md).</span><span class="sxs-lookup"><span data-stu-id="7dda1-106">It is not possible to use dynamic debugging with custom actions based on [executable files](executable-files.md) or [scripts](scripts.md).</span></span>

<span data-ttu-id="7dda1-107">Le tecniche descritte in questa sezione consentono di eseguire il debug di Windows Installer azioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="7dda1-107">The techniques described in this section can help you debug Windows Installer custom actions.</span></span> <span data-ttu-id="7dda1-108">Per informazioni sugli [strumenti di debug per Windows](https://www.microsoft.com/?ref=go), vedere la sezione strumenti di sviluppo driver di Windows Driver Kit (WDK).</span><span class="sxs-lookup"><span data-stu-id="7dda1-108">See the Driver Development Tools section of the Windows Driver Kit (WDK) for information about [Debugging Tools for Windows](https://www.microsoft.com/?ref=go).</span></span>

<span data-ttu-id="7dda1-109">Windows Installer usa la variabile di ambiente MsiBreak per determinare quale azione personalizzata deve essere sottoposta a debug.</span><span class="sxs-lookup"><span data-stu-id="7dda1-109">Windows Installer uses the MsiBreak environment variable to determine which custom action is to be debugged.</span></span> <span data-ttu-id="7dda1-110">Se si ha accesso al codice sorgente dell'azione personalizzata, potrebbe essere possibile usare il debug senza MsiBreak.</span><span class="sxs-lookup"><span data-stu-id="7dda1-110">If you have access to the custom action's source code, you may be able to use debugging without MsiBreak.</span></span> <span data-ttu-id="7dda1-111">Per avviare il debug senza MsiBreak, inserire una finestra di messaggio temporanea all'inizio del codice dell'azione.</span><span class="sxs-lookup"><span data-stu-id="7dda1-111">To start debugging without MsiBreak, put a temporary message box at the beginning of the action's code.</span></span> <span data-ttu-id="7dda1-112">Quando viene visualizzata la finestra di messaggio durante l'installazione, alleghi il debugger al processo proprietario della finestra di messaggio.</span><span class="sxs-lookup"><span data-stu-id="7dda1-112">When the message box appears during the installation, attach the debugger to the process owning the message box.</span></span> <span data-ttu-id="7dda1-113">È quindi possibile impostare eventuali punti di interruzione necessari e chiudere la finestra di messaggio per riprendere l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7dda1-113">You can then set any necessary breakpoints and dismiss the message box to resume execution.</span></span> <span data-ttu-id="7dda1-114">Non è possibile eseguire il debug delle parti precedenti dell'azione personalizzata da questo metodo.</span><span class="sxs-lookup"><span data-stu-id="7dda1-114">It is not possible to debug the earlier portions of the custom action by this method.</span></span>

<span data-ttu-id="7dda1-115">Per usare la variabile di ambiente MsiBreak per eseguire il debug dell'azione personalizzata, impostare MsiBreak sul nome dell'azione personalizzata nella [tabella CustomAction](customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="7dda1-115">To use the MsiBreak environment variable to debug the custom action, set MsiBreak to the custom action's name in the [CustomAction table](customaction-table.md).</span></span> <span data-ttu-id="7dda1-116">MsiBreak può essere una variabile di ambiente di sistema o utente.</span><span class="sxs-lookup"><span data-stu-id="7dda1-116">MsiBreak can be either a system or a user environment variable.</span></span> <span data-ttu-id="7dda1-117">Se la variabile è impostata come variabile di sistema, potrebbe essere necessario riavviare il sistema quando il valore viene modificato per rilevare il nuovo valore.</span><span class="sxs-lookup"><span data-stu-id="7dda1-117">If the variable is set as a system variable, a restart of the system may be needed when the value is changed to detect the new value.</span></span>

<span data-ttu-id="7dda1-118">Per usare la variabile di ambiente MsiBreak per eseguire il debug di un'interfaccia utente incorporata, impostare il valore di MsiBreak su MsiEmbeddedUI.</span><span class="sxs-lookup"><span data-stu-id="7dda1-118">To use the MsiBreak environment variable to debug an embedded user interface, set the value of MsiBreak to MsiEmbeddedUI.</span></span>

<span data-ttu-id="7dda1-119">Windows Installer controlla solo la variabile di ambiente MsiBreak se l'utente è un amministratore.</span><span class="sxs-lookup"><span data-stu-id="7dda1-119">Windows Installer only checks the MsiBreak environment variable if the user is an Administrator.</span></span> <span data-ttu-id="7dda1-120">Il programma di installazione ignora il valore di MsiBreak se l'utente non è un amministratore, anche se si tratta di un' [*applicazione gestita*](m-gly.md).</span><span class="sxs-lookup"><span data-stu-id="7dda1-120">The installer ignores the value of MsiBreak if the user is not an Administrator, even if this is a [*managed application*](m-gly.md).</span></span>

<span data-ttu-id="7dda1-121">Se si esegue il debug di un'azione personalizzata che viene eseguita con privilegi elevati (di sistema) nella sequenza di esecuzione, associare il debugger al servizio Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="7dda1-121">If you are debugging a custom action that runs with elevated (system) privileges in the execution sequence, attach the debugger to the Windows Installer service.</span></span> <span data-ttu-id="7dda1-122">Quando si esegue il debug di un'azione personalizzata eseguita con privilegi rappresentati nella sequenza di esecuzione, il sistema richiede una finestra di dialogo che indica il processo di cui eseguire il debug.</span><span class="sxs-lookup"><span data-stu-id="7dda1-122">When debugging a custom action that runs with impersonated privileges in the execution sequence, the system prompts with a dialog box that indicates which process should be debugged.</span></span> <span data-ttu-id="7dda1-123">All'utente viene visualizzata una finestra di dialogo che indica il processo di cui eseguire il debug.</span><span class="sxs-lookup"><span data-stu-id="7dda1-123">The user is prompted with a dialog box indicating which process to debug.</span></span> <span data-ttu-id="7dda1-124">Per altre informazioni sulle azioni personalizzate con privilegi elevati, vedere [sicurezza dell'azione personalizzata](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="7dda1-124">For more information about elevated custom actions, see [Custom Action Security](custom-action-security.md).</span></span>

<span data-ttu-id="7dda1-125">Una volta che il debugger è stato collegato al processo corretto, il programma di installazione attiva un punto di interruzione del debugger immediatamente prima di chiamare il punto di ingresso della DLL.</span><span class="sxs-lookup"><span data-stu-id="7dda1-125">Once the debugger has been attached to the correct process, the installer triggers a debugger breakpoint immediately before calling the entry point of the DLL.</span></span> <span data-ttu-id="7dda1-126">Nel punto di interruzione, la DLL è già caricata nel processo e l'indirizzo del punto di ingresso è stato determinato.</span><span class="sxs-lookup"><span data-stu-id="7dda1-126">At the breakpoint, your DLL is already loaded into the process and the entry point address determined.</span></span> <span data-ttu-id="7dda1-127">Se non è stato possibile caricare la DLL dell'azione personalizzata oppure il punto di ingresso dell'azione personalizzata non esiste, non viene attivato alcun punto di interruzione.</span><span class="sxs-lookup"><span data-stu-id="7dda1-127">If your custom action DLL could not be loaded or the custom action entry point did not exist, no breakpoint is triggered.</span></span> <span data-ttu-id="7dda1-128">Poiché il punto di interruzione viene attivato prima di chiamare la funzione DLL, dopo che il punto di interruzione è stato attivato, è consigliabile utilizzare il debugger per proseguire fino a quando non viene chiamato il punto di ingresso dell'azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="7dda1-128">Because the breakpoint is triggered before calling the DLL function, once the breakpoint has been triggered you should use your debugger to step forward until your custom action entry point is called.</span></span> <span data-ttu-id="7dda1-129">In alternativa, è possibile impostare un punto di interruzione in qualsiasi punto dell'azione personalizzata e riprendere l'esecuzione normale.</span><span class="sxs-lookup"><span data-stu-id="7dda1-129">Alternately, you can set a breakpoint anywhere in your custom action and resume normal execution.</span></span>

<span data-ttu-id="7dda1-130">Il Windows Installer esegue le dll non memorizzate nella [tabella binaria](binary-table.md) direttamente dal percorso della dll.</span><span class="sxs-lookup"><span data-stu-id="7dda1-130">The Windows Installer executes DLLs not stored in the [Binary table](binary-table.md) directly from the DLL location.</span></span> <span data-ttu-id="7dda1-131">Il programma di installazione non conosce il nome originale di una DLL archiviata nella tabella binaria ed esegue l'azione personalizzata DLL con un nome file temporaneo.</span><span class="sxs-lookup"><span data-stu-id="7dda1-131">The installer does not know the original name of a DLL stored in the Binary table and runs the DLL custom action under a temporary file name.</span></span> <span data-ttu-id="7dda1-132">Il formato del nome file temporaneo è MSI?????. TMP.</span><span class="sxs-lookup"><span data-stu-id="7dda1-132">The form of the temporary file name is MSI?????.TMP.</span></span> <span data-ttu-id="7dda1-133">In Windows XP, questo file temporaneo viene archiviato in un percorso sicuro, in genere <WindowFolder> \\ programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="7dda1-133">On Windows XP, this temporary file is stored in a secure location, commonly <WindowFolder>\\Installer.</span></span>

<span data-ttu-id="7dda1-134">Si noti che molte DLL create per il debug contengono il nome e il percorso del file PDB corrispondente come parte della DLL.</span><span class="sxs-lookup"><span data-stu-id="7dda1-134">Note that many DLLs created for debugging contain the name and path of the corresponding PDB file as part of the DLL itself.</span></span> <span data-ttu-id="7dda1-135">Quando si esegue il debug di questo tipo di DLL in un sistema in cui il file PDB è disponibile nel percorso archiviato nella DLL, è possibile che i simboli vengano caricati automaticamente dallo strumento del debugger.</span><span class="sxs-lookup"><span data-stu-id="7dda1-135">When debugging this type of DLL on a system where the PDB can be found at the location stored in the DLL, symbols may be loaded automatically by the debugger tool.</span></span> <span data-ttu-id="7dda1-136">Nelle situazioni in cui il PDB non è stato trovato nel percorso archiviato, in cui il debugger non supporta il caricamento di simboli dal percorso archiviato o in cui la DLL non è stata compilata con le informazioni di debug, potrebbe essere necessario inserire i file di simboli nella cartella con il file DLL temporaneo.</span><span class="sxs-lookup"><span data-stu-id="7dda1-136">In situations where the PDB cannot be found at the stored location, where the debugger does not support loading symbols from the stored location, or where the DLL was not built with debugging information, you may need to place your symbol files in the folder with the temporary DLL file.</span></span>

<span data-ttu-id="7dda1-137">Il programma di installazione aggiunge le informazioni di debug per gli script di azione personalizzati al file di log dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="7dda1-137">The installer adds debugging information for custom action scripts to the installation log file.</span></span>

``` syntax
There is a problem with this Windows Installer package. A script 
required for this install to complete could not be run. Contact your 
support personnel or package vendor.  {Custom action [2] script error 
[3], [4]: [5] Line [6], Column [7], [8] }
```

 

 



