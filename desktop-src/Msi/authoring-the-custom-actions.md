---
description: 'La tabella seguente elenca le cinque azioni personalizzate usate per soddisfare le specifiche di esempio: ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts e RollbackAccounts.'
ms.assetid: 389ec652-243e-4392-aec9-3a7eb90e6c68
title: Creazione di azioni personalizzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09525490304762b98635bcbbe6c238ce3fe413f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967262"
---
# <a name="authoring-the-custom-actions"></a><span data-ttu-id="bf566-103">Creazione di azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="bf566-103">Authoring the Custom Actions</span></span>

<span data-ttu-id="bf566-104">La tabella seguente elenca le cinque azioni personalizzate usate per soddisfare le specifiche di esempio: ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts e RollbackAccounts.</span><span class="sxs-lookup"><span data-stu-id="bf566-104">The table below lists the five custom actions used to meet the sample specifications: ProcessAccounts, UninstallAccounts, CreateAccounts, RemoveAccounts, and RollbackAccounts.</span></span> <span data-ttu-id="bf566-105">Tutte queste azioni personalizzate si trovano nelle [librerie a collegamento dinamico](dynamic-link-libraries.md) archiviate nella [tabella binaria](binary-table.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-105">All of these custom actions are in [dynamic-link libraries](dynamic-link-libraries.md) stored in the [Binary Table](binary-table.md).</span></span> <span data-ttu-id="bf566-106">Il codice sorgente C++ per le librerie a collegamento dinamico che contiene le azioni personalizzate di esempio viene fornito in Windows Installer SDK.</span><span class="sxs-lookup"><span data-stu-id="bf566-106">The C++ source code for the dynamic-link libraries containing the sample custom actions are provided in the Windows Installer SDK.</span></span> <span data-ttu-id="bf566-107">ProcessAccounts e UninstallAccounts sono nel file Process. cpp.</span><span class="sxs-lookup"><span data-stu-id="bf566-107">ProcessAccounts and UninstallAccounts are in the file Process.cpp.</span></span> <span data-ttu-id="bf566-108">CreateAccount si trova nel file create. cpp.</span><span class="sxs-lookup"><span data-stu-id="bf566-108">CreateAccount is in the file Create.cpp.</span></span> <span data-ttu-id="bf566-109">RemoveAccount e RollbackAccount si trovano nel file Remove. cpp.</span><span class="sxs-lookup"><span data-stu-id="bf566-109">RemoveAccount and RollbackAccount are in the file Remove.cpp.</span></span> <span data-ttu-id="bf566-110">Questi file di origine possono essere utilizzati per creare i file Process.dll, Create.dll e Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-110">These source files can be used to create the files Process.dll, Create.dll, and Remove.dll.</span></span>

<span data-ttu-id="bf566-111">Poiché la creazione o la rimozione di un account utente richiede privilegi elevati, è necessario utilizzare le [azioni personalizzate di esecuzione posticipata](deferred-execution-custom-actions.md) eseguite nel contesto del sistema per creare, rimuovere o eseguire il rollback degli account utente.</span><span class="sxs-lookup"><span data-stu-id="bf566-111">Because the creation or removal of a user account requires elevated privileges, [deferred execution custom actions](deferred-execution-custom-actions.md) that run in the context of the system must be used to create, remove, or roll back user accounts.</span></span> <span data-ttu-id="bf566-112">Le azioni personalizzate di esecuzione immediata, ProcessAccounts e UninstallAccounts, generano le azioni personalizzate posticipate per la creazione, la rimozione o il rollback degli account utente: CreateAccount, RemoveAccount e RollbackAccount.</span><span class="sxs-lookup"><span data-stu-id="bf566-112">The immediate execution custom actions, ProcessAccounts and UninstallAccounts, generate the deferred custom actions that create, remove, or rollback user accounts: CreateAccount, RemoveAccount, and RollbackAccount.</span></span>

<span data-ttu-id="bf566-113">Poiché le azioni personalizzate posticipate non possono leggere informazioni nelle tabelle di database, ProcessAccounts e UninstallUserAccouts devono impostare una proprietà CustomActionData per passare le informazioni nella tabella UserAccounts alle azioni personalizzate posticipate, come descritto in [ottenere informazioni sul contesto per le azioni personalizzate di esecuzione posticipata](obtaining-context-information-for-deferred-execution-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-113">Because deferred custom actions cannot read information in database tables, ProcessAccounts and UninstallUserAccouts must set a CustomActionData property to pass the information in the UserAccounts table to the deferred custom actions as described in [Obtaining Context Information for Deferred Execution Custom Actions](obtaining-context-information-for-deferred-execution-custom-actions.md).</span></span> <span data-ttu-id="bf566-114">Quando il programma di installazione esegue lo script di esecuzione, le azioni personalizzate posticipate gestiscono gli account utente in base alle informazioni contenute nella proprietà CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="bf566-114">When the installer runs the execution script, the deferred custom actions handle user accounts according to the information in the CustomActionData property.</span></span>

<span data-ttu-id="bf566-115">Poiché tutte le azioni personalizzate si trovano in librerie a collegamento dinamico archiviate nella tabella binaria, includono tutte le costanti msidbCustomActionTypeDll e msidbCustomActionTypeBinaryData nel tipo numerico di base.</span><span class="sxs-lookup"><span data-stu-id="bf566-115">Because all the custom actions are in dynamic-link libraries stored in the Binary table, they all include the constants msidbCustomActionTypeDll and msidbCustomActionTypeBinaryData in their base numeric type.</span></span> <span data-ttu-id="bf566-116">ProcessAccounts e UninstallAccounts sono esempi di [azione personalizzata pure di tipo 1](custom-action-type-1.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-116">ProcessAccounts and UninstallAccounts are examples of pure [Custom Action Type 1](custom-action-type-1.md).</span></span> <span data-ttu-id="bf566-117">Per informazioni sugli altri tipi di azione personalizzati, vedere l' [elenco riepilogativo di tutti i tipi di azione personalizzati](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-117">For information on other custom action types see the [Summary List of All Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span>

<span data-ttu-id="bf566-118">CreateAccount e RemoveAccount sono [azioni personalizzate di esecuzione posticipata](deferred-execution-custom-actions.md) che non consentono ai servizi di rappresentare utenti specifici.</span><span class="sxs-lookup"><span data-stu-id="bf566-118">CreateAccount and RemoveAccount are [deferred execution custom actions](deferred-execution-custom-actions.md) that do not allow services to impersonate particular users.</span></span> <span data-ttu-id="bf566-119">Queste azioni personalizzate includono le costanti msidbCustomActionTypeInScript e msidbCustomActionTypeNoImpersonate per specificare le [Opzioni di esecuzione in-script di un'azione personalizzata](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-119">These custom actions include the constants msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="bf566-120">RollbackAccount è un' [azione personalizzata di rollback](rollback-custom-actions.md) che rimuove solo gli account utente durante un' [installazione di rollback](rollback-installation.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-120">RollbackAccount is a [rollback custom action](rollback-custom-actions.md) that only removes user accounts during a [rollback installation](rollback-installation.md).</span></span> <span data-ttu-id="bf566-121">RollbackAccount include le costanti msidbCustomActionTypeInScript e msidbCustomActionTypeRollback per specificare le [Opzioni di esecuzione di un'azione personalizzata in-script](custom-action-in-script-execution-options.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-121">RollbackAccount includes the constants msidbCustomActionTypeInScript and msidbCustomActionTypeRollback to specify these [custom action in-script execution options](custom-action-in-script-execution-options.md).</span></span>

<span data-ttu-id="bf566-122">Queste azioni personalizzate possono gestire dati sensibili, ad esempio password utente, che non devono essere scritte nel file di log.</span><span class="sxs-lookup"><span data-stu-id="bf566-122">These custom actions may handle sensitive data such as user passwords, which should not be written to the log file.</span></span> <span data-ttu-id="bf566-123">Le azioni personalizzate posticipate dovrebbero pertanto includere msidbCustomActionTypeHideTarget nel tipo di azione personalizzato.</span><span class="sxs-lookup"><span data-stu-id="bf566-123">The deferred custom actions should therefore include msidbCustomActionTypeHideTarget in the custom action type.</span></span> <span data-ttu-id="bf566-124">I nomi delle azioni personalizzate posticipate devono anche essere aggiunti all'elenco di proprietà [**MsiHiddenProperties**](msihiddenproperties.md) nella [tabella delle proprietà](property-table.md) a causa del modo in cui le azioni personalizzate immediate passano i dati alle azioni personalizzate posticipate usando la proprietà CustomActionData.</span><span class="sxs-lookup"><span data-stu-id="bf566-124">The names of the deferred custom actions also need to be added to the [**MsiHiddenProperties**](msihiddenproperties.md) property list in the [Property table](property-table.md) because of the way immediate custom actions pass data to deferred custom actions using the CustomActionData property.</span></span>



| <span data-ttu-id="bf566-125">Azione personalizzata</span><span class="sxs-lookup"><span data-stu-id="bf566-125">Custom action</span></span>     | <span data-ttu-id="bf566-126">Punto di ingresso DLL</span><span class="sxs-lookup"><span data-stu-id="bf566-126">DLL entry point</span></span>                       | <span data-ttu-id="bf566-127">Tipo di azione personalizzata</span><span class="sxs-lookup"><span data-stu-id="bf566-127">Custom action type</span></span>                                                                                                                                                         |
|-------------------|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bf566-128">ProcessAccounts</span><span class="sxs-lookup"><span data-stu-id="bf566-128">ProcessAccounts</span></span>   | <span data-ttu-id="bf566-129">ProcessUserAccounts in Process.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-129">ProcessUserAccounts in Process.dll.</span></span>   | <span data-ttu-id="bf566-130">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span><span class="sxs-lookup"><span data-stu-id="bf566-130">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="bf566-131">UninstallAccounts</span><span class="sxs-lookup"><span data-stu-id="bf566-131">UninstallAccounts</span></span> | <span data-ttu-id="bf566-132">UninstallUserAccounts in Process.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-132">UninstallUserAccounts in Process.dll.</span></span> | <span data-ttu-id="bf566-133">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span><span class="sxs-lookup"><span data-stu-id="bf566-133">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData = 1</span></span>                                                                                                             |
| <span data-ttu-id="bf566-134">CreateAccount</span><span class="sxs-lookup"><span data-stu-id="bf566-134">CreateAccount</span></span>     | <span data-ttu-id="bf566-135">CreateUserAccount in Create.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-135">CreateUserAccount in Create.dll.</span></span>      | <span data-ttu-id="bf566-136">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="bf566-136">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="bf566-137">RemoveAccount</span><span class="sxs-lookup"><span data-stu-id="bf566-137">RemoveAccount</span></span>     | <span data-ttu-id="bf566-138">RemoveUserAccount in Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-138">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="bf566-139">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span><span class="sxs-lookup"><span data-stu-id="bf566-139">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate + msidbCustomActionTypeHideTarget = 11265.</span></span> |
| <span data-ttu-id="bf566-140">RollbackAccount</span><span class="sxs-lookup"><span data-stu-id="bf566-140">RollbackAccount</span></span>   | <span data-ttu-id="bf566-141">RemoveUserAccount in Remove.dll.</span><span class="sxs-lookup"><span data-stu-id="bf566-141">RemoveUserAccount in Remove.dll.</span></span>      | <span data-ttu-id="bf566-142">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span><span class="sxs-lookup"><span data-stu-id="bf566-142">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeInScript + msidbCustomActionTypeRollback + msidbCustomActionTypeHideTarget = 9473.</span></span>       |



 

<span data-ttu-id="bf566-143">Continuare con [la creazione della tabella CustomAction](authoring-the-customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="bf566-143">Continue to [Authoring the CustomAction Table](authoring-the-customaction-table.md).</span></span>

 

 



