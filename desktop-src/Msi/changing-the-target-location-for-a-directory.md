---
description: Se possibile, il modo migliore per specificare il percorso di destinazione per una directory consiste nel creare la tabella di directory nel pacchetto di installazione per fornire la posizione corretta. Per ulteriori informazioni, vedere Utilizzo della tabella directory.
ms.assetid: 2d16e036-2d7f-431d-b646-1addf2f65f3f
title: Modifica del percorso di destinazione per una directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 818c4e9d555244dd1637e19eb249478f13ea2d48
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104227199"
---
# <a name="changing-the-target-location-for-a-directory"></a><span data-ttu-id="c5295-104">Modifica del percorso di destinazione per una directory</span><span class="sxs-lookup"><span data-stu-id="c5295-104">Changing the Target Location for a Directory</span></span>

<span data-ttu-id="c5295-105">Se possibile, il modo migliore per specificare il percorso di destinazione per una directory consiste nel creare la [tabella di directory](directory-table.md) nel pacchetto di installazione per fornire la posizione corretta.</span><span class="sxs-lookup"><span data-stu-id="c5295-105">If possible, the best way to specify the target location for a directory is to author the [Directory Table](directory-table.md) in your installation package to provide the correct location.</span></span> <span data-ttu-id="c5295-106">Per ulteriori informazioni, vedere [utilizzo della tabella directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="c5295-106">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>

<span data-ttu-id="c5295-107">Se è necessario modificare il percorso della directory al momento dell'installazione, sono disponibili le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c5295-107">If you need to change the directory location at the time of the installation, you have the following options:</span></span>

-   <span data-ttu-id="c5295-108">Specificare il percorso di una directory impostando il valore di una [proprietà pubblica](public-properties.md) nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="c5295-108">Specify the location of a directory by setting the value of a [Public Property](public-properties.md) on the command line.</span></span> <span data-ttu-id="c5295-109">Durante l' [azione CostFinalize secondo](costfinalize-action.md), i percorsi di directory interni utilizzati dal programma di installazione vengono aggiornati al valore delle proprietà elencate come chiavi nella [tabella directory](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="c5295-109">During the [CostFinalize Action](costfinalize-action.md), the internal directory paths used by the installer are updated to the value of properties listed as keys in the [Directory Table](directory-table.md).</span></span> <span data-ttu-id="c5295-110">Per ulteriori informazioni, vedere [utilizzo delle proprietà](using-properties.md) e [impostazione dei valori delle proprietà pubbliche nella riga di comando](setting-public-property-values-on-the-command-line.md).</span><span class="sxs-lookup"><span data-stu-id="c5295-110">For more information, see [Using Properties](using-properties.md) and [Setting Public Property Values on the Command Line](setting-public-property-values-on-the-command-line.md).</span></span>
-   <span data-ttu-id="c5295-111">Specificare il percorso di una directory usando un'azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="c5295-111">Specify the location of a directory by using a custom action.</span></span> <span data-ttu-id="c5295-112">Se l'azione personalizzata deve essere eseguita prima dell' [azione CostFinalize secondo](costfinalize-action.md), è possibile usare un [tipo di azione personalizzata 51](custom-action-type-51.md) per impostare il valore di una proprietà da una stringa di testo formattato.</span><span class="sxs-lookup"><span data-stu-id="c5295-112">If the custom action is to run before the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 51](custom-action-type-51.md) to set the value of a property from a formatted text string.</span></span> <span data-ttu-id="c5295-113">Se l'azione personalizzata viene eseguita dopo l' [azione CostFinalize secondo](costfinalize-action.md), è possibile usare un [tipo di azione personalizzata 35](custom-action-type-35.md) per impostare il valore del percorso della directory da una stringa di testo formattato.</span><span class="sxs-lookup"><span data-stu-id="c5295-113">If the custom action runs after the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 35](custom-action-type-35.md) to set the value of the directory path from a formatted text string.</span></span> <span data-ttu-id="c5295-114">Le azioni personalizzate che modificano una [delle proprietà della cartella di sistema](property-reference.md) devono essere incluse nelle tabelle di sequenza di esecuzione (tabella [InstallExecuteSequence](installexecutesequence-table.md) o tabella [AdminExecuteSequence](adminexecutesequence-table.md)) e nelle tabelle di sequenza dell'interfaccia utente (tabella [InstallUISequence](installuisequence-table.md) e [tabella AdminUISequence](adminuisequence-table.md)) in modo che la cartella venga modificata durante le installazioni [*complete*](f-gly.md) dell'interfaccia utente e dell'interfaccia utente di [*base*](b-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="c5295-114">Custom actions that change one of the [System Folder Properties](property-reference.md) should be included in both the execution sequence tables ([InstallExecuteSequence Table](installexecutesequence-table.md) or [AdminExecuteSequence Table](adminexecutesequence-table.md)), and the user interface sequence tables ([InstallUISequence Table](installuisequence-table.md) and [AdminUISequence Table](adminuisequence-table.md)) so that the folder is changed during both [*full UI*](f-gly.md) and [*basic UI*](b-gly.md) installations.</span></span>
-   <span data-ttu-id="c5295-115">Se l'installazione esegue un' [*interfaccia utente completa*](f-gly.md), è possibile usare [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) o [SetTargetPath ControlEvent](settargetpath-controlevent.md) per impostare il percorso della directory.</span><span class="sxs-lookup"><span data-stu-id="c5295-115">If the installation is running a [*full UI*](f-gly.md), you can use [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) or the [SetTargetPath ControlEvent](settargetpath-controlevent.md) to set the directory path.</span></span> <span data-ttu-id="c5295-116">Controllare la proprietà [**ProductState**](productstate.md) per determinare se il prodotto che contiene il componente è già installato prima di chiamare **MsiSetTargetPath** o SetTargetPath ControlEvent.</span><span class="sxs-lookup"><span data-stu-id="c5295-116">Check the [**ProductState**](productstate.md) Property to determine whether the product that contains this component is already installed before calling **MsiSetTargetPath** or the SetTargetPath ControlEvent.</span></span> <span data-ttu-id="c5295-117">Non tentare di modificare il percorso della directory di destinazione se alcuni componenti che usano tale percorso sono già installati per l'utente corrente o per un altro utente.</span><span class="sxs-lookup"><span data-stu-id="c5295-117">Do not attempt to change the target directory path if some components that use that path are already installed for the current user or a different user.</span></span>

<span data-ttu-id="c5295-118">Per tutte le opzioni sopra riportate si applicano le restrizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c5295-118">The following restrictions apply to all of the above options:</span></span>

-   <span data-ttu-id="c5295-119">Non tentare di modificare il percorso della directory di destinazione se alcuni componenti che usano il percorso sono già installati per l'utente corrente o per un altro utente.</span><span class="sxs-lookup"><span data-stu-id="c5295-119">Do not attempt to change the target directory path if some components that use the path are already installed for the current user or for a different user.</span></span>
-   <span data-ttu-id="c5295-120">Non tentare di modificare il percorso della directory di destinazione durante un' [installazione di manutenzione](maintenance-installation.md).</span><span class="sxs-lookup"><span data-stu-id="c5295-120">Do not attempt to change the target directory path during a [Maintenance Installation](maintenance-installation.md).</span></span>

 

 



