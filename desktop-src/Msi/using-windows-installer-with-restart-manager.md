---
description: Le applicazioni che utilizzano Windows Installer 4,0 per l'installazione e la manutenzione in Windows Vista utilizzano automaticamente Gestione riavvio per ridurre i riavvii del sistema.
ms.assetid: 821739ff-f7a7-4192-ad34-254aa7d74d13
title: Uso di Windows Installer con Gestione riavvio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4160b2241c75ec7305accd1ab4d1295a54fa9f65
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308176"
---
# <a name="using-windows-installer-with-restart-manager"></a><span data-ttu-id="1f02b-103">Uso di Windows Installer con Gestione riavvio</span><span class="sxs-lookup"><span data-stu-id="1f02b-103">Using Windows Installer with Restart Manager</span></span>

<span data-ttu-id="1f02b-104">Le applicazioni che utilizzano Windows Installer 4,0 per l'installazione e la manutenzione in Windows Vista utilizzano automaticamente [Gestione riavvio](../rstmgr/restart-manager-portal.md) per ridurre i riavvii del sistema.</span><span class="sxs-lookup"><span data-stu-id="1f02b-104">Applications that use Windows Installer 4.0 for installation and servicing on Windows Vista automatically use the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts.</span></span> <span data-ttu-id="1f02b-105">Il comportamento predefinito in Windows Vista consiste nell'arrestare le applicazioni anziché arrestare e riavviare il sistema operativo laddove possibile.</span><span class="sxs-lookup"><span data-stu-id="1f02b-105">The default behavior on Windows Vista is to shut down applications rather than shut down and restart the operating system whenever possible.</span></span> <span data-ttu-id="1f02b-106">Nei casi in cui un riavvio del sistema è inevitabile, i programmi di installazione possono usare l'API di [Gestione riavvio](../rstmgr/restart-manager-portal.md) per pianificare i riavvii in modo da ridurre al minimo l'alterazione del flusso di lavoro dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1f02b-106">In cases where a system restart is unavoidable, installers can use the [Restart Manager](../rstmgr/restart-manager-portal.md) API to schedule restarts in such a way that it minimizes the disruption of the user's work flow.</span></span>

<span data-ttu-id="1f02b-107">Windows Installer gli sviluppatori possono eseguire le azioni seguenti per preparare il pacchetto in modo che funzioni con [Gestione riavvio](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="1f02b-107">Windows Installer developers can perform the following actions to prepare their package to work with the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span>

-   <span data-ttu-id="1f02b-108">Aggiungere la finestra di dialogo [MsiRMFilesInUse](msirmfilesinuse-dialog.md) al pacchetto.</span><span class="sxs-lookup"><span data-stu-id="1f02b-108">Add the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box to your package.</span></span> <span data-ttu-id="1f02b-109">Se la finestra di dialogo MsiRMFilesInUse è presente nel pacchetto, l'utente di Windows Vista che esegue un'installazione al livello completo dell' [interfaccia utente](user-interface-levels.md) dell'interfaccia utente ha la possibilità di chiudere e riavviare automaticamente le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="1f02b-109">If the MsiRMFilesInUse dialog box is present in the package, the Windows Vista user running an installation at the Full UI [user interface level](user-interface-levels.md) is given the option to automatically close and restart applications.</span></span> <span data-ttu-id="1f02b-110">Un pacchetto di installazione può contenere informazioni per la finestra di dialogo MsiRMFilesInUse e la finestra di dialogo [filesinus](filesinuse-dialog.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-110">An installation package can contain information for both the MsiRMFilesInUse dialog box and the [FilesInUse](filesinuse-dialog.md) dialog box .</span></span> <span data-ttu-id="1f02b-111">La finestra di dialogo MsiRMFilesInUse viene visualizzata solo se il pacchetto è installato con almeno Windows Installer 4,0 in Windows Vista e in caso contrario viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="1f02b-111">The MsiRMFilesInUse dialog box is only displayed if the package is installed with at least Windows Installer 4.0 on Windows Vista, and is otherwise ignored.</span></span> <span data-ttu-id="1f02b-112">I pacchetti esistenti che non hanno la finestra di dialogo MsiRMFilesInUse continuano a funzionare usando la finestra di dialogo filesinusale.</span><span class="sxs-lookup"><span data-stu-id="1f02b-112">Existing packages that do not have the MsiRMFilesInUse dialog box continue to function using the FilesInUse dialog box.</span></span> <span data-ttu-id="1f02b-113">È possibile utilizzare una trasformazione di personalizzazione per aggiungere una finestra di dialogo MsiRMFilesInUse a pacchetti esistenti.</span><span class="sxs-lookup"><span data-stu-id="1f02b-113">A customization transform can be used to add an MsiRMFilesInUse dialog box to existing packages.</span></span>

    <span data-ttu-id="1f02b-114">Gli utenti finali eseguono in genere installazioni al livello completo dell' [interfaccia utente](user-interface-levels.md)dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="1f02b-114">End-users typically run installations at the Full UI [user interface level](user-interface-levels.md).</span></span> <span data-ttu-id="1f02b-115">Le installazioni di base dell'interfaccia utente o a livello di interfaccia utente ridotto consentono all'utente di usare [Gestione riavvio](../rstmgr/restart-manager-portal.md) per ridurre i riavvii del sistema anche se la finestra di dialogo [MsiRMFilesInUse](msirmfilesinuse-dialog.md) non è presente.</span><span class="sxs-lookup"><span data-stu-id="1f02b-115">Basic UI or Reduced UI level installations give the user the option of using the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts even if the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box is not present.</span></span> <span data-ttu-id="1f02b-116">Le installazioni a livello di interfaccia utente invisibile all'utente arrestano sempre le applicazioni e i servizi e in Windows Vista utilizzano sempre Gestione riavvio.</span><span class="sxs-lookup"><span data-stu-id="1f02b-116">Silent UI level installations always shut down applications and services, and on Windows Vista, always use Restart Manager.</span></span>

-   <span data-ttu-id="1f02b-117">Registrare le applicazioni per un riavvio utilizzando la funzione [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-117">Register applications for a restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function.</span></span> <span data-ttu-id="1f02b-118">Gestione riavvio può riavviare solo le applicazioni che sono state registrate per il riavvio.</span><span class="sxs-lookup"><span data-stu-id="1f02b-118">Restart Manager can only restart applications that have been registered for restart.</span></span> <span data-ttu-id="1f02b-119">Gestione riavvio riavvia le applicazioni registrate dopo l'installazione.</span><span class="sxs-lookup"><span data-stu-id="1f02b-119">Restart Manager restarts registered applications after the installation.</span></span> <span data-ttu-id="1f02b-120">Se l'installazione richiede un riavvio del sistema, gestione riavvio riavvia l'applicazione registrata dopo il riavvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="1f02b-120">If the installation requires a system restart, Restart Manager restarts the registered application after the system restart.</span></span>
-   <span data-ttu-id="1f02b-121">Specificare INSTALLLOGMODE \_ RMFILESINUSE quando si Abilita un gestore dell'interfaccia utente esterno con le funzioni [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) e [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-121">Specify INSTALLLOGMODE\_RMFILESINUSE when enabling an external user-interface handler with the [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) and [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) functions.</span></span> <span data-ttu-id="1f02b-122">Windows Installer invierà un \_ messaggio INSTALLMESSAGE RMFILESINUSE per i gestori dell'interfaccia utente esterni che supportano [Gestione riavvio](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="1f02b-122">Windows Installer will send a INSTALLMESSAGE\_RMFILESINUSE message for external user-interface handlers that support the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span> <span data-ttu-id="1f02b-123">Se nessuna interfaccia utente registrata o interna gestisce il messaggio INSTALLMESSAGE \_ RMFILESINUSE, il programma di installazione invia un \_ messaggio filesinus INSTALLMESSAGE per i gestori dell'interfaccia utente che supportano la finestra di dialogo [filesinusale](filesinuse-dialog.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-123">If no registered or internal user-interface handles the INSTALLMESSAGE\_RMFILESINUSE message, the installer sends a INSTALLMESSAGE\_FILESINUSE message for user-interface handlers that support the [FilesInUse](filesinuse-dialog.md) dialog box.</span></span> <span data-ttu-id="1f02b-124">Per ulteriori informazioni, vedere [utilizzo di gestione riavvio con un'interfaccia utente esterna](using-restart-manager-with-an-external-ui-.md).</span><span class="sxs-lookup"><span data-stu-id="1f02b-124">For more information, see [Using Restart Manager with an External UI](using-restart-manager-with-an-external-ui-.md).</span></span>
-   <span data-ttu-id="1f02b-125">Le azioni personalizzate possono aggiungere risorse appartenenti a una sessione di [Gestione riavvio](../rstmgr/restart-manager-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-125">Custom actions can add resources belonging to a [Restart Manager](../rstmgr/restart-manager-portal.md) session.</span></span> <span data-ttu-id="1f02b-126">L'azione personalizzata deve essere sequenziata prima dell'azione [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-126">The custom action should be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="1f02b-127">Le azioni personalizzate possono utilizzare la proprietà [**MsiRestartManagerSessionKey**](msirestartmanagersessionkey.md) per ottenere la chiave della sessione e devono chiamare le funzioni [**RmJoinSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) e [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) dell'API di gestione riavvio.</span><span class="sxs-lookup"><span data-stu-id="1f02b-127">Custom actions can use the [**MsiRestartManagerSessionKey**](msirestartmanagersessionkey.md) property to obtain the session key, and should call the [**RmJoinSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) and [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) functions of the Restart Manager API.</span></span> <span data-ttu-id="1f02b-128">Le azioni personalizzate non possono rimuovere risorse appartenenti a una sessione di gestione riavvio.</span><span class="sxs-lookup"><span data-stu-id="1f02b-128">Custom actions cannot remove resources belonging to a Restart Manager session.</span></span> <span data-ttu-id="1f02b-129">Le azioni personalizzate non devono tentare di arrestare o riavviare le applicazioni usando le funzioni [**RmShutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) e [**RmRestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-129">Custom actions should not attempt to shutdown or restart applications using the [**RmShutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) and [**RmRestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) functions.</span></span>
-   <span data-ttu-id="1f02b-130">Gli autori di pacchetti possono basare una condizione nella [tabella LaunchCondition](launchcondition-table.md) della proprietà [**MsiSystemRebootPending**](msisystemrebootpending.md) per impedire l'installazione del pacchetto quando un riavvio del sistema è in sospeso.</span><span class="sxs-lookup"><span data-stu-id="1f02b-130">Package authors can base a condition in the [LaunchCondition table](launchcondition-table.md) on the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to prevent the installation of their package when a system restart is pending.</span></span>
-   <span data-ttu-id="1f02b-131">Gli autori e gli amministratori di pacchetti possono controllare l'interazione di Windows Installer e gestione riavvio usando le proprietà [**MSIRESTARTMANAGERCONTROL**](msirestartmanagercontrol.md), [**MSIDISABLERMRESTART**](msidisablermrestart.md), [**MSIRMSHUTDOWN**](msirmshutdown.md) e [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-131">Package authors and administrators can control the interaction of the Windows Installer and Restart Manager by using the [**MSIRESTARTMANAGERCONTROL**](msirestartmanagercontrol.md), [**MSIDISABLERMRESTART**](msidisablermrestart.md), [**MSIRMSHUTDOWN**](msirmshutdown.md) properties and the [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md) policy.</span></span>
-   <span data-ttu-id="1f02b-132">Le applicazioni e i servizi devono seguire le linee guida descritte nella sezione [utilizzo di gestione riavvio](../rstmgr/using-restart-manager.md) della documentazione di [Gestione riavvio](../rstmgr/restart-manager-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="1f02b-132">Applications and services should follow the guidelines described in the [Using Restart Manager](../rstmgr/using-restart-manager.md) section of the [Restart Manager](../rstmgr/restart-manager-portal.md) documentation.</span></span>

 

 
