---
description: Nella procedura descritta in questo argomento viene illustrato come creare un pacchetto di Windows Installer per installare un assembly Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Installazione di assembly Win32 per l'utilizzo privato di un'applicazione in Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307728"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="1ad84-103">Installazione di assembly Win32 per l'utilizzo privato di un'applicazione in Windows XP</span><span class="sxs-lookup"><span data-stu-id="1ad84-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="1ad84-104">Nella procedura descritta in questo argomento viene illustrato come creare un pacchetto di Windows Installer per installare un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="1ad84-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="1ad84-105">Il pacchetto installa l'assembly e un file manifesto dell'applicazione in una cartella creata che l'applicazione utilizza.</span><span class="sxs-lookup"><span data-stu-id="1ad84-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="1ad84-106">Il manifesto dell'applicazione specifica la dipendenza dell'applicazione nell'assembly privato.</span><span class="sxs-lookup"><span data-stu-id="1ad84-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="1ad84-107">Dopo l'installazione del pacchetto, l'assembly privato è disponibile per l'utilizzo esclusivo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1ad84-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="1ad84-108">La dipendenza degli assembly specificata nel manifesto dell'applicazione sostituisce (per questa applicazione) qualsiasi altra dipendenza di assembly globale specificata nei file manifesto dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="1ad84-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="1ad84-109">Prima di continuare, è consigliabile comprendere come creare un pacchetto di Windows Installer senza assembly.</span><span class="sxs-lookup"><span data-stu-id="1ad84-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="1ad84-110">Per ulteriori informazioni, vedere [un esempio di installazione](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="1ad84-111">**Per installare un assembly privato in Windows XP**</span><span class="sxs-lookup"><span data-stu-id="1ad84-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="1ad84-112">Definire un componente Windows Installer che includa l'assembly Win32 e il file manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1ad84-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="1ad84-113">Questo componente può contenere altre risorse che devono essere sempre installate o rimosse con l'assembly.</span><span class="sxs-lookup"><span data-stu-id="1ad84-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="1ad84-114">Nei passaggi rimanenti di questa procedura viene descritto come creare il database di installazione per installare questo componente.</span><span class="sxs-lookup"><span data-stu-id="1ad84-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="1ad84-115">Aggiungere una riga alla [tabella dei componenti](component-table.md) per il componente che contiene l'assembly Win32 e il file manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1ad84-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="1ad84-116">Immettere un [GUID](guid.md) Windows Installer valido per questo codice componente.</span><span class="sxs-lookup"><span data-stu-id="1ad84-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="1ad84-117">Per altre informazioni, vedere [modifica del codice del componente](changing-the-component-code.md) e [cosa accade se le regole dei componenti sono interrotte?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="1ad84-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="1ad84-118">Il programma di installazione copia il file manifesto dell'assembly nella cartella che contiene il file specificato nel \_ campo file Application della [tabella MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="1ad84-119">Aggiungere una riga alla [tabella FeatureComponents](featurecomponents-table.md) che lega il componente a una funzionalità Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="1ad84-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="1ad84-120">Per ulteriori informazioni, vedere [componenti e funzionalità](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="1ad84-121">Una funzionalità di Windows Installer deve essere una parte della funzionalità dell'applicazione che un utente è in grado di riconoscere.</span><span class="sxs-lookup"><span data-stu-id="1ad84-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="1ad84-122">L'assembly viene attivato quando questa funzionalità viene selezionata da un utente o con errori in da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1ad84-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="1ad84-123">Se l'assembly definisce una funzionalità aggiuntiva, aggiungere una riga aggiuntiva alla [tabella delle funzionalità](feature-table.md) per gli attributi della funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1ad84-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="1ad84-124">Questo passaggio non è necessario se si crea un modulo unione.</span><span class="sxs-lookup"><span data-stu-id="1ad84-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="1ad84-125">Per gli assembly affiancati, le informazioni sull'associazione e sull'attivazione, ad esempio le classi COM, le interfacce e le librerie dei tipi, vengono archiviate in file manifesto invece che nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="1ad84-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="1ad84-126">Gli assembly privati archiviano queste informazioni in un manifesto dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="1ad84-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="1ad84-127">Nei sistemi che supportano gli assembly affiancati, il programma di installazione ignora l'elaborazione di tutte le informazioni sul componente immesso nella [tabella delle estensioni](extension-table.md), nella tabella dei [verbi](verb-table.md), nella [tabella TypeLib](typelib-table.md), nella tabella [MIME](mime-table.md), nella tabella delle [classi](class-table.md), nella [tabella ProgId](progid-table.md)e nella tabella [AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="1ad84-128">Le informazioni di associazione e attivazione possono essere immesse nelle tabelle per l'uso da parte di sistemi che non supportano la condivisione di assembly affiancati.</span><span class="sxs-lookup"><span data-stu-id="1ad84-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="1ad84-129">L'installazione side-by-side non registra l'assembly a livello globale.</span><span class="sxs-lookup"><span data-stu-id="1ad84-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="1ad84-130">Il programma di installazione ignora la registrazione automatica del componente se nella [tabella SelfReg](selfreg-table.md)vengono immesse eventuali informazioni di registrazione automatica.</span><span class="sxs-lookup"><span data-stu-id="1ad84-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="1ad84-131">È possibile immettere le informazioni di registrazione automatica nella tabella SelfReg per la registrazione automatica del componente nei sistemi che non supportano la condivisione di assembly affiancati.</span><span class="sxs-lookup"><span data-stu-id="1ad84-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="1ad84-132">Aggiungere qualsiasi altra informazione del registro di sistema, esclusa l'associazione e l'attivazione o la registrazione automatica del componente, per la tabella [del registro di sistema](registry-table.md), la [tabella RemoveRegistry](removeregistry-table.md)e la [tabella dell'ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="1ad84-133">Il programma di installazione ignora la [tabella IsolatedComponent](isolatedcomponent-table.md) per questo componente nei sistemi operativi che supportano la condivisione side-by-side.</span><span class="sxs-lookup"><span data-stu-id="1ad84-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="1ad84-134">Immettere le informazioni in questa tabella se si desidera che l'assembly sia privato nei sistemi che supportano i file locali.</span><span class="sxs-lookup"><span data-stu-id="1ad84-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="1ad84-135">Aggiungere una riga alla [tabella MsiAssembly](msiassembly-table.md) per il componente che contiene l'assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="1ad84-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="1ad84-136">Immettere il valore 1 nel campo attributi della tabella MsiAssembly per specificare che si tratta di un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="1ad84-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="1ad84-137">Immettere la chiave del file dell'assembly privato nel campo file \_ Application della [tabella MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="1ad84-138">Aggiungere l' [azione MsiPublishAssemblies](msipublishassemblies-action.md) alla tabella [InstallExecuteSequence](installexecutesequence-table.md) o [AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="1ad84-139">Aggiungere l' [azione MsiUnpublishAssemblies](msiunpublishassemblies-action.md) alla tabella InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="1ad84-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="1ad84-140">Creare una cartella per l'assembly e il file manifesto nella [tabella directory](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="1ad84-141">Questa cartella deve trovarsi nella directory radice dell'applicazione e contenere il file specificato nel campo file \_ Application della [tabella MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="1ad84-142">Durante l'installazione dell'applicazione, il programma di installazione risolve la [tabella di directory](directory-table.md) per il percorso di questa cartella.</span><span class="sxs-lookup"><span data-stu-id="1ad84-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="1ad84-143">Per ulteriori informazioni, vedere [utilizzo della tabella directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="1ad84-144">Aggiungere righe alla [tabella MsiAssemblyName](msiassemblyname-table.md) per il componente.</span><span class="sxs-lookup"><span data-stu-id="1ad84-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="1ad84-145">Aggiungere una riga per ogni coppia di nome e valore specificata nella sezione assemblyIdentity del manifesto.</span><span class="sxs-lookup"><span data-stu-id="1ad84-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="1ad84-146">Per altre informazioni, vedere [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="1ad84-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



