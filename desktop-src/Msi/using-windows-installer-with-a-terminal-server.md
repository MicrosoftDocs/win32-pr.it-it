---
description: Quando si utilizza un server terminal, può interessare le installazioni di Windows Installer seguenti. Gli sviluppatori del programma di installazione devono sempre verificare che il pacchetto di Windows Installer venga installato come previsto quando gli utenti utilizzano anche un server terminal.
ms.assetid: deda9efa-a0fc-4b4e-a531-650ac201fd84
title: Uso di Windows Installer con un Terminal Server
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d471fa19b4588a01a2730af44fa5e9d978d18859
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484660"
---
# <a name="using-windows-installer-with-a-terminal-server"></a><span data-ttu-id="3ef53-104">Uso di Windows Installer con un Terminal Server</span><span class="sxs-lookup"><span data-stu-id="3ef53-104">Using Windows Installer with a Terminal Server</span></span>

<span data-ttu-id="3ef53-105">Quando si utilizza un server terminal, può interessare le installazioni di Windows Installer seguenti.</span><span class="sxs-lookup"><span data-stu-id="3ef53-105">The following may affect Windows Installer installations when using a terminal server.</span></span> <span data-ttu-id="3ef53-106">Gli sviluppatori del programma di installazione devono sempre verificare che il pacchetto di Windows Installer venga installato come previsto quando gli utenti utilizzano anche un server terminal.</span><span class="sxs-lookup"><span data-stu-id="3ef53-106">Setup developers should always test that their Windows Installer package installs as expected when users are also using a terminal server.</span></span>

-   <span data-ttu-id="3ef53-107">Nei sistemi operativi precedenti a Windows Server 2008 e Windows Vista, i criteri di sistema [EnableAdminTSRemote](enableadmintsremote.md) devono essere impostati in modo da consentire agli amministratori di eseguire installazioni nella sessione client.</span><span class="sxs-lookup"><span data-stu-id="3ef53-107">On operating systems earlier than Windows Server 2008 and Windows Vista, the [EnableAdminTSRemote](enableadmintsremote.md) system policy must be set to enable administrators to perform installations in the client session.</span></span> <span data-ttu-id="3ef53-108">A partire da Windows Server 2008 e Windows Vista, il criterio EnableAdminTSRemote non ha più alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="3ef53-108">Beginning with Windows Server 2008 and Windows Vista, the EnableAdminTSRemote policy no longer has any effect.</span></span> <span data-ttu-id="3ef53-109">Indipendentemente dall'impostazione, gli amministratori e gli amministratori non possono eseguire un'installazione nella sessione client o nella sessione della console.</span><span class="sxs-lookup"><span data-stu-id="3ef53-109">Regardless of its setting, administrators and non-administrators can perform an installation in the client session or the console session.</span></span> <span data-ttu-id="3ef53-110">Gli amministratori e gli amministratori non possono sempre eseguire le installazioni Windows Installer nella sessione della console.</span><span class="sxs-lookup"><span data-stu-id="3ef53-110">Administrators and non-administrators can always perform Windows Installer installations in the console session.</span></span>
-   <span data-ttu-id="3ef53-111">Il Windows Installer impedisce l'installazione nel [contesto di installazione](installation-context.md) per utente se il[criterio di sistema](system-policy.md) [DisableUserInstalls](disableuserinstalls.md)è impostato su 1.</span><span class="sxs-lookup"><span data-stu-id="3ef53-111">The Windows Installer prevents installation in the per-user [installation context](installation-context.md) if the [DisableUserInstalls](disableuserinstalls.md)[system policy](system-policy.md) is set to 1.</span></span> <span data-ttu-id="3ef53-112">In questo caso, il programma di installazione ignora tutte le applicazioni registrate come per singolo utente e cerca solo le applicazioni registrate come per computer.</span><span class="sxs-lookup"><span data-stu-id="3ef53-112">In this case, the installer ignores all applications registered as per-user and searches only for applications registered as per-machine.</span></span>
-   <span data-ttu-id="3ef53-113">Quando un amministratore esegue un'installazione in una sessione client di un server terminal ospitato in Windows 2000, è necessario che l'installazione usi un percorso UNC e non una lettera di unità mappata.</span><span class="sxs-lookup"><span data-stu-id="3ef53-113">When an administrator performs an installation in a client session of a terminal server that is hosted in Windows 2000, the installation must use a UNC path and not a mapped drive letter.</span></span>

<span data-ttu-id="3ef53-114">Quando si sviluppa un componente Windows Installer che può essere utilizzato con un server terminal, gli sviluppatori devono attenersi alle linee guida seguenti.</span><span class="sxs-lookup"><span data-stu-id="3ef53-114">Developers should adhere to the following guidelines when developing a Windows Installer component that may be used with a terminal server.</span></span>

-   <span data-ttu-id="3ef53-115">Scrivere tutte le informazioni del registro di sistema **HKCU** nella  \\ parte **software** HKCU del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="3ef53-115">Write all **HKCU** registry information in the **HKCU**\\**Software** part of the registry.</span></span>
-   <span data-ttu-id="3ef53-116">Non è consigliabile archiviare le informazioni di configurazione nei file INI.</span><span class="sxs-lookup"><span data-stu-id="3ef53-116">Storing configuration information in INI files is not recommended.</span></span>
-   <span data-ttu-id="3ef53-117">Consente di scrivere le informazioni per utente nel registro di sistema quando l'applicazione viene eseguita per la prima volta e non in fase di installazione.</span><span class="sxs-lookup"><span data-stu-id="3ef53-117">Write per-user information to the registry when the application is run for the first time and not at installation time.</span></span> <span data-ttu-id="3ef53-118">Se è necessario scrivere le informazioni per utente nel registro di sistema al momento dell'installazione, separare le informazioni per utente e per computer in componenti Windows Installer diversi.</span><span class="sxs-lookup"><span data-stu-id="3ef53-118">If you must write per-user information to the registry at installation time, separate the per-user and per-machine information into different Windows Installer components.</span></span> <span data-ttu-id="3ef53-119">Creare il pacchetto in modo che il programma di installazione non tenti di convalidare e riparare i componenti contenenti informazioni per utente durante l'installazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3ef53-119">Author the package such that the installer does not attempt to validate and repair the components containing per-user information when the application is installed.</span></span>
-   <span data-ttu-id="3ef53-120">Un pacchetto usato solo per le installazioni per computer deve scrivere le variabili di ambiente nell'ambiente del computer includendo \* nella colonna nome della [tabella dell'ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="3ef53-120">A package used for only per-machine installations should write environment variables to the computer's environment by including \* in the Name column of the [Environment Table](environment-table.md).</span></span> <span data-ttu-id="3ef53-121">Se il pacchetto può essere usato per installazioni per utente o per computer, usare due componenti.</span><span class="sxs-lookup"><span data-stu-id="3ef53-121">If the package can be used for per-user installations or per-machine installations, use two components.</span></span> <span data-ttu-id="3ef53-122">Includere il componente per utente nella tabella dei [componenti](condition-table.md) e immettere le impostazioni utente nella tabella dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-122">Include the per-user component in the [Component Table](condition-table.md) and enter the user settings in the Environment Table.</span></span> <span data-ttu-id="3ef53-123">Includere il componente per computer nella tabella dei componenti e immettere le impostazioni del computer nella tabella dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-123">Include the per-machine component in the Component Table and enter the computer settings in the Environment Table.</span></span> <span data-ttu-id="3ef53-124">Controllare quale componente viene installato utilizzando istruzioni condizionali basate sulla proprietà [**ALLUSERS**](allusers.md) nel campo condition della tabella Component.</span><span class="sxs-lookup"><span data-stu-id="3ef53-124">Control which component gets installed by using conditional statements based upon the [**ALLUSERS**](allusers.md) property in the Condition field of the Component Table.</span></span>
-   <span data-ttu-id="3ef53-125">Quando si eseguono installazioni per computer da un server terminal, il programma di installazione scrive le variabili di ambiente per ogni utente in **HKCU** \\ **.** \\ **Ambiente** predefinito.</span><span class="sxs-lookup"><span data-stu-id="3ef53-125">When performing per-machine installations from a terminal server, the installer writes per-user environment variables to **HKCU**\\ **.Default**\\**Environment**.</span></span> <span data-ttu-id="3ef53-126">Poiché il server terminal non esegue la replica di questa sezione del registro di sistema, l'installazione non imposta le variabili di ambiente per singolo utente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-126">Because the terminal server does not replicate this section of the registry, the installation does not set the per-user environment variables.</span></span>
-   <span data-ttu-id="3ef53-127">Poiché un server può essere configurato per impedire agli utenti di ripristinare le applicazioni, l'applicazione deve gestire il caso di chiavi del registro di sistema mancanti normalmente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-127">Because a server may be configured to prevent users from repairing applications, your application should handle the case of missing registry keys gracefully.</span></span>

<span data-ttu-id="3ef53-128">Le condizioni seguenti si applicano quando un pacchetto di Windows Installer che utilizza [azioni personalizzate](custom-actions.md) dll, exe o script viene installato nel contesto di installazione per computer in un server terminal.</span><span class="sxs-lookup"><span data-stu-id="3ef53-128">The following applies when a Windows Installer package that uses DLL, EXE, or Script [custom actions](custom-actions.md) is installed in the per-machine installation context on a terminal server.</span></span> <span data-ttu-id="3ef53-129">In questo caso, il programma di installazione imposta la proprietà [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="3ef53-129">In this case, the installer sets the [**TerminalServer**](terminalserver.md) property.</span></span>

-   <span data-ttu-id="3ef53-130">Le azioni personalizzate posticipate vengono eseguite nel contesto del sistema locale, a meno che l'azione non includa l'attributo **msidbCustomActionTypeTSAware** .</span><span class="sxs-lookup"><span data-stu-id="3ef53-130">Deferred custom actions run in the context of the local system unless the action has the **msidbCustomActionTypeTSAware** attribute.</span></span> <span data-ttu-id="3ef53-131">Questo vale anche se l'azione personalizzata rappresenta l'utente in un sistema che non è un server terminal.</span><span class="sxs-lookup"><span data-stu-id="3ef53-131">This is true even if the custom action impersonates the user on a system that is not a terminal server.</span></span> <span data-ttu-id="3ef53-132">Si noti che se un'azione personalizzata con l'attributo **msidbCustomActionTypeTSAware** modifica il registro di sistema dell'utente, il programma di installazione non verifica automaticamente che tali modifiche vengano apportate anche nel registro di sistema di ogni utente del computer.</span><span class="sxs-lookup"><span data-stu-id="3ef53-132">Note that if a custom action having the **msidbCustomActionTypeTSAware** attribute changes the user's registry, the installer does not automatically ensure that those changes are also made in the registry of every user on the computer.</span></span>
-   <span data-ttu-id="3ef53-133">Qualsiasi operazione del registro di sistema in un'azione personalizzata posticipata che legge dall'hive del registro di sistema **HKCU** Visualizza l'hive del registro di sistema predefinito del sistema e non l'hive del registro di sistema dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-133">Any registry operations in a deferred custom action that read from the **HKCU** registry hive sees the system's default registry hive and not the current user's registry hive.</span></span>
-   <span data-ttu-id="3ef53-134">Tutte le operazioni del registro di sistema in un'azione personalizzata posticipata che scrivono in **HKCU** \\ **software** vengono rilevate dal programma di installazione e copiate a ogni utente del computer al successivo accesso dell'utente.</span><span class="sxs-lookup"><span data-stu-id="3ef53-134">Any registry operations in a deferred custom action that write to **HKCU**\\**Software** are detected by the installer and copied to every user of the computer at the next logon of the user.</span></span>
-   <span data-ttu-id="3ef53-135">Qualsiasi operazione del registro di sistema in un'azione personalizzata posticipata che scrive in **HKCU**, ma che non si trova sotto la  \\ chiave del registro di sistema HKCU **software** , non viene rilevata dal programma di installazione o copiata.</span><span class="sxs-lookup"><span data-stu-id="3ef53-135">Any registry operations in a deferred custom action that write to **HKCU**, but are not under the **HKCU**\\**Software** registry key, are not detected by the installer or copied.</span></span>

<span data-ttu-id="3ef53-136">Per ulteriori informazioni, vedere [Servizi terminal](../termserv/terminal-services-portal.md) in Microsoft Windows Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="3ef53-136">For more information, see [Terminal Services](../termserv/terminal-services-portal.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>

## <a name="related-topics"></a><span data-ttu-id="3ef53-137">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3ef53-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3ef53-138">EnableAdminTSRemote</span><span class="sxs-lookup"><span data-stu-id="3ef53-138">EnableAdminTSRemote</span></span>](enableadmintsremote.md)
</dt> <dt>

[<span data-ttu-id="3ef53-139">**Proprietà TerminalServer**</span><span class="sxs-lookup"><span data-stu-id="3ef53-139">**TerminalServer property**</span></span>](terminalserver.md)
</dt> <dt>

[<span data-ttu-id="3ef53-140">**Proprietà RemoteAdminTS**</span><span class="sxs-lookup"><span data-stu-id="3ef53-140">**RemoteAdminTS property**</span></span>](remoteadmints.md)
</dt> <dt>

[<span data-ttu-id="3ef53-141">Servizi terminal</span><span class="sxs-lookup"><span data-stu-id="3ef53-141">Terminal Services</span></span>](../termserv/terminal-services-portal.md)
</dt> </dl>

 

 
