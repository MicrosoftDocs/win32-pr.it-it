---
description: "Questa sezione enumera un elenco di suggerimenti, collegati alla documentazione principale di Windows Installer SDK, per aiutare gli sviluppatori di applicazioni, gli autori di installazione, i professionisti IT e gli sviluppatori di infrastrutture a individuare le procedure consigliate per l'uso della Windows Installer:"
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Procedure consigliate Windows Installer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104057803"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="b9908-103">Procedure consigliate Windows Installer</span><span class="sxs-lookup"><span data-stu-id="b9908-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="b9908-104">Questa sezione enumera un elenco di suggerimenti, collegati alla documentazione principale di Windows Installer SDK, per aiutare gli sviluppatori di applicazioni, gli autori di installazione, i professionisti IT e gli sviluppatori di infrastrutture a individuare le procedure consigliate per l'uso della Windows Installer:</span><span class="sxs-lookup"><span data-stu-id="b9908-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="b9908-105">Aggiornare la versione del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="b9908-106">Soddisfare i requisiti di certificazione del logo Windows.</span><span class="sxs-lookup"><span data-stu-id="b9908-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="b9908-107">Preparare il pacchetto per la localizzazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="b9908-108">Aggiornare la documentazione e gli strumenti di sviluppo Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="b9908-109">Se si decide di ricreare un pacchetto di un'applicazione di installazione legacy, seguire le buone procedure per la creazione di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="b9908-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="b9908-110">Non tentare di sostituire le risorse protette.</span><span class="sxs-lookup"><span data-stu-id="b9908-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="b9908-111">Non dipendono da risorse non critiche.</span><span class="sxs-lookup"><span data-stu-id="b9908-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="b9908-112">Usare l'API per recuperare le informazioni di configurazione Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="b9908-113">Organizzare l'installazione dell'applicazione intorno ai componenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="b9908-114">Ridurre le dimensioni dei pacchetti di Windows Installer di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b9908-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="b9908-115">Se si usano azioni personalizzate, seguire le buone procedure di azione personalizzate.</span><span class="sxs-lookup"><span data-stu-id="b9908-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="b9908-116">Se si usano gli assembly, seguire le buone procedure per gli assembly</span><span class="sxs-lookup"><span data-stu-id="b9908-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="b9908-117">Non vengono fornite installazioni simultanee.</span><span class="sxs-lookup"><span data-stu-id="b9908-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="b9908-118">Mantieni i nomi dei pacchetti e i codici del pacchetto coerenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="b9908-119">Non usare le tabelle SelfReg e TypeLib.</span><span class="sxs-lookup"><span data-stu-id="b9908-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="b9908-120">Consente di specificare l'opzione di installazione senza interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="b9908-121">Evitare di usare i criteri AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="b9908-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="b9908-122">Abilitare il criterio DisableMedia per limitare l'installazione non autorizzata.</span><span class="sxs-lookup"><span data-stu-id="b9908-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="b9908-123">Mantieni i file di origine del pacchetto originali protetti e disponibili per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="b9908-124">Abilitare la registrazione dettagliata nel computer dell'utente durante la risoluzione dei problemi di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b9908-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="b9908-125">La disinstallazione lascia il computer dell'utente in uno stato pulito.</span><span class="sxs-lookup"><span data-stu-id="b9908-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="b9908-126">Testare i pacchetti per la distribuzione dell'installazione per utente e per computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="b9908-127">Pianificare e testare una strategia di manutenzione prima di distribuire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="b9908-128">Ridurre la dipendenza degli aggiornamenti sulle origini originali.</span><span class="sxs-lookup"><span data-stu-id="b9908-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="b9908-129">Non distribuire i moduli merge non collegabili.</span><span class="sxs-lookup"><span data-stu-id="b9908-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="b9908-130">Evitare l'applicazione di patch alle installazioni amministrative.</span><span class="sxs-lookup"><span data-stu-id="b9908-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="b9908-131">Registrare gli aggiornamenti da eseguire con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="b9908-132">Usare la tabella MsiPatchSequence per sequenziare le patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="b9908-133">Testare accuratamente il pacchetto di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="b9908-134">Correggere tutti gli errori di convalida prima di distribuire un pacchetto di installazione nuovo o modificato.</span><span class="sxs-lookup"><span data-stu-id="b9908-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="b9908-135">Creare un'installazione sicura.</span><span class="sxs-lookup"><span data-stu-id="b9908-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="b9908-136">USA PMSIHANDLE anziché HANDLE</span><span class="sxs-lookup"><span data-stu-id="b9908-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="b9908-137">Aggiornare la versione del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="b9908-138">Usare Windows Installer 5,0 in Windows Server 2008 R2 e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b9908-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="b9908-139">Si tratta della versione Windows Installer fornita con il sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="b9908-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="b9908-140">Utilizzare Windows Installer 4,5 in Windows Server 2008, Windows Server 2003 con Service Pack 1 (SP1), Windows Vista con Service Pack 1 (SP1) o Windows XP con Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="b9908-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="b9908-141">Per informazioni su come ottenere la versione più recente di Windows Installer, vedere [Windows Installer ridistribuibili](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="b9908-142">Usare Windows Installer 3,1 in Windows 2000 con Service Pack 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="b9908-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="b9908-143">Windows Installer versione 3,1 dispone di funzionalità che facilitano la manutenzione e l'applicazione di [patch](patching.md)migliori.</span><span class="sxs-lookup"><span data-stu-id="b9908-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="b9908-144">Molte importanti funzionalità sono state introdotte con la versione 3,0 e sono elencate nella sezione [non supportata in Windows Installer versione 2,0](not-supported-in-windows-installer-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="b9908-145">È possibile installare i pacchetti di installazione e gli aggiornamenti creati per Windows Installer 2,0 usando Windows Installer 3,0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="b9908-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="b9908-146">I pacchetti di patch contenenti le nuove tabelle utilizzate da Windows Installer 3,0 possono comunque essere applicati utilizzando versioni precedenti di Windows Installer ma senza la funzionalità di applicazione delle patch Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="b9908-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="b9908-147">È anche possibile creare patch che richiedono in modo esplicito il Windows Installer 3,0 che non possono essere applicate da versioni precedenti di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="b9908-148">Se un utente non è in grado di aggiornare la versione del programma di installazione, assicurarsi che l'applicazione o l'aggiornamento saranno compatibili con un aggiornamento futuro del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="b9908-149">Per un elenco delle funzionalità di Windows Installer non supportate nelle versioni precedenti di Windows Installer, vedere [novità di Windows Installer](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="b9908-150">Soddisfare i requisiti di certificazione del logo Windows.</span><span class="sxs-lookup"><span data-stu-id="b9908-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="b9908-151">Anche se non si prevede di inviare l'applicazione al programma logo, le linee guida per la certificazione del logo possono contribuire a migliorare il pacchetto di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="b9908-152">Per una panoramica dei requisiti del logo e per i collegamenti a specifici programmi di certificazione del logo, vedere [Windows Installer e logo requirements](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="b9908-153">Preparare il pacchetto per la localizzazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="b9908-154">È consigliabile prepararsi per la localizzazione futura durante la creazione del pacchetto di installazione originale.</span><span class="sxs-lookup"><span data-stu-id="b9908-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="b9908-155">È possibile seguire la procedura di localizzazione dei pacchetti suggerita in [localizzazione di un pacchetto di Windows Installer](localizing-a-windows-installer-package.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="b9908-156">Aggiornare la documentazione e gli strumenti di sviluppo Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="b9908-157">Gli [strumenti di sviluppo Windows Installer](windows-installer-development-tools.md) non sono ridistribuibili ed è consigliabile utilizzare solo le versioni di questi strumenti disponibili da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b9908-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="b9908-158">Questi sono disponibili nella [Windows SDK componenti per Windows Installer sviluppatori](platform-sdk-components-for-windows-installer-developers.md) in Microsoft Windows Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="b9908-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="b9908-159">Diversi fornitori di software indipendenti offrono strumenti per creare o modificare pacchetti Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="b9908-160">Questi strumenti possono fornire un ambiente di creazione di pacchetti che può essere più facile da usare rispetto agli strumenti disponibili in Windows Installer SDK.</span><span class="sxs-lookup"><span data-stu-id="b9908-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="b9908-161">Per ulteriori informazioni su questi strumenti, vedere le risorse di informazioni illustrate in [altre fonti di Windows Installer informazioni](other-sources-of-windows-installer-information.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="b9908-162">La possibilità di creare un pacchetto dai file di testo può essere più intuitiva per alcuni sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="b9908-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="b9908-163">Il set di strumenti Windows Installer XML (WiX) disponibile in [sourceforge.NET](https://sourceforge.net/projects/wix) compila i pacchetti di installazione di Windows dal codice sorgente XML.</span><span class="sxs-lookup"><span data-stu-id="b9908-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="b9908-164">La documentazione di [Windows Installer SDK](./windows-installer-portal.md) rilasciata in MSDN Library viene aggiornata più di frequente.</span><span class="sxs-lookup"><span data-stu-id="b9908-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="b9908-165">Utilizzare la versione recente di [Msizap.exe](msizap-exe.md) (versione 3.1.4000.2726 o successiva) disponibile nei [componenti Windows SDK per Windows Installer sviluppatori](platform-sdk-components-for-windows-installer-developers.md) per Windows Vista o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="b9908-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="b9908-166">Versioni minori di Msizap.exe possono rimuovere informazioni su tutti gli aggiornamenti applicati ad altre applicazioni nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="b9908-167">Se queste informazioni vengono rimosse, potrebbe essere necessario rimuovere e reinstallare le altre applicazioni per ricevere ulteriori aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="b9908-168">L'editor di tabelle di database [Orca.exe](orca-exe.md) è un editor di tabelle di database per la creazione e la modifica di Windows Installer pacchetti e i moduli unione.</span><span class="sxs-lookup"><span data-stu-id="b9908-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="b9908-169">Dispone di un'interfaccia GUI di base che supporta la modifica avanzata dei database Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="b9908-170">Anche se si usa un'altra applicazione come strumento di sviluppo principale, è possibile trovare l'uso di Orca.exe è utile per la risoluzione dei problemi e il test di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="b9908-171">Per informazioni aggiornate sui Windows Installer disponibili in Blog, chat tecniche, newsgroup, articoli tecnici e siti Web, vedere [altre fonti di Windows Installer informazioni](other-sources-of-windows-installer-information.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="b9908-172">Se si decide di ricreare un pacchetto di un'applicazione di installazione legacy, seguire le buone procedure per la creazione di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="b9908-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="b9908-173">Molti fornitori di applicazioni forniscono pacchetti di Windows Installer nativi per l'installazione o i prodotti.</span><span class="sxs-lookup"><span data-stu-id="b9908-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="b9908-174">Il software che converte un'applicazione di installazione legacy esistente in un pacchetto di Windows Installer viene definito strumento per la creazione di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="b9908-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="b9908-175">La [Guida dettagliata al white paper per la creazione di pacchetti di Windows Installer e la ricreazione del pacchetto del software per la Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) descrive uno strumento di Repackaging disponibile in commercio.</span><span class="sxs-lookup"><span data-stu-id="b9908-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="b9908-176">Il riassemblaggio di un'applicazione di installazione esistente non è la procedura di sviluppo ottimale.</span><span class="sxs-lookup"><span data-stu-id="b9908-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="b9908-177">Le applicazioni progettate dall'inizio per sfruttare i vantaggi delle funzionalità di Windows Installer possono essere più facili da installare e servire dagli utenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="b9908-178">Se si decide di usare un software di riconfezionamento, le procedure seguenti consentono di produrre un pacchetto di Windows Installer migliore.</span><span class="sxs-lookup"><span data-stu-id="b9908-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="b9908-179">La creazione di pacchetti di strumenti consente di convertire le installazioni legacy in un pacchetto di Windows Installer facendo un'immagine di un sistema di gestione temporanea prima e dopo l'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="b9908-180">Eventuali modifiche al registro di sistema, modifiche dei file o impostazioni di sistema che si verificano durante il processo di acquisizione sono incluse nell'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="b9908-181">Configurare l'hardware e il software del computer utilizzato per riassemblare l'installazione il più vicino possibile al sistema dell'utente desiderato.</span><span class="sxs-lookup"><span data-stu-id="b9908-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="b9908-182">Creare un pacchetto separato per ogni configurazione hardware differente.</span><span class="sxs-lookup"><span data-stu-id="b9908-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="b9908-183">Ricreare il pacchetto utilizzando un computer di staging pulito.</span><span class="sxs-lookup"><span data-stu-id="b9908-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="b9908-184">Rimuovere tutte le applicazioni non necessarie.</span><span class="sxs-lookup"><span data-stu-id="b9908-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="b9908-185">Arrestare tutti i processi non necessari.</span><span class="sxs-lookup"><span data-stu-id="b9908-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="b9908-186">Chiudere tutti i servizi di sistema non essenziali.</span><span class="sxs-lookup"><span data-stu-id="b9908-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="b9908-187">Prima di iniziare a lavorare, creare sempre una copia dell'installazione originale.</span><span class="sxs-lookup"><span data-stu-id="b9908-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="b9908-188">Usare sempre la copia.</span><span class="sxs-lookup"><span data-stu-id="b9908-188">Always work on the copy.</span></span> <span data-ttu-id="b9908-189">Non arrestare mai un riassemblatore prima di completare la compilazione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="b9908-190">Se il riassemblatore danneggia il pacchetto, si avrà ancora l'originale.</span><span class="sxs-lookup"><span data-stu-id="b9908-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="b9908-191">Non riassemblare gli aggiornamenti software Microsoft in un pacchetto di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="b9908-192">Microsoft rilascia gli aggiornamenti software, ad esempio i Service Pack, come file autoestraenti che eseguono automaticamente l'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="b9908-193">Questi aggiornamenti usano programmi di installazione diversi rispetto al Windows Installer per sostituire le risorse protette di Windows e non possono essere convertiti in un pacchetto di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="b9908-194">Per informazioni su come distribuire i Service Pack di Windows, vedere la guida alla distribuzione di Service Pack in [Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="b9908-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="b9908-195">Non usare uno strumento di reimballaggio per convertire un pacchetto di Windows Installer in un nuovo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="b9908-196">Il Windows Installer aggiunge informazioni di configurazione al sistema e alle risorse dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="b9908-197">Quando uno strumento di reimballaggio confronta il sistema prima e dopo l'installazione, il reimballatore interpreta erroneamente le informazioni di configurazione come parte dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="b9908-198">Questa operazione in genere danneggia l'applicazione riassemblata.</span><span class="sxs-lookup"><span data-stu-id="b9908-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="b9908-199">Usare invece le [trasformazioni di personalizzazione](a-customization-transform-example.md) per modificare un pacchetto di Windows Installer esistente o creare un nuovo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="b9908-200">È possibile creare trasformazioni di personalizzazione utilizzando lo strumento [Msitran.exe](msitran-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="b9908-201">Non usare uno strumento di riconfezionamento per consolidare diversi pacchetti di Windows Installer in un unico pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="b9908-202">È invece possibile usare lo strumento [Msistuff.exe](msistuff-exe.md) per configurare l'eseguibile di bootstrap Setup.exe per installare i pacchetti uno dopo l'altro.</span><span class="sxs-lookup"><span data-stu-id="b9908-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="b9908-203">Creare il pacchetto di Windows Installer in modo che possa essere facilmente personalizzato dal cliente.</span><span class="sxs-lookup"><span data-stu-id="b9908-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="b9908-204">Le variabili globali utilizzate dal Windows Installer durante un'installazione possono essere impostate utilizzando le [Proprietà](properties.md) pubbliche o le [trasformazioni di personalizzazione](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="b9908-205">Fornire la documentazione per l'utilizzo di tali proprietà e i valori predefiniti pratici per tutti i valori personalizzabili.</span><span class="sxs-lookup"><span data-stu-id="b9908-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="b9908-206">Per informazioni su come ottenere e impostare le proprietà, vedere [using Properties](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="b9908-207">Per un esempio di trasformazione della personalizzazione, vedere [un esempio di trasformazione della personalizzazione](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="b9908-208">Non tentare di sostituire le risorse protette.</span><span class="sxs-lookup"><span data-stu-id="b9908-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="b9908-209">I pacchetti Windows Installer non devono tentare di sostituire le risorse protette durante l'installazione o l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="b9908-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="b9908-210">Il Windows Installer non rimuove o sostituisce queste risorse perché Windows impedisce la sostituzione di file di sistema, cartelle e chiavi del registro di sistema essenziali.</span><span class="sxs-lookup"><span data-stu-id="b9908-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="b9908-211">La protezione di queste risorse impedisce gli errori dell'applicazione e del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="b9908-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="b9908-212">Quando è in esecuzione in Windows Server 2008 o Windows Vista, il Windows Installer ignora l'installazione di qualsiasi file o chiave del registro di sistema protetta da [Protezione risorse di Windows](../wfp/windows-resource-protection-portal.md) (WRP), il programma di installazione immette un avviso nel file di log e continua con il resto dell'installazione senza errori.</span><span class="sxs-lookup"><span data-stu-id="b9908-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="b9908-213">Per informazioni, vedere [utilizzo di Windows Installer e protezione risorse di Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="b9908-214">WRP è il nuovo nome per la protezione dei file di Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="b9908-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="b9908-215">WRP protegge le chiavi del registro di sistema e le cartelle, nonché i file di sistema essenziali.</span><span class="sxs-lookup"><span data-stu-id="b9908-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="b9908-216">In Windows Server 2003, Windows XP e Windows 2000, quando il Windows Installer ha rilevato un file protetto da WFP, il programma di installazione richiederà l'installazione del file da parte di Pam.</span><span class="sxs-lookup"><span data-stu-id="b9908-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="b9908-217">Per informazioni, vedere [utilizzo di Windows Installer e protezione risorse di Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="b9908-218">Non dipendono da risorse non critiche.</span><span class="sxs-lookup"><span data-stu-id="b9908-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="b9908-219">L'installazione o l'aggiornamento non deve dipendere dall'installazione di risorse non critiche per i motivi seguenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="b9908-220">Le azioni personalizzate possono avere esito negativo se dipendono da un componente appartenente a una funzionalità che l'utente annuncia anziché installare.</span><span class="sxs-lookup"><span data-stu-id="b9908-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="b9908-221">Le azioni personalizzate sequenziate prima dell'azione [InstallFinalize](installfinalize-action.md) possono avere esito negativo se dipendono da un componente contenente un assembly in fase di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="b9908-222">Il Windows Installer non esegue il commit degli assembly nella global assembly cache (GAC) finché non viene completata l'azione InstallFinalize.</span><span class="sxs-lookup"><span data-stu-id="b9908-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="b9908-223">Usare l'API per recuperare le informazioni di configurazione Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="b9908-224">L'installazione dell'applicazione o dell'aggiornamento non deve dipendere dall'accesso diretto alle informazioni di configurazione Windows Installer salvate nel computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="b9908-225">Usare invece il Application Programming Interface Windows Installer per recuperare le informazioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="b9908-226">Il percorso e il formato delle informazioni di configurazione sono gestiti dal servizio Windows Installer e possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="b9908-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="b9908-227">Le funzioni di installazione e configurazione dell'API Windows Installer sono descritte nella Guida di [riferimento alla funzione del programma](installer-function-reference.md)di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="b9908-228">Le [proprietà di configurazione](property-reference.md) sono descritte nel riferimento alla proprietà.</span><span class="sxs-lookup"><span data-stu-id="b9908-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="b9908-229">I metodi e le proprietà di automazione sono descritti nella Guida di [riferimento all'interfaccia di automazione](automation-interface-reference.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="b9908-230">Lo script di esempio WiLstPrd.vbs si connette a un oggetto del programma di installazione ed enumera i prodotti registrati e le informazioni sul prodotto.</span><span class="sxs-lookup"><span data-stu-id="b9908-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="b9908-231">Per informazioni, vedere [elencare prodotti, proprietà, funzionalità e componenti](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="b9908-232">Organizzare l'installazione dell'applicazione intorno ai componenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="b9908-233">Il servizio Windows Installer installa o rimuove raccolte di risorse definite [componenti](windows-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="b9908-234">Poiché i componenti sono comunemente condivisi, l'autore di un pacchetto di installazione deve seguire le regole quando si specificano i componenti di una funzionalità o di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="b9908-235">Rispettare le regole dei componenti quando si [organizzano le applicazioni in componenti](organizing-applications-into-components.md) per garantire che i nuovi componenti, o le nuove versioni dei componenti, possano essere installati e rimossi senza danneggiare altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b9908-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="b9908-236">È possibile seguire la procedura descritta in [definizione dei componenti del programma di installazione](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="b9908-237">Il programma di installazione tiene traccia di ogni componente per il rispettivo GUID ID componente specificato nella [tabella dei componenti](component-table.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="b9908-238">È essenziale per il funzionamento del Windows Installer meccanismo di conteggio dei riferimenti che il GUID dell'ID componente sia corretto.</span><span class="sxs-lookup"><span data-stu-id="b9908-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="b9908-239">Seguire le linee guida per la [modifica del codice componente](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="b9908-240">Se il pacchetto deve suddividere le regole dei componenti, tenere presenti le possibili conseguenze e assicurarsi che l'installazione non installi mai questi componenti in modo che possano danneggiare i componenti nel sistema dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="b9908-241">Per informazioni, vedere [cosa accade se le regole del componente sono interrotte?](what-happens-if-the-component-rules-are-broken.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="b9908-242">Tenere presente il modo in cui il Windows Installer applica le [regole di controllo delle versioni dei file](file-versioning-rules.md) durante la sostituzione dei [file esistenti](replacing-existing-files.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="b9908-243">Il Windows Installer determina innanzitutto se il file di chiave del componente è già installato prima di tentare di installare uno dei file del componente.</span><span class="sxs-lookup"><span data-stu-id="b9908-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="b9908-244">Se il programma di installazione trova un file con lo stesso nome del file di chiave del componente installato nel percorso di destinazione, confronta la versione, la data e la lingua dei due file chiave e usa le regole di controllo delle versioni dei file per determinare se installare il componente fornito dal pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="b9908-245">Se il programma di installazione stabilisce che è necessario sostituire la base del componente sul file di chiave, USA le regole di controllo delle versioni dei file per ogni file installato per determinare se sostituire il file.</span><span class="sxs-lookup"><span data-stu-id="b9908-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="b9908-246">Ridurre le dimensioni dei pacchetti di Windows Installer di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b9908-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="b9908-247">I pacchetti Windows di grandi dimensioni accettano risorse di sistema e possono essere difficili da installare per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="b9908-248">È consigliabile ridurre le dimensioni dei pacchetti di Windows Installer molto grandi con i metodi seguenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="b9908-249">Comprimere i file nell'installazione e archiviarli in un file CAB (con estensione cab).</span><span class="sxs-lookup"><span data-stu-id="b9908-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="b9908-250">Il programma di installazione consente di archiviare il file con estensione cab come file esterno separato o come flusso di dati nel pacchetto MSI stesso.</span><span class="sxs-lookup"><span data-stu-id="b9908-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="b9908-251">Per informazioni [, vedere uso di cabinet e origini compresse](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="b9908-252">Rimuovere lo spazio di archiviazione sprecato nel file con estensione MSI usando una delle opzioni descritte in [riduzione delle dimensioni di un file con estensione msi](reducing-the-size-of-an--msi-file.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="b9908-253">Se il pacchetto di Windows Installer contiene più di 32767 file, è necessario modificare lo schema del database.</span><span class="sxs-lookup"><span data-stu-id="b9908-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="b9908-254">Per informazioni, vedere [creazione di un pacchetto di grandi dimensioni](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="b9908-255">Se si usano azioni personalizzate, seguire le buone procedure di azione personalizzate.</span><span class="sxs-lookup"><span data-stu-id="b9908-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="b9908-256">Il Windows Installer dispone di molte [azioni standard](standard-actions-reference.md) predefinite per l'installazione e la gestione delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b9908-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="b9908-257">Gli sviluppatori devono provare a basarsi sulle azioni standard quanto più pratica, anziché creare [azioni personalizzate](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="b9908-258">Tuttavia, esistono situazioni in cui lo sviluppatore di un pacchetto di installazione rileva che è necessario scrivere un'azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="b9908-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="b9908-259">Seguire le linee guida per l' [uso di azioni personalizzate](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="b9908-260">Seguire le [linee guida per proteggere le azioni personalizzate](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="b9908-261">Le azioni personalizzate che usano informazioni riservate non devono scrivere queste informazioni nel log.</span><span class="sxs-lookup"><span data-stu-id="b9908-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="b9908-262">Per informazioni, vedere [sicurezza dell'azione personalizzata](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="b9908-263">Le azioni personalizzate non devono tentare di impostare un punto di ingresso di ripristino del sistema dall'interno di un'azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="b9908-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="b9908-264">Per informazioni, vedere [impostazione di un punto di ripristino da un'azione personalizzata](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="b9908-265">Restituisce i messaggi di errore dalle azioni personalizzate e li scrive nel log per facilitare la risoluzione dei problemi relativi alle azioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="b9908-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="b9908-266">Per informazioni, vedere [azioni personalizzate del messaggio di errore](error-message-custom-actions.md) e [restituzione di messaggi di errore da azioni personalizzate](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="b9908-267">Non modificare lo stato del sistema da un'azione personalizzata immediata.</span><span class="sxs-lookup"><span data-stu-id="b9908-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="b9908-268">Le azioni personalizzate che modificano direttamente il sistema o chiamano un altro servizio di sistema devono essere rinviate al momento in cui viene eseguito lo script di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="b9908-269">Ogni [azione personalizzata di esecuzione posticipata](deferred-execution-custom-actions.md) che modifica lo stato del sistema deve essere preceduta da un' [azione personalizzata rollback](rollback-custom-actions.md) per annullare la modifica dello stato del sistema durante il rollback dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="b9908-270">Per informazioni, vedere [modifica dello stato del sistema mediante un'azione personalizzata](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="b9908-271">Le azioni personalizzate che eseguono operazioni di installazione complesse devono essere un [file eseguibile](executable-files.md) o una [libreria a collegamento dinamico](dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="b9908-272">Limitare l'uso di azioni personalizzate basate su [script](scripts.md) per semplici operazioni di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="b9908-273">Rendere facilmente individuabili gli amministratori di sistema i dettagli relativi all'azione personalizzata eseguita dal sistema.</span><span class="sxs-lookup"><span data-stu-id="b9908-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="b9908-274">Inserire i dettagli delle voci del registro di sistema e dei file utilizzati dall'azione personalizzata in una tabella personalizzata e fare in modo che l'azione personalizzata legga da questa tabella.</span><span class="sxs-lookup"><span data-stu-id="b9908-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="b9908-275">Questa operazione viene illustrata nell'esempio di [utilizzo di un'azione personalizzata per creare account utente in un computer locale](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="b9908-276">Per informazioni sull'aggiunta di tabelle personalizzate a un database, vedere [utilizzo di query](working-with-queries.md) ed [esempi di query di database tramite SQL e script](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="b9908-277">Le azioni personalizzate non devono visualizzare una finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b9908-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="b9908-278">Le azioni personalizzate che richiedono un'interfaccia utente possono invece usare la funzione [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) .</span><span class="sxs-lookup"><span data-stu-id="b9908-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="b9908-279">Vedere [invio di messaggi a Windows Installer con MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="b9908-280">Per le azioni personalizzate non è necessario utilizzare alcuna delle funzioni elencate nella pagina: [funzioni non utilizzabili in azioni personalizzate](functions-not-for-use-in-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="b9908-281">Se l'installazione è progettata per l'esecuzione in un server terminal, verificare che tutte le azioni personalizzate siano in grado di essere eseguite in un server terminal.</span><span class="sxs-lookup"><span data-stu-id="b9908-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="b9908-282">Per ulteriori informazioni, vedere proprietà [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="b9908-283">Per eseguire un'azione personalizzata quando una particolare patch viene disinstallata, l'azione personalizzata deve essere presente nell'applicazione originale o essere inclusa in una patch per il prodotto che viene sempre applicato.</span><span class="sxs-lookup"><span data-stu-id="b9908-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="b9908-284">Per altre informazioni, vedere [patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="b9908-285">Le azioni personalizzate non devono utilizzare il livello di interfaccia utente come condizione per l'invio di messaggi di errore al programma di installazione, in quanto ciò può interferire con la registrazione e i messaggi esterni.</span><span class="sxs-lookup"><span data-stu-id="b9908-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="b9908-286">Per informazioni, vedere [determinazione del livello dell'interfaccia utente da un'azione personalizzata](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="b9908-287">Usare le istruzioni condizionali e la [sintassi dell'istruzione condizionale](conditional-statement-syntax.md) per garantire che il pacchetto esegua correttamente le azioni personalizzate, non esegue azioni personalizzate o esegue un'azione personalizzata alternativa quando il pacchetto viene disinstallato.</span><span class="sxs-lookup"><span data-stu-id="b9908-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="b9908-288">Verificare che il pacchetto funzioni come previsto durante la [Disinstallazione delle azioni personalizzate](uninstalling-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="b9908-289">Per informazioni, vedere [azioni di condizionamento da eseguire durante la rimozione](conditioning-actions-to-run-during-removal.md)</span><span class="sxs-lookup"><span data-stu-id="b9908-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="b9908-290">Se l'installazione deve essere in grado di essere eseguita da utenti che non dispongono di privilegi di amministratore, eseguire un test per assicurarsi che tutte le azioni personalizzate possano essere eseguite con privilegi non amministrativi.</span><span class="sxs-lookup"><span data-stu-id="b9908-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="b9908-291">Per le azioni personalizzate sono necessari privilegi elevati per modificare parti del sistema che non sono specifiche dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="b9908-292">Il programma di installazione può eseguire azioni personalizzate con privilegi elevati se è in corso l'installazione di un'applicazione gestita o se i criteri di sistema sono stati specificati per privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="b9908-293">Tutte le azioni personalizzate che richiedono privilegi elevati devono includere l'azione personalizzata msidbCustomActionTypeInScript e msidbCustomActionTypeNoImpersonate [In-Script opzioni di esecuzione](custom-action-in-script-execution-options.md) nel tipo di azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="b9908-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="b9908-294">Questa operazione viene illustrata nell'esempio di [utilizzo di un'azione personalizzata per creare account utente in un computer locale](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="b9908-295">Se si usano gli assembly, seguire le buone procedure per gli assembly</span><span class="sxs-lookup"><span data-stu-id="b9908-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="b9908-296">Se il pacchetto utilizza [assembly](assemblies.md)software, attenersi alle linee guida per l' [aggiunta di assembly a un pacchetto](adding-assemblies-to-a-package.md), l' [aggiornamento degli assembly](updating-assemblies.md)e [l'installazione e la rimozione di assembly](installing-and-removing-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="b9908-297">Non vengono fornite installazioni simultanee.</span><span class="sxs-lookup"><span data-stu-id="b9908-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="b9908-298">Le [installazioni simultanee](concurrent-installations.md), denominate anche installazioni annidate, installano un altro pacchetto Windows Installer durante un'installazione attualmente in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="b9908-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="b9908-299">L'uso di installazioni simultanee non è una procedura consigliata perché è difficile per i clienti.</span><span class="sxs-lookup"><span data-stu-id="b9908-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="b9908-300">L'applicazione di patch e l'aggiornamento potrebbero non funzionare con le installazioni simultanee.</span><span class="sxs-lookup"><span data-stu-id="b9908-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="b9908-301">L'alternativa consigliata per l'utilizzo di installazioni simultanee consiste invece nell'utilizzare un'applicazione di installazione e un gestore dell'interfaccia utente esterno per installare più pacchetti Windows Installer in modo sequenziale.</span><span class="sxs-lookup"><span data-stu-id="b9908-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="b9908-302">Per ulteriori informazioni sull'utilizzo di un gestore dell'interfaccia utente esterno, vedere [monitoraggio di un'installazione mediante MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="b9908-303">Per ulteriori informazioni sull'utilizzo di un gestore esterno basato su record, vedere [monitoraggio di un'installazione mediante MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="b9908-304">Le installazioni simultanee vengono talvolta utilizzate negli ambienti aziendali controllati per installare le applicazioni che non sono destinate al pubblico.</span><span class="sxs-lookup"><span data-stu-id="b9908-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="b9908-305">Se si decide di utilizzare installazioni simultanee, attenersi a queste linee guida.</span><span class="sxs-lookup"><span data-stu-id="b9908-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="b9908-306">Non utilizzare installazioni simultanee per installare o aggiornare un prodotto di spedizione.</span><span class="sxs-lookup"><span data-stu-id="b9908-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="b9908-307">Le installazioni simultanee non devono condividere i componenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="b9908-308">Un'installazione amministrativa non deve contenere un'installazione simultanea.</span><span class="sxs-lookup"><span data-stu-id="b9908-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="b9908-309">I ProgressBar integrati non devono essere usati con installazioni simultanee.</span><span class="sxs-lookup"><span data-stu-id="b9908-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="b9908-310">Le risorse da annunciare non devono essere installate da un'installazione simultanea.</span><span class="sxs-lookup"><span data-stu-id="b9908-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="b9908-311">Un pacchetto che esegue un'installazione simultanea di un'applicazione deve disinstallare anche l'applicazione simultanea quando viene disinstallato il prodotto padre.</span><span class="sxs-lookup"><span data-stu-id="b9908-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="b9908-312">Un'installazione nidificata è presente nel contesto del prodotto padre in Installazione applicazioni nel pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="b9908-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="b9908-313">Mantieni i nomi dei pacchetti e i codici del pacchetto coerenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="b9908-314">Al file con estensione msi è possibile assegnare qualsiasi nome che consenta agli utenti di identificare il pacchetto, ma il nome non deve essere modificato senza modificare anche il codice del prodotto.</span><span class="sxs-lookup"><span data-stu-id="b9908-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="b9908-315">Assegnare al file con estensione msi un nome descrittivo che consenta all'utente di identificare il contenuto del pacchetto Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="b9908-316">Il [codice del prodotto](product-codes.md) è l'identificazione principale di un'applicazione e deve essere modificato ogni volta che viene eseguito un aggiornamento completo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="b9908-317">Per informazioni, vedere [**ProductCode**](productcode.md) e [modifica del codice del prodotto](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="b9908-318">La modifica del nome del file con estensione msi dell'applicazione è considerata una modifica completa e richiede sempre una modifica corrispondente del codice prodotto per garantire la coerenza.</span><span class="sxs-lookup"><span data-stu-id="b9908-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="b9908-319">Il [codice del pacchetto](package-codes.md) è l'identificatore primario utilizzato dal programma di installazione per cercare e convalidare il pacchetto corretto per una determinata installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="b9908-320">Due file con estensione msi non identici dovrebbero avere sempre lo stesso codice del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="b9908-321">Se un pacchetto viene modificato senza modificare il codice del pacchetto, è possibile che il programma di installazione non usi il pacchetto più recente se entrambi sono ancora accessibili al programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="b9908-322">Il codice del pacchetto viene archiviato nella proprietà [**Riepilogo numero revisione**](revision-number-summary.md) del [flusso di informazioni di riepilogo](summary-information-stream.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="b9908-323">Si noti che le lettere nel codice del prodotto e i [GUID](guid.md) del codice del pacchetto devono essere tutti in maiuscolo.</span><span class="sxs-lookup"><span data-stu-id="b9908-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="b9908-324">Non usare le tabelle SelfReg e TypeLib.</span><span class="sxs-lookup"><span data-stu-id="b9908-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="b9908-325">Gli autori dei pacchetti di installazione si sconsigliano vivamente di usare la registrazione automatica e la tabella [selfreg](selfreg-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="b9908-326">Devono invece registrare i moduli creando una o più tabelle nel [gruppo tabelle del registro di sistema](registry-tables-group.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="b9908-327">Molti dei vantaggi della Windows Installer vengono persi con la registrazione automatica perché le routine di registrazione automatica tendono a nascondere le informazioni di configurazione critiche.</span><span class="sxs-lookup"><span data-stu-id="b9908-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="b9908-328">Per un elenco dei motivi per evitare la registrazione automatica, vedere [tabella SelfReg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="b9908-329">Gli autori dei pacchetti di installazione si sconsigliano vivamente di utilizzare la tabella [typelib](typelib-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="b9908-330">Anziché utilizzare la tabella TypeLib, registrare le librerie dei tipi utilizzando la tabella [del registro di sistema](registry-table.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="b9908-331">Se un'installazione che utilizza la tabella TypeLib ha esito negativo ed è necessario eseguirne il rollback, è possibile che il rollback non ripristini il computer nello stesso stato esistente prima del rollback.</span><span class="sxs-lookup"><span data-stu-id="b9908-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="b9908-332">Consente di specificare l'opzione di installazione senza interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="b9908-333">Spesso gli amministratori preferiscono distribuire le applicazioni all'interno di un'azienda senza richiedere l'intervento dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="b9908-334">È consigliabile consentire all'applicazione di fornire la possibilità di installare con il [livello di interfaccia utente](user-interface-levels.md) di nessuno.</span><span class="sxs-lookup"><span data-stu-id="b9908-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="b9908-335">Utilizzare le [proprietà pubbliche](public-properties.md) per le informazioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="b9908-336">Gli amministratori possono fornire queste informazioni nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="b9908-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="b9908-337">Non richiedere che l'installazione dipenda dalle informazioni raccolte dall'interazione dell'utente con le finestre di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b9908-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="b9908-338">Queste informazioni non sono disponibili durante un'installazione invisibile all'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="b9908-339">Non riavviare automaticamente il computer dell'utente durante un'installazione invisibile all'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="b9908-340">Gli amministratori possono impostare il [livello di interfaccia utente](user-interface-levels.md) durante l'installazione di tramite l' [opzione della riga di comando](command-line-options.md) "/q".</span><span class="sxs-lookup"><span data-stu-id="b9908-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="b9908-341">Il livello di interfaccia utente può essere impostato anche a livello di codice con una chiamata a [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span><span class="sxs-lookup"><span data-stu-id="b9908-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="b9908-342">Evitare di usare i criteri AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="b9908-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="b9908-343">Se il criterio [AlwaysInstallElevated](alwaysinstallelevated.md) non è impostato, le applicazioni non distribuite dall'amministratore vengono installate usando i privilegi dell'utente e solo le applicazioni gestite ottengono privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="b9908-344">L'impostazione di questo criterio indica Windows Installer di utilizzare le autorizzazioni di sistema durante l'installazione dell'applicazione nel sistema.</span><span class="sxs-lookup"><span data-stu-id="b9908-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="b9908-345">Questo metodo può aprire un computer a un rischio per la sicurezza, perché quando questo criterio è impostato, un utente non amministratore può eseguire installazioni con privilegi [*elevati*](e-gly.md) e accedere a posizioni sicure nel computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="b9908-346">È consigliabile usare un altro metodo rispetto ai criteri di AlwaysInstallElevated durante [l'installazione di un pacchetto con privilegi elevati per un non amministratore](installing-a-package-with-elevated-privileges-for-a-non-admin.md) o l' [applicazione di patch Per-User applicazioni gestite](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="b9908-347">Abilitare il criterio DisableMedia per limitare l'installazione non autorizzata.</span><span class="sxs-lookup"><span data-stu-id="b9908-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="b9908-348">Il criterio [DisableMedia](disablemedia.md) può impedire l'installazione di applicazioni non autorizzate.</span><span class="sxs-lookup"><span data-stu-id="b9908-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="b9908-349">Quando questo criterio è abilitato, gli utenti e gli amministratori che eseguono un'installazione di manutenzione di un prodotto non possono utilizzare la finestra di dialogo Sfoglia per visualizzare le origini multimediali, ad esempio CD-ROM, per le origini di altri prodotti installabili.</span><span class="sxs-lookup"><span data-stu-id="b9908-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="b9908-350">L'esplorazione di altri prodotti viene impedita indipendentemente dal fatto che l'installazione venga eseguita con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="b9908-351">È comunque possibile che l'utente reinstalli il prodotto da un supporto se l'utente dispone di un'origine multimediale correttamente etichettata.</span><span class="sxs-lookup"><span data-stu-id="b9908-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="b9908-352">Mantieni i file di origine del pacchetto originali protetti e disponibili per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="b9908-353">In alcuni casi è possibile che l'origine originale del pacchetto di Windows Installer sia necessaria per l'installazione su richiesta, il ripristino o l'aggiornamento di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="b9908-354">Se il programma di installazione non è in grado di individuare un'origine disponibile, all'utente viene richiesto di fornire supporti o di accedere a un percorso di rete contenente le origini necessarie.</span><span class="sxs-lookup"><span data-stu-id="b9908-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="b9908-355">È consigliabile assicurarsi che il programma di installazione disponga delle origini necessarie senza richiedere l'intervento dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="b9908-356">Usare le [firme digitali e i file CAB esterni](digital-signatures-and-external-cabinet-files.md) per assicurarsi che le origini origial usate dal programma di installazione siano sicure.</span><span class="sxs-lookup"><span data-stu-id="b9908-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="b9908-357">Un'immagine di origine non compressa archiviata in un percorso pubblico non è sicura.</span><span class="sxs-lookup"><span data-stu-id="b9908-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="b9908-358">Includere un elenco completo dei percorsi di origine della rete o dell'URL per il pacchetto di installazione dell'applicazione nella proprietà dell'elenco di [**origine**](sourcelist.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="b9908-359">Utilizzare una condivisione file system distribuito (DFS) per il percorso di origine.</span><span class="sxs-lookup"><span data-stu-id="b9908-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="b9908-360">Usare l'API Windows Installer per recuperare e modificare le informazioni dell'elenco di origine per Windows Installer le applicazioni e le patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="b9908-361">Per informazioni, vedere [gestione delle origini di installazione](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="b9908-362">Usare i metodi e le proprietà dell'oggetto del [**programma di installazione**](installer-object.md), dell'oggetto [**prodotto**](product-object.md)e dell' [**oggetto patch**](patch-object.md) per recuperare e modificare le informazioni dell'elenco di origine per Windows Installer le applicazioni e le patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="b9908-363">Rispettare i punti elencati in [Impedisci a una patch di richiedere l'accesso ai punti di origine dell'installazione originale](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) per ridurre al minimo la possibilità che la patch richieda l'accesso alle origini originali.</span><span class="sxs-lookup"><span data-stu-id="b9908-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="b9908-364">Archiviare i file di origine del pacchetto in un percorso che non sia la cartella temporanea del sistema.</span><span class="sxs-lookup"><span data-stu-id="b9908-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="b9908-365">Windows Installer file di origine archiviati nella cartella temporanea possono risultare non disponibili per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="b9908-366">Abilitare la registrazione dettagliata nel computer dell'utente durante la risoluzione dei problemi di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b9908-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="b9908-367">[Windows Installer registrazione](windows-installer-logging.md) include un'opzione di registrazione dettagliata che può essere abilitata nel computer di un utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="b9908-368">Le informazioni contenute in un log dettagliato possono risultare utili quando si tenta di risolvere i problemi Windows Installer distribuzione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="b9908-369">È possibile abilitare la registrazione dettagliata nel computer dell'utente usando le [Opzioni della riga di comando](command-line-options.md), la proprietà [**MsiLogging**](msilogging.md) , i [criteri di registrazione](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga)e il metodo [**EnableLog**](installer-enablelog.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="b9908-370">Una risorsa molto utile per interpretare i file di log di Windows Installer è [Wilogutl.exe](wilogutl-exe.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="b9908-371">Questo strumento consente di analizzare i file di log e di visualizzare le soluzioni consigliate per gli errori rilevati in un file di log.</span><span class="sxs-lookup"><span data-stu-id="b9908-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="b9908-372">Per ulteriori informazioni sull'interpretazione dei file di log di Windows Installer, vedere la white paper disponibile sul sito TechNet: [Windows Installer: vantaggi e implementazione per gli amministratori di sistema](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="b9908-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="b9908-373">L'opzione di registrazione dettagliata deve essere utilizzata solo per finalità di risoluzione dei problemi e non deve essere lasciata in quanto può avere effetti negativi sulle prestazioni del sistema e sullo spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="b9908-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="b9908-374">Ogni volta che si utilizza lo strumento Installazione applicazioni nel pannello di controllo, viene creato un nuovo file.</span><span class="sxs-lookup"><span data-stu-id="b9908-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="b9908-375">La disinstallazione lascia il computer dell'utente in uno stato pulito.</span><span class="sxs-lookup"><span data-stu-id="b9908-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="b9908-376">La rimozione dell'applicazione è importante come l'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-376">Application removal is as important as installation.</span></span> <span data-ttu-id="b9908-377">Quando viene disinstallato un pacchetto di Windows Installer, non è necessario che nel computer dell'utente rimangano parti superflue.</span><span class="sxs-lookup"><span data-stu-id="b9908-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="b9908-378">Se un file che dovrebbe essere stato rimosso dal computer dell'utente rimane installato dopo l'esecuzione di una disinstallazione, il programma di installazione potrebbe non rimuovere il componente contenente il file per uno o più dei motivi descritti in [rimuovere i file bloccati](removing-stranded-files.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="b9908-379">Se è necessario registrare un'applicazione, creare il pacchetto per rimuovere le informazioni del registro di sistema quando l'applicazione viene disinstallata.</span><span class="sxs-lookup"><span data-stu-id="b9908-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="b9908-380">Per informazioni, vedere [aggiunta o rimozione di chiavi del registro di sistema durante l'installazione o la rimozione di componenti](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="b9908-381">Se un'applicazione non è registrata, l'applicazione non viene elencata nella funzionalità Installazione applicazioni nel pannello di controllo e non può essere gestita tramite il Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="b9908-382">Per nascondere un'applicazione dalla funzionalità Installazione applicazioni nel pannello di controllo e comunque essere in grado di usare la Windows Installer per gestire l'applicazione, seguire le linee guida descritte in [aggiunta e rimozione di un'applicazione e senza lasciare traccia nel registro di sistema](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="b9908-383">Le azioni personalizzate devono essere condizionate per l'esecuzione o non in base alle necessità alla disinstallazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="b9908-384">Potrebbe essere necessario eseguire azioni personalizzate diverse durante l'installazione e la disinstallazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="b9908-385">Le informazioni di personalizzazione specifiche dell'utente possono essere archiviate in un file di testo nel computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="b9908-386">Questo ha il vantaggio di poter rimuovere il file quando viene disinstallata l'applicazione, anche se l'utente di questa personalizzazione non è attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="b9908-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="b9908-387">Testare i pacchetti per la distribuzione dell'installazione per utente e per computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="b9908-388">È consigliabile consentire ai clienti di decidere se distribuire un pacchetto per l'installazione nel [contesto di installazione](installation-context.md)per computer o per utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="b9908-389">Valutare se l'applicazione deve essere disponibile solo per determinati utenti o per tutti gli utenti del computer durante il processo di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b9908-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="b9908-390">Verificare che il pacchetto funzioni correttamente sia per l'installazione per utente che per i contesti di installazione per computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="b9908-391">Rendere il pacchetto facilmente personalizzabile e consentire ai clienti di decidere se distribuirlo per utente o per computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="b9908-392">Pianificare e testare una strategia di manutenzione prima di distribuire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="b9908-393">È necessario decidere come si intende eseguire la manutenzione dell'applicazione prima di distribuire l'applicazione per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="b9908-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="b9908-394">Prendere in considerazione i tipi di aggiornamenti che si prevede di usare per il servizio dell'applicazione in futuro.</span><span class="sxs-lookup"><span data-stu-id="b9908-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="b9908-395">Il Windows Installer fornisce tre tipi di aggiornamenti: [Small Update](small-updates.md), [aggiornamento secondario](minor-upgrades.md)e [aggiornamenti principali](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="b9908-396">Le differenze tra questi argomenti sono descritte in applicazione di [patch e aggiornamenti](patching-and-upgrades.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="b9908-397">Prima di distribuire l'applicazione, verificare che funzioni come previsto dopo la manutenzione di ogni tipo di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="b9908-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="b9908-398">Ridurre la dipendenza degli aggiornamenti sulle origini originali.</span><span class="sxs-lookup"><span data-stu-id="b9908-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="b9908-399">Se i file di origine originali sono necessari per aggiornare l'applicazione, questo può rendere più difficile la manutenzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="b9908-400">I metodi seguenti consentono di ridurre la dipendenza degli aggiornamenti sulle origini originali.</span><span class="sxs-lookup"><span data-stu-id="b9908-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="b9908-401">Usare una [*patch Delta*](d-gly.md) per aggiornare le versioni di base dell'applicazione, ad esempio la versione RTM e le versioni Service Pack.</span><span class="sxs-lookup"><span data-stu-id="b9908-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="b9908-402">Seguire le linee guida per l'uso delle patch Delta descritte nell'argomento: [riduzione delle dimensioni delle patch](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="b9908-403">Seguire i consigli elencati nell'argomento: [impedire a una patch di richiedere l'accesso all'origine dell'installazione originale](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="b9908-404">Non distribuire i moduli merge non collegabili.</span><span class="sxs-lookup"><span data-stu-id="b9908-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="b9908-405">Le applicazioni non devono dipendere da [moduli merge](merge-modules.md) per l'installazione del componente se il proprietario del modulo merge e il proprietario dell'applicazione sono diversi.</span><span class="sxs-lookup"><span data-stu-id="b9908-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="b9908-406">Questo può rendere difficile il servizio dell'applicazione perché entrambi i proprietari devono coordinarsi per aggiornare l'applicazione o il modulo.</span><span class="sxs-lookup"><span data-stu-id="b9908-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="b9908-407">Senza conoscere tutte le applicazioni che hanno utilizzato il modulo merge, il proprietario dell'applicazione non è in grado di aggiornare il modulo merge senza rischiare che l'aggiornamento potrebbe non essere compatibile con un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="b9908-408">Il proprietario del modulo merge non dispone di un metodo diretto per l'aggiornamento di Windows Installer pacchetti in cui è già installato il modulo merge.</span><span class="sxs-lookup"><span data-stu-id="b9908-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="b9908-409">È consigliabile fornire i componenti necessari agli utenti come un'altra Windows Installer installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="b9908-410">Evitare l'applicazione di patch alle installazioni amministrative.</span><span class="sxs-lookup"><span data-stu-id="b9908-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="b9908-411">Fornire in rete un' [installazione amministrativa](administrative-installation.md) del pacchetto di Windows Installer originale dell'applicazione per consentire ai membri di un gruppo di lavoro di installare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="b9908-412">Gli utenti di questa immagine amministrativa dovranno quindi applicare gli aggiornamenti all'istanza locale dell'applicazione presente nel computer.</span><span class="sxs-lookup"><span data-stu-id="b9908-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="b9908-413">In questo modo gli utenti vengono sincronizzati con l'immagine amministrativa.</span><span class="sxs-lookup"><span data-stu-id="b9908-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="b9908-414">Non è consigliabile applicare gli aggiornamenti all'installazione amministrativa per i motivi seguenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="b9908-415">Le dimensioni e la latenza del download necessarie per gli utenti per ottenere un aggiornamento vengono aumentate rispetto al download di una patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="b9908-416">L'intero pacchetto di Windows Installer aggiornato e i file di origine devono essere scaricati, rimemorizzati nella cache e reinstallati.</span><span class="sxs-lookup"><span data-stu-id="b9908-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="b9908-417">Gli utenti non sono in grado di eseguire l' [installazione su richiesta](installation-on-demand.md) e di ripristinare le applicazioni da un'installazione amministrativa aggiornata finché non rimemorizzano nella cache e reinstalla l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="b9908-418">L'applicazione di una patch a un'installazione amministrativa rimuove la firma digitale dal pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="b9908-419">Un amministratore deve firmare nuovamente il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-419">An administrator must resign the package.</span></span> <span data-ttu-id="b9908-420">Per altre informazioni sull'uso delle firme digitali, vedere [firme digitali e Windows Installer](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="b9908-421">Molte patch binarie sono destinate all'immagine RTM dell'applicazione e richiedono una versione precedente del file.</span><span class="sxs-lookup"><span data-stu-id="b9908-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="b9908-422">L'istanza locale di un'applicazione installata da un'installazione amministrativa aggiornata potrebbe non funzionare con altri aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="b9908-423">Molte applicazioni di patch binarie possono avere esito negativo.</span><span class="sxs-lookup"><span data-stu-id="b9908-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="b9908-424">Se si applica una patch a un'installazione amministrativa, i file di origine e il file con estensione msi non vengono contrassegnati con le informazioni sull'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="b9908-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="b9908-425">Gli utenti non possono determinare quali aggiornamenti sono stati ricevuti dall'installazione amministrativa.</span><span class="sxs-lookup"><span data-stu-id="b9908-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="b9908-426">Ciò rende impossibile sequenziare gli aggiornamenti applicati sul lato utente con quelli già applicati sul lato dell'immagine amministrativa.</span><span class="sxs-lookup"><span data-stu-id="b9908-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="b9908-427">Le patch applicate a un'installazione amministrativa non sono [patch disinstallabili](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="b9908-428">Ciò può impedire che il codice del pacchetto memorizzato nella cache del computer dell'utente diventi diverso dal codice del pacchetto nell'installazione amministrativa.</span><span class="sxs-lookup"><span data-stu-id="b9908-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="b9908-429">Se il codice del pacchetto memorizzato nella cache nel computer dell'utente è diverso da quello dell'installazione amministrativa, reinstallare l'applicazione dall'installazione amministrativa, quindi applicare una patch al computer client.</span><span class="sxs-lookup"><span data-stu-id="b9908-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="b9908-430">Se si decide di applicare piccoli aggiornamenti con l'applicazione di patch a un'immagine amministrativa, attenersi alle linee guida descritte nell'argomento relativo all' [applicazione di piccoli aggiornamenti con l'applicazione di patch a un'immagine amministrativa](applying-small-updates-by-patching-an-administrative-image.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="b9908-431">Registrare gli aggiornamenti da eseguire con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="b9908-432">A partire da Windows Installer 3,0, è possibile applicare patch a un'applicazione installata in un contesto gestito per utente, dopo che la patch è stata registrata con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="b9908-433">Non è possibile applicare patch alle applicazioni installate in un contesto gestito per utente usando versioni di Windows Installer precedenti alla versione 3,0.</span><span class="sxs-lookup"><span data-stu-id="b9908-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="b9908-434">Usare il metodo [**SourceListAddSource**](patch-sourcelistaddsource.md) o la funzione [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) per registrare un pacchetto di patch con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="b9908-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="b9908-435">Seguire le linee guida ed esempi disponibili in [applicazione di patch Per-User applicazioni gestite](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="b9908-436">Quando si esegue Windows Installer versione 4,0 in Windows Vista, è anche possibile usare l'applicazione di patch per il [controllo dell'account utente](user-account-control--uac--patching.md) per consentire agli autori di Windows Installer installazioni di identificare le patch firmate digitalmente che possono essere applicate in futuro da utenti non amministratori.</span><span class="sxs-lookup"><span data-stu-id="b9908-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="b9908-437">Questa operazione è disponibile solo con l'installazione dei pacchetti nel [contesto di installazione](installation-context.md) per computer (ALLUSERS = 1).</span><span class="sxs-lookup"><span data-stu-id="b9908-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="b9908-438">Verificare che l'applicazione di patch con privilegi minimi non sia stata disabilitata impostando la proprietà [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) o il criterio [DisableLUAPatching](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="b9908-439">Usare la tabella MsiPatchSequence per sequenziare le patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="b9908-440">Includere una [tabella MsiPatchSequence](msipatchsequence-table.md) nel pacchetto e aggiungere le informazioni di sequenziazione delle patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="b9908-441">A partire da Windows Installer versione 3,0, il programma di installazione può usare la tabella MsiPatchSequence quando si [installano più patch](installing-multiple-patches.md) per determinare la sequenza di applicazione patch migliore.</span><span class="sxs-lookup"><span data-stu-id="b9908-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="b9908-442">Usare le linee guida descritte in [sequenziazione della patch in Windows Installer versione 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper per la definizione delle famiglie di patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="b9908-443">Se lo si desidera, specificare tutte le patch come appartenenti a una singola famiglia di patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="b9908-444">In molti casi, una singola famiglia di patch offre una flessibilità sufficiente per la sequenziazione delle patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="b9908-445">La complessità della creazione aumenta quando vengono utilizzate più famiglie di patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="b9908-446">Assegnare un nome significativo alla famiglia di patch e assegnare i valori di sequenza in tale famiglia di patch che aumentano nel tempo.</span><span class="sxs-lookup"><span data-stu-id="b9908-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="b9908-447">Per applicare le patch nell'ordine in cui sono state rilasciate, seguire l'esempio di applicazione di [patch multipli](multiple-patching-example.md) .</span><span class="sxs-lookup"><span data-stu-id="b9908-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="b9908-448">Usare la [tabella PatchSequence](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) per generare le informazioni nella [tabella MsiPatchSequence](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="b9908-449">La versione di PATCHWIZ.DLL rilasciata con Windows Installer 3,0 può generare automaticamente informazioni di sequenziazione delle patch.</span><span class="sxs-lookup"><span data-stu-id="b9908-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="b9908-450">Per ulteriori informazioni su come aggiungere una nuova patch, vedere [generazione di informazioni sulla sequenza di patch](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="b9908-451">Per ulteriori informazioni sugli scenari di sequenziazione delle patch, vedere il white paper sulla [sequenziazione delle patch nella Windows Installer versione 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="b9908-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="b9908-452">Testare accuratamente il pacchetto di installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="b9908-453">Verificare la corretta installazione, ripristino e rimozione del pacchetto di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="b9908-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="b9908-454">È possibile dividere il processo di test nelle parti seguenti.</span><span class="sxs-lookup"><span data-stu-id="b9908-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="b9908-455">Test dell'installazione: testare l'installazione con tutte le possibili combinazioni di funzionalità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="b9908-456">Testare tutti i tipi di installazione, tra cui l'installazione [amministrativa](administrative-installation.md), l' [installazione di rollback](rollback-installation.md)e l' [installazione su richiesta](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="b9908-457">Provare tutti i possibili metodi di installazione, incluso il file con estensione msi, le [Opzioni della riga di comando](command-line-options.md)e l'installazione dal pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="b9908-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="b9908-458">Verificare che il pacchetto possa essere installato dagli utenti in tutti i possibili contesti dei privilegi.</span><span class="sxs-lookup"><span data-stu-id="b9908-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="b9908-459">Provare a installare il pacchetto dopo che è stato distribuito con tutti i metodi possibili.</span><span class="sxs-lookup"><span data-stu-id="b9908-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="b9908-460">Abilitare la [registrazione Windows Installer](windows-installer-logging.md) per ogni test e risolvere tutti gli errori rilevati nel log del programma di installazione e nel registro eventi.</span><span class="sxs-lookup"><span data-stu-id="b9908-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="b9908-461">Test dell'interfaccia utente: testare il pacchetto quando viene installato con tutti i [livelli di interfaccia utente](user-interface-levels.md)possibili.</span><span class="sxs-lookup"><span data-stu-id="b9908-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="b9908-462">Testare il pacchetto installato senza interfaccia utente e con tutte le informazioni fornite tramite l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="b9908-463">Verificare l' [accessibilità](accessibility.md) dell'interfaccia utente e che l'interfaccia utente funzioni come previsto per diverse risoluzioni dello schermo e dimensioni dei tipi di carattere.</span><span class="sxs-lookup"><span data-stu-id="b9908-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="b9908-464">Test di manutenzione e riparazione: verificare che il pacchetto sia in grado di gestire l'applicazione di [patch e gli aggiornamenti](patching-and-upgrades.md) forniti da un [piccolo aggiornamento](small-updates.md), dall' [aggiornamento secondario](minor-upgrades.md)e dagli [aggiornamenti principali](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="b9908-465">Prima di distribuire il pacchetto, scrivere un aggiornamento di valutazione di ogni tipo e provare ad applicarlo al pacchetto originale.</span><span class="sxs-lookup"><span data-stu-id="b9908-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="b9908-466">Test di disinstallazione: verificare che, quando il pacchetto viene rimosso, non rimanga inutile parte del computer dell'utente e che siano state rimosse solo le informazioni appartenenti al pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="b9908-467">Riavviare il computer di test dopo aver disinstallato il pacchetto e verificare l'integrità degli strumenti di sistema comuni e di altre applicazioni standard.</span><span class="sxs-lookup"><span data-stu-id="b9908-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="b9908-468">Verificare che il pacchetto possa essere rimosso dagli utenti in tutti i possibili contesti dei privilegi.</span><span class="sxs-lookup"><span data-stu-id="b9908-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="b9908-469">Testare tutti i metodi per rimuovere il pacchetto, fare clic sul file con estensione msi, provare a usare le [Opzioni della riga di comando](command-line-options.md)e provare a rimuovere il pacchetto dal pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="b9908-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="b9908-470">Abilitare la [registrazione Windows Installer](windows-installer-logging.md) per ogni test e risolvere tutti gli errori rilevati nel log del programma di installazione e nel registro eventi.</span><span class="sxs-lookup"><span data-stu-id="b9908-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="b9908-471">Test delle funzionalità del prodotto: assicurarsi che l'applicazione funzioni come previsto dopo l'installazione, il ripristino o la rimozione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b9908-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="b9908-472">Correggere tutti gli errori di convalida prima di distribuire un pacchetto di installazione nuovo o modificato.</span><span class="sxs-lookup"><span data-stu-id="b9908-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="b9908-473">Eseguire la [convalida del pacchetto](package-validation.md) in un pacchetto di Windows Installer nuovo o rivisto prima di provare a installarlo per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="b9908-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="b9908-474">La convalida controlla il database Windows Installer per la creazione di errori.</span><span class="sxs-lookup"><span data-stu-id="b9908-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="b9908-475">Il tentativo di installare un pacchetto che non supera la convalida può danneggiare il sistema dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b9908-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="b9908-476">È possibile convalidare il pacchetto usando [Orca.exe](orca-exe.md) o [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="b9908-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="b9908-477">Entrambi gli strumenti sono forniti con il Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="b9908-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="b9908-478">I fornitori di terze parti possono anche incorporare il sistema di convalida del ghiaccio nell'ambiente di creazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="b9908-479">È possibile usare il set standard di [analizzatori di coerenza interni](internal-consistency-evaluators-ices.md) , ovvero i ghiacci inclusi nei file con estensione cub forniti con l'SDK, oppure personalizzare la convalida compilando [un ghiaccio](building-an-ice.md) e aggiungendolo al file con estensione cub.</span><span class="sxs-lookup"><span data-stu-id="b9908-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="b9908-480">È possibile utilizzare il Evalcom2.dll per implementare l' [automazione di convalida](validation-automation.md) per i pacchetti di installazione e i moduli unione.</span><span class="sxs-lookup"><span data-stu-id="b9908-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="b9908-481">Creare un'installazione sicura.</span><span class="sxs-lookup"><span data-stu-id="b9908-481">Author a secure installation.</span></span>

<span data-ttu-id="b9908-482">Seguendo queste linee guida durante lo sviluppo del pacchetto per mantenere un ambiente protetto durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="b9908-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="b9908-483">Linee guida per la creazione di installazioni sicure</span><span class="sxs-lookup"><span data-stu-id="b9908-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="b9908-484">Linee guida per la protezione dei pacchetti nei computer bloccati</span><span class="sxs-lookup"><span data-stu-id="b9908-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="b9908-485">Linee guida per la protezione di azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="b9908-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="b9908-486">USA PMSIHANDLE anziché HANDLE</span><span class="sxs-lookup"><span data-stu-id="b9908-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="b9908-487">Le variabili di tipo **PMSIHANDLE** sono definite in MSI. h.</span><span class="sxs-lookup"><span data-stu-id="b9908-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="b9908-488">È consigliabile che l'applicazione usi il tipo **PMSIHANDLE** perché il programma di installazione chiude gli oggetti **PMSIHANDLE** quando escono dall'ambito, mentre l'applicazione deve chiudere gli oggetti **MSIHANDLE** chiamando [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span><span class="sxs-lookup"><span data-stu-id="b9908-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="b9908-489">Ad esempio, se si usa codice simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="b9908-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="b9908-490">Modificarla in:</span><span class="sxs-lookup"><span data-stu-id="b9908-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
