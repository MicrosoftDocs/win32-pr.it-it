---
description: Quando si crea un pacchetto di installazione, è possibile usare la funzione MsiViewModify o il metodo View. Modify per assicurarsi che i dati immessi siano sintatticamente corretti.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Convalida interna
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca3c1a9e6f7b7e35b4d7d91287af64eff7812de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104128375"
---
# <a name="internal-validation"></a><span data-ttu-id="eaccb-103">Convalida interna</span><span class="sxs-lookup"><span data-stu-id="eaccb-103">Internal Validation</span></span>

<span data-ttu-id="eaccb-104">Quando si crea un pacchetto di installazione, è possibile usare la funzione [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) o il metodo View. Modify per assicurarsi che i dati immessi siano sintatticamente corretti.</span><span class="sxs-lookup"><span data-stu-id="eaccb-104">When authoring an installation package, you can use the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function or the View.Modify method to ensure that the data you enter is syntactically correct.</span></span> <span data-ttu-id="eaccb-105">Per ulteriori informazioni, vedere [**modifica del metodo**](view-modify.md).</span><span class="sxs-lookup"><span data-stu-id="eaccb-105">For more information, see [**Modify method**](view-modify.md).</span></span> <span data-ttu-id="eaccb-106">Al livello più basso, la colonna di una tabella di database può archiviare interi (short o Long), stringhe o dati binari.</span><span class="sxs-lookup"><span data-stu-id="eaccb-106">At the lowest level, a database table's column can store integers (short or long), strings, or binary data.</span></span> <span data-ttu-id="eaccb-107">Tuttavia, un pacchetto di installazione richiede interi o stringhe specifiche in determinate tabelle.</span><span class="sxs-lookup"><span data-stu-id="eaccb-107">However, an installation package requires specific integers or strings in certain tables.</span></span> <span data-ttu-id="eaccb-108">Queste specifiche vengono mantenute nella [ \_ tabella di convalida](-validation-table.md).</span><span class="sxs-lookup"><span data-stu-id="eaccb-108">These specifications are maintained in the [\_Validation table](-validation-table.md).</span></span> <span data-ttu-id="eaccb-109">Ad esempio, la colonna FileName della [tabella file](file-table.md) è una colonna stringa, ma archivia in modo specifico un nome file.</span><span class="sxs-lookup"><span data-stu-id="eaccb-109">For example, the FileName column of the [File table](file-table.md) is a string column, but it specifically stores a file name.</span></span> <span data-ttu-id="eaccb-110">Pertanto, non solo la voce deve essere una stringa, ma deve anche seguire i requisiti per la denominazione dei file.</span><span class="sxs-lookup"><span data-stu-id="eaccb-110">Therefore, not only should your entry be a string, but it should also follow the requirements for naming files.</span></span>

<span data-ttu-id="eaccb-111">I vari valori enum di convalida usati con la funzione [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) consentono la convalida immediata a livelli diversi.</span><span class="sxs-lookup"><span data-stu-id="eaccb-111">The various validation enum values used with the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function allow for immediate validation at different levels.</span></span> <span data-ttu-id="eaccb-112">L' \_ enumerazione del \_ Campo Validate MSIMODIFY può essere usata per convalidare i singoli campi di un record.</span><span class="sxs-lookup"><span data-stu-id="eaccb-112">The MSIMODIFY\_VALIDATE\_FIELD enum can be used to validate individual fields of a record.</span></span> <span data-ttu-id="eaccb-113">Non convalida le chiavi esterne.</span><span class="sxs-lookup"><span data-stu-id="eaccb-113">It does not validate foreign keys.</span></span> <span data-ttu-id="eaccb-114">L' \_ enumerazione MSIMODIFY Validate convalida un'intera riga e include la convalida della chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="eaccb-114">The MSIMODIFY\_VALIDATE enum validates an entire row and includes foreign key validation.</span></span> <span data-ttu-id="eaccb-115">Se si inserisce una nuova riga in una tabella, usare l' \_ enumerazione MSIMODIFY Validate \_ New per verificare che si stiano aggiungendo dati validi e usando chiavi primarie univoche.</span><span class="sxs-lookup"><span data-stu-id="eaccb-115">If you are inserting a new row into a table, use the MSIMODIFY\_VALIDATE\_NEW enum to verify that you are adding valid data as well as using unique primary keys.</span></span> <span data-ttu-id="eaccb-116">Un inserimento ha esito negativo se le chiavi primarie non sono univoche.</span><span class="sxs-lookup"><span data-stu-id="eaccb-116">An insert fails if the primary keys are not unique.</span></span> <span data-ttu-id="eaccb-117">Se una chiamata a **MsiViewModify** con una delle enumerazioni di convalida restituisce un errore, è possibile eseguire chiamate ripetute a [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) per la diagnosi del problema.</span><span class="sxs-lookup"><span data-stu-id="eaccb-117">If a call to **MsiViewModify** with one of the validation enums returns an error, you can make repeated calls to [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) for diagnosing the problem.</span></span> <span data-ttu-id="eaccb-118">**MsiViewGetError** indica la colonna in cui si è verificato l'errore e il valore enum per facilitare la risoluzione del problema.</span><span class="sxs-lookup"><span data-stu-id="eaccb-118">**MsiViewGetError** indicates the column where the error occurred as well as the enum value to help fix the problem.</span></span> <span data-ttu-id="eaccb-119">Per ulteriori informazioni, vedere [**metodo getError**](view-geterror.md).</span><span class="sxs-lookup"><span data-stu-id="eaccb-119">For more information, see [**GetError method**](view-geterror.md).</span></span>

<span data-ttu-id="eaccb-120">È anche possibile usare la convalida interna per assicurarsi che altri autori immettano correttamente i dati nella tabella personalizzata.</span><span class="sxs-lookup"><span data-stu-id="eaccb-120">You can also use internal validation to ensure that other authors enter data correctly into your custom table.</span></span> <span data-ttu-id="eaccb-121">Aggiungere tutte le colonne della tabella personalizzata alla \_ tabella di convalida usando il nome della tabella e il nome della colonna personalizzati come chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="eaccb-121">Add each of the columns of your custom table to the \_Validation table using the custom table name and column name as the primary key.</span></span> <span data-ttu-id="eaccb-122">Fornire una descrizione o uno scopo di ogni colonna nella colonna Descrizione della \_ tabella di convalida.</span><span class="sxs-lookup"><span data-stu-id="eaccb-122">Provide a description or purpose of each column in the Description column of the \_Validation table.</span></span> <span data-ttu-id="eaccb-123">Immettere i requisiti applicabili per ogni colonna usando le colonne nullable, MinValue, MaxValue, DataTable, DataColumn, Category e set:</span><span class="sxs-lookup"><span data-stu-id="eaccb-123">Enter the applicable requirements for each column using the Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Category, and Set columns:</span></span>

-   <span data-ttu-id="eaccb-124">Se la colonna ammette valori null, immettere una "Y".</span><span class="sxs-lookup"><span data-stu-id="eaccb-124">If the column is Nullable, enter a 'Y'.</span></span> <span data-ttu-id="eaccb-125">In caso contrario, immettere ' n'.</span><span class="sxs-lookup"><span data-stu-id="eaccb-125">If not, enter a 'N'.</span></span>
-   <span data-ttu-id="eaccb-126">Se la colonna è una colonna di tipo integer e può contenere un intervallo di numeri interi, immettere tale intervallo utilizzando le colonne MinValue e MaxValue.</span><span class="sxs-lookup"><span data-stu-id="eaccb-126">If the column is an integer column and can contain a range of integers, enter that range using the MinValue and MaxValue columns.</span></span>
-   <span data-ttu-id="eaccb-127">Le colonne chiave esterna vengono identificate tramite le colonne chiave e colonna chiave.</span><span class="sxs-lookup"><span data-stu-id="eaccb-127">Foreign key columns are identified using the KeyTable and KeyColumn columns.</span></span>
-   <span data-ttu-id="eaccb-128">Per le colonne di tipo stringa, specificare una categoria, ad esempio filename, GUID o Identifier.</span><span class="sxs-lookup"><span data-stu-id="eaccb-128">For string columns, specify a Category such as Filename, GUID, or Identifier.</span></span> <span data-ttu-id="eaccb-129">Per altre informazioni, vedere [tipi di dati di colonna](column-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="eaccb-129">For more information, see [column data types](column-data-types.md).</span></span>
-   <span data-ttu-id="eaccb-130">Se i dati possono essere correlati solo a un numero specifico di valori (stringa o Integer), utilizzare la colonna set per elencare i valori accettabili.</span><span class="sxs-lookup"><span data-stu-id="eaccb-130">If the data can only pertain to a specific number of values (string or integer), use the Set column to list the acceptable values.</span></span>

<span data-ttu-id="eaccb-131">Di seguito è riportato un elenco delle colonne (oltre a tabella, colonna e descrizione) nella \_ tabella di convalida che è possibile compilare se la colonna è del tipo specificato.</span><span class="sxs-lookup"><span data-stu-id="eaccb-131">The following is a list of the columns (in addition to Table, Column, and Description) in the \_Validation table that can be filled in if your column is of the specified type.</span></span> <span data-ttu-id="eaccb-132">(Si noti che non è necessario compilare tutte le colonne).</span><span class="sxs-lookup"><span data-stu-id="eaccb-132">(Note that you do not have to fill in all the columns.)</span></span>



| <span data-ttu-id="eaccb-133">Tipo</span><span class="sxs-lookup"><span data-stu-id="eaccb-133">Type</span></span>    | <span data-ttu-id="eaccb-134">Colonne</span><span class="sxs-lookup"><span data-stu-id="eaccb-134">Columns</span></span>                                                          |
|---------|------------------------------------------------------------------|
| <span data-ttu-id="eaccb-135">Integer</span><span class="sxs-lookup"><span data-stu-id="eaccb-135">Integer</span></span> | <span data-ttu-id="eaccb-136">Nullable, MinValue, MaxValue, tabella di tabella, colonna di colonne, set</span><span class="sxs-lookup"><span data-stu-id="eaccb-136">Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Set</span></span>           |
| <span data-ttu-id="eaccb-137">string</span><span class="sxs-lookup"><span data-stu-id="eaccb-137">String</span></span>  | <span data-ttu-id="eaccb-138">Nullable, DataTable, colonna di colonna, categoria, set, MinValue, MaxValue</span><span class="sxs-lookup"><span data-stu-id="eaccb-138">Nullable, KeyTable, KeyColumn, Category, Set, MinValue, MaxValue</span></span> |
| <span data-ttu-id="eaccb-139">Binary</span><span class="sxs-lookup"><span data-stu-id="eaccb-139">Binary</span></span>  | <span data-ttu-id="eaccb-140">Nullable, Category (la categoria deve essere "binary")</span><span class="sxs-lookup"><span data-stu-id="eaccb-140">Nullable, Category (Category must be "Binary")</span></span>                   |



 

<span data-ttu-id="eaccb-141">Gli ambienti di creazione possono usare MSIMODIFY \_ Validate \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="eaccb-141">Authoring environments may make use of MSIMODIFY\_VALIDATE\_DELETE.</span></span> <span data-ttu-id="eaccb-142">Questa enumerazione presuppone che si voglia eliminare la riga.</span><span class="sxs-lookup"><span data-stu-id="eaccb-142">This enum assumes that you want to delete the row.</span></span> <span data-ttu-id="eaccb-143">Non viene eseguita alcuna convalida del campo o della chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="eaccb-143">No field or foreign key validation is performed.</span></span> <span data-ttu-id="eaccb-144">Questa enumerazione esegue effettivamente una convalida della chiave esterna inversa.</span><span class="sxs-lookup"><span data-stu-id="eaccb-144">This enum actually performs a reverse foreign key validation.</span></span> <span data-ttu-id="eaccb-145">Consente di controllare la \_ tabella di convalida per i riferimenti nelle colonne della tabella e della colonna della tabella per la tabella a cui appartiene la riga "Deleted".</span><span class="sxs-lookup"><span data-stu-id="eaccb-145">It checks the \_Validation table for references in the KeyTable and KeyColumn columns for the table to which the "deleted" row belongs.</span></span> <span data-ttu-id="eaccb-146">Se sono presenti colonne in cui è elencata la tabella contenente la riga "eliminata" come potenziale chiave esterna, il ciclo passa a tale colonna per verificare se uno dei valori fa riferimento ai valori nella riga "eliminato".</span><span class="sxs-lookup"><span data-stu-id="eaccb-146">If there are columns that list the table containing the "deleted" row as a potential foreign key, it cycles through that column to see if any of the values reference values in the "deleted" row.</span></span> <span data-ttu-id="eaccb-147">Un errore restituito indica che si interrompe l'integrità relazionale del database eliminando la riga.</span><span class="sxs-lookup"><span data-stu-id="eaccb-147">An error return means that you break the relational integrity of the database by deleting the row.</span></span>

 

 



