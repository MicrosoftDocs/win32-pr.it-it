---
description: Windows Installer contiene la funzionalità per visualizzare un indicatore di stato in una finestra di dialogo di visualizzazione dell'azione.
ms.assetid: cfc2d974-4f2d-4f52-9835-eab1dc091c9b
title: Creazione di un controllo ProgressBar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b872ed2dd36fb8ed04ee48fd69e4680fce002a18
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103881102"
---
# <a name="authoring-a-progressbar-control"></a><span data-ttu-id="a44e6-103">Creazione di un controllo ProgressBar</span><span class="sxs-lookup"><span data-stu-id="a44e6-103">Authoring a ProgressBar Control</span></span>

<span data-ttu-id="a44e6-104">Windows Installer contiene la funzionalità per visualizzare un indicatore di stato in una finestra di dialogo di visualizzazione dell'azione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-104">Windows Installer contains functionality to display a progress indicator in an action display dialog.</span></span> <span data-ttu-id="a44e6-105">Il [controllo ProgressBar](progressbar-control.md) rappresenta graficamente l'installazione di singoli componenti e segnala il tempo totale trascorso in relazione al tempo rimanente o al tempo totale approssimativo rimanente fino al completamento dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-105">The [ProgressBar control](progressbar-control.md) graphically represents the installation of individual components and reports either the total time elapsed relative to time remaining or the approximate total time remaining until the installation is complete.</span></span>

<span data-ttu-id="a44e6-106">Per determinare il tempo totale previsto per l'installazione, il programma di installazione tiene traccia dei cicli di avanzamento totali previsti da ogni azione durante la generazione dello script di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-106">To determine the total time anticipated for the installation, the installer tracks the total progress ticks anticipated by each action during generation of the execution script.</span></span> <span data-ttu-id="a44e6-107">Al termine della generazione dello script, il totale del segno di avanzamento viene archiviato e viene avviata l'installazione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-107">When script generation is complete, the progress tick total is stored and the installation begins.</span></span>

<span data-ttu-id="a44e6-108">I messaggi di stato che descrivono in dettaglio il numero trascorso di cicli di avanzamento vengono inviati al gestore di messaggi attivi quando ogni azione nello script viene eseguita.</span><span class="sxs-lookup"><span data-stu-id="a44e6-108">Progress messages detailing the elapsed number of progress ticks are sent to the active message handler as each action in the script is executed.</span></span> <span data-ttu-id="a44e6-109">In ogni messaggio di stato, il programma di installazione trasmette un [ControlEvent di avanzamento](setprogress-controlevent.md) alla finestra di dialogo attualmente attiva.</span><span class="sxs-lookup"><span data-stu-id="a44e6-109">On each progress message, the installer broadcasts a [SetProgress ControlEvent](setprogress-controlevent.md) to the currently active dialog box.</span></span> <span data-ttu-id="a44e6-110">La sequenza dell'interfaccia utente deve essere creata per creare la finestra di dialogo visualizzazione azione durante l'esecuzione dello script per ricevere i messaggi di ControlEvent di stato dal programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-110">The UI sequence should be authored to create the action display dialog box during script execution to receive the SetProgress ControlEvent messages from the installer.</span></span>

<span data-ttu-id="a44e6-111">Quando la finestra di dialogo visualizzazione azione riceve un ControlEvent di avanzamento, verifica la [tabella EventMapping](eventmapping-table.md) per tutti i controlli che sottoscrivono ControlEvent.</span><span class="sxs-lookup"><span data-stu-id="a44e6-111">When the action display dialog box receives a SetProgress ControlEvent, it checks the [EventMapping table](eventmapping-table.md) for any controls subscribing to the ControlEvent.</span></span> <span data-ttu-id="a44e6-112">Il controllo ProgressBar nella finestra di dialogo visualizzazione azione è stato sottoscritto con l'attributo di controllo progress specificato nella colonna attributi.</span><span class="sxs-lookup"><span data-stu-id="a44e6-112">The ProgressBar control on the action display dialog box is subscribed to with the Progress control attribute specified in the Attributes column.</span></span> <span data-ttu-id="a44e6-113">L'attributo di controllo progress specifica che al controllo ProgressBar verranno passati i valori "ticksSoFar" e "totalTicks" insieme al ControlEvent di avanzamento.</span><span class="sxs-lookup"><span data-stu-id="a44e6-113">The Progress Control attribute specifies that the ProgressBar control will be passed "ticksSoFar" and "totalTicks" values along with the SetProgress ControlEvent.</span></span> <span data-ttu-id="a44e6-114">Il controllo indicatore di stato USA queste informazioni per far avanzare la barra grafica da sinistra a destra per un'installazione e da destra a sinistra per un'operazione di [rollback](rollback-installation.md) .</span><span class="sxs-lookup"><span data-stu-id="a44e6-114">The progress bar control uses this information to advance the graphical bar from left to right for an installation and from right to left for a [rollback](rollback-installation.md) operation.</span></span>

<span data-ttu-id="a44e6-115">Inoltre, il programma di installazione trasmette un [ControlEvent TimeRemaining](timeremaining-controlevent.md) a ogni messaggio di stato.</span><span class="sxs-lookup"><span data-stu-id="a44e6-115">In addition, the installer broadcasts a [TimeRemaining ControlEvent](timeremaining-controlevent.md) on each progress message.</span></span> <span data-ttu-id="a44e6-116">Il tempo totale rimanente per l'installazione viene determinato calcolando prima la velocità di esecuzione, ovvero il numero totale di cicli trascorsi per il tempo totale trascorso dall'inizio dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="a44e6-116">The total time remaining for the installation is determined by first calculating the execution rate, which is the total number of ticks elapsed divided by the total time since the installation began.</span></span> <span data-ttu-id="a44e6-117">Il totale dei cicli rimanenti divisi per la velocità di esecuzione indica il tempo di permanenza approssimativo.</span><span class="sxs-lookup"><span data-stu-id="a44e6-117">The total ticks remaining divided by the execution rate gives the approximate time remaining.</span></span>

<span data-ttu-id="a44e6-118">Quando la finestra di dialogo visualizzazione azione riceve il ControlEvent TimeRemaining, Cerca nuovamente nella tabella EventMapping i controlli sottoscritti.</span><span class="sxs-lookup"><span data-stu-id="a44e6-118">When the action display dialog box receives the TimeRemaining ControlEvent, it again looks in the EventMapping table for any controls that are subscribed.</span></span> <span data-ttu-id="a44e6-119">Per visualizzare il tempo rimanente, è necessario che un [controllo di testo](text-control.md) abbia sottoscritto il ControlEvent TimeRemaining con l' [attributo di controllo TimeRemaining](timeremaining-control-attribute.md) specificato nella colonna attributi.</span><span class="sxs-lookup"><span data-stu-id="a44e6-119">In order to display the time remaining, a [Text control](text-control.md) must be subscribed to the TimeRemaining ControlEvent with the [TimeRemaining control attribute](timeremaining-control-attribute.md) specified in the Attributes column.</span></span>

<span data-ttu-id="a44e6-120">Il controllo testo sottoscritto esegue una query sulla [tabella UIText](uitext-table.md) per una stringa di modello con parametri denominata "TimeRemaining".</span><span class="sxs-lookup"><span data-stu-id="a44e6-120">The subscribed Text control queries the [UIText table](uitext-table.md) for a parameterized template string named "TimeRemaining".</span></span> <span data-ttu-id="a44e6-121">Questa stringa ha due parametri, \[ 1 \] per i minuti e \[ 2 \] per i secondi.</span><span class="sxs-lookup"><span data-stu-id="a44e6-121">This string has two parameters, \[1\] for minutes, and \[2\] for seconds.</span></span> <span data-ttu-id="a44e6-122">Il controllo testo converte ogni valore in minuti e secondi, valuta la stringa del modello TimeRemaining e aggiorna il controllo di testo con le nuove informazioni.</span><span class="sxs-lookup"><span data-stu-id="a44e6-122">The Text control converts each value to minutes and seconds, evaluates the TimeRemaining template string, and updates the text control with the new information.</span></span>

<span data-ttu-id="a44e6-123">Se il livello di visualizzazione dell'interfaccia utente è impostato su di base o inferiore, il programma di installazione visualizza una finestra di dialogo predefinita contenente un indicatore di stato e un campo di testo TimeRemaining.</span><span class="sxs-lookup"><span data-stu-id="a44e6-123">If the UI display level is set to basic or lower, the installer displays a default dialog box containing a progress bar and TimeRemaining text field.</span></span> <span data-ttu-id="a44e6-124">Per ulteriori informazioni, vedere [livelli di interfaccia utente](user-interface-levels.md).</span><span class="sxs-lookup"><span data-stu-id="a44e6-124">For more information, see [User Interface Levels](user-interface-levels.md).</span></span>

 

 



