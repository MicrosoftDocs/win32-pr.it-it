---
description: I moduli unione forniscono un metodo standard che consente agli sviluppatori di distribuire componenti di Windows Installer condivisi e di configurare la logica per le applicazioni.
ms.assetid: 3eb087b1-0f44-40d8-a950-67d489f09408
title: Utilizzo dell'API per unire un modulo merge in un database
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2e68298671045825dda41ad120896fa22c89f068
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314765"
---
# <a name="using-the-api-to-merge-a-merge-module-into-a-database"></a><span data-ttu-id="2a22c-103">Utilizzo dell'API per unire un modulo merge in un database</span><span class="sxs-lookup"><span data-stu-id="2a22c-103">Using the API to Merge a Merge Module into a Database</span></span>

<span data-ttu-id="2a22c-104">I [moduli unione](merge-modules.md) forniscono un metodo standard che consente agli sviluppatori di distribuire [*componenti*](c-gly.md) di Windows Installer condivisi e di configurare la logica per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2a22c-104">[Merge modules](merge-modules.md) provide a standard method for developers to deliver shared Windows Installer [*components*](c-gly.md) and setup logic to their applications.</span></span> <span data-ttu-id="2a22c-105">I moduli merge devono essere Uniti in un pacchetto di installazione usando uno strumento di merge.</span><span class="sxs-lookup"><span data-stu-id="2a22c-105">Merge modules must be merged into an installation package using a merge tool.</span></span> <span data-ttu-id="2a22c-106">L'alternativa migliore è ottenere uno strumento di merge distribuito liberamente oppure acquistare uno degli strumenti di Unione disponibili presso i fornitori di software indipendenti.</span><span class="sxs-lookup"><span data-stu-id="2a22c-106">The best alternative is to obtain a freely distributed merge tool or purchase one of the merging tools available from independent software vendors.</span></span> <span data-ttu-id="2a22c-107">Ad esempio, è possibile usare la funzionalità fornita da [Mergemod.dll](merge-module-automation.md).</span><span class="sxs-lookup"><span data-stu-id="2a22c-107">For example you can use the functionality provided by [Mergemod.dll](merge-module-automation.md).</span></span>

<span data-ttu-id="2a22c-108">Usare i passaggi seguenti in sequenza per unire un modulo merge in un database di installazione Windows Installer dall'API di [Mergemod.dll](merge-module-automation.md).</span><span class="sxs-lookup"><span data-stu-id="2a22c-108">Use the following steps in sequence to merge a merge module into a Windows Installer installation database by the API of [Mergemod.dll](merge-module-automation.md).</span></span>

<span data-ttu-id="2a22c-109">**Per unire un modulo merge in un database di installazione Windows Installer**</span><span class="sxs-lookup"><span data-stu-id="2a22c-109">**To merge a merge module into a Windows Installer installation database**</span></span>

1.  <span data-ttu-id="2a22c-110">Aprire un file di log usando [**OpenLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openlog).</span><span class="sxs-lookup"><span data-stu-id="2a22c-110">Open a log file using [**OpenLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openlog).</span></span> <span data-ttu-id="2a22c-111">Questo passaggio è necessario solo se è necessario creare un file di log o accodare un file di log esistente per il processo di merge.</span><span class="sxs-lookup"><span data-stu-id="2a22c-111">This step is required only if you need to create a log file, or append an existing log file, for the merge process.</span></span>
2.  <span data-ttu-id="2a22c-112">Aprire il database di installazione, un [file con estensione msi](windows-installer-file-extensions.md), che riceverà il modulo merge usando [**OpenDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-opendatabase).</span><span class="sxs-lookup"><span data-stu-id="2a22c-112">Open the installation database, an [.msi file](windows-installer-file-extensions.md), that will receive the merge module using [**OpenDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-opendatabase).</span></span> <span data-ttu-id="2a22c-113">Questo passaggio è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="2a22c-113">This step is required.</span></span>
3.  <span data-ttu-id="2a22c-114">Aprire il modulo merge, ovvero un [file con estensione MSM](windows-installer-file-extensions.md), da unire nel database tramite [**ApriModulo**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openmodule).</span><span class="sxs-lookup"><span data-stu-id="2a22c-114">Open the merge module, an [.msm file](windows-installer-file-extensions.md), that is being merged into the database using [**OpenModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openmodule).</span></span> <span data-ttu-id="2a22c-115">Prima di poter eseguire il merge di un modulo con un database di installazione, è necessario aprirlo.</span><span class="sxs-lookup"><span data-stu-id="2a22c-115">A module must be opened before it can be merged with an installation database.</span></span> <span data-ttu-id="2a22c-116">Questo passaggio è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="2a22c-116">This step is required.</span></span>
4.  <span data-ttu-id="2a22c-117">Unire il modulo nel database di installazione usando [**merge**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-merge) o [**MergeEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-mergeex).</span><span class="sxs-lookup"><span data-stu-id="2a22c-117">Merge the module into the installation database by using [**Merge**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-merge) or [**MergeEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-mergeex).</span></span> <span data-ttu-id="2a22c-118">Si noti che **merge** o **MergeEx** può essere chiamato una sola volta per unire una particolare combinazione di file con estensione msi e MSM.</span><span class="sxs-lookup"><span data-stu-id="2a22c-118">Note that **Merge** or **MergeEx** can only be called once to merge a particular combination of .msi and .msm files.</span></span> <span data-ttu-id="2a22c-119">**MergeEx** è disponibile solo quando si usa [Mergemod.dll versione 2,0](merge-module-automation.md) o successiva e solo quando si usa l'interfaccia [IMsmMerge2](/windows/desktop/api/Mergemod/nn-mergemod-imsmmerge2) .</span><span class="sxs-lookup"><span data-stu-id="2a22c-119">**MergeEx** is only available when using [Mergemod.dll version 2.0](merge-module-automation.md) or later and only when using the [IMsmMerge2](/windows/desktop/api/Mergemod/nn-mergemod-imsmmerge2) interface.</span></span> <span data-ttu-id="2a22c-120">Questo passaggio è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="2a22c-120">This step is required.</span></span>
5.  <span data-ttu-id="2a22c-121">Chiamare [**get \_ Errors**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-get_errors) ed esaminare la raccolta di errori recuperata per i conflitti di merge o altri errori.</span><span class="sxs-lookup"><span data-stu-id="2a22c-121">Call [**get\_Errors**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-get_errors) and examine the retrieved collection of errors for merge conflicts or other errors.</span></span> <span data-ttu-id="2a22c-122">Il recupero non è distruttivo.</span><span class="sxs-lookup"><span data-stu-id="2a22c-122">The retrieval is non-destructive.</span></span> <span data-ttu-id="2a22c-123">È possibile recuperare più istanze della raccolta di errori leggendo ripetutamente la chiamata di **get \_ Errors**.</span><span class="sxs-lookup"><span data-stu-id="2a22c-123">Multiple instances of the error collection may be retrieved by repeatedly reading calling **get\_Errors**.</span></span> <span data-ttu-id="2a22c-124">Sarà necessario risolvere gli eventuali errori nel modo appropriato per il caso.</span><span class="sxs-lookup"><span data-stu-id="2a22c-124">You will need to resolve any errors as appropriate for your case.</span></span>
6.  <span data-ttu-id="2a22c-125">Associare i componenti del modulo merge a eventuali funzionalità aggiuntive che sono state o verranno unite nel database di installazione tramite [**Connect**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-connect).</span><span class="sxs-lookup"><span data-stu-id="2a22c-125">Associate the components of the merge module with any additional features that have been, or will be, merged into the installation database using [**Connect**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-connect).</span></span> <span data-ttu-id="2a22c-126">La funzionalità deve esistere già prima di chiamare questo metodo.</span><span class="sxs-lookup"><span data-stu-id="2a22c-126">The feature must already exist before calling this method.</span></span> <span data-ttu-id="2a22c-127">Questo passaggio è necessario solo se si dispone di funzionalità aggiuntive. per ulteriori informazioni, vedere [connessione di un modulo merge a più funzionalità](connecting-a-merge-module-to-multiple-features.md)</span><span class="sxs-lookup"><span data-stu-id="2a22c-127">This step is only required if you have additional features, for more information see [Connecting a Merge Module to Multiple Features](connecting-a-merge-module-to-multiple-features.md)</span></span>
7.  <span data-ttu-id="2a22c-128">Se necessario, estrarre i file di origine dal modulo eseguendo una o più delle operazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="2a22c-128">If necessary, extract source files from the module by doing one or more of the following.</span></span>

    <span data-ttu-id="2a22c-129">Per estrarre i file da un file con estensione cab incorporato e quindi copiarli in una directory specificata, utilizzare [**ExtractFiles**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractfiles) o [**ExtractFilesEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-extractfilesex).</span><span class="sxs-lookup"><span data-stu-id="2a22c-129">To extract files from an embedded .cab file and then copy into a specified directory, use [**ExtractFiles**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractfiles) or [**ExtractFilesEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-extractfilesex).</span></span> <span data-ttu-id="2a22c-130">Si noti che **ExtractFilesEx** richiede [Mergemod.dll versione 2,0](merge-module-automation.md) o successiva.</span><span class="sxs-lookup"><span data-stu-id="2a22c-130">Note that **ExtractFilesEx** requires [Mergemod.dll version 2.0](merge-module-automation.md) or later.</span></span>

    <span data-ttu-id="2a22c-131">Per estrarre i file da un file con estensione cab incorporato e quindi salvarli in un file specificato, usare [**ExtractCAB**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractcab).</span><span class="sxs-lookup"><span data-stu-id="2a22c-131">To extract files from an embedded .cab file and then save in a specified file, use [**ExtractCAB**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractcab).</span></span>

    <span data-ttu-id="2a22c-132">Per estrarre i file da un modulo e quindi copiarli in un'immagine di origine su disco dopo il merge, usare [**CreateSourceImage**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-createsourceimage).</span><span class="sxs-lookup"><span data-stu-id="2a22c-132">To extract files from a module and then copy to a source image on disk after the merge, use [**CreateSourceImage**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-createsourceimage).</span></span> <span data-ttu-id="2a22c-133">Si noti che **CreateSourceImage** è disponibile solo con [Mergemod.dll versione 2,0](merge-module-automation.md) o successiva.</span><span class="sxs-lookup"><span data-stu-id="2a22c-133">Note that **CreateSourceImage** is only available with [Mergemod.dll version 2.0](merge-module-automation.md) or later.</span></span>

8.  <span data-ttu-id="2a22c-134">Chiudere il modulo Open merge corrente usando [**CloseModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closemodule).</span><span class="sxs-lookup"><span data-stu-id="2a22c-134">Close the current open merge module using [**CloseModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closemodule).</span></span> <span data-ttu-id="2a22c-135">Questo passaggio è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="2a22c-135">This step is required.</span></span>
9.  <span data-ttu-id="2a22c-136">Chiudere il database di installazione aperto corrente usando [**ChiudiDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closedatabase).</span><span class="sxs-lookup"><span data-stu-id="2a22c-136">Close the current open installation database using [**CloseDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closedatabase).</span></span> <span data-ttu-id="2a22c-137">Questo passaggio è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="2a22c-137">This step is required.</span></span> <span data-ttu-id="2a22c-138">La chiusura di un database Cancella tutte le informazioni sulle dipendenze, ma non influisce sugli errori che non sono stati recuperati.</span><span class="sxs-lookup"><span data-stu-id="2a22c-138">Closing a database clears all dependency information but does not affect any errors that have not been retrieved.</span></span>
10. <span data-ttu-id="2a22c-139">Chiudere il file di log corrente usando [**CloseLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closelog).</span><span class="sxs-lookup"><span data-stu-id="2a22c-139">Close the current log file using [**CloseLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closelog).</span></span> <span data-ttu-id="2a22c-140">Questo passaggio è obbligatorio se è stato aperto un file di log.</span><span class="sxs-lookup"><span data-stu-id="2a22c-140">This step is required if you have opened a log file.</span></span>

<span data-ttu-id="2a22c-141">Dopo che il modulo è stato unito al database usando [Mergemod.dll](merge-module-automation.md), è necessario aggiornare la [tabella dei supporti](media-table.md) per descrivere il layout dell'immagine di origine desiderato.</span><span class="sxs-lookup"><span data-stu-id="2a22c-141">After the module has been merged into the database using [Mergemod.dll](merge-module-automation.md), the [Media Table](media-table.md) must be updated to describe the desired source image layout.</span></span> <span data-ttu-id="2a22c-142">Il processo di merge fornito da Mergemod.dll non aggiorna la tabella dei supporti perché il consumer del modulo merge può selezionare diversi modi per creare il layout dell'immagine di origine.</span><span class="sxs-lookup"><span data-stu-id="2a22c-142">The merge process provided by Mergemod.dll does not update the Media Table because the consumer of the merge module can select various ways to layout the source image.</span></span>

 

 
