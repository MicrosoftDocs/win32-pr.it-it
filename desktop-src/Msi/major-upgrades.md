---
description: Un aggiornamento principale è un aggiornamento completo di un prodotto che richiede una modifica della proprietà ProductCode.
ms.assetid: 0c8f2aad-b301-4404-9051-694d97db1a8d
title: Aggiornamenti principali
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7795695072f6c153373db914781ac4b919cd2572
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104527031"
---
# <a name="major-upgrades"></a><span data-ttu-id="66fe1-103">Aggiornamenti principali</span><span class="sxs-lookup"><span data-stu-id="66fe1-103">Major Upgrades</span></span>

<span data-ttu-id="66fe1-104">Un aggiornamento principale è un aggiornamento completo di un prodotto che richiede una modifica della proprietà [**ProductCode**](productcode.md) .</span><span class="sxs-lookup"><span data-stu-id="66fe1-104">A major upgrade is a comprehensive update of a product that needs a change of the [**ProductCode**](productcode.md) Property.</span></span>

<span data-ttu-id="66fe1-105">Un tipico aggiornamento principale rimuove una versione precedente di un'applicazione e installa una nuova versione.</span><span class="sxs-lookup"><span data-stu-id="66fe1-105">A typical major upgrade removes a previous version of an application and installs a new version.</span></span> <span data-ttu-id="66fe1-106">Un aggiornamento principale può riorganizzare l'albero dei componenti della funzionalità.</span><span class="sxs-lookup"><span data-stu-id="66fe1-106">A major upgrade can reorganize the feature component tree.</span></span> <span data-ttu-id="66fe1-107">Per ulteriori informazioni, vedere [**ProductCode**](productcode.md) e [modifica del codice del prodotto](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-107">For more information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span>

<span data-ttu-id="66fe1-108">Durante un aggiornamento principale con Windows Installer, il programma di installazione Cerca nel computer dell'utente le applicazioni correlate all'aggiornamento in sospeso e, quando ne rileva uno, recupera la versione dell'applicazione installata dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="66fe1-108">During a major upgrade using Windows Installer, the installer searches the user's computer for applications that are related to the pending upgrade, and when it detects one, it retrieves the version of the installed application from the system registry.</span></span> <span data-ttu-id="66fe1-109">Il programma di installazione usa quindi le informazioni nel database di aggiornamento per determinare se aggiornare l'applicazione installata.</span><span class="sxs-lookup"><span data-stu-id="66fe1-109">The installer then uses information in the upgrade database to determine whether to upgrade the installed application.</span></span>

<span data-ttu-id="66fe1-110">Per abilitare le funzionalità di aggiornamento del programma di installazione, ogni pacchetto deve disporre di una proprietà [**UpgradeCode**](upgradecode.md) e di una [tabella di aggiornamento](upgrade-table.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-110">To enable the installer upgrade capabilities, each package should have an [**UpgradeCode**](upgradecode.md) Property and an [Upgrade Table](upgrade-table.md).</span></span> <span data-ttu-id="66fe1-111">Ogni prodotto autonomo o gruppo di prodotti deve avere il proprio **UpgradeCode**.</span><span class="sxs-lookup"><span data-stu-id="66fe1-111">Each stand-alone product or product suite should have its own **UpgradeCode**.</span></span> <span data-ttu-id="66fe1-112">Per altre informazioni sull'uso di **UpgradeCode** , vedere la sezione [uso di un UpgradeCode](using-an-upgradecode.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-112">For more information about using the **UpgradeCode** see the section [Using an UpgradeCode](using-an-upgradecode.md).</span></span> <span data-ttu-id="66fe1-113">Ogni record nella tabella di aggiornamento fornisce una combinazione del codice di aggiornamento, della versione del prodotto e delle informazioni sulla lingua utilizzate per identificare un set di prodotti interessati dall'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="66fe1-113">Each record in the Upgrade table gives a combination of the upgrade code, product version, and language information used to identify a set of products affected by the upgrade.</span></span> <span data-ttu-id="66fe1-114">Quando l' [azione FindRelatedProducts](findrelatedproducts-action.md) rileva che nel sistema è installato un prodotto interessato, questo Accoda il codice prodotto a una proprietà nella colonna ActionProperty della tabella di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="66fe1-114">When the [FindRelatedProducts Action](findrelatedproducts-action.md) detects that an affected product is installed on the system, it appends the product code to a property in the ActionProperty column of the Upgrade table.</span></span> <span data-ttu-id="66fe1-115">L' [azione RemoveExistingProducts](removeexistingproducts-action.md) e l' [azione MigrateFeatureStates](migratefeaturestates-action.md) rimuovere o migrare i prodotti elencati nell'elenco ActionProperty.</span><span class="sxs-lookup"><span data-stu-id="66fe1-115">The [RemoveExistingProducts action](removeexistingproducts-action.md) and the [MigrateFeatureStates Action](migratefeaturestates-action.md) remove or migrate the products listed in the ActionProperty list.</span></span> <span data-ttu-id="66fe1-116">Gli autori di pacchetti possono inoltre attenersi alla procedura descritta nell'argomento [preparazione di un'applicazione per aggiornamenti principali futuri](preparing-an-application-for-future-major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-116">Package authors can also follow the procedure described in the topic: [Preparing an Application for Future Major Upgrades](preparing-an-application-for-future-major-upgrades.md).</span></span>

<span data-ttu-id="66fe1-117">È possibile creare Windows Installer pacchetti di aggiornamento in modo che gli aggiornamenti principali non vengano installati se per l'utente è già installata una versione più recente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="66fe1-117">Windows Installer upgrade packages can be authored such that major upgrades will not install if the user already has a newer version of the application installed.</span></span> <span data-ttu-id="66fe1-118">Per ulteriori informazioni su come creare un pacchetto che non viene installato in una versione più recente, vedere [impedire l'installazione di un pacchetto obsoleto in una versione più recente](preventing-an-old-package-from-installing-over-a-newer-version.md) .</span><span class="sxs-lookup"><span data-stu-id="66fe1-118">For more information about how to author a package that will not install over a newer version, see [Preventing an Old Package from Installing Over a Newer Version](preventing-an-old-package-from-installing-over-a-newer-version.md)</span></span>

> [!Note]  
> <span data-ttu-id="66fe1-119">Windows Installer utilizza solo i primi tre campi della versione del prodotto.</span><span class="sxs-lookup"><span data-stu-id="66fe1-119">Windows Installer uses only the first three fields of the product version.</span></span> <span data-ttu-id="66fe1-120">Per le descrizioni di questi campi, vedere proprietà [**ProductVersion**](productversion.md) .</span><span class="sxs-lookup"><span data-stu-id="66fe1-120">See [**ProductVersion**](productversion.md) Property for descriptions of these fields.</span></span> <span data-ttu-id="66fe1-121">Se si include un quarto campo nella versione del prodotto, il programma di installazione ignorerà il quarto campo.</span><span class="sxs-lookup"><span data-stu-id="66fe1-121">If you include a fourth field in your product version, the installer ignores the fourth field.</span></span>

 

<span data-ttu-id="66fe1-122">Il metodo consigliato per applicare un aggiornamento principale installando il pacchetto completo per il prodotto aggiornato.</span><span class="sxs-lookup"><span data-stu-id="66fe1-122">The recommended method of applying a major upgrade by installing the full package for the updated product.</span></span> <span data-ttu-id="66fe1-123">Per informazioni su come applicare un aggiornamento importante installando il prodotto, vedere l'articolo relativo all' [applicazione degli aggiornamenti principali tramite l'installazione del prodotto](applying-major-upgrades-by-installing-the-product.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-123">For information about how to apply a major upgrade by installing the product, see [Applying Major Upgrades by Installing the Product](applying-major-upgrades-by-installing-the-product.md).</span></span>

<span data-ttu-id="66fe1-124">Un aggiornamento principale applicato come [pacchetto di patch](patch-packages.md) per il prodotto non può essere sequenziato con altri aggiornamenti e non è una [patch non installabile](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-124">A major upgrade applied as a [Patch Package](patch-packages.md) for the product cannot be sequenced with other updates and is not an [uninstallable patch](uninstallable-patches.md).</span></span> <span data-ttu-id="66fe1-125">Per informazioni su come applicare un pacchetto di patch di aggiornamento principale a un pacchetto di Windows Installer, vedere [l'articolo relativo all'applicazione di aggiornamenti principali mediante l'applicazione di patch all'installazione locale del prodotto](applying-major-upgrades-by-patching-the-local-installation-of-the-product.md).</span><span class="sxs-lookup"><span data-stu-id="66fe1-125">For information about how to apply a major upgrade patch package to a Windows Installer package see [Applying Major Upgrades by Patching the Local Installation of the Product](applying-major-upgrades-by-patching-the-local-installation-of-the-product.md).</span></span> <span data-ttu-id="66fe1-126">L'applicazione di un aggiornamento principale usando un pacchetto di patch non è consigliata, ma è consigliabile applicare gli aggiornamenti principali installando il prodotto completo.</span><span class="sxs-lookup"><span data-stu-id="66fe1-126">The application of a major upgrade using a patch package is not recommended, instead apply major upgrades by installing the full product.</span></span>

> [!Note]  
> <span data-ttu-id="66fe1-127">Se un'applicazione viene installata nel [contesto di installazione](installation-context.md)per utente, è necessario eseguire qualsiasi aggiornamento importante dell'applicazione anche usando il contesto per utente.</span><span class="sxs-lookup"><span data-stu-id="66fe1-127">If an application is installed in the per-user [installation context](installation-context.md), any major upgrade to the application must also be performed using the per-user context.</span></span> <span data-ttu-id="66fe1-128">Se un'applicazione viene installata nel contesto di installazione per computer, è necessario eseguire anche eventuali aggiornamenti principali dell'applicazione usando il contesto per computer.</span><span class="sxs-lookup"><span data-stu-id="66fe1-128">If an application is installed in the per-machine installation context, any major upgrade to the application must also be performed using the per-machine context.</span></span> <span data-ttu-id="66fe1-129">Il Windows Installer non installerà gli aggiornamenti principali nel contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="66fe1-129">The Windows Installer will not install major upgrades across installation context.</span></span>

 

<span data-ttu-id="66fe1-130">È possibile condizionare le azioni personalizzate sequenziate dopo [InstallValidate](installvalidate-action.md) per gestire gli aggiornamenti principali usando la proprietà [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md) :</span><span class="sxs-lookup"><span data-stu-id="66fe1-130">You can condition custom actions that are sequenced after [InstallValidate](installvalidate-action.md) to handle major upgrades by using the [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md) property:</span></span>

-   <span data-ttu-id="66fe1-131">Se si desidera che un'azione personalizzata venga eseguita durante una disinstallazione del prodotto, ma non durante la rimozione del prodotto da un aggiornamento principale, utilizzare questa condizione.</span><span class="sxs-lookup"><span data-stu-id="66fe1-131">If you want a custom action to run during an uninstallation of the product, but not during the removal of the product by a major upgrade, use this condition.</span></span>

    <span data-ttu-id="66fe1-132">REMOVE = "ALL" e non [ **UPGRADINGPRODUCTCODE**](upgradingproductcode.md)</span><span class="sxs-lookup"><span data-stu-id="66fe1-132">REMOVE="ALL" AND NOT [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md)</span></span>

-   <span data-ttu-id="66fe1-133">Se si vuole che un'azione personalizzata venga eseguita solo durante un aggiornamento principale, usare questa condizione.</span><span class="sxs-lookup"><span data-stu-id="66fe1-133">If you want a custom action to run only during a major upgrade, use this condition.</span></span>

    [<span data-ttu-id="66fe1-134">**UPGRADINGPRODUCTCODE**</span><span class="sxs-lookup"><span data-stu-id="66fe1-134">**UPGRADINGPRODUCTCODE**</span></span>](upgradingproductcode.md)

 

 



