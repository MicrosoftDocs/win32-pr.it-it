---
description: Gli utenti e le applicazioni con privilegi amministrativi possono recuperare e modificare le informazioni dell'elenco di origini di rete, URL e supporto per Windows Installer le applicazioni e le patch nel sistema.
ms.assetid: e8c66bad-f594-4926-b3b4-c8b245dcfa83
title: Gestione delle origini di installazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7fc45253af20ae5f9792ee3a5ec7dd318c80295
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106318278"
---
# <a name="managing-installation-sources"></a><span data-ttu-id="f3238-103">Gestione delle origini di installazione</span><span class="sxs-lookup"><span data-stu-id="f3238-103">Managing Installation Sources</span></span>

<span data-ttu-id="f3238-104">Gli utenti e le applicazioni con privilegi amministrativi possono recuperare e modificare le informazioni dell'elenco di origini di rete, URL e supporto per Windows Installer le applicazioni e le patch nel sistema.</span><span class="sxs-lookup"><span data-stu-id="f3238-104">Users and applications with administrative privileges can retrieve and modify network, URL, and media source list information for Windows Installer applications and patches on the system.</span></span>

<span data-ttu-id="f3238-105">**Windows Installer 2,0:** Non supportato.</span><span class="sxs-lookup"><span data-stu-id="f3238-105">**Windows Installer 2.0:** Not supported.</span></span> <span data-ttu-id="f3238-106">Gli amministratori non possono leggere, riordinare o sostituire le voci nell'elenco di origine e non possono modificare o recuperare le proprietà dell'elenco di origine.</span><span class="sxs-lookup"><span data-stu-id="f3238-106">Administrators cannot read, reorder, or replace entries in the source list and cannot modify or retrieve source list properties.</span></span> <span data-ttu-id="f3238-107">È possibile gestire le origini di rete, ma non le origini URL o multimediali.</span><span class="sxs-lookup"><span data-stu-id="f3238-107">It is possible to manage Network sources, but not URL or Media sources.</span></span> <span data-ttu-id="f3238-108">Gli amministratori possono gestire solo gli elenchi di origine per le applicazioni per computer o per le applicazioni installate come per utente per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="f3238-108">Administrators can only manage source lists for per-machine applications or applications installed as per-user for the current user.</span></span> <span data-ttu-id="f3238-109">Ciò impedisce agli amministratori che usano versioni precedenti a Windows Installer versione 3,0 di gestire le informazioni dell'elenco di origine per tutti gli utenti del sistema.</span><span class="sxs-lookup"><span data-stu-id="f3238-109">This prevents administrators using versions earlier than Windows Installer version 3.0 from managing source list information for all users in the system.</span></span>

<span data-ttu-id="f3238-110">**Windows Installer 3,0 e versioni successive:** Gli utenti e le applicazioni che dispongono di privilegi di amministratore possono recuperare e modificare le informazioni dell'elenco di origine per Windows Installer le applicazioni e le patch installate nel sistema per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="f3238-110">**Windows Installer 3.0 and later:** Users and applications that have administrator privileges can retrieve and modify source list information for Windows Installer applications and patches installed on the system for all users.</span></span> <span data-ttu-id="f3238-111">Le funzioni elenco di origine possono essere usate per gestire elenchi di origine e proprietà dell'elenco di origine per le origini di rete, URL e supporti.</span><span class="sxs-lookup"><span data-stu-id="f3238-111">The source list functions can be used to manage source lists and source list properties for network, URL and media sources.</span></span> <span data-ttu-id="f3238-112">Il programma di installazione può riordinare gli elenchi di origine da un processo esterno.</span><span class="sxs-lookup"><span data-stu-id="f3238-112">The installer can reorder source lists from an external process.</span></span>

<span data-ttu-id="f3238-113">Gli utenti e le applicazioni che dispongono di privilegi amministrativi possono leggere e modificare i tipi seguenti di informazioni sull'elenco di origini:</span><span class="sxs-lookup"><span data-stu-id="f3238-113">Users and applications that have administrative privileges can read and modify the following types of source list information:</span></span>

-   <span data-ttu-id="f3238-114">Elenchi di origine per le applicazioni e le patch installate per tutti gli utenti del sistema.</span><span class="sxs-lookup"><span data-stu-id="f3238-114">Source lists for applications and patches installed for all users on the system.</span></span>
-   <span data-ttu-id="f3238-115">Elenchi di origine per le origini patch esistenti oltre alle origini dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f3238-115">Source lists for patch sources that exist apart from the application sources.</span></span>
-   <span data-ttu-id="f3238-116">Elenchi di origine per URL e origini multimediali esistenti oltre alle origini di rete.</span><span class="sxs-lookup"><span data-stu-id="f3238-116">Source lists for URL and media sources that exist apart from network sources.</span></span>
-   <span data-ttu-id="f3238-117">Proprietà dell'elenco di origine, ad esempio [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType** e **PackageName**.</span><span class="sxs-lookup"><span data-stu-id="f3238-117">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName**.</span></span>

<span data-ttu-id="f3238-118">Le funzioni degli elenchi di origine possono limitare l'ambito degli elenchi di origine trovati specificando il contesto di installazione e il contesto utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-118">The source lists functions can limit the scope of the source lists found by specifying the installation context and user context.</span></span> <span data-ttu-id="f3238-119">Esistono tre possibili contesti di installazione: per utente (non gestito), per computer e gestiti per utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-119">There are three possible installation contexts: per-user (unmanaged), per-machine, and per-user managed.</span></span> <span data-ttu-id="f3238-120">Il contesto utente può essere un utente specifico o tutti gli utenti del sistema.</span><span class="sxs-lookup"><span data-stu-id="f3238-120">The user context can be a particular user or all users on the system.</span></span>

<span data-ttu-id="f3238-121">Gli utenti non amministratori non possono modificare l'elenco di origine di un'istanza di un'applicazione o di una patch esistente nel contesto di un altro utente (gestito o non gestito).</span><span class="sxs-lookup"><span data-stu-id="f3238-121">Non-administrators cannot modify the source list of an instance of an application or patch that exists under another user's per-user (managed or unmanaged) context.</span></span> <span data-ttu-id="f3238-122">Gli non amministratori possono modificare gli elenchi di origine di un'istanza di un'applicazione o di una patch installata con i seguenti contesti:</span><span class="sxs-lookup"><span data-stu-id="f3238-122">Non-administrators can modify the source lists of an instance of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="f3238-123">Il rispettivo contesto per utente (non gestito).</span><span class="sxs-lookup"><span data-stu-id="f3238-123">Their own per-user(unmanaged) context.</span></span>
-   <span data-ttu-id="f3238-124">Il contesto del computer, ma solo se i criteri [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md)e [AlwaysInstallElevated](alwaysinstallelevated.md) consentono la ricerca di un'applicazione o di un'origine patch.</span><span class="sxs-lookup"><span data-stu-id="f3238-124">The machine context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>
-   <span data-ttu-id="f3238-125">Il rispettivo contesto gestito per utente, ma solo se i criteri [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md)e [AlwaysInstallElevated](alwaysinstallelevated.md) consentono loro di cercare un'applicazione o un'origine patch.</span><span class="sxs-lookup"><span data-stu-id="f3238-125">Their own per-user managed context, but only if the [DisableBrowse](disablebrowse.md), [AllowLockdownBrowse](allowlockdownbrowse.md), and [AlwaysInstallElevated](alwaysinstallelevated.md) policies allows them to browse for an application or patch source.</span></span>

<span data-ttu-id="f3238-126">Gli amministratori possono modificare qualsiasi elenco di origine che può essere modificato da un amministratore non amministratore.</span><span class="sxs-lookup"><span data-stu-id="f3238-126">Administrators can modify any source list that a non-administrator can modify.</span></span> <span data-ttu-id="f3238-127">Inoltre, gli amministratori e le applicazioni che dispongono di privilegi amministrativi possono modificare gli elenchi di origine di un'applicazione o di una patch installata nei contesti seguenti:</span><span class="sxs-lookup"><span data-stu-id="f3238-127">In addition, administrators and applications that have administrative privileges can modify the source lists of an application or patch installed under the following contexts:</span></span>

-   <span data-ttu-id="f3238-128">Contesto per computer.</span><span class="sxs-lookup"><span data-stu-id="f3238-128">Per-machine context.</span></span>
-   <span data-ttu-id="f3238-129">Il rispettivo per utente (non gestito) o il proprio contesto gestito per utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-129">Their own per-user (unmanaged) or their own per-user managed context.</span></span>
-   <span data-ttu-id="f3238-130">Contesto gestito per utente di un altro utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-130">Another user's per-user managed context.</span></span>

> [!Note]  
> <span data-ttu-id="f3238-131">Gli utenti e le applicazioni che dispongono di privilegi amministrativi non possono modificare l'elenco di origine di un'istanza di un'applicazione o di una patch installata nel contesto per utente (non gestito) di un altro utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-131">Users and applications that have administrative privileges cannot modify the source list of an instance of an application or patch installed in the per-user (unmanaged) context of another user.</span></span>

 

## <a name="managing-network-and-url-sources-for-products-and-patches"></a><span data-ttu-id="f3238-132">Gestione delle origini di rete e URL per prodotti e patch</span><span class="sxs-lookup"><span data-stu-id="f3238-132">Managing Network and URL sources for Products and Patches</span></span>

<span data-ttu-id="f3238-133">Usare la funzione [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) per aggiungere o riordinare l'elenco di origine di origini di rete e URL per una patch o un'applicazione in un determinato contesto.</span><span class="sxs-lookup"><span data-stu-id="f3238-133">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to add or reorder the source list of network and URL sources for a patch or application in a particular context.</span></span> <span data-ttu-id="f3238-134">Usare il parametro *dwContext* per specificare il contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="f3238-134">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="f3238-135">Usare il parametro *szUserSid* per specificare il contesto utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-135">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="f3238-136">Usare la funzione [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) per creare un elenco di origine per una patch che non è ancora stata applicata a nessuna applicazione nel contesto specificato.</span><span class="sxs-lookup"><span data-stu-id="f3238-136">Use the [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to create a source list for a patch that has not yet been applied to any application in the specified context.</span></span> <span data-ttu-id="f3238-137">Questa operazione può essere utile quando si registra una patch con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="f3238-137">This can be useful when registering a patch to have elevated privileges.</span></span> <span data-ttu-id="f3238-138">Per ulteriori informazioni sulla registrazione di privilegi elevati per una patch, vedere [applicazione di patch Per-User applicazioni gestite](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="f3238-138">For more information about registering elevated privileges for a patch, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

<span data-ttu-id="f3238-139">Utilizzare la funzione [**MsiSourceListClearSource**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) per rimuovere un'origine esistente per un'applicazione o una patch in un contesto specificato.</span><span class="sxs-lookup"><span data-stu-id="f3238-139">Use the [**MsiSourceListClearSource**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) function to remove an existing source for an application or patch in a specified context.</span></span> <span data-ttu-id="f3238-140">La rimozione dell'origine corrente per un'applicazione o una patch impone al programma di installazione di cercare un'origine nell'elenco di origine alla successiva richiesta di un'origine.</span><span class="sxs-lookup"><span data-stu-id="f3238-140">Removing the current source for an application or patch forces the installer to search the source list for a source the next time a source is required.</span></span>

<span data-ttu-id="f3238-141">Utilizzare la funzione [**MsiSourceListEnumSources**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) per enumerare le origini nell'elenco di origine di una patch o di un'applicazione specificata.</span><span class="sxs-lookup"><span data-stu-id="f3238-141">Use the [**MsiSourceListEnumSources**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) function to enumerate sources in the source list of a specified patch or application.</span></span>

## <a name="managing-media-sources-for-products-and-patches"></a><span data-ttu-id="f3238-142">Gestione delle origini multimediali per prodotti e patch</span><span class="sxs-lookup"><span data-stu-id="f3238-142">Managing Media sources for Products and Patches</span></span>

<span data-ttu-id="f3238-143">Usare la funzione [**MsiSourceListAddMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) per aggiungere o aggiornare le informazioni sul disco dell'origine multimediale di un'applicazione o di una patch registrata.</span><span class="sxs-lookup"><span data-stu-id="f3238-143">Use the [**MsiSourceListAddMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) function to add or update the disk information of the media source of a registered application or patch.</span></span> <span data-ttu-id="f3238-144">Ogni voce viene identificata in modo univoco da un ID disco.</span><span class="sxs-lookup"><span data-stu-id="f3238-144">Each entry is uniquely identified by a disk ID.</span></span> <span data-ttu-id="f3238-145">Se il disco esiste già, viene aggiornato con i valori nuovi per etichetta volume e richiesta disco.</span><span class="sxs-lookup"><span data-stu-id="f3238-145">If the disk already exists, it is updated with the new volume label and disk prompt values.</span></span> <span data-ttu-id="f3238-146">Se il disco non esiste, viene creata una nuova voce del disco con i nuovi valori.</span><span class="sxs-lookup"><span data-stu-id="f3238-146">If the disk does not exist, a new disk entry is created with the new values.</span></span>

<span data-ttu-id="f3238-147">Usare la funzione [**MsiSourceListClearMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) per rimuovere un disco registrato esistente nell'origine supporto per un'applicazione o una patch in un contesto specifico.</span><span class="sxs-lookup"><span data-stu-id="f3238-147">Use the [**MsiSourceListClearMediaDisk**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) function to remove an existing registered disk under the media source for an application or patch in a specific context.</span></span>

<span data-ttu-id="f3238-148">Usare la funzione [**MsiSourceListEnumMediaDisks**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) per enumerare un elenco di dischi registrati nell'origine multimediale per un'applicazione o una patch.</span><span class="sxs-lookup"><span data-stu-id="f3238-148">Use the [**MsiSourceListEnumMediaDisks**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) function to enumerate a list of disks registered under the media source for an application or patch.</span></span>

## <a name="retrieval-and-modification-of-source-list-information"></a><span data-ttu-id="f3238-149">Recupero e modifica delle informazioni sull'elenco di origine</span><span class="sxs-lookup"><span data-stu-id="f3238-149">Retrieval and modification of source list information</span></span>

<span data-ttu-id="f3238-150">Usare le funzioni [**MsiSourceListGetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) e [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) per recuperare o modificare le informazioni sull'elenco di origine di un'applicazione o di una patch in un contesto specifico.</span><span class="sxs-lookup"><span data-stu-id="f3238-150">Use the [**MsiSourceListGetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) and [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) functions to retrieve or modify information about the source list for an application or patch in a specific context.</span></span> <span data-ttu-id="f3238-151">Usare il parametro *dwContext* per specificare il contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="f3238-151">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="f3238-152">Usare il parametro *szUserSid* per specificare il contesto utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-152">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="f3238-153">È possibile accedere alle proprietà dell'elenco di origine, ad esempio [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType** e **PackageName** .</span><span class="sxs-lookup"><span data-stu-id="f3238-153">Source list properties such as [**MEDIAPACKAGEPATH**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **LastUsedSource**, **LastUsedType**, and **PackageName** can be accessed.</span></span>

> [!Note]  
> <span data-ttu-id="f3238-154">È possibile leggere la proprietà elenco origine **LastUsedType** .</span><span class="sxs-lookup"><span data-stu-id="f3238-154">The **LastUsedType** source list property can only be read.</span></span> <span data-ttu-id="f3238-155">Non è possibile impostarlo direttamente tramite la funzione [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) .</span><span class="sxs-lookup"><span data-stu-id="f3238-155">It cannot be set directly using the [**MsiSourceListSetInfo**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) function.</span></span>

 

## <a name="clearing-the-complete-source-list-or-forcing-a-source-resolution"></a><span data-ttu-id="f3238-156">Cancellazione dell'elenco di origine completo o forzatura di una risoluzione dell'origine</span><span class="sxs-lookup"><span data-stu-id="f3238-156">Clearing the complete source list or forcing a source resolution</span></span>

<span data-ttu-id="f3238-157">Utilizzare la funzione [**MsiSourceListClearAllEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) per rimuovere tutte le origini esistenti di un determinato tipo di origine per l'applicazione o l'istanza di patch specificata.</span><span class="sxs-lookup"><span data-stu-id="f3238-157">Use the [**MsiSourceListClearAllEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) function to remove all the existing sources of a given source type for the specified application or patch instance.</span></span> <span data-ttu-id="f3238-158">Se la patch non è installata da alcuna applicazione nello stesso contesto, viene rimossa anche la registrazione delle patch.</span><span class="sxs-lookup"><span data-stu-id="f3238-158">The patch registration is also removed if the patch is not installed by any application in the same context.</span></span> <span data-ttu-id="f3238-159">Usare il parametro *dwContext* per specificare il contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="f3238-159">Use the *dwContext* parameter to specify the installation context.</span></span> <span data-ttu-id="f3238-160">Usare il parametro *szUserSid* per specificare il contesto utente.</span><span class="sxs-lookup"><span data-stu-id="f3238-160">Use the *szUserSid* parameter to specify the user context.</span></span>

<span data-ttu-id="f3238-161">Usare [**MsiSourceListForceResolutionEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) per cancellare l'ultima voce di origine usata per un'applicazione o una patch nel contesto specificato.</span><span class="sxs-lookup"><span data-stu-id="f3238-161">Use the [**MsiSourceListForceResolutionEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) to clear the last used source entry for an application or patch in the specified context.</span></span> <span data-ttu-id="f3238-162">Questa funzione rimuove la registrazione della proprietà denominata **LastUsedSource**.</span><span class="sxs-lookup"><span data-stu-id="f3238-162">This function removes the registration of the property called **LastUsedSource**.</span></span> <span data-ttu-id="f3238-163">Questa funzione non influisce sull'elenco di origini registrate.</span><span class="sxs-lookup"><span data-stu-id="f3238-163">This function does not affect the registered source list.</span></span> <span data-ttu-id="f3238-164">La cancellazione della registrazione **LastUsedSource** impone al programma di installazione di eseguire una risoluzione dell'origine sulle origini registrate la volta successiva che richiede l'origine.</span><span class="sxs-lookup"><span data-stu-id="f3238-164">Clearing the **LastUsedSource** registration forces the installer to do a source resolution against the registered sources the next time it requires the source.</span></span>

 

 



