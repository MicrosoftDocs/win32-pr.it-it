---
description: In questa sezione viene descritto come inviare messaggi da azioni personalizzate che eseguono effettivamente una parte dell'installazione chiamando una libreria a collegamento dinamico o uno script.
ms.assetid: 637efccf-920d-421d-9183-528cc3515bf8
title: Restituzione di messaggi di errore da azioni personalizzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 480a9e7891680aadc9d8eb4eedba2bad0d2e3dd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130670"
---
# <a name="returning-error-messages-from-custom-actions"></a><span data-ttu-id="8666a-103">Restituzione di messaggi di errore da azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="8666a-103">Returning Error Messages from Custom Actions</span></span>

<span data-ttu-id="8666a-104">In questa sezione viene descritto come inviare messaggi da azioni personalizzate che eseguono effettivamente una parte dell'installazione chiamando una libreria a collegamento dinamico o uno script.</span><span class="sxs-lookup"><span data-stu-id="8666a-104">This section describes how to send messages from custom actions that actually perform a part of the installation by calling a dynamic link library or script.</span></span> <span data-ttu-id="8666a-105">Si noti che il [tipo di azione personalizzata 19](custom-action-type-19.md) Invia solo un messaggio di errore specificato, restituisce un errore e quindi termina l'installazione.</span><span class="sxs-lookup"><span data-stu-id="8666a-105">Note that [Custom Action Type 19](custom-action-type-19.md) only sends a specified error message, returns failure, and then terminates the installation.</span></span> <span data-ttu-id="8666a-106">Il tipo di azione personalizzata 19 non esegue alcuna parte dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="8666a-106">Custom Action Type 19 does not perform any part of the installation.</span></span>

<span data-ttu-id="8666a-107">Per inviare un messaggio di errore da un'azione personalizzata che usa una [libreria di collegamento dinamico](dynamic-link-libraries.md) (dll), fare in modo che l'azione personalizzata chiami [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="8666a-107">To send an error message from a custom action that uses a [dynamic-link library](dynamic-link-libraries.md) (DLL), have the custom action call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span> <span data-ttu-id="8666a-108">Si noti che le azioni personalizzate avviate da un [ControlEvent DoAction](doaction-controlevent.md) possono inviare messaggi con il metodo del [**messaggio**](session-message.md) , ma non possono inviare un messaggio con **MsiProcessMessage**.</span><span class="sxs-lookup"><span data-stu-id="8666a-108">Note that custom actions launched by a [DoAction ControlEvent](doaction-controlevent.md) can send messages with the [**Message**](session-message.md) method but cannot send a message with **MsiProcessMessage**.</span></span> <span data-ttu-id="8666a-109">Nei sistemi precedenti a Windows Server 2003, le azioni personalizzate avviate da un DoAction ControlEvent non possono inviare messaggi con **MsiProcessMessage** o metodo **Message** .</span><span class="sxs-lookup"><span data-stu-id="8666a-109">On systems earlier than Windows Server 2003, custom actions launched by a DoAction ControlEvent cannot send messages with **MsiProcessMessage** or **Message** method.</span></span> <span data-ttu-id="8666a-110">Per altre informazioni, vedere [invio di messaggi a Windows Installer con MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="8666a-110">For more information, see [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>

<span data-ttu-id="8666a-111">**Per visualizzare un messaggio di errore all'interno di un'azione personalizzata utilizzando una DLL**</span><span class="sxs-lookup"><span data-stu-id="8666a-111">**To display an error message from within a custom action using a DLL**</span></span>

1.  <span data-ttu-id="8666a-112">L'azione personalizzata deve chiamare [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) e passare i parametri *hinstall*, *eMessageType* e *hRecord*.</span><span class="sxs-lookup"><span data-stu-id="8666a-112">The custom action should call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and pass in the parameters *hInstall*, *eMessageType*, and *hRecord*.</span></span> <span data-ttu-id="8666a-113">L'handle per l'installazione, [tipo di azione personalizzata 19](custom-action-type-19.md), può essere fornito all'azione personalizzata come descritto in [accesso alla sessione del programma di installazione corrente dall'interno di un'azione personalizzata](accessing-the-current-installer-session-from-inside-a-custom-action.md) o da [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) o [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span><span class="sxs-lookup"><span data-stu-id="8666a-113">The handle to the installation, [Custom Action Type 19](custom-action-type-19.md), may be provided to the custom action as described in [Accessing the Current Installer Session from Inside a Custom Action](accessing-the-current-installer-session-from-inside-a-custom-action.md) or from [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) or [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span></span>
2.  <span data-ttu-id="8666a-114">Il parametro *eMessageType* deve specificare uno dei tipi di messaggio elencati in [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="8666a-114">The parameter *eMessageType* should specify one of the message types as listed in [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span>
3.  <span data-ttu-id="8666a-115">Il parametro *hRecord* della funzione [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) dipende dal tipo di messaggio.</span><span class="sxs-lookup"><span data-stu-id="8666a-115">The *hRecord* parameter of the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function depends upon the message type.</span></span> <span data-ttu-id="8666a-116">Vedere [invio di messaggi a Windows Installer con MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="8666a-116">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span> <span data-ttu-id="8666a-117">Se il messaggio contiene dati formattati, immettere il messaggio nella tabella degli [errori](error-table.md) usando la formattazione descritta in [formattato](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="8666a-117">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="8666a-118">Per inviare un messaggio di errore da un'azione personalizzata che utilizza gli [script](scripts.md), l'azione personalizzata può chiamare il metodo [**Message**](session-message.md) dell'oggetto [**Session**](session-object.md) .</span><span class="sxs-lookup"><span data-stu-id="8666a-118">To send an error message from a custom action that uses [Scripts](scripts.md), the custom action may call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object.</span></span>

<span data-ttu-id="8666a-119">**Per visualizzare un messaggio di errore all'interno di un'azione personalizzata tramite script**</span><span class="sxs-lookup"><span data-stu-id="8666a-119">**To display an error message from within a custom action using script**</span></span>

1.  <span data-ttu-id="8666a-120">L'azione personalizzata deve chiamare il metodo del [**messaggio**](session-message.md) dell'oggetto [**sessione**](session-object.md) e passare il *tipo* e il *record* dei parametri.</span><span class="sxs-lookup"><span data-stu-id="8666a-120">The custom action should call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object and pass in the parameters *kind* and *record*.</span></span>
2.  <span data-ttu-id="8666a-121">Il *tipo* di parametro deve specificare uno dei tipi di messaggio elencati nel metodo del [**messaggio**](session-message.md) .</span><span class="sxs-lookup"><span data-stu-id="8666a-121">The parameter *kind* should specify one of the message types listed in the [**Message**](session-message.md) method.</span></span>
3.  <span data-ttu-id="8666a-122">Il parametro *record* del metodo del [**messaggio**](session-message.md) dipende dal tipo di messaggio.</span><span class="sxs-lookup"><span data-stu-id="8666a-122">The *record* parameter of the [**Message**](session-message.md) method depends upon the message type.</span></span> <span data-ttu-id="8666a-123">Se il messaggio contiene dati formattati, immettere il messaggio nella tabella degli [errori](error-table.md) usando la formattazione descritta in [formattato](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="8666a-123">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="8666a-124">Le azioni personalizzate che usano [file eseguibili](executable-files.md) non possono inviare un messaggio chiamando [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) o il metodo [**Message**](session-message.md) perché non possono ottenere un handle per l'installazione.</span><span class="sxs-lookup"><span data-stu-id="8666a-124">Custom actions using [Executable Files](executable-files.md) cannot send a message by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) or the [**Message**](session-message.md) method because they cannot get a handle to the installation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8666a-125">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8666a-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8666a-126">Valori restituiti dell'azione personalizzata</span><span class="sxs-lookup"><span data-stu-id="8666a-126">Custom Action Return Values</span></span>](custom-action-return-values.md)
</dt> </dl>

 

 



