---
description: Esistono due modi per creare il database di installazione di Windows Installer in modo che un'azione venga chiamata solo quando il pacchetto viene disinstallato.
ms.assetid: 67b205bb-11d8-454f-b5d5-93330219f6cc
title: Esecuzione delle azioni di condizionamento durante la rimozione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad0e84f21b42f569744af9b8a7a46bb1e3df7a85
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528645"
---
# <a name="conditioning-actions-to-run-during-removal"></a><span data-ttu-id="9932c-103">Esecuzione delle azioni di condizionamento durante la rimozione</span><span class="sxs-lookup"><span data-stu-id="9932c-103">Conditioning Actions to Run During Removal</span></span>

<span data-ttu-id="9932c-104">Esistono due modi per creare il database di installazione in modo che un'azione venga chiamata solo quando il pacchetto viene disinstallato:</span><span class="sxs-lookup"><span data-stu-id="9932c-104">There are two ways to author the installation database such that an action is only called when the package is uninstalled:</span></span>

-   <span data-ttu-id="9932c-105">Se l'azione viene sequenziata dopo l' [azione InstallValidate](installvalidate-action.md) nella [tabella InstallExecuteSequence](installexecutesequence-table.md), l'autore del pacchetto può specificare una condizione di Remove = "All" per l'azione nella colonna condizione.</span><span class="sxs-lookup"><span data-stu-id="9932c-105">If the action is sequenced after the [InstallValidate action](installvalidate-action.md) in the [InstallExecuteSequence table](installexecutesequence-table.md), the package author may specify a condition of REMOVE="ALL" for the action in the Condition column.</span></span> <span data-ttu-id="9932c-106">Si noti che non è garantita l'impostazione della proprietà [**Remove**](remove.md) su All durante una disinstallazione prima che il programma di installazione esegua l'azione InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="9932c-106">Note that the [**REMOVE**](remove.md) property is not guaranteed to be set to ALL during an uninstall before the installer executes the InstallValidate action.</span></span> <span data-ttu-id="9932c-107">Si noti che in questo caso sono necessarie le virgolette per tutto il valore.</span><span class="sxs-lookup"><span data-stu-id="9932c-107">Note that the quote marks around the value ALL are required in this case.</span></span>
-   <span data-ttu-id="9932c-108">Se l'azione viene sequenziata dopo l' [azione CostFinalize secondo](costfinalize-action.md) e tutte le azioni che potrebbero modificare lo stato della funzionalità, ad esempio l'azione [MigrateFeatureStates](migratefeaturestates-action.md), l'azione può essere condizionata sullo stato di una particolare funzionalità o componente.</span><span class="sxs-lookup"><span data-stu-id="9932c-108">If the action is sequenced after the [CostFinalize action](costfinalize-action.md) and any actions that could change the feature state, such as [MigrateFeatureStates action](migratefeaturestates-action.md), the action can be conditioned on the state of a particular feature or component.</span></span> <span data-ttu-id="9932c-109">Vedere [sintassi dell'istruzione condizionale](conditional-statement-syntax.md).</span><span class="sxs-lookup"><span data-stu-id="9932c-109">See [Conditional Statement Syntax](conditional-statement-syntax.md).</span></span> <span data-ttu-id="9932c-110">Usare questa opzione per chiamare un'azione durante la rimozione di una funzionalità o di un componente specifico, che può verificarsi al di fuori della rimozione completa dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9932c-110">Use this option to call an action during the removal of a particular feature or component, which may occur outside of the complete removal of the application.</span></span>

<span data-ttu-id="9932c-111">Si noti che la proprietà [**installata**](installed.md) può essere utilizzata nelle espressioni condizionali per determinare se un prodotto è installato per computer o per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9932c-111">Note that the [**Installed**](installed.md) property can be used in conditional expressions to determine whether a product is installed per-computer or for the current user.</span></span> <span data-ttu-id="9932c-112">Per determinare se il prodotto è installato per un utente diverso, controllare la proprietà [**ProductState**](productstate.md) .</span><span class="sxs-lookup"><span data-stu-id="9932c-112">To determine whether the product is installed for a different user, check the [**ProductState**](productstate.md) property.</span></span>

<span data-ttu-id="9932c-113">Si noti che le versioni precedenti di un prodotto possono essere rimosse durante un aggiornamento mediante l' [azione RemoveExistingProducts](removeexistingproducts-action.md).</span><span class="sxs-lookup"><span data-stu-id="9932c-113">Note that older versions of a product may be removed during an upgrade by the [RemoveExistingProducts action](removeexistingproducts-action.md).</span></span> <span data-ttu-id="9932c-114">La [tabella di aggiornamento](upgrade-table.md) può inoltre impostare la proprietà [**Remove**](remove.md) su All in questo caso.</span><span class="sxs-lookup"><span data-stu-id="9932c-114">The [Upgrade table](upgrade-table.md) may also set the [**REMOVE**](remove.md) property to ALL in this case.</span></span> <span data-ttu-id="9932c-115">Per determinare se un prodotto è stato rimosso da un aggiornamento, controllare la proprietà [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md) .</span><span class="sxs-lookup"><span data-stu-id="9932c-115">To determine whether a product is being removed by an upgrade, check the [**UPGRADINGPRODUCTCODE**](upgradingproductcode.md) property.</span></span> <span data-ttu-id="9932c-116">Il programma di installazione imposta questa proprietà solo quando RemoveExistingProducts rimuove il prodotto.</span><span class="sxs-lookup"><span data-stu-id="9932c-116">The installer only sets this property when RemoveExistingProducts removes the product.</span></span> <span data-ttu-id="9932c-117">Il programma di installazione non imposta la proprietà durante una normale disinstallazione, ad esempio la rimozione con installazione applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9932c-117">The installer does not set the property during a normal uninstall, such as removal with Add/Remove programs.</span></span>

 

 



