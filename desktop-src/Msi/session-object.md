---
description: L'oggetto Session controlla il processo di installazione.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: Oggetto Session (Windows Installer)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c391249d5ccc58fe9a947c9db761a77521c9776d
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "106333043"
---
# <a name="session-object-windows-installer"></a><span data-ttu-id="fbf92-103">Oggetto Session (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="fbf92-103">Session object (Windows Installer)</span></span>

<span data-ttu-id="fbf92-104">L'oggetto **Session** controlla il processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="fbf92-104">The **Session** object controls the installation process.</span></span> <span data-ttu-id="fbf92-105">Viene aperto il database del programma di installazione che contiene i dati e le tabelle di installazione.</span><span class="sxs-lookup"><span data-stu-id="fbf92-105">It opens the Installer database, which contains the installation tables and data.</span></span> <span data-ttu-id="fbf92-106">Questo oggetto è associato a un set standard di funzioni di azione, ciascuna delle quali esegue operazioni specifiche sui dati di una o più tabelle.</span><span class="sxs-lookup"><span data-stu-id="fbf92-106">This object is associated with a standard set of action functions, each performing particular operations on data from one or more tables.</span></span> <span data-ttu-id="fbf92-107">È possibile aggiungere azioni personalizzate aggiuntive per le installazioni di prodotti particolari.</span><span class="sxs-lookup"><span data-stu-id="fbf92-107">Additional custom actions may be added for particular product installations.</span></span> <span data-ttu-id="fbf92-108">La funzione del motore di base è un sequencer che recupera i record sequenziali da una tabella di sequenza designata, valuta qualsiasi espressione di condizione specificata ed esegue l'azione designata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-108">The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action.</span></span> <span data-ttu-id="fbf92-109">Le azioni non riconosciute dal motore sono rinviate all'oggetto gestore dell'interfaccia utente per l'elaborazione, in genere sequenze di finestre di dialogo.</span><span class="sxs-lookup"><span data-stu-id="fbf92-109">Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</span></span>

<span data-ttu-id="fbf92-110">Si noti che solo un oggetto **sessione** può essere aperto da un singolo processo.</span><span class="sxs-lookup"><span data-stu-id="fbf92-110">Note that only one **Session** object can be opened by a single process.</span></span>

## <a name="members"></a><span data-ttu-id="fbf92-111">Membri</span><span class="sxs-lookup"><span data-stu-id="fbf92-111">Members</span></span>

<span data-ttu-id="fbf92-112">L'oggetto **sessione** dispone di questi tipi di membri:</span><span class="sxs-lookup"><span data-stu-id="fbf92-112">The **Session** object has these types of members:</span></span>

-   [<span data-ttu-id="fbf92-113">Metodi</span><span class="sxs-lookup"><span data-stu-id="fbf92-113">Methods</span></span>](#methods)
-   [<span data-ttu-id="fbf92-114">Proprietà</span><span class="sxs-lookup"><span data-stu-id="fbf92-114">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="fbf92-115">Metodi</span><span class="sxs-lookup"><span data-stu-id="fbf92-115">Methods</span></span>

<span data-ttu-id="fbf92-116">L'oggetto **Session** dispone di questi metodi.</span><span class="sxs-lookup"><span data-stu-id="fbf92-116">The **Session** object has these methods.</span></span>



| <span data-ttu-id="fbf92-117">Metodo</span><span class="sxs-lookup"><span data-stu-id="fbf92-117">Method</span></span>                                                 | <span data-ttu-id="fbf92-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="fbf92-118">Description</span></span>                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="fbf92-119">**DoAction**</span><span class="sxs-lookup"><span data-stu-id="fbf92-119">**DoAction**</span></span>](session-doaction.md)                   | <span data-ttu-id="fbf92-120">Esegue l'azione specificata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-120">Executes the specified action.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="fbf92-121">**EvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="fbf92-121">**EvaluateCondition**</span></span>](session-evaluatecondition.md) | <span data-ttu-id="fbf92-122">Valuta un'espressione logica contenente i simboli e i valori e restituisce un Integer dell'enumerazione msiEvaluateConditionErrorEnum.</span><span class="sxs-lookup"><span data-stu-id="fbf92-122">Evaluates a logical expression containing symbols and values and returns an integer of the enumeration msiEvaluateConditionErrorEnum.</span></span><br/>                                                                                                                          |
| [<span data-ttu-id="fbf92-123">**FeatureInfo**</span><span class="sxs-lookup"><span data-stu-id="fbf92-123">**FeatureInfo**</span></span>](session-featureinfo.md)             | <span data-ttu-id="fbf92-124">Restituisce un oggetto [**FeatureInfo**](featureinfo-object.md) che contiene informazioni descrittive per la funzionalità specificata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-124">Returns a [**FeatureInfo**](featureinfo-object.md) object containing descriptive information for the specified feature.</span></span><br/>                                                                                                                                       |
| [<span data-ttu-id="fbf92-125">**FormatRecord**</span><span class="sxs-lookup"><span data-stu-id="fbf92-125">**FormatRecord**</span></span>](session-formatrecord.md)           | <span data-ttu-id="fbf92-126">Restituisce una stringa formattata dai dati del modello e del record.</span><span class="sxs-lookup"><span data-stu-id="fbf92-126">Returns a formatted string from template and record data.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="fbf92-127">**Messaggio**</span><span class="sxs-lookup"><span data-stu-id="fbf92-127">**Message**</span></span>](session-message.md)                     | <span data-ttu-id="fbf92-128">Esegue tutte le operazioni di registrazione abilitate e rinvia l'esecuzione all'oggetto gestore dell'interfaccia utente associato al motore.</span><span class="sxs-lookup"><span data-stu-id="fbf92-128">Performs any enabled logging operations and defers execution to the UI handler object associated with the engine.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="fbf92-129">**Sequenza**</span><span class="sxs-lookup"><span data-stu-id="fbf92-129">**Sequence**</span></span>](session-sequence.md)                   | <span data-ttu-id="fbf92-130">Apre una query sulla tabella specificata, ordinando le azioni in base ai numeri nella colonna sequenza.</span><span class="sxs-lookup"><span data-stu-id="fbf92-130">Opens a query on the specified table, ordering the actions by the numbers in the Sequence column.</span></span> <span data-ttu-id="fbf92-131">Per ogni riga recuperata, viene chiamato il metodo [**DoAction**](session-doaction.md) , purché le espressioni di condizione fornite non restituiscono false.</span><span class="sxs-lookup"><span data-stu-id="fbf92-131">For each row fetched, the [**DoAction**](session-doaction.md) method is called, provided that any supplied condition expression does not evaluate to False.</span></span><br/> |
| [<span data-ttu-id="fbf92-132">**SetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="fbf92-132">**SetInstallLevel**</span></span>](session-setinstalllevel.md)     | <span data-ttu-id="fbf92-133">Imposta il livello di installazione per l'installazione corrente su un valore specificato e Ricalcola gli stati selezionati e installati per tutte le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="fbf92-133">Sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features.</span></span><br/>                                                                                                                    |



 

### <a name="properties"></a><span data-ttu-id="fbf92-134">Proprietà</span><span class="sxs-lookup"><span data-stu-id="fbf92-134">Properties</span></span>

<span data-ttu-id="fbf92-135">L'oggetto **Session** dispone di queste proprietà.</span><span class="sxs-lookup"><span data-stu-id="fbf92-135">The **Session** object has these properties.</span></span>



| <span data-ttu-id="fbf92-136">Proprietà</span><span class="sxs-lookup"><span data-stu-id="fbf92-136">Property</span></span>                                                                  | <span data-ttu-id="fbf92-137">Tipo di accesso</span><span class="sxs-lookup"><span data-stu-id="fbf92-137">Access type</span></span>           | <span data-ttu-id="fbf92-138">Descrizione</span><span class="sxs-lookup"><span data-stu-id="fbf92-138">Description</span></span>                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="fbf92-139">**ComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="fbf92-139">**ComponentCosts**</span></span>](session-componentcosts.md)<br/>               |                       | <span data-ttu-id="fbf92-140">Restituisce un oggetto di [**record**](recordlist-object.md) che enumera lo spazio su disco per unità richiesta per l'installazione di un componente.</span><span class="sxs-lookup"><span data-stu-id="fbf92-140">Returns a [**RecordList**](recordlist-object.md) object enumerating the disk space per drive required to install a component.</span></span><br/>                                  |
| [<span data-ttu-id="fbf92-141">**ComponentCurrentState**</span><span class="sxs-lookup"><span data-stu-id="fbf92-141">**ComponentCurrentState**</span></span>](session-componentcurrentstate.md)<br/> |                       | <span data-ttu-id="fbf92-142">Restituisce lo stato corrente installato del componente designato.</span><span class="sxs-lookup"><span data-stu-id="fbf92-142">Returns the current installed state of the designated component.</span></span><br/>                                                                                                |
| [<span data-ttu-id="fbf92-143">**ComponentRequestState**</span><span class="sxs-lookup"><span data-stu-id="fbf92-143">**ComponentRequestState**</span></span>](session-componentrequeststate.md)<br/> |                       | <span data-ttu-id="fbf92-144">Ottiene o richiede una modifica nello stato dell'azione di una riga nella tabella dei componenti.</span><span class="sxs-lookup"><span data-stu-id="fbf92-144">Obtains or requests a change in the Action state of a row in the Component table.</span></span><br/>                                                                               |
| [<span data-ttu-id="fbf92-145">**Database**</span><span class="sxs-lookup"><span data-stu-id="fbf92-145">**Database**</span></span>](session-database.md)<br/>                           |                       | <span data-ttu-id="fbf92-146">Restituisce il database per la sessione di installazione corrente.</span><span class="sxs-lookup"><span data-stu-id="fbf92-146">Returns the database for the current installation session.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="fbf92-147">**FeatureCost**</span><span class="sxs-lookup"><span data-stu-id="fbf92-147">**FeatureCost**</span></span>](session-featurecost.md)<br/>                     |                       | <span data-ttu-id="fbf92-148">Restituisce la quantità totale di spazio su disco, in unità di 512 byte, richiesta dalla funzionalità specificata e dalle relative funzionalità padre (fino alla radice della tabella delle funzionalità).</span><span class="sxs-lookup"><span data-stu-id="fbf92-148">Returns the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the Feature table).</span></span><br/> |
| [<span data-ttu-id="fbf92-149">**FeatureCurrentState**</span><span class="sxs-lookup"><span data-stu-id="fbf92-149">**FeatureCurrentState**</span></span>](session-featurecurrentstate.md)<br/>     |                       | <span data-ttu-id="fbf92-150">Restituisce lo stato di installazione corrente della funzionalità designata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-150">Returns the current installed state of the designated feature.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="fbf92-151">**FeatureRequestState**</span><span class="sxs-lookup"><span data-stu-id="fbf92-151">**FeatureRequestState**</span></span>](session-featurerequeststate.md)<br/>     | <span data-ttu-id="fbf92-152">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="fbf92-152">Read/write</span></span><br/> | <span data-ttu-id="fbf92-153">Ottiene o richiede una modifica nello stato di selezione del record e dei sottorecord di una funzionalità.</span><span class="sxs-lookup"><span data-stu-id="fbf92-153">Obtains or requests a change in the Select state of a feature's record and subrecords.</span></span><br/>                                                                          |
| [<span data-ttu-id="fbf92-154">**FeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="fbf92-154">**FeatureValidStates**</span></span>](session-featurevalidstates.md)<br/>       |                       | <span data-ttu-id="fbf92-155">Restituisce un Integer che rappresenta i flag di bit con ogni bit pertinente che rappresenta uno stato di installazione valido per la funzionalità specificata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-155">Returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</span></span><br/>                             |
| [<span data-ttu-id="fbf92-156">**Programma di installazione**</span><span class="sxs-lookup"><span data-stu-id="fbf92-156">**Installer**</span></span>](session-installer.md)<br/>                         |                       | <span data-ttu-id="fbf92-157">Restituisce l'oggetto del programma di installazione attivo.</span><span class="sxs-lookup"><span data-stu-id="fbf92-157">Returns the active installer object.</span></span><br/>                                                                                                                            |
| [<span data-ttu-id="fbf92-158">**Language (oggetto Session)**</span><span class="sxs-lookup"><span data-stu-id="fbf92-158">**Language (Session Object)**</span></span>](session-language.md)<br/>          |                       | <span data-ttu-id="fbf92-159">Rappresenta l'identificatore di lingua numerico utilizzato dalla sessione di installazione corrente.</span><span class="sxs-lookup"><span data-stu-id="fbf92-159">Represents the numeric language identifier used by the current installation session.</span></span><br/>                                                                            |
| [<span data-ttu-id="fbf92-160">**Modalità**</span><span class="sxs-lookup"><span data-stu-id="fbf92-160">**Mode**</span></span>](session-mode.md)<br/>                                   |                       | <span data-ttu-id="fbf92-161">Questa proprietà è un valore che rappresenta il flag della modalità designata per la sessione di installazione corrente.</span><span class="sxs-lookup"><span data-stu-id="fbf92-161">This property is a value representing the designated mode flag for the current installation session.</span></span><br/>                                                            |
| [<span data-ttu-id="fbf92-162">**ProductProperty**</span><span class="sxs-lookup"><span data-stu-id="fbf92-162">**ProductProperty**</span></span>](session-productproperty.md)<br/>             |                       | <span data-ttu-id="fbf92-163">Rappresenta il valore stringa di una proprietà del programma di installazione denominata.</span><span class="sxs-lookup"><span data-stu-id="fbf92-163">Represents the string value of a named installer property.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="fbf92-164">**Proprietà (oggetto Session)**</span><span class="sxs-lookup"><span data-stu-id="fbf92-164">**Property (Session Object)**</span></span>](session-session.md)<br/>           | <span data-ttu-id="fbf92-165">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="fbf92-165">Read/write</span></span><br/> | <span data-ttu-id="fbf92-166">Recupera le proprietà del prodotto dal database del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fbf92-166">Retrieves product properties from the product database.</span></span><br/>                                                                                                         |
| [<span data-ttu-id="fbf92-167">**SourcePath**</span><span class="sxs-lookup"><span data-stu-id="fbf92-167">**SourcePath**</span></span>](session-sourcepath.md)<br/>                       |                       | <span data-ttu-id="fbf92-168">Fornisce il percorso completo della cartella designata nel supporto di origine o nell'immagine server.</span><span class="sxs-lookup"><span data-stu-id="fbf92-168">Provides the full path to the designated folder on the source media or server image.</span></span><br/>                                                                            |
| [<span data-ttu-id="fbf92-169">**TargetPath**</span><span class="sxs-lookup"><span data-stu-id="fbf92-169">**TargetPath**</span></span>](session-targetpath.md)<br/>                       | <span data-ttu-id="fbf92-170">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="fbf92-170">Read/write</span></span><br/> | <span data-ttu-id="fbf92-171">Fornisce il percorso completo della cartella designata nell'unità di destinazione dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="fbf92-171">Provides the full path to the designated folder on the installation target drive.</span></span><br/>                                                                               |
| [<span data-ttu-id="fbf92-172">**VerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="fbf92-172">**VerifyDiskSpace**</span></span>](session-verifydiskspace.md)<br/>             |                       | <span data-ttu-id="fbf92-173">Restituisce true se è disponibile spazio su disco sufficiente e false se il disco è pieno.</span><span class="sxs-lookup"><span data-stu-id="fbf92-173">Returns true if enough disk space exists, and false if the disk is full.</span></span><br/>                                                                                        |



 

## <a name="requirements"></a><span data-ttu-id="fbf92-174">Requisiti</span><span class="sxs-lookup"><span data-stu-id="fbf92-174">Requirements</span></span>



| <span data-ttu-id="fbf92-175">Requisito</span><span class="sxs-lookup"><span data-stu-id="fbf92-175">Requirement</span></span> | <span data-ttu-id="fbf92-176">Valore</span><span class="sxs-lookup"><span data-stu-id="fbf92-176">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fbf92-177">Versione</span><span class="sxs-lookup"><span data-stu-id="fbf92-177">Version</span></span><br/> | <span data-ttu-id="fbf92-178">Windows Installer 5,0 in Windows Server 2012, Windows 8, Windows Server 2008 R2 o Windows 7.</span><span class="sxs-lookup"><span data-stu-id="fbf92-178">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="fbf92-179">Windows Installer 4,0 o Windows Installer 4,5 in Windows Server 2008 o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="fbf92-179">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="fbf92-180">Windows Installer in Windows Server 2003 o Windows XP</span><span class="sxs-lookup"><span data-stu-id="fbf92-180">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="fbf92-181">DLL</span><span class="sxs-lookup"><span data-stu-id="fbf92-181">DLL</span></span><br/>     | <dl> <span data-ttu-id="fbf92-182"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="fbf92-182"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="fbf92-183">IID</span><span class="sxs-lookup"><span data-stu-id="fbf92-183">IID</span></span><br/>     | <span data-ttu-id="fbf92-184">IID \_ ISession è definito come 000C109E-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="fbf92-184">IID\_ISession is defined as 000C109E-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                             |



## <a name="see-also"></a><span data-ttu-id="fbf92-185">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="fbf92-185">See also</span></span>

<dl> <dt>

[<span data-ttu-id="fbf92-186">Esempi di script di Windows Installer</span><span class="sxs-lookup"><span data-stu-id="fbf92-186">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




