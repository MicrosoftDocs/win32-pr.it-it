---
description: Windows Installer possibile ripristinare, sostituire e verificare i file contenuti in un'applicazione. Potrebbe essere necessaria una reinstallazione parziale o completa dell'applicazione se eventuali file o voci del registro di sistema associate a qualsiasi funzionalità sono mancanti o danneggiati.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Reinstallazione di una funzionalità o di un'applicazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131614"
---
# <a name="reinstalling-a-feature-or-application"></a><span data-ttu-id="7d992-104">Reinstallazione di una funzionalità o di un'applicazione</span><span class="sxs-lookup"><span data-stu-id="7d992-104">Reinstalling a Feature or Application</span></span>

<span data-ttu-id="7d992-105">Windows Installer possibile ripristinare, sostituire e verificare i file contenuti in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7d992-105">Windows Installer can repair, replace, and verify files contained in an application.</span></span> <span data-ttu-id="7d992-106">Potrebbe essere necessaria una reinstallazione parziale o completa dell'applicazione se eventuali file o voci del registro di sistema associate a qualsiasi funzionalità sono mancanti o danneggiati.</span><span class="sxs-lookup"><span data-stu-id="7d992-106">A partial or complete application reinstallation might be required if any files or registry entries associated with any feature are missing or corrupt.</span></span>

<span data-ttu-id="7d992-107">Quando una funzionalità o un'applicazione viene reinstallata, vengono reinstallati anche tutti i servizi, le variabili di ambiente e le azioni personalizzate appartenenti alla funzionalità o all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7d992-107">When a feature or application is reinstalled, all the services, environment variables, and custom actions belonging to the feature or application are reinstalled as well.</span></span> <span data-ttu-id="7d992-108">Si noti che questo significa che tutte le modifiche apportate alle variabili di ambiente tra l'installazione originale e la reinstallazione vengono perse.</span><span class="sxs-lookup"><span data-stu-id="7d992-108">Note that this means that any changes made to environment variables between the original installation and the reinstallation are lost.</span></span>

<span data-ttu-id="7d992-109">Nell'elenco seguente sono inclusi i metodi di reinstallazione di una funzionalità o di un prodotto.</span><span class="sxs-lookup"><span data-stu-id="7d992-109">The following list contains methods of reinstalling a feature or product.</span></span> <span data-ttu-id="7d992-110">I primi due metodi sono stati automatizzati dal programma di installazione:</span><span class="sxs-lookup"><span data-stu-id="7d992-110">The first two methods have been automated by the installer:</span></span>

-   <span data-ttu-id="7d992-111">Ripristinare, sostituire o verificare i file chiamando la funzione [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .</span><span class="sxs-lookup"><span data-stu-id="7d992-111">Repair, replace, or verify files by calling the [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) function.</span></span>
-   <span data-ttu-id="7d992-112">Reinstallare l'intero prodotto chiamando la funzione [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="7d992-112">Reinstall the entire product by calling the [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) function.</span></span>
-   <span data-ttu-id="7d992-113">Reinstallare, sostituire o verificare i file con un pulsante di controllo dell'interfaccia utente del programma di installazione tramite la [Reinstallazione ControlEvent](reinstall-controlevent.md).</span><span class="sxs-lookup"><span data-stu-id="7d992-113">Reinstall, replace, or verify files with an installer UI control button through the [Reinstall ControlEvent](reinstall-controlevent.md).</span></span>
-   <span data-ttu-id="7d992-114">Reinstallare, sostituire o verificare i file da una riga di comando impostando la proprietà [**REINSTALL**](reinstall.md) e la proprietà [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="7d992-114">Reinstall, replace, or verify files from a command line by setting the [**REINSTALL**](reinstall.md) property and the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

<span data-ttu-id="7d992-115">Per ulteriori informazioni sulla reinstallazione di una funzionalità o di un'applicazione, vedere [resilienza](resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="7d992-115">For more information on reinstalling a feature or application, see [Resiliency](resiliency.md).</span></span>

<span data-ttu-id="7d992-116">**Per reinstallare un prodotto utilizzando il programma di installazione**</span><span class="sxs-lookup"><span data-stu-id="7d992-116">**To reinstall a product using the installer**</span></span>

-   <span data-ttu-id="7d992-117">Chiamare [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span><span class="sxs-lookup"><span data-stu-id="7d992-117">Call [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span></span>

<span data-ttu-id="7d992-118">**Per reinstallare una funzionalità tramite il programma di installazione**</span><span class="sxs-lookup"><span data-stu-id="7d992-118">**To reinstall a feature using the installer**</span></span>

-   <span data-ttu-id="7d992-119">Chiamare [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="7d992-119">Call [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="7d992-120">**Per reinstallare un prodotto o una funzionalità con un'interfaccia utente del programma di installazione**</span><span class="sxs-lookup"><span data-stu-id="7d992-120">**To reinstall a product or feature with an installer user interface**</span></span>

1.  <span data-ttu-id="7d992-121">Aggiungere un pulsante alla finestra di dialogo specificata aggiungendo una voce alla tabella del [controllo](control-table.md).</span><span class="sxs-lookup"><span data-stu-id="7d992-121">Add a button to the specified dialog box by adding an entry to the [Control table](control-table.md).</span></span>
2.  <span data-ttu-id="7d992-122">Aggiungere un [ControlEvent REINSTALLMODE](reinstallmode-controlevent.md) alla tabella ControlEvent, con i campi finestra di dialogo \_ e controllo che \_ fanno riferimento al controllo Button creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="7d992-122">Add a [ReinstallMode ControlEvent](reinstallmode-controlevent.md) to the ControlEvent table, with the Dialog\_ and Control\_ fields referencing the button control created in step 1.</span></span> <span data-ttu-id="7d992-123">Nel campo argomento immettere una stringa contenente le lettere corrispondenti alle modalità di reinstallazione desiderate. i valori accettabili per questo campo sono identici a quelli accettati per la proprietà [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="7d992-123">In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the [**REINSTALLMODE**](reinstallmode.md) property).</span></span> <span data-ttu-id="7d992-124">Il valore nella colonna Ordering per questo evento deve essere 1.</span><span class="sxs-lookup"><span data-stu-id="7d992-124">The value in the Ordering column for this event should be 1.</span></span>
3.  <span data-ttu-id="7d992-125">Aggiungere un evento [REINSTALL ControlEvent](reinstall-controlevent.md) alla [tabella ControlEvent](controlevent-table.md), facendo nuovamente riferimento allo stesso controllo Button.</span><span class="sxs-lookup"><span data-stu-id="7d992-125">Add a [Reinstall ControlEvent](reinstall-controlevent.md) event to the [ControlEvent table](controlevent-table.md), again referencing the same button control.</span></span> <span data-ttu-id="7d992-126">Il campo argomento per questo evento sarà in genere tutto, per forzare la reinstallazione di tutte le funzionalità, ma qui è possibile inserire il nome di una funzionalità specifica.</span><span class="sxs-lookup"><span data-stu-id="7d992-126">The Argument field for this event will normally be ALL, to force reinstallation of all features, but you can place the name of a specific feature here.</span></span> <span data-ttu-id="7d992-127">Il valore nella colonna Ordering per questo evento deve essere 2.</span><span class="sxs-lookup"><span data-stu-id="7d992-127">The value in the Ordering column for this event should be 2.</span></span>
4.  <span data-ttu-id="7d992-128">Aggiungere un altro evento associato allo stesso controllo Button per avviare effettivamente la reinstallazione.</span><span class="sxs-lookup"><span data-stu-id="7d992-128">Add one more event tied to the same button control, to actually initiate the reinstallation.</span></span> <span data-ttu-id="7d992-129">Può trattarsi di un evento EndDialog (con un argomento di Return).</span><span class="sxs-lookup"><span data-stu-id="7d992-129">This can be an EndDialog event (with an argument of Return).</span></span> <span data-ttu-id="7d992-130">In genere, tuttavia, viene usato un evento NewDialog per passare a una finestra di dialogo di conferma che si **vuole reinstallare?** .</span><span class="sxs-lookup"><span data-stu-id="7d992-130">More typically, however, a NewDialog event would be used here to jump to an **Are you sure you want to reinstall?** confirmation dialog box.</span></span> <span data-ttu-id="7d992-131">Il valore nella colonna Ordering per questo evento deve essere 3.</span><span class="sxs-lookup"><span data-stu-id="7d992-131">The value in the Ordering column for this event should be 3.</span></span>

    <span data-ttu-id="7d992-132">Se lo si desidera, è possibile creare diversi pulsanti di [**Reinstallazione**](reinstall.md) per una singola finestra di dialogo, in modo da consentire all'utente di selezionare il tipo di reinstallazione eseguito.</span><span class="sxs-lookup"><span data-stu-id="7d992-132">If desired, several [**REINSTALL**](reinstall.md) buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed.</span></span> <span data-ttu-id="7d992-133">In questo caso, ogni pulsante viene creato come descritto nella procedura precedente, con un parametro [REINSTALLMODE ControlEvent](reinstallmode-controlevent.md) diverso per ogni pulsante.</span><span class="sxs-lookup"><span data-stu-id="7d992-133">In this case, each button is authored as outlined in the preceding procedure, with a different [ReinstallMode ControlEvent](reinstallmode-controlevent.md) parameter for each button.</span></span>

<span data-ttu-id="7d992-134">Una volta installato un particolare prodotto (con alcune o tutte le funzionalità del prodotto), è possibile eseguire una reinstallazione dalla riga di comando:</span><span class="sxs-lookup"><span data-stu-id="7d992-134">Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed at the command line:</span></span>

<span data-ttu-id="7d992-135">**Per reinstallare un prodotto o una funzionalità da una riga di comando**</span><span class="sxs-lookup"><span data-stu-id="7d992-135">**To reinstall a product or feature from a command line**</span></span>

1.  <span data-ttu-id="7d992-136">Al prompt dei comandi specificare la proprietà [**REINSTALL**](reinstall.md) .</span><span class="sxs-lookup"><span data-stu-id="7d992-136">From the command prompt, specify the [**REINSTALL**](reinstall.md) property.</span></span>
2.  <span data-ttu-id="7d992-137">Al prompt dei comandi specificare la proprietà [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="7d992-137">From the command prompt, specify the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

    <span data-ttu-id="7d992-138">L'impostazione di queste proprietà consente all'utente di reinstallare una o tutte le funzionalità del prodotto.</span><span class="sxs-lookup"><span data-stu-id="7d992-138">Specifying these properties allows the user to reinstall any or all of the product's features.</span></span> <span data-ttu-id="7d992-139">È anche possibile specificare il tipo di reinstallazione.</span><span class="sxs-lookup"><span data-stu-id="7d992-139">The type of reinstallation can also be specified.</span></span> <span data-ttu-id="7d992-140">Ad esempio, è possibile specificare che solo i file completamente mancanti devono essere reinstallati o che solo i file danneggiati, ad esempio file eseguibili il cui checksum non corrisponde al contenuto effettivo del file, vengano sostituiti.</span><span class="sxs-lookup"><span data-stu-id="7d992-140">For example, you can specify that only those files that are completely missing should be reinstalled, or that only corrupt files (for example, any executable file whose checksum does not match the actual file contents) be replaced.</span></span>

 

 



