---
description: Di seguito viene descritto come creare un pacchetto di Windows Installer per installare un assembly Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Installazione degli assembly Win32 per la condivisione side-by-side
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317760"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="72b18-103">Installazione degli assembly Win32 per la condivisione side-by-side</span><span class="sxs-lookup"><span data-stu-id="72b18-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="72b18-104">Di seguito viene descritto come creare un pacchetto di Windows Installer per installare un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="72b18-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="72b18-105">Il pacchetto installa un assembly affiancato nella cartella WinSxS per l'uso condiviso dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="72b18-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="72b18-106">Dopo l'installazione del pacchetto, l'assembly condiviso è disponibile a livello globale per tutte le applicazioni che specificano una dipendenza dall'assembly in un file manifesto dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="72b18-107">Il programma di installazione non registra globalmente l'assembly affiancato nel sistema.</span><span class="sxs-lookup"><span data-stu-id="72b18-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="72b18-108">Si noti che è possibile installare assembly side-by-side condivisi usando i [moduli merge](merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="72b18-109">Prima di continuare è necessario comprendere come creare un pacchetto di Windows Installer senza assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="72b18-110">Per un esempio di come creare un'installazione semplice, vedere [un esempio di installazione](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="72b18-111">**Per installare un assembly condiviso side-by-side**</span><span class="sxs-lookup"><span data-stu-id="72b18-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="72b18-112">Definire un componente Windows Installer che includa l'assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="72b18-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="72b18-113">Questo componente può contenere altre risorse che devono essere sempre installate o rimosse con l'assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="72b18-114">Tutti gli altri componenti dell'applicazione possono essere creati come per un'installazione senza assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="72b18-115">Aggiungere una riga alla [tabella dei componenti](component-table.md) per il componente contenente l'assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="72b18-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="72b18-116">Immettere un [GUID](guid.md) Windows Installer valido per questo codice componente.</span><span class="sxs-lookup"><span data-stu-id="72b18-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="72b18-117">Non usare il file manifesto come percorso della chiave per questo componente.</span><span class="sxs-lookup"><span data-stu-id="72b18-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="72b18-118">Aggiungere una riga alla [tabella FeatureComponents](featurecomponents-table.md) che lega il componente a una funzionalità Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="72b18-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="72b18-119">Per informazioni, vedere [componenti e funzionalità](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="72b18-120">Una funzionalità di Windows Installer deve essere una parte della funzionalità dell'applicazione riconoscibile per un utente.</span><span class="sxs-lookup"><span data-stu-id="72b18-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="72b18-121">L'assembly viene attivato quando questa funzionalità viene selezionata da un utente o con errori in da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="72b18-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="72b18-122">Se l'assembly definisce una funzionalità aggiuntiva, aggiungere una riga aggiuntiva alla [tabella delle funzionalità](feature-table.md) per gli attributi della funzionalità.</span><span class="sxs-lookup"><span data-stu-id="72b18-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="72b18-123">Questo passaggio non è necessario per la creazione di un modulo merge.</span><span class="sxs-lookup"><span data-stu-id="72b18-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="72b18-124">Per gli assembly affiancati, le informazioni sull'associazione e sull'attivazione, come le classi COM, le interfacce e le librerie dei tipi, vengono archiviate in file manifesto invece che nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="72b18-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="72b18-125">Gli assembly condivisi archiviano queste informazioni in un manifesto dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="72b18-126">Nei sistemi che supportano gli assembly affiancati, il programma di installazione ignora l'elaborazione di tutte le informazioni relative al componente immesso nella [tabella di estensione](extension-table.md), nella tabella dei [verbi](verb-table.md), nella [tabella TypeLib](typelib-table.md), nella tabella [MIME](mime-table.md), nella tabella delle [classi](class-table.md), nella [tabella ProgId](progid-table.md)e nella [tabella AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="72b18-127">Le informazioni sul binding e sull'attivazione possono essere immesse in queste tabelle per l'uso da parte di sistemi che non supportano la condivisione di assembly affiancati.</span><span class="sxs-lookup"><span data-stu-id="72b18-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="72b18-128">L'installazione side-by-side non registra l'assembly a livello globale, il programma di installazione ignora la registrazione automatica del componente se sono state immesse eventuali informazioni di registrazione automatica nella [tabella SelfReg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="72b18-129">È possibile immettere le informazioni di registrazione automatica nella tabella SelfReg per la registrazione automatica del componente nei sistemi che non supportano la condivisione di assembly affiancati.</span><span class="sxs-lookup"><span data-stu-id="72b18-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="72b18-130">Aggiungere qualsiasi altra informazione del registro di sistema, esclusa l'associazione e l'attivazione o la registrazione automatica del componente, per la tabella [del registro di sistema](registry-table.md), la [tabella RemoveRegistry](removeregistry-table.md)e la [tabella dell'ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="72b18-131">Poiché si tratta di un assembly condiviso, non viene generato un file. local.</span><span class="sxs-lookup"><span data-stu-id="72b18-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="72b18-132">Non includere informazioni per questo componente nella [tabella IsolatedComponent](isolatedcomponent-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="72b18-133">Il programma di installazione ignora la tabella IsolatedComponent per questo componente nei sistemi operativi che supportano la condivisione side-by-side.</span><span class="sxs-lookup"><span data-stu-id="72b18-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="72b18-134">Aggiungere informazioni alla tabella IsolatedComponent se si desidera che l'assembly sia privato nei sistemi che supportano i file con estensione local.</span><span class="sxs-lookup"><span data-stu-id="72b18-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="72b18-135">Per abilitare la condivisione side-by-Side, è necessario che l'assembly Win32 sia installato nella cartella WinSxS.</span><span class="sxs-lookup"><span data-stu-id="72b18-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="72b18-136">Questa operazione viene eseguita lasciando la \_ colonna applicazione file della [tabella MsiAssembly](msiassembly-table.md) null per l'assembly.</span><span class="sxs-lookup"><span data-stu-id="72b18-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="72b18-137">Indica al programma di installazione di installare l'assembly nella cartella WinSxS, anziché nella cartella del componente.</span><span class="sxs-lookup"><span data-stu-id="72b18-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="72b18-138">Aggiungere una riga alla [tabella MsiAssembly](msiassembly-table.md) per il componente che contiene l'assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="72b18-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="72b18-139">Immettere il valore 1 nel campo attributi della tabella MsiAssembly per specificare che si tratta di un assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="72b18-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="72b18-140">Per un assembly condiviso, lasciare vuoto il \_ campo applicazione file.</span><span class="sxs-lookup"><span data-stu-id="72b18-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="72b18-141">Aggiungere l' [azione MsiPublishAssemblies](msipublishassemblies-action.md) alla tabella [InstallExecuteSequence](installexecutesequence-table.md) o [AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="72b18-142">Aggiungere l' [azione MsiUnpublishAssemblies](msiunpublishassemblies-action.md) alla tabella InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="72b18-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="72b18-143">Aggiungere righe alla [tabella MsiAssemblyName](msiassemblyname-table.md) per il componente.</span><span class="sxs-lookup"><span data-stu-id="72b18-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="72b18-144">Aggiungere una riga per ogni coppia di nome e valore specificata nella sezione assemblyIdentity del manifesto.</span><span class="sxs-lookup"><span data-stu-id="72b18-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="72b18-145">Per un esempio, vedere [tabella MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="72b18-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



