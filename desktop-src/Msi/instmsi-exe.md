---
description: Instmsi.exe è il pacchetto ridistribuibile per l'installazione di Windows Installer&\# 160; 2.0 e le versioni precedenti di Windows Installer. Vedere Windows Installer i ridistribuibili per i ridistribuibili per Windows Installer&\# 160; 3.0 e versioni successive.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317127"
---
# <a name="instmsiexe"></a><span data-ttu-id="1d96a-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="1d96a-104">Instmsi.exe</span></span>

<span data-ttu-id="1d96a-105">Instmsi.exe è il pacchetto ridistribuibile per l'installazione di Windows Installer 2,0 e versioni precedenti di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="1d96a-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="1d96a-106">Vedere [Windows Installer i ridistribuibili](windows-installer-redistributables.md) per i ridistribuibili per Windows Installer 3,0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="1d96a-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="1d96a-107">Per ulteriori informazioni sulla versione del Windows Installer fornita con il sistema operativo, vedere [versioni rilasciate di Windows Installer](released-versions-of-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="1d96a-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="1d96a-108">Alcuni ridistribuibili non devono essere eseguiti in determinate versioni del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="1d96a-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="1d96a-109">La tabella seguente descrive quali Instmsi sono compatibili con il sistema operativo in uso.</span><span class="sxs-lookup"><span data-stu-id="1d96a-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="1d96a-110">Se Instmsi.exe installa questa versione di Windows Installer</span><span class="sxs-lookup"><span data-stu-id="1d96a-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="1d96a-111">Instmsi.exe può essere eseguito in questi sistemi operativi</span><span class="sxs-lookup"><span data-stu-id="1d96a-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="1d96a-112">Instmsi.exe non devono essere eseguiti in questi sistemi operativi</span><span class="sxs-lookup"><span data-stu-id="1d96a-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="1d96a-113">Windows Installer versione 1,0</span><span class="sxs-lookup"><span data-stu-id="1d96a-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="1d96a-114">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="1d96a-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="1d96a-115">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="1d96a-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="1d96a-116">Windows Installer versione 1,1</span><span class="sxs-lookup"><span data-stu-id="1d96a-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="1d96a-117">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="1d96a-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="1d96a-118">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="1d96a-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="1d96a-119">Windows Installer versione 1,2</span><span class="sxs-lookup"><span data-stu-id="1d96a-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="1d96a-120">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="1d96a-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="1d96a-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="1d96a-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="1d96a-122">Windows Installer versione 2,0</span><span class="sxs-lookup"><span data-stu-id="1d96a-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="1d96a-123">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP6, Windows 2000</span><span class="sxs-lookup"><span data-stu-id="1d96a-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="1d96a-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="1d96a-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="1d96a-125">Ad esempio, un'applicazione che ridistribuisce Windows Installer versione 1,1 deve verificare che il sistema operativo sia Windows NT 4,0 SP3 o Windows 98/95 prima di eseguire il pacchetto ridistribuibile.</span><span class="sxs-lookup"><span data-stu-id="1d96a-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="1d96a-126">Le applicazioni che utilizzano il pacchetto ridistribuibile devono inoltre garantire che la versione ANSI del Windows Installer sia installata in Windows 98/95 e che la versione Unicode sia installata in Windows NT o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="1d96a-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="1d96a-127">Si noti che in alcune applicazioni la versione Unicode viene rinominata in InstMsiW.</span><span class="sxs-lookup"><span data-stu-id="1d96a-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="1d96a-128">Sintassi</span><span class="sxs-lookup"><span data-stu-id="1d96a-128">Syntax</span></span>

<span data-ttu-id="1d96a-129"> *Opzioni* di Instmsi</span><span class="sxs-lookup"><span data-stu-id="1d96a-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="1d96a-130">Opzioni da riga di comando</span><span class="sxs-lookup"><span data-stu-id="1d96a-130">Command Line Options</span></span>

<span data-ttu-id="1d96a-131">Le opzioni della riga di comando non fanno distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="1d96a-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="1d96a-132">Opzione</span><span class="sxs-lookup"><span data-stu-id="1d96a-132">Option</span></span>                     | <span data-ttu-id="1d96a-133">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1d96a-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1d96a-134">/q</span><span class="sxs-lookup"><span data-stu-id="1d96a-134">/q</span></span>                         | <span data-ttu-id="1d96a-135">Per l'uso da parte di applicazioni che ridistribuiscono il Windows Installer come parte di un'applicazione di bootstrap.</span><span class="sxs-lookup"><span data-stu-id="1d96a-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="1d96a-136">Non viene visualizzata alcuna interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="1d96a-136">No UI is presented to the user.</span></span> <span data-ttu-id="1d96a-137">L'applicazione di bootstrap deve controllare il codice restituito per determinare se è necessario riavviare il computer per completare l'installazione del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="1d96a-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="1d96a-138">/t</span><span class="sxs-lookup"><span data-stu-id="1d96a-138">/t</span></span>                         | <span data-ttu-id="1d96a-139">Utilizzato solo a scopo di debug.</span><span class="sxs-lookup"><span data-stu-id="1d96a-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="1d96a-140">/c: "msiinst/delayreboot"</span><span class="sxs-lookup"><span data-stu-id="1d96a-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="1d96a-141">Opzione di riavvio ritardato.</span><span class="sxs-lookup"><span data-stu-id="1d96a-141">The delayed reboot option.</span></span> <span data-ttu-id="1d96a-142">Impedisce a Instmsi di richiedere all'utente un riavvio anche se è necessario sostituire i file in uso durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="1d96a-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="1d96a-143">Se Instmsi viene richiamato con questa opzione, viene restituito l'errore \_ \_ reboot riuscito \_ se è necessario sostituire i file in uso.</span><span class="sxs-lookup"><span data-stu-id="1d96a-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="1d96a-144">Se non è necessario sostituire i file in uso, viene restituito l'errore \_ Success.</span><span class="sxs-lookup"><span data-stu-id="1d96a-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="1d96a-145">Disponibile con Instmsi per Windows Installer 2,0 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="1d96a-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="1d96a-146">Per ulteriori informazioni sui riavvii ritardati, vedere la sezione Osservazioni.</span><span class="sxs-lookup"><span data-stu-id="1d96a-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="1d96a-147">/c: "msiinst/delayrebootq"</span><span class="sxs-lookup"><span data-stu-id="1d96a-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="1d96a-148">Versione non interattiva dell'opzione di riavvio ritardato.</span><span class="sxs-lookup"><span data-stu-id="1d96a-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="1d96a-149">Non presenta alcuna interfaccia utente per l'utente.</span><span class="sxs-lookup"><span data-stu-id="1d96a-149">It does not present any UI to the user.</span></span> <span data-ttu-id="1d96a-150">In caso contrario, il comportamento è identico all'opzione precedente.</span><span class="sxs-lookup"><span data-stu-id="1d96a-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="1d96a-151">Disponibile con Instmsi per Windows Installer 2,0 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="1d96a-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="1d96a-152">Per ulteriori informazioni sui riavvii ritardati, vedere la sezione Osservazioni.</span><span class="sxs-lookup"><span data-stu-id="1d96a-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="1d96a-153">/?</span><span class="sxs-lookup"><span data-stu-id="1d96a-153">/?</span></span>                         | <span data-ttu-id="1d96a-154">Visualizza la Guida.</span><span class="sxs-lookup"><span data-stu-id="1d96a-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="1d96a-155">Commenti</span><span class="sxs-lookup"><span data-stu-id="1d96a-155">Remarks</span></span>

<span data-ttu-id="1d96a-156">Le applicazioni di [bootstrap](bootstrapping.md) che usano Instmsi.exe per installare il Windows Installer con un'altra applicazione possono richiedere un riavvio del sistema aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="1d96a-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="1d96a-157">Si tratta potenzialmente di un riavvio aggiuntivo, oltre a tutti i riavvii necessari per installare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1d96a-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="1d96a-158">L'opzione di riavvio ritardato è consigliata solo per gli sviluppatori di installazione che desiderano eliminare un riavvio aggiuntivo causato dall'utilizzo di Instmsi.exe con un'applicazione di installazione che consente di installare i file in uso.</span><span class="sxs-lookup"><span data-stu-id="1d96a-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="1d96a-159">Gli sviluppatori devono eseguire le operazioni seguenti nell'applicazione di installazione per usare l'opzione di riavvio ritardato.</span><span class="sxs-lookup"><span data-stu-id="1d96a-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="1d96a-160">Questa opzione non è disponibile con Instmsi.exe versioni che installano versioni di Windows Installer precedenti alla versione 2,0:</span><span class="sxs-lookup"><span data-stu-id="1d96a-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="1d96a-161">**Per utilizzare l'opzione di riavvio ritardato**</span><span class="sxs-lookup"><span data-stu-id="1d96a-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="1d96a-162">Chiamare Instmsi.exe con una delle opzioni della riga di comando per il riavvio ritardato.</span><span class="sxs-lookup"><span data-stu-id="1d96a-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="1d96a-163">Considerare la restituzione di esito positivo errore \_ o errore \_ \_ riavvio riuscito \_ , necessario come operazione riuscita.</span><span class="sxs-lookup"><span data-stu-id="1d96a-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="1d96a-164">Ottenere il percorso della cartella che contiene i file binari di Windows Installer appena installati dal valore InstallerLocation in:</span><span class="sxs-lookup"><span data-stu-id="1d96a-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="1d96a-165">**HKEY \_ Software del \_ computer locale** \\  \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **Installer**</span><span class="sxs-lookup"><span data-stu-id="1d96a-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="1d96a-166">Questo valore è di tipo **reg \_ SZ**.</span><span class="sxs-lookup"><span data-stu-id="1d96a-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="1d96a-167">Impostare la directory corrente sul percorso ottenuto nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="1d96a-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="1d96a-168">Richiamare msiexec sul pacchetto dell'applicazione ed eseguire altro codice di installazione specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1d96a-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="1d96a-169">Se l'applicazione di installazione usa [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), l'applicazione deve caricare MSI.DLL dal percorso ottenuto nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="1d96a-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="1d96a-170">Le applicazioni che chiamano **LoadLibrary** sul nuovo MSI.DLL nella posizione ottenuta nel passaggio 3 devono garantire che una versione precedente di MSI.DLL non sia già stata caricata nel processo.</span><span class="sxs-lookup"><span data-stu-id="1d96a-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="1d96a-171">Se nel processo è stata caricata una versione precedente di MSI.DLL, è necessario scaricarla dallo spazio degli indirizzi del processo prima della chiamata a **LoadLibrary** per la nuova MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="1d96a-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="1d96a-172">Se il passaggio (5) non richiede un riavvio e se Instmsi.exe ha restituito un \_ errore \_ \_ nel passaggio (1), richiedere all'utente di riavviare il computer per completare l'installazione dei file binari Windows Installer nel sistema.</span><span class="sxs-lookup"><span data-stu-id="1d96a-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="1d96a-173">Tuttavia, se si verifica un riavvio nel passaggio (5), non sono necessari passaggi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="1d96a-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="1d96a-174">Instmsi.exe è disponibile nei [componenti Windows SDK per Windows Installer sviluppatori](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="1d96a-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1d96a-175">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1d96a-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1d96a-176">Bootstrap</span><span class="sxs-lookup"><span data-stu-id="1d96a-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="1d96a-177">Bootstrap di download Internet</span><span class="sxs-lookup"><span data-stu-id="1d96a-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="1d96a-178">Versioni rilasciate, strumenti e ridistribuibili</span><span class="sxs-lookup"><span data-stu-id="1d96a-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="1d96a-179">Strumenti di sviluppo Windows Installer</span><span class="sxs-lookup"><span data-stu-id="1d96a-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




