---
description: Le azioni personalizzate vengono pianificate in tabelle di sequenza in modo analogo alle azioni standard.
ms.assetid: 1aea75b1-a498-405e-9208-91672455496b
title: Sequenziazione di azioni personalizzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad7c24fb91247a36880cb808c9b8e10437312cf7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104234021"
---
# <a name="sequencing-custom-actions"></a><span data-ttu-id="88587-103">Sequenziazione di azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="88587-103">Sequencing Custom Actions</span></span>

<span data-ttu-id="88587-104">Le azioni personalizzate vengono pianificate in tabelle di sequenza in modo analogo alle azioni standard.</span><span class="sxs-lookup"><span data-stu-id="88587-104">Custom actions are scheduled in sequence tables in the same way as standard actions.</span></span>

<span data-ttu-id="88587-105">**Per pianificare un'azione personalizzata in una tabella di sequenza**</span><span class="sxs-lookup"><span data-stu-id="88587-105">**To schedule a custom action in a sequence table**</span></span>

1.  <span data-ttu-id="88587-106">Immettere il nome dell'azione personalizzata, ovvero la chiave primaria della tabella [CustomAction](customaction-table.md), nella colonna azione della tabella di [sequenza](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-106">Enter the custom action name (which is the primary key of the [CustomAction](customaction-table.md)) table into the Action column of the [Sequence](sequence-table-detailed-example.md) table.</span></span>
2.  <span data-ttu-id="88587-107">Immettere la sequenza dell'azione personalizzata relativa alle altre azioni nella tabella nella colonna sequenza della tabella di [sequenza](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-107">Enter the custom action's sequence relative to the other actions in the table into the Sequence column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="88587-108">Per ulteriori informazioni sulle tabelle di sequenza, vedere [utilizzo di una tabella di sequenza](using-a-sequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="88587-108">For more information about sequence tables, see [Using a Sequence Table](using-a-sequence-table.md).</span></span>
3.  <span data-ttu-id="88587-109">Per ignorare l'azione in modo condizionale, immettere un'espressione condizionale nella colonna condizione della tabella di [sequenza](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-109">To conditionally skip the action, enter a conditional expression into the Condition column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="88587-110">Il programma di installazione ignora questa azione se l'espressione restituisce FALSE.</span><span class="sxs-lookup"><span data-stu-id="88587-110">The installer skips this action if the expression evaluates to FALSE.</span></span>

<span data-ttu-id="88587-111">Come nel caso di azioni standard, le azioni personalizzate pianificate in [InstallUISequence](installuisequence-table.md) o [AdminUISequence](adminuisequence-table.md) vengono eseguite solo se l'interfaccia utente interna è impostata sul livello completo.</span><span class="sxs-lookup"><span data-stu-id="88587-111">As in the case of standard actions, custom actions that are scheduled in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence](adminuisequence-table.md) run only if the internal user interface is set to the full level.</span></span> <span data-ttu-id="88587-112">Il livello dell'interfaccia utente viene impostato tramite la funzione [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .</span><span class="sxs-lookup"><span data-stu-id="88587-112">The UI level is set by using the [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) function.</span></span>

<span data-ttu-id="88587-113">Le azioni standard e personalizzate pianificate nelle tabelle [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md)o [AdvtExecuteSequence](advtexecutesequence-table.md) non apportano modifiche al sistema.</span><span class="sxs-lookup"><span data-stu-id="88587-113">Standard and custom actions scheduled in the [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md), or [AdvtExecuteSequence](advtexecutesequence-table.md) tables do not make system changes.</span></span> <span data-ttu-id="88587-114">Al contrario, il programma di installazione accoda i record di esecuzione in uno script per l'esecuzione successiva durante il servizio di installazione.</span><span class="sxs-lookup"><span data-stu-id="88587-114">Instead the installer queues up execution records in a script for subsequent execution during the install service.</span></span> <span data-ttu-id="88587-115">Se non è presente alcun servizio di installazione, le azioni pianificate in queste tabelle vengono eseguite nello stesso contesto della sequenza dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="88587-115">If there is no install service, then the actions scheduled in these tables are run in the same context as the UI sequence.</span></span>

<span data-ttu-id="88587-116">Se il server del programma di installazione non è registrato, le azioni personalizzate vengono eseguite sul lato client.</span><span class="sxs-lookup"><span data-stu-id="88587-116">If the installer server is not registered, the custom actions are executed on the client side.</span></span> <span data-ttu-id="88587-117">Se il server è registrato e si utilizza la modalità di interfaccia utente completa, le azioni personalizzate vengono eseguite sul lato server.</span><span class="sxs-lookup"><span data-stu-id="88587-117">If the server is registered and using the full UI mode, then the custom actions are run on the server side.</span></span>

<span data-ttu-id="88587-118">Se si usa l'interfaccia utente completa con il server, le azioni iniziali prima dell'azione [InstallValidate](installvalidate-action.md) vengono eseguite sul client per consentire l'interazione completa.</span><span class="sxs-lookup"><span data-stu-id="88587-118">If using full UI with the server, the initial actions prior to the [InstallValidate](installvalidate-action.md) action are run on the client to allow full interaction.</span></span> <span data-ttu-id="88587-119">L'esecuzione viene quindi cambiata nel server che ripete tali azioni ed esegue le azioni di esecuzione dello script.</span><span class="sxs-lookup"><span data-stu-id="88587-119">Execution is then switched to the server which repeats those actions and runs the script execution actions.</span></span> <span data-ttu-id="88587-120">Questa operazione è seguita da un ritorno al client per le azioni finali.</span><span class="sxs-lookup"><span data-stu-id="88587-120">This is followed by a return to the client for the final actions.</span></span>

<span data-ttu-id="88587-121">Si noti che se un prodotto viene rimosso impostando la funzionalità principale su assente, la proprietà [**Remove**](remove.md) potrebbe non essere uguale a All fino a dopo l'azione [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-121">Note that if a product is removed by setting its top feature to absent, the [**REMOVE**](remove.md) property may not equal ALL until after the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="88587-122">Ciò significa che qualsiasi azione personalizzata che dipende da REMOVE = ALL deve essere sequenziata dopo l'azione InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="88587-122">This means that any custom action that depends on REMOVE=ALL must be sequenced after the InstallValidate action.</span></span> <span data-ttu-id="88587-123">Un'azione personalizzata può selezionare Rimuovi per determinare se un prodotto è stato impostato per la disinstallazione completa.</span><span class="sxs-lookup"><span data-stu-id="88587-123">A custom action may check REMOVE to determine whether a product has been set to be completely uninstalled.</span></span>

<span data-ttu-id="88587-124">Le azioni personalizzate che fanno riferimento a un file installato come origine, ad esempio il tipo di azione personalizzata 17 (DLL), il tipo di azione personalizzata 18 (EXE), il tipo di azione personalizzata 21 (JScript) e il tipo di azione personalizzata 22 (VBScript), devono rispettare le restrizioni di sequenziazione seguenti.</span><span class="sxs-lookup"><span data-stu-id="88587-124">Custom actions that reference an installed file as their source, such as Custom Action Type 17 (DLL), Custom Action Type 18 (EXE), Custom Action Type 21 (JScript), and Custom Action Type 22 (VBScript), must adhere to the following sequencing restrictions.</span></span>

-   <span data-ttu-id="88587-125">L'azione personalizzata deve essere sequenziata dopo l'azione [CostFinalize secondo](costfinalize-action.md) in modo che sia possibile risolvere il percorso del file a cui si fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="88587-125">The custom action must be sequenced after the [CostFinalize](costfinalize-action.md) action so that the path to the referenced file can be resolved.</span></span>
-   <span data-ttu-id="88587-126">Se il file di origine non è già installato nel computer, le azioni personalizzate posticipate (in-script) devono essere sequenziate dopo [InstallFiles](installfiles-action.md).</span><span class="sxs-lookup"><span data-stu-id="88587-126">If the source file is not already installed on the computer, deferred (in-script) custom actions must be sequenced after the [InstallFiles](installfiles-action.md).</span></span>
-   <span data-ttu-id="88587-127">Se il file di origine non è già installato nel computer, le azioni personalizzate nondeferred devono essere sequenziate dopo l'azione [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-127">If the source file is not already installed on the computer, nondeferred custom actions must be sequenced after the [InstallInitialize](installinitialize-action.md) action.</span></span>

<span data-ttu-id="88587-128">Le restrizioni di sequenziazione seguenti si applicano alle azioni personalizzate che modificano o aggiornano un pacchetto di Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="88587-128">The following sequencing restrictions apply to custom actions that change or update a Windows Installer package.</span></span>

-   <span data-ttu-id="88587-129">Se l'azione personalizzata modifica il pacchetto, ad esempio aggiungendo righe a una tabella, l'azione deve essere sequenziata prima dell'azione [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-129">If the custom action changes the package, such as by adding rows to a table, the action must be sequenced before the [InstallInitialize](installinitialize-action.md) action.</span></span>
-   <span data-ttu-id="88587-130">Se l'azione personalizzata apporta modifiche che potrebbero influire sui costi, sarà necessario sequenziarla prima dell'azione [CostInitialize](costfinalize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-130">If the custom action makes changes that would affect costing, then it should be sequenced before the [CostInitialize](costfinalize-action.md) action.</span></span>
-   <span data-ttu-id="88587-131">Se l'azione personalizzata modifica lo stato di installazione delle funzionalità o dei componenti, deve essere sequenziata prima dell'azione [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="88587-131">If the custom action changes the installation state of features or components, it must be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span>

 

 



