---
description: Questo materiale è destinato agli sviluppatori che scrivono programmi di installazione e sviluppatori che desiderano ottenere altre informazioni sulle tabelle del database del programma di installazione. Per informazioni generali sul programma di installazione, vedere informazioni su Windows Installer.
ms.assetid: 95516437-9708-4f4e-a5c2-7bcd4741c776
title: Funzioni di database
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4a4233437d24944c8bb7fe5c7de6412e700022b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103752799"
---
# <a name="database-functions"></a><span data-ttu-id="12a30-104">Funzioni di database</span><span class="sxs-lookup"><span data-stu-id="12a30-104">Database Functions</span></span>

<span data-ttu-id="12a30-105">Questo materiale è destinato agli sviluppatori che scrivono programmi di installazione e sviluppatori che desiderano ottenere altre informazioni sulle tabelle del database del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-105">This material is intended for developers who are writing their own setup programs and developers who want to learn more about the installer database tables.</span></span> <span data-ttu-id="12a30-106">Per informazioni generali sul programma di installazione, vedere [informazioni su Windows Installer](about-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="12a30-106">For general information on the installer, see [About Windows Installer](about-windows-installer.md).</span></span>

<span data-ttu-id="12a30-107">È possibile utilizzare le funzioni di accesso del programma di installazione per accedere al database e al processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-107">You can use the installer access functions to access the database and the installation process.</span></span> <span data-ttu-id="12a30-108">Queste funzioni devono essere utilizzate solo da azioni di installazione personalizzate e strumenti di creazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-108">These functions should only be used by custom installation actions and authoring tools.</span></span> <span data-ttu-id="12a30-109">Alcune funzioni di accesso del programma di installazione richiedono stringhe di query SQL per eseguire query sul database.</span><span class="sxs-lookup"><span data-stu-id="12a30-109">Some of the installer access functions require SQL query strings for querying the database.</span></span> <span data-ttu-id="12a30-110">Le query devono rispettare la [sintassi SQL](sql-syntax.md)del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-110">Queries must adhere to the installer [SQL syntax](sql-syntax.md).</span></span>

<span data-ttu-id="12a30-111">Questo argomento elenca le funzioni di accesso al database del programma di installazione per categoria.</span><span class="sxs-lookup"><span data-stu-id="12a30-111">This topic lists the installer database access functions by category.</span></span>

## <a name="general-database-access-functions"></a><span data-ttu-id="12a30-112">Funzioni di accesso al database generali</span><span class="sxs-lookup"><span data-stu-id="12a30-112">General Database Access Functions</span></span>



| <span data-ttu-id="12a30-113">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-113">Function</span></span>                                                             | <span data-ttu-id="12a30-114">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-114">Description</span></span>                                                                             |
|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="12a30-115">**MsiDatabaseCommit**</span><span class="sxs-lookup"><span data-stu-id="12a30-115">**MsiDatabaseCommit**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)                       | <span data-ttu-id="12a30-116">Consente di eseguire il commit delle modifiche in un database.</span><span class="sxs-lookup"><span data-stu-id="12a30-116">Commits changes to a database.</span></span>                                                          |
| [<span data-ttu-id="12a30-117">**MsiDatabaseGetPrimaryKeys**</span><span class="sxs-lookup"><span data-stu-id="12a30-117">**MsiDatabaseGetPrimaryKeys**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegetprimarykeysa)       | <span data-ttu-id="12a30-118">Restituisce i nomi di tutte le colonne chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="12a30-118">Returns the names of all the primary key columns.</span></span>                                       |
| [<span data-ttu-id="12a30-119">**MsiDatabaseIsTablePersistent**</span><span class="sxs-lookup"><span data-stu-id="12a30-119">**MsiDatabaseIsTablePersistent**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseistablepersistenta) | <span data-ttu-id="12a30-120">Restituisce un'enumerazione che descrive lo stato di una tabella.</span><span class="sxs-lookup"><span data-stu-id="12a30-120">Returns an enumeration describing the state of a table.</span></span>                                 |
| [<span data-ttu-id="12a30-121">**MsiDatabaseOpenView**</span><span class="sxs-lookup"><span data-stu-id="12a30-121">**MsiDatabaseOpenView**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa)                   | <span data-ttu-id="12a30-122">Prepara una query di database e crea un oggetto visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-122">Prepares a database query and creates a view object.</span></span>                                    |
| [<span data-ttu-id="12a30-123">**Funzione MsiGetActiveDatabase**</span><span class="sxs-lookup"><span data-stu-id="12a30-123">**MsiGetActiveDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetactivedatabase)                 | <span data-ttu-id="12a30-124">Restituisce il database attivo per l'installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-124">Returns the active database for the installation.</span></span>                                       |
| [<span data-ttu-id="12a30-125">**MsiViewGetColumnInfo**</span><span class="sxs-lookup"><span data-stu-id="12a30-125">**MsiViewGetColumnInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgetcolumninfo)                 | <span data-ttu-id="12a30-126">Restituisce i nomi o le definizioni delle colonne.</span><span class="sxs-lookup"><span data-stu-id="12a30-126">Returns column names or definitions.</span></span>                                                    |
| [<span data-ttu-id="12a30-127">**MsiOpenDatabase**</span><span class="sxs-lookup"><span data-stu-id="12a30-127">**MsiOpenDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea)                           | <span data-ttu-id="12a30-128">Apre un file di database per l'accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="12a30-128">Opens a database file for data access.</span></span>                                                  |
| [<span data-ttu-id="12a30-129">**MsiViewClose**</span><span class="sxs-lookup"><span data-stu-id="12a30-129">**MsiViewClose**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewclose)                                 | <span data-ttu-id="12a30-130">Rilascia il set di risultati per una visualizzazione eseguita.</span><span class="sxs-lookup"><span data-stu-id="12a30-130">Releases the result set for an executed view.</span></span>                                           |
| [<span data-ttu-id="12a30-131">**MsiViewExecute**</span><span class="sxs-lookup"><span data-stu-id="12a30-131">**MsiViewExecute**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute)                             | <span data-ttu-id="12a30-132">Esegue la query di visualizzazione e fornisce i parametri richiesti.</span><span class="sxs-lookup"><span data-stu-id="12a30-132">Executes the view query and supplies required parameters.</span></span>                               |
| [<span data-ttu-id="12a30-133">**MsiViewFetch**</span><span class="sxs-lookup"><span data-stu-id="12a30-133">**MsiViewFetch**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewfetch)                                 | <span data-ttu-id="12a30-134">Recupera il record sequenziale successivo dalla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-134">Fetches the next sequential record from the view.</span></span>                                       |
| [<span data-ttu-id="12a30-135">**MsiViewGetError**</span><span class="sxs-lookup"><span data-stu-id="12a30-135">**MsiViewGetError**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora)                           | <span data-ttu-id="12a30-136">Restituisce l'errore che si è verificato nella funzione [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) .</span><span class="sxs-lookup"><span data-stu-id="12a30-136">Returns the error that occurred in the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function.</span></span> |
| [<span data-ttu-id="12a30-137">**MsiViewModify**</span><span class="sxs-lookup"><span data-stu-id="12a30-137">**MsiViewModify**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify)                               | <span data-ttu-id="12a30-138">Aggiorna un record recuperato.</span><span class="sxs-lookup"><span data-stu-id="12a30-138">Updates a fetched record.</span></span>                                                               |



 

## <a name="database-management-functions"></a><span data-ttu-id="12a30-139">Funzioni di gestione di database</span><span class="sxs-lookup"><span data-stu-id="12a30-139">Database Management Functions</span></span>



| <span data-ttu-id="12a30-140">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-140">Function</span></span>                                                               | <span data-ttu-id="12a30-141">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-141">Description</span></span>                                                      |
|------------------------------------------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="12a30-142">**MsiCreateTransformSummaryInfo**</span><span class="sxs-lookup"><span data-stu-id="12a30-142">**MsiCreateTransformSummaryInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa) | <span data-ttu-id="12a30-143">Crea informazioni di riepilogo per una trasformazione esistente.</span><span class="sxs-lookup"><span data-stu-id="12a30-143">Creates summary information for an existing transform.</span></span>           |
| [<span data-ttu-id="12a30-144">**MsiDatabaseApplyTransform**</span><span class="sxs-lookup"><span data-stu-id="12a30-144">**MsiDatabaseApplyTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma)         | <span data-ttu-id="12a30-145">Applica una trasformazione a un database.</span><span class="sxs-lookup"><span data-stu-id="12a30-145">Applies a transform to a database.</span></span>                               |
| [<span data-ttu-id="12a30-146">**MsiDatabaseExport**</span><span class="sxs-lookup"><span data-stu-id="12a30-146">**MsiDatabaseExport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta)                         | <span data-ttu-id="12a30-147">Esporta una tabella da un database aperto in un file di archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="12a30-147">Exports a table from an open database to a text archive file.</span></span>    |
| [<span data-ttu-id="12a30-148">**MsiDatabaseGenerateTransform**</span><span class="sxs-lookup"><span data-stu-id="12a30-148">**MsiDatabaseGenerateTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma)   | <span data-ttu-id="12a30-149">Genera un file di trasformazione di differenze tra due database.</span><span class="sxs-lookup"><span data-stu-id="12a30-149">Generates a transform file of differences between two databases.</span></span> |
| [<span data-ttu-id="12a30-150">**MsiDatabaseImport**</span><span class="sxs-lookup"><span data-stu-id="12a30-150">**MsiDatabaseImport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)                         | <span data-ttu-id="12a30-151">Importa una tabella di archivio di testo del programma di installazione in un database aperto.</span><span class="sxs-lookup"><span data-stu-id="12a30-151">Imports an installer text archive table into an open database.</span></span>   |
| [<span data-ttu-id="12a30-152">**MsiDatabaseMerge**</span><span class="sxs-lookup"><span data-stu-id="12a30-152">**MsiDatabaseMerge**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea)                           | <span data-ttu-id="12a30-153">Unisce due database.</span><span class="sxs-lookup"><span data-stu-id="12a30-153">Merges two databases together.</span></span>                                   |
| [<span data-ttu-id="12a30-154">**MsiGetDatabaseState**</span><span class="sxs-lookup"><span data-stu-id="12a30-154">**MsiGetDatabaseState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate)                     | <span data-ttu-id="12a30-155">Restituisce lo stato del database.</span><span class="sxs-lookup"><span data-stu-id="12a30-155">Returns the state of the database.</span></span>                               |



 

## <a name="record-processing-functions"></a><span data-ttu-id="12a30-156">Funzioni di elaborazione dei record</span><span class="sxs-lookup"><span data-stu-id="12a30-156">Record Processing Functions</span></span>



| <span data-ttu-id="12a30-157">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-157">Function</span></span>                                                 | <span data-ttu-id="12a30-158">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-158">Description</span></span>                                                     |
|----------------------------------------------------------|-----------------------------------------------------------------|
| [<span data-ttu-id="12a30-159">**MsiCreateRecord**</span><span class="sxs-lookup"><span data-stu-id="12a30-159">**MsiCreateRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreaterecord)               | <span data-ttu-id="12a30-160">Crea un nuovo oggetto record con il numero di campi specificato.</span><span class="sxs-lookup"><span data-stu-id="12a30-160">Creates new record object with specified number of fields.</span></span>      |
| [<span data-ttu-id="12a30-161">**MsiFormatRecord**</span><span class="sxs-lookup"><span data-stu-id="12a30-161">**MsiFormatRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda)               | <span data-ttu-id="12a30-162">Formatta i dati e le proprietà dei campi del record utilizzando una stringa di formato.</span><span class="sxs-lookup"><span data-stu-id="12a30-162">Formats record field data and properties using a format string.</span></span> |
| [<span data-ttu-id="12a30-163">**MsiRecordClearData**</span><span class="sxs-lookup"><span data-stu-id="12a30-163">**MsiRecordClearData**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordcleardata)         | <span data-ttu-id="12a30-164">Imposta su null tutti i campi di un record.</span><span class="sxs-lookup"><span data-stu-id="12a30-164">Sets all fields in a record to null.</span></span>                            |
| [<span data-ttu-id="12a30-165">**MsiRecordDataSize**</span><span class="sxs-lookup"><span data-stu-id="12a30-165">**MsiRecordDataSize**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecorddatasize)           | <span data-ttu-id="12a30-166">Restituisce la lunghezza di un campo di record.</span><span class="sxs-lookup"><span data-stu-id="12a30-166">Returns the length of a record field.</span></span>                           |
| [<span data-ttu-id="12a30-167">**MsiRecordGetFieldCount**</span><span class="sxs-lookup"><span data-stu-id="12a30-167">**MsiRecordGetFieldCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetfieldcount) | <span data-ttu-id="12a30-168">Restituisce il numero di campi in un record.</span><span class="sxs-lookup"><span data-stu-id="12a30-168">Returns the number of fields in a record.</span></span>                       |
| [<span data-ttu-id="12a30-169">**MsiRecordGetInteger**</span><span class="sxs-lookup"><span data-stu-id="12a30-169">**MsiRecordGetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetinteger)       | <span data-ttu-id="12a30-170">Restituisce il valore intero da un campo di record.</span><span class="sxs-lookup"><span data-stu-id="12a30-170">Returns the integer value from a record field.</span></span>                  |
| [<span data-ttu-id="12a30-171">**MsiRecordGetString**</span><span class="sxs-lookup"><span data-stu-id="12a30-171">**MsiRecordGetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetstringa)         | <span data-ttu-id="12a30-172">Restituisce il valore stringa di un campo di record.</span><span class="sxs-lookup"><span data-stu-id="12a30-172">Returns the string value of a record field.</span></span>                     |
| [<span data-ttu-id="12a30-173">**MsiRecordIsNull**</span><span class="sxs-lookup"><span data-stu-id="12a30-173">**MsiRecordIsNull**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordisnull)               | <span data-ttu-id="12a30-174">Indica se un campo di record è null.</span><span class="sxs-lookup"><span data-stu-id="12a30-174">Reports whether a record field is null.</span></span>                         |
| [<span data-ttu-id="12a30-175">**MsiRecordReadStream**</span><span class="sxs-lookup"><span data-stu-id="12a30-175">**MsiRecordReadStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream)       | <span data-ttu-id="12a30-176">Legge i byte da un campo del flusso di record in un buffer.</span><span class="sxs-lookup"><span data-stu-id="12a30-176">Reads bytes from a record stream field into a buffer.</span></span>           |
| [<span data-ttu-id="12a30-177">**MsiRecordSetInteger**</span><span class="sxs-lookup"><span data-stu-id="12a30-177">**MsiRecordSetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetinteger)       | <span data-ttu-id="12a30-178">Imposta un campo di record in un campo integer.</span><span class="sxs-lookup"><span data-stu-id="12a30-178">Sets a record field to an integer field.</span></span>                        |
| [<span data-ttu-id="12a30-179">**MsiRecordSetStream**</span><span class="sxs-lookup"><span data-stu-id="12a30-179">**MsiRecordSetStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama)         | <span data-ttu-id="12a30-180">Imposta un campo del flusso di record da un file.</span><span class="sxs-lookup"><span data-stu-id="12a30-180">Sets a record stream field from a file.</span></span>                         |
| [<span data-ttu-id="12a30-181">**MsiRecordSetString**</span><span class="sxs-lookup"><span data-stu-id="12a30-181">**MsiRecordSetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa)         | <span data-ttu-id="12a30-182">Copia una stringa nel campo designato.</span><span class="sxs-lookup"><span data-stu-id="12a30-182">Copies a string into the designated field.</span></span>                      |



 

## <a name="summary-information-property-functions"></a><span data-ttu-id="12a30-183">Funzioni di proprietà delle informazioni di riepilogo</span><span class="sxs-lookup"><span data-stu-id="12a30-183">Summary Information Property Functions</span></span>



| <span data-ttu-id="12a30-184">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-184">Function</span></span>                                                                 | <span data-ttu-id="12a30-185">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-185">Description</span></span>                                                            |
|--------------------------------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="12a30-186">**MsiGetSummaryInformation**</span><span class="sxs-lookup"><span data-stu-id="12a30-186">**MsiGetSummaryInformation**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsummaryinformationa)             | <span data-ttu-id="12a30-187">Ottiene l'handle per il flusso di informazioni di riepilogo del database del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-187">Obtains handle to summary information stream of installer database.</span></span>    |
| [<span data-ttu-id="12a30-188">**MsiSummaryInfoGetProperty**</span><span class="sxs-lookup"><span data-stu-id="12a30-188">**MsiSummaryInfoGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertya)           | <span data-ttu-id="12a30-189">Ottiene una singola proprietà dalle informazioni di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="12a30-189">Gets a single property from the summary information.</span></span>                   |
| [<span data-ttu-id="12a30-190">**MsiSummaryInfoGetPropertyCount**</span><span class="sxs-lookup"><span data-stu-id="12a30-190">**MsiSummaryInfoGetPropertyCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertycount) | <span data-ttu-id="12a30-191">Restituisce il numero di proprietà nel flusso di informazioni di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="12a30-191">Returns number of properties in the summary information stream.</span></span>        |
| [<span data-ttu-id="12a30-192">**MsiSummaryInfoPersist**</span><span class="sxs-lookup"><span data-stu-id="12a30-192">**MsiSummaryInfoPersist**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfopersist)                   | <span data-ttu-id="12a30-193">Scrive le informazioni di riepilogo modificate nel flusso di informazioni di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="12a30-193">Writes changed summary information back to summary information stream.</span></span> |
| [<span data-ttu-id="12a30-194">**MsiSummaryInfoSetProperty**</span><span class="sxs-lookup"><span data-stu-id="12a30-194">**MsiSummaryInfoSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfosetpropertya)           | <span data-ttu-id="12a30-195">Imposta una singola proprietà di informazioni di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="12a30-195">Sets a single summary information property.</span></span>                            |



 

## <a name="installer-state-access-functions"></a><span data-ttu-id="12a30-196">Funzioni di accesso allo stato del programma di installazione</span><span class="sxs-lookup"><span data-stu-id="12a30-196">Installer State Access Functions</span></span>



| <span data-ttu-id="12a30-197">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-197">Function</span></span>                                               | <span data-ttu-id="12a30-198">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-198">Description</span></span>                                                 |
|--------------------------------------------------------|-------------------------------------------------------------|
| [<span data-ttu-id="12a30-199">**MsiGetLanguage**</span><span class="sxs-lookup"><span data-stu-id="12a30-199">**MsiGetLanguage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage)               | <span data-ttu-id="12a30-200">Restituisce la lingua numerica dell'installazione corrente.</span><span class="sxs-lookup"><span data-stu-id="12a30-200">Returns the numeric language of the current installation.</span></span>   |
| [<span data-ttu-id="12a30-201">**MsiGetLastErrorRecord**</span><span class="sxs-lookup"><span data-stu-id="12a30-201">**MsiGetLastErrorRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlasterrorrecord) | <span data-ttu-id="12a30-202">Restituisce il record degli errori restituito per l'ultima volta per il processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="12a30-202">Returns error record last returned for the calling process.</span></span> |
| [<span data-ttu-id="12a30-203">**MsiGetMode**</span><span class="sxs-lookup"><span data-stu-id="12a30-203">**MsiGetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode)                       | <span data-ttu-id="12a30-204">Restituisce uno degli Stati di installazione interni booleani.</span><span class="sxs-lookup"><span data-stu-id="12a30-204">Returns one of the Boolean internal installation states.</span></span>    |
| [<span data-ttu-id="12a30-205">**MsiGetProperty**</span><span class="sxs-lookup"><span data-stu-id="12a30-205">**MsiGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya)               | <span data-ttu-id="12a30-206">Ottiene il valore di una proprietà del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-206">Gets the value of an installer property.</span></span>                    |
| [<span data-ttu-id="12a30-207">**MsiSetProperty**</span><span class="sxs-lookup"><span data-stu-id="12a30-207">**MsiSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetpropertya)               | <span data-ttu-id="12a30-208">Imposta il valore di una proprietà di installazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-208">Sets the value of an installation property.</span></span>                 |
| [<span data-ttu-id="12a30-209">**MsiSetMode**</span><span class="sxs-lookup"><span data-stu-id="12a30-209">**MsiSetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode)                       | <span data-ttu-id="12a30-210">Imposta uno stato booleano del motore interno.</span><span class="sxs-lookup"><span data-stu-id="12a30-210">Sets an internal engine Boolean state.</span></span>                      |



 

## <a name="installer-action-functions"></a><span data-ttu-id="12a30-211">Funzioni di azione del programma di installazione</span><span class="sxs-lookup"><span data-stu-id="12a30-211">Installer Action Functions</span></span>



| <span data-ttu-id="12a30-212">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-212">Function</span></span>                                             | <span data-ttu-id="12a30-213">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-213">Description</span></span>                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------|
| [<span data-ttu-id="12a30-214">**MsiDoAction**</span><span class="sxs-lookup"><span data-stu-id="12a30-214">**MsiDoAction**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona)                   | <span data-ttu-id="12a30-215">Esegue un'azione predefinita, un'azione personalizzata o un'azione guidata dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="12a30-215">Executes built-in action, custom action, or user-interface wizard action.</span></span> |
| [<span data-ttu-id="12a30-216">**MsiEvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="12a30-216">**MsiEvaluateCondition**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona) | <span data-ttu-id="12a30-217">Valuta un'espressione condizionale contenente i nomi e i valori delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="12a30-217">Evaluates a conditional expression containing property names and values.</span></span>  |
| [<span data-ttu-id="12a30-218">**MsiProcessMessage**</span><span class="sxs-lookup"><span data-stu-id="12a30-218">**MsiProcessMessage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)       | <span data-ttu-id="12a30-219">Invia un record di errore al programma di installazione per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="12a30-219">Sends an error record to the installer for processing.</span></span>                    |
| [<span data-ttu-id="12a30-220">**MsiSequence**</span><span class="sxs-lookup"><span data-stu-id="12a30-220">**MsiSequence**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisequencea)                   | <span data-ttu-id="12a30-221">Esegue una sequenza di azioni.</span><span class="sxs-lookup"><span data-stu-id="12a30-221">Executes an action sequence.</span></span>                                              |



 

## <a name="installer-location-functions"></a><span data-ttu-id="12a30-222">Funzioni del percorso del programma di installazione</span><span class="sxs-lookup"><span data-stu-id="12a30-222">Installer Location Functions</span></span>



| <span data-ttu-id="12a30-223">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-223">Function</span></span>                                     | <span data-ttu-id="12a30-224">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-224">Description</span></span>                                                       |
|----------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="12a30-225">**MsiGetSourcePath**</span><span class="sxs-lookup"><span data-stu-id="12a30-225">**MsiGetSourcePath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsourcepatha) | <span data-ttu-id="12a30-226">Restituisce il percorso di origine completo per una cartella nella tabella directory.</span><span class="sxs-lookup"><span data-stu-id="12a30-226">Returns the full source path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="12a30-227">**MsiGetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="12a30-227">**MsiGetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigettargetpatha) | <span data-ttu-id="12a30-228">Restituisce il percorso di destinazione completo per una cartella nella tabella directory.</span><span class="sxs-lookup"><span data-stu-id="12a30-228">Returns the full target path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="12a30-229">**MsiSetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="12a30-229">**MsiSetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) | <span data-ttu-id="12a30-230">Imposta il percorso di destinazione completo per una cartella nella tabella directory.</span><span class="sxs-lookup"><span data-stu-id="12a30-230">Sets the full target path for a folder in the Directory table.</span></span>    |



 

## <a name="installer-selection-functions"></a><span data-ttu-id="12a30-231">Funzioni di selezione del programma di installazione</span><span class="sxs-lookup"><span data-stu-id="12a30-231">Installer Selection Functions</span></span>



| <span data-ttu-id="12a30-232">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-232">Function</span></span>                                                     | <span data-ttu-id="12a30-233">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-233">Description</span></span>                                                          |
|--------------------------------------------------------------|----------------------------------------------------------------------|
| [<span data-ttu-id="12a30-234">**MsiEnumComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="12a30-234">**MsiEnumComponentCosts**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienumcomponentcostsa)       | <span data-ttu-id="12a30-235">Enumera lo spazio su disco richiesto per l'installazione di un componente.</span><span class="sxs-lookup"><span data-stu-id="12a30-235">Enumerates the disk-space per drive required to install a component.</span></span> |
| [<span data-ttu-id="12a30-236">**MsiGetComponentState**</span><span class="sxs-lookup"><span data-stu-id="12a30-236">**MsiGetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetcomponentstatea)         | <span data-ttu-id="12a30-237">Ottiene lo stato di un componente.</span><span class="sxs-lookup"><span data-stu-id="12a30-237">Obtains the state of a component.</span></span>                                    |
| [<span data-ttu-id="12a30-238">**MsiGetFeatureCost**</span><span class="sxs-lookup"><span data-stu-id="12a30-238">**MsiGetFeatureCost**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturecosta)               | <span data-ttu-id="12a30-239">Restituisce lo spazio su disco richiesto da una funzionalità.</span><span class="sxs-lookup"><span data-stu-id="12a30-239">Returns the disk space required by a feature.</span></span>                        |
| [<span data-ttu-id="12a30-240">**MsiGetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="12a30-240">**MsiGetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturestatea)             | <span data-ttu-id="12a30-241">Ottiene lo stato di una funzionalità.</span><span class="sxs-lookup"><span data-stu-id="12a30-241">Gets the state of a feature.</span></span>                                         |
| [<span data-ttu-id="12a30-242">**MsiGetFeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="12a30-242">**MsiGetFeatureValidStates**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturevalidstatesa) | <span data-ttu-id="12a30-243">Restituisce uno stato di installazione valido.</span><span class="sxs-lookup"><span data-stu-id="12a30-243">Returns a valid installation state.</span></span>                                  |
| [<span data-ttu-id="12a30-244">**MsiSetComponentState**</span><span class="sxs-lookup"><span data-stu-id="12a30-244">**MsiSetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetcomponentstatea)         | <span data-ttu-id="12a30-245">Imposta un componente sullo stato specificato.</span><span class="sxs-lookup"><span data-stu-id="12a30-245">Sets a component to the specified state.</span></span>                             |
| [<span data-ttu-id="12a30-246">**MsiSetFeatureAttributes**</span><span class="sxs-lookup"><span data-stu-id="12a30-246">**MsiSetFeatureAttributes**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeatureattributesa)   | <span data-ttu-id="12a30-247">Modifica gli attributi predefiniti di una funzionalità in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="12a30-247">Modifies the default attributes of a feature at run time.</span></span>            |
| [<span data-ttu-id="12a30-248">**MsiSetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="12a30-248">**MsiSetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeaturestatea)             | <span data-ttu-id="12a30-249">Imposta una funzionalità sullo stato specificato.</span><span class="sxs-lookup"><span data-stu-id="12a30-249">Sets a feature to a specified state.</span></span>                                 |
| [<span data-ttu-id="12a30-250">**MsiSetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="12a30-250">**MsiSetInstallLevel**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetinstalllevel)             | <span data-ttu-id="12a30-251">Imposta il livello di installazione di un'installazione completa del prodotto.</span><span class="sxs-lookup"><span data-stu-id="12a30-251">Sets the installation level of a full product installation.</span></span>          |
| [<span data-ttu-id="12a30-252">**MsiVerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="12a30-252">**MsiVerifyDiskSpace**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiverifydiskspace)             | <span data-ttu-id="12a30-253">Verifica la presenza di spazio su disco sufficiente.</span><span class="sxs-lookup"><span data-stu-id="12a30-253">Checks for sufficient disk space.</span></span>                                    |



 

## <a name="user-interface-functions"></a><span data-ttu-id="12a30-254">Funzioni dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="12a30-254">User Interface Functions</span></span>



| <span data-ttu-id="12a30-255">Funzione</span><span class="sxs-lookup"><span data-stu-id="12a30-255">Function</span></span>                                           | <span data-ttu-id="12a30-256">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12a30-256">Description</span></span>                                                             |
|----------------------------------------------------|-------------------------------------------------------------------------|
| [<span data-ttu-id="12a30-257">**MsiEnableUIPreview**</span><span class="sxs-lookup"><span data-stu-id="12a30-257">**MsiEnableUIPreview**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview)   | <span data-ttu-id="12a30-258">Abilita la modalità di anteprima dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="12a30-258">Enables preview mode of the user interface.</span></span>                             |
| [<span data-ttu-id="12a30-259">**MsiPreviewBillboard**</span><span class="sxs-lookup"><span data-stu-id="12a30-259">**MsiPreviewBillboard**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewbillboarda) | <span data-ttu-id="12a30-260">Visualizza un tabellone con il controllo host nella finestra di dialogo visualizzata.</span><span class="sxs-lookup"><span data-stu-id="12a30-260">Displays a billboard with the host control in the displayed dialog box.</span></span> |
| [<span data-ttu-id="12a30-261">**MsiPreviewDialog**</span><span class="sxs-lookup"><span data-stu-id="12a30-261">**MsiPreviewDialog**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewdialoga)       | <span data-ttu-id="12a30-262">Visualizza una finestra di dialogo non modale e inattiva.</span><span class="sxs-lookup"><span data-stu-id="12a30-262">Displays a dialog box as modeless and inactive.</span></span>                         |



 

<span data-ttu-id="12a30-263">Tutte le funzioni supportano le chiamate ANSI e Unicode.</span><span class="sxs-lookup"><span data-stu-id="12a30-263">All functions support both ANSI and Unicode calls.</span></span> <span data-ttu-id="12a30-264">Per usare queste funzioni, includere MsiQuery. h e il collegamento con MSI. lib.</span><span class="sxs-lookup"><span data-stu-id="12a30-264">To use these functions, include MsiQuery.h and link with Msi.lib.</span></span>

## <a name="installation-functions"></a><span data-ttu-id="12a30-265">Funzioni di installazione</span><span class="sxs-lookup"><span data-stu-id="12a30-265">Installation Functions</span></span>

<span data-ttu-id="12a30-266">Oltre alle funzioni di accesso al database elencate in precedenza, è possibile creare un pacchetto di installazione per un'applicazione usando le funzioni del programma di installazione elencate nella sezione riferimento per le funzioni del [programma di installazione](installer-function-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="12a30-266">In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the [Installer Function Reference](installer-function-reference.md) section.</span></span>

 

 



