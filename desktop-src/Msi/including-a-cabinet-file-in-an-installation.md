---
description: In questa sezione vengono descritti i file CAB inclusi nelle installazioni di. Per altre informazioni, vedere uso di cabinet e origini compresse.
ms.assetid: 17ea7f76-90b2-48fb-8187-64dc6d294443
title: Inclusione di un file CAB in un'installazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 098e660de3f7ec7097ab02613d75219ac0a0d624
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310974"
---
# <a name="including-a-cabinet-file-in-an-installation"></a><span data-ttu-id="bb9a4-104">Inclusione di un file CAB in un'installazione</span><span class="sxs-lookup"><span data-stu-id="bb9a4-104">Including a Cabinet File in an Installation</span></span>

<span data-ttu-id="bb9a4-105">In questa sezione vengono descritti i file CAB inclusi nelle installazioni di.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-105">This section describes including cabinet files in installations.</span></span> <span data-ttu-id="bb9a4-106">Per altre informazioni, vedere [uso di cabinet e origini compresse](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-106">For more information, see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>

<span data-ttu-id="bb9a4-107">**Per includere un file CAB in un pacchetto di installazione**</span><span class="sxs-lookup"><span data-stu-id="bb9a4-107">**To include a cabinet file in a installation package**</span></span>

1.  <span data-ttu-id="bb9a4-108">Usare uno strumento di creazione del cabinet per comprimere i file di origine in un file CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-108">Use a cabinet creation tool to compress the source files into a cabinet file.</span></span> <span data-ttu-id="bb9a4-109">Vedere [file CAB](cabinet-files.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-109">See [Cabinet Files](cabinet-files.md).</span></span>
2.  <span data-ttu-id="bb9a4-110">Il file CAB deve trovarsi in un flusso di dati all'interno del file con estensione msi o in un file CAB separato che si trova nella radice dell'albero di origine specificato dalla [tabella di directory](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-110">The cabinet file must either be located in a data stream inside the .msi file or in a separate cabinet file located at the root of the source tree specified by the [Directory Table](directory-table.md).</span></span>
3.  <span data-ttu-id="bb9a4-111">Determinare se l'origine deve essere un tipo compresso o un tipo misto con file sia non compressi che compressi.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-111">Determine whether the source is to be a compressed type or a mixed type that has both uncompressed and compressed files.</span></span> <span data-ttu-id="bb9a4-112">Vedere [origini compresse e non compresse](compressed-and-uncompressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-112">See [Compressed and Uncompressed Sources](compressed-and-uncompressed-sources.md).</span></span> <span data-ttu-id="bb9a4-113">A seconda del tipo di immagine di origine, impostare i bit di flag compressi o non compressi della proprietà [**riepilogo Conteggio parole**](word-count-summary.md) .</span><span class="sxs-lookup"><span data-stu-id="bb9a4-113">Depending on the type of source image, set the compressed or uncompressed flag bits of the [**Word Count Summary**](word-count-summary.md) Property.</span></span>
4.  <span data-ttu-id="bb9a4-114">Aggiungere un record alla [tabella file](file-table.md) per ogni file nel file CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-114">Add a record to the [File table](file-table.md) for each of the files in the cabinet.</span></span> <span data-ttu-id="bb9a4-115">Immettere una chiave file nella colonna file che corrisponde esattamente alla chiave del file nel file CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-115">Enter a file key in the File column that exactly matches the file key of the file in the cabinet.</span></span> <span data-ttu-id="bb9a4-116">Le chiavi del file fanno distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-116">The file keys are case-sensitive.</span></span> <span data-ttu-id="bb9a4-117">Anche la sequenza di installazione dei file nella tabella file e nel file CAB deve essere la stessa.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-117">The file installation sequence in the File table and the cabinet must also be the same.</span></span> <span data-ttu-id="bb9a4-118">La sequenza di file è specificata dal numero di sequenza nella colonna sequenza.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-118">The file sequence is specified by the sequence number in the Sequence column.</span></span> <span data-ttu-id="bb9a4-119">Per arrivare al numero di sequenza del primo file nell'archivio, effettuare le operazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-119">To arrive at the sequence number for the first file in the cabinet, do the following.</span></span> <span data-ttu-id="bb9a4-120">Trovare il record esistente nella [tabella dei supporti](media-table.md) con il valore massimo nella colonna DiskID.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-120">Find the existing record in the [Media table](media-table.md) having the greatest value in the DiskID column.</span></span> <span data-ttu-id="bb9a4-121">Il campo LastSequence di questo record restituisce l'ultimo numero di sequenza del file utilizzato nei supporti.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-121">The LastSequence field of this record gives the last file sequence number used on the media.</span></span> <span data-ttu-id="bb9a4-122">Nella tabella file assegnare il primo file del nuovo file CAB a un numero di sequenza maggiore di questo.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-122">In the File table, assign the first file of the new cabinet a sequence number that is greater than this.</span></span> <span data-ttu-id="bb9a4-123">Assegnare i numeri di sequenza a tutti i file rimanenti nello stesso ordine in cui si trovi nel file CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-123">Assign sequence numbers to all of the remaining files in the same order as in the cabinet file.</span></span> <span data-ttu-id="bb9a4-124">Per una descrizione dei campi record rimanenti, vedere [tabella file](file-table.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-124">For a description of the remaining record fields, see [File table](file-table.md).</span></span>
5.  <span data-ttu-id="bb9a4-125">Aggiungere un record alla [tabella dei supporti](media-table.md) per il file CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-125">Add a record to the [Media table](media-table.md) for the cabinet.</span></span> <span data-ttu-id="bb9a4-126">Specificare un valore nel campo DiskID del nuovo record che è maggiore del valore DiskID più grande già esistente nella tabella.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-126">Specify a value in the DiskID field of this new record that is greater than the largest DiskID value already existing in the table.</span></span> <span data-ttu-id="bb9a4-127">Inserire il nome del file CAB nel campo CAB.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-127">Put the name of the cabinet into the Cabinet field.</span></span> <span data-ttu-id="bb9a4-128">Il nome deve essere nel formato di un tipo di dati [CAB](cabinet.md) .</span><span class="sxs-lookup"><span data-stu-id="bb9a4-128">This name must be in the form of a [Cabinet](cabinet.md) data type.</span></span> <span data-ttu-id="bb9a4-129">Anteporre il prefisso al nome con il simbolo di cancelletto " \# " se l'archivio è un flusso di dati archiviato nel file con estensione msi.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-129">Prefix the name with a number sign "\#" if the cabinet is a data stream stored in the .msi file.</span></span> <span data-ttu-id="bb9a4-130">Si noti che se l'archivio è un flusso di dati, il nome del cabinet fa distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-130">Note that if the cabinet is a data stream, the name of the cabinet is case-sensitive.</span></span> <span data-ttu-id="bb9a4-131">Se il file CAB è un file separato, il nome del file non fa distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-131">If the cabinet is a separate file, the name of the file is not case-sensitive.</span></span>
6.  <span data-ttu-id="bb9a4-132">Determinare il numero di sequenza di file più grande nel nuovo file CAB controllando la colonna sequenza della tabella file aggiornata.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-132">Determine the greatest file sequence number in the new cabinet by checking the Sequence column of the updated File table.</span></span> <span data-ttu-id="bb9a4-133">Immettere un valore maggiore di questo nel campo LastSequence del nuovo record della tabella dei supporti.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-133">Enter a value that is greater than this into the LastSequence field of the new record of the Media table.</span></span> <span data-ttu-id="bb9a4-134">Per una descrizione dei campi record rimanenti, vedere la [tabella media](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-134">For a description of the remaining record fields, see [Media table](media-table.md).</span></span>
7.  <span data-ttu-id="bb9a4-135">È possibile archiviare il file CAB nel pacchetto di installazione usando uno strumento come Msidb.exe o usando le [funzioni di database](database-functions.md)del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-135">You can store the cabinet file in the installation package either by using a tool such as Msidb.exe or by using the installer's [Database Functions](database-functions.md).</span></span> <span data-ttu-id="bb9a4-136">I quattro passaggi seguenti illustrano come aggiungere il file CAB da un programma usando le funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-136">The following four steps explain how to add the cabinet from a program by using the database functions.</span></span>
8.  <span data-ttu-id="bb9a4-137">Per aggiungere il file CAB al pacchetto di installazione da un programma, aprire una vista nella [ \_ tabella dei flussi](-streams-table.md) del database usando [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-137">To add the cabinet to the installation package from a program open a view on the [\_Streams table](-streams-table.md) of the database using [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span></span>
9.  <span data-ttu-id="bb9a4-138">Usare [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) per impostare la colonna Name della \_ tabella streams sul nome visualizzato nella colonna CAB della [tabella media](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="bb9a4-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) to set the Name column of the \_Streams table to the name appearing in the Cabinet column of the [Media table](media-table.md).</span></span> <span data-ttu-id="bb9a4-139">Omettere il simbolo di cancelletto: \# .</span><span class="sxs-lookup"><span data-stu-id="bb9a4-139">Omit the number sign: \#.</span></span>
10. <span data-ttu-id="bb9a4-140">Utilizzare [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) per impostare la colonna di dati della \_ tabella dei flussi sui dati dell'archivio.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) to set the Data column of the \_Streams table to the cabinet's data.</span></span>
11. <span data-ttu-id="bb9a4-141">Usare [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) per aggiornare il record nella \_ tabella dei flussi.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) to update the record in the \_Streams table.</span></span>
12. <span data-ttu-id="bb9a4-142">Per utilizzare Msidb.exe per aggiungere il file CAB Mycab.cab al pacchetto di installazione denominato Mydatabase.msi, utilizzare la seguente riga di comando: Msidb.exe-d mydatabase.msi-a mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-142">To use Msidb.exe to add the cabinet file Mycab.cab to the installation package named Mydatabase.msi, use the following command line: Msidb.exe -d mydatabase.msi -a mycab.cab.</span></span> <span data-ttu-id="bb9a4-143">In questo caso, la colonna CAB della tabella media deve contenere la stringa: \#mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="bb9a4-143">In this case, the Cabinet column of the Media table should contain the string: \#mycab.cab.</span></span>

 

 



