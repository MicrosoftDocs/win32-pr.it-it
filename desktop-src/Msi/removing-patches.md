---
description: A partire da Windows Installer&\# 160; versione&\# 160; 3.0, è possibile creare e installare patch che possono essere disinstallate singolarmente e in qualsiasi ordine senza dover disinstallare e reinstallare l'intera applicazione e altre patch.
ms.assetid: 2ad30ac9-eac9-49cf-98ae-5c053a0b500a
title: Rimozione di patch
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7cd54db3bde3a356a0c3adb299555248bbc87a0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106313800"
---
# <a name="removing-patches"></a><span data-ttu-id="d722e-103">Rimozione di patch</span><span class="sxs-lookup"><span data-stu-id="d722e-103">Removing Patches</span></span>

<span data-ttu-id="d722e-104">A partire da Windows Installer versione 3,0, è possibile creare e installare patch che possono essere disinstallate singolarmente e in qualsiasi ordine senza dover disinstallare e reinstallare l'intera applicazione e altre patch.</span><span class="sxs-lookup"><span data-stu-id="d722e-104">Beginning with Windows Installer version 3.0, it is possible to create and install patches that can be uninstalled singly, and in any order, without having to uninstall and reinstall the entire application and other patches.</span></span> <span data-ttu-id="d722e-105">Windows Installer 3,0 consente inoltre di creare [pacchetti di patch](patch-packages.md) con una [tabella MsiPatchSequence](msipatchsequence-table.md) che contiene informazioni di sequenziazione delle patch.</span><span class="sxs-lookup"><span data-stu-id="d722e-105">Windows Installer 3.0 also enables [Patch Packages](patch-packages.md) to be authored with a [MsiPatchSequence Table](msipatchsequence-table.md) that contains patch sequencing information.</span></span> <span data-ttu-id="d722e-106">Con le versioni di Windows Installer precedenti alla Windows Installer 3,0, l'unico metodo per rimuovere determinate patch da un'applicazione consiste nel disinstallare l'intera applicazione con patch e quindi reinstallare senza riapplicare le patch rimosse.</span><span class="sxs-lookup"><span data-stu-id="d722e-106">With versions of Windows Installer earlier than Windows Installer 3.0, the only method to remove particular patches from an application is to uninstall the entire patched application and then reinstall without reapplying any patches being removed.</span></span>

<span data-ttu-id="d722e-107">Il fatto che una patch possa essere disinstallata dipende dalla modalità di creazione della patch, dalla versione di Windows Installer usata per installare la patch e dalle modifiche apportate dalla patch all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d722e-107">Whether a patch can be uninstalled depends upon how the patch was authored, the version of Windows Installer used to install the patch, and the changes made by the patch to the application.</span></span> <span data-ttu-id="d722e-108">Se una patch non è disinstallabile, l'unico modo per rimuovere la patch è disinstallare l'intera applicazione e reinstallare senza applicare la patch da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="d722e-108">If a patch is not uninstallable, then the only way to remove the patch is to uninstall the entire application and reinstall without applying the patch being removed.</span></span>

<span data-ttu-id="d722e-109">È possibile disinstallare una o più patch usando un'opzione della riga di comando, l'interfaccia di scripting o chiamando [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) da un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="d722e-109">You can uninstall one or more patches using a command line option, the scripting interface, or by calling [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) from another application.</span></span> <span data-ttu-id="d722e-110">Per ulteriori informazioni su come disinstallare le patch, vedere [Disinstallazione delle patch](uninstalling-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="d722e-110">See [Uninstalling Patches](uninstalling-patches.md) for more information about how to uninstall patches.</span></span>

<span data-ttu-id="d722e-111">Il valore della proprietà [**MSIPATCHREMOVE**](msipatchremove.md) elenca le patch da disinstallare.</span><span class="sxs-lookup"><span data-stu-id="d722e-111">The value of the [**MSIPATCHREMOVE**](msipatchremove.md) property lists the patches to be uninstalled.</span></span> <span data-ttu-id="d722e-112">Per ogni patch nell'elenco, il programma di installazione verifica che la patch sia disinstallabile.</span><span class="sxs-lookup"><span data-stu-id="d722e-112">For each patch in the list, the installer verifies that the patch is uninstallable.</span></span> <span data-ttu-id="d722e-113">Se l'utente non dispone dei privilegi necessari per rimuovere la patch, la patch non è nota per il prodotto, il criterio patch impedisce la rimozione o la patch è stata contrassegnata come non disinstallabile, il programma di installazione restituisce un errore che indica una transazione di installazione non riuscita.</span><span class="sxs-lookup"><span data-stu-id="d722e-113">If the user does not have privileges to remove the patch, the patch is unknown for the product, patch policy prevents removal, or the patch was marked as not uninstallable, the installer returns an error that indicates a failed installation transaction.</span></span> <span data-ttu-id="d722e-114">Per ulteriori informazioni su come determinare se una patch non è disinstallabile, vedere [patch disinstallabili](uninstallable-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="d722e-114">See [Uninstallable Patches](uninstallable-patches.md) for more information about what determines whether a patch is not uninstallable.</span></span>

<span data-ttu-id="d722e-115">Quando la patch viene verificata come rimovibile, il programma di installazione rimuove la patch dalla sequenza dell'applicazione patch.</span><span class="sxs-lookup"><span data-stu-id="d722e-115">Once the patch is verified as removable, the installer removes the patch from the patch application sequence.</span></span> <span data-ttu-id="d722e-116">Per ulteriori informazioni su come Windows Installer 3,0 determina quale sequenza utilizzare quando si applicano le patch, vedere [sequenziazione delle patch](sequencing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="d722e-116">For more information about how Windows Installer 3.0 determines what sequence to use when applying patches see [Sequencing Patches](sequencing-patches.md).</span></span> <span data-ttu-id="d722e-117">Si noti che la rimozione di patch dalla sequenza può causare l'attivazione delle patch contrassegnate come obsolete o sostituite.</span><span class="sxs-lookup"><span data-stu-id="d722e-117">Note that removing patches from the sequence can cause patches marked obsolete or superseded to become active.</span></span>

<span data-ttu-id="d722e-118">Tutte le patch selezionate per la rimozione sono elencate nella proprietà [**MsiPatchRemovalList**](msipatchremovallist.md) .</span><span class="sxs-lookup"><span data-stu-id="d722e-118">All patches selected for removal are listed in the [**MsiPatchRemovalList**](msipatchremovallist.md) property.</span></span> <span data-ttu-id="d722e-119">Questa proprietà è una proprietà privata impostata dal programma di installazione e può essere utilizzata nelle espressioni condizionali o sottoposta a query da [azioni personalizzate](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="d722e-119">This property is a private property that is set by the installer and can be used in conditional expressions or queried by [custom actions](custom-actions.md).</span></span> <span data-ttu-id="d722e-120">La proprietà contiene l'elenco dei GUID di codice delle patch da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="d722e-120">The property contains the list of patch code GUIDs of patches to be removed.</span></span> <span data-ttu-id="d722e-121">Un'azione personalizzata può determinare se lo stato di installazione della patch è applicato, obsoleto o sostituito chiamando il [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) o la proprietà [**PatchProperty**](patch-patchproperty.md) dell' [oggetto patch](patch-object.md).</span><span class="sxs-lookup"><span data-stu-id="d722e-121">A custom action can determine whether the installation state of the patch is applied, obsolete or superseded by calling the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) or the [**PatchProperty**](patch-patchproperty.md) property of the [Patch Object](patch-object.md).</span></span>

<span data-ttu-id="d722e-122">Dopo la rimozione di una patch, lo stato dell'applicazione è identico a quello in cui la patch non è mai stata installata.</span><span class="sxs-lookup"><span data-stu-id="d722e-122">After a patch is removed the state of the application is the same as if the patch was never installed.</span></span> <span data-ttu-id="d722e-123">Se possibile, il programma di installazione limita il processo al subset di funzionalità interessate dalla patch da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="d722e-123">If possible, the installer restricts the process to the subset of features affected by the patch being removed.</span></span> <span data-ttu-id="d722e-124">Il programma di installazione imposta automaticamente la proprietà [**REINSTALL**](reinstall.md) sull'elenco delle funzionalità interessate.</span><span class="sxs-lookup"><span data-stu-id="d722e-124">The installer automatically sets the [**REINSTALL**](reinstall.md) property to the list of affected features.</span></span> <span data-ttu-id="d722e-125">I file aggiunti dalla patch vengono rimossi e i file modificati dalla patch vengono sovrascritti.</span><span class="sxs-lookup"><span data-stu-id="d722e-125">Files that were added by the patch are removed and files that were modified by the patch are overwritten.</span></span> <span data-ttu-id="d722e-126">I file e le voci del registro di sistema vengono ripristinati nella versione prevista dal prodotto meno la patch.</span><span class="sxs-lookup"><span data-stu-id="d722e-126">Files and registry entries are restored to the version expected by the product minus the patch.</span></span> <span data-ttu-id="d722e-127">La registrazione delle funzionalità e dei componenti aggiunti dalla patch viene annullata dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d722e-127">Features and components that were added by the patch are unregistered from the application.</span></span> <span data-ttu-id="d722e-128">Si noti che il contenuto aggiuntivo aggiunto dalla patch può rimanere nel computer dell'utente se il contenuto viene usato da un'altra patch ancora applicabile.</span><span class="sxs-lookup"><span data-stu-id="d722e-128">Note that additional content added by the patch can remain on the user's computer if the content is used by another patch that is still applicable.</span></span>

<span data-ttu-id="d722e-129">Se un file di un componente condiviso viene aggiornato da una patch, la modifica avrà effetto su tutte le applicazioni che condividono il componente.</span><span class="sxs-lookup"><span data-stu-id="d722e-129">If a file of a shared component is updated by a patch, the change affects all applications that share the component.</span></span> <span data-ttu-id="d722e-130">Quando la patch viene rimossa, la modifica ha effetto su tutte le applicazioni che condividono il componente.</span><span class="sxs-lookup"><span data-stu-id="d722e-130">When the patch is removed, again, the change affects all applications that share the component.</span></span> <span data-ttu-id="d722e-131">Ciò significa che la rimozione di una patch da parte di un'applicazione può ripristinare il file del componente condiviso a una versione precedente rispetto a quella richiesta da un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="d722e-131">This means that removal of a patch by one application can restore the file of the shared component to a lower version than required by another application.</span></span> <span data-ttu-id="d722e-132">Questa operazione potrebbe risolvere la prima applicazione, ma la seconda applicazione smette di funzionare.</span><span class="sxs-lookup"><span data-stu-id="d722e-132">This could fix the first application, but cause the second application to stop working.</span></span> <span data-ttu-id="d722e-133">In questo caso, la seconda applicazione può essere ripristinata reinstallando la seconda applicazione usando i metodi descritti in [reinstallazione di una funzionalità o di un'applicazione](reinstalling-a-feature-or-application.md).</span><span class="sxs-lookup"><span data-stu-id="d722e-133">In this case, the second application can be repaired by reinstalling the second application using the methods describe in [Reinstalling a Feature or Application](reinstalling-a-feature-or-application.md).</span></span> <span data-ttu-id="d722e-134">Verrà ripristinata la versione con patch del file.</span><span class="sxs-lookup"><span data-stu-id="d722e-134">This will restore the patched version of the file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d722e-135">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d722e-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d722e-136">**MsiEnumapplicationsEx**</span><span class="sxs-lookup"><span data-stu-id="d722e-136">**MsiEnumapplicationsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[<span data-ttu-id="d722e-137">**MsiGetPatchInfoEx**</span><span class="sxs-lookup"><span data-stu-id="d722e-137">**MsiGetPatchInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[<span data-ttu-id="d722e-138">**MSIPATCHREMOVE**</span><span class="sxs-lookup"><span data-stu-id="d722e-138">**MSIPATCHREMOVE**</span></span>](msipatchremove.md)
</dt> <dt>

[<span data-ttu-id="d722e-139">**MsiRemovePatches**</span><span class="sxs-lookup"><span data-stu-id="d722e-139">**MsiRemovePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> <dt>

[<span data-ttu-id="d722e-140">Sequenza di patch</span><span class="sxs-lookup"><span data-stu-id="d722e-140">Patch Sequencing</span></span>](sequencing-patches.md)
</dt> <dt>

[<span data-ttu-id="d722e-141">Patch disinstallare azioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="d722e-141">Patch Uninstall Custom Actions</span></span>](patch-uninstall-custom-actions.md)
</dt> <dt>

[<span data-ttu-id="d722e-142">Patch disinstallabili</span><span class="sxs-lookup"><span data-stu-id="d722e-142">Uninstallable Patches</span></span>](uninstallable-patches.md)
</dt> <dt>

[<span data-ttu-id="d722e-143">Disinstallazione di patch</span><span class="sxs-lookup"><span data-stu-id="d722e-143">Uninstalling Patches</span></span>](uninstalling-patches.md)
</dt> </dl>

 

 



