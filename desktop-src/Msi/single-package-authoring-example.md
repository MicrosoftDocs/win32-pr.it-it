---
description: Il PUASample.msi di esempio è un esempio di un pacchetto a doppio scopo Windows Installer 5,0 che è in grado di essere installato nel contesto di installazione per utente o per computer in Windows Server 2008 R2 e Windows 7.
ms.assetid: be018e8a-ca5f-4135-a019-970ec4173f23
title: Esempio di creazione di pacchetti singoli
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0ed56b8d7aaf8793416ba3ecab24c1f2a48ffe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314775"
---
# <a name="single-package-authoring-example"></a><span data-ttu-id="8cad3-103">Esempio di creazione di pacchetti singoli</span><span class="sxs-lookup"><span data-stu-id="8cad3-103">Single Package Authoring Example</span></span>

<span data-ttu-id="8cad3-104">Il PUASample.msi di esempio è un esempio di un pacchetto a doppio scopo Windows Installer 5,0 che è in grado di essere installato nel [contesto di installazione](installation-context.md) per utente o per computer in windows Server 2008 R2 e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8cad3-104">The sample PUASample.msi is an example of a dual-purpose Windows Installer 5.0 package that is capable of being installed in either the per-user or per-machine [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="8cad3-105">Questo pacchetto di esempio segue le linee guida di sviluppo descritte in [creazione di pacchetti singoli](single-package-authoring.md).</span><span class="sxs-lookup"><span data-stu-id="8cad3-105">This sample package follows the development guidelines described in [Single Package Authoring](single-package-authoring.md).</span></span>

## <a name="obtaining-a-copy-of-the-sample"></a><span data-ttu-id="8cad3-106">Acquisizione di una copia dell'esempio</span><span class="sxs-lookup"><span data-stu-id="8cad3-106">Obtaining a copy of the sample</span></span>

<span data-ttu-id="8cad3-107">Una copia di questo esempio e un Windows Installer editor di tabelle di database, Orca.exe, si trovano nei [componenti Windows SDK per gli sviluppatori Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="8cad3-107">A copy of this sample and a Windows Installer database table editor, Orca.exe, are in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="8cad3-108">L'editor di esempio e di tabella è fornito con Windows Software Development Kit per Windows Server 2008 R2 e Windows 7 come file di installazione Windows Installer PUASample1.msi e Orca.msi.</span><span class="sxs-lookup"><span data-stu-id="8cad3-108">The sample and table editor are provided with the Windows Software Development Kit for Windows Server 2008 R2 and Windows 7 as the Windows Installer installation files PUASample1.msi and Orca.msi.</span></span>

## <a name="system-requirements"></a><span data-ttu-id="8cad3-109">Requisiti di sistema</span><span class="sxs-lookup"><span data-stu-id="8cad3-109">System Requirements</span></span>

<span data-ttu-id="8cad3-110">Per l'editor di database, [Orca.exe](orca-exe.md), sono necessari windows Server 2008 R2 e versioni precedenti e Windows 7 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-110">The database editor, [Orca.exe](orca-exe.md), requires Windows Server 2008 R2 and earlier and Windows 7 and earlier.</span></span> <span data-ttu-id="8cad3-111">Il pacchetto a doppio scopo, PUASample1.msi, può essere installato nel [contesto di installazione](installation-context.md) per computer o per utente in windows Server 2008 R2 e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8cad3-111">The dual-purpose package, PUASample1.msi, can be installed in either the per-machine or per-user [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="8cad3-112">PUASample1.msi può essere installato solo nel contesto per computer in Windows Server 2008 e versioni precedenti e in Windows Vista e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-112">PUASample1.msi can be installed only in the per-machine context on Windows Server 2008 and earlier and Windows Vista and earlier.</span></span> <span data-ttu-id="8cad3-113">È possibile installare l'editor di database per esaminare il contenuto di PUASample1.msi senza installare l'esempio.</span><span class="sxs-lookup"><span data-stu-id="8cad3-113">You can install the database editor to examine the contents of PUASample1.msi without installing the sample.</span></span> <span data-ttu-id="8cad3-114">Per installare i pacchetti di esempio o dell'editor, verificare che il criterio [DisableMSI](disablemsi.md) non sia impostato su un valore che blocca le installazioni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-114">To install the sample or editor packages, ensure that the [DisableMSI](disablemsi.md) policy is not set to a value that blocks application installations.</span></span>

## <a name="identifying-a-dual-purpose-package"></a><span data-ttu-id="8cad3-115">Identificazione di un pacchetto di Dual-Purpose</span><span class="sxs-lookup"><span data-stu-id="8cad3-115">Identifying a Dual-Purpose Package</span></span>

<span data-ttu-id="8cad3-116">I pacchetti a doppio scopo devono inizializzare il valore della proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) su 1.</span><span class="sxs-lookup"><span data-stu-id="8cad3-116">Dual-purpose packages should initialize the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1.</span></span> <span data-ttu-id="8cad3-117">Identifica il pacchetto in modo che sia in grado di essere installato nel contesto per computer o per utente in Windows Server 2008 R2 e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8cad3-117">This identifies the package as capable of being installed in either the per-machine or per-user context on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="8cad3-118">Impostare la proprietà **MSIINSTALLPERUSER** nel pacchetto solo se è stata scritta seguendo le linee guida per lo sviluppo descritte in [creazione di pacchetti singoli](single-package-authoring.md) e se si desidera fornire agli utenti l'opzione per installare il pacchetto nel contesto per utente o per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-118">Set the **MSIINSTALLPERUSER** property in the package only if it has been written following the development guidelines described in [Single Package Authoring](single-package-authoring.md) and if you intend to provide users with the option to install the package in either the per-user or per-machine context.</span></span> <span data-ttu-id="8cad3-119">Un pacchetto a doppio scopo deve anche inizializzare il valore della proprietà [**ALLUSERS**](allusers.md) su 2.</span><span class="sxs-lookup"><span data-stu-id="8cad3-119">A dual-purpose package should also initialize the value of the [**ALLUSERS**](allusers.md) property to 2.</span></span> <span data-ttu-id="8cad3-120">In questo modo viene specificato per utente come contesto di installazione predefinito per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-120">This specifies per-user as the default installation context for the application.</span></span> <span data-ttu-id="8cad3-121">Se il valore della proprietà **ALLUSERS** è un valore diverso da 2, Windows Installer ignora la proprietà **MSIINSTALLPERUSER** .</span><span class="sxs-lookup"><span data-stu-id="8cad3-121">If the value of the **ALLUSERS** property is any value other than 2, Windows Installer ignores the **MSIINSTALLPERUSER** property.</span></span>

<span data-ttu-id="8cad3-122">Per esaminare il contenuto dei PUASample1.msi, utilizzare un editor di database Windows Installer, ad esempio [Orca.exe](orca-exe.md).</span><span class="sxs-lookup"><span data-stu-id="8cad3-122">Use a Windows Installer database editor, such as [Orca.exe](orca-exe.md), to examine the contents of PUASample1.msi.</span></span> <span data-ttu-id="8cad3-123">La tabella delle [Proprietà](property-table.md) nel pacchetto di esempio contiene le due voci seguenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-123">The [Property](property-table.md) table in the sample package contains the following two entries.</span></span>

<span data-ttu-id="8cad3-124">[Proprietà](property-table.md) di Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-124">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-125">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8cad3-125">Property</span></span>          | <span data-ttu-id="8cad3-126">Valore</span><span class="sxs-lookup"><span data-stu-id="8cad3-126">Value</span></span> |
|-------------------|-------|
| <span data-ttu-id="8cad3-127">ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="8cad3-127">ALLUSERS</span></span>          | <span data-ttu-id="8cad3-128">2</span><span class="sxs-lookup"><span data-stu-id="8cad3-128">2</span></span>     |
| <span data-ttu-id="8cad3-129">MSIINSTALLPERUSER</span><span class="sxs-lookup"><span data-stu-id="8cad3-129">MSIINSTALLPERUSER</span></span> | <span data-ttu-id="8cad3-130">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-130">1</span></span>     |



 

## <a name="custom-dialog-box-for-installation-context"></a><span data-ttu-id="8cad3-131">Finestra di dialogo personalizzata per il contesto di installazione</span><span class="sxs-lookup"><span data-stu-id="8cad3-131">Custom Dialog Box for Installation Context</span></span>

<span data-ttu-id="8cad3-132">L' [interfaccia utente](user-interface.md) del pacchetto di esempio include un esempio di finestra di dialogo personalizzata, VerifyReadyDialog, che consente agli utenti di selezionare il contesto di installazione per utente o per computer al momento dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-132">The [user interface](user-interface.md) of the sample package includes an example of a custom dialog box, VerifyReadyDialog, that enables users to select either the per-user or per-machine installation context at installation time.</span></span> <span data-ttu-id="8cad3-133">La tabella della [finestra di dialogo](dialog-table.md) contiene un record che descrive la finestra di dialogo VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="8cad3-133">The [Dialog](dialog-table.md) table contains a record that describes the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="8cad3-134">Il valore immesso nel campo attributi è 39 perché in questa finestra di dialogo vengono utilizzati i [bit di stile](dialog-style-bits.md)msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4) e msidbDialogAttributesTrackDiskSpace (32).</span><span class="sxs-lookup"><span data-stu-id="8cad3-134">The value entered in the Attributes field is 39 because this dialog box uses the msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4), and msidbDialogAttributesTrackDiskSpace (32) [dialog style bits](dialog-style-bits.md).</span></span> <span data-ttu-id="8cad3-135">Nella barra del titolo della finestra di dialogo viene visualizzato un titolo fornito dal valore della proprietà [**ProductName**](productname.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-135">The title bar of the dialog box displays a title given by the value of the [**ProductName**](productname.md) property.</span></span>

<span data-ttu-id="8cad3-136">[Finestra di dialogo](dialog-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-136">[Dialog](dialog-table.md) Table (partial)</span></span> 

| <span data-ttu-id="8cad3-137">Finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="8cad3-137">Dialog</span></span>            | <span data-ttu-id="8cad3-138">HCentering</span><span class="sxs-lookup"><span data-stu-id="8cad3-138">HCentering</span></span> | <span data-ttu-id="8cad3-139">VCenter</span><span class="sxs-lookup"><span data-stu-id="8cad3-139">VCentering</span></span> | <span data-ttu-id="8cad3-140">Larghezza</span><span class="sxs-lookup"><span data-stu-id="8cad3-140">Width</span></span> | <span data-ttu-id="8cad3-141">Altezza</span><span class="sxs-lookup"><span data-stu-id="8cad3-141">Height</span></span> | <span data-ttu-id="8cad3-142">Attributi</span><span class="sxs-lookup"><span data-stu-id="8cad3-142">Attributes</span></span> | <span data-ttu-id="8cad3-143">Titolo</span><span class="sxs-lookup"><span data-stu-id="8cad3-143">Title</span></span>           | <span data-ttu-id="8cad3-144">\_Primo controllo</span><span class="sxs-lookup"><span data-stu-id="8cad3-144">Control\_First</span></span> | <span data-ttu-id="8cad3-145">Controllo \_ predefinito</span><span class="sxs-lookup"><span data-stu-id="8cad3-145">Control\_Default</span></span> | <span data-ttu-id="8cad3-146">\_Annulla controllo</span><span class="sxs-lookup"><span data-stu-id="8cad3-146">Control\_Cancel</span></span> |
|-------------------|------------|------------|-------|--------|------------|-----------------|----------------|------------------|-----------------|
| <span data-ttu-id="8cad3-147">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-147">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-148">50</span><span class="sxs-lookup"><span data-stu-id="8cad3-148">50</span></span>         | <span data-ttu-id="8cad3-149">50</span><span class="sxs-lookup"><span data-stu-id="8cad3-149">50</span></span>         | <span data-ttu-id="8cad3-150">480</span><span class="sxs-lookup"><span data-stu-id="8cad3-150">480</span></span>   | <span data-ttu-id="8cad3-151">280</span><span class="sxs-lookup"><span data-stu-id="8cad3-151">280</span></span>    | <span data-ttu-id="8cad3-152">39</span><span class="sxs-lookup"><span data-stu-id="8cad3-152">39</span></span>         | <span data-ttu-id="8cad3-153">\[ProductName\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-153">\[ProductName\]</span></span> | <span data-ttu-id="8cad3-154">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-154">InstallPerUser</span></span> | <span data-ttu-id="8cad3-155">Prossima</span><span class="sxs-lookup"><span data-stu-id="8cad3-155">Next</span></span>             | <span data-ttu-id="8cad3-156">Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-156">Cancel</span></span>          |



 

<span data-ttu-id="8cad3-157">La tabella di [controllo](control-table.md) contiene le voci per i [controlli](controls.md) visualizzati dalla finestra di dialogo VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="8cad3-157">The [Control](control-table.md) table contains entries for the [controls](controls.md) displayed by the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="8cad3-158">Nella finestra di dialogo vengono visualizzati i controlli [pulsante](pushbutton-control.md) e un controllo [testo](text-control.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-158">The dialog box displays [PushButton](pushbutton-control.md) controls and a [Text](text-control.md) control.</span></span> <span data-ttu-id="8cad3-159">Tutti i controlli utilizzano gli [attributi di controllo](control-attributes.md)msidbControlAttributesEnabled (2) e msidbControlAttributesVisible (1).</span><span class="sxs-lookup"><span data-stu-id="8cad3-159">All the controls use the msidbControlAttributesEnabled (2) and msidbControlAttributesVisible (1) [control attributes](control-attributes.md).</span></span> <span data-ttu-id="8cad3-160">Il controllo InstallPerMachine usa anche l'attributo del controllo [ElevationShield](elevationshield-attribute.md) , msidbControlAttributesElevationShield (8388608). Questo attributo di controllo aggiunge l'icona di elevazione del [*controllo dell'account utente*](u-gly.md) (UAC) al controllo InstallPerMachine e informa l'utente che sono necessarie le credenziali UAC per installare l'applicazione nel contesto per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-160">The InstallPerMachine control also uses the [ElevationShield](elevationshield-attribute.md) control attribute, msidbControlAttributesElevationShield (8388608.) This control attribute adds the [*User Account Control*](u-gly.md) (UAC) elevation icon (shield icon) to the InstallPerMachine control and informs the user that UAC credentials are required to install the application in the per-machine context.</span></span> <span data-ttu-id="8cad3-161">Il valore nel campo di testo della tabella dei controlli è lo stile testo e il testo visualizzati dal controllo.</span><span class="sxs-lookup"><span data-stu-id="8cad3-161">The value in the Text field of the Control table is the text-style and text displayed by the control.</span></span> <span data-ttu-id="8cad3-162">Per ulteriori informazioni sull'aggiunta di testo a un controllo utilizzando stili predefiniti, vedere la descrizione del campo di testo nell'argomento della tabella di controllo.</span><span class="sxs-lookup"><span data-stu-id="8cad3-162">See the description of the Text field in the Control table topic for more information about adding text to a control using predefined styles.</span></span>

<span data-ttu-id="8cad3-163">[Controllo](control-table.md) di Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-163">[Control](control-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-164">Finestra di dialogo\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-164">Dialog\_</span></span>          | <span data-ttu-id="8cad3-165">Control</span><span class="sxs-lookup"><span data-stu-id="8cad3-165">Control</span></span>           | <span data-ttu-id="8cad3-166">Tipo</span><span class="sxs-lookup"><span data-stu-id="8cad3-166">Type</span></span>       | <span data-ttu-id="8cad3-167">Attributo</span><span class="sxs-lookup"><span data-stu-id="8cad3-167">Attribute</span></span> | <span data-ttu-id="8cad3-168">Testo</span><span class="sxs-lookup"><span data-stu-id="8cad3-168">Text</span></span>                                                   | <span data-ttu-id="8cad3-169">Controllo \_ successivo</span><span class="sxs-lookup"><span data-stu-id="8cad3-169">Control\_Next</span></span>     |
|-------------------|-------------------|------------|-----------|--------------------------------------------------------|-------------------|
| <span data-ttu-id="8cad3-170">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-170">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-171">Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-171">Cancel</span></span>            | <span data-ttu-id="8cad3-172">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-172">PushButton</span></span> | <span data-ttu-id="8cad3-173">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-173">3</span></span>         | <span data-ttu-id="8cad3-174">{ \\ Tahoma10} &Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-174">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="8cad3-175">Prossima</span><span class="sxs-lookup"><span data-stu-id="8cad3-175">Next</span></span>              |
| <span data-ttu-id="8cad3-176">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-176">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-177">Indietro</span><span class="sxs-lookup"><span data-stu-id="8cad3-177">Previous</span></span>          | <span data-ttu-id="8cad3-178">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-178">PushButton</span></span> | <span data-ttu-id="8cad3-179">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-179">3</span></span>         | <span data-ttu-id="8cad3-180">{ \\ Tahoma10} <<&precedente</span><span class="sxs-lookup"><span data-stu-id="8cad3-180">{\\Tahoma10}<<&Previous</span></span>                          | <span data-ttu-id="8cad3-181">Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-181">Cancel</span></span>            |
| <span data-ttu-id="8cad3-182">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-182">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-183">Prossima</span><span class="sxs-lookup"><span data-stu-id="8cad3-183">Next</span></span>              | <span data-ttu-id="8cad3-184">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-184">PushButton</span></span> | <span data-ttu-id="8cad3-185">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-185">3</span></span>         | <span data-ttu-id="8cad3-186">{ \\ Tahoma10} &successiva >></span><span class="sxs-lookup"><span data-stu-id="8cad3-186">{\\Tahoma10}&Next >></span></span>                             | <span data-ttu-id="8cad3-187">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-187">InstallPerUser</span></span>    |
| <span data-ttu-id="8cad3-188">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-188">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-189">Text2</span><span class="sxs-lookup"><span data-stu-id="8cad3-189">Text2</span></span>             | <span data-ttu-id="8cad3-190">Testo</span><span class="sxs-lookup"><span data-stu-id="8cad3-190">Text</span></span>       | <span data-ttu-id="8cad3-191">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-191">3</span></span>         | <span data-ttu-id="8cad3-192">Si è pronti per completare l'installazione sospesa?</span><span class="sxs-lookup"><span data-stu-id="8cad3-192">Are you ready to complete your suspended installation?</span></span> |                   |
| <span data-ttu-id="8cad3-193">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-193">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-194">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-194">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-195">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-195">PushButton</span></span> | <span data-ttu-id="8cad3-196">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-196">3</span></span>         | <span data-ttu-id="8cad3-197">{ \\ Tahoma10} installazione solo per &me</span><span class="sxs-lookup"><span data-stu-id="8cad3-197">{\\Tahoma10}Install Only for &Me</span></span>                       | <span data-ttu-id="8cad3-198">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="8cad3-198">InstallPerMachine</span></span> |
| <span data-ttu-id="8cad3-199">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-199">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-200">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="8cad3-200">InstallPerMachine</span></span> | <span data-ttu-id="8cad3-201">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-201">PushButton</span></span> | <span data-ttu-id="8cad3-202">8388611</span><span class="sxs-lookup"><span data-stu-id="8cad3-202">8388611</span></span>   | <span data-ttu-id="8cad3-203">\\Installazione di {Tahoma10} per &Everyone</span><span class="sxs-lookup"><span data-stu-id="8cad3-203">{\\Tahoma10}Install for &Everyone</span></span>                      | <span data-ttu-id="8cad3-204">Indietro</span><span class="sxs-lookup"><span data-stu-id="8cad3-204">Previous</span></span>          |
| <span data-ttu-id="8cad3-205">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-205">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-206">Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-206">Cancel</span></span>            | <span data-ttu-id="8cad3-207">Pulsante</span><span class="sxs-lookup"><span data-stu-id="8cad3-207">PushButton</span></span> | <span data-ttu-id="8cad3-208">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-208">3</span></span>         | <span data-ttu-id="8cad3-209">{ \\ Tahoma10} &Annulla</span><span class="sxs-lookup"><span data-stu-id="8cad3-209">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="8cad3-210">Prossima</span><span class="sxs-lookup"><span data-stu-id="8cad3-210">Next</span></span>              |



 

<span data-ttu-id="8cad3-211">La tabella [ControlEvent](controlevent-table.md) specifica il [ControlEvents](control-events.md)o le azioni che il programma di installazione esegue quando l'utente interagisce con un controllo.</span><span class="sxs-lookup"><span data-stu-id="8cad3-211">The [ControlEvent](controlevent-table.md) table specifies the [ControlEvents](control-events.md), or actions, the installer performs when the user interacts with a control.</span></span> <span data-ttu-id="8cad3-212">Quando un utente attiva il pulsante InstallPerUser, l'interfaccia utente visualizza una finestra di dialogo OutOfDisk se la proprietà [**OutOfDiskSpace**](outofdiskspace.md) è 1, imposta il valore della proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) su 1, imposta il valore della proprietà [**ALLUSERS**](allusers.md) su 2, imposta la proprietà [**MSIFASTINSTALL**](msifastinstall.md) su 1 e restituisce.</span><span class="sxs-lookup"><span data-stu-id="8cad3-212">When a user activates the InstallPerUser pushbutton, the user interface displays an OutOfDisk dialog box if the [**OutOfDiskSpace**](outofdiskspace.md) property is 1, sets the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1, sets the value of the [**ALLUSERS**](allusers.md) property to 2, sets the [**MSIFASTINSTALL**](msifastinstall.md) property to 1, and returns .</span></span> <span data-ttu-id="8cad3-213">Poiché la proprietà **MSIFASTINSTALL** è impostata, non viene generato alcun punto di ripristino di sistema per l'installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-213">Because the **MSIFASTINSTALL** property is set, no System Restore point is generated for the installation.</span></span> <span data-ttu-id="8cad3-214">Quando un utente attiva il pulsante InstallPerMachine, l'interfaccia utente visualizza una finestra di dialogo OutOfDisk se la proprietà **OutOfDiskSpace** è 1, imposta il valore della proprietà **ALLUSERS** su 1 e restituisce.</span><span class="sxs-lookup"><span data-stu-id="8cad3-214">When a user activates the InstallPerMachine pushbutton, the user interface displays an OutOfDisk dialog box if the **OutOfDiskSpace** property is 1, sets the value of the **ALLUSERS** property to 1, and returns.</span></span>

<span data-ttu-id="8cad3-215">[ControlEvent](controlevent-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-215">[ControlEvent](controlevent-table.md) Table (partial)</span></span> 

| <span data-ttu-id="8cad3-216">Finestra di dialogo\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-216">Dialog\_</span></span>          | <span data-ttu-id="8cad3-217">controllo\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-217">Control\_</span></span>         | <span data-ttu-id="8cad3-218">Evento</span><span class="sxs-lookup"><span data-stu-id="8cad3-218">Event</span></span>                 | <span data-ttu-id="8cad3-219">Argomento</span><span class="sxs-lookup"><span data-stu-id="8cad3-219">Argument</span></span>  | <span data-ttu-id="8cad3-220">Condizione</span><span class="sxs-lookup"><span data-stu-id="8cad3-220">Condition</span></span>                 | <span data-ttu-id="8cad3-221">JSON</span><span class="sxs-lookup"><span data-stu-id="8cad3-221">Order</span></span> |
|-------------------|-------------------|-----------------------|-----------|---------------------------|-------|
| <span data-ttu-id="8cad3-222">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-222">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-223">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-223">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-224">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-224">SpawnDialog</span></span>           | <span data-ttu-id="8cad3-225">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="8cad3-225">OutOfDisk</span></span> | <span data-ttu-id="8cad3-226">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-226">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="8cad3-227">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-227">1</span></span>     |
| <span data-ttu-id="8cad3-228">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-228">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-229">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-229">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-230">EndDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-230">EndDialog</span></span>             | <span data-ttu-id="8cad3-231">Return</span><span class="sxs-lookup"><span data-stu-id="8cad3-231">Return</span></span>    | <span data-ttu-id="8cad3-232">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-232">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="8cad3-233">5</span><span class="sxs-lookup"><span data-stu-id="8cad3-233">5</span></span>     |
| <span data-ttu-id="8cad3-234">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-234">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-235">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-235">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-236">\[MSIINSTALLPERUSER\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-236">\[MSIINSTALLPERUSER\]</span></span> | <span data-ttu-id="8cad3-237">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-237">1</span></span>         | <span data-ttu-id="8cad3-238">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-238">1</span></span>                         | <span data-ttu-id="8cad3-239">2</span><span class="sxs-lookup"><span data-stu-id="8cad3-239">2</span></span>     |
| <span data-ttu-id="8cad3-240">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-240">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-241">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-241">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-242">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-242">\[ALLUSERS\]</span></span>          | <span data-ttu-id="8cad3-243">2</span><span class="sxs-lookup"><span data-stu-id="8cad3-243">2</span></span>         | <span data-ttu-id="8cad3-244">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-244">1</span></span>                         | <span data-ttu-id="8cad3-245">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-245">3</span></span>     |
| <span data-ttu-id="8cad3-246">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-246">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-247">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="8cad3-247">InstallPerMachine</span></span> | <span data-ttu-id="8cad3-248">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-248">SpawnDialog</span></span>           | <span data-ttu-id="8cad3-249">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="8cad3-249">OutOfDisk</span></span> | <span data-ttu-id="8cad3-250">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-250">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="8cad3-251">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-251">1</span></span>     |
| <span data-ttu-id="8cad3-252">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-252">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-253">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="8cad3-253">InstallPerMachine</span></span> | <span data-ttu-id="8cad3-254">EndDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-254">EndDialog</span></span>             | <span data-ttu-id="8cad3-255">Return</span><span class="sxs-lookup"><span data-stu-id="8cad3-255">Return</span></span>    | <span data-ttu-id="8cad3-256">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-256">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="8cad3-257">3</span><span class="sxs-lookup"><span data-stu-id="8cad3-257">3</span></span>     |
| <span data-ttu-id="8cad3-258">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-258">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-259">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="8cad3-259">InstallPerMachine</span></span> | <span data-ttu-id="8cad3-260">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-260">\[ALLUSERS\]</span></span>          | <span data-ttu-id="8cad3-261">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-261">1</span></span>         | <span data-ttu-id="8cad3-262">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-262">1</span></span>                         | <span data-ttu-id="8cad3-263">2</span><span class="sxs-lookup"><span data-stu-id="8cad3-263">2</span></span>     |
| <span data-ttu-id="8cad3-264">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-264">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-265">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-265">InstallPerUser</span></span>    | <span data-ttu-id="8cad3-266">\[MSIFASTINSTALL\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-266">\[MSIFASTINSTALL\]</span></span>    | <span data-ttu-id="8cad3-267">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-267">1</span></span>         | <span data-ttu-id="8cad3-268">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-268">1</span></span>                         | <span data-ttu-id="8cad3-269">4</span><span class="sxs-lookup"><span data-stu-id="8cad3-269">4</span></span>     |



 

<span data-ttu-id="8cad3-270">Il controllo InstallPerUser deve essere rimosso dall'interfaccia utente di qualsiasi installazione usando una versione Windows Installer precedente alla Windows Installer Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="8cad3-270">The InstallPerUser control should be removed from the user interface of any installation using a Windows Installer version earlier than Windows Installer Windows Installer 5.0.</span></span> <span data-ttu-id="8cad3-271">La tabella [ControlCondition](controlcondition-table.md) nel pacchetto di esempio contiene quattro voci che disabilitano e nascondono il controllo InstallPerUser se la versione corrente è minore di Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="8cad3-271">The [ControlCondition](controlcondition-table.md) table in the sample package contains four entries that disable and hide the InstallPerUser control if the current version is less than Windows Installer 5.0.</span></span> <span data-ttu-id="8cad3-272">La tabella usa il valore della proprietà [**VersionMsi**](versionmsi.md) e la [sintassi dell'istruzione condizionale](conditional-statement-syntax.md) per definire questa condizione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-272">The table uses the value of the [**VersionMsi**](versionmsi.md) property and the [conditional statement syntax](conditional-statement-syntax.md) to define this condition.</span></span> <span data-ttu-id="8cad3-273">L'azione specificata nel campo azione viene eseguita solo se l'istruzione nel campo condizione è true.</span><span class="sxs-lookup"><span data-stu-id="8cad3-273">The action specified in the Action field is performed only if the statement in the Condition field is true.</span></span>

<span data-ttu-id="8cad3-274">[ControlCondition](controlcondition-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-274">[ControlCondition](controlcondition-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-275">Finestra di dialogo\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-275">Dialog\_</span></span>          | <span data-ttu-id="8cad3-276">controllo\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-276">Control\_</span></span>      | <span data-ttu-id="8cad3-277">Azione</span><span class="sxs-lookup"><span data-stu-id="8cad3-277">Action</span></span>  | <span data-ttu-id="8cad3-278">Condizione</span><span class="sxs-lookup"><span data-stu-id="8cad3-278">Condition</span></span>               |
|-------------------|----------------|---------|-------------------------|
| <span data-ttu-id="8cad3-279">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-279">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-280">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-280">InstallPerUser</span></span> | <span data-ttu-id="8cad3-281">Abilitare</span><span class="sxs-lookup"><span data-stu-id="8cad3-281">Enable</span></span>  | <span data-ttu-id="8cad3-282">VersionMsi >= "5,00"</span><span class="sxs-lookup"><span data-stu-id="8cad3-282">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="8cad3-283">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-283">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-284">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-284">InstallPerUser</span></span> | <span data-ttu-id="8cad3-285">Disabilita</span><span class="sxs-lookup"><span data-stu-id="8cad3-285">Disable</span></span> | <span data-ttu-id="8cad3-286">VersionMsi < "5,00"</span><span class="sxs-lookup"><span data-stu-id="8cad3-286">VersionMsi < "5.00"</span></span>  |
| <span data-ttu-id="8cad3-287">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-287">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-288">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-288">InstallPerUser</span></span> | <span data-ttu-id="8cad3-289">Mostra</span><span class="sxs-lookup"><span data-stu-id="8cad3-289">Show</span></span>    | <span data-ttu-id="8cad3-290">VersionMsi >= "5,00"</span><span class="sxs-lookup"><span data-stu-id="8cad3-290">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="8cad3-291">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="8cad3-291">VerifyReadyDialog</span></span> | <span data-ttu-id="8cad3-292">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="8cad3-292">InstallPerUser</span></span> | <span data-ttu-id="8cad3-293">Nascondi</span><span class="sxs-lookup"><span data-stu-id="8cad3-293">Hide</span></span>    | <span data-ttu-id="8cad3-294">VersionMsi < "5,00"</span><span class="sxs-lookup"><span data-stu-id="8cad3-294">VersionMsi < "5.00"</span></span>  |



 

## <a name="specifying-directory-structure"></a><span data-ttu-id="8cad3-295">Specifica della struttura di directory</span><span class="sxs-lookup"><span data-stu-id="8cad3-295">Specifying Directory Structure</span></span>

<span data-ttu-id="8cad3-296">Utilizzare l'editor di database per esaminare la tabella di [directory](directory-table.md) di PUASample1.msi.</span><span class="sxs-lookup"><span data-stu-id="8cad3-296">Use the database editor to examine the [Directory](directory-table.md) table of PUASample1.msi.</span></span> <span data-ttu-id="8cad3-297">Il record della tabella di directory con una stringa vuota nel \_ campo padre della directory rappresenta la directory radice dell'albero delle directory di origine e di destinazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-297">The record of the Directory Table having an empty string in its Directory\_Parent field represents the root directory of both the source and target directory trees.</span></span> <span data-ttu-id="8cad3-298">Se la proprietà [**targetdir**](targetdir.md) è indefinita, il programma di installazione ne imposta il valore al momento dell'installazione sul valore della proprietà [**ROOTDRIVE**](rootdrive.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-298">If the [**TARGETDIR**](targetdir.md) property is undefined, the installer sets its value at installation time to the value of the [**ROOTDRIVE**](rootdrive.md) property.</span></span> <span data-ttu-id="8cad3-299">Se la proprietà [**SourceDir**](sourcedir.md) è indefinita, il programma di installazione ne imposta il valore sul percorso della directory contenente il pacchetto di Windows Installer (file con estensione msi). I nomi di directory vengono specificati utilizzando il \| formato Short Long.</span><span class="sxs-lookup"><span data-stu-id="8cad3-299">If the [**SourceDir**](sourcedir.md) property is undefined, the installer sets its value to the location of the directory containing the Windows Installer package (.msi file.) The directory names are specified using the short\|long format.</span></span>

<span data-ttu-id="8cad3-300">[Directory](directory-table.md) di Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-300">[Directory](directory-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-301">Directory</span><span class="sxs-lookup"><span data-stu-id="8cad3-301">Directory</span></span>          | <span data-ttu-id="8cad3-302">\_Padre directory</span><span class="sxs-lookup"><span data-stu-id="8cad3-302">Directory\_Parent</span></span>  | <span data-ttu-id="8cad3-303">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="8cad3-303">DefaultDir</span></span>               |
|--------------------|--------------------|--------------------------|
| <span data-ttu-id="8cad3-304">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-304">TARGETDIR</span></span>          |                    | <span data-ttu-id="8cad3-305">SourceDir</span><span class="sxs-lookup"><span data-stu-id="8cad3-305">SourceDir</span></span>                |
| <span data-ttu-id="8cad3-306">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-306">ProgramFilesFolder</span></span> | <span data-ttu-id="8cad3-307">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-307">TARGETDIR</span></span>          | <span data-ttu-id="8cad3-308">.</span><span class="sxs-lookup"><span data-stu-id="8cad3-308">.</span></span>                        |
| <span data-ttu-id="8cad3-309">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-309">ProgramMenuFolder</span></span>  | <span data-ttu-id="8cad3-310">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-310">TARGETDIR</span></span>          | <span data-ttu-id="8cad3-311">.</span><span class="sxs-lookup"><span data-stu-id="8cad3-311">.</span></span>                        |
| <span data-ttu-id="8cad3-312">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="8cad3-312">INSTALLLOCATION</span></span>    | <span data-ttu-id="8cad3-313">Fornitore</span><span class="sxs-lookup"><span data-stu-id="8cad3-313">MyVendor</span></span>           | <span data-ttu-id="8cad3-314">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-314">Sample1\|MSDN-PUASample1</span></span> |
| <span data-ttu-id="8cad3-315">Fornitore</span><span class="sxs-lookup"><span data-stu-id="8cad3-315">MyVendor</span></span>           | <span data-ttu-id="8cad3-316">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-316">ProgramFilesFolder</span></span> | <span data-ttu-id="8cad3-317">\|Microsoft MSFT</span><span class="sxs-lookup"><span data-stu-id="8cad3-317">Msft\|Microsoft</span></span>          |



 

<span data-ttu-id="8cad3-318">Nell'origine questa tabella di [directory](directory-table.md) viene risolta nei percorsi di directory seguenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-318">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="8cad3-319">\[SourceDir \] \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-319">\[SourceDir\]\\Msft\\Sample1</span></span>  
<span data-ttu-id="8cad3-320">\[SourceDir\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-320">\[SourceDir\]</span></span>  
</dl>

<span data-ttu-id="8cad3-321">Nella destinazione la tabella [directory](directory-table.md) viene risolta nei percorsi della tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="8cad3-321">At the target, the [Directory](directory-table.md) table resolves to the paths in the following table.</span></span> <span data-ttu-id="8cad3-322">Il programma di installazione imposta i valori delle proprietà [**ProgramFilesFolder**](programfilesfolder.md) e [**ProgramMenuFolder**](programmenufolder.md) su percorsi che dipendono dal [contesto di installazione](installation-context.md) e se il sistema è costituito dalle versioni a 32 bit o 64 bit di Windows Server 2008 R2 e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="8cad3-322">The installer sets the values of the [**ProgramFilesFolder**](programfilesfolder.md) and [**ProgramMenuFolder**](programmenufolder.md) properties to locations that depend upon the [installation context](installation-context.md) and whether the system is the 32-bit or 64-bit versions of Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="8cad3-323">I percorsi delle cartelle di destinazione variano a seconda che l'utente selezioni un'installazione per utente o per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-323">The paths to the target folders depend on whether the user selects a per-user or per-machine installation.</span></span>

| <span data-ttu-id="8cad3-324">Contesto di installazione</span><span class="sxs-lookup"><span data-stu-id="8cad3-324">Installation Context</span></span> | <span data-ttu-id="8cad3-325">Sistema</span><span class="sxs-lookup"><span data-stu-id="8cad3-325">System</span></span>                                                                              | <span data-ttu-id="8cad3-326">Percorsi di esempio</span><span class="sxs-lookup"><span data-stu-id="8cad3-326">Example Paths</span></span>                                                                                                                    |
|----------------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8cad3-327">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="8cad3-327">Per-Machine</span></span>          | <span data-ttu-id="8cad3-328">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-328">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-329">versione a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-329">32-bit version</span></span><br/>           | <span data-ttu-id="8cad3-330">% Programmi% \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-330">%ProgramFiles%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="8cad3-331">% ALLUSERSPROFILE% \\ \\ \\ programmi menu Start di Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="8cad3-331">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>                  |
| <span data-ttu-id="8cad3-332">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="8cad3-332">Per-Machine</span></span>          | <span data-ttu-id="8cad3-333">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-333">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-334">versione a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-334">64-bit version</span></span><br/>           | <span data-ttu-id="8cad3-335">% ProgramFiles (x86)% \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-335">%ProgramFiles(x86)%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="8cad3-336">% ALLUSERSPROFILE% \\ \\ \\ programmi menu Start di Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="8cad3-336">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>             |
| <span data-ttu-id="8cad3-337">Per-User</span><span class="sxs-lookup"><span data-stu-id="8cad3-337">Per-User</span></span>             | <span data-ttu-id="8cad3-338">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-338">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-339">versione a 32 bit o a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-339">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="8cad3-340">% USERPROFILE% \\ AppData \\ \\ programmi locali \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-340">%USERPROFILE%\\AppData\\Local\\Programs\\Msft\\Sample1</span></span><br/> <span data-ttu-id="8cad3-341">% APPDATA% \\ \\ \\ programmi menu Start di Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="8cad3-341">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/> |



 

<span data-ttu-id="8cad3-342">Le applicazioni per utente devono essere archiviate in sottocartelle nella cartella programmi specificata dal valore della proprietà [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-342">Per-user applications should be stored in subfolders under the Programs folder specified by the value of [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span> <span data-ttu-id="8cad3-343">In genere, il percorso dell'applicazione assume il formato seguente.</span><span class="sxs-lookup"><span data-stu-id="8cad3-343">Typically, the path to the application takes the following form.</span></span>

<span data-ttu-id="8cad3-344">% LocalAppData% \\ programmi \\ *ISV nome* \\ *appname*.</span><span class="sxs-lookup"><span data-stu-id="8cad3-344">%LOCALAPPDATA%\\Programs\\*ISV name*\\*AppName*.</span></span>

<span data-ttu-id="8cad3-345">I dati di configurazione per utente devono essere archiviati nella cartella programmi specificata dal valore della proprietà [**ProgramMenuFolder**](programmenufolder.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-345">Per-user configuration data should be stored in the Programs folder specified by the value of the [**ProgramMenuFolder**](programmenufolder.md) property.</span></span> <span data-ttu-id="8cad3-346">In genere, questa cartella si trova nel percorso seguente.</span><span class="sxs-lookup"><span data-stu-id="8cad3-346">Typically, this folder is located at the following path.</span></span>

<span data-ttu-id="8cad3-347">% APPDATA% \\ \\ \\ programmi menu Start di Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="8cad3-347">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span>

<span data-ttu-id="8cad3-348">Se si installano componenti del [pacchetto Windows Installer a 32 bit](32-bit-windows-installer-packages.md) , utilizzare la proprietà [**ProgramFilesFolder**](programfilesfolder.md) e [**CommonFilesFolder**](commonfilesfolder.md) nella tabella [directory](directory-table.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-348">If installing [32-bit Windows Installer Package](32-bit-windows-installer-packages.md) components, use the [**ProgramFilesFolder**](programfilesfolder.md) and [**CommonFilesFolder**](commonfilesfolder.md) property in the [Directory](directory-table.md) table.</span></span> <span data-ttu-id="8cad3-349">Se si installano componenti del [pacchetto Windows Installer a 64 bit](64-bit-windows-installer-packages.md) , usare le proprietà [**ProgramFiles64Folder**](programfiles64folder.md) e [**CommonFiles64Folder**](commonfiles64folder.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-349">If installing [64-bit Windows Installer Package](64-bit-windows-installer-packages.md) components, use the [**ProgramFiles64Folder**](programfiles64folder.md) and [**CommonFiles64Folder**](commonfiles64folder.md) properties.</span></span> <span data-ttu-id="8cad3-350">Se l'applicazione contiene versioni a 32 bit e a 64 bit dello stesso componente, con lo stesso nome, assicurarsi che queste versioni siano salvate in directory diverse o assegnare loro nomi diversi.</span><span class="sxs-lookup"><span data-stu-id="8cad3-350">If your application contains 32-bit and 64-bit versions of the same component, with the same name, ensure that these versions are saved in different directories or give them different names.</span></span>

<span data-ttu-id="8cad3-351">La tabella [directory](directory-table.md) seguente fornisce un esempio di un layout di directory compatibile con un pacchetto che include componenti a 32 bit e 64 bit e include alcuni componenti condivisi tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8cad3-351">The following [Directory](directory-table.md) table provides an example of a directory layout compatible with a package that includes 32-bit and 64-bit components and includes some components that are shared across applications.</span></span>

| <span data-ttu-id="8cad3-352">Directory</span><span class="sxs-lookup"><span data-stu-id="8cad3-352">Directory</span></span>            | <span data-ttu-id="8cad3-353">\_Padre directory</span><span class="sxs-lookup"><span data-stu-id="8cad3-353">Directory\_Parent</span></span>    | <span data-ttu-id="8cad3-354">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="8cad3-354">DefaultDir</span></span>                        |
|----------------------|----------------------|-----------------------------------|
| <span data-ttu-id="8cad3-355">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-355">TARGETDIR</span></span>            |                      | <span data-ttu-id="8cad3-356">SourceDir</span><span class="sxs-lookup"><span data-stu-id="8cad3-356">SourceDir</span></span>                         |
| <span data-ttu-id="8cad3-357">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-357">ProgramFilesFolder</span></span>   | <span data-ttu-id="8cad3-358">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-358">TARGETDIR</span></span>            | <span data-ttu-id="8cad3-359">.:P rog32</span><span class="sxs-lookup"><span data-stu-id="8cad3-359">.:Prog32</span></span>                          |
| <span data-ttu-id="8cad3-360">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="8cad3-360">ProgramFiles64Folder</span></span> | <span data-ttu-id="8cad3-361">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-361">TARGETDIR</span></span>            | <span data-ttu-id="8cad3-362">.:P rog64</span><span class="sxs-lookup"><span data-stu-id="8cad3-362">.:Prog64</span></span>                          |
| <span data-ttu-id="8cad3-363">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-363">CommonFilesFolder</span></span>    | <span data-ttu-id="8cad3-364">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-364">TARGETDIR</span></span>            | <span data-ttu-id="8cad3-365">.:Share32</span><span class="sxs-lookup"><span data-stu-id="8cad3-365">.:Share32</span></span>                         |
| <span data-ttu-id="8cad3-366">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="8cad3-366">CommonFiles64Folder</span></span>  | <span data-ttu-id="8cad3-367">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-367">TARGETDIR</span></span>            | <span data-ttu-id="8cad3-368">.:Share64</span><span class="sxs-lookup"><span data-stu-id="8cad3-368">.:Share64</span></span>                         |
| <span data-ttu-id="8cad3-369">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-369">ProgramMenuFolder</span></span>    | <span data-ttu-id="8cad3-370">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="8cad3-370">TARGETDIR</span></span>            | <span data-ttu-id="8cad3-371">.: Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-371">.:Sample1\|MSDN-PUASample1</span></span>        |
| <span data-ttu-id="8cad3-372">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="8cad3-372">INSTALLLOCATION</span></span>      | <span data-ttu-id="8cad3-373">Fornitore</span><span class="sxs-lookup"><span data-stu-id="8cad3-373">MyVendor</span></span>             | <span data-ttu-id="8cad3-374">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-374">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="8cad3-375">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="8cad3-375">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="8cad3-376">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-376">Vendorx64</span></span>            | <span data-ttu-id="8cad3-377">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-377">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="8cad3-378">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="8cad3-378">SHAREDLOCATION</span></span>       | <span data-ttu-id="8cad3-379">ShVendor</span><span class="sxs-lookup"><span data-stu-id="8cad3-379">ShVendor</span></span>             | <span data-ttu-id="8cad3-380">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-380">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="8cad3-381">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="8cad3-381">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="8cad3-382">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-382">ShVendorx64</span></span>          | <span data-ttu-id="8cad3-383">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-383">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="8cad3-384">Fornitore</span><span class="sxs-lookup"><span data-stu-id="8cad3-384">MyVendor</span></span>             | <span data-ttu-id="8cad3-385">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-385">ProgramFilesFolder</span></span>   | <span data-ttu-id="8cad3-386">\|Microsoft MSFT</span><span class="sxs-lookup"><span data-stu-id="8cad3-386">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="8cad3-387">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-387">Vendorx64</span></span>            | <span data-ttu-id="8cad3-388">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="8cad3-388">ProgramFiles64Folder</span></span> | <span data-ttu-id="8cad3-389">\|Microsoft MSFT</span><span class="sxs-lookup"><span data-stu-id="8cad3-389">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="8cad3-390">ShVendor</span><span class="sxs-lookup"><span data-stu-id="8cad3-390">ShVendor</span></span>             | <span data-ttu-id="8cad3-391">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="8cad3-391">CommonFilesFolder</span></span>    | <span data-ttu-id="8cad3-392">\|Microsoft MSFT</span><span class="sxs-lookup"><span data-stu-id="8cad3-392">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="8cad3-393">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-393">ShVendorx64</span></span>          | <span data-ttu-id="8cad3-394">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="8cad3-394">CommonFiles64Folder</span></span>  | <span data-ttu-id="8cad3-395">\|Microsoft MSFT</span><span class="sxs-lookup"><span data-stu-id="8cad3-395">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="8cad3-396">Shrx86</span><span class="sxs-lookup"><span data-stu-id="8cad3-396">Shrx86</span></span>               | <span data-ttu-id="8cad3-397">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="8cad3-397">SHAREDLOCATION</span></span>       | <span data-ttu-id="8cad3-398">x32 \| -componenti a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-398">x32\|32-bit components</span></span>            |
| <span data-ttu-id="8cad3-399">Shrx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-399">Shrx64</span></span>               | <span data-ttu-id="8cad3-400">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="8cad3-400">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="8cad3-401">\|componenti x64 a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-401">x64\|64-bit components</span></span>            |
| <span data-ttu-id="8cad3-402">Binx86</span><span class="sxs-lookup"><span data-stu-id="8cad3-402">Binx86</span></span>               | <span data-ttu-id="8cad3-403">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="8cad3-403">INSTALLLOCATION</span></span>      | <span data-ttu-id="8cad3-404">x32 \| -componenti a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-404">x32\|32-bit components</span></span>            |
| <span data-ttu-id="8cad3-405">Binx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-405">Binx64</span></span>               | <span data-ttu-id="8cad3-406">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="8cad3-406">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="8cad3-407">\|componenti x64 a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-407">x64\|64-bit components</span></span>            |
| <span data-ttu-id="8cad3-408">App32</span><span class="sxs-lookup"><span data-stu-id="8cad3-408">App32</span></span>                | <span data-ttu-id="8cad3-409">Binx86</span><span class="sxs-lookup"><span data-stu-id="8cad3-409">Binx86</span></span>               | <span data-ttu-id="8cad3-410">MyApp \| componenti non condivisi a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-410">myapp\|unshared 32-bit components</span></span> |
| <span data-ttu-id="8cad3-411">App64</span><span class="sxs-lookup"><span data-stu-id="8cad3-411">App64</span></span>                | <span data-ttu-id="8cad3-412">Binx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-412">Binx64</span></span>               | <span data-ttu-id="8cad3-413">MyApp \| componenti non condivisi a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-413">myapp\|unshared 64-bit components</span></span> |
| <span data-ttu-id="8cad3-414">Share32</span><span class="sxs-lookup"><span data-stu-id="8cad3-414">Share32</span></span>              | <span data-ttu-id="8cad3-415">Shrx86</span><span class="sxs-lookup"><span data-stu-id="8cad3-415">Shrx86</span></span>               | <span data-ttu-id="8cad3-416">componenti condivisi condivisi \| a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-416">shared\|shared 32-bit components</span></span>  |
| <span data-ttu-id="8cad3-417">Share64</span><span class="sxs-lookup"><span data-stu-id="8cad3-417">Share64</span></span>              | <span data-ttu-id="8cad3-418">Shrx64</span><span class="sxs-lookup"><span data-stu-id="8cad3-418">Shrx64</span></span>               | <span data-ttu-id="8cad3-419">componenti condivisi condivisi \| a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-419">shared\|shared 64-bit components</span></span>  |



 

<span data-ttu-id="8cad3-420">Nell'origine questa tabella di [directory](directory-table.md) viene risolta nei percorsi di directory seguenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-420">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="8cad3-421">\[SourceDir \] Prog32 \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-421">\[SourceDir\]Prog32\\Msft\\Sample1\\x32\\myapp</span></span>  
<span data-ttu-id="8cad3-422">\[SourceDir \] Share32 \\ file comuni \\ MSFT \\ Sample1 \\ x32 \\ condiviso</span><span class="sxs-lookup"><span data-stu-id="8cad3-422">\[SourceDir\]Share32\\Common Files\\Msft\\Sample1\\x32\\shared</span></span>  
<span data-ttu-id="8cad3-423">\[SourceDir \] Prog64 \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-423">\[SourceDir\]Prog64\\Msft\\Sample1\\x64\\myapp</span></span>  
<span data-ttu-id="8cad3-424">\[SourceDir \] Share64- \\ file comuni \\ MSFT \\ Sample1 \\ x64 \\ condivisi</span><span class="sxs-lookup"><span data-stu-id="8cad3-424">\[SourceDir\]Share64\\Common Files\\Msft\\Sample1\\x64\\shared</span></span>  
<span data-ttu-id="8cad3-425">\[\]Sample1 SourceDir</span><span class="sxs-lookup"><span data-stu-id="8cad3-425">\[SourceDir\]Sample1</span></span>  
</dl>

<span data-ttu-id="8cad3-426">Nella destinazione, questa tabella di [directory](directory-table.md) viene risolta nei percorsi di directory seguenti.</span><span class="sxs-lookup"><span data-stu-id="8cad3-426">At the target, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span> <span data-ttu-id="8cad3-427">I percorsi di destinazione dipendono dal [contesto di installazione](installation-context.md) e dal sistema.</span><span class="sxs-lookup"><span data-stu-id="8cad3-427">The target paths depend on the [installation context](installation-context.md) and system.</span></span>

| <span data-ttu-id="8cad3-428">Contesto di installazione</span><span class="sxs-lookup"><span data-stu-id="8cad3-428">Installation Context</span></span> | <span data-ttu-id="8cad3-429">Sistema</span><span class="sxs-lookup"><span data-stu-id="8cad3-429">System</span></span>                                                                              | <span data-ttu-id="8cad3-430">Percorsi di esempio</span><span class="sxs-lookup"><span data-stu-id="8cad3-430">Example Paths</span></span>                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8cad3-431">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="8cad3-431">Per-Machine</span></span>          | <span data-ttu-id="8cad3-432">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-432">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-433">versione a 32 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-433">32-bit version</span></span><br/>           | <span data-ttu-id="8cad3-434">% Programmi% \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-434">%ProgramFiles%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="8cad3-435">% ProgramFiles% \\ file comuni \\ MSFT \\ Sample1 \\ x32 \\ condiviso</span><span class="sxs-lookup"><span data-stu-id="8cad3-435">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="8cad3-436">% ProgramFiles (x86)% \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-436">%ProgramFiles(x86)%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="8cad3-437">% ProgramFiles (x86)% \\ file comuni \\ MSFT \\ Sample1 \\ x64 \\ condiviso</span><span class="sxs-lookup"><span data-stu-id="8cad3-437">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="8cad3-438">% ProgramData% \\ Microsoft \\ Windows \\ programmi menu \\ Start \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-438">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="8cad3-439">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="8cad3-439">Per-Machine</span></span>          | <span data-ttu-id="8cad3-440">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-440">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-441">versione a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-441">64-bit version</span></span><br/>           | <span data-ttu-id="8cad3-442">% ProgramFiles (x86)% \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-442">%ProgramFiles(x86)%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="8cad3-443">% ProgramFiles (x86)% \\ file comuni \\ MSFT \\ Sample1s \\ x32 \\ condiviso</span><span class="sxs-lookup"><span data-stu-id="8cad3-443">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="8cad3-444">% ProgramFiles% \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-444">%ProgramFiles%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="8cad3-445">% ProgramFiles% \\ file comuni \\ MSFT \\ Sample1 \\ x64 \\ condiviso</span><span class="sxs-lookup"><span data-stu-id="8cad3-445">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="8cad3-446">% ProgramData% \\ Microsoft \\ Windows \\ programmi menu \\ Start \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-446">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="8cad3-447">Per-User</span><span class="sxs-lookup"><span data-stu-id="8cad3-447">Per-User</span></span>             | <span data-ttu-id="8cad3-448">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="8cad3-448">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="8cad3-449">versione a 32 bit o a 64 bit</span><span class="sxs-lookup"><span data-stu-id="8cad3-449">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="8cad3-450">% LOCALAPPDATA% \\ programmi \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-450">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="8cad3-451">% LOCALAPPDATA% \\ programmi \\ comuni \\ MSFT \\ Sample1 \\ x32 \\ condivisi</span><span class="sxs-lookup"><span data-stu-id="8cad3-451">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="8cad3-452">% LOCALAPPDATA% \\ programmi \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="8cad3-452">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="8cad3-453">% LOCALAPPDATA% \\ programmi \\ comuni \\ MSFT \\ Sample1 \\ x64 \\ condivisi</span><span class="sxs-lookup"><span data-stu-id="8cad3-453">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="8cad3-454">% APPDATA% \\ Microsoft \\ Windows \\ programmi menu \\ Start \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="8cad3-454">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/> |



 

## <a name="application-registration"></a><span data-ttu-id="8cad3-455">Registrazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="8cad3-455">Application Registration</span></span>

<span data-ttu-id="8cad3-456">Il PUASample.msi aggiunge una sottochiave alla chiave del registro di sistema dei percorsi dell'applicazione ed esegue le registrazioni che consentono di salvare le informazioni dell'applicazione nel registro di sistema in base a questa chiave.</span><span class="sxs-lookup"><span data-stu-id="8cad3-456">The PUASample.msi adds a subkey to the App Paths registry key for the application and performs registrations that enable application information to be saved in the registry under this key.</span></span> <span data-ttu-id="8cad3-457">Per ulteriori informazioni sui percorsi delle app e la registrazione dell'applicazione, vedere la sezione relativa alla registrazione dell'applicazione, [PerceivedTypes e SystemFileAssociations](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) nella sezione [Extensibility](https://msdn.microsoft.com/library/bb762762.aspx) della shell della [Guida per gli sviluppatori della shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="8cad3-457">For more information about App Paths and application registration, see the [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="8cad3-458">Al momento dell'installazione, l'utente decide di installare l'applicazione nel contesto di installazione per utente o per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-458">At installation time, the user makes the decision to install the application in either the per-user or per-machine installation context.</span></span> <span data-ttu-id="8cad3-459">Quando viene creato il pacchetto a doppio scopo, lo sviluppatore del pacchetto non è in grado di stabilire se le registrazioni devono essere eseguite nel \_ computer locale HKEY \_ o nelle \_ chiavi utente correnti di HKEY \_ .</span><span class="sxs-lookup"><span data-stu-id="8cad3-459">At the time the dual-purpose package is authored, the package developer cannot know if the registrations should be performed under the HKEY\_LOCAL\_MACHINE or HKEY\_CURRENT\_USER keys.</span></span>

<span data-ttu-id="8cad3-460">Lo sviluppatore del pacchetto definisce l'identificatore del file eseguibile dell'applicazione nel campo file della tabella [file](file-table.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-460">The package developer defines the file identifier for the application's executable file in the File field of the [File](file-table.md) Table.</span></span>

<span data-ttu-id="8cad3-461">[File](file-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-461">[File](file-table.md) Table (partial)</span></span> 

| <span data-ttu-id="8cad3-462">File</span><span class="sxs-lookup"><span data-stu-id="8cad3-462">File</span></span>      | <span data-ttu-id="8cad3-463">Componente\_</span><span class="sxs-lookup"><span data-stu-id="8cad3-463">Component\_</span></span>      | <span data-ttu-id="8cad3-464">FileName</span><span class="sxs-lookup"><span data-stu-id="8cad3-464">FileName</span></span>                     | <span data-ttu-id="8cad3-465">FileSize</span><span class="sxs-lookup"><span data-stu-id="8cad3-465">FileSize</span></span> | <span data-ttu-id="8cad3-466">Versione</span><span class="sxs-lookup"><span data-stu-id="8cad3-466">Version</span></span> | <span data-ttu-id="8cad3-467">Linguaggio</span><span class="sxs-lookup"><span data-stu-id="8cad3-467">Language</span></span> | <span data-ttu-id="8cad3-468">Attributi</span><span class="sxs-lookup"><span data-stu-id="8cad3-468">Attributes</span></span> | <span data-ttu-id="8cad3-469">Sequenza</span><span class="sxs-lookup"><span data-stu-id="8cad3-469">Sequence</span></span> |
|-----------|------------------|------------------------------|----------|---------|----------|------------|----------|
| <span data-ttu-id="8cad3-470">MyAppFile</span><span class="sxs-lookup"><span data-stu-id="8cad3-470">MyAppFile</span></span> | <span data-ttu-id="8cad3-471">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-471">ProductComponent</span></span> | <span data-ttu-id="8cad3-472">PUASAMP1.EXE\|PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="8cad3-472">PUASAMP1.EXE\|PUASample1.exe</span></span> | <span data-ttu-id="8cad3-473">81920</span><span class="sxs-lookup"><span data-stu-id="8cad3-473">81920</span></span>    |         |          | <span data-ttu-id="8cad3-474">0</span><span class="sxs-lookup"><span data-stu-id="8cad3-474">0</span></span>          | <span data-ttu-id="8cad3-475">1</span><span class="sxs-lookup"><span data-stu-id="8cad3-475">1</span></span>        |



 

<span data-ttu-id="8cad3-476">I valori da salvare nel registro di sistema possono essere specificati nel campo del valore della tabella del [Registro di sistema](registry-table.md) come stringa [formattata](formatted.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-476">Values to be saved in the registry can be specified in the Value field of the [Registry](registry-table.md) table as a [Formatted](formatted.md) string.</span></span> <span data-ttu-id="8cad3-477">Usare l'identificatore di file definito nel campo file della tabella [file](file-table.md) e la \[ \#  \] convenzione FileKey del tipo formattato per specificare il valore predefinito per la chiave del registro di sistema percorsi app.</span><span class="sxs-lookup"><span data-stu-id="8cad3-477">Use the file identifier defined in the File field of the [File](file-table.md) table, and the \[\#*filekey*\] convention of the Formatted type, to specify the default value for the App Paths registry key.</span></span> <span data-ttu-id="8cad3-478">L'azione di [installazione](install-action.md) di primo livello esegue le azioni nella tabella [InstallExecuteSequence](installexecutesequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-478">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table.</span></span> <span data-ttu-id="8cad3-479">Una volta completate le azioni [CostInitialize](costinitialize-action.md), [filecost](filecost-action.md)e [InstallFinalize](installfinalize-action.md) in questa tabella, il Windows Installer sostituisce la sottostringa formattata \[ \# MyAppFile \] nella tabella del registro di sistema con il percorso completo del file dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-479">After the [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md), and [InstallFinalize](installfinalize-action.md) actions in this table have completed, the Windows Installer replaces the formatted substring \[\#MyAppFile\] in the Registry table with the full path to the application file.</span></span>

<span data-ttu-id="8cad3-480">L'esempio definisce una proprietà personalizzata, RegRoot, per contenere il percorso della chiave radice e usa un'azione personalizzata per reimpostare il valore della proprietà se l'utente sceglie un'installazione per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-480">The sample defines a custom property, RegRoot, to contain the location of the root key and uses a custom action to reset the property value if the user chooses a per-machine installation.</span></span> <span data-ttu-id="8cad3-481">Usare la proprietà personalizzata, RegRoot, in tutti i valori stringa formattati che fanno riferimento al percorso radice.</span><span class="sxs-lookup"><span data-stu-id="8cad3-481">Use the custom property, RegRoot, in any formatted string values that reference the root location.</span></span> <span data-ttu-id="8cad3-482">Nella tabella delle [Proprietà](property-table.md) il pacchetto di PUASample.msi definisce la proprietà personalizzata e imposta il valore di RegRoot su HKCU.</span><span class="sxs-lookup"><span data-stu-id="8cad3-482">In the [Property](property-table.md) table the PUASample.msi package defines the custom property and sets the value of RegRoot to HKCU.</span></span> <span data-ttu-id="8cad3-483">Viene così inizializzato il valore della proprietà per il contesto di installazione per utente, il contesto predefinito consigliato per i pacchetti a doppio scopo.</span><span class="sxs-lookup"><span data-stu-id="8cad3-483">This initializes the value of the property for the per-user installation context, the recommended default context for dual-purpose packages.</span></span>

<span data-ttu-id="8cad3-484">[Proprietà](property-table.md) di Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-484">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-485">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8cad3-485">Property</span></span> | <span data-ttu-id="8cad3-486">Valore</span><span class="sxs-lookup"><span data-stu-id="8cad3-486">Value</span></span> |
|----------|-------|
| <span data-ttu-id="8cad3-487">RegRoot</span><span class="sxs-lookup"><span data-stu-id="8cad3-487">RegRoot</span></span>  | <span data-ttu-id="8cad3-488">HKCU</span><span class="sxs-lookup"><span data-stu-id="8cad3-488">HKCU</span></span>  |



 

<span data-ttu-id="8cad3-489">Nella tabella [CustomAction](customaction-table.md) il pacchetto definisce un'azione personalizzata denominata set \_ RegRoot \_ HKLM.</span><span class="sxs-lookup"><span data-stu-id="8cad3-489">In the [CustomAction](customaction-table.md) table the package defines a custom action named Set\_RegRoot\_HKLM.</span></span> <span data-ttu-id="8cad3-490">Il valore nel campo tipo identifica questo [tipo di azione personalizzata 51](custom-action-type-51.md) azione personalizzata standard.</span><span class="sxs-lookup"><span data-stu-id="8cad3-490">The value in the Type field identifies this as a [Custom Action Type 51](custom-action-type-51.md) standard custom action.</span></span> <span data-ttu-id="8cad3-491">Il significato dei campi di origine e di destinazione nella tabella CustomAction dipende dal tipo di azione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="8cad3-491">The meaning of the Source and Target fields in the CustomAction table depend upon the custom action type.</span></span> <span data-ttu-id="8cad3-492">Per altre informazioni sui tipi standard di azioni personalizzate, vedere [tipi di azione personalizzati](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="8cad3-492">For more information about the standard types of custom actions, see [Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span> <span data-ttu-id="8cad3-493">Il campo di origine per l' \_ azione personalizzata set RegRoot \_ HKLM specifica che il valore della proprietà RegRoot.</span><span class="sxs-lookup"><span data-stu-id="8cad3-493">The Source field for the Set\_RegRoot\_HKLM custom action specifies that the value of the RegRoot property.</span></span> <span data-ttu-id="8cad3-494">Se il programma di installazione esegue l' \_ azione personalizzata set RegRoot \_ HKLM, il valore della proprietà RegRoot viene reimpostato su HKLM.</span><span class="sxs-lookup"><span data-stu-id="8cad3-494">If the installer performs the Set\_RegRoot\_HKLM custom action, this resets the value of the RegRoot property to HKLM.</span></span>

<span data-ttu-id="8cad3-495">[CustomAction](customaction-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-495">[CustomAction](customaction-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-496">Azione</span><span class="sxs-lookup"><span data-stu-id="8cad3-496">Action</span></span>             | <span data-ttu-id="8cad3-497">Tipo</span><span class="sxs-lookup"><span data-stu-id="8cad3-497">Type</span></span> | <span data-ttu-id="8cad3-498">Source (Sorgente)</span><span class="sxs-lookup"><span data-stu-id="8cad3-498">Source</span></span>      | <span data-ttu-id="8cad3-499">Destinazione</span><span class="sxs-lookup"><span data-stu-id="8cad3-499">Target</span></span> |
|--------------------|------|-------------|--------|
| <span data-ttu-id="8cad3-500">Imposta \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="8cad3-500">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="8cad3-501">51</span><span class="sxs-lookup"><span data-stu-id="8cad3-501">51</span></span>   | <span data-ttu-id="8cad3-502">\[RegRoot\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-502">\[RegRoot\]</span></span> | <span data-ttu-id="8cad3-503">HKLM</span><span class="sxs-lookup"><span data-stu-id="8cad3-503">HKLM</span></span>   |



 

<span data-ttu-id="8cad3-504">L'azione di [installazione](install-action.md) di primo livello esegue le azioni nella tabella [InstallExecuteSequence](installexecutesequence-table.md) , nella sequenza specificata nel campo Sequence della tabella.</span><span class="sxs-lookup"><span data-stu-id="8cad3-504">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table, in the sequence specified in the Sequence field of that table.</span></span> <span data-ttu-id="8cad3-505">Il valore creato nel campo sequenza per l' \_ azione personalizzata set RegRoot \_ HKLM (1501) specifica che l'azione personalizzata deve essere eseguita dopo l'azione [InstallInitialize](installinitialize-action.md) (1500) e prima dell'azione [ProcessComponents](processcomponents-action.md) (1600). Questa sequenza garantisce che il record per l' \_ azione personalizzata set RegRoot \_ HKLM venga valutato al momento dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-505">The value authored in the Sequence field for the Set\_RegRoot\_HKLM custom action (1501) specifies that this custom action be performed after the [InstallInitialize](installinitialize-action.md) action (1500) and before the [ProcessComponents](processcomponents-action.md) action (1600.) This sequence ensures that the record for the Set\_RegRoot\_HKLM custom action is evaluated at installation time.</span></span> <span data-ttu-id="8cad3-506">Per ulteriori informazioni sulla sequenza di azioni consigliata nella tabella InstallExecuteSequence, vedere l'argomento [InstallExecuteSequence suggerito](suggested-installexecutesequence.md) .</span><span class="sxs-lookup"><span data-stu-id="8cad3-506">For more information about the recommended sequence of actions in the InstallExecuteSequence table, see the [Suggested InstallExecuteSequence](suggested-installexecutesequence.md) topic.</span></span> <span data-ttu-id="8cad3-507">La [sintassi dell'istruzione condizionale](conditional-statement-syntax.md) creata nel campo condizione specifica che l' \_ azione set RegRoot \_ HKLM viene eseguita solo se il valore della proprietà [**ALLUSERS**](allusers.md) restituisce 1 al momento dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-507">The [conditional statement syntax](conditional-statement-syntax.md) authored in the Condition field specifies that the Set\_RegRoot\_HKLM action be performed only if the value of the [**ALLUSERS**](allusers.md) property evaluates to 1 at installation time.</span></span> <span data-ttu-id="8cad3-508">Un valore della proprietà **ALLUSERS** pari a 1 specifica un'installazione per computer.</span><span class="sxs-lookup"><span data-stu-id="8cad3-508">An **ALLUSERS** property value of 1 specifies a per-machine installation.</span></span>

<span data-ttu-id="8cad3-509">[InstallExecuteSequence](installexecutesequence-table.md) Tabella (parziale)</span><span class="sxs-lookup"><span data-stu-id="8cad3-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partial)</span></span>

| <span data-ttu-id="8cad3-510">Azione</span><span class="sxs-lookup"><span data-stu-id="8cad3-510">Action</span></span>             | <span data-ttu-id="8cad3-511">Condizione</span><span class="sxs-lookup"><span data-stu-id="8cad3-511">Condition</span></span>  | <span data-ttu-id="8cad3-512">Sequenza</span><span class="sxs-lookup"><span data-stu-id="8cad3-512">Sequence</span></span> |
|--------------------|------------|----------|
| <span data-ttu-id="8cad3-513">Imposta \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="8cad3-513">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="8cad3-514">ALLUSERS = 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-514">ALLUSERS=1</span></span> | <span data-ttu-id="8cad3-515">1501</span><span class="sxs-lookup"><span data-stu-id="8cad3-515">1501</span></span>     |



 

<span data-ttu-id="8cad3-516">I record seguenti nella tabella [del registro di sistema](registry-table.md) eseguono le registrazioni se il componente ProductComponent è installato.</span><span class="sxs-lookup"><span data-stu-id="8cad3-516">The following records in the [Registry](registry-table.md) table perform the registrations if the ProductComponent component is installed.</span></span> <span data-ttu-id="8cad3-517">Il valore-1 nel campo radice è necessario per eseguire la registrazione in HKEY \_ Local \_ computer per un'installazione per utente e in HKEY \_ Current \_ User per un'installazione per utente.</span><span class="sxs-lookup"><span data-stu-id="8cad3-517">The value -1 in the Root field is required to perform the registration under HKEY\_LOCAL\_MACHINE for a per-user installation and under HKEY\_CURRENT\_USER for a per-user installation.</span></span> <span data-ttu-id="8cad3-518">Il record con una stringa vuota nel campo Registro di sistema aggiunge una sottochiave per l'applicazione sotto la chiave del registro di sistema percorsi app e imposta il valore "(impostazione predefinita)" sul percorso completo del file eseguibile dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-518">The record with an empty string in the Registry field adds a subkey for the application under the AppPaths registry key and sets the "(Default)" value to the full path of the application's executable file.</span></span> <span data-ttu-id="8cad3-519">La registrazione MyAppPathAlias esegue il mapping del file eseguibile a un alias dell'applicazione e consente l'avvio dell'applicazione se l'utente digita l'alias "puapct" al prompt della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="8cad3-519">The MyAppPathAlias registration maps the executable file to an application alias and enables the application to be launched if the user types the alias "puapct" at a command line prompt.</span></span> <span data-ttu-id="8cad3-520">La registrazione MyAppPathRegistration esegue il mapping del nome del file eseguibile al percorso completo del file.</span><span class="sxs-lookup"><span data-stu-id="8cad3-520">The MyAppPathRegistration registration maps the name of the executable file to the file's full path.</span></span>



| <span data-ttu-id="8cad3-521">Registro</span><span class="sxs-lookup"><span data-stu-id="8cad3-521">Registry</span></span>              | <span data-ttu-id="8cad3-522">Radice</span><span class="sxs-lookup"><span data-stu-id="8cad3-522">Root</span></span> | <span data-ttu-id="8cad3-523">Codice</span><span class="sxs-lookup"><span data-stu-id="8cad3-523">Key</span></span>                                                                     | <span data-ttu-id="8cad3-524">Nome</span><span class="sxs-lookup"><span data-stu-id="8cad3-524">Name</span></span> | <span data-ttu-id="8cad3-525">Valore</span><span class="sxs-lookup"><span data-stu-id="8cad3-525">Value</span></span>                                                                            | <span data-ttu-id="8cad3-526">Componente</span><span class="sxs-lookup"><span data-stu-id="8cad3-526">Component</span></span>        |
|-----------------------|------|-------------------------------------------------------------------------|------|----------------------------------------------------------------------------------|------------------|
|                       | <span data-ttu-id="8cad3-527">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-527">-1</span></span>   | <span data-ttu-id="8cad3-528">Software \\ Microsoft \\ MyAppPathRegistrationLocation</span><span class="sxs-lookup"><span data-stu-id="8cad3-528">Software\\Microsoft\\MyAppPathRegistrationLocation</span></span>                      |      | <span data-ttu-id="8cad3-529">\[RegRoot \] \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ percorsi app \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="8cad3-529">\[RegRoot\]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span> | <span data-ttu-id="8cad3-530">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-530">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-531">MyAppPathAlias</span><span class="sxs-lookup"><span data-stu-id="8cad3-531">MyAppPathAlias</span></span>        | <span data-ttu-id="8cad3-532">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-532">-1</span></span>   | <span data-ttu-id="8cad3-533">Software \\ Microsoft \\ Windows \\ CurrentVersion \\ percorsi app \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="8cad3-533">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span>     |      | <span data-ttu-id="8cad3-534">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-534">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="8cad3-535">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-535">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-536">MyAppPathRegistration</span><span class="sxs-lookup"><span data-stu-id="8cad3-536">MyAppPathRegistration</span></span> | <span data-ttu-id="8cad3-537">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-537">-1</span></span>   | <span data-ttu-id="8cad3-538">Software \\ Microsoft \\ Windows \\ CurrentVersion \\ percorsi app \\PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="8cad3-538">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUASample1.exe</span></span> |      | <span data-ttu-id="8cad3-539">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="8cad3-539">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="8cad3-540">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-540">ProductComponent</span></span> |



 

## <a name="autoplay-cancel-registration"></a><span data-ttu-id="8cad3-541">Annulla registrazione AutoPlay</span><span class="sxs-lookup"><span data-stu-id="8cad3-541">AutoPlay Cancel Registration</span></span>

<span data-ttu-id="8cad3-542">Il PUASample.msi esegue le registrazioni che consentono all'utente dell'applicazione di impedire l'avvio di [AutoPlay hardware](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) per i dispositivi selezionati.</span><span class="sxs-lookup"><span data-stu-id="8cad3-542">The PUASample.msi performs registrations that enable the application user to prevent [Hardware Autoplay](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) from launching for selected devices.</span></span> <span data-ttu-id="8cad3-543">Per informazioni sulla registrazione di un gestore per annullare AutoPlay in risposta a un evento, vedere l'argomento [preparazione dell'hardware e del software da usare con AutoPlay](/previous-versions//cc144208(v=vs.85)) nella sezione [Extensibility della shell](https://msdn.microsoft.com/library/bb762762.aspx) della Guida per [gli sviluppatori della shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="8cad3-543">For information about registering a handler to cancel Autoplay in response to an event, see the [Preparing Hardware and Software for Use with AutoPlay](/previous-versions//cc144208(v=vs.85)) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="8cad3-544">Il record seguente registra il gestore specificato nel campo nome quando viene installato il componente ProductComponent.</span><span class="sxs-lookup"><span data-stu-id="8cad3-544">The following record registers the handler specified in the Name field when the ProductComponent component is installed.</span></span> <span data-ttu-id="8cad3-545">Il valore-1 nel campo radice è necessario per specificare la Windows Installer che la registrazione deve essere reindirizzata a una posizione che dipende dal contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-545">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="8cad3-546">[Registro di sistema](registry-table.md) tavolo</span><span class="sxs-lookup"><span data-stu-id="8cad3-546">[Registry](registry-table.md) Table</span></span> 

| <span data-ttu-id="8cad3-547">Registro</span><span class="sxs-lookup"><span data-stu-id="8cad3-547">Registry</span></span>                     | <span data-ttu-id="8cad3-548">Radice</span><span class="sxs-lookup"><span data-stu-id="8cad3-548">Root</span></span> | <span data-ttu-id="8cad3-549">Codice</span><span class="sxs-lookup"><span data-stu-id="8cad3-549">Key</span></span>                                                                                             | <span data-ttu-id="8cad3-550">Nome</span><span class="sxs-lookup"><span data-stu-id="8cad3-550">Name</span></span>                                 | <span data-ttu-id="8cad3-551">Valore</span><span class="sxs-lookup"><span data-stu-id="8cad3-551">Value</span></span> | <span data-ttu-id="8cad3-552">Componente</span><span class="sxs-lookup"><span data-stu-id="8cad3-552">Component</span></span>        |
|------------------------------|------|-------------------------------------------------------------------------------------------------|--------------------------------------|-------|------------------|
| <span data-ttu-id="8cad3-553">MyAutoplayCancelRegistration</span><span class="sxs-lookup"><span data-stu-id="8cad3-553">MyAutoplayCancelRegistration</span></span> | <span data-ttu-id="8cad3-554">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-554">-1</span></span>   | <span data-ttu-id="8cad3-555">SOFTWARE \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ AutoplayHandlers \\ cancelautoplay \\ CLSID</span><span class="sxs-lookup"><span data-stu-id="8cad3-555">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers\\CancelAutoplay\\CLSID</span></span> | <span data-ttu-id="8cad3-556">66A32FE6-229D-427b-A608-D273F40C034C</span><span class="sxs-lookup"><span data-stu-id="8cad3-556">66A32FE6-229D-427b-A608-D273F40C034C</span></span> |       | <span data-ttu-id="8cad3-557">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-557">ProductComponent</span></span> |



 

## <a name="preview-handler-registration"></a><span data-ttu-id="8cad3-558">Anteprima registrazione gestore</span><span class="sxs-lookup"><span data-stu-id="8cad3-558">Preview Handler Registration</span></span>

<span data-ttu-id="8cad3-559">Il PUASample.msi esegue le registrazioni necessarie per installare un gestore di [anteprime](../shell/preview-handlers.md) che Abilita un'anteprima di sola lettura dei file con estensione PUA senza avviare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-559">The PUASample.msi performs registrations that are required to install a [preview handler](../shell/preview-handlers.md) that enables a read-only preview of .pua files without launching the application.</span></span> <span data-ttu-id="8cad3-560">Per informazioni sulla registrazione dei gestori di anteprime, vedere l'argomento [registrazione dei gestori di anteprime](../shell/how-to-register-a-preview-handler.md) nella sezione [Extensibility](https://msdn.microsoft.com/library/bb762762.aspx) della shell della [Guida per gli sviluppatori della shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="8cad3-560">For information about registering preview handlers, see the [Registering Preview Handlers](../shell/how-to-register-a-preview-handler.md) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="8cad3-561">I record seguenti nella tabella [del registro di sistema](registry-table.md) registrano il gestore quando viene installato il componente ProductComponent.</span><span class="sxs-lookup"><span data-stu-id="8cad3-561">The following records in the [Registry](registry-table.md) table register the handler when the ProductComponent component is installed.</span></span> <span data-ttu-id="8cad3-562">Il valore-1 nel campo radice è necessario per specificare la Windows Installer che la registrazione deve essere reindirizzata a una posizione che dipende dal contesto di installazione.</span><span class="sxs-lookup"><span data-stu-id="8cad3-562">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="8cad3-563">[Registro di sistema](registry-table.md) tavolo</span><span class="sxs-lookup"><span data-stu-id="8cad3-563">[Registry](registry-table.md) Table</span></span>

| <span data-ttu-id="8cad3-564">Registro</span><span class="sxs-lookup"><span data-stu-id="8cad3-564">Registry</span></span>                       | <span data-ttu-id="8cad3-565">Radice</span><span class="sxs-lookup"><span data-stu-id="8cad3-565">Root</span></span> | <span data-ttu-id="8cad3-566">Codice</span><span class="sxs-lookup"><span data-stu-id="8cad3-566">Key</span></span>                                                                              | <span data-ttu-id="8cad3-567">Nome</span><span class="sxs-lookup"><span data-stu-id="8cad3-567">Name</span></span>                                   | <span data-ttu-id="8cad3-568">Valore</span><span class="sxs-lookup"><span data-stu-id="8cad3-568">Value</span></span>                                        | <span data-ttu-id="8cad3-569">Componente</span><span class="sxs-lookup"><span data-stu-id="8cad3-569">Component</span></span>        |
|--------------------------------|------|----------------------------------------------------------------------------------|----------------------------------------|----------------------------------------------|------------------|
| <span data-ttu-id="8cad3-570">MyPreviewHandlerRegistration1</span><span class="sxs-lookup"><span data-stu-id="8cad3-570">MyPreviewHandlerRegistration1</span></span>  | <span data-ttu-id="8cad3-571">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-571">-1</span></span>   | <span data-ttu-id="8cad3-572">\\Classi software \\ . PUA</span><span class="sxs-lookup"><span data-stu-id="8cad3-572">Software\\Classes\\.pua</span></span>                                                          |                                        | <span data-ttu-id="8cad3-573">puafile</span><span class="sxs-lookup"><span data-stu-id="8cad3-573">puafile</span></span>                                      | <span data-ttu-id="8cad3-574">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-574">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-575">MyPreviewHandlerRegistration2</span><span class="sxs-lookup"><span data-stu-id="8cad3-575">MyPreviewHandlerRegistration2</span></span>  | <span data-ttu-id="8cad3-576">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-576">-1</span></span>   | <span data-ttu-id="8cad3-577">Software \\ Microsoft \\ Windows \\ CurrentVersion \\ PreviewHandlers</span><span class="sxs-lookup"><span data-stu-id="8cad3-577">Software\\Microsoft\\Windows\\CurrentVersion\\PreviewHandlers</span></span>                    | <span data-ttu-id="8cad3-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span> | <span data-ttu-id="8cad3-579">Gestore di anteprima TEST di Microsoft Windows PUA</span><span class="sxs-lookup"><span data-stu-id="8cad3-579">Microsoft Windows PUA TEST Preview Handler</span></span>   | <span data-ttu-id="8cad3-580">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-580">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-581">MyPreviewHandlerRegistration3</span><span class="sxs-lookup"><span data-stu-id="8cad3-581">MyPreviewHandlerRegistration3</span></span>  | <span data-ttu-id="8cad3-582">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-582">-1</span></span>   | <span data-ttu-id="8cad3-583">\\Classi software \\ puafile \\ ShellEx \\ {8895b1c6-b41f-4c1c-a562-0d564250836f}</span><span class="sxs-lookup"><span data-stu-id="8cad3-583">Software\\Classes\\puafile\\ShellEx\\{8895b1c6-b41f-4c1c-a562-0d564250836f}</span></span>      |                                        | <span data-ttu-id="8cad3-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>       | <span data-ttu-id="8cad3-585">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-585">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-586">MyPreviewHandlerRegistration4</span><span class="sxs-lookup"><span data-stu-id="8cad3-586">MyPreviewHandlerRegistration4</span></span>  | <span data-ttu-id="8cad3-587">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-587">-1</span></span>   | <span data-ttu-id="8cad3-588">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-588">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 |                                        | <span data-ttu-id="8cad3-589">Gestore di anteprime di esempio Per-User Applicaton 1</span><span class="sxs-lookup"><span data-stu-id="8cad3-589">Per-User Applicaton Sample 1 Preview Handler</span></span> | <span data-ttu-id="8cad3-590">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-590">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-591">MyPreviewHandlerRegistration5</span><span class="sxs-lookup"><span data-stu-id="8cad3-591">MyPreviewHandlerRegistration5</span></span>  | <span data-ttu-id="8cad3-592">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-592">-1</span></span>   | <span data-ttu-id="8cad3-593">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-593">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="8cad3-594">AppID</span><span class="sxs-lookup"><span data-stu-id="8cad3-594">AppID</span></span>                                  | <span data-ttu-id="8cad3-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span><span class="sxs-lookup"><span data-stu-id="8cad3-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span></span>       | <span data-ttu-id="8cad3-596">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-596">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-597">MyPreviewHandlerRegistration6</span><span class="sxs-lookup"><span data-stu-id="8cad3-597">MyPreviewHandlerRegistration6</span></span>  | <span data-ttu-id="8cad3-598">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-598">-1</span></span>   | <span data-ttu-id="8cad3-599">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-599">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="8cad3-600">DisplayName</span><span class="sxs-lookup"><span data-stu-id="8cad3-600">DisplayName</span></span>                            | <span data-ttu-id="8cad3-601">@shell32,-38242</span><span class="sxs-lookup"><span data-stu-id="8cad3-601">@shell32,-38242</span></span>                              | <span data-ttu-id="8cad3-602">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-602">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-603">MyPreviewHandlerRegistration7</span><span class="sxs-lookup"><span data-stu-id="8cad3-603">MyPreviewHandlerRegistration7</span></span>  | <span data-ttu-id="8cad3-604">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-604">-1</span></span>   | <span data-ttu-id="8cad3-605">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="8cad3-605">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="8cad3-606">Icona</span><span class="sxs-lookup"><span data-stu-id="8cad3-606">Icon</span></span>                                   | <span data-ttu-id="8cad3-607">notepad.exe, 2</span><span class="sxs-lookup"><span data-stu-id="8cad3-607">notepad.exe,2</span></span>                                | <span data-ttu-id="8cad3-608">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-608">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-609">MyPreviewHandlerRegistration8</span><span class="sxs-lookup"><span data-stu-id="8cad3-609">MyPreviewHandlerRegistration8</span></span>  | <span data-ttu-id="8cad3-610">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-610">-1</span></span>   | <span data-ttu-id="8cad3-611">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="8cad3-611">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="8cad3-612">ThreadingModel</span><span class="sxs-lookup"><span data-stu-id="8cad3-612">ThreadingModel</span></span>                         | <span data-ttu-id="8cad3-613">Apartment</span><span class="sxs-lookup"><span data-stu-id="8cad3-613">Apartment</span></span>                                    | <span data-ttu-id="8cad3-614">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-614">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-615">MyPreviewHandlerRegistration9</span><span class="sxs-lookup"><span data-stu-id="8cad3-615">MyPreviewHandlerRegistration9</span></span>  | <span data-ttu-id="8cad3-616">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-616">-1</span></span>   | <span data-ttu-id="8cad3-617">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="8cad3-617">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> |                                        | <span data-ttu-id="8cad3-618">\#%% SystemRoot% \\ system32 \\shell32.dll</span><span class="sxs-lookup"><span data-stu-id="8cad3-618">\#%%SystemRoot%\\system32\\shell32.dll</span></span>       | <span data-ttu-id="8cad3-619">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-619">ProductComponent</span></span> |
| <span data-ttu-id="8cad3-620">MyPreviewHandlerRegistration10</span><span class="sxs-lookup"><span data-stu-id="8cad3-620">MyPreviewHandlerRegistration10</span></span> | <span data-ttu-id="8cad3-621">-1</span><span class="sxs-lookup"><span data-stu-id="8cad3-621">-1</span></span>   | <span data-ttu-id="8cad3-622">\\Classi software \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="8cad3-622">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="8cad3-623">ProgID</span><span class="sxs-lookup"><span data-stu-id="8cad3-623">ProgID</span></span>                                 | <span data-ttu-id="8cad3-624">puafile</span><span class="sxs-lookup"><span data-stu-id="8cad3-624">puafile</span></span>                                      | <span data-ttu-id="8cad3-625">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="8cad3-625">ProductComponent</span></span> |



 

 

 
