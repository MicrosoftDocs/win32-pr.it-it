---
description: Un pacchetto dual-purpose è un pacchetto Windows Installer 5.0 creato per essere in grado di installare un'applicazione nel contesto di installazione per utente o per computer.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Creazione di pacchetti singoli
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4c89a24c692591326d0498ce6da028ca3fa7eccd9b66db642105fad35a0aaccc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "119628211"
---
# <a name="single-package-authoring"></a>Creazione di pacchetti singoli

Un pacchetto dual-purpose è un pacchetto Windows Installer 5.0 creato per essere in grado di installare un'applicazione nel contesto di installazione per utente o per [computer.](installation-context.md) Gli sviluppatori del programma di installazione che usano un pacchetto dual-purpose per l'applicazione possono offrire agli utenti una scelta del contesto di installazione in fase di installazione e possono rimuovere le richieste di credenziali del controllo dell'account utente dalle installazioni per utente in Windows 7 o Windows Server 2008 R2. Lo sviluppo di un pacchetto Windows Installer 5.0 per l'installazione in Windows 7 e Windows Server 2008 R2 è detto creazione di pacchetti singoli.

È possibile iniziare a sviluppare pacchetti dual-purpose per Windows 7 e Windows Server 2008 R2 usando il programma di installazione di Windows 5.0, la proprietà [**MSIINSTALLPERUSER,**](msiinstallperuser.md) la proprietà [**ALLUSERS**](allusers.md) e le cartelle e le registrazioni note con supporto per utente di [Windows Shell](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85)). Quando Windows Installer 5.0 installa un pacchetto dual-purpose nel contesto per utente in Windows 7 o Windows Server 2008 R2, il programma di installazione indirizza le voci di file e registro ai percorsi per utente e non visualizza richieste di controllo dell'account utente per le credenziali. Quando Windows Installer 5.0 installa un pacchetto dual-purpose nel contesto per computer, il programma di installazione indirizza i file e le voci del Registro di sistema ai percorsi per computer e richiede le credenziali del controllo dell'account utente per verificare che l'utente disponga di privilegi sufficienti per installare il software per tutti gli utenti del computer. Dopo Windows Installer 5.0 installa un'applicazione, usa lo stesso contesto di installazione per tutti gli aggiornamenti, i riparazioni o la rimozione successivi dell'applicazione.

**[Windows Installer 4.5](not-supported-in-windows-installer-4-5.md)** o versioni precedenti: le proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) e le versioni per utente delle cartelle a cui fanno riferimento le proprietà [**ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)e [**CommonFiles64Folder**](commonfiles64folder.md) non sono supportate. Le **cartelle FOLDERID \_ UserProgramFiles** e **FOLDERID \_ UserProgramFilesCommon** sono disponibili a partire da Windows 7 e Windows Server 2008 R2. Ciò significa che le installazioni sviluppate per Windows Installer 4.5 o versioni precedenti indirizzano file e voci del Registro di sistema a FOLDERID \_ ProgramFiles, FOLDERID \_ ProgramFilesCommon, FOLDERID \_ ProgramFilesX64 e FOLDERID \_ ProgramFilesCommonX64. Poiché si tratta di percorsi accessibili ad altri utenti del computer, Windows Vista e sistemi successivi richiedono la visualizzazione delle richieste di controllo dell'account utente per le credenziali.

Quando un utente installa un pacchetto dual-purpose creato per Windows Installer 5.0 con Windows Installer 4.5 o versione precedente, il programma di installazione ignora la [**proprietà MSIINSTALLPERUSER.**](msiinstallperuser.md) In questo caso, l'installazione può indirizzare file e voci del Registro di sistema a percorsi accessibili ad altri utenti e richiedere al sistema di visualizzare le richieste di controllo dell'account utente per le credenziali. Windows Il programma di installazione 5.0 può installare un pacchetto sviluppato per il programma di installazione di Windows 4.5 o versioni precedenti, ma l'installazione indirizza i file e le voci del Registro di sistema a percorsi accessibili ad altri utenti e richiede al sistema di visualizzare le richieste di controllo dell'account utente per le credenziali.

## <a name="development-guidelines"></a>Linee guida per lo sviluppo

Attenersi alle linee guida seguenti per la creazione di pacchetti singoli per assicurarsi che il pacchetto possa essere installato nel contesto per utente o per computer. Seguire queste linee guida per consentire all'utente di scegliere in fase di installazione un'installazione per utente o per computer e rimuovere le richieste di controllo dell'account utente dalle installazioni per utente.

-   L'installazione per utente richiede Windows Installer 5.0 in Windows 7 o Windows Server 2008 R2. È necessario informare l'utente che il pacchetto supporta l'installazione per computer dell'applicazione nelle versioni precedenti del sistema.
-   Inizializzare i valori [**per le proprietà ALLUSERS**](allusers.md) e [**MSIINSTALLPERUSER**](msiinstallperuser.md) nella tabella [delle](property-table.md) proprietà del pacchetto per due scopi. Usare **il valore ALLUSERS** 2 e **il valore MSIINSTALLPERUSER** pari a 1 come valori iniziali. Questo specifica l'installazione per utente come impostazione predefinita per il pacchetto dual-purpose.
-   Provare a creare una finestra di dialogo per [l'interfaccia](user-interface.md) utente del pacchetto dual-purpose che consente all'utente di scegliere il contesto in fase di installazione. Creare i controlli in questa finestra di dialogo personalizzata per impostare i valori delle proprietà [**ALLUSERS**](allusers.md) e [**MSIINSTALLPERUSER.**](msiinstallperuser.md) Per il **valore ALLUSERS** pari a 2, impostare **MSIINSTALLPERUSER** su un valore pari a 1 per specificare un'installazione per utente e **impostare MSIINSTALLPERUSER** su una stringa vuota ("") per specificare un'installazione per computer. Gli utenti possono anche impostare **ALLUSERS** e **MSIINSTALLPERUSER** nella riga di comando se installano il pacchetto dalla riga di comando.
-   Convalidare il pacchetto [usando gli analizzatori di coerenza interna - ICEs](internal-consistency-evaluators-ices.md). Il pacchetto deve essere in grado di superare la convalida [tramite ICE105](ice-105.md) per essere un pacchetto valido per due scopi.
-   Usare la [tabella del Registro di](registry-table.md) sistema e la tabella [RemoveRegistry](removeregistry-table.md) per reindirizzare le voci del Registro di sistema alle parti per utente del Registro di sistema durante le installazioni per utente. In un'installazione per utente, le voci del Registro di sistema con -1 nella colonna Radice vengono reindirizzate a **HKEY \_ CURRENT \_ USER** e in un'installazione per computer vengono indirizzate a **HKEY \_ LOCAL \_ MACHINE**. In un'installazione per utente, le voci del Registro di sistema con msidbRegistryRootClassesRoot (0) nella colonna Radice vengono reindirizzate a **HKCU** Software Classes e in un'installazione per computer, queste vengono indirizzate \\  \\ a **HKLM** \\ **Software** \\ **Classes**.
-   Usare la [**proprietà ProgramFilesFolder**](programfilesfolder.md) nella [tabella Directory](directory-table.md) dei pacchetti del programma di installazione Windows [a 32 bit](32-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 32 bit non condivisi tra le applicazioni. Quando un utente installa il pacchetto dual-purpose usando il contesto per computer, questi componenti vengono salvati nella cartella Programmi nelle versioni a 32 bit di Windows e nella cartella Programmi (x86) nelle versioni a 64 bit del sistema. Tutti gli utenti possono accedere ai componenti in queste directory. Quando un utente installa il pacchetto dual-purpose in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella Programmi dell'utente corrente (ad esempio in %LocalAppData% Programs) e sono accessibili solo da \\ tale utente.
-   Usare la [**proprietà CommonFilesFolder**](commonfilesfolder.md) nella [tabella Directory](directory-table.md) dei pacchetti del programma di installazione Windows a [32 bit](32-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 32 bit condivisi tra le applicazioni. Quando un utente installa il pacchetto dual-purpose usando il contesto per computer, questi componenti vengono salvati nella cartella File comuni ed è accessibile a tutti gli utenti. Quando un utente installa il pacchetto dual-purpose in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella Common dell'utente corrente (ad esempio in %LocalAppData% Programs Common) e sono accessibili solo da \\ \\ tale utente.
-   Usare la [**proprietà ProgramFiles64Folder**](programfiles64folder.md) nella tabella [Directory](directory-table.md) dei pacchetti del programma di installazione [di Windows a 64 bit](64-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 64 bit non condivisi tra le applicazioni. Quando un utente installa il pacchetto dual-purpose usando il contesto per computer, questi componenti vengono salvati nella cartella Programmi. Tutti gli utenti possono accedere ai componenti in queste directory. Quando un utente installa il pacchetto dual-purpose in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella Programmi dell'utente corrente (ad esempio in %LocalAppData% Programs) e sono accessibili solo da \\ tale utente. Per altre informazioni sulla creazione di un pacchetto per installare un'applicazione in sistemi operativi a 64 bit, vedere Windows Installer in sistemi operativi a [64 bit](windows-installer-on-64-bit-operating-systems.md).
-   Usare la [**proprietà CommonFiles64Folder**](commonfiles64folder.md) nella tabella [Directory](directory-table.md) dei pacchetti del programma di installazione [di Windows a 64 bit](64-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 64 bit condivisi tra le applicazioni. Quando un utente installa il pacchetto dual-purpose usando il contesto per computer, questi componenti vengono salvati nella cartella File comuni ed è accessibile a tutti gli utenti. Quando un utente installa il pacchetto dual-purpose in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella Common dell'utente corrente (ad esempio in %LocalAppData% Programs Common) e sono accessibili solo da \\ \\ tale utente.
-   Usare le [**proprietà ProgramFilesFolder**](programfilesfolder.md) e [**CommonFilesFolder**](commonfilesfolder.md) nella tabella [Directory](directory-table.md) dei pacchetti del programma di installazione [Windows a 64 bit](64-bit-windows-installer-packages.md) per specificare il percorso delle directory contenenti componenti a 32 bit. Usare nomi diversi per le versioni a 32 bit e a 64 bit di tutti i componenti forniti con lo stesso nome oppure, in alternativa, salvare le versioni in cartelle diverse. Ad esempio, aggiungere informazioni alla tabella Directory per specificare il percorso della directory contenente la versione a 32 bit come ProgramFilesFolder NOME ISV Nome applicazione x86 e il percorso della directory contenente la versione a \[ \] \\  \\  \\ 64 bit \[ come Program64FilesFolder NOME ISV Nome applicazione \] \\  \\  \\ x64. Un'installazione per computer salva quindi la versione a 32 bit in Program Files(x86) \\ *ISV Name* Application Name x86 e salva la versione a 64 bit in Programmi NOME ISV Nome applicazione \\  \\ \\  \\  \\ x64. Un'installazione per utente salva la versione a 32 bit in %LocalAppData% Programmi NOME ISV Nome applicazione x86 e installa la versione a \\ \\  \\  \\ 64 bit in %LocalAppData% Programmi NOME ISV Nome applicazione \\ \\  \\  \\ x64.
-   Archiviare i dati di configurazione per utente per l'applicazione in \\ Nome \\ *utente utenti* \\ AppData.
-   Archiviare i modelli e i file generati dall'applicazione in sottocartelle in \\ Nome utente \\ *utenti*.
-   Se l'applicazione usa estensioni della shell, è necessario usare i punti di estendibilità della [shell](https://msdn.microsoft.com/library/bb762762.aspx) per utente disponibili a partire da Windows 7 o Windows Server 2008 R2.
-   Non usare azioni personalizzate nel pacchetto che richiedono privilegi elevati per l'esecuzione. La [tabella CustomAction](customaction-table.md) non deve contenere azioni personalizzate contrassegnate per l'esecuzione con privilegi elevati. Per altre informazioni sulle azioni personalizzate con privilegi elevati, vedere [Sicurezza delle azioni personalizzate.](custom-action-security.md)
-   Non scrivere in cartelle di sistema globali. La [tabella Directory](directory-table.md) non deve contenere un riferimento alle proprietà della cartella di sistema seguenti.

    <dl>

[**AdminToolsFolder**](admintoolsfolder.md)  
    [**CommonAppDataFolder**](commonappdatafolder.md)  
    [**FontsFolder**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**Cartella di sistema**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**Cartella Windows**](windowsfolder.md)  
    [**WindowsVolume**](windowsvolume.md)  
    </dl>

-   Non installare un assembly Common Language Runtime nella Global Assembly Cache (GAC). Per altre informazioni sull'installazione di assembly nella Global Assembly Cache, vedere Aggiunta di assembly [a](adding-assemblies-to-a-package.md) un pacchetto e Installazione di [assembly Common Language Runtime](installation-of-common-language-runtime-assemblies.md).
-   Non installare origini dati ODBC. Non usare la tabella [ODBCDataSource](odbcdatasource-table.md) per installare un'origine dati.
-   Non installare alcun servizio. Non usare la tabella [ServiceInstall](serviceinstall-table.md) per installare un servizio.

## <a name="example"></a>Esempio

Un esempio di pacchetto dual-purpose è disponibile in [componenti sdk](platform-sdk-components-for-windows-installer-developers.md) di Windows per sviluppatori Windows Installer come file PUASample1.msi. Se si dispone dell'SDK corrente, è possibile accedere a tutti gli strumenti e i dati necessari per riprodurre il pacchetto di installazione di esempio. Per altre informazioni su questo esempio, vedere [Single Package Authoring Example](single-package-authoring-example.md).

 

 
