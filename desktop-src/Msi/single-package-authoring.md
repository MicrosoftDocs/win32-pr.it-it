---
description: Un pacchetto a doppio scopo è un pacchetto di Windows Installer 5,0 che è stato creato per essere in grado di installare un'applicazione nel contesto di installazione per utente o per computer.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Creazione di pacchetti singoli
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87c22b9be930be2d2178ea4efb7ba1538320823a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314774"
---
# <a name="single-package-authoring"></a>Creazione di pacchetti singoli

Un pacchetto a doppio scopo è un pacchetto di Windows Installer 5,0 che è stato creato per essere in grado di installare un'applicazione nel [contesto di installazione](installation-context.md)per utente o per computer. Gli sviluppatori che utilizzano un pacchetto a doppio scopo per la propria applicazione possono fornire agli utenti la possibilità di scegliere il contesto di installazione al momento dell'installazione e possono rimuovere le richieste di credenziali UAC dalle installazioni per utente in Windows 7 o Windows Server 2008 R2. Lo sviluppo di un pacchetto a doppio scopo Windows Installer 5,0 per l'installazione in Windows 7 e Windows Server 2008 R2 viene definito creazione di pacchetti singoli.

È possibile iniziare a sviluppare pacchetti a doppio scopo per Windows 7 e Windows Server 2008 R2 usando Windows Installer 5,0, la proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) , la proprietà [**ALLUSERS**](allusers.md) e le cartelle note e le registrazioni con supporto per utente della [Shell di Windows](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85)). Quando Windows Installer 5,0 installa un pacchetto a doppio scopo nel contesto per utente in Windows 7 o Windows Server 2008 R2, il programma di installazione indirizza le voci di file e del registro di sistema a percorsi per utente e non Visualizza richieste di credenziali per il controllo dell'account utente. Quando Windows Installer 5,0 installa un pacchetto a doppio scopo nel contesto per computer, il programma di installazione indirizza i file e le voci del registro di sistema a percorsi per computer e richiede le credenziali UAC per confermare che l'utente dispone di privilegi sufficienti per installare il software per tutti gli utenti del computer. Una volta Windows Installer 5,0 installa un'applicazione, viene usato lo stesso contesto di installazione per tutti gli aggiornamenti, le riparazioni o la rimozione successivi dell'applicazione.

**[Windows Installer 4,5 o versioni precedenti](not-supported-in-windows-installer-4-5.md):** le proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) e le versioni per utente delle cartelle a cui fanno riferimento le proprietà [**ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)e [**CommonFiles64Folder**](commonfiles64folder.md) non sono supportate. Le cartelle **FOLDERID \_ UserProgramFiles** e **FOLDERID \_ UserProgramFilesCommon** sono disponibili a partire da Windows 7 e Windows Server 2008 R2. Ciò significa che le installazioni sviluppate per Windows Installer 4,5 o i file diretti precedenti e le voci del registro di sistema in FOLDERID \_ ProgramFiles, FOLDERID \_ PROGRAMFILESCOMMON, FOLDERID \_ ProgramFilesX64 e FOLDERID ProgramFilesCommonX64 \_ . Poiché si tratta di percorsi accessibili ad altri utenti del computer, i sistemi Windows Vista e versioni successive richiedono la visualizzazione delle credenziali del controllo dell'account utente.

Quando un utente installa un pacchetto a doppio scopo creato per Windows Installer 5,0 con Windows Installer 4,5 o versioni precedenti, il programma di installazione ignora la proprietà [**MSIINSTALLPERUSER**](msiinstallperuser.md) . In questo caso, l'installazione può indirizzare i file e le voci del registro di sistema a posizioni accessibili ad altri utenti e richiedere al sistema di visualizzare le richieste di credenziali del controllo dell'account utente. Windows Installer 5,0 può installare un pacchetto sviluppato per Windows Installer 4,5 o versioni precedenti, tuttavia, l'installazione indirizza i file e le voci del registro di sistema ai percorsi accessibili ad altri utenti e richiede al sistema di visualizzare le credenziali del controllo dell'account utente.

## <a name="development-guidelines"></a>Linee guida per lo sviluppo

Attenersi alle seguenti linee guida per la creazione di pacchetti singoli per assicurarsi che il pacchetto possa essere installato nel contesto per utente o per computer. Attenersi a queste linee guida per consentire all'utente di scegliere al momento dell'installazione un'installazione per utente o per computer e di rimuovere le richieste di controllo dell'account utente dalle installazioni per utente.

-   Per l'installazione per utente è necessario Windows Installer 5,0 in Windows 7 o Windows Server 2008 R2. È necessario informare l'utente che il pacchetto supporta l'installazione per computer dell'applicazione in versioni precedenti del sistema.
-   Inizializzare i valori per le proprietà [**ALLUSERS**](allusers.md) e [**MSIINSTALLPERUSER**](msiinstallperuser.md) nella [tabella delle proprietà](property-table.md) del pacchetto a doppio scopo. Usare il valore **ALLUSERS** 2 e il valore **MSIINSTALLPERUSER** 1 come valori iniziali. Viene specificata l'installazione per utente come impostazione predefinita per il pacchetto a doppio scopo.
-   Provare a creare una finestra di dialogo per l' [interfaccia utente](user-interface.md) del pacchetto a doppio scopo che consenta all'utente di scegliere il contesto al momento dell'installazione. Creare i controlli in questa finestra di dialogo personalizzata per impostare i valori delle proprietà [**ALLUSERS**](allusers.md) e [**MSIINSTALLPERUSER**](msiinstallperuser.md) . Per il valore **ALLUSERS** 2, impostare **MSIINSTALLPERUSER** su un valore pari a 1 per specificare un'installazione per utente e impostare **MSIINSTALLPERUSER** su una stringa vuota ("") per specificare un'installazione per computer. Gli utenti possono inoltre impostare **ALLUSERS** e **MSIINSTALLPERUSER** nella riga di comando se installano il pacchetto dalla riga di comando.
-   Convalidare il pacchetto utilizzando gli [analizzatori di coerenza interni-CIEM](internal-consistency-evaluators-ices.md). Il pacchetto deve essere in grado di passare la convalida da [ICE105](ice-105.md) a un pacchetto a doppio scopo valido.
-   Utilizzare la [tabella del registro di sistema](registry-table.md) e la [tabella RemoveRegistry](removeregistry-table.md) per reindirizzare le voci del registro di sistema alle parti per singolo utente del registro di sistema durante le installazioni per utente. In un'installazione per utente, le voci del registro di sistema con-1 nella colonna radice vengono reindirizzate a **HKEY \_ Current \_ User** e in un'installazione per computer vengono indirizzate **al \_ \_ computer locale HKEY**. In un'installazione per utente, le voci del registro di sistema con msidbRegistryRootClassesRoot (0) nella colonna radice vengono reindirizzate alle  \\  \\ **classi** Software HKCU e, in un'installazione per computer, vengono indirizzate a  \\  \\ **classi** Software HKLM.
-   Usare la proprietà [**ProgramFilesFolder**](programfilesfolder.md) nella [tabella di directory](directory-table.md) dei [pacchetti di Windows Installer a 32 bit](32-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 32 bit non condivisi tra le applicazioni. Quando un utente installa il pacchetto a doppio scopo usando il contesto per computer, questi componenti vengono salvati nella cartella programmi nelle versioni a 32 bit di Windows e nella cartella programmi (x86) nelle versioni a 64 bit del sistema. Tutti gli utenti possono accedere ai componenti di tali directory. Quando un utente installa il pacchetto a doppio scopo in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella programmi dell'utente corrente (ad esempio in% LocalAppData% \\ Programs) ed è possibile accedervi solo da tale utente.
-   Usare la proprietà [**CommonFilesFolder**](commonfilesfolder.md) nella [tabella di directory](directory-table.md) dei [pacchetti di Windows Installer a 32 bit](32-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 32 bit condivisi tra le applicazioni. Quando un utente installa il pacchetto a doppio scopo usando il contesto per computer, questi componenti vengono salvati nella cartella file comuni e possono essere accessibili da tutti gli utenti. Quando un utente installa il pacchetto a doppio scopo in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella comune dell'utente corrente (ad esempio, in% LocalAppData% \\ programs \\ Common) ed è possibile accedervi solo da tale utente.
-   Usare la proprietà [**ProgramFiles64Folder**](programfiles64folder.md) nella [tabella di directory](directory-table.md) dei [pacchetti di Windows Installer a 64 bit](64-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 64 bit non condivisi tra le applicazioni. Quando un utente installa il pacchetto a doppio scopo usando il contesto per computer, questi componenti vengono salvati nella cartella programmi. Tutti gli utenti possono accedere ai componenti di tali directory. Quando un utente installa il pacchetto a doppio scopo in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella programmi dell'utente corrente (ad esempio in% LocalAppData% \\ Programs) ed è possibile accedervi solo da tale utente. Per ulteriori informazioni sulla creazione di un pacchetto per l'installazione di un'applicazione in sistemi operativi a 64 bit, vedere [Windows Installer nei sistemi operativi a 64 bit](windows-installer-on-64-bit-operating-systems.md).
-   Usare la proprietà [**CommonFiles64Folder**](commonfiles64folder.md) nella [tabella di directory](directory-table.md) dei [pacchetti di Windows Installer a 64 bit](64-bit-windows-installer-packages.md) per specificare i percorsi delle directory contenenti componenti a 64 bit condivisi tra le applicazioni. Quando un utente installa il pacchetto a doppio scopo usando il contesto per computer, questi componenti vengono salvati nella cartella file comuni e possono essere accessibili da tutti gli utenti. Quando un utente installa il pacchetto a doppio scopo in Windows 7 o Windows Server 2008 R2 usando il contesto per utente, questi componenti vengono salvati nella cartella comune dell'utente corrente (ad esempio, in% LocalAppData% \\ programs \\ Common) ed è possibile accedervi solo da tale utente.
-   Usare le proprietà [**ProgramFilesFolder**](programfilesfolder.md) e [**CommonFilesFolder**](commonfilesfolder.md) nella [tabella di directory](directory-table.md) dei [pacchetti di Windows Installer a 64 bit](64-bit-windows-installer-packages.md) per specificare il percorso delle directory contenenti componenti a 32 bit. Usare nomi diversi per le versioni a 32 bit e a 64 bit di tutti i componenti forniti con lo stesso nome oppure, in alternativa, salvare le versioni in cartelle diverse. Ad esempio, aggiungere informazioni alla tabella directory per specificare il percorso della directory contenente la versione a 32 bit come nome \[ \] \\  \\ *dell'applicazione* ProgramFilesFolder ISV nome \\ x86 e il percorso della directory che contiene la versione a 64 bit come \[ Program64FilesFolder \] \\ *ISV nome* \\ *applicazione* nome \\ x64. Un'installazione per computer salva quindi la versione a 32 bit in programmi (x86) ISV nome \\  \\ *applicazione* \\ x86 e salva la versione a 64 bit in Program Files \\ *ISV nome* \\ *applicazione* \\ x64. Un'installazione per utente salva la versione a 32 bit in% LocalAppData% \\ programmi \\ *ISV nome* \\ *applicazione* \\ x86 e installa la versione a 64 bit in% LocalAppData% \\ programmi \\ *ISV nome* \\ *applicazione* \\ x64.
-   Archiviare i dati di configurazione per utente per l'applicazione in \\ Users \\ *nomeutente* \\ AppData.
-   Consente di archiviare i modelli e i file generati dall'applicazione nelle sottocartelle in \\ \\ *username (nome utente*).
-   Se l'applicazione usa le estensioni della shell, è necessario usare i punti di [estendibilità della shell](https://msdn.microsoft.com/library/bb762762.aspx) con supporto per utente disponibili a partire da Windows 7 o windows Server 2008 R2.
-   Non usare azioni personalizzate nel pacchetto che richiedono privilegi elevati per l'esecuzione. La tabella [CustomAction](customaction-table.md) non deve contenere azioni personalizzate contrassegnate per l'esecuzione con privilegi elevati. Per altre informazioni sulle azioni personalizzate con privilegi elevati, vedere [sicurezza dell'azione personalizzata](custom-action-security.md).
-   Non scrivere in alcuna cartella di sistema globale. La tabella di [directory](directory-table.md) non deve contenere un riferimento a nessuna delle proprietà della cartella di sistema seguenti.

    <dl>

[**AdminToolsFolder**](admintoolsfolder.md)  
    [**CommonAppDataFolder**](commonappdatafolder.md)  
    [**FontsFolder**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**SystemFolder**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**WindowsFolder**](windowsfolder.md)  
    [**WindowsVolume**](windowsvolume.md)  
    </dl>

-   Non installare un assembly Common Language Runtime nella Global Assembly Cache (GAC). Per ulteriori informazioni sull'installazione degli assembly per la Global Assembly Cache, vedere [aggiunta di assembly a un pacchetto](adding-assemblies-to-a-package.md) e [installazione di assembly Common Language Runtime](installation-of-common-language-runtime-assemblies.md).
-   Non installare alcuna origine dati ODBC. Non usare la tabella [ODBCDataSource](odbcdatasource-table.md) per installare un'origine dati.
-   Non installare alcun servizio. Non usare la tabella [ServiceInstall](serviceinstall-table.md) per installare un servizio.

## <a name="example"></a>Esempio

Un esempio di pacchetto a doppio scopo è disponibile nei [componenti Windows SDK per Windows Installer sviluppatori](platform-sdk-components-for-windows-installer-developers.md) come file PUASample1.msi. Se si dispone dell'SDK corrente, è possibile accedere a tutti gli strumenti e i dati necessari per riprodurre il pacchetto di installazione di esempio. Per ulteriori informazioni su questo esempio, vedere [esempio di creazione di pacchetti singoli](single-package-authoring-example.md).

 

 
