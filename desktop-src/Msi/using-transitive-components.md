---
description: Un utilizzo tipico per i componenti transitivi consiste nel preparare un prodotto da reinstallare durante un aggiornamento del sistema.
ms.assetid: 73677573-945f-4646-89d8-93e28f7856fe
title: Utilizzo di componenti transitivi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35982aafd486a62ce8560e507b8b6caf88e32591
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/05/2021
ms.locfileid: "103969012"
---
# <a name="using-transitive-components"></a><span data-ttu-id="eff23-103">Utilizzo di componenti transitivi</span><span class="sxs-lookup"><span data-stu-id="eff23-103">Using Transitive Components</span></span>

<span data-ttu-id="eff23-104">Un utilizzo tipico per i componenti transitivi consiste nel preparare un prodotto da reinstallare durante un aggiornamento del sistema.</span><span class="sxs-lookup"><span data-stu-id="eff23-104">A typical use for transitive components is to prepare a product to reinstall during a system upgrade.</span></span> <span data-ttu-id="eff23-105">L'autore del pacchetto di installazione specifica i componenti che devono essere scambiati durante un aggiornamento del sistema con l'attributo transitivo.</span><span class="sxs-lookup"><span data-stu-id="eff23-105">The author of the installation package specifies those components that need to be swapped out during a system upgrade as having the transitive attribute.</span></span> <span data-ttu-id="eff23-106">Quando l'utente aggiorna il sistema in un secondo momento, è necessario reinstallare il prodotto.</span><span class="sxs-lookup"><span data-stu-id="eff23-106">When the user later upgrades the system, the product must be reinstalled.</span></span> <span data-ttu-id="eff23-107">Al momento della reinstallazione, il programma di installazione rimuove i componenti precedenti e installa i componenti successivi senza dover installare l'intero prodotto.</span><span class="sxs-lookup"><span data-stu-id="eff23-107">Upon this reinstall, the installer removes the earlier components and installs the later components, without having to install the entire product.</span></span>

<span data-ttu-id="eff23-108">**Per includere due componenti transitivi nel pacchetto di installazione**</span><span class="sxs-lookup"><span data-stu-id="eff23-108">**To include two transitive components in the installation package**</span></span>

1.  <span data-ttu-id="eff23-109">Includere entrambi i componenti transitivi nel pacchetto di installazione.</span><span class="sxs-lookup"><span data-stu-id="eff23-109">Include both transitive components in the installation package.</span></span>
2.  <span data-ttu-id="eff23-110">Creare entrambi i componenti transitivi nella [tabella dei componenti](component-table.md) in modo analogo ai componenti normali.</span><span class="sxs-lookup"><span data-stu-id="eff23-110">Author both transitive components into the [Component table](component-table.md) the same as regular components.</span></span> <span data-ttu-id="eff23-111">Ogni componente transitivo deve avere un proprio GUID univoco specificato nella colonna ComponentId.</span><span class="sxs-lookup"><span data-stu-id="eff23-111">Each transitive component must have its own unique GUID specified in the ComponentId column.</span></span>
3.  <span data-ttu-id="eff23-112">Includere il bit **msidbComponentAttributesTransitive** nella colonna Attributes della tabella Component per ogni componente transitivo.</span><span class="sxs-lookup"><span data-stu-id="eff23-112">Include the **msidbComponentAttributesTransitive** bit in the Attributes column of the Component table for each transitive component.</span></span> <span data-ttu-id="eff23-113">Se questo bit è impostato, il programma di installazione rivaluterà il valore dell'istruzione nella colonna condizione durante una reinstallazione.</span><span class="sxs-lookup"><span data-stu-id="eff23-113">If this bit is set, the installer reevaluates the value of the statement in the Condition column upon a reinstall.</span></span>

    <span data-ttu-id="eff23-114">Se il valore era in precedenza false e è stato modificato in true, il programma di installazione installerà il componente.</span><span class="sxs-lookup"><span data-stu-id="eff23-114">If the value was previously False and has changed to True, the installer installs the component.</span></span>

    <span data-ttu-id="eff23-115">Se il valore era in precedenza true ed è stato modificato in false, il programma di installazione rimuove il componente anche se il componente dispone di altri prodotti come client.</span><span class="sxs-lookup"><span data-stu-id="eff23-115">If the value was previously True and has changed to False the installer removes the component even if the component has other products as clients.</span></span>

    > [!Note]  
    > <span data-ttu-id="eff23-116">A meno che non sia impostato il bit transitivo, il componente rimane abilitato una volta installato anche se l'istruzione condizionale restituisce false durante un'installazione di manutenzione successiva del prodotto.</span><span class="sxs-lookup"><span data-stu-id="eff23-116">Unless the transitive bit is set, the component remains enabled once installed even if the conditional statement evaluates to False on a subsequent maintenance installation of the product.</span></span> <span data-ttu-id="eff23-117">Le condizioni devono essere basate solo sugli Stati del computer.</span><span class="sxs-lookup"><span data-stu-id="eff23-117">The conditions must be based only on computer states.</span></span> <span data-ttu-id="eff23-118">Non utilizzare con le condizioni basate sugli stati utente o sulle proprietà impostate nella riga di comando, in quanto ciò può causare la reinstallazione del prodotto da parte del programma di installazione per ogni utilizzo da parte di un altro utente.</span><span class="sxs-lookup"><span data-stu-id="eff23-118">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

     

4.  <span data-ttu-id="eff23-119">Immettere espressioni condizionali complementari nei campi condizione della tabella dei controlli in modo che quando la condizione sul primo componente transitivo viene modificata in false, la condizione sul secondo componente transitivo diventa true.</span><span class="sxs-lookup"><span data-stu-id="eff23-119">Enter complementary conditional expressions into the Condition fields of the Control table such that when the condition on the first transitive component changes to False the condition on the second transitive component changes to True.</span></span> <span data-ttu-id="eff23-120">Ciò comporta la rimozione del primo componente e l'installazione del secondo componente dopo la reinstallazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eff23-120">This results in the removal of the first component and installation of the second component upon reinstallation of the application.</span></span>

<span data-ttu-id="eff23-121">Una reinstallazione del prodotto è necessaria per cambiare i componenti transitivi.</span><span class="sxs-lookup"><span data-stu-id="eff23-121">A reinstallation of the product is necessary to switch the transitive components.</span></span> <span data-ttu-id="eff23-122">Gli autori di pacchetti devono quindi fornire agli utenti un metodo per reinstallare il prodotto e per impostare le modalità della proprietà [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="eff23-122">Package authors therefore need to provide users with a method for reinstalling the product and for setting the modes of the [**REINSTALLMODE**](reinstallmode.md) property.</span></span> <span data-ttu-id="eff23-123">Esistono sostanzialmente tre modi per attivare la reinstallazione:</span><span class="sxs-lookup"><span data-stu-id="eff23-123">There are basically three ways to trigger the reinstallation:</span></span>

-   <span data-ttu-id="eff23-124">Eseguire e configurare la reinstallazione tramite l'interfaccia utente mediante la creazione di un pacchetto che utilizza l'interfaccia utente [*completa*](f-gly.md).</span><span class="sxs-lookup"><span data-stu-id="eff23-124">Run and configure the reinstallation through the user interface by authoring a package that uses the [*full UI*](f-gly.md).</span></span>
-   <span data-ttu-id="eff23-125">Eseguire la reinstallazione dalla riga di comando usando **msiexec/f** e selezionare le modalità dall'elenco per l' [opzione della riga di comando](command-line-options.md) **/f** .</span><span class="sxs-lookup"><span data-stu-id="eff23-125">Run the reinstallation from the command line by using **msiexec /f** and select the modes from the list for the **/f** [command line option](command-line-options.md).</span></span>
-   <span data-ttu-id="eff23-126">Chiedere all'applicazione di chiamare [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) o [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="eff23-126">Have the application call [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) or [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="eff23-127">Il bit deve essere utilizzato solo con condizioni basate sugli Stati del computer.</span><span class="sxs-lookup"><span data-stu-id="eff23-127">The bit should only be used with conditions based on computer states.</span></span> <span data-ttu-id="eff23-128">Non utilizzare con le condizioni basate sugli stati utente o sulle proprietà impostate nella riga di comando, in quanto ciò può causare la reinstallazione del prodotto da parte del programma di installazione per ogni utilizzo da parte di un altro utente.</span><span class="sxs-lookup"><span data-stu-id="eff23-128">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

> [!Note]
> <span data-ttu-id="eff23-129">A meno che non sia impostato il bit transitivo nella colonna attributi per un componente, il componente rimane abilitato una volta installato anche se l'istruzione condizionale nella colonna condizione restituisce false in un'installazione di manutenzione successiva del prodotto.</span><span class="sxs-lookup"><span data-stu-id="eff23-129">Unless the Transitive bit in the Attributes column is set for a component, the component remains enabled once installed even if the conditional statement in the Condition column evaluates to False on a subsequent maintenance installation of the product.</span></span>
> 
> <span data-ttu-id="eff23-130">Nella maggior parte dei casi, se un'applicazione include componenti transitivi, Windows Installer richiede l'origine dell'applicazione per la riparazione o l'aggiornamento dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eff23-130">In most cases, if an application includes transitive components, Windows Installer requires the application's source to repair or upgrade the application.</span></span> <span data-ttu-id="eff23-131">In questi casi, il CD-ROM di ripristino del sistema fornito da un produttore di apparecchiature originale non funziona ed è necessario fornire un'origine di installazione effettiva per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eff23-131">In these cases, the system restoration CD-ROM shipped by an original equipment manufacturer does not work and an actual installation source for the application needs to be provided.</span></span>

 

 

 



