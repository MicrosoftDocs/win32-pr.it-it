---
description: L'azione WriteEnvironmentStrings modifica i valori delle variabili di ambiente.
ms.assetid: a91c1ffe-1bdd-49bb-aa6a-71667a1ed812
title: Azione WriteEnvironmentStrings
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc3a9d64a1140fc883d94e8d3733608d29dc2d39
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104050250"
---
# <a name="writeenvironmentstrings-action"></a><span data-ttu-id="9f927-103">Azione WriteEnvironmentStrings</span><span class="sxs-lookup"><span data-stu-id="9f927-103">WriteEnvironmentStrings Action</span></span>

<span data-ttu-id="9f927-104">L'azione WriteEnvironmentStrings modifica i valori delle variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="9f927-104">The WriteEnvironmentStrings action modifies the values of environment variables.</span></span>

<span data-ttu-id="9f927-105">Le variabili di ambiente non cambiano per l'installazione in corso quando viene eseguita l'azione WriteEnvironmentStrings o [RemoveEnvironmentStrings](removeenvironmentstrings-action.md) .</span><span class="sxs-lookup"><span data-stu-id="9f927-105">Environment variables do not change for the installation in progress when the WriteEnvironmentStrings action or [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) are run.</span></span> <span data-ttu-id="9f927-106">In Windows 2000, Windows Server 2003, Windows XP e Windows Vista queste informazioni vengono archiviate nel registro di sistema e viene inviato un messaggio [**WM \_ SETTINGCHANGE**](../winmsg/wm-settingchange.md) per notificare al sistema le modifiche al termine dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="9f927-106">On Windows 2000, Windows Server 2003, Windows XP, and Windows Vista this information is stored in the registry and a [**WM\_SETTINGCHANGE**](../winmsg/wm-settingchange.md) message is sent to notify the system of the changes when the installation completes.</span></span> <span data-ttu-id="9f927-107">Un altro processo può ricevere notifiche delle modifiche gestendo questi messaggi.</span><span class="sxs-lookup"><span data-stu-id="9f927-107">Another process can receive notification of the changes by handling these messages.</span></span> <span data-ttu-id="9f927-108">Se il riavvio del sistema è in sospeso, non viene inviato alcun messaggio.</span><span class="sxs-lookup"><span data-stu-id="9f927-108">No message is sent if a restart of the system is pending.</span></span> <span data-ttu-id="9f927-109">Un pacchetto può utilizzare la proprietà [**MsiSystemRebootPending**](msisystemrebootpending.md) per verificare se un riavvio del sistema è in sospeso.</span><span class="sxs-lookup"><span data-stu-id="9f927-109">A package can use the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to check whether a system restart is pending.</span></span>

<span data-ttu-id="9f927-110">Il programma di installazione esegue l'azione WriteEnvironmentStrings solo durante l'installazione o la reinstallazione di un componente ed esegue l' [azione RemoveEnvironmentStrings](removeenvironmentstrings-action.md) solo durante la rimozione di un componente.</span><span class="sxs-lookup"><span data-stu-id="9f927-110">The installer runs the WriteEnvironmentStrings action only during the installation or reinstallation of a component, and runs the [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) only during the removal of a component.</span></span>

<span data-ttu-id="9f927-111">I valori vengono scritti o rimossi in base alla selezione di azioni e modificatori primari.</span><span class="sxs-lookup"><span data-stu-id="9f927-111">Values are written or removed based on the selection of primary actions and modifiers.</span></span> <span data-ttu-id="9f927-112">Questi elementi sono descritti nella sezione messaggi ActionData seguenti.</span><span class="sxs-lookup"><span data-stu-id="9f927-112">These are described in the following ActionData Messages section.</span></span> <span data-ttu-id="9f927-113">Si noti che, a seconda dell'azione specificata, WriteEnvironmentStrings può rimuovere le variabili e RemoveEnvironmentStrings può aggiungerle in base alla creazione della [tabella dell'ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="9f927-113">Note that depending on the action specified, WriteEnvironmentStrings may remove variables, and RemoveEnvironmentStrings may add them based on the authoring of the [Environment table](environment-table.md).</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="9f927-114">Restrizioni sequenza</span><span class="sxs-lookup"><span data-stu-id="9f927-114">Sequence Restrictions</span></span>

<span data-ttu-id="9f927-115">L' [azione InstallValidate](installvalidate-action.md) deve essere eseguita prima dell'azione RemoveEnvironmentStrings.</span><span class="sxs-lookup"><span data-stu-id="9f927-115">The [InstallValidate action](installvalidate-action.md) must be executed before the RemoveEnvironmentStrings action.</span></span> <span data-ttu-id="9f927-116">Poiché l'azione WriteEnvironmentStrings e l'azione RemoveEnvironmentStrings non vengono mai applicate durante un'installazione o rimozione di un componente, la relativa sequenza relativa non è limitata.</span><span class="sxs-lookup"><span data-stu-id="9f927-116">Because the WriteEnvironmentStrings action and RemoveEnvironmentStrings action are never both applied during an install or removal of a component, their relative sequence is not restricted.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="9f927-117">Messaggi ActionData</span><span class="sxs-lookup"><span data-stu-id="9f927-117">ActionData Messages</span></span>



| <span data-ttu-id="9f927-118">Campo</span><span class="sxs-lookup"><span data-stu-id="9f927-118">Field</span></span> | <span data-ttu-id="9f927-119">Descrizione dei dati dell'azione</span><span class="sxs-lookup"><span data-stu-id="9f927-119">Description of action data</span></span>                                                                                                                                                                                                  |
|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f927-120">\[1\]</span><span class="sxs-lookup"><span data-stu-id="9f927-120">\[1\]</span></span> | <span data-ttu-id="9f927-121">Nome della variabile di ambiente da modificare.</span><span class="sxs-lookup"><span data-stu-id="9f927-121">Name of the environment variable to modify.</span></span>                                                                                                                                                                                 |
| <span data-ttu-id="9f927-122">\[2\]</span><span class="sxs-lookup"><span data-stu-id="9f927-122">\[2\]</span></span> | <span data-ttu-id="9f927-123">Valore della variabile di ambiente.</span><span class="sxs-lookup"><span data-stu-id="9f927-123">The environment variable value.</span></span>                                                                                                                                                                                             |
| <span data-ttu-id="9f927-124">\[3\]</span><span class="sxs-lookup"><span data-stu-id="9f927-124">\[3\]</span></span> | <span data-ttu-id="9f927-125">Si tratta di un campo di flag di bit che specifica l'azione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="9f927-125">This is a field of bit flags that specifies the action to be performed.</span></span> <span data-ttu-id="9f927-126">Includere solo un bit per un'azione primaria.</span><span class="sxs-lookup"><span data-stu-id="9f927-126">Include only one bit for a primary action.</span></span> <span data-ttu-id="9f927-127">In questo campo può essere incluso più di un bit del modificatore.</span><span class="sxs-lookup"><span data-stu-id="9f927-127">There may be more than one modifier bit included in this field.</span></span> <span data-ttu-id="9f927-128">Vedere le seguenti descrizioni dei flag di bit.</span><span class="sxs-lookup"><span data-stu-id="9f927-128">See the following bit flag descriptions.</span></span> |



 



| <span data-ttu-id="9f927-129">Valore bit</span><span class="sxs-lookup"><span data-stu-id="9f927-129">Bit Value</span></span> | <span data-ttu-id="9f927-130">Descrizione delle azioni primarie</span><span class="sxs-lookup"><span data-stu-id="9f927-130">Description of primary actions</span></span>                                                                                                                                                                                      |
|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f927-131">0x1</span><span class="sxs-lookup"><span data-stu-id="9f927-131">0x1</span></span>       | <span data-ttu-id="9f927-132">Ai posti.</span><span class="sxs-lookup"><span data-stu-id="9f927-132">Set.</span></span> <span data-ttu-id="9f927-133">Imposta il valore della variabile di ambiente in tutti i casi.</span><span class="sxs-lookup"><span data-stu-id="9f927-133">Sets the value of the environment variable in all cases.</span></span><br/> <span data-ttu-id="9f927-134">Se questo bit è combinato con un bit di modificatore Append o prefix, l'azione aggiunge il valore a qualsiasi valore esistente nella variabile.</span><span class="sxs-lookup"><span data-stu-id="9f927-134">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/> |
| <span data-ttu-id="9f927-135">0x2</span><span class="sxs-lookup"><span data-stu-id="9f927-135">0x2</span></span>       | <span data-ttu-id="9f927-136">Ai posti.</span><span class="sxs-lookup"><span data-stu-id="9f927-136">Set.</span></span> <span data-ttu-id="9f927-137">Imposta il valore se la variabile è assente.</span><span class="sxs-lookup"><span data-stu-id="9f927-137">Sets the value if the variable is absent.</span></span><br/> <span data-ttu-id="9f927-138">Se questo bit è combinato con un bit di modificatore Append o prefix, l'azione aggiunge il valore a qualsiasi valore esistente nella variabile.</span><span class="sxs-lookup"><span data-stu-id="9f927-138">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/>                |
| <span data-ttu-id="9f927-139">0x4</span><span class="sxs-lookup"><span data-stu-id="9f927-139">0x4</span></span>       | <span data-ttu-id="9f927-140">Rimuovi.</span><span class="sxs-lookup"><span data-stu-id="9f927-140">Remove.</span></span> <span data-ttu-id="9f927-141">Rimuove il valore dalla variabile.</span><span class="sxs-lookup"><span data-stu-id="9f927-141">Removes the value from the variable.</span></span><br/> <span data-ttu-id="9f927-142">Se questo bit è combinato con un bit di modificatore Append o prefix, il valore viene rimosso dalla stringa esistente, se il valore esiste.</span><span class="sxs-lookup"><span data-stu-id="9f927-142">If this bit is combined with an Append or Prefix modifier bit, the value is removed from the existing string, if the value exists.</span></span><br/>               |



 



| <span data-ttu-id="9f927-143">Valore bit</span><span class="sxs-lookup"><span data-stu-id="9f927-143">Bit Value</span></span>  | <span data-ttu-id="9f927-144">Descrizione del modificatore</span><span class="sxs-lookup"><span data-stu-id="9f927-144">Description of modifier</span></span>                                                                                                                                                              |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f927-145">0x20000000</span><span class="sxs-lookup"><span data-stu-id="9f927-145">0x20000000</span></span> | <span data-ttu-id="9f927-146">Se questo bit è impostato, le azioni vengono applicate alle variabili di ambiente del computer.</span><span class="sxs-lookup"><span data-stu-id="9f927-146">If this bit is set, actions are applied to the machine environment variables.</span></span><br/> <span data-ttu-id="9f927-147">Se questo bit non è impostato, le azioni vengono applicate alle variabili di ambiente dell'utente.</span><span class="sxs-lookup"><span data-stu-id="9f927-147">If this bit is not set, actions are applied to the user's environment variables.</span></span><br/> |
| <span data-ttu-id="9f927-148">0x40000000</span><span class="sxs-lookup"><span data-stu-id="9f927-148">0x40000000</span></span> | <span data-ttu-id="9f927-149">Append.</span><span class="sxs-lookup"><span data-stu-id="9f927-149">Append.</span></span> <span data-ttu-id="9f927-150">Questo bit è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="9f927-150">This bit is optional.</span></span> <span data-ttu-id="9f927-151">Non impostare i modificatori Append e prefix.</span><span class="sxs-lookup"><span data-stu-id="9f927-151">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |
| <span data-ttu-id="9f927-152">0x80000000</span><span class="sxs-lookup"><span data-stu-id="9f927-152">0x80000000</span></span> | <span data-ttu-id="9f927-153">Prefisso.</span><span class="sxs-lookup"><span data-stu-id="9f927-153">Prefix.</span></span> <span data-ttu-id="9f927-154">Questo bit è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="9f927-154">This bit is optional.</span></span> <span data-ttu-id="9f927-155">Non impostare i modificatori Append e prefix.</span><span class="sxs-lookup"><span data-stu-id="9f927-155">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |



 

 

 
