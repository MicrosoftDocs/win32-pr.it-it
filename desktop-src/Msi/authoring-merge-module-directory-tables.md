---
description: Un modulo merge può essere applicato a un file con estensione msi per aggiungere directory all'installazione, ma non è possibile sostituire o rimuovere le directory esistenti.
ms.assetid: 5b808aa2-b2b2-4703-bd57-0b5e1e73b306
title: Creazione di tabelle di directory del modulo merge
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98332f2c0bda10a5cc076f0ec80df3bf4b2e05aa
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103881101"
---
# <a name="authoring-merge-module-directory-tables"></a><span data-ttu-id="31396-103">Creazione di tabelle di directory del modulo merge</span><span class="sxs-lookup"><span data-stu-id="31396-103">Authoring Merge Module Directory Tables</span></span>

<span data-ttu-id="31396-104">Un modulo merge può essere applicato a un file con estensione msi per aggiungere directory all'installazione, ma non è possibile sostituire o rimuovere le directory esistenti.</span><span class="sxs-lookup"><span data-stu-id="31396-104">A merge module can be applied to an .msi file to add directories to the installation but it cannot replace or remove any existing directories.</span></span> <span data-ttu-id="31396-105">La [tabella directory](directory-table.md) specifica il layout delle directory fornite dal modulo merge all'installazione di destinazione.</span><span class="sxs-lookup"><span data-stu-id="31396-105">The [Directory table](directory-table.md) specifies the layout of the directories the merge module provides to the target installation.</span></span> <span data-ttu-id="31396-106">In ogni modulo merge è necessaria una tabella di directory.</span><span class="sxs-lookup"><span data-stu-id="31396-106">A Directory table is required in every merge module.</span></span>

<span data-ttu-id="31396-107">Usare le linee guida seguenti durante la creazione della tabella di directory in un modulo merge.</span><span class="sxs-lookup"><span data-stu-id="31396-107">Use the following guidelines when authoring the Directory Table in a merge module.</span></span> <span data-ttu-id="31396-108">Per ulteriori informazioni, vedere [tabella directory](directory-table.md) e [utilizzo della tabella directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="31396-108">For more information, see [Directory Table](directory-table.md) and [Using The Directory Table](using-the-directory-table.md).</span></span>

-   <span data-ttu-id="31396-109">La struttura di directory aggiunta dal modulo merge deve avere una singola directory radice.</span><span class="sxs-lookup"><span data-stu-id="31396-109">The directory structure added by the merge module must have a single root directory.</span></span> <span data-ttu-id="31396-110">La radice deve essere denominata TARGETDIR.</span><span class="sxs-lookup"><span data-stu-id="31396-110">The root must be named TARGETDIR.</span></span> <span data-ttu-id="31396-111">L'utente può modificare il valore di TARGETDIR durante il merge per specificare la posizione in cui alleghi la struttura di directory del modulo nell'albero di directory della destinazione.</span><span class="sxs-lookup"><span data-stu-id="31396-111">The user may change the value of TARGETDIR during the merge to specify where to attach the module's directory structure onto the target's directory tree.</span></span>
-   <span data-ttu-id="31396-112">Le tabelle del modulo merge diverse dalla tabella di directory non devono fare riferimento direttamente ai percorsi della directory a TARGETDIR.</span><span class="sxs-lookup"><span data-stu-id="31396-112">Merge module tables other than the Directory table must not directly reference directory locations to TARGETDIR.</span></span> <span data-ttu-id="31396-113">Il percorso di tale riferimento viene modificato se l'utente modifica il valore di TARGETDIR.</span><span class="sxs-lookup"><span data-stu-id="31396-113">The location of such a reference changes if the value of TARGETDIR is changed by the user.</span></span>
-   <span data-ttu-id="31396-114">È necessario che le tabelle del modulo merge facciano riferimento al percorso di una directory figlio di TARGETDIR o a un'altra directory nell'albero del modulo merge.</span><span class="sxs-lookup"><span data-stu-id="31396-114">The tables in the merge module must reference the location of a child directory of TARGETDIR, or another directory in the merge module's tree.</span></span> <span data-ttu-id="31396-115">Eseguire le operazioni seguenti per specificare TARGETDIR come elemento padre di una directory nel modulo merge.</span><span class="sxs-lookup"><span data-stu-id="31396-115">Do the following to specify TARGETDIR as the parent of a directory in the merge module.</span></span> <span data-ttu-id="31396-116">Immettere la directory nella colonna directory e immettere TARGETDIR nella \_ colonna padre della directory.</span><span class="sxs-lookup"><span data-stu-id="31396-116">Enter the directory into the Directory column and enter TARGETDIR into the Directory\_Parent column.</span></span> <span data-ttu-id="31396-117">Usare la notazione "." nella colonna DefaultDir per indicare che questa directory si trova in TARGETDIR senza una sottodirectory.</span><span class="sxs-lookup"><span data-stu-id="31396-117">Use the "." notation in the DefaultDir column to indicate that this directory is located in TARGETDIR without a subdirectory.</span></span> <span data-ttu-id="31396-118">Per ulteriori informazioni, vedere [utilizzo della tabella directory](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="31396-118">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
-   <span data-ttu-id="31396-119">I nomi delle directory aggiunte dal modulo merge devono usare le convenzioni di denominazione descritte in [denominazione delle chiavi primarie nei database dei moduli di merge](naming-primary-keys-in-merge-module-databases.md).</span><span class="sxs-lookup"><span data-stu-id="31396-119">The names of directories added by the merge module must use the naming conventions described in [Naming Primary Keys in Merge Module Databases](naming-primary-keys-in-merge-module-databases.md).</span></span> <span data-ttu-id="31396-120">Sono incluse le directory predefinite da proprietà come la proprietà [**SystemFolder**](systemfolder.md) e la proprietà [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="31396-120">This includes directories predefined by properties such as the [**SystemFolder**](systemfolder.md) property and [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span>
-   <span data-ttu-id="31396-121">Aggiungere un [*GUID*](g-gly.md) a ogni voce nella tabella di directory (ad eccezione di TARGETDIR). Sono incluse le voci della tabella di directory che specificano Windows Installer proprietà [**SystemFolder**](systemfolder.md) , ad esempio SystemFolder. 00000000 \_ 0000 \_ 0000 \_ 0000 \_ 000000000000.</span><span class="sxs-lookup"><span data-stu-id="31396-121">Append a [*GUID*](g-gly.md) to every entry in the Directory table (except TARGETDIR.) This includes Directory table entries that specify Windows Installer [**SystemFolder**](systemfolder.md) properties, for example, SystemFolder.00000000\_0000\_0000\_0000\_000000000000.</span></span> <span data-ttu-id="31396-122">La libreria Mergemod.dll aggiunge azioni personalizzate per impostare la proprietà **SystemFolder** .</span><span class="sxs-lookup"><span data-stu-id="31396-122">The library Mergemod.dll adds custom actions to set the **SystemFolder** property.</span></span>
-   <span data-ttu-id="31396-123">Quando in un modulo merge viene inclusa una directory predefinita, lo strumento di merge aggiunge automaticamente al database di destinazione un' [azione personalizzata di tipo 51](custom-action-type-51.md) .</span><span class="sxs-lookup"><span data-stu-id="31396-123">When a predefined directory is included in a merge module, the merge tool automatically adds a [Custom Action Type 51](custom-action-type-51.md) to the target database.</span></span> <span data-ttu-id="31396-124">L'autore del modulo merge deve verificare che sia inclusa anche una [tabella CustomAction](customaction-table.md) .</span><span class="sxs-lookup"><span data-stu-id="31396-124">The merge module author must ensure that a [CustomAction table](customaction-table.md) is also included.</span></span> <span data-ttu-id="31396-125">La tabella CustomAction può essere vuota, ma la tabella deve esistere nel database di destinazione e garantisce che le directory predefinite modificate vengano scritte nei percorsi corretti.</span><span class="sxs-lookup"><span data-stu-id="31396-125">The CustomAction table may be empty, but this table is required to exist in the target database and ensures that the modified predefined directories are written to the correct locations.</span></span> <span data-ttu-id="31396-126">Ad esempio, quando una directory di sistema è inclusa in un modulo merge, l'autore del modulo merge deve verificare che sia presente una tabella delle azioni personalizzata.</span><span class="sxs-lookup"><span data-stu-id="31396-126">For example, when a system directory is included in a merge module, the merge module author must ensure that a Custom Action table exists.</span></span>

    <span data-ttu-id="31396-127">Si noti che l'algoritmo di corrispondenza per la generazione di queste azioni personalizzate di tipo 51 controlla solo che il nome di directory inizi con una delle proprietà [**SystemFolder**](systemfolder.md) predefinite.</span><span class="sxs-lookup"><span data-stu-id="31396-127">Note that the matching algorithm for the generation of these type 51 custom actions only checks that the directory name begins with one of the predefined [**SystemFolder**](systemfolder.md) properties.</span></span> <span data-ttu-id="31396-128">Non verifica che il nome di directory corrisponda esattamente alla proprietà della directory.</span><span class="sxs-lookup"><span data-stu-id="31396-128">It does not verify that the directory name exactly equals the directory property.</span></span> <span data-ttu-id="31396-129">Tutte le directory che iniziano con uno di questi nomi di cartella standard ottengono un'azione personalizzata di tipo 51, anche se il resto del nome non è un GUID.</span><span class="sxs-lookup"><span data-stu-id="31396-129">Any directory beginning with one of these standard folder names gets a type 51 custom action, even if the rest of the name is not a GUID.</span></span> <span data-ttu-id="31396-130">È necessario che gli autori si occupino di non generare corrispondenze false positive e la generazione di azioni personalizzate non intenzionali, su chiavi primarie derivate che iniziano con una delle proprietà **SystemFolder** .</span><span class="sxs-lookup"><span data-stu-id="31396-130">Authors need to take care that this does not generate false positive matches, and unintended custom action generation, on derivative primary keys that begin with one of the **SystemFolder** properties.</span></span>

<span data-ttu-id="31396-131">Di seguito è riportato un esempio di tabella di directory in un modulo merge e le directory risolte previste.</span><span class="sxs-lookup"><span data-stu-id="31396-131">The following is an example of a Directory table in a merge module and the expected resolved directories.</span></span>



| <span data-ttu-id="31396-132">Directory</span><span class="sxs-lookup"><span data-stu-id="31396-132">Directory</span></span>                                              | <span data-ttu-id="31396-133">\_Padre directory</span><span class="sxs-lookup"><span data-stu-id="31396-133">Directory\_Parent</span></span>                                | <span data-ttu-id="31396-134">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="31396-134">DefaultDir</span></span>  |
|--------------------------------------------------------|--------------------------------------------------|-------------|
| <span data-ttu-id="31396-135">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="31396-135">TARGETDIR</span></span>                                              |                                                  | <span data-ttu-id="31396-136">SourceDir</span><span class="sxs-lookup"><span data-stu-id="31396-136">SourceDir</span></span>   |
| <span data-ttu-id="31396-137">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-137">Dir00.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="31396-138">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="31396-138">TARGETDIR</span></span>                                        | <span data-ttu-id="31396-139">.: \_ PROG mmm</span><span class="sxs-lookup"><span data-stu-id="31396-139">.:MMM\_Prog</span></span> |
| <span data-ttu-id="31396-140">SystemFolder. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-140">SystemFolder.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span> | <span data-ttu-id="31396-141">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="31396-141">TARGETDIR</span></span>                                        | <span data-ttu-id="31396-142">\_Sys mmm</span><span class="sxs-lookup"><span data-stu-id="31396-142">MMM\_Sys</span></span>    |
| <span data-ttu-id="31396-143">Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-143">Dir02.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="31396-144">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848 \_ 006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-144">Dir00.BC82E350\_ C7FC\_11d1\_ A848\_006097ABDE17</span></span> | <span data-ttu-id="31396-145">\_ocx MFC</span><span class="sxs-lookup"><span data-stu-id="31396-145">MFC\_OCX</span></span>    |



 

<span data-ttu-id="31396-146">Si prevede che un modulo merge con la tabella di directory precedente provochi la seguente struttura di directory.</span><span class="sxs-lookup"><span data-stu-id="31396-146">A merge module with the above Directory table is expected to result in the following directory structure.</span></span>



| <span data-ttu-id="31396-147">Directory</span><span class="sxs-lookup"><span data-stu-id="31396-147">Directory</span></span>                                              | <span data-ttu-id="31396-148">Destinazione</span><span class="sxs-lookup"><span data-stu-id="31396-148">Target</span></span>                                     | <span data-ttu-id="31396-149">Source (Sorgente)</span><span class="sxs-lookup"><span data-stu-id="31396-149">Source</span></span>                                               |
|--------------------------------------------------------|--------------------------------------------|------------------------------------------------------|
| <span data-ttu-id="31396-150">Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-150">Dir00.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="31396-151">\[Punto di installazione del modulo di merge\]</span><span class="sxs-lookup"><span data-stu-id="31396-151">\[Merge Module's Install Point\]</span></span>\\         | <span data-ttu-id="31396-152">\[\] \\ PROG mmm punto di origine del modulo di merge \_</span><span class="sxs-lookup"><span data-stu-id="31396-152">\[Merge Module's Source Point\]\\MMM\_Prog</span></span>           |
| <span data-ttu-id="31396-153">SystemFolder. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-153">SystemFolder.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span> | <span data-ttu-id="31396-154">\[SystemFolder\]</span><span class="sxs-lookup"><span data-stu-id="31396-154">\[SystemFolder\]</span></span>\\                         | <span data-ttu-id="31396-155">\[Il punto di origine del modulo di Unione \] \\ mmm \_ sys</span><span class="sxs-lookup"><span data-stu-id="31396-155">\[Merge Module's Source Point\]\\MMM\_Sys</span></span>            |
| <span data-ttu-id="31396-156">Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17</span><span class="sxs-lookup"><span data-stu-id="31396-156">Dir02.BC82E350\_ C7FC\_11d1\_ A848-006097ABDE17</span></span>        | <span data-ttu-id="31396-157">\[OCX per il punto di installazione del modulo di merge \] \\ \_</span><span class="sxs-lookup"><span data-stu-id="31396-157">\[Merge Module's Install Point\]\\MFC\_OCX</span></span> | <span data-ttu-id="31396-158">\[Punto di origine del modulo di merge- \] \\ \_ PROG \\ MFC \_ ocx</span><span class="sxs-lookup"><span data-stu-id="31396-158">\[Merge Module's Source Point\]\\MMM\_Prog\\MFC\_OCX</span></span> |



 

 

 



