---
description: È possibile aggiungere informazioni di localizzazione a un database di installazione utilizzando un editor tabelle di database, ad esempio ORCA fornito con l'SDK di Windows Installer o chiamando le funzioni di database da un'applicazione.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Gestione della tabella codici delle stringhe di parametro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104226357"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="a168f-103">Gestione della tabella codici delle stringhe di parametro</span><span class="sxs-lookup"><span data-stu-id="a168f-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="a168f-104">È possibile aggiungere informazioni di localizzazione a un database di installazione utilizzando un editor tabelle di database, ad esempio ORCA fornito con l'SDK di Windows Installer o chiamando le [funzioni di database](database-functions.md) da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a168f-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="a168f-105">Prestare attenzione a passare solo i parametri di stringa che usano la tabella codici del database in fase di localizzazione.</span><span class="sxs-lookup"><span data-stu-id="a168f-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="a168f-106">Se un parametro di stringa contiene caratteri che non possono essere rappresentati dalla tabella codici del database, il programma di installazione restituisce un errore durante la chiamata a [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="a168f-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="a168f-107">Per un elenco di tabelle codici numeriche, vedere [localizzazione delle tabelle Error e ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a168f-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="a168f-108">Per ulteriori informazioni, vedere la pagina relativa alla [determinazione della tabella codici di un database di installazione](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="a168f-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="a168f-109">Aggiunta di informazioni di localizzazione a un database</span><span class="sxs-lookup"><span data-stu-id="a168f-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="a168f-110">Quando si aggiungono informazioni di localizzazione a un database, la tabella codici del database deve essere supportata dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="a168f-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="a168f-111">Non è necessario che sia la tabella codici corrente del sistema.</span><span class="sxs-lookup"><span data-stu-id="a168f-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="a168f-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) deve restituire **true** per la tabella codici del database.</span><span class="sxs-lookup"><span data-stu-id="a168f-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="a168f-113">Poiché il sistema converte le stringhe ANSI in Unicode, si verifica un errore se la tabella codici dell'utente corrente non corrisponde alla tabella codici del database.</span><span class="sxs-lookup"><span data-stu-id="a168f-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="a168f-114">La chiamata della versione ANSI dell'API Windows Installer converte la stringa localizzata in Unicode usando la tabella codici di sistema corrente.</span><span class="sxs-lookup"><span data-stu-id="a168f-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="a168f-115">Quando viene eseguito il commit del database, la stringa Unicode viene convertita in ANSI utilizzando la tabella codici del database.</span><span class="sxs-lookup"><span data-stu-id="a168f-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="a168f-116">Se la tabella codici di sistema corrente è diversa dalla tabella codici della stringa localizzata, il risultato può essere una perdita di dati e una conversione di stringa non corretta.</span><span class="sxs-lookup"><span data-stu-id="a168f-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="a168f-117">Nella procedura riportata di seguito viene illustrato come archiviare i dati di localizzazione.</span><span class="sxs-lookup"><span data-stu-id="a168f-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="a168f-118">**Per archiviare i dati di localizzazione**</span><span class="sxs-lookup"><span data-stu-id="a168f-118">**To store localization data**</span></span>

1.  <span data-ttu-id="a168f-119">Impostare la tabella codici del database sulla tabella codici della stringa localizzata.</span><span class="sxs-lookup"><span data-stu-id="a168f-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="a168f-120">Convertire la stringa ANSI in Unicode usando la funzione [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) e specificare la tabella codici dei dati localizzati.</span><span class="sxs-lookup"><span data-stu-id="a168f-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="a168f-121">Chiamare la versione Unicode dell'API Windows Installer usando la stringa Unicode per aggiungere i dati localizzati.</span><span class="sxs-lookup"><span data-stu-id="a168f-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="a168f-122">Eseguire il commit delle modifiche di localizzazione nel database tramite [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="a168f-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="a168f-123">È inoltre possibile aggiungere informazioni di localizzazione a un database di installazione importando ed esportando i file di archivio di testo ASCII.</span><span class="sxs-lookup"><span data-stu-id="a168f-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="a168f-124">Per ulteriori informazioni, vedere [gestione di tabelle codici per le tabelle importate ed esportate](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a168f-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
