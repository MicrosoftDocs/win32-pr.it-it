---
description: Un writer può non riuscire per diversi motivi programmatici.
ms.assetid: 50eced73-3917-4d7e-96cc-2d793b448738
title: Errori e veto del writer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c24c15ad10766fc6ec395ed058ab3cb72a689d9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104226108"
---
# <a name="writer-errors-and-vetoes"></a><span data-ttu-id="00f2b-103">Errori e veto del writer</span><span class="sxs-lookup"><span data-stu-id="00f2b-103">Writer Errors and Vetoes</span></span>

<span data-ttu-id="00f2b-104">Un writer può non riuscire per diversi motivi programmatici.</span><span class="sxs-lookup"><span data-stu-id="00f2b-104">A writer can fail for numerous programmatic reasons.</span></span> <span data-ttu-id="00f2b-105">Quando si verifica questa situazione, è necessario porre il veto sull'operazione di backup, ripristino o copia shadow in corso chiamando il metodo [**CVssWriter:: SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure) in uno dei relativi metodi di gestione (ad esempio, [**CVssWriter:: OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) o [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) e restituendo **true**.</span><span class="sxs-lookup"><span data-stu-id="00f2b-105">When this happens, it should veto the ongoing backup, restore, or shadow copy operation by calling the [**CVssWriter::SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure) method in one of its handler methods (for example, [**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) or [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) and returning **TRUE**.</span></span> <span data-ttu-id="00f2b-106">Può anche impostare facoltativamente una stringa del messaggio di errore in risposta a una condizione di errore in determinati metodi del gestore con i metodi [**IVssComponentEx:: SetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setprepareforbackupfailuremsg), [**IVssComponentEx:: SetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setpostsnapshotfailuremsg), [**IVssComponent:: SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)e [**IVssComponent:: SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg) .</span><span class="sxs-lookup"><span data-stu-id="00f2b-106">It can also optionally set an error message string in response to a failure condition in certain handler methods with the [**IVssComponentEx::SetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setprepareforbackupfailuremsg), [**IVssComponentEx::SetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setpostsnapshotfailuremsg), [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), and [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg) methods.</span></span> <span data-ttu-id="00f2b-107">Il richiedente può accettare il veto o continuare con il backup, ignorando il veto.</span><span class="sxs-lookup"><span data-stu-id="00f2b-107">The requester can accept the veto or continue with the backup, ignoring the veto.</span></span>

<span data-ttu-id="00f2b-108">Un richiedente deve controllare lo stato del writer (usando [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) e [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)) dopo ogni evento generato.</span><span class="sxs-lookup"><span data-stu-id="00f2b-108">A requester should check the writer status (using [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) and [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)) following each event it generates.</span></span>

<span data-ttu-id="00f2b-109">In alcuni casi, è possibile recuperare i messaggi di errore da questi errori (usando i metodi [**IVssComponentEx:: GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg), [**IVssComponent:: GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**IVssComponentEx:: GetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getpostsnapshotfailuremsg)e [**IVssComponent:: GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg) ) oppure un writer può scegliere di impostare i metadati (usando [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata) e [**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) con informazioni sullo stato di errore).</span><span class="sxs-lookup"><span data-stu-id="00f2b-109">In some cases, error messages can be retrieved from these failures (using the [**IVssComponentEx::GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg), [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**IVssComponentEx::GetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getpostsnapshotfailuremsg), and [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg) methods), or a writer may choose to set metadata (using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata) and [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) with error state information).</span></span> <span data-ttu-id="00f2b-110">Per un esempio di codice in cui viene illustrato come visualizzare tali messaggi di errore, vedere [**IVssComponentEx:: GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg).</span><span class="sxs-lookup"><span data-stu-id="00f2b-110">For example code that shows how to view such error messages, see [**IVssComponentEx::GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg).</span></span>

<span data-ttu-id="00f2b-111">A seconda dello stato di errore, un richiedente o il relativo operatore può riavviare il backup e la copia shadow con qualsiasi modifica necessaria allo stato del processo o del sistema di backup.</span><span class="sxs-lookup"><span data-stu-id="00f2b-111">Depending on the error state, a requester or its operator could restart the backup and shadow copy with any necessary modification to the state of the backup job or system.</span></span>

<span data-ttu-id="00f2b-112">Si supponga, ad esempio, che [**GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) abbia restituito quanto segue:</span><span class="sxs-lookup"><span data-stu-id="00f2b-112">For example, suppose [**GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) returned the following:</span></span>

-   <span data-ttu-id="00f2b-113">Servizio Copia **shadow \_ del volume E \_ WRITERERROR \_ INCONSISTENTSNAPSHOT** suggerisce che un richiedente potrebbe aggiungere volumi aggiuntivi alla copia shadow</span><span class="sxs-lookup"><span data-stu-id="00f2b-113">**VSS\_E\_WRITERERROR\_INCONSISTENTSNAPSHOT** suggests that a requester might add additional volumes to the shadow copy</span></span>
-   <span data-ttu-id="00f2b-114">Servizio Copia **shadow \_ del volume E \_ WRITERERROR \_** indica che il nuovo tentativo senza riconfigurazione potrebbe funzionare.</span><span class="sxs-lookup"><span data-stu-id="00f2b-114">**VSS\_E\_WRITERERROR\_RETRYABLE** indicates that retrying without reconfiguration might work.</span></span> <span data-ttu-id="00f2b-115">Se il writer continua a restituire l'errore dopo diversi tentativi, provare a riavviare il servizio che ospita il writer.</span><span class="sxs-lookup"><span data-stu-id="00f2b-115">If the writer continues to return the error after several retries, try restarting the service that hosts the writer.</span></span> <span data-ttu-id="00f2b-116">I writer seguenti sono ospitati nel servizio Copia Shadow del volume: writer del registro di sistema, writer del database di registrazione della classe COM+, writer di ottimizzazione della copia shadow e writer di ripristino automatico del sistema (ASR).</span><span class="sxs-lookup"><span data-stu-id="00f2b-116">The following writers are hosted in the VSS service: registry writer, COM+ class registration database writer, shadow copy optimization writer, and Automated System Recovery (ASR) writer.</span></span> <span data-ttu-id="00f2b-117">Se il writer appartiene a un'applicazione che ospita il writer nel proprio processo, provare a riavviare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="00f2b-117">If the writer belongs to an application that hosts the writer in its own process, try restarting the application.</span></span>

    <span data-ttu-id="00f2b-118">**Windows Server 2003 e Windows XP:** I writer seguenti sono ospitati nel servizio Copia Shadow del volume: writer del registro di sistema, writer del database di registrazione della classe COM+, writer del registro eventi dell'applicazione e Microsoft SQL Server writer di 2000 Desktop Engine (MSDE).</span><span class="sxs-lookup"><span data-stu-id="00f2b-118">**Windows Server 2003 and Windows XP:** The following writers are hosted in the VSS service: registry writer, COM+ class registration database writer, application event log writer, and Microsoft SQL Server 2000 Desktop Engine (MSDE) writer.</span></span>

-   <span data-ttu-id="00f2b-119">\_ \_ Lo stato VSS e writer \_ \_ non \_ disponibile indica che un writer potrebbe avere raggiunto il numero massimo di sessioni di backup e ripristino disponibili e il nuovo tentativo potrebbe funzionare quando il sistema è meno occupato.</span><span class="sxs-lookup"><span data-stu-id="00f2b-119">VSS\_E\_WRITER\_STATUS\_NOT\_AVAILABLE indicates that a writer may have reached the maximum number of available backup and restore sessions, and retrying might work when the system is less busy.</span></span>
-   <span data-ttu-id="00f2b-120">Servizio Copia **shadow \_ del volume E \_ WRITERERROR \_ OUTOFRESOURCES** o **VSS \_ e \_ WRITERERROR \_ timeout** potrebbe suggerire la riduzione del carico di sistema prima di riprovare</span><span class="sxs-lookup"><span data-stu-id="00f2b-120">**VSS\_E\_WRITERERROR\_OUTOFRESOURCES** or **VSS\_E\_WRITERERROR\_TIMEOUT** might suggest that system load be reduced prior to retrying</span></span>
-   <span data-ttu-id="00f2b-121">Servizio Copia **shadow \_ del volume E \_ WRITERERROR \_ nonretryable** o **VSS \_ e \_ writer \_ non \_ risponde** probabilmente indicherebbe un errore del writer così grave da impedire il tentativo di eseguire il backup dei dati con VSS.</span><span class="sxs-lookup"><span data-stu-id="00f2b-121">**VSS\_E\_WRITERERROR\_NONRETRYABLE** or **VSS\_E\_WRITER\_NOT\_RESPONDING** would likely indicate a writer error so severe as to preclude trying to back up its data with VSS.</span></span>

<span data-ttu-id="00f2b-122">A seconda del writer e dei componenti che li generano, non è sempre necessario che un'applicazione di backup si interrompa dopo un errore o un veto.</span><span class="sxs-lookup"><span data-stu-id="00f2b-122">Depending on which writer and which components generate them, it is not always necessary for a backup application to abort following a veto or error.</span></span>

<span data-ttu-id="00f2b-123">Ad esempio, un richiedente può decidere che lo scopo della copia shadow è eseguire il backup dell'applicazione A e il veto è stato ricevuto dal writer per l'applicazione di backup B. In questo caso, è perfettamente accettabile continuare a eseguire il backup dell'applicazione A ignorando il veto.</span><span class="sxs-lookup"><span data-stu-id="00f2b-123">For example, a requester may decide that the intent of the shadow copy is to back up application A and the veto has been received from the writer for backup application B. In this case, it is perfectly acceptable to continue to back up application A while ignoring the veto.</span></span>

<span data-ttu-id="00f2b-124">Di seguito sono riportati alcuni esempi di veto del writer:</span><span class="sxs-lookup"><span data-stu-id="00f2b-124">The following are examples of a writer veto:</span></span>

-   <span data-ttu-id="00f2b-125">Il writer oppone il processo di creazione della copia shadow quando non è stato possibile sospendere le attività durante la creazione della copia shadow.</span><span class="sxs-lookup"><span data-stu-id="00f2b-125">The writer vetoes the shadow copy creation process when it could not suspend its activities during the time the shadow copy was being created.</span></span> <span data-ttu-id="00f2b-126">Ciò indica una probabilità elevata che la copia shadow non è valida perché si è verificata un'operazione di scrittura durante lo stato di blocco.</span><span class="sxs-lookup"><span data-stu-id="00f2b-126">This indicates that there is a high probability that the shadow copy is not valid because a write operation has occurred during the Freeze state.</span></span>
-   <span data-ttu-id="00f2b-127">Un'applicazione di backup ha richiesto una copia shadow solo del volume C: e un writer determina che una copia shadow di C: e D: deve eseguire il backup dei dati.</span><span class="sxs-lookup"><span data-stu-id="00f2b-127">A backup application has requested a shadow copy of only volume C: and a writer determines that a shadow copy of C: and D: is to back up its data.</span></span> <span data-ttu-id="00f2b-128">In questo caso, il writer effettuerà il veto.</span><span class="sxs-lookup"><span data-stu-id="00f2b-128">In this case, the writer will veto.</span></span> <span data-ttu-id="00f2b-129">L'applicazione di backup può esaminare i metadati e determinare se il writer verrà ignorato o se il processo di creazione della copia shadow verrà interrotto e riavviato in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="00f2b-129">The backup application may examine the metadata and determine whether the writer will be ignored or the shadow copy creation process will be aborted and later restarted.</span></span>

 

 



