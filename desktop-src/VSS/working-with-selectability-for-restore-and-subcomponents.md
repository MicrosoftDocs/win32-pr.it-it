---
description: La selezione per il ripristino consente al richiedente di determinare quando un componente può essere ripristinato singolarmente.
ms.assetid: 684dc50f-5d7b-4c95-85dd-77c320d65fff
title: Utilizzo della selezione per il ripristino e i sottocomponenti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d988f4c4e029c7dd8623ad22fcaee7662d33e82
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526262"
---
# <a name="working-with-selectability-for-restore-and-subcomponents"></a><span data-ttu-id="1ebdc-103">Utilizzo della selezione per il ripristino e i sottocomponenti</span><span class="sxs-lookup"><span data-stu-id="1ebdc-103">Working with Selectability For Restore and Subcomponents</span></span>

<span data-ttu-id="1ebdc-104">La selezione per il ripristino consente al richiedente di determinare quando un componente può essere ripristinato singolarmente.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-104">Selectability for restore allows the requester to determine when a component can be individually restored.</span></span> <span data-ttu-id="1ebdc-105">Un componente incluso per il backup può essere visualizzato in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="1ebdc-105">A component that has been included for backup can appear in one of two ways:</span></span>

-   <span data-ttu-id="1ebdc-106">È possibile che un componente sia stato [*incluso in modo esplicito*](vssgloss-e.md) nel backup.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-106">A component may have been [*explicitly included*](vssgloss-e.md) in the backup.</span></span> <span data-ttu-id="1ebdc-107">Questi componenti hanno un'istanza di [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corrispondente nel documento componenti di backup.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-107">These components have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document.</span></span> <span data-ttu-id="1ebdc-108">Questi componenti sono inclusi in un ripristino con [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="1ebdc-108">These components are included in a restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>
-   <span data-ttu-id="1ebdc-109">È possibile che un componente sia stato [*incluso in modo implicito*](vssgloss-i.md) nel backup.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-109">A component may have been [*implicitly included*](vssgloss-i.md) in the backup.</span></span> <span data-ttu-id="1ebdc-110">Questi componenti non hanno un'istanza di [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corrispondente nel documento dei componenti di backup; Tuttavia, nel documento sarà sempre presente un'istanza di **IVssComponent** per un componente predecessore.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-110">These components do not have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document; however, there will always be an **IVssComponent** instance for some ancestor component in the document.</span></span> <span data-ttu-id="1ebdc-111">Questi componenti sono inclusi in un ripristino con [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="1ebdc-111">These components are included in a restore using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="1ebdc-112">Tutti i componenti inclusi in modo esplicito nel backup possono essere sempre selezionati singolarmente per il ripristino, indipendentemente dal valore di selezione per il ripristino.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-112">Any component that has been explicitly included in the backup can always be individually selected for restore, regardless of its selectability-for-restore value.</span></span> <span data-ttu-id="1ebdc-113">Il richiedente chiama [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passando l'ID del writer, il percorso logico e il nome del componente specifico.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-113">The requester calls [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passing in the writer ID, logical path, and name of the specific component.</span></span> <span data-ttu-id="1ebdc-114">I componenti che sono stati inclusi in modo implicito nel backup verranno ripristinati quando viene ripristinato un predecessore incluso in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-114">Components that have been implicitly included in the backup will be restored when an explicitly included ancestor is restored.</span></span> <span data-ttu-id="1ebdc-115">I componenti inclusi in modo implicito possono essere selezionati singolarmente per il ripristino solo se sono contrassegnati come selezionabili per il ripristino.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-115">Implicitly included components can be individually selected for restore only if they are marked as selectable for restore.</span></span> <span data-ttu-id="1ebdc-116">Il richiedente chiama prima **IVssBackupComponents:: SetSelectedForRestore** sul componente predecessore incluso in modo esplicito più vicino, quindi chiama [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) sul componente predecessore per selezionare il componente incluso in modo implicito per il ripristino.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-116">The requester first calls **IVssBackupComponents::SetSelectedForRestore** on the closest explicitly included ancestor component, and then calls [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) on the ancestor component to select the implicitly included component for restore.</span></span> <span data-ttu-id="1ebdc-117">Al termine, verrà ripristinato solo il componente selezionato in modo implicito; tutti gli altri componenti del set di componenti non verranno ripristinati.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-117">After this is done, only the implicitly selected component will be restored; all other components in the component set will not be restored.</span></span>

<span data-ttu-id="1ebdc-118">A differenza della selezione per il backup, che deve sempre essere impostata in modo esplicito quando un componente viene aggiunto con [**IVssCreateWriterMetadata:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), la selezione per il ripristino ha un valore predefinito false, che può essere sottoposto a override.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-118">Unlike selectability for backup, which must always be explicitly set when a component is added with [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), selectability for restore has a default value of false, which can be overridden.</span></span>

<span data-ttu-id="1ebdc-119">Poiché i componenti di primo livello, ovvero i componenti con un percorso logico vuoto, possono essere inclusi in modo esplicito solo in un backup, la selezione per il ripristino non ha alcun significato per questi componenti.</span><span class="sxs-lookup"><span data-stu-id="1ebdc-119">Because top-level components (components with an empty logical path) can only be explicitly included in a backup, selectability for restore has no meaning for these components.</span></span>

 

 



