---
description: 'Il modello di transizione dello stato in un provider di copie shadow è semplificato dalla serializzazione della creazione della copia shadow dal momento in cui viene chiamato IVssBackupComponents:: StartSnapshotSet finché la chiamata a IVssBackupComponents::D oSnapshotSet restituisce.'
ms.assetid: 5dbf0fb3-53cb-4532-9a8f-bd955afe16c4
title: Transizioni di stato nei provider di copie shadow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d628d11419158f947225b2e4cabd7f93975f421
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311844"
---
# <a name="state-transitions-in-shadow-copy-providers"></a><span data-ttu-id="6e5de-103">Transizioni di stato nei provider di copie shadow</span><span class="sxs-lookup"><span data-stu-id="6e5de-103">State Transitions in Shadow Copy Providers</span></span>

<span data-ttu-id="6e5de-104">Il modello di transizione dello stato in un provider di copie shadow è semplificato dalla serializzazione della creazione della copia shadow dal momento in cui viene chiamato [**IVssBackupComponents:: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) finché la chiamata a [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) restituisce.</span><span class="sxs-lookup"><span data-stu-id="6e5de-104">The state transition model in a shadow copy provider is simplified by the serialization of shadow copy creation from the time that [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) is called until the call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) returns.</span></span> <span data-ttu-id="6e5de-105">Se un altro richiedente tenta di creare una copia shadow durante questo periodo di tempo, la chiamata a **StartSnapshotSet** avrà esito negativo con errore **VSS \_ e \_ \_ set \_ di snapshot in \_ corso, a** indicare che il secondo richiedente deve attendere e riprovare.</span><span class="sxs-lookup"><span data-stu-id="6e5de-105">If another requester tries to create a shadow copy during this time, the call to **StartSnapshotSet** will fail with error **VSS\_E\_SNAPSHOT\_SET\_IN\_PROGRESS**, indicating that the second requester should wait and try again.</span></span>

<span data-ttu-id="6e5de-106">VSS chiamerà solo [**IVssProviderCreateSnapshotSet:: AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) dopo che il richiedente ha chiamato [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), anche se la copia shadow ha esito negativo o viene interrotta prima di questo punto.</span><span class="sxs-lookup"><span data-stu-id="6e5de-106">VSS will only call [**IVssProviderCreateSnapshotSet::AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) after the requester has called [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), even if the shadow copy fails or is aborted before this point.</span></span> <span data-ttu-id="6e5de-107">Questo significa che un provider non riceverà una chiamata a **AbortSnapshots** fino a quando non viene chiamato [**IVssProviderCreateSnapshotSet:: EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) .</span><span class="sxs-lookup"><span data-stu-id="6e5de-107">This means that a provider will not receive a call to **AbortSnapshots** until after [**IVssProviderCreateSnapshotSet::EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) has been called.</span></span> <span data-ttu-id="6e5de-108">Se una copia shadow viene interrotta o ha esito negativo prima di questo punto, al provider non viene fornita alcuna indicazione fino a quando non viene avviata una nuova copia shadow.</span><span class="sxs-lookup"><span data-stu-id="6e5de-108">If a shadow copy is aborted or fails before this point, the provider is not given any indication until a new shadow copy is started.</span></span> <span data-ttu-id="6e5de-109">Per questo motivo, il provider deve essere preparato a gestire una chiamata out-of-Sequence a [**IVssHardwareSnapshotProvider:: BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="6e5de-109">For this reason, the provider must be prepared to handle an out-of-sequence call to [**IVssHardwareSnapshotProvider::BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) at any point.</span></span> <span data-ttu-id="6e5de-110">Questa chiamata fuori sequenza rappresenta l'inizio di una nuova sequenza di copia shadow e avrà un nuovo ID del set di copie shadow.</span><span class="sxs-lookup"><span data-stu-id="6e5de-110">This out-of-sequence call represents the start of a new shadow copy sequence and will have a new shadow copy set ID.</span></span>

 

 



