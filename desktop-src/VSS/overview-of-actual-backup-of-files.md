---
description: VSS consente a un richiedente di accedere alla copia shadow dei volumi contenenti i dati per il backup e di copiare i dati nei supporti di backup.
ms.assetid: 187f26f2-f191-4703-9bde-3357f1ceef0c
title: Panoramica del backup effettivo dei file
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98a504ff5a41725e33a2eb27792a3c6c89d00276
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310695"
---
# <a name="overview-of-actual-backup-of-files"></a><span data-ttu-id="9a57c-103">Panoramica del backup effettivo dei file</span><span class="sxs-lookup"><span data-stu-id="9a57c-103">Overview of Actual Backup Of Files</span></span>

<span data-ttu-id="9a57c-104">VSS consente a un richiedente di accedere alla copia shadow dei volumi contenenti i dati per il backup e di copiare i dati nei supporti di backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-104">VSS enables a requester to access the shadow copy of volumes containing data for backup and to copy data to backup media.</span></span> <span data-ttu-id="9a57c-105">In genere i writer procedono con il normale funzionamento durante questo processo.</span><span class="sxs-lookup"><span data-stu-id="9a57c-105">Writers generally proceed with normal operation during this process.</span></span> <span data-ttu-id="9a57c-106">Per ulteriori informazioni, vedere [Cenni preliminari sull'elaborazione di un backup in VSS](overview-of-processing-a-backup-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="9a57c-106">For more information, see [Overview of Processing a Backup Under VSS](overview-of-processing-a-backup-under-vss.md).</span></span>

<span data-ttu-id="9a57c-107">Nella tabella seguente viene illustrata la sequenza di azioni ed eventi necessari per i file di cui eseguire il backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-107">The following table shows the sequence of actions and events that are required for files to be backed up.</span></span>



<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="9a57c-108">Azione del richiedente</span><span class="sxs-lookup"><span data-stu-id="9a57c-108">Requester action</span></span></th>
<th><span data-ttu-id="9a57c-109">Evento</span><span class="sxs-lookup"><span data-stu-id="9a57c-109">Event</span></span></th>
<th><span data-ttu-id="9a57c-110">Azione del writer</span><span class="sxs-lookup"><span data-stu-id="9a57c-110">Writer action</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="9a57c-111">Accedere ai file nel volume copiato Shadow (vedere <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties"><strong>IVssBackupComponents:: GetSnapshotProperties</strong></a>, <a href="/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop"><strong>VSS_SNAPSHOT_PROP</strong></a>)</span><span class="sxs-lookup"><span data-stu-id="9a57c-111">Access files on the shadow-copied volume (see <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties"><strong>IVssBackupComponents::GetSnapshotProperties</strong></a>, <a href="/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop"><strong>VSS_SNAPSHOT_PROP</strong></a>)</span></span></td>
<td><span data-ttu-id="9a57c-112">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-112">None</span></span></td>
<td><span data-ttu-id="9a57c-113">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-113">None</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9a57c-114">Generare l'elenco dei file di cui eseguire il backup e copiare i dati dei file nei supporti di backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-114">Generate the list of files to back up, and copy file data to backup media.</span></span></td>
<td><span data-ttu-id="9a57c-115">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-115">None</span></span></td>
<td><span data-ttu-id="9a57c-116">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-116">None</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9a57c-117">Indicare l'esito positivo o negativo del backup con <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded"><strong>IVssBackupComponents:: SetBackupSucceeded</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="9a57c-117">Indicate the success or failure of the backup with <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded"><strong>IVssBackupComponents::SetBackupSucceeded</strong></a>.</span></span></td>
<td><span data-ttu-id="9a57c-118">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-118">None</span></span></td>
<td><span data-ttu-id="9a57c-119">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-119">None</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9a57c-120">Il richiedente indica che il backup è stato completato chiamando <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete"><strong>IVssBackupComponents:: BackupComplete</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="9a57c-120">The requester indicates that the backup has completed by calling <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete"><strong>IVssBackupComponents::BackupComplete</strong></a>.</span></span></td>
<td><span data-ttu-id="9a57c-121"><a href="vssgloss-b.md"><em>BackupComplete</em></a></span><span class="sxs-lookup"><span data-stu-id="9a57c-121"><a href="vssgloss-b.md"><em>BackupComplete</em></a></span></span></td>
<td><span data-ttu-id="9a57c-122">Eseguire una pulizia successiva al backup (vedere <a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete"><strong>CVssWriter:: OnBackupComplete</strong></a>, <a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents"><strong>IVssWriterComponents</strong></a>, <a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent"><strong>IVssComponent</strong></a>).</span><span class="sxs-lookup"><span data-stu-id="9a57c-122">Perform any post-backup cleanup (see <a href="/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete"><strong>CVssWriter::OnBackupComplete</strong></a>, <a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents"><strong>IVssWriterComponents</strong></a>, <a href="/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent"><strong>IVssComponent</strong></a>).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9a57c-123">Il richiedente attende che tutti i writer riconosca la ricezione dell'evento <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete"><strong>IVssBackupComponents:: BackupComplete</strong></a> usando <a href="/windows/desktop/api/Vss/nn-vss-ivssasync"><strong>IVssAsync</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="9a57c-123">The requester waits for all writers to acknowledge receipt of the <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete"><strong>IVssBackupComponents::BackupComplete</strong></a> event using <a href="/windows/desktop/api/Vss/nn-vss-ivssasync"><strong>IVssAsync</strong></a>.</span></span> <span data-ttu-id="9a57c-124">Deve inoltre verificare lo stato del writer (vedere <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus"><strong>IVssBackupComponents:: GatherWriterStatus</strong></a>, <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus"><strong>IVssBackupComponents:: GetWriterStatus</strong></a>).</span><span class="sxs-lookup"><span data-stu-id="9a57c-124">It should also verify writer status (see <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus"><strong>IVssBackupComponents::GatherWriterStatus</strong></a>, <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus"><strong>IVssBackupComponents::GetWriterStatus</strong></a>).</span></span> <span data-ttu-id="9a57c-125">Il richiedente deve chiamare <strong>GatherWriterStatus</strong> in questo momento per fare in modo che la sessione del writer venga impostata sullo stato completato.</span><span class="sxs-lookup"><span data-stu-id="9a57c-125">The requester must call <strong>GatherWriterStatus</strong> at this time to cause the writer session to be set to a completed state.</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="9a57c-126">Questa operazione è necessaria solo in Windows Server 2008 con Service Pack 2 (SP2) e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="9a57c-126">This is only necessary on Windows Server 2008 with Service Pack 2 (SP2) and earlier.</span></span>
</blockquote>
<br/></td>
<td><span data-ttu-id="9a57c-127">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-127">None</span></span></td>
<td><span data-ttu-id="9a57c-128">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-128">None</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9a57c-129">Salvare i componenti di backup documento e ogni documento di metadati del writer in documenti XML, che possono essere scritti nei supporti di backup (vedere <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml"><strong>IVssBackupComponents:: saveasxml</strong></a> e <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml"><strong>IVssExamineWriterMetadata:: saveasxml</strong></a>).</span><span class="sxs-lookup"><span data-stu-id="9a57c-129">Save the Backup Components Document and each Writer Metadata Document to XML documents, which can be written to the backup media (see <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml"><strong>IVssBackupComponents::SaveAsXML</strong></a> and <a href="/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml"><strong>IVssExamineWriterMetadata::SaveAsXML</strong></a>).</span></span></td>
<td><span data-ttu-id="9a57c-130">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-130">None</span></span></td>
<td><span data-ttu-id="9a57c-131">nessuno</span><span class="sxs-lookup"><span data-stu-id="9a57c-131">None</span></span></td>
</tr>
</tbody>
</table>



 

## <a name="writer-actions-during-backup-of-files"></a><span data-ttu-id="9a57c-132">Azioni del writer durante il backup dei file</span><span class="sxs-lookup"><span data-stu-id="9a57c-132">Writer Actions during Backup of Files</span></span>

<span data-ttu-id="9a57c-133">Al termine della copia shadow, tutte le operazioni di I/O nel sistema di cui viene eseguito il backup dovrebbero essere in grado di riprendere senza compromettere l'integrità del backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-133">After the shadow copy has been completed, all I/O operations on the system that is being backed up should be able to resume without disrupting the integrity of the backup.</span></span> <span data-ttu-id="9a57c-134">Questa è una delle motivazioni principali per avere la funzionalità copia shadow.</span><span class="sxs-lookup"><span data-stu-id="9a57c-134">This is one of the prime motivations for having the shadow copy functionality.</span></span>

<span data-ttu-id="9a57c-135">Pertanto, come nella fase di individuazione (vedere [Panoramica della fase di individuazione del backup](overview-of-the-backup-discovery-phase.md)), è possibile che vengano rilevate alcune richieste nei writer mentre è in corso il backup dei file.</span><span class="sxs-lookup"><span data-stu-id="9a57c-135">Therefore, as in the discovery phase (see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md)), there are few demands placed on the writers while files are actually being backed up.</span></span>

<span data-ttu-id="9a57c-136">Dopo che un backup è stato completato e un richiedente ha generato un evento [*BackupComplete*](vssgloss-b.md) , VSS chiamerà il metodo [**CVssWriter:: OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) di ogni writer, un metodo virtuale che, per impostazione predefinita, restituisce semplicemente **true**.</span><span class="sxs-lookup"><span data-stu-id="9a57c-136">After a backup has completed, and a requester has generated a [*BackupComplete*](vssgloss-b.md) event, VSS will call each writer's [**CVssWriter::OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) method, a virtual method that by default simply returns **TRUE**.</span></span> <span data-ttu-id="9a57c-137">Tuttavia, i writer possono eseguire l'override dell'implementazione predefinita ed eseguire azioni come la rimozione dei file temporanei rimanenti oppure utilizzare l'interfaccia [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) con cui viene chiamata per verificare lo stato del backup di ognuno dei componenti [*inclusi in modo esplicito*](vssgloss-e.md) (e di qualsiasi [*set di componenti*](vssgloss-c.md) che potrebbero definire) recuperando l'oggetto [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corrispondente.</span><span class="sxs-lookup"><span data-stu-id="9a57c-137">However, writers can override the default implementation and take such actions as removing remaining temporary files, or use the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface it is called with to check the state of the backup of each of its [*included explicitly*](vssgloss-e.md) components (and any [*component set*](vssgloss-c.md) they might define) by retrieving the corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) object.</span></span> <span data-ttu-id="9a57c-138">Il writer può quindi determinare e agire sull'esito positivo o negativo del backup chiamando [**IVssComponent: GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded).</span><span class="sxs-lookup"><span data-stu-id="9a57c-138">The writer can then determine, and act on, the success or failure of the backup by calling [**IVssComponent:GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded).</span></span> <span data-ttu-id="9a57c-139">Il valore restituito da **IVssComponent: GetBackupSucceeded** sarà **true** solo se è stato eseguito il backup di tutti i file inclusi in modo esplicito nel componente e di tutti i relativi [*sottocomponenti*](vssgloss-s.md) inclusi in modo [*implicito*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="9a57c-139">The value returned by **IVssComponent:GetBackupSucceeded** will be **TRUE** only if all explicitly included files in the component and all [*implicitly included*](vssgloss-i.md) of any of its [*subcomponents*](vssgloss-s.md) have been successfully backed up.</span></span>

<span data-ttu-id="9a57c-140">Quando la chiamata a [**CVssWriter:: OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) è stata completata, il richiedente deve chiamare [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) e [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) (per ogni writer) un'ultima volta.</span><span class="sxs-lookup"><span data-stu-id="9a57c-140">When the call to [**CVssWriter::OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) has completed, the requester should call [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) and [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) (for each writer) one last time.</span></span> <span data-ttu-id="9a57c-141">La memoria dello stato della sessione del writer è una risorsa limitata e i writer devono riutilizzare gli Stati della sessione.</span><span class="sxs-lookup"><span data-stu-id="9a57c-141">The writer session state memory is a limited resource and writers must eventually reuse session states.</span></span> <span data-ttu-id="9a57c-142">Questo passaggio contrassegna lo stato della sessione di backup del writer come completato e notifica a VSS che questo slot della sessione di backup può essere riutilizzato da un'operazione di backup successiva.</span><span class="sxs-lookup"><span data-stu-id="9a57c-142">This step marks the writer’s backup session state as completed and notifies VSS that this backup session slot can be reused by a subsequent backup operation.</span></span>

## <a name="requester-actions-during-backup-of-files"></a><span data-ttu-id="9a57c-143">Azioni del richiedente durante il backup dei file</span><span class="sxs-lookup"><span data-stu-id="9a57c-143">Requester Actions during Backup of Files</span></span>

<span data-ttu-id="9a57c-144">Come indicato nella [Panoramica della fase di individuazione del backup](overview-of-the-backup-discovery-phase.md), non è necessario generare l'elenco effettivo dei file di cui eseguire il backup finché la copia shadow non è stata completata.</span><span class="sxs-lookup"><span data-stu-id="9a57c-144">As noted in [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md), you should not generate the actual list of files to be backed up until the shadow copy has completed.</span></span>

<span data-ttu-id="9a57c-145">L' [*oggetto dispositivo*](vssgloss-d.md) che corrisponde alla copia shadow di un determinato volume viene usato per ottenere l'accesso ai file nel volume copiato dall'ombreggiatura una volta completata la copia shadow.</span><span class="sxs-lookup"><span data-stu-id="9a57c-145">The [*device object*](vssgloss-d.md) corresponding to the shadow copy of a given volume is used to get access to files on the shadow copied volume once the shadow copy has completed.</span></span> <span data-ttu-id="9a57c-146">L'oggetto dispositivo viene ottenuto dall'oggetto [**\_ \_ prop dello snapshot VSS**](/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop) restituito da [**IVssBackupComponents:: GetSnapshotProperties**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties).</span><span class="sxs-lookup"><span data-stu-id="9a57c-146">The device object is obtained from the [**VSS\_SNAPSHOT\_PROP**](/windows/desktop/api/Vss/ns-vss-vss_snapshot_prop) object returned by [**IVssBackupComponents::GetSnapshotProperties**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties).</span></span> <span data-ttu-id="9a57c-147">Ogni copia shadow di un set di copie shadow avrà un proprio oggetto dispositivo.</span><span class="sxs-lookup"><span data-stu-id="9a57c-147">Each shadow copy of a shadow copy set will have its own device object.</span></span>

<span data-ttu-id="9a57c-148">L'oggetto dispositivo e i percorsi ottenuti dalle specifiche dei documenti dei metadati del writer vengono quindi utilizzati per selezionare i file per il backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-148">The device object and the paths obtained from the Writer Metadata Document specifications of components are then used to select files for backup.</span></span> <span data-ttu-id="9a57c-149">Per ulteriori informazioni, vedere [richiesta di accesso ai dati copiati in Shadow](requestor-access-to-shadow-copied-data.md) .</span><span class="sxs-lookup"><span data-stu-id="9a57c-149">See [Requester Access to Shadow Copied Data](requestor-access-to-shadow-copied-data.md) for more information.</span></span>

<span data-ttu-id="9a57c-150">I file che verranno inclusi nell'elenco di backup variano a seconda della natura del backup specifico, della selezione dei componenti [*per il backup*](vssgloss-s.md)e della struttura del percorso logico del writer. vedere Utilizzo della [selezione per il backup](working-with-selectability-for-backup.md).</span><span class="sxs-lookup"><span data-stu-id="9a57c-150">Which files will be included in the backup list depends on the nature of the particular backup, upon component [*selectability for backup*](vssgloss-s.md), and the logical path structure of the writer (see [Working with Selectability for Backup](working-with-selectability-for-backup.md)).</span></span>

<span data-ttu-id="9a57c-151">Oltre ai file specificati nei componenti, è possibile che un determinato writer includa anche file esclusi in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="9a57c-151">In addition to files specified in the components, a given writer may also have explicitly excluded files.</span></span> <span data-ttu-id="9a57c-152">L'esclusione di file deve sempre essere rispettata, indipendentemente dai componenti selezionati.</span><span class="sxs-lookup"><span data-stu-id="9a57c-152">File exclusion must always be respected, regardless of which components are selected.</span></span>

<span data-ttu-id="9a57c-153">Come indicato nella [Panoramica della fase di individuazione del backup](overview-of-the-backup-discovery-phase.md), una cartella montata o un punto di analisi può essere visualizzato in una copia shadow ed è possibile eseguirne il backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-153">Also as noted in [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md), a mounted folder or reparse point can appear in a shadow copy and can be backed up.</span></span> <span data-ttu-id="9a57c-154">Tuttavia, non è possibile attraversare una cartella montata o un punto di analisi nel volume copiato in Shadow (vedere [uso di cartelle montate e reparse point](working-with-reparse-and-mount-points.md)).</span><span class="sxs-lookup"><span data-stu-id="9a57c-154">However, a mounted folder or reparse point cannot be traversed on the shadow-copied volume (see [Working with Mounted Folders and Reparse Points](working-with-reparse-and-mount-points.md)).</span></span>

<span data-ttu-id="9a57c-155">È necessario prestare attenzione anche durante un'operazione di backup, se il [*percorso alternativo*](vssgloss-a.md) restituito da [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) non è vuoto.</span><span class="sxs-lookup"><span data-stu-id="9a57c-155">Care should also be taken during a backup operation, if the [*alternate path*](vssgloss-a.md) returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) is not blank.</span></span> <span data-ttu-id="9a57c-156">Un percorso alternativo è diverso da un [*mapping del percorso alternativo*](vssgloss-a.md) perché viene usato solo durante i backup, mentre un mapping del percorso alternativo viene usato solo durante i ripristini.</span><span class="sxs-lookup"><span data-stu-id="9a57c-156">An alternate path differs from an [*alternate location mapping*](vssgloss-a.md) in that it is used only during backups, while an alternate location mapping is used only during restores.</span></span>

<span data-ttu-id="9a57c-157">In questo caso, non è necessario eseguire il backup dei dati dal percorso normale (indicato da [**IVssWMFiledesc:: GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), ma dal percorso restituito da [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation).</span><span class="sxs-lookup"><span data-stu-id="9a57c-157">In this case, the data is not to be backed up from its normal location (indicated by [**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), but from the location returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation).</span></span> <span data-ttu-id="9a57c-158">Durante il ripristino, il file deve essere restituito al percorso normale.</span><span class="sxs-lookup"><span data-stu-id="9a57c-158">On restore, the file should be returned to its normal location.</span></span> <span data-ttu-id="9a57c-159">Per ulteriori informazioni, vedere [percorsi di backup e ripristino non predefiniti](non-default-backup-and-restore-locations.md) .</span><span class="sxs-lookup"><span data-stu-id="9a57c-159">See [Non-Default Backup and Restore Locations](non-default-backup-and-restore-locations.md) for more information.</span></span>

<span data-ttu-id="9a57c-160">VSS non impone alcuna restrizione sul meccanismo effettivo di esecuzione del backup dei dati in un supporto di archiviazione o nella scelta del supporto.</span><span class="sxs-lookup"><span data-stu-id="9a57c-160">VSS places no restrictions on the actual mechanism of backing up data to a storage medium or the choice of that medium.</span></span> <span data-ttu-id="9a57c-161">È tuttavia consigliabile che i file di ogni componente di ogni istanza di [*writer*](vssgloss-w.md) vengano elaborati come unità.</span><span class="sxs-lookup"><span data-stu-id="9a57c-161">However, it is recommended that the files of each component of each [*writer instance*](vssgloss-w.md) be processed as a unit.</span></span> <span data-ttu-id="9a57c-162">Vedere [generazione di un set di backup](generating-a-backup-set.md) per una descrizione delle procedure consigliate per la generazione dell'elenco dei file di backup.</span><span class="sxs-lookup"><span data-stu-id="9a57c-162">See [Generating A Backup Set](generating-a-backup-set.md) for a discussion of best practices in generating the backup file list.</span></span>

<span data-ttu-id="9a57c-163">L'esito positivo o negativo del backup di uno dei file gestiti da un determinato componente e (se definisce un [*set di componenti*](vssgloss-c.md)) i relativi [*sottocomponenti*](vssgloss-s.md) per una determinata istanza di Writer devono essere conservati nel documento componenti di backup chiamando [**IVssBackupComponents:: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded).</span><span class="sxs-lookup"><span data-stu-id="9a57c-163">The success or failure of backing up any of the files managed by a given component and (if it defines a [*component set*](vssgloss-c.md)) its [*subcomponents*](vssgloss-s.md) for a given writer instance should be preserved in the Backup Components Document by calling [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded).</span></span> <span data-ttu-id="9a57c-164">Se non è possibile eseguire il backup di un file gestito da un componente o da un set di componenti, viene detto che l'intero componente avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="9a57c-164">If any file managed by a component or component set fails to back up, the entire component is said to fail.</span></span> <span data-ttu-id="9a57c-165">Le informazioni esatte sul file di cui non è stato eseguito il backup devono sempre essere registrate.</span><span class="sxs-lookup"><span data-stu-id="9a57c-165">Exact information about which file failed to back up should always be logged.</span></span>

<span data-ttu-id="9a57c-166">Gli sviluppatori possono essere utili per archiviare un record sui supporti di backup di cui viene eseguito il backup dei file, i componenti e il set di componenti di cui sono membri, la loro specifica e i percorsi originali.</span><span class="sxs-lookup"><span data-stu-id="9a57c-166">Developers may find it helpful to store a record on the backup media of which files are backed up, the components and component set they were a member of, their specification, and what their original paths were.</span></span> <span data-ttu-id="9a57c-167">Può anche essere utile archiviare informazioni come la definizione del componente di ogni writer.</span><span class="sxs-lookup"><span data-stu-id="9a57c-167">It may also be useful to store information such as each writer's component definition.</span></span> <span data-ttu-id="9a57c-168">Questa operazione può rendere più semplice l'operazione di recupero.</span><span class="sxs-lookup"><span data-stu-id="9a57c-168">Doing this may make the retrieval operation simpler.</span></span> <span data-ttu-id="9a57c-169">Tuttavia, tali dettagli vengono lasciati allo sviluppatore del richiedente.</span><span class="sxs-lookup"><span data-stu-id="9a57c-169">However, such details are left to the requester developer.</span></span>

<span data-ttu-id="9a57c-170">Poiché i writer possono modificare il documento dei componenti di backup durante la gestione dell'evento post- [**snapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) generato dalla chiamata del richiedente a [**IVssBackupComponents::D Osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), il documento dei componenti di backup non deve essere salvato finché non viene completata la chiamata asincrona.</span><span class="sxs-lookup"><span data-stu-id="9a57c-170">Because writers can modify the Backup Components Document while handling the [**PostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) event generated by the requester's call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), the Backup Components Document should not be saved until after that asynchronous call has completed.</span></span>

<span data-ttu-id="9a57c-171">Sebbene possa essere eseguita in precedenza, questo è anche il momento opportuno per salvare il documento di metadati del writer.</span><span class="sxs-lookup"><span data-stu-id="9a57c-171">Although it may take place earlier, this is also a convenient time to save the Writer Metadata Document.</span></span>

<span data-ttu-id="9a57c-172">È molto importante che sia il documento dei componenti di backup che i documenti dei metadati del writer vengano conservati usando [**IVssBackupComponents:: saveasxml**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml) e [**IVssExamineWriterMetadata:: saveasxml**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml).</span><span class="sxs-lookup"><span data-stu-id="9a57c-172">It is very important that both the Backup Components Document and the Writer Metadata Documents be preserved using [**IVssBackupComponents::SaveAsXML**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml) and [**IVssExamineWriterMetadata::SaveAsXML**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml).</span></span> <span data-ttu-id="9a57c-173">In caso contrario, non sarà possibile utilizzare VSS durante il ripristino del file.</span><span class="sxs-lookup"><span data-stu-id="9a57c-173">If they are not, it will not be possible to make use of VSS during file restoration.</span></span>

<span data-ttu-id="9a57c-174">Oltre a archiviare i metadati originali, è possibile che alcune applicazioni di backup richiedano di salvare una copia del proprio elenco dei file (in un formato ottimizzato) e il writer, il componente, la procedura di ripristino e le informazioni sulla posizione associati al supporto di backup per un successivo recupero.</span><span class="sxs-lookup"><span data-stu-id="9a57c-174">In addition to storing the original metadata, some backup applications may find it useful to save a copy of their own list of the files (in their own optimized format)—and their associated writer, component, restore procedure, and location information—to the backup media for later retrieval.</span></span> <span data-ttu-id="9a57c-175">Tale elenco può essere utilizzato per evitare l'analisi e il confronto dei documenti di metadati del writer e dei documenti del componente di backup durante il ripristino.</span><span class="sxs-lookup"><span data-stu-id="9a57c-175">Such a list can be used to avoid some of the parsing and comparing of Writer Metadata Documents and the Backup Component Documents during restore.</span></span>

<span data-ttu-id="9a57c-176">I volumi di cui viene eseguito il backup possono contenere dati non gestiti da writer VSS.</span><span class="sxs-lookup"><span data-stu-id="9a57c-176">Volumes being backed up may have data that is not managed by VSS writers.</span></span> <span data-ttu-id="9a57c-177">È possibile eseguire il backup di questi dati dal volume copiato Shadow, in cui si troverà in uno [*stato coerente con l'arresto anomalo*](vssgloss-c.md)del sistema.</span><span class="sxs-lookup"><span data-stu-id="9a57c-177">This data can and should be backed up from the shadow copied volume, where it will be in a [*crash-consistent state*](vssgloss-c.md).</span></span> <span data-ttu-id="9a57c-178">Per ulteriori informazioni, vedere [backup senza partecipazione al writer](backups-without-writer-participation.md) .</span><span class="sxs-lookup"><span data-stu-id="9a57c-178">See [Backups without Writer Participation](backups-without-writer-participation.md) for more information.</span></span>

 

 




