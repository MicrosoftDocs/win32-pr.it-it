---
description: Un set di backup è un elenco di tutti i file di cui eseguire il backup, le rispettive posizioni e il modo in cui eseguirne il backup.
ms.assetid: 34a66a9c-c1bc-437d-b034-59dc0c88228c
title: Generazione di un set di backup
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 827d9ecb90ac376aa9818b61e8dab65550ff8c50
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310717"
---
# <a name="generating-a-backup-set"></a><span data-ttu-id="4094d-103">Generazione di un set di backup</span><span class="sxs-lookup"><span data-stu-id="4094d-103">Generating A Backup Set</span></span>

<span data-ttu-id="4094d-104">Un set di backup è un elenco di tutti i file di cui eseguire il backup, le rispettive posizioni e il modo in cui eseguirne il backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-104">A backup set is a list of all files to be backed up, their locations, and how to back them up.</span></span>

<span data-ttu-id="4094d-105">Un richiedente deve usare i file contenuti nei volumi copiati shadow dopo [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) restituisce correttamente l'elenco completo dei file di cui eseguire il backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-105">A requester must make use of the files contained on the shadow-copied volumes after the [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) returns successfully to generate the full list of files to be backed up.</span></span>

<span data-ttu-id="4094d-106">Inoltre, un richiedente deve gestire la possibilità che alcuni file abbiano [*percorsi alternativi*](vssgloss-a.md) e che alcuni file siano stati esclusi.</span><span class="sxs-lookup"><span data-stu-id="4094d-106">In addition, a requester must deal with the possibility that some files have [*alternate paths*](vssgloss-a.md) and that some files have been excluded.</span></span>

<span data-ttu-id="4094d-107">Un algoritmo per la selezione dei file di cui eseguire il backup deve essere eseguito in un' [*istanza del writer*](vssgloss-w.md) in base a un'istanza del writer, a seconda del componente, come avverrebbe durante il ripristino. vedere [generazione di un set di ripristino](generating-a-restore-set.md)e procedere con le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="4094d-107">An algorithm for selecting files to back up should go on a [*writer instance*](vssgloss-w.md) by writer instance, component-by-component basis (as will be the case during restore; see [Generating a Restore Set](generating-a-restore-set.md)) and might proceed by doing the following:</span></span>

1.  <span data-ttu-id="4094d-108">Determinazione dei volumi che contengono i file del writer e degli oggetti dispositivo corrispondenti</span><span class="sxs-lookup"><span data-stu-id="4094d-108">Determining the volumes that contain the writer's files and the corresponding device objects</span></span>
2.  <span data-ttu-id="4094d-109">Utilizzando le informazioni sui [*set di file*](vssgloss-f.md) , contenute negli oggetti [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) restituiti da [**IVssExamineWriterMetadata:: GetExcludeFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getexcludefile), per creare un elenco dei file esclusi in modo esplicito, se necessario utilizzando **FindFileFirst**, **FindFileFirstEx** e **FindNextFile**.</span><span class="sxs-lookup"><span data-stu-id="4094d-109">Using the [*file set*](vssgloss-f.md) information (contained in [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) objects returned by [**IVssExamineWriterMetadata::GetExcludeFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getexcludefile)) to create a list of the explicitly excluded files, if necessary using **FindFileFirst**, **FindFileFirstEx**, and **FindNextFile**.</span></span>
3.  <span data-ttu-id="4094d-110">Iterazione su tutti i componenti di un writer usando [**IVssExamineWriterMetadata:: getComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span><span class="sxs-lookup"><span data-stu-id="4094d-110">Iterating over all of a writer's components, using [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span></span> <span data-ttu-id="4094d-111">Se è selezionato un componente selezionabile, utilizzare il [*percorso logico*](vssgloss-l.md) per ottenere i componenti non selezionabili Associati in un set di componenti.</span><span class="sxs-lookup"><span data-stu-id="4094d-111">If a selectable component is selected, use [*logical path*](vssgloss-l.md) to obtain those nonselectable components associated with it in a component set.</span></span> <span data-ttu-id="4094d-112">(Vedere [uso di selezione e percorsi logici](working-with-selectability-and-logical-paths.md)).</span><span class="sxs-lookup"><span data-stu-id="4094d-112">(See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md).)</span></span>
4.  <span data-ttu-id="4094d-113">Ottenere i [*set di file*](vssgloss-f.md) contenuti in ogni componente selezionato usando l'interfaccia [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) corrispondente a ogni componente che contiene.</span><span class="sxs-lookup"><span data-stu-id="4094d-113">Obtaining the [*file sets*](vssgloss-f.md) contained in each selected component by using the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface corresponding to each component it contains.</span></span>
5.  <span data-ttu-id="4094d-114">Generazione di un elenco di file dalle specifiche, se necessario usando **FindFileFirst**, **FindFileFirstEx** e **FindNextFile**.</span><span class="sxs-lookup"><span data-stu-id="4094d-114">Generating a list of files from the specifications—if necessary using **FindFileFirst**, **FindFileFirstEx**, and **FindNextFile**.</span></span>
6.  <span data-ttu-id="4094d-115">Controllo di ogni file nell'elenco generato dalle informazioni sul componente rispetto all'elenco dei file esclusi generati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="4094d-115">Checking each file in the list generated from component information against the list of excluded files generated above.</span></span> <span data-ttu-id="4094d-116">Questa operazione deve essere eseguita utilizzando il percorso predefinito per il file (restituito da [**IVssWMFiledesc:: GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), non dal percorso alternativo restituito da [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)).</span><span class="sxs-lookup"><span data-stu-id="4094d-116">This should be done using the default path for the file (returned by [**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), not by the alternate path returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)).</span></span> <span data-ttu-id="4094d-117">Se il file corrisponde all'elenco escluso, non verrà eseguito il backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-117">If the file matches the excluded list, it will not be backed up.</span></span>
7.  <span data-ttu-id="4094d-118">Scelta del percorso effettivo dal quale eseguire il backup (usando il percorso alternativo se è stato impostato)</span><span class="sxs-lookup"><span data-stu-id="4094d-118">Choosing the actual location from which to back up (using the alternate path if it was set)</span></span>
8.  <span data-ttu-id="4094d-119">A questo punto, è disponibile un elenco completo dei file e delle rispettive posizioni ed è possibile iniziare un backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-119">At this point, a full list of files and their locations is available and a backup can begin.</span></span>

<span data-ttu-id="4094d-120">Dopo la generazione di un set di backup iniziale per tutti i writer presenti nel sistema, il richiedente controlla la seguente chiave del registro di sistema:</span><span class="sxs-lookup"><span data-stu-id="4094d-120">After an initial backup set has been generated for all writers that are present on the system, the requester then checks the following registry key:</span></span>

<span data-ttu-id="4094d-121">**HKEY \_ Local \_ computer \\ System \\ CurrentControlSet \\ Control \\ backuprestore \\ FilesNotToBackup**</span><span class="sxs-lookup"><span data-stu-id="4094d-121">**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\BackupRestore\\FilesNotToBackup**</span></span>

<span data-ttu-id="4094d-122">Il richiedente usa le sottochiavi sotto questa chiave come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="4094d-122">The requester uses the subkeys under this key as follows:</span></span>

-   <span data-ttu-id="4094d-123">Se un writer è presente nel sistema ed è presente una sottochiave il cui nome corrisponde al nome del writer, tale sottochiave deve essere ignorata.</span><span class="sxs-lookup"><span data-stu-id="4094d-123">If a writer is present on the system, and there is a subkey whose name matches the writer's name, that subkey must be ignored.</span></span>
-   <span data-ttu-id="4094d-124">Se un writer era presente nel sistema ma è attualmente assente dal set di backup ed è presente una sottochiave corrispondente, tutti i file specificati nei dati della sottochiave vengono esclusi e devono essere rimossi dal set di backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-124">If a writer was present on the system but is currently absent from the backup set, and there is a matching subkey, any files specified in the subkey data are excluded and must be removed from the backup set.</span></span>
-   <span data-ttu-id="4094d-125">L'applicazione di backup aggiunge file ai dati della sottochiave creando un \_ valore di più SZ contenente un elenco di specifiche di file per i file di cui non è necessario eseguire il backup.</span><span class="sxs-lookup"><span data-stu-id="4094d-125">The backup application adds files to the subkey data by creating a MULTI\_SZ value containing a list of file specifications for the files that must not be backed up.</span></span> <span data-ttu-id="4094d-126">Ogni stringa nel valore di più \_ SZ deve contenere una specifica del file.</span><span class="sxs-lookup"><span data-stu-id="4094d-126">Each string in the MULTI\_SZ value should contain one file specification.</span></span>
-   <span data-ttu-id="4094d-127">Le specifiche dei file possono contenere?</span><span class="sxs-lookup"><span data-stu-id="4094d-127">File specifications can contain the ?</span></span> <span data-ttu-id="4094d-128">e \* caratteri jolly.</span><span class="sxs-lookup"><span data-stu-id="4094d-128">and \* wildcard characters.</span></span> <span data-ttu-id="4094d-129">Una specifica può essere resa ricorsiva aggiungendo/s alla fine.</span><span class="sxs-lookup"><span data-stu-id="4094d-129">A specification can be made recursive by appending /s to the end.</span></span> <span data-ttu-id="4094d-130">Se ad esempio si specifica "% TEMP% \\ \* /s", non sarà possibile eseguire il backup di tutti i file nella directory% Temp% e di tutte le relative sottodirectory.</span><span class="sxs-lookup"><span data-stu-id="4094d-130">For example, specifying "%TEMP%\\\* /s" causes all files in the %TEMP% directory and all of its subdirectories not to be backed up.</span></span>

 

 



