---
description: Il documento componenti di backup viene mantenuto dalle istanze dell'interfaccia IVssBackupComponents.
ms.assetid: 8c7ebba8-58c4-4733-ba59-802abf902c5e
title: Contenuto del documento dei componenti di backup
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e12c88ebffa0037702e1f30dd818d4fd23fe4e2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103885414"
---
# <a name="backup-components-document-contents"></a><span data-ttu-id="373a4-103">Contenuto del documento dei componenti di backup</span><span class="sxs-lookup"><span data-stu-id="373a4-103">Backup Components Document Contents</span></span>

<span data-ttu-id="373a4-104">Il documento componenti di backup viene mantenuto dalle istanze dell'interfaccia [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="373a4-104">The Backup Components Document is maintained by instances of the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="373a4-105">Questa interfaccia contiene inoltre numerosi metodi per il controllo delle operazioni di backup, la modifica delle copie shadow e l'esecuzione di query sullo stato del sistema.</span><span class="sxs-lookup"><span data-stu-id="373a4-105">This interface also contains numerous methods for controlling backup operations, manipulating shadow copies, and querying the system state.</span></span> <span data-ttu-id="373a4-106">Tuttavia, non tutte le informazioni del documento sono direttamente accessibili tramite questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="373a4-106">However, not all of the document's information is directly accessible through this interface.</span></span>

<span data-ttu-id="373a4-107">Il documento componenti di backup è costituito da diversi set di dati:</span><span class="sxs-lookup"><span data-stu-id="373a4-107">The Backup Components Document consists of several sets of data:</span></span>

-   <span data-ttu-id="373a4-108">Informazioni sui componenti inclusi in modo esplicito in un'operazione di backup o ripristino</span><span class="sxs-lookup"><span data-stu-id="373a4-108">Information about which components were explicitly included in a backup or restore operation</span></span>
-   <span data-ttu-id="373a4-109">Rappresentazione delle informazioni sul componente e sul writer archiviati</span><span class="sxs-lookup"><span data-stu-id="373a4-109">A representation of the stored component and writer information</span></span>
-   <span data-ttu-id="373a4-110">Informazioni sullo stato relative all'operazione di backup/ripristino</span><span class="sxs-lookup"><span data-stu-id="373a4-110">State information about the backup/recover operation</span></span>

<span data-ttu-id="373a4-111">Sebbene le informazioni sul componente siano disponibili sia per il richiedente che per il writer, solo il writer ha accesso alle informazioni sullo stato.</span><span class="sxs-lookup"><span data-stu-id="373a4-111">While the component information is available to both the requester and the writer, only the writer has access to the state information.</span></span>

## <a name="component-inclusion-information"></a><span data-ttu-id="373a4-112">Informazioni sull'inclusione di componenti</span><span class="sxs-lookup"><span data-stu-id="373a4-112">Component Inclusion Information</span></span>

<span data-ttu-id="373a4-113">Il documento componenti di backup contiene un elenco dei componenti inclusi in modo esplicito nel backup e nel ripristino dal richiedente.</span><span class="sxs-lookup"><span data-stu-id="373a4-113">The Backup Components Document contains a list of those components explicitly included in backup and restore by the requester.</span></span> <span data-ttu-id="373a4-114">L'elenco contiene gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="373a4-114">The list contains the following:</span></span>

-   <span data-ttu-id="373a4-115">Inclusi in modo esplicito i [*componenti selezionabili*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="373a4-115">Explicitly included [*selectable components*](vssgloss-s.md).</span></span>

    <span data-ttu-id="373a4-116">L'inclusione di questi file nelle operazioni di backup è indicata da [**IVssBackupComponents:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) e dalle operazioni di ripristino di [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="373a4-116">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="373a4-117">Non selezionabile per i sottocomponenti di backup senza un predecessore selezionabile per il componente di backup.</span><span class="sxs-lookup"><span data-stu-id="373a4-117">Nonselectable for backup subcomponents without a selectable for backup component ancestor.</span></span>

    <span data-ttu-id="373a4-118">Tutti questi componenti devono essere inclusi se nell'operazione sono inclusi componenti del writer.</span><span class="sxs-lookup"><span data-stu-id="373a4-118">All of these components must be included if any components of the writer are to be included in the operation.</span></span> <span data-ttu-id="373a4-119">L'inclusione di questi file nelle operazioni di backup è indicata da [**IVssBackupComponents:: AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) e dalle operazioni di ripristino di [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="373a4-119">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="373a4-120">Componenti aggiunti in modo implicito al backup ([*sottocomponenti*](vssgloss-s.md)) [*selezionabili per il ripristino*](vssgloss-s.md) e aggiunti esplicitamente al ripristino.</span><span class="sxs-lookup"><span data-stu-id="373a4-120">Components implicitly added to the backup ([*subcomponents*](vssgloss-s.md)) that are [*selectable for restore*](vssgloss-s.md) and are explicitly added to the restore.</span></span>

    <span data-ttu-id="373a4-121">Questi componenti possono essere selezionabili o non selezionabili, ma hanno un predecessore selezionabile che è stato usato per selezionarli in modo implicito per il backup.</span><span class="sxs-lookup"><span data-stu-id="373a4-121">These components may be either selectable or nonselectable, but have a selectable ancestor that was used to implicitly select them for backup.</span></span> <span data-ttu-id="373a4-122">Vengono aggiunti al documento componenti di backup di [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="373a4-122">They are added to the Backup Components Document by [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="373a4-123">Le identità dei componenti inclusi in modo implicito nel ripristino non vengono archiviate nel documento componenti di backup.</span><span class="sxs-lookup"><span data-stu-id="373a4-123">The identities of components implicitly included in the restore are not stored in the Backup Components Document.</span></span>

<span data-ttu-id="373a4-124">VSS ha accesso alle informazioni sull'inclusione dei componenti: i writer senza componenti inclusi in modo esplicito in un ripristino o un backup non ricevono eventi VSS dopo la generazione degli eventi [*PrepareForBackup*](vssgloss-p.md) o di [*preripristino*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="373a4-124">VSS has access to information about component inclusion: writers with no components explicitly included in a restore or backup receive no VSS events following the generation of the [*PrepareForBackup*](vssgloss-p.md) or [*PreRestore*](vssgloss-p.md) events.</span></span>

<span data-ttu-id="373a4-125">I writer non possono eseguire query direttamente su queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="373a4-125">Writers cannot directly query this information.</span></span> <span data-ttu-id="373a4-126">Non si tratta di una limitazione significativa perché, per impostazione predefinita, i singoli writer del servizio Copia Shadow del volume non devono richiedere informazioni dettagliate sullo stato di altri writer del sistema e, come indicato in precedenza, quelli senza componenti inclusi non dovranno partecipare all'operazione VSS.</span><span class="sxs-lookup"><span data-stu-id="373a4-126">This is not a significant limitation because by design, individual VSS writers should not require detailed information about the status of other writers on the system and, as noted above, those with no included components will not have to participate in the VSS operation.</span></span>

<span data-ttu-id="373a4-127">Un richiedente può determinare quali componenti sono stati inclusi in modo esplicito in un'operazione.</span><span class="sxs-lookup"><span data-stu-id="373a4-127">A requester can determine which components have been explicitly included in an operation.</span></span>

<span data-ttu-id="373a4-128">Il metodo [**IVssBackupComponents:: GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) restituisce il numero di writer con le informazioni sul componente archiviate nel documento dei componenti di backup (e non il numero di componenti nel documento).</span><span class="sxs-lookup"><span data-stu-id="373a4-128">The [**IVssBackupComponents::GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) method returns the number of writers with component information stored in the Backup Components Document (and not the number of components in the document).</span></span>

<span data-ttu-id="373a4-129">Il richiedente indicizza le informazioni del writer archiviato usando [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), che restituisce le istanze dell'interfaccia [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) .</span><span class="sxs-lookup"><span data-stu-id="373a4-129">The requester indexes through the stored writer information using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface.</span></span> <span data-ttu-id="373a4-130">L'interfaccia **IVssWriterComponentsExt** consente al richiedente di ottenere la [*classe Writer*](vssgloss-w.md) e l' [*istanza writer*](vssgloss-w.md) dei writer partecipanti, nonché di accedere alle informazioni relative ai componenti archiviati nel documento componenti di backup.</span><span class="sxs-lookup"><span data-stu-id="373a4-130">The **IVssWriterComponentsExt** interface allows the requester to obtain the [*writer class*](vssgloss-w.md) and [*writer instance*](vssgloss-w.md) of participating writers, as well as to access information about those of its components stored in the Backup Components Document.</span></span>

## <a name="information-on-included-components"></a><span data-ttu-id="373a4-131">Informazioni sui componenti inclusi</span><span class="sxs-lookup"><span data-stu-id="373a4-131">Information on Included Components</span></span>

<span data-ttu-id="373a4-132">La rappresentazione del documento dei componenti di backup dei dati del componente, che non include informazioni sulle specifiche di percorso e file, a cui si accede tramite istanze dell'interfaccia [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="373a4-132">The Backup Components Document's representation of the component data (which does not include path and file specification information), which is accessed through instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="373a4-133">I richiedenti e i writer ottengono l'accesso alle istanze dell'interfaccia [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) in modi diversi.</span><span class="sxs-lookup"><span data-stu-id="373a4-133">Requesters and writers obtain access to instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface in different ways.</span></span>

<span data-ttu-id="373a4-134">Un richiedente esamina i dati del componente in un writer in base al writer usando le istanze dell'interfaccia [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) restituite da [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span><span class="sxs-lookup"><span data-stu-id="373a4-134">A requester examines component data on a writer by writer basis by using instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span></span>

<span data-ttu-id="373a4-135">Oltre alle informazioni di identificazione del writer, l'interfaccia [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) fornisce una matrice di istanze dell'interfaccia [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , una per ogni componente dei writer selezionati inclusi.</span><span class="sxs-lookup"><span data-stu-id="373a4-135">In addition to the writer identification information, the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface provides an array of instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface—one for each of the selected writers included components.</span></span>

<span data-ttu-id="373a4-136">Come indicato nel [ciclo di vita del documento dei componenti di backup](backup-components-document-life-cycle.md), i writer possono accedere alle stesse informazioni tramite l'interfaccia [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) durante la gestione dell'evento PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, PreRestore o PostRestore.</span><span class="sxs-lookup"><span data-stu-id="373a4-136">As noted in [Backup Components Document Life Cycle](backup-components-document-life-cycle.md), the writers can gain access to the same information through the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface when handling the PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, PreRestore, or PostRestore event.</span></span>

<span data-ttu-id="373a4-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) consente a writer e richiedenti di ottenere le informazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="373a4-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) allows both writer and requesters to get the following information:</span></span>

-   <span data-ttu-id="373a4-138">Nome, tipo e [*percorso logico*](vssgloss-l.md) di un componente ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span><span class="sxs-lookup"><span data-stu-id="373a4-138">A component's name, type, and [*logical path*](vssgloss-l.md) ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span></span>
-   <span data-ttu-id="373a4-139">Come deve essere ripristinato un componente come indicato dalla [*destinazione di ripristino*](vssgloss-r.md) ([**IVssComponent:: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="373a4-139">How a component should be restored as indicated by the [*restore target*](vssgloss-r.md) ([**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span></span>
-   <span data-ttu-id="373a4-140">Se è stato usato un percorso alternativo per il ripristino di un file ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span><span class="sxs-lookup"><span data-stu-id="373a4-140">If an alternate location was used in restoring a file ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span></span>
-   <span data-ttu-id="373a4-141">Nuove informazioni di destinazione, se presenti ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span><span class="sxs-lookup"><span data-stu-id="373a4-141">New target information, if any ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span></span>
-   <span data-ttu-id="373a4-142">Messaggi di errore pre-e post-ripristino ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="373a4-142">Pre-and post-restore error messages ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span></span>
-   <span data-ttu-id="373a4-143">Se è stato selezionato un componente [*selezionabile per il backup*](vssgloss-s.md) che definisce un set di componenti per il ripristino ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span><span class="sxs-lookup"><span data-stu-id="373a4-143">If a [*selectable for backup*](vssgloss-s.md) component defining a component set has been selected for restore ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span></span>
-   <span data-ttu-id="373a4-144">Indica se il backup o il ripristino è riuscito ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span><span class="sxs-lookup"><span data-stu-id="373a4-144">Whether a backup or restore succeeded ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span></span>
-   <span data-ttu-id="373a4-145">Eventuali opzioni di backup o ripristino specifiche del writer che potrebbero essere state impostate da [**IVssBackupComponents:: SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) o [**IVssBackupComponents:: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="373a4-145">Any writer-specific backup or restore options that may have been set by [**IVssBackupComponents::SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) or [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="373a4-146">Tutti i metadati specifici del writer per il backup o il ripristino ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="373a4-146">Any writer-specific metadata backup or restore metadata ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span></span>
-   <span data-ttu-id="373a4-147">Informazioni timestamp ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="373a4-147">Time-stamp information ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span></span>
-   <span data-ttu-id="373a4-148">Informazioni sui sottocomponenti di backup inclusi in modo esplicito in un ripristino ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span><span class="sxs-lookup"><span data-stu-id="373a4-148">Information about backup subcomponents explicitly included in a restore ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span></span>

<span data-ttu-id="373a4-149">A differenza dei richiedenti, i writer possono modificare determinate informazioni nel documento componenti di backup tramite l'interfaccia [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) :</span><span class="sxs-lookup"><span data-stu-id="373a4-149">Unlike requesters, writers can change certain information in the Backup Components Document via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface:</span></span>

-   <span data-ttu-id="373a4-150">Come deve essere ripristinato un componente come indicato dalla destinazione di ripristino ([**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="373a4-150">How a component should be restored as indicated by the restore target ([**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span></span>
-   <span data-ttu-id="373a4-151">Metadati di backup e ripristino specifici del writer ([**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="373a4-151">Writer-specific backup and restore metadata ([**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="373a4-152">Informazioni timestamp ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="373a4-152">Time-stamp information ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span></span>
-   <span data-ttu-id="373a4-153">Messaggi di errore pre-e post-ripristino ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="373a4-153">Pre- and post-restore error messages ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span></span>

## <a name="requester-state-information"></a><span data-ttu-id="373a4-154">Informazioni sullo stato del richiedente</span><span class="sxs-lookup"><span data-stu-id="373a4-154">Requester State Information</span></span>

<span data-ttu-id="373a4-155">I richiedenti inseriscono informazioni sullo stato di un'operazione di backup o ripristino nel documento componenti di backup usando l'interfaccia [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="373a4-155">Requesters insert information about the state of a backup or restore operation into the Backup Components Document using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="373a4-156">Le applicazioni writer sono in grado di eseguire query per queste informazioni tramite la classe [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) .</span><span class="sxs-lookup"><span data-stu-id="373a4-156">Writer applications are able to query for this information through the [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) class.</span></span>

<span data-ttu-id="373a4-157">Le informazioni sullo stato archiviate nel documento componenti di backup includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="373a4-157">State information stored in the Backup Components Document includes the following:</span></span>

<span data-ttu-id="373a4-158">Informazioni generali sul backup</span><span class="sxs-lookup"><span data-stu-id="373a4-158">General Information about the Backup</span></span>

-   <span data-ttu-id="373a4-159">Il tipo di backup complessivo (incrementale, differenziale o completo)</span><span class="sxs-lookup"><span data-stu-id="373a4-159">The overall backup type (incremental, differential, or full)</span></span><dl> <dt>

<span data-ttu-id="373a4-160">Impostato dai richiedenti con [ **IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="373a4-160">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-161">Recuperato dai writer con [ **CVssWriter:: GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span><span class="sxs-lookup"><span data-stu-id="373a4-161">Retrieved by writers using [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span></span>
</dt> </dl>
-   Whether component operations are supported<dl> <dt>

<span data-ttu-id="373a4-162">Impostato dai richiedenti con [ **IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="373a4-162">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-163">Recuperato dai writer con [ **CVssWriter:: AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span><span class="sxs-lookup"><span data-stu-id="373a4-163">Retrieved by writers using [**CVssWriter::AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span></span>
</dt> </dl>
-   Whether the bootable system state is backed up<dl> <dt>

<span data-ttu-id="373a4-164">Impostato dai richiedenti con [ **IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="373a4-164">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-165">Recuperato dai writer con [ **CVssWriter:: IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span><span class="sxs-lookup"><span data-stu-id="373a4-165">Retrieved by writers using [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span></span>
</dt> </dl>
-   Whether partial file operations are supported<dl> <dt>

<span data-ttu-id="373a4-166">Impostato dai richiedenti con [ **IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="373a4-166">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-167">Recuperato dai writer con [ **CVssWriter:: IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span><span class="sxs-lookup"><span data-stu-id="373a4-167">Retrieved by writers using [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span></span>
</dt> </dl>

<span data-ttu-id="373a4-168">Informazioni generali sul ripristino</span><span class="sxs-lookup"><span data-stu-id="373a4-168">General Information about the Restore</span></span>

-   <span data-ttu-id="373a4-169">Tipo di ripristino generale (se il ripristino è da copia o importazione)</span><span class="sxs-lookup"><span data-stu-id="373a4-169">The overall restore type (whether restore is by copy or import)</span></span><dl> <dt>

<span data-ttu-id="373a4-170">Impostato dai richiedenti con [ **IVssBackupComponents:: SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span><span class="sxs-lookup"><span data-stu-id="373a4-170">Set by requesters using [**IVssBackupComponents::SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-171">Recuperato dai writer con [ **CVssWriter:: GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span><span class="sxs-lookup"><span data-stu-id="373a4-171">Retrieved by writers using [**CVssWriter::GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span></span>
</dt> </dl>

<span data-ttu-id="373a4-172">Informazioni sui file di supporto</span><span class="sxs-lookup"><span data-stu-id="373a4-172">Information about Supporting Files</span></span>

-   <span data-ttu-id="373a4-173">Percorso dei file degli intervalli utilizzati da un componente specifico in operazioni di file parziali</span><span class="sxs-lookup"><span data-stu-id="373a4-173">The location of ranges files used by a specific component in partial file operations</span></span><dl> <dt>

<span data-ttu-id="373a4-174">Impostato dai richiedenti con [ **IVssBackupComponents:: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span><span class="sxs-lookup"><span data-stu-id="373a4-174">Set by requesters using [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-175">Recuperato da Writer (o richiedenti) con [ **IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span><span class="sxs-lookup"><span data-stu-id="373a4-175">Retrieved by writers (or requesters) using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span></span>
</dt> </dl>

<span data-ttu-id="373a4-176">Stato delle informazioni</span><span class="sxs-lookup"><span data-stu-id="373a4-176">Status of Information</span></span>

-   <span data-ttu-id="373a4-177">Indica se è stato eseguito il backup di uno dei componenti del writer specificato</span><span class="sxs-lookup"><span data-stu-id="373a4-177">Indicate whether one of a given writer's components was successfully backed up</span></span><dl> <dt>

<span data-ttu-id="373a4-178">Impostato dai richiedenti con [ **IVssBackupComponents:: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="373a4-178">Set by requesters using [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-179">Recuperato da writer e richiedenti con [ **IVssComponent:: GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="373a4-179">Retrieved by writers and requesters using [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span></span>
</dt> </dl>
-   Indicate whether one of a given writer's components was successfully restored<dl> <dt>

<span data-ttu-id="373a4-180">Impostato dai richiedenti con [ **IVssBackupComponents:: SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="373a4-180">Set by requesters using [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-181">Recuperato da writer e richiedente usando [ **IVssComponent:: GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="373a4-181">Retrieved by writers and requester using [**IVssComponent::GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span></span>
</dt> </dl>

<span data-ttu-id="373a4-182">Informazioni Writer-Settable</span><span class="sxs-lookup"><span data-stu-id="373a4-182">Writer-Settable Information</span></span>

-   <span data-ttu-id="373a4-183">Specifica di backup aggiuntiva per uno dei componenti del writer specificato</span><span class="sxs-lookup"><span data-stu-id="373a4-183">Additional backup specification for one of a given writer's components</span></span><dl> <dt>

<span data-ttu-id="373a4-184">Impostato dai writer con [ **IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="373a4-184">Set by writers using [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-185">Recuperato da writer e richiedenti con [ **IVssComponent:: GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="373a4-185">Retrieved by writers and requesters using [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span></span>
</dt> </dl>
-   Additional restore specification for one of a given writer's components<dl> <dt>

<span data-ttu-id="373a4-186">Impostato dai writer con [ **IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="373a4-186">Set by writers using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-187">Recuperato da writer e richiedenti con [ **IVssComponent:: GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="373a4-187">Retrieved by writers and requesters using [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span></span>
</dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the current backup of one of its component's backups<dl> <dt>

<span data-ttu-id="373a4-188">Impostato dai writer con [ **IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="373a4-188">Set by writers using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-189">Recuperato da writer e richiedenti con [ **IVssComponent:: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="373a4-189">Retrieved by writers and requesters using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span></span>
<span data-ttu-id="373a4-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent:: SetBackupStamp</a></span><span class="sxs-lookup"><span data-stu-id="373a4-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span></span><dl> <dt>

<span data-ttu-id="373a4-191">Archiviato e impostato dai richiedenti per un componente specifico usando [ **IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="373a4-191">Stored and set by requesters for a specific component using [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-192">Recuperato da writer e richiedenti con [ **IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="373a4-192">Retrieved by writers and requesters using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span></span>
</dt> </dl>
-   Error messages for failure before and after restore operations<dl> <dt>

<span data-ttu-id="373a4-193">Impostato dai writer con [**IVssComponent:: SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) o [**IVssComponent:: SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="373a4-193">Set by writers using [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) or [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span></span>
</dt> <dt>

<span data-ttu-id="373a4-194">Recuperato da writer e richiedenti con [**IVssComponent:: GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) o [**IVssComponent:: GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="373a4-194">Retrieved by writers and requesters using [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) or [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span></span>
</dt> </dl>

 

 
