---
description: Durante l'inizializzazione di un'operazione di ripristino VSS, un richiedente deve recuperare il documento del componente di backup e ogni documento di metadati del writer pertinente creato e salvato durante l'operazione di backup.
ms.assetid: 0a087125-c9d4-460a-8153-3e2e26633ac2
title: Panoramica dell'inizializzazione del ripristino
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6eb62e5282a74e38cd53d36c8ba004f4b8069746
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131270"
---
# <a name="overview-of-restore-initialization"></a><span data-ttu-id="d1a37-103">Panoramica dell'inizializzazione del ripristino</span><span class="sxs-lookup"><span data-stu-id="d1a37-103">Overview of Restore Initialization</span></span>

<span data-ttu-id="d1a37-104">Durante l'inizializzazione di un'operazione di ripristino VSS, un richiedente deve recuperare il documento del componente di backup e ogni documento di metadati del writer pertinente creato e salvato durante l'operazione di backup.</span><span class="sxs-lookup"><span data-stu-id="d1a37-104">In initializing a VSS restore operation, a requester needs to retrieve the Backup Component Document and each relevant Writer Metadata Document created and saved during the backup operation.</span></span> <span data-ttu-id="d1a37-105">Lo stato corrente del writer verrà sottoposto a query durante la gestione dell' [*evento di identificazione*](vssgloss-i.md) generato dal richiedente.</span><span class="sxs-lookup"><span data-stu-id="d1a37-105">The writer will have its current state queried in handling the [*Identify event*](vssgloss-i.md) that the requester generates.</span></span> <span data-ttu-id="d1a37-106">Per ulteriori informazioni, vedere [Cenni preliminari sull'elaborazione di un ripristino in VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="d1a37-106">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="d1a37-107">Nella tabella seguente viene illustrata la sequenza di azioni ed eventi necessari per inizializzare un'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="d1a37-107">The following table shows the sequence of actions and events that are required to initialize a restore operation.</span></span>



| <span data-ttu-id="d1a37-108">Azione del richiedente</span><span class="sxs-lookup"><span data-stu-id="d1a37-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="d1a37-109">Evento</span><span class="sxs-lookup"><span data-stu-id="d1a37-109">Event</span></span>                                                     | <span data-ttu-id="d1a37-110">Azione del writer</span><span class="sxs-lookup"><span data-stu-id="d1a37-110">Writer action</span></span>                                                                                                                                                                                                                                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d1a37-111">Creare un'interfaccia [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) , inizializzarla per gestire un ripristino e caricare i metadati del richiedente archiviato. vedere [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore).</span><span class="sxs-lookup"><span data-stu-id="d1a37-111">Create an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, initialize it to manage a restore, and load stored requester metadata (see [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)).</span></span> | <span data-ttu-id="d1a37-112">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-112">None</span></span>                                                      | <span data-ttu-id="d1a37-113">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-113">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="d1a37-114">Chiamare [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) per creare interfacce [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) e caricarle con i metadati del writer archiviati.</span><span class="sxs-lookup"><span data-stu-id="d1a37-114">Call [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) to create [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interfaces and load them with stored writer metadata.</span></span>                                                                                                           | <span data-ttu-id="d1a37-115">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-115">None</span></span>                                                      | <span data-ttu-id="d1a37-116">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-116">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="d1a37-117">Avviare il contatto asincrono con i writer (vedere [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).)</span><span class="sxs-lookup"><span data-stu-id="d1a37-117">Initiate asynchronous contact with writers (see [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).)</span></span>                                                                                                                                                                      | [<span data-ttu-id="d1a37-118">*Identificare*</span><span class="sxs-lookup"><span data-stu-id="d1a37-118">*Identify*</span></span>](vssgloss-i.md) | <span data-ttu-id="d1a37-119">Il writer avvia la gestione degli eventi a supporto del ripristino.</span><span class="sxs-lookup"><span data-stu-id="d1a37-119">The writer begins event handling in support of the restore.</span></span> <span data-ttu-id="d1a37-120">Crea il documento di metadati del writer (vedere [utilizzo del documento di metadati del writer](working-with-the-writer-metadata-document.md), [**CVssWriter:: onidentificate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)).</span><span class="sxs-lookup"><span data-stu-id="d1a37-120">Creates the Writer Metadata Document (see [Working with the Writer Metadata Document](working-with-the-writer-metadata-document.md), [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)).</span></span> |
| <span data-ttu-id="d1a37-121">Il richiedente è in attesa dell'inizializzazione dei writer chiamando [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span><span class="sxs-lookup"><span data-stu-id="d1a37-121">The requester waits for writers to initialize by calling [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span>                                                                                                                                                                                                                               | <span data-ttu-id="d1a37-122">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-122">None</span></span>                                                      | <span data-ttu-id="d1a37-123">nessuno</span><span class="sxs-lookup"><span data-stu-id="d1a37-123">None</span></span>                                                                                                                                                                                                                                                                                                                      |



 

## <a name="requester-actions-during-restore-initialization"></a><span data-ttu-id="d1a37-124">Azioni del richiedente durante l'inizializzazione del ripristino</span><span class="sxs-lookup"><span data-stu-id="d1a37-124">Requester Actions during Restore Initialization</span></span>

<span data-ttu-id="d1a37-125">Durante la fase di inizializzazione di un ripristino, il richiedente deve avere accesso al documento dei componenti di backup archiviati e a tutti i documenti di metadati del writer.</span><span class="sxs-lookup"><span data-stu-id="d1a37-125">During the initialization phase of a restore, the requester needs to have access to the stored Backup Components Document and all the Writer Metadata Documents.</span></span>

<span data-ttu-id="d1a37-126">A seconda dell'implementazione di, ciò significa che il richiedente richiede che i supporti di backup siano montati e leggibili oppure che sia disponibile un altro meccanismo per accedere ai metadati archiviati.</span><span class="sxs-lookup"><span data-stu-id="d1a37-126">Depending on the implementation, this will mean either that the requester will require that backup media be mounted and readable, or that some other mechanism for accessing the stored metadata be available.</span></span>

<span data-ttu-id="d1a37-127">Il richiedente usa il documento XML archiviato contenente il documento componenti di backup del richiedente che ha eseguito il backup per inizializzare il documento relativo ai componenti di backup usando [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) può accedere alle informazioni.</span><span class="sxs-lookup"><span data-stu-id="d1a37-127">The requester uses the stored XML document containing the Backup Components Document of the requester that performed the backup to initialize its Backup Components Document using [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) can access the information.</span></span>

<span data-ttu-id="d1a37-128">Come nel caso del backup, il documento componenti di backup non contiene informazioni sufficienti per supportare un ripristino. per questo motivo, il richiedente deve accedere ai documenti dei metadati del writer archiviati durante il backup (vedere [uso dei componenti da parte del richiedente](use-of-components-by-the-requestor.md)).</span><span class="sxs-lookup"><span data-stu-id="d1a37-128">As was the case during the backup, the Backup Components Document has insufficient information to support a restore; therefore, the requester needs access to those Writer Metadata Documents stored during backup (see [Use of Components by the Requester](use-of-components-by-the-requestor.md)).</span></span>

<span data-ttu-id="d1a37-129">Il richiedente recupera i metadati del writer archiviati chiamando [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) per ogni writer di cui è stato eseguito il backup dei dati e che ora deve essere ripristinato.</span><span class="sxs-lookup"><span data-stu-id="d1a37-129">The requester retrieves the stored writer metadata by calling [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) for each writer whose data was backed up and now is to be restored.</span></span> <span data-ttu-id="d1a37-130">Questa funzione crea un oggetto [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) per ogni writer e carica il documento di metadati del writer del writer nell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="d1a37-130">This function creates an [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) object for each writer and loads the writer's Writer Metadata Document into the object.</span></span>

<span data-ttu-id="d1a37-131">Come nel caso del backup, per avviare la collaborazione tra se stesso e i writer del sistema, un richiedente deve generare un evento di [*Identificazione*](vssgloss-i.md) chiamando [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="d1a37-131">As was the case during the backup, to initiate cooperation between itself and the system's writers, a requester must generate an [*Identify*](vssgloss-i.md) event by calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="d1a37-132">Non è necessario chiamare [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) dopo il completamento di [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="d1a37-132">It is not necessary to call [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) following the completion of [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="d1a37-133">I writer che non riescono a elaborare l'evento di [*Identificazione*](vssgloss-i.md) non verranno inclusi nell'elenco di writer che forniscono i metadati che devono essere restituiti da [**IVssBackupComponents:: GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) e [**IVssBackupComponents:: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (vedere [determinare lo stato del writer](determining-writer-status.md)).</span><span class="sxs-lookup"><span data-stu-id="d1a37-133">Writers that fail to process the [*Identify*](vssgloss-i.md) event will not be included in the list of writers providing the metadata to be returned by [**IVssBackupComponents::GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (see [Determining Writer Status](determining-writer-status.md)).</span></span>

<span data-ttu-id="d1a37-134">Come per l'operazione di backup, un richiedente dovrà eseguire una query e analizzare le informazioni nel documento sui componenti di backup e confrontarlo con i dati nei documenti dei metadati del writer per individuare i componenti di cui è stato eseguito il backup e scegliere quelli da ripristinare. vedere [Panoramica della preparazione per il ripristino](overview-of-preparing-for-restore.md).</span><span class="sxs-lookup"><span data-stu-id="d1a37-134">As with the backup operation, a requester will need to query and parse the information in the Backup Components Document and compare it to data in the Writer Metadata Documents to determine which components were backed up and to choose those to be restored (see [Overview of Preparing for Restore](overview-of-preparing-for-restore.md)).</span></span> <span data-ttu-id="d1a37-135">Inoltre, il richiedente dovrà generare un elenco dettagliato contenente le informazioni sui file nel supporto di backup selezionato per il ripristino, nonché le modalità e la posizione in cui devono essere ripristinati.</span><span class="sxs-lookup"><span data-stu-id="d1a37-135">In addition, the requester will need to generate a detailed list containing information about the files on the backup media selected for restore, as well as how and where they are to be restored.</span></span> <span data-ttu-id="d1a37-136">(Vedere [generazione di un set di ripristino](generating-a-restore-set.md)).</span><span class="sxs-lookup"><span data-stu-id="d1a37-136">(See [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="d1a37-137">È pertanto possibile che alcune applicazioni di backup richiedano di archiviare nei supporti di backup il proprio elenco (in un formato ottimizzato) dei file e le informazioni relative a writer, componenti, procedure di ripristino e percorso.</span><span class="sxs-lookup"><span data-stu-id="d1a37-137">Therefore, some backup applications may find it useful to have stored on the backup media their own list (in their own optimized format) of the files and their associated writer, component, restore procedure, and location information.</span></span> <span data-ttu-id="d1a37-138">Questo elenco può essere utilizzato per ridurre al minimo la quantità di analisi e di confronto dei documenti di metadati del writer e dei documenti del componente di backup necessari per supportare un ripristino.</span><span class="sxs-lookup"><span data-stu-id="d1a37-138">This list can be used to minimize the amount of parsing and comparing of Writer Metadata Documents and the Backup Component Documents required to support a restore.</span></span>

## <a name="writer-actions-during-restore-initialization"></a><span data-ttu-id="d1a37-139">Azioni del writer durante l'inizializzazione del ripristino</span><span class="sxs-lookup"><span data-stu-id="d1a37-139">Writer Actions during Restore Initialization</span></span>

<span data-ttu-id="d1a37-140">Analogamente a quanto avviene durante un'operazione di ripristino, in risposta all'evento di identificazione, VSS chiama il metodo del gestore virtuale di ogni writer [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span><span class="sxs-lookup"><span data-stu-id="d1a37-140">Just as is done during a restore operation, in response to the Identify event, VSS calls each writer's virtual handler method [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span></span>

<span data-ttu-id="d1a37-141">Si noti che le applicazioni diverse dal richiedente corrente (ad esempio, le applicazioni di sistema) possono generare eventi di identificazione, che devono essere gestiti dal writer.</span><span class="sxs-lookup"><span data-stu-id="d1a37-141">Note that applications other than the current requester (for instance, system applications) can generate Identify events, which must be handled by the writer.</span></span> <span data-ttu-id="d1a37-142">Inoltre, non esiste alcun modo che un writer determini dall'interno di [**CVssWriter:: Onidentificate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) l'applicazione che ha generato l'evento di identificazione.</span><span class="sxs-lookup"><span data-stu-id="d1a37-142">In addition, there is no way for a writer to determine from within [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) which application has generated the Identify event.</span></span>

<span data-ttu-id="d1a37-143">Dato che un writer può ricevere diversi eventi di identificazione durante l'elaborazione di un'operazione di ripristino, i writer non devono mai impostare le informazioni sullo stato nel gestore [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) .</span><span class="sxs-lookup"><span data-stu-id="d1a37-143">Given that a writer may receive several Identify events while processing a restore operation, writers should never set state information in the [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) handler.</span></span> <span data-ttu-id="d1a37-144">Devono invece usare lo stesso algoritmo per la creazione del documento di metadati del writer come è stato fatto durante le operazioni di backup. per altre informazioni, vedere [azioni del writer durante l'inizializzazione del backup](overview-of-backup-initialization.md) .</span><span class="sxs-lookup"><span data-stu-id="d1a37-144">Instead, they must use the same algorithm for creating their Writer Metadata Document as was done during backup operations (see [Writer Actions during Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

 

 



