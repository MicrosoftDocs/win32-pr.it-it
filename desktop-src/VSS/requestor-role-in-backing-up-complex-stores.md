---
description: Come per tutte le operazioni importanti in VSS, i backup incrementali e differenziali richiedono una stretta collaborazione tra i richiedenti e i writer.
ms.assetid: 00391a49-8c81-4518-88a2-741ad5ee4ac3
title: Ruolo del richiedente nel backup di archivi complessi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 197351e76b6861ee9b9d1e0589ef028c911430ed
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104049846"
---
# <a name="requester-role-in-backing-up-complex-stores"></a><span data-ttu-id="7749a-103">Ruolo del richiedente nel backup di archivi complessi</span><span class="sxs-lookup"><span data-stu-id="7749a-103">Requester Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="7749a-104">Come per tutte le operazioni importanti in VSS, i backup [*incrementali*](vssgloss-i.md) e [*differenziali*](vssgloss-d.md) richiedono una stretta collaborazione tra i richiedenti e i writer.</span><span class="sxs-lookup"><span data-stu-id="7749a-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-type"></a><span data-ttu-id="7749a-105">Tipo di backup</span><span class="sxs-lookup"><span data-stu-id="7749a-105">Backup Type</span></span>

<span data-ttu-id="7749a-106">L'infrastruttura fornisce supporto speciale per cinque tipi di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="7749a-107">Sono descritte come segue:</span><span class="sxs-lookup"><span data-stu-id="7749a-107">They are described as follows:</span></span>

-   <span data-ttu-id="7749a-108">Completo (**VSS \_ BT \_ completo**).</span><span class="sxs-lookup"><span data-stu-id="7749a-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="7749a-109">Verrà eseguito il backup dei file indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="7749a-110">La cronologia di backup di ogni file verrà aggiornata e questo tipo di backup può essere utilizzato come base per un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="7749a-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="7749a-111">Se sono presenti file di log, è possibile che vengano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="7749a-112">Il ripristino di un backup completo richiede una sola immagine di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="7749a-113">Differenziale (**VSS \_ BT \_ differenziale**).</span><span class="sxs-lookup"><span data-stu-id="7749a-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="7749a-114">L'API VSS viene utilizzata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo vengano copiati in un supporto di archiviazione. tutte le informazioni sul backup intermedio verranno ignorate.</span><span class="sxs-lookup"><span data-stu-id="7749a-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="7749a-115">Questo può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="7749a-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="7749a-116">Un backup differenziale è associato a un backup completo e in genere non può essere ripristinato fino a quando non viene ripristinato il backup completo.</span><span class="sxs-lookup"><span data-stu-id="7749a-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="7749a-117">Se sono presenti file di log, in genere non verranno troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="7749a-118">Il ripristino di un backup differenziale richiede l'immagine di backup originale e l'immagine di backup differenziale più recente eseguita dopo l'ultimo backup completo.</span><span class="sxs-lookup"><span data-stu-id="7749a-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="7749a-119">Incrementale (**VSS \_ BT \_ incrementale**).</span><span class="sxs-lookup"><span data-stu-id="7749a-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="7749a-120">L'API VSS viene utilizzata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo o incrementale vengano copiati in un supporto di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="7749a-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="7749a-121">Questo può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="7749a-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="7749a-122">Alcuni writer non consentono di combinare backup incrementali con backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="7749a-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="7749a-123">Se sono presenti file di log, è possibile che vengano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="7749a-124">Il ripristino di un backup incrementale richiede l'immagine di backup originale e tutte le immagini di backup incrementali effettuate dal backup iniziale.</span><span class="sxs-lookup"><span data-stu-id="7749a-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="7749a-125">Backup del log **( \_ \_ log di VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="7749a-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="7749a-126">Verrà eseguito il backup solo dei file di log del writer, ovvero i file aggiunti a un componente con il metodo [**IVssCreateWriterMetadata:: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) e recuperato da una chiamata a [**IVssWMComponent:: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile).</span><span class="sxs-lookup"><span data-stu-id="7749a-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="7749a-127">Questo tipo di backup è specifico per VSS.</span><span class="sxs-lookup"><span data-stu-id="7749a-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="7749a-128">I backup del log tendono a essere eseguiti con molta frequenza.</span><span class="sxs-lookup"><span data-stu-id="7749a-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="7749a-129">In genere, il file di log verrà troncato in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="7749a-130">Backup di copia **( \_ \_ copia di VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="7749a-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="7749a-131">Analogamente al \_ \_ tipo di backup completo VSS BT, verrà eseguito il backup dei file indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="7749a-132">Tuttavia, la cronologia di backup di ogni file non verrà aggiornata e questo tipo di backup non può essere utilizzato come base per un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="7749a-132">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="7749a-133">I file di log non devono mai essere troncati come risultato di un backup di copia.</span><span class="sxs-lookup"><span data-stu-id="7749a-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="7749a-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Supporto file parziale</span><span class="sxs-lookup"><span data-stu-id="7749a-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="7749a-135">Alcuni writer supportano il ripristino dei file tramite la sovrascrittura delle parti dei file gestiti.</span><span class="sxs-lookup"><span data-stu-id="7749a-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="7749a-136">Un richiedente può essere progettato per trarre vantaggio da questo e, in caso affermativo, impostando le informazioni in [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="7749a-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="7749a-137">Il richiedente specifica il tipo di backup eseguito tramite il parametro *BackupType* di [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="7749a-137">The requester specifies what type of backup is being performed through the *backupType* parameter of [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="7749a-138">Writer diversi supporteranno tipi diversi di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-138">Different writers will support different types of backup.</span></span> <span data-ttu-id="7749a-139">Dopo la chiamata di [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) , il richiedente può determinare i tipi di backup supportati da un determinato writer chiamando [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="7749a-139">After [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) has been called, the requester can determine what types of backup a given writer supports by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="7749a-140">Il valore restituito è una maschera di bit che indica il supporto per diversi tipi di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-140">The returned value is a bit mask indicating support for different backup types.</span></span> <span data-ttu-id="7749a-141">Servizio Copia **shadow \_ del volume Il \_ differenziale BS** indica il supporto per i backup differenziali, il servizio Copia Shadow del volume **\_ \_ incrementale** per i backup incrementali, il **\_ \_ log VSS BS** per i backup del log e la **\_ \_ copia VSS BS** per i backup di copia. tutti i writer devono supportare backup completi.</span><span class="sxs-lookup"><span data-stu-id="7749a-141">**VSS\_BS\_DIFFERENTIAL** indicates support for differential backups, **VSS\_BS\_INCREMENTAL** for incremental backups, **VSS\_BS\_LOG** for log backups, and **VSS\_BS\_COPY** for copy backups; all writers must support full backups.</span></span> <span data-ttu-id="7749a-142">Se un writer non supporta la combinazione di backup incrementali con backup differenziali, verrà aggiunto anche il flag di **\_ \_ \_ \_ differenziale incrementale esclusivo VSS BS** .</span><span class="sxs-lookup"><span data-stu-id="7749a-142">If a writer does not support mixing incremental backups with differential backups, the **VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL** flag will be added as well.</span></span> <span data-ttu-id="7749a-143">Se il richiedente esegue un backup incrementale o differenziale e un determinato writer non supporta tale tipo di backup, è necessario eseguire un backup completo su tale writer.</span><span class="sxs-lookup"><span data-stu-id="7749a-143">If the requester is performing an incremental or differential backup and a given writer does not support that backup type, a full backup should be performed on that writer.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="7749a-144">Timbri di backup</span><span class="sxs-lookup"><span data-stu-id="7749a-144">Backup Stamps</span></span>

<span data-ttu-id="7749a-145">I backup incrementali e differenziali sono sempre associati a un backup precedente.</span><span class="sxs-lookup"><span data-stu-id="7749a-145">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="7749a-146">Esistono due modi per associare i backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-146">There are two ways to tie backups.</span></span> <span data-ttu-id="7749a-147">Per gli archivi dati semplici, il richiedente può tenere traccia della correlazione tra i backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-147">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="7749a-148">Tuttavia, per gli archivi dati più complessi, il writer dovrà mantenere il proprio timestamp con il backup; Questo timestamp può tenere traccia della posizione del log, delle informazioni sui checkpoint e così via.</span><span class="sxs-lookup"><span data-stu-id="7749a-148">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="7749a-149">Il richiedente può determinare se un determinato writer deve archiviare il proprio timestamp controllando il bit del **\_ \_ timestamp di VSS BS** nel valore restituito da [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="7749a-149">The requester can determine whether a given writer needs to store its own timestamp by checking for the **VSS\_BS\_TIMESTAMPED** bit in the value returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

<span data-ttu-id="7749a-150">I writer in cui viene archiviato un timestamp in un backup aggiungeranno il timestamp durante l'elaborazione di [**IVssBackupComponents::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o durante l'elaborazione di [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="7749a-150">Writers that store a timestamp in a backup will add the timestamp either while processing [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or while processing [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="7749a-151">Il richiedente può ottenere questo timestamp chiamando [**IVssComponent:: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="7749a-151">The requester can obtain this timestamp by calling [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span> <span data-ttu-id="7749a-152">Quando si esegue un backup incrementale o differenziale, il richiedente deve associare il backup corrente a un backup precedente.</span><span class="sxs-lookup"><span data-stu-id="7749a-152">When performing an incremental or differential backup, the requester needs to tie the current backup to some previous backup.</span></span> <span data-ttu-id="7749a-153">Questa operazione viene eseguita ottenendo il timestamp dal backup precedente di un componente specifico e passandolo alla funzione [**IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) ; Questa operazione deve essere eseguita per ogni componente di cui è stato eseguito il backup nel backup precedente.</span><span class="sxs-lookup"><span data-stu-id="7749a-153">This is done by obtaining the timestamp from the previous backup of a specific component and passing it into the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) function; this needs to be done for each component that was backed up in the previous backup.</span></span>

## <a name="backing-up-files"></a><span data-ttu-id="7749a-154">Backup di file</span><span class="sxs-lookup"><span data-stu-id="7749a-154">Backing Up Files</span></span>

### <a name="backing-up-files-reported-by-writer"></a><span data-ttu-id="7749a-155">Backup dei file segnalati dal writer</span><span class="sxs-lookup"><span data-stu-id="7749a-155">Backing Up Files Reported by Writer</span></span>

<span data-ttu-id="7749a-156">Ogni specifica di file aggiunta da un writer ai relativi metadati durante la fase GatherWriterMetadata contiene una maschera del tipo di backup che specifica quando eseguire il backup del file.</span><span class="sxs-lookup"><span data-stu-id="7749a-156">Every file specification that a writer adds to its metadata during the GatherWriterMetadata phase contains a backup type mask that specifies when the file should be backed up.</span></span> <span data-ttu-id="7749a-157">Il richiedente determina l'elemento della maschera chiamando [**IVssWMFiledesc:: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span><span class="sxs-lookup"><span data-stu-id="7749a-157">The requester determines what this mask is by calling [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span></span> <span data-ttu-id="7749a-158">I valori in questa maschera vengono utilizzati per determinare per quali tipi di backup deve essere eseguito il backup della specifica del file.</span><span class="sxs-lookup"><span data-stu-id="7749a-158">The values in this mask are used to determine for which backup types the file specification needs to be backed up.</span></span> <span data-ttu-id="7749a-159">La maschera può contenere uno o più dei seguenti valori di bit:</span><span class="sxs-lookup"><span data-stu-id="7749a-159">The mask can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="7749a-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**\_ \_ backup completo VSS \_ FSBT \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="7749a-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-161">Obbligatorio per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="7749a-161">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**è \_ \_ necessario il \_ backup DIFFERENZIAle FSBT VSS \_**</span><span class="sxs-lookup"><span data-stu-id="7749a-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-163">Obbligatorio per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="7749a-163">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**è \_ \_ necessario il backup incrementale FSBT VSS \_ \_**</span><span class="sxs-lookup"><span data-stu-id="7749a-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-165">Obbligatorio per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="7749a-165">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**\_backup del \_ log FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="7749a-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-167">Obbligatorio per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="7749a-167">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS \_ FSBT \_ tutti i \_ backup \_ necessari**</span><span class="sxs-lookup"><span data-stu-id="7749a-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-169">Obbligatorio per tutti i tipi di backup; si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="7749a-169">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="7749a-170">Questa specifica esegue l'override della specifica di selettività del componente.</span><span class="sxs-lookup"><span data-stu-id="7749a-170">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="7749a-171">Si consideri, ad esempio, un componente i cui file sono tutti contrassegnati con il **\_ backup del log VSS FSBT \_ \_ \_ richiesto** , ma non con il **\_ \_ backup completo VSS FSBT \_ \_ obbligatorio**.</span><span class="sxs-lookup"><span data-stu-id="7749a-171">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="7749a-172">Si supponga che il componente non sia selezionabile per il backup (*bSelectable* è false quando [**IVssCreateWriterMetadata:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) è stato chiamato).</span><span class="sxs-lookup"><span data-stu-id="7749a-172">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="7749a-173">Nel caso di un backup del log, significa che è necessario eseguire sempre il backup di tutti i file di questo componente.</span><span class="sxs-lookup"><span data-stu-id="7749a-173">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="7749a-174">Tuttavia, nel caso di un backup completo, non è necessario eseguire il backup di nessuno dei file, nonostante il fatto che la selettività del componente ne implichi il backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-174">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="7749a-175">Ora dell'Ultima modifica del backup</span><span class="sxs-lookup"><span data-stu-id="7749a-175">Backup by Last Modify Time</span></span>

<span data-ttu-id="7749a-176">Le informazioni sulle specifiche del file specificate nella fase [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) non forniscono informazioni sul richiedente relative a quanto è stato modificato dall'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-176">The file specification information specified in the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) phase does not give the requester information about what has changed since the last backup.</span></span> <span data-ttu-id="7749a-177">Un metodo per un writer per indicare le modifiche al richiedente consiste nell'usare il meccanismo di file differenziato.</span><span class="sxs-lookup"><span data-stu-id="7749a-177">One way for a writer to indicate changes to the requester is by using the differenced file mechanism.</span></span> <span data-ttu-id="7749a-178">Un writer può specificare che è necessario eseguire il backup di determinati file di un componente solo se sono stati modificati da un determinato periodo di tempo; il writer può specificare questi file in [**IVssBackupComponents::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="7749a-178">A writer can specify that certain files in a component should be backed up only if they have been modified since a certain time; the writer may specify these files either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="7749a-179">Un richiedente può determinare questi file chiamando [**IVssComponent:: GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) e [**IVssComponent:: GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="7749a-179">A requester can determine these files by calling [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) and [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="7749a-180">Se la specifica del file corrisponde a un set in **IVssBackupComponents:: GatherWriterMetadata** (attualmente valido in base al tipo di backup mask), le informazioni sul file differenziato eseguono l'override delle informazioni precedenti. in altre termini, viene eseguito il backup dei file corrispondenti alla specifica del file solo se sono stati modificati dopo l'ora specificata.</span><span class="sxs-lookup"><span data-stu-id="7749a-180">If the file specification matches one set in **IVssBackupComponents::GatherWriterMetadata** (that is currently valid based on the backup type mask) the differenced file information overrides the previous information; that is, the files matching that file specification are now backed up only if they have been modified since the specified time.</span></span> <span data-ttu-id="7749a-181">L'ora dell'Ultima modifica viene comunicata utilizzando una struttura [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) .</span><span class="sxs-lookup"><span data-stu-id="7749a-181">The last-modify time is communicated using a [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structure.</span></span> <span data-ttu-id="7749a-182">Se il valore di questa struttura è pari a zero, significa che è necessario determinare l'ora dell'Ultima modifica in base al record del richiedente dell'ora dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-182">If the value of this structure is zero, this implies that the last-modify time should be determined based on the requester's record of the time of last backup.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="7749a-183">Backup parziale dei file</span><span class="sxs-lookup"><span data-stu-id="7749a-183">Partial File Backup</span></span>

<span data-ttu-id="7749a-184">Un altro modo affinché un writer indichi modifiche al richiedente consiste nell'usare il meccanismo di file parziale.</span><span class="sxs-lookup"><span data-stu-id="7749a-184">Another way for a writer to indicate changes to the requester is by using the partial file mechanism.</span></span> <span data-ttu-id="7749a-185">Un writer può specificare intervalli di byte nei file di componente di cui è necessario eseguire il backup; il writer può specificare questi intervalli di file in [**IVssBackupComponents::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o in [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="7749a-185">A writer can specify byte ranges within component files that need to be backed up; the writer can specify these file ranges either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="7749a-186">Un richiedente può determinare questi file chiamando [**IVssComponent:: GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) e [**IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="7749a-186">A requester can determine these files by calling [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) and [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="7749a-187">**IVssComponent:: GetPartialFile** restituirà un percorso e un nome di file che punta al file e una stringa di intervalli che indica gli elementi di cui è necessario eseguire il backup nel file.</span><span class="sxs-lookup"><span data-stu-id="7749a-187">**IVssComponent::GetPartialFile** will return a path and a file name pointing to the file, and a ranges string indicating what needs to be backed up in the file.</span></span> <span data-ttu-id="7749a-188">Come per i file differenziati, se il percorso e il nome del file corrispondono a una specifica del file impostata dal writer in [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), le informazioni sul file parziale eseguono l'override dell'impostazione precedente.</span><span class="sxs-lookup"><span data-stu-id="7749a-188">As with differenced files, if the path and file name matches a file specification set by the writer in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), the partial-file information overrides the previous setting.</span></span> <span data-ttu-id="7749a-189">La stringa degli intervalli può avere due formati: può specificare direttamente gli intervalli o specificare un file contenente le informazioni sugli intervalli.</span><span class="sxs-lookup"><span data-stu-id="7749a-189">The ranges string can have two formats: it can either specify the ranges directly, or it can specify a file containing ranges information.</span></span> <span data-ttu-id="7749a-190">Se si specificano gli intervalli direttamente, la sintassi è un elenco delimitato da virgole nel formato offset1: length1, offset2: length2, dove ogni offset e lunghezza è un Unsigned Integer a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="7749a-190">If specifying ranges directly, the syntax is a comma-separated list of the form offset1:length1, offset2:length2, where each offset and length is a 64-bit unsigned integer.</span></span> <span data-ttu-id="7749a-191">Se si specifica un file degli intervalli, la stringa degli intervalli deve essere impostata su file = *filename*, dove *filename* è il percorso completo del file degli intervalli.</span><span class="sxs-lookup"><span data-stu-id="7749a-191">If specifying a ranges file, the ranges string should be set to File= *filename*, where *filename* is the full path to the ranges file.</span></span> <span data-ttu-id="7749a-192">Il file degli intervalli è un file binario formattato come un elenco di interi senza segno a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="7749a-192">The ranges file itself is a binary file that is formatted as a list of 64-bit unsigned integers.</span></span> <span data-ttu-id="7749a-193">Il primo valore integer indica il numero di intervalli rappresentati nel file.</span><span class="sxs-lookup"><span data-stu-id="7749a-193">The first integer indicates how many ranges are represented in the file.</span></span> <span data-ttu-id="7749a-194">Ogni coppia di numeri interi successiva rappresenta l'offset e la lunghezza di un intervallo.</span><span class="sxs-lookup"><span data-stu-id="7749a-194">Each subsequent pair of integers represents the offset and length of a range.</span></span> <span data-ttu-id="7749a-195">Il richiedente deve prestare attenzione al backup e al ripristino del file degli intervalli.</span><span class="sxs-lookup"><span data-stu-id="7749a-195">The requester must take care to back up and restore this ranges file as well.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="7749a-196">Regole specifiche file</span><span class="sxs-lookup"><span data-stu-id="7749a-196">File Specification Rules</span></span>

<span data-ttu-id="7749a-197">Le specifiche dei file aggiunte tramite il file differenziato e i meccanismi di file parziale modificheranno le specifiche del file impostate in [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) o aggiungono file completamente nuovi.</span><span class="sxs-lookup"><span data-stu-id="7749a-197">File specifications added through the differenced-file and the partial-file mechanisms will either modify file specifications set in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) or add completely new files.</span></span> <span data-ttu-id="7749a-198">Se si modificano le specifiche dei file impostate in **IVssBackupComponents:: GatherWriterMetadata** usando il meccanismo di file parziale, un richiedente può prevedere che la specifica del file corrisponda esattamente a una delle specifiche del file impostate nel componente in **IVssBackupComponents:: GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="7749a-198">If modifying files specifications set in **IVssBackupComponents::GatherWriterMetadata** using the partial-file mechanism, then a requester can expect the file specification to exactly match one of the file specifications set in the component in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="7749a-199">La specifica del file non si sovrappone parzialmente a un'altra specifica di file e non corrisponderà ad alcuna specifica di file in alcun altro componente di tale writer.</span><span class="sxs-lookup"><span data-stu-id="7749a-199">The file specification will not partially overlap another file specification, and it will not match any file specifications in any other of that writer's components.</span></span> <span data-ttu-id="7749a-200">Le specifiche dei file aggiunte utilizzando il meccanismo di file parziale possono, tuttavia, sovrapporsi parzialmente a un'altra specifica di file.</span><span class="sxs-lookup"><span data-stu-id="7749a-200">File specifications added using the partial-file mechanism can, however, partially overlap another file specification.</span></span> <span data-ttu-id="7749a-201">Quando è true, la specifica del file differenziato o del file parziale sostituisce il set di specifiche in **IVssBackupComponents:: GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="7749a-201">When this is true, the differenced-file or partial-file specification overrides the specification set in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="7749a-202">Le specifiche di file generali possono avere un valore di percorso alternativo (restituito da [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) che indica una posizione alternativa da cui ottenere il file in fase di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-202">General file specifications can have an alternate-location value (returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) that indicates an alternate place to obtain the file from at backup time.</span></span> <span data-ttu-id="7749a-203">Se le specifiche del file impostate tramite i meccanismi di file differenziati o parziali corrispondono a una specifica di file esistente con un percorso alternativo, i dati devono essere prelevati da questo percorso alternativo.</span><span class="sxs-lookup"><span data-stu-id="7749a-203">If the file specifications set through the differenced-file or partial file mechanisms match an existing files specification that has an alternate location, the data should be picked up from this alternate location.</span></span> <span data-ttu-id="7749a-204">Se le specifiche del file impostate tramite i meccanismi di file differenziato o di file parziale non corrispondono ad alcuna specifica esistente per il componente, è ora necessario aggiungere questi intervalli di file al backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-204">If the file specifications set through the differenced-file or partial-file mechanisms do not match any existing specifications for the component, then these file ranges should now be added to the backup.</span></span> <span data-ttu-id="7749a-205">Il richiedente può prevedere che solo i file nei volumi che sono già stati inclusi nel set di copie shadow verranno aggiunti usando uno di questi meccanismi.</span><span class="sxs-lookup"><span data-stu-id="7749a-205">The requester can expect that only files on volumes that have already been included in the shadow copy set will be added using one of these mechanisms.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="7749a-206">Backup senza copia shadow</span><span class="sxs-lookup"><span data-stu-id="7749a-206">Backup without a Shadow Copy</span></span>

<span data-ttu-id="7749a-207">Potrebbe non essere necessario eseguire il backup di alcuni tipi di file da un volume di copia shadow.</span><span class="sxs-lookup"><span data-stu-id="7749a-207">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="7749a-208">Questo, ad esempio, sarà spesso vero per i file di log del database.</span><span class="sxs-lookup"><span data-stu-id="7749a-208">For example, this will often be true of database log files.</span></span> <span data-ttu-id="7749a-209">Poiché i file di log aumentano in modo progressivo e un writer può specificare esattamente le parti del file di cui eseguire il backup usando file parziali, è spesso possibile eseguire il backup della disconnessione dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="7749a-209">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to backup the log off the original volume.</span></span> <span data-ttu-id="7749a-210">Come ottimizzazione, un writer può contrassegnare i file che richiedono copie shadow per diversi tipi di backup usando la maschera del tipo di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-210">As an optimization, a writer can mark which files require shadow copies for different backup types using the backup-type mask.</span></span> <span data-ttu-id="7749a-211">Il valore restituito da [**IVssWMFiledesc:: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) può contenere uno o più dei seguenti valori di bit:</span><span class="sxs-lookup"><span data-stu-id="7749a-211">The value returned from [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="7749a-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**\_ \_ snapshot completo VSS \_ FSBT \_ necessario**</span><span class="sxs-lookup"><span data-stu-id="7749a-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-213">Copia shadow necessaria per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="7749a-213">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**\_ \_ snapshot differenziale FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="7749a-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-215">Copia shadow necessaria per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="7749a-215">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**\_ \_ snapshot incrementale FSBT \_ VSS \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="7749a-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-217">Copia shadow necessaria per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="7749a-217">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**\_snapshot del \_ log FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="7749a-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-219">Copia shadow necessaria per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="7749a-219">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="7749a-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS \_ FSBT \_ tutti gli \_ snapshot \_ necessari**</span><span class="sxs-lookup"><span data-stu-id="7749a-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="7749a-221">Copia shadow necessaria per tutti i tipi di backup; si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="7749a-221">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="7749a-222">Se un volume specifico contiene solo componenti che non richiedono una copia shadow per questo backup, il richiedente può ignorare il passaggio della creazione di una copia shadow per questo volume.</span><span class="sxs-lookup"><span data-stu-id="7749a-222">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="7749a-223">Tutti i dati di questo volume possono essere copiati nel supporto di backup direttamente dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="7749a-223">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="restoring-files"></a><span data-ttu-id="7749a-224">Ripristino di file</span><span class="sxs-lookup"><span data-stu-id="7749a-224">Restoring Files</span></span>

### <a name="sequential-restores"></a><span data-ttu-id="7749a-225">Ripristini sequenziali</span><span class="sxs-lookup"><span data-stu-id="7749a-225">Sequential Restores</span></span>

<span data-ttu-id="7749a-226">Al termine dell'esecuzione di un'operazione di ripristino, il richiedente invia l'evento PostRestore a tutti i writer.</span><span class="sxs-lookup"><span data-stu-id="7749a-226">After the requester is done performing a restore operation, it sends the PostRestore event to all writers.</span></span> <span data-ttu-id="7749a-227">In genere, i writer gestiscono questo evento eseguendo il ripristino o altre operazioni di post-ripristino.</span><span class="sxs-lookup"><span data-stu-id="7749a-227">Generally, writers handle this event by performing recovery or other post-restore operations.</span></span> <span data-ttu-id="7749a-228">Il ripristino dei backup incrementali, tuttavia, si verifica in genere come una sequenza di operazioni di ripristino, una per ogni backup incrementale.</span><span class="sxs-lookup"><span data-stu-id="7749a-228">Restoration of incremental backups, however, usually happen as a sequence of restore operations, one per incremental backup.</span></span> <span data-ttu-id="7749a-229">Il richiedente deve informare il writer che tale ripristino è in corso per impedire che il ripristino o altre operazioni indesiderate vengano eseguite fino al completamento del ripristino.</span><span class="sxs-lookup"><span data-stu-id="7749a-229">The requester needs to inform the writer that such a restoration is in progress in order to prevent recovery or other undesirable operations from happening until the restore is completely done.</span></span> <span data-ttu-id="7749a-230">Questa operazione viene eseguita chiamando [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="7749a-230">This is done by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span> <span data-ttu-id="7749a-231">Questo metodo viene chiamato per componente e indica al writer che sono in arrivo più ripristini per quel componente.</span><span class="sxs-lookup"><span data-stu-id="7749a-231">This method is called per component, and indicates to the writer that more restores are coming for that component.</span></span> <span data-ttu-id="7749a-232">Per il ripristino finale nella sequenza, il flag di ripristini aggiuntivi deve essere impostato su false (valore predefinito), che indica che si tratta dell'ultimo ripristino nella sequenza per quel componente.</span><span class="sxs-lookup"><span data-stu-id="7749a-232">For the final restore in the sequence, the additional-restores flag should be set to false (its default value), which indicates that this is the last restore in the sequence for that component.</span></span>

### <a name="new-targets"></a><span data-ttu-id="7749a-233">Nuove destinazioni</span><span class="sxs-lookup"><span data-stu-id="7749a-233">New Targets</span></span>

<span data-ttu-id="7749a-234">Se supportato dal writer, il richiedente può ripristinare i file di dati in un percorso diverso da quello originale in fase di backup.</span><span class="sxs-lookup"><span data-stu-id="7749a-234">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="7749a-235">Il richiedente può verificare la presenza di questo supporto chiamando [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="7749a-235">The requester can check for this support by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="7749a-236">Il **\_ writer BS \_ VSS \_ supporta \_ \_** la creazione di un nuovo bit di destinazione se il writer supporta questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="7749a-236">The **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit will be set if the writer supports this behavior.</span></span> <span data-ttu-id="7749a-237">Il richiedente informa il writer del nuovo percorso chiamando [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) per ogni specifica di file rilocata.</span><span class="sxs-lookup"><span data-stu-id="7749a-237">The requester informs the writer of the new location by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) for each relocated file specification.</span></span> <span data-ttu-id="7749a-238">Il richiedente può inoltre decidere di ripristinare un file di intervalli specifico in un percorso diverso.</span><span class="sxs-lookup"><span data-stu-id="7749a-238">The requester can also decide to restore a specific ranges file to a different location.</span></span> <span data-ttu-id="7749a-239">Il richiedente informa il writer di questa modifica chiamando [**IVssBackupComponents:: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span><span class="sxs-lookup"><span data-stu-id="7749a-239">The requester informs the writer of this change by calling [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span></span>

### <a name="directed-targets"></a><span data-ttu-id="7749a-240">Destinazioni dirette</span><span class="sxs-lookup"><span data-stu-id="7749a-240">Directed Targets</span></span>

<span data-ttu-id="7749a-241">Per gli scenari di ripristino complessi, un writer potrebbe voler eseguire il mapping degli intervalli di un file di cui è stato eseguito il backup in intervalli diversi dello stesso file o di un file diverso.</span><span class="sxs-lookup"><span data-stu-id="7749a-241">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="7749a-242">Questa operazione può essere eseguita usando il meccanismo di destinazione diretto.</span><span class="sxs-lookup"><span data-stu-id="7749a-242">This can be done by using the directed target mechanism.</span></span> <span data-ttu-id="7749a-243">Il richiedente può determinare dopo la fase [**IVssBackupComponents::P Rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) che questo meccanismo viene usato per un componente chiamando [**IVssComponent:: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) e controllando la presenza di un ritorno di **VSS \_ RT \_ diretto**.</span><span class="sxs-lookup"><span data-stu-id="7749a-243">The requester can determine after the [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase that this mechanism is being used for a component by calling [**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) and checking for a return of **VSS\_RT\_DIRECTED**.</span></span> <span data-ttu-id="7749a-244">È possibile che il richiedente ottenga tutti i ripristini reindirizzati chiamando [**IVssComponent:: GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) e [**IVssComponent:: GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="7749a-244">The requester can than obtain all of these redirected restores by calling [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) and [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span></span> <span data-ttu-id="7749a-245">**IVssComponent:: GetDirectedTarget** restituirà il percorso completo di un file di origine nel backup e il percorso completo di un file di destinazione in cui verrà ripristinato.</span><span class="sxs-lookup"><span data-stu-id="7749a-245">**IVssComponent::GetDirectedTarget** will return a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="7749a-246">Restituisce anche un elenco di intervalli per ognuno di questi file.</span><span class="sxs-lookup"><span data-stu-id="7749a-246">It also returns a ranges list for each of these files.</span></span> <span data-ttu-id="7749a-247">Il richiedente è quindi responsabile del ripristino degli intervalli specificati nel file di origine agli intervalli mappati nel file di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7749a-247">The requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="7749a-248">Il formato della stringa degli intervalli è identico a quello di [**IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="7749a-248">The format of the ranges string is the same as in [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span>

-   [<span data-ttu-id="7749a-249">Ruolo writer nei backup incrementali e differenziali VSS</span><span class="sxs-lookup"><span data-stu-id="7749a-249">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="7749a-250">Ruolo del richiedente nei backup incrementali e differenziali VSS</span><span class="sxs-lookup"><span data-stu-id="7749a-250">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 
