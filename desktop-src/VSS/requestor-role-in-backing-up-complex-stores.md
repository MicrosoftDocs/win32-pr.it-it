---
description: Informazioni sul ruolo del richiedente nei backup incrementali e differenziali, che richiedono una stretta collaborazione tra richiedenti e writer.
ms.assetid: 00391a49-8c81-4518-88a2-741ad5ee4ac3
title: Ruolo richiedente nel backup di archivi complessi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a84dfa1b0b1837bacc2488b6bd9e3ffdd51b92c0
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262183"
---
# <a name="requester-role-in-backing-up-complex-stores"></a><span data-ttu-id="3414b-103">Ruolo richiedente nel backup di archivi complessi</span><span class="sxs-lookup"><span data-stu-id="3414b-103">Requester Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="3414b-104">Come per tutte le operazioni importanti in VSS, i backup [*incrementali*](vssgloss-i.md) e [*differenziali*](vssgloss-d.md) richiedono una stretta collaborazione tra richiedenti e writer.</span><span class="sxs-lookup"><span data-stu-id="3414b-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-type"></a><span data-ttu-id="3414b-105">Tipo di backup</span><span class="sxs-lookup"><span data-stu-id="3414b-105">Backup Type</span></span>

<span data-ttu-id="3414b-106">L'infrastruttura offre un supporto speciale per cinque tipi di backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="3414b-107">Sono descritte come segue:</span><span class="sxs-lookup"><span data-stu-id="3414b-107">They are described as follows:</span></span>

-   <span data-ttu-id="3414b-108">Full (**VSS \_ BT \_ FULL**).</span><span class="sxs-lookup"><span data-stu-id="3414b-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="3414b-109">Verrà eseguito il backup dei file indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="3414b-110">La cronologia di backup di ogni file verrà aggiornata e questo tipo di backup può essere usato come base di un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="3414b-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="3414b-111">Se sono presenti file di log, è possibile che siano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="3414b-112">Il ripristino di un backup completo richiede una sola immagine di backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="3414b-113">Differenziale (**VSS \_ BT \_ DIFFERENTIAL**).</span><span class="sxs-lookup"><span data-stu-id="3414b-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="3414b-114">L'API VSS viene usata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo devono essere copiati in un supporto di archiviazione. tutte le informazioni di backup intermedie vengono ignorate.</span><span class="sxs-lookup"><span data-stu-id="3414b-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="3414b-115">Può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="3414b-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="3414b-116">Un backup differenziale è associato a un backup completo e in genere non può essere ripristinato fino al ripristino del backup completo.</span><span class="sxs-lookup"><span data-stu-id="3414b-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="3414b-117">Se sono presenti file di log, in genere non verranno troncati come risultato di questo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="3414b-118">Il ripristino di un backup differenziale richiede l'immagine di backup originale e l'immagine di backup differenziale più recente effettuata dopo l'ultimo backup completo.</span><span class="sxs-lookup"><span data-stu-id="3414b-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="3414b-119">Incrementale (**VSS \_ BT \_ INCREMENTAL**).</span><span class="sxs-lookup"><span data-stu-id="3414b-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="3414b-120">L'API VSS viene usata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo o incrementale devono essere copiati in un supporto di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="3414b-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="3414b-121">Può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="3414b-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="3414b-122">Alcuni writer non consentono l'esecuzione di backup incrementali con backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="3414b-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="3414b-123">Se sono presenti file di log, è possibile che siano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="3414b-124">Il ripristino di un backup incrementale richiede l'immagine di backup originale e tutte le immagini di backup incrementale effettuate dopo il backup iniziale.</span><span class="sxs-lookup"><span data-stu-id="3414b-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="3414b-125">Backup del log (**VSS \_ BT \_ LOG**).</span><span class="sxs-lookup"><span data-stu-id="3414b-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="3414b-126">Verrà eseguito il backup solo dei file di log di un writer (file aggiunti a un componente con il metodo [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) e recuperati da una chiamata a [**IVssWMComponent::GetDatabaseLogFile).**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)</span><span class="sxs-lookup"><span data-stu-id="3414b-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="3414b-127">Questo tipo di backup è specifico di VSS.</span><span class="sxs-lookup"><span data-stu-id="3414b-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="3414b-128">I backup del log tendono a essere esersi con una frequenza piuttosto frequente.</span><span class="sxs-lookup"><span data-stu-id="3414b-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="3414b-129">In genere, il file di log verrà troncato in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="3414b-130">Copiare il backup (**VSS \_ BT \_ COPY**).</span><span class="sxs-lookup"><span data-stu-id="3414b-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="3414b-131">Analogamente al tipo di backup FULL di VSS BT, verrà eseguito il backup dei file \_ \_ indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="3414b-132">Tuttavia, la cronologia di backup di ogni file non verrà aggiornata e questo tipo di backup non può essere usato come base di un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="3414b-132">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="3414b-133">I file di log non devono mai essere troncati in seguito a un backup di copia.</span><span class="sxs-lookup"><span data-stu-id="3414b-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="3414b-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Supporto di file parziali</span><span class="sxs-lookup"><span data-stu-id="3414b-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="3414b-135">Alcuni writer supportano il ripristino dei file tramite la sovrascrittura di parti dei file gestiti.</span><span class="sxs-lookup"><span data-stu-id="3414b-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="3414b-136">Un richiedente può essere progettato per sfruttare questo vantaggio e, in tal caso, lo indica impostando le informazioni in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="3414b-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="3414b-137">Il richiedente specifica il tipo di backup eseguito tramite il parametro *backupType* di [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="3414b-137">The requester specifies what type of backup is being performed through the *backupType* parameter of [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="3414b-138">Writer diversi supporteranno tipi diversi di backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-138">Different writers will support different types of backup.</span></span> <span data-ttu-id="3414b-139">Dopo aver chiamato [**IVssBackupComponents::GatherWriterMetadata,**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) il richiedente può determinare i tipi di backup supportati da un determinato writer chiamando [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="3414b-139">After [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) has been called, the requester can determine what types of backup a given writer supports by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="3414b-140">Il valore restituito è una maschera di bit che indica il supporto per tipi di backup diversi.</span><span class="sxs-lookup"><span data-stu-id="3414b-140">The returned value is a bit mask indicating support for different backup types.</span></span> <span data-ttu-id="3414b-141">**VSS \_ BS \_ DIFFERENTIAL** indica il supporto per i backup differenziali, **VSS \_ BS \_ INCREMENTAL** per i backup incrementali, **VSS \_ BS \_ LOG** per i backup del log e **VSS \_ BS \_ COPY** per i backup di copia. Tutti i writer devono supportare i backup completi.</span><span class="sxs-lookup"><span data-stu-id="3414b-141">**VSS\_BS\_DIFFERENTIAL** indicates support for differential backups, **VSS\_BS\_INCREMENTAL** for incremental backups, **VSS\_BS\_LOG** for log backups, and **VSS\_BS\_COPY** for copy backups; all writers must support full backups.</span></span> <span data-ttu-id="3414b-142">Se un writer non supporta la combinazione di backup incrementali con backup differenziali, verrà aggiunto anche il flag **\_ \_ \_ \_ DIFFERENZIALE INCREMENTALE** ESCLUSIVO DI VSS BS.</span><span class="sxs-lookup"><span data-stu-id="3414b-142">If a writer does not support mixing incremental backups with differential backups, the **VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL** flag will be added as well.</span></span> <span data-ttu-id="3414b-143">Se il richiedente esegue un backup incrementale o differenziale e un writer specificato non supporta tale tipo di backup, è necessario eseguire un backup completo su tale writer.</span><span class="sxs-lookup"><span data-stu-id="3414b-143">If the requester is performing an incremental or differential backup and a given writer does not support that backup type, a full backup should be performed on that writer.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="3414b-144">Stamp di backup</span><span class="sxs-lookup"><span data-stu-id="3414b-144">Backup Stamps</span></span>

<span data-ttu-id="3414b-145">I backup incrementali e differenziali sono sempre associati a un backup precedente.</span><span class="sxs-lookup"><span data-stu-id="3414b-145">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="3414b-146">Esistono due modi per collegare i backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-146">There are two ways to tie backups.</span></span> <span data-ttu-id="3414b-147">Per gli archivi dati semplici, il richiedente può tenere traccia della correlazione tra i backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-147">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="3414b-148">Tuttavia, per archivi dati più complessi, il writer dovrà mantenere il proprio timestamp con il backup. questo timestamp può tenere traccia della posizione del log, delle informazioni sul checkpoint e così via.</span><span class="sxs-lookup"><span data-stu-id="3414b-148">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="3414b-149">Il richiedente può determinare se un determinato writer deve archiviare il proprio timestamp controllando il bit **\_ \_ TIMESTAMPED di VSS BS** nel valore restituito da [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="3414b-149">The requester can determine whether a given writer needs to store its own timestamp by checking for the **VSS\_BS\_TIMESTAMPED** bit in the value returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

<span data-ttu-id="3414b-150">I writer che archiviano un timestamp in un backup aggiungeranno il timestamp durante l'elaborazione [**di IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o durante l'elaborazione [**di IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="3414b-150">Writers that store a timestamp in a backup will add the timestamp either while processing [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or while processing [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="3414b-151">Il richiedente può ottenere questo timestamp chiamando [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="3414b-151">The requester can obtain this timestamp by calling [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span> <span data-ttu-id="3414b-152">Quando si esegue un backup incrementale o differenziale, il richiedente deve collegare il backup corrente a un backup precedente.</span><span class="sxs-lookup"><span data-stu-id="3414b-152">When performing an incremental or differential backup, the requester needs to tie the current backup to some previous backup.</span></span> <span data-ttu-id="3414b-153">Questa operazione viene eseguita ottenendo il timestamp dal backup precedente di un componente specifico e passandolo alla funzione [**IVssBackupComponents::SetPreviousBackupStamp.**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) questa operazione deve essere eseguita per ogni componente di cui è stato eseguito il backup nel backup precedente.</span><span class="sxs-lookup"><span data-stu-id="3414b-153">This is done by obtaining the timestamp from the previous backup of a specific component and passing it into the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) function; this needs to be done for each component that was backed up in the previous backup.</span></span>

## <a name="backing-up-files"></a><span data-ttu-id="3414b-154">Backup di file</span><span class="sxs-lookup"><span data-stu-id="3414b-154">Backing Up Files</span></span>

### <a name="backing-up-files-reported-by-writer"></a><span data-ttu-id="3414b-155">Backup dei file segnalati dal writer</span><span class="sxs-lookup"><span data-stu-id="3414b-155">Backing Up Files Reported by Writer</span></span>

<span data-ttu-id="3414b-156">Ogni specifica di file aggiunta da un writer ai metadati durante la fase GatherWriterMetadata contiene una maschera del tipo di backup che specifica quando eseguire il backup del file.</span><span class="sxs-lookup"><span data-stu-id="3414b-156">Every file specification that a writer adds to its metadata during the GatherWriterMetadata phase contains a backup type mask that specifies when the file should be backed up.</span></span> <span data-ttu-id="3414b-157">Il richiedente determina che cos'è questa maschera chiamando [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span><span class="sxs-lookup"><span data-stu-id="3414b-157">The requester determines what this mask is by calling [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span></span> <span data-ttu-id="3414b-158">I valori in questa maschera vengono usati per determinare per quali tipi di backup deve essere eseguito il backup della specifica di file.</span><span class="sxs-lookup"><span data-stu-id="3414b-158">The values in this mask are used to determine for which backup types the file specification needs to be backed up.</span></span> <span data-ttu-id="3414b-159">La maschera può contenere uno o più dei valori di bit seguenti:</span><span class="sxs-lookup"><span data-stu-id="3414b-159">The mask can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="3414b-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**BACKUP COMPLETO DI VSS \_ FSBT \_ \_ \_ OBBLIGATORIO**</span><span class="sxs-lookup"><span data-stu-id="3414b-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-161">Obbligatorio per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="3414b-161">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**BACKUP DIFFERENZIALE DI VSS \_ FSBT \_ \_ \_ OBBLIGATORIO**</span><span class="sxs-lookup"><span data-stu-id="3414b-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-163">Obbligatorio per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="3414b-163">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**BACKUP INCREMENTALE DI VSS \_ FSBT \_ \_ \_ OBBLIGATORIO**</span><span class="sxs-lookup"><span data-stu-id="3414b-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-165">Obbligatorio per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="3414b-165">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**BACKUP DEL LOG FSBT DI VSS \_ \_ \_ \_ OBBLIGATORIO**</span><span class="sxs-lookup"><span data-stu-id="3414b-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-167">Obbligatorio per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="3414b-167">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS \_ FSBT \_ ALL \_ BACKUP \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-169">Obbligatorio per tutti i tipi di backup. si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="3414b-169">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="3414b-170">Questa specifica esegue l'override della specifica di selettività del componente.</span><span class="sxs-lookup"><span data-stu-id="3414b-170">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="3414b-171">Si consideri ad esempio un componente i cui file sono tutti contrassegnati con **VSS \_ FSBT \_ LOG BACKUP \_ \_ REQUIRED** ma non con **VSS \_ FSBT \_ FULL BACKUP \_ \_ REQUIRED**.</span><span class="sxs-lookup"><span data-stu-id="3414b-171">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="3414b-172">Si supponga che questo componente non sia selezionabile per il backup (*bSelectable* era false quando è stato chiamato [**IVssCreateWriterMetadata::AddComponent).**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent)</span><span class="sxs-lookup"><span data-stu-id="3414b-172">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="3414b-173">Nel caso di un backup del log, ciò significa che è sempre necessario eseguire il backup di tutti i file in questo componente.</span><span class="sxs-lookup"><span data-stu-id="3414b-173">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="3414b-174">Tuttavia, nel caso di un backup completo, non è necessario eseguire il backup di nessuno dei file, anche se la selettività del componente implica che deve essere eseguito il backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-174">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="3414b-175">Backup in base all'ora dell'ultima modifica</span><span class="sxs-lookup"><span data-stu-id="3414b-175">Backup by Last Modify Time</span></span>

<span data-ttu-id="3414b-176">Le informazioni sulla specifica del file specificate nella fase [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) non forniscono al richiedente informazioni sugli elementi modificati dopo l'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-176">The file specification information specified in the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) phase does not give the requester information about what has changed since the last backup.</span></span> <span data-ttu-id="3414b-177">Un modo per indicare le modifiche al richiedente da parte di un writer consiste nell'usare il meccanismo di file differenze.</span><span class="sxs-lookup"><span data-stu-id="3414b-177">One way for a writer to indicate changes to the requester is by using the differenced file mechanism.</span></span> <span data-ttu-id="3414b-178">Un writer può specificare che è necessario eseguire il backup di determinati file in un componente solo se sono stati modificati da un determinato periodo di tempo. il writer può specificare questi file in [**IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o in [**IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="3414b-178">A writer can specify that certain files in a component should be backed up only if they have been modified since a certain time; the writer may specify these files either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="3414b-179">Un richiedente può determinare questi file chiamando [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) e [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="3414b-179">A requester can determine these files by calling [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) and [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="3414b-180">Se la specifica del file corrisponde a un set in **IVssBackupComponents::GatherWriterMetadata** (attualmente valido in base alla maschera del tipo di backup), le informazioni sui file con differenze eseguono l'override delle informazioni precedenti. in altri, i file corrispondenti a tale specifica di file vengono ora sottoposti a backup solo se sono stati modificati dopo l'ora specificata.</span><span class="sxs-lookup"><span data-stu-id="3414b-180">If the file specification matches one set in **IVssBackupComponents::GatherWriterMetadata** (that is currently valid based on the backup type mask) the differenced file information overrides the previous information; that is, the files matching that file specification are now backed up only if they have been modified since the specified time.</span></span> <span data-ttu-id="3414b-181">L'ora dell'ultima modifica viene comunicata usando una [**struttura FILETIME.**](/windows/win32/api/minwinbase/ns-minwinbase-filetime)</span><span class="sxs-lookup"><span data-stu-id="3414b-181">The last-modify time is communicated using a [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structure.</span></span> <span data-ttu-id="3414b-182">Se il valore di questa struttura è zero, significa che l'ora dell'ultima modifica deve essere determinata in base al record del richiedente dell'ora dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-182">If the value of this structure is zero, this implies that the last-modify time should be determined based on the requester's record of the time of last backup.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="3414b-183">Backup parziale di file</span><span class="sxs-lookup"><span data-stu-id="3414b-183">Partial File Backup</span></span>

<span data-ttu-id="3414b-184">Un altro modo per indicare le modifiche al richiedente da parte di un writer è l'uso del meccanismo di file parziale.</span><span class="sxs-lookup"><span data-stu-id="3414b-184">Another way for a writer to indicate changes to the requester is by using the partial file mechanism.</span></span> <span data-ttu-id="3414b-185">Un writer può specificare intervalli di byte all'interno dei file del componente di cui è necessario eseguire il backup; Il writer può specificare questi intervalli di file in [**IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) o in [**IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="3414b-185">A writer can specify byte ranges within component files that need to be backed up; the writer can specify these file ranges either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="3414b-186">Un richiedente può determinare questi file chiamando [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) e [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="3414b-186">A requester can determine these files by calling [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) and [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="3414b-187">**IVssComponent::GetPartialFile** restituirà un percorso e un nome file che punta al file e una stringa di intervalli che indica gli elementi di cui eseguire il backup nel file.</span><span class="sxs-lookup"><span data-stu-id="3414b-187">**IVssComponent::GetPartialFile** will return a path and a file name pointing to the file, and a ranges string indicating what needs to be backed up in the file.</span></span> <span data-ttu-id="3414b-188">Come per i file con differenze, se il percorso e il nome del file corrispondono a una specifica di file impostata dal writer in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), le informazioni sul file parziale eseguono l'override dell'impostazione precedente.</span><span class="sxs-lookup"><span data-stu-id="3414b-188">As with differenced files, if the path and file name matches a file specification set by the writer in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), the partial-file information overrides the previous setting.</span></span> <span data-ttu-id="3414b-189">La stringa ranges può avere due formati: può specificare direttamente gli intervalli oppure può specificare un file contenente informazioni sugli intervalli.</span><span class="sxs-lookup"><span data-stu-id="3414b-189">The ranges string can have two formats: it can either specify the ranges directly, or it can specify a file containing ranges information.</span></span> <span data-ttu-id="3414b-190">Se si specificano direttamente gli intervalli, la sintassi è un elenco delimitato da virgole nel formato offset1:length1, offset2:length2, dove ogni offset e lunghezza è un intero senza segno a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="3414b-190">If specifying ranges directly, the syntax is a comma-separated list of the form offset1:length1, offset2:length2, where each offset and length is a 64-bit unsigned integer.</span></span> <span data-ttu-id="3414b-191">Se si specifica un file di intervalli, la stringa degli intervalli deve essere impostata su File= *nomefile*, dove *nomefile* è il percorso completo del file di intervalli.</span><span class="sxs-lookup"><span data-stu-id="3414b-191">If specifying a ranges file, the ranges string should be set to File= *filename*, where *filename* is the full path to the ranges file.</span></span> <span data-ttu-id="3414b-192">Il file di intervalli stesso è un file binario formattato come elenco di interi senza segno a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="3414b-192">The ranges file itself is a binary file that is formatted as a list of 64-bit unsigned integers.</span></span> <span data-ttu-id="3414b-193">Il primo numero intero indica il numero di intervalli rappresentati nel file.</span><span class="sxs-lookup"><span data-stu-id="3414b-193">The first integer indicates how many ranges are represented in the file.</span></span> <span data-ttu-id="3414b-194">Ogni coppia successiva di interi rappresenta l'offset e la lunghezza di un intervallo.</span><span class="sxs-lookup"><span data-stu-id="3414b-194">Each subsequent pair of integers represents the offset and length of a range.</span></span> <span data-ttu-id="3414b-195">Il richiedente deve eseguire anche il backup e il ripristino di questo file di intervalli.</span><span class="sxs-lookup"><span data-stu-id="3414b-195">The requester must take care to back up and restore this ranges file as well.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="3414b-196">Regole di specifica dei file</span><span class="sxs-lookup"><span data-stu-id="3414b-196">File Specification Rules</span></span>

<span data-ttu-id="3414b-197">Le specifiche di file aggiunte tramite i meccanismi differenced-file e partial-file modificheranno le specifiche di file impostate in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) o aggiungeranno file completamente nuovi.</span><span class="sxs-lookup"><span data-stu-id="3414b-197">File specifications added through the differenced-file and the partial-file mechanisms will either modify file specifications set in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) or add completely new files.</span></span> <span data-ttu-id="3414b-198">Se si modificano le specifiche dei file impostate in **IVssBackupComponents::GatherWriterMetadata** usando il meccanismo di file parziale, un richiedente può aspettarsi che la specifica del file corrisponda esattamente a una delle specifiche di file impostate nel componente in **IVssBackupComponents::GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="3414b-198">If modifying files specifications set in **IVssBackupComponents::GatherWriterMetadata** using the partial-file mechanism, then a requester can expect the file specification to exactly match one of the file specifications set in the component in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="3414b-199">La specifica del file non si sovrapporrà parzialmente a un'altra specifica di file e non corrisponderà ad alcuna specifica di file in altri componenti del writer.</span><span class="sxs-lookup"><span data-stu-id="3414b-199">The file specification will not partially overlap another file specification, and it will not match any file specifications in any other of that writer's components.</span></span> <span data-ttu-id="3414b-200">Le specifiche di file aggiunte usando il meccanismo del file parziale possono tuttavia sovrapporsi parzialmente a un'altra specifica di file.</span><span class="sxs-lookup"><span data-stu-id="3414b-200">File specifications added using the partial-file mechanism can, however, partially overlap another file specification.</span></span> <span data-ttu-id="3414b-201">In questo caso, la specifica differenced-file o partial-file sostituisce la specifica impostata in **IVssBackupComponents::GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="3414b-201">When this is true, the differenced-file or partial-file specification overrides the specification set in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="3414b-202">Le specifiche di file generali possono avere un valore di posizione alternativa (restituito da [**IVssWMFiledesc::GetAlternateLocation)**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)che indica una posizione alternativa da cui ottenere il file in fase di backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-202">General file specifications can have an alternate-location value (returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) that indicates an alternate place to obtain the file from at backup time.</span></span> <span data-ttu-id="3414b-203">Se le specifiche di file impostate tramite i meccanismi di file differenze o parziali corrispondono a una specifica di file esistente con un percorso alternativo, i dati devono essere prelevati da questo percorso alternativo.</span><span class="sxs-lookup"><span data-stu-id="3414b-203">If the file specifications set through the differenced-file or partial file mechanisms match an existing files specification that has an alternate location, the data should be picked up from this alternate location.</span></span> <span data-ttu-id="3414b-204">Se le specifiche di file impostate tramite i meccanismi differenced-file o partial-file non corrispondono ad alcuna specifica esistente per il componente, questi intervalli di file dovrebbero ora essere aggiunti al backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-204">If the file specifications set through the differenced-file or partial-file mechanisms do not match any existing specifications for the component, then these file ranges should now be added to the backup.</span></span> <span data-ttu-id="3414b-205">Il richiedente può prevedere che solo i file nei volumi già inclusi nel set di copie shadow verranno aggiunti usando uno di questi meccanismi.</span><span class="sxs-lookup"><span data-stu-id="3414b-205">The requester can expect that only files on volumes that have already been included in the shadow copy set will be added using one of these mechanisms.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="3414b-206">Backup senza copia shadow</span><span class="sxs-lookup"><span data-stu-id="3414b-206">Backup without a Shadow Copy</span></span>

<span data-ttu-id="3414b-207">Potrebbe non essere necessario eseguire il backup di alcuni tipi di file da un volume di copia shadow.</span><span class="sxs-lookup"><span data-stu-id="3414b-207">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="3414b-208">Ad esempio, questo vale spesso per i file di log del database.</span><span class="sxs-lookup"><span data-stu-id="3414b-208">For example, this will often be true of database log files.</span></span> <span data-ttu-id="3414b-209">Poiché le dimensioni dei file di log aumentano in modo monotona e un writer può specificare esattamente le parti del file di cui eseguire il backup usando file parziali, è spesso possibile eseguire il backup della disconnessione dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="3414b-209">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to backup the log off the original volume.</span></span> <span data-ttu-id="3414b-210">Come ottimizzazione, un writer può contrassegnare i file che richiedono copie shadow per tipi di backup diversi usando la maschera del tipo di backup.</span><span class="sxs-lookup"><span data-stu-id="3414b-210">As an optimization, a writer can mark which files require shadow copies for different backup types using the backup-type mask.</span></span> <span data-ttu-id="3414b-211">Il valore restituito [**da IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) può contenere uno o più dei valori di bit seguenti:</span><span class="sxs-lookup"><span data-stu-id="3414b-211">The value returned from [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="3414b-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS \_ FSBT \_ FULL \_ SNAPSHOT \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-213">Copia shadow necessaria per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="3414b-213">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS \_ FSBT \_ DIFFERENTIAL \_ SNAPSHOT \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-215">Copia shadow necessaria per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="3414b-215">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS \_ FSBT \_ INCREMENTAL \_ SNAPSHOT \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-217">Copia shadow necessaria per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="3414b-217">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS \_ FSBT \_ LOG \_ SNAPSHOT \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-219">Copia shadow necessaria per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="3414b-219">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="3414b-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS \_ FSBT \_ ALL \_ SNAPSHOT \_ REQUIRED**</span><span class="sxs-lookup"><span data-stu-id="3414b-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="3414b-221">Copia shadow necessaria per tutti i tipi di backup. si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="3414b-221">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="3414b-222">Se un volume specifico contiene solo componenti che non richiedono una copia shadow per questo backup, il richiedente può ignorare il passaggio di creazione di una copia shadow per questo volume.</span><span class="sxs-lookup"><span data-stu-id="3414b-222">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="3414b-223">Tutti i dati in questo volume possono essere copiati nel supporto di backup direttamente dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="3414b-223">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="restoring-files"></a><span data-ttu-id="3414b-224">Ripristino di file</span><span class="sxs-lookup"><span data-stu-id="3414b-224">Restoring Files</span></span>

### <a name="sequential-restores"></a><span data-ttu-id="3414b-225">Ripristini sequenziali</span><span class="sxs-lookup"><span data-stu-id="3414b-225">Sequential Restores</span></span>

<span data-ttu-id="3414b-226">Dopo che il richiedente ha eseguito un'operazione di ripristino, invia l'evento PostRestore a tutti i writer.</span><span class="sxs-lookup"><span data-stu-id="3414b-226">After the requester is done performing a restore operation, it sends the PostRestore event to all writers.</span></span> <span data-ttu-id="3414b-227">In genere, i writer gestiscono questo evento eseguendo il ripristino o altre operazioni successive al ripristino.</span><span class="sxs-lookup"><span data-stu-id="3414b-227">Generally, writers handle this event by performing recovery or other post-restore operations.</span></span> <span data-ttu-id="3414b-228">Il ripristino dei backup incrementali, tuttavia, avviene in genere come sequenza di operazioni di ripristino, una per ogni backup incrementale.</span><span class="sxs-lookup"><span data-stu-id="3414b-228">Restoration of incremental backups, however, usually happen as a sequence of restore operations, one per incremental backup.</span></span> <span data-ttu-id="3414b-229">Il richiedente deve informare il writer che tale ripristino è in corso per impedire il ripristino o altre operazioni indesiderate fino al completamento del ripristino.</span><span class="sxs-lookup"><span data-stu-id="3414b-229">The requester needs to inform the writer that such a restoration is in progress in order to prevent recovery or other undesirable operations from happening until the restore is completely done.</span></span> <span data-ttu-id="3414b-230">Questa operazione viene eseguita chiamando [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="3414b-230">This is done by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span> <span data-ttu-id="3414b-231">Questo metodo viene chiamato per ogni componente e indica al writer che sono in arrivo altri ripristini per tale componente.</span><span class="sxs-lookup"><span data-stu-id="3414b-231">This method is called per component, and indicates to the writer that more restores are coming for that component.</span></span> <span data-ttu-id="3414b-232">Per il ripristino finale nella sequenza, il flag additional-restores deve essere impostato su false (valore predefinito), che indica che si tratta dell'ultimo ripristino nella sequenza per tale componente.</span><span class="sxs-lookup"><span data-stu-id="3414b-232">For the final restore in the sequence, the additional-restores flag should be set to false (its default value), which indicates that this is the last restore in the sequence for that component.</span></span>

### <a name="new-targets"></a><span data-ttu-id="3414b-233">Nuove destinazioni</span><span class="sxs-lookup"><span data-stu-id="3414b-233">New Targets</span></span>

<span data-ttu-id="3414b-234">Se supportato dal writer, il richiedente può ripristinare i file di dati in un percorso diverso da quello dell'ora di backup originale.</span><span class="sxs-lookup"><span data-stu-id="3414b-234">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="3414b-235">Il richiedente può verificare questo supporto chiamando [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="3414b-235">The requester can check for this support by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="3414b-236">Il bit **VSS \_ BS \_ WRITER \_ SUPPORTS \_ NEW \_ TARGET** verrà impostato se il writer supporta questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="3414b-236">The **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit will be set if the writer supports this behavior.</span></span> <span data-ttu-id="3414b-237">Il richiedente informa il writer del nuovo percorso chiamando [**IVssBackupComponents::AddNewTarget per**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) ogni specifica di file rilocato.</span><span class="sxs-lookup"><span data-stu-id="3414b-237">The requester informs the writer of the new location by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) for each relocated file specification.</span></span> <span data-ttu-id="3414b-238">Il richiedente può anche decidere di ripristinare un file di intervalli specifico in un percorso diverso.</span><span class="sxs-lookup"><span data-stu-id="3414b-238">The requester can also decide to restore a specific ranges file to a different location.</span></span> <span data-ttu-id="3414b-239">Il richiedente informa il writer di questa modifica chiamando [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span><span class="sxs-lookup"><span data-stu-id="3414b-239">The requester informs the writer of this change by calling [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span></span>

### <a name="directed-targets"></a><span data-ttu-id="3414b-240">Destinazioni dirette</span><span class="sxs-lookup"><span data-stu-id="3414b-240">Directed Targets</span></span>

<span data-ttu-id="3414b-241">Per scenari di ripristino complessi, un writer potrebbe voler eseguire il mapping di intervalli di un file di cui è stato eseguito il backup in intervalli diversi dello stesso file o in un file diverso.</span><span class="sxs-lookup"><span data-stu-id="3414b-241">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="3414b-242">Questa operazione può essere eseguita usando il meccanismo di destinazione diretto.</span><span class="sxs-lookup"><span data-stu-id="3414b-242">This can be done by using the directed target mechanism.</span></span> <span data-ttu-id="3414b-243">Il richiedente può determinare dopo la fase [**IVssBackupComponents::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) che questo meccanismo viene usato per un componente chiamando [**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) e controllando la restituzione di **VSS \_ RT \_ DIRECTED.**</span><span class="sxs-lookup"><span data-stu-id="3414b-243">The requester can determine after the [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase that this mechanism is being used for a component by calling [**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) and checking for a return of **VSS\_RT\_DIRECTED**.</span></span> <span data-ttu-id="3414b-244">Il richiedente può ottenere tutti questi ripristini reindirizzati chiamando [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) e [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="3414b-244">The requester can than obtain all of these redirected restores by calling [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) and [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span></span> <span data-ttu-id="3414b-245">**IVssComponent::GetDirectedTarget** restituirà un percorso completo di un file di origine nel backup e un percorso completo di un file di destinazione in cui verrà ripristinato.</span><span class="sxs-lookup"><span data-stu-id="3414b-245">**IVssComponent::GetDirectedTarget** will return a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="3414b-246">Restituisce anche un elenco di intervalli per ognuno di questi file.</span><span class="sxs-lookup"><span data-stu-id="3414b-246">It also returns a ranges list for each of these files.</span></span> <span data-ttu-id="3414b-247">Il richiedente è quindi responsabile del ripristino degli intervalli specificati nel file di origine negli intervalli mappati nel file di destinazione.</span><span class="sxs-lookup"><span data-stu-id="3414b-247">The requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="3414b-248">Il formato della stringa degli intervalli è lo stesso di [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="3414b-248">The format of the ranges string is the same as in [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span>

-   [<span data-ttu-id="3414b-249">Ruolo writer nei backup incrementali e differenziali vss</span><span class="sxs-lookup"><span data-stu-id="3414b-249">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="3414b-250">Ruolo richiedente nei backup incrementali e differenziali vss</span><span class="sxs-lookup"><span data-stu-id="3414b-250">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 
