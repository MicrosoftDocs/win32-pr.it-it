---
description: Durante la preparazione per un ripristino, un richiedente usa i documenti dei metadati del writer archiviati insieme al documento relativo ai componenti di backup recuperati per determinare gli elementi da ripristinare e come.
ms.assetid: 36cf188f-fce6-467c-a200-cbd9dc8f31a6
title: Panoramica della preparazione per il ripristino
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8b1bc3e429da5be9872e8345fe6da32a5340005
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310687"
---
# <a name="overview-of-preparing-for-restore"></a><span data-ttu-id="89c90-103">Panoramica della preparazione per il ripristino</span><span class="sxs-lookup"><span data-stu-id="89c90-103">Overview of Preparing for Restore</span></span>

<span data-ttu-id="89c90-104">Durante la preparazione per un ripristino, un richiedente usa i documenti dei metadati del writer archiviati insieme al documento relativo ai componenti di backup recuperati per determinare gli elementi da ripristinare e come.</span><span class="sxs-lookup"><span data-stu-id="89c90-104">In preparing for a restore, a requester uses the stored Writer Metadata Documents in conjunction with its own retrieved Backup Components Document to determine what is to be restored and how.</span></span> <span data-ttu-id="89c90-105">Per ulteriori informazioni, vedere [Cenni preliminari sull'elaborazione di un ripristino in VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="89c90-105">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="89c90-106">Dopo la selezione dei componenti di ripristino candidati, i writer attualmente in esecuzione nel sistema accedono al documento componenti di backup del richiedente.</span><span class="sxs-lookup"><span data-stu-id="89c90-106">Following the selection of restore candidate components, writers currently running on the system access the requester's Backup Components Document.</span></span> <span data-ttu-id="89c90-107">I writer utilizzano questo accesso per indicare come provocare difficoltà minime per l'esecuzione dei servizi a causa del ripristino.</span><span class="sxs-lookup"><span data-stu-id="89c90-107">Writers use this access to indicate how to cause minimum difficulty for running services due to the restore.</span></span>

<span data-ttu-id="89c90-108">Al termine di questa operazione, il richiedente avrà a disposizione informazioni sufficienti per determinare quali file dovranno essere ripristinati, nonché la posizione e il modo in cui devono essere ripristinati.</span><span class="sxs-lookup"><span data-stu-id="89c90-108">After this is completed, the requester has enough information to determine which files will need to be restored, as well as where and how they should be restored.</span></span> <span data-ttu-id="89c90-109">Per ulteriori informazioni, vedere [generazione di un set di ripristino](generating-a-restore-set.md).</span><span class="sxs-lookup"><span data-stu-id="89c90-109">(For more information, see [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="89c90-110">Nella tabella seguente viene illustrata la sequenza di azioni ed eventi necessari per preparare un'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="89c90-110">The following table shows the sequence of actions and events that are required to prepare for a restore operation.</span></span>



| <span data-ttu-id="89c90-111">Azione del richiedente</span><span class="sxs-lookup"><span data-stu-id="89c90-111">Requester action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <span data-ttu-id="89c90-112">Evento</span><span class="sxs-lookup"><span data-stu-id="89c90-112">Event</span></span>                                                         | <span data-ttu-id="89c90-113">Azione del writer</span><span class="sxs-lookup"><span data-stu-id="89c90-113">Writer action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="89c90-114">Recuperare le informazioni dal documento componenti di backup sui componenti [*inclusi in modo esplicito*](vssgloss-e.md) nell'operazione di backup (vedere [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) esaminare i documenti dei metadati del writer recuperato per ottenere i dettagli relativi ai componenti inclusi in modo esplicito nel backup e tutti i componenti secondari [*inclusi in modo implicito*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="89c90-114">Retrieve information from the Backup Components Document about the components [*explicitly included*](vssgloss-e.md) in the backup operation (see [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) Examine retrieved Writer Metadata Documents to get details about those components explicitly included in the backup, and any find [*implicitly included*](vssgloss-i.md) subcomponents.</span></span> <span data-ttu-id="89c90-115">(Vedere [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent)).</span><span class="sxs-lookup"><span data-stu-id="89c90-115">(See [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent).)</span></span><br/> | <span data-ttu-id="89c90-116">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-116">None</span></span>                                                          | <span data-ttu-id="89c90-117">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-117">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="89c90-118">Selezionare i componenti e i set di componenti da ripristinare (vedere [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) e [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).)</span><span class="sxs-lookup"><span data-stu-id="89c90-118">Select components and component sets to be restored (see [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) and [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).)</span></span>                                                                                                                                                                                                                                                                                                                                                                                          | <span data-ttu-id="89c90-119">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-119">None</span></span>                                                          | <span data-ttu-id="89c90-120">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-120">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="89c90-121">Il richiedente consente al writer di aggiornare il documento dei componenti di backup e, facoltativamente, di comunicare eventuali opzioni di ripristino speciali al writer.</span><span class="sxs-lookup"><span data-stu-id="89c90-121">The requester allows the writer to update the Backup Components Document and may optionally communicate any special restore options to the writer.</span></span> <span data-ttu-id="89c90-122">(Vedere [**IVssBackupComponents:: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)e [**IVssBackupComponents: rerestore:P**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).)</span><span class="sxs-lookup"><span data-stu-id="89c90-122">(See [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget), and [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).)</span></span>                                                                                                                                                                                                                                         | [<span data-ttu-id="89c90-123">*PreRestore*</span><span class="sxs-lookup"><span data-stu-id="89c90-123">*PreRestore*</span></span>](vssgloss-p.md) | <span data-ttu-id="89c90-124">Il writer determina la partecipazione al ripristino, prepara i file da ripristinare e, facoltativamente, modifica i componenti di backup del documento, se necessario.</span><span class="sxs-lookup"><span data-stu-id="89c90-124">The writer determines participation in the restore, prepares files to restore, and optionally modifies Backup Components Document if necessary.</span></span> <span data-ttu-id="89c90-125">(Vedere [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent:: GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).)</span><span class="sxs-lookup"><span data-stu-id="89c90-125">(See [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).)</span></span> |
| <span data-ttu-id="89c90-126">Il richiedente attende che i writer gestiscano l'evento di [**preripristino**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) con [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span><span class="sxs-lookup"><span data-stu-id="89c90-126">The requester waits on writers to handle the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span> <span data-ttu-id="89c90-127">Deve inoltre verificare lo stato del writer.</span><span class="sxs-lookup"><span data-stu-id="89c90-127">It should also verify writer status.</span></span> <span data-ttu-id="89c90-128">(Vedere [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus).)</span><span class="sxs-lookup"><span data-stu-id="89c90-128">(See [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus).)</span></span>                                                                                                                                                                                                                                                                                  | <span data-ttu-id="89c90-129">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-129">None</span></span>                                                          | <span data-ttu-id="89c90-130">nessuno</span><span class="sxs-lookup"><span data-stu-id="89c90-130">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |



 

## <a name="requester-actions-during-restore-preparations"></a><span data-ttu-id="89c90-131">Azioni del richiedente durante i preparativi di ripristino</span><span class="sxs-lookup"><span data-stu-id="89c90-131">Requester Actions during Restore Preparations</span></span>

<span data-ttu-id="89c90-132">Per determinare quali componenti sono candidati per il ripristino, il richiedente deve eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="89c90-132">To determine which components are candidates for restore, the requester must do the following:</span></span>

-   <span data-ttu-id="89c90-133">Stabilire il componente e la struttura del [*set di componenti*](vssgloss-c.md) utilizzata per eseguire il backup.</span><span class="sxs-lookup"><span data-stu-id="89c90-133">Establish the component and the [*component set*](vssgloss-c.md) structure used to make the backup.</span></span>
-   <span data-ttu-id="89c90-134">Esaminare la selezione dei componenti [*per il ripristino*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="89c90-134">Examine the components' [*selectability for restore*](vssgloss-s.md).</span></span>
-   <span data-ttu-id="89c90-135">Usare le linee guida per la selezione (utilizzo[della selezione per il ripristino e i sottocomponenti](working-with-selectability-for-restore-and-subcomponents.md)) per scegliere i componenti da includere.</span><span class="sxs-lookup"><span data-stu-id="89c90-135">Use selectability guidelines ([Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)) to choose components to include.</span></span>
-   <span data-ttu-id="89c90-136">Utilizzare le informazioni sui [*set di file*](vssgloss-f.md) dei componenti per determinare quali file nel supporto di backup devono essere ripristinati.</span><span class="sxs-lookup"><span data-stu-id="89c90-136">Use component [*file set*](vssgloss-f.md) information to determine which files on the backup media must be restored.</span></span>

<span data-ttu-id="89c90-137">A tale scopo, il richiedente deve esaminare i componenti [*inclusi in modo esplicito*](vssgloss-e.md) nel documento relativo ai componenti di backup archiviati.</span><span class="sxs-lookup"><span data-stu-id="89c90-137">To do this, the requester needs to examine [*explicitly included*](vssgloss-e.md) components in the stored Backup Components Document.</span></span> <span data-ttu-id="89c90-138">Queste informazioni sul componente sono disponibili per Writer per Writer usando [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), che restituisce le istanze dell'interfaccia [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) , da cui è possibile recuperare sia le informazioni del writer sia le istanze dell'interfaccia [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="89c90-138">This component information is available on a writer-by-writer basis using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface, from which both writer information and instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface can be retrieved.</span></span>

<span data-ttu-id="89c90-139">Come indicato altrove ([utilizzo di componenti dal richiedente](use-of-components-by-the-requestor.md)), il documento componenti di backup e l'interfaccia **IVssComponent** non contengono informazioni sufficienti per supportare il backup.</span><span class="sxs-lookup"><span data-stu-id="89c90-139">As noted elsewhere ([Use of Components by the Requester](use-of-components-by-the-requestor.md)), the Backup Components Document and the **IVssComponent** interface do not contain enough information to support the backup.</span></span> <span data-ttu-id="89c90-140">Pertanto, il richiedente deve esaminare il documento di metadati del writer archiviato corrispondente usando [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (vedere [le informazioni di identificazione del writer](writer-metadata-document-contents.md)).</span><span class="sxs-lookup"><span data-stu-id="89c90-140">Therefore, the requester must examine the corresponding stored Writer Metadata Document by using [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (see [Writer Identification Information](writer-metadata-document-contents.md)).</span></span>

<span data-ttu-id="89c90-141">Il numero di componenti gestiti da ogni writer viene restituito da [**IVssExamineWriterMetadata:: GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts).</span><span class="sxs-lookup"><span data-stu-id="89c90-141">The number of components each writer manages is returned by [**IVssExamineWriterMetadata::GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts).</span></span> <span data-ttu-id="89c90-142">Il richiedente può quindi usare [**IVssExamineWriterMetadata:: getComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) per ottenere un'interfaccia [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) per ogni componente gestito da un writer.</span><span class="sxs-lookup"><span data-stu-id="89c90-142">The requester can then use [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) to get an [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface for each component a writer manages.</span></span>

<span data-ttu-id="89c90-143">Esaminando la selezione dei componenti [*per*](vssgloss-s.md) i [*percorsi logici*](vssgloss-l.md) e di backup (vedere [utilizzo di selezione e percorsi logici](working-with-selectability-and-logical-paths.md)), un richiedente è in grado di identificare i componenti che definiscono set di componenti della fase di backup (componenti inclusi in modo esplicito) e i membri dei sottocomponenti di tali set (componenti inclusi in modo implicito).</span><span class="sxs-lookup"><span data-stu-id="89c90-143">By examining the components' [*selectability for backup*](vssgloss-s.md) and [*logical paths*](vssgloss-l.md) (see [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md)), a requester is able to identify the components that defined backup-time component sets (explicitly included components), and the subcomponents members of those sets (implicitly included components).</span></span>

<span data-ttu-id="89c90-144">I richiedenti indicano tramite il documento componenti di backup se un componente deve essere ripristinato in modo esplicito, utilizzando [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89c90-144">Requesters indicate through the Backup Components Document if a component is to be explicitly restored, using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="89c90-145">La scelta del metodo dipenderà dal modo in cui il componente è stato originariamente sottoposto a backup e dalla relativa [*selezione per il ripristino*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="89c90-145">The choice of method will depend on how the component was originally backed up and its [*selectability for restore*](vssgloss-s.md).</span></span> <span data-ttu-id="89c90-146">Questi componenti inclusi in modo esplicito per il ripristino designano altri componenti inclusi in modo implicito (vedere [uso della selezione per il ripristino e i sottocomponenti](working-with-selectability-for-restore-and-subcomponents.md) per informazioni dettagliate).</span><span class="sxs-lookup"><span data-stu-id="89c90-146">These components explicitly included for restore designate other components which are implicitly included (see [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md) for details).</span></span>

<span data-ttu-id="89c90-147">Un richiedente può includere in modo esplicito nessuno dei componenti del writer attualmente in esecuzione per il ripristino usando [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89c90-147">A requester may explicitly include none of a currently executing writer's components for restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="89c90-148">In questo caso, il writer non riceverà alcun evento VSS per il resto dell'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="89c90-148">In this case, that writer will not receive any VSS events for the remainder of the restore operation.</span></span>

<span data-ttu-id="89c90-149">L'utilizzo esplicito di [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) per selezionare un componente di un writer che non è attualmente in esecuzione restituisce un \_ errore VSS E \_ Object \_ non \_ trovato.</span><span class="sxs-lookup"><span data-stu-id="89c90-149">Explicitly using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) to select a component of a writer that is not currently running returns a VSS\_E\_OBJECT\_NOT\_FOUND error.</span></span> <span data-ttu-id="89c90-150">Per informazioni sul ripristino dei dati di writer mancanti, vedere [ripristini senza partecipazione del writer](restores-without-writer-participation.md) .</span><span class="sxs-lookup"><span data-stu-id="89c90-150">See [Restores without Writer Participation](restores-without-writer-participation.md) for information on restoring the data of missing writers.</span></span>

<span data-ttu-id="89c90-151">Per consentire a un writer di avere informazioni complete su cui agire, le opzioni di ripristino specifiche del writer e l'indicazione di un ripristino incrementale possono essere inviate ai writer dalle chiamate del richiedente a [**IVssBackupComponents:: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) e [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="89c90-151">To enable a writer to have complete information upon which to act, writer-specific restore options and indication of an incremental restore can be sent to the writers by requester calls to [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) and [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), respectively.</span></span>

<span data-ttu-id="89c90-152">A questo punto, un richiedente ha completato la preparazione e genera un evento di **Preripristino** chiamando [**IVssBackupComponents::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), consentendo ai writer di prepararsi per il ripristino effettivo.</span><span class="sxs-lookup"><span data-stu-id="89c90-152">At this point, a requester has finished its preparation, and it generates a **PreRestore** event by calling [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), allowing writers to prepare for the actual restore.</span></span>

## <a name="writer-actions-during-restore-preparations"></a><span data-ttu-id="89c90-153">Azioni del writer durante i preparativi di ripristino</span><span class="sxs-lookup"><span data-stu-id="89c90-153">Writer Actions during Restore Preparations</span></span>

<span data-ttu-id="89c90-154">La preparazione del writer per l'operazione di ripristino si verifica quando si gestisce l'evento di [**preripristino**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) con il metodo virtuale [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span><span class="sxs-lookup"><span data-stu-id="89c90-154">Writer preparation for the restore operation occurs when handling the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with the virtual method [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span></span> <span data-ttu-id="89c90-155">L'implementazione predefinita restituisce semplicemente senza eseguire alcuna azione.</span><span class="sxs-lookup"><span data-stu-id="89c90-155">The default implementation simply returns without taking any action.</span></span> <span data-ttu-id="89c90-156">È possibile che i writer scelgano di eseguire l'override dell'implementazione predefinita per esercitare un maggiore controllo:</span><span class="sxs-lookup"><span data-stu-id="89c90-156">Writers may choose to override the default implementation to exercise more control by:</span></span>

-   <span data-ttu-id="89c90-157">Override dei [*metodi di ripristino*](vssgloss-r.md) con [*destinazioni Restore*](vssgloss-r.md)</span><span class="sxs-lookup"><span data-stu-id="89c90-157">Overriding [*restore methods*](vssgloss-r.md) with [*restore targets*](vssgloss-r.md)</span></span>
-   <span data-ttu-id="89c90-158">Definizione di [ *destinazioni dirette*](vssgloss-d.md)</span><span class="sxs-lookup"><span data-stu-id="89c90-158">Defining [*directed targets*](vssgloss-d.md)</span></span>
-   <span data-ttu-id="89c90-159">Creazione di messaggi di errore e dati aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="89c90-159">Creating error messages and additional data</span></span>
-   <span data-ttu-id="89c90-160">Fornire informazioni sul timbro di backup</span><span class="sxs-lookup"><span data-stu-id="89c90-160">Supplying backup stamp information</span></span>

<span data-ttu-id="89c90-161">Il gestore eventi [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) riceve un'istanza di [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), da cui può ottenere le interfacce [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) per i componenti inclusi in modo esplicito nel documento componenti di backup durante il backup.</span><span class="sxs-lookup"><span data-stu-id="89c90-161">The event handler [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) receives an instance of the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), from which it can obtain [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interfaces for those of its components explicitly included in the Backup Components Document during backup.</span></span>

<span data-ttu-id="89c90-162">Informazioni sui sottocomponenti inclusi in modo implicito nelle operazioni di backup e incluse in modo esplicito nei ripristini utilizzando un'istanza di **IVssComponent** corrispondente al componente che ha definito il relativo [*set di componenti*](vssgloss-c.md)di backup.</span><span class="sxs-lookup"><span data-stu-id="89c90-162">Information about subcomponents implicitly included in backup operations and explicitly included in restores by using an instance of the **IVssComponent** corresponding to the component that defined its backup [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="89c90-163">Il metodo [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) viene usato per determinare se deve essere ripristinato un componente incluso in modo esplicito per il backup.</span><span class="sxs-lookup"><span data-stu-id="89c90-163">The [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) method is used to determine whether an explicitly included for backup component is to be restored.</span></span>

<span data-ttu-id="89c90-164">Per determinare se un sottocomponente di backup è stato incluso in modo esplicito nel ripristino, i writer utilizzano [**IVssComponent:: GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89c90-164">To determine if a backup subcomponent was explicitly included in the restore, writers use [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span></span>

<span data-ttu-id="89c90-165">Il writer deve esaminare il [*set di file*](vssgloss-f.md) in ogni componente e determinare se è necessario eseguire azioni per supportare il ripristino.</span><span class="sxs-lookup"><span data-stu-id="89c90-165">The writer should examine the [*file set*](vssgloss-f.md) in each component and determine if it needs to take actions to support the restore.</span></span> <span data-ttu-id="89c90-166">Il writer dovrà valutare se desidera che i file correnti vengano sovrascritti o se sarà necessario ripristinare i nuovi percorsi.</span><span class="sxs-lookup"><span data-stu-id="89c90-166">The writer will need to evaluate if it wants its current files overwritten, or if it will require restoration to new locations.</span></span> <span data-ttu-id="89c90-167">Le azioni possono includere quanto segue:</span><span class="sxs-lookup"><span data-stu-id="89c90-167">Actions can include the following:</span></span>

-   <span data-ttu-id="89c90-168">Come ottenere e agire su qualsiasi opzione specifica del writer o del richiedente che regola le operazioni di ripristino (vedere [**IVssComponent:: GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="89c90-168">Getting and acting on any writer- or requester-specific options governing restore operations (see [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="89c90-169">Chiusura e rendere scrivibile tutti i file attualmente aperti</span><span class="sxs-lookup"><span data-stu-id="89c90-169">Closing and making writable any currently open files</span></span>
-   <span data-ttu-id="89c90-170">Aggiornamento della destinazione di ripristino, ad esempio per forzare il ripristino in un mapping del percorso alternativo.</span><span class="sxs-lookup"><span data-stu-id="89c90-170">Updating the restore target (for instance, to force restoration to an alternate location mapping).</span></span> <span data-ttu-id="89c90-171">Vedere [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span><span class="sxs-lookup"><span data-stu-id="89c90-171">See [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span></span>
-   <span data-ttu-id="89c90-172">Comunicazione con il richiedente tramite metadati privati (vedere [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="89c90-172">Communicating with the requester via private metadata (see [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="89c90-173">Che indica che un file deve essere ripristinato tramite un nuovo mapping tramite la definizione di [*destinazioni dirette*](vssgloss-d.md) (vedere [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span><span class="sxs-lookup"><span data-stu-id="89c90-173">Indicating that a file should be restored by remapping through the definition of [*directed targets*](vssgloss-d.md) (see [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span></span>

<span data-ttu-id="89c90-174">L'istanza di [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) utilizzata sarà creata dall'inclusione esplicita del componente nel documento componenti di backup durante il backup o dal componente che definisce il set di componenti di backup di cui è membro (vedere [utilizzo della selezione per il ripristino e i sottocomponenti](working-with-selectability-for-restore-and-subcomponents.md)).</span><span class="sxs-lookup"><span data-stu-id="89c90-174">The instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) used will either be that created by the component's explicit inclusion in the Backup Components Document during backup, or that of the component defining the backup component set of which it was a member (see [Working with Selectability For Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)).</span></span>

 

 
