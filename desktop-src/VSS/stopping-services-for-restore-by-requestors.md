---
description: Potrebbe essere necessario arrestare un servizio prima e riavviare dopo un'operazione di ripristino.
ms.assetid: 111d1281-ad83-49bc-868c-1106a0e25a2a
title: Arresto dei servizi per il ripristino da richiedenti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548af25a4b4550d35a8e6fa4d4c0e791897b6e0a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311591"
---
# <a name="stopping-services-for-restore-by-requesters"></a><span data-ttu-id="63c3f-103">Arresto dei servizi per il ripristino da richiedenti</span><span class="sxs-lookup"><span data-stu-id="63c3f-103">Stopping Services for Restore by Requesters</span></span>

<span data-ttu-id="63c3f-104">Potrebbe essere necessario arrestare un servizio prima e riavviare dopo un'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="63c3f-104">It may be necessary for a service to be stopped prior to and restarted following a restore operation.</span></span>

<span data-ttu-id="63c3f-105">In genere, l'arresto e l'avvio di un servizio per il supporto di un ripristino vengono eseguiti da un writer durante la gestione dell'evento di [*preripristino*](vssgloss-p.md) (con [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) e l'evento [*PostRestore*](vssgloss-p.md) (con [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span><span class="sxs-lookup"><span data-stu-id="63c3f-105">Typically, stopping and starting a service to support a restore would be performed by a writer when handling the [*PreRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) and the [*PostRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span></span>

<span data-ttu-id="63c3f-106">Tuttavia, in alcuni casi è necessario che un richiedente arresti in modo esplicito un servizio in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="63c3f-106">However, there may be cases when it is necessary for a requester to explicitly stop a running service.</span></span> <span data-ttu-id="63c3f-107">I writer indicano se questo è il caso, impostando il valore di avvio dell'arresto del \_ ripristino VSS RME o del servizio Copia Shadow del volume \_ \_ \_ \_ RME \_ \_ \_ per l'arresto del ripristino dell'enumerazione [**VSS \_ \_ RESTOREMETHOD**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) come argomento del metodo Restore di una chiamata al metodo [**IVssCreateWriterMetadata:: SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) e specificando il nome del servizio da arrestare.</span><span class="sxs-lookup"><span data-stu-id="63c3f-107">Writers indicate if this is the case by setting the VSS\_RME\_STOP\_RESTORE\_START or VSS\_RME\_RESTORE\_STOP\_START value of the [**VSS\_RESTOREMETHOD\_ENUM**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) enumeration as the restore method argument of a call to the [**IVssCreateWriterMetadata::SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) method and specifying the name of the service to be stopped.</span></span>

<span data-ttu-id="63c3f-108">Un richiedente ottiene informazioni sul metodo Restore e il nome del servizio da arrestare quando si utilizzano i metadati del writer tramite il metodo [**IVssExamineWriterMetadata:: GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) .</span><span class="sxs-lookup"><span data-stu-id="63c3f-108">A requester obtains information about the restore method and the name of the service to be stopped when working with writer metadata by using the [**IVssExamineWriterMetadata::GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) method.</span></span>

<span data-ttu-id="63c3f-109">È importante che il writer, quando si specifica il nome di un servizio da arrestare, usi il nome noto pubblicamente corretto del servizio.</span><span class="sxs-lookup"><span data-stu-id="63c3f-109">It is important that the writer, when specifying the name of a service to be stopped, uses the correct publicly known name of that service.</span></span> <span data-ttu-id="63c3f-110">Un nome ambiguo o non accurato può comportare l'arresto del servizio errato da parte dei richiedenti o l'impossibilità di determinare quale servizio arrestare.</span><span class="sxs-lookup"><span data-stu-id="63c3f-110">An ambiguous or inaccurate name may result in requesters stopping the wrong service or being unable to determine which service to stop.</span></span>

<span data-ttu-id="63c3f-111">Al termine dell'operazione di ripristino, i richiedenti devono riavviare il servizio.</span><span class="sxs-lookup"><span data-stu-id="63c3f-111">After the completion of the restore operation, requesters must restart the service.</span></span>

<span data-ttu-id="63c3f-112">È necessario prestare attenzione nella progettazione e nell'implementazione di writer che supportano servizi che i richiedenti devono arrestare e riavviare.</span><span class="sxs-lookup"><span data-stu-id="63c3f-112">You must be careful in designing and implementing writers that support services that requesters must stop and restart.</span></span> <span data-ttu-id="63c3f-113">In particolare, tali writer non devono far parte del servizio, ovvero il writer stesso non deve essere interrotto e quindi riavviato nel corso dell'operazione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="63c3f-113">Specifically, such writers should not actually be part of the service—that is, the writer itself should not need to be stopped and then restarted in the course of the restore operation.</span></span>

<span data-ttu-id="63c3f-114">Un writer il cui processo viene arrestato avrà un'istanza di writer diversa al riavvio.</span><span class="sxs-lookup"><span data-stu-id="63c3f-114">A writer whose process is stopped will have a different writer instance upon restart.</span></span> <span data-ttu-id="63c3f-115">La nuova istanza del writer non riceverà gli eventi VSS destinati all'istanza originale del writer.</span><span class="sxs-lookup"><span data-stu-id="63c3f-115">The new instance of the writer will not receive VSS events intended for the original instance of the writer.</span></span> <span data-ttu-id="63c3f-116">In particolare, se il processo di un'istanza di writer viene arrestato dopo la gestione di un evento di preripristino, la nuova istanza non riceverà l'evento di post-ripristino.</span><span class="sxs-lookup"><span data-stu-id="63c3f-116">Specifically, if the process of a writer instance is stopped after handling a PreRestore event, the new instance will not receive the PostRestore event.</span></span> <span data-ttu-id="63c3f-117">VSS genera inoltre un errore che indica la perdita di un writer partecipante nell'operazione di ripristino e [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) può restituire un errore.</span><span class="sxs-lookup"><span data-stu-id="63c3f-117">Further, VSS will generate an error indicating the loss of a participating writer in the restore operation, and [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) may return a failure.</span></span>

 

 



