---
description: "Gli eventi Abort possono essere generati durante un'operazione di backup nei casi seguenti:"
ms.assetid: c2e39cdd-0ff8-4030-9bec-9e003b4d9520
title: Interruzione delle operazioni VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35e4b82ba4227dfeb02e3da91c9bc1e77f10f492
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106313236"
---
# <a name="aborting-vss-operations"></a><span data-ttu-id="36717-103">Interruzione delle operazioni VSS</span><span class="sxs-lookup"><span data-stu-id="36717-103">Aborting VSS Operations</span></span>

<span data-ttu-id="36717-104">Gli eventi [*Abort*](vssgloss-a.md) possono essere generati durante un'operazione di backup nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="36717-104">[*Abort*](vssgloss-a.md) events can be generated during a backup operation in any of the following cases:</span></span>

-   <span data-ttu-id="36717-105">Un richiedente genera in modo esplicito un [*evento Abort*](vssgloss-a.md) chiamando [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span><span class="sxs-lookup"><span data-stu-id="36717-105">A requester explicitly generates an [*Abort event*](vssgloss-a.md) by calling [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span></span>
-   <span data-ttu-id="36717-106">I gestori eventi [*Freeze*](vssgloss-f.md) e [*scongela*](vssgloss-t.md) del writer ([**CVssWriter:: OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) e [**CVssWriter:: onscongelate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)) restituiscono **false** oppure non possono essere completati nell'intervallo di tempo specificato in [**CVssWriter:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize).</span><span class="sxs-lookup"><span data-stu-id="36717-106">A writer's [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) event handlers ([**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) and [**CVssWriter::OnThaw**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)) return **false**, or cannot complete in the time window specified in [**CVssWriter::Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize).</span></span>
-   <span data-ttu-id="36717-107">Si è verificato un errore del provider o VSS durante la creazione di una copia shadow dopo l'evento [*PrepareForSnapshot*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="36717-107">There is any failure of the provider or VSS during the creation of a shadow copy following the [*PrepareForSnapshot*](vssgloss-p.md) event.</span></span>

<span data-ttu-id="36717-108">Le interruzioni non sono supportate per le operazioni di ripristino.</span><span class="sxs-lookup"><span data-stu-id="36717-108">Aborts are not supported for restore operations.</span></span>

## <a name="requester-handling-and-creation-of-abort-events"></a><span data-ttu-id="36717-109">Gestione e creazione di eventi di interruzione del richiedente</span><span class="sxs-lookup"><span data-stu-id="36717-109">Requester Handling and Creation of Abort Events</span></span>

<span data-ttu-id="36717-110">Un'istanza dell'interfaccia [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) può essere utilizzata solo per un backup, pertanto se si verifica un errore durante l'elaborazione di un backup, è in genere consigliabile rilasciare l'istanza corrente e ricominciare.</span><span class="sxs-lookup"><span data-stu-id="36717-110">An instance of the [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface can be used for only one backup, so if an error occurs in processing a backup it is generally best to release the current instance and start over.</span></span>

<span data-ttu-id="36717-111">Un richiedente deve segnalare in modo esplicito che sta interrompendo un'operazione di backup (usando [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) solo dopo la preparazione effettiva di un backup, che interessa i writer o che è stata eseguita la creazione di una copia shadow.</span><span class="sxs-lookup"><span data-stu-id="36717-111">A requester should explicitly signal that it is aborting a backup operation (using [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) only after the actual preparation for a backup, involving writers, or the creation of a shadow copy has taken place.</span></span>

<span data-ttu-id="36717-112">In realtà, ciò significa che ogni volta che un richiedente deve arrestare un'operazione di backup dopo la generazione di un evento [*PrepareForBackup*](vssgloss-p.md) chiamando [**IVssBackupComponents::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), deve chiamare [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) e attendere la restituzione prima di rilasciare l'istanza di [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) corrente.</span><span class="sxs-lookup"><span data-stu-id="36717-112">Effectively, this means that any time a requester needs to stop a backup operation after generating a [*PrepareForBackup*](vssgloss-p.md) event by calling [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), it should call [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) and await its return prior to releasing the current [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) instance.</span></span>

<span data-ttu-id="36717-113">Se, ad esempio, un writer ha bloccato un'operazione di backup, un richiedente deve utilizzare [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) per notificare a tutti gli altri writer che l'operazione di backup non verrà completata.</span><span class="sxs-lookup"><span data-stu-id="36717-113">For example, if a writer vetoed a backup operation, a requester should use [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) to notify all other writers that the backup operation will not be completed.</span></span>

<span data-ttu-id="36717-114">Prima di chiamare [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup)o se la chiamata a **PrepareForBackup** ha esito negativo, un richiedente può rilasciare l'istanza corrente dell'interfaccia [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) senza dover generare un evento Abort.</span><span class="sxs-lookup"><span data-stu-id="36717-114">Prior to calling [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), or if the call to **PrepareForBackup** fails, a requester can release the current instance of the [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface without needing to generate an Abort event.</span></span>

<span data-ttu-id="36717-115">Se, ad esempio, l'istanza corrente di [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) viene utilizzata semplicemente per ottenere informazioni chiamando [**IVSSBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) e generando un evento di [*Identificazione*](vssgloss-i.md) , una volta restituite le informazioni, l'istanza di **IVSSBackupComponents** può semplicemente essere rilasciata.</span><span class="sxs-lookup"><span data-stu-id="36717-115">For example, if the current instance of [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) is being used merely to obtain information by calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) and generating an [*Identify*](vssgloss-i.md) event, once information has been returned the instance of **IVSSBackupComponents** can simply be released.</span></span>

<span data-ttu-id="36717-116">Un richiedente genera una serie di eventi ([*PrepareForSnapshot*](vssgloss-p.md), [*Freeze*](vssgloss-f.md), [*scongelate*](vssgloss-t.md)e [*postsnapshot*](vssgloss-p.md)) quando chiama [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="36717-116">A requester generates a number of events ([*PrepareForSnapshot*](vssgloss-p.md), [*Freeze*](vssgloss-f.md), [*Thaw*](vssgloss-t.md), and [*PostSnapshot*](vssgloss-p.md)) when it calls [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="36717-117">Quando si gestiscono gli eventi di blocco e sblocco, un writer potrebbe non riuscire e generare un evento Abort autonomamente.</span><span class="sxs-lookup"><span data-stu-id="36717-117">While handling the Freeze and Thaw events, a writer may fail and can generate an Abort event on its own.</span></span> <span data-ttu-id="36717-118">La mancata gestione degli eventi PrepareForSnapshot e PostSnapshot non genera un evento Abort.</span><span class="sxs-lookup"><span data-stu-id="36717-118">Failure to handle PrepareForSnapshot and PostSnapshot events does not generate an Abort event.</span></span>

<span data-ttu-id="36717-119">Non è sempre possibile che un richiedente sappia se è stato generato un evento Abort quando [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) indica un errore.</span><span class="sxs-lookup"><span data-stu-id="36717-119">It is not always possible for a requester to know if an Abort event was generated when [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) indicates failure.</span></span> <span data-ttu-id="36717-120">Pertanto, un richiedente che deve terminare un'operazione di backup perché lo stato di **IVssBackupComponents::D osnapshotset** indica che un problema deve comunque chiamare [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span><span class="sxs-lookup"><span data-stu-id="36717-120">Therefore, a requester that needs to terminate a backup operation because the status of **IVssBackupComponents::DoSnapshotSet** indicates a problem should still call [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span></span>

<span data-ttu-id="36717-121">Se un richiedente ha chiamato [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup), non è necessario chiamare [**IVssBackupComponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) prima di rilasciare un'istanza di [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents).</span><span class="sxs-lookup"><span data-stu-id="36717-121">If a requester has called [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup), it is not necessary to call [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) prior to releasing an instance of [**IVSSBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents).</span></span>

## <a name="writer-handling-and-creation-of-abort-events"></a><span data-ttu-id="36717-122">Gestione e creazione di eventi di interruzione del writer</span><span class="sxs-lookup"><span data-stu-id="36717-122">Writer Handling and Creation of Abort Events</span></span>

<span data-ttu-id="36717-123">Come indicato in precedenza, un writer può ricevere un evento Abort da un richiedente oppure il provider può attivarne uno.</span><span class="sxs-lookup"><span data-stu-id="36717-123">As noted previously, a writer can receive an Abort event from a requester, or the provider can trigger one itself.</span></span> <span data-ttu-id="36717-124">Inoltre, un writer può ricevere più eventi Abort in determinate circostanze.</span><span class="sxs-lookup"><span data-stu-id="36717-124">Also, it is possible for a writer to receive multiple Abort events under certain circumstances.</span></span> <span data-ttu-id="36717-125">Gli sviluppatori di Writer devono codificare qualsiasi implementazione di [**CVssWriter:: OnAbort**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onabort) tenendo presente questo aspetto.</span><span class="sxs-lookup"><span data-stu-id="36717-125">Writer developers should code any implementation of [**CVssWriter::OnAbort**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onabort) with this in mind.</span></span>

<span data-ttu-id="36717-126">Durante la gestione di un evento Abort, un writer deve tentare di ripristinare il processo gestito con lo stato di esecuzione normale, oltre a eseguire la gestione e la registrazione degli errori.</span><span class="sxs-lookup"><span data-stu-id="36717-126">In handling an Abort event, a writer should attempt to restore whatever process it managed to its normal running state, as well as perform any error handling and logging.</span></span>

<span data-ttu-id="36717-127">Questo può significare che un'implementazione di [**CVssWriter:: OnAbort**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onabort) potrebbe dover eseguire molte, se non tutte, le stesse attività del gestore eventi di disgelo ([**CVssWriter:: onscongelate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)) e del gestore eventi PostSnapshot ([**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) e questi gestori possono essere chiamati dall'interno di **CVssWriter:: OnAbort**.</span><span class="sxs-lookup"><span data-stu-id="36717-127">This may mean that an implementation of [**CVssWriter::OnAbort**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onabort) might have to perform many, if not all, of the same tasks as the Thaw event handler ([**CVssWriter::OnThaw**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)) and the PostSnapshot event handler ([**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)), and these handlers can be called from within **CVssWriter::OnAbort**.</span></span>

 

 



