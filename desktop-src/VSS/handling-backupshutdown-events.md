---
description: È possibile che un'applicazione di backup (richiedente) termini e non generi un evento BackupComplete.
ms.assetid: 8e6a1f4f-ba62-46ea-965e-b0c6526ece89
title: Gestione degli eventi BackupShutdown
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 939e8e64ca9ee463b0b8331e607f8068c3325d5c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310710"
---
# <a name="handling-backupshutdown-events"></a><span data-ttu-id="035a6-103">Gestione degli eventi BackupShutdown</span><span class="sxs-lookup"><span data-stu-id="035a6-103">Handling BackupShutdown Events</span></span>

<span data-ttu-id="035a6-104">È possibile che un'applicazione di backup (richiedente) termini e non generi un evento [*BackupComplete*](vssgloss-b.md) .</span><span class="sxs-lookup"><span data-stu-id="035a6-104">It is possible for a backup application (requester) to terminate and not generate a [*BackupComplete*](vssgloss-b.md) event.</span></span> <span data-ttu-id="035a6-105">L'applicazione di backup potrebbe arrestarsi in modo anomalo o essere terminata (ad esempio dal gestore attività) e non essere in grado di chiamare [**IVssBackupComponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="035a6-105">The backup application could crash, or be terminated (from the Task Manager, for example) and not be able to call [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>

<span data-ttu-id="035a6-106">Pertanto, l'infrastruttura VSS (anziché il richiedente) genera un evento [*BackupShutdown*](vssgloss-b.md) ogni volta che viene rilasciata un'istanza di [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) che partecipa a un backup, indipendentemente dal fatto che venga rilasciata dal richiedente o dal sistema.</span><span class="sxs-lookup"><span data-stu-id="035a6-106">Therefore, the VSS infrastructure (rather than the requester) generates a [*BackupShutdown*](vssgloss-b.md) event whenever an instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) participating in a backup is released, whether it is released by the requester or by the system.</span></span>

<span data-ttu-id="035a6-107">Se un backup procede correttamente, un writer riceverà un evento BackupComplete seguito da un evento BackupShutdown.</span><span class="sxs-lookup"><span data-stu-id="035a6-107">If a backup proceeds properly, a writer will receive a BackupComplete event followed by a BackupShutdown event.</span></span>

<span data-ttu-id="035a6-108">Se l'operazione viene interrotta (il richiedente genera un [*evento Abort*](vssgloss-a.md) chiamando [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) o ha esito negativo improvvisamente, un writer può ricevere solo un evento BackupShutdown e potrebbe non ricevere altri eventi che eseguono operazioni di pulizia.</span><span class="sxs-lookup"><span data-stu-id="035a6-108">If the operation aborts (the requester generates an [*Abort event*](vssgloss-a.md) by calling [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) or fails abruptly, a writer may receive only a BackupShutdown event, and it may not receive other events that perform cleanup operations.</span></span> <span data-ttu-id="035a6-109">Spetta a un writer determinare se un evento BackupShutdown segue una sequenza di eventi corretta o rappresenta un errore imprevisto delle operazioni di backup.</span><span class="sxs-lookup"><span data-stu-id="035a6-109">It is up to a writer to determine whether a BackupShutdown event follows a proper sequence of events, or represents an unexpected failure of the backup operations.</span></span>

<span data-ttu-id="035a6-110">Il gestore eventi BackupShutdown, [**CVssWriter:: OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown), riceve l' \_ ID VSS (Guid) del set di copie shadow dell'operazione di backup che viene arrestata.</span><span class="sxs-lookup"><span data-stu-id="035a6-110">The BackupShutdown event handler, [**CVssWriter::OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown), receives the VSS\_ID (GUID) of the shadow copy set of the backup operation being shut down.</span></span> <span data-ttu-id="035a6-111">Il writer può utilizzare questo oggetto per determinare quale operazione di backup verrà arrestata, se l'ID del set di copie shadow è stato archiviato durante la relativa sequenza di backup (ad esempio, dall'interno di [**CVssWriter:: OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze), [**CVssWriter:: onscongelate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)o [**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) tramite [**CVssWriter:: GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid).</span><span class="sxs-lookup"><span data-stu-id="035a6-111">The writer can use this to determine which backup operation is being shut down, if it has stored the shadow copy set ID during its backup sequence (for example, from within [**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze), [**CVssWriter::OnThaw**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw), or [**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) by using [**CVssWriter::GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid).</span></span>

<span data-ttu-id="035a6-112">Un writer, tuttavia, non deve chiamare [**CVssWriter:: GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid) dall'interno di [**CVssWriter:: OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown).</span><span class="sxs-lookup"><span data-stu-id="035a6-112">However, a writer should not call [**CVssWriter::GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid) from within [**CVssWriter::OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown).</span></span> <span data-ttu-id="035a6-113">Inoltre, **CVssWriter:: GetCurrentSnapshotSetId** non può essere chiamato dopo la restituzione di [**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) .</span><span class="sxs-lookup"><span data-stu-id="035a6-113">Also, **CVssWriter::GetCurrentSnapshotSetId** cannot be called after [**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) returns.</span></span>

<span data-ttu-id="035a6-114">È possibile che il writer sia coinvolto in più operazioni di backup e, se viene chiamato un evento BackupShutdown a causa di un arresto improvviso di un richiedente, l' \_ ID VSS restituito potrebbe essere quello di un'altra operazione di backup a cui il writer parteciperà.</span><span class="sxs-lookup"><span data-stu-id="035a6-114">It is possible for the writer to be involved in multiple backup operations, and if a BackupShutdown event is called because of an abrupt shutdown of a requester, the VSS\_ID returned could be that of another backup operation the writer was participating in.</span></span>

 

 



