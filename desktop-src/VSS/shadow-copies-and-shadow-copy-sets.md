---
description: Una copia shadow è uno snapshot di un volume che duplica tutti i dati contenuti in tale volume in un momento preciso e preciso. VSS identifica ogni copia shadow da un GUID permanente.
ms.assetid: 8ef2478a-c8bc-4517-9a14-e1d9226ec4cd
title: Copie shadow e set di copie shadow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18709842b1fb0fbf6d6cce2557b51042dfb024ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310665"
---
# <a name="shadow-copies-and-shadow-copy-sets"></a><span data-ttu-id="e26ea-104">Copie shadow e set di copie shadow</span><span class="sxs-lookup"><span data-stu-id="e26ea-104">Shadow Copies and Shadow Copy Sets</span></span>

<span data-ttu-id="e26ea-105">Una [*Copia Shadow*](vssgloss-s.md) è uno snapshot di un volume che duplica tutti i dati contenuti in tale volume in un momento preciso e preciso.</span><span class="sxs-lookup"><span data-stu-id="e26ea-105">A [*shadow copy*](vssgloss-s.md) is a snapshot of a volume that duplicates all of the data that is held on that volume at one well-defined instant in time.</span></span> <span data-ttu-id="e26ea-106">VSS identifica ogni copia shadow da un GUID permanente.</span><span class="sxs-lookup"><span data-stu-id="e26ea-106">VSS identifies each shadow copy by a persistent GUID.</span></span>

<span data-ttu-id="e26ea-107">Un [*set*](vssgloss-s.md) di copie shadow è una raccolta di copie shadow di diversi volumi eseguite contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e26ea-107">A [*shadow copy set*](vssgloss-s.md) is a collection of shadow copies of various volumes all taken at the same time.</span></span> <span data-ttu-id="e26ea-108">VSS identifica ogni copia shadow impostata da un GUID permanente.</span><span class="sxs-lookup"><span data-stu-id="e26ea-108">VSS identifies each shadow copy set by a persistent GUID.</span></span>

<span data-ttu-id="e26ea-109">Il modo in cui un particolare fornitore di hardware o software sceglie di implementare copie shadow è completamente a sua discrezione.</span><span class="sxs-lookup"><span data-stu-id="e26ea-109">How a particular hardware or software vendor chooses to implement shadow copies is completely at its discretion.</span></span> <span data-ttu-id="e26ea-110">Una volta creata una copia shadow, sono disponibili nel sistema due immagini del volume di cui è stata eseguita la copia shadow: il volume originale, a cui è possibile accedere convenzionalmente; e i dati copiati, a cui è possibile accedere tramite l'API VSS.</span><span class="sxs-lookup"><span data-stu-id="e26ea-110">Once a shadow copy is created, there are effectively two images of the shadow-copied volume available to the system: the original volume, which can be accessed conventionally; and the copied data, which can be accessed through the VSS API.</span></span>

<span data-ttu-id="e26ea-111">In questo modo è possibile eseguire due set di attività allo stesso tempo:</span><span class="sxs-lookup"><span data-stu-id="e26ea-111">This allows two sets of activities to take place at the same time:</span></span>

-   <span data-ttu-id="e26ea-112">Le applicazioni ordinarie del sistema possono continuare o riprendere rapidamente usando il volume originale, aggiornando i dati sul disco.</span><span class="sxs-lookup"><span data-stu-id="e26ea-112">Ordinary applications on the system can quickly continue or resume using the original volume, updating data on the disk.</span></span>
-   <span data-ttu-id="e26ea-113">Le applicazioni che utilizzano l'API del richiedente VSS per accedere al volume copiato shadow possono eseguire backup o operazioni simili.</span><span class="sxs-lookup"><span data-stu-id="e26ea-113">Applications that are using the VSS requester API to access the shadow-copied volume can perform backups or similar operations.</span></span>

<span data-ttu-id="e26ea-114">Le copie shadow non devono essere implementate nello stesso modo per ogni file, directory o volume.</span><span class="sxs-lookup"><span data-stu-id="e26ea-114">Shadow copies need not be implemented in the same way for every file, directory, or volume.</span></span> <span data-ttu-id="e26ea-115">Implementazioni diverse del meccanismo di copia shadow ([*provider*](vssgloss-p.md)) possono utilizzare approcci diversi per la creazione di una copia shadow.</span><span class="sxs-lookup"><span data-stu-id="e26ea-115">Different implementations of the shadow copy mechanism ([*providers*](vssgloss-p.md)) may use different approaches to creating a shadow copy.</span></span> <span data-ttu-id="e26ea-116">Tuttavia, per tutte le applicazioni che utilizzano l'API VSS, tutte le copie shadow dovrebbero apparire uguali.</span><span class="sxs-lookup"><span data-stu-id="e26ea-116">However, to all applications that are using the VSS API, all shadow copies should appear the same.</span></span>

<span data-ttu-id="e26ea-117">Per informazioni sull'implementazione predefinita del provider Windows, vedere [provider di sistema](providers.md).</span><span class="sxs-lookup"><span data-stu-id="e26ea-117">For information on the default Windows provider implementation, see [System Provider](providers.md).</span></span>

## <a name="default-shadow-copy-state"></a><span data-ttu-id="e26ea-118">Stato copia shadow predefinita</span><span class="sxs-lookup"><span data-stu-id="e26ea-118">Default Shadow Copy State</span></span>

<span data-ttu-id="e26ea-119">Anche se il file system Scarica tutti i buffer di I/O prima di creare una copia shadow, questo non garantisce che l'I/O incompleto venga gestito correttamente.</span><span class="sxs-lookup"><span data-stu-id="e26ea-119">Even though the file system flushes all I/O buffers prior to creating a shadow copy, this will not ensure that incomplete I/O is properly handled.</span></span>

<span data-ttu-id="e26ea-120">Pertanto, supponendo che il sistema non disponga di applicazioni abilitate per VSS, i dati in una copia shadow si affermeranno in uno [*stato coerente con l'arresto anomalo*](vssgloss-c.md).</span><span class="sxs-lookup"><span data-stu-id="e26ea-120">Therefore, assuming that the system has no VSS-enabled applications, the data in a shadow copy is said to be in a [*crash-consistent state*](vssgloss-c.md).</span></span> <span data-ttu-id="e26ea-121">Una copia shadow in uno stato coerente con l'arresto anomalo del sistema contiene un'immagine del disco identica a quella esistente dopo un arresto irreversibile del sistema.</span><span class="sxs-lookup"><span data-stu-id="e26ea-121">A shadow copy in a crash-consistent state contains an image of the disk that is the same as that which would exist following a catastrophic system shutdown.</span></span> <span data-ttu-id="e26ea-122">Tutti i file aperti continueranno a esistere nel volume, ma non è garantito che siano privi di operazioni di I/O incomplete o di danneggiamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="e26ea-122">All files that were open will still exist on the volume, but they are not guaranteed to be free of incomplete I/O operations or data corruption.</span></span>

<span data-ttu-id="e26ea-123">Sebbene lo stato coerente con l'arresto anomalo del sistema non occupi completamente tutti i problemi associati alla definizione di un set di backup stabile (vedere [problemi comuni di backup del volume](common-volume-backup-issues.md)), presenta diversi vantaggi rispetto al set di backup che avrebbe dovuto utilizzare le operazioni di backup convenzionali:</span><span class="sxs-lookup"><span data-stu-id="e26ea-123">While the crash-consistent state does not fully deal with all the issues associated with defining a stable backup set (see [Common Volume Backup Issues](common-volume-backup-issues.md)), it has several advantages over the backup set that conventional backup operations would have to use:</span></span>

-   <span data-ttu-id="e26ea-124">Un volume contenuto in una copia shadow, anche in uno stato coerente con l'arresto anomalo del sistema, contiene comunque tutti i file.</span><span class="sxs-lookup"><span data-stu-id="e26ea-124">A volume contained in a shadow copy, even in a crash-consistent state, still contains all files.</span></span> <span data-ttu-id="e26ea-125">Un set di backup creato senza una copia shadow non conterrà tutti i file aperti al momento del backup.</span><span class="sxs-lookup"><span data-stu-id="e26ea-125">A backup set created without a shadow copy would not contain all files open at the time of the backup.</span></span> <span data-ttu-id="e26ea-126">I file mantenuti aperti al momento dell'operazione di backup vengono esclusi dal backup.</span><span class="sxs-lookup"><span data-stu-id="e26ea-126">Files held open at the time of the backup operation are excluded from the backup.</span></span>
-   <span data-ttu-id="e26ea-127">La copia shadow del volume viene creata in un istante e non attraversando un file system attivo, che in genere richiede molto più tempo.</span><span class="sxs-lookup"><span data-stu-id="e26ea-127">The shadow copy of the volume is created at one instant in time, and not by traversing an active file system, which typically requires much more time.</span></span>

<span data-ttu-id="e26ea-128">Le applicazioni in un sistema che non sono compatibili con VSS (elaboratori di testo, editor e così via) avranno probabilmente i file lasciati in uno stato coerente con l'arresto anomalo del sistema.</span><span class="sxs-lookup"><span data-stu-id="e26ea-128">Applications on a system that are not VSS-aware—word processors, editors, and so on—will likely have their files left in a crash-consistent state.</span></span> <span data-ttu-id="e26ea-129">Tuttavia, le applicazioni compatibili con VSS (writer) possono coordinare le azioni in modo che lo stato dei file nella copia shadow sia ben definito e coerente.</span><span class="sxs-lookup"><span data-stu-id="e26ea-129">However, VSS-aware applications (writers) can coordinate their actions so that the state of their files in the shadow copy is well defined and consistent.</span></span>

## <a name="shadow-copy-freeze-and-thaw"></a><span data-ttu-id="e26ea-130">Blocca e sblocca copia shadow</span><span class="sxs-lookup"><span data-stu-id="e26ea-130">Shadow Copy Freeze and Thaw</span></span>

<span data-ttu-id="e26ea-131">La creazione di ogni operazione di copia shadow VSS è racchiusa tra eventi di [*blocco*](vssgloss-f.md) e [*sblocco*](vssgloss-t.md) , che i writer utilizzano per inserire i file in uno stato stabile prima della copia shadow.</span><span class="sxs-lookup"><span data-stu-id="e26ea-131">The creation of every VSS shadow copy operation is bracketed by [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) events, which writers use to put their files in a stable state prior to shadow copy.</span></span>

<span data-ttu-id="e26ea-132">La presenza di eventi di blocco e sblocco come parte del modello VSS significa:</span><span class="sxs-lookup"><span data-stu-id="e26ea-132">Having Freeze and Thaw events as part of the VSS model means:</span></span>

-   <span data-ttu-id="e26ea-133">La gestione dell'evento Freeze significa che gli utenti che sviluppano Writer devono avere un punto ben definito nel ciclo di backup, in cui assicurano che tutte le operazioni di scrittura sul disco siano interrotte e che i file siano in uno stato ben definito per il backup.</span><span class="sxs-lookup"><span data-stu-id="e26ea-133">Handling the Freeze event means that those who are developing writers must have a clearly delineated point in the backup cycle where they ensure that all write operations to the disk are stopped and that files are in a well-defined state for backup.</span></span>
-   <span data-ttu-id="e26ea-134">La gestione dell'evento di sblocco fornisce il meccanismo per i writer per riprendere le Scritture sul disco ed eliminare eventuali file temporanei o altre informazioni sullo stato temporaneo create in associazione alla copia shadow.</span><span class="sxs-lookup"><span data-stu-id="e26ea-134">Handling the Thaw event provides the mechanism for writers to resume writes to the disk and clean up any temporary files or other temporary state information that were created in association with the shadow copy.</span></span>
-   <span data-ttu-id="e26ea-135">La finestra predefinita tra gli eventi Freeze e scongela è breve (in genere 60 secondi); Pertanto, è possibile ridurre al minimo l'interruzione effettiva di tutti i servizi forniti da un writer.</span><span class="sxs-lookup"><span data-stu-id="e26ea-135">The default window between the Freeze and Thaw events is short (typically 60 seconds); therefore, actual interruption of any service that a writer provides can be minimized.</span></span>
-   <span data-ttu-id="e26ea-136">La gestione di altri eventi, ad esempio PrepareForSnapshot, prima e dopo gli eventi di blocco e sblocco, fornisce rispettivamente la flessibilità necessaria per consentire ai writer di completare operazioni complesse per supportare le copie shadow.</span><span class="sxs-lookup"><span data-stu-id="e26ea-136">Handling of other events (such as PrepareForSnapshot) preceding and following the Freeze and Thaw events, respectively, provides the necessary flexibility to allow writers to complete complicated operations to support shadow copies.</span></span>

 

 



