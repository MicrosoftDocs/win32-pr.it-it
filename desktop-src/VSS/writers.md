---
description: I writer sono applicazioni o servizi che archiviano informazioni permanenti nei file su disco e che forniscono i nomi e i percorsi dei file ai richiedenti tramite l'interfaccia copia shadow.
ms.assetid: 24fc2d7c-f8d6-49ca-9bb5-0179bef68e78
title: Writer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 52ca409e8dc6153a6b3e2b747dc23cc391055471
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307116"
---
# <a name="writers"></a><span data-ttu-id="3dfef-103">Writer</span><span class="sxs-lookup"><span data-stu-id="3dfef-103">Writers</span></span>

<span data-ttu-id="3dfef-104">I [*writer*](vssgloss-w.md) sono applicazioni o servizi che archiviano informazioni permanenti nei file su disco e che forniscono i nomi e i percorsi dei file ai richiedenti tramite l'interfaccia copia shadow.</span><span class="sxs-lookup"><span data-stu-id="3dfef-104">[*Writers*](vssgloss-w.md) are applications or services that store persistent information in files on disk and that provide the names and locations of these files to requesters by using the shadow copy interface.</span></span>

<span data-ttu-id="3dfef-105">Durante le operazioni di backup, i writer assicurano che i dati siano tranquilli e stabili, adatti per la copia shadow e il backup.</span><span class="sxs-lookup"><span data-stu-id="3dfef-105">During backup operations, writers ensure that their data is quiescent and stable—suitable for shadow copy and backup.</span></span> <span data-ttu-id="3dfef-106">I writer collaborano con i ripristini sbloccando i file quando possibile e indicando posizioni alternative quando necessario.</span><span class="sxs-lookup"><span data-stu-id="3dfef-106">Writers collaborate with restores by unlocking files when possible and indicating alternate locations when necessary.</span></span>

<span data-ttu-id="3dfef-107">Se durante un'operazione di backup VSS non è presente alcun writer, è comunque possibile creare una copia shadow.</span><span class="sxs-lookup"><span data-stu-id="3dfef-107">If no writers are present during a VSS backup operation, a shadow copy can still be created.</span></span> <span data-ttu-id="3dfef-108">In questo caso, tutti i dati nel volume copiato Shadow si troveranno nello [*stato coerente con l'arresto anomalo*](vssgloss-c.md)del sistema.</span><span class="sxs-lookup"><span data-stu-id="3dfef-108">In this case, all data on the shadow-copied volume will be in the [*crash-consistent state*](vssgloss-c.md).</span></span>

## <a name="writer-state"></a><span data-ttu-id="3dfef-109">Stato del writer</span><span class="sxs-lookup"><span data-stu-id="3dfef-109">Writer State</span></span>

<span data-ttu-id="3dfef-110">I writer mantengono il proprio stato in un oggetto di metadati basato su XML, il [*documento di metadati del writer*](vssgloss-w.md).</span><span class="sxs-lookup"><span data-stu-id="3dfef-110">Writers maintain their state in an XML-based metadata object, the [*Writer Metadata Document*](vssgloss-w.md).</span></span>

<span data-ttu-id="3dfef-111">I metadati del writer sono l'unica struttura di dati che contiene il [*set di file*](vssgloss-f.md), ovvero percorso, specifica file e flag di ricorsione, dei dati di cui eseguire il backup e il ripristino.</span><span class="sxs-lookup"><span data-stu-id="3dfef-111">This writer metadata is the only data structure that contains the [*file set*](vssgloss-f.md)—path, file specification, and recursion flag—of the data to be backed up and restored.</span></span>

<span data-ttu-id="3dfef-112">Il documento dei metadati del writer organizza i set di file del writer in gruppi o [*componenti*](vssgloss-c.md).</span><span class="sxs-lookup"><span data-stu-id="3dfef-112">The Writer Metadata Document organizes the writer's file sets into groups or [*components*](vssgloss-c.md).</span></span> <span data-ttu-id="3dfef-113">La relazione di uno di questi componenti durante le operazioni di backup e ripristino sugli altri componenti gestiti dal writer è descritta nel documento dei metadati del writer per la selezione del componente [*per il backup*](vssgloss-s.md), la relativa [*selezione per il ripristino*](vssgloss-s.md)e i [*percorsi logici*](vssgloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="3dfef-113">The relationship of one of these components during backup and restore operations to the other components managed by the writer is described in the Writer Metadata Document by the component's [*selectability for backup*](vssgloss-s.md), its [*selectability for restore*](vssgloss-s.md), and its [*logical paths*](vssgloss-l.md).</span></span> <span data-ttu-id="3dfef-114">Per ulteriori informazioni, vedere [configurazione dell'organizzazione dei componenti](definition-of-components-by-writers.md) e [utilizzo di percorsi di selezione e logica](working-with-selectability-and-logical-paths.md).</span><span class="sxs-lookup"><span data-stu-id="3dfef-114">(For more information, see [Setting up Component Organization](definition-of-components-by-writers.md) and [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md).)</span></span>

<span data-ttu-id="3dfef-115">Questo documento contiene anche informazioni aggiuntive che controllano il ripristino dei file e altri problemi.</span><span class="sxs-lookup"><span data-stu-id="3dfef-115">Additional information that governs file restoration and other issues is also contained in this document.</span></span>

<span data-ttu-id="3dfef-116">Per elaborare un backup o un ripristino, il richiedente deve disporre dei metadati del writer, insieme al documento relativo ai componenti di backup.</span><span class="sxs-lookup"><span data-stu-id="3dfef-116">The requester needs the writer metadata, in conjunction with its own Backup Components Document, to process a backup or a restore.</span></span>

<span data-ttu-id="3dfef-117">A differenza del documento componenti di backup, il documento di metadati del writer deve essere considerato come una struttura di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="3dfef-117">Unlike the Backup Components Document, the Writer Metadata Document should be thought of as a read-only structure.</span></span> <span data-ttu-id="3dfef-118">Quando un writer lo crea, il documento non viene modificato.</span><span class="sxs-lookup"><span data-stu-id="3dfef-118">Once a writer creates it, the document is not altered.</span></span>

## <a name="writer-event-handling"></a><span data-ttu-id="3dfef-119">Gestione degli eventi del writer</span><span class="sxs-lookup"><span data-stu-id="3dfef-119">Writer Event Handling</span></span>

<span data-ttu-id="3dfef-120">Le operazioni VSS di un writer vengono avviate tramite la ricezione di eventi COM.</span><span class="sxs-lookup"><span data-stu-id="3dfef-120">A writer's VSS operations are initiated through the receipt of COM events.</span></span>

<span data-ttu-id="3dfef-121">Quando non sono presenti eventi, un writer non esegue operazioni VSS, ad esempio un backup o un ripristino VSS.</span><span class="sxs-lookup"><span data-stu-id="3dfef-121">When no events are present, a writer does not perform VSS operations (such as a VSS backup or restore).</span></span> <span data-ttu-id="3dfef-122">Viene invece eseguita la normale attività, ad esempio la risposta alle query di database, la gestione dei dati utente o la fornitura di altri servizi.</span><span class="sxs-lookup"><span data-stu-id="3dfef-122">Instead, it performs its normal work, such as responding to database queries, managing user data, or providing other services.</span></span>

<span data-ttu-id="3dfef-123">Per assicurarsi che la gestione degli errori per più sessioni di backup e ripristino parallele venga eseguita correttamente e per garantire che una sessione di backup o ripristino non danneggi un altro, è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dfef-123">To ensure that error handling for multiple parallel backup and restore sessions is performed correctly, and to ensure that one backup or restore session does not corrupt another, you must do the following:</span></span>

-   <span data-ttu-id="3dfef-124">Se il gestore eventi di un writer, ad esempio [**CVssWriter:: OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze), chiama il metodo [**CVssWriterEx2:: GetSessionID**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriterex2-getsessionid), [**CVssWriter:: SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure)o [**CVssWriterEx2:: SetWriterFailureEx**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriterex2-setwriterfailureex) , il gestore eventi deve chiamare il metodo nello stesso thread che ha chiamato il gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="3dfef-124">If a writer's event handler (such as [**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze)) calls the [**CVssWriterEx2::GetSessionId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriterex2-getsessionid), [**CVssWriter::SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure), or [**CVssWriterEx2::SetWriterFailureEx**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriterex2-setwriterfailureex) method, the event handler must call the method in the same thread that called the event handler.</span></span>
-   <span data-ttu-id="3dfef-125">Se lo si desidera, l'implementazione del writer di un gestore eventi, ad esempio [**onFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) , può eseguire l'offload del lavoro nei thread di lavoro, purché ogni thread di lavoro esegue il marshalling di tutte le segnalazioni di errori necessarie al thread del gestore eventi originale.</span><span class="sxs-lookup"><span data-stu-id="3dfef-125">Your writer’s implementation of an event handler such as [**OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) can offload work to worker threads if desired, as long as each worker thread marshals any needed error reporting back to the original event handler thread.</span></span>

## <a name="handling-identify-events"></a><span data-ttu-id="3dfef-126">Gestione degli eventi di identificazione</span><span class="sxs-lookup"><span data-stu-id="3dfef-126">Handling Identify Events</span></span>

<span data-ttu-id="3dfef-127">Fatta eccezione per l'evento di identificazione, il tipo e l'ordine degli eventi ricevuti da un writer dipendono in modo univoco dal tipo di operazioni VSS attualmente in corso.</span><span class="sxs-lookup"><span data-stu-id="3dfef-127">With the exception of the Identify event, the type and order of the events a writer receives depends uniquely on the type of VSS operations that are currently ongoing.</span></span>

<span data-ttu-id="3dfef-128">L'evento di identificazione richiede che i writer forniscano le informazioni di sistema sulla configurazione e i file gestiti tramite il [*documento di metadati del writer*](vssgloss-w.md).</span><span class="sxs-lookup"><span data-stu-id="3dfef-128">The Identify event requires writers to provide the system information about their configuration and the files they manage through their [*Writer Metadata Document*](vssgloss-w.md).</span></span> <span data-ttu-id="3dfef-129">Viene generato un evento di identificazione per supportare quasi tutte le operazioni VSS, incluse le query di sistema, nonché le operazioni di copia shadow e backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="3dfef-129">An Identify event is generated in support of almost any VSS operation, including system queries as well as shadow copy and backup and restore operations.</span></span> <span data-ttu-id="3dfef-130">Pertanto, l'implementazione di qualsiasi writer del gestore eventi di identificazione [**CVssWriter:: Onidentificate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) deve essere in grado di gestire un evento di identificazione in qualsiasi momento, incluso durante l'elaborazione di un'altra operazione VSS, ad esempio un backup o un ripristino.</span><span class="sxs-lookup"><span data-stu-id="3dfef-130">Therefore, any writer's implementation of the Identify event handler [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) must be able to handle an Identify event at any time—including in the middle of processing another VSS operation, such as a backup or restore.</span></span> <span data-ttu-id="3dfef-131">Un evento di identificazione non dovrebbe mai essere considerato come parte del ciclo di vita di un'operazione VSS, anche se la generazione potrebbe essere prevista e obbligatoria prima dell'avvio dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="3dfef-131">An Identify event should never be thought of as part of the life cycle of a VSS operation, even though its generation may be expected and required prior to the start of that operation.</span></span>

<span data-ttu-id="3dfef-132">È particolarmente importante che le informazioni sullo stato relative a un'operazione VSS non vengano modificate in [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), perché la ricezione di un evento non ordinato comporta la reimpostazione delle informazioni.</span><span class="sxs-lookup"><span data-stu-id="3dfef-132">It is particularly important that state information about a VSS operation not be modified in [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), because receipt of an out-of-order event would reset that information.</span></span>

## <a name="backup-and-restore-events"></a><span data-ttu-id="3dfef-133">Eventi di backup e ripristino</span><span class="sxs-lookup"><span data-stu-id="3dfef-133">Backup and Restore Events</span></span>

<span data-ttu-id="3dfef-134">A seconda che si tratti di un backup o di un ripristino, un writer riceverà tra due e sette eventi, oltre a un evento di identificazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="3dfef-134">Depending on whether it is participating in a backup or restore, a writer will receive between two and seven events, in addition to an initial Identify event.</span></span>

<span data-ttu-id="3dfef-135">La gestione di questi eventi costituisce, dal punto di vista di un writer, il ciclo di vita di un'operazione di backup o ripristino.</span><span class="sxs-lookup"><span data-stu-id="3dfef-135">Handling these events constitutes (from the point of view of a writer) the life cycle of a backup or restore operation.</span></span>

<span data-ttu-id="3dfef-136">In una tipica operazione di backup (vedere [Cenni preliminari sull'elaborazione di un backup in VSS](overview-of-processing-a-backup-under-vss.md)), un writer gestirà gli eventi seguenti (oltre a un evento di identificazione iniziale):</span><span class="sxs-lookup"><span data-stu-id="3dfef-136">In a typical backup operation (see [Overview of Processing a Backup Under VSS](overview-of-processing-a-backup-under-vss.md)), a writer would handle the following events (in addition to an initial Identify event):</span></span>

-   <span data-ttu-id="3dfef-137">PrepareForBackup</span><span class="sxs-lookup"><span data-stu-id="3dfef-137">PrepareForBackup</span></span>
-   <span data-ttu-id="3dfef-138">PrepareForSnapshot</span><span class="sxs-lookup"><span data-stu-id="3dfef-138">PrepareForSnapshot</span></span>
-   <span data-ttu-id="3dfef-139">Freeze</span><span class="sxs-lookup"><span data-stu-id="3dfef-139">Freeze</span></span>
-   <span data-ttu-id="3dfef-140">Sblocca</span><span class="sxs-lookup"><span data-stu-id="3dfef-140">Thaw</span></span>
-   <span data-ttu-id="3dfef-141">PostSnapshot</span><span class="sxs-lookup"><span data-stu-id="3dfef-141">PostSnapshot</span></span>
-   <span data-ttu-id="3dfef-142">BackupComplete</span><span class="sxs-lookup"><span data-stu-id="3dfef-142">BackupComplete</span></span>
-   <span data-ttu-id="3dfef-143">BackupShutdown</span><span class="sxs-lookup"><span data-stu-id="3dfef-143">BackupShutdown</span></span>

<span data-ttu-id="3dfef-144">In un'operazione di ripristino tipica (vedere [Cenni preliminari sull'elaborazione di un ripristino in VSS](overview-of-processing-a-restore-under-vss.md)), un writer gestirà gli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dfef-144">In a typical restore operation (see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md)), a writer would handle the following events:</span></span>

-   <span data-ttu-id="3dfef-145">PreRestore</span><span class="sxs-lookup"><span data-stu-id="3dfef-145">PreRestore</span></span>
-   <span data-ttu-id="3dfef-146">PostRestore</span><span class="sxs-lookup"><span data-stu-id="3dfef-146">PostRestore</span></span>

 

 



