---
description: L'elaborazione di uno dei set di file di un componente potrebbe richiedere a un richiedente di attraversare un albero di directory in modo ricorsivo, che può richiedere al richiedente di gestire le cartelle montate e i reparse point, ad esempio i collegamenti, che puntano a dati che non si trova nel volume corrente.
ms.assetid: d0e08598-a8a2-489b-9cb2-e989bed1ce53
title: Uso delle cartelle e dei reparse point montati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 397a7aa88f39361f788f9aac882b4f9d337fd6f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307125"
---
# <a name="working-with-mounted-folders-and-reparse-points"></a><span data-ttu-id="370e2-103">Uso delle cartelle e dei reparse point montati</span><span class="sxs-lookup"><span data-stu-id="370e2-103">Working with Mounted Folders and Reparse Points</span></span>

<span data-ttu-id="370e2-104">L'elaborazione di uno dei set di file di un componente potrebbe richiedere a un richiedente di attraversare un albero di directory in modo ricorsivo, che può richiedere al richiedente di gestire le cartelle montate e i reparse point, ad esempio i collegamenti, che puntano a dati che non si trova nel volume corrente.</span><span class="sxs-lookup"><span data-stu-id="370e2-104">Processing one of a component's file sets may require a requester to traverse a directory tree recursively, which can require the requester to handle mounted folders and reparse points (such as links) that point to data that is not on the current volume.</span></span>

<span data-ttu-id="370e2-105">Si prevede che i richiedenti seguano le cartelle montate e i reparse point durante l'attraversamento di un albero di directory, mentre VSS include linee guida ben definite per gestirle per le operazioni di backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="370e2-105">Requesters are expected to follow mounted folders and reparse points when traversing a directory tree, and VSS has well-defined guidelines for handling them for backup and restore operations.</span></span>

<span data-ttu-id="370e2-106">Per illustrare queste linee guida, prendere in considerazione l'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="370e2-106">To illustrate these guidelines, consider the following example:</span></span>

-   <span data-ttu-id="370e2-107">Il volume \\ \\ ? \\ Il volume {GUID \_ 1} contiene la lettera di unità C: \\ .</span><span class="sxs-lookup"><span data-stu-id="370e2-107">The volume \\\\?\\Volume{GUID\_1} has the drive letter C:\\.</span></span>
-   <span data-ttu-id="370e2-108">Il percorso di un set di file è C: \\ WriterData.</span><span class="sxs-lookup"><span data-stu-id="370e2-108">A file set has a path of C:\\WriterData.</span></span>
-   <span data-ttu-id="370e2-109">Un file Specification \* . dat viene utilizzato dal set di file.</span><span class="sxs-lookup"><span data-stu-id="370e2-109">A file specification \*.dat is used by the file set.</span></span>
-   <span data-ttu-id="370e2-110">La ricorsione del set di file è impostata su **true**.</span><span class="sxs-lookup"><span data-stu-id="370e2-110">The file set's recursion is set to **TRUE**.</span></span>
-   <span data-ttu-id="370e2-111">La directory C: \\ WriterData si trova nel volume \\ \\ ? \\ Volume {GUID \_ 1}.</span><span class="sxs-lookup"><span data-stu-id="370e2-111">The directory C:\\WriterData is located on the volume \\\\?\\Volume{GUID\_1}.</span></span>
-   <span data-ttu-id="370e2-112">La directory C: \\ WriterData \\ Archive è una cartella montata.</span><span class="sxs-lookup"><span data-stu-id="370e2-112">The directory C:\\WriterData\\Archive is a mounted folder.</span></span>
-   <span data-ttu-id="370e2-113">Il volume \\ \\ ? \\ Il volume {GUID \_ 2} è associato alla cartella montata C: \\ WriterData \\ Archive.</span><span class="sxs-lookup"><span data-stu-id="370e2-113">The volume \\\\?\\Volume{GUID\_2} is associated with the mounted folder C:\\WriterData\\Archive.</span></span>

## <a name="handling-mounted-folders-and-reparse-points-during-backup"></a><span data-ttu-id="370e2-114">Gestione delle cartelle montate e dei reparse point durante il backup</span><span class="sxs-lookup"><span data-stu-id="370e2-114">Handling Mounted Folders and Reparse Points during Backup</span></span>

<span data-ttu-id="370e2-115">Le regole di base per la gestione delle cartelle montate e dei reparse point in VSS durante l'esecuzione di un backup ricorsivo possono essere riepilogate come segue:</span><span class="sxs-lookup"><span data-stu-id="370e2-115">The basic rules for handling mounted folders and reparse points under VSS when performing a recursive backup can be summarized as follows:</span></span>

-   <span data-ttu-id="370e2-116">I percorsi vengono seguiti tra le cartelle montate e i reparse point.</span><span class="sxs-lookup"><span data-stu-id="370e2-116">Paths are followed across mounted folders and reparse points.</span></span>
-   <span data-ttu-id="370e2-117">Se una cartella montata o un punto di analisi punta a un volume, tale volume deve essere replicato.</span><span class="sxs-lookup"><span data-stu-id="370e2-117">If a mounted folder or reparse point points to a volume, that volume should be shadow copied.</span></span>
-   <span data-ttu-id="370e2-118">Se un volume contiene cartelle montate o punti di analisi, questi verranno visualizzati nella copia shadow del volume.</span><span class="sxs-lookup"><span data-stu-id="370e2-118">If a volume contains mounted folders or reparse points, these will appear in the shadow copy of the volume.</span></span>
-   <span data-ttu-id="370e2-119">I dati che si trova nella cartella montata o nel punto di analisi vengono acquisiti nella copia shadow del volume a cui punta la cartella montata o il punto di analisi.</span><span class="sxs-lookup"><span data-stu-id="370e2-119">Data that is under the mounted folder or reparse point is captured in the shadow copy of the volume that the mounted folder or reparse point points to.</span></span>

<span data-ttu-id="370e2-120">Per illustrare l'uso dell'esempio precedente, poiché è impostato il flag ricorsivo, il richiedente deve esaminare tutti i dati nell' \\ Archivio C: WriterData \\ e sotto.</span><span class="sxs-lookup"><span data-stu-id="370e2-120">To illustrate using the example above, because the recursive flag is set, the requester must examine all data under C:\\WriterData\\Archive and below.</span></span>

<span data-ttu-id="370e2-121">Il richiedente deve aggiungere il volume con la lettera di unità C: \\ ( \\ \\ ? \\ Volume {GUID \_ 1}) e volume associato alla cartella montata C: \\ WriterData \\ Archive ( \\ \\ ? \\ Volume {GUID \_ 2}) per il set di copie shadow con [**IVssBackupComponents:: AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="370e2-121">The requester must add both the volume with drive letter C:\\ (\\\\?\\Volume{GUID\_1}) and the volume associated with the mounted folder C:\\WriterData\\Archive (\\\\?\\Volume{GUID\_2}) to the shadow copy set using [**IVssBackupComponents::AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span></span>

<span data-ttu-id="370e2-122">La cartella montata C: \\ WriterData \\ Archive viene visualizzata nella copia shadow del volume \\ \\ ? \\ Volume {GUID \_ 1}, che include un oggetto dispositivo denominato deviceObject1.</span><span class="sxs-lookup"><span data-stu-id="370e2-122">The mounted folder C:\\WriterData\\Archive appears in the shadow copy of volume \\\\?\\Volume{GUID\_1}, which has a device object named deviceObject1.</span></span>

<span data-ttu-id="370e2-123">Tuttavia, il servizio Copia Shadow del volume non copia i dati nella cartella montata (dati su \\ \\ ? \\ Volume {GUID \_ 2}) per la copia shadow a cui fa riferimento deviceObject1.</span><span class="sxs-lookup"><span data-stu-id="370e2-123">However, VSS will not copy any data under that mounted folder (data on \\\\?\\Volume{GUID\_2}) to the shadow copy referenced by deviceObject1.</span></span> <span data-ttu-id="370e2-124">I dati vengono invece acquisiti nella copia shadow di \\ \\ ? \\ Volume {GUID \_ 2}, che include un oggetto dispositivo denominato deviceObject2.</span><span class="sxs-lookup"><span data-stu-id="370e2-124">Instead, that data is captured in the shadow copy of \\\\?\\Volume{GUID\_2}, which has a device object named deviceObject2.</span></span>

<span data-ttu-id="370e2-125">Pertanto, un richiedente che esegue il backup dei file copiati Shadow in C: \\ WriterData utilizzerà il percorso deviceObject1 \\ WriterData per cercare i file corrispondenti a C: \\ WriterData \\ \* . dat.</span><span class="sxs-lookup"><span data-stu-id="370e2-125">Therefore, a requester that is backing up shadow copied files under C:\\WriterData will use a path of deviceObject1\\WriterData to search for files matching C:\\WriterData\\\*.dat.</span></span>

<span data-ttu-id="370e2-126">Per eseguire il backup dei file con copia shadow nell'archivio C: \\ WriterData \\ , il richiedente userà un percorso di deviceObject2 (perché la directory radice di \\ \\ ? \\ Il volume {GUID \_ 2} è stato associato alla cartella montata c: \\ Archivio del writer \\ ) per cercare i file corrispondenti a c: \\ WriterData \\ Archive \\ \* . dat.</span><span class="sxs-lookup"><span data-stu-id="370e2-126">To back up shadow copied files under C:\\WriterData\\Archive, the requester will use a path of deviceObject2 (because the root directory of \\\\?\\Volume{GUID\_2} was associated with the mounted folder C:\\Writer\\Archive) to search for files matching C:\\WriterData\\Archive\\\*.dat.</span></span>

<span data-ttu-id="370e2-127">Si noti che un reparse point viene gestito allo stesso modo di una cartella montata.</span><span class="sxs-lookup"><span data-stu-id="370e2-127">Note that a reparse point is handled in the same way as a mounted folder.</span></span> <span data-ttu-id="370e2-128">Il punto di analisi viene visualizzato nella copia shadow del primo volume.</span><span class="sxs-lookup"><span data-stu-id="370e2-128">The reparse point appears in the shadow copy of the first volume.</span></span> <span data-ttu-id="370e2-129">I dati nel punto di analisi vengono visualizzati nella copia shadow del secondo volume.</span><span class="sxs-lookup"><span data-stu-id="370e2-129">The data under the reparse point appears in the shadow copy of the second volume.</span></span>

<span data-ttu-id="370e2-130">Durante il backup, i richiedenti devono archiviare le informazioni sulle cartelle montate e i volumi associati, nonché i reparse point e le relative destinazioni per garantire che tutti i dati vengano sottoposti a backup e ripristinati correttamente.</span><span class="sxs-lookup"><span data-stu-id="370e2-130">During backup, requesters should store information about mounted folders and the volumes associated with them as well as reparse points and their targets to ensure that all data is backed up and restored correctly.</span></span>

## <a name="handling-mount-and-reparse-points-during-restore"></a><span data-ttu-id="370e2-131">Gestione del montaggio e dei reparse point durante il ripristino</span><span class="sxs-lookup"><span data-stu-id="370e2-131">Handling Mount and Reparse Points during Restore</span></span>

<span data-ttu-id="370e2-132">Quando si ripristinano i file, il richiedente deve seguire le linee guida in modo diverso rispetto a quelle usate durante il backup (ignorando i problemi, ad esempio il [*mapping del percorso alternativo*](vssgloss-a.md) e il [*nuovo percorso di destinazione*](vssgloss-n.md)):</span><span class="sxs-lookup"><span data-stu-id="370e2-132">When restoring files, the requester must follow guidelines somewhat different from those that were used during backup (ignoring issues such as [*alternate location mapping*](vssgloss-a.md) and [*new target location*](vssgloss-n.md)):</span></span>

-   <span data-ttu-id="370e2-133">Come prima, se è necessaria la ricorsione, i percorsi vengono seguiti tra le cartelle montate e i reparse point.</span><span class="sxs-lookup"><span data-stu-id="370e2-133">As before, if recursion is required, paths are followed across mounted folders and reparse points.</span></span>
-   <span data-ttu-id="370e2-134">Le cartelle montate devono essere ripristinate.</span><span class="sxs-lookup"><span data-stu-id="370e2-134">Mounted folders are to be restored.</span></span>
-   <span data-ttu-id="370e2-135">I percorsi di ripristino delle cartelle e dei reparse point montati sono quelli determinati dai percorsi originali.</span><span class="sxs-lookup"><span data-stu-id="370e2-135">The restoration locations of mounted folders and reparse points are those determined by their original paths.</span></span>

<span data-ttu-id="370e2-136">Se i nomi dei volumi vengono mantenuti tra backup e ripristino, ovvero se non si ricreano i volumi, le cartelle montate ripristinate e i punti di analisi devono puntare ai volumi corretti.</span><span class="sxs-lookup"><span data-stu-id="370e2-136">If the volume names persist between backup and restore—that is, you do not re-create the volumes—restored mounted folders and reparse points should point to the correct volumes.</span></span>

<span data-ttu-id="370e2-137">Quindi, nell'esempio illustrato in precedenza, se la cartella montata C: \\ WriterData \\ Archive è stata ripristinata ( \\ \\ ? \\ Il volume {GUID \_ 1}) e il volume precedentemente associato sono stati ripristinati in ( \\ \\ ? \\ Volume {GUID \_ 2}), i file ripristinati e la struttura del file sarebbero corretti e coerenti.</span><span class="sxs-lookup"><span data-stu-id="370e2-137">Therefore, in the example discussed above, if the mounted folder C:\\WriterData\\Archive was restored to (\\\\?\\Volume{GUID\_1}) and the volume previously associated with it was restored to (\\\\?\\Volume{GUID\_2}), the restored files and file structure would be correct and consistent.</span></span>

<span data-ttu-id="370e2-138">È possibile che i dati vengano ripristinati in un sistema in cui sono stati modificati i nomi dei volumi.</span><span class="sxs-lookup"><span data-stu-id="370e2-138">It may happen that data is restored to a system where volume names changed.</span></span> <span data-ttu-id="370e2-139">La causa potrebbe essere un arresto anomalo del disco, in cui potrebbe essere necessario eseguire un ripristino manuale del sistema e ricreare i volumi.</span><span class="sxs-lookup"><span data-stu-id="370e2-139">This could be due to disk crashes, where you might need to perform a manual system recovery and re-create volumes.</span></span> <span data-ttu-id="370e2-140">In questo tipo di situazione, le cartelle e i reparse point montati non saranno più validi dopo il ripristino.</span><span class="sxs-lookup"><span data-stu-id="370e2-140">In this type of situation, mounted folders and reparse points will no longer be valid after restore.</span></span> <span data-ttu-id="370e2-141">Per ricreare i file e la struttura dei file nel volume ripristinato, è necessario eliminare le cartelle montate e reparse point ripristinate e ricrearle su disco.</span><span class="sxs-lookup"><span data-stu-id="370e2-141">To re-create the files and file structure on the restored volume will require deleting the restored mounted folders and reparse points and re-creating them on disk.</span></span> <span data-ttu-id="370e2-142">Spetta all'applicazione di backup decidere se è appropriato.</span><span class="sxs-lookup"><span data-stu-id="370e2-142">It is up to the backup application to decide whether this is appropriate.</span></span>

<span data-ttu-id="370e2-143">Si noti che è possibile che la destinazione di ripristino per una cartella montata sia già occupata.</span><span class="sxs-lookup"><span data-stu-id="370e2-143">Note that it is possible that the restore destination for a mounted folder is already occupied.</span></span> <span data-ttu-id="370e2-144">Ad esempio, C: \\ WriterData \\ Archive potrebbe già contenere alcuni file.</span><span class="sxs-lookup"><span data-stu-id="370e2-144">For example, C:\\WriterData\\Archive might already contain some files.</span></span> <span data-ttu-id="370e2-145">Spetta all'applicazione di backup decidere come gestire questa situazione.</span><span class="sxs-lookup"><span data-stu-id="370e2-145">It is up to the backup application to decide how to handle this situation.</span></span>

 

 



