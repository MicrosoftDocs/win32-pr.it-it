---
description: Esistono situazioni in cui i dati di un writer dipendono dai dati gestiti da un altro writer. In questi casi, è necessario eseguire il backup o il ripristino dei dati da entrambi i writer.
ms.assetid: 0413c289-74b7-4e83-a227-00bfb264e56e
title: Dipendenze tra componenti gestiti da Writer diversi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ba3be6a2c2f0a722c4c5f06ca95351e004e1cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349271"
---
# <a name="dependencies-between-components-managed-by-different-writers"></a><span data-ttu-id="b9765-104">Dipendenze tra componenti gestiti da Writer diversi</span><span class="sxs-lookup"><span data-stu-id="b9765-104">Dependencies between Components Managed by Different Writers</span></span>

<span data-ttu-id="b9765-105">Esistono situazioni in cui i dati di un writer dipendono dai dati gestiti da un altro writer.</span><span class="sxs-lookup"><span data-stu-id="b9765-105">There are situations where data from one writer depends on data managed by another writer.</span></span> <span data-ttu-id="b9765-106">In questi casi, è necessario eseguire il backup o il ripristino dei dati da entrambi i writer.</span><span class="sxs-lookup"><span data-stu-id="b9765-106">In these cases, you should back up or restore data from both writers.</span></span>

<span data-ttu-id="b9765-107">VSS gestisce questo problema tramite la nozione di dipendenza esplicita del componente writer e l'interfaccia [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) .</span><span class="sxs-lookup"><span data-stu-id="b9765-107">VSS handles this problem through the notion of an explicit writer-component dependency and the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span>

<span data-ttu-id="b9765-108">Un writer aggiunge una o più dipendenze durante la creazione del documento di metadati del writer usando il metodo [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) .</span><span class="sxs-lookup"><span data-stu-id="b9765-108">A writer adds one or more dependencies while creating the Writer Metadata Document using the [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method.</span></span> <span data-ttu-id="b9765-109">Il writer passa il metodo il nome e il percorso logico del componente dipendente (gestito), nonché il nome e il percorso logico e l' [*ID della classe Writer*](vssgloss-w.md) (il GUID che identifica la classe) del componente da cui dipende.</span><span class="sxs-lookup"><span data-stu-id="b9765-109">The writer passes the method the name and logical path of the dependent component (which it manages), as well as the name and logical path and the [*writer class ID*](vssgloss-w.md) (the GUID identifying the class) of the component upon which it depends.</span></span>

<span data-ttu-id="b9765-110">Una volta stabilita, questa dipendenza informa il richiedente che durante qualsiasi operazione di backup o ripristino sia il componente dipendente che le destinazioni delle relative dipendenze devono partecipare.</span><span class="sxs-lookup"><span data-stu-id="b9765-110">Once established, this dependency informs the requester that during any backup or restore operation both the dependent component and the targets of its dependencies must participate.</span></span>

<span data-ttu-id="b9765-111">Un determinato componente può disporre di più dipendenze, per cui è necessario che l'insieme e tutte le relative destinazioni dipendenti partecipino al backup e al ripristino.</span><span class="sxs-lookup"><span data-stu-id="b9765-111">A given component can have multiple dependencies, which requires that it and all its dependent targets participate in the backup and restore together.</span></span>

<span data-ttu-id="b9765-112">Il componente dipendente e/o le destinazioni delle relative dipendenze possono essere inclusi in [*modo esplicito*](vssgloss-e.md) o [*implicito*](vssgloss-i.md) in un'operazione di backup o ripristino.</span><span class="sxs-lookup"><span data-stu-id="b9765-112">The dependent component and/or the target(s) of its dependencies can be included either [*explicitly*](vssgloss-e.md) or [*implicitly*](vssgloss-i.md) in a backup or restore operations.</span></span>

<span data-ttu-id="b9765-113">Il meccanismo di dipendenza del componente writer esplicito non deve essere utilizzato per creare una dipendenza tra due componenti sullo stesso writer.</span><span class="sxs-lookup"><span data-stu-id="b9765-113">The explicit writer component dependency mechanism should not be used to create a dependency between two components on the same writer.</span></span> <span data-ttu-id="b9765-114">Le regole di selezione possono fornire la stessa funzionalità in modo più efficiente senza rischiare dipendenze circolari.</span><span class="sxs-lookup"><span data-stu-id="b9765-114">The selection rules can supply the same functionality more efficiently without risk of circular dependencies.</span></span>

<span data-ttu-id="b9765-115">Ad esempio, è possibile usare [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) per definire la dipendenza del componente writerData (con il percorso logico "") del writer writeback sul componente internetData (con un percorso logico "Connections") di un writer denominato InternetConnector con un ID classe Writer X. Sebbene sia possibile che più writer con lo stesso ID di classe si trovino simultaneamente nel sistema, è possibile evitare confusione perché la combinazione di percorso logico e nome del componente è univoca nel sistema in VSS.</span><span class="sxs-lookup"><span data-stu-id="b9765-115">As an example, [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) could be used to define the dependency of the component writerData (with logical path "") of the writer MyWriter on component internetData (with a logical path of "Connections") of a writer named InternetConnector with a writer Class ID X. (While it is possible for multiple writers with the same class ID to be on the system simultaneously, confusion will be avoided because the combination of logical path and component name is unique on the system under VSS.)</span></span>

<span data-ttu-id="b9765-116">Un writer aggiunge più dipendenze a un determinato componente semplicemente chiamando [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) ripetuto con componenti diversi di writer diversi.</span><span class="sxs-lookup"><span data-stu-id="b9765-116">A writer adds multiple dependencies to a given component simply by calling [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) repeated with different components from different writers.</span></span> <span data-ttu-id="b9765-117">È possibile trovare il numero di altri componenti da cui dipende un determinato componente esaminando il membro **cDependencies** della struttura [**\_ COMPONENTINFO VSS**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) .</span><span class="sxs-lookup"><span data-stu-id="b9765-117">The number of other components a given component depends on can be found by examining the **cDependencies** member of the [**VSS\_COMPONENTINFO**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) structure.</span></span>

<span data-ttu-id="b9765-118">Un writer o un richiedente recupera le istanze dell'interfaccia [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) con [**IVssWMComponent:: getdependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span><span class="sxs-lookup"><span data-stu-id="b9765-118">A writer or requester retrieves instances of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface with [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="b9765-119">**IVssWMDependency** restituisce il nome del componente, il percorso logico e l'ID di classe del writer che gestisce il componente che rappresenta la destinazione della dipendenza.</span><span class="sxs-lookup"><span data-stu-id="b9765-119">The **IVssWMDependency** returns the component name, logical path, and class ID of the writer managing the component that is the target of the dependency.</span></span>

<span data-ttu-id="b9765-120">Il meccanismo di dipendenza non prescrive alcun ordine di preferenza particolare tra il componente dipendente e le destinazioni delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b9765-120">The dependency mechanism does not prescribe any particular order of preference between the dependent component and the targets of its dependencies.</span></span> <span data-ttu-id="b9765-121">Come indicato in precedenza, tutte le dipendenze indicano che ogni volta che viene eseguito il backup o il ripristino di un componente specifico, è necessario eseguire il backup o il ripristino anche del componente o dei componenti da cui dipende.</span><span class="sxs-lookup"><span data-stu-id="b9765-121">As noted above, all a dependency indicates is that whenever a given component is either backed up or restored, the component or components it depends on must be backed up or restored as well.</span></span> <span data-ttu-id="b9765-122">L'esatta implementazione di dipendenza è a discrezione dell'applicazione di backup.</span><span class="sxs-lookup"><span data-stu-id="b9765-122">The exact implementation of dependency is at the discretion of the backup application.</span></span>

<span data-ttu-id="b9765-123">Nel caso precedente, ad esempio, il componente writerData (percorso logico "") dipende dal componente InternetConnector (percorso logico "Connections").</span><span class="sxs-lookup"><span data-stu-id="b9765-123">For example, in the case above, the component writerData (logical path "") depends on component InternetConnector (logical path "Connections").</span></span> <span data-ttu-id="b9765-124">Un richiedente è libero di interpretare questo problema in uno dei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="b9765-124">A requester is free to interpret this in either of the following ways:</span></span>

-   <span data-ttu-id="b9765-125">Se il componente dipendente, writerData, è selezionato (in modo implicito o esplicito) per il backup o il ripristino, il richiedente deve selezionare (in modo implicito o esplicito) la destinazione della relativa dipendenza, internetData</span><span class="sxs-lookup"><span data-stu-id="b9765-125">If the dependent component, writerData, is selected (implicitly or explicitly) for backup or restore, the requester must select (either implicitly or explicitly) the target of its dependency, internetData</span></span>
-   <span data-ttu-id="b9765-126">Se la destinazione della relativa dipendenza, internetData, non è selezionata per il backup, non è necessario selezionare il componente dipendente, writerData.</span><span class="sxs-lookup"><span data-stu-id="b9765-126">If the target of its dependency, internetData, is not selected for backup, then the dependent component, writerData, should not be selected.</span></span>

<span data-ttu-id="b9765-127">Tuttavia, durante lo sviluppo del supporto per le dipendenze, gli sviluppatori del richiedente devono tenere presente che non esiste alcun modo in cui un writer può determinare se uno dei suoi componenti è la destinazione di una dipendenza.</span><span class="sxs-lookup"><span data-stu-id="b9765-127">However, when developing support for dependencies, requester developers should be aware that there is no way a writer can determine if one of its components is a target of a dependency.</span></span>

## <a name="declaring-remote-dependencies"></a><span data-ttu-id="b9765-128">Dichiarazione delle dipendenze Remote</span><span class="sxs-lookup"><span data-stu-id="b9765-128">Declaring Remote Dependencies</span></span>

<span data-ttu-id="b9765-129">Un'applicazione distribuita è un'applicazione che può essere configurata per l'utilizzo di uno o più computer alla volta.</span><span class="sxs-lookup"><span data-stu-id="b9765-129">A distributed application is an application that can be configured to use one or more computers at a time.</span></span> <span data-ttu-id="b9765-130">In genere l'applicazione viene eseguita in uno o più computer del server applicazioni e comunica con (ma può essere effettivamente eseguita o meno) uno o più computer server di database.</span><span class="sxs-lookup"><span data-stu-id="b9765-130">Typically the application runs on one or more application server computers and communicates with (but may or may not actually run on) one or more database server computers.</span></span> <span data-ttu-id="b9765-131">Questa configurazione viene a volte definita distribuzione multisistema.</span><span class="sxs-lookup"><span data-stu-id="b9765-131">This configuration is sometimes referred to as a multi-system deployment.</span></span> <span data-ttu-id="b9765-132">Spesso la stessa applicazione può essere configurata anche per l'esecuzione in un singolo computer che esegue sia un server applicazioni che un server di database.</span><span class="sxs-lookup"><span data-stu-id="b9765-132">Often the same application can also be configured to run on a single computer that runs both an application server and a database server.</span></span> <span data-ttu-id="b9765-133">Una configurazione di questo tipo è detta distribuzione a singolo sistema.</span><span class="sxs-lookup"><span data-stu-id="b9765-133">Such a configuration is called a single-system deployment.</span></span> <span data-ttu-id="b9765-134">In entrambe le configurazioni, il server applicazioni e il server di database dispongono ognuno dei propri writer VSS indipendenti.</span><span class="sxs-lookup"><span data-stu-id="b9765-134">In both configurations, the application server and database server each have their own independent VSS writers.</span></span>

<span data-ttu-id="b9765-135">In una distribuzione multisistema, se un componente gestito dal writer dell'applicazione dipende da un componente remoto gestito dal writer del server di database, questo viene definito dipendenza remota.</span><span class="sxs-lookup"><span data-stu-id="b9765-135">In a multi-system deployment, if a component managed by the application's writer depends on a remote component managed by the database server's writer, this is called a remote dependency.</span></span> <span data-ttu-id="b9765-136">Una distribuzione a singolo sistema, al contrario, ha solo dipendenze locali.</span><span class="sxs-lookup"><span data-stu-id="b9765-136">(A single-system deployment, in contrast, has only local dependencies.)</span></span>

<span data-ttu-id="b9765-137">Come esempio di una distribuzione multisistema, si consideri un server applicazioni che utilizza un server di database SQL Server come archivio dati.</span><span class="sxs-lookup"><span data-stu-id="b9765-137">As an example of a multi-system deployment, consider an application server that uses a SQL Server database server as a data store.</span></span> <span data-ttu-id="b9765-138">I dati specifici dell'applicazione, che includono le web part, i file di contenuto Web e la metabase IIS, si trovano in uno o più computer, detti server Web front-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-138">The application-specific data, which includes the web parts, web content files, and the IIS metabase, resides on one or more computers, called front-end web servers.</span></span> <span data-ttu-id="b9765-139">L'archivio dati SQL effettivo, che include il database di configurazione e più database di contenuto, risiede in uno o più computer, detti server di database back-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-139">The actual SQL data store, which includes the Config database and multiple Content databases, resides on one or more other computers, called back-end database servers.</span></span> <span data-ttu-id="b9765-140">Ogni server Web front-end contiene lo stesso contenuto e la stessa configurazione specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b9765-140">Each of the front-end web servers contains the same application-specific content and configuration.</span></span> <span data-ttu-id="b9765-141">Ogni server di database back-end può ospitare qualsiasi database di contenuto o il database di configurazione.</span><span class="sxs-lookup"><span data-stu-id="b9765-141">Each of the back-end database servers can host any of the Content databases or the Config database.</span></span> <span data-ttu-id="b9765-142">Il software applicativo viene eseguito solo nei server Web front-end, non nei server di database.</span><span class="sxs-lookup"><span data-stu-id="b9765-142">The application software runs only on the front-end web servers, not on the database servers.</span></span> <span data-ttu-id="b9765-143">In questa configurazione, la VSS writer dell'applicazione ha dipendenze remote dai componenti gestiti dal writer SQL.</span><span class="sxs-lookup"><span data-stu-id="b9765-143">In this configuration, the application's VSS writer has remote dependencies on the components managed by the SQL writer.</span></span>

<span data-ttu-id="b9765-144">Un writer può dichiarare una dipendenza remota chiamando il metodo [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) , anteponendo " \\ \\ *NomeComputerRemoto* \\ ", dove *NomeComputerRemoto* è il nome del computer in cui risiede il componente remoto, al percorso logico nel parametro *wszOnLogicalPath* .</span><span class="sxs-lookup"><span data-stu-id="b9765-144">A writer can declare a remote dependency by calling the [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method, prepending "\\\\*RemoteComputerName*\\", where *RemoteComputerName* is the name of the computer where the remote component resides, to the logical path in the *wszOnLogicalPath* parameter.</span></span> <span data-ttu-id="b9765-145">Il valore di *NomeComputerRemoto* può essere un indirizzo IP o un nome di computer restituito dalla funzione [**presunto GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) .</span><span class="sxs-lookup"><span data-stu-id="b9765-145">The value of *RemoteComputerName* can be an IP address or a computer name returned by the [**GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) function.</span></span>

<span data-ttu-id="b9765-146">**Windows Server 2003:** Un writer non può dichiarare le dipendenze remote fino a Windows Server 2003 con Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="b9765-146">**Windows Server 2003:** A writer cannot declare remote dependencies until Windows Server 2003 with Service Pack 1 (SP1).</span></span>

<span data-ttu-id="b9765-147">Per identificare una dipendenza, un richiedente chiama i metodi [**GetWriterId**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath)e [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) dell'interfaccia [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) .</span><span class="sxs-lookup"><span data-stu-id="b9765-147">To identify a dependency, a requester calls the [**GetWriterId**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath), and [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) methods of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span> <span data-ttu-id="b9765-148">Il richiedente deve esaminare il nome del componente restituito da **GetComponentName** nel parametro *pbstrComponentName* .</span><span class="sxs-lookup"><span data-stu-id="b9765-148">The requester must examine the component name that **GetComponentName** returns in the *pbstrComponentName* parameter.</span></span> <span data-ttu-id="b9765-149">Se il nome del componente inizia con " \\ \\ ", il richiedente deve presupporre che specifichi una dipendenza remota e che il primo componente che segue " \\ \\ " è il *NomeComputerRemoto* specificato quando il writer ha chiamato [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency).</span><span class="sxs-lookup"><span data-stu-id="b9765-149">If the component name begins with "\\\\", the requester must assume that it specifies a remote dependency and that the first component following "\\\\" is the *RemoteComputerName* that was specified when the writer called [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency).</span></span> <span data-ttu-id="b9765-150">Se il nome del componente non inizia con " \\ \\ ", il richiedente deve presupporre che specifichi una dipendenza locale.</span><span class="sxs-lookup"><span data-stu-id="b9765-150">If the component name does not begin with "\\\\", the requester should assume that it specifies a local dependency.</span></span>

<span data-ttu-id="b9765-151">Se è presente una dipendenza remota, il richiedente deve eseguire il backup del componente remoto quando esegue il backup del componente locale.</span><span class="sxs-lookup"><span data-stu-id="b9765-151">If there is a remote dependency, the requester must back up the remote component when it backs up the local component.</span></span> <span data-ttu-id="b9765-152">Per eseguire il backup del componente remoto, il richiedente deve disporre di un agente nel computer remoto e deve avviare il backup nel computer remoto.</span><span class="sxs-lookup"><span data-stu-id="b9765-152">To back up the remote component, the requester should have an agent on the remote computer and should initiate the backup on the remote computer.</span></span>

## <a name="structuring-remote-dependencies"></a><span data-ttu-id="b9765-153">Strutturazione delle dipendenze Remote</span><span class="sxs-lookup"><span data-stu-id="b9765-153">Structuring Remote Dependencies</span></span>

<span data-ttu-id="b9765-154">È importante comprendere che una dipendenza non è un componente di e di se stessa.</span><span class="sxs-lookup"><span data-stu-id="b9765-154">It is important to understand that a dependency is not a component in and of itself.</span></span> <span data-ttu-id="b9765-155">Un componente è necessario per mantenere la dipendenza.</span><span class="sxs-lookup"><span data-stu-id="b9765-155">A component is necessary to hold the dependency.</span></span>

<span data-ttu-id="b9765-156">Negli esempi seguenti vengono illustrati due modi per strutturare un set di dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b9765-156">The following examples show two ways to structure a set of dependencies.</span></span>

``` syntax
Example 1:
    Writer 1
        Component A
            File A
            File B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")

Example 2:
    Writer 2
        Component A
            File A
            File B
        Component B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")
```

<span data-ttu-id="b9765-157">Nell'esempio 1, le dipendenze sono detenute dal componente A. Poiché è possibile selezionare solo i componenti, non singoli file, strutturare le dipendenze del componente A in questo modo, è necessario che l'intero componente, sia i file che le dipendenze, debbano essere sempre sottoposti a backup e ripristino insieme.</span><span class="sxs-lookup"><span data-stu-id="b9765-157">In example 1, the dependencies are held by Component A. Because only components can be selected, not individual files, structuring Component A's dependencies this way would require that the entire component, both the files and the dependencies, must always be backed up and restored together.</span></span> <span data-ttu-id="b9765-158">Non è possibile eseguirne il backup o il ripristino singolarmente.</span><span class="sxs-lookup"><span data-stu-id="b9765-158">They cannot be backed up or restored individually.</span></span>

<span data-ttu-id="b9765-159">Nell'esempio 2, i componenti separati (i componenti A e B) contengono tutte le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b9765-159">In example 2, separate components (Components A and B) hold each of the dependencies.</span></span> <span data-ttu-id="b9765-160">In questo caso, è possibile selezionare i due componenti in modo indipendente e quindi eseguire il backup e il ripristino in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="b9765-160">In this case, the two components can be selected independently, and therefore backed up and restored independently.</span></span> <span data-ttu-id="b9765-161">Strutturare le dipendenze in questo modo fornisce a un'applicazione distribuita maggiore flessibilità nella gestione delle dipendenze remote.</span><span class="sxs-lookup"><span data-stu-id="b9765-161">Structuring the dependencies this way gives a distributed application much more flexibility in managing its remote dependencies.</span></span>

## <a name="supporting-remote-dependencies"></a><span data-ttu-id="b9765-162">Supporto delle dipendenze Remote</span><span class="sxs-lookup"><span data-stu-id="b9765-162">Supporting Remote Dependencies</span></span>

<span data-ttu-id="b9765-163">Un richiedente può fornire supporto completo o parziale per le dipendenze remote.</span><span class="sxs-lookup"><span data-stu-id="b9765-163">A requester can provide full or partial support for remote dependencies.</span></span>

<span data-ttu-id="b9765-164">Per fornire supporto completo, il richiedente deve eseguire le operazioni seguenti in fase di backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="b9765-164">To provide full support, the requester should do the following at backup and restore time.</span></span>

<span data-ttu-id="b9765-165">Al momento del backup, il richiedente deve avviare il backup nel computer front-end (locale), determinare le dipendenze esistenti e quindi eseguire lo spooling di processi di backup aggiuntivi per acquisire i database back-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-165">At backup time, the requester must start the backup on the front-end (local) computer, determine the dependencies that exist, and spool additional backup jobs to capture the back-end databases.</span></span> <span data-ttu-id="b9765-166">Il richiedente deve attendere il completamento dei processi di backup back-end nel computer remoto prima di chiamare i metodi [**IVssBackupComponents:: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) e [**IVssBackupComponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) .</span><span class="sxs-lookup"><span data-stu-id="b9765-166">The requester must wait until after the back-end backup jobs on the remote computer have completed before calling the [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) methods.</span></span> <span data-ttu-id="b9765-167">Se il richiedente resta in attesa fino al completamento del backup dei componenti back-end prima di chiamare **BackupComplete**, in questo modo verrà generato un backup recuperabile più facilmente per un writer che implementa ulteriori miglioramenti, ad esempio il blocco della topologia, durante il backup.</span><span class="sxs-lookup"><span data-stu-id="b9765-167">If the requester waits until the backup of back-end components is complete before calling **BackupComplete**, this will produce a more easily recoverable backup for a writer that implements additional enhancements—such as topology locking, for example—during the backup.</span></span> <span data-ttu-id="b9765-168">La procedura seguente descrive le operazioni che il richiedente deve eseguire:</span><span class="sxs-lookup"><span data-stu-id="b9765-168">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="b9765-169">Sul computer locale, il richiedente chiama i metodi [**IVssBackupComponents:: InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::P Repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup)e [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) .</span><span class="sxs-lookup"><span data-stu-id="b9765-169">On the local computer, the requester calls the [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), and [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) methods.</span></span>
2.  <span data-ttu-id="b9765-170">Al termine della copia shadow locale, ma prima del completamento del backup, il richiedente spoolerà i processi di backup aggiuntivi inviando una richiesta all'agente nel computer remoto.</span><span class="sxs-lookup"><span data-stu-id="b9765-170">After the local shadow copy is completed, but before the backup is completed, the requester spools additional backup jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="b9765-171">Nel computer remoto, l'agente del richiedente esegue la sequenza di backup con spooling chiamando [**InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)e [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="b9765-171">On the remote computer, the requester's agent performs the spooled backup sequence by calling [**InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded), and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>
4.  <span data-ttu-id="b9765-172">Quando l'agente del richiedente ha completato i processi di spooling nel computer remoto, il richiedente completa la sequenza di backup chiamando [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) e [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="b9765-172">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the backup sequence by calling [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>

<span data-ttu-id="b9765-173">Al momento del ripristino, il richiedente deve avviare il ripristino che interessa il computer front-end (locale), selezionare i componenti e le relative dipendenze da ripristinare e quindi inviare l'evento di [**Preripristino**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) chiamando il metodo **IVssBackupComponents::P rerestore** .</span><span class="sxs-lookup"><span data-stu-id="b9765-173">At restore time, the requester must start the restore involving the front-end (local) computer, select the components and their dependencies to be restored, and then send the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event by calling the **IVssBackupComponents::PreRestore** method.</span></span> <span data-ttu-id="b9765-174">Il richiedente deve quindi eseguire lo spooling dei processi di ripristino back-end nel computer remoto e chiamare il metodo [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) quando i ripristini back-end sono completi.</span><span class="sxs-lookup"><span data-stu-id="b9765-174">The requester should then spool the back-end restore jobs on the remote computer and call the [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) method when the back-end restores are complete.</span></span> <span data-ttu-id="b9765-175">Questo requisito offre al writer front-end maggiore controllo sull'esperienza di ripristino e una migliore esperienza utente dell'amministratore in generale.</span><span class="sxs-lookup"><span data-stu-id="b9765-175">This requirement gives the front-end writer more control over the restore experience and a better administrator user experience overall.</span></span> <span data-ttu-id="b9765-176">Poiché i backup in ogni sistema non si verificano nello stesso momento, il writer front-end dovrà eseguire alcune operazioni di pulizia dei dati back-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-176">Because the backups across each of the systems do not occur at the same point in time, the front-end writer will need to perform some cleanup of the back-end data.</span></span> <span data-ttu-id="b9765-177">Nell'applicazione di esempio illustrata in precedenza "dichiarazione delle dipendenze remote", il writer deve avviare un nuovo mapping del sito o reindicizzare dopo il completamento di un ripristino di uno dei database back-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-177">In the example application discussed in the preceding "Declaring Remote Dependencies", the writer should initiate a site remapping or reindexing after a restore of one of the back-end databases has completed.</span></span> <span data-ttu-id="b9765-178">A tale scopo, il writer deve ricevere eventi nel server front-end.</span><span class="sxs-lookup"><span data-stu-id="b9765-178">To do this, the writer must receive events on the front-end server.</span></span> <span data-ttu-id="b9765-179">La procedura seguente descrive le operazioni che il richiedente deve eseguire:</span><span class="sxs-lookup"><span data-stu-id="b9765-179">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="b9765-180">Nel computer locale, il richiedente chiama [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (o [**IVssBackupComponentsEx:: SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) e [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span><span class="sxs-lookup"><span data-stu-id="b9765-180">On the local computer, the requester calls [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (or [**IVssBackupComponentsEx::SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span>
2.  <span data-ttu-id="b9765-181">Al termine della fase di [**preripristino**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) , ma prima dell'inizio della fase di post- [**ripristino**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) , il richiedente spoolà ulteriori processi di ripristino inviando una richiesta all'agente nel computer remoto.</span><span class="sxs-lookup"><span data-stu-id="b9765-181">After the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase is completed, but before the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) phase begins, the requester spools additional restore jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="b9765-182">Nel computer remoto, l'agente del richiedente esegue i processi di ripristino con spooling chiamando [**InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (o [**SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) e [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="b9765-182">On the remote computer, the requester's agent performs the spooled restore jobs by calling [**InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (or [**SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>
4.  <span data-ttu-id="b9765-183">Quando l'agente del richiedente ha completato i processi di spooling nel computer remoto, il richiedente completa la sequenza di ripristino chiamando [**IVssBackupComponents:: SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) e [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="b9765-183">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the restore sequence by calling [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>

<span data-ttu-id="b9765-184">Per fornire supporto parziale per le dipendenze remote, il richiedente deve seguire le dipendenze remote e includerle come parte del backup, ma l'ordine degli eventi nei sistemi front-end e back-end, come descritto nelle due procedure precedenti, non è necessario.</span><span class="sxs-lookup"><span data-stu-id="b9765-184">To provide partial support for remote dependencies, the requester must follow remote dependencies and include them as part of the backup, but the ordering of events on front-end and back-end systems as detailed in the previous two procedures would not be required.</span></span> <span data-ttu-id="b9765-185">Per un richiedente che implementa solo il supporto parziale, il richiedente deve fare riferimento alla documentazione di backup/ripristino dell'applicazione Writer per comprendere quali scenari è possibile supportare.</span><span class="sxs-lookup"><span data-stu-id="b9765-185">For a requester that implements only partial support, the requester should refer to the writer application's backup/restore documentation to understand what scenarios can be supported.</span></span>

 

 
