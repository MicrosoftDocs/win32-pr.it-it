---
description: Come per tutte le operazioni importanti in VSS, i backup incrementali e differenziali richiedono una stretta collaborazione tra i richiedenti e i writer.
ms.assetid: 3cf5dd1f-dc58-42bc-925f-fee7d34053c5
title: Ruolo di writer per il backup di archivi complessi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80864256b9a19c25a2f0dce0d0c929ed19fd7269
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129267"
---
# <a name="writer-role-in-backing-up-complex-stores"></a><span data-ttu-id="6455c-103">Ruolo di writer per il backup di archivi complessi</span><span class="sxs-lookup"><span data-stu-id="6455c-103">Writer Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="6455c-104">Come per tutte le operazioni importanti in VSS, i backup [*incrementali*](vssgloss-i.md) e [*differenziali*](vssgloss-d.md) richiedono una stretta collaborazione tra i richiedenti e i writer.</span><span class="sxs-lookup"><span data-stu-id="6455c-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-types"></a><span data-ttu-id="6455c-105">Tipi di backup</span><span class="sxs-lookup"><span data-stu-id="6455c-105">Backup Types</span></span>

<span data-ttu-id="6455c-106">L'infrastruttura fornisce supporto speciale per cinque tipi di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="6455c-107">Sono descritte come segue:</span><span class="sxs-lookup"><span data-stu-id="6455c-107">They are described as follows:</span></span>

-   <span data-ttu-id="6455c-108">Completo (**VSS \_ BT \_ completo**).</span><span class="sxs-lookup"><span data-stu-id="6455c-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="6455c-109">Verrà eseguito il backup dei file indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="6455c-110">La cronologia di backup di ogni file verrà aggiornata e questo tipo di backup può essere utilizzato come base per un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="6455c-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="6455c-111">Se sono presenti file di log, è possibile che vengano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="6455c-112">Il ripristino di un backup completo richiede una sola immagine di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="6455c-113">Differenziale (**VSS \_ BT \_ differenziale**).</span><span class="sxs-lookup"><span data-stu-id="6455c-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="6455c-114">L'API VSS viene utilizzata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo vengano copiati in un supporto di archiviazione. tutte le informazioni sul backup intermedio verranno ignorate.</span><span class="sxs-lookup"><span data-stu-id="6455c-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="6455c-115">Questo può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="6455c-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="6455c-116">Un backup differenziale è associato a un backup completo e in genere non può essere ripristinato fino a quando non viene ripristinato il backup completo.</span><span class="sxs-lookup"><span data-stu-id="6455c-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="6455c-117">Se sono presenti file di log, in genere non verranno troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="6455c-118">Il ripristino di un backup differenziale richiede l'immagine di backup originale e l'immagine di backup differenziale più recente eseguita dopo l'ultimo backup completo.</span><span class="sxs-lookup"><span data-stu-id="6455c-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="6455c-119">Incrementale (**VSS \_ BT \_ incrementale**).</span><span class="sxs-lookup"><span data-stu-id="6455c-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="6455c-120">L'API VSS viene utilizzata per garantire che solo i file che sono stati modificati o aggiunti dopo l'ultimo backup completo o incrementale vengano copiati in un supporto di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="6455c-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="6455c-121">Questo può includere interi file o intervalli specifici all'interno dei file.</span><span class="sxs-lookup"><span data-stu-id="6455c-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="6455c-122">Alcuni writer non consentono di combinare backup incrementali con backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="6455c-123">Se sono presenti file di log, è possibile che vengano troncati in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="6455c-124">Il ripristino di un backup incrementale richiede l'immagine di backup originale e tutte le immagini di backup incrementali effettuate dal backup iniziale.</span><span class="sxs-lookup"><span data-stu-id="6455c-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="6455c-125">Backup del log **( \_ \_ log di VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="6455c-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="6455c-126">Verrà eseguito il backup solo dei file di log del writer, ovvero i file aggiunti a un componente con il metodo [**IVssCreateWriterMetadata:: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) e recuperato da una chiamata a [**IVssWMComponent:: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile).</span><span class="sxs-lookup"><span data-stu-id="6455c-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="6455c-127">Questo tipo di backup è specifico per VSS.</span><span class="sxs-lookup"><span data-stu-id="6455c-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="6455c-128">I backup del log tendono a essere eseguiti con molta frequenza.</span><span class="sxs-lookup"><span data-stu-id="6455c-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="6455c-129">In genere, il file di log verrà troncato in seguito a questo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="6455c-130">Backup di copia **( \_ \_ copia di VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="6455c-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="6455c-131">Analogamente al \_ \_ tipo di backup completo VSS BT, verrà eseguito il backup dei file indipendentemente dalla data dell'ultimo backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="6455c-132">Tuttavia, la cronologia di backup di ogni file non verrà aggiornata e questo tipo di backup non può essere utilizzato come base per un backup incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="6455c-132">However, the backup history of each file will not be updated, and this type of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="6455c-133">I file di log non devono mai essere troncati come risultato di un backup di copia.</span><span class="sxs-lookup"><span data-stu-id="6455c-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="6455c-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Supporto file parziale</span><span class="sxs-lookup"><span data-stu-id="6455c-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="6455c-135">Alcuni writer supportano il ripristino dei file tramite la sovrascrittura delle parti dei file gestiti.</span><span class="sxs-lookup"><span data-stu-id="6455c-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="6455c-136">Un richiedente può essere progettato per trarre vantaggio da questo e, in caso affermativo, impostando le informazioni in [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="6455c-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="6455c-137">I writer indicano il tipo di backup supportati chiamando [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) durante l'elaborazione dell'evento di [*Identificazione*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="6455c-137">The writers indicate what type of backups are supported by calling [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) while processing the [*Identify*](vssgloss-i.md) event.</span></span> <span data-ttu-id="6455c-138">Il parametro *dsSchemaMask* per il metodo **IVssCreateWriterMetadata:: SetBackupSchema** è una maschera di bit che indica i tipi di backup supportati.</span><span class="sxs-lookup"><span data-stu-id="6455c-138">The *dsSchemaMask* parameter to the **IVssCreateWriterMetadata::SetBackupSchema** method is a bit mask indicating what types of backup are supported.</span></span> <span data-ttu-id="6455c-139">Tutti i writer devono supportare backup completi.</span><span class="sxs-lookup"><span data-stu-id="6455c-139">All writers must support full backups.</span></span>

<dl> <dt>

<span data-ttu-id="6455c-140"><span id="VSS_BS_DIFFERENTIAL"></span><span id="vss_bs_differential"></span>**\_differenziale di VSS BS \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-140"><span id="VSS_BS_DIFFERENTIAL"></span><span id="vss_bs_differential"></span>**VSS\_BS\_DIFFERENTIAL**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-141">Indica il supporto per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-141">Indicates support for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-142"><span id="VSS_BS_INCREMENTAL"></span><span id="vss_bs_incremental"></span>**\_ \_ incrementale BS VSS**</span><span class="sxs-lookup"><span data-stu-id="6455c-142"><span id="VSS_BS_INCREMENTAL"></span><span id="vss_bs_incremental"></span>**VSS\_BS\_INCREMENTAL**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-143">Indica il supporto per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="6455c-143">Indicates support for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-144"><span id="VSS_BS_LOG"></span><span id="vss_bs_log"></span>**LOG di VSS \_ BS \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-144"><span id="VSS_BS_LOG"></span><span id="vss_bs_log"></span>**VSS\_BS\_LOG**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-145">Indica il supporto per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="6455c-145">Indicates support for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-146"><span id="VSS_BS_COPY"></span><span id="vss_bs_copy"></span>**copia di VSS \_ BS \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-146"><span id="VSS_BS_COPY"></span><span id="vss_bs_copy"></span>**VSS\_BS\_COPY**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-147">Indica il supporto per i backup di copia.</span><span class="sxs-lookup"><span data-stu-id="6455c-147">Indicates support for copy backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-148"><span id="VSS_BS_EXCLUSIVE_INCREMENTAL_DIFFERENTIAL"></span><span id="vss_bs_exclusive_incremental_differential"></span>**\_ \_ \_ differenziale incrementale esclusivo VSS BS \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-148"><span id="VSS_BS_EXCLUSIVE_INCREMENTAL_DIFFERENTIAL"></span><span id="vss_bs_exclusive_incremental_differential"></span>**VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-149">Indica che un writer non supporta la combinazione di backup incrementali con backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-149">Indicates that a writer does not support mixing incremental backups with differential backups.</span></span>

</dd> </dl>

<span data-ttu-id="6455c-150">Il writer può determinare il tipo di backup da eseguire chiamando [**CVssWriter:: GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype).</span><span class="sxs-lookup"><span data-stu-id="6455c-150">The writer can determine what type of backup is being performed by calling [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype).</span></span> <span data-ttu-id="6455c-151">Il primo punto in cui può essere eseguito è durante l'elaborazione dell'evento PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="6455c-151">The earliest point when this can be performed is while processing the PrepareForBackup event.</span></span> <span data-ttu-id="6455c-152">**CVssWriter:: GetBackupType** restituirà un membro dell'enumerazione [**del \_ \_ tipo di backup VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_type) .</span><span class="sxs-lookup"><span data-stu-id="6455c-152">**CVssWriter::GetBackupType** will return a member of the [**VSS\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_backup_type) enumeration.</span></span> <span data-ttu-id="6455c-153">Se il tipo di backup non è supportato dal writer, il writer deve trattare il backup come backup completo.</span><span class="sxs-lookup"><span data-stu-id="6455c-153">If the backup type is not supported by the writer, then the writer should treat the backup as a full backup.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="6455c-154">Timbri di backup</span><span class="sxs-lookup"><span data-stu-id="6455c-154">Backup Stamps</span></span>

<span data-ttu-id="6455c-155">I backup incrementali e differenziali sono sempre associati a un backup precedente.</span><span class="sxs-lookup"><span data-stu-id="6455c-155">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="6455c-156">Esistono due modi per associare i backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-156">There are two ways to tie backups.</span></span> <span data-ttu-id="6455c-157">Per gli archivi dati semplici, il richiedente può tenere traccia della correlazione tra i backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-157">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="6455c-158">Tuttavia, per gli archivi dati più complessi, il writer dovrà mantenere il proprio timestamp con il backup; Questo timestamp può tenere traccia della posizione del log, delle informazioni sui checkpoint e così via.</span><span class="sxs-lookup"><span data-stu-id="6455c-158">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="6455c-159">Un writer indica che sono necessari timestamp personalizzati impostando il bit del **\_ \_ timestamp** del servizio Copia Shadow del volume BS quando chiama [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span><span class="sxs-lookup"><span data-stu-id="6455c-159">A writer indicates that it needs its own timestamps by setting the **VSS\_BS\_TIMESTAMPED** bit when it calls [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span></span>

<span data-ttu-id="6455c-160">Un writer può archiviare un timestamp con ogni componente di cui viene eseguito il backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-160">A writer can store a timestamp with each component that is being backed up.</span></span> <span data-ttu-id="6455c-161">Il writer archivia il timestamp chiamando [**IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)e passando una rappresentazione di stringa dell'indicatore per il parametro *wszBackupStamp* .</span><span class="sxs-lookup"><span data-stu-id="6455c-161">The writer stores the timestamp by calling [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp), and passing in a string representation of the stamp for the *wszBackupStamp* parameter.</span></span> <span data-ttu-id="6455c-162">In genere, un writer chiamerà questo metodo durante l'elaborazione dell'evento [*PostSnapshot*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="6455c-162">Generally, a writer will call this method while processing the [*PostSnapshot*](vssgloss-p.md) event.</span></span> <span data-ttu-id="6455c-163">Tuttavia, per i backup che non coinvolgono una copia shadow, l'evento PostSnapshot non verrà inviato.</span><span class="sxs-lookup"><span data-stu-id="6455c-163">However, for backups that do not involve a shadow copy, the PostSnapshot event will not be sent.</span></span> <span data-ttu-id="6455c-164">In questo caso, è necessario chiamare **IVssComponent:: SetBackupStamp** durante l'elaborazione dell'evento [*PrepareForBackup*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="6455c-164">In this case, **IVssComponent::SetBackupStamp** must be called while processing the [*PrepareForBackup*](vssgloss-p.md) event.</span></span>

<span data-ttu-id="6455c-165">Quando viene eseguito un backup incrementale o differenziale, il richiedente indicherà al writer l'indicatore di backup del backup precedente che funge da base per il backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-165">When an incremental or differential backup is being performed, the requester will indicate to the writer the backup stamp of the previous backup that is serving as a base for this backup.</span></span> <span data-ttu-id="6455c-166">Il writer può accedere a questo indicatore di backup precedente durante l'elaborazione dell'evento PrepareForBackup o PostSnapshot, chiamando [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="6455c-166">The writer can access this previous backup stamp while processing either the PrepareForBackup or PostSnapshot event, by calling [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span> <span data-ttu-id="6455c-167">Il writer può utilizzare il timbro restituito per determinare gli elementi di cui deve essere eseguito il backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-167">The writer can use the returned stamp to determine what needs to be backed up.</span></span>

## <a name="backup-strategies"></a><span data-ttu-id="6455c-168">Strategie di backup</span><span class="sxs-lookup"><span data-stu-id="6455c-168">Backup Strategies</span></span>

### <a name="file-backup-files-strategies"></a><span data-ttu-id="6455c-169">Strategie per i file di backup dei file</span><span class="sxs-lookup"><span data-stu-id="6455c-169">File Backup Files Strategies</span></span>

<span data-ttu-id="6455c-170">Spesso è necessario eseguire il backup di alcuni file segnalati nei metadati del writer solo quando si eseguono determinati tipi di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-170">Often, certain files reported in the writer metadata need only be backed up when performing certain types of backup.</span></span> <span data-ttu-id="6455c-171">È possibile che alcuni file siano necessari solo quando si esegue un backup completo.</span><span class="sxs-lookup"><span data-stu-id="6455c-171">Some files may only be required when performing a full backup.</span></span> <span data-ttu-id="6455c-172">Per eseguire un backup incrementale o differenziale è possibile che siano necessari altri file.</span><span class="sxs-lookup"><span data-stu-id="6455c-172">Other files may only be required when performing an incremental or differential backup.</span></span> <span data-ttu-id="6455c-173">VSS fornisce un metodo affinché i writer indichino queste informazioni al richiedente.</span><span class="sxs-lookup"><span data-stu-id="6455c-173">VSS provides a method for the writers to indicate this information to the requester.</span></span> <span data-ttu-id="6455c-174">Quando si aggiungono file ai componenti usando [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)o [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), il parametro *dwBackupTypeMask* indica per quali tipi di backup è necessario eseguire il backup di questi file.</span><span class="sxs-lookup"><span data-stu-id="6455c-174">When adding files to components using [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), the *dwBackupTypeMask* parameter indicates for which backup types these files must be backed up.</span></span> <span data-ttu-id="6455c-175">La maschera può contenere uno o più dei valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="6455c-175">The mask can contain one or more of the following values:</span></span>

<dl> <dt>

<span data-ttu-id="6455c-176"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**\_ \_ backup completo VSS \_ FSBT \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="6455c-176"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-177">Obbligatorio per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="6455c-177">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-178"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**è \_ \_ necessario il \_ backup DIFFERENZIAle FSBT VSS \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-178"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-179">Obbligatorio per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-179">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-180"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**è \_ \_ necessario il backup incrementale FSBT VSS \_ \_**</span><span class="sxs-lookup"><span data-stu-id="6455c-180"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-181">Obbligatorio per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="6455c-181">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-182"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**\_backup del \_ log FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="6455c-182"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-183">Obbligatorio per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="6455c-183">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-184"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS \_ FSBT \_ tutti i \_ backup \_ necessari**</span><span class="sxs-lookup"><span data-stu-id="6455c-184"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-185">Obbligatorio per tutti i tipi di backup; si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="6455c-185">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="6455c-186">Questa specifica esegue l'override della specifica di selettività del componente.</span><span class="sxs-lookup"><span data-stu-id="6455c-186">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="6455c-187">Si consideri, ad esempio, un componente i cui file sono tutti contrassegnati con il **\_ backup del log VSS FSBT \_ \_ \_ richiesto** , ma non con il **\_ \_ backup completo VSS FSBT \_ \_ obbligatorio**.</span><span class="sxs-lookup"><span data-stu-id="6455c-187">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="6455c-188">Si supponga che il componente non sia selezionabile per il backup (*bSelectable* è false quando [**IVssCreateWriterMetadata:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) è stato chiamato).</span><span class="sxs-lookup"><span data-stu-id="6455c-188">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="6455c-189">Nel caso di un backup del log, significa che è necessario eseguire sempre il backup di tutti i file di questo componente.</span><span class="sxs-lookup"><span data-stu-id="6455c-189">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="6455c-190">Tuttavia, nel caso di un backup completo, non è necessario eseguire il backup di nessuno dei file, nonostante il fatto che la selettività del componente ne implichi il backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-190">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="6455c-191">Ora dell'Ultima modifica del backup</span><span class="sxs-lookup"><span data-stu-id="6455c-191">Backup By Last Modify Time</span></span>

<span data-ttu-id="6455c-192">Un metodo per un writer per indicare quali file sono stati modificati consiste nell'usare il meccanismo di file differenziato.</span><span class="sxs-lookup"><span data-stu-id="6455c-192">One way for a writer to indicate what files have changed is by using the differenced file mechanism.</span></span> <span data-ttu-id="6455c-193">Un writer può specificare che è necessario eseguire il backup di determinati file di un componente solo se sono stati modificati da un determinato periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="6455c-193">A writer can specify that certain files in a component should only be backed up if they have been modified since a certain time.</span></span> <span data-ttu-id="6455c-194">Il writer chiama [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) con una specifica del file e l'ora dell'Ultima modifica.</span><span class="sxs-lookup"><span data-stu-id="6455c-194">The writer calls [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) with a file specification and a last modify time.</span></span> <span data-ttu-id="6455c-195">**IVssComponent:: AddDifferencedFilesByLastModifyTime** viene in genere chiamato durante l'elaborazione dell'evento PostSnapshot, sebbene possa essere chiamato durante l'elaborazione dell'evento PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="6455c-195">**IVssComponent::AddDifferencedFilesByLastModifyTime** is typically called while processing the PostSnapshot event, although it can be called while processing the PrepareForBackup event.</span></span> <span data-ttu-id="6455c-196">Il richiedente deve quindi eseguire il backup di tutti i file che corrispondono alla specifica del file che sono stati modificati dall'ora specificata.</span><span class="sxs-lookup"><span data-stu-id="6455c-196">The requester must then back up all files matching the file specification that have changed since the specified time.</span></span> <span data-ttu-id="6455c-197">Se il writer utilizza il meccanismo del timbro di backup, l'ora dell'Ultima modifica verrà determinata in base all'indicatore di backup precedente nel documento di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-197">If the writer is using the backup stamp mechanism, this last modify time will be determined based on the previous backup stamp in the backup document.</span></span> <span data-ttu-id="6455c-198">Il writer può anche passare zero per l'ora dell'Ultima modifica, che indica che il richiedente è responsabile della determinazione dell'ora dell'ultimo backup e dei file modificati da quel momento.</span><span class="sxs-lookup"><span data-stu-id="6455c-198">The writer can also pass in zero for the last modify time, which indicates that the requester is responsible for determining the time of the last backup and the files changed since that time.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="6455c-199">Backup parziale dei file</span><span class="sxs-lookup"><span data-stu-id="6455c-199">Partial File Backup</span></span>

<span data-ttu-id="6455c-200">Un altro modo affinché un writer indichi modifiche al richiedente consiste nell'usare il meccanismo di file parziale.</span><span class="sxs-lookup"><span data-stu-id="6455c-200">Another way for a writer to indicate changes to the requester is by using the partial-file mechanism.</span></span> <span data-ttu-id="6455c-201">Un writer può specificare intervalli di byte nei file di componente di cui è necessario eseguire il backup; il writer può specificare questi intervalli di file durante l'elaborazione dell'evento PostSnapshot o PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="6455c-201">A writer can specify byte ranges within component files that need to be backed up; the writer may specify these file ranges while processing either the PostSnapshot or PrepareForBackup event.</span></span> <span data-ttu-id="6455c-202">Il writer chiama [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) per aggiungere specifiche di file parziali al backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-202">The writer calls [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) to add partial file specifications to the backup.</span></span> <span data-ttu-id="6455c-203">Una specifica del file parziale è costituita da un percorso e un nome file con informazioni sugli intervalli nel file di cui è necessario eseguire il backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-203">A partial file specification consists of a path and file name together with information about what ranges in the file need to be backed up.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="6455c-204">Regole specifiche file</span><span class="sxs-lookup"><span data-stu-id="6455c-204">File Specification Rules</span></span>

<span data-ttu-id="6455c-205">È possibile usare [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) o [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) per modificare le specifiche del file specificate durante l'evento di identificazione o per aggiungere file completamente nuovi alla specifica.</span><span class="sxs-lookup"><span data-stu-id="6455c-205">[**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) or [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) can both be used to modify file specifications given during the Identify event, or to add completely new files to the specification.</span></span> <span data-ttu-id="6455c-206">Se il writer sta modificando il set di informazioni durante l'evento di identificazione usando **IVssComponent:: AddDifferencedFilesByLastModifyTime**, la specifica del file deve corrispondere esattamente a una delle specifiche del file nel componente corrente.</span><span class="sxs-lookup"><span data-stu-id="6455c-206">If the writer is modifying information set during the Identify event using **IVssComponent::AddDifferencedFilesByLastModifyTime**, then the file specification must exactly match one of the file specifications in the current component.</span></span> <span data-ttu-id="6455c-207">La specifica del file non deve sovrapporsi parzialmente ai file nel componente corrente e non deve corrispondere ai file in altri componenti.</span><span class="sxs-lookup"><span data-stu-id="6455c-207">The file specification must not partially overlap files in the current component, and it must not match files in any other components.</span></span> <span data-ttu-id="6455c-208">I file specificati con **IVssComponent:: AddPartialFile** possono, tuttavia, sovrapporsi parzialmente a un'altra specifica di file.</span><span class="sxs-lookup"><span data-stu-id="6455c-208">Files specified using **IVssComponent::AddPartialFile** can, however, partially overlap another file specification.</span></span> <span data-ttu-id="6455c-209">Le informazioni impostate da **IVssComponent:: AddDifferencedFilesByLastModifyTime** o **IVssComponent:: AddPartialFile** eseguono l'override delle informazioni impostate in precedenza tramite l'interfaccia [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) in risposta all'evento di identificazione.</span><span class="sxs-lookup"><span data-stu-id="6455c-209">Information set by **IVssComponent::AddDifferencedFilesByLastModifyTime** or **IVssComponent::AddPartialFile** overrides the information set earlier using the [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) interface in response to the Identify event.</span></span>

<span data-ttu-id="6455c-210">Le specifiche di file generali possono avere un valore di percorso alternativo (impostato dal parametro *wszAlternateLocation* di [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) che indica un percorso alternativo da cui ottenere il file in fase di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-210">General file specifications can have an alternate-location value (set by the *wszAlternateLocation* parameter of [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) that indicates an alternate location to obtain the file from at backup time.</span></span> <span data-ttu-id="6455c-211">Se la specifica del file impostata tramite i meccanismi del file differenziato o del file parziale corrisponde a una specifica del file esistente con un percorso alternativo, l'applicazione di backup otterrà i dati da questo percorso alternativo.</span><span class="sxs-lookup"><span data-stu-id="6455c-211">If the file specification set through the differenced-file or partial-file mechanisms matches an existing file specification that has an alternate location, the backup application will obtain the data from this alternate location.</span></span>

<span data-ttu-id="6455c-212">Se il set di specifiche di file in [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) o [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) non corrisponde a e ai file nel componente di cui viene eseguito il backup, tutti i file corrispondenti verranno aggiunti al backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-212">If the file specification set in [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) or in [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) does not match and files in the component that are being backed up, then all matching files are now added to the backup.</span></span> <span data-ttu-id="6455c-213">È necessario prestare attenzione che il writer aggiunga solo i file presenti in un volume di cui è già stata eseguita la copia shadow. in caso contrario, il richiedente potrebbe non riuscire a eseguire il backup di questi file.</span><span class="sxs-lookup"><span data-stu-id="6455c-213">Care must be taken that the writer only adds files that exist on a volume that is already being shadow copied while doing this; otherwise, the requester may fail to back up these files.</span></span> <span data-ttu-id="6455c-214">Se queste funzioni vengono chiamate durante l'elaborazione dell'evento PostSnapshot, questo può essere determinato tramite il metodo [**CVssWriter:: IsPathAffected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispathaffected) .</span><span class="sxs-lookup"><span data-stu-id="6455c-214">If these functions are called while processing the PostSnapshot event, this can be determined by using the [**CVssWriter::IsPathAffected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispathaffected) method.</span></span> <span data-ttu-id="6455c-215">Se chiamato durante la gestione dell'evento PrepareForBackup, il writer deve effettuare questa determinazione usando un altro metodo.</span><span class="sxs-lookup"><span data-stu-id="6455c-215">If called while handling the PrepareForBackup event, the writer must make this determination using another method.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="6455c-216">Backup senza copia shadow</span><span class="sxs-lookup"><span data-stu-id="6455c-216">Backup Without a Shadow Copy</span></span>

<span data-ttu-id="6455c-217">Potrebbe non essere necessario eseguire il backup di alcuni tipi di file da un volume di copia shadow.</span><span class="sxs-lookup"><span data-stu-id="6455c-217">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="6455c-218">Questo, ad esempio, sarà spesso vero per i file di log del database.</span><span class="sxs-lookup"><span data-stu-id="6455c-218">For example, this will often be true of database log files.</span></span> <span data-ttu-id="6455c-219">Poiché i file di log aumentano in modo progressivo e un writer può specificare esattamente le parti del file di cui eseguire il backup usando file parziali, è spesso possibile eseguire il backup della disconnessione dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="6455c-219">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to back up the log off the original volume.</span></span> <span data-ttu-id="6455c-220">Come ottimizzazione, un writer può contrassegnare i file che richiedono copie shadow per diversi tipi di backup usando i flag impostati nel parametro *dwBackupTypeMask* di [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)o [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span><span class="sxs-lookup"><span data-stu-id="6455c-220">As an optimization, a writer can mark which files require shadow copies for different backup types using the flags set in the *dwBackupTypeMask* parameter of [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span></span> <span data-ttu-id="6455c-221">I flag supportati sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="6455c-221">Supported flags include the following:</span></span>

<dl> <dt>

<span data-ttu-id="6455c-222"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**\_ \_ snapshot completo VSS \_ FSBT \_ necessario**</span><span class="sxs-lookup"><span data-stu-id="6455c-222"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-223">Copia shadow necessaria per i backup completi.</span><span class="sxs-lookup"><span data-stu-id="6455c-223">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-224"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**\_ \_ snapshot differenziale FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="6455c-224"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-225">Copia shadow necessaria per i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-225">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-226"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**\_ \_ snapshot incrementale FSBT \_ VSS \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="6455c-226"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-227">Copia shadow necessaria per i backup incrementali.</span><span class="sxs-lookup"><span data-stu-id="6455c-227">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-228"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**\_snapshot del \_ log FSBT VSS \_ \_ obbligatorio**</span><span class="sxs-lookup"><span data-stu-id="6455c-228"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-229">Copia shadow necessaria per i backup del log.</span><span class="sxs-lookup"><span data-stu-id="6455c-229">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="6455c-230"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS \_ FSBT \_ tutti gli \_ snapshot \_ necessari**</span><span class="sxs-lookup"><span data-stu-id="6455c-230"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="6455c-231">Copia shadow necessaria per tutti i tipi di backup; si tratta dell'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="6455c-231">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="6455c-232">Se un volume specifico contiene solo componenti che non richiedono una copia shadow per questo backup, il richiedente può ignorare il passaggio della creazione di una copia shadow per questo volume.</span><span class="sxs-lookup"><span data-stu-id="6455c-232">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="6455c-233">Tutti i dati di questo volume possono essere copiati nel supporto di backup direttamente dal volume originale.</span><span class="sxs-lookup"><span data-stu-id="6455c-233">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="backup-cleanup"></a><span data-ttu-id="6455c-234">Pulitura backup</span><span class="sxs-lookup"><span data-stu-id="6455c-234">Backup Cleanup</span></span>

<span data-ttu-id="6455c-235">Se il writer deve eseguire un troncamento del log o un'altra pulitura successiva al backup, il posto appropriato è durante l'elaborazione dell'evento [*BackupComplete*](vssgloss-b.md) .</span><span class="sxs-lookup"><span data-stu-id="6455c-235">If the writer needs to perform log truncation or other post-backup cleanup, the proper place to do this is while processing the [*BackupComplete*](vssgloss-b.md) event.</span></span> <span data-ttu-id="6455c-236">L'evento [*BackupShutdown*](vssgloss-b.md) verrà inviato un po' di tempo dopo BackupComplete, quindi alcune operazioni di pulizia possono essere eseguite anche nel gestore dell'evento BackupShutdown.</span><span class="sxs-lookup"><span data-stu-id="6455c-236">The [*BackupShutdown*](vssgloss-b.md) event will be sent some time after BackupComplete, so some cleanup may also be done in the BackupShutdown event handler.</span></span>

<span data-ttu-id="6455c-237">L'evento BackupShutdown viene sempre inviato dopo la terminazione di un backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-237">The BackupShutdown event is always sent after termination of a backup.</span></span> <span data-ttu-id="6455c-238">Se il richiedente termina in modo anomalo durante l'esecuzione di un backup, BackupShutdown verrà inviato immediatamente, senza prima inviare BackupComplete.</span><span class="sxs-lookup"><span data-stu-id="6455c-238">If the requester terminates abnormally while performing a backup, BackupShutdown will be sent immediately, without first sending BackupComplete.</span></span> <span data-ttu-id="6455c-239">Se il writer deve eseguire la pulizia di qualsiasi stato, è possibile eseguire questa operazione. il troncamento del log non dovrebbe tuttavia verificarsi in questo evento perché il backup non è stato necessariamente completato.</span><span class="sxs-lookup"><span data-stu-id="6455c-239">If the writer needs to clean up any state, that may be done here; however, log truncation should not happen in this event because the backup did not necessarily complete.</span></span>

## <a name="restore-strategies"></a><span data-ttu-id="6455c-240">Strategie di ripristino</span><span class="sxs-lookup"><span data-stu-id="6455c-240">Restore Strategies</span></span>

<span data-ttu-id="6455c-241">Le attività di base dei writer in fase di ripristino sono la verifica che il ripristino possa verificarsi durante la gestione dell'evento di preripristino e che il ripristino si sia verificato durante la gestione dell'evento PostRestore.</span><span class="sxs-lookup"><span data-stu-id="6455c-241">The basic tasks of writers at restore are to verify that the restore can happen in handling the PreRestore event, and that the restore has happened in handling the PostRestore event.</span></span> <span data-ttu-id="6455c-242">Gli archivi più complessi eseguiranno anche un processo di ripristino nel gestore PostRestore.</span><span class="sxs-lookup"><span data-stu-id="6455c-242">More complex stores will also perform a recovery process in the PostRestore handler.</span></span> <span data-ttu-id="6455c-243">Se il ripristino fa parte di un ripristino incrementale o differenziale, il writer desidera in genere ritardare il processo di ripristino fino a quando non vengono completati tutti i ripristini incrementali o differenziali.</span><span class="sxs-lookup"><span data-stu-id="6455c-243">If the restore is part of an incremental or differential restore, the writer will generally want to delay this recovery process until all incremental or differential restores have been completed.</span></span> <span data-ttu-id="6455c-244">[**IVssComponent:: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) indicherà se si tratta del ripristino finale di questo componente o se sono presenti più ripristini da passare.</span><span class="sxs-lookup"><span data-stu-id="6455c-244">[**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) will indicate whether this is the final restore of this component, or whether there are more restores to come.</span></span> <span data-ttu-id="6455c-245">Se **IVssComponent:: GetAdditionalRestores** restituisce **true**, il writer non deve eseguire la relativa procedura di recupero su tale componente.</span><span class="sxs-lookup"><span data-stu-id="6455c-245">If **IVssComponent::GetAdditionalRestores** returns **true**, the writer should not perform its recovery procedure on that component.</span></span>

## <a name="new-targets"></a><span data-ttu-id="6455c-246">Nuove destinazioni</span><span class="sxs-lookup"><span data-stu-id="6455c-246">New Targets</span></span>

<span data-ttu-id="6455c-247">Se supportato dal writer, il richiedente può ripristinare i file di dati in un percorso diverso da quello originale in fase di backup.</span><span class="sxs-lookup"><span data-stu-id="6455c-247">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="6455c-248">Un writer indica il supporto per questa modalità di ripristino impostando il writer del servizio Copia Shadow del volume, supporta il nuovo bit di **\_ \_ \_ \_ \_ destinazione** nel parametro *DsSchemaMask* durante la chiamata a [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span><span class="sxs-lookup"><span data-stu-id="6455c-248">A writer indicates support for this restore mode by setting the **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit in the *dsSchemaMask* parameter when calling [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span></span> <span data-ttu-id="6455c-249">Un writer ottiene i nuovi percorsi per i file dei componenti in fase di ripristino chiamando [**IVssComponent:: GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) e [**IVssComponent:: GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget).</span><span class="sxs-lookup"><span data-stu-id="6455c-249">A writer obtains the new locations for component files at restore time by calling [**IVssComponent::GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) and [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget).</span></span>

## <a name="directed-targets"></a><span data-ttu-id="6455c-250">Destinazioni dirette</span><span class="sxs-lookup"><span data-stu-id="6455c-250">Directed Targets</span></span>

<span data-ttu-id="6455c-251">Per gli scenari di ripristino complessi, un writer potrebbe voler eseguire il mapping degli intervalli di un file di cui è stato eseguito il backup in intervalli diversi dello stesso file o di un file diverso.</span><span class="sxs-lookup"><span data-stu-id="6455c-251">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="6455c-252">A tale scopo, è possibile usare il meccanismo di destinazione diretto.</span><span class="sxs-lookup"><span data-stu-id="6455c-252">This can be done by using the directed-target mechanism.</span></span> <span data-ttu-id="6455c-253">A tale scopo, un writer deve prima indicare che questa situazione si verifica chiamando [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), passando in **VSS \_ RT \_ indirizzato** per il parametro di *destinazione* .</span><span class="sxs-lookup"><span data-stu-id="6455c-253">To do this, a writer must first indicate this is happening by calling [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), passing in **VSS\_RT\_DIRECTED** for the *target* parameter.</span></span> <span data-ttu-id="6455c-254">Quindi, per ogni mapping, il writer chiama [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="6455c-254">Then, for each mapping, the writer calls [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).</span></span> <span data-ttu-id="6455c-255">Questo metodo accetta il percorso completo di un file di origine nel backup e il percorso completo di un file di destinazione in cui verrà ripristinato.</span><span class="sxs-lookup"><span data-stu-id="6455c-255">This method takes a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="6455c-256">Accetta inoltre un elenco di intervalli per ognuno di questi file.</span><span class="sxs-lookup"><span data-stu-id="6455c-256">It also takes a ranges list for each of these files.</span></span> <span data-ttu-id="6455c-257">Il writer chiama queste funzioni durante la gestione dell'evento di preripristino e il richiedente è quindi responsabile del ripristino degli intervalli specificati nel file di origine agli intervalli mappati nel file di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6455c-257">The writer calls these functions while handling the PreRestore event, and the requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="6455c-258">Il formato della stringa degli intervalli è identico a quello di [ **IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)</span><span class="sxs-lookup"><span data-stu-id="6455c-258">The format of the ranges string is the same as in [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)</span></span>

## <a name="private-writer-metadata"></a><span data-ttu-id="6455c-259">Metadati del writer privato</span><span class="sxs-lookup"><span data-stu-id="6455c-259">Private Writer Metadata</span></span>

<span data-ttu-id="6455c-260">Spesso è utile per un writer mantenere i metadati privati con un backup per eseguire correttamente un ripristino incrementale o differenziale.</span><span class="sxs-lookup"><span data-stu-id="6455c-260">It is often useful for a writer to maintain private metadata with a backup to properly perform an incremental or differential restore.</span></span> <span data-ttu-id="6455c-261">Un writer può chiamare [**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) durante la gestione di PrepareForBackup o PostSnapshot per archiviare i metadati.</span><span class="sxs-lookup"><span data-stu-id="6455c-261">A writer may call [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) while handling either PrepareForBackup or PostSnapshot to store metadata.</span></span> <span data-ttu-id="6455c-262">È possibile accedere a questi metadati dal writer durante il preripristino o dopo il ripristino chiamando [**IVssComponent:: GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata).</span><span class="sxs-lookup"><span data-stu-id="6455c-262">This metadata can be accessed by the writer during either PreRestore or PostRestore by calling [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata).</span></span> <span data-ttu-id="6455c-263">I metadati possono anche essere archiviati con una specifica del file parziale usando il parametro *wszMetadata* di [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile); è possibile accedere a questi metadati tramite il parametro *pbstrMetadata* di [**IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="6455c-263">Metadata can also be stored with partial file specification by using the *wszMetadata* parameter of [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile); this metadata is accessed through the *pbstrMetadata* parameter of [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="6455c-264">Il writer può anche passare i metadati a se stesso tra [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) e [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore).</span><span class="sxs-lookup"><span data-stu-id="6455c-264">The writer can also pass metadata to itself between [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) and [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore).</span></span> <span data-ttu-id="6455c-265">In **CVssWriter:: OnPreRestore** i metadati vengono impostati chiamando [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata).</span><span class="sxs-lookup"><span data-stu-id="6455c-265">In **CVssWriter::OnPreRestore**, the metadata is set by calling [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata).</span></span> <span data-ttu-id="6455c-266">In **CVssWriter:: OnPostRestore** i metadati vengono recuperati chiamando [**IVssComponent:: GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata).</span><span class="sxs-lookup"><span data-stu-id="6455c-266">In **CVssWriter::OnPostRestore**, the metadata is retrieved by calling [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata).</span></span>

-   [<span data-ttu-id="6455c-267">Ruolo writer nei backup incrementali e differenziali VSS</span><span class="sxs-lookup"><span data-stu-id="6455c-267">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="6455c-268">Ruolo del richiedente nei backup incrementali e differenziali VSS</span><span class="sxs-lookup"><span data-stu-id="6455c-268">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 



