---
description: "Questa fase del backup Inizializza sia il writer che il richiedente, compilando le strutture di dati interne, specificando il backup e stabilisce la comunicazione del writer/richiedente tramite la chiamata obbligatoria a IVssBackupComponents:: GatherWriterMetadata. Per ulteriori informazioni, vedere Cenni preliminari sull'elaborazione di un backup in VSS."
ms.assetid: 1fc46062-c4a0-4aa2-ae05-3d7cded18584
title: Panoramica dell'inizializzazione del backup
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53fb97b43cf19ca60e3e4601899700e35bdad3aa
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310691"
---
# <a name="overview-of-backup-initialization"></a><span data-ttu-id="122fc-104">Panoramica dell'inizializzazione del backup</span><span class="sxs-lookup"><span data-stu-id="122fc-104">Overview of Backup Initialization</span></span>

<span data-ttu-id="122fc-105">Questa fase del backup Inizializza sia il writer che il richiedente, compilando le strutture di dati interne, specificando il backup e stabilisce la comunicazione del writer/richiedente tramite la chiamata obbligatoria a [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="122fc-105">This stage of the backup initializes both the writer and the requester, filling in their internal data structures, specifying the backup and establishes writer/requester communication through the required call to [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="122fc-106">Per ulteriori informazioni, vedere [Cenni preliminari sull'elaborazione di un backup in VSS](overview-of-processing-a-backup-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="122fc-106">For more information, see [Overview of Processing a Backup Under VSS](overview-of-processing-a-backup-under-vss.md).</span></span>

<span data-ttu-id="122fc-107">Nella tabella seguente viene illustrata la sequenza di azioni ed eventi necessari per l'inizializzazione del backup.</span><span class="sxs-lookup"><span data-stu-id="122fc-107">The following table shows the sequence of actions and events that are required for backup initialization.</span></span>



| <span data-ttu-id="122fc-108">Azione del richiedente</span><span class="sxs-lookup"><span data-stu-id="122fc-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                                            | <span data-ttu-id="122fc-109">Evento</span><span class="sxs-lookup"><span data-stu-id="122fc-109">Event</span></span>                                                     | <span data-ttu-id="122fc-110">Azione del writer</span><span class="sxs-lookup"><span data-stu-id="122fc-110">Writer action</span></span>                                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="122fc-111">Crea un'interfaccia [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) e la inizializza per gestire un backup (vedere [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents:: InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup)) e, facoltativamente, abilitare o disabilitare i writer nel sistema.</span><span class="sxs-lookup"><span data-stu-id="122fc-111">Creates an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface and initializes it to manage a backup (see [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup)) and optionally enable or disable writers on the system.</span></span> | <span data-ttu-id="122fc-112">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-112">None</span></span>                                                      | <span data-ttu-id="122fc-113">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-113">None</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="122fc-114">Facoltativamente, impostare il contesto per le operazioni di copia shadow e, facoltativamente, eseguire una query sul sistema sui provider e sulle copie shadow supportate. vedere [**IVssBackupComponents:: secontext**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setcontext), [**IVssBackupComponents:: query**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-query).</span><span class="sxs-lookup"><span data-stu-id="122fc-114">Optionally set the context for shadow copy operations and optionally query the system about the providers and shadow copies it supports (see [**IVssBackupComponents::SetContext**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setcontext), [**IVssBackupComponents::Query**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-query)).</span></span>                                               | <span data-ttu-id="122fc-115">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-115">None</span></span>                                                      | <span data-ttu-id="122fc-116">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-116">None</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="122fc-117">Il richiedente pu√≤ fornire ulteriori informazioni sulla gestione delle operazioni di backup e ripristino (vedere [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate))</span><span class="sxs-lookup"><span data-stu-id="122fc-117">The requester can provide additional information on handling backup and restore operations (see [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate))</span></span>                                                                                                                                                        | <span data-ttu-id="122fc-118">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-118">None</span></span>                                                      | <span data-ttu-id="122fc-119">nessuno</span><span class="sxs-lookup"><span data-stu-id="122fc-119">None</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="122fc-120">Avvia il contatto asincrono con i writer (vedere [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata))</span><span class="sxs-lookup"><span data-stu-id="122fc-120">Initiates asynchronous contact with writers (see [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata))</span></span>                                                                                                                                                                                           | [<span data-ttu-id="122fc-121">*Identificare*</span><span class="sxs-lookup"><span data-stu-id="122fc-121">*Identify*</span></span>](vssgloss-i.md) | <span data-ttu-id="122fc-122">Crea un documento di metadati del writer (vedere [utilizzo del documento di metadati del writer](working-with-the-writer-metadata-document.md), [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata))</span><span class="sxs-lookup"><span data-stu-id="122fc-122">Creates a Writer Metadata Document (see [Working with the Writer Metadata Document](working-with-the-writer-metadata-document.md), [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata))</span></span> |



 

## <a name="requester-actions-during-backup-initialization"></a><span data-ttu-id="122fc-123">Azioni del richiedente durante l'inizializzazione del backup</span><span class="sxs-lookup"><span data-stu-id="122fc-123">Requester Actions during Backup Initialization</span></span>

<span data-ttu-id="122fc-124">Un oggetto [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) pu√≤ essere utilizzato solo per un backup.</span><span class="sxs-lookup"><span data-stu-id="122fc-124">An [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) object can be used for only one backup.</span></span> <span data-ttu-id="122fc-125">Pertanto, un richiedente deve procedere fino alla fine del backup, incluso il rilascio dell'interfaccia **IVssBackupComponents** .</span><span class="sxs-lookup"><span data-stu-id="122fc-125">Therefore, a requester must proceed through to the end of the backup, including releasing the **IVssBackupComponents** interface.</span></span> <span data-ttu-id="122fc-126">Se il backup deve terminare in modo anomalo, il richiedente deve chiamare [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) e quindi rilasciare l'oggetto **IVssBackupComponents** . per ulteriori informazioni, vedere l' [interruzione delle operazioni VSS](aborting-vss-operations.md) .</span><span class="sxs-lookup"><span data-stu-id="122fc-126">If the backup needs to terminate prematurely, the requester needs to call [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup) and then release the **IVssBackupComponents** object (see [Aborting VSS Operations](aborting-vss-operations.md) for more information).</span></span> <span data-ttu-id="122fc-127">Non tentare di riprendere l'interfaccia **IVssBackupComponents** .</span><span class="sxs-lookup"><span data-stu-id="122fc-127">Do not attempt to resume the **IVssBackupComponents** interface.</span></span>

<span data-ttu-id="122fc-128">In genere, il documento dei componenti di backup di un richiedente viene inizializzato come vuoto.</span><span class="sxs-lookup"><span data-stu-id="122fc-128">Typically, a requester's Backup Components Document is initialized as empty.</span></span> <span data-ttu-id="122fc-129">Un documento dei componenti di backup archiviato pu√≤ essere caricato quando viene chiamato [**IVssBackupComponents:: InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup) , in genere supportato da volumi di copie shadow trasportabili.</span><span class="sxs-lookup"><span data-stu-id="122fc-129">A stored Backup Components Document can be loaded when [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup) is called, typically in support of transportable shadow copied volumes.</span></span> <span data-ttu-id="122fc-130">In questo caso, la comunicazione del richiedente Writer sar√† leggermente diversa da quella descritta di seguito.</span><span class="sxs-lookup"><span data-stu-id="122fc-130">In this case, the writer-requester communication will be somewhat different than what is described below.</span></span> <span data-ttu-id="122fc-131">Per ulteriori informazioni, vedere [importazione di volumi di copie shadow trasportabili](importing-transportable-shadow-copied-volumes.md) .</span><span class="sxs-lookup"><span data-stu-id="122fc-131">(See [Importing Transportable Shadow Copied Volumes](importing-transportable-shadow-copied-volumes.md) for more information.)</span></span>

<span data-ttu-id="122fc-132">Per aggiungere volumi al set di copie shadow, un richiedente deve innanzitutto impostare il contesto per l'operazione di copia shadow chiamando [**IVssBackupComponents:: secontext**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setcontext).</span><span class="sxs-lookup"><span data-stu-id="122fc-132">To add volumes to the shadow copy set, a requester must first set the context for the shadow copy operation by calling [**IVssBackupComponents::SetContext**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setcontext).</span></span> <span data-ttu-id="122fc-133">Se questo metodo non viene chiamato, viene utilizzato il contesto predefinito per le copie shadow, \_ ovvero il backup VSS CTX \_ .</span><span class="sxs-lookup"><span data-stu-id="122fc-133">If this method is not called, the default context for shadow copies, VSS\_CTX\_BACKUP, is used.</span></span> <span data-ttu-id="122fc-134">Per informazioni sull'impostazione del contesto della copia shadow, vedere configurazioni del contesto per la [Copia Shadow](shadow-copy-context-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="122fc-134">For information about setting the shadow copy context, see [Shadow Copy Context Configurations](shadow-copy-context-configurations.md).</span></span>

<span data-ttu-id="122fc-135">Per iniziare il completamento della configurazione prima del backup, un richiedente deve chiamare [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="122fc-135">To begin the completion of its setup prior to backup, a requester must call [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="122fc-136">In questo modo, un richiedente indica ai writer:</span><span class="sxs-lookup"><span data-stu-id="122fc-136">By doing this, a requester indicates to the writers:</span></span>

-   <span data-ttu-id="122fc-137">Tipo di backup (come definito nel [**tipo di \_ backup \_ VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_type))</span><span class="sxs-lookup"><span data-stu-id="122fc-137">The type of backup (as defined in [**VSS\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_backup_type))</span></span>
-   <span data-ttu-id="122fc-138">Indica se il backup include uno stato del sistema di avvio</span><span class="sxs-lookup"><span data-stu-id="122fc-138">Whether the backup includes a bootable system state</span></span>
-   <span data-ttu-id="122fc-139">Indica se il richiedente supporta la selezione di singoli componenti o esegue il backup di interi volumi.</span><span class="sxs-lookup"><span data-stu-id="122fc-139">Whether the requester supports the selection of individual components or backs up entire volumes.</span></span>

<span data-ttu-id="122fc-140">Tutti i richiedenti che partecipano alle operazioni di backup e ripristino devono chiamare sempre [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="122fc-140">All requesters participating in backup and restore operations must always call [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="122fc-141">Questo metodo avvia la comunicazione del richiedente del writer generando un evento di [*Identificazione*](vssgloss-i.md) VSS, in risposta al quale un writer crea il documento di metadati.</span><span class="sxs-lookup"><span data-stu-id="122fc-141">This method initiates writer-requester communication by generating a VSS [*Identify*](vssgloss-i.md) event, in response to which a writer creates its metadata document.</span></span>

<span data-ttu-id="122fc-142">Prima di chiamare [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), un richiedente ha la possibilit√† di abilitare o disabilitare esplicitamente determinati writer e classi writer specifiche usando [**IVssBackupComponents:: EnableWriterClasses**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-enablewriterclasses), [**IVssBackupComponents::D Isablewriterinstances**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-disablewriterinstances)e [**IVssBackupComponents::D isablewriterclasses**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-disablewriterclasses) (per impostazione predefinita, tutte le classi sono abilitate).</span><span class="sxs-lookup"><span data-stu-id="122fc-142">Prior to calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), a requester has an opportunity to explicitly enable or disable certain specific writers and writer classes using [**IVssBackupComponents::EnableWriterClasses**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-enablewriterclasses), [**IVssBackupComponents::DisableWriterInstances**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-disablewriterinstances), and [**IVssBackupComponents::DisableWriterClasses**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-disablewriterclasses) (by default, all classes are enabled).</span></span> <span data-ttu-id="122fc-143">Dopo la chiamata di **IVssBackupComponents:: GatherWriterMetadata** , queste chiamate non hanno alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="122fc-143">After **IVssBackupComponents::GatherWriterMetadata** is called, these calls have no effect.</span></span>

<span data-ttu-id="122fc-144">Poich√© non esiste alcun modo per ottenere un elenco di writer nel sistema prima di chiamare [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), i richiedenti possono prendere in considerazione la creazione e l'eliminazione di una seconda istanza di [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) per ottenere l'elenco.</span><span class="sxs-lookup"><span data-stu-id="122fc-144">Because there is no way to obtain a list of writers on the system prior to calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), requesters may consider creating and then deleting a second instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) to obtain the list.</span></span>

<span data-ttu-id="122fc-145">Non √® necessario chiamare [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) dopo il completamento di [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="122fc-145">It is not necessary to call [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) following the completion of [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="122fc-146">I writer che non riescono a elaborare l'evento di [*Identificazione*](vssgloss-i.md) generato dalle chiamate non faranno parte dell'elenco di writer che forniscono i metadati trovati da [**IVssBackupComponents:: GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) e [**IVssBackupComponents:: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (vedere [determinare lo stato del writer](determining-writer-status.md)).</span><span class="sxs-lookup"><span data-stu-id="122fc-146">Writers that fail to process the [*Identify*](vssgloss-i.md) event generated by the calls will not be part of the list of writers providing metadata found by [**IVssBackupComponents::GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (see [Determining Writer Status](determining-writer-status.md)).</span></span>

## <a name="writer-actions-during-backup-initialization"></a><span data-ttu-id="122fc-147">Azioni del writer durante l'inizializzazione del backup</span><span class="sxs-lookup"><span data-stu-id="122fc-147">Writer Actions during Backup Initialization</span></span>

<span data-ttu-id="122fc-148">In risposta all'evento di identificazione, VSS chiama il metodo del gestore virtuale di ogni writer, [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span><span class="sxs-lookup"><span data-stu-id="122fc-148">In response to the Identify event, VSS calls each writer's virtual handler method, [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span></span> <span data-ttu-id="122fc-149">Un writer crea il documento di metadati del writer eseguendo l'override dell'implementazione predefinita di **CVssWriter:: Onidentificate** e usando l'interfaccia [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) .</span><span class="sxs-lookup"><span data-stu-id="122fc-149">A writer creates its Writer Metadata Document by overriding the default implementation of **CVssWriter::OnIdentify** and using the [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) interface.</span></span>

<span data-ttu-id="122fc-150">Si noti che le applicazioni diverse dal richiedente corrente (ad esempio, le applicazioni di sistema) possono generare eventi di identificazione che devono essere gestiti dal writer.</span><span class="sxs-lookup"><span data-stu-id="122fc-150">Note that applications other than the current requester (for instance, system applications) can generate Identify events that must be handled by the writer.</span></span> <span data-ttu-id="122fc-151">Inoltre, non esiste alcun modo che un writer determini dall'interno di [**CVssWriter:: Onidentificate**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) l'applicazione che ha generato l'evento di identificazione.</span><span class="sxs-lookup"><span data-stu-id="122fc-151">In addition, there is no way for a writer to determine from within [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) which application has generated the Identify event.</span></span>

<span data-ttu-id="122fc-152">Questo √® il caso, dato che un writer pu√≤ ricevere diversi eventi di identificazione durante l'elaborazione di un'operazione di backup, un writer non deve mai impostare le informazioni sullo stato nel gestore [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) .</span><span class="sxs-lookup"><span data-stu-id="122fc-152">This being the case, given that a writer may receive several Identify events while processing a backup operation, a writer should never set state information in the [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) handler.</span></span>

<span data-ttu-id="122fc-153">Al contrario, [**CVssWriter:: onidentifi**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) deve eseguire un algoritmo coerente per creare il documento di metadati del writer del writer, in particolare perch√©, in seguito alla creazione del documento da parte di un writer, il richiedente e il writer non possono modificarlo.</span><span class="sxs-lookup"><span data-stu-id="122fc-153">Instead, [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) should perform a consistent algorithm to create the writer's Writer Metadata Document, particularly because after a writer creates the document, neither the requester nor the writer can modify it.</span></span> <span data-ttu-id="122fc-154">Da questo punto in poi, si tratta di un documento di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="122fc-154">From this point forward, it is a read-only document.</span></span>

<span data-ttu-id="122fc-155">Ci√≤ significa che il numero e il tipo di [*componenti*](vssgloss-c.md) associati a un writer, i file che fanno parte di ogni componente e l'esclusione esplicita dei file dalle operazioni di backup o ripristino non possono essere modificati dopo che un writer ha restituito l'elaborazione dell'evento di identificazione.</span><span class="sxs-lookup"><span data-stu-id="122fc-155">This means that the number and type of [*components*](vssgloss-c.md) associated with a writer, which files are part of each component, and the explicit exclusion of files from backup or restore operations cannot be changed after a writer returns from processing the Identify event.</span></span>

<span data-ttu-id="122fc-156">Tutti i writer che partecipano a VSS sono necessari per eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="122fc-156">All writers participating with VSS are required to do the following:</span></span>

1.  <span data-ttu-id="122fc-157">Indicare un metodo di ripristino per tutti i componenti gestiti dal writer usando [**IVssCreateWriterMetadata:: SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod).</span><span class="sxs-lookup"><span data-stu-id="122fc-157">Indicate a restore method for all components managed by the writer using [**IVssCreateWriterMetadata::SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod).</span></span>
2.  <span data-ttu-id="122fc-158">Aggiungere almeno un componente usando [**IVssCreateWriterMetadata:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) (vedere la [definizione di componenti per Writer](definition-of-components-by-writers.md) per ulteriori informazioni sulla specifica del componente).</span><span class="sxs-lookup"><span data-stu-id="122fc-158">Add at least one component using [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) (see [Definition of Components by Writers](definition-of-components-by-writers.md) for more information on component specification).</span></span>

<span data-ttu-id="122fc-159">Un writer indica i file per partecipare a un'operazione di backup o ripristino mediante l'aggiunta di [*set di file*](vssgloss-f.md), ovvero una combinazione di un percorso, una specifica del file e un flag di ricorsione, a un determinato componente usando [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)o [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), a seconda del tipo (vedere [aggiunta di file ai componenti](definition-of-components-by-writers.md)).</span><span class="sxs-lookup"><span data-stu-id="122fc-159">A writer indicates the files to participate in a backup or restore operation by adding [*file sets*](vssgloss-f.md)‚Äîa combination of a path, file specification, and a recursion flag‚Äîto a given component using [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), or [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), depending on type (See [Adding Files to Components](definition-of-components-by-writers.md).)</span></span>

<span data-ttu-id="122fc-160">Un writer pu√≤ inoltre disporre di uno o pi√π componenti vuoti, componenti a cui non √® stato aggiunto alcun file.</span><span class="sxs-lookup"><span data-stu-id="122fc-160">A writer may also have one or more empty components, components to which no files have been added.</span></span> <span data-ttu-id="122fc-161">Sono molto utili per organizzare i componenti del writer.</span><span class="sxs-lookup"><span data-stu-id="122fc-161">These are very useful in organizing the writer's components.</span></span> <span data-ttu-id="122fc-162">(Vedere il [percorso logico dei componenti](logical-pathing-of-components.md)).</span><span class="sxs-lookup"><span data-stu-id="122fc-162">(See [Logical Pathing of Components](logical-pathing-of-components.md).)</span></span>

<span data-ttu-id="122fc-163">Un writer USA [**IVssCreateWriterMetadata:: AddExcludeFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addexcludefiles) per impedire in modo esplicito l'inclusione di file nel backup.</span><span class="sxs-lookup"><span data-stu-id="122fc-163">A writer uses [**IVssCreateWriterMetadata::AddExcludeFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addexcludefiles) to explicitly prevent files from being included in the backup.</span></span> <span data-ttu-id="122fc-164">Questa esclusione esplicita √® utile perch√© i caratteri jolly possono essere usati per specificare i file da includere (vedere la [specifica dell'elenco di file esclusi](writer-metadata-document-contents.md)).</span><span class="sxs-lookup"><span data-stu-id="122fc-164">This explicit exclusion is useful because wildcard characters can be used to specify files for inclusion (see [Exclude File List Specification](writer-metadata-document-contents.md)).</span></span> <span data-ttu-id="122fc-165">Si noti che l'elenco di file di esclusione ha la precedenza sugli elenchi di file dei componenti.</span><span class="sxs-lookup"><span data-stu-id="122fc-165">Note that the exclude file list takes precedence over component files lists.</span></span>

<span data-ttu-id="122fc-166">[**IVssCreateWriterMetadata:: AddAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addalternatelocationmapping) viene usato per creare [*mapping di percorsi alternativi*](vssgloss-a.md) per i set di file specificati che sono stati aggiunti a uno dei componenti del writer.</span><span class="sxs-lookup"><span data-stu-id="122fc-166">[**IVssCreateWriterMetadata::AddAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addalternatelocationmapping) is used to create [*alternate location mappings*](vssgloss-a.md) for specified file sets that have been added to one of the writer's components.</span></span> <span data-ttu-id="122fc-167">Questi mapping vengono usati durante il ripristino del file quando il ripristino nel percorso originale di un file non √® possibile o auspicabile.</span><span class="sxs-lookup"><span data-stu-id="122fc-167">These mappings are used during file restore when restoring to a file's original location is not possible or desirable.</span></span> <span data-ttu-id="122fc-168">Vedere [Panoramica del ripristino di file effettivi e dei](overview-of-actual-file-restoration.md) [percorsi di backup e ripristino non predefiniti](non-default-backup-and-restore-locations.md).</span><span class="sxs-lookup"><span data-stu-id="122fc-168">(See [Overview of Actual File Restoration](overview-of-actual-file-restoration.md) and [Non-Default Backup and Restore Locations](non-default-backup-and-restore-locations.md).)</span></span>

<span data-ttu-id="122fc-169">Poich√© il set di file di backup viene specificato nel documento di metadati del writer, non pu√≤ essere modificato in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="122fc-169">Because the backup file set is specified in the Writer Metadata Document, it cannot later be modified.</span></span> <span data-ttu-id="122fc-170">Pertanto, un writer deve essere codificato in modo che la definizione del set di file includa tutti i file necessari nel backup, in base al nome o tramite caratteri jolly.</span><span class="sxs-lookup"><span data-stu-id="122fc-170">Therefore, a writer should be coded so that the file set's definition will include all files needed in the backup, either by name or through wildcard characters.</span></span> <span data-ttu-id="122fc-171">In teoria, pu√≤ includere alcuni file che potrebbero essere creati dopo l'evento di identificazione.</span><span class="sxs-lookup"><span data-stu-id="122fc-171">Conceivably, this may include some files that might be created after the Identify event.</span></span>

 

 



