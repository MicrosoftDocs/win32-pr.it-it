---
title: Windows Installer per sviluppatori di giochi
description: Questo articolo fornisce una panoramica di Windows Installer, specificamente destinata agli sviluppatori di giochi. Per la documentazione dettagliata sulle funzionalità e sulle API menzionate in questo articolo, fare riferimento a Windows Platform SDK.
ms.assetid: 07401792-b34b-71c9-18f8-a11c916c7d81
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e44227b633f7f9491b8a69bc06aa7945941a154
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399277"
---
# <a name="windows-installer-for-game-developers"></a><span data-ttu-id="0b8cf-104">Windows Installer per sviluppatori di giochi</span><span class="sxs-lookup"><span data-stu-id="0b8cf-104">Windows Installer for Game Developers</span></span>

<span data-ttu-id="0b8cf-105">Mostra in che modo è possibile usare Windows Installer per installare giochi nei computer degli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-105">Shows how Windows Installer can be used to install games on end-user machines.</span></span> <span data-ttu-id="0b8cf-106">Windows Installer offre supporto completo per un'interfaccia utente personalizzata, nonché per l'applicazione di patch.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-106">Windows Installer offers full support for a customized user interface, as well as for patching.</span></span>

<span data-ttu-id="0b8cf-107">Microsoft Windows Installer è l'API preferita per l'installazione di software in computer basati su Windows.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-107">Microsoft Windows Installer is the preferred API for installing software on Windows-based computers.</span></span> <span data-ttu-id="0b8cf-108">Sebbene molte delle funzionalità di Windows Installer siano progettate per supportare la distribuzione di applicazioni aziendali in un ambiente aziendale, Windows Installer è anche completamente adatta per l'installazione di giochi nei computer degli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-108">While many of the features of Windows Installer are designed to support deployment of business applications in a corporate environment, Windows Installer is also completely suitable for installing games on end-user machines.</span></span> <span data-ttu-id="0b8cf-109">I principali vantaggi dell'uso di Windows Installer per l'installazione del gioco sono:</span><span class="sxs-lookup"><span data-stu-id="0b8cf-109">The primary advantages of using Windows Installer for game installation are:</span></span>

-   <span data-ttu-id="0b8cf-110">Disinstallazione affidabile</span><span class="sxs-lookup"><span data-stu-id="0b8cf-110">Reliable uninstall</span></span>
-   <span data-ttu-id="0b8cf-111">Possibilità di installare il contenuto su richiesta</span><span class="sxs-lookup"><span data-stu-id="0b8cf-111">Ability to install content on demand</span></span>
-   <span data-ttu-id="0b8cf-112">Supporto per l'interfaccia utente completamente personalizzata</span><span class="sxs-lookup"><span data-stu-id="0b8cf-112">Support for completely custom user interface</span></span>
-   <span data-ttu-id="0b8cf-113">Applicazione di patch efficiente</span><span class="sxs-lookup"><span data-stu-id="0b8cf-113">Efficient patching</span></span>

<span data-ttu-id="0b8cf-114">Questo articolo fornisce una panoramica di Windows Installer, specificamente destinata agli sviluppatori di giochi.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-114">This article gives an overview of Windows Installer, specifically targeted to game developers.</span></span> <span data-ttu-id="0b8cf-115">Per la documentazione dettagliata sulle funzionalità e sulle API menzionate in questo articolo, fare riferimento a Windows Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-115">For detailed documentation on the features and APIs mentioned in this article, please refer to the Windows Platform SDK.</span></span>

-   [<span data-ttu-id="0b8cf-116">Overview</span><span class="sxs-lookup"><span data-stu-id="0b8cf-116">Overview</span></span>](#overview)
-   [<span data-ttu-id="0b8cf-117">Concetti chiave Windows Installer</span><span class="sxs-lookup"><span data-stu-id="0b8cf-117">Key Windows Installer Concepts</span></span>](#key-windows-installer-concepts)
    -   [<span data-ttu-id="0b8cf-118">Componenti</span><span class="sxs-lookup"><span data-stu-id="0b8cf-118">Components</span></span>](#components)
    -   [<span data-ttu-id="0b8cf-119">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="0b8cf-119">Features</span></span>](#features)
-   [<span data-ttu-id="0b8cf-120">Stati di installazione</span><span class="sxs-lookup"><span data-stu-id="0b8cf-120">Install States</span></span>](#install-states)
-   [<span data-ttu-id="0b8cf-121">Installare su richiesta</span><span class="sxs-lookup"><span data-stu-id="0b8cf-121">Install on Demand</span></span>](#install-on-demand)
-   [<span data-ttu-id="0b8cf-122">Interfaccia utente personalizzata</span><span class="sxs-lookup"><span data-stu-id="0b8cf-122">Custom User Interface</span></span>](#custom-user-interface)
-   [<span data-ttu-id="0b8cf-123">Patch</span><span class="sxs-lookup"><span data-stu-id="0b8cf-123">Patching</span></span>](#patching)
-   [<span data-ttu-id="0b8cf-124">Altre risorse</span><span class="sxs-lookup"><span data-stu-id="0b8cf-124">Other Resources</span></span>](#other-resources)

## <a name="overview"></a><span data-ttu-id="0b8cf-125">Panoramica</span><span class="sxs-lookup"><span data-stu-id="0b8cf-125">Overview</span></span>

<span data-ttu-id="0b8cf-126">Tutte le configurazioni basate su Windows Installer utilizzano un file di database di installazione denominato file MSI per descrivere la modalità di installazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-126">All Windows Installer-based setups use an installation database file called an MSI file to describe how the application is to be installed.</span></span> <span data-ttu-id="0b8cf-127">Il file MSI contiene informazioni sui file, le chiavi del registro di sistema, i collegamenti al desktop, le associazioni di file e altri elementi dell'applicazione da installare.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-127">The MSI file contains information on what files, registry keys, desktop shortcuts, file associations, and other application elements are to be installed.</span></span> <span data-ttu-id="0b8cf-128">È possibile comprimere i file effettivi da installare all'interno del file con estensione MSI, in bundle e compressi in file CAB distinti oppure archiviati in un'altra posizione nel supporto di installazione come singoli file non compressi.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-128">The actual files to be installed can be compressed within the MSI file itself, bundled and compressed into separate "cabinet files", or stored elsewhere on the installation media as individual uncompressed files.</span></span> <span data-ttu-id="0b8cf-129">Il file MSI può inoltre fare riferimento a azioni personalizzate implementate esternamente, in modo da consentire azioni per le quali il file MSI non consente in modo nativo.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-129">The MSI file can also reference externally implemented custom actions, in order to allow for actions for which the MSI file does not natively allow.</span></span>

<span data-ttu-id="0b8cf-130">Un file MSI può facoltativamente contenere un'interfaccia utente per guidare l'utente durante il processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-130">An MSI file can optionally contain a user interface to guide the user through the installation process.</span></span> <span data-ttu-id="0b8cf-131">Questa interfaccia utente è adeguata per la maggior parte delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-131">This UI is adequate for most applications.</span></span> <span data-ttu-id="0b8cf-132">Tuttavia, ha l'aspetto di una normale applicazione Windows e molti sviluppatori di giochi preferiscono che l'applicazione di installazione mantenga l'aspetto del gioco, per offrire un'esperienza utente finale più coerente.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-132">However, it has the look and feel of a regular Windows application, and many game developers prefer to have their setup application maintain the look and feel of the game itself, in order to provide a more consistent end-user experience.</span></span> <span data-ttu-id="0b8cf-133">Per supportare questo scenario di interfaccia utente completamente personalizzato, un'applicazione di installazione può disabilitare l'interfaccia utente incorporata Windows Installer e gestire l'intera interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-133">To support this fully custom UI scenario, a setup application can turn off Windows Installer's built-in UI, and handle the entire user interface itself.</span></span> <span data-ttu-id="0b8cf-134">L'API Windows Installer espone un meccanismo di callback per consentire a un'interfaccia utente di installazione personalizzata di ricevere notifiche sullo stato di avanzamento dell'installazione, nonché eventi importanti come le richieste di modifica del disco.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-134">The Windows Installer API exposes a callback mechanism to allow a custom setup UI to be notified of the progress of the installation, as well as important events such as disk change requests.</span></span>

<span data-ttu-id="0b8cf-135">Windows Installer non è una soluzione end-to-end per la creazione di configurazioni.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-135">Windows Installer is not an end-to-end solution for creating setups.</span></span> <span data-ttu-id="0b8cf-136">Si tratta solo di un'API che può essere utilizzata da un programma di installazione per eseguire l'installazione effettiva di file, chiavi del registro di sistema, collegamenti desktop e altri elementi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-136">It is only an API that can be used by a setup program to do the actual installation of files, registry keys, desktop shortcuts, and other elements of the application.</span></span> <span data-ttu-id="0b8cf-137">Le versioni recenti di tutti gli strumenti principali per la configurazione commerciale, ad esempio InstallShield, WISE e Microsoft Visual Studio, supportano Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-137">Recent versions of all of the major commercial setup tools (for example, InstallShield, WISE, and Microsoft Visual Studio) support Windows Installer.</span></span> <span data-ttu-id="0b8cf-138">Questi strumenti offrono pratici interfacce utente per la creazione della configurazione per un gioco, ma si basano sull'API Windows Installer per eseguire gran parte dell'installazione effettiva.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-138">These tools provide convenient user interfaces for creating the setup for a game, but they rely on the Windows Installer API to do much of the actual installation.</span></span> <span data-ttu-id="0b8cf-139">Questi strumenti possono essere usati anche solo per compilare un database MSI contenente il pacchetto di installazione, che può quindi essere installato da un'interfaccia utente di installazione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-139">These tools can also be used just to build an MSI database containing the setup package, which can then be installed from a custom-written setup UI.</span></span> <span data-ttu-id="0b8cf-140">In alternativa agli strumenti di terze parti, l'API Windows Installer fornisce tutte le funzioni necessarie per la creazione e la modifica di un database MSI a livello di codice e Windows Platform SDK include uno strumento di modifica del database MSI Bare Bones chiamato Orca.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-140">As an alternative to third-party tools, the Windows Installer API provides all of the functions necessary for creating and manipulating an MSI database programmatically, and the Windows Platform SDK includes a bare-bones MSI database-editing tool called Orca.</span></span>

## <a name="key-windows-installer-concepts"></a><span data-ttu-id="0b8cf-141">Concetti chiave Windows Installer</span><span class="sxs-lookup"><span data-stu-id="0b8cf-141">Key Windows Installer Concepts</span></span>

<span data-ttu-id="0b8cf-142">Di seguito sono riportati i componenti e le funzionalità Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-142">Here are the Windows Installer components and features.</span></span>

### <a name="components"></a><span data-ttu-id="0b8cf-143">Componenti</span><span class="sxs-lookup"><span data-stu-id="0b8cf-143">Components</span></span>

<span data-ttu-id="0b8cf-144">Un'applicazione è costituita da uno o più componenti, identificati da un ID componente GUID.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-144">An application is made up of one or more components, identified by a GUID component ID.</span></span> <span data-ttu-id="0b8cf-145">Un componente è un'unità atomica. è installato completamente o non è installato.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-145">A component is an atomic unit; it is either entirely installed or not installed at all.</span></span> <span data-ttu-id="0b8cf-146">Un componente può essere costituito da un singolo file, più file, chiavi del registro di sistema, collegamenti desktop o una combinazione di questi elementi.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-146">A component can consist of a single file, multiple files, registry keys, desktop shortcuts, or some combination thereof.</span></span> <span data-ttu-id="0b8cf-147">Le risorse (file e così via) all'interno di un componente devono essere univoche per quel componente. due componenti non possono contenere la stessa risorsa.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-147">The resources (files, and so on) within a component must be unique to that component-no two components can contain the same resource.</span></span> <span data-ttu-id="0b8cf-148">Un componente non viene mai installato in modo esplicito; viene installato solo come parte di una funzionalità (vedere di seguito).</span><span class="sxs-lookup"><span data-stu-id="0b8cf-148">A component is never installed explicitly; it is only installed as part of a feature (see following).</span></span>

### <a name="features"></a><span data-ttu-id="0b8cf-149">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="0b8cf-149">Features</span></span>

<span data-ttu-id="0b8cf-150">Una funzionalità è un gruppo di componenti, identificato da un ID di funzionalità GUID.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-150">A feature is a group of components, identified by a GUID feature ID.</span></span> <span data-ttu-id="0b8cf-151">Diversamente dai componenti, più funzionalità possono contenere lo stesso componente.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-151">Unlike components, multiple features may contain the same component.</span></span> <span data-ttu-id="0b8cf-152">Un componente condiviso tra più funzionalità verrà installato se una di queste funzionalità viene installata e rimossa solo quando tutte le funzionalità che fanno riferimento al componente sono state disinstallate.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-152">A component shared between multiple features will be installed if any of those features is installed, and removed only when all features that reference the component have been uninstalled.</span></span> <span data-ttu-id="0b8cf-153">L'installazione di una funzionalità può essere eseguita automaticamente come parte dell'installazione di un prodotto oppure può essere eseguita manualmente tramite l'API [**MsiConfigureFeature**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) .</span><span class="sxs-lookup"><span data-stu-id="0b8cf-153">Installation of a feature can be done automatically as part of the installation of a product, or it can be done manually using the [**MsiConfigureFeature**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) API.</span></span>

<span data-ttu-id="0b8cf-154">Sebbene pochi giochi abbiano più "funzionalità" che possono essere installate in modo indipendente, il concetto Windows Installer di una funzionalità è ancora utile.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-154">Although few games have multiple "features" that can be installed independently, the Windows Installer concept of a feature is still useful.</span></span> <span data-ttu-id="0b8cf-155">Poiché una funzionalità Windows Installer non è nient'altro che una raccolta di componenti che possono essere installati insieme, i giochi possono usare le funzionalità per raggruppare tutti i contenuti necessari per una fase specifica del gioco.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-155">Since a Windows Installer feature is nothing more than a collection of components that can be installed together, games can use features to group together all of the content needed for a particular stage of the game.</span></span> <span data-ttu-id="0b8cf-156">Ad esempio, un gioco orientato ai livelli può definire una funzionalità per ogni livello, costituito da tutto il contenuto necessario per tale livello.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-156">For example, a level-oriented game could define one feature per level, consisting of all of the content required for that level.</span></span> <span data-ttu-id="0b8cf-157">Questo consentirebbe al gioco di installare il contenuto un livello alla volta dall'interno del gioco, anziché installare tutto il contenuto per tutti i livelli durante l'installazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-157">This would allow the game to install the content one level at a time from within the game itself, rather than installing all of the content for all of the levels during the initial installation.</span></span>

## <a name="install-states"></a><span data-ttu-id="0b8cf-158">Stati di installazione</span><span class="sxs-lookup"><span data-stu-id="0b8cf-158">Install States</span></span>

<span data-ttu-id="0b8cf-159">A ogni componente o funzionalità è associato uno stato di installazione, che determina se il componente o la funzionalità è disponibile e, in tal caso, dove sono installati i file per il componente o la funzionalità.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-159">Each component or feature has an associated install state, which determines whether the component or feature is available, and if so, where the files for the component or feature are installed.</span></span> <span data-ttu-id="0b8cf-160">Gli Stati di installazione possibili per una funzionalità sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="0b8cf-160">The possible install states for a feature are:</span></span>

<dl> <dt>

<span data-ttu-id="0b8cf-161"><span id="Absent"></span><span id="absent"></span><span id="ABSENT"></span>Assente</span><span class="sxs-lookup"><span data-stu-id="0b8cf-161"><span id="Absent"></span><span id="absent"></span><span id="ABSENT"></span>Absent</span></span>
</dt> <dd>

<span data-ttu-id="0b8cf-162">La funzionalità non è installata e pertanto non è accessibile.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-162">The feature is not installed and is therefore inaccessible.</span></span>

</dd> <dt>

<span data-ttu-id="0b8cf-163"><span id="Local"></span><span id="local"></span><span id="LOCAL"></span>Locale</span><span class="sxs-lookup"><span data-stu-id="0b8cf-163"><span id="Local"></span><span id="local"></span><span id="LOCAL"></span>Local</span></span>
</dt> <dd>

<span data-ttu-id="0b8cf-164">La funzionalità è disponibile e viene installata per l'esecuzione dal disco rigido locale.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-164">The feature is available and is installed to run from the local hard drive.</span></span>

</dd> <dt>

<span data-ttu-id="0b8cf-165"><span id="Source"></span><span id="source"></span><span id="SOURCE"></span>Origine</span><span class="sxs-lookup"><span data-stu-id="0b8cf-165"><span id="Source"></span><span id="source"></span><span id="SOURCE"></span>Source</span></span>
</dt> <dd>

<span data-ttu-id="0b8cf-166">La funzionalità è disponibile e viene installata per l'esecuzione dal supporto di origine originale, in genere un CD o un DVD.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-166">The feature is available and is installed to run from the original source media (usually a CD or DVD).</span></span>

</dd> <dt>

<span data-ttu-id="0b8cf-167"><span id="Advertised"></span><span id="advertised"></span><span id="ADVERTISED"></span>Annunciati</span><span class="sxs-lookup"><span data-stu-id="0b8cf-167"><span id="Advertised"></span><span id="advertised"></span><span id="ADVERTISED"></span>Advertised</span></span>
</dt> <dd>

<span data-ttu-id="0b8cf-168">La funzionalità non è installata, ma può essere installata su richiesta con l'API [**MsiConfigureFeature**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) .</span><span class="sxs-lookup"><span data-stu-id="0b8cf-168">The feature is not installed, but can be installed on demand using the [**MsiConfigureFeature**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) API.</span></span> <span data-ttu-id="0b8cf-169">Quando la funzionalità è effettivamente installata, può essere installata nello stato locale o di origine.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-169">When the feature is actually installed, it can be installed either to the Local or Source state.</span></span>

</dd> </dl>

<span data-ttu-id="0b8cf-170">Un componente può avere uno degli stati precedenti ad eccezione di "annunciato".</span><span class="sxs-lookup"><span data-stu-id="0b8cf-170">A component can have any of the above states except for "Advertised."</span></span> <span data-ttu-id="0b8cf-171">Se un componente fa parte di una funzionalità annunciata, il componente viene visualizzato come "assente" fino a quando non viene installata la funzionalità.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-171">If a component is part of an advertised feature, the component will appear as "Absent" until the feature is installed.</span></span>

## <a name="install-on-demand"></a><span data-ttu-id="0b8cf-172">Installare su richiesta</span><span class="sxs-lookup"><span data-stu-id="0b8cf-172">Install on Demand</span></span>

<span data-ttu-id="0b8cf-173">Windows Installer consente a un'applicazione di contrassegnare le funzionalità come pubblicizzate, vale a dire che la funzionalità non è ancora installata, ma è disponibile per l'installazione in fase di esecuzione, se necessario.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-173">Windows Installer allows an application to mark features as Advertised, meaning that the feature is not yet installed, but is available to install at runtime if it is needed.</span></span> <span data-ttu-id="0b8cf-174">L'installazione di funzionalità in fase di esecuzione è nota come "installa su richiesta".</span><span class="sxs-lookup"><span data-stu-id="0b8cf-174">Installing features at runtime is known as "Install on Demand."</span></span> <span data-ttu-id="0b8cf-175">I giochi possono usare l'installazione su richiesta per ridurre drasticamente il tempo necessario per la configurazione iniziale del gioco rinviando l'installazione del contenuto del gioco fino a quando non è necessario in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-175">Games can use Install on Demand to drastically reduce the time required for the initial game setup by deferring the installation of game content until it is needed at runtime.</span></span> <span data-ttu-id="0b8cf-176">Il ritardo necessario per installare il contenuto in fase di esecuzione può spesso essere parzialmente o completamente nascosto eseguendo l'installazione su richiesta in un thread in background, mentre l'utente è altrimenti occupato con il gioco.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-176">The delay required to install the content at runtime can often be partially or completely hidden by doing the on-demand installation in a background thread, while the user is otherwise occupied with the game.</span></span>

## <a name="custom-user-interface"></a><span data-ttu-id="0b8cf-177">Interfaccia utente personalizzata</span><span class="sxs-lookup"><span data-stu-id="0b8cf-177">Custom User Interface</span></span>

<span data-ttu-id="0b8cf-178">Sebbene Windows Installer fornisca un'interfaccia utente predefinita che guida l'utente durante l'installazione dell'applicazione, questa interfaccia è simile a quella di un'applicazione Windows standard.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-178">Although Windows Installer provides a default user interface that guides the user through the installation of the application, this interface looks like that of a standard Windows application.</span></span> <span data-ttu-id="0b8cf-179">Molti sviluppatori di giochi preferiscono che la loro interfaccia utente di installazione abbia lo stesso aspetto del gioco, per offrire all'utente un'idea dell'ambiente del gioco.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-179">Many game developers prefer that their installation UI have the same look and feel as the game itself, to provide the user with a taste of the game's ambiance.</span></span> <span data-ttu-id="0b8cf-180">Per supportare questa operazione, Windows Installer consente la disabilitazione completa dell'interfaccia utente incorporata, consentendo allo sviluppatore di fornire un'interfaccia utente completamente personalizzata.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-180">To support this, Windows Installer allows its built-in user interface to be completely disabled, allowing the developer to provide a completely custom UI.</span></span>

<span data-ttu-id="0b8cf-181">Il programma di installazione personalizzato Disabilita prima di tutto l'interfaccia utente predefinita di Windows Installer usando l'API [**MsiSetInternalUI**](/windows/desktop/api/msi/nf-msi-msisetinternalui) per impostare il livello di interfaccia utente su INSTALLUILEVEL \_ None.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-181">The custom setup program first disables Windows Installer's built-in user interface using the [**MsiSetInternalUI**](/windows/desktop/api/msi/nf-msi-msisetinternalui) API to set the UI level to INSTALLUILEVEL\_NONE.</span></span> <span data-ttu-id="0b8cf-182">Viene quindi chiamata l'API [**MsiSetExternalUI**](/windows/desktop/api/msi/nf-msi-msisetexternaluia) per specificare una funzione di callback che verrà chiamata durante il processo di installazione per notificare al programma di installazione gli eventi chiave durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-182">It then calls the [**MsiSetExternalUI**](/windows/desktop/api/msi/nf-msi-msisetexternaluia) API to specify a callback function that will be called during the installation process to notify the setup program of key events during the installation.</span></span>

<span data-ttu-id="0b8cf-183">Il processo di installazione effettivo viene quindi avviato chiamando l'API [**MsiInstallProduct**](/windows/desktop/api/msi/nf-msi-msiinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="0b8cf-183">The actual installation process is then started by calling the [**MsiInstallProduct**](/windows/desktop/api/msi/nf-msi-msiinstallproducta) API.</span></span> <span data-ttu-id="0b8cf-184">Questa API accetta una stringa di parametro che consente al chiamante di specificare i valori per le proprietà denominate.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-184">This API accepts a parameter string that allows the caller to specify values for named properties.</span></span> <span data-ttu-id="0b8cf-185">Queste proprietà possono essere utilizzate all'interno del database di installazione per personalizzare la modalità di installazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-185">These properties can be used within the installation database itself to customize how the application is to be installed.</span></span> <span data-ttu-id="0b8cf-186">Queste proprietà possono essere usate per specificare:</span><span class="sxs-lookup"><span data-stu-id="0b8cf-186">These properties can be used to specify:</span></span>

-   <span data-ttu-id="0b8cf-187">Directory in cui deve essere installata l'applicazione</span><span class="sxs-lookup"><span data-stu-id="0b8cf-187">The directory to which the application is to be installed</span></span>
-   <span data-ttu-id="0b8cf-188">Quali funzionalità devono essere installate localmente e che devono essere installate per l'esecuzione dal CD/DVD, ad esempio per consentire la scelta tra un'installazione minima e un'installazione completa.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-188">Which features are to be installed locally and which are to be installed to run from the CD/DVD (for example, to enable choosing between a minimal install and a full install)</span></span>
-   <span data-ttu-id="0b8cf-189">Indica se l'applicazione deve essere installata per tutti gli utenti del computer o solo per l'utente corrente</span><span class="sxs-lookup"><span data-stu-id="0b8cf-189">Whether the application should be installed for all users of the machine, or for only the current user</span></span>

<span data-ttu-id="0b8cf-190">Nel corso dell'installazione, il programma di installazione utilizza i messaggi di notifica inviati alla relativa funzione di callback per determinare quando aggiornare l'interfaccia utente dell'indicatore di stato, quando richiedere all'utente di inserire il CD successivo o quando inviare una notifica all'utente in merito a un errore nel processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-190">During the course of the installation, the setup program uses the notification messages sent to its callback function to determine when to update its progress indicator UI, when to prompt the user to insert the next CD, or when to notify the user about an error in the installation process.</span></span>

## <a name="patching"></a><span data-ttu-id="0b8cf-191">Applicazione di patch</span><span class="sxs-lookup"><span data-stu-id="0b8cf-191">Patching</span></span>

<span data-ttu-id="0b8cf-192">Windows Installer consente la correzione delle applicazioni installate applicando un file di patch.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-192">Windows Installer allows installed applications to be patched by applying a patch file.</span></span> <span data-ttu-id="0b8cf-193">Un file di patch contiene i nuovi file che verranno aggiunti dalla patch, i file modificati dalla patch e un elenco di modifiche da apportare al database di installazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-193">A patch file contains the new files to be added by the patch, the files that are modified by the patch, and a list of changes to make to the installation database.</span></span> <span data-ttu-id="0b8cf-194">Per conservare spazio, anziché archiviare il contenuto completo di un file modificato dalla patch, il file di correzione contiene effettivamente solo le differenze tra la versione originale del file e la nuova versione del file.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-194">To conserve space, instead of storing the complete contents of a file changed by the patch, the patch file actually contains only the differences between the original version of the file and the new version of the file.</span></span>

<span data-ttu-id="0b8cf-195">Per creare una patch, è necessaria l'immagine di installazione per ogni versione dell'applicazione da cui si vuole eseguire l'aggiornamento della patch, oltre all'immagine di installazione per la nuova versione aggiornata dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-195">In order to create a patch, you need the setup image for each of the versions of the application that you wish the patch to upgrade from, as well as the setup image for the new, upgraded version of the application.</span></span> <span data-ttu-id="0b8cf-196">Un'immagine di installazione è costituita dal database MSI e da tutti i file di dati effettivi per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-196">A setup image consists of the MSI database and all of the actual data files for the application.</span></span> <span data-ttu-id="0b8cf-197">Il modo migliore per creare un'immagine di installazione per una nuova versione dell'applicazione consiste nel copiare l'immagine di installazione dalla versione precedente dell'applicazione, quindi apportare le modifiche necessarie per aggiornare la copia alla versione con patch.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-197">The best way to create a setup image for a new version of the application is to copy the setup image from the previous version of the application, and then make any changes necessary to update that copy to the patched version.</span></span>

<span data-ttu-id="0b8cf-198">Dopo aver creato tutte le immagini di installazione necessarie, è possibile creare le patch usando Msimsp.exe, ovvero uno strumento per la creazione di patch disponibile come parte di Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-198">Once you have all of the necessary setup images, you can create the patches using Msimsp.exe, which is a patch creation tool available as part of the Platform SDK.</span></span> <span data-ttu-id="0b8cf-199">Lo strumento richiederà le posizioni di ogni immagine di installazione e quindi determinerà come rappresentare in modo efficiente le differenze tra le versioni successive.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-199">The tool will ask for the locations of each of the setup images, and then determine how to efficiently represent the differences between the successive versions.</span></span> <span data-ttu-id="0b8cf-200">L'output dello strumento è il file patch finale (identificato dall'estensione MSP).</span><span class="sxs-lookup"><span data-stu-id="0b8cf-200">The output of the tool is the final patch file (identified by the extension MSP).</span></span> <span data-ttu-id="0b8cf-201">Per installare la patch a livello di codice, chiamare l'API [**MsiApplyPatch**](/windows/desktop/api/msi/nf-msi-msiapplypatcha) .</span><span class="sxs-lookup"><span data-stu-id="0b8cf-201">In order to install the patch programmatically, call the [**MsiApplyPatch**](/windows/desktop/api/msi/nf-msi-msiapplypatcha) API.</span></span> <span data-ttu-id="0b8cf-202">L'utente può anche installare manualmente la patch facendo doppio clic sul file MSP in Esplora.</span><span class="sxs-lookup"><span data-stu-id="0b8cf-202">The user can also install the patch manually by double-clicking on the MSP file in Explorer.</span></span>

## <a name="other-resources"></a><span data-ttu-id="0b8cf-203">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="0b8cf-203">Other Resources</span></span>

-   <span data-ttu-id="0b8cf-204">Per informazioni dettagliate sull'API Windows Installer, vedere [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span><span class="sxs-lookup"><span data-stu-id="0b8cf-204">For detailed info on the Windows Installer API, see [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span></span>
-   <span data-ttu-id="0b8cf-205">Per informazioni sulle procedure consigliate per l'installazione del gioco, vedere [installazione e manutenzione dei giochi](/windows/desktop/DxTechArts/installation-and-maintenance-of-games).</span><span class="sxs-lookup"><span data-stu-id="0b8cf-205">For info on best practices for game installation, see [Installation and Maintenance of Games](/windows/desktop/DxTechArts/installation-and-maintenance-of-games).</span></span>

 

 