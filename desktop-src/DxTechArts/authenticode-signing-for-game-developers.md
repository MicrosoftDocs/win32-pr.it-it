---
title: Firma Authenticode per sviluppatori di giochi
description: Questo articolo illustra come iniziare a eseguire l'autenticazione del gioco e come integrare l'autenticazione in un processo di compilazione giornaliero.
ms.assetid: 0b3138ea-e4ea-57fb-756b-62fdc20cf813
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f304e6cc8e185264699709987f62dfdca17bf8b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300088"
---
# <a name="authenticode-signing-for-game-developers"></a><span data-ttu-id="6a475-103">Firma Authenticode per sviluppatori di giochi</span><span class="sxs-lookup"><span data-stu-id="6a475-103">Authenticode Signing for Game Developers</span></span>

<span data-ttu-id="6a475-104">L'autenticazione dei dati è sempre più importante per gli sviluppatori di giochi.</span><span class="sxs-lookup"><span data-stu-id="6a475-104">Data authentication is increasingly important for game developers.</span></span> <span data-ttu-id="6a475-105">Windows Vista e Windows 7 hanno diverse funzionalità, ad esempio i controlli padre, che richiedono che i giochi siano firmati correttamente per assicurarsi che nessuno abbia alterato i dati.</span><span class="sxs-lookup"><span data-stu-id="6a475-105">Windows Vista and Windows 7 have a number of features, such as parental controls, that require games to be properly signed to ensure that no one has tampered with the data.</span></span> <span data-ttu-id="6a475-106">Microsoft Authenticode consente agli utenti finali e al sistema operativo di verificare che il codice del programma provenga dal legittimo proprietario e che non sia stato alterato in modo dannoso o accidentalmente danneggiato.</span><span class="sxs-lookup"><span data-stu-id="6a475-106">Microsoft Authenticode enables end users and the operating system to verify that program code comes from the rightful owner and that it hasn't been maliciously altered or accidentally corrupted.</span></span> <span data-ttu-id="6a475-107">Questo articolo illustra come iniziare a eseguire l'autenticazione del gioco e come integrare l'autenticazione in un processo di compilazione giornaliero.</span><span class="sxs-lookup"><span data-stu-id="6a475-107">This article discusses how to get started with authenticating your game and how to integrate authentication into a daily build process.</span></span>

-   [<span data-ttu-id="6a475-108">Background</span><span class="sxs-lookup"><span data-stu-id="6a475-108">Background</span></span>](#background)
-   [<span data-ttu-id="6a475-109">Per iniziare</span><span class="sxs-lookup"><span data-stu-id="6a475-109">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="6a475-110">Uso di un'autorità di certificazione attendibile</span><span class="sxs-lookup"><span data-stu-id="6a475-110">Using a Trusted Certificate Authority</span></span>](#using-a-trusted-certificate-authority)
-   [<span data-ttu-id="6a475-111">Esempio di utilizzo di un certificato di prova</span><span class="sxs-lookup"><span data-stu-id="6a475-111">Example Using a Test Certificate</span></span>](#example-using-a-test-certificate)
-   [<span data-ttu-id="6a475-112">Integrazione del codice per l'accesso al sistema di compilazione giornaliero</span><span class="sxs-lookup"><span data-stu-id="6a475-112">Integrating Code Signing into the Daily Build System</span></span>](#integrating-code-signing-into-the-daily-build-system)
-   [<span data-ttu-id="6a475-113">Revoca</span><span class="sxs-lookup"><span data-stu-id="6a475-113">Revocation</span></span>](#revocation)
-   [<span data-ttu-id="6a475-114">Driver per la firma del codice</span><span class="sxs-lookup"><span data-stu-id="6a475-114">Code-Signing Drivers</span></span>](#code-signing-drivers)
-   [<span data-ttu-id="6a475-115">Summary</span><span class="sxs-lookup"><span data-stu-id="6a475-115">Summary</span></span>](#summary)
-   [<span data-ttu-id="6a475-116">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="6a475-116">More information</span></span>](#more-information)

> [!Note]  
> <span data-ttu-id="6a475-117">A partire dal 1 ° gennaio 2016, Windows 7 e versioni successive non considerano più attendibile il certificato di firma del codice SHA-1 con una data di scadenza pari al 1 ° gennaio 2016 o successiva.</span><span class="sxs-lookup"><span data-stu-id="6a475-117">As of January 1, 2016, Windows 7 and later no longer trust any SHA-1 code signing certificate with an expiration date of January 1, 2016 or later.</span></span> <span data-ttu-id="6a475-118">Per altre informazioni, vedere [applicazione di Windows per la firma e il timestamp del codice Authenticode](https://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-sha1-certificates.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6a475-118">See [Windows Enforcement of Authenticode Code Signing and Timestamping](https://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-sha1-certificates.aspx) for more information.</span></span>

 

## <a name="background"></a><span data-ttu-id="6a475-119">Sfondo</span><span class="sxs-lookup"><span data-stu-id="6a475-119">Background</span></span>

<span data-ttu-id="6a475-120">I certificati digitali vengono usati per stabilire l'identità dell'autore.</span><span class="sxs-lookup"><span data-stu-id="6a475-120">Digital certificates are used to establish the identity of the author.</span></span> <span data-ttu-id="6a475-121">I certificati digitali vengono emessi da terze parti attendibili, nota come autorità di certificazione (CA), ad esempio VeriSign o Thawte.</span><span class="sxs-lookup"><span data-stu-id="6a475-121">Digital certificates are issued by a trusted third party known as a Certificate Authority (CA) such as VeriSign or Thawte.</span></span> <span data-ttu-id="6a475-122">La CA è responsabile della verifica che il proprietario non stia reclamando un'identificazione falsa.</span><span class="sxs-lookup"><span data-stu-id="6a475-122">The CA is responsible for verifying that owner is not claiming a false identify.</span></span> <span data-ttu-id="6a475-123">Dopo aver applicato una CA per un certificato, gli sviluppatori commerciali possono prevedere una risposta alla propria applicazione in meno di due settimane.</span><span class="sxs-lookup"><span data-stu-id="6a475-123">After applying to a CA for a certificate, commercial developers can expect a response to their application in less than two weeks.</span></span>

<span data-ttu-id="6a475-124">Dopo che l'autorità di certificazione ha deciso di soddisfare i criteri dei criteri, genera un certificato di firma codice conforme a X. 509, il formato di certificato standard del settore creato dall'Unione internazionale delle telecomunicazioni, con le estensioni della versione 3.</span><span class="sxs-lookup"><span data-stu-id="6a475-124">After the CA decides that you meet its policy criteria, it generates a code-signing certificate that conforms to X.509, the industry-standard certificate format created by the International Telecommunications Union, with Version 3 extensions.</span></span> <span data-ttu-id="6a475-125">Questo certificato identifica l'utente e contiene la chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="6a475-125">This certificate identifies you and contains your public key.</span></span> <span data-ttu-id="6a475-126">Viene archiviato dalla CA come riferimento e viene fornita una copia elettronica.</span><span class="sxs-lookup"><span data-stu-id="6a475-126">It is stored by the CA for reference, and a copy is given to you electronically.</span></span> <span data-ttu-id="6a475-127">Allo stesso tempo, si crea anche una chiave privata che è necessario proteggere e che non si deve condividere con nessuno, neanche con la CA.</span><span class="sxs-lookup"><span data-stu-id="6a475-127">At the same time, you also create a private, key which you must keep safe and which you must not share with anyone, even the CA.</span></span>

<span data-ttu-id="6a475-128">Quando si dispone di una chiave pubblica e privata, è possibile iniziare a distribuire il software firmato.</span><span class="sxs-lookup"><span data-stu-id="6a475-128">After you have a public and private key, you can then begin distributing signed software.</span></span> <span data-ttu-id="6a475-129">Microsoft fornisce gli strumenti per eseguire questa operazione nel Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="6a475-129">Microsoft provides tools to do this in the Windows SDK.</span></span> <span data-ttu-id="6a475-130">Gli strumenti utilizzano un hash unidirezionale, producono un digest a lunghezza fissa e generano una firma crittografata con una chiave privata.</span><span class="sxs-lookup"><span data-stu-id="6a475-130">The tools utilize a one-way hash, produce a fixed-length digest, and generate an encrypted signature with a private key.</span></span> <span data-ttu-id="6a475-131">Combinano quindi la firma crittografata con il certificato e le credenziali in una struttura nota come blocco di firma e la incorporano nel formato del file eseguibile.</span><span class="sxs-lookup"><span data-stu-id="6a475-131">They then combine that encrypted signature with your certificate and credentials into a structure known as a signature block and embed it into the file format of the executable.</span></span> <span data-ttu-id="6a475-132">È possibile firmare qualsiasi tipo di file binario eseguibile, incluse le dll, i file eseguibili e i file CAB.</span><span class="sxs-lookup"><span data-stu-id="6a475-132">Any type of executable binary file can be signed, including DLLs, executable files, and cabinet files.</span></span>

<span data-ttu-id="6a475-133">La firma può essere verificata in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="6a475-133">The signature can be verified in multiple ways.</span></span> <span data-ttu-id="6a475-134">I programmi possono chiamare la funzione CertVerifyCertificateChainPolicy e SignTool (signtool.exe) può essere usato per verificare una firma dal prompt della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="6a475-134">Programs can call the CertVerifyCertificateChainPolicy function, and SignTool (signtool.exe) can be used to verify a signature from the command-line prompt.</span></span> <span data-ttu-id="6a475-135">Esplora risorse dispone inoltre di una scheda firme digitali in proprietà file che consente di visualizzare ogni certificato di un file binario firmato.</span><span class="sxs-lookup"><span data-stu-id="6a475-135">Windows Explorer also has a Digital Signatures tab in File Properties that displays each certificate of a signed binary file.</span></span> <span data-ttu-id="6a475-136">La scheda firme digitali viene visualizzata solo nelle proprietà dei file firmati. Inoltre, un'applicazione può eseguire la verifica automatica usando [**CertVerifyCertificateChainPolicy**](/windows/desktop/api/wincrypt/nf-wincrypt-certverifycertificatechainpolicy).</span><span class="sxs-lookup"><span data-stu-id="6a475-136">(The Digital Signatures tab only appears in File Properties for signed files.) Also, an application can be self-verifying by use of [**CertVerifyCertificateChainPolicy**](/windows/desktop/api/wincrypt/nf-wincrypt-certverifycertificatechainpolicy).</span></span>

<span data-ttu-id="6a475-137">La firma Authenticode non è utile solo per l'autenticazione dei dati da parte degli utenti finali, ma è necessaria anche per l'applicazione di patch a account utente limitati e a controlli padre in Windows Vista e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="6a475-137">Authenticode signing is not only useful for data authentication by end users, but is also needed for patching of Limited User Accounts and by parental controls in Windows Vista and Windows 7.</span></span> <span data-ttu-id="6a475-138">Inoltre, le tecnologie future nei sistemi operativi Windows possono richiedere anche che il codice sia firmato, quindi è consigliabile che tutti gli sviluppatori professionisti e amatoriali acquisiscano un certificato di firma codice da un'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="6a475-138">In addition, future technologies in Windows operating systems may also require that code is signed, so it is strongly advised that all professional and amateur developers acquire a code-signing certificate from a CA.</span></span> <span data-ttu-id="6a475-139">Altre informazioni su come eseguire questa operazione sono disponibili più avanti in questo articolo in [uso di un'autorità di certificazione attendibile](#using-a-trusted-certificate-authority).</span><span class="sxs-lookup"><span data-stu-id="6a475-139">More information on how this is done can be found later in this article in [Using a Trusted Certificate Authority](#using-a-trusted-certificate-authority).</span></span>

<span data-ttu-id="6a475-140">Il codice del gioco, i Patcher e i programmi di installazione possono sfruttare ulteriormente la firma Authenticode verificando che i file siano autentici nel codice.</span><span class="sxs-lookup"><span data-stu-id="6a475-140">Game code, patchers, and installers can further leverage Authenicode signing by verifying files are authentic in code.</span></span> <span data-ttu-id="6a475-141">Questa operazione può essere usata per l'anti-cheat e la sicurezza di rete generale.</span><span class="sxs-lookup"><span data-stu-id="6a475-141">This can be used for anti-cheat and general network security.</span></span> <span data-ttu-id="6a475-142">Il codice di esempio per verificare se un file è firmato è disponibile qui: [esempio C programma: verifica della firma di un file PE](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file)e codice di esempio per verificare la proprietà di un certificato di firma in un file firmato sono disponibili qui: [come ottenere informazioni da file eseguibili firmati da Authenticode](https://support.microsoft.com/kb/323809).</span><span class="sxs-lookup"><span data-stu-id="6a475-142">Example code for checking if a file is signed can be found here: [Example C Program: Verifying the Signature of a PE File](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file), and example code for checking ownership of a signing certificate on a signed file can be found here: [How To Get Information from Authenticode Signed Executables](https://support.microsoft.com/kb/323809).</span></span>

## <a name="getting-started"></a><span data-ttu-id="6a475-143">Introduzione</span><span class="sxs-lookup"><span data-stu-id="6a475-143">Getting Started</span></span>

<span data-ttu-id="6a475-144">Per iniziare, Microsoft fornisce strumenti con Visual Studio 2005 e Visual Studio 2008, oltre che nel [Windows SDK](https://msdn.microsoft.com/windowsserver/bb980924.aspx), per facilitare l'esecuzione e la verifica del processo di firma del codice.</span><span class="sxs-lookup"><span data-stu-id="6a475-144">To get started, Microsoft provides tools with Visual Studio 2005 and Visual Studio 2008, and in the [Windows SDK](https://msdn.microsoft.com/windowsserver/bb980924.aspx), to help perform and verify the code-signing process.</span></span> <span data-ttu-id="6a475-145">Dopo l'installazione di Visual Studio o del Windows SDK, gli strumenti descritti in questo articolo tecnico si trovano in una sottodirectory dell'installazione, che può includere uno o più dei seguenti elementi:</span><span class="sxs-lookup"><span data-stu-id="6a475-145">After installing Visual Studio or the Windows SDK, the tools described in this technical article are located in a subdirectory of the installation, which may include one or more of the following:</span></span>

-   <span data-ttu-id="6a475-146">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 8 \\ SDK \\ v 2.0 \\ bin</span><span class="sxs-lookup"><span data-stu-id="6a475-146">%SystemDrive%\\Program Files\\Microsoft Visual Studio 8\\SDK\\v2.0\\Bin</span></span>
-   <span data-ttu-id="6a475-147">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 8 \\ VC \\ platformsdk \\ bin</span><span class="sxs-lookup"><span data-stu-id="6a475-147">%SystemDrive%\\Program Files\\Microsoft Visual Studio 8\\VC\\PlatformSDK\\Bin</span></span>
-   <span data-ttu-id="6a475-148">% SystemDrive% \\ Program Files \\ Microsoft Visual Studio 9,0 \\ smartdevices \\ SDK \\ SDKTools</span><span class="sxs-lookup"><span data-stu-id="6a475-148">%SystemDrive%\\Program Files\\Microsoft Visual Studio 9.0\\SmartDevices\\SDK\\SDKTools</span></span>\\
-   <span data-ttu-id="6a475-149">% SystemDrive% \\ programmi \\ Microsoft SDK \\ Windows \\ v 6.0 un \\ contenitore</span><span class="sxs-lookup"><span data-stu-id="6a475-149">%SystemDrive%\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\bin</span></span>\\

<span data-ttu-id="6a475-150">Gli strumenti seguenti sono i più utili per la firma del codice:</span><span class="sxs-lookup"><span data-stu-id="6a475-150">The following tools are the most useful for signing code:</span></span>

<dl> <dt>

<span data-ttu-id="6a475-151"><span id="Certificate_Creation_Tool__MakeCert.exe_"></span><span id="certificate_creation_tool__makecert.exe_"></span><span id="CERTIFICATE_CREATION_TOOL__MAKECERT.EXE_"></span>Strumento per la creazione di certificati (MakeCert.exe)</span><span class="sxs-lookup"><span data-stu-id="6a475-151"><span id="Certificate_Creation_Tool__MakeCert.exe_"></span><span id="certificate_creation_tool__makecert.exe_"></span><span id="CERTIFICATE_CREATION_TOOL__MAKECERT.EXE_"></span>Certificate Creation Tool (MakeCert.exe)</span></span>
</dt> <dd>

<span data-ttu-id="6a475-152">Genera un certificato X. 509 di test, come file con estensione cer, che contiene la chiave pubblica e una chiave privata, come file con estensione PVK.</span><span class="sxs-lookup"><span data-stu-id="6a475-152">Generates a test X.509 certificate, as a .cer file, that contains your public key and a private key, as a .pvk file.</span></span> <span data-ttu-id="6a475-153">Questo certificato è solo a scopo di test interno e non può essere utilizzato pubblicamente.</span><span class="sxs-lookup"><span data-stu-id="6a475-153">This certificate is only for internal testing purposes and can't be used publicly.</span></span>

</dd> <dt>

<span data-ttu-id="6a475-154"><span id="pvk2pfx.exe"></span><span id="PVK2PFX.EXE"></span>pvk2pfx.exe</span><span class="sxs-lookup"><span data-stu-id="6a475-154"><span id="pvk2pfx.exe"></span><span id="PVK2PFX.EXE"></span>pvk2pfx.exe</span></span>
</dt> <dd>

<span data-ttu-id="6a475-155">Crea un file di scambio di informazioni personali (con estensione pfx) da una coppia di file con estensione CER e PVK.</span><span class="sxs-lookup"><span data-stu-id="6a475-155">Creates a Personal Information Exchange (.pfx) file from a pair of .cer and .pvk files.</span></span> <span data-ttu-id="6a475-156">Il file con estensione pfx contiene sia la chiave pubblica che quella privata.</span><span class="sxs-lookup"><span data-stu-id="6a475-156">The .pfx file contains both your public and private key.</span></span>

</dd> <dt>

<span data-ttu-id="6a475-157"><span id="SignTool__SignTool.exe_"></span><span id="signtool__signtool.exe_"></span><span id="SIGNTOOL__SIGNTOOL.EXE_"></span>SignTool (SignTool.exe)</span><span class="sxs-lookup"><span data-stu-id="6a475-157"><span id="SignTool__SignTool.exe_"></span><span id="signtool__signtool.exe_"></span><span id="SIGNTOOL__SIGNTOOL.EXE_"></span>SignTool (SignTool.exe)</span></span>
</dt> <dd>

<span data-ttu-id="6a475-158">Firma il file usando il file con estensione pfx.</span><span class="sxs-lookup"><span data-stu-id="6a475-158">Signs file by using the .pfx file.</span></span> <span data-ttu-id="6a475-159">SignTool supporta la firma di file DLL, file eseguibili, file di Windows Installer (MSI) e file CAB (CAB).</span><span class="sxs-lookup"><span data-stu-id="6a475-159">SignTool supports the signing of DLL files, executable files, Windows Installer (.msi) files, and cabinet (.cab) files.</span></span>

</dd> </dl>

> [!Note]  
> <span data-ttu-id="6a475-160">Durante la lettura di altra documentazione, è possibile trovare riferimenti a SignCode (SignCode.exe), ma questo strumento è deprecato e non è più supportato. in alternativa, usare SignTool.</span><span class="sxs-lookup"><span data-stu-id="6a475-160">While reading other documentation, you might find references to SignCode (SignCode.exe), but this tool is deprecated and is no longer supported—use SignTool instead.</span></span>

 

## <a name="using-a-trusted-certificate-authority"></a><span data-ttu-id="6a475-161">Uso di un'autorità di certificazione attendibile</span><span class="sxs-lookup"><span data-stu-id="6a475-161">Using a Trusted Certificate Authority</span></span>

<span data-ttu-id="6a475-162">Per ottenere un certificato attendibile, è necessario applicare a un'autorità di certificazione (CA), ad esempio VeriSign o Thawte.</span><span class="sxs-lookup"><span data-stu-id="6a475-162">To obtain a trusted certificate, you must apply to a Certificate Authority (CA), such as VeriSign or Thawte.</span></span> <span data-ttu-id="6a475-163">Microsoft non consiglia alcuna CA rispetto a un'altra, ma se si vuole eseguire l'integrazione nel servizio Segnalazione errori Windows (WER), è consigliabile usare VeriSign per emettere il certificato, perché l'accesso al database WER richiede un account WinQual che richiede un ID VeriSign.</span><span class="sxs-lookup"><span data-stu-id="6a475-163">Microsoft doesn't recommend any CA over another, but if you want to integrate into the Windows Error Reporting (WER) service, you should consider using VeriSign to issue the certificate, because accessing the WER database requires a WinQual account which requires a VeriSign ID.</span></span> <span data-ttu-id="6a475-164">Per un elenco completo di autorità di certificazione di terze parti attendibili, vedere [membri del programma Microsoft Root Certificate](/previous-versions/ms995347(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="6a475-164">For a complete list of trusted third-party certificate authorities, see [Microsoft Root Certificate Program Members](/previous-versions/ms995347(v=msdn.10)).</span></span> <span data-ttu-id="6a475-165">Per ulteriori informazioni sulla registrazione con WER, vedere l'argomento "[introduzione segnalazione errori Windows](https://msdn.microsoft.com/)" nella [zona ISV](https://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="6a475-165">For more information about registering with WER, see "[Introducing Windows Error Reporting](https://msdn.microsoft.com/)" in [ISV Zone](https://msdn.microsoft.com/).</span></span>

<span data-ttu-id="6a475-166">Dopo aver ricevuto il certificato dalla CA, è possibile firmare il programma usando SignTool e rilasciare il programma al pubblico.</span><span class="sxs-lookup"><span data-stu-id="6a475-166">After you receive your certificate from the CA, you can sign your program by using SignTool and release your program to the public.</span></span> <span data-ttu-id="6a475-167">Tuttavia, è necessario prestare attenzione a proteggere la chiave privata, che è contenuta nei file. pfx e. PVK.</span><span class="sxs-lookup"><span data-stu-id="6a475-167">However, you must be careful to protect your private key, which is contained in your .pfx and .pvk files.</span></span> <span data-ttu-id="6a475-168">Assicurarsi di tenere questi file in una posizione sicura.</span><span class="sxs-lookup"><span data-stu-id="6a475-168">Be sure to keep these files in a secure location.</span></span>

## <a name="example-using-a-test-certificate"></a><span data-ttu-id="6a475-169">Esempio di utilizzo di un certificato di prova</span><span class="sxs-lookup"><span data-stu-id="6a475-169">Example Using a Test Certificate</span></span>

<span data-ttu-id="6a475-170">I passaggi seguenti illustrano la creazione di un certificato di firma codice a scopo di test, seguito dalla firma di un programma di esempio Direct3D (denominato BasicHLSL.exe) con questo certificato di test.</span><span class="sxs-lookup"><span data-stu-id="6a475-170">The following steps demonstrate the creation of a code-signing certificate for testing purposes, followed by the signing of a Direct3D sample program (called BasicHLSL.exe) with this test certificate.</span></span> <span data-ttu-id="6a475-171">Questa procedura consente di creare i file con estensione CER e PVK, rispettivamente le chiavi pubbliche e private, che non possono essere usate per la certificazione pubblica.</span><span class="sxs-lookup"><span data-stu-id="6a475-171">This procedure creates .cer and .pvk files—your public and private keys, respectively — which cannot be used for public certification.</span></span>

<span data-ttu-id="6a475-172">In questo esempio viene aggiunto anche un timestamp alla firma.</span><span class="sxs-lookup"><span data-stu-id="6a475-172">In this example, a time stamp is also added to the signature.</span></span> <span data-ttu-id="6a475-173">Un timestamp impedisce che la firma diventi non valida al momento della scadenza del certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-173">A time stamp prevents the signature from becoming invalid when the certificate expires.</span></span> <span data-ttu-id="6a475-174">Il codice firmato ma privo di timestamp non verrà convalidato dopo la scadenza del certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-174">Code that is signed but lacking a time stamp will not validate after the certificate expires.</span></span> <span data-ttu-id="6a475-175">Pertanto, tutti i codici rilasciati pubblicamente dovrebbero avere un timestamp.</span><span class="sxs-lookup"><span data-stu-id="6a475-175">Therefore, all publicly released code should have a time stamp.</span></span>

<span data-ttu-id="6a475-176">**Per creare un certificato e firmare un programma**</span><span class="sxs-lookup"><span data-stu-id="6a475-176">**To create a certificate and sign a program**</span></span>

1.  <span data-ttu-id="6a475-177">Creare un certificato di prova e una chiave privata utilizzando lo strumento di creazione dei certificati (MakeCert.exe).</span><span class="sxs-lookup"><span data-stu-id="6a475-177">Create a test certificate and private key by using the Certificate Creation Tool (MakeCert.exe).</span></span>

    <span data-ttu-id="6a475-178">Il seguente esempio di riga di comando specifica MyPrivateKey come nome file per il file di chiave privata (con estensione PVK), MyPublicKey come nome file per il file del certificato (con estensione CER) e MySoftwareCompany come nome del certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-178">The following command-line example specifies MyPrivateKey as the file name for the private key (.pvk) file, MyPublicKey as the file name for the certificate (.cer) file, and MySoftwareCompany as the name of the certificate.</span></span> <span data-ttu-id="6a475-179">Il certificato viene inoltre reso autofirmato, in modo che non disponga di un'autorità radice non attendibile.</span><span class="sxs-lookup"><span data-stu-id="6a475-179">It also makes the certificate self-signed, so that it does not have an untrusted root authority.</span></span>

    ```
    MakeCert /n CN=MySoftwareCompany /r /h 0 /eku "1.3.6.1.5.5.7.3.3,1.3.6.1.4.1.311.10.3.13" /e 12-31-2020 /sv MyPrivateKey.pvk MyPublicKey.cer
    ```

    

2.  <span data-ttu-id="6a475-180">Creare un file di scambio di informazioni personali (con estensione pfx) dal file di chiave privata (con estensione PVK) e dal file del certificato (con estensione CER) usando pvk2pfx.exe.</span><span class="sxs-lookup"><span data-stu-id="6a475-180">Create a Personal Information Exchange (.pfx) file from your private key (.pvk) file and certificate (.cer) file by using pvk2pfx.exe.</span></span>

    <span data-ttu-id="6a475-181">Il file con estensione pfx combina le chiavi pubbliche e private in un unico file.</span><span class="sxs-lookup"><span data-stu-id="6a475-181">The .pfx file combines your public and private keys into a single file.</span></span> <span data-ttu-id="6a475-182">Il seguente esempio di riga di comando usa i file con estensione PVK e CER del passaggio precedente per creare il file con estensione pfx denominato MyPFX con la password \_ :</span><span class="sxs-lookup"><span data-stu-id="6a475-182">The following command-line example uses the .pvk and .cer files from the previous step to create the .pfx file named MyPFX with the password your\_password:</span></span>

    ```
    pvk2pfx.exe -pvk MyPrivateKey.pvk -spc MyPublicKey.cer -pfx MyPFX.pfx -po your_password
    ```

    

3.  <span data-ttu-id="6a475-183">Firmare il programma con il file di scambio di informazioni personali (con estensione pfx) usando SignTool.</span><span class="sxs-lookup"><span data-stu-id="6a475-183">Sign your program with your Personal Information Exchange (.pfx) file by using SignTool.</span></span>

    <span data-ttu-id="6a475-184">È possibile specificare diverse opzioni nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="6a475-184">You can specify several options on the command line.</span></span> <span data-ttu-id="6a475-185">Il seguente esempio di riga di comando usa il file con estensione pfx del passaggio precedente, assegna la \_ password come password, specifica BasicHLSL come file da firmare e recupera un timestamp da un server specificato:</span><span class="sxs-lookup"><span data-stu-id="6a475-185">The following command-line example uses the .pfx file from the previous step, gives your\_password as the password, specifies BasicHLSL as the file to be signed, and retrieves a time stamp from a specified server:</span></span>

    ```
    signtool.exe sign /fd SHA256 /f MyPFX.pfx /p your_password /v /t URL_to_time_stamp_service BasicHLSL.exe
    ```

    

    > [!Note]  
    > <span data-ttu-id="6a475-186">L'URL del servizio timestamp viene fornito dalla CA ed è facoltativo per il test.</span><span class="sxs-lookup"><span data-stu-id="6a475-186">The URL to the time stamp service is provided by the CA, and is optional for testing.</span></span> <span data-ttu-id="6a475-187">È importante che la firma di produzione includa un'autorità di certificazione del timestamp valida o che la firma non venga convalidata al termine del certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-187">It is important for production signing to include a valid time stamp authority, or the signature will fail to validate when the certificate expires.</span></span>

     

4.  <span data-ttu-id="6a475-188">Verificare che il programma sia firmato tramite SignTool.</span><span class="sxs-lookup"><span data-stu-id="6a475-188">Verify that the program is signed by using SignTool.</span></span>

    <span data-ttu-id="6a475-189">Il seguente esempio di riga di comando specifica che SignTool deve tentare di verificare la firma su BasicHLSL.exe usando tutti i metodi disponibili fornendo output dettagliato:</span><span class="sxs-lookup"><span data-stu-id="6a475-189">The following command-line example specifies that SignTool should attempt to verify the signature on BasicHLSL.exe by using all available methods while providing verbose output:</span></span>

    ```
    signtool.exe verify /a /v BasicHLSL.exe
    ```

    

    <span data-ttu-id="6a475-190">In questo esempio, SignTool deve indicare che il certificato è collegato, indicando anche che non è attendibile, perché non viene emesso da un'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="6a475-190">In this example, SignTool should indicate that the certificate is attached, while also stating that it is not trusted, since it is not issued by a CA.</span></span>

5.  <span data-ttu-id="6a475-191">Considerare attendibile il certificato di prova.</span><span class="sxs-lookup"><span data-stu-id="6a475-191">Trust the test certificate.</span></span>

    <span data-ttu-id="6a475-192">Per i certificati di test è necessario considerare attendibile il certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-192">For test certificates you need to trust the certificate.</span></span> <span data-ttu-id="6a475-193">Questo passaggio deve essere ignorato per i certificati forniti da una CA, perché saranno considerati attendibili per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="6a475-193">This step should be skipped for certificates provided by a CA since those will trusted by default.</span></span>

    <span data-ttu-id="6a475-194">Solo nei computer in cui si desidera considerare attendibile il certificato di test, eseguire il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="6a475-194">On only the computers where you want to trust the test certificate, run the following:</span></span>

    ```
    certmgr.msc
    ```

    

    <span data-ttu-id="6a475-195">Fare clic con il pulsante destro del mouse su autorità di certificazione radice attendibili e scegliere tutte le attività \| Importa.</span><span class="sxs-lookup"><span data-stu-id="6a475-195">Then right click on Trusted Root Certification Authorities and choose All Tasks \| Import.</span></span> <span data-ttu-id="6a475-196">Individuare quindi il file con estensione pfx creato e seguire i passaggi della procedura guidata, inserendo il certificato nelle autorità di certificazione radice attendibili.</span><span class="sxs-lookup"><span data-stu-id="6a475-196">Then browse to the .pfx file you created and follow the wizard steps, placing the certificate in the Trusted Root Certification Authorities.</span></span>

    <span data-ttu-id="6a475-197">Al termine della procedura guidata, è possibile avviare il test con il certificato attendibile nel computer.</span><span class="sxs-lookup"><span data-stu-id="6a475-197">When the wizard completes, you can start testing with the trusted certificate on that computer.</span></span>

## <a name="integrating-code-signing-into-the-daily-build-system"></a><span data-ttu-id="6a475-198">Integrazione del codice per l'accesso al sistema di compilazione giornaliero</span><span class="sxs-lookup"><span data-stu-id="6a475-198">Integrating Code Signing into the Daily Build System</span></span>

<span data-ttu-id="6a475-199">Per integrare la firma del codice in un progetto, è possibile creare un file batch o uno script per eseguire gli strumenti da riga di comando.</span><span class="sxs-lookup"><span data-stu-id="6a475-199">To integrate code signing into a project, you can create a batch file or script to run the command line tools.</span></span> <span data-ttu-id="6a475-200">Dopo aver compilato il progetto, eseguire SignTool con le impostazioni appropriate (come illustrato nel passaggio 3 dell'esempio).</span><span class="sxs-lookup"><span data-stu-id="6a475-200">After the project is built, run SignTool with the proper settings (as shown in step 3 of our example).</span></span>

<span data-ttu-id="6a475-201">Prestare particolare attenzione al processo di compilazione per garantire che l'accesso ai file con estensione pfx e PVK sia limitato al minor numero di computer e utenti possibile.</span><span class="sxs-lookup"><span data-stu-id="6a475-201">Be especially cautious in your build process to insure that access to the .pfx and .pvk files is restricted to as few computers and users as possible.</span></span> <span data-ttu-id="6a475-202">Come procedura consigliata, gli sviluppatori devono firmare il codice solo usando il certificato di test fino a quando non sono pronti per la spedizione.</span><span class="sxs-lookup"><span data-stu-id="6a475-202">As a best practice, developers should only sign code by using the test certificate until they are ready to ship.</span></span> <span data-ttu-id="6a475-203">Anche in questo caso, la chiave privata (con estensione PVK) deve essere mantenuta in una posizione protetta, ad esempio una stanza sicura o bloccata, e idealmente su un dispositivo crittografico, ad esempio una smart card.</span><span class="sxs-lookup"><span data-stu-id="6a475-203">Again, the private key (.pvk) should be kept in a secured location, like a safe or locked room, and ideally on a cryptographic device, like a smart card.</span></span>

<span data-ttu-id="6a475-204">Un altro livello di protezione viene fornito tramite Microsoft Authenticode per firmare il pacchetto di Windows Installer (MSI).</span><span class="sxs-lookup"><span data-stu-id="6a475-204">Another layer of protection is provided by using Microsoft Authenticode to sign the Windows Installer (MSI) package itself.</span></span> <span data-ttu-id="6a475-205">Ciò consente di proteggere il pacchetto MSI da manomissioni e danneggiamenti accidentali.</span><span class="sxs-lookup"><span data-stu-id="6a475-205">This helps protect the MSI package against tampering and accidental corruption.</span></span> <span data-ttu-id="6a475-206">Per altre informazioni su come firmare i pacchetti con Authenticode, fare riferimento alla documentazione per lo strumento di creazione MSI.</span><span class="sxs-lookup"><span data-stu-id="6a475-206">Refer to the documentation for your MSI creation tool for more information about how to sign packages with Authenticode.</span></span>

## <a name="revocation"></a><span data-ttu-id="6a475-207">Revoca</span><span class="sxs-lookup"><span data-stu-id="6a475-207">Revocation</span></span>

<span data-ttu-id="6a475-208">Nel caso in cui la sicurezza della chiave privata venga compromessa o un evento correlato alla sicurezza esegua il rendering di un certificato di Code-Signing non valido, lo sviluppatore deve revocare il certificato.</span><span class="sxs-lookup"><span data-stu-id="6a475-208">In the event that the security of the private key is compromised or some security-related event renders a Code-Signing certificate invalid, the developer must revoke the certificate.</span></span> <span data-ttu-id="6a475-209">Questa operazione potrebbe indebolire l'integrità dello sviluppatore e l'efficacia del codice di firma.</span><span class="sxs-lookup"><span data-stu-id="6a475-209">Not doing so would weaken the integrity of the developer and the effectiveness of signing code.</span></span> <span data-ttu-id="6a475-210">Una CA può inoltre emettere una revoca con un'ora specifica; il codice firmato con un timestamp prima dell'ora di revoca verrà comunque considerato valido, ma il codice con un timestamp successivo non sarà valido.</span><span class="sxs-lookup"><span data-stu-id="6a475-210">A CA can also issue a revocation with specific time; code signed with a time stamp prior to the revocation time will still be considered valid, but code with a subsequent time stamp will be invalid.</span></span> <span data-ttu-id="6a475-211">La revoca dei certificati influiscono sul codice in tutte le applicazioni firmate con il certificato revocato.</span><span class="sxs-lookup"><span data-stu-id="6a475-211">Certificate revocation affects code in any applications that is signed with the revoked certificate.</span></span>

## <a name="code-signing-drivers"></a><span data-ttu-id="6a475-212">Driver Code-Signing</span><span class="sxs-lookup"><span data-stu-id="6a475-212">Code-Signing Drivers</span></span>

<span data-ttu-id="6a475-213">I driver possono e devono avere firma Authenticode.</span><span class="sxs-lookup"><span data-stu-id="6a475-213">Drivers can and should be Authenticode-signed.</span></span> <span data-ttu-id="6a475-214">I driver in modalità kernel presentano requisiti aggiuntivi: le edizioni a 64 bit di Windows Vista e Windows 7 impediranno l'installazione di tutti i driver in modalità kernel senza firma e tutte le versioni di Windows presenteranno una richiesta di avviso quando un utente tenta di installare un driver non firmato.</span><span class="sxs-lookup"><span data-stu-id="6a475-214">Kernel-mode drivers have additional requirements: 64-bit editions of Windows Vista and Windows 7 will prevent installation of all unsigned kernel-mode drivers, and all versions of Windows will present a warning prompt when a user attempts to install an unsigned driver.</span></span> <span data-ttu-id="6a475-215">Inoltre, gli amministratori possono impostare Criteri di gruppo per impedire l'installazione di driver non firmati in Microsoft Windows Server 2003, Windows XP Professional x64 Edition e versioni a 32 bit di Windows Vista e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="6a475-215">In addition, administrators can set Group Policy to prevent unsigned drivers from being installed on Microsoft Windows Server 2003, Windows XP Professional x64 Edition, and 32-bit editions of Windows Vista and Windows 7.</span></span>

<span data-ttu-id="6a475-216">Molti tipi di driver possono essere firmati con una firma attendibile di Microsoft, come parte del programma di certificazione Windows di [Windows Hardware Quality Labs](https://www.microsoft.com/whdc/whql/) (WHQL) o del [programma di firma non classificato](https://www.microsoft.com/whdc/winlogo/drvsign/dqs.mspx) (denominato in precedenza driver affidabilità), che consente al sistema di considerare completamente attendibili questi driver e di installarli anche senza credenziali amministrative.</span><span class="sxs-lookup"><span data-stu-id="6a475-216">Many types of drivers can be signed with a Microsoft-trusted signature — as part of the Windows Certification Program of [Windows Hardware Quality Labs](https://www.microsoft.com/whdc/whql/) (WHQL) or the [Unclassified Signature Program](https://www.microsoft.com/whdc/winlogo/drvsign/dqs.mspx) (formerly named Driver Reliability Signature) — which allows the system to fully trust these drivers and install them even without administrative credentials.</span></span>

<span data-ttu-id="6a475-217">Come minimo, i driver devono essere firmati con Authenticode, perché i driver non firmati o autofirmati, ovvero firmati con un certificato di prova, non possono essere installati in molte piattaforme basate su Windows.</span><span class="sxs-lookup"><span data-stu-id="6a475-217">At a minimum, drivers should be Authenticode-signed, because drivers that are unsigned or self-signed (that is, signed with a test certificate) will fail to install on many Windows-based platforms.</span></span> <span data-ttu-id="6a475-218">Per ulteriori informazioni sulla firma di driver e codice e sulla funzionalità correlata, vedere [driver signing requirements for Windows](https://www.microsoft.com/whdc/winlogo/drvsign/drvsign.mspx) on [Windows Hardware Developer Central](https://www.microsoft.com/whdc/).</span><span class="sxs-lookup"><span data-stu-id="6a475-218">For more information about signing drivers and code and related feature, see [Driver Signing Requirements for Windows](https://www.microsoft.com/whdc/winlogo/drvsign/drvsign.mspx) on [Windows Hardware Developer Central](https://www.microsoft.com/whdc/).</span></span>

## <a name="summary"></a><span data-ttu-id="6a475-219">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="6a475-219">Summary</span></span>

<span data-ttu-id="6a475-220">L'utilizzo di Microsoft Authenticode è un processo semplice.</span><span class="sxs-lookup"><span data-stu-id="6a475-220">Using Microsoft Authenticode is a straightforward process.</span></span> <span data-ttu-id="6a475-221">Una volta ottenuta una CER e creato una chiave privata, è semplice utilizzare gli strumenti forniti da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="6a475-221">Once you have obtained a CER and created a private key, it is a simple matter of using the tools provided by Microsoft.</span></span> <span data-ttu-id="6a475-222">È quindi possibile abilitare funzionalità importanti in Windows Vista e Windows 7, ad esempio i controlli padre, e informare i clienti che il prodotto deriva direttamente dal legittimo proprietario.</span><span class="sxs-lookup"><span data-stu-id="6a475-222">You can then enable important features in Windows Vista and Windows 7, such as parental controls, and let customers know that your product comes directly from its rightful owner.</span></span>

## <a name="more-information"></a><span data-ttu-id="6a475-223">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="6a475-223">More information</span></span>

<span data-ttu-id="6a475-224">Per ulteriori informazioni sugli strumenti e i processi correlati alla firma del codice, vedere i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6a475-224">More information about tools and processes related to signing code, see the following links:</span></span>

-   [<span data-ttu-id="6a475-225">Strumenti di crittografia</span><span class="sxs-lookup"><span data-stu-id="6a475-225">Cryptography Tools</span></span>](/windows/desktop/SecCrypto/cryptography-tools)
-   [<span data-ttu-id="6a475-226">Informazioni di riferimento sugli strumenti dell'API Crypto</span><span class="sxs-lookup"><span data-stu-id="6a475-226">Crypto API Tools Reference</span></span>](/windows/desktop/SecCrypto/cryptoapi-tools-reference)
-   <span data-ttu-id="6a475-227">[Panoramica di Authenticode e turtorials](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537360(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6a475-227">[Authenticode Overview and Turtorials](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537360(v=vs.85))</span></span>
-   [<span data-ttu-id="6a475-228">Certificati digitali</span><span class="sxs-lookup"><span data-stu-id="6a475-228">Digital Certificates</span></span>](/windows/desktop/SecCrypto/digital-certificates)
-   [<span data-ttu-id="6a475-229">Distribuzione di Authenticode</span><span class="sxs-lookup"><span data-stu-id="6a475-229">Deploying Authenticode</span></span>](https://www.microsoft.com/technet/security/topics/cryptographyetc/authenticodets.mspx)
-   [<span data-ttu-id="6a475-230">Procedura: creare certificati temporanei da usare durante lo sviluppo</span><span class="sxs-lookup"><span data-stu-id="6a475-230">How To: Create Temporary Certificates for Use During Development</span></span>](/dotnet/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development)

 

 