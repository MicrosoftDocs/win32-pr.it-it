---
title: Controllo dell'account utente per sviluppatori di giochi
description: Questo articolo descrive le linee guida e le procedure consigliate per gli sviluppatori di giochi per lavorare in modo efficace con la funzionalità di sicurezza controllo dell'account utente introdotta in Windows Vista.
ms.assetid: dbac1c07-73dd-f2bc-3c5c-d6160368a88f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57d5533a3fbdd349cc25dfde501a234bbd7b05b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399333"
---
# <a name="user-account-control-for-game-developers"></a><span data-ttu-id="9c66d-103">Controllo dell'account utente per sviluppatori di giochi</span><span class="sxs-lookup"><span data-stu-id="9c66d-103">User Account Control for Game Developers</span></span>

<span data-ttu-id="9c66d-104">Questo articolo descrive le linee guida e le procedure consigliate per gli sviluppatori di giochi per lavorare in modo efficace con la funzionalità di sicurezza controllo dell'account utente introdotta in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-104">This article describes the guidelines and best practices for game developers to work effectively with the User Account Control (UAC) security feature introduced in Windows Vista.</span></span>

-   [<span data-ttu-id="9c66d-105">Panoramica del controllo dell'account utente</span><span class="sxs-lookup"><span data-stu-id="9c66d-105">Overview of User Account Control</span></span>](#overview-of-user-account-control)
-   [<span data-ttu-id="9c66d-106">Account utente in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="9c66d-106">User Accounts in Windows Vista</span></span>](#user-accounts-in-windows-vista)
-   [<span data-ttu-id="9c66d-107">Accesso ai file come utente standard</span><span class="sxs-lookup"><span data-stu-id="9c66d-107">File Access as a Standard User</span></span>](#file-access-as-a-standard-user)
-   [<span data-ttu-id="9c66d-108">Accesso al registro di sistema come utente standard</span><span class="sxs-lookup"><span data-stu-id="9c66d-108">Registry Access as a Standard User</span></span>](#registry-access-as-a-standard-user)
-   [<span data-ttu-id="9c66d-109">Elevazione dei privilegi</span><span class="sxs-lookup"><span data-stu-id="9c66d-109">Privilege Elevation</span></span>](#privilege-elevation)
-   [<span data-ttu-id="9c66d-110">Implicazioni del controllo dell'account utente con CreateProcess ()</span><span class="sxs-lookup"><span data-stu-id="9c66d-110">UAC Implications with CreateProcess()</span></span>](#uac-implications-with-createprocess)
-   [<span data-ttu-id="9c66d-111">Impostazione del livello di esecuzione nel manifesto dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="9c66d-111">Setting the Execution Level in the Application Manifest</span></span>](#setting-the-execution-level-in-the-application-manifest)
-   [<span data-ttu-id="9c66d-112">Incorporamento di un manifesto in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="9c66d-112">Embedding a Manifest in Visual Studio</span></span>](#embedding-a-manifest-in-visual-studio)
-   [<span data-ttu-id="9c66d-113">Compatibilità UAC con i giochi meno recenti</span><span class="sxs-lookup"><span data-stu-id="9c66d-113">UAC Compatibility with Older Games</span></span>](#uac-compatibility-with-older-games)
-   [<span data-ttu-id="9c66d-114">Scenari e manifesti legacy</span><span class="sxs-lookup"><span data-stu-id="9c66d-114">Legacy Scenarios and Manifests</span></span>](#legacy-scenarios-and-manifests)
-   [<span data-ttu-id="9c66d-115">Conclusione</span><span class="sxs-lookup"><span data-stu-id="9c66d-115">Conclusion</span></span>](#conclusion)
-   [<span data-ttu-id="9c66d-116">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="9c66d-116">Further Reading</span></span>](#further-reading)

## <a name="overview-of-user-account-control"></a><span data-ttu-id="9c66d-117">Panoramica del controllo dell'account utente</span><span class="sxs-lookup"><span data-stu-id="9c66d-117">Overview of User Account Control</span></span>

<span data-ttu-id="9c66d-118">Il controllo dell'account utente (UAC), introdotto in Windows Vista, è una funzionalità di sicurezza progettata per impedire agli utenti malintenzionati malintenzionati di usare debolezze o bug rilevati nelle applicazioni di uso comune per modificare il sistema operativo o altri programmi installati.</span><span class="sxs-lookup"><span data-stu-id="9c66d-118">User Account Control (UAC), introduced in Windows Vista, is a security feature that is designed to help prevent malicious attackers from using weaknesses or bugs found in widely-used applications to alter the operating system or other installed programs.</span></span> <span data-ttu-id="9c66d-119">Questa operazione viene eseguita eseguendo la maggior parte dei programmi e dei processi come utente standard (noto anche come utente con limitazioni, utente con restrizioni o utente Least-Privileged) anche se l'account dell'utente corrente dispone di credenziali amministrative.</span><span class="sxs-lookup"><span data-stu-id="9c66d-119">This is accomplished by running the vast majority of programs and processes as a Standard User (also known as a Limited User, Restricted User, or Least-Privileged User) even if the current user's account has administrative credentials.</span></span> <span data-ttu-id="9c66d-120">Un processo con privilegi utente standard presenta molte restrizioni intrinseche che impediscono di apportare modifiche a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="9c66d-120">A process with standard user privileges has many inherent restrictions that prevent it from making system-wide changes.</span></span>

<span data-ttu-id="9c66d-121">Il controllo dell'account utente è inoltre responsabile dell'elevazione dei privilegi di un processo mediante l'utilizzo di uno schema di autenticazione basato su finestra di dialogo avviato durante l'esecuzione di determinati processi designati come che richiedono privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-121">UAC is also responsible for privilege elevation of a process by use of a dialog-based, authentication scheme initiated upon execution of certain processes that are designated as requiring administrative privileges.</span></span> <span data-ttu-id="9c66d-122">L'elevazione dei privilegi consente agli amministratori di eseguire la maggior parte delle applicazioni a un livello di privilegio sicuro (uguale a qualsiasi altro utente standard), ma anche i processi e le operazioni che richiedono privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-122">Privilege elevation allows administrators to run the majority of their applications at a safe privilege level (the same as any other standard user), but also allow processes and operations that require administrative privileges.</span></span> <span data-ttu-id="9c66d-123">Il controllo dell'account utente supporta l'autenticazione basata sulla spalla, in modo che un amministratore possa concedere privilegi elevati a un programma mentre un utente standard è attualmente connesso al sistema.</span><span class="sxs-lookup"><span data-stu-id="9c66d-123">UAC supports over-the-shoulder authentication so that an administrator can grant elevated privileges to a program while a standard user is currently logged onto the system.</span></span>

<span data-ttu-id="9c66d-124">La funzionalità controllo dell'account utente è abilitata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="9c66d-124">The UAC feature is enabled by default.</span></span> <span data-ttu-id="9c66d-125">Sebbene sia possibile per un amministratore disabilitare l'UAC a livello di sistema, questa operazione ha una serie di ramificazioni negative.</span><span class="sxs-lookup"><span data-stu-id="9c66d-125">While it is possible for an administrator to disable UAC system-wide, doing so has a number of negative ramifications.</span></span> <span data-ttu-id="9c66d-126">In primo luogo, in questo modo si indebolisce la sicurezza di tutti gli account amministrativi, poiché tutti i processi vengono eseguiti con credenziali amministrative, anche quando la maggior parte delle applicazioni non le richiede.</span><span class="sxs-lookup"><span data-stu-id="9c66d-126">First, this weakens the security of all administrative accounts, as all processes would be run with administrative credentials, even when most applications do not actually require them.</span></span> <span data-ttu-id="9c66d-127">Con UAC disabilitato, un'applicazione utente standard che espone una vulnerabilità sfruttabile nella sicurezza può essere potenzialmente utilizzata per rubare informazioni private, installare rootkit o spyware, eliminare l'integrità del sistema o ospitare attacchi zombie su altri sistemi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-127">With UAC disabled, a standard user application that exposes an exploitable vulnerability in security can potentially be used to steal private information, install rootkits or spyware, destroy the system integrity, or host zombie attacks on other systems.</span></span> <span data-ttu-id="9c66d-128">Mentre con UAC abilitato, l'esecuzione della maggior parte del software come utente standard limita notevolmente i potenziali danni da tale bug.</span><span class="sxs-lookup"><span data-stu-id="9c66d-128">Whereas with UAC enabled, running the majority of software as a standard user greatly limits the potential damage from such a bug.</span></span> <span data-ttu-id="9c66d-129">In secondo luogo, la disattivazione del controllo dell'account utente disabilita molte soluzioni alternative per la compatibilità delle applicazioni che consentono agli utenti reali di eseguire correttamente un'ampia gamma di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9c66d-129">Secondly, turning off UAC disables many of the workarounds for application compatibility that allow true standard users to successfully run a broad range of applications.</span></span> <span data-ttu-id="9c66d-130">La disabilitazione di UAC non dovrebbe mai essere consigliata come soluzione alternativa per la compatibilità.</span><span class="sxs-lookup"><span data-stu-id="9c66d-130">Disabling UAC should never be recommended as a compatibility workaround.</span></span>

<span data-ttu-id="9c66d-131">È importante tenere presente che, se possibile, le applicazioni devono essere in grado di utilizzare solo diritti utente standard.</span><span class="sxs-lookup"><span data-stu-id="9c66d-131">It is important to note that applications should strive to only use standard user rights if at all possible.</span></span> <span data-ttu-id="9c66d-132">Sebbene gli amministratori possano facilmente elevare i privilegi di un processo, l'elevazione richiede comunque l'interazione dell'utente e il riconoscimento ogni volta che viene eseguita un'applicazione che richiede credenziali amministrative.</span><span class="sxs-lookup"><span data-stu-id="9c66d-132">While administrators can easily elevate the privileges of a process, the elevation still requires user interaction and acknowledgement every time that an application is run that requires administrative credentials.</span></span> <span data-ttu-id="9c66d-133">Questa elevazione deve essere eseguita anche al momento dell'avvio del programma, quindi la richiesta di credenziali amministrative anche per una singola operazione richiede l'esposizione del sistema a un rischio maggiore per l'intero tempo di esecuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-133">This elevation must also be done at the time that the program starts, so requiring administrative credentials   even for a single operation   requires exposing the system to greater risk for the entire running time of the application.</span></span> <span data-ttu-id="9c66d-134">Anche gli utenti standard senza alcuna possibilità di elevare i propri privilegi sono comuni nelle impostazioni di famiglia e business.</span><span class="sxs-lookup"><span data-stu-id="9c66d-134">Standard users without any ability to elevate their privileges are also common in family and business settings.</span></span> <span data-ttu-id="9c66d-135">"Esegui come amministratore" non è una soluzione efficace per la compatibilità, espone l'utente e il sistema a un maggiore rischio di sicurezza e crea frustrazione per gli utenti in molte situazioni.</span><span class="sxs-lookup"><span data-stu-id="9c66d-135">"Run As Administrator" is not a good workaround for compatibility, exposes the user and the system to greater security risk, and creates frustration for users in many situations.</span></span>

> [!Note]  
> <span data-ttu-id="9c66d-136">La funzionalità di controllo dell'account utente introdotta in Windows Vista è disponibile anche in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="9c66d-136">The User Account Control feature introduced in Windows Vista is also present in Windows 7.</span></span> <span data-ttu-id="9c66d-137">Anche se l'esperienza utente che lavora con le varie funzionalità del sistema è stata migliorata rispetto al controllo dell'account utente, l'effetto sulle applicazioni è fondamentalmente lo stesso.</span><span class="sxs-lookup"><span data-stu-id="9c66d-137">While the user experience working with the various system features has been improved with respect to User Account Control, the impact on applications is basically the same.</span></span> <span data-ttu-id="9c66d-138">Tutte le raccomandazioni di Windows Vista in questo articolo si applicano anche a Windows 7.</span><span class="sxs-lookup"><span data-stu-id="9c66d-138">All of the Windows Vista recommendations in this article apply to Windows 7 as well.</span></span> <span data-ttu-id="9c66d-139">Per informazioni dettagliate sulle modifiche dell'interfaccia utente del controllo dell'account utente per Windows 7, vedere [interfaccia utente-aggiornamenti della finestra di dialogo controllo dell'account utente](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span><span class="sxs-lookup"><span data-stu-id="9c66d-139">For details on the UAC UI changes for Windows 7, see [User Interface - User Account Control Dialog Updates](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span></span>

 

## <a name="user-accounts-in-windows-vista"></a><span data-ttu-id="9c66d-140">Account utente in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="9c66d-140">User Accounts in Windows Vista</span></span>

<span data-ttu-id="9c66d-141">Windows Vista suddivide ogni utente in due tipi di account utente: amministratori e utenti standard.</span><span class="sxs-lookup"><span data-stu-id="9c66d-141">Windows Vista categorizes every user into two user account types: administrators and standard users.</span></span>

<span data-ttu-id="9c66d-142">Un account utente standard è simile a un account utente con limitazioni in Windows XP.</span><span class="sxs-lookup"><span data-stu-id="9c66d-142">A standard user account is similar to a limited-user account in Windows XP.</span></span> <span data-ttu-id="9c66d-143">Come in Windows XP, un utente standard non può scrivere nella cartella programmi, non è in grado di scrivere \_ nella \_ parte del registro di sistema HKEY locale e non può eseguire attività che modificano il sistema, ad esempio l'installazione di un driver in modalità kernel o l'accesso agli spazi dei processi a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="9c66d-143">Like in Windows XP, a standard user cannot write to the Program Files folder, cannot write to the HKEY\_LOCAL\_MACHINE portion of the registry, and cannot perform tasks that alter the system, such as installing a kernel-mode driver or accessing system-level process spaces.</span></span>

<span data-ttu-id="9c66d-144">L'account Administrator è stato modificato in modo significativo da quando è stato rilasciato Windows XP.</span><span class="sxs-lookup"><span data-stu-id="9c66d-144">The Administrator account has significantly changed since Windows XP was released.</span></span> <span data-ttu-id="9c66d-145">In precedenza, a tutti i processi avviati da un membro del gruppo Administrators venivano assegnati privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-145">Previously, all processes launched by a member of the Administrators group were given administrative privileges.</span></span> <span data-ttu-id="9c66d-146">Con UAC abilitato, tutti i processi vengono eseguiti con privilegi utente standard, a meno che non siano espressamente elevati da un amministratore.</span><span class="sxs-lookup"><span data-stu-id="9c66d-146">With UAC enabled, all processes execute with standard user privileges, unless specifically elevated by an administrator.</span></span> <span data-ttu-id="9c66d-147">Questa differenza rende più sicuri gli account nel gruppo Administrators, riducendo i rischi per la sicurezza causati da potenziali bug nella maggior parte dei programmi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-147">This difference makes accounts in the Administrators group more secure by reducing the security risk posed by potential bugs in most programs.</span></span>

<span data-ttu-id="9c66d-148">È importante che tutte le applicazioni, in particolare i giochi, funzionino in modo efficace e responsabile quando vengono eseguite come processo utente standard.</span><span class="sxs-lookup"><span data-stu-id="9c66d-148">It is important that all applications, especially games, operate effectively and responsibly when run as a standard user process.</span></span> <span data-ttu-id="9c66d-149">Tutte le operazioni che richiedono privilegi amministrativi devono essere eseguite in fase di installazione o da programmi ausiliari che richiedono in modo esplicito le credenziali amministrative.</span><span class="sxs-lookup"><span data-stu-id="9c66d-149">All operations that require administrative privileges should be done either at installation time or by auxiliary programs that explicitly request administrative credentials.</span></span> <span data-ttu-id="9c66d-150">Anche se l'elevazione dei privilegi è piuttosto semplice per un membro del gruppo Administrators, gli utenti standard devono rinviare a un utente con credenziali amministrative per immettere fisicamente la password per elevare i privilegi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-150">While privilege elevation is fairly trivial for a member of the Administrators group, standard users must defer to someone with administrative credentials to physically enter their password to elevate privileges.</span></span> <span data-ttu-id="9c66d-151">Poiché gli account protetti da controlli padre devono essere utenti standard, si tratta di una situazione molto comune per i giocatori che usano Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-151">Since accounts protected by parental controls must be standard users, this will be a very common situation for gamers who are using Windows Vista.</span></span>

<span data-ttu-id="9c66d-152">Se il gioco è già in esecuzione in Windows XP con account utente limitati, il passaggio al controllo dell'account utente in Windows Vista dovrebbe essere molto semplice.</span><span class="sxs-lookup"><span data-stu-id="9c66d-152">If your game is already working on Windows XP with limited-user accounts, then the move to User Account Control on Windows Vista should be very easy.</span></span> <span data-ttu-id="9c66d-153">La maggior parte di tali applicazioni funzionerà così com'è, anche se è consigliabile aggiungere un manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-153">The majority of such applications will work as-is, although adding an application manifest is highly recommended.</span></span> <span data-ttu-id="9c66d-154">I manifesti sono descritti più avanti in questo argomento in [impostazione del livello di esecuzione nel manifesto dell'applicazione](#setting-the-execution-level-in-the-application-manifest).</span><span class="sxs-lookup"><span data-stu-id="9c66d-154">(Manifests are described later in this topic in [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest).)</span></span>

## <a name="file-access-as-a-standard-user"></a><span data-ttu-id="9c66d-155">Accesso ai file come utente standard</span><span class="sxs-lookup"><span data-stu-id="9c66d-155">File Access as a Standard User</span></span>

<span data-ttu-id="9c66d-156">L'aspetto del gioco più interessato dalle restrizioni degli utenti standard è file system organizzazione e l'accessibilità.</span><span class="sxs-lookup"><span data-stu-id="9c66d-156">The aspect of your game most affected by standard user restrictions is file system organization and accessibility.</span></span> <span data-ttu-id="9c66d-157">Non presupporre mai che il gioco possa scrivere file nella cartella in cui è installato il gioco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-157">You should never assume that your game can write files to the folder where your game is installed.</span></span> <span data-ttu-id="9c66d-158">In Windows Vista, ad esempio, è necessario che i privilegi utente siano elevati dal sistema operativo prima che un'applicazione possa scrivere nella cartella programmi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-158">In Windows Vista for instance, a user s privileges must be elevated by the operating system before an application can write to the Program Files folder.</span></span> <span data-ttu-id="9c66d-159">Per evitare questo problema, è necessario categorizzare i file di dati del gioco in base all'ambito e all'accessibilità e usare la funzione [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) , insieme alle costanti CSIDL fornite dalla shell di Windows, per generare i percorsi di file appropriati.</span><span class="sxs-lookup"><span data-stu-id="9c66d-159">To avoid this, you should categorize your game s data files by scope and accessibility, and use the [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) function, along with the CSIDL constants provided by the Windows shell, to generate the appropriate file paths.</span></span> <span data-ttu-id="9c66d-160">Le costanti CSIDL corrispondono a cartelle note nel file system usato dal sistema operativo e promuove la partizione di file globali e specifici dell'utente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-160">The CSIDL constants correspond to known folders in the file system that the operating system uses and promotes to partition global and user-specific files.</span></span>

<span data-ttu-id="9c66d-161">Il tentativo di creare o scrivere un file o una directory in una cartella che non concede l'autorizzazione di scrittura al processo avrà esito negativo in Windows Vista se l'applicazione non dispone di privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-161">Attempting to create or write a file or directory under a folder which does not grant write permission to the process will fail under Windows Vista if the application does not have administrative privileges.</span></span> <span data-ttu-id="9c66d-162">Se il file eseguibile del gioco a 32 bit viene eseguito in modalità legacy, perché non dichiara un livello di esecuzione richiesto, le operazioni di scrittura avranno esito positivo, ma saranno soggette alla virtualizzazione, come descritto nella sezione "compatibilità UAC con i giochi meno recenti" più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-162">If your 32-bit game executable is running in legacy mode, because it did not declare a requested execution level, its write operations will succeed, but they will be subjected to virtualization as described in the section "UAC Compatibility with Older Games" later in this article.</span></span>

<span data-ttu-id="9c66d-163">**Tabella 1. Cartelle note**</span><span class="sxs-lookup"><span data-stu-id="9c66d-163">**Table 1. Known Folders**</span></span>



| <span data-ttu-id="9c66d-164">Nome CSIDL</span><span class="sxs-lookup"><span data-stu-id="9c66d-164">CSIDL Name</span></span>             | <span data-ttu-id="9c66d-165">Percorso tipico (Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="9c66d-165">Typical Path (Windows Vista)</span></span>                                                   | <span data-ttu-id="9c66d-166">Diritti utente standard</span><span class="sxs-lookup"><span data-stu-id="9c66d-166">Standard User Rights</span></span> | <span data-ttu-id="9c66d-167">Diritti di amministratore</span><span class="sxs-lookup"><span data-stu-id="9c66d-167">Administrator Rights</span></span> | <span data-ttu-id="9c66d-168">Ambito di accesso</span><span class="sxs-lookup"><span data-stu-id="9c66d-168">Access Scope</span></span> | <span data-ttu-id="9c66d-169">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9c66d-169">Description</span></span>                                                                                                                      | <span data-ttu-id="9c66d-170">Esempi</span><span class="sxs-lookup"><span data-stu-id="9c66d-170">Examples</span></span>                                                          |
|------------------------|--------------------------------------------------------------------------------|----------------------|----------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
| <span data-ttu-id="9c66d-171">CSIDL \_ personale</span><span class="sxs-lookup"><span data-stu-id="9c66d-171">CSIDL\_PERSONAL</span></span>        | <span data-ttu-id="9c66d-172">C: \\ utenti \\ nome utente \\ documenti</span><span class="sxs-lookup"><span data-stu-id="9c66d-172">C:\\Users\\user name\\Documents</span></span>                                                | <span data-ttu-id="9c66d-173">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-173">Read/Write</span></span>           | <span data-ttu-id="9c66d-174">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-174">Read/Write</span></span>           | <span data-ttu-id="9c66d-175">Per-User</span><span class="sxs-lookup"><span data-stu-id="9c66d-175">Per-User</span></span>     | <span data-ttu-id="9c66d-176">File di giochi specifici dell'utente che vengono letti e modificati e possono essere modificati all'esterno del contesto del gioco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-176">User-specific game files that are read and modified and can be manipulated outside of the game context.</span></span>                          | <span data-ttu-id="9c66d-177">Schermate.</span><span class="sxs-lookup"><span data-stu-id="9c66d-177">Screen shots.</span></span> <span data-ttu-id="9c66d-178">File di gioco salvati con un'associazione di estensione di file.</span><span class="sxs-lookup"><span data-stu-id="9c66d-178">Saved game files with a file extension association.</span></span> |
| <span data-ttu-id="9c66d-179">\_AppData locale \_ CSIDL</span><span class="sxs-lookup"><span data-stu-id="9c66d-179">CSIDL\_LOCAL\_APPDATA</span></span>  | <span data-ttu-id="9c66d-180">C: \\ utenti \\ nome utente \\ AppData \\ locale</span><span class="sxs-lookup"><span data-stu-id="9c66d-180">C:\\Users\\user name\\AppData\\Local</span></span>                                           | <span data-ttu-id="9c66d-181">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-181">Read/Write</span></span>           | <span data-ttu-id="9c66d-182">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-182">Read/Write</span></span>           | <span data-ttu-id="9c66d-183">Per-User</span><span class="sxs-lookup"><span data-stu-id="9c66d-183">Per-User</span></span>     | <span data-ttu-id="9c66d-184">File di gioco specifici dell'utente che vengono letti e modificati e che vengono usati solo nel contesto del gioco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-184">User-specific game files that are read and modified and are of use only within the game context.</span></span>                                 | <span data-ttu-id="9c66d-185">File della cache dei giochi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-185">Game cache files.</span></span> <span data-ttu-id="9c66d-186">Configurazioni del lettore.</span><span class="sxs-lookup"><span data-stu-id="9c66d-186">Player configurations.</span></span>                          |
| <span data-ttu-id="9c66d-187">CSIDL \_ Common \_ AppData</span><span class="sxs-lookup"><span data-stu-id="9c66d-187">CSIDL\_COMMON\_APPDATA</span></span> | <span data-ttu-id="9c66d-188">C: \\ ProgramData</span><span class="sxs-lookup"><span data-stu-id="9c66d-188">C:\\ProgramData</span></span>                                                                | <span data-ttu-id="9c66d-189">Lettura/scrittura se il proprietario</span><span class="sxs-lookup"><span data-stu-id="9c66d-189">Read/Write if owner</span></span>  | <span data-ttu-id="9c66d-190">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-190">Read/Write</span></span>           | <span data-ttu-id="9c66d-191">Tutti gli utenti</span><span class="sxs-lookup"><span data-stu-id="9c66d-191">All Users</span></span>    | <span data-ttu-id="9c66d-192">File del gioco che possono essere creati da un utente e letti da tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="9c66d-192">Game files that can be created by a user and read by all users.</span></span> <span data-ttu-id="9c66d-193">L'accesso in scrittura viene concesso solo al creatore del file (proprietario).</span><span class="sxs-lookup"><span data-stu-id="9c66d-193">Write access is granted only to the creator of the file (owner).</span></span> | <span data-ttu-id="9c66d-194">Profili utente</span><span class="sxs-lookup"><span data-stu-id="9c66d-194">User Profiles</span></span>                                                     |
| <span data-ttu-id="9c66d-195">\_file di programma CSIDL \_</span><span class="sxs-lookup"><span data-stu-id="9c66d-195">CSIDL\_PROGRAM\_FILES</span></span>  | <span data-ttu-id="9c66d-196">C: \\ programmi</span><span class="sxs-lookup"><span data-stu-id="9c66d-196">C:\\Program Files</span></span><br/> <span data-ttu-id="9c66d-197">oppure</span><span class="sxs-lookup"><span data-stu-id="9c66d-197">or</span></span><br/> <span data-ttu-id="9c66d-198">C: \\ programmi (x86)</span><span class="sxs-lookup"><span data-stu-id="9c66d-198">C:\\Program Files (x86)</span></span> <br/> | <span data-ttu-id="9c66d-199">Sola lettura</span><span class="sxs-lookup"><span data-stu-id="9c66d-199">Read only</span></span>            | <span data-ttu-id="9c66d-200">Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="9c66d-200">Read/Write</span></span>           | <span data-ttu-id="9c66d-201">Tutti gli utenti</span><span class="sxs-lookup"><span data-stu-id="9c66d-201">All Users</span></span>    | <span data-ttu-id="9c66d-202">File di gioco statici scritti dal programma di installazione di Game s che vengono letti da tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="9c66d-202">Static game files written by the game s installer that are read by all users.</span></span>                                                    | <span data-ttu-id="9c66d-203">Asset del gioco, ad esempio materiali e mesh.</span><span class="sxs-lookup"><span data-stu-id="9c66d-203">Game assets, such as materials and meshes.</span></span>                        |



 

<span data-ttu-id="9c66d-204">Il gioco viene in genere installato in una cartella sotto la cartella rappresentata dalla \_ costante dei file di programma CSIDL \_ .</span><span class="sxs-lookup"><span data-stu-id="9c66d-204">Your game will typically be installed in a folder under the folder represented by the CSIDL\_PROGRAM\_FILES constant.</span></span> <span data-ttu-id="9c66d-205">Questo meccanismo non viene, tuttavia, sempre applicato.</span><span class="sxs-lookup"><span data-stu-id="9c66d-205">However, this is not always the case.</span></span> <span data-ttu-id="9c66d-206">È invece consigliabile usare un percorso relativo dal file eseguibile quando si generano stringhe di percorso in file o directory che si trovano nella cartella di installazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-206">You should instead use a relative path from your executable file when generating path strings to files or directories located under your installation folder.</span></span>

<span data-ttu-id="9c66d-207">Si consiglia inoltre di evitare i presupposti hardcoded sui percorsi di cartella noti.</span><span class="sxs-lookup"><span data-stu-id="9c66d-207">You should also refrain from hard-coded assumptions about the known folder paths.</span></span> <span data-ttu-id="9c66d-208">Ad esempio, in Windows XP Professional 64-bit Edition e Windows Vista x64, il percorso dei file di programma è C: \\ programmi (x86) per i programmi a 32 bit e c: programmi \\ per programmi a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="9c66d-208">For example, on Windows XP Professional 64-bit Edition and Windows Vista x64, the program files path is C:\\Program Files (x86) for 32-bit programs and C:\\Program Files for 64-bit programs.</span></span> <span data-ttu-id="9c66d-209">Questi percorsi noti vengono modificati da Windows XP e gli utenti possono riconfigurare il percorso di molte di queste cartelle e persino individuarle in unità diverse.</span><span class="sxs-lookup"><span data-stu-id="9c66d-209">These known paths are changed from Windows XP, and users can reconfigure the location of many of these folders and even locate them on different drives.</span></span> <span data-ttu-id="9c66d-210">Usare sempre le costanti CSIDL per evitare confusione e potenziali problemi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-210">So, always use the CSIDL constants to avoid confusion and potential problems.</span></span> <span data-ttu-id="9c66d-211">Installazione di Windows riconosce questi percorsi di cartelle note e sposta i dati quando si aggiorna il sistema operativo da Windows XP; al contrario, l'uso di posizioni non standard o di percorsi hardcoded potrebbe non riuscire dopo un aggiornamento del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-211">Windows Setup understands these known folder locations and will move the data when upgrading the operating system from Windows XP; in contrast, use of non-standard locations or hard-coded paths may well fail after an OS upgrade.</span></span>

<span data-ttu-id="9c66d-212">È necessario prestare attenzione alle minime differenze di usabilità tra le cartelle specifiche dell'utente specificate da CSIDL \_ Personal e CSIDL \_ Local \_ AppData.</span><span class="sxs-lookup"><span data-stu-id="9c66d-212">Attention should be given to the subtle usability differences between the user-specific folders specified by CSIDL\_PERSONAL and CSIDL\_LOCAL\_APPDATA.</span></span> <span data-ttu-id="9c66d-213">La procedura consigliata per selezionare la costante CSIDL da usare per la scrittura di un file consiste nell'usare CSIDL \_ Personal se si prevede che l'utente interagisca con il file, ad esempio facendo doppio clic su di esso per aprirlo in uno strumento o in un'applicazione e usare CSIDL \_ Local \_ AppData per altri file.</span><span class="sxs-lookup"><span data-stu-id="9c66d-213">The recommended practice for selecting the CSIDL constant to use for writing a file is to use CSIDL\_PERSONAL if the user is expected to interact with the file, such as double-clicking on it to open it in a tool or application, and to use CSIDL\_LOCAL\_APPDATA for other files.</span></span> <span data-ttu-id="9c66d-214">Entrambe le cartelle possono essere utilizzate dall'applicazione per archiviare e organizzare i file di dati specifici dell'utente, in quanto non esiste alcuna differenza nel loro ambito di accesso o livello di privilegio.</span><span class="sxs-lookup"><span data-stu-id="9c66d-214">Both folders can be leveraged by your application to store and organize user-specific data files, as there is no difference in their access scope or privilege level.</span></span> <span data-ttu-id="9c66d-215">È necessario prestare attenzione per creare nomi di percorso sufficientemente univoci da non essere in conflitto con altre applicazioni, ma sufficientemente breve da contenere il numero di caratteri nel percorso completo inferiore al valore di MAX \_ path, 260.</span><span class="sxs-lookup"><span data-stu-id="9c66d-215">Care should be taken to create path names that are unique enough to not collide with other applications, but short enough to keep the number of characters in the full path fewer than the value of MAX\_PATH, 260.</span></span>

<span data-ttu-id="9c66d-216">Il codice seguente fornisce un esempio di come scrivere un file in una cartella Nota:</span><span class="sxs-lookup"><span data-stu-id="9c66d-216">The following code provides an example of how to write a file to a known folder:</span></span>

``` syntax
#include <windows.h>
#include <shlobj.h>
#include <shlwapi.h>
        ...
        ...
        ...
        TCHAR strPath[MAX_PATH];
        if( SUCCEEDED(
        SHGetFolderPath( NULL, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, strPath ) ) )
        {
        PathAppend( strPath, TEXT( "Company Name\\Title" ) );

        if( !PathFileExists( strPath ) )
        {
        if( ERROR_SUCCESS != SHCreateDirectoryEx( NULL, strPath, NULL ) )
        return E_FAIL;
        }

        PathAppend( strPath, TEXT( "gamefile.txt" ) );

        // strPath is now something like:
        // C:\Users\<current user>\Documents\Company Name\Title\gamefile.txt
        // Open the file for writing
        HANDLE hFile = CreateFile(strPath, GENERIC_WRITE, NULL, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);

        if( INVALID_HANDLE_VALUE != hFile )
        {
        // TODO: Write to file
        CloseHandle(hFile);
        }
        }
```

## <a name="registry-access-as-a-standard-user"></a><span data-ttu-id="9c66d-217">Accesso al registro di sistema come utente standard</span><span class="sxs-lookup"><span data-stu-id="9c66d-217">Registry Access as a Standard User</span></span>

<span data-ttu-id="9c66d-218">L'accesso al registro di sistema da parte di un utente standard viene limitato in modo analogo al file system.</span><span class="sxs-lookup"><span data-stu-id="9c66d-218">Registry access by a standard user is restricted in a similar fashion as the file system.</span></span> <span data-ttu-id="9c66d-219">Un utente standard è autorizzato ad accedere in lettura a tutte le chiavi nel registro di sistema. Tuttavia, l'accesso in scrittura viene concesso solo al \_ \_ sottoalbero HKEY Current User (HKCU), mappato internamente alla sottochiave specifica dell'utente HKEY Users \_ \\ ID di sicurezza (SID) dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-219">A standard user is permitted read access to all keys in the registry; however, write access is only granted to the HKEY\_CURRENT\_USER (HKCU) subtree, which is mapped internally to the user-specific subkey HKEY\_USERS\\Security ID (SID) of current user.</span></span> <span data-ttu-id="9c66d-220">Un'applicazione che deve scrivere in un percorso del registro di sistema diverso \_ dall'utente corrente di HKEY \_ richiede privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-220">An application that needs to write to any registry location other than HKEY\_CURRENT\_USER requires administrative privileges.</span></span>

<span data-ttu-id="9c66d-221">Se l'applicazione a 32 bit non contiene un livello di esecuzione richiesto nel manifesto, tutte le scritture nel \_ software del \_ computer locale HKEY \\ verranno virtualizzate, mentre le Scritture in altre posizioni all'esterno dell' \_ utente corrente di HKEY \_ avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-221">If the 32-bit application does not contain a requested execution level in its manifest, then all writes to HKEY\_LOCAL\_MACHINE\\Software will be virtualized, while writes to other locations outside of HKEY\_CURRENT\_USER will fail.</span></span>

<span data-ttu-id="9c66d-222">Non è consigliabile archiviare dati persistenti nel registro di sistema, ad esempio la configurazione di un utente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-222">Storing persistent data in the registry, like a user's configuration, is not recommended.</span></span> <span data-ttu-id="9c66d-223">Il metodo preferito per archiviare i dati persistenti dal gioco consiste nel scrivere i dati nel file system chiamando [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) e ottenere il valore di una costante CSIDL, descritto nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-223">The preferred method of storing persistent data from your game is to write the data to the file system by calling [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) and to get the value of a CSIDL constant, described in the previous section.</span></span>

## <a name="privilege-elevation"></a><span data-ttu-id="9c66d-224">Elevazione dei privilegi</span><span class="sxs-lookup"><span data-stu-id="9c66d-224">Privilege Elevation</span></span>

<span data-ttu-id="9c66d-225">In Windows Vista, qualsiasi applicazione che richiede privilegi amministrativi deve dichiarare una richiesta di un livello di esecuzione amministrativa nel relativo manifesto (descritto nella sezione successiva [impostazione del livello di esecuzione nel manifesto dell'applicazione](#setting-the-execution-level-in-the-application-manifest)).</span><span class="sxs-lookup"><span data-stu-id="9c66d-225">In Windows Vista, any application that requires administrative privileges must declare a request for an administrative execution level in its manifest (described in the next section, [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest)).</span></span>

<span data-ttu-id="9c66d-226">L'elevazione dei privilegi, come è noto, è la procedura gestita da UAC per promuovere un processo a un processo amministrativo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-226">Elevation, as it is known, is the procedure driven by UAC to promote a process to an administrative process.</span></span> <span data-ttu-id="9c66d-227">I privilegi di un processo possono essere elevati solo in fase di creazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-227">The privileges of a process can only be elevated at creation time.</span></span> <span data-ttu-id="9c66d-228">Una volta creato, un processo non verrà mai promosso a un livello di privilegi più elevato.</span><span class="sxs-lookup"><span data-stu-id="9c66d-228">Once created, a process will never be promoted to a higher privilege level.</span></span> <span data-ttu-id="9c66d-229">Per questo motivo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-229">For this reason.</span></span> <span data-ttu-id="9c66d-230">le operazioni che richiedono credenziali amministrative devono essere isolate per separare i programmi di installazione e altri programmi ausiliari.</span><span class="sxs-lookup"><span data-stu-id="9c66d-230">operations that require administrative credentials should be isolated to separate installers and other auxiliary programs.</span></span>

<span data-ttu-id="9c66d-231">Al momento dell'esecuzione di un programma, il controllo dell'account utente controlla il livello di esecuzione richiesto nel manifesto e, se sono necessari privilegi elevati, richiede all'utente corrente una delle due finestre di dialogo standard: una per un utente standard e una per un amministratore.</span><span class="sxs-lookup"><span data-stu-id="9c66d-231">Upon execution of a program, UAC inspects the requested execution level in the manifest, and if elevated privileges are required, prompts the current user with one of two standard dialog boxes: one for a standard user and one for an administrator.</span></span>

<span data-ttu-id="9c66d-232">Se l'utente corrente è un utente standard, il controllo dell'account utente richiede le credenziali di un amministratore prima di consentire l'esecuzione del programma.</span><span class="sxs-lookup"><span data-stu-id="9c66d-232">If the current user is a standard user, UAC prompts the user for the credentials of an administrator before allowing the program to run.</span></span>

<span data-ttu-id="9c66d-233">**Figura 1. Richiedi a un utente standard di immettere le credenziali per un account amministrativo**</span><span class="sxs-lookup"><span data-stu-id="9c66d-233">**Figure 1. Prompt for a Standard User to enter credentials for an administrative account**</span></span>

![Richiedi a un utente standard di immettere le credenziali per un account amministrativo](images/uac-prompt-elevation.jpg)

<span data-ttu-id="9c66d-235">Se l'utente corrente è un amministratore, il controllo dell'account utente richiede l'autorizzazione dell'utente prima di consentire l'esecuzione del programma.</span><span class="sxs-lookup"><span data-stu-id="9c66d-235">If the current user is an administrator, UAC prompts the user for permission before allowing the program to run.</span></span>

<span data-ttu-id="9c66d-236">**Figura 2. Richiedere a un amministratore di autorizzare le modifiche al computer**</span><span class="sxs-lookup"><span data-stu-id="9c66d-236">**Figure 2. Prompt for an Administrator to authorize changes to the computer**</span></span>

![richiedere a un amministratore di autorizzare le modifiche al computer](images/uac-prompt-authorization.jpg)

<span data-ttu-id="9c66d-238">All'applicazione verranno concessi solo i privilegi amministrativi se un utente standard fornisce le credenziali amministrative corrette oppure un utente amministratore fornisce il riconoscimento; qualsiasi altra operazione causerà l'interruzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-238">The application will only be granted administrative privileges if a standard user provides the proper administrative credentials or an administrative user provides acknowledgement; anything else will cause the application to terminate.</span></span>

<span data-ttu-id="9c66d-239">È importante notare che un processo con privilegi elevati viene eseguito come utente amministratore che ha immesso le credenziali nella richiesta UAC anziché come utente standard attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="9c66d-239">It is important to note that a process with elevated privileges runs as the administrative user who entered credentials in the UAC prompt rather than as the standard user who is currently logged in.</span></span> <span data-ttu-id="9c66d-240">Questa operazione è simile a **RunAs** in Windows XP. il processo con privilegi elevati ottiene la cartella dell'amministratore e le chiavi del registro di sistema durante l'accesso ai dati per utente e tutti i programmi avviati dal processo con privilegi elevati ereditano anche i diritti amministrativi e le posizioni degli account utente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-240">This is similar to **RunAs** in Windows XP   the elevated process gets the administrator's folder and registry keys when accessing per-user data, and all programs that the elevated process launches also inherit both the administrative rights and user account locations.</span></span> <span data-ttu-id="9c66d-241">Per gli amministratori che riceveranno la richiesta di riconoscimento (**continua** o **Annulla**), questi percorsi corrisponderanno alle località dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-241">For administrators who are prompted for acknowledgement (**Continue** or **Cancel**), these locations will match the currently user's locations.</span></span> <span data-ttu-id="9c66d-242">In generale, tuttavia, i processi che richiedono l'elevazione non devono funzionare sui dati per utente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-242">In general, however, processes that require elevation should not operate on per-user data.</span></span> <span data-ttu-id="9c66d-243">Si noti che questo può influire sostanzialmente sulla modalità di funzionamento del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-243">Note that this can substantially affect how your installer must operate!</span></span> <span data-ttu-id="9c66d-244">Se il programma di installazione, eseguito come amministratore, scrive in HKCU o nel profilo di un utente, potrebbe essere molto corretto scrivere nel percorso errato.</span><span class="sxs-lookup"><span data-stu-id="9c66d-244">If the installer, running as an administrator, writes to HKCU or to a user's profile, it may very well be writing to the wrong location.</span></span> <span data-ttu-id="9c66d-245">Si consiglia di creare questi valori per utente alla prima esecuzione del gioco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-245">Consider creating these per-user values upon the first run of the game.</span></span>

## <a name="uac-implications-with-createprocess"></a><span data-ttu-id="9c66d-246">Implicazioni del controllo dell'account utente con CreateProcess ()</span><span class="sxs-lookup"><span data-stu-id="9c66d-246">UAC Implications with CreateProcess()</span></span>

<span data-ttu-id="9c66d-247">Il meccanismo di elevazione del controllo dell'account utente non verrà richiamato da una chiamata alla funzione Win32 [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)() per avviare un eseguibile configurato in modo da richiedere un livello di esecuzione superiore rispetto al processo corrente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-247">The UAC elevation mechanism will not be invoked from a call to the Win32 [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)() function to start an executable which is configured to require a higher execution level than the current process.</span></span> <span data-ttu-id="9c66d-248">Di conseguenza, la chiamata a **CreateProcess**() avrà esito negativo con [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)() che restituisce l'elevazione degli errori \_ \_ necessaria.</span><span class="sxs-lookup"><span data-stu-id="9c66d-248">As a result, the call to **CreateProcess**() will fail with [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)() returning ERROR\_ELEVATION\_REQUIRED.</span></span> <span data-ttu-id="9c66d-249">**CreateProcess**() avrà esito positivo solo se il livello di esecuzione del chiamato è uguale o minore di quello del chiamante.</span><span class="sxs-lookup"><span data-stu-id="9c66d-249">**CreateProcess**() will only succeed when the execution level of the callee is equal-to or less-than that of the caller.</span></span> <span data-ttu-id="9c66d-250">Un processo non con privilegi elevati che deve generare processi con privilegi elevati dovrebbe farlo utilizzando la funzione [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)(), che determina l'attivazione del meccanismo di elevazione del controllo dell'account utente tramite la Shell.</span><span class="sxs-lookup"><span data-stu-id="9c66d-250">A non-elevated process that must spawn elevated processes should do so using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)() function, which will cause the UAC elevation mechanism to be triggered by means of the shell.</span></span>

## <a name="setting-the-execution-level-in-the-application-manifest"></a><span data-ttu-id="9c66d-251">Impostazione del livello di esecuzione nel manifesto dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="9c66d-251">Setting the Execution Level in the Application Manifest</span></span>

<span data-ttu-id="9c66d-252">Per dichiarare il livello di esecuzione richiesto del gioco è necessario aggiungere un'estensione al manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-252">You declare the requested execution level of your game by adding an extension to the application s manifest.</span></span> <span data-ttu-id="9c66d-253">Nel codice XML seguente viene illustrata la configurazione minima necessaria per impostare il livello di esecuzione per un'applicazione:</span><span class="sxs-lookup"><span data-stu-id="9c66d-253">The following XML code shows the minimal configuration required to set the execution level for an application:</span></span>

``` syntax
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <ms_asmv2:trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
        <ms_asmv2:security>
            <ms_asmv2:requestedPrivileges>
                <ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
            </ms_asmv2:requestedPrivileges>
        </ms_asmv2:security>
    </ms_asmv2:trustInfo>
</assembly>
```

<span data-ttu-id="9c66d-254">Nel codice precedente, il sistema operativo viene informato che il gioco richiede solo privilegi utente standard con il seguente tag:</span><span class="sxs-lookup"><span data-stu-id="9c66d-254">In the preceding code, the operating system is informed that the game only requires standard user privileges by the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
```

<span data-ttu-id="9c66d-255">Impostando in modo esplicito requestedExecutionLevel su "asInvoker", questo esempio dichiara al sistema operativo che il gioco si comporterà correttamente senza privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-255">By explicitly setting requestedExecutionLevel to "asInvoker", this example asserts to the operating system that the game will behave properly without administrative privileges.</span></span> <span data-ttu-id="9c66d-256">Di conseguenza, UAC Disabilita la virtualizzazione ed esegue il gioco con gli stessi privilegi dell'invoker, che in genere è privilegi utente standard, perché Esplora risorse viene eseguito come utente standard.</span><span class="sxs-lookup"><span data-stu-id="9c66d-256">As a result, UAC disables virtualization and runs the game with the same privileges as the invoker   which is typically standard user privileges, since Windows Explorer runs as standard user.</span></span>

<span data-ttu-id="9c66d-257">Il sistema operativo può essere informato che un gioco richiede l'elevazione dei privilegi amministrativi sostituendo "asInvoker" con "requireAdministrator" per creare il tag seguente:</span><span class="sxs-lookup"><span data-stu-id="9c66d-257">The operating system can be informed a game requires elevation to administrative privileges by replacing "asInvoker" with "requireAdministrator", to create the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="requireAdministrator" uiAccess="false" />
```

<span data-ttu-id="9c66d-258">Con questa configurazione, il sistema operativo chiede all'utente corrente una delle finestre di dialogo di elevazione del controllo dell'account utente standard ogni volta che viene eseguito il gioco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-258">With this configuration, the operating system prompts the current user with one of the standard UAC elevation dialogs every time that the game is executed.</span></span> <span data-ttu-id="9c66d-259">È consigliabile che nessun gioco richieda privilegi di amministratore per l'esecuzione, perché non solo questa finestra di dialogo diventa fastidiosa, ma rende anche il gioco incompatibile con i controlli padre.</span><span class="sxs-lookup"><span data-stu-id="9c66d-259">It is highly recommended that no game require administrator privileges to run, because not only will this dialog quickly become annoying, but it also makes the game incompatible with parental controls.</span></span> <span data-ttu-id="9c66d-260">Valutare attentamente prima di aggiungere questo requisito a qualsiasi eseguibile.</span><span class="sxs-lookup"><span data-stu-id="9c66d-260">Think very carefully before adding this requirement to any executable.</span></span>

<span data-ttu-id="9c66d-261">Un malinteso comune è che l'aggiunta di un manifesto che imposta requestedExecutionLevel su "requireAdministrator" Ignora la necessità di una richiesta di elevazione dei privilegi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-261">A common misconception is that adding a manifest that sets requestedExecutionLevel to "requireAdministrator" bypasses the need for an elevation prompt.</span></span> <span data-ttu-id="9c66d-262">Risposta errata.</span><span class="sxs-lookup"><span data-stu-id="9c66d-262">This is not true.</span></span> <span data-ttu-id="9c66d-263">Impedisce semplicemente al sistema operativo di indovinare se l'applicazione di installazione o aggiornamento necessita di privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-263">It simply prevents the operating system from guessing whether your setup or update application needs administrative privileges.</span></span> <span data-ttu-id="9c66d-264">All'utente viene comunque richiesto di autorizzare l'elevazione dei privilegi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-264">The user is still prompted to authorize elevation.</span></span>

<span data-ttu-id="9c66d-265">Windows controlla la firma di qualsiasi applicazione contrassegnata per l'elevazione dei privilegi prima di visualizzare il prompt di controllo dell'account utente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-265">Windows checks the signature of any application that is marked for elevation before it displays the UAC prompt.</span></span> <span data-ttu-id="9c66d-266">Un file eseguibile di grandi dimensioni contrassegnato per l'elevazione dei privilegi richiede più tempo rispetto a un file eseguibile di piccole dimensioni e più lungo di un file eseguibile contrassegnato come "asInvoker".</span><span class="sxs-lookup"><span data-stu-id="9c66d-266">A large executable that is marked for elevation takes longer to check than a small executable and longer than an executable that is marked as "asInvoker".</span></span> <span data-ttu-id="9c66d-267">Gli eseguibili di installazione autoestraenti dovrebbero pertanto essere contrassegnati come "asInvoker" e qualsiasi parte che deve essere contrassegnata come "requireAdministrator" deve essere inserita in un eseguibile di helper separato.</span><span class="sxs-lookup"><span data-stu-id="9c66d-267">Setup executables that are self-extracting should, therefore, be marked as "asInvoker", and any portion that needs to be marked as "requireAdministrator" should be placed in a separate helper executable.</span></span>

<span data-ttu-id="9c66d-268">L'attributo uiAccess, illustrato negli esempi precedenti, deve sempre essere FALSE per i giochi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-268">The uiAccess attribute, shown in the preceding examples, should always be FALSE for games.</span></span> <span data-ttu-id="9c66d-269">Questo attributo specifica se i client di automazione interfaccia utente hanno accesso all'interfaccia utente del sistema protetto e presenta implicazioni di sicurezza speciali se impostate su TRUE.</span><span class="sxs-lookup"><span data-stu-id="9c66d-269">This attribute specifies whether UI automation clients have access to the protected system UI, and it has special security implications if set to TRUE.</span></span>

## <a name="embedding-a-manifest-in-visual-studio"></a><span data-ttu-id="9c66d-270">Incorporamento di un manifesto in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="9c66d-270">Embedding a Manifest in Visual Studio</span></span>

<span data-ttu-id="9c66d-271">Il supporto del manifesto è stato aggiunto per la prima volta a Visual Studio a partire da VS2005.</span><span class="sxs-lookup"><span data-stu-id="9c66d-271">Manifest support was first added to Visual Studio beginning in VS2005.</span></span> <span data-ttu-id="9c66d-272">Per impostazione predefinita, un file eseguibile compilato in Visual Studio 2005 (o versione successiva) avrà un manifesto generato automaticamente incorporato nell'ambito del processo di compilazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-272">By default, an executable built in Visual Studio 2005 (or newer) will have an auto-generated manifest embedded in it as part of the build process.</span></span> <span data-ttu-id="9c66d-273">Il contenuto del manifesto generato automaticamente dipende da determinate configurazioni di progetto specificate nella finestra di dialogo delle proprietà del progetto.</span><span class="sxs-lookup"><span data-stu-id="9c66d-273">The contents of the auto-generated manifest are dependent on certain project configurations that you specify in the project properties dialog.</span></span>

<span data-ttu-id="9c66d-274">Il manifesto generato automaticamente da Visual Studio 2005 non conterrà un <trustInfo> blocco poiché non esiste alcun modo per configurare il livello di esecuzione del controllo dell'account utente nelle proprietà del progetto.</span><span class="sxs-lookup"><span data-stu-id="9c66d-274">The manifest that is auto-generated by Visual Studio 2005 will not contain a <trustInfo> block as there is no way to configure the UAC execution level in the project properties.</span></span> <span data-ttu-id="9c66d-275">Il modo migliore per aggiungere queste informazioni consiste nel consentire a VS2005 di unire un manifesto definito dall'utente contenente il <trustInfo> blocco con il manifesto generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-275">The preferred way to add this information is to let VS2005 merge a user-defined manifest containing the <trustInfo> block with the auto-generated manifest.</span></span> <span data-ttu-id="9c66d-276">Questa operazione è semplice quanto l'aggiunta \* di un file con estensione manifest alla soluzione che contiene il codice XML riportato nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-276">This is as simple as adding a \*.manifest file to your solution that contains the XML listed in the previous section.</span></span> <span data-ttu-id="9c66d-277">Quando Visual Studio rileva un file con estensione manifest nella soluzione, richiamerà automaticamente lo strumento Manifesto (mt.exe) per unire i file. manifest con quello generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-277">When Visual Studio encounters a .manifest file in your solution, it will automatically invoke the Manifest Tool (mt.exe) to merge the .manifest files with the auto-generated one.</span></span>

> [!Note]  
> <span data-ttu-id="9c66d-278">È presente un bug nello strumento Manifesto (mt.exe) fornito da Visual Studio 2005 che produce un manifesto Unito e incorporato che può causare problemi quando il file eseguibile viene eseguito in Windows XP prima di SP3.</span><span class="sxs-lookup"><span data-stu-id="9c66d-278">There is a bug in the Manifest Tool (mt.exe) provided by Visual Studio 2005 that results in a merged and embedded manifest which can cause problems when the executable is run on Windows XP prior to SP3.</span></span> <span data-ttu-id="9c66d-279">Il bug è il risultato del modo in cui lo strumento ridefinisce lo spazio dei nomi predefinito alla dichiarazione del <trustInfo> blocco.</span><span class="sxs-lookup"><span data-stu-id="9c66d-279">The bug is a result of how the tool redefines the default namespace upon declaration of the <trustInfo> block.</span></span> <span data-ttu-id="9c66d-280">Fortunatamente, è facile ignorare completamente il problema dichiarando in modo esplicito uno spazio dei nomi diverso nel <trustInfo> blocco e definendo l'ambito dei nodi figlio al nuovo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-280">Fortunately, it is easy to bypass the issue entirely by explicitly declaring a different namespace in the <trustInfo> block and by scoping the child nodes to the new namespace.</span></span> <span data-ttu-id="9c66d-281">Il codice XML fornito nella sezione precedente illustra questa correzione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-281">The XML provided in the previous section demonstrates this fix.</span></span>

 

<span data-ttu-id="9c66d-282">Un avvertimento nell'uso dello strumento mt.exe incluso in Visual Studio 2005 è che genererà un avviso durante l'elaborazione del <trustInfo> blocco poiché lo strumento non contiene uno schema aggiornato per convalidare l'XML.</span><span class="sxs-lookup"><span data-stu-id="9c66d-282">A caveat in using the mt.exe tool included in Visual Studio 2005 is that it will generate a warning when processing the <trustInfo> block as the tool does not contain an updated schema to validate the XML against.</span></span> <span data-ttu-id="9c66d-283">Per risolvere il problema, è consigliabile sostituire tutti i file mt.exe nella directory di installazione di Visual Studio 2005 (sono presenti più istanze) con il mt.exe fornito nella Windows SDK più recente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-283">To remedy this warning, it is recommended that you replace all mt.exe files under the Visual Studio 2005 install directory (there are multiple instances) with the mt.exe provided in the latest Windows SDK.</span></span>

<span data-ttu-id="9c66d-284">A partire da Visual Studio 2008, è ora possibile specificare il livello di esecuzione di un'applicazione nella finestra di dialogo delle proprietà del progetto (Figura 3) o usando il flag del linker/MANIFESTUAC.</span><span class="sxs-lookup"><span data-stu-id="9c66d-284">Beginning in Visual Studio 2008, you can now specify an application's execution level from within the project properties dialog (Figure 3), or by using the /MANIFESTUAC linker flag.</span></span> <span data-ttu-id="9c66d-285">L'impostazione di queste opzioni causerà la generazione automatica e l'incorporamento di un manifesto con il <trustInfo> blocco appropriato nell'eseguibile da parte di Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="9c66d-285">Setting these options will cause Visual Studio 2008 to auto-generate and embed a manifest with the appropriate <trustInfo> block into the executable.</span></span>

<span data-ttu-id="9c66d-286">**Figura 3. Impostazione del livello di esecuzione in Visual Studio 2008**</span><span class="sxs-lookup"><span data-stu-id="9c66d-286">**Figure 3. Setting the execution level in Visual Studio 2008**</span></span>

![impostazione del livello di esecuzione in Visual Studio 2008](images/setting-execution-level-in-vs2008.jpg)

<span data-ttu-id="9c66d-288">È ancora possibile incorporare un manifesto in versioni precedenti di Visual Studio senza supporto per il manifesto, ma richiede più lavoro da parte dello sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="9c66d-288">Embedding a manifest in older versions of Visual Studio without manifest support is still possible, but does require more work from the developer.</span></span> <span data-ttu-id="9c66d-289">Per un esempio su come eseguire questa operazione, esaminare il progetto di Visual Studio 2003 incluso in qualsiasi esempio in DirectX SDK prima della versione di marzo 2008.</span><span class="sxs-lookup"><span data-stu-id="9c66d-289">For an example on how to do this, please examine the Visual Studio 2003 project included in any sample in the DirectX SDK prior to the March 2008 release.</span></span>

## <a name="uac-compatibility-with-older-games"></a><span data-ttu-id="9c66d-290">Compatibilità UAC con i giochi meno recenti</span><span class="sxs-lookup"><span data-stu-id="9c66d-290">UAC Compatibility with Older Games</span></span>

<span data-ttu-id="9c66d-291">Se il gioco sembra salvare e caricare correttamente un file nella directory programmi, ma non si verifica il file iOn Windows Vista, qualsiasi applicazione a 32 bit che non contiene un livello di esecuzione richiesto nel manifesto è considerata un'applicazione legacy.</span><span class="sxs-lookup"><span data-stu-id="9c66d-291">If your game appears to be saving and loading a file successfully to the Program Files directory, yet no evidence of the file iOn Windows Vista, any 32-bit application that does not contain a requested execution level in its manifest is considered a legacy application.</span></span> <span data-ttu-id="9c66d-292">Prima di Windows Vista, la maggior parte delle applicazioni veniva in genere eseguita dagli utenti con privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-292">Prior to Windows Vista, most applications were typically run by users with administrative privileges.</span></span> <span data-ttu-id="9c66d-293">Di conseguenza, queste applicazioni possono leggere e scrivere liberamente i file di sistema e le chiavi del registro di sistema e molti sviluppatori non hanno apportato le modifiche necessarie per funzionare correttamente con account utente limitati in Windows XP.</span><span class="sxs-lookup"><span data-stu-id="9c66d-293">As a result, these applications could freely read and write system files and registry keys, and many developers did not make the changes needed to work properly on Limited User Accounts on Windows XP.</span></span> <span data-ttu-id="9c66d-294">Tuttavia, in Windows Vista, le stesse applicazioni ora hanno esito negativo a causa di privilegi di accesso insufficienti nel nuovo modello di sicurezza, che impone l'esecuzione dell'utente standard per le applicazioni legacy.</span><span class="sxs-lookup"><span data-stu-id="9c66d-294">However on Windows Vista, these same applications would now fail due to insufficient access privileges under the new security model, which enforces standard user execution for legacy applications.</span></span> <span data-ttu-id="9c66d-295">Per attenuare l'effetto di questo problema, è stata aggiunta anche la virtualizzazione a Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-295">To mitigate the impact of this, virtualization was also added to Windows Vista.</span></span> <span data-ttu-id="9c66d-296">Grazie alla virtualizzazione, le migliaia di applicazioni legacy funzionano in modo ottimale in Windows Vista senza che sia necessario che tali applicazioni dispongano di privilegi elevati in qualsiasi momento semplicemente per poter eseguire alcune operazioni secondarie.</span><span class="sxs-lookup"><span data-stu-id="9c66d-296">Virtualization will keep thousands of legacy applications working well on Windows Vista without requiring those applications to have elevated privileges at all times simply to succeed at a few minor operations.</span></span> <span data-ttu-id="9c66d-297">trovate, è probabile che il gioco sia in esecuzione in modalità legacy ed è stato soggetto alla virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-297">s found, chances are your game is running in legacy mode and was subjected to virtualization.</span></span>

<span data-ttu-id="9c66d-298">La virtualizzazione influiscono sul file system e il registro di sistema reindirizzando le Scritture sensibili al sistema (e le successive operazioni del registro di sistema) a una posizione per utente all'interno del profilo dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-298">Virtualization affects the file system and registry by redirecting system-sensitive writes (and subsequent file or registry operations) to a per-user location within the current user's profile.</span></span> <span data-ttu-id="9c66d-299">Ad esempio, se un'applicazione tenta di scrivere nel file seguente:</span><span class="sxs-lookup"><span data-stu-id="9c66d-299">For example, if an application attempts to write to the following file:</span></span>

<dl> <span data-ttu-id="9c66d-300">C: \\ Program Files \\ nome società \\ titolo \\config.ini</span><span class="sxs-lookup"><span data-stu-id="9c66d-300">C:\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="9c66d-301">la scrittura viene reindirizzata automaticamente a:</span><span class="sxs-lookup"><span data-stu-id="9c66d-301">the write is automatically redirected to:</span></span>

<dl> <span data-ttu-id="9c66d-302">C: \\ Users \\ nome utente \\ AppData \\ Local \\ VirtualStore \\ Program Files \\ nome società \\ titolo \\config.ini</span><span class="sxs-lookup"><span data-stu-id="9c66d-302">C:\\Users\\user name\\AppData\\Local\\VirtualStore\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="9c66d-303">Analogamente, se un'applicazione tenta di scrivere un valore del registro di sistema simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="9c66d-303">Likewise, if an application attempts to write a registry value like the following:</span></span>

<dl> <span data-ttu-id="9c66d-304">\_ \_ \\ \\ Titolo nome società del software del computer locale HKEY \\</span><span class="sxs-lookup"><span data-stu-id="9c66d-304">HKEY\_LOCAL\_MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="9c66d-305">verrà reindirizzato al posto di:</span><span class="sxs-lookup"><span data-stu-id="9c66d-305">it will be redirected instead to:</span></span>

<dl> <span data-ttu-id="9c66d-306">HKEY \_ \_ \\ le classi software utente corrente \\ \\ VirtualStore \\ Machine \\ software \\ nome società \\ titolo</span><span class="sxs-lookup"><span data-stu-id="9c66d-306">HKEY\_CURRENT\_USER\\Software\\Classes\\VirtualStore\\MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="9c66d-307">I file e le chiavi del registro di sistema interessati dalla virtualizzazione sono accessibili solo da operazioni di file e registro di sistema da applicazioni virtualizzate eseguite con l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9c66d-307">Files and registry keys affected by virtualization are only be accessed by file and registry operations from virtualized applications that are running as the current user.</span></span>

<span data-ttu-id="9c66d-308">Tuttavia, esistono molte restrizioni per la virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-308">However, there are many restrictions to virtualization.</span></span> <span data-ttu-id="9c66d-309">Uno è che le applicazioni a 64 bit non vengono mai eseguite in modalità legacy per le operazioni di compatibilità soggette alla virtualizzazione nelle applicazioni a 32 bit riusciranno a funzionare solo a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="9c66d-309">One is that 64-bit applications are never run in legacy mode for compatibility   operations subjected to virtualization in 32-bit applications will just fail in 64-bit.</span></span> <span data-ttu-id="9c66d-310">Inoltre, se un'applicazione legacy in esecuzione come utente standard tenta di scrivere qualsiasi tipo di file eseguibile in un percorso che richiede credenziali amministrative, la virtualizzazione non verrà eseguita e la scrittura avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-310">Also if a legacy application running as a standard user tries to write any type of executable file to a location that requires administrative credentials, then virtualization will not occur and the write will fail.</span></span>

<span data-ttu-id="9c66d-311">**Figura 4. Processo di virtualizzazione**</span><span class="sxs-lookup"><span data-stu-id="9c66d-311">**Figure 4. Virtualization Process**</span></span>

![processo di virtualizzazione](images/uac-virtualization-process.jpg)

<span data-ttu-id="9c66d-313">Quando un'applicazione legacy tenta un'operazione di lettura in percorsi sensibili al sistema nel file system o nel registro di sistema, viene eseguita la ricerca per prima delle posizioni virtuali.</span><span class="sxs-lookup"><span data-stu-id="9c66d-313">When a legacy application attempts a read operation on system-sensitive locations in the file system or registry, the virtual locations are searched first.</span></span> <span data-ttu-id="9c66d-314">Se il file o la chiave del registro di sistema non viene trovata, il sistema operativo accede ai percorsi di sistema predefiniti.</span><span class="sxs-lookup"><span data-stu-id="9c66d-314">If the file or registry key is not found, then the operating system accesses the default system locations.</span></span>

<span data-ttu-id="9c66d-315">La virtualizzazione verrà rimossa dalle versioni successive di Windows, pertanto è importante non affidarsi a questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="9c66d-315">Virtualization will be removed from subsequent versions of Windows so it important not to rely on this feature.</span></span> <span data-ttu-id="9c66d-316">Al contrario, è necessario configurare in modo esplicito il manifesto dell'applicazione per i privilegi di amministratore o utente standard, in quanto questa operazione Disabilita la virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-316">Instead, you should explicitly configure your application manifest for either standard user or administrative privileges, as this will disable virtualization.</span></span> <span data-ttu-id="9c66d-317">Anche la virtualizzazione non è ovvia agli utenti finali, quindi anche se la virtualizzazione può consentire l'esecuzione dell'applicazione, può generare chiamate di supporto e renderlo difficile da risolvere per questi clienti.</span><span class="sxs-lookup"><span data-stu-id="9c66d-317">Virtualization is also not obvious to end users, so even though virtualization may allow your application to run, it can generate support calls and make it difficult to trouble-shoot for these customers.</span></span>

<span data-ttu-id="9c66d-318">Si noti che se UAC è disabilitato, anche la virtualizzazione è disabilitata.</span><span class="sxs-lookup"><span data-stu-id="9c66d-318">Note that if UAC is disabled, then virtualization is also disabled.</span></span> <span data-ttu-id="9c66d-319">Se la virtualizzazione è disabilitata, gli account utente standard si comportano esattamente come gli account utente limitati in Windows XP e le applicazioni legacy potrebbero non funzionare correttamente per gli utenti standard che altrimenti avrebbero avuto esito positivo a causa della virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-319">If virtualization is disabled, standard user accounts behave exactly like limited user accounts in Windows XP, and legacy applications may not function correctly for standard users that would otherwise have succeeded due to virtualization.</span></span>

## <a name="legacy-scenarios-and-manifests"></a><span data-ttu-id="9c66d-320">Scenari e manifesti legacy</span><span class="sxs-lookup"><span data-stu-id="9c66d-320">Legacy Scenarios and Manifests</span></span>

<span data-ttu-id="9c66d-321">Per la maggior parte degli scenari di utilizzo, è sufficiente contrassegnare il file con estensione exe con gli elementi del manifesto del controllo dell'account utente corretti e verificare che l'applicazione funzioni correttamente perché un utente standard è sufficiente per la compatibilità con UAC.</span><span class="sxs-lookup"><span data-stu-id="9c66d-321">For the majority of usage scenarios, simply marking the .exe with the correct UAC manifest elements and ensuring the application works correctly as a Standard User is sufficient for excellent UAC compatibility.</span></span> <span data-ttu-id="9c66d-322">La maggior parte dei giocatori esegue Windows Vista o Windows 7 con il controllo dell'account utente abilitato.</span><span class="sxs-lookup"><span data-stu-id="9c66d-322">Most gamers are running Windows Vista or Windows 7 with User Account Control enabled.</span></span> <span data-ttu-id="9c66d-323">Per Windows XP e gli utenti in Windows Vista o Windows7 con la funzionalità di controllo dell'account utente disabilitata, vengono in genere eseguiti usando gli account amministratore.</span><span class="sxs-lookup"><span data-stu-id="9c66d-323">For Windows XP and users on Windows Vista or Windows7 with the User Account Control feature disabled, they typically run using administrator accounts.</span></span> <span data-ttu-id="9c66d-324">Sebbene si tratti di una modalità di funzionamento meno sicura, in genere non si verificano problemi di compatibilità aggiuntivi, ma come indicato in precedenza, la disabilitazione di UAC Disabilita anche la virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-324">While this is a less secure mode of operation, it will generally not run into any additional compatibility issues although as noted above, disabling UAC disables virtualization as well.</span></span>

<span data-ttu-id="9c66d-325">Quando il programma è contrassegnato come "requireAdministrator" nel manifesto del controllo dell'account utente, è opportuno notare un particolare caso.</span><span class="sxs-lookup"><span data-stu-id="9c66d-325">There is a special case worth noting when the program is marked as "requireAdministrator" in the UAC manifest.</span></span> <span data-ttu-id="9c66d-326">In Windows XP e in Windows Vista o Windows 7 con controllo dell'account utente disabilitato, gli elementi manifesto del controllo dell'account utente vengono ignorati dal sistema.</span><span class="sxs-lookup"><span data-stu-id="9c66d-326">On Windows XP and on Windows Vista or Windows 7 with User Account Control disabled, the UAC manifest elements are ignored by the system.</span></span> <span data-ttu-id="9c66d-327">In questa situazione, gli utenti con account Administrator eseguiranno sempre tutti i programmi con diritti di amministratore completi, quindi questi programmi funzioneranno come previsto.</span><span class="sxs-lookup"><span data-stu-id="9c66d-327">In this situation, users with administrator accounts will always run all programs with full administrator rights, and thus these programs will function as expected.</span></span> <span data-ttu-id="9c66d-328">Gli utenti con restrizioni di Windows XP e gli utenti standard in esecuzione su Windows Vista o Windows 7, tuttavia, eseguiranno sempre questi programmi con diritti limitati e tutte le operazioni a livello di amministratore avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="9c66d-328">Windows XP Restricted Users and Standard Users running on Windows Vista or Windows 7, however, will always run these programs with restricted rights and all administrator-level operations will fail.</span></span> <span data-ttu-id="9c66d-329">È pertanto consigliabile che i programmi contrassegnati come "requiretAdministrator" chiamino [**IsUserAnAdmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) all'avvio e visualizzino un messaggio di errore irreversibile se restituisce false.</span><span class="sxs-lookup"><span data-stu-id="9c66d-329">It is therefore recommended that programs marked as "requiretAdministrator" call [**IsUserAnAdmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) on startup, and display a fatal error message if it returns FALSE.</span></span> <span data-ttu-id="9c66d-330">Per lo scenario di maggioranza precedente, questo avrà sempre esito positivo, ma offre un'esperienza utente migliore e un messaggio di errore chiaro per questa rara situazione.</span><span class="sxs-lookup"><span data-stu-id="9c66d-330">For the majority scenario above, this will always succeed, but provides a better user experience and a clear error message for this rare situation.</span></span>

## <a name="conclusion"></a><span data-ttu-id="9c66d-331">Conclusione</span><span class="sxs-lookup"><span data-stu-id="9c66d-331">Conclusion</span></span>

<span data-ttu-id="9c66d-332">Per gli sviluppatori di giochi che fanno riferimento all'ambiente multiutente di Windows, è fondamentale progettare il gioco per operare in modo efficace e responsabile.</span><span class="sxs-lookup"><span data-stu-id="9c66d-332">As a game developer targeting the Windows multi-user environment, it is imperative that you design your game to operate effectively and responsibly.</span></span> <span data-ttu-id="9c66d-333">Il file eseguibile principale del gioco non deve dipendere dai privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-333">Your game's main executable file should not be dependent on administrative privileges.</span></span> <span data-ttu-id="9c66d-334">Questo non solo impedisce l'aspetto delle richieste di elevazione ogni volta che viene eseguito il gioco, che può influire negativamente sull'esperienza utente complessiva, ma consente anche al gioco di sfruttare le altre funzionalità che richiedono l'esecuzione con privilegi utente standard, ad esempio i controlli padre.</span><span class="sxs-lookup"><span data-stu-id="9c66d-334">This not only prevents the appearance of prompts for elevation every time that your game is run   which can negatively impact the overall user experience   but it also enables your game to take advantage of other features that require execution with standard user privileges, such as Parental Controls.</span></span>

<span data-ttu-id="9c66d-335">Le applicazioni progettate correttamente per funzionare come con le credenziali di un utente standard (o un utente limitato) nelle versioni precedenti di Windows non saranno interessate dal controllo dell'account utente che verranno eseguite senza elevazione dei privilegi.</span><span class="sxs-lookup"><span data-stu-id="9c66d-335">Applications that are properly designed to operate as with the credentials of a standard user (or limited user) under previous versions of Windows will not be impacted by UAC   they will run without elevation.</span></span> <span data-ttu-id="9c66d-336">Tuttavia, devono includere un manifesto con il livello di esecuzione richiesto impostato su "asInvoker" per essere conforme agli standard dell'applicazione per vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-336">However, they should include a manifest with their requested execution level set to "asInvoker" to conform to application standards for Vista.</span></span>

## <a name="further-reading"></a><span data-ttu-id="9c66d-337">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="9c66d-337">Further Reading</span></span>

<span data-ttu-id="9c66d-338">Per assistenza sulla progettazione di applicazioni per Windows Vista che siano conformi a controllo dell'account utente, scaricare i white paper seguenti: [requisiti per lo sviluppo di applicazioni Windows Vista per la compatibilità con il controllo dell'account utente](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="9c66d-338">For assistance with designing applications for Windows Vista that are compliant with User Account Control, download the following white paper: [Windows Vista Application Development Requirements for User Account Control Compatibility](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span></span>

<span data-ttu-id="9c66d-339">In questa white paper vengono illustrati i passaggi dettagliati del processo di progettazione, oltre a esempi di codice, requisiti e procedure consigliate.</span><span class="sxs-lookup"><span data-stu-id="9c66d-339">This white paper provides detailed steps about the design process, along with code samples, requirements, and best practices.</span></span> <span data-ttu-id="9c66d-340">In questo documento vengono inoltre illustrati in dettaglio gli aggiornamenti tecnici e le modifiche apportate all'esperienza utente in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-340">This paper also details the technical updates and changes to the user experience in Windows Vista.</span></span>

<span data-ttu-id="9c66d-341">Per ulteriori informazioni su controllo dell'account utente, visitare [Windows Vista: controllo dell'account utente](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) in [Microsoft TechNet](https://www.microsoft.com/technet/).</span><span class="sxs-lookup"><span data-stu-id="9c66d-341">For more information about User Account Control, visit [Windows Vista: User Account Control](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) on [Microsoft TechNet](https://www.microsoft.com/technet/).</span></span>

<span data-ttu-id="9c66d-342">Un'altra risorsa utile è l'articolo [per insegnare alle app di giocare con il controllo dell'account utente di Windows Vista](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control), da [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), 2007 gennaio.</span><span class="sxs-lookup"><span data-stu-id="9c66d-342">Another useful resource is the article [Teach Your Apps To Play Nicely with Windows Vista User Account Control](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control), from [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), January 2007.</span></span> <span data-ttu-id="9c66d-343">In questo articolo vengono illustrati i problemi generali relativi alla compatibilità delle applicazioni, nonché i vantaggi e i problemi correlati all'utilizzo di pacchetti di Windows Installer in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="9c66d-343">This article discusses general issues of application compatibility, as well as the advantages and issues of using Windows Installer packages on Windows Vista.</span></span>

<span data-ttu-id="9c66d-344">Per altre informazioni sul bug e la correzione per mt.exe, lo strumento usato da Visual Studio 2005 per unire automaticamente e incorporare un manifesto in un eseguibile, vedere l'articolo relativo all' [esplorazione dei manifesti parte 2: spazi dei nomi predefiniti e manifesti UAC in Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) nel Blog di Chris Jackson su [MSDN](/archive/blogs/).</span><span class="sxs-lookup"><span data-stu-id="9c66d-344">For more information about the bug and the fix for mt.exe, the tool used by Visual Studio 2005 to automatically merge and embed a manifest into an executable, see [Exploring Manifests Part 2: Default Namespaces and UAC Manifests in Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) on Chris Jackson's blog on [MSDN](/archive/blogs/).</span></span>

 

