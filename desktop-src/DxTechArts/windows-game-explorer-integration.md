---
title: Esplora giochi di Windows per sviluppatori di giochi
description: Questo articolo illustra il processo di registrazione di un gioco con Esplora giochi e controlli padre in Windows Vista e Windows 7 usando il nuovo schema GDF.
ms.assetid: 628f14bf-2714-0d68-8267-4f7f48c2774a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7f59b90a23f407be3990a6a4e24b92d39e66852
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300106"
---
# <a name="windows-games-explorer-for-game-developers"></a><span data-ttu-id="fa535-103">Esplora giochi di Windows per sviluppatori di giochi</span><span class="sxs-lookup"><span data-stu-id="fa535-103">Windows Games Explorer for Game Developers</span></span>

<span data-ttu-id="fa535-104">Windows Vista migliora l'esperienza utente dei giochi in Windows, includendo Esplora giochi.</span><span class="sxs-lookup"><span data-stu-id="fa535-104">Windows Vista improves the user experience of gaming on Windows by including Games Explorer.</span></span> <span data-ttu-id="fa535-105">Game Explorer viene esposto nel menu Start di Windows Vista come cartella dei giochi e fornisce una posizione centralizzata per l'accesso ai giochi.</span><span class="sxs-lookup"><span data-stu-id="fa535-105">Games Explorer is exposed in the Windows Vista Start Menu as the Games folder and provides a central location for accessing games.</span></span>

<span data-ttu-id="fa535-106">A partire dalla versione di marzo 2009 di DirectX SDK, viene usato un nuovo schema del file di definizione del gioco (GDF) per supportare le funzionalità di Windows 7, del provider di giochi e del feed RSS e di IGameExplorer2.</span><span class="sxs-lookup"><span data-stu-id="fa535-106">Starting with the March 2009 release of the DirectX SDK, a new game definition file (GDF) schema is used to support features in Windows 7, Game Provider and RSS feed, and IGameExplorer2.</span></span> <span data-ttu-id="fa535-107">IGameExplorer2 è una nuova interfaccia di Windows 7 che semplifica il processo di integrazione di un gioco con Game Explorer.</span><span class="sxs-lookup"><span data-stu-id="fa535-107">IGameExplorer2 is a new interface on Windows 7 that simplifies the process of integrating a game with Games Explorer.</span></span>

<span data-ttu-id="fa535-108">Questo articolo illustra il processo di registrazione di un gioco con Esplora giochi e controlli padre in Windows Vista e Windows 7 usando il nuovo schema GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-108">This article outlines the process of registering a game with Games Explorer and parental controls on Windows Vista and Windows 7 by using the new GDF schema.</span></span>

<span data-ttu-id="fa535-109">Contenuto:</span><span class="sxs-lookup"><span data-stu-id="fa535-109">Contents:</span></span>

-   [<span data-ttu-id="fa535-110">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="fa535-110">Prerequisites</span></span>](#prerequisites)
-   [<span data-ttu-id="fa535-111">Integrazione con un programma di installazione</span><span class="sxs-lookup"><span data-stu-id="fa535-111">Integrating with an Installer</span></span>](#integrating-with-an-installer)
-   [<span data-ttu-id="fa535-112">Processo di integrazione</span><span class="sxs-lookup"><span data-stu-id="fa535-112">Integration Process</span></span>](#integration-process)
-   [<span data-ttu-id="fa535-113">Attività di Esplora giochi</span><span class="sxs-lookup"><span data-stu-id="fa535-113">Games Explorer Tasks</span></span>](#games-explorer-tasks)
-   [<span data-ttu-id="fa535-114">Integrazione in InstallScript</span><span class="sxs-lookup"><span data-stu-id="fa535-114">Integrating into InstallScript</span></span>](#integrating-into-installscript)
-   [<span data-ttu-id="fa535-115">Integrazione in un pacchetto MSI</span><span class="sxs-lookup"><span data-stu-id="fa535-115">Integrating into an MSI Package</span></span>](#integrating-into-an-msi-package)
-   [<span data-ttu-id="fa535-116">Suggerimenti per il debug</span><span class="sxs-lookup"><span data-stu-id="fa535-116">Debugging Tips</span></span>](#debugging-tips)
    -   [<span data-ttu-id="fa535-117">Eseguire il test con il codice di esempio</span><span class="sxs-lookup"><span data-stu-id="fa535-117">Test with sample code</span></span>](#test-with-sample-code)
    -   [<span data-ttu-id="fa535-118">Verificare che il gioco sia stato rimosso correttamente</span><span class="sxs-lookup"><span data-stu-id="fa535-118">Make sure that your game was removed properly</span></span>](#make-sure-that-your-game-was-removed-properly)
    -   [<span data-ttu-id="fa535-119">Assicurarsi di firmare con Authenticode</span><span class="sxs-lookup"><span data-stu-id="fa535-119">Be sure to sign using Authenticode</span></span>](#be-sure-to-sign-using-authenticode)
    -   [<span data-ttu-id="fa535-120">Assicurarsi che i controlli parentali siano disponibili</span><span class="sxs-lookup"><span data-stu-id="fa535-120">Be sure that parental controls are available</span></span>](#be-sure-that-parental-controls-are-available)
    -   [<span data-ttu-id="fa535-121">Verificare che le attività siano del tipo corretto</span><span class="sxs-lookup"><span data-stu-id="fa535-121">Verify that tasks are of the correct type</span></span>](#verify-that-tasks-are-of-the-correct-type)
    -   [<span data-ttu-id="fa535-122">Verificare i dati nel file binario di GDF</span><span class="sxs-lookup"><span data-stu-id="fa535-122">Verify the data in GDF binary</span></span>](#verify-the-data-in-gdf-binary)
-   [<span data-ttu-id="fa535-123">Summary</span><span class="sxs-lookup"><span data-stu-id="fa535-123">Summary</span></span>](#summary)

## <a name="prerequisites"></a><span data-ttu-id="fa535-124">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="fa535-124">Prerequisites</span></span>

<span data-ttu-id="fa535-125">Prima di poter integrare un gioco in Game Explorer, è necessario creare un file di definizione del gioco (GDF).</span><span class="sxs-lookup"><span data-stu-id="fa535-125">Before you can integrate a game into Games Explorer, you must create a game definition file (GDF).</span></span> <span data-ttu-id="fa535-126">Un oggetto GDF è un file XML che contiene i metadati che descrivono il gioco.</span><span class="sxs-lookup"><span data-stu-id="fa535-126">A GDF is an XML file that contains metadata that describes the game.</span></span> <span data-ttu-id="fa535-127">Nella versione di marzo 2009 di DirectX SDK è stata aggiunta una sezione per il provider di giochi, il feed RSS e l'attività di gioco allo schema GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-127">In the March 2009 release of the DirectX SDK, a section for game provider, RSS feed, and game task has been added to the GDF schema.</span></span> <span data-ttu-id="fa535-128">Per usare le istruzioni riportate in questo articolo, è necessario usare questo nuovo formato GDF per creare il file GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-128">To use the instructions in this article, you must use this new GDF format to create your GDF file.</span></span>

<span data-ttu-id="fa535-129">Microsoft fornisce uno strumento per la creazione di GDFs in DirectX SDK, editor di file di definizione del gioco, per semplificare il processo di creazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-129">Microsoft provides a tool for authoring GDFs in the DirectX SDK, Game Definition File Editor, to make this creation process easier.</span></span> <span data-ttu-id="fa535-130">Questo strumento consente inoltre di creare versioni localizzate di un GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-130">This tool also helps you create localized versions of a GDF.</span></span>

<span data-ttu-id="fa535-131">Dopo la creazione e la localizzazione di un GDF, il file deve essere incapsulato all'interno di una sezione delle risorse di un file binario (un eseguibile o DLL), oltre all'anteprima e all'icona del gioco.</span><span class="sxs-lookup"><span data-stu-id="fa535-131">Once a GDF has been authored and localized, it must be encapsulated within a resource section of a binary file (either an executable or DLL), along with the game's thumbnail and icon.</span></span> <span data-ttu-id="fa535-132">Il GDF contiene tutti i metadati associati al gioco, inclusa la classificazione del gioco.</span><span class="sxs-lookup"><span data-stu-id="fa535-132">The GDF contains all of the metadata associated with the game, including the game's rating.</span></span> <span data-ttu-id="fa535-133">I controlli padre di Windows usano la classificazione del gioco per consentire ai genitori di controllare l'accesso al gioco.</span><span class="sxs-lookup"><span data-stu-id="fa535-133">Windows Parental Controls use the game's rating to allow parents to control access to the game.</span></span> <span data-ttu-id="fa535-134">Il file binario che contiene l'oggetto GDF deve essere firmato digitalmente con un certificato Authenticode valido; in caso contrario, Esplora giochi e il sistema di controllo padre ignoreranno la classificazione del gioco, perché le informazioni relative alla classificazione non possono essere considerate attendibili senza certificazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-134">The binary file which contains the GDF must be digitally signed with a valid Authenticode certificate; otherwise, Games Explorer and the parental control system ignores the game's rating, because the rating information cannot be trusted without certification.</span></span> <span data-ttu-id="fa535-135">Per altri dettagli sulla firma del codice con Authenticode, vedere [firma Authenticode per sviluppatori di giochi](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="fa535-135">For more details about signing code with Authenticode, see [Authenticode Signing for Game Developers](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span></span>

## <a name="integrating-with-an-installer"></a><span data-ttu-id="fa535-136">Integrazione con un programma di installazione</span><span class="sxs-lookup"><span data-stu-id="fa535-136">Integrating with an Installer</span></span>

<span data-ttu-id="fa535-137">Per semplificare l'integrazione di Game Explorer, l'esempio GameUXInstallHelper fornisce un'API comune che può essere chiamata su Windows XP, Windows Vista e Windows 7.</span><span class="sxs-lookup"><span data-stu-id="fa535-137">To simplify Games Explorer integration, the GameUXInstallHelper sample provides a common API that can be called on Windows XP, Windows Vista, and Windows 7.</span></span> <span data-ttu-id="fa535-138">È progettato per funzionare con gli script per InstallShield e il sistema di installazione Wise, nonché per le azioni personalizzate MSI e gli strumenti di installazione personalizzati.</span><span class="sxs-lookup"><span data-stu-id="fa535-138">It is designed to work with scripts for InstallShield and Wise Installation System, as well as MSI custom actions and custom installation tools.</span></span> <span data-ttu-id="fa535-139">Il rilevamento del sistema operativo viene gestito all'interno di questa DLL di esempio, pertanto il chiamante non deve preoccuparsi se il client esegue Windows XP, Windows Vista o Windows 7.</span><span class="sxs-lookup"><span data-stu-id="fa535-139">Detection of the operating system is handled inside this sample DLL, so the caller does not need to worry whether the client is running Windows XP, Windows Vista, or Windows 7.</span></span>

<span data-ttu-id="fa535-140">Le funzioni esportate da questa DLL sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="fa535-140">The functions exported by this DLL are the following:</span></span>

<dl> <dt>

<span data-ttu-id="fa535-141"><span id="GameExplorerInstallW"></span><span id="gameexplorerinstallw"></span><span id="GAMEEXPLORERINSTALLW"></span>**GameExplorerInstallW**</span><span class="sxs-lookup"><span data-stu-id="fa535-141"><span id="GameExplorerInstallW"></span><span id="gameexplorerinstallw"></span><span id="GAMEEXPLORERINSTALLW"></span>**GameExplorerInstallW**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-142">Registra un gioco con Game Explorer, dato un percorso del file binario di GDF, il percorso completo della cartella in cui è installato il gioco e l'ambito di installazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-142">Registers a game with Games Explorer, given a path to the GDF binary, a full path to the folder where the game is installed, and the installation scope.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-143"><span id="GameExplorerInstallA"></span><span id="gameexplorerinstalla"></span><span id="GAMEEXPLORERINSTALLA"></span>**GameExplorerInstallA**</span><span class="sxs-lookup"><span data-stu-id="fa535-143"><span id="GameExplorerInstallA"></span><span id="gameexplorerinstalla"></span><span id="GAMEEXPLORERINSTALLA"></span>**GameExplorerInstallA**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-144">Registra un gioco con Game Explorer; Versione ANSI di **GameExplorerInstallW**.</span><span class="sxs-lookup"><span data-stu-id="fa535-144">Registers a game with Games Explorer; ANSI version of **GameExplorerInstallW**.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-145"><span id="GameExplorerUninstallW"></span><span id="gameexploreruninstallw"></span><span id="GAMEEXPLORERUNINSTALLW"></span>**GameExplorerUninstallW**</span><span class="sxs-lookup"><span data-stu-id="fa535-145"><span id="GameExplorerUninstallW"></span><span id="gameexploreruninstallw"></span><span id="GAMEEXPLORERUNINSTALLW"></span>**GameExplorerUninstallW**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-146">Rimuove un gioco dalla registrazione con Game Explorer, dato un percorso al file binario di GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-146">Removes a game from registration with Games Explorer, given a path to the GDF binary.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-147"><span id="GameExplorerUninstallA"></span><span id="gameexploreruninstalla"></span><span id="GAMEEXPLORERUNINSTALLA"></span>**GameExplorerUninstallA**</span><span class="sxs-lookup"><span data-stu-id="fa535-147"><span id="GameExplorerUninstallA"></span><span id="gameexploreruninstalla"></span><span id="GAMEEXPLORERUNINSTALLA"></span>**GameExplorerUninstallA**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-148">Rimuove un gioco dalla registrazione con Game Explorer; Versione ANSI di **GameExplorerUninstallW**.</span><span class="sxs-lookup"><span data-stu-id="fa535-148">Removes a game from registration with Games Explorer; ANSI version of **GameExplorerUninstallW**.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-149"><span id="GameExplorerSetMSIProperties"></span><span id="gameexplorersetmsiproperties"></span><span id="GAMEEXPLORERSETMSIPROPERTIES"></span>**GameExplorerSetMSIProperties**</span><span class="sxs-lookup"><span data-stu-id="fa535-149"><span id="GameExplorerSetMSIProperties"></span><span id="gameexplorersetmsiproperties"></span><span id="GAMEEXPLORERSETMSIPROPERTIES"></span>**GameExplorerSetMSIProperties**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-150">Configura le proprietà CustomActionData per le azioni di un'installazione personalizzata MSI posticipata.</span><span class="sxs-lookup"><span data-stu-id="fa535-150">Configures the CustomActionData properties for the actions of an MSI deferred custom installation.</span></span> <span data-ttu-id="fa535-151">L'utilizzo di questa funzione è descritto in dettaglio più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="fa535-151">Usage of this function is described in detail later in this article.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-152"><span id="GameExplorerInstallUsingMSI"></span><span id="gameexplorerinstallusingmsi"></span><span id="GAMEEXPLORERINSTALLUSINGMSI"></span>**GameExplorerInstallUsingMSI**</span><span class="sxs-lookup"><span data-stu-id="fa535-152"><span id="GameExplorerInstallUsingMSI"></span><span id="gameexplorerinstallusingmsi"></span><span id="GAMEEXPLORERINSTALLUSINGMSI"></span>**GameExplorerInstallUsingMSI**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-153">Aggiunge un gioco a Game Explorer; da usare durante un'installazione di un'azione personalizzata MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-153">Adds a game to Games Explorer; for use during an MSI custom action installation.</span></span>

</dd> <dt>

<span data-ttu-id="fa535-154"><span id="GameExplorerUninstallUsingMSI"></span><span id="gameexploreruninstallusingmsi"></span><span id="GAMEEXPLORERUNINSTALLUSINGMSI"></span>**GameExplorerUninstallUsingMSI**</span><span class="sxs-lookup"><span data-stu-id="fa535-154"><span id="GameExplorerUninstallUsingMSI"></span><span id="gameexploreruninstallusingmsi"></span><span id="GAMEEXPLORERUNINSTALLUSINGMSI"></span>**GameExplorerUninstallUsingMSI**</span></span>
</dt> <dd>

<span data-ttu-id="fa535-155">Rimuovere un gioco da Game Explorer; da usare durante un'installazione di un'azione personalizzata MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-155">Remove a game from Games Explorer; for use during an MSI custom action installation.</span></span>

</dd> </dl>

<span data-ttu-id="fa535-156">Queste funzioni sono descritte ulteriormente nell'intestazione GameUXInstallHelper. h.</span><span class="sxs-lookup"><span data-stu-id="fa535-156">These functions are further explained in the GameUXInstallHelper.h header.</span></span>

## <a name="integration-process"></a><span data-ttu-id="fa535-157">Processo di integrazione</span><span class="sxs-lookup"><span data-stu-id="fa535-157">Integration Process</span></span>

<span data-ttu-id="fa535-158">Quando il file GDF e i file correlati sono stati aggiunti a una risorsa binaria, è possibile integrare il gioco con Game Explorer.</span><span class="sxs-lookup"><span data-stu-id="fa535-158">Once the GDF and related files have been added to a binary resource, it is then possible to integrate the game with Games Explorer.</span></span> <span data-ttu-id="fa535-159">Con **GameUXInstallHelper** il processo di integrazione viene semplificato.</span><span class="sxs-lookup"><span data-stu-id="fa535-159">Using **GameUXInstallHelper** will simplify the integration process.</span></span> <span data-ttu-id="fa535-160">Per registrare il gioco con Game Explorer, chiamare **GameExplorerInstall** con il percorso del file binario di GDF, il percorso completo della cartella in cui è installato il gioco e l'ambito di installazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-160">To register the game with Games Explorer, call the **GameExplorerInstall** with a path to the GDF binary, a full path to the folder where the game is installed, and the installation scope.</span></span> <span data-ttu-id="fa535-161">Per rimuovere la registrazione del gioco, chiamare **GameExplorerUninstall** con un percorso del file binario di GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-161">To remove the game's registration, call **GameExplorerUninstall** with a path to the GDF binary.</span></span>

<span data-ttu-id="fa535-162">Si noti che il processo di rimozione rimuove solo un'installazione univoca.</span><span class="sxs-lookup"><span data-stu-id="fa535-162">Note that the removal process only removes one unique installation.</span></span> <span data-ttu-id="fa535-163">Se un gioco è stato installato più volte, è necessario ripetere questo processo per ogni installazione univoca.</span><span class="sxs-lookup"><span data-stu-id="fa535-163">If a game has been installed multiple times, this process must be repeated for each unique installation.</span></span>

## <a name="games-explorer-tasks"></a><span data-ttu-id="fa535-164">Attività di Esplora giochi</span><span class="sxs-lookup"><span data-stu-id="fa535-164">Games Explorer Tasks</span></span>

<span data-ttu-id="fa535-165">Le attività di Esplora giochi verranno visualizzate nel menu di scelta rapida di un elemento in Game Explorer.</span><span class="sxs-lookup"><span data-stu-id="fa535-165">Games Explorer tasks will appear in the context menu of an item in Games Explorer.</span></span> <span data-ttu-id="fa535-166">Le attività sono divise in attività di riproduzione e attività di supporto.</span><span class="sxs-lookup"><span data-stu-id="fa535-166">Tasks are divided into play tasks and support tasks.</span></span> <span data-ttu-id="fa535-167">Le attività di riproduzione avviano un gioco in una modalità specifica, mentre le attività di supporto servono qualsiasi altro scopo, incluso il collegamento a siti Web.</span><span class="sxs-lookup"><span data-stu-id="fa535-167">Play tasks launch a game into a particular mode, while support tasks serve any other purpose, including linking to web sites.</span></span>

<span data-ttu-id="fa535-168">In Windows Vista, le attività sono semplicemente collegamenti che si trovano in cartelle specifiche.</span><span class="sxs-lookup"><span data-stu-id="fa535-168">In Windows Vista, tasks are simply shortcuts that are located in specific folders.</span></span> <span data-ttu-id="fa535-169">Le attività di riproduzione e le attività di supporto vengono archiviate in cartelle con i nomi corrispondenti PlayTasks e SupportTasks.</span><span class="sxs-lookup"><span data-stu-id="fa535-169">Play tasks and support tasks are stored in folders with the corresponding names PlayTasks and SupportTasks.</span></span> <span data-ttu-id="fa535-170">GameUXInstallHelper può leggere le informazioni sulle attività del gioco dal file binario di GDF e creare automaticamente tutti i tasti di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="fa535-170">GameUXInstallHelper can read the game's task information from the GDF binary file and create all of the shortcuts automatically.</span></span>

<span data-ttu-id="fa535-171">In Windows 7, i collegamenti alle attività non sono necessari, perché Game Explorer Ottiene tutte le informazioni sulle attività direttamente dal file binario di GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-171">In Windows 7, the shortcuts to the tasks are not needed, because Games Explorer obtains all of the task information directly from the GDF binary file.</span></span>

## <a name="integrating-into-installscript"></a><span data-ttu-id="fa535-172">Integrazione in InstallScript</span><span class="sxs-lookup"><span data-stu-id="fa535-172">Integrating into InstallScript</span></span>

<span data-ttu-id="fa535-173">La chiamata di API di Esplora giochi dalla InstallScript di InstallShield è semplificata usando l'esempio GameUXInstallHelper.</span><span class="sxs-lookup"><span data-stu-id="fa535-173">Calling Games Explorer APIs from InstallShield's InstallScript is made easy by using the GameUXInstallHelper sample.</span></span> <span data-ttu-id="fa535-174">I passaggi necessari per l'integrazione con InstallShield sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="fa535-174">The steps required to integrate with InstallShield are as follows:</span></span>

1.  <span data-ttu-id="fa535-175">Aprire un progetto InstallScript nell'editor InstallShield.</span><span class="sxs-lookup"><span data-stu-id="fa535-175">Open an InstallScript project in the InstallShield editor.</span></span>
2.  <span data-ttu-id="fa535-176">Aggiungere GameUXInstallHelper.dll al progetto da installare nella directory di destinazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-176">Add GameUXInstallHelper.dll to the project to be installed to the target directory.</span></span>

    <span data-ttu-id="fa535-177">**Per aggiungere GameUXInstallHelper.dll a un progetto InstallScript:**</span><span class="sxs-lookup"><span data-stu-id="fa535-177">**To add GameUXInstallHelper.dll to an InstallScript project:**</span></span>

    1.  <span data-ttu-id="fa535-178">Nella scheda **progettazione installazione** fare clic su **dati applicazione** nel riquadro di spostamento a sinistra.</span><span class="sxs-lookup"><span data-stu-id="fa535-178">On the **Installation Designer** tab, click **Application Data** in the navigation pane on the left.</span></span>
    2.  <span data-ttu-id="fa535-179">Fare clic su **file e cartelle** e selezionare le **cartelle del computer di origine** per individuare GameUXInstallerHelper.dll nei **file del computer di origine**.</span><span class="sxs-lookup"><span data-stu-id="fa535-179">Click **Files and Folders** and browse in **Source computer's folders** to locate GameUXInstallerHelper.dll in **Source computer's files**.</span></span>

        <span data-ttu-id="fa535-180">Il percorso predefinito per GameUXInstallerHelper.dll è i campioni radice di DirectX SDK \\ \\ C++ \\ misc \\ bin \\ x86.</span><span class="sxs-lookup"><span data-stu-id="fa535-180">The default location for GameUXInstallerHelper.dll is DirectX SDK root\\Samples\\C++\\Misc\\Bin\\x86.</span></span>

    3.  <span data-ttu-id="fa535-181">In **cartelle del computer di destinazione** fare clic su **cartella di destinazione dell'applicazione**.</span><span class="sxs-lookup"><span data-stu-id="fa535-181">Under **Destination computer's folders**, click **Application Target Folder**.</span></span>
    4.  <span data-ttu-id="fa535-182">Trascinare GameUXInstallerHelper.dll dai **file del computer di origine** ai **file del computer di destinazione**.</span><span class="sxs-lookup"><span data-stu-id="fa535-182">Drag GameUXInstallerHelper.dll from **Source computer's files** to **Destination computer's files**.</span></span>

3.  <span data-ttu-id="fa535-183">In InstallScript Explorer fare clic sul file InstallScript (in genere Setup. rul) che chiama la funzione DLL.</span><span class="sxs-lookup"><span data-stu-id="fa535-183">In the InstallScript explorer, click the InstallScript file (usually setup.rul) that calls the DLL function.</span></span>
4.  <span data-ttu-id="fa535-184">Incollare il InstallScript seguente nel file:</span><span class="sxs-lookup"><span data-stu-id="fa535-184">Paste the following InstallScript into the file:</span></span>

    ``` syntax
    typedef GUID
    begin
    LONG  Data1;
    SHORT Data2;
    SHORT Data3;
    CHAR  Data4(8);
    end;

    prototype LONG GameUXInstallHelper.GameExplorerInstallW(WSTRING, WSTRING, NUMBER);
    prototype LONG GameUXInstallHelper.GameExplorerUninstallW(WSTRING);

    function OnMoved()

    WSTRING gdfbin[256];
    WSTRING path[256];
    NUMBER scope;

    begin

    if !MAINTENANCE then

    UseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UseDLL( WINSYSDIR ^ "OLE32.dll" );

    path = TARGETDIR;
    gdfbin = TARGETDIR ^ "bin\\ExampleGame.exe";  // TODO: Change this to point to binary containing the GDF

    if ALLUSERS == 1 then
    scope = 3;
    else
    scope = 2;
    endif;

    GameUXInstallHelper.GameExplorerInstallW( gdfbin, path, scope);

    UnUseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UnUseDLL( WINSYSDIR ^ "OLE32.dll" );

    endif;

    end;

    function OnMoving()

    WSTRING gdfbin[256];

    begin

    if MAINTENANCE && UNINST != "" then

    UseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UseDLL( WINSYSDIR ^ "OLE32.dll" );

    gdfbin = path ^ "bin\\ExampleGame.exe";  // TODO: Change this to point to binary containing the GDF

    GameUXInstallHelper.GameExplorerUninstallW(gdfbin);
    UnUseDLL( TARGETDIR ^ "GameUXInstallHelper.dll" );
    UnUseDLL( WINSYSDIR ^ "OLE32.dll" );

    endif;

    end;
    ```

## <a name="integrating-into-an-msi-package"></a><span data-ttu-id="fa535-185">Integrazione in un pacchetto MSI</span><span class="sxs-lookup"><span data-stu-id="fa535-185">Integrating into an MSI Package</span></span>

<span data-ttu-id="fa535-186">Di seguito è riportata una descrizione di alto livello dei passaggi necessari per chiamare le API di Esplora giochi usando le azioni personalizzate MSI:</span><span class="sxs-lookup"><span data-stu-id="fa535-186">The following is a high-level description of the steps required to call the Games Explorer APIs using MSI custom actions:</span></span>

1.  <span data-ttu-id="fa535-187">Aggiungere una proprietà alla tabella delle proprietà MSI denominata "RelativePathToGDF" contenente il percorso relativo del file binario di GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-187">Add a property to the MSI Property table called "RelativePathToGDF" containing the relative path to the GDF binary.</span></span>
2.  <span data-ttu-id="fa535-188">Dopo l'azione CostFinalize secondo, chiamare la funzione GameUXInstallHelper DLL **SetMSIGameExplorerProperties** in un'azione personalizzata immediata per impostare le proprietà MSI appropriate per le altre azioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="fa535-188">After the CostFinalize action, call the GameUXInstallHelper DLL function **SetMSIGameExplorerProperties** in an immediate custom action to set the appropriate MSI properties for the other custom actions.</span></span>
3.  <span data-ttu-id="fa535-189">Al momento dell'installazione, attivare un'azione personalizzata posticipata dopo l'azione InstallFiles che chiama la funzione DLL GameUXInstallHelper **AddToGameExplorerUsingMSI**.</span><span class="sxs-lookup"><span data-stu-id="fa535-189">Upon installation, trigger a deferred custom action after the InstallFiles action that calls the GameUXInstallHelper DLL function **AddToGameExplorerUsingMSI**.</span></span> <span data-ttu-id="fa535-190">Se l'installazione è per tutti gli utenti, l'azione personalizzata deve impostare il flag msidbCustomActionTypeNoImpersonate; in caso contrario, non deve impostare questo flag.</span><span class="sxs-lookup"><span data-stu-id="fa535-190">If the installation is for all users, then the custom action must set the flag msidbCustomActionTypeNoImpersonate; otherwise, it must not set this flag.</span></span> <span data-ttu-id="fa535-191">Sono pertanto definite due azioni personalizzate quasi identiche: GameUXAddAsAdmin e GameUXAddAsCurUser.</span><span class="sxs-lookup"><span data-stu-id="fa535-191">Therefore, two nearly identical custom actions are defined: GameUXAddAsAdmin and GameUXAddAsCurUser.</span></span>
4.  <span data-ttu-id="fa535-192">Al momento della rimozione dell'installazione, attivare un'azione personalizzata posticipata prima dell'azione RemoveFiles che chiama la funzione DLL GameUXInstallHelper **RemoveFromGameExplorerUsingMSI**.</span><span class="sxs-lookup"><span data-stu-id="fa535-192">Upon removal of the installation, trigger a deferred custom action before the RemoveFiles action that calls the GameUXInstallHelper DLL function **RemoveFromGameExplorerUsingMSI**.</span></span> <span data-ttu-id="fa535-193">Se l'installazione è stata eseguita per tutti gli utenti, l'azione personalizzata deve impostare il flag msidbCustomActionTypeNoImpersonate; in caso contrario, non deve impostare questo flag.</span><span class="sxs-lookup"><span data-stu-id="fa535-193">If the installation was for all users, then the custom action must set the flag msidbCustomActionTypeNoImpersonate; otherwise, it must not set this flag.</span></span> <span data-ttu-id="fa535-194">Sono pertanto definite due azioni personalizzate quasi identiche: GameUXRemoveAsAdmin e GameUXRemoveAsCurUser.</span><span class="sxs-lookup"><span data-stu-id="fa535-194">Therefore, two nearly identical custom actions are defined: GameUXRemoveAsAdmin and GameUXRemoveAsCurUser.</span></span>
5.  <span data-ttu-id="fa535-195">Definire le azioni personalizzate di rollback per gestire il caso in cui l'utente annulla l'installazione o la rimozione dopo che è già stata eseguita una delle azioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="fa535-195">Define rollback custom actions to handle the case where the user cancels installing or removing after one of the these custom actions has already happened.</span></span> <span data-ttu-id="fa535-196">Ciò comporta altre 4 azioni personalizzate: GameUXRollBackAddAsAdmin, GameUXRollBackAddAsCurUser, GameUXRollBackRemoveAsAdmin e GameUXRollBackRemoveAsCurUser.</span><span class="sxs-lookup"><span data-stu-id="fa535-196">This results in an additional 4 custom actions: GameUXRollBackAddAsAdmin, GameUXRollBackAddAsCurUser, GameUXRollBackRemoveAsAdmin, and GameUXRollBackRemoveAsCurUser.</span></span>

<span data-ttu-id="fa535-197">Questa procedura è descritta in dettaglio nelle istruzioni seguenti, che descrivono un processo che può essere eseguito usando un editor MSI, ad esempio l'editor ORCA disponibile in Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="fa535-197">This procedure is described in detail in the following instructions, which describe a process that can be done using an MSI editor, such as the Orca editor found in the Platform SDK.</span></span> <span data-ttu-id="fa535-198">Alcuni editor MSI hanno procedure guidate che semplificano alcuni di questi passaggi di configurazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-198">Some MSI editors have wizards which simplify some of these configuration steps.</span></span>

<span data-ttu-id="fa535-199">**Per configurare un pacchetto MSI per l'integrazione con Game Explorer**</span><span class="sxs-lookup"><span data-stu-id="fa535-199">**To configure an MSI package for integration with Games Explorer**</span></span>

1.  <span data-ttu-id="fa535-200">Aprire il pacchetto MSI in Orca.</span><span class="sxs-lookup"><span data-stu-id="fa535-200">Open the MSI package in Orca.</span></span>
2.  <span data-ttu-id="fa535-201">Aggiungere la riga illustrata nella tabella seguente alla tabella **binaria** nel pacchetto MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-201">Add the row shown in the following table to the **Binary** table in the MSI package.</span></span> 

    | <span data-ttu-id="fa535-202">Nome</span><span class="sxs-lookup"><span data-stu-id="fa535-202">Name</span></span>   | <span data-ttu-id="fa535-203">Data</span><span class="sxs-lookup"><span data-stu-id="fa535-203">Data</span></span>                                          |
    |--------|-----------------------------------------------|
    | <span data-ttu-id="fa535-204">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-204">GAMEUX</span></span> | <span data-ttu-id="fa535-205">percorso del file della DLL \\GameUXInstallHelper.dll</span><span class="sxs-lookup"><span data-stu-id="fa535-205">file path to the DLL\\GameUXInstallHelper.dll</span></span> |

    

     

    > [!Note]  
    > <span data-ttu-id="fa535-206">Questo file verrà incorporato nel pacchetto MSI, pertanto è necessario eseguire questo passaggio ogni volta che si ricompila GameUXInstallHelper.dll.</span><span class="sxs-lookup"><span data-stu-id="fa535-206">This file will be embedded in the MSI package, so you must do this step every time you recompile GameUXInstallHelper.dll.</span></span>

     

3.  <span data-ttu-id="fa535-207">Aggiungere le righe mostrate nella tabella seguente alla tabella **CustomAction** del pacchetto MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-207">Add the rows shown in the following table to the **CustomAction** table in the MSI package.</span></span>

    | <span data-ttu-id="fa535-208">Azione</span><span class="sxs-lookup"><span data-stu-id="fa535-208">Action</span></span>                        | <span data-ttu-id="fa535-209">Tipo</span><span class="sxs-lookup"><span data-stu-id="fa535-209">Type</span></span>                                                                                                                                                                                                   | <span data-ttu-id="fa535-210">Source (Sorgente)</span><span class="sxs-lookup"><span data-stu-id="fa535-210">Source</span></span> | <span data-ttu-id="fa535-211">Destinazione</span><span class="sxs-lookup"><span data-stu-id="fa535-211">Target</span></span>                         |
    |-------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|--------------------------------|
    | <span data-ttu-id="fa535-212">GameUXSetMSIProperties</span><span class="sxs-lookup"><span data-stu-id="fa535-212">GameUXSetMSIProperties</span></span>        | <span data-ttu-id="fa535-213">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue = 65</span><span class="sxs-lookup"><span data-stu-id="fa535-213">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue = 65</span></span>                                                                                                        | <span data-ttu-id="fa535-214">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-214">GAMEUX</span></span> | <span data-ttu-id="fa535-215">SetMSIGameExplorerProperties</span><span class="sxs-lookup"><span data-stu-id="fa535-215">SetMSIGameExplorerProperties</span></span>   |
    | <span data-ttu-id="fa535-216">GameUXAddAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-216">GameUXAddAsAdmin</span></span>              | <span data-ttu-id="fa535-217">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span><span class="sxs-lookup"><span data-stu-id="fa535-217">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span></span>                                 | <span data-ttu-id="fa535-218">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-218">GAMEUX</span></span> | <span data-ttu-id="fa535-219">AddToGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-219">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="fa535-220">GameUXAddAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-220">GameUXAddAsCurUser</span></span>            | <span data-ttu-id="fa535-221">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span><span class="sxs-lookup"><span data-stu-id="fa535-221">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span></span>                                                                      | <span data-ttu-id="fa535-222">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-222">GAMEUX</span></span> | <span data-ttu-id="fa535-223">AddToGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-223">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="fa535-224">GameUXRollBackAddAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-224">GameUXRollBackAddAsAdmin</span></span>      | <span data-ttu-id="fa535-225">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span><span class="sxs-lookup"><span data-stu-id="fa535-225">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span></span> | <span data-ttu-id="fa535-226">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-226">GAMEUX</span></span> | <span data-ttu-id="fa535-227">RemoveFromGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-227">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="fa535-228">GameUXRollBackAddAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-228">GameUXRollBackAddAsCurUser</span></span>    | <span data-ttu-id="fa535-229">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span><span class="sxs-lookup"><span data-stu-id="fa535-229">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span></span>                                      | <span data-ttu-id="fa535-230">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-230">GAMEUX</span></span> | <span data-ttu-id="fa535-231">RemoveFromGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-231">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="fa535-232">GameUXRemoveAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-232">GameUXRemoveAsAdmin</span></span>           | <span data-ttu-id="fa535-233">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span><span class="sxs-lookup"><span data-stu-id="fa535-233">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3137</span></span>                                 | <span data-ttu-id="fa535-234">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-234">GAMEUX</span></span> | <span data-ttu-id="fa535-235">RemoveFromGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-235">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="fa535-236">GameUXRemoveAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-236">GameUXRemoveAsCurUser</span></span>         | <span data-ttu-id="fa535-237">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span><span class="sxs-lookup"><span data-stu-id="fa535-237">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeInScript = 1089</span></span>                                                                      | <span data-ttu-id="fa535-238">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-238">GAMEUX</span></span> | <span data-ttu-id="fa535-239">RemoveFromGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-239">RemoveFromGameExplorerUsingMSI</span></span> |
    | <span data-ttu-id="fa535-240">GameUXRollBackRemoveAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-240">GameUXRollBackRemoveAsAdmin</span></span>   | <span data-ttu-id="fa535-241">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span><span class="sxs-lookup"><span data-stu-id="fa535-241">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript + msidbCustomActionTypeNoImpersonate = 3393</span></span> | <span data-ttu-id="fa535-242">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-242">GAMEUX</span></span> | <span data-ttu-id="fa535-243">AddToGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-243">AddToGameExplorerUsingMSI</span></span>      |
    | <span data-ttu-id="fa535-244">GameUXRollBackRemoveAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-244">GameUXRollBackRemoveAsCurUser</span></span> | <span data-ttu-id="fa535-245">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span><span class="sxs-lookup"><span data-stu-id="fa535-245">msidbCustomActionTypeDll + msidbCustomActionTypeBinaryData + msidbCustomActionTypeContinue + msidbCustomActionTypeRollback + msidbCustomActionTypeInScript = 1345</span></span>                                      | <span data-ttu-id="fa535-246">GAMEUX</span><span class="sxs-lookup"><span data-stu-id="fa535-246">GAMEUX</span></span> | <span data-ttu-id="fa535-247">AddToGameExplorerUsingMSI</span><span class="sxs-lookup"><span data-stu-id="fa535-247">AddToGameExplorerUsingMSI</span></span>      |

    

     

4.  <span data-ttu-id="fa535-248">Aggiungere i valori visualizzati per Action, Condition e Sequence nella tabella seguente alla tabella **InstallExecuteSequence** del pacchetto MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-248">Add the values shown for Action, Condition, and Sequence in the following table to the **InstallExecuteSequence** table in the MSI package.</span></span>

    | <span data-ttu-id="fa535-249">Azione</span><span class="sxs-lookup"><span data-stu-id="fa535-249">Action</span></span>                        | <span data-ttu-id="fa535-250">Condizione</span><span class="sxs-lookup"><span data-stu-id="fa535-250">Condition</span></span>                      | <span data-ttu-id="fa535-251">Sequenza</span><span class="sxs-lookup"><span data-stu-id="fa535-251">Sequence</span></span> | <span data-ttu-id="fa535-252">Note</span><span class="sxs-lookup"><span data-stu-id="fa535-252">Notes</span></span>                                                                                                                                                                                            |
    |-------------------------------|--------------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="fa535-253">GameUXSetMSIProperties</span><span class="sxs-lookup"><span data-stu-id="fa535-253">GameUXSetMSIProperties</span></span>        |                                | <span data-ttu-id="fa535-254">1015</span><span class="sxs-lookup"><span data-stu-id="fa535-254">1015</span></span>     | <span data-ttu-id="fa535-255">Il numero di sequenza inserisce l'azione subito dopo CostFinalize secondo.</span><span class="sxs-lookup"><span data-stu-id="fa535-255">The sequence number places the action soon after CostFinalize.</span></span>                                                                                                                                   |
    | <span data-ttu-id="fa535-256">GameUXAddAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-256">GameUXAddAsAdmin</span></span>              | <span data-ttu-id="fa535-257">NON installato e ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-257">NOT Installed AND ALLUSERS</span></span>     | <span data-ttu-id="fa535-258">4003</span><span class="sxs-lookup"><span data-stu-id="fa535-258">4003</span></span>     | <span data-ttu-id="fa535-259">Questa azione personalizzata verrà eseguita solo durante una nuova installazione per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="fa535-259">This custom action will only happen during a fresh installation for all users.</span></span> <span data-ttu-id="fa535-260">Il numero di sequenza inserisce l'azione dopo InstallFiles e dopo il rollback.</span><span class="sxs-lookup"><span data-stu-id="fa535-260">The sequence number places the action after InstallFiles and after the rollbacks.</span></span>                                 |
    | <span data-ttu-id="fa535-261">GameUXAddAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-261">GameUXAddAsCurUser</span></span>            | <span data-ttu-id="fa535-262">NON installato e non ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-262">NOT Installed AND NOT ALLUSERS</span></span> | <span data-ttu-id="fa535-263">4004</span><span class="sxs-lookup"><span data-stu-id="fa535-263">4004</span></span>     | <span data-ttu-id="fa535-264">Questa azione personalizzata verrà eseguita solo durante una nuova installazione solo per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="fa535-264">This custom action will only happen during a fresh installation for the current user only.</span></span> <span data-ttu-id="fa535-265">Il numero di sequenza inserisce l'azione dopo InstallFiles e dopo il rollback.</span><span class="sxs-lookup"><span data-stu-id="fa535-265">The sequence number places the action after InstallFiles and after the rollbacks.</span></span>                     |
    | <span data-ttu-id="fa535-266">GameUXRollBackAddAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-266">GameUXRollBackAddAsAdmin</span></span>      | <span data-ttu-id="fa535-267">NON installato e ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-267">NOT Installed AND ALLUSERS</span></span>     | <span data-ttu-id="fa535-268">4001</span><span class="sxs-lookup"><span data-stu-id="fa535-268">4001</span></span>     | <span data-ttu-id="fa535-269">Questa azione personalizzata verrà eseguita solo quando viene annullata una nuova installazione per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="fa535-269">This custom action will only happen when a fresh installation for all users is cancelled.</span></span> <span data-ttu-id="fa535-270">Il numero di sequenza inserisce l'azione dopo InstallFiles e prima dell'azione personalizzata Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="fa535-270">The sequence number places the action after InstallFiles and before the Add custom action.</span></span>             |
    | <span data-ttu-id="fa535-271">GameUXRollBackAddAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-271">GameUXRollBackAddAsCurUser</span></span>    | <span data-ttu-id="fa535-272">NON installato e non ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-272">NOT Installed AND NOT ALLUSERS</span></span> | <span data-ttu-id="fa535-273">4002</span><span class="sxs-lookup"><span data-stu-id="fa535-273">4002</span></span>     | <span data-ttu-id="fa535-274">Questa azione personalizzata verrà eseguita solo quando viene annullata una nuova installazione per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="fa535-274">This custom action will only happen when a fresh installation for the current user only is cancelled.</span></span> <span data-ttu-id="fa535-275">Il numero di sequenza inserisce l'azione dopo InstallFiles e prima dell'azione personalizzata Aggiungi.</span><span class="sxs-lookup"><span data-stu-id="fa535-275">The sequence number places the action after InstallFiles and before the Add custom action.</span></span> |
    | <span data-ttu-id="fa535-276">GameUXRemoveAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-276">GameUXRemoveAsAdmin</span></span>           | <span data-ttu-id="fa535-277">REMOVE ~ = "ALL" E ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-277">REMOVE~="ALL" AND ALLUSERS</span></span>     | <span data-ttu-id="fa535-278">3452</span><span class="sxs-lookup"><span data-stu-id="fa535-278">3452</span></span>     | <span data-ttu-id="fa535-279">Questa azione personalizzata verrà eseguita solo durante la rimozione di tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="fa535-279">This custom action will only happen during removal for all users.</span></span> <span data-ttu-id="fa535-280">Il numero di sequenza posiziona l'azione direttamente prima di RemoveFiles e dopo i rollback.</span><span class="sxs-lookup"><span data-stu-id="fa535-280">The sequence number places the action directly before RemoveFiles and after the rollbacks.</span></span>                                     |
    | <span data-ttu-id="fa535-281">GameUXRemoveAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-281">GameUXRemoveAsCurUser</span></span>         | <span data-ttu-id="fa535-282">REMOVE ~ = "ALL" E NON ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-282">REMOVE~="ALL" AND NOT ALLUSERS</span></span> | <span data-ttu-id="fa535-283">3453</span><span class="sxs-lookup"><span data-stu-id="fa535-283">3453</span></span>     | <span data-ttu-id="fa535-284">Questa azione personalizzata verrà eseguita solo durante la rimozione dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="fa535-284">This custom action will only happen during removal for the current user.</span></span> <span data-ttu-id="fa535-285">Il numero di sequenza posiziona l'azione direttamente prima di RemoveFiles e dopo i rollback.</span><span class="sxs-lookup"><span data-stu-id="fa535-285">The sequence number places the action directly before RemoveFiles and after the rollbacks.</span></span>                              |
    | <span data-ttu-id="fa535-286">GameUXRollBackRemoveAsAdmin</span><span class="sxs-lookup"><span data-stu-id="fa535-286">GameUXRollBackRemoveAsAdmin</span></span>   | <span data-ttu-id="fa535-287">REMOVE ~ = "ALL" E ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-287">REMOVE~="ALL" AND ALLUSERS</span></span>     | <span data-ttu-id="fa535-288">3450</span><span class="sxs-lookup"><span data-stu-id="fa535-288">3450</span></span>     | <span data-ttu-id="fa535-289">Questa azione personalizzata verrà eseguita solo quando viene annullata la rimozione per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="fa535-289">This custom action will only happen when removal for all users is cancelled.</span></span> <span data-ttu-id="fa535-290">Il numero di sequenza posiziona l'azione immediatamente prima di RemoveFiles e prima dell'azione personalizzata Rimuovi.</span><span class="sxs-lookup"><span data-stu-id="fa535-290">The sequence number places the action directly before RemoveFiles and before the Remove custom action.</span></span>              |
    | <span data-ttu-id="fa535-291">GameUXRollBackRemoveAsCurUser</span><span class="sxs-lookup"><span data-stu-id="fa535-291">GameUXRollBackRemoveAsCurUser</span></span> | <span data-ttu-id="fa535-292">REMOVE ~ = "ALL" E NON ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="fa535-292">REMOVE~="ALL" AND NOT ALLUSERS</span></span> | <span data-ttu-id="fa535-293">3451</span><span class="sxs-lookup"><span data-stu-id="fa535-293">3451</span></span>     | <span data-ttu-id="fa535-294">Questa azione personalizzata verrà eseguita solo quando viene annullata la rimozione per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="fa535-294">This custom action will only happen when removal for the current user is cancelled.</span></span> <span data-ttu-id="fa535-295">Il numero di sequenza posiziona l'azione immediatamente prima di RemoveFiles e prima dell'azione personalizzata Rimuovi.</span><span class="sxs-lookup"><span data-stu-id="fa535-295">The sequence number places the action directly before RemoveFiles and before the Remove custom action.</span></span>       |

    

     

5.  <span data-ttu-id="fa535-296">Aggiungere la riga illustrata nella tabella seguente alla tabella delle proprietà nel pacchetto MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-296">Add the row shown in the following table to the Property table in the MSI package.</span></span>

    | <span data-ttu-id="fa535-297">Proprietà</span><span class="sxs-lookup"><span data-stu-id="fa535-297">Property</span></span>          | <span data-ttu-id="fa535-298">Valore</span><span class="sxs-lookup"><span data-stu-id="fa535-298">Value</span></span>                                                         |
    |-------------------|---------------------------------------------------------------|
    | <span data-ttu-id="fa535-299">RelativePathToGDF</span><span class="sxs-lookup"><span data-stu-id="fa535-299">RelativePathToGDF</span></span> | <span data-ttu-id="fa535-300">nome del percorso file relativo \\ del file binario che contiene l'oggetto GDF</span><span class="sxs-lookup"><span data-stu-id="fa535-300">relative file path\\name of binary file that contains the GDF</span></span> |

    

     

    > [!Note]  
    > <span data-ttu-id="fa535-301">Il percorso specificato dal percorso è relativo alla posizione specificata dal percorso di installazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-301">The location specified by the path is relative to the location specified by the installation path.</span></span> <span data-ttu-id="fa535-302">Ad esempio, bin \\GDF.dll.</span><span class="sxs-lookup"><span data-stu-id="fa535-302">For example, bin\\GDF.dll.</span></span>

     

6.  <span data-ttu-id="fa535-303">Salvare il pacchetto MSI.</span><span class="sxs-lookup"><span data-stu-id="fa535-303">Save the MSI package.</span></span>

<span data-ttu-id="fa535-304">Per informazioni più dettagliate sui pacchetti MSI e Windows Installer, vedere [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span><span class="sxs-lookup"><span data-stu-id="fa535-304">For more detailed information about MSI packages and Windows Installer, see [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span></span>

## <a name="debugging-tips"></a><span data-ttu-id="fa535-305">Suggerimenti per il debug</span><span class="sxs-lookup"><span data-stu-id="fa535-305">Debugging Tips</span></span>

<span data-ttu-id="fa535-306">Di seguito sono riportati alcuni suggerimenti per facilitare il debug dei problemi quando si chiamano le API di Esplora giochi:</span><span class="sxs-lookup"><span data-stu-id="fa535-306">The following are some tips to help debug issues when calling Games Explorer APIs:</span></span>

### <a name="test-with-sample-code"></a><span data-ttu-id="fa535-307">Eseguire il test con il codice di esempio</span><span class="sxs-lookup"><span data-stu-id="fa535-307">Test with sample code</span></span>

<span data-ttu-id="fa535-308">La compilazione della soluzione di esempio GameUXInstallHelper creerà un GameUXInstallHelper.dll e una GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="fa535-308">Building the GameUXInstallHelper sample solution will create a GameUXInstallHelper.dll and a GDFInstall.exe.</span></span> <span data-ttu-id="fa535-309">Il GDFInstall.exe è un'applicazione di esempio che usa GameUXInstallHelper.dll.</span><span class="sxs-lookup"><span data-stu-id="fa535-309">The GDFInstall.exe is a sample application that uses GameUXInstallHelper.dll.</span></span> <span data-ttu-id="fa535-310">In esecuzione GDFInstall.exe verrà chiesto se si vuole installare o rimuovere un file binario di GDF da Game Explorer.</span><span class="sxs-lookup"><span data-stu-id="fa535-310">Running GDFInstall.exe will prompt if you want install or remove a GDF binary from game explorer.</span></span> <span data-ttu-id="fa535-311">È possibile testare il file binario di GDF passandolo come prima riga di comando ARG per GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="fa535-311">You can test your GDF binary file by passing it in as the first command line arg to GDFInstall.exe.</span></span>

<span data-ttu-id="fa535-312">Se non si dispone di un file binario di GDF o l'installazione non riesce, provare a usare l'esempio GDF in DirectX SDK.</span><span class="sxs-lookup"><span data-stu-id="fa535-312">If you don't have a GDF binary or yours fails to install, try using the sample GDF in the DirectX SDK.</span></span> <span data-ttu-id="fa535-313">L'esempio GDFExampleBinary è disponibile in DirectX SDK ed è solo una DLL che contiene solo un file GDF.</span><span class="sxs-lookup"><span data-stu-id="fa535-313">The GDFExampleBinary sample is found in the DirectX SDK and is just a DLL that only contains a GDF file.</span></span> <span data-ttu-id="fa535-314">Il progetto GDFMaker è incluso anche nell'origine.</span><span class="sxs-lookup"><span data-stu-id="fa535-314">Also included in the source is its GDFMaker project.</span></span> <span data-ttu-id="fa535-315">È possibile compilarlo e testarlo utilizzando GDFInstall.exe.</span><span class="sxs-lookup"><span data-stu-id="fa535-315">You can build it and test it using GDFInstall.exe.</span></span> <span data-ttu-id="fa535-316">È anche possibile confrontare il relativo codice XML con il proprio per individuare esattamente il punto in cui si verifica il problema.</span><span class="sxs-lookup"><span data-stu-id="fa535-316">You can also compare the its XML to yours to pinpoint exactly where the issue is.</span></span>

### <a name="make-sure-that-your-game-was-removed-properly"></a><span data-ttu-id="fa535-317">Verificare che il gioco sia stato rimosso correttamente</span><span class="sxs-lookup"><span data-stu-id="fa535-317">Make sure that your game was removed properly</span></span>

<span data-ttu-id="fa535-318">Se il gioco è già installato in Games Explorer, le successive chiamate a **IGameExplorer:: AddGame** restituiranno E \_ non riusciranno quindi assicurarsi che il gioco non venga installato prima del test.</span><span class="sxs-lookup"><span data-stu-id="fa535-318">If the game is already installed in Games Explorer, then subsequent calls to **IGameExplorer::AddGame** will return E\_FAIL so make sure your game isn't installed before testing.</span></span> <span data-ttu-id="fa535-319">Questo vale anche se si installa il GDF solo per l'utente corrente e quindi si prova a installare il GDF per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="fa535-319">This also applies if you install the GDF for only the current user and then try to install the GDF for all users.</span></span> <span data-ttu-id="fa535-320">È necessario prima rimuovere il gioco dagli utenti correnti prima che **IGameExplorer:: AddGame** abbia esito positivo.</span><span class="sxs-lookup"><span data-stu-id="fa535-320">You must first remove the game from the current users before **IGameExplorer::AddGame** will succeed.</span></span>

<span data-ttu-id="fa535-321">Se si esegue **GDFInstall.exe enum**, l'applicazione di esempio entrerà in una modalità diversa che enumera tutti i giochi di Esplora giochi installati e richiede di rimuoverli.</span><span class="sxs-lookup"><span data-stu-id="fa535-321">If you run **GDFInstall.exe enum**, the sample application will enter a different mode which will enumerate all of the installed Games Explorer games and prompt you to remove them.</span></span> <span data-ttu-id="fa535-322">È anche possibile cercare nel registro di \_ sistema HKEY LOCAL \_ Machine \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ GameUX per verificare che il gioco non sia installato per un altro utente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="fa535-322">You can also browse and search the registry in HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\GameUX to make sure that your game isn't installed for another user on the system.</span></span> <span data-ttu-id="fa535-323">Tuttavia, non modificare queste impostazioni del registro di sistema per altri scopi, poiché non è garantito che rimangano compatibili nelle versioni future del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="fa535-323">However, do not alter these registry settings for any other purpose, as they are not guaranteed to remain compatible in future versions of the operating system.</span></span>

### <a name="be-sure-to-sign-using-authenticode"></a><span data-ttu-id="fa535-324">Assicurarsi di firmare con Authenticode</span><span class="sxs-lookup"><span data-stu-id="fa535-324">Be sure to sign using Authenticode</span></span>

<span data-ttu-id="fa535-325">Se è stata specificata una classificazione, ma non viene visualizzato in Games Explorer, assicurarsi di aver usato Authenticode per firmare il file eseguibile o DLL che contiene la classificazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-325">If you have provided a rating, but are not seeing it in Games Explorer, make sure that you have used Authenticode to sign the executable or DLL file that contains the rating.</span></span> <span data-ttu-id="fa535-326">Esplora giochi ignora le informazioni sulle classificazioni nei file non firmati.</span><span class="sxs-lookup"><span data-stu-id="fa535-326">Games Explorer ignores ratings information in unsigned files.</span></span> <span data-ttu-id="fa535-327">Per ulteriori informazioni su Authenticode, vedere [firma Authenticode per sviluppatori di giochi](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="fa535-327">For more information about Authenticode, see [Authenticode Signing for Game Developers](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span></span>

### <a name="be-sure-that-parental-controls-are-available"></a><span data-ttu-id="fa535-328">Assicurarsi che i controlli parentali siano disponibili</span><span class="sxs-lookup"><span data-stu-id="fa535-328">Be sure that parental controls are available</span></span>

<span data-ttu-id="fa535-329">Assicurarsi di eseguire il test dei controlli padre in un'edizione di Windows Vista che fornisce controlli padre: Home Basic, Home Premium o Ultimate.</span><span class="sxs-lookup"><span data-stu-id="fa535-329">Ensure that you are testing parental controls on an edition of Windows Vista that provides parental controls: Home Basic, Home Premium, or Ultimate.</span></span> <span data-ttu-id="fa535-330">Windows Vista Business e Windows Vista Enterprise non forniscono controlli padre. Tuttavia, se si esegue il test in Windows Vista Ultimate e il computer di test è aggiunto a un dominio, è necessario modificare un'impostazione di criteri di gruppo rendere visibili i controlli padre.</span><span class="sxs-lookup"><span data-stu-id="fa535-330">Windows Vista Business and Windows Vista Enterprise do not provide parental controls however if you are testing on Windows Vista Ultimate, and the test computer is joined to a domain, you must change a group policy setting make parental controls visible.</span></span> <span data-ttu-id="fa535-331">Per eseguire questa operazione, vedere [Introduzione con Game Explorer](/previous-versions/windows/desktop/legacy/ee417682(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="fa535-331">To do this, see [Getting Started with Games Explorer](/previous-versions/windows/desktop/legacy/ee417682(v=vs.85)).</span></span>

### <a name="verify-that-tasks-are-of-the-correct-type"></a><span data-ttu-id="fa535-332">Verificare che le attività siano del tipo corretto</span><span class="sxs-lookup"><span data-stu-id="fa535-332">Verify that tasks are of the correct type</span></span>

<span data-ttu-id="fa535-333">Se sono state specificate attività di supporto che non vengono visualizzate in Game Explorer, verificare che siano tutti collegamenti Web.</span><span class="sxs-lookup"><span data-stu-id="fa535-333">If you have specified support tasks that do not appear in Games Explorer, verify that they are all Web links.</span></span> <span data-ttu-id="fa535-334">Qualsiasi altra attività di collegamento deve essere creata come attività di riproduzione.</span><span class="sxs-lookup"><span data-stu-id="fa535-334">Any other shortcut tasks must be created as play tasks.</span></span> <span data-ttu-id="fa535-335">Le attività sono descritte in precedenza in questo articolo nelle [attività di Esplora giochi](#games-explorer-tasks).</span><span class="sxs-lookup"><span data-stu-id="fa535-335">Tasks are covered earlier in this article in [Games Explorer Tasks](#games-explorer-tasks).</span></span>

### <a name="verify-the-data-in-gdf-binary"></a><span data-ttu-id="fa535-336">Verificare i dati nel file binario di GDF</span><span class="sxs-lookup"><span data-stu-id="fa535-336">Verify the data in GDF binary</span></span>

<span data-ttu-id="fa535-337">GDFTrace.exe è uno strumento disponibile in DirectX SDK.</span><span class="sxs-lookup"><span data-stu-id="fa535-337">GDFTrace.exe is a tool found in the DirectX SDK.</span></span> <span data-ttu-id="fa535-338">È possibile eseguire GDFTrace.exe nel file binario di GDF e tutti i metadati GDF contenuti nel file binario vengono restituiti per ogni lingua supportata per la convalida rapida.</span><span class="sxs-lookup"><span data-stu-id="fa535-338">You can run GDFTrace.exe on your GDF binary and it will output all the GDF metadata contained in the binary for every supported language for quick validation.</span></span> <span data-ttu-id="fa535-339">Vengono inoltre visualizzati gli avvisi relativi a informazioni mancanti o obsolete.</span><span class="sxs-lookup"><span data-stu-id="fa535-339">It also displays any warnings about missing or outdated information.</span></span>

## <a name="summary"></a><span data-ttu-id="fa535-340">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="fa535-340">Summary</span></span>

<span data-ttu-id="fa535-341">Esplora giochi in Windows Vista offre un modo semplice e personalizzabile per presentare il gioco agli utenti di Windows Vista, ma richiede anche di registrare il gioco con il sistema durante il processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="fa535-341">Games Explorer in Windows Vista provides an easy, customizable way to present your game to users of Windows Vista, but it also requires you to register the game with the system during the installation process.</span></span> <span data-ttu-id="fa535-342">L'esempio GameUXInstallHelper semplifica notevolmente questo processo per gli sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="fa535-342">The GameUXInstallHelper sample greatly simplifies this process for developers.</span></span>

 

 