---
title: object (attributo)
description: L'attributo \ Object \ Interface identifica un'interfaccia COM.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- attributo oggetto MIDL
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "103726335"
---
# <a name="object-attribute"></a><span data-ttu-id="f0013-104">object (attributo)</span><span class="sxs-lookup"><span data-stu-id="f0013-104">object attribute</span></span>

<span data-ttu-id="f0013-105">L'attributo dell'interfaccia dell' **\[ oggetto \]** identifica un'interfaccia com.</span><span class="sxs-lookup"><span data-stu-id="f0013-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="f0013-106">Un elenco di attributi di interfaccia che non include l'attributo **\[ Object \]** indica un'interfaccia RPC DCE.</span><span class="sxs-lookup"><span data-stu-id="f0013-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="f0013-107">Parametri</span><span class="sxs-lookup"><span data-stu-id="f0013-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="f0013-108">*stringa-UUID*</span><span class="sxs-lookup"><span data-stu-id="f0013-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="f0013-109">Stringa UUID generata dall'utilità uuidgen.</span><span class="sxs-lookup"><span data-stu-id="f0013-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="f0013-110">È possibile racchiudere la stringa UUID tra virgolette.</span><span class="sxs-lookup"><span data-stu-id="f0013-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="f0013-111">*Interface-Attribute-List*</span><span class="sxs-lookup"><span data-stu-id="f0013-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="f0013-112">Altri attributi applicabili all'interfaccia nel suo complesso.</span><span class="sxs-lookup"><span data-stu-id="f0013-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="f0013-113">*Nome interfaccia*</span><span class="sxs-lookup"><span data-stu-id="f0013-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="f0013-114">Nome dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f0013-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="f0013-115">*interfaccia di base*</span><span class="sxs-lookup"><span data-stu-id="f0013-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="f0013-116">Interfaccia COM da cui deriva questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f0013-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="f0013-117">L'interfaccia di base deve essere [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)o un'altra interfaccia com che deriva direttamente o indirettamente da **IUnknown** o da **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="f0013-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="f0013-118">Commenti</span><span class="sxs-lookup"><span data-stu-id="f0013-118">Remarks</span></span>

<span data-ttu-id="f0013-119">Un elenco di attributi di interfaccia per un'interfaccia COM deve includere l' **\[** attributo [**UUID**](uuid.md) **\]** , ma non può includere l' **\[** [](version.md) **\]** attributo Version.</span><span class="sxs-lookup"><span data-stu-id="f0013-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="f0013-120">Per impostazione predefinita, la compilazione di un'interfaccia COM con il compilatore MIDL genera i file necessari per compilare una DLL proxy.</span><span class="sxs-lookup"><span data-stu-id="f0013-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="f0013-121">Questa DLL contiene il codice per supportare l'utilizzo dell'interfaccia COM personalizzata da parte delle applicazioni client e dei server oggetti.</span><span class="sxs-lookup"><span data-stu-id="f0013-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="f0013-122">Tuttavia, se l'elenco di attributi di interfaccia per un'interfaccia COM specifica l' **\[** [](local.md) **\]** attributo locale, il compilatore MIDL genera solo il file di intestazione dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f0013-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="f0013-123">Il compilatore MIDL genera automaticamente un tipo di dati dell'interfaccia per un'interfaccia COM.</span><span class="sxs-lookup"><span data-stu-id="f0013-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="f0013-124">In alternativa, è possibile utilizzare [**typedef**](typedef.md) con la parola chiave [**Interface**](interface.md) per definire in modo esplicito un tipo di dati dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f0013-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="f0013-125">La specifica dell'interfaccia può quindi utilizzare il tipo di dati dell'interfaccia nei parametri della funzione e i valori restituiti, i membri [**struct**](struct.md) e [**Union**](union.md) e altre dichiarazioni di tipo.</span><span class="sxs-lookup"><span data-stu-id="f0013-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="f0013-126">Nell'esempio seguente viene illustrato l'utilizzo di un tipo di dati [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) generato automaticamente:</span><span class="sxs-lookup"><span data-stu-id="f0013-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="f0013-127">In un'interfaccia COM, si presuppone che tutte le funzioni membro di interfaccia siano funzioni virtuali.</span><span class="sxs-lookup"><span data-stu-id="f0013-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="f0013-128">Una funzione virtuale ha un puntatore **this** implicito come primo parametro.</span><span class="sxs-lookup"><span data-stu-id="f0013-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="f0013-129">La tabella della funzione virtuale contiene una voce per ogni funzione membro di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f0013-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="f0013-130">**\[**[](local.md) **\]** Le funzioni membro di interfaccia a oggetti non locali devono avere un valore restituito HRESULT o SCODE.</span><span class="sxs-lookup"><span data-stu-id="f0013-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="f0013-131">Si noti che le versioni precedenti di MIDL hanno consentito alle funzioni membro di restituire [**void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="f0013-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="f0013-132">Tuttavia, a partire da MIDL versione 3,0, restituendo **void** genera un errore del compilatore. Se si dispone di un valore restituito HRESULT o SCODE significa che se viene generata un'eccezione durante una chiamata remota, i proxy generati intercettano l'eccezione e restituiscono il codice di eccezione nel valore restituito.</span><span class="sxs-lookup"><span data-stu-id="f0013-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="f0013-133">Se l'applicazione può permettersi di ignorare gli errori che si verificano durante una chiamata di procedura remota, è possibile specificare HRESULT come tipo restituito senza controllare il valore restituito dopo la chiamata.</span><span class="sxs-lookup"><span data-stu-id="f0013-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="f0013-134">Se si sta ricompilando un'applicazione precedente, la modifica dei tipi restituiti può presentare problemi di compatibilità con le versioni precedenti quando il server invia il risultato appena introdotto al client.</span><span class="sxs-lookup"><span data-stu-id="f0013-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="f0013-135">In alternativa alla modifica del tipo restituito, è possibile etichettare la funzione che restituisce [**void**](void.md) con la **\[** [**chiamata \_ come**](call-as.md) **\]** attributo, rendendola così una funzione locale.</span><span class="sxs-lookup"><span data-stu-id="f0013-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="f0013-136">Definire quindi una funzione remota correlata con gli stessi parametri, ma con il tipo restituito HRESULT.</span><span class="sxs-lookup"><span data-stu-id="f0013-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="f0013-137">La funzione locale può generare un'eccezione in base al valore HRESULT, se necessario.</span><span class="sxs-lookup"><span data-stu-id="f0013-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="f0013-138">L'attributo **\[ \] Object** non è disponibile quando si esegue la compilazione con l'opzione [**/OSF**](-osf.md) del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="f0013-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="f0013-139">Esempi</span><span class="sxs-lookup"><span data-stu-id="f0013-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="f0013-140">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f0013-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="f0013-141">**chiama \_ come**</span><span class="sxs-lookup"><span data-stu-id="f0013-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="f0013-142">File di definizione dell'interfaccia (IDL)</span><span class="sxs-lookup"><span data-stu-id="f0013-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="f0013-143">**IID \_ è**</span><span class="sxs-lookup"><span data-stu-id="f0013-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="f0013-144">**interfaccia**</span><span class="sxs-lookup"><span data-stu-id="f0013-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="f0013-145">**locale**</span><span class="sxs-lookup"><span data-stu-id="f0013-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="f0013-146">**/osf**</span><span class="sxs-lookup"><span data-stu-id="f0013-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="f0013-147">**typedef**</span><span class="sxs-lookup"><span data-stu-id="f0013-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="f0013-148">**uuid**</span><span class="sxs-lookup"><span data-stu-id="f0013-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="f0013-149">**Versione**</span><span class="sxs-lookup"><span data-stu-id="f0013-149">**version**</span></span>](version.md)
</dt> </dl>

 

 