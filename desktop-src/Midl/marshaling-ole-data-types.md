---
title: Marshalling di tipi di dati OLE
description: Marshalling di automazione e tipi di dati OLE.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:
- MIDL e COM MIDL, marshalling di tipi di dati OLE
- marshalling MIDL
- MIDL di dati OLE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5970c6e0fef9d0fc88b8a0a11a087fa4396d7a7c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "103725154"
---
# <a name="marshaling-ole-data-types"></a><span data-ttu-id="c175d-106">Marshalling di tipi di dati OLE</span><span class="sxs-lookup"><span data-stu-id="c175d-106">Marshaling OLE Data Types</span></span>

<span data-ttu-id="c175d-107">Per semplificare l'utilizzo di determinati tipi di dati di automazione e OLE, oltre ad alcuni handle di sistema usati di frequente in COM, i typedef per questi tipi di dati e le funzioni di supporto correlate sono disponibili mediante l'importazione dei file IDL di Windows e il collegamento ai file DLL OLE e di automazione.</span><span class="sxs-lookup"><span data-stu-id="c175d-107">To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files.</span></span> <span data-ttu-id="c175d-108">Questi file vengono installati automaticamente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="c175d-108">These files are automatically installed on your system.</span></span>

-   <span data-ttu-id="c175d-109">Per utilizzare il tipo di dati [**BSTR**](/previous-versions/windows/desktop/automat/bstr) in Remote Procedure Calls, importare il file wtypes. idl nel file di definizione dell'interfaccia (IDL) e collegarsi a Oleaut32. lib durante la compilazione dell'applicazione distribuita.</span><span class="sxs-lookup"><span data-stu-id="c175d-109">To use the [**BSTR**](/previous-versions/windows/desktop/automat/bstr) data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application.</span></span> <span data-ttu-id="c175d-110">In questo consentirà agli stub di usare le funzioni di supporto **predefinite \_ BSTR UserSize**, **BSTR \_ UserMarshal**, **BSTR \_ UserUnmarshal** e **BSTR \_ UserFree**.</span><span class="sxs-lookup"><span data-stu-id="c175d-110">This will let your stubs use the ready-made helper functions **BSTR\_UserSize**, **BSTR\_UserMarshal**, **BSTR\_UserUnmarshal**, and **BSTR\_UserFree**.</span></span>
-   <span data-ttu-id="c175d-111">Per utilizzare altri tipi di dati di automazione, come [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) e [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), o tipi che utilizzano tali tipi (ad esempio, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) e [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), importare il file objidl. idl nel file IDL e collegarsi a Oleaut32. lib in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="c175d-111">To use other Automation data types, such as [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) and [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), or types that use those types (for example, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) and [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time.</span></span> <span data-ttu-id="c175d-112">Questo consentirà di usare le routine di supporto appropriate.</span><span class="sxs-lookup"><span data-stu-id="c175d-112">This will allow you to use the appropriate helper routines.</span></span>
-   <span data-ttu-id="c175d-113">Per usare i tipi di dati OLE (ad esempio CLIPFORMAT, BNS, STGMEDIUM, ASYNC \_ STGMEDIUM) o gli handle di sistema (ad esempio HMETAFILE \_ PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE e HGLOBAL), importare il file objidl. idl nel file di definizione dell'interfaccia e collegarsi a ole32. lib in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="c175d-113">To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC\_STGMEDIUM), or system handles (such as HMETAFILE\_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</span></span>
-   <span data-ttu-id="c175d-114">Gli handle OLE seguenti sono definiti anche con l'attributo **\[ Wire \_ marshalling \]** , ma solo come handle all'interno di un computer, in quanto non possono essere usati nelle chiamate di procedura remota ad altri computer al momento: HWND, HMENU, haccel, HDC, HFONT, HICON, HBRUSH.</span><span class="sxs-lookup"><span data-stu-id="c175d-114">The following OLE handles are also defined with the **\[wire\_marshal\]** attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH.</span></span> <span data-ttu-id="c175d-115">Importare il file objidl. idl nel file IDL e collegarsi a ole32. lib in fase di compilazione per usare questi handle nella comunicazione interprocesso in un singolo computer.</span><span class="sxs-lookup"><span data-stu-id="c175d-115">Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</span></span>

<span data-ttu-id="c175d-116">Per ulteriori informazioni, vedere [l' \_ attributo Wire Marshal](/windows/desktop/Rpc/the-wire-marshal-attribute), [il tipo \_ UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [il tipo \_ UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [il tipo \_ UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [il tipo \_ UserFree function](/windows/desktop/Rpc/the-type-userfree-function)e gli [Stub targeting per specifiche piattaforme a 32 bit o a 64 bit](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="c175d-116">For more information, see [The wire\_marshal Attribute](/windows/desktop/Rpc/the-wire-marshal-attribute), [The type\_UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [The type\_UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [The type\_UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [The type\_UserFree Function](/windows/desktop/Rpc/the-type-userfree-function), and [Targeting Stubs for Specific 32-bit or 64-bit Platforms](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span></span>

 

 