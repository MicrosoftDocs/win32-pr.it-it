---
title: Informazioni sull'input non elaborato
description: Questo argomento illustra l'input dell'utente da dispositivi quali joystick, touch screen e microfoni.
ms.assetid: 013ed309-f667-47ed-ade0-5e7ca5a0997a
keywords:
- input utente, input non elaborato
- acquisizione dell'input dell'utente, input non elaborato
- input non elaborato
- registrazione dell'input non elaborato
- lettura dell'input non elaborato
- input non elaborato del joystick
- input non elaborato touch screen
- input raw microfono
- Human Interface Device (HID)
- HID (dispositivo interfaccia umana)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3535e5601ec63a254c76060611999a1a2f08aeb
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104046737"
---
# <a name="about-raw-input"></a><span data-ttu-id="b4d73-113">Informazioni sull'input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-113">About Raw Input</span></span>

<span data-ttu-id="b4d73-114">Accanto alla tastiera e al mouse tradizionali sono presenti molti dispositivi di input utente.</span><span class="sxs-lookup"><span data-stu-id="b4d73-114">There are many user-input devices beside the traditional keyboard and mouse.</span></span> <span data-ttu-id="b4d73-115">Ad esempio, l'input dell'utente può provenire da un joystick, un touchscreen, un microfono o altri dispositivi che consentono una grande flessibilità nell'input dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b4d73-115">For example, user input can come from a joystick, a touch screen, a microphone, or other devices that allow great flexibility in user input.</span></span> <span data-ttu-id="b4d73-116">Questi dispositivi sono collettivamente noti come Human Interface Device (HIDs).</span><span class="sxs-lookup"><span data-stu-id="b4d73-116">These devices are collectively known as Human Interface Devices (HIDs).</span></span> <span data-ttu-id="b4d73-117">L'API di input non elaborato fornisce un modo stabile e affidabile per le applicazioni di accettare l'input non elaborato da qualsiasi HID, inclusa la tastiera e il mouse.</span><span class="sxs-lookup"><span data-stu-id="b4d73-117">The raw input API provides a stable and robust way for applications to accept raw input from any HID, including the keyboard and mouse.</span></span>

<span data-ttu-id="b4d73-118">Questa sezione contiene gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="b4d73-118">This section covers the following topics:</span></span>

-   [<span data-ttu-id="b4d73-119">Modello di input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-119">Raw Input Model</span></span>](#raw-input-model)
-   [<span data-ttu-id="b4d73-120">Registrazione per l'input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-120">Registration for Raw Input</span></span>](#registration-for-raw-input)
-   [<span data-ttu-id="b4d73-121">Lettura dell'input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-121">Reading Raw Input</span></span>](#reading-raw-input)

## <a name="raw-input-model"></a><span data-ttu-id="b4d73-122">Modello di input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-122">Raw Input Model</span></span>

<span data-ttu-id="b4d73-123">In precedenza, la tastiera e il mouse generavano in genere dati di input.</span><span class="sxs-lookup"><span data-stu-id="b4d73-123">Previously, the keyboard and mouse typically generated input data.</span></span> <span data-ttu-id="b4d73-124">Il sistema ha interpretato i dati provenienti da questi dispositivi in modo da eliminare i dettagli specifici del dispositivo delle informazioni non elaborate.</span><span class="sxs-lookup"><span data-stu-id="b4d73-124">The system interpreted the data coming from these devices in a way that eliminated the device-specific details of the raw information.</span></span> <span data-ttu-id="b4d73-125">Ad esempio, la tastiera genera il codice di analisi specifico del dispositivo, ma il sistema fornisce un'applicazione con il codice della chiave virtuale.</span><span class="sxs-lookup"><span data-stu-id="b4d73-125">For example, the keyboard generates the device-specific scan code but the system provides an application with the virtual key code.</span></span> <span data-ttu-id="b4d73-126">Oltre a nascondere i dettagli dell'input non elaborato, gestione finestre non supportava tutti i nuovi HIDs.</span><span class="sxs-lookup"><span data-stu-id="b4d73-126">Besides hiding the details of the raw input, the window manager did not support all the new HIDs.</span></span> <span data-ttu-id="b4d73-127">Per ottenere l'input dalla HIDs non supportata, un'applicazione deve eseguire molte operazioni: aprire il dispositivo, gestire la modalità condivisa, leggere periodicamente il dispositivo o configurare la porta di completamento I/O e così via.</span><span class="sxs-lookup"><span data-stu-id="b4d73-127">To get input from the unsupported HIDs, an application had to do many things: open the device, manage the shared mode, periodically read the device or set up the I/O completion port, and so forth.</span></span> <span data-ttu-id="b4d73-128">Il modello di input non elaborato e le API associate sono stati sviluppati per consentire l'accesso semplice a un input non elaborato da tutti i dispositivi di input, tra cui la tastiera e il mouse.</span><span class="sxs-lookup"><span data-stu-id="b4d73-128">The raw input model and the associated APIs were developed to allow simple access to raw input from all input devices, including the keyboard and mouse.</span></span>

<span data-ttu-id="b4d73-129">Il modello di input non elaborato è diverso dal modello di input Windows originale per la tastiera e il mouse.</span><span class="sxs-lookup"><span data-stu-id="b4d73-129">The raw input model is different from the original Windows input model for the keyboard and mouse.</span></span> <span data-ttu-id="b4d73-130">Nel modello di input originale, un'applicazione riceve un input indipendente dal dispositivo sotto forma di messaggi inviati o inviati alle finestre, ad esempio [**WM \_ char**](wm-char.md), [**WM \_ MOUSEMOVE**](wm-mousemove.md)e [**WM \_ APPCOMMAND**](wm-appcommand.md).</span><span class="sxs-lookup"><span data-stu-id="b4d73-130">In the original input model, an application receives device-independent input in the form of messages that are sent or posted to its windows, such as [**WM\_CHAR**](wm-char.md), [**WM\_MOUSEMOVE**](wm-mousemove.md), and [**WM\_APPCOMMAND**](wm-appcommand.md).</span></span> <span data-ttu-id="b4d73-131">Per l'input non elaborato, invece, un'applicazione deve registrare i dispositivi da cui desidera ottenere i dati.</span><span class="sxs-lookup"><span data-stu-id="b4d73-131">In contrast, for raw input an application must register the devices it wants to get data from.</span></span> <span data-ttu-id="b4d73-132">Inoltre, l'applicazione ottiene l'input non elaborato tramite il messaggio di [**\_ input WM**](wm-input.md) .</span><span class="sxs-lookup"><span data-stu-id="b4d73-132">Also, the application gets the raw input through the [**WM\_INPUT**](wm-input.md) message.</span></span>

<span data-ttu-id="b4d73-133">Il modello di input non elaborato presenta diversi vantaggi:</span><span class="sxs-lookup"><span data-stu-id="b4d73-133">There are several advantages to the raw input model:</span></span>

-   <span data-ttu-id="b4d73-134">Non è necessario che un'applicazione rilevi o apra il dispositivo di input.</span><span class="sxs-lookup"><span data-stu-id="b4d73-134">An application does not have to detect or open the input device.</span></span>
-   <span data-ttu-id="b4d73-135">Un'applicazione ottiene i dati direttamente dal dispositivo ed elabora i dati per le proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="b4d73-135">An application gets the data directly from the device, and processes the data for its needs.</span></span>
-   <span data-ttu-id="b4d73-136">Un'applicazione può distinguere l'origine dell'input anche se è dello stesso tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b4d73-136">An application can distinguish the source of the input even if it is from the same type of device.</span></span> <span data-ttu-id="b4d73-137">Ad esempio, due dispositivi mouse.</span><span class="sxs-lookup"><span data-stu-id="b4d73-137">For example, two mouse devices.</span></span>
-   <span data-ttu-id="b4d73-138">Un'applicazione gestisce il traffico dati specificando i dati da una raccolta di dispositivi o solo specifici tipi di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="b4d73-138">An application manages the data traffic by specifying data from a collection of devices or only specific device types.</span></span>
-   <span data-ttu-id="b4d73-139">I dispositivi HID possono essere usati quando diventano disponibili nel Marketplace, senza attendere che nuovi tipi di messaggio o un sistema operativo aggiornato dispongano di nuovi comandi in [**WM \_ APPCOMMAND**](wm-appcommand.md).</span><span class="sxs-lookup"><span data-stu-id="b4d73-139">HID devices can be used as they become available in the marketplace, without waiting for new message types or an updated OS to have new commands in [**WM\_APPCOMMAND**](wm-appcommand.md).</span></span>

<span data-ttu-id="b4d73-140">Si noti che [**WM \_ APPCOMMAND**](wm-appcommand.md) fornisce alcuni dispositivi HID.</span><span class="sxs-lookup"><span data-stu-id="b4d73-140">Note that [**WM\_APPCOMMAND**](wm-appcommand.md) does provide for some HID devices.</span></span> <span data-ttu-id="b4d73-141">Tuttavia, **WM \_ APPCOMMAND** è un evento di input di livello superiore indipendente dal dispositivo, mentre l' [**\_ input WM**](wm-input.md) invia dati non elaborati di basso livello specifici di un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b4d73-141">However, **WM\_APPCOMMAND** is a higher level device-independent input event, while [**WM\_INPUT**](wm-input.md) sends raw, low level data that is specific to a device.</span></span>

## <a name="registration-for-raw-input"></a><span data-ttu-id="b4d73-142">Registrazione per l'input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-142">Registration for Raw Input</span></span>

<span data-ttu-id="b4d73-143">Per impostazione predefinita, nessuna applicazione riceve input non elaborato.</span><span class="sxs-lookup"><span data-stu-id="b4d73-143">By default, no application receives raw input.</span></span> <span data-ttu-id="b4d73-144">Per ricevere input non elaborato da un dispositivo, un'applicazione deve registrare il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b4d73-144">To receive raw input from a device, an application must register the device.</span></span>

<span data-ttu-id="b4d73-145">Per registrare i dispositivi, un'applicazione crea prima di tutto una matrice di strutture [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice) che specificano la [raccolta di livello superiore](/windows-hardware/drivers/hid/top-level-collections) (TLC) per i dispositivi desiderati.</span><span class="sxs-lookup"><span data-stu-id="b4d73-145">To register devices, an application first creates an array of [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice) structures that specify the [top level collection](/windows-hardware/drivers/hid/top-level-collections) (TLC) for the devices it wants.</span></span> <span data-ttu-id="b4d73-146">Il TLC è definito da una [pagina di utilizzo](/windows-hardware/drivers/hid/hid-usages#usage-page) (la classe del dispositivo) e da un [ID di utilizzo](/windows-hardware/drivers/hid/hid-usages#usage-id) (il dispositivo all'interno della classe).</span><span class="sxs-lookup"><span data-stu-id="b4d73-146">The TLC is defined by a [Usage Page](/windows-hardware/drivers/hid/hid-usages#usage-page) (the class of the device) and a [Usage ID](/windows-hardware/drivers/hid/hid-usages#usage-id) (the device within the class).</span></span> <span data-ttu-id="b4d73-147">Ad esempio, per ottenere la tastiera di TLC, impostare UsagePage = 0x01 e UsageID = 0x06.</span><span class="sxs-lookup"><span data-stu-id="b4d73-147">For example, to get the keyboard TLC, set UsagePage = 0x01 and UsageID = 0x06.</span></span> <span data-ttu-id="b4d73-148">L'applicazione chiama [**RegisterRawInputDevices**](/windows/win32/api/winuser/nf-winuser-registerrawinputdevices) per registrare i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="b4d73-148">The application calls [**RegisterRawInputDevices**](/windows/win32/api/winuser/nf-winuser-registerrawinputdevices) to register the devices.</span></span>

<span data-ttu-id="b4d73-149">Si noti che un'applicazione può registrare un dispositivo che non è attualmente collegato al sistema.</span><span class="sxs-lookup"><span data-stu-id="b4d73-149">Note that an application can register a device that is not currently attached to the system.</span></span> <span data-ttu-id="b4d73-150">Quando il dispositivo è collegato, Windows Manager invierà automaticamente l'input non elaborato all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4d73-150">When this device is attached, the Windows Manager will automatically send the raw input to the application.</span></span> <span data-ttu-id="b4d73-151">Per ottenere l'elenco di dispositivi di input non elaborati nel sistema, un'applicazione chiama [**GetRawInputDeviceList**](/windows/win32/api/winuser/nf-winuser-getrawinputdevicelist).</span><span class="sxs-lookup"><span data-stu-id="b4d73-151">To get the list of raw input devices on the system, an application calls [**GetRawInputDeviceList**](/windows/win32/api/winuser/nf-winuser-getrawinputdevicelist).</span></span> <span data-ttu-id="b4d73-152">Utilizzando *hDevice* da questa chiamata, un'applicazione chiama [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) per ottenere le informazioni sul dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b4d73-152">Using the *hDevice* from this call, an application calls [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) to get the device information.</span></span>

<span data-ttu-id="b4d73-153">Tramite il membro **dwFlags** di [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice), un'applicazione può selezionare i dispositivi da ascoltare e anche quelli che vogliono ignorare.</span><span class="sxs-lookup"><span data-stu-id="b4d73-153">Through the **dwFlags** member of [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice), an application can select the devices to listen to and also those it wants to ignore.</span></span> <span data-ttu-id="b4d73-154">Ad esempio, un'applicazione può richiedere l'input da tutti i dispositivi di telefonia ad eccezione dei computer che rispondono.</span><span class="sxs-lookup"><span data-stu-id="b4d73-154">For example, an application can ask for input from all telephony devices except for answering machines.</span></span> <span data-ttu-id="b4d73-155">Per il codice di esempio, vedere [la pagina relativa alla registrazione per l'input non elaborato](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="b4d73-155">For sample code, see [Registering for Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="b4d73-156">Si noti che anche il mouse e la tastiera sono HIDs, quindi i dati provenienti da essi possono essere inclusi sia nell' [**\_ input WM**](wm-input.md) del messaggio HID che nei messaggi tradizionali.</span><span class="sxs-lookup"><span data-stu-id="b4d73-156">Note that the mouse and the keyboard are also HIDs, so data from them can come through both the HID message [**WM\_INPUT**](wm-input.md) and from traditional messages.</span></span> <span data-ttu-id="b4d73-157">Un'applicazione può selezionare uno dei metodi in base alla selezione appropriata dei flag in [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice).</span><span class="sxs-lookup"><span data-stu-id="b4d73-157">An application can select either method by the proper selection of flags in [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice).</span></span>

<span data-ttu-id="b4d73-158">Per ottenere lo stato di registrazione di un'applicazione, chiamare [**GetRegisteredRawInputDevices**](/windows/win32/api/winuser/nf-winuser-getregisteredrawinputdevices) in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="b4d73-158">To get an application's registration status, call [**GetRegisteredRawInputDevices**](/windows/win32/api/winuser/nf-winuser-getregisteredrawinputdevices) at any time.</span></span>

## <a name="reading-raw-input"></a><span data-ttu-id="b4d73-159">Lettura dell'input non elaborato</span><span class="sxs-lookup"><span data-stu-id="b4d73-159">Reading Raw Input</span></span>

<span data-ttu-id="b4d73-160">Un'applicazione riceve input non elaborato da qualsiasi HID la cui [raccolta di livello superiore](/windows-hardware/drivers/hid/top-level-collections) (TLC) corrisponde a una TLC dalla registrazione.</span><span class="sxs-lookup"><span data-stu-id="b4d73-160">An application receives raw input from any HID whose [top level collection](/windows-hardware/drivers/hid/top-level-collections) (TLC) matches a TLC from the registration.</span></span> <span data-ttu-id="b4d73-161">Quando un'applicazione riceve un input non elaborato, la coda di messaggi riceve un messaggio di [**\_ input WM**](wm-input.md) e il flag di stato della coda **QS \_ rawinput** è impostato (l'**\_ input QS** include anche questo flag).</span><span class="sxs-lookup"><span data-stu-id="b4d73-161">When an application receives raw input, its message queue gets a [**WM\_INPUT**](wm-input.md) message and the queue status flag **QS\_RAWINPUT** is set (**QS\_INPUT** also includes this flag).</span></span> <span data-ttu-id="b4d73-162">Un'applicazione può ricevere dati quando si trova in primo piano e quando si trova in background.</span><span class="sxs-lookup"><span data-stu-id="b4d73-162">An application can receive data when it is in the foreground and when it is in the background.</span></span>

<span data-ttu-id="b4d73-163">Esistono due modi per leggere i dati non elaborati: il metodo non memorizzato nel buffer (o standard) e il metodo memorizzato nel buffer.</span><span class="sxs-lookup"><span data-stu-id="b4d73-163">There are two ways to read the raw data: the unbuffered (or standard) method and the buffered method.</span></span> <span data-ttu-id="b4d73-164">Il metodo non memorizzato nel buffer ottiene i dati non elaborati una struttura [**rawinput**](/windows/win32/api/winuser/ns-winuser-rawinput) alla volta ed è adeguata per molti HIDS.</span><span class="sxs-lookup"><span data-stu-id="b4d73-164">The unbuffered method gets the raw data one [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) structure at a time and is adequate for many HIDs.</span></span> <span data-ttu-id="b4d73-165">In questo caso, l'applicazione chiama [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage) per ottenere il messaggio di [**\_ input WM**](wm-input.md) .</span><span class="sxs-lookup"><span data-stu-id="b4d73-165">Here, the application calls [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage) to get the [**WM\_INPUT**](wm-input.md) message.</span></span> <span data-ttu-id="b4d73-166">Quindi, l'applicazione chiama [**GetRawInputData**](/windows/win32/api/winuser/nf-winuser-getrawinputdata) usando l'handle **rawinput** contenuto **nell' \_ input WM**.</span><span class="sxs-lookup"><span data-stu-id="b4d73-166">Then the application calls [**GetRawInputData**](/windows/win32/api/winuser/nf-winuser-getrawinputdata) using the **RAWINPUT** handle contained in **WM\_INPUT**.</span></span> <span data-ttu-id="b4d73-167">Per un esempio, vedere la pagina relativa alla [lettura di un input non elaborato standard](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="b4d73-167">For an example, see [Doing a Standard Read of Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="b4d73-168">Al contrario, il metodo memorizzato nel buffer ottiene una matrice di strutture [**rawinput**](/windows/win32/api/winuser/ns-winuser-rawinput) alla volta.</span><span class="sxs-lookup"><span data-stu-id="b4d73-168">In contrast, the buffered method gets an array of [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) structures at a time.</span></span> <span data-ttu-id="b4d73-169">Viene fornito per i dispositivi che possono produrre grandi quantità di input non elaborato.</span><span class="sxs-lookup"><span data-stu-id="b4d73-169">This is provided for devices that can produce large amounts of raw input.</span></span> <span data-ttu-id="b4d73-170">In questo metodo, l'applicazione chiama [**GetRawInputBuffer**](/windows/win32/api/winuser/nf-winuser-getrawinputbuffer) per ottenere una matrice di strutture **rawinput** .</span><span class="sxs-lookup"><span data-stu-id="b4d73-170">In this method, the application calls [**GetRawInputBuffer**](/windows/win32/api/winuser/nf-winuser-getrawinputbuffer) to get an array of **RAWINPUT** structures.</span></span> <span data-ttu-id="b4d73-171">Si noti che la macro [**NEXTRAWINPUTBLOCK**](/windows/win32/api/winuser/nf-winuser-nextrawinputblock) viene utilizzata per attraversare una matrice di strutture **rawinput** .</span><span class="sxs-lookup"><span data-stu-id="b4d73-171">Note that the [**NEXTRAWINPUTBLOCK**](/windows/win32/api/winuser/nf-winuser-nextrawinputblock) macro is used to traverse an array of **RAWINPUT** structures.</span></span> <span data-ttu-id="b4d73-172">Per un esempio, vedere la pagina relativa alla [lettura di un input non elaborato memorizzato nel buffer](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="b4d73-172">For an example, see [Doing a Buffered Read of Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="b4d73-173">Per interpretare l'input non elaborato, è necessario ottenere informazioni dettagliate sul HIDs.</span><span class="sxs-lookup"><span data-stu-id="b4d73-173">To interpret the raw input, detailed information about the HIDs is required.</span></span> <span data-ttu-id="b4d73-174">Un'applicazione ottiene le informazioni sul dispositivo chiamando [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) con l'handle del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b4d73-174">An application gets the device information by calling [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) with the device handle.</span></span> <span data-ttu-id="b4d73-175">Questo handle può provenire dall' [**\_ input WM**](wm-input.md) o dal membro **hDevice** di [**RAWINPUTHEADER**](/windows/win32/api/winuser/ns-winuser-rawinputheader).</span><span class="sxs-lookup"><span data-stu-id="b4d73-175">This handle can come either from [**WM\_INPUT**](wm-input.md) or from the **hDevice** member of [**RAWINPUTHEADER**](/windows/win32/api/winuser/ns-winuser-rawinputheader).</span></span>