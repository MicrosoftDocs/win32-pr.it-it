---
title: Uso della funzionalità NDF
description: Microsoft fornisce accesso alla funzionalità NDF tramite un'API pubblica. Quando si verifica un problema, l'applicazione può usare questa API per sfruttare questa funzionalità nel contesto di un'applicazione specifica.
ms.assetid: db06b9a9-a64a-43ff-9b77-95230208cfd6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca74a8a80f7babca75182625ec71dc1ec47cbc7
ms.sourcegitcommit: c9c66a09eeb9e46311879a5181342e89964c1dd8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/10/2020
ms.locfileid: "104398828"
---
# <a name="using-ndf-functionality"></a><span data-ttu-id="bfe0b-104">Uso della funzionalità NDF</span><span class="sxs-lookup"><span data-stu-id="bfe0b-104">Using NDF Functionality</span></span>

<span data-ttu-id="bfe0b-105">Microsoft fornisce accesso alla funzionalità NDF tramite un'API pubblica.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-105">Microsoft provides access to NDF functionality through a public API.</span></span> <span data-ttu-id="bfe0b-106">Quando si verifica un problema, l'applicazione può usare questa API per sfruttare questa funzionalità nel contesto di un'applicazione specifica.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-106">When a problem occurs, the application can use this API to leverage this functionality within the context of a specific application.</span></span>

<span data-ttu-id="bfe0b-107">Sono disponibili tre fasi di esecuzione della diagnosi con NDF, ovvero la creazione di un evento imprevisto, l'esecuzione di diagnosi e riparazioni e la chiusura dell'evento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-107">There are three stages of performing diagnosis with NDF: creating an incident, running diagnosis and repairs, and closing the incident.</span></span> <span data-ttu-id="bfe0b-108">In questa panoramica vengono indicate le funzioni NDF che possono essere rilevanti per uno scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-108">This overview indicates which NDF functions may be relevant for a specific scenario.</span></span> <span data-ttu-id="bfe0b-109">Per informazioni dettagliate su ogni funzione, vedere la sezione di [riferimento a NDF](ndf-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="bfe0b-109">Detailed information on each function can be found in the [NDF Reference](ndf-reference.md) section.</span></span>

## <a name="creating-an-incident"></a><span data-ttu-id="bfe0b-110">Creazione di un evento imprevisto</span><span class="sxs-lookup"><span data-stu-id="bfe0b-110">Creating an Incident</span></span>

<span data-ttu-id="bfe0b-111">Una sessione di diagnostica NDF richiede un evento imprevisto specifico da diagnosticare.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-111">An NDF diagnostics session requires a specific incident to diagnose.</span></span> <span data-ttu-id="bfe0b-112">Sono disponibili diverse funzioni che è possibile usare per creare un evento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-112">There are several functions which can be used to create an incident.</span></span> <span data-ttu-id="bfe0b-113">Scegliere la funzione che corrisponde maggiormente a quella che l'applicazione stava tentando di eseguire quando si è verificato l'errore.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-113">Choose the function which most closely matches what the application was trying to do when the failure occurred.</span></span>

-   <span data-ttu-id="bfe0b-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): problemi generali di connettività Internet che non necessitano di informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): General Internet connectivity problems which do not need additional information.</span></span>
-   <span data-ttu-id="bfe0b-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident) / [**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): connessione a un URL http o HTTPS.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident)/[**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): Connecting to an HTTP or HTTPS URL.</span></span>
-   <span data-ttu-id="bfe0b-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): accesso a un percorso UNC o a una condivisione file.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): Accessing a UNC path or file share.</span></span>
-   <span data-ttu-id="bfe0b-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): risoluzione di un nome host DNS.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): Resolving a DNS host name.</span></span>
-   <span data-ttu-id="bfe0b-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): risoluzione di un nome peer PNRP.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): Resolving a PNRP peer name.</span></span>
-   <span data-ttu-id="bfe0b-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): aggiunta di un gruppo peer-to-peer.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): Joining a peer-to-peer group.</span></span>
-   <span data-ttu-id="bfe0b-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): connessione a una destinazione tramite un socket (quando nessuna delle altre funzioni viene applicata in modo specifico).</span><span class="sxs-lookup"><span data-stu-id="bfe0b-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): Connecting to a destination by using a socket (when none of the other functions specifically apply).</span></span>
-   <span data-ttu-id="bfe0b-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): usata quando non è appropriato alcun altro scenario e la classe helper NDF specifica da richiamare è nota (insieme agli argomenti necessari).</span><span class="sxs-lookup"><span data-stu-id="bfe0b-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): Used when no other scenario is appropriate and the specific NDF helper class to be invoked is known (along with the arguments it requires).</span></span> <span data-ttu-id="bfe0b-122">Usato principalmente a scopo di test da parte degli sviluppatori di applicazioni che hanno scritto una propria classe helper.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-122">Primarily used for testing purposes by application developers who have written their own helper class.</span></span>

## <a name="running-diagnosis-and-repairs"></a><span data-ttu-id="bfe0b-123">Esecuzione di diagnosi e riparazioni</span><span class="sxs-lookup"><span data-stu-id="bfe0b-123">Running Diagnosis and Repairs</span></span>

<span data-ttu-id="bfe0b-124">Esistono due modi per avviare la diagnostica e la funzionalità di ripristino.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-124">There are two ways to launch the diagnosis and repair functionality.</span></span>

-   <span data-ttu-id="bfe0b-125">Uso dell'interfaccia utente di Windows (scelta consigliata)</span><span class="sxs-lookup"><span data-stu-id="bfe0b-125">Using the Windows User Interface (Recommended)</span></span>

    <span data-ttu-id="bfe0b-126">Quando è in esecuzione nell'interfaccia utente standard di Windows, è possibile chiamare semplicemente la funzione [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) .</span><span class="sxs-lookup"><span data-stu-id="bfe0b-126">When running in the standard Windows user interface, you can simply call the [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) function.</span></span> <span data-ttu-id="bfe0b-127">Viene avviata la procedura guidata NDF che consente all'utente di identificare e, se possibile, di risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-127">The NDF Wizard will launch and assist the user in identifying (and if possible, and resolving) the problem.</span></span> <span data-ttu-id="bfe0b-128">La funzione restituirà una volta terminato il processo.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-128">The function will return after this process has finished.</span></span> <span data-ttu-id="bfe0b-129">L'interfaccia utente è facoltativamente modale per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-129">The user interface is optionally modal to your application.</span></span>

-   <span data-ttu-id="bfe0b-130">Uso di un'interfaccia utente personalizzata (solo Windows 7 e versioni successive)</span><span class="sxs-lookup"><span data-stu-id="bfe0b-130">Using a Custom User Interface (Windows 7 and later only)</span></span>

    <span data-ttu-id="bfe0b-131">Sono disponibili diverse funzioni da usare in scenari in cui non viene visualizzata alcuna interfaccia utente o in cui l'esperienza Windows standard non è in uso (ad esempio, Media Center, applicazioni incorporate e il prompt dei comandi).</span><span class="sxs-lookup"><span data-stu-id="bfe0b-131">Different functions are available to use in scenarios where no user interface is being shown, or where the standard Windows experience is not being used (such as Media Center, embedded applications, and the command prompt).</span></span> <span data-ttu-id="bfe0b-132">Questa opzione consente di ignorare le funzionalità dell'esperienza utente fornite nella procedura guidata NDF, che include la limitazione dei risultati alle cause radice completamente supportate, nonché l'euristica per presentare le riparazioni all'utente nell'ordine consigliato.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-132">This option bypasses the user experience functionality provided in the NDF Wizard, which includes limiting the results to fully-supported root causes, as well as heuristics to present repairs to the user in recommended order.</span></span> <span data-ttu-id="bfe0b-133">Quando si usano queste funzioni, è necessario fornire le stesse funzionalità.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-133">When using these functions, you must provide any such functionality yourself.</span></span> <span data-ttu-id="bfe0b-134">È inoltre necessario assicurarsi di liberare la memoria utilizzata dai risultati della diagnosi.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-134">You must also make sure to free memory used by the diagnosis results.</span></span>

    <span data-ttu-id="bfe0b-135">Per iniziare la diagnosi, chiamare la funzione [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) .</span><span class="sxs-lookup"><span data-stu-id="bfe0b-135">To begin diagnosis, call the [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) function.</span></span> <span data-ttu-id="bfe0b-136">Eventuali problemi rilevati verranno restituiti all'applicazione come raccolta di strutture [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) che descrivono le cause principali identificate e le possibili correzioni.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-136">Any problems found will be returned to the application as a collection of [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) structures describing identified root causes and possible repairs.</span></span>

    <span data-ttu-id="bfe0b-137">Dopo aver selezionato un ripristino (o chiesto all'utente di selezionare un ripristino), è necessario chiamare [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) per tentare la riparazione e determinare se il problema è stato risolto.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-137">After selecting a repair (or asking the user to select a repair), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) should be called to attempt the repair and determine whether the problem was resolved.</span></span>

    <span data-ttu-id="bfe0b-138">In alcuni casi, una riparazione può essere eseguita correttamente, ma non risolverà il problema.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-138">In some cases, a repair may be successfully performed but will not resolve the problem.</span></span> <span data-ttu-id="bfe0b-139">In questi casi, è consigliabile chiudere l'evento imprevisto esistente e quindi aprirne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-139">In such cases, closing the existing incident and then opening a new one is recommended.</span></span> <span data-ttu-id="bfe0b-140">In questo modo verranno identificati tutti i nuovi problemi non mascherati dalla correzione iniziale.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-140">This will ensure that any new problems unmasked by the initial repair are identified.</span></span> <span data-ttu-id="bfe0b-141">Si supponga, ad esempio, che non sia stata visualizzata alcuna rete wireless.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-141">For example, suppose that no wireless networks had been visible.</span></span> <span data-ttu-id="bfe0b-142">Dopo aver reimpostato l'adapter, le reti wireless sono visibili, ma nessuna di esse si trova nell'elenco Preferiti.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-142">After resetting the adapter, wireless networks are visible, but none of them are on the preferred list.</span></span> <span data-ttu-id="bfe0b-143">Si tratta di un nuovo problema che richiederebbe una nuova diagnosi da identificare.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-143">This is a new problem that would require a new diagnosis to identify.</span></span> <span data-ttu-id="bfe0b-144">Se un secondo tentativo di diagnosi non identifica ulteriori problemi, è possibile tentare di risolvere il problema originale oppure è possibile che l'utente sia informato che non è stato possibile risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-144">If such a second diagnosis attempt does not identify additional problems, a different repair can be attempted to resolve the original issue, or the user can be informed that the problem could not be resolved.</span></span>

    <span data-ttu-id="bfe0b-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) e [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) sono API sincrone.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) and [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) are synchronous APIs.</span></span> <span data-ttu-id="bfe0b-146">Se si desidera annullare l'attività avviata da queste funzioni, chiamare [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) da un altro thread.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-146">If you wish to cancel activity initiated by these functions, call [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) from another thread.</span></span> <span data-ttu-id="bfe0b-147">La funzione restituirà al successivo punto di arresto disponibile nel processo di diagnosi o di ripristino.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-147">The function will return at the next available stopping point in the diagnosis or repair process.</span></span>

    <span data-ttu-id="bfe0b-148">In qualsiasi momento, è possibile chiamare [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) per recuperare una copia del log NDF per la sessione di diagnosi corrente e includerla nei log dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-148">At any point, you may optionally call [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) to retrieve a copy of the NDF log for the current diagnosis session and include it with your application logs.</span></span> <span data-ttu-id="bfe0b-149">Il log viene svuotato una volta recuperato e le chiamate successive recupereranno solo gli eventi che si sono verificati dopo l'ultima chiamata a questa funzione.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-149">The log is flushed once retrieved, and subsequent calls will only retrieve events which occurred after the last call to this function.</span></span>

## <a name="closing-an-incident"></a><span data-ttu-id="bfe0b-150">Chiusura di un evento imprevisto</span><span class="sxs-lookup"><span data-stu-id="bfe0b-150">Closing an Incident</span></span>

<span data-ttu-id="bfe0b-151">Al termine della diagnosi di un evento imprevisto, chiamare [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) per liberare le risorse di sistema associate all'esecuzione della diagnostica in tale evento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="bfe0b-151">When you are finished diagnosing an incident, call [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) to free system resources associated with performing diagnostics on that incident.</span></span> <span data-ttu-id="bfe0b-152">Si noti che questa operazione non libera gli oggetti creati da [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span><span class="sxs-lookup"><span data-stu-id="bfe0b-152">(Note that this does not free objects created by [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span></span>
