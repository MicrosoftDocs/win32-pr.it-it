---
description: Un servizio che è un'applicazione console può registrare un gestore di controllo della console per ricevere una notifica quando un utente si disconnette.
ms.assetid: 86ace8b8-c1cb-4646-bc92-86bd578a82c5
title: Ricezione di eventi in un servizio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b95f7329383ffc8aea08102a2fe8cf8b49e0ef9d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104530079"
---
# <a name="receiving-events-in-a-service"></a><span data-ttu-id="80e31-103">Ricezione di eventi in un servizio</span><span class="sxs-lookup"><span data-stu-id="80e31-103">Receiving Events in a Service</span></span>

<span data-ttu-id="80e31-104">Un servizio che è un'applicazione console può registrare un [gestore di controllo della console](/windows/console/console-control-handlers) per ricevere una notifica quando un utente si disconnette.</span><span class="sxs-lookup"><span data-stu-id="80e31-104">A service that is a console application can register a [console control handler](/windows/console/console-control-handlers) to receive notification when a user logs off.</span></span> <span data-ttu-id="80e31-105">Tuttavia, non viene inviato alcun evento console quando un utente interattivo esegue l'accesso.</span><span class="sxs-lookup"><span data-stu-id="80e31-105">However, there is no console event sent when an interactive user logs on.</span></span> <span data-ttu-id="80e31-106">Per informazioni sulla ricezione di notifiche quando un utente esegue l'accesso, vedere [creazione di un pacchetto di notifica di Winlogon](/windows/desktop/SecAuthN/creating-a-winlogon-notification-package).</span><span class="sxs-lookup"><span data-stu-id="80e31-106">For information on receiving notification when a user logs on, see [Creating a Winlogon Notification Package](/windows/desktop/SecAuthN/creating-a-winlogon-notification-package).</span></span>

<span data-ttu-id="80e31-107">Il sistema trasmette gli eventi di modifica del dispositivo a tutti i servizi.</span><span class="sxs-lookup"><span data-stu-id="80e31-107">The system broadcasts device change events to all services.</span></span> <span data-ttu-id="80e31-108">Questi eventi possono essere ricevuti da un servizio in una routine della finestra o nel gestore di controllo del servizio.</span><span class="sxs-lookup"><span data-stu-id="80e31-108">These events can be received by a service in a window procedure or in its service control handler.</span></span> <span data-ttu-id="80e31-109">Per specificare gli eventi che il servizio deve ricevere, utilizzare la funzione [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) .</span><span class="sxs-lookup"><span data-stu-id="80e31-109">To specify which events your service should receive, use the [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) function.</span></span>

<span data-ttu-id="80e31-110">Assicurarsi di gestire Plug and Play eventi del dispositivo il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="80e31-110">Be sure to handle Plug and Play device events as quickly as possible.</span></span> <span data-ttu-id="80e31-111">In caso contrario, il sistema potrebbe smettere di rispondere.</span><span class="sxs-lookup"><span data-stu-id="80e31-111">Otherwise, the system may become unresponsive.</span></span> <span data-ttu-id="80e31-112">Se il gestore eventi deve eseguire un'operazione che può bloccare l'esecuzione, ad esempio I/O, è consigliabile avviare un altro thread per eseguire l'operazione in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="80e31-112">If your event handler is to perform an operation that may block execution (such as I/O), it is best to start another thread to perform the operation asynchronously.</span></span>

<span data-ttu-id="80e31-113">Quando un servizio chiama [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa), il servizio specifica anche un handle di finestra o un handle di stato del servizio.</span><span class="sxs-lookup"><span data-stu-id="80e31-113">When a service calls [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa), the service also specifies either a window handle or a service status handle.</span></span> <span data-ttu-id="80e31-114">Se un servizio specifica un handle di finestra, la routine della finestra riceve gli eventi di notifica.</span><span class="sxs-lookup"><span data-stu-id="80e31-114">If a service specifies a window handle, the window procedure receives the notification events.</span></span> <span data-ttu-id="80e31-115">Se un servizio specifica il rispettivo handle di stato del servizio, il gestore di controllo del servizio riceve gli eventi di notifica.</span><span class="sxs-lookup"><span data-stu-id="80e31-115">If a service specifies its service status handle, its service control handler receives the notification events.</span></span> <span data-ttu-id="80e31-116">Per ulteriori informazioni, vedere [**HandlerEx**](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex).</span><span class="sxs-lookup"><span data-stu-id="80e31-116">For more information, see [**HandlerEx**](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex).</span></span>

<span data-ttu-id="80e31-117">Gli handle di notifica del dispositivo restituiti da [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) devono essere chiusi chiamando la funzione [**UnregisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-unregisterdevicenotification) quando non sono più necessari.</span><span class="sxs-lookup"><span data-stu-id="80e31-117">Device notification handles returned by [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) must be closed by calling the [**UnregisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-unregisterdevicenotification) function when they are no longer needed.</span></span>

 

 
