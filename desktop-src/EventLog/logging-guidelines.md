---
description: I registri eventi archiviano i record degli eventi significativi per conto del sistema e delle applicazioni in esecuzione nel sistema.
ms.assetid: 58a6569a-2775-4687-bf99-579fa4153191
title: Linee guida per la registrazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1210757a7961d82d13d4887e40fbd3837b86138
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131315"
---
# <a name="logging-guidelines"></a><span data-ttu-id="aafcb-103">Linee guida per la registrazione</span><span class="sxs-lookup"><span data-stu-id="aafcb-103">Logging Guidelines</span></span>

<span data-ttu-id="aafcb-104">I registri eventi archiviano i record degli eventi significativi per conto del sistema e delle applicazioni in esecuzione nel sistema.</span><span class="sxs-lookup"><span data-stu-id="aafcb-104">Event logs store records of significant events on behalf of the system and applications running on the system.</span></span> <span data-ttu-id="aafcb-105">Poiché le funzioni di registrazione sono a scopo generico, è necessario decidere quali informazioni sono appropriate per la registrazione.</span><span class="sxs-lookup"><span data-stu-id="aafcb-105">Because the logging functions are general purpose, you must decide what information is appropriate to log.</span></span> <span data-ttu-id="aafcb-106">In genere, è consigliabile registrare solo le informazioni che potrebbero essere utili per la diagnosi di un problema hardware o software.</span><span class="sxs-lookup"><span data-stu-id="aafcb-106">Generally, you should log only information that could be useful in diagnosing a hardware or software problem.</span></span> <span data-ttu-id="aafcb-107">La registrazione degli eventi non può essere utilizzata come strumento di traccia.</span><span class="sxs-lookup"><span data-stu-id="aafcb-107">Event logging is not intended to be used as a tracing tool.</span></span>

## <a name="choosing-events-to-log"></a><span data-ttu-id="aafcb-108">Scelta degli eventi da registrare</span><span class="sxs-lookup"><span data-stu-id="aafcb-108">Choosing Events to Log</span></span>

<span data-ttu-id="aafcb-109">Di seguito sono riportati alcuni esempi di casi in cui la registrazione degli eventi può essere utile:</span><span class="sxs-lookup"><span data-stu-id="aafcb-109">The following are examples of cases in which event logging can be helpful:</span></span>

-   <span data-ttu-id="aafcb-110">Problemi di risorse.</span><span class="sxs-lookup"><span data-stu-id="aafcb-110">Resource problems.</span></span> <span data-ttu-id="aafcb-111">La registrazione di un evento di avviso quando l'allocazione di memoria non riesce può aiutare a indicare la cause di una situazione di memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="aafcb-111">Logging a Warning event when memory allocation fails can help indicate the cause of a low-memory situation.</span></span>
-   <span data-ttu-id="aafcb-112">Problemi hardware.</span><span class="sxs-lookup"><span data-stu-id="aafcb-112">Hardware problems.</span></span> <span data-ttu-id="aafcb-113">Se un driver di dispositivo rileva un timeout del controller del disco, un'interruzione dell'alimentazione in una porta parallela o un errore di dati da una rete o da una scheda seriale, il driver di dispositivo può registrare le informazioni relative a questi eventi per consentire all'amministratore di sistema di diagnosticare i problemi hardware.</span><span class="sxs-lookup"><span data-stu-id="aafcb-113">If a device driver encounters a disk controller time-out, a power failure in a parallel port, or a data error from a network or serial card, the device driver can log information about these events to help the system administrator diagnose hardware problems.</span></span>
-   <span data-ttu-id="aafcb-114">Settori danneggiati.</span><span class="sxs-lookup"><span data-stu-id="aafcb-114">Bad sectors.</span></span> <span data-ttu-id="aafcb-115">Se un driver del disco rileva un settore errato, è possibile che sia in grado di leggere o scrivere nel settore dopo aver ritentato l'operazione, ma il settore non andrà a buon fine.</span><span class="sxs-lookup"><span data-stu-id="aafcb-115">If a disk driver encounters a bad sector, it may be able to read from or write to the sector after retrying the operation, but the sector will go bad eventually.</span></span> <span data-ttu-id="aafcb-116">Se il driver del disco può continuare, deve registrare un evento di avviso. in caso contrario, dovrebbe registrare un evento di errore.</span><span class="sxs-lookup"><span data-stu-id="aafcb-116">If the disk driver can proceed, it should log a Warning event; otherwise, it should log an Error event.</span></span> <span data-ttu-id="aafcb-117">Se un driver file system trova un numero elevato di settori danneggiati e li corregge, la registrazione degli eventi di avviso può aiutare un amministratore a determinare se il disco sta per avere esito negativo.</span><span class="sxs-lookup"><span data-stu-id="aafcb-117">If a file system driver finds a large number of bad sectors and fixes them, logging Warning events might help an administrator determine that the disk may be about to fail.</span></span>
-   <span data-ttu-id="aafcb-118">Eventi informativi.</span><span class="sxs-lookup"><span data-stu-id="aafcb-118">Information events.</span></span> <span data-ttu-id="aafcb-119">Un'applicazione server, ad esempio un server di database, registra un utente che esegue l'accesso, apre un database o avvia un trasferimento di file.</span><span class="sxs-lookup"><span data-stu-id="aafcb-119">A server application (such as a database server) records a user logging on, opening a database, or starting a file transfer.</span></span> <span data-ttu-id="aafcb-120">Il server può inoltre registrare altri eventi, ad esempio errori (non può accedere al file, al processo host disconnesso e così via), al danneggiamento del database o se un trasferimento di file è stato eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="aafcb-120">The server can also log other events such as errors (cannot access file, host process disconnected, and so on), database corruption, or whether a file transfer was successful.</span></span>

## <a name="writing-messages"></a><span data-ttu-id="aafcb-121">Scrittura di messaggi</span><span class="sxs-lookup"><span data-stu-id="aafcb-121">Writing Messages</span></span>

<span data-ttu-id="aafcb-122">I messaggi devono avere senso per gli amministratori e gli utenti che tentano di risolvere un problema.</span><span class="sxs-lookup"><span data-stu-id="aafcb-122">Messages should make sense to administrators and users who are trying to troubleshoot a problem.</span></span> <span data-ttu-id="aafcb-123">Un messaggio deve contenere tutte le informazioni necessarie per capire cosa ha causato il problema e come correggerlo.</span><span class="sxs-lookup"><span data-stu-id="aafcb-123">A message should contain all the information needed to understand what caused the problem and how to correct it.</span></span>

<span data-ttu-id="aafcb-124">Evitare di scrivere un messaggio enigmatico, ad esempio "un pacchetto driver ricevuto dal sottosistema di I/O non è valido.</span><span class="sxs-lookup"><span data-stu-id="aafcb-124">Avoid writing a cryptic message such as "A driver packet received from the I/O subsystem was invalid.</span></span> <span data-ttu-id="aafcb-125">I dati sono il pacchetto ". Un messaggio migliore indicherà che il driver in questione funziona correttamente, ma che registra pacchetti formattati in modo errato.</span><span class="sxs-lookup"><span data-stu-id="aafcb-125">The data is the packet."A better message would indicate that the driver in question is functioning properly, but is logging incorrectly formatted packets.</span></span> <span data-ttu-id="aafcb-126">Per risolvere il problema, è possibile che sia necessaria una versione Unicode del driver.</span><span class="sxs-lookup"><span data-stu-id="aafcb-126">It could go on to say that a Unicode version of the driver is needed to correct the problem.</span></span> <span data-ttu-id="aafcb-127">Per ulteriori informazioni sulla scrittura di messaggi di errore validi, vedere [linee guida](/windows/desktop/Debug/error-message-guidelines)per i messaggi di errore.</span><span class="sxs-lookup"><span data-stu-id="aafcb-127">For more information about writing good error messages, see [Error Message Guidelines](/windows/desktop/Debug/error-message-guidelines).</span></span>

<span data-ttu-id="aafcb-128">Non utilizzare tabulazioni o virgole nel testo del messaggio, perché i registri eventi possono essere salvati come file di testo delimitati da virgole o tabulazioni.</span><span class="sxs-lookup"><span data-stu-id="aafcb-128">Do not use tabs or commas in the message text, because event logs can be saved as comma or tab-separated text files.</span></span> <span data-ttu-id="aafcb-129">Molte organizzazioni importano questi file nei database e i caratteri di formattazione aggiuntivi richiedono la manipolazione manuale.</span><span class="sxs-lookup"><span data-stu-id="aafcb-129">Many organizations import these files into databases, and the extra formatting characters will require manual manipulation.</span></span>

<span data-ttu-id="aafcb-130">Quando si utilizzano nomi UNC o altri collegamenti contenenti spazi, racchiudere il nome tra parentesi angolari.</span><span class="sxs-lookup"><span data-stu-id="aafcb-130">When using UNC names, or other links that contain spaces, enclose the name in angle brackets.</span></span> <span data-ttu-id="aafcb-131">Ad esempio, <\\ \\ *ShareName* \\ *ServerName*>.</span><span class="sxs-lookup"><span data-stu-id="aafcb-131">For example, <\\\\*sharename*\\*servername*>.</span></span> <span data-ttu-id="aafcb-132">È possibile scrivere un URL alla fine del messaggio che indica all'utente il materiale della Guida correlato.</span><span class="sxs-lookup"><span data-stu-id="aafcb-132">You can write a URL to the end of the message that points the user to related help material.</span></span> <span data-ttu-id="aafcb-133">L'URL deve essere un nome host DNS completo.</span><span class="sxs-lookup"><span data-stu-id="aafcb-133">The URL must be a fully qualified DNS host name.</span></span> <span data-ttu-id="aafcb-134">Ad esempio, è possibile aggiungere il testo seguente ai messaggi: "per ulteriori informazioni su questo messaggio, visitare il sito del supporto tecnico all'indirizzo https://www.microsoft.com/Support/ProdRedirect/ContentSearch.asp ".</span><span class="sxs-lookup"><span data-stu-id="aafcb-134">For example, you could append the following text to your messages: "For additional information on this message, please visit our support site at https://www.microsoft.com/Support/ProdRedirect/ContentSearch.asp."</span></span> <span data-ttu-id="aafcb-135">Il collegamento porterebbe a una pagina ASP che reindirizza l'utente al contenuto relativo al messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="aafcb-135">The link would lead to an ASP page that redirects the user to content relating to the error message.</span></span> <span data-ttu-id="aafcb-136">Analizzerà i parametri aggiuntivi (passati quando si fa clic sull'URL) per determinare dove reindirizzare l'utente.</span><span class="sxs-lookup"><span data-stu-id="aafcb-136">It would parse additional parameters (passed when the URL is clicked) to determine where to redirect the user.</span></span>

<span data-ttu-id="aafcb-137">Gli argomenti passati alla funzione [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) vengono aggiunti all'URL come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="aafcb-137">The arguments passed to the [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) function are appended to the URL as follows:</span></span>

``` syntax
strHTTPQuery += L"?EvtSrc=" + _strEscapedSource;
strHTTPQuery += L"&EvtCat=" + _strEscapedCategory;
strHTTPQuery += L"&EvtID=" + _strEscapedEventID;
strHTTPQuery += L"&EvtCatID=" + _strEscapedCategoryID;
strHTTPQuery += L"&EvtType=" + _strEscapedType;
strHTTPQuery += L"&EvtTypeID=" + _strEscapedTypeID;
strHTTPQuery += L"&EvtRptTime=" + _strEscapedDateAndTime;
strHTTPQuery += L"&EvtTZBias=" + _strEscapedTimeZoneBias;
```

<span data-ttu-id="aafcb-138">Se il nome della società, il nome del prodotto, la versione del prodotto, il nome del file e la versione del file dall'intestazione DLL del messaggio per l'origine evento sono validi, vengono aggiunti anche all'URL:</span><span class="sxs-lookup"><span data-stu-id="aafcb-138">If the company name, product name, product version, file name, and file version from the message DLL header for the event source are valid, they are also appended to the URL:</span></span>

``` syntax
ADD_VER_STR(L"CoName",   _strEscapedCompanyName);
ADD_VER_STR(L"ProdName", _strEscapedProductName);
ADD_VER_STR(L"ProdVer",  _strEscapedProductVersion);
ADD_VER_STR(L"FileName", _strEscapedFileName);
ADD_VER_STR(L"FileVer",  _strEscapedFileVersion);
```

## <a name="reducing-overhead"></a><span data-ttu-id="aafcb-139">Riduzione del sovraccarico</span><span class="sxs-lookup"><span data-stu-id="aafcb-139">Reducing Overhead</span></span>

<span data-ttu-id="aafcb-140">La registrazione degli eventi utilizza risorse quali lo spazio su disco e il tempo processore.</span><span class="sxs-lookup"><span data-stu-id="aafcb-140">Event logging consumes resources such as disk space and processor time.</span></span> <span data-ttu-id="aafcb-141">La quantità di spazio su disco richiesta da un log eventi e l'overhead per un'applicazione che registra gli eventi dipendono dalla quantità di informazioni che si sceglie di registrare.</span><span class="sxs-lookup"><span data-stu-id="aafcb-141">The amount of disk space that an event log requires and the overhead for an application that logs events depend on how much information you choose to log.</span></span> <span data-ttu-id="aafcb-142">Per questo motivo è importante registrare solo le informazioni essenziali.</span><span class="sxs-lookup"><span data-stu-id="aafcb-142">This is why it is important to log only essential information.</span></span> <span data-ttu-id="aafcb-143">È anche opportuno inserire le chiamate di registrazione eventi in un percorso di errore nel codice anziché nel percorso del codice principale, riducendo così le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="aafcb-143">It is also good to place event logging calls in an error path in the code rather than in the main code path, which would reduce performance.</span></span>

<span data-ttu-id="aafcb-144">La quantità di spazio su disco necessaria per ogni record del registro eventi include i membri della struttura [**EVENTLOGRECORD**](/windows/desktop/api/Winnt/ns-winnt-eventlogrecord) .</span><span class="sxs-lookup"><span data-stu-id="aafcb-144">The amount of disk space required for each event log record includes the members of the [**EVENTLOGRECORD**](/windows/desktop/api/Winnt/ns-winnt-eventlogrecord) structure.</span></span> <span data-ttu-id="aafcb-145">Si tratta di una struttura a lunghezza variabile. le stringhe e i dati binari vengono archiviati dopo la struttura.</span><span class="sxs-lookup"><span data-stu-id="aafcb-145">This is a variable length structure; strings and binary data are stored following the structure.</span></span>

 

 
