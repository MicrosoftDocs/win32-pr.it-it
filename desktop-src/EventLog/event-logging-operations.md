---
description: Le funzioni OpenEventLog, OpenBackupEventLog, RegisterEventSource, DeregisterEventSource e CloseEventLog aprono e chiudono gli handle del registro eventi.
ms.assetid: e42a66c2-2f1e-46f8-99c7-4701075c8ec3
title: Operazioni di registrazione eventi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 065acd268788de8c9674baa1fe47a3b89a719d4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310819"
---
# <a name="event-logging-operations"></a><span data-ttu-id="ef1b6-103">Operazioni di registrazione eventi</span><span class="sxs-lookup"><span data-stu-id="ef1b6-103">Event Logging Operations</span></span>

<span data-ttu-id="ef1b6-104">Le funzioni [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga), [**OpenBackupEventLog**](/windows/desktop/api/Winbase/nf-winbase-openbackupeventloga), [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea), [**DeRegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-deregistereventsource)e [**CloseEventLog**](/windows/desktop/api/Winbase/nf-winbase-closeeventlog) aprono e chiudono gli handle del registro eventi.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-104">The [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga), [**OpenBackupEventLog**](/windows/desktop/api/Winbase/nf-winbase-openbackupeventloga), [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea), [**DeregisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-deregistereventsource), and [**CloseEventLog**](/windows/desktop/api/Winbase/nf-winbase-closeeventlog) functions open and close event log handles.</span></span>

<span data-ttu-id="ef1b6-105">Nella tabella seguente vengono illustrate le operazioni che possono essere eseguite su un registro eventi aperto e la funzione corrispondente per ogni operazione.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-105">The following table shows the operations that can be performed on an open event log, and the corresponding function for each operation.</span></span>



| <span data-ttu-id="ef1b6-106">Operazione</span><span class="sxs-lookup"><span data-stu-id="ef1b6-106">Operation</span></span> | <span data-ttu-id="ef1b6-107">Funzione</span><span class="sxs-lookup"><span data-stu-id="ef1b6-107">Function</span></span>                                                                                                                     |
|-----------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ef1b6-108">Backup</span><span class="sxs-lookup"><span data-stu-id="ef1b6-108">Backup</span></span>    | [<span data-ttu-id="ef1b6-109">**BackupEventLog**</span><span class="sxs-lookup"><span data-stu-id="ef1b6-109">**BackupEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-backupeventloga)                                                                                     |
| <span data-ttu-id="ef1b6-110">Cancella</span><span class="sxs-lookup"><span data-stu-id="ef1b6-110">Clear</span></span>     | [<span data-ttu-id="ef1b6-111">**ClearEventLog**</span><span class="sxs-lookup"><span data-stu-id="ef1b6-111">**ClearEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-cleareventloga)                                                                                       |
| <span data-ttu-id="ef1b6-112">Monitoraggio</span><span class="sxs-lookup"><span data-stu-id="ef1b6-112">Monitor</span></span>   | [<span data-ttu-id="ef1b6-113">**NotifyChangeEventLog**</span><span class="sxs-lookup"><span data-stu-id="ef1b6-113">**NotifyChangeEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-notifychangeeventlog)                                                                         |
| <span data-ttu-id="ef1b6-114">Query</span><span class="sxs-lookup"><span data-stu-id="ef1b6-114">Query</span></span>     | <span data-ttu-id="ef1b6-115">[**GetOldestEventLogRecord**](/windows/desktop/api/Winbase/nf-winbase-getoldesteventlogrecord), [ **GetNumberOfEventLogRecords**](/windows/desktop/api/Winbase/nf-winbase-getnumberofeventlogrecords)</span><span class="sxs-lookup"><span data-stu-id="ef1b6-115">[**GetOldestEventLogRecord**](/windows/desktop/api/Winbase/nf-winbase-getoldesteventlogrecord), [**GetNumberOfEventLogRecords**](/windows/desktop/api/Winbase/nf-winbase-getnumberofeventlogrecords)</span></span> |
| <span data-ttu-id="ef1b6-116">Lettura</span><span class="sxs-lookup"><span data-stu-id="ef1b6-116">Read</span></span>      | [<span data-ttu-id="ef1b6-117">**ReadEventLog**</span><span class="sxs-lookup"><span data-stu-id="ef1b6-117">**ReadEventLog**</span></span>](/windows/desktop/api/Winbase/nf-winbase-readeventloga)                                                                                         |
| <span data-ttu-id="ef1b6-118">Scrittura</span><span class="sxs-lookup"><span data-stu-id="ef1b6-118">Write</span></span>     | [<span data-ttu-id="ef1b6-119">**ReportEvent**</span><span class="sxs-lookup"><span data-stu-id="ef1b6-119">**ReportEvent**</span></span>](/windows/desktop/api/Winbase/nf-winbase-reporteventa)                                                                                           |



 

<span data-ttu-id="ef1b6-120">Le funzioni [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) e [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) accettano un nome server facoltativo come parametro in modo che le operazioni possano essere eseguite sul server remoto.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-120">The [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) and [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) functions take an optional server name as a parameter so the operations can be performed on the remote server.</span></span> <span data-ttu-id="ef1b6-121">Utilizzare [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) per la lettura o l'esecuzione di operazioni amministrative (backup, cancellazione, monitoraggio e query) nel log e utilizzare [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea) per la scrittura nel log.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-121">Use [**OpenEventLog**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) for reading or performing administrative operations (backup, clear, monitor, and query) on the log, and use [**RegisterEventSource**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea) for writing to the log.</span></span>

<span data-ttu-id="ef1b6-122">Ogni chiamata a una funzione di registrazione eventi è un'operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-122">Each call to an event logging function is an atomic operation.</span></span> <span data-ttu-id="ef1b6-123">Quando si esegue la lettura dal registro eventi, vengono restituiti solo i record dell'intero evento.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-123">When you read from the event log, only whole event records are returned.</span></span> <span data-ttu-id="ef1b6-124">Quando si scrive nel registro eventi, è garantito che ogni record di evento venga scritto in sequenza come record completo nel log.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-124">When you write to the event log, each event record is guaranteed to be written sequentially as a complete record in the log.</span></span> <span data-ttu-id="ef1b6-125">Nell'elenco seguente viene descritto il modo in cui il servizio di registrazione eventi gestisce condizioni speciali:</span><span class="sxs-lookup"><span data-stu-id="ef1b6-125">The following list describes how the event-logging service handles special conditions:</span></span>

-   <span data-ttu-id="ef1b6-126">Il servizio di registrazione eventi riceve un'operazione di lettura e un'operazione di scrittura allo stesso tempo: se la posizione di lettura si trova alla fine del file, l'operazione di lettura ha esito negativo con lo stato "fine del file" (se l'operazione di scrittura non è stata completata) o restituisce il nuovo record, se l'operazione di scrittura è stata completata.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-126">The event-logging service receives a read operation and a write operation at the same time: If the read position is at the end of the file, either the read operation fails with an "end-of-file" status (if the write operation has not been completed), or it returns the new record (if the write operation has been completed).</span></span>
-   <span data-ttu-id="ef1b6-127">Il servizio di registrazione eventi completa un'operazione di cancellazione prima di ricevere un'operazione di lettura: l'operazione di lettura ha esito negativo con lo stato "fine del file".</span><span class="sxs-lookup"><span data-stu-id="ef1b6-127">The event-logging service completes a clear operation before receiving a read operation: The read operation fails with "end-of-file" status.</span></span>
-   <span data-ttu-id="ef1b6-128">Il servizio di registrazione eventi completa un'operazione di cancellazione prima di ricevere un'operazione di scrittura: l'operazione di cancellazione tronca il log, quindi l'operazione di scrittura aggiunge il nuovo record all'inizio del log.</span><span class="sxs-lookup"><span data-stu-id="ef1b6-128">The event-logging service completes a clear operation before receiving a write operation: The clear operation truncates the log, then the write operation adds the new record at the beginning of the log.</span></span>

 

 



