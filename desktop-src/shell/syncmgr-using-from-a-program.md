---
description: Per consentire all'applicazione di utilizzare Gestione sincronizzazione, è necessario implementare un oggetto Component Object Model (COM) per gestire le notifiche di sincronizzazione ricevute da SyncMgr.
title: Utilizzo di gestione sincronizzazione da un programma
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bf18d493-0fe7-46e7-9686-f7ee75b3039b
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 9bd5abdc382c82c6c1aafcda3a967337384dc807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104530175"
---
# <a name="using-synchronization-manager-from-a-program"></a><span data-ttu-id="af918-103">Utilizzo di gestione sincronizzazione da un programma</span><span class="sxs-lookup"><span data-stu-id="af918-103">Using Synchronization Manager from a Program</span></span>

<span data-ttu-id="af918-104">Per consentire all'applicazione di utilizzare Gestione sincronizzazione, è necessario implementare un oggetto Component Object Model (COM) per gestire le notifiche di sincronizzazione ricevute da SyncMgr.</span><span class="sxs-lookup"><span data-stu-id="af918-104">To enable your application to work with the Synchronization Manager you must implement a Component Object Model (COM) object to handle synchronization notifications that you receive from SyncMgr.</span></span> <span data-ttu-id="af918-105">Il gestore dell'applicazione esegue la sincronizzazione per gli elementi gestiti.</span><span class="sxs-lookup"><span data-stu-id="af918-105">Your application's handler performs the synchronization for the items that you handle.</span></span> <span data-ttu-id="af918-106">Incluso nel gestore, è necessario implementare l'interfaccia [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="af918-106">Included in your handler, you must implement the [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="af918-107">Inoltre, è necessario fornire un oggetto enumeratore e [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) per eventuali elementi distinti che l'applicazione può sincronizzare.</span><span class="sxs-lookup"><span data-stu-id="af918-107">Also, you must provide an enumerator object and [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) for any separate items that your application can synchronize.</span></span>

<span data-ttu-id="af918-108">SyncMgr implementa [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) e [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span><span class="sxs-lookup"><span data-stu-id="af918-108">SyncMgr implements [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) and [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span></span>

<span data-ttu-id="af918-109">SyncMgr chiama i metodi in [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) per ottenere informazioni sugli elementi gestiti dall'applicazione e informazioni sul gestore fornito per la sincronizzazione di questi elementi.</span><span class="sxs-lookup"><span data-stu-id="af918-109">The SyncMgr calls methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) to get information on the items that your application handles and information on the handler that you provide for synchronizing these items.</span></span>

<span data-ttu-id="af918-110">In fase di esecuzione, il processo di sincronizzazione segue questa procedura.</span><span class="sxs-lookup"><span data-stu-id="af918-110">At runtime, the synchronization process follows these steps.</span></span>

1.  <span data-ttu-id="af918-111">SyncMgr notifica all'applicazione che è il momento di eseguire la sincronizzazione per uno degli elementi gestiti dall'applicazione chiamando il metodo [**ISyncMgrSynchronize:: Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) .</span><span class="sxs-lookup"><span data-stu-id="af918-111">SyncMgr notifies your application that it is time for synchronization to occur for one of the items that your application handles by calling your [**ISyncMgrSynchronize::Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) method.</span></span>
2.  <span data-ttu-id="af918-112">SyncMgr chiama [**ISyncMgrSynchronize:: EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) per ottenere l'interfaccia [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) per gli elementi gestiti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="af918-112">SyncMgr calls [**ISyncMgrSynchronize::EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) to obtain the [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) interface for the items handled by your application.</span></span>
3.  <span data-ttu-id="af918-113">SyncMgr chiama [**ISyncMgrSynchronize:: SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) per fornire al gestore il puntatore di interfaccia per l'interfaccia [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) .</span><span class="sxs-lookup"><span data-stu-id="af918-113">SyncMgr calls [**ISyncMgrSynchronize::SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) to provide your handler with the interface pointer for the [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) interface.</span></span> <span data-ttu-id="af918-114">Il gestore usa questa interfaccia per richiamare SyncMgr durante la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="af918-114">Your handler uses this interface to call back to the SyncMgr during synchronization.</span></span>
4.  <span data-ttu-id="af918-115">SyncMgr chiama quindi il metodo [**ISyncMgrSynchronize::P repareforsync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) per fornire al gestore la possibilità di visualizzare qualsiasi elemento dell'interfaccia utente necessario prima che inizi la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="af918-115">SyncMgr then calls your [**ISyncMgrSynchronize::PrepareForSync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) method to give your handler a chance to display any user interface element that is necessary before synchronization begins.</span></span> <span data-ttu-id="af918-116">Ad esempio, un'applicazione di posta elettronica può visualizzare una finestra di dialogo di accesso utente.</span><span class="sxs-lookup"><span data-stu-id="af918-116">For example, an email application may display a user logon dialog.</span></span>
5.  <span data-ttu-id="af918-117">Il gestore chiama [**ISyncMgrSynchronizeCallback:: EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) prima e dopo la visualizzazione di tutti gli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="af918-117">Your handler calls [**ISyncMgrSynchronizeCallback::EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) before and after displaying any user interface elements.</span></span> <span data-ttu-id="af918-118">Il gestore chiama [**ISyncMgrSynchronizeCallback::P repareforsynccompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) al termine dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="af918-118">Your handler calls [**ISyncMgrSynchronizeCallback::PrepareForSyncCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) when you are done.</span></span>
6.  <span data-ttu-id="af918-119">SyncMgr chiama il metodo [**ISyncMgrSynchronize:: Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) per avviare la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="af918-119">SyncMgr calls your [**ISyncMgrSynchronize::Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) method to start the synchronization.</span></span>

<span data-ttu-id="af918-120">Durante il processo di sincronizzazione, SyncMgr continua a chiamare i metodi nell'interfaccia [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="af918-120">During the synchronization process, SyncMgr continues to call methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="af918-121">Può inviare gli errori del gestore, lo stato di avanzamento e le notifiche.</span><span class="sxs-lookup"><span data-stu-id="af918-121">It can send your handler errors, progress, and notifications.</span></span> <span data-ttu-id="af918-122">Può inoltre enumerare gli elementi gestiti dall'applicazione o consentire all'applicazione di visualizzare le proprietà degli elementi.</span><span class="sxs-lookup"><span data-stu-id="af918-122">It can also enumerate through the items that your application handles or allow your application to show properties for the items.</span></span>

<span data-ttu-id="af918-123">Il gestore chiama i metodi in [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) per determinare se un elemento deve essere ignorato, per registrare gli errori e per inviare informazioni sullo stato di avanzamento durante il processo di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="af918-123">Your handler calls methods in [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) to determine if an item should be skipped, to log errors, and to post progress information during the synchronization process.</span></span>

<span data-ttu-id="af918-124">Per ulteriori informazioni, vedere le pagine di riferimento correlate per le interfacce necessarie.</span><span class="sxs-lookup"><span data-stu-id="af918-124">For further information, see the related reference pages for the interfaces involved.</span></span>

<span data-ttu-id="af918-125">Al termine della sincronizzazione, il gestore chiama [**ISyncMgrSynchronizeCallback:: SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span><span class="sxs-lookup"><span data-stu-id="af918-125">When the synchronization is completed, your handler calls [**ISyncMgrSynchronizeCallback::SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span></span>

 

 



