---
description: I gestori di sovrimpressione delle icone sono oggetti COM (Component Object Model in-process), implementati come dll.
ms.assetid: ADF27BFD-CC96-43F9-9EBB-DEBE0DEA7B92
title: Come implementare i gestori di sovrimpressione delle icone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e22c1057f65c50b31c6627846ec77103827a0283
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979535"
---
# <a name="how-to-implement-icon-overlay-handlers"></a><span data-ttu-id="63475-103">Come implementare i gestori di sovrimpressione delle icone</span><span class="sxs-lookup"><span data-stu-id="63475-103">How to Implement Icon Overlay Handlers</span></span>

<span data-ttu-id="63475-104">I gestori di sovrimpressione delle icone sono oggetti COM (Component Object Model in-process), implementati come dll.</span><span class="sxs-lookup"><span data-stu-id="63475-104">Icon overlay handlers are in-process Component Object Model (COM) objects, implemented as DLLs.</span></span> <span data-ttu-id="63475-105">Esportano un'interfaccia oltre a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span><span class="sxs-lookup"><span data-stu-id="63475-105">They export one interface in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span></span> <span data-ttu-id="63475-106">Questa interfaccia ha tre metodi: [**IShellIconOverlayIdentifier:: GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier:: GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority)e [**IShellIconOverlayIdentifier:: IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span><span class="sxs-lookup"><span data-stu-id="63475-106">This interface has three methods: [**IShellIconOverlayIdentifier::GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier::GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority), and [**IShellIconOverlayIdentifier::IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span></span>

## <a name="instructions"></a><span data-ttu-id="63475-107">Istruzioni</span><span class="sxs-lookup"><span data-stu-id="63475-107">Instructions</span></span>

### <a name="step-1-implementing-getoverlayinfo"></a><span data-ttu-id="63475-108">Passaggio 1: implementazione di GetOverlayInfo</span><span class="sxs-lookup"><span data-stu-id="63475-108">Step 1: Implementing GetOverlayInfo</span></span>

<span data-ttu-id="63475-109">Il metodo [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) viene chiamato per la prima volta durante l'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="63475-109">The [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) method is first called during initialization.</span></span> <span data-ttu-id="63475-110">Il metodo restituisce il percorso completo del file che contiene l'immagine sovrapposta all'icona e il relativo indice in base zero all'interno del file.</span><span class="sxs-lookup"><span data-stu-id="63475-110">The method returns the fully qualified path of the file that contains the icon overlay image, and its zero-based index within the file.</span></span> <span data-ttu-id="63475-111">La shell aggiunge quindi l'immagine all'elenco di immagini di sistema.</span><span class="sxs-lookup"><span data-stu-id="63475-111">The Shell then adds the image to the system image list.</span></span> <span data-ttu-id="63475-112">Le sovrapposizioni di icone possono essere contenute in uno dei tipi di file standard, tra cui. exe,. dll e. ico.</span><span class="sxs-lookup"><span data-stu-id="63475-112">Icon overlays can be contained in any of the standard file types, including .exe, .dll, and .ico.</span></span>

<span data-ttu-id="63475-113">Al termine dell'inizializzazione, la shell chiama [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) quando è necessario visualizzare la sovrapposizione dell'icona del gestore.</span><span class="sxs-lookup"><span data-stu-id="63475-113">After initialization is complete, the Shell calls [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) when it needs to display the handler's icon overlay.</span></span> <span data-ttu-id="63475-114">Il metodo deve restituire lo stesso nome file e lo stesso indice che ha fatto durante l'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="63475-114">The method should return the same file name and index that it did during initialization.</span></span> <span data-ttu-id="63475-115">Sebbene la shell usi l'immagine memorizzata nella cache dell'elenco di immagini del sistema anziché caricare l'immagine dal file, una sovrapposizione di icone viene ancora identificata dal nome e dall'indice del file.</span><span class="sxs-lookup"><span data-stu-id="63475-115">Although the Shell uses the image that is cached in the system image list rather than loading the image from the file, an icon overlay is still identified by its file name and index.</span></span>

### <a name="step-2-implementing-getpriority"></a><span data-ttu-id="63475-116">Passaggio 2: implementazione di GetPriority</span><span class="sxs-lookup"><span data-stu-id="63475-116">Step 2: Implementing GetPriority</span></span>

<span data-ttu-id="63475-117">Il metodo [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) viene chiamato solo durante l'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="63475-117">The [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) method is called only during initialization.</span></span> <span data-ttu-id="63475-118">Assegna un valore di priorità alla sovrapposizione dell'icona del gestore.</span><span class="sxs-lookup"><span data-stu-id="63475-118">It assigns a priority value to the handler's icon overlay.</span></span> <span data-ttu-id="63475-119">Il valore può variare da zero a 100, dove 100 è la priorità più bassa.</span><span class="sxs-lookup"><span data-stu-id="63475-119">The value can range from zero to 100, where 100 is the lowest priority.</span></span> <span data-ttu-id="63475-120">Lo scopo di questo valore di priorità è aiutare la shell a risolvere il conflitto che si verifica quando vengono specificate più sovrapposizioni di icone per un singolo oggetto.</span><span class="sxs-lookup"><span data-stu-id="63475-120">The purpose of this priority value is to help the Shell resolve the conflict that arises when multiple icon overlays are specified for a single object.</span></span> <span data-ttu-id="63475-121">La shell USA innanzitutto un set di regole interno per determinare la sovrapposizione dell'icona con priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="63475-121">The Shell first uses an internal set of rules to determine the highest-priority icon overlay.</span></span> <span data-ttu-id="63475-122">Se queste regole non consentono di risolvere il conflitto, i valori assegnati alle icone sovrapposte da **GetPriority** determinano la priorità.</span><span class="sxs-lookup"><span data-stu-id="63475-122">If these rules do not resolve the conflict, the values assigned to the icon overlays by **GetPriority** determine priority.</span></span>

<span data-ttu-id="63475-123">Il valore di priorità impostato da [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) non è un modo affidabile per risolvere i conflitti tra i gestori sovrapposti delle icone non correlate.</span><span class="sxs-lookup"><span data-stu-id="63475-123">The priority value set by [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) is not a reliable way to resolve conflicts between unrelated icon overlay handlers.</span></span> <span data-ttu-id="63475-124">Non esiste alcun modo per il gestore per determinare quali valori di priorità utilizzano altri gestori.</span><span class="sxs-lookup"><span data-stu-id="63475-124">There is no way for your handler to determine what priority values other handlers are using.</span></span> <span data-ttu-id="63475-125">In genere, è necessario impostare il valore su zero.</span><span class="sxs-lookup"><span data-stu-id="63475-125">Normally, you should set the value to zero.</span></span> <span data-ttu-id="63475-126">Tuttavia, il valore di priorità è utile quando sono stati implementati due o più gestori di sovrapposizioni di icone che possono richiedere icone di sovrapposizione icona per lo stesso oggetto.</span><span class="sxs-lookup"><span data-stu-id="63475-126">However, the priority value is useful when you have implemented two or more icon overlay handlers that can request icon overlay icons for the same object.</span></span> <span data-ttu-id="63475-127">Impostando in modo appropriato i valori di priorità, è possibile specificare quale verrà visualizzata la sovrimpressione dell'icona richiesta.</span><span class="sxs-lookup"><span data-stu-id="63475-127">By setting the priority values appropriately, you can specify which of the requested icon overlays will be displayed.</span></span>

### <a name="step-3-implementing-ismemberof"></a><span data-ttu-id="63475-128">Passaggio 3: implementazione di IsMemberOf</span><span class="sxs-lookup"><span data-stu-id="63475-128">Step 3: Implementing IsMemberOf</span></span>

<span data-ttu-id="63475-129">La shell chiama il metodo [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) per determinare se deve visualizzare la sovrimpressione dell'icona di un gestore per un oggetto specifico.</span><span class="sxs-lookup"><span data-stu-id="63475-129">The Shell calls the [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) method to determine whether it should display a handler's icon overlay for a particular object.</span></span> <span data-ttu-id="63475-130">La shell specifica l'oggetto passandone il nome al metodo.</span><span class="sxs-lookup"><span data-stu-id="63475-130">The Shell specifies the object by passing its name to the method.</span></span> <span data-ttu-id="63475-131">Se un gestore desidera che venga visualizzata la sovrimpressione dell'icona, **IsMemberOf** restituisce S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="63475-131">If a handler wants to have its icon overlay displayed, **IsMemberOf** returns S\_OK.</span></span> <span data-ttu-id="63475-132">In caso contrario, restituisce \_ false.</span><span class="sxs-lookup"><span data-stu-id="63475-132">If not, it returns S\_FALSE.</span></span>

<span data-ttu-id="63475-133">I gestori di sovrimpressione delle icone sono normalmente progettati per funzionare con un particolare gruppo di file.</span><span class="sxs-lookup"><span data-stu-id="63475-133">Icon overlay handlers are normally intended to work with a particular group of files.</span></span> <span data-ttu-id="63475-134">Un esempio tipico è un [tipo di file](fa-file-types.md), identificato da un'estensione di file specifica.</span><span class="sxs-lookup"><span data-stu-id="63475-134">A typical example is a [file type](fa-file-types.md), identified by a specific file name extension.</span></span> <span data-ttu-id="63475-135">Un gestore sovrapposizione icone può richiedere una sovrapposizione di icone per tutti i file del tipo di file.</span><span class="sxs-lookup"><span data-stu-id="63475-135">An icon overlay handler can request an icon overlay for all files of the file type.</span></span> <span data-ttu-id="63475-136">Alcuni gestori richiedono una sovrapposizione di icone solo se un file del tipo di file si trova in uno stato specifico.</span><span class="sxs-lookup"><span data-stu-id="63475-136">Some handlers request an icon overlay only if a file of the file type is in a particular state.</span></span> <span data-ttu-id="63475-137">Tuttavia, i gestori di sovrimpressione delle icone sono liberi di richiedere la sovrapposizione delle icone per qualsiasi oggetto scelto.</span><span class="sxs-lookup"><span data-stu-id="63475-137">However, icon overlay handlers are free to request their icon overlay for any object that they choose.</span></span>

 

 
