---
description: Prima di Windows Vista, è stato creato un elemento del pannello di controllo creando un file dll e definendolo con estensione CPL.
ms.assetid: 258dae28-c054-4392-b0e9-99493f23c814
title: Uso di CPLApplet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1e59b29dd7c082822ed63d425dd4967a542b5d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979479"
---
# <a name="using-cplapplet"></a><span data-ttu-id="36c9d-103">Uso di CPLApplet</span><span class="sxs-lookup"><span data-stu-id="36c9d-103">Using CPLApplet</span></span>

<span data-ttu-id="36c9d-104">Prima di Windows Vista, è stato creato un elemento del pannello di controllo creando un file dll e definendolo con estensione CPL.</span><span class="sxs-lookup"><span data-stu-id="36c9d-104">Prior to Windows Vista, you created a Control Panel item by creating a .dll file and naming it with a .cpl extension.</span></span> <span data-ttu-id="36c9d-105">Questo file ha esportato la funzione [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) .</span><span class="sxs-lookup"><span data-stu-id="36c9d-105">This file exported the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function.</span></span> <span data-ttu-id="36c9d-106">Questo schema è ancora supportato in Windows Vista e versioni successive e viene illustrato in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="36c9d-106">This scheme is still supported in Windows Vista and later versions and is discussed in this topic.</span></span> <span data-ttu-id="36c9d-107">Tuttavia, le linee guida per i nuovi elementi del pannello di controllo consigliano un approccio più semplice con l'elemento del pannello di controllo compilato come file con estensione exe che usa un layout del flusso di attività.</span><span class="sxs-lookup"><span data-stu-id="36c9d-107">However, the guidelines for new Control Panel items recommend a simpler approach with the Control Panel item built as a .exe file that uses a task flow layout.</span></span>

<span data-ttu-id="36c9d-108">Quando il pannello di controllo carica un file dll (o CPL), chiama la funzione [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) per ottenere informazioni come il numero di elementi del pannello di controllo che ospita il file, nonché informazioni su ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="36c9d-108">When Control Panel loads a .dll (or .cpl) file, it calls the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function to get information such as the number of Control Panel items the file hosts, as well as information about each item.</span></span> <span data-ttu-id="36c9d-109">Il pannello di controllo chiama anche la funzione quando la finestra dell'elemento è inizializzata, aperta o chiusa.</span><span class="sxs-lookup"><span data-stu-id="36c9d-109">Control Panel also calls the function when the item's window is initialized, opened, or closed.</span></span>

<span data-ttu-id="36c9d-110">Quando Windows carica innanzitutto l'elemento del pannello di controllo, recupera l'indirizzo della funzione [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) e successivamente lo usa per chiamare la funzione e passare i messaggi it.</span><span class="sxs-lookup"><span data-stu-id="36c9d-110">When Windows first loads the Control Panel item, it retrieves the address of the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function and subsequently uses that address to call the function and pass it messages.</span></span> <span data-ttu-id="36c9d-111">Potrebbe inviare i messaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="36c9d-111">It might send the following messages.</span></span>



| <span data-ttu-id="36c9d-112">Message</span><span class="sxs-lookup"><span data-stu-id="36c9d-112">Message</span></span>                                     | <span data-ttu-id="36c9d-113">Descrizione</span><span class="sxs-lookup"><span data-stu-id="36c9d-113">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="36c9d-114">**\_DBLCLK cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-114">**CPL\_DBLCLK**</span></span>](cpl-dblclk.md)           | <span data-ttu-id="36c9d-115">Inviato per notificare a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) che l'utente ha scelto l'icona associata a un elemento del pannello di controllo specificato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-115">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given Control Panel item.</span></span> <span data-ttu-id="36c9d-116">**CPlApplet** dovrebbe visualizzare la finestra di dialogo per l'elemento specificato ed eseguire tutte le attività specificate dall'utente.</span><span class="sxs-lookup"><span data-stu-id="36c9d-116">**CPlApplet** should display the dialog box for the specified item and carry out any user-specified tasks.</span></span> <span data-ttu-id="36c9d-117">Il parametro **CPlApplet** *lParam1* è un numero intero che rappresenta l'indice in base zero dell'elemento del pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="36c9d-117">The **CPlApplet** *lParam1* parameter is an integer that represents the zero-based index of the Control Panel item.</span></span> <span data-ttu-id="36c9d-118">Il parametro *lParam2* è il puntatore **lpData** restituito nella struttura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) o [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) nel messaggio [**cpl \_ Inquirer**](cpl-inquire.md) o [**cpl \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="36c9d-118">The *lParam2* parameter is the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="36c9d-119">Il valore restituito viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-119">The return value is ignored.</span></span>                                                                |
| [<span data-ttu-id="36c9d-120">**\_uscita cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-120">**CPL\_EXIT**</span></span>](cpl-exit.md)               | <span data-ttu-id="36c9d-121">Inviato dopo l'ultimo \_ messaggio di arresto cpl e immediatamente prima che Windows usi la funzione [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) per liberare la dll che contiene l'elemento del pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="36c9d-121">Sent after the last CPL\_STOP message and immediately before Windows uses the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function to free the DLL that contains the Control Panel item.</span></span> <span data-ttu-id="36c9d-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) deve liberare la memoria rimanente e prepararsi alla chiusura.</span><span class="sxs-lookup"><span data-stu-id="36c9d-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any remaining memory and prepare to close.</span></span> <span data-ttu-id="36c9d-123">Il valore restituito viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-123">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="36c9d-124">**\_conteggio cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-124">**CPL\_GETCOUNT**</span></span>](cpl-getcount.md)       | <span data-ttu-id="36c9d-125">Inviato dopo il \_ messaggio cpl init per richiedere a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) di restituire un numero che indichi il numero di sottoprogrammi supportati.</span><span class="sxs-lookup"><span data-stu-id="36c9d-125">Sent after the CPL\_INIT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to return a number that indicates how many subprograms it supports.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="36c9d-126">**\_init cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-126">**CPL\_INIT**</span></span>](cpl-init.md)               | <span data-ttu-id="36c9d-127">Inviato immediatamente dopo che la DLL contenente l'elemento del pannello di controllo è stata caricata.</span><span class="sxs-lookup"><span data-stu-id="36c9d-127">Sent immediately after the DLL that contains the Control Panel item is loaded.</span></span> <span data-ttu-id="36c9d-128">Il messaggio richiede a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) di eseguire le procedure di inizializzazione, inclusa l'allocazione della memoria.</span><span class="sxs-lookup"><span data-stu-id="36c9d-128">The message prompts [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to perform initialization procedures, including memory allocation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="36c9d-129">**domande su CPL \_**</span><span class="sxs-lookup"><span data-stu-id="36c9d-129">**CPL\_INQUIRE**</span></span>](cpl-inquire.md)         | <span data-ttu-id="36c9d-130">Inviato dopo il \_ messaggio cpl GetCount per richiedere a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) di fornire informazioni su un sottoprogramma specificato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-130">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified subprogram.</span></span> <span data-ttu-id="36c9d-131">Il valore *lParam1* è un numero intero che rappresenta l'indice in base zero del sottoprogramma su cui vengono richieste informazioni.</span><span class="sxs-lookup"><span data-stu-id="36c9d-131">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="36c9d-132">Il parametro *lParam2* di **CPlApplet** punta a una struttura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) .</span><span class="sxs-lookup"><span data-stu-id="36c9d-132">The *lParam2* parameter of **CPlApplet** points to a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) structure.</span></span> <span data-ttu-id="36c9d-133">Il valore restituito viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-133">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="36c9d-134">**\_NEWINQUIRE cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-134">**CPL\_NEWINQUIRE**</span></span>](cpl-newinquire.md)   | <span data-ttu-id="36c9d-135">Inviato dopo il \_ messaggio cpl GetCount per richiedere [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) per fornire informazioni su un elemento del pannello di controllo specificato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-135">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified Control Panel item.</span></span> <span data-ttu-id="36c9d-136">Il valore *lParam1* è un numero intero che rappresenta l'indice in base zero del sottoprogramma su cui vengono richieste informazioni.</span><span class="sxs-lookup"><span data-stu-id="36c9d-136">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="36c9d-137">Il parametro *lParam2* è un puntatore a una struttura [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) .</span><span class="sxs-lookup"><span data-stu-id="36c9d-137">The *lParam2* parameter is a pointer to a [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure.</span></span> <span data-ttu-id="36c9d-138">CPL \_ NEWINQUIRE in genere deve essere ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-138">CPL\_NEWINQUIRE normally should be ignored.</span></span> <span data-ttu-id="36c9d-139">L'applicazione deve elaborare solo CPL \_ Inquirer su Windows 95, Microsoft Windows NT 4,0 e versioni successive, perché le prestazioni del pannello di controllo soffrono quando \_ si usa cpl NEWINQUIRE.</span><span class="sxs-lookup"><span data-stu-id="36c9d-139">Your application should process only CPL\_INQUIRE on Windows 95, Microsoft Windows NT 4.0, and later systems since Control Panel performance suffers when CPL\_NEWINQUIRE is used.</span></span> <span data-ttu-id="36c9d-140">Questo perché le stringhe e le icone restituite non possono essere memorizzate nella cache.</span><span class="sxs-lookup"><span data-stu-id="36c9d-140">This is because the returned strings and icons cannot be cached.</span></span> <span data-ttu-id="36c9d-141">Il valore restituito viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-141">The return value is ignored.</span></span> |
| [<span data-ttu-id="36c9d-142">**\_selezione cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-142">**CPL\_SELECT**</span></span>](cpl-select.md)           | <span data-ttu-id="36c9d-143">Obsoleta.</span><span class="sxs-lookup"><span data-stu-id="36c9d-143">Obsolete.</span></span> <span data-ttu-id="36c9d-144">Le versioni correnti di Windows non inviano questo messaggio.</span><span class="sxs-lookup"><span data-stu-id="36c9d-144">Current versions of Windows do not send this message.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="36c9d-145">**\_STARTWPARMS cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-145">**CPL\_STARTWPARMS**</span></span>](cpl-startwparms.md) | <span data-ttu-id="36c9d-146">Inviato per notificare a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) che l'utente ha scelto l'icona associata a una determinata finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="36c9d-146">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given dialog box.</span></span> <span data-ttu-id="36c9d-147">**CPlApplet** dovrebbe visualizzare la finestra di dialogo corrispondente ed eseguire tutte le attività specificate dall'utente.</span><span class="sxs-lookup"><span data-stu-id="36c9d-147">**CPlApplet** should display the corresponding dialog box and carry out any user-specified tasks.</span></span> <span data-ttu-id="36c9d-148">Questo messaggio è simile a CPL \_ DblClk, ma potrebbero esserci alcune informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="36c9d-148">This message is similar to CPL\_DBLCLK, but there might be some additional information.</span></span> <span data-ttu-id="36c9d-149">Il parametro *lParam1* è il numero dell'elemento del pannello di controllo e *LParam2* è un **LPCTSTR** a tutte le direzioni aggiuntive che potrebbero essere necessarie.</span><span class="sxs-lookup"><span data-stu-id="36c9d-149">The *lParam1* parameter is the Control Panel item number and *lParam2* is an **LPCTSTR** to any extra directions that might be necessary.</span></span> <span data-ttu-id="36c9d-150">Restituisce **true** se il messaggio è gestito; in caso contrario, **false**.</span><span class="sxs-lookup"><span data-stu-id="36c9d-150">Return **TRUE** if this message is handled; otherwise, **FALSE**.</span></span> <span data-ttu-id="36c9d-151">Questo messaggio è valido per la [versione 5,00](versions.md) e successive di Shell32.dll.</span><span class="sxs-lookup"><span data-stu-id="36c9d-151">This message is valid for [version 5.00](versions.md) and later of Shell32.dll.</span></span>                                                                                         |
| [<span data-ttu-id="36c9d-152">**\_arresto cpl**</span><span class="sxs-lookup"><span data-stu-id="36c9d-152">**CPL\_STOP**</span></span>](cpl-stop.md)               | <span data-ttu-id="36c9d-153">Inviato una volta per ogni elemento del pannello di controllo nel file. cpl prima che Windows Scarica l'estensione del pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="36c9d-153">Sent once for each Control Panel item in the .cpl file before Windows unloads the Control Panel extension.</span></span> <span data-ttu-id="36c9d-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) deve liberare la memoria associata al numero di elemento fornito in *lParam1*.</span><span class="sxs-lookup"><span data-stu-id="36c9d-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any memory associated with the item number provided in *lParam1*.</span></span> <span data-ttu-id="36c9d-155">Il parametro *lParam2* è **lpData** puntatore restituito nella struttura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) o [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) nel messaggio [**cpl \_ Inquirer**](cpl-inquire.md) o [**cpl \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="36c9d-155">The *lParam2* parameter is **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="36c9d-156">Il valore restituito viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="36c9d-156">The return value is ignored.</span></span>                                                                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="36c9d-157">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="36c9d-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="36c9d-158">Elementi del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-158">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="36c9d-159">Linee guida sull'esperienza utente</span><span class="sxs-lookup"><span data-stu-id="36c9d-159">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="36c9d-160">Registrazione degli elementi del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-160">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="36c9d-161">Elaborazione del messaggio del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-161">Control Panel Message Processing</span></span>](message-processing.md)
</dt> <dt>

[<span data-ttu-id="36c9d-162">Esecuzione degli elementi del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-162">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="36c9d-163">Estensione degli elementi del pannello di controllo di sistema</span><span class="sxs-lookup"><span data-stu-id="36c9d-163">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="36c9d-164">Assegnazione delle categorie del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-164">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="36c9d-165">Creazione di collegamenti alle attività ricercabili per un elemento del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="36c9d-165">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="36c9d-166">Accesso al pannello di controllo in modalità provvisoria in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="36c9d-166">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
