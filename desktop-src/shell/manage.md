---
description: La Shell offre diversi modi per gestire i file System.
ms.assetid: d9ffda6f-adc0-44a3-b410-e23bf5f4f165
title: Gestione del file System
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 404b456ce1f26c128e6c3fc3bc9971672378a0d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104342431"
---
# <a name="managing-the-file-system"></a><span data-ttu-id="cd747-103">Gestione del file System</span><span class="sxs-lookup"><span data-stu-id="cd747-103">Managing the File System</span></span>

<span data-ttu-id="cd747-104">La Shell offre diversi modi per gestire i file System.</span><span class="sxs-lookup"><span data-stu-id="cd747-104">The Shell provides a number of ways to manage file systems.</span></span> <span data-ttu-id="cd747-105">La shell fornisce una funzione, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), che consente a un'applicazione di spostare, copiare, rinominare ed eliminare i file a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="cd747-105">The Shell provides a function, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), that allows an application to programmatically move, copy, rename, and delete files.</span></span> <span data-ttu-id="cd747-106">La Shell supporta inoltre alcune funzionalità di gestione dei file aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="cd747-106">The Shell also supports some additional file management capabilities.</span></span>

-   <span data-ttu-id="cd747-107">I documenti HTML possono essere *connessi* a file correlati, ad esempio file di grafica o fogli di stile.</span><span class="sxs-lookup"><span data-stu-id="cd747-107">HTML documents can be *connected* to related files, such as graphics files or style sheets.</span></span> <span data-ttu-id="cd747-108">Quando il documento viene spostato o copiato, anche i file connessi vengono spostati o copiati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="cd747-108">When the document is moved or copied, the connected files are automatically moved or copied as well.</span></span>
-   <span data-ttu-id="cd747-109">Per i sistemi disponibili per più di un utente, i file possono essere gestiti in base ai singoli utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-109">For systems that are available to more than one user, files can be managed on a per-user basis.</span></span> <span data-ttu-id="cd747-110">Gli utenti possono accedere facilmente ai file di dati, ma non ai file appartenenti ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-110">Users have easy access to their data files, but not to files belonging to other users.</span></span>
-   <span data-ttu-id="cd747-111">Se i file di documento vengono aggiunti o modificati, è possibile aggiungerli all'elenco dei documenti recenti della shell.</span><span class="sxs-lookup"><span data-stu-id="cd747-111">If document files are added or modified, they can be added to the Shell's list of recent documents.</span></span> <span data-ttu-id="cd747-112">Quando l'utente fa clic sul comando **documenti** nel menu Start, viene visualizzato un elenco di collegamenti ai documenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-112">When the user clicks the **Documents** command on the Start menu, a list of links to the documents appears.</span></span>

<span data-ttu-id="cd747-113">In questo documento viene illustrato il funzionamento di queste tecnologie di gestione file.</span><span class="sxs-lookup"><span data-stu-id="cd747-113">This document discusses how these file management technologies work.</span></span> <span data-ttu-id="cd747-114">Viene quindi descritto come utilizzare la Shell per spostare, copiare, rinominare ed eliminare i file e come gestire gli oggetti nel Cestino.</span><span class="sxs-lookup"><span data-stu-id="cd747-114">It then outlines how to use the Shell to move, copy, rename, and delete files, and how to manage objects in the Recycle Bin.</span></span>

-   [<span data-ttu-id="cd747-115">Gestione file per utente</span><span class="sxs-lookup"><span data-stu-id="cd747-115">Per-User File Management</span></span>](#per-user-file-management)
-   [<span data-ttu-id="cd747-116">Cartelle documenti e immagini personali</span><span class="sxs-lookup"><span data-stu-id="cd747-116">My Documents and My Pictures Folders</span></span>](#my-documents-and-my-pictures-folders)
-   [<span data-ttu-id="cd747-117">File connessi</span><span class="sxs-lookup"><span data-stu-id="cd747-117">Connected Files</span></span>](#connected-files)
-   [<span data-ttu-id="cd747-118">Trasferimento, copia, ridenominazione ed eliminazione di file</span><span class="sxs-lookup"><span data-stu-id="cd747-118">Moving, Copying, Renaming, and Deleting Files</span></span>](#moving-copying-renaming-and-deleting-files)
    -   [<span data-ttu-id="cd747-119">Notifica della shell</span><span class="sxs-lookup"><span data-stu-id="cd747-119">Notifying the Shell</span></span>](#notifying-the-shell)
-   [<span data-ttu-id="cd747-120">Esempio semplice di gestione dei file con SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="cd747-120">Simple Example of Managing Files with SHFileOperation</span></span>](#simple-example-of-managing-files-with-shfileoperation)
-   [<span data-ttu-id="cd747-121">Aggiunta di file all'elenco di documenti recenti della shell</span><span class="sxs-lookup"><span data-stu-id="cd747-121">Adding Files to the Shell's List of Recent Documents</span></span>](#adding-files-to-the-shells-list-of-recent-documents)

## <a name="per-user-file-management"></a><span data-ttu-id="cd747-122">Gestione dei file Per-User</span><span class="sxs-lookup"><span data-stu-id="cd747-122">Per-User File Management</span></span>

<span data-ttu-id="cd747-123">La shell di Windows 2000 consente di associare i file a un utente specifico, in modo che i file rimangano nascosti ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-123">The Windows 2000 Shell allows files to be associated with a particular user so the files remain hidden from other users.</span></span> <span data-ttu-id="cd747-124">In termini di file system, i file vengono archiviati nella cartella del profilo dell'utente, in genere C: \\ Documents and Settings \\ *username* \\ nei sistemi Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="cd747-124">In terms of the file system, the files are stored under the user's profile folder, typically C:\\Documents and Settings\\*Username*\\ on Windows 2000 systems.</span></span> <span data-ttu-id="cd747-125">Questa funzionalità consente a molti utenti di utilizzare lo stesso computer, mantenendo al tempo stesso la privacy dei file di altri utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-125">This feature allows many individuals to use the same computer, while maintaining the privacy of their files from other users.</span></span> <span data-ttu-id="cd747-126">Diversi utenti possono avere programmi diversi.</span><span class="sxs-lookup"><span data-stu-id="cd747-126">Different users can have different programs available.</span></span> <span data-ttu-id="cd747-127">Fornisce inoltre agli amministratori e alle applicazioni un modo semplice per archiviare elementi quali l'inizializzazione (INI) o i file di collegamento (lnk).</span><span class="sxs-lookup"><span data-stu-id="cd747-127">It also provides a straightforward way for administrators and applications to store such things as initialization (.ini) or link (.lnk) files.</span></span> <span data-ttu-id="cd747-128">Le applicazioni possono quindi mantenere uno stato diverso per ogni utente e recuperare facilmente lo stato specifico quando necessario.</span><span class="sxs-lookup"><span data-stu-id="cd747-128">Applications can thus preserve a different state for each user and easily recover that particular state when needed.</span></span> <span data-ttu-id="cd747-129">È disponibile anche una cartella del profilo per archiviare le informazioni comuni a tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-129">There is also a profile folder for storing information that is common to all users.</span></span>

<span data-ttu-id="cd747-130">Poiché non è pratico determinare quale utente è connesso e dove si trovano i file, le cartelle standard per utente sono cartelle speciali e sono identificate da un [**CSIDL**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="cd747-130">Because it is inconvenient to determine which user is logged in and where their files are located, the standard per-user folders are special folders and are identified by a [**CSIDL**](csidl.md).</span></span> <span data-ttu-id="cd747-131">Ad esempio, il CSIDL per la cartella dei file di programma per utente è CSIDL \_ Programs.</span><span class="sxs-lookup"><span data-stu-id="cd747-131">For instance, the CSIDL for the per-user Program Files folder is CSIDL\_PROGRAMS.</span></span> <span data-ttu-id="cd747-132">Se l'applicazione chiama [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) o [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) con uno dei CSIDL per utente, la funzione restituisce il puntatore a un elenco di identificatori di elemento (PIDL) o a un percorso appropriato per l'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="cd747-132">If your application calls [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with one of the per-user CSIDLs, the function returns the pointer to an item identifier list (PIDL) or path appropriate to the currently logged-in user.</span></span> <span data-ttu-id="cd747-133">Se l'applicazione deve recuperare il percorso o PIDL della cartella del profilo, il relativo CSIDL è **CSIDL \_ profilo**.</span><span class="sxs-lookup"><span data-stu-id="cd747-133">If your application needs to retrieve the path or PIDL of the profile folder, its CSIDL is **CSIDL\_PROFILE**.</span></span>

## <a name="my-documents-and-my-pictures-folders"></a><span data-ttu-id="cd747-134">Cartelle documenti e immagini personali</span><span class="sxs-lookup"><span data-stu-id="cd747-134">My Documents and My Pictures Folders</span></span>

<span data-ttu-id="cd747-135">Una delle icone standard trovate sul desktop è la **mia documentazione**.</span><span class="sxs-lookup"><span data-stu-id="cd747-135">One of the standard icons found on the desktop is **My Documents**.</span></span> <span data-ttu-id="cd747-136">Quando si apre questa cartella, contiene i file di documento dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="cd747-136">When you open this folder, it contains the current user's document files.</span></span> <span data-ttu-id="cd747-137">L'istanza desktop dei documenti è una cartella virtuale, ovvero un alias per il file system percorso usato per archiviare fisicamente i documenti dell'utente, situato immediatamente sotto il desktop nella gerarchia dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="cd747-137">The desktop instance of My Documents is a virtual folder—an alias to the file system location used to physically store the user's documents—located immediately below the desktop in the namespace hierarchy.</span></span>

<span data-ttu-id="cd747-138">Lo scopo delle cartelle documenti e immagini è quello di fornire agli utenti un modo semplice e sicuro per accedere ai file di documenti e immagini in un sistema che potrebbe avere più utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-138">The purpose of the My Documents and My Pictures folders is to provide a straightforward and secure way for users to access their document and picture files on a system that might have multiple users.</span></span> <span data-ttu-id="cd747-139">A ogni utente vengono assegnate cartelle di file system separate per i propri file.</span><span class="sxs-lookup"><span data-stu-id="cd747-139">Each user is assigned separate file system folders for his or her files.</span></span> <span data-ttu-id="cd747-140">Ad esempio, la posizione della cartella documenti di un utente nel file system è in genere simile a C: \\ Documents and Settings \\ *username* \\ My Documents.</span><span class="sxs-lookup"><span data-stu-id="cd747-140">For example, the location of a user's documents folder in the file system is typically something like C:\\Documents and Settings\\*username*\\My Documents.</span></span> <span data-ttu-id="cd747-141">Non è necessario che gli utenti conoscano la posizione fisica delle cartelle file system.</span><span class="sxs-lookup"><span data-stu-id="cd747-141">There is no need for users to know anything about the physical location of their file system folders.</span></span> <span data-ttu-id="cd747-142">Si limitano ad accedere ai file tramite l'icona documenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-142">They simply access their files through the My Documents icon.</span></span>

> [!Note]  
> <span data-ttu-id="cd747-143">Documenti consente a un utente di accedere ai propri file ma non a quelli di altri utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-143">My Documents allows a user to access his or her own files but not those of any other user.</span></span> <span data-ttu-id="cd747-144">Se più persone utilizzano lo stesso computer, un amministratore può bloccare gli utenti partendo dall'file system in cui sono archiviati i file effettivi.</span><span class="sxs-lookup"><span data-stu-id="cd747-144">If multiple individuals use the same computer, an administrator can lock users out of the part of the file system where the actual files are stored.</span></span> <span data-ttu-id="cd747-145">Gli utenti potranno quindi lavorare nei propri documenti tramite la cartella documenti, ma non nei documenti che appartengono ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-145">Users will thus be able to work on their own documents through the My Documents folder but not on documents that belong to any other users.</span></span>

 

<span data-ttu-id="cd747-146">Non è in genere necessario che un'applicazione conosca quale utente è connesso o dove si trova nella file system cartella documenti dell'utente.</span><span class="sxs-lookup"><span data-stu-id="cd747-146">There is usually no need for an application to know which user is logged in or where in the file system that user's My Documents folder is located.</span></span> <span data-ttu-id="cd747-147">Al contrario, l'applicazione può recuperare il PIDL dell'icona del desktop My Documents chiamando il metodo [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) del desktop.</span><span class="sxs-lookup"><span data-stu-id="cd747-147">Instead, your application can retrieve the PIDL of the My Documents desktop icon by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method.</span></span> <span data-ttu-id="cd747-148">Il nome di analisi usato per identificare la cartella documenti non è un percorso di file, bensì:: {450D8FBA-AD25-11D0-98A8-0800361B1103}.</span><span class="sxs-lookup"><span data-stu-id="cd747-148">The parsing name used to identify the My Documents folder is not a file path but rather ::{450d8fba-ad25-11d0-98a8-0800361b1103}.</span></span> <span data-ttu-id="cd747-149">L'espressione tra parentesi è il formato di testo del GUID documenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-149">The bracketed expression is the text form of the My Documents GUID.</span></span> <span data-ttu-id="cd747-150">Ad esempio, per recuperare il PIDL dei documenti, l'applicazione deve usare questa chiamata a **IShellFolder::P arsedisplayname**.</span><span class="sxs-lookup"><span data-stu-id="cd747-150">For example, to retrieve the PIDL of My Documents, your application should use this call to **IShellFolder::ParseDisplayName**.</span></span>


```C++
hr = psfDeskTop->ParseDisplayName(NULL, 
                                  NULL, 
                                  L"::{450d8fba-ad25-11d0-98a8-0800361b1103}", 
                                  &chEaten, 
                                  &pidlDocFiles, 
                                  NULL);
```



<span data-ttu-id="cd747-151">Una volta che l'applicazione dispone del PIDL documenti, può gestire la cartella in modo analogo a una normale cartella file system, enumerando gli elementi, analizzando, associando ed eseguendo qualsiasi altra operazione di cartella valida.</span><span class="sxs-lookup"><span data-stu-id="cd747-151">Once your application has the My Documents PIDL, it can handle the folder just as it would a normal file system folder—enumerating items, parsing, binding, and performing any other valid folder operations.</span></span> <span data-ttu-id="cd747-152">La shell esegue automaticamente il mapping delle modifiche nei documenti o nelle relative sottocartelle alle cartelle file system appropriate.</span><span class="sxs-lookup"><span data-stu-id="cd747-152">The Shell automatically maps changes in My Documents or its subfolders to the appropriate file system folders.</span></span>

<span data-ttu-id="cd747-153">Se l'applicazione deve accedere alla cartella file system effettiva che contiene i documenti dell'utente corrente, passare CSIDL \_ Personal a [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span><span class="sxs-lookup"><span data-stu-id="cd747-153">If your application needs access to the actual file system folder that contains the current user's documents, pass CSIDL\_PERSONAL to [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span></span> <span data-ttu-id="cd747-154">La funzione restituisce il PIDL della cartella file system visualizzata nella cartella documenti dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="cd747-154">The function returns the PIDL of the file system folder that is displayed in the current user's My Documents folder.</span></span>

## <a name="connected-files"></a><span data-ttu-id="cd747-155">File connessi</span><span class="sxs-lookup"><span data-stu-id="cd747-155">Connected Files</span></span>

<span data-ttu-id="cd747-156">I documenti HTML hanno spesso un certo numero di file di grafica associati, un file di foglio di stile, diversi file di Microsoft JScript (compatibili con ECMA 262 Language Specification) e così via.</span><span class="sxs-lookup"><span data-stu-id="cd747-156">HTML documents often have a number of associated graphics files, a style sheet file, several Microsoft JScript (compatible with ECMA 262 language specification ) files, and so on.</span></span> <span data-ttu-id="cd747-157">Quando si sposta o si copia il documento HTML primario, in genere si desidera spostare o copiare i file associati per evitare la suddivisione dei collegamenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-157">When you move or copy the primary HTML document, you also usually want to move or copy its associated files to avoid breaking links.</span></span> <span data-ttu-id="cd747-158">Sfortunatamente, finora non è stato possibile determinare quali file sono correlati a un documento HTML specifico, ad eccezione del fatto che analizzarne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="cd747-158">Unfortunately, there has been no easy way until now to determine which files are related to any given HTML document other than by analyzing their contents.</span></span> <span data-ttu-id="cd747-159">Per ovviare a questo problema, Windows 2000 fornisce un modo semplice per *connettere* un documento HTML primario al relativo gruppo di file associati.</span><span class="sxs-lookup"><span data-stu-id="cd747-159">To alleviate this problem, Windows 2000 provides a simple way to *connect* a primary HTML document to its group of associated files.</span></span> <span data-ttu-id="cd747-160">Se la connessione file è abilitata, quando il documento viene spostato o copiato tutti i relativi file connessi vengono associati.</span><span class="sxs-lookup"><span data-stu-id="cd747-160">If file connection is enabled, when the document is moved or copied all its connected files go with it.</span></span>

<span data-ttu-id="cd747-161">Per creare un gruppo di file connessi, il documento primario deve avere un'estensione di file con estensione htm o HTML.</span><span class="sxs-lookup"><span data-stu-id="cd747-161">To create a group of connected files, the primary document must have an .htm or .html file name extension.</span></span> <span data-ttu-id="cd747-162">Creare una sottocartella della cartella padre del documento primario.</span><span class="sxs-lookup"><span data-stu-id="cd747-162">Create a subfolder of the primary document's parent folder.</span></span> <span data-ttu-id="cd747-163">Il nome della sottocartella deve corrispondere al nome del documento primario, meno l'estensione. htm o. html, seguito da una delle estensioni elencate di seguito.</span><span class="sxs-lookup"><span data-stu-id="cd747-163">The subfolder's name must be the name of the primary document, minus the .htm or .html extension, followed by one of the extensions listed below.</span></span> <span data-ttu-id="cd747-164">Le estensioni usate più di frequente sono ". Files" o " \_ files".</span><span class="sxs-lookup"><span data-stu-id="cd747-164">The most commonly used extensions are ".files" or "\_files".</span></span> <span data-ttu-id="cd747-165">Ad esempio, se il documento primario è denominato MyDoc.htm, la denominazione della sottocartella "MyDoc \_ files" definisce la sottocartella come contenitore per i file connessi del documento.</span><span class="sxs-lookup"><span data-stu-id="cd747-165">For instance, if the primary document is named MyDoc.htm, naming the subfolder "MyDoc\_files" defines the subfolder as the container for the document's connected files.</span></span> <span data-ttu-id="cd747-166">Se il documento primario viene spostato o copiato, anche la sottocartella e i relativi file vengono spostati o copiati.</span><span class="sxs-lookup"><span data-stu-id="cd747-166">If the primary document is moved or copied, the subfolder and its files are moved or copied as well.</span></span>

<span data-ttu-id="cd747-167">Per alcune lingue, è possibile usare un equivalente localizzato di " \_ files" per creare una sottocartella per i file connessi.</span><span class="sxs-lookup"><span data-stu-id="cd747-167">For some languages, it is possible to use a localized equivalent of "\_files" to create a subfolder for connected files.</span></span> <span data-ttu-id="cd747-168">Nella tabella seguente sono elencate le stringhe valide che è possibile aggiungere al nome di un documento per creare una sottocartella di file connessi.</span><span class="sxs-lookup"><span data-stu-id="cd747-168">The following table lists the valid strings that can be appended to a document name to create a connected files subfolder.</span></span> <span data-ttu-id="cd747-169">Si noti che alcune di queste stringhe hanno '-' come primo carattere anziché come ' \_ ' o ' .'.</span><span class="sxs-lookup"><span data-stu-id="cd747-169">Note that some of these strings have '-' as their first character rather than '\_' or '.'.</span></span>



|              |               |                 |               |
|--------------|---------------|-----------------|---------------|
| <span data-ttu-id="cd747-170">" \_ archiviazioni"</span><span class="sxs-lookup"><span data-stu-id="cd747-170">"\_archivos"</span></span> | <span data-ttu-id="cd747-171">" \_ arquivos"</span><span class="sxs-lookup"><span data-stu-id="cd747-171">"\_arquivos"</span></span>  | <span data-ttu-id="cd747-172">"si basa su" \_</span><span class="sxs-lookup"><span data-stu-id="cd747-172">"\_bestanden"</span></span>   | <span data-ttu-id="cd747-173">" \_ bylos"</span><span class="sxs-lookup"><span data-stu-id="cd747-173">"\_bylos"</span></span>     |
| <span data-ttu-id="cd747-174">"-Dateien"</span><span class="sxs-lookup"><span data-stu-id="cd747-174">"-Dateien"</span></span>   | <span data-ttu-id="cd747-175">" \_ datoteke"</span><span class="sxs-lookup"><span data-stu-id="cd747-175">"\_datoteke"</span></span>  | <span data-ttu-id="cd747-176">" \_ dosyalar"</span><span class="sxs-lookup"><span data-stu-id="cd747-176">"\_dosyalar"</span></span>    | <span data-ttu-id="cd747-177">" \_ elemei"</span><span class="sxs-lookup"><span data-stu-id="cd747-177">"\_elemei"</span></span>    |
| <span data-ttu-id="cd747-178">" \_ failid"</span><span class="sxs-lookup"><span data-stu-id="cd747-178">"\_failid"</span></span>   | <span data-ttu-id="cd747-179">" \_ non riuscito"</span><span class="sxs-lookup"><span data-stu-id="cd747-179">"\_fails"</span></span>     | <span data-ttu-id="cd747-180">" \_ fajlovi"</span><span class="sxs-lookup"><span data-stu-id="cd747-180">"\_fajlovi"</span></span>     | <span data-ttu-id="cd747-181">" \_ ficheiros"</span><span class="sxs-lookup"><span data-stu-id="cd747-181">"\_ficheiros"</span></span> |
| <span data-ttu-id="cd747-182">" \_ fichiers"</span><span class="sxs-lookup"><span data-stu-id="cd747-182">"\_fichiers"</span></span> | <span data-ttu-id="cd747-183">"-filer"</span><span class="sxs-lookup"><span data-stu-id="cd747-183">"-filer"</span></span>      | <span data-ttu-id="cd747-184">". Files"</span><span class="sxs-lookup"><span data-stu-id="cd747-184">".files"</span></span>        | <span data-ttu-id="cd747-185">" \_ file"</span><span class="sxs-lookup"><span data-stu-id="cd747-185">"\_files"</span></span>     |
| <span data-ttu-id="cd747-186">" \_ file"</span><span class="sxs-lookup"><span data-stu-id="cd747-186">"\_file"</span></span>     | <span data-ttu-id="cd747-187">" \_ fitxers"</span><span class="sxs-lookup"><span data-stu-id="cd747-187">"\_fitxers"</span></span>   | <span data-ttu-id="cd747-188">" \_ fitxategiak"</span><span class="sxs-lookup"><span data-stu-id="cd747-188">"\_fitxategiak"</span></span> | <span data-ttu-id="cd747-189">" \_ pliki"</span><span class="sxs-lookup"><span data-stu-id="cd747-189">"\_pliki"</span></span>     |
| <span data-ttu-id="cd747-190">" \_ Soubory"</span><span class="sxs-lookup"><span data-stu-id="cd747-190">"\_soubory"</span></span>  | <span data-ttu-id="cd747-191">" \_ tiedostot"</span><span class="sxs-lookup"><span data-stu-id="cd747-191">"\_tiedostot"</span></span> |                 |               |



 

> [!Note]  
> <span data-ttu-id="cd747-192">Questa funzionalità è sensibile al caso dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="cd747-192">This feature is sensitive to the case of the extension.</span></span> <span data-ttu-id="cd747-193">Ad esempio, per l'esempio precedente, una sottocartella denominata "MyDoc \_ files" non verrà connessa a MyDoc.htm.</span><span class="sxs-lookup"><span data-stu-id="cd747-193">For instance, for the example given above, a subfolder named "MyDoc\_Files" will not be connected to MyDoc.htm.</span></span>

 

<span data-ttu-id="cd747-194">Se la connessione file è abilitata o disabilitata è controllata da un valore **reg \_ DWORD** , NoFileFolderConnection, della chiave del registro di sistema seguente.</span><span class="sxs-lookup"><span data-stu-id="cd747-194">Whether file connection is enabled or disabled is controlled by a **REG\_DWORD** value, NoFileFolderConnection, of the following registry key.</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
```

<span data-ttu-id="cd747-195">Questo valore non è normalmente definito e la connessione file è abilitata.</span><span class="sxs-lookup"><span data-stu-id="cd747-195">This value normally is not defined, and file connection is enabled.</span></span> <span data-ttu-id="cd747-196">Se necessario, è possibile disabilitare la connessione file aggiungendo questo valore alla chiave e impostandolo su 1.</span><span class="sxs-lookup"><span data-stu-id="cd747-196">If necessary, you can disable file connection by adding this value to the key and setting it to 1.</span></span> <span data-ttu-id="cd747-197">Per abilitare di nuovo la connessione file, impostare NoFileFolderConnection su zero.</span><span class="sxs-lookup"><span data-stu-id="cd747-197">To enable file connection again, set NoFileFolderConnection to zero.</span></span>

> [!Note]  
> <span data-ttu-id="cd747-198">La connessione file deve in genere essere abilitata perché altre applicazioni potrebbero dipendere da tale connessione.</span><span class="sxs-lookup"><span data-stu-id="cd747-198">File connection should normally be enabled because other applications might depend on it.</span></span> <span data-ttu-id="cd747-199">Disabilitare la connessione file solo se assolutamente necessario.</span><span class="sxs-lookup"><span data-stu-id="cd747-199">Disable file connection only if absolutely necessary.</span></span>

 

## <a name="moving-copying-renaming-and-deleting-files"></a><span data-ttu-id="cd747-200">Trasferimento, copia, ridenominazione ed eliminazione di file</span><span class="sxs-lookup"><span data-stu-id="cd747-200">Moving, Copying, Renaming, and Deleting Files</span></span>

<span data-ttu-id="cd747-201">Lo spazio dei nomi non è statico e le applicazioni in genere devono gestire il file system eseguendo una delle operazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-201">The namespace is not static, and applications commonly need to manage the file system by performing one of the following operations.</span></span>

-   <span data-ttu-id="cd747-202">Copia di un oggetto in un'altra cartella.</span><span class="sxs-lookup"><span data-stu-id="cd747-202">Copying an object to another folder.</span></span>
-   <span data-ttu-id="cd747-203">Lo stato di un oggetto viene spostato in un'altra cartella.</span><span class="sxs-lookup"><span data-stu-id="cd747-203">Moving an object to another folder.</span></span>
-   <span data-ttu-id="cd747-204">Eliminazione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="cd747-204">Deleting an object.</span></span>
-   <span data-ttu-id="cd747-205">Ridenominazione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="cd747-205">Renaming an object.</span></span>

<span data-ttu-id="cd747-206">Tutte queste operazioni vengono eseguite con [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="cd747-206">These operations are all performed with [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="cd747-207">Questa funzione accetta uno o più file di origine e produce file di destinazione corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="cd747-207">This function takes one or more source files and produces corresponding destination files.</span></span> <span data-ttu-id="cd747-208">Nel caso dell'operazione di eliminazione, il sistema tenta di inserire i file eliminati nel Cestino.</span><span class="sxs-lookup"><span data-stu-id="cd747-208">In the case of the delete operation, the system attempts to put the deleted files into the Recycle Bin.</span></span>

<span data-ttu-id="cd747-209">È anche possibile spostare i file usando la funzionalità di [trascinamento della selezione](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="cd747-209">It is also possible to move files using the [drag-and-drop](dragdrop.md) functionality.</span></span>

<span data-ttu-id="cd747-210">Per usare la funzione, è necessario compilare i membri di una struttura [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) e passarla a [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span><span class="sxs-lookup"><span data-stu-id="cd747-210">To use the function, you must fill in the members of an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure and pass it to [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="cd747-211">I membri chiave della struttura sono **pFrom** e **PTO**.</span><span class="sxs-lookup"><span data-stu-id="cd747-211">The key members of the structure are **pFrom** and **pTo**.</span></span>

<span data-ttu-id="cd747-212">Il membro **pFrom** è una stringa con terminazione **null** doppia che contiene uno o più nomi di file di origine.</span><span class="sxs-lookup"><span data-stu-id="cd747-212">The **pFrom** member is a double **null**-terminated string that contains one or more source file names.</span></span> <span data-ttu-id="cd747-213">Questi nomi possono essere percorsi completi o caratteri jolly standard di DOS, ad esempio \* . \*</span><span class="sxs-lookup"><span data-stu-id="cd747-213">These names can be either fully qualified paths or standard DOS wildcards such as \*.\*.</span></span> <span data-ttu-id="cd747-214">Sebbene questo membro sia dichiarato come stringa con terminazione **null**, viene usato come buffer per memorizzare più nomi di file.</span><span class="sxs-lookup"><span data-stu-id="cd747-214">Although this member is declared as a **null**-terminated string, it is used as a buffer to hold multiple file names.</span></span> <span data-ttu-id="cd747-215">Ogni nome file deve terminare con il consueto carattere **null** singolo.</span><span class="sxs-lookup"><span data-stu-id="cd747-215">Each file name must be terminated by the usual single **NULL** character.</span></span> <span data-ttu-id="cd747-216">È necessario aggiungere un carattere **null** aggiuntivo alla fine del nome finale per indicare la fine di **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="cd747-216">An additional **NULL** character must be appended to the end of the final name to indicate the end of **pFrom**.</span></span>

<span data-ttu-id="cd747-217">Il membro **PTO** è una stringa con terminazione **null** doppia, molto simile a **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="cd747-217">The **pTo** member is a double **null**-terminated string, much like **pFrom**.</span></span> <span data-ttu-id="cd747-218">Il membro **PTO** contiene i nomi di uno o più nomi di destinazione completi.</span><span class="sxs-lookup"><span data-stu-id="cd747-218">The **pTo** member contains the names of one or more fully qualified destination names.</span></span> <span data-ttu-id="cd747-219">Vengono compressi in **PTO** nello stesso modo in cui sono disponibili per **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="cd747-219">They are packed into **pTo** in the same way as they are for **pFrom**.</span></span> <span data-ttu-id="cd747-220">Se **PTO** contiene più nomi, è necessario impostare anche il flag **FOF \_ MULTIDESTFILES** nel membro **fFlags** .</span><span class="sxs-lookup"><span data-stu-id="cd747-220">If **pTo** contains multiple names, you must also set the **FOF\_MULTIDESTFILES** flag in the **fFlags** member.</span></span> <span data-ttu-id="cd747-221">L'utilizzo di **PTO** dipende dall'operazione descritta qui.</span><span class="sxs-lookup"><span data-stu-id="cd747-221">The usage of **pTo** depends on the operation as described here.</span></span>

-   <span data-ttu-id="cd747-222">Per le operazioni di copia e spostamento, se tutti i file passano a una singola directory, **PTO** contiene il nome completo della directory.</span><span class="sxs-lookup"><span data-stu-id="cd747-222">For copy and move operations, if all the files are going to a single directory, **pTo** contains the fully qualified directory name.</span></span> <span data-ttu-id="cd747-223">Se i file passano a destinazioni diverse, **PTO** può anche contenere una directory o un nome di file completo per ogni file di origine.</span><span class="sxs-lookup"><span data-stu-id="cd747-223">If the files are going to different destinations, **pTo** can also contain one fully qualified directory or file name for each source file.</span></span> <span data-ttu-id="cd747-224">Se una directory non esiste, verrà creata dal sistema.</span><span class="sxs-lookup"><span data-stu-id="cd747-224">If a directory does not exist, the system creates it.</span></span>
-   <span data-ttu-id="cd747-225">Per le operazioni di ridenominazione, **PTO** contiene un percorso completo per ogni file di origine in **pFrom**.</span><span class="sxs-lookup"><span data-stu-id="cd747-225">For rename operations, **pTo** contains one fully qualified path for each source file in **pFrom**.</span></span>
-   <span data-ttu-id="cd747-226">Per le operazioni di eliminazione, non viene usato **PTO** .</span><span class="sxs-lookup"><span data-stu-id="cd747-226">For delete operations, **pTo** is not used.</span></span>

### <a name="notifying-the-shell"></a><span data-ttu-id="cd747-227">Notifica della shell</span><span class="sxs-lookup"><span data-stu-id="cd747-227">Notifying the Shell</span></span>

<span data-ttu-id="cd747-228">Inviare una notifica alla shell della modifica dopo aver usato [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) per spostare, copiare, rinominare o eliminare file oppure dopo aver eseguito altre azioni che influiscono sullo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="cd747-228">Notify the Shell of the change after using [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to move, copy, rename, or delete files, or after taking any other action that affects the namespace.</span></span> <span data-ttu-id="cd747-229">Le azioni che devono essere accompagnate dalla notifica includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="cd747-229">Actions that should be accompanied by notification include the following:</span></span>

-   <span data-ttu-id="cd747-230">Aggiunta o eliminazione di file o cartelle.</span><span class="sxs-lookup"><span data-stu-id="cd747-230">Adding or deleting files or folders.</span></span>
-   <span data-ttu-id="cd747-231">Trasferimento, copia o ridenominazione di file o cartelle.</span><span class="sxs-lookup"><span data-stu-id="cd747-231">Moving, copying, or renaming files or folders.</span></span>
-   <span data-ttu-id="cd747-232">Modifica di un'associazione di file.</span><span class="sxs-lookup"><span data-stu-id="cd747-232">Changing a file association.</span></span>
-   <span data-ttu-id="cd747-233">Modifica degli attributi del file.</span><span class="sxs-lookup"><span data-stu-id="cd747-233">Changing file attributes.</span></span>
-   <span data-ttu-id="cd747-234">Aggiunta o rimozione di unità o supporti di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="cd747-234">Adding or removing drives or storage media.</span></span>
-   <span data-ttu-id="cd747-235">Creazione o disabilitazione di una cartella condivisa.</span><span class="sxs-lookup"><span data-stu-id="cd747-235">Creating or disabling a shared folder.</span></span>
-   <span data-ttu-id="cd747-236">Modifica dell'elenco di immagini di sistema.</span><span class="sxs-lookup"><span data-stu-id="cd747-236">Changing the system image list.</span></span>

<span data-ttu-id="cd747-237">Un'applicazione invia una notifica alla shell chiamando [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) con i dettagli delle modifiche apportate.</span><span class="sxs-lookup"><span data-stu-id="cd747-237">An application notifies the Shell by calling [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) with the details of what has changed.</span></span> <span data-ttu-id="cd747-238">La shell può quindi aggiornare l'immagine dello spazio dei nomi per riflettere accuratamente il nuovo stato.</span><span class="sxs-lookup"><span data-stu-id="cd747-238">The Shell can then update its image of the namespace to accurately reflect its new state.</span></span>

## <a name="simple-example-of-managing-files-with-shfileoperation"></a><span data-ttu-id="cd747-239">Esempio semplice di gestione dei file con SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="cd747-239">Simple Example of Managing Files with SHFileOperation</span></span>

<span data-ttu-id="cd747-240">Nell'applicazione console di esempio seguente viene illustrato l'uso di [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) per copiare i file da una directory a un'altra.</span><span class="sxs-lookup"><span data-stu-id="cd747-240">The following sample console application illustrates the use of [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to copy files from one directory to another.</span></span> <span data-ttu-id="cd747-241">Le directory di origine e di destinazione, C: \\ My \_ docs e c: \\ My \_ Docs2, sono hardcoded nell'applicazione per semplicità.</span><span class="sxs-lookup"><span data-stu-id="cd747-241">The source and destination directories, C:\\My\_Docs and C:\\My\_Docs2, are hard-coded into the application for simplicity.</span></span>


```C++
#include <shlobj.h>
#include <shlwapi.h>
#include <strsafe.h>

int main(void)
{
    IShellFolder *psfDeskTop = NULL;
    IShellFolder *psfDocFiles = NULL;
    LPITEMIDLIST pidlDocFiles = NULL;
    LPITEMIDLIST pidlItems = NULL;
    IEnumIDList *ppenum = NULL;
    SHFILEOPSTRUCT sfo;
    STRRET strDispName;
    TCHAR szParseName[MAX_PATH];
    TCHAR szSourceFiles[256];
    int i;
    int iBufPos = 0;
    ULONG chEaten;
    ULONG celtFetched;
    size_t ParseNameSize = 0;
    HRESULT hr;
    

    szSourceFiles[0] = '\0';
    hr = SHGetDesktopFolder(&psfDeskTop);

    hr = psfDeskTop->ParseDisplayName(NULL, NULL, L"c:\\My_Docs", 
         &chEaten, &pidlDocFiles, NULL);
    hr = psfDeskTop->BindToObject(pidlDocFiles, NULL, IID_IShellFolder, 
         (LPVOID *) &psfDocFiles);
    hr = psfDeskTop->Release();

    hr = psfDocFiles->EnumObjects(NULL,SHCONTF_FOLDERS | SHCONTF_NONFOLDERS, 
         &ppenum);

    while( (hr = ppenum->Next(1,&pidlItems, &celtFetched)) == S_OK 
       && (celtFetched) == 1)
    {
        psfDocFiles->GetDisplayNameOf(pidlItems, SHGDN_FORPARSING, 
            &strDispName);
        StrRetToBuf(&strDispName, pidlItems, szParseName, MAX_PATH);
        
        hr = StringCchLength(szParseName, MAX_PATH, &ParseNameSize);
        
        if (SUCCEEDED(hr))
        {
            for(i=0; i<=ParseNameSize; i++)
            {
                szSourceFiles[iBufPos++] = szParseName[i];
            }
            CoTaskMemFree(pidlItems);
        }
    }
    ppenum->Release();
    
    szSourceFiles[iBufPos] = '\0';

    sfo.hwnd = NULL;
    sfo.wFunc = FO_COPY;
    sfo.pFrom = szSourceFiles;
    sfo.pTo = "c:\\My_Docs2\0";
    sfo.fFlags = FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOCONFIRMMKDIR;

    hr = SHFileOperation(&sfo);
    
    SHChangeNotify(SHCNE_UPDATEDIR, SHCNF_PATH, (LPCVOID) "c:\\My_Docs2", 0);

    CoTaskMemFree(pidlDocFiles);
    psfDocFiles->Release();

    return 0;
}
```



<span data-ttu-id="cd747-242">L'applicazione recupera innanzitutto un puntatore all'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) del desktop.</span><span class="sxs-lookup"><span data-stu-id="cd747-242">The application first retrieves a pointer to the desktop's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="cd747-243">Recupera quindi il PIDL della directory di origine passando il percorso completo a [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span><span class="sxs-lookup"><span data-stu-id="cd747-243">It then retrieves the source directory's PIDL by passing its fully qualified path to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span></span> <span data-ttu-id="cd747-244">Si noti che **IShellFolder::P arsedisplayname** richiede che il percorso della directory sia una stringa Unicode.</span><span class="sxs-lookup"><span data-stu-id="cd747-244">Note that **IShellFolder::ParseDisplayName** requires the directory's path to be a Unicode string.</span></span> <span data-ttu-id="cd747-245">L'applicazione viene quindi associata alla directory di origine e utilizza l'interfaccia **IShellFolder** per recuperare l'interfaccia [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) di un oggetto enumeratore.</span><span class="sxs-lookup"><span data-stu-id="cd747-245">The application then binds to the source directory and uses its **IShellFolder** interface to retrieve an enumerator object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>

<span data-ttu-id="cd747-246">Poiché ogni file nella directory di origine è enumerato, [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) viene usato per recuperare il nome.</span><span class="sxs-lookup"><span data-stu-id="cd747-246">As each file in the source directory is enumerated, [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) is used to retrieve its name.</span></span> <span data-ttu-id="cd747-247">\_Viene impostato il flag SHGDN FORPARSING, che fa sì che **IShellFolder:: GetDisplayNameOf** restituisca il percorso completo del file.</span><span class="sxs-lookup"><span data-stu-id="cd747-247">The SHGDN\_FORPARSING flag is set, which causes **IShellFolder::GetDisplayNameOf** to return the file's fully qualified path.</span></span> <span data-ttu-id="cd747-248">I percorsi dei file, inclusi i caratteri **null** di terminazione, vengono concatenati in una singola matrice, *szSourceFiles*.</span><span class="sxs-lookup"><span data-stu-id="cd747-248">The file paths, including the terminating **NULL** characters, are concatenated into a single array, *szSourceFiles*.</span></span> <span data-ttu-id="cd747-249">Un secondo carattere **null** viene aggiunto al percorso finale per terminare correttamente la matrice.</span><span class="sxs-lookup"><span data-stu-id="cd747-249">A second **NULL** character is appended to the final path to terminate the array properly.</span></span>

<span data-ttu-id="cd747-250">Al termine dell'enumerazione, l'applicazione assegna valori a una struttura [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) .</span><span class="sxs-lookup"><span data-stu-id="cd747-250">Once the enumeration is complete, the application assigns values to an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure.</span></span> <span data-ttu-id="cd747-251">Si noti che la matrice assegnata a **PTO** per specificare la destinazione deve anche essere terminata da un **valore null** doppio.</span><span class="sxs-lookup"><span data-stu-id="cd747-251">Note that the array assigned to **pTo** to specify the destination must also be terminated by a double **NULL**.</span></span> <span data-ttu-id="cd747-252">In questo caso, viene semplicemente incluso nella stringa assegnata a **PTO**.</span><span class="sxs-lookup"><span data-stu-id="cd747-252">In this case, it is simply included in the string that is assigned to **pTo**.</span></span> <span data-ttu-id="cd747-253">Poiché si tratta di un'applicazione console, i \_ flag FOF Silent, FOF \_ noconfirmation e FOF \_ NOCONFIRMMKDIR sono impostati in modo da non visualizzare le finestre di dialogo eventualmente visualizzate.</span><span class="sxs-lookup"><span data-stu-id="cd747-253">Because this is a console application, the FOF\_SILENT, FOF\_NOCONFIRMATION, and FOF\_NOCONFIRMMKDIR flags are set to suppress any dialog boxes that might appear.</span></span> <span data-ttu-id="cd747-254">Dopo la restituzione di [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) , viene chiamato [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) per notificare la shell della modifica.</span><span class="sxs-lookup"><span data-stu-id="cd747-254">After [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) returns, [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) is called to notify the Shell of the change.</span></span> <span data-ttu-id="cd747-255">Quindi, l'applicazione esegue la normale pulizia e restituisce il risultato.</span><span class="sxs-lookup"><span data-stu-id="cd747-255">Then the application performs the usual cleanup and returns.</span></span>

## <a name="adding-files-to-the-shells-list-of-recent-documents"></a><span data-ttu-id="cd747-256">Aggiunta di file all'elenco di documenti recenti della shell</span><span class="sxs-lookup"><span data-stu-id="cd747-256">Adding Files to the Shell's List of Recent Documents</span></span>

<span data-ttu-id="cd747-257">La shell gestisce un elenco di documenti aggiunti o modificati di recente per ogni utente.</span><span class="sxs-lookup"><span data-stu-id="cd747-257">The Shell maintains a list of recently added or modified documents for each user.</span></span> <span data-ttu-id="cd747-258">L'utente può visualizzare un elenco di collegamenti a questi file scegliendo documenti dal menu Start.</span><span class="sxs-lookup"><span data-stu-id="cd747-258">The user can display a list of links to these files by clicking Documents on the Start menu.</span></span> <span data-ttu-id="cd747-259">Come per i documenti, ogni utente dispone di una directory file system per il collegamento dei collegamenti effettivi.</span><span class="sxs-lookup"><span data-stu-id="cd747-259">As with My Documents, each user has a file system directory to hold the actual links.</span></span> <span data-ttu-id="cd747-260">Per recuperare il PIDL della directory recente dell'utente corrente, l'applicazione può chiamare [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) con CSIDL \_ recente oppure chiamare [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) per recuperare il percorso.</span><span class="sxs-lookup"><span data-stu-id="cd747-260">To retrieve the PIDL of the current user's Recent directory, your application can call [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) with CSIDL\_RECENT, or call [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) to retrieve its path.</span></span>

<span data-ttu-id="cd747-261">L'applicazione può enumerare il contenuto della cartella recente usando le tecniche descritte in precedenza in questo documento.</span><span class="sxs-lookup"><span data-stu-id="cd747-261">Your application can enumerate the contents of the Recent folder using the techniques discussed earlier in this document.</span></span> <span data-ttu-id="cd747-262">Tuttavia, un'applicazione non deve modificare il contenuto della cartella come se si trattasse di una normale cartella file system.</span><span class="sxs-lookup"><span data-stu-id="cd747-262">However, an application should not modify the contents of the folder as if it were a normal file system folder.</span></span> <span data-ttu-id="cd747-263">In tal caso, l'elenco dei documenti recenti della shell non verrà aggiornato correttamente e le modifiche non verranno riflesse nel menu Start.</span><span class="sxs-lookup"><span data-stu-id="cd747-263">If it does so, the Shell's list of recent documents will not be updated properly, and the changes will not be reflected in the Start menu.</span></span> <span data-ttu-id="cd747-264">Per aggiungere un collegamento a un documento alla cartella recente di un utente, l'applicazione può invece chiamare [**funzione SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span><span class="sxs-lookup"><span data-stu-id="cd747-264">Instead, to add a document link to a user's Recent folder, your application can call [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="cd747-265">La Shell consente di aggiungere un collegamento alla cartella file system appropriata, nonché di aggiornare l'elenco dei documenti recenti e il menu Start.</span><span class="sxs-lookup"><span data-stu-id="cd747-265">The Shell will add a link to the appropriate file system folder, as well as updating its list of recent documents and the Start menu.</span></span> <span data-ttu-id="cd747-266">È anche possibile usare questa funzione per cancellare la cartella.</span><span class="sxs-lookup"><span data-stu-id="cd747-266">You can also use this function to clear the folder.</span></span>

 

 
