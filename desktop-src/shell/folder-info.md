---
description: La sezione ottenere l'ID di una cartella ha illustrato due approcci per ottenere il puntatore di un oggetto spazio dei nomi a un elenco di identificatori di elemento (PIDL).
ms.assetid: c99a2f6c-3144-41ec-ad97-59a30bfec9ab
title: Ottenere informazioni sul contenuto di una cartella
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7eb26e9df28af4811e74f2878eebb7af9d5c92a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104993685"
---
# <a name="getting-information-about-the-contents-of-a-folder"></a><span data-ttu-id="3354d-103">Ottenere informazioni sul contenuto di una cartella</span><span class="sxs-lookup"><span data-stu-id="3354d-103">Getting Information About the Contents of a Folder</span></span>

<span data-ttu-id="3354d-104">La sezione [ottenere l'ID di una cartella ha](folder-id.md) illustrato due approcci per ottenere il puntatore di un oggetto spazio dei nomi a un elenco di identificatori di elemento (PIDL).</span><span class="sxs-lookup"><span data-stu-id="3354d-104">The [Getting a Folder's ID](folder-id.md) section discussed two approaches to getting a namespace object's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="3354d-105">Una domanda ovvia è: quando si dispone di un PIDL, cosa è possibile fare?</span><span class="sxs-lookup"><span data-stu-id="3354d-105">One obvious question is: Once you have a PIDL, what can you do with it?</span></span> <span data-ttu-id="3354d-106">Una domanda correlata è: cosa accade se nessuno dei due approcci funziona o è adatto per l'applicazione?</span><span class="sxs-lookup"><span data-stu-id="3354d-106">A related question is: What if neither approach works, or is suitable for your application?</span></span> <span data-ttu-id="3354d-107">La risposta a entrambe le domande richiede un esame più approfondito del modo in cui viene implementato lo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="3354d-107">The answer to both questions requires taking a closer look at how the namespace is implemented.</span></span> <span data-ttu-id="3354d-108">La chiave è l'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="3354d-108">The key is the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

-   [<span data-ttu-id="3354d-109">Uso dell'interfaccia IShellFolder</span><span class="sxs-lookup"><span data-stu-id="3354d-109">Using the IShellFolder Interface</span></span>](#using-the-ishellfolder-interface)
-   [<span data-ttu-id="3354d-110">Enumerazione del contenuto di una cartella</span><span class="sxs-lookup"><span data-stu-id="3354d-110">Enumerating the Contents of a Folder</span></span>](#enumerating-the-contents-of-a-folder)
-   [<span data-ttu-id="3354d-111">Determinazione dei nomi visualizzati e delle altre proprietà</span><span class="sxs-lookup"><span data-stu-id="3354d-111">Determining Display Names and Other Properties</span></span>](#determining-display-names-and-other-properties)
-   [<span data-ttu-id="3354d-112">Recupero di un puntatore all'interfaccia IShellFolder di una sottocartella</span><span class="sxs-lookup"><span data-stu-id="3354d-112">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>](#getting-a-pointer-to-a-subfolders-ishellfolder-interface)
-   [<span data-ttu-id="3354d-113">Determinazione della cartella padre di un oggetto</span><span class="sxs-lookup"><span data-stu-id="3354d-113">Determining an Object's Parent Folder</span></span>](#determining-an-objects-parent-folder)

## <a name="using-the-ishellfolder-interface"></a><span data-ttu-id="3354d-114">Uso dell'interfaccia IShellFolder</span><span class="sxs-lookup"><span data-stu-id="3354d-114">Using the IShellFolder Interface</span></span>

<span data-ttu-id="3354d-115">In precedenza in questa documentazione, le cartelle dello spazio dei nomi venivano definite oggetti.</span><span class="sxs-lookup"><span data-stu-id="3354d-115">Earlier in this documentation, namespace folders were referred to as objects.</span></span> <span data-ttu-id="3354d-116">Anche se, a questo punto, il termine è stato usato in modo separato, si tratta effettivamente di un vero e proprio senso.</span><span class="sxs-lookup"><span data-stu-id="3354d-116">Although, at that point, the term was used in a loose sense, it is actually true in a strict sense as well.</span></span> <span data-ttu-id="3354d-117">Ogni cartella dello spazio dei nomi è rappresentata da un oggetto Component Object Model (COM).</span><span class="sxs-lookup"><span data-stu-id="3354d-117">Every namespace folder is represented by a Component Object Model (COM) object.</span></span> <span data-ttu-id="3354d-118">Ogni oggetto Folder espone una serie di interfacce che possono essere utilizzate per un'ampia gamma di attività.</span><span class="sxs-lookup"><span data-stu-id="3354d-118">Each folder object exposes a number of interfaces that can be used for a wide variety of tasks.</span></span> <span data-ttu-id="3354d-119">Alcune interfacce facoltative potrebbero non essere esposte da tutte le cartelle.</span><span class="sxs-lookup"><span data-stu-id="3354d-119">Some interfaces that are optional may not be exposed by all folders.</span></span> <span data-ttu-id="3354d-120">Tuttavia, tutte le cartelle devono esporre l'interfaccia di base, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="3354d-120">However, all folders must expose the fundamental interface, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span>

<span data-ttu-id="3354d-121">Il primo passaggio nell'uso di un oggetto Folder consiste nel recuperare un puntatore alla relativa interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="3354d-121">The first step in using a folder object is to retrieve a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="3354d-122">Oltre a fornire l'accesso alle altre interfacce dell'oggetto, **IShellFolder** espone un gruppo di metodi che gestiscono una serie di attività comuni, alcune delle quali sono descritte in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="3354d-122">In addition to providing access to the object's other interfaces, **IShellFolder** exposes a group of methods that handle a number of common tasks, several of which are discussed in this section.</span></span>

<span data-ttu-id="3354d-123">Per recuperare un puntatore all'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) di un oggetto spazio dei nomi, è prima necessario chiamare [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span><span class="sxs-lookup"><span data-stu-id="3354d-123">To retrieve a pointer to a namespace object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, you must first call [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span></span> <span data-ttu-id="3354d-124">Questa funzione restituisce un puntatore all'interfaccia **IShellFolder** della radice dello spazio dei nomi, il desktop.</span><span class="sxs-lookup"><span data-stu-id="3354d-124">This function returns a pointer to the **IShellFolder** interface of the namespace root, the desktop.</span></span> <span data-ttu-id="3354d-125">Dopo aver creato l'interfaccia **IShellFolder** del desktop, è possibile procedere in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="3354d-125">Once you have the desktop's **IShellFolder** interface, there a variety of ways to proceed.</span></span>

<span data-ttu-id="3354d-126">Se si dispone già del PIDL della cartella a cui si è interessati, ad esempio chiamando [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation), è possibile recuperare la relativa interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) chiamando il metodo [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) del desktop.</span><span class="sxs-lookup"><span data-stu-id="3354d-126">If you already have the PIDL of the folder you are interested in—for instance, by calling [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)—you can retrieve its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface by calling the desktop's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="3354d-127">Se si dispone del percorso di un oggetto file system, è necessario innanzitutto ottenere il relativo PIDL chiamando il metodo [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) del desktop e quindi chiamare **IShellFolder:: BindToObject**.</span><span class="sxs-lookup"><span data-stu-id="3354d-127">If you have the path of a file system object, you must first obtain its PIDL by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method and then call **IShellFolder::BindToObject**.</span></span> <span data-ttu-id="3354d-128">Se nessuno di questi approcci è applicabile, è possibile usare altri metodi **IShellFolder** per spostarsi nello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="3354d-128">If neither of these approaches is applicable, you can use other **IShellFolder** methods to navigate the namespace.</span></span> <span data-ttu-id="3354d-129">Per ulteriori informazioni, vedere [spostamento nello spazio dei nomi](navigate.md).</span><span class="sxs-lookup"><span data-stu-id="3354d-129">For more information, see [Navigating the Namespace](navigate.md).</span></span>

## <a name="enumerating-the-contents-of-a-folder"></a><span data-ttu-id="3354d-130">Enumerazione del contenuto di una cartella</span><span class="sxs-lookup"><span data-stu-id="3354d-130">Enumerating the Contents of a Folder</span></span>

<span data-ttu-id="3354d-131">La prima cosa che si vuole fare con una cartella è individuare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="3354d-131">The first thing you usually want to do with a folder is to find out what it contains.</span></span> <span data-ttu-id="3354d-132">È necessario chiamare prima il metodo [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) della cartella.</span><span class="sxs-lookup"><span data-stu-id="3354d-132">You must first call the folder's [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="3354d-133">La cartella creerà un oggetto enumerazione OLE standard e restituirà l'interfaccia [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) .</span><span class="sxs-lookup"><span data-stu-id="3354d-133">The folder will create a standard OLE enumeration object and return its [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span> <span data-ttu-id="3354d-134">Questa interfaccia espone quattro metodi standard, ovvero [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset)e [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), che possono essere usati per enumerare il contenuto della cartella.</span><span class="sxs-lookup"><span data-stu-id="3354d-134">This interface exposes four standard methods—[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), and [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)—that can be used to enumerate the contents of the folder.</span></span>

<span data-ttu-id="3354d-135">La procedura di base per l'enumerazione del contenuto di una cartella è la seguente:</span><span class="sxs-lookup"><span data-stu-id="3354d-135">The basic procedure for enumerating a folder's contents is:</span></span>

1.  <span data-ttu-id="3354d-136">Chiamare il metodo Folders [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) per recuperare un puntatore all'interfaccia [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) dell'oggetto di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="3354d-136">Call the folders [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method to retrieve a pointer to an enumeration object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>
2.  <span data-ttu-id="3354d-137">Passare un PIDL non allocato a [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="3354d-137">Pass an unallocated PIDL to [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="3354d-138">Si occuperà **quindi** di allocare PIDL, ma l'applicazione deve deallocarla quando non è più necessaria.</span><span class="sxs-lookup"><span data-stu-id="3354d-138">**Next** takes care of allocating the PIDL, but the application must deallocate it when it is no longer needed.</span></span> <span data-ttu-id="3354d-139">Quando restituisce **Next** , il PIDL conterrà solo l'ID elemento dell'oggetto e i caratteri **null** di terminazione.</span><span class="sxs-lookup"><span data-stu-id="3354d-139">When **Next** returns, the PIDL will contain just the object's item ID and the terminating **NULL** characters.</span></span> <span data-ttu-id="3354d-140">In altre parole, si tratta di un PIDL a un solo livello relativo alla cartella, non di un PIDL completo.</span><span class="sxs-lookup"><span data-stu-id="3354d-140">In other words, it is a single-level PIDL, relative to the folder, not a fully qualified PIDL.</span></span>
3.  <span data-ttu-id="3354d-141">Ripetere il passaggio 2 fino a quando [**successivo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) restituisce \_ false per indicare che tutti gli elementi sono stati enumerati.</span><span class="sxs-lookup"><span data-stu-id="3354d-141">Repeat step 2 until [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) returns S\_FALSE to indicate that all items have been enumerated.</span></span>
4.  <span data-ttu-id="3354d-142">Chiamare **IEnumIDList:: Release** per rilasciare l'oggetto di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="3354d-142">Call **IEnumIDList::Release** to release the enumeration object.</span></span>

> [!Note]  
> <span data-ttu-id="3354d-143">È importante tenere traccia dell'uso di un PIDL completo o relativo.</span><span class="sxs-lookup"><span data-stu-id="3354d-143">It is important to keep track of whether you are working with a full or relative PIDL.</span></span> <span data-ttu-id="3354d-144">Alcune funzioni e metodi accetteranno uno dei due, mentre altri ne accetteranno solo uno o l'altro.</span><span class="sxs-lookup"><span data-stu-id="3354d-144">Some functions and methods will accept either, but others will only take one or the other.</span></span>

 

<span data-ttu-id="3354d-145">I restanti tre metodi [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)e [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) sono utili se è necessario eseguire enumerazioni ripetute della cartella.</span><span class="sxs-lookup"><span data-stu-id="3354d-145">The remaining three [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) methods ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), and [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) are useful if you need to do repeated enumerations of the folder.</span></span> <span data-ttu-id="3354d-146">Consentono di reimpostare l'enumerazione, ignorare uno o più oggetti e creare una copia dell'oggetto di enumerazione per conservarne lo stato.</span><span class="sxs-lookup"><span data-stu-id="3354d-146">They allow you to reset the enumeration, skip one or more objects, and make a copy of the enumeration object to preserve its state.</span></span>

## <a name="determining-display-names-and-other-properties"></a><span data-ttu-id="3354d-147">Determinazione dei nomi visualizzati e delle altre proprietà</span><span class="sxs-lookup"><span data-stu-id="3354d-147">Determining Display Names and Other Properties</span></span>

<span data-ttu-id="3354d-148">Dopo aver enumerato tutti i PIDL contenuti in una cartella, è possibile individuare il tipo di oggetti che rappresentano.</span><span class="sxs-lookup"><span data-stu-id="3354d-148">Once you have enumerated all the PIDLs that are contained by a folder, you can find out what sort of objects they represent.</span></span> <span data-ttu-id="3354d-149">L'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) fornisce una serie di metodi utili, due dei quali sono discussi qui.</span><span class="sxs-lookup"><span data-stu-id="3354d-149">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface provides a number of useful methods, two of which are discussed here.</span></span> <span data-ttu-id="3354d-150">Altri metodi **IShellFolder** e altre interfacce di cartelle della shell verranno discusse più avanti.</span><span class="sxs-lookup"><span data-stu-id="3354d-150">Other **IShellFolder** methods and other Shell folder interfaces are discussed later.</span></span>

<span data-ttu-id="3354d-151">Una delle proprietà più utili è il nome visualizzato dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="3354d-151">One of the most useful properties is the object's display name.</span></span> <span data-ttu-id="3354d-152">Per recuperare il nome visualizzato di un oggetto, passare il relativo PIDL a [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="3354d-152">To retrieve the display name of an object, pass its PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="3354d-153">Sebbene l'oggetto possa trovarsi in qualsiasi punto sotto la cartella padre nello spazio dei nomi, il relativo PIDL deve essere relativo alla cartella.</span><span class="sxs-lookup"><span data-stu-id="3354d-153">Although the object can be located anywhere below the parent folder in the namespace, its PIDL must be relative to the folder.</span></span>

<span data-ttu-id="3354d-154">[**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) restituisce il nome visualizzato come parte di una struttura [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="3354d-154">[**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) returns the display name as part of of a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="3354d-155">Poiché l'estrazione del nome visualizzato da una struttura **STRRET** può essere un po' complicata, la shell fornisce due funzioni che eseguono il processo per l'utente, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) e [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span><span class="sxs-lookup"><span data-stu-id="3354d-155">Because extracting the display name from a **STRRET** structure can be a little tricky, the Shell provides two functions that do the job for you, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) and [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span></span> <span data-ttu-id="3354d-156">Entrambe le funzioni accettano una struttura **STRRET** e restituiscono il nome visualizzato come stringa normale.</span><span class="sxs-lookup"><span data-stu-id="3354d-156">Both functions take a **STRRET** structure, and return the display name as a normal string.</span></span> <span data-ttu-id="3354d-157">Si differenziano solo per la modalità di allocazione della stringa.</span><span class="sxs-lookup"><span data-stu-id="3354d-157">They differ only in how the string is allocated.</span></span>

<span data-ttu-id="3354d-158">Oltre al nome visualizzato, un oggetto può avere diversi attributi, ad esempio se si tratta di una cartella o se può essere spostata.</span><span class="sxs-lookup"><span data-stu-id="3354d-158">In addition to its display name, an object can have a number of attributes, such as whether it is a folder or whether it can be moved.</span></span> <span data-ttu-id="3354d-159">È possibile recuperare gli attributi di un oggetto passandone il PIDL a [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="3354d-159">You can retrieve an object's attributes by passing its PIDL to [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span> <span data-ttu-id="3354d-160">L'elenco completo degli attributi è molto grande, pertanto dovrebbe essere visualizzato il riferimento per i dettagli.</span><span class="sxs-lookup"><span data-stu-id="3354d-160">The complete list of attributes is quite large, so you should see the reference for details.</span></span> <span data-ttu-id="3354d-161">Si noti che il PIDL passato a **GetAttributesOf** deve essere a livello singolo.</span><span class="sxs-lookup"><span data-stu-id="3354d-161">Note that the PIDL that you pass to **GetAttributesOf** must be single-level.</span></span> <span data-ttu-id="3354d-162">In particolare, **IShellFolder:: GetAttributesOf** accetterà il PIDL restituito da [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="3354d-162">In particular, **IShellFolder::GetAttributesOf** will accept the PIDLs returned by [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="3354d-163">È possibile passare una matrice di PIDL e **GetAttributesOf** restituirà gli attributi in comune per tutti gli oggetti nella matrice.</span><span class="sxs-lookup"><span data-stu-id="3354d-163">You can pass in an array of PIDLs, and **GetAttributesOf** will return those attributes that all objects in the array have in common.</span></span>

<span data-ttu-id="3354d-164">Se il percorso completo di un oggetto è PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) fornisce un modo semplice per recuperare informazioni su un oggetto sufficiente per molti scopi.</span><span class="sxs-lookup"><span data-stu-id="3354d-164">If you have an object's fully qualified path or PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) provides a simple way to retrieve information about an object that is sufficient for many purposes.</span></span> <span data-ttu-id="3354d-165">**SHGetFileInfo** accetta un percorso completo o PIDL e restituisce una serie di informazioni sull'oggetto, tra cui:</span><span class="sxs-lookup"><span data-stu-id="3354d-165">**SHGetFileInfo** takes a fully qualified path or PIDL, and returns a variety of information about the object including:</span></span>

-   <span data-ttu-id="3354d-166">Nome visualizzato dell'oggetto</span><span class="sxs-lookup"><span data-stu-id="3354d-166">The object's display name</span></span>
-   <span data-ttu-id="3354d-167">Attributi dell'oggetto</span><span class="sxs-lookup"><span data-stu-id="3354d-167">The object's attributes</span></span>
-   <span data-ttu-id="3354d-168">Handle per le icone dell'oggetto</span><span class="sxs-lookup"><span data-stu-id="3354d-168">Handles to the object's icons</span></span>
-   <span data-ttu-id="3354d-169">Handle per l'elenco di immagini di sistema</span><span class="sxs-lookup"><span data-stu-id="3354d-169">A handle to the system image list</span></span>
-   <span data-ttu-id="3354d-170">Percorso del file contenente l'icona dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="3354d-170">The path of the file containing the object's icon</span></span>

## <a name="getting-a-pointer-to-a-subfolders-ishellfolder-interface"></a><span data-ttu-id="3354d-171">Recupero di un puntatore all'interfaccia IShellFolder di una sottocartella</span><span class="sxs-lookup"><span data-stu-id="3354d-171">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>

<span data-ttu-id="3354d-172">È possibile determinare se la cartella contiene sottocartelle chiamando [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) e verificando se \_ è impostato il flag di cartella SFGAO.</span><span class="sxs-lookup"><span data-stu-id="3354d-172">You can determine whether your folder contains any subfolders by calling [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) and checking to see if the SFGAO\_FOLDER flag is set.</span></span> <span data-ttu-id="3354d-173">Se un oggetto è una cartella, è possibile associarlo, che fornisce un puntatore alla relativa interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="3354d-173">If an object is a folder, you can bind to it, which provides you with a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

<span data-ttu-id="3354d-174">Per eseguire l'associazione a una sottocartella, chiamare il metodo [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) della cartella padre.</span><span class="sxs-lookup"><span data-stu-id="3354d-174">To bind to a subfolder, call the parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="3354d-175">Questo metodo accetta il PIDL della sottocartella e restituisce un puntatore alla relativa interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="3354d-175">This method takes the subfolder's PIDL and returns a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="3354d-176">Una volta ottenuto questo puntatore, è possibile utilizzare i metodi **IShellFolder** per enumerare il contenuto delle sottocartelle, determinarne le proprietà e così via.</span><span class="sxs-lookup"><span data-stu-id="3354d-176">Once you have this pointer, you can use the **IShellFolder** methods to enumerate the subfolders contents, determine their properties, and so on.</span></span>

## <a name="determining-an-objects-parent-folder"></a><span data-ttu-id="3354d-177">Determinazione della cartella padre di un oggetto</span><span class="sxs-lookup"><span data-stu-id="3354d-177">Determining an Object's Parent Folder</span></span>

<span data-ttu-id="3354d-178">Se si dispone di un PIDL di un oggetto, potrebbe essere necessario un handle per una delle interfacce esposte dalla relativa cartella padre.</span><span class="sxs-lookup"><span data-stu-id="3354d-178">If you have an object's PIDL, you may need a handle to one of the interfaces exposed by its parent folder.</span></span> <span data-ttu-id="3354d-179">Se ad esempio si desidera determinare il nome visualizzato associato a un PIDL tramite [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), è necessario recuperare prima l'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) dell'elemento padre dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="3354d-179">For example, if you want to determine the display name associated with a PIDL by using [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), you must first retrieve the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface of the object's parent.</span></span> <span data-ttu-id="3354d-180">È possibile eseguire questa operazione con le tecniche descritte nelle sezioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="3354d-180">It is possible to do this with the techniques discussed in the previous sections.</span></span> <span data-ttu-id="3354d-181">Tuttavia, un approccio molto più semplice consiste nell'usare la funzione Shell [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span><span class="sxs-lookup"><span data-stu-id="3354d-181">However, a much simpler approach is to use the Shell function, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span></span> <span data-ttu-id="3354d-182">Questa funzione accetta l'PIDL completo di un oggetto e restituisce un puntatore a interfaccia specificato nella cartella padre.</span><span class="sxs-lookup"><span data-stu-id="3354d-182">This function takes the fully qualified PIDL of an object and returns a specified interface pointer on the parent folder.</span></span> <span data-ttu-id="3354d-183">Facoltativamente, restituisce anche il PIDL a singolo livello dell'elemento per l'uso in metodi quali [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="3354d-183">Optionally, it also returns the item's single-level PIDL for use in methods such as [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span>

<span data-ttu-id="3354d-184">Nell'applicazione console di esempio seguente viene recuperato il PIDL della cartella speciale di sistema e viene restituito il relativo nome visualizzato.</span><span class="sxs-lookup"><span data-stu-id="3354d-184">The following sample console application retrieves the PIDL of the System special folder and returns its display name.</span></span>


```
#include <shlobj.h>
#include <shlwapi.h>
#include <iostream.h>
#include <objbase.h>

int main()
{
    IShellFolder *psfParent = NULL;
    LPITEMIDLIST pidlSystem = NULL;
    LPCITEMIDLIST pidlRelative = NULL;
    STRRET strDispName;
    TCHAR szDisplayName[MAX_PATH];
    HRESULT hr;

    hr = SHGetFolderLocation(NULL, CSIDL_SYSTEM, NULL, NULL, &pidlSystem);

    hr = SHBindToParent(pidlSystem, IID_IShellFolder, (void **) &psfParent, &pidlRelative);

    if(SUCCEEDED(hr))
    {
        hr = psfParent->GetDisplayNameOf(pidlRelative, SHGDN_NORMAL, &strDispName);
        hr = StrRetToBuf(&strDispName, pidlSystem, szDisplayName, sizeof(szDisplayName));
        cout << "SHGDN_NORMAL - " <<szDisplayName << '\n';
    }

    psfParent->Release();
    CoTaskMemFree(pidlSystem);

    return 0;
}
```



<span data-ttu-id="3354d-185">L'applicazione usa prima di tutto [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) per recuperare il PIDL della cartella di sistema.</span><span class="sxs-lookup"><span data-stu-id="3354d-185">The application first uses [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) to retrieve the System folder's PIDL.</span></span> <span data-ttu-id="3354d-186">Chiama quindi [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), che restituisce un puntatore all'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) della cartella padre e il PIDL della cartella di sistema rispetto al relativo elemento padre.</span><span class="sxs-lookup"><span data-stu-id="3354d-186">It then calls [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), which returns a pointer to the parent folder's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, and the System folder's PIDL relative to its parent.</span></span> <span data-ttu-id="3354d-187">USA quindi il metodo [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) della cartella padre per recuperare il nome visualizzato della cartella di sistema.</span><span class="sxs-lookup"><span data-stu-id="3354d-187">It then uses the parent folder's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to retrieve the display name of the System folder.</span></span> <span data-ttu-id="3354d-188">Poiché **GetDisplayNameOf** restituisce una struttura [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) , [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) viene utilizzato per convertire il nome visualizzato in una stringa normale.</span><span class="sxs-lookup"><span data-stu-id="3354d-188">Because **GetDisplayNameOf** returns a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure, [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) is used to convert the display name into a normal string.</span></span> <span data-ttu-id="3354d-189">Dopo aver visualizzato il nome visualizzato, i puntatori di interfaccia vengono rilasciati e il PIDL di sistema viene liberato.</span><span class="sxs-lookup"><span data-stu-id="3354d-189">After displaying the display name, the interface pointers are released and the System PIDL freed.</span></span> <span data-ttu-id="3354d-190">Si noti che non è necessario liberare il PIDL relativo restituito da **SHBindToParent**.</span><span class="sxs-lookup"><span data-stu-id="3354d-190">Note that you must not free the relative PIDL returned by **SHBindToParent**.</span></span>

 

 
