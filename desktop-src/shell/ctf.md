---
description: Flag che controllano il comportamento della funzione chiamante. Usato da SHCreateThread e SHCreateThreadWithHandle. In tali funzioni, questi valori sono definiti come di tipo flag SHCT \_ .
title: Flag CTF (Shlwapi. h)
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 66cda866-7a39-4c5a-a795-a4c5c64cbab7
api_name:
- CTF_INSIST
- CTF_THREAD_REF
- CTF_PROCESS_REF
- CTF_COINIT_STA
- CTF_COINIT
- CTF_FREELIBANDEXIT
- CTF_REF_COUNTED
- CTF_WAIT_ALLOWCOM
- CTF_UNUSED
- CTF_INHERITWOW64
- CTF_WAIT_NO_REENTRANCY
- CTF_KEYBOARD_LOCALE
- CTF_OLEINITIALIZE
- CTF_COINIT_MTA
- CTF_NOADDREFLIB
api_type:
- HeaderDef
api_location:
- Shlwapi.h
topic_type:
- APIRef
- kbSyntax
ms.openlocfilehash: db0f33daecc4abcbfbc9972d0607f4817bc7ecff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104977319"
---
# <a name="ctf-flags"></a>Flag CTF

Flag che controllano il comportamento della funzione chiamante. Usato da [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) e [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle). In tali funzioni, questi valori sono definiti come di tipo flag SHCT \_ .



| Costante/valore                                                                                                                                                                                                                                             | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CTF_INSIST"></span><span id="ctf_insist"></span><dl> <dt>**CTF \_ INSISTEre**</dt> <dt>0x00000001</dt> </dl>                                       | 0x00000001. Se il tentativo di creare il thread con [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) ha esito negativo, l'impostazione di questo flag provocherà la chiamata sincrona della funzione a cui punta *pfnThreadProc* dal thread chiamante. Questo flag può essere utilizzato solo se *pfnCallback* è **null**.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_THREAD_REF"></span><span id="ctf_thread_ref"></span><dl> <dt>**CTF \_ 0x00000002 \_ ref thread**</dt> <dt></dt> </dl>                          | 0x00000002. Mantenere un riferimento al thread di creazione per la durata della chiamata alla funzione a cui punta *pfnThreadProc*. Questo riferimento deve essere stato impostato con [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="CTF_PROCESS_REF"></span><span id="ctf_process_ref"></span><dl> <dt>**CTF \_ 0x00000004 \_ ref processo**</dt> <dt></dt> </dl>                       | 0x00000004. Mantenere un riferimento al processo di Esplora risorse per la durata della chiamata alla funzione a cui punta *pfnThreadProc*. Questo flag è utile per i [gestori di estensioni della shell](handlers.md), che potrebbero dover evitare la chiusura anomala del processo di Esplora risorse. Questa azione è utile durante le attività, ad esempio l'utilizzo di un thread in background o la copia di file. Per ulteriori informazioni, vedere [**SHGetInstanceExplorer**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_COINIT_STA"></span><span id="ctf_coinit_sta"></span><dl> <dt>**CTF \_ CoInit \_ sta**</dt> <dt>0x00000008</dt> </dl>                          | 0x00000008. Inizializzare COM come Apartment a thread singolo (STA) per il thread creato prima di chiamare la funzione facoltativa a cui punta *pfnCallback* o la funzione a cui fa riferimento *pfnThreadProc*. Questo flag è utile quando è necessario inizializzare COM per un thread. COM verrà automaticamente inizializzato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="CTF_COINIT"></span><span id="ctf_coinit"></span><dl> <dt>**CTF \_ CoInit**</dt> <dt>0x00000008</dt> </dl>                                       | Equivalente a CTF \_ CoInit \_ sta.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="CTF_FREELIBANDEXIT"></span><span id="ctf_freelibandexit"></span><dl> <dt>**CTF \_**</dt> <dt>0x00000010</dt> FREELIBANDEXIT </dl>               | 0x00000010. **Internet Explorer 6 o versione successiva.** [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) verrà chiamato sulla dll che contiene la funzione *pfnThreadProc* per impedire che venga scaricata. Dopo la restituzione di *pfnThreadProc* , la dll verrà liberata con [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary), diminuendo in tal modo il conteggio dei riferimenti alla dll. Passare questo flag per impedire che la DLL venga scaricata prematuramente; ad esempio, da [**CoFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries). Si noti che se questo flag viene passato, la funzione *pfnThreadProc* deve trovarsi in una dll. Questo flag è implicito in Windows Vista e versioni successive.<br/>                                                                                                                                                                                                                                                                   |
| <span id="CTF_REF_COUNTED"></span><span id="ctf_ref_counted"></span><dl> <dt>**CTF \_ 0x00000020 \_ conteggiati Ref**</dt> <dt></dt> </dl>                       | 0x00000020. **Internet Explorer 6 o versione successiva.** Verrà creato automaticamente un riferimento al thread per il thread creato e impostato con [**SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref). Al termine della restituzione di *pfnThreadProc* , il riferimento al thread viene rilasciato e i messaggi vengono inviati fino a quando il conteggio dei riferimenti nel riferimento al thread non scende fino a zero, ovvero fino a quando i thread che dipendono dal thread creato non hanno rilasciato i relativi riferimenti.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_WAIT_ALLOWCOM"></span><span id="ctf_wait_allowcom"></span><dl> <dt>**CTF \_ ATTESA \_ ALLOWCOM**</dt> <dt>0x00000040</dt> </dl>                 | 0x00000040. **Internet Explorer 6 o versione successiva.** Il thread chiamante attende e pompa i messaggi COM e [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) . Se la procedura sincrona tenta di inviare un messaggio di Windows con **SendMessage** a una finestra ospitata nel thread chiamante, il messaggio verrà visualizzato correttamente. Se la procedura sincrona tenta di usare COM per comunicare con un oggetto STA ospitato nel thread chiamante, la chiamata di funzione raggiungerà correttamente l'oggetto previsto. Il thread chiamante è aperto per rientrare in fragilità. Mentre il thread chiamante è in grado di gestire l'uso di **SendMessage** e com da parte di altri thread, se altri thread utilizzano **SendMessage** o com per comunicare con gli oggetti ospitati nel thread chiamante, potrebbero essere messaggi imprevisti o chiamate di funzione elaborati durante il completamento della procedura sincrona.<br/> |
| <span id="CTF_UNUSED"></span><span id="ctf_unused"></span><dl> <dt>**CTF \_**</dt> <dt>0X00000080</dt> non usato </dl>                                       | 0x00000080. **Internet Explorer 7 o versione successiva.** Non usato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_INHERITWOW64"></span><span id="ctf_inheritwow64"></span><dl> <dt>**CTF \_**</dt> <dt>0x00000100</dt> INHERITWOW64 </dl>                     | 0x00000100. **Internet Explorer 7 o versione successiva.** Il nuovo thread eredita lo stato di disabilitazione di Windows-on-Windows a 64 bit (WOW64) per il redirector file system.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_WAIT_NO_REENTRANCY"></span><span id="ctf_wait_no_reentrancy"></span><dl> <dt>**CTF \_ \_Non attendere \_**</dt> <dt>0x00000200</dt> rientranti </dl> | 0x00000200. **Windows Vista o versioni successive.** Il thread chiamante blocca tutti gli altri processi in attesa dell'esecuzione della procedura sincrona sul nuovo thread. Se la procedura sincrona tenta di inviare un messaggio di Windows con [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) a una finestra ospitata nel thread chiamante, la procedura sincrona genera un deadlock. Se la procedura sincrona tenta di usare COM per comunicare con un oggetto STA ospitato nel thread chiamante, questo causa anche il deadlock della procedura sincrona. Il thread chiamante è protetto da tutte le problematiche di rientrata specificando questo flag.<br/>                                                                                                                                                                                                                                                                |
| <span id="CTF_KEYBOARD_LOCALE"></span><span id="ctf_keyboard_locale"></span><dl> <dt>**CTF \_ \_Impostazioni locali tastiera**</dt> <dt>0x00000400</dt> </dl>           | 0x00000400. **Windows 7 o versione successiva.** Usare le impostazioni locali della tastiera dal thread originale nel nuovo thread che genera.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_OLEINITIALIZE"></span><span id="ctf_oleinitialize"></span><dl> <dt>**CTF \_**</dt> <dt>0x00000800</dt> OLEINITIALIZE </dl>                  | 0x00000800. **Windows 7 o versione successiva.** Inizializzare COM con il modello di Apartment a thread singolo (STA) per il thread creato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_COINIT_MTA"></span><span id="ctf_coinit_mta"></span><dl> <dt>**CTF \_ CoInit \_ MTA**</dt> <dt>0x00001000</dt> </dl>                          | 0x00001000. **Windows 7 e versioni successive**. Inizializzare COM con il modello di Apartment a thread multipli (MTA) per il thread creato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_NOADDREFLIB"></span><span id="ctf_noaddreflib"></span><dl> <dt>**CTF \_**</dt> <dt>0x00002000</dt> NOADDREFLIB </dl>                        | 0x00002000. **Windows 7 o versione successiva.** Questo flag è essenzialmente il contrario di CTF \_ FREELIBANDEXIT. In questo modo [](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)si evitano / le chiamate a LoadLibrary [**FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) che possono comportare la contesa del blocco del caricatore. Usare la funzione CTF \_ NOADDREFLIB solo quando il nuovo thread ha il significato di garantire che il codice della routine del thread originale rimanga caricato. Questo valore non deve essere utilizzato nel contesto di oggetti COM, perché gli oggetti COM devono garantire che la DLL rimanga caricata (in genere, COM Scarica le dll).<br/>                                                                                                                                                                                                                                                                                                                    |



## <a name="remarks"></a>Commenti

Se non \_ \_ viene specificato alcun flag di attesa CTF, il thread chiamante attenderà e invierà messaggi [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) . Se la procedura sincrona tenta di inviare un messaggio di Windows con **SendMessage** a una finestra ospitata nel thread chiamante, il messaggio verrà inserito nella finestra desiderata. Se la procedura sincrona tenta di usare COM per comunicare con un oggetto STA ospitato nel thread chiamante, la procedura sincrona si blocca. Il thread chiamante è aperto per rientrare in fragilità. Mentre il thread chiamante è in grado di gestire l'uso di **SendMessage** per la procedura sincrona, se altri thread utilizzano **SendMessage** per comunicare con una finestra ospitata nel thread chiamante, questi messaggi potrebbero essere imprevisti. Ciò può comportarne l'elaborazione durante il completamento della procedura sincrona.

## <a name="requirements"></a>Requisiti



| Requisito | Valore |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimo supportato<br/> | Windows 2000 Professional, Windows XP, Windows 7 \[ desktop apps\]<br/>    |
| Server minimo supportato<br/> | Windows 2000 Server \[solo app desktop\]<br/>                                 |
| Intestazione<br/>                   | <dl> <dt>Shlwapi. h</dt> </dl> |



 

 
