---
description: Flag che controllano il comportamento della funzione chiamante. Usato da SHCreateThread e SHCreateThreadWithHandle. In queste funzioni, questi valori sono definiti come di tipo SHCT \_ FLAGS.
title: Flag CTF (Shlwapi.h)
ms.topic: reference
ms.date: 05/31/2018
ms.assetid: 66cda866-7a39-4c5a-a795-a4c5c64cbab7
api_name:
- CTF_INSIST
- CTF_THREAD_REF
- CTF_PROCESS_REF
- CTF_COINIT_STA
- CTF_COINIT
- CTF_FREELIBANDEXIT
- CTF_REF_COUNTED
- CTF_WAIT_ALLOWCOM
- CTF_UNUSED
- CTF_INHERITWOW64
- CTF_WAIT_NO_REENTRANCY
- CTF_KEYBOARD_LOCALE
- CTF_OLEINITIALIZE
- CTF_COINIT_MTA
- CTF_NOADDREFLIB
api_type:
- HeaderDef
api_location:
- Shlwapi.h
topic_type:
- APIRef
- kbSyntax
ms.openlocfilehash: bfad2b2e662a80501d0f869d6f9e7849e01c5dcc3e949834b698a3c583fef3d6
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "118224845"
---
# <a name="ctf-flags"></a>Flag CTF

Flag che controllano il comportamento della funzione chiamante. Usato da [**SHCreateThread**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethread) e [**SHCreateThreadWithHandle**](/windows/desktop/api/Shlwapi/nf-shlwapi-shcreatethreadwithhandle). In queste funzioni, questi valori sono definiti come di tipo SHCT \_ FLAGS.



| Costante/valore                                                                                                                                                                                                                                             | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CTF_INSIST"></span><span id="ctf_insist"></span><dl> <dt>**CTF \_ INSIST**</dt> <dt>0X00000001</dt> </dl>                                       | 0x00000001. Se il tentativo di creare il thread con [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) ha esito negativo, l'impostazione di questo flag causerà la chiamata sincrona della funzione a cui *punta pfnThreadProc* dal thread chiamante. Questo flag può essere usato solo se *pfnCallback* è **NULL.**<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_THREAD_REF"></span><span id="ctf_thread_ref"></span><dl> <dt>**CTF \_ THREAD \_ REF**</dt> <dt>0x00000002</dt> </dl>                          | 0x00000002. Contenere un riferimento al thread di creazione per la durata della chiamata alla funzione a cui *punta pfnThreadProc*. Questo riferimento deve essere stato impostato con [**SHSetThreadRef.**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="CTF_PROCESS_REF"></span><span id="ctf_process_ref"></span><dl> <dt>**CTF \_ ELABORA \_ REF**</dt> <dt>0x00000004</dt> </dl>                       | 0x00000004. Mantenere un riferimento al processo Windows Explorer per la durata della chiamata alla funzione a cui *punta pfnThreadProc*. Questo flag è utile per i gestori [dell'estensione shell](handlers.md), che potrebbero dover evitare la chiusura prematura Windows processo di Esplora risorse. Questa azione è utile durante attività quali l'uso di un thread in background o la copia di file. Per altre informazioni, vedere [**SHGetInstanceExplorer.**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetinstanceexplorer)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_COINIT_STA"></span><span id="ctf_coinit_sta"></span><dl> <dt>**CTF \_ COINIT \_ STA**</dt> <dt>0x00000008</dt> </dl>                          | 0x00000008. Inizializzare COM come apartment a thread singolo (STA) per il thread creato prima di chiamare la funzione facoltativa a cui *punta pfnCallback* o la funzione a cui punta *pfnThreadProc*. Questo flag è utile quando COM deve essere inizializzato per un thread. Anche COM verrà automaticamente non inizializzato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="CTF_COINIT"></span><span id="ctf_coinit"></span><dl> <dt>**CTF \_ CoINIT**</dt> <dt>0x00000008</dt> </dl>                                       | Equivale a CTF \_ COINIT \_ STA.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="CTF_FREELIBANDEXIT"></span><span id="ctf_freelibandexit"></span><dl> <dt>**CTF \_ FREELIBANDEXIT**</dt> <dt>0x00000010</dt> </dl>               | 0x00000010. **Internet Explorer 6 o versione successiva.** [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) verrà chiamato sulla DLL che contiene la funzione *pfnThreadProc* per impedirne lo scaricamento. Al *termine di pfnThreadProc,* la DLL verrà liberata con [**FreeLibrary,**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary)riducendo così il conteggio dei riferimenti alla DLL. Passare questo flag per impedire che la DLL venga scaricata in modo prematuro. ad esempio, di [**CoFreeUnusedLibraries**](/windows/win32/api/combaseapi/nf-combaseapi-cofreeunusedlibraries). Si noti che se questo flag viene passato, la *funzione pfnThreadProc* deve risiedere in una DLL. Questo flag è implicito in Windows Vista e versioni successive.<br/>                                                                                                                                                                                                                                                                   |
| <span id="CTF_REF_COUNTED"></span><span id="ctf_ref_counted"></span><dl> <dt>**CTF \_ \_CONTEGGIO**</dt> <dt>DEI RIFERIMENTI 0x00000020</dt> </dl>                       | 0x00000020. **Internet Explorer 6 o versione successiva.** Un riferimento al thread verrà creato automaticamente per il thread creato e impostato [**con SHSetThreadRef**](/windows/desktop/api/Shlwapi/nf-shlwapi-shsetthreadref). Al termine *di pfnThreadProc,* il riferimento al thread viene rilasciato e i messaggi vengono inviati fino a quando il conteggio dei riferimenti sul riferimento al thread non scende a zero, cio? fino a quando i thread dipendenti dal thread creato non rilasciano i relativi riferimenti.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_WAIT_ALLOWCOM"></span><span id="ctf_wait_allowcom"></span><dl> <dt>**CTF \_ WAIT \_ ALLOWCOM**</dt> <dt>0x00000040</dt> </dl>                 | 0x00000040. **Internet Explorer 6 o versione successiva.** Il thread chiamante attende e pompa i messaggi COM [**e SendMessage.**](/windows/win32/api/winuser/nf-winuser-sendmessage) Se la procedura sincrona tenta di inviare un messaggio Windows **con SendMessage** a una finestra ospitata nel thread chiamante, il messaggio verrà ricevuto correttamente. Se la procedura sincrona tenta di usare COM per comunicare con un oggetto STA ospitato nel thread chiamante, la chiamata di funzione raggiungerà correttamente l'oggetto previsto. Il thread chiamante è aperto per riasserire la fragilezza. Mentre il thread chiamante può gestire l'uso di **SendMessage** e COM da parte della procedura sincrona, se altri thread usano **SendMessage** o COM per comunicare con gli oggetti ospitati nel thread chiamante, potrebbero trattarsi di messaggi imprevisti o chiamate di funzione elaborate durante il completamento della procedura sincrona.<br/> |
| <span id="CTF_UNUSED"></span><span id="ctf_unused"></span><dl> <dt>**CTF \_ Non usato**</dt> <dt>0x00000080</dt> </dl>                                       | 0x00000080. **Internet Explorer 7 o versione successiva.** Non usato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span id="CTF_INHERITWOW64"></span><span id="ctf_inheritwow64"></span><dl> <dt>**CTF \_ INHERITWOW64**</dt> <dt>0x00000100</dt> </dl>                     | 0x00000100. **Internet Explorer 7 o versione successiva.** Il nuovo thread eredita lo stato Windows di disabilitazione Windows a 64 bit (WOW64) per il redirector file system locale.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_WAIT_NO_REENTRANCY"></span><span id="ctf_wait_no_reentrancy"></span><dl> <dt>**CTF \_ WAIT \_ NO \_ REENTRANCY**</dt> <dt>0x00000200</dt> </dl> | 0x00000200. **Windows Vista o versioni successive.** Il thread chiamante blocca tutti gli altri processi durante l'attesa dell'esecuzione della procedura sincrona nel nuovo thread. Se la procedura sincrona tenta di inviare un messaggio Windows con [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) a una finestra ospitata nel thread chiamante, la procedura sincrona viene in deadlock. Se la procedura sincrona tenta di usare COM per parlare con un oggetto STA ospitato nel thread chiamante, anche la procedura sincrona viene deadlock. Il thread chiamante è protetto da tutti i problemi di riasserzione specificando questo flag.<br/>                                                                                                                                                                                                                                                                |
| <span id="CTF_KEYBOARD_LOCALE"></span><span id="ctf_keyboard_locale"></span><dl> <dt>**CTF \_ IMPOSTAZIONI \_ LOCALI DELLA**</dt> TASTIERA <dt>0x00000400</dt> </dl>           | 0x00000400. **Windows 7 o versione successiva.** Usare le impostazioni locali della tastiera del thread originale nel nuovo thread generato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="CTF_OLEINITIALIZE"></span><span id="ctf_oleinitialize"></span><dl> <dt>**CTF \_ OLEINITIALIZE**</dt> <dt>0x00000800</dt> </dl>                  | 0x00000800. **Windows 7 o versione successiva.** Inizializzare COM con il modello apartment a thread singolo (STA) per il thread creato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="CTF_COINIT_MTA"></span><span id="ctf_coinit_mta"></span><dl> <dt>**CTF \_ CoINIT \_ MTA**</dt> <dt>0x00001000</dt> </dl>                          | 0x00001000. **Windows 7 e versioni successive.** Inizializzare COM con il modello di apartment multithreading (MTA) per il thread creato.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="CTF_NOADDREFLIB"></span><span id="ctf_noaddreflib"></span><dl> <dt>**CTF \_ NoADDREFLIB**</dt> <dt>0x00002000</dt> </dl>                        | 0x00002000. **Windows 7 o versione successiva.** Questo flag è essenzialmente l'opposto di CTF \_ FREELIBANDEXIT. In questo modo si [**evitano chiamate**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) / [**LoadLibrary FreeLibraryAndExitThread**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread) che possono causare conflitti per il blocco del caricatore. Usare CTF NOADDREFLIB solo quando il nuovo thread ha mezzi per garantire che il codice della procedura del thread originale \_ rimanga caricato. Questo valore non deve essere usato nel contesto degli oggetti COM, perché gli oggetti COM devono garantire che la DLL rimanga caricata (in genere COM scarica le DLL).<br/>                                                                                                                                                                                                                                                                                                                    |



## <a name="remarks"></a>Commenti

Se non viene specificato \_ alcun flag WAIT CTF, il thread \_ chiamante attenderà e invierà [**messaggi SendMessage.**](/windows/win32/api/winuser/nf-winuser-sendmessage) Se la procedura sincrona tenta di inviare un messaggio Windows con **SendMessage** a una finestra ospitata nel thread chiamante, il messaggio verrà visualizzato nella finestra prevista. Se la procedura sincrona tenta di usare COM per parlare con un oggetto STA ospitato nel thread chiamante, la procedura sincrona genererà un deadlock. Il thread chiamante è aperto per riasserire la fragilezza. Mentre il thread chiamante può gestire l'uso di **SendMessage** da parte della procedura sincrona, se altri thread usano **SendMessage** per comunicare con una finestra ospitata nel thread chiamante, questi messaggi potrebbero essere imprevisti. In questo modo possono essere elaborati durante il completamento della procedura sincrona.

## <a name="requirements"></a>Requisiti



| Requisito | Valore |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Client minimo supportato<br/> | Windows 2000 Professional, Windows XP, Windows 7 \[ app desktop\]<br/>    |
| Server minimo supportato<br/> | Windows 2000 Server \[solo app desktop\]<br/>                                 |
| Intestazione<br/>                   | <dl> <dt>Shlwapi.h</dt> </dl> |



 

 
