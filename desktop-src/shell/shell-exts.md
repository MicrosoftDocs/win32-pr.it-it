---
description: In questo set di argomenti viene illustrato come implementare i gestori di estensione che consentono di modificare un'ampia gamma di azioni della shell.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Uso delle estensioni della shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980650"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="460bf-103">Uso delle estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="460bf-103">Working with Shell Extensions</span></span>

<span data-ttu-id="460bf-104">Le funzionalità della shell possono essere estese con le voci del registro di sistema e i file ini.</span><span class="sxs-lookup"><span data-stu-id="460bf-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="460bf-105">Sebbene questo approccio per estendere la shell sia semplice e appropriato per molti scopi, è limitato.</span><span class="sxs-lookup"><span data-stu-id="460bf-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="460bf-106">Se ad esempio si usa il registro di sistema per specificare un'icona personalizzata per un tipo di file, verrà visualizzata la stessa icona per ogni file di quel tipo.</span><span class="sxs-lookup"><span data-stu-id="460bf-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="460bf-107">L'estensione della shell con il registro di sistema non consente di variare l'icona per membri diversi del tipo di file.</span><span class="sxs-lookup"><span data-stu-id="460bf-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="460bf-108">Altri aspetti della shell, ad esempio la finestra delle proprietà **delle proprietà che** può essere visualizzata quando si fa clic con il pulsante destro del mouse su un file, non possono essere modificati nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="460bf-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="460bf-109">Un approccio più potente e flessibile per estendere la Shell consiste nell'implementare i *gestori di estensioni della shell*.</span><span class="sxs-lookup"><span data-stu-id="460bf-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="460bf-110">Questi gestori possono essere implementati per un'ampia gamma di azioni che la shell può eseguire.</span><span class="sxs-lookup"><span data-stu-id="460bf-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="460bf-111">Prima di eseguire l'azione, la shell esegue una query sul gestore dell'estensione, offrendo la possibilità di modificare l'azione.</span><span class="sxs-lookup"><span data-stu-id="460bf-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="460bf-112">Un esempio comune è un gestore di estensione del menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="460bf-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="460bf-113">Se ne viene implementato uno per un tipo di file, verrà eseguita una query ogni volta che viene fatto clic con il pulsante destro del mouse su uno dei file.</span><span class="sxs-lookup"><span data-stu-id="460bf-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="460bf-114">Il gestore può quindi specificare voci di menu aggiuntive in base al file, anziché avere lo stesso set per tutti i file di quel tipo di file.</span><span class="sxs-lookup"><span data-stu-id="460bf-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="460bf-115">In questo set di argomenti viene illustrato come implementare i gestori di estensione che consentono di modificare un'ampia gamma di azioni della shell.</span><span class="sxs-lookup"><span data-stu-id="460bf-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="460bf-116">I gestori seguenti sono associati a un tipo di file specifico e consentono di specificare in base al file.</span><span class="sxs-lookup"><span data-stu-id="460bf-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="460bf-117">Gestore</span><span class="sxs-lookup"><span data-stu-id="460bf-117">Handler</span></span>                                               | <span data-ttu-id="460bf-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="460bf-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="460bf-119">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="460bf-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="460bf-120">Chiamato prima che venga visualizzato il menu di scelta rapida di un file.</span><span class="sxs-lookup"><span data-stu-id="460bf-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="460bf-121">Consente di aggiungere elementi al menu di scelta rapida in base al file.</span><span class="sxs-lookup"><span data-stu-id="460bf-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="460bf-122">Gestore dati</span><span class="sxs-lookup"><span data-stu-id="460bf-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="460bf-123">Chiamato quando viene eseguita un'operazione di trascinamento e rilascio sugli oggetti della shell.</span><span class="sxs-lookup"><span data-stu-id="460bf-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="460bf-124">Consente di fornire altri formati degli Appunti all'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="460bf-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="460bf-125">Gestore di trascinamento</span><span class="sxs-lookup"><span data-stu-id="460bf-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="460bf-126">Chiamato quando un oggetto dati viene trascinato o rilasciato in un file.</span><span class="sxs-lookup"><span data-stu-id="460bf-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="460bf-127">Consente di creare un file in un obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="460bf-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="460bf-128">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="460bf-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="460bf-129">Chiamato prima che venga visualizzata l'icona di un file.</span><span class="sxs-lookup"><span data-stu-id="460bf-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="460bf-130">Consente di sostituire l'icona predefinita del file con un'icona personalizzata in base al file.</span><span class="sxs-lookup"><span data-stu-id="460bf-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="460bf-131">Gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="460bf-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="460bf-132">Chiamato prima della visualizzazione della finestra delle proprietà **delle proprietà di** un oggetto.</span><span class="sxs-lookup"><span data-stu-id="460bf-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="460bf-133">Consente di aggiungere o sostituire pagine.</span><span class="sxs-lookup"><span data-stu-id="460bf-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="460bf-134">**Gestore immagini di anteprima**</span><span class="sxs-lookup"><span data-stu-id="460bf-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="460bf-135">Fornisce un'immagine per rappresentare l'elemento.</span><span class="sxs-lookup"><span data-stu-id="460bf-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="460bf-136">**Gestore della finestra popup**</span><span class="sxs-lookup"><span data-stu-id="460bf-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="460bf-137">Fornisce il testo popup quando l'utente posiziona il puntatore del mouse sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="460bf-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="460bf-138">**Gestore di metadati**</span><span class="sxs-lookup"><span data-stu-id="460bf-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="460bf-139">Fornisce l'accesso in lettura e scrittura ai metadati (proprietà) archiviati in un file.</span><span class="sxs-lookup"><span data-stu-id="460bf-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="460bf-140">Questa operazione può essere utilizzata per estendere la visualizzazione dettagli, infotip, la pagina delle proprietà e le funzionalità di raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="460bf-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="460bf-141">Altri non sono associati a un tipo di file specifico, ma vengono chiamati prima di alcune operazioni della shell.</span><span class="sxs-lookup"><span data-stu-id="460bf-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="460bf-142">Gestore</span><span class="sxs-lookup"><span data-stu-id="460bf-142">Handler</span></span>                                                            | <span data-ttu-id="460bf-143">Descrizione</span><span class="sxs-lookup"><span data-stu-id="460bf-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="460bf-144">Gestore delle colonne</span><span class="sxs-lookup"><span data-stu-id="460bf-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="460bf-145">Chiamato da Esplora risorse prima di visualizzare la visualizzazione dettagli di una cartella.</span><span class="sxs-lookup"><span data-stu-id="460bf-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="460bf-146">Consente di aggiungere colonne personalizzate alla visualizzazione dettagli.</span><span class="sxs-lookup"><span data-stu-id="460bf-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="460bf-147">Gestore hook di copia</span><span class="sxs-lookup"><span data-stu-id="460bf-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="460bf-148">Chiamato quando un oggetto Folder o Printer sta per essere spostato, copiato, eliminato o rinominato.</span><span class="sxs-lookup"><span data-stu-id="460bf-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="460bf-149">Consente di approvare o porre il veto sull'operazione.</span><span class="sxs-lookup"><span data-stu-id="460bf-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="460bf-150">Gestore di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="460bf-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="460bf-151">Chiamato quando un file viene trascinato con il pulsante destro del mouse.</span><span class="sxs-lookup"><span data-stu-id="460bf-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="460bf-152">Consente di modificare il menu di scelta rapida visualizzato.</span><span class="sxs-lookup"><span data-stu-id="460bf-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="460bf-153">Gestore sovrimpressione icone</span><span class="sxs-lookup"><span data-stu-id="460bf-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="460bf-154">Chiamato prima che venga visualizzata l'icona di un file.</span><span class="sxs-lookup"><span data-stu-id="460bf-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="460bf-155">Consente di specificare una sovrapposizione per l'icona del file.</span><span class="sxs-lookup"><span data-stu-id="460bf-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="460bf-156">Gestore ricerche</span><span class="sxs-lookup"><span data-stu-id="460bf-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="460bf-157">Chiamato per avviare un motore di ricerca.</span><span class="sxs-lookup"><span data-stu-id="460bf-157">Called to launch a search engine.</span></span> <span data-ttu-id="460bf-158">Consente di implementare un motore di ricerca personalizzato accessibile dal menu **Start** o da Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="460bf-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="460bf-159">I dettagli relativi all'implementazione di gestori di estensioni specifici sono descritti nelle sezioni elencate in precedenza.</span><span class="sxs-lookup"><span data-stu-id="460bf-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="460bf-160">Per le discussioni sui problemi di implementazione comuni a tutti i gestori di estensioni della shell, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="460bf-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="460bf-161">Inizializzazione di gestori estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="460bf-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="460bf-162">Registrazione di gestori estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="460bf-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
