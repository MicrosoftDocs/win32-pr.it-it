---
description: Questo argomento fornisce un'analisi dettagliata dei requisiti per la compilazione di un file DLL che implementa un gestore da usare con il Centro sincronizzazione. Queste informazioni sono valide a partire da Windows Vista.
title: Sviluppo di un gestore del Centro sincronizzazione Windows
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 66b40f81-9515-4190-8ced-44f20bb9df86
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 11185aa5976c27b7af95787b081e1eaacd99c8e9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104979799"
---
# <a name="developing-a-windows-sync-center-handler"></a><span data-ttu-id="6eedc-104">Sviluppo di un gestore del Centro sincronizzazione Windows</span><span class="sxs-lookup"><span data-stu-id="6eedc-104">Developing a Windows Sync Center Handler</span></span>

<span data-ttu-id="6eedc-105">Questo argomento fornisce un'analisi dettagliata dei requisiti per la compilazione di un file DLL che implementa un gestore da usare con il Centro sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="6eedc-105">This topic provides a step-by-step examination of the requirements to build a DLL file that implements a handler to be used with Sync Center.</span></span> <span data-ttu-id="6eedc-106">Queste informazioni sono valide a partire da Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="6eedc-106">This information is valid as of Windows Vista.</span></span>

-   [<span data-ttu-id="6eedc-107">Esperienza di sincronizzazione di Windows prima di vista</span><span class="sxs-lookup"><span data-stu-id="6eedc-107">The Windows Synchronization Experience Before Vista</span></span>](#the-windows-synchronization-experience-before-vista)
-   [<span data-ttu-id="6eedc-108">API del Centro sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="6eedc-108">Sync Center APIs</span></span>](#sync-center-apis)
    -   [<span data-ttu-id="6eedc-109">Interfacce essenziali</span><span class="sxs-lookup"><span data-stu-id="6eedc-109">Essential Interfaces</span></span>](#essential-interfaces)

## <a name="the-windows-synchronization-experience-before-vista"></a><span data-ttu-id="6eedc-110">Esperienza di sincronizzazione di Windows prima di vista</span><span class="sxs-lookup"><span data-stu-id="6eedc-110">The Windows Synchronization Experience Before Vista</span></span>

<span data-ttu-id="6eedc-111">Windows XP ha fornito una [Gestione sincronizzazione](syncmgr-start-page.md) (mobsync.exe).</span><span class="sxs-lookup"><span data-stu-id="6eedc-111">Windows XP provided a [Synchronization Manager](syncmgr-start-page.md) (mobsync.exe).</span></span> <span data-ttu-id="6eedc-112">Molti dispositivi, ad esempio lettori MP3, telefoni cellulari e fotocamere, forniscono anche le proprie interfacce di sincronizzazione anziché usare Gestione sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="6eedc-112">Many devices such as mp3 players, cell phones, and cameras also provided their own synchronization interfaces rather than using the Synchronization Manager.</span></span> <span data-ttu-id="6eedc-113">Ciò ha comportato un'esperienza utente non coerente e non centralizzata.</span><span class="sxs-lookup"><span data-stu-id="6eedc-113">This resulted in an inconsistent and noncentralized user experience.</span></span>

<span data-ttu-id="6eedc-114">La nuova funzionalità del Centro sincronizzazione fornita in Windows Vista presenta diversi vantaggi rispetto alla gestione della sincronizzazione precedente.</span><span class="sxs-lookup"><span data-stu-id="6eedc-114">The new Sync Center feature provided in Windows Vista has several advantages over the older Synchronization Manager.</span></span>

-   <span data-ttu-id="6eedc-115">Maggiore individuabilità</span><span class="sxs-lookup"><span data-stu-id="6eedc-115">Better discoverability</span></span>
-   <span data-ttu-id="6eedc-116">Minore necessità di azione diretta dell'utente</span><span class="sxs-lookup"><span data-stu-id="6eedc-116">Less need for direct user action</span></span>
-   <span data-ttu-id="6eedc-117">Non blocca altre operazioni</span><span class="sxs-lookup"><span data-stu-id="6eedc-117">Does not block other operations</span></span>
-   <span data-ttu-id="6eedc-118">Migliore visualizzazione dello stato di avanzamento della sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="6eedc-118">Better visualization of the synchronization progress</span></span>
-   <span data-ttu-id="6eedc-119">Modello di sviluppo più semplice da comprendere</span><span class="sxs-lookup"><span data-stu-id="6eedc-119">Easier to understand development model</span></span>

## <a name="sync-center-apis"></a><span data-ttu-id="6eedc-120">API del Centro sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="6eedc-120">Sync Center APIs</span></span>

<span data-ttu-id="6eedc-121">Il Centro sincronizzazione comunica con i gestori tramite una serie di interfacce di Component Object Model (COM).</span><span class="sxs-lookup"><span data-stu-id="6eedc-121">Sync Center communicates with handlers through a number of Component Object Model (COM) interfaces.</span></span> <span data-ttu-id="6eedc-122">Non tutte queste interfacce sono necessarie per implementare un gestore del Centro sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="6eedc-122">Not all of these interfaces are needed to implement a Sync Center handler.</span></span> <span data-ttu-id="6eedc-123">Questo argomento è stato suddiviso in due sezioni.</span><span class="sxs-lookup"><span data-stu-id="6eedc-123">This topic has been broken into two sections.</span></span> <span data-ttu-id="6eedc-124">La prima sezione illustra le interfacce COM essenziali che ogni gestore deve supportare e la seconda sezione esamina le interfacce COM facoltative ed esamina i motivi che un gestore li supporterà.</span><span class="sxs-lookup"><span data-stu-id="6eedc-124">The first section explains the essential COM interfaces that every handler must support, and the second section examines the optional COM interfaces and looks at the reasons that a handler would support them.</span></span>

-   [<span data-ttu-id="6eedc-125">Interfacce essenziali</span><span class="sxs-lookup"><span data-stu-id="6eedc-125">Essential Interfaces</span></span>](#essential-interfaces)

### <a name="essential-interfaces"></a><span data-ttu-id="6eedc-126">Interfacce essenziali</span><span class="sxs-lookup"><span data-stu-id="6eedc-126">Essential Interfaces</span></span>

<span data-ttu-id="6eedc-127">Tutti i gestori del Centro sincronizzazione devono supportare le interfacce seguenti:</span><span class="sxs-lookup"><span data-stu-id="6eedc-127">All Sync Center handlers must support the following interfaces:</span></span>

-   [<span data-ttu-id="6eedc-128">**ISyncMgrHandler**</span><span class="sxs-lookup"><span data-stu-id="6eedc-128">**ISyncMgrHandler**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler)
-   [<span data-ttu-id="6eedc-129">**ISyncMgrHandlerInfo**</span><span class="sxs-lookup"><span data-stu-id="6eedc-129">**ISyncMgrHandlerInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo)
-   [<span data-ttu-id="6eedc-130">**ISyncMgrSyncItemContainer**</span><span class="sxs-lookup"><span data-stu-id="6eedc-130">**ISyncMgrSyncItemContainer**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer)
-   [<span data-ttu-id="6eedc-131">**IEnumSyncMgrSyncItems**</span><span class="sxs-lookup"><span data-stu-id="6eedc-131">**IEnumSyncMgrSyncItems**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems)
-   [<span data-ttu-id="6eedc-132">**ISyncMgrSyncItem**</span><span class="sxs-lookup"><span data-stu-id="6eedc-132">**ISyncMgrSyncItem**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem)
-   [<span data-ttu-id="6eedc-133">**ISyncMgrSyncItemInfo**</span><span class="sxs-lookup"><span data-stu-id="6eedc-133">**ISyncMgrSyncItemInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo)

<span data-ttu-id="6eedc-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) e [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) vengono usati per descrivere un singolo elemento di sincronizzazione che interessano la sincronizzazione con il centro di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="6eedc-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) are used to describe a single sync item involved in the synchronization to the Sync Center.</span></span> <span data-ttu-id="6eedc-135">Un elemento di sincronizzazione rappresenta in genere un particolare tipo di dati, ad esempio immagini, o una particolare posizione di dati.</span><span class="sxs-lookup"><span data-stu-id="6eedc-135">A sync item generally represents either a particular data type (such as images) or a particular location of data.</span></span>

<span data-ttu-id="6eedc-136">Gli elementi di sincronizzazione che rappresentano percorsi di dati diversi consentono sincronizzazioni molto specifiche.</span><span class="sxs-lookup"><span data-stu-id="6eedc-136">Sync items that represent different data locations allow for very specific synchronizations.</span></span> <span data-ttu-id="6eedc-137">La granularità della posizione spetta all'autore del gestore, ma è necessario prestare attenzione alla progettazione.</span><span class="sxs-lookup"><span data-stu-id="6eedc-137">The granularity of the location is up to the handler author, but care should be taken in the design.</span></span> <span data-ttu-id="6eedc-138">Se sono presenti troppi elementi di sincronizzazione (percorsi), l'utente è limitato alla possibilità di sincronizzare solo determinati dati.</span><span class="sxs-lookup"><span data-stu-id="6eedc-138">If there are too few sync items (locations), then the user is restricted in their ability to sync only certain data.</span></span> <span data-ttu-id="6eedc-139">All'altro estremo, una granularità eccessiva può diventare non gestibile.</span><span class="sxs-lookup"><span data-stu-id="6eedc-139">At the other extreme, too much granularity can become unmanageable.</span></span>

<span data-ttu-id="6eedc-140">Se un gestore supporta più di un tipo di dati o più percorsi di dati, deve supportare più di un oggetto di sincronizzazione elemento.</span><span class="sxs-lookup"><span data-stu-id="6eedc-140">If a handler supports more than one data type or multiple data locations, then it needs to support more than one sync item object.</span></span> <span data-ttu-id="6eedc-141">Un esempio può essere un PDA (Personal Data Assistant) che consente all'utente di sincronizzare contatti, elementi del calendario e documenti.</span><span class="sxs-lookup"><span data-stu-id="6eedc-141">An example might be a personal data assistant (PDA) that allows the user to sync contacts, calendar items and documents.</span></span> <span data-ttu-id="6eedc-142">Questi tre tipi di dati devono essere rappresentati da tre oggetti univoci, ciascuno dei quali espone le interfacce [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) e [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) .</span><span class="sxs-lookup"><span data-stu-id="6eedc-142">These three data types would need to be represented by three unique objects that each expose the [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) interfaces.</span></span>

<span data-ttu-id="6eedc-143">L'interfaccia [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) fornisce un meccanismo per enumerare gli elementi di sincronizzazione di un gestore.</span><span class="sxs-lookup"><span data-stu-id="6eedc-143">The [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) interface provides a mechanism to enumerate through a handler's sync items.</span></span> <span data-ttu-id="6eedc-144">Per recuperare l'enumeratore, il Centro sincronizzazione chiama il metodo [**ISyncMgrSyncItemContainer:: GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) esposto dal gestore.</span><span class="sxs-lookup"><span data-stu-id="6eedc-144">To retrieve this enumerator, Sync Center calls the [**ISyncMgrSyncItemContainer::GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) method exposed by the handler.</span></span> <span data-ttu-id="6eedc-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) contiene anche altri due metodi che possono essere usati dal Centro sincronizzazione per recuperare le informazioni sugli elementi di sincronizzazione del gestore:</span><span class="sxs-lookup"><span data-stu-id="6eedc-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) also contains two other methods that the Sync Center can use to retrieve information about the handler's sync items:</span></span>

-   <span data-ttu-id="6eedc-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) restituisce un elemento di sincronizzazione specifico.</span><span class="sxs-lookup"><span data-stu-id="6eedc-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) returns a specific sync item.</span></span>
-   <span data-ttu-id="6eedc-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) restituisce il numero di elementi di sincronizzazione supportati dal gestore.</span><span class="sxs-lookup"><span data-stu-id="6eedc-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) returns the number of sync items supported by the handler.</span></span>

<span data-ttu-id="6eedc-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) e [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) vengono usati per descrivere le proprietà del gestore e avviare la sincronizzazione effettiva.</span><span class="sxs-lookup"><span data-stu-id="6eedc-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) and [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) are used to describe the properties of the hander and launch the actual synchronization.</span></span> <span data-ttu-id="6eedc-149">[**ISyncMgrHandler:: Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) è il punto in cui il codice del gestore esegue la sincronizzazione e fornisce feedback sullo stato di avanzamento e sui problemi che si verificano.</span><span class="sxs-lookup"><span data-stu-id="6eedc-149">[**ISyncMgrHandler::Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) is where the handler code carries out the synchronization and provides feedback on progress and any issues that occur.</span></span>

<span data-ttu-id="6eedc-150">Molti metodi di interfaccia non devono essere completamente implementati.</span><span class="sxs-lookup"><span data-stu-id="6eedc-150">Many of the interface methods do not need to be fully implemented.</span></span> <span data-ttu-id="6eedc-151">Il Centro sincronizzazione fornisce una certa quantità di informazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="6eedc-151">Sync Center provides a certain amount of default information.</span></span> <span data-ttu-id="6eedc-152">Le interfacce consentono a un gestore di eseguire l'override di queste informazioni e fornire informazioni personalizzate da visualizzare, se necessario.</span><span class="sxs-lookup"><span data-stu-id="6eedc-152">The interfaces allow a handler to override this information and provide custom information to display, if needed.</span></span>

 

 



