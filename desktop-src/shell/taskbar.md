---
description: L'interfaccia di Windows include una barra degli strumenti del desktop applicazione speciale denominata barra delle applicazioni. È possibile utilizzare la barra delle applicazioni per attività come il cambio tra le finestre aperte e l'avvio di nuove applicazioni.
ms.assetid: 14d520e7-7c15-441d-9662-24b972d208ac
title: Barra delle applicazioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cce37991c6265f02ab92ece62dbae341031d272a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104994968"
---
# <a name="the-taskbar"></a><span data-ttu-id="c24a4-104">Barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-104">The Taskbar</span></span>

<span data-ttu-id="c24a4-105">L'interfaccia di Windows include una [barra degli strumenti del desktop applicazione](application-desktop-toolbars.md) speciale denominata *barra delle applicazioni*.</span><span class="sxs-lookup"><span data-stu-id="c24a4-105">The Windows interface includes a special [application desktop toolbar](application-desktop-toolbars.md) called the *taskbar*.</span></span> <span data-ttu-id="c24a4-106">È possibile utilizzare la barra delle applicazioni per attività come il cambio tra le finestre aperte e l'avvio di nuove applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-106">You can use the taskbar for such tasks as switching between open windows and starting new applications.</span></span>

> [!Note]  
> <span data-ttu-id="c24a4-107">Per informazioni sulle modifiche apportate alla barra delle applicazioni a partire da Windows 7, vedere [estensioni della barra delle applicazioni](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-107">For information on changes made to the taskbar as of Windows 7, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

 

<span data-ttu-id="c24a4-108">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="c24a4-108">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="c24a4-109">Informazioni sulla barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-109">About the Taskbar</span></span>](#about-the-taskbar)
    -   [<span data-ttu-id="c24a4-110">Opzioni di visualizzazione della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-110">Taskbar Display Options</span></span>](#taskbar-display-options)
    -   [<span data-ttu-id="c24a4-111">Aggiunta di collegamenti al menu Start</span><span class="sxs-lookup"><span data-stu-id="c24a4-111">Adding Shortcuts to the Start Menu</span></span>](#adding-shortcuts-to-the-start-menu)
    -   [<span data-ttu-id="c24a4-112">Gestione dei pulsanti della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-112">Managing Taskbar Buttons</span></span>](#managing-taskbar-buttons)
    -   [<span data-ttu-id="c24a4-113">Aggiunta, modifica ed eliminazione di icone nell'area di notifica</span><span class="sxs-lookup"><span data-stu-id="c24a4-113">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>](#adding-modifying-and-deleting-icons-in-the-notification-area)
    -   [<span data-ttu-id="c24a4-114">Notifica di creazione della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-114">Taskbar Creation Notification</span></span>](#taskbar-creation-notification)
-   [<span data-ttu-id="c24a4-115">Uso della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-115">Using the Taskbar</span></span>](#using-the-taskbar)
    -   [<span data-ttu-id="c24a4-116">Aggiunta ed eliminazione delle icone delle barre degli strumenti nell'area di notifica</span><span class="sxs-lookup"><span data-stu-id="c24a4-116">Adding and Deleting Taskbar Icons in the Notification Area</span></span>](#adding-and-deleting-taskbar-icons-in-the-notification-area)
    -   [<span data-ttu-id="c24a4-117">Ricezione di eventi del mouse</span><span class="sxs-lookup"><span data-stu-id="c24a4-117">Receiving Mouse Events</span></span>](#receiving-mouse-events)

## <a name="about-the-taskbar"></a><span data-ttu-id="c24a4-118">Informazioni sulla barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-118">About the Taskbar</span></span>

<span data-ttu-id="c24a4-119">La barra delle applicazioni include quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c24a4-119">The taskbar includes the following:</span></span>

-   <span data-ttu-id="c24a4-120">Menu **Start**</span><span class="sxs-lookup"><span data-stu-id="c24a4-120">**Start** menu</span></span>
-   <span data-ttu-id="c24a4-121">Barra avvio veloce (solo Windows Vista e versioni precedenti)</span><span class="sxs-lookup"><span data-stu-id="c24a4-121">Quick Launch bar (Windows Vista and earlier only)</span></span>
-   <span data-ttu-id="c24a4-122">Pulsanti della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-122">Taskbar buttons</span></span>
-   <span data-ttu-id="c24a4-123">Barre degli strumenti (facoltativo)</span><span class="sxs-lookup"><span data-stu-id="c24a4-123">Toolbars (optional)</span></span>
-   <span data-ttu-id="c24a4-124">Area delle notifiche</span><span class="sxs-lookup"><span data-stu-id="c24a4-124">Notification area</span></span>

<span data-ttu-id="c24a4-125">Il menu **Start** contiene i comandi che consentono di accedere a programmi, documenti e impostazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-125">The **Start** menu contains commands that can access programs, documents, and settings.</span></span> <span data-ttu-id="c24a4-126">Questi comandi includono **tutti i programmi, i** **documenti**, il **Pannello di controllo**, i **giochi**, la **Guida e il supporto tecnico**, l' **arresto** e la **ricerca di programmi e file**.</span><span class="sxs-lookup"><span data-stu-id="c24a4-126">These commands include **All Programs**, **Documents**, **Control Panel**, **Games**, **Help and Support**, **Shut down**, and **Search programs and files**.</span></span>

<span data-ttu-id="c24a4-127">L' **avvio** nelle versioni precedenti di Windows conteneva elementi quali **trova** ed **Esegui**, la cui funzionalità era inclusa nei **programmi e nei file di ricerca** in Windows Vista e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="c24a4-127">The **Start** in earlier versions of Windows contained items such as **Find** and **Run**, the functionality of which was included in **Search programs and files** in Windows Vista and later.</span></span>

<span data-ttu-id="c24a4-128">La barra avvio veloce, disponibile nelle versioni di Windows precedenti a Windows 7, contiene collegamenti alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-128">The Quick Launch bar, available in versions of Windows earlier than Windows 7, contains shortcuts to applications.</span></span> <span data-ttu-id="c24a4-129">Windows fornisce voci predefinite, ad esempio Windows Internet Explorer, e l'utente può aggiungere eventuali altri collegamenti scelti.</span><span class="sxs-lookup"><span data-stu-id="c24a4-129">Windows provides default entries, such as Windows Internet Explorer, and the user can add any further shortcuts that they choose.</span></span> <span data-ttu-id="c24a4-130">Le icone in quest'area rispondono a un solo clic.</span><span class="sxs-lookup"><span data-stu-id="c24a4-130">Icons in this area respond to a single click.</span></span> <span data-ttu-id="c24a4-131">In Windows 7 e versioni successive questa funzionalità è inclusa nei pulsanti della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-131">In Windows 7 and later, this functionality is included in the taskbar buttons.</span></span>

<span data-ttu-id="c24a4-132">La shell posiziona un pulsante sulla barra delle applicazioni ogni volta che un'applicazione crea una finestra senza proprietario, ovvero una finestra che non dispone di un elemento padre e con i bit di stile estesi appropriati. vedere la sezione relativa alla [gestione dei pulsanti della barra delle applicazioni](#managing-taskbar-buttons).</span><span class="sxs-lookup"><span data-stu-id="c24a4-132">The Shell places a button on the taskbar whenever an application creates an unowned window—that is, a window that does not have a parent and that has the appropriate extended style bits (see [Managing Taskbar Buttons](#managing-taskbar-buttons), below).</span></span> <span data-ttu-id="c24a4-133">Per passare a una finestra, l'utente fa clic sul pulsante della finestra.</span><span class="sxs-lookup"><span data-stu-id="c24a4-133">To switch to a window, the user clicks its window button.</span></span> <span data-ttu-id="c24a4-134">Questa funzionalità è stata notevolmente espansa a partire da Windows 7.</span><span class="sxs-lookup"><span data-stu-id="c24a4-134">This functionality has been greatly expanded as of Windows 7.</span></span> <span data-ttu-id="c24a4-135">Per ulteriori informazioni, vedere [estensioni della barra delle applicazioni](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-135">For more information, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

<span data-ttu-id="c24a4-136">Le applicazioni possono inserire icone nell'area di notifica per indicare lo stato di un'operazione o per notificare all'utente un evento.</span><span class="sxs-lookup"><span data-stu-id="c24a4-136">Applications can put icons in the notification area to indicate the status of an operation or to notify the user about an event.</span></span> <span data-ttu-id="c24a4-137">Un'applicazione potrebbe ad esempio inserire un'icona della stampante nell'area di notifica per indicare che un processo di stampa è in corso.</span><span class="sxs-lookup"><span data-stu-id="c24a4-137">For example, an application might put a printer icon in the notification area to show that a print job is under way.</span></span> <span data-ttu-id="c24a4-138">Tuttavia, in Windows 7 e versioni successive, alcune delle informazioni fornite in precedenza dall'area di notifica devono essere fornite tramite il pulsante della barra delle applicazioni di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c24a4-138">However, in Windows 7 and later, some of the information previously provided by the notification area should be provided through an application's taskbar button.</span></span> <span data-ttu-id="c24a4-139">L'area di notifica si trova sul bordo destro della barra delle applicazioni (se la barra delle applicazioni è orizzontale) o nella parte inferiore (se la barra delle applicazioni è verticale).</span><span class="sxs-lookup"><span data-stu-id="c24a4-139">The notification area is located at the right edge of the taskbar (if the taskbar is horizontal) or at the bottom (if the taskbar is vertical).</span></span> <span data-ttu-id="c24a4-140">Per ulteriori informazioni, vedere [notifiche e l'area di notifica](notification-area.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-140">For more information, see [Notifications and the Notification Area](notification-area.md).</span></span>

<span data-ttu-id="c24a4-141">L'area di notifica Visualizza anche l'ora corrente se è selezionata questa opzione.</span><span class="sxs-lookup"><span data-stu-id="c24a4-141">The notification area also displays the current time if that option is selected.</span></span> <span data-ttu-id="c24a4-142">L'opzione è disponibile come:</span><span class="sxs-lookup"><span data-stu-id="c24a4-142">The option is found as:</span></span>

-   <span data-ttu-id="c24a4-143">**Windows 7 e versioni successive**: l'elenco a discesa **Clock** nella pagina **attiva o disattiva icone di sistema** dell'applicazione del pannello di controllo delle icone dell' **area di notifica** , accessibile anche tramite le proprietà dell'area di notifica.</span><span class="sxs-lookup"><span data-stu-id="c24a4-143">**Windows 7 and later**: The **Clock** drop-down list in the **Turn system icons on or off** page of the **Notification Area Icons** Control Panel application (also accessible through the notification area properties).</span></span>
-   <span data-ttu-id="c24a4-144">**Windows Vista**: la casella di controllo **Clock** nella pagina **area di notifica** della finestra delle proprietà della **barra delle applicazioni e del menu Start** .</span><span class="sxs-lookup"><span data-stu-id="c24a4-144">**Windows Vista**: The **Clock** check box in the **Notification Area** page of the **Taskbar and Start Menu** properties window.</span></span>
-   <span data-ttu-id="c24a4-145">**Windows XP**: la casella di controllo **Mostra Clock** nella finestra **delle proprietà della barra delle applicazioni e del menu Start** .</span><span class="sxs-lookup"><span data-stu-id="c24a4-145">**Windows XP**: The **Show the clock** check box in the **Taskbar and Start Menu** properties window.</span></span>

<span data-ttu-id="c24a4-146">È possibile fare clic con il pulsante destro del mouse sulla barra delle applicazioni per visualizzare il menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="c24a4-146">The user can right-click the taskbar to display the shortcut menu.</span></span> <span data-ttu-id="c24a4-147">Nel menu di scelta rapida sono inclusi i comandi per le finestre a cascata, le finestre dello stack, le finestre affiancate, il desktop, avviare Gestione attività e impostare le proprietà della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-147">The shortcut menu includes commands to cascade windows, stack windows, show windows side-by-side, show the desktop, start Task Manager, and set taskbar properties.</span></span> <span data-ttu-id="c24a4-148">Nel menu di scelta rapida è inoltre disponibile l'opzione per aggiungere o rimuovere un set di barre degli strumenti dalla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-148">The shortcut menu also provides the option to add or remove a set of toolbars from the taskbar.</span></span> <span data-ttu-id="c24a4-149">È possibile aggiungere nuove barre degli strumenti a questo menu eseguendone la registrazione nella categoria CATId \_ deskband.</span><span class="sxs-lookup"><span data-stu-id="c24a4-149">You can add new toolbars to this menu by registering them under the CATID\_DeskBand category.</span></span> <span data-ttu-id="c24a4-150">Per altre informazioni, vedere [implementazione di oggetti banda](band-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-150">For more information, see [Implementing Band Objects](band-objects.md).</span></span> <span data-ttu-id="c24a4-151">Si noti che, a partire da Windows 7, la barra delle applicazioni e l'area di notifica dispongono di menu di scelta rapida distinti.</span><span class="sxs-lookup"><span data-stu-id="c24a4-151">Note that as of Windows 7, the taskbar and the notification area have separate shortcut menus.</span></span> <span data-ttu-id="c24a4-152">Questi menu di scelta rapida condividono alcune opzioni, ad esempio la disposizione della finestra, e ne aggiungono altre.</span><span class="sxs-lookup"><span data-stu-id="c24a4-152">These shortcut menus share some options, such as window arrangement, and add others.</span></span>

### <a name="taskbar-display-options"></a><span data-ttu-id="c24a4-153">Opzioni di visualizzazione della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-153">Taskbar Display Options</span></span>

<span data-ttu-id="c24a4-154">La barra delle applicazioni supporta due opzioni di visualizzazione: Nascondi automaticamente e, solo in Windows Vista e versioni precedenti, Always On Top (la barra delle applicazioni è sempre in questa modalità in Windows 7 e versioni successive).</span><span class="sxs-lookup"><span data-stu-id="c24a4-154">The taskbar supports two display options: Auto-Hide and, in Windows Vista and earlier only, Always On Top (the taskbar is always in this mode in Windows 7 and later).</span></span> <span data-ttu-id="c24a4-155">Per impostare queste opzioni, l'utente deve aprire il menu di scelta rapida della barra delle applicazioni, fare clic su **Proprietà** e selezionare o deselezionare la casella di controllo **Nascondi automaticamente la barra delle applicazioni** o **Mantieni la barra delle applicazioni su altre finestre** .</span><span class="sxs-lookup"><span data-stu-id="c24a4-155">To set these options, the user must open the taskbar shortcut menu, click **Properties**, and select or clear the **Auto-hide the taskbar** check box or the **Keep the taskbar on top of other windows** check box.</span></span> <span data-ttu-id="c24a4-156">Per recuperare lo stato di queste opzioni di visualizzazione, utilizzare il messaggio [**ABM \_ GetState**](abm-getstate.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-156">To retrieve the state of these display options, use the [**ABM\_GETSTATE**](abm-getstate.md) message.</span></span> <span data-ttu-id="c24a4-157">Se si desidera ricevere una notifica quando lo stato di queste opzioni di visualizzazione cambia, elaborare il messaggio di notifica [**\_ STATECHANGE di ABN**](abn-statechange.md) nella routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="c24a4-157">If you would like to be notified when the state of these display options changes, process the [**ABN\_STATECHANGE**](abn-statechange.md) notification message in your window procedure.</span></span> <span data-ttu-id="c24a4-158">Per modificare lo stato di queste opzioni di visualizzazione, utilizzare il messaggio di [**\_ stato ABM**](abm-setstate.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-158">To change the state of these display options, use the [**ABM\_SETSTATE**](abm-setstate.md) message.</span></span>

<span data-ttu-id="c24a4-159">L' *area di lavoro* è la parte dello schermo non nascosta dalla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-159">The *work area* is the portion of the screen not obscured by the taskbar.</span></span> <span data-ttu-id="c24a4-160">Per recuperare le dimensioni dell'area di lavoro, chiamare la funzione [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) con il valore **SPI \_ GETWORKAREA** impostato.</span><span class="sxs-lookup"><span data-stu-id="c24a4-160">To retrieve the size of the work area, call the [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) function with the **SPI\_GETWORKAREA** value set.</span></span> <span data-ttu-id="c24a4-161">Per recuperare le coordinate del rettangolo che descrivono la posizione della barra delle applicazioni, utilizzare il messaggio [**\_ GETTASKBARPOS di ABM**](abm-gettaskbarpos.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-161">To retrieve the rectangle coordinates that describe the location of the taskbar, use the [**ABM\_GETTASKBARPOS**](abm-gettaskbarpos.md) message.</span></span>

<span data-ttu-id="c24a4-162">È possibile coprire la barra delle applicazioni impostando in modo esplicito le dimensioni del rettangolo della finestra uguale alla dimensione dello schermo con [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span><span class="sxs-lookup"><span data-stu-id="c24a4-162">It is possible to cover the taskbar by explicitly setting the size of the window rectangle equal to the size of the screen with [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span></span> <span data-ttu-id="c24a4-163">Per i sistemi Windows 2000 o versioni successive, la finestra non deve avere [**WS \_ Caption**](../winmsg/window-styles.md) o [**WS \_ THICKFRAME**](../winmsg/window-styles.md). in caso contrario, la finestra deve essere ridimensionata in modo che l'area client copra l'intero schermo.</span><span class="sxs-lookup"><span data-stu-id="c24a4-163">For Windows 2000 systems or later, the window must lack either [**WS\_CAPTION**](../winmsg/window-styles.md) or [**WS\_THICKFRAME**](../winmsg/window-styles.md), or else the window must be sized so that the client area covers the entire screen.</span></span> <span data-ttu-id="c24a4-164">Inoltre, in particolare, se la barra delle applicazioni è impostata su Always On Top, rimarrà nascosta solo mentre l'applicazione è l'applicazione in primo piano.</span><span class="sxs-lookup"><span data-stu-id="c24a4-164">Also particular to those systems, if the taskbar is set to Always On Top, it will remain hidden only while the application is the foreground application.</span></span>

### <a name="adding-shortcuts-to-the-start-menu"></a><span data-ttu-id="c24a4-165">Aggiunta di collegamenti al menu Start</span><span class="sxs-lookup"><span data-stu-id="c24a4-165">Adding Shortcuts to the Start Menu</span></span>

<span data-ttu-id="c24a4-166">Per aggiungere un elemento al sottomenu **programmi** in Microsoft windows NT 4,0, Windows 2000 e versioni successive o Windows 95 o versione successiva, attenersi alla seguente procedura.</span><span class="sxs-lookup"><span data-stu-id="c24a4-166">To add an item to the **Programs** submenu on Microsoft Windows NT 4.0, Windows 2000 and later, or Windows 95 or later, follow these steps.</span></span>

1.  <span data-ttu-id="c24a4-167">Creare un [collegamento della shell](./links.md) usando l'interfaccia [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-167">Create a [shell link](./links.md) by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface.</span></span>
2.  <span data-ttu-id="c24a4-168">Ottenere il PIDL della cartella programmi usando [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passando i [**\_ programmi CSIDL**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-168">Obtain the PIDL of the Programs folder by using [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passing [**CSIDL\_PROGRAMS**](csidl.md).</span></span>
3.  <span data-ttu-id="c24a4-169">Aggiungere il collegamento della shell alla cartella programmi.</span><span class="sxs-lookup"><span data-stu-id="c24a4-169">Add the Shell link to the Programs folder.</span></span> <span data-ttu-id="c24a4-170">È anche possibile creare una cartella nella cartella programmi e aggiungere il collegamento a tale cartella.</span><span class="sxs-lookup"><span data-stu-id="c24a4-170">You can also create a folder in the Programs folder and add the link to that folder.</span></span>

### <a name="managing-taskbar-buttons"></a><span data-ttu-id="c24a4-171">Gestione dei pulsanti della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-171">Managing Taskbar Buttons</span></span>

<span data-ttu-id="c24a4-172">La shell crea un pulsante sulla barra delle applicazioni ogni volta che un'applicazione crea una finestra che non è di proprietà.</span><span class="sxs-lookup"><span data-stu-id="c24a4-172">The Shell creates a button on the taskbar whenever an application creates a window that isn't owned.</span></span> <span data-ttu-id="c24a4-173">Per assicurarsi che il pulsante finestra venga inserito sulla barra delle applicazioni, creare una finestra senza proprietario con lo stile esteso [**WS \_ \_ AppWindow**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-173">To ensure that the window button is placed on the taskbar, create an unowned window with the [**WS\_EX\_APPWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="c24a4-174">Per evitare che il pulsante della finestra venga inserito sulla barra delle applicazioni, creare la finestra senza proprietario con lo stile esteso [**WS \_ \_ TOOLWINDOW**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-174">To prevent the window button from being placed on the taskbar, create the unowned window with the [**WS\_EX\_TOOLWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="c24a4-175">In alternativa, è possibile creare una finestra nascosta e rendere questa finestra nascosta il proprietario della finestra visibile.</span><span class="sxs-lookup"><span data-stu-id="c24a4-175">As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.</span></span>

<span data-ttu-id="c24a4-176">La shell rimuoverà il pulsante di una finestra dalla barra delle applicazioni solo se lo stile della finestra supporta i pulsanti della barra delle applicazioni visibile.</span><span class="sxs-lookup"><span data-stu-id="c24a4-176">The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons.</span></span> <span data-ttu-id="c24a4-177">Per modificare in modo dinamico lo stile di una finestra che non supporta i pulsanti della barra delle applicazioni visibili, è necessario nascondere prima la finestra (chiamando [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) con il **pulsante \_ Nascondi di SW**), modificare lo stile della finestra e quindi visualizzare la finestra.</span><span class="sxs-lookup"><span data-stu-id="c24a4-177">If you want to dynamically change a window's style to one that does not support visible taskbar buttons, you must hide the window first (by calling [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) with **SW\_HIDE**), change the window style, and then show the window.</span></span>

<span data-ttu-id="c24a4-178">Il pulsante finestra contiene in genere l'icona e il titolo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c24a4-178">The window button typically contains the application icon and title.</span></span> <span data-ttu-id="c24a4-179">Tuttavia, se l'applicazione non contiene un menu di sistema, il pulsante della finestra viene creato senza l'icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-179">However, if the application does not contain a system menu, the window button is created without the icon.</span></span>

<span data-ttu-id="c24a4-180">Se si desidera che l'applicazione ottenga l'attenzione dell'utente quando la finestra non è attiva, utilizzare la funzione [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) per indicare all'utente che un messaggio è in attesa.</span><span class="sxs-lookup"><span data-stu-id="c24a4-180">If you want your application to get the user's attention when the window is not active, use the [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) function to let the user know that a message is waiting.</span></span> <span data-ttu-id="c24a4-181">Questa funzione lampeggia il pulsante della finestra.</span><span class="sxs-lookup"><span data-stu-id="c24a4-181">This function flashes the window button.</span></span> <span data-ttu-id="c24a4-182">Quando l'utente fa clic sul pulsante della finestra per attivare la finestra, l'applicazione può visualizzare il messaggio.</span><span class="sxs-lookup"><span data-stu-id="c24a4-182">Once the user clicks the window button to activate the window, your application can display the message.</span></span>

### <a name="modifying-the-contents-of-the-taskbar"></a><span data-ttu-id="c24a4-183">Modifica del contenuto della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-183">Modifying the Contents of the Taskbar</span></span>

<span data-ttu-id="c24a4-184">La [versione 4,71 e successive](versions.md) di Shell32.dll aggiunge la funzionalità per modificare il contenuto della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-184">[Version 4.71 and later](versions.md) of Shell32.dll adds the capability to modify the contents of the taskbar.</span></span> <span data-ttu-id="c24a4-185">Da un'applicazione, ora è possibile aggiungere, rimuovere e attivare i pulsanti della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-185">From an application, you can now add, remove, and activate taskbar buttons.</span></span> <span data-ttu-id="c24a4-186">L'attivazione dell'elemento non attiva la finestra; Mostra l'elemento premuto sulla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-186">Activating the item does not activate the window; it shows the item as pressed on the taskbar.</span></span>

<span data-ttu-id="c24a4-187">Le funzionalità di modifica della barra delle applicazioni sono implementate in un oggetto Component Object Model (COM) (la \_ barra delle applicazioni CLSID) che espone l'interfaccia [**ITASKBARLIST**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) (IID \_ ITaskbarList).</span><span class="sxs-lookup"><span data-stu-id="c24a4-187">The taskbar modification capabilities are implemented in a Component Object Model (COM) object (CLSID\_TaskbarList ) that exposes the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface (IID\_ITaskbarList).</span></span> <span data-ttu-id="c24a4-188">È necessario chiamare il metodo [**ITaskbarList:: HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) per inizializzare l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c24a4-188">You must call the [**ITaskbarList::HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) method to initialize the object.</span></span> <span data-ttu-id="c24a4-189">È quindi possibile usare i metodi dell'interfaccia [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) per modificare il contenuto della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-189">You can then use the methods of the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface to modify the contents of the taskbar.</span></span>

### <a name="adding-modifying-and-deleting-icons-in-the-notification-area"></a><span data-ttu-id="c24a4-190">Aggiunta, modifica ed eliminazione di icone nell'area di notifica</span><span class="sxs-lookup"><span data-stu-id="c24a4-190">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>

<span data-ttu-id="c24a4-191">Utilizzare la [**funzione \_ NotifyIcon della shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) per aggiungere, modificare o eliminare icone dall'area di notifica.</span><span class="sxs-lookup"><span data-stu-id="c24a4-191">Use the [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) function to add, modify, or delete icons from the notification area.</span></span> <span data-ttu-id="c24a4-192">Il parametro *dwMessage* della **Shell \_ NotifyIcon** è un messaggio alla barra delle applicazioni che specifica l'azione da intraprendere.</span><span class="sxs-lookup"><span data-stu-id="c24a4-192">The *dwMessage* parameter of **Shell\_NotifyIcon** is a message to the taskbar that specifies the action to be taken.</span></span> <span data-ttu-id="c24a4-193">Il parametro *PNid* è un puntatore a una struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) utilizzata per identificare l'icona e passare eventuali informazioni aggiuntive necessarie per l'elaborazione del messaggio da parte del sistema.</span><span class="sxs-lookup"><span data-stu-id="c24a4-193">The *pnid* parameter is a pointer to a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure that is used to identify the icon and pass any additional information that is needed for the system to process the message.</span></span>

<span data-ttu-id="c24a4-194">Con le icone dell'area di notifica è possibile eseguire le azioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="c24a4-194">You can perform the following actions with notification area icons.</span></span>

-   <span data-ttu-id="c24a4-195">Per aggiungere un'icona all'area di notifica della barra delle applicazioni, chiamare la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con il parametro *dwMessage* impostato su NIM \_ Add.</span><span class="sxs-lookup"><span data-stu-id="c24a4-195">To add an icon to the taskbar's notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_ADD.</span></span> <span data-ttu-id="c24a4-196">La struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) viene utilizzata per specificare l'handle e l'identificatore dell'icona e qualsiasi testo della descrizione comando.</span><span class="sxs-lookup"><span data-stu-id="c24a4-196">The [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure is used to specify the icon's handle and identifier, and any tooltip text.</span></span> <span data-ttu-id="c24a4-197">Se l'utente ha selezionato la casella di controllo **Mostra Clock** nelle proprietà della barra delle applicazioni, il sistema posiziona l'icona sulla sinistra del clock.</span><span class="sxs-lookup"><span data-stu-id="c24a4-197">If the user has selected the **Show Clock** check box in the taskbar properties, the system places the icon to the immediate left of the clock.</span></span> <span data-ttu-id="c24a4-198">In caso contrario, l'icona viene visualizzata sul lato destro o nella parte inferiore della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-198">Otherwise, the icon appears on the right side or at the bottom of the taskbar.</span></span> <span data-ttu-id="c24a4-199">Qualsiasi icona esistente viene spostata a sinistra per fare spazio per la nuova icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-199">Any existing icons are shifted to the left to make room for the new icon.</span></span>
-   <span data-ttu-id="c24a4-200">Per modificare le informazioni di un'icona, inclusi il relativo handle di icona, il testo della descrizione comando e l'identificatore del messaggio di callback, chiamare la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con *dwMessage* impostata su NIM \_ Modify.</span><span class="sxs-lookup"><span data-stu-id="c24a4-200">To modify an icon's information, including its icon handle, tooltip text, and callback message identifier, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_MODIFY.</span></span>
-   <span data-ttu-id="c24a4-201">Per eliminare un'icona dall'area di notifica, chiamare la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con il parametro *dwMessage* impostato su NIM \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="c24a4-201">To delete an icon from the notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_DELETE.</span></span>

<span data-ttu-id="c24a4-202">Al termine di un'operazione dell'interfaccia utente, restituire lo stato attivo all'area di notifica chiamando la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con *DWMESSAGE* impostato su NIM \_ SetFocus.</span><span class="sxs-lookup"><span data-stu-id="c24a4-202">When you have completed a user interface operation, return focus to the notification area by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_SETFOCUS.</span></span> <span data-ttu-id="c24a4-203">Ad esempio, è possibile eseguire questa operazione quando un'icona della barra delle applicazioni Visualizza un menu di scelta rapida, ma l'utente lo annulla premendo il tasto ESC.</span><span class="sxs-lookup"><span data-stu-id="c24a4-203">For example, you could do this when a taskbar icon displays a shortcut menu, but the user cancels it by pressing the ESCAPE key.</span></span>

### <a name="receiving-notification-area-callback-messages"></a><span data-ttu-id="c24a4-204">Ricezione di messaggi di callback dell'area di notifica</span><span class="sxs-lookup"><span data-stu-id="c24a4-204">Receiving Notification Area Callback Messages</span></span>

<span data-ttu-id="c24a4-205">Le applicazioni in genere inseriscono icone nell'area di notifica della barra delle applicazioni per fungere da indicatori di stato.</span><span class="sxs-lookup"><span data-stu-id="c24a4-205">Applications commonly put icons in the notification area of the taskbar to serve as status indicators.</span></span> <span data-ttu-id="c24a4-206">È possibile fornire informazioni aggiuntive quando l'utente esegue le azioni del mouse, ad esempio lo spostamento del puntatore del mouse sull'icona o il clic sull'icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-206">You can provide additional information when the user performs mouse actions, such as moving the mouse pointer over the icon or clicking the icon.</span></span>

<span data-ttu-id="c24a4-207">Il sistema invia notifiche agli eventi del mouse e della tastiera inviando un messaggio di callback definito dall'applicazione associato a una particolare icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-207">The system notifies you of mouse and keyboard events by sending an application-defined callback message that is associated with a particular icon.</span></span> <span data-ttu-id="c24a4-208">In questo modo, il sistema può notificare a un'applicazione quando l'utente, ad esempio, fa clic sull'icona o la seleziona premendo un tasto.</span><span class="sxs-lookup"><span data-stu-id="c24a4-208">In this way, the system can notify an application when the user, for instance, clicks the icon or selects it by pressing a key.</span></span>

<span data-ttu-id="c24a4-209">Si definisce il messaggio di callback di un'icona quando si aggiunge l'icona alla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-209">You define an icon's callback message when you add the icon to the taskbar.</span></span> <span data-ttu-id="c24a4-210">L'identificatore del messaggio di callback viene specificato nel membro **uCallbackMessage** della struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) passata con Nim \_ Add.</span><span class="sxs-lookup"><span data-stu-id="c24a4-210">The callback message identifier is specified in the **uCallbackMessage** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure passed with NIM\_ADD.</span></span> <span data-ttu-id="c24a4-211">Quando si verifica un evento, il sistema invia il messaggio di callback alla routine della finestra specificata dal membro **HWND** .</span><span class="sxs-lookup"><span data-stu-id="c24a4-211">When an event occurs, the system sends the callback message to the window procedure of the window specified by the **hWnd** member.</span></span> <span data-ttu-id="c24a4-212">Il parametro *wParam* del messaggio contiene l'identificatore dell'icona della barra delle applicazioni in cui si è verificato l'evento.</span><span class="sxs-lookup"><span data-stu-id="c24a4-212">The *wParam* parameter of the message contains the identifier of the taskbar icon in which the event occurred.</span></span> <span data-ttu-id="c24a4-213">Il parametro *lParam* include il mouse o il messaggio della tastiera associato all'evento.</span><span class="sxs-lookup"><span data-stu-id="c24a4-213">The *lParam* parameter holds the mouse or keyboard message associated with the event.</span></span> <span data-ttu-id="c24a4-214">Ad esempio, quando il puntatore del mouse si sposta su un'icona della barra delle applicazioni, *lParam* contiene [**WM \_ MOUSEMOVE**](../inputdev/wm-mousemove.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-214">For example, when the mouse pointer moves onto a taskbar icon, *lParam* contains [**WM\_MOUSEMOVE**](../inputdev/wm-mousemove.md).</span></span>

<span data-ttu-id="c24a4-215">I risultati di diversi eventi del mouse possono essere riepilogati come segue:</span><span class="sxs-lookup"><span data-stu-id="c24a4-215">The results of various mouse events can be summarized as follows:</span></span>

-   <span data-ttu-id="c24a4-216">Quando l'utente sposta il puntatore del mouse sull'icona, il sistema Visualizza il testo della descrizione comando specificato in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span><span class="sxs-lookup"><span data-stu-id="c24a4-216">When the user moves the mouse pointer over the icon, the system displays the tooltip text that was specified in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span></span>
-   <span data-ttu-id="c24a4-217">Quando l'utente fa clic sull'icona, l'applicazione riceve una notifica [**\_ LBUTTONDOWN WM**](../inputdev/wm-lbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-217">When the user clicks the icon, your application receives a [**WM\_LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) notification.</span></span>
-   <span data-ttu-id="c24a4-218">Quando l'utente fa clic con il pulsante destro del mouse sull'icona, l'applicazione riceve una notifica [**\_ RBUTTONDOWN WM**](../inputdev/wm-rbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-218">When the user right-clicks the icon, your application receives a [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) notification.</span></span>
-   <span data-ttu-id="c24a4-219">Quando l'utente fa doppio clic sull'icona, l'applicazione riceve una [**notifica \_ LBUTTONDBLCLK WM**](../inputdev/wm-lbuttondblclk.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-219">When the user double-clicks the icon, your application receives a [**WM\_LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) notification.</span></span>

<span data-ttu-id="c24a4-220">In genere, facendo clic sull'icona si fa in modo che l'applicazione visualizzi una finestra con ulteriori informazioni, facendo clic con il pulsante destro del mouse sul menu di scelta rapida e scegliendo Esegui il comando di menu di scelta rapida predefinito.</span><span class="sxs-lookup"><span data-stu-id="c24a4-220">Typically, clicking the icon causes the application to display a window with additional information, right-clicking displays a shortcut menu, and double-clicking executes the default shortcut menu command.</span></span>

<span data-ttu-id="c24a4-221">Per un esempio di come modificare il testo della descrizione comando associato a un'icona dell'area di notifica, vedere le [descrizioni comandi dei fumetti per le icone della barra di stato](../controls/tooltip-controls.md).</span><span class="sxs-lookup"><span data-stu-id="c24a4-221">For an example of how to change the tooltip text associated with a notification area icon, see [Balloon Tooltips for Status Bar Icons](../controls/tooltip-controls.md).</span></span>

<span data-ttu-id="c24a4-222">Le versioni 5,0 e successive della shell gestiscono gli eventi del mouse e della tastiera [**\_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) della shell in modi diversi rispetto alle versioni precedenti della shell presenti in Windows NT 4,0, Windows 95 e Windows 98.</span><span class="sxs-lookup"><span data-stu-id="c24a4-222">Versions 5.0 and later of the Shell handle [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) mouse and keyboard events in different ways than earlier Shell versions found on Windows NT 4.0, Windows 95, and Windows 98.</span></span> <span data-ttu-id="c24a4-223">Le differenze sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="c24a4-223">The differences are as follows:</span></span>

-   <span data-ttu-id="c24a4-224">Se un utente richiede il menu di scelta rapida di un'icona di notifica con la tastiera, la shell versione 5,0 invia all'applicazione associata un messaggio [**WM \_ ContextMenu**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-224">If a user requests a notify icon's shortcut menu with the keyboard, the version 5.0 Shell sends the associated application a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message.</span></span> <span data-ttu-id="c24a4-225">Le versioni precedenti inviano messaggi [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-225">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c24a4-226">Se un utente seleziona un'icona di notifica con la tastiera e la attiva con la barra spaziatrice o il tasto invio, la shell della versione 5,0 invia all'applicazione associata una notifica di **\_ selezione** della chiave Nin.</span><span class="sxs-lookup"><span data-stu-id="c24a4-226">If a user selects a notify icon with the keyboard and activates it with the space bar or ENTER key, the version 5.0 Shell sends the associated application an **NIN\_KEYSELECT** notification.</span></span> <span data-ttu-id="c24a4-227">Le versioni precedenti inviano messaggi [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-227">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c24a4-228">Se un utente seleziona un'icona di notifica con il mouse e la attiva con il tasto invio, la shell della versione 5,0 invia all'applicazione associata una notifica **\_ Select Nin** .</span><span class="sxs-lookup"><span data-stu-id="c24a4-228">If a user selects a notify icon with the mouse and activates it with the ENTER key, the version 5.0 Shell sends the associated application an **NIN\_SELECT** notification.</span></span> <span data-ttu-id="c24a4-229">Le versioni precedenti inviano messaggi [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c24a4-229">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c24a4-230">Se un utente passa il puntatore del mouse su un'icona a cui è associata una descrizione comandi a fumetto, la versione 6,0 della shell (Windows XP) Invia i messaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="c24a4-230">If a user passes the mouse pointer over an icon with which a balloon tooltip is associated, the version 6.0 Shell (Windows XP)sends the following messages.</span></span>
    -   -   <span data-ttu-id="c24a4-231">**Nin \_ BALLOONSHOW** : inviato quando viene visualizzato il fumetto (i palloni vengono accodati).</span><span class="sxs-lookup"><span data-stu-id="c24a4-231">**NIN\_BALLOONSHOW** - Sent when the balloon is shown (balloons are queued).</span></span>
        -   <span data-ttu-id="c24a4-232">**Nin \_ BALLOONHIDE** : inviato quando il fumetto scompare, ad esempio quando l'icona viene eliminata.</span><span class="sxs-lookup"><span data-stu-id="c24a4-232">**NIN\_BALLOONHIDE** - Sent when the balloon disappears—for example, when the icon is deleted.</span></span> <span data-ttu-id="c24a4-233">Questo messaggio non viene inviato se il fumetto viene eliminato a causa di un timeout o di un clic del mouse.</span><span class="sxs-lookup"><span data-stu-id="c24a4-233">This message is not sent if the balloon is dismissed because of a timeout or a mouse click.</span></span>
        -   <span data-ttu-id="c24a4-234">**Nin \_ BALLOONTIMEOUT** : inviato quando il fumetto viene eliminato a causa di un timeout.</span><span class="sxs-lookup"><span data-stu-id="c24a4-234">**NIN\_BALLOONTIMEOUT** - Sent when the balloon is dismissed because of a timeout.</span></span>
        -   <span data-ttu-id="c24a4-235">**Nin \_ BALLOONUSERCLICK** : inviato quando il fumetto viene eliminato a causa di un clic del mouse.</span><span class="sxs-lookup"><span data-stu-id="c24a4-235">**NIN\_BALLOONUSERCLICK** - Sent when the balloon is dismissed because of a mouse click.</span></span>

<span data-ttu-id="c24a4-236">È possibile selezionare il modo in cui la shell deve comportarsi chiamando la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con *dwMessage* impostato su **NIM \_ seversion**.</span><span class="sxs-lookup"><span data-stu-id="c24a4-236">You can select which way the Shell should behave by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_SETVERSION**.</span></span> <span data-ttu-id="c24a4-237">Impostare il membro **uVersion** della struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) per indicare se si desidera la versione 5,0 o il comportamento precedente alla versione 5,0.</span><span class="sxs-lookup"><span data-stu-id="c24a4-237">Set the **uVersion** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure to indicate whether you want version 5.0 or pre-version 5.0 behavior.</span></span>

### <a name="taskbar-creation-notification"></a><span data-ttu-id="c24a4-238">Notifica di creazione della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-238">Taskbar Creation Notification</span></span>

<span data-ttu-id="c24a4-239">Con Microsoft Internet Explorer 4,0 e versioni successive, la shell notifica alle applicazioni che la barra delle applicazioni è stata creata.</span><span class="sxs-lookup"><span data-stu-id="c24a4-239">With Microsoft Internet Explorer 4.0 and later, the Shell notifies applications that the taskbar has been created.</span></span> <span data-ttu-id="c24a4-240">Quando viene creata la barra delle applicazioni, viene registrato un messaggio con la stringa TaskbarCreated e il messaggio viene trasmesso a tutte le finestre di primo livello.</span><span class="sxs-lookup"><span data-stu-id="c24a4-240">When the taskbar is created, it registers a message with the TaskbarCreated string and then broadcasts this message to all top-level windows.</span></span> <span data-ttu-id="c24a4-241">Quando l'applicazione della barra delle applicazioni riceve questo messaggio, è necessario presupporre che tutte le icone della barra delle applicazioni aggiunte siano state rimosse e aggiungerle nuovamente.</span><span class="sxs-lookup"><span data-stu-id="c24a4-241">When your taskbar application receives this message, it should assume that any taskbar icons it added have been removed and add them again.</span></span> <span data-ttu-id="c24a4-242">Questa funzionalità viene in genere applicata solo ai servizi già in esecuzione all'avvio della shell.</span><span class="sxs-lookup"><span data-stu-id="c24a4-242">This feature generally applies only to services that are already running when the Shell launches.</span></span> <span data-ttu-id="c24a4-243">Nell'esempio seguente viene illustrato un metodo molto semplificato per la gestione di questo caso.</span><span class="sxs-lookup"><span data-stu-id="c24a4-243">The following example shows a very simplified method for handling this case.</span></span>

<span data-ttu-id="c24a4-244">In Windows 10 la barra delle applicazioni trasmette anche questo messaggio quando viene modificato il valore DPI dello schermo principale.</span><span class="sxs-lookup"><span data-stu-id="c24a4-244">On Windows 10, the taskbar also broadcasts this message when the DPI of the primary display changes.</span></span>

```
LRESULT CALLBACK WndProc(HWND hWnd, 
                         UINT uMessage, 
                         WPARAM wParam, 
                         LPARAM lParam)
{
    static UINT s_uTaskbarRestart;

    switch(uMessage)
    {
        case WM_CREATE:
            s_uTaskbarRestart = RegisterWindowMessage(TEXT("TaskbarCreated"));
            break;
        
        default:
            if(uMessage == s_uTaskbarRestart)
                AddTaskbarIcons();
            break;
    }

    return DefWindowProc(hWnd, uMessage, wParam, lParam);
}
```



## <a name="using-the-taskbar"></a><span data-ttu-id="c24a4-245">Uso della barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="c24a4-245">Using the Taskbar</span></span>

<span data-ttu-id="c24a4-246">Questa sezione include esempi che illustrano come aggiungere icone all'area di notifica della barra delle applicazioni e come elaborare i messaggi di callback per le icone della barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-246">This section includes examples that demonstrate how to add icons to the taskbar notification area and how to process callback messages for taskbar icons.</span></span>

### <a name="adding-and-deleting-taskbar-icons-in-the-notification-area"></a><span data-ttu-id="c24a4-247">Aggiunta ed eliminazione delle icone delle barre degli strumenti nell'area di notifica</span><span class="sxs-lookup"><span data-stu-id="c24a4-247">Adding and Deleting Taskbar Icons in the Notification Area</span></span>

<span data-ttu-id="c24a4-248">Per aggiungere un'icona all'area di notifica della barra delle applicazioni, compilare una struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) e quindi passare la struttura a [**\_ NotifyIcon della shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con *dwMessage* impostato su **NIM \_ Add**.</span><span class="sxs-lookup"><span data-stu-id="c24a4-248">You add an icon to the taskbar notification area by filling in a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and then passing the structure to [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_ADD**.</span></span> <span data-ttu-id="c24a4-249">I membri della struttura devono specificare l'handle per la finestra che aggiunge l'icona, nonché l'identificatore dell'icona e l'handle dell'icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-249">The structure members must specify the handle to the window that is adding the icon, as well as the icon identifier and icon handle.</span></span> <span data-ttu-id="c24a4-250">È anche possibile specificare il testo della descrizione comando per l'icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-250">You can also specify tooltip text for the icon.</span></span> <span data-ttu-id="c24a4-251">Se è necessario ricevere i messaggi del mouse per l'icona, specificare l'identificatore del messaggio di callback che il sistema deve usare per inviare il messaggio alla routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="c24a4-251">If you need to receive mouse messages for the icon, specify the identifier of the callback message that the system should use to send the message to the window procedure.</span></span>

<span data-ttu-id="c24a4-252">La funzione nell'esempio seguente illustra come aggiungere un'icona alla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-252">The function in the following example demonstrates how to add an icon to the taskbar.</span></span>


```
// MyTaskBarAddIcon - adds an icon to the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window to receive callback messages 
// uID - identifier of the icon 
// hicon - handle to the icon to add 
// lpszTip - tooltip text 

BOOL MyTaskBarAddIcon(HWND hwnd, UINT uID, HICON hicon, LPSTR lpszTip) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
    tnid.uFlags = NIF_MESSAGE | NIF_ICON | NIF_TIP; 
    tnid.uCallbackMessage = MYWM_NOTIFYICON; 
    tnid.hIcon = hicon; 
    if (lpszTip) 
        hr = StringCbCopyN(tnid.szTip, sizeof(tnid.szTip), lpszTip, 
                           sizeof(tnid.szTip));
        // TODO: Add error handling for the HRESULT.
    else 
        tnid.szTip[0] = (TCHAR)'\0'; 
 
    res = Shell_NotifyIcon(NIM_ADD, &tnid); 
 
    if (hicon) 
        DestroyIcon(hicon); 
 
    return res; 
}
```



<span data-ttu-id="c24a4-253">Per eliminare un'icona dall'area di notifica della barra delle applicazioni, compilare una struttura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) e chiamare la [**Shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) con *dwMessage* impostato su **NIM \_ Delete**.</span><span class="sxs-lookup"><span data-stu-id="c24a4-253">To delete an icon from the taskbar notification area, fill a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_DELETE**.</span></span> <span data-ttu-id="c24a4-254">Quando si elimina un'icona della barra delle applicazioni, specificare solo i membri **cbSize**, **HWND** e **uID** della struttura.</span><span class="sxs-lookup"><span data-stu-id="c24a4-254">When deleting a taskbar icon, specify only the **cbSize**, **hWnd**, and **uID** members of the structure.</span></span> <span data-ttu-id="c24a4-255">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="c24a4-255">For example:</span></span>


```
// MyTaskBarDeleteIcon - deletes an icon from the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window that added the icon. 
// uID - identifier of the icon to delete. 

BOOL MyTaskBarDeleteIcon(HWND hwnd, UINT uID) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
         
    res = Shell_NotifyIcon(NIM_DELETE, &tnid); 
    return res; 
}
```



### <a name="receiving-mouse-events"></a><span data-ttu-id="c24a4-256">Ricezione di eventi del mouse</span><span class="sxs-lookup"><span data-stu-id="c24a4-256">Receiving Mouse Events</span></span>

<span data-ttu-id="c24a4-257">Se si specifica un messaggio di callback per un'icona della barra delle applicazioni, il sistema invia il messaggio all'applicazione ogni volta che si verifica un evento del mouse nel rettangolo di delimitazione dell'icona.</span><span class="sxs-lookup"><span data-stu-id="c24a4-257">If you specify a callback message for a taskbar icon, the system sends the message to your application whenever a mouse event occurs in the icon's bounding rectangle.</span></span> <span data-ttu-id="c24a4-258">Il parametro *wParam* del messaggio specifica l'identificatore dell'icona della barra delle applicazioni e il parametro *lParam* del messaggio specifica il messaggio generato dal sistema come risultato dell'evento del mouse.</span><span class="sxs-lookup"><span data-stu-id="c24a4-258">The *wParam* parameter of the message specifies the identifier of the taskbar icon, and the *lParam* parameter of the message specifies the message that the system generated as a result of the mouse event.</span></span>

<span data-ttu-id="c24a4-259">La funzione nell'esempio seguente è di un'applicazione che aggiunge le icone della batteria e della stampante alla barra delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c24a4-259">The function in the following example is from an application that adds both battery and printer icons to the taskbar.</span></span> <span data-ttu-id="c24a4-260">L'applicazione chiama la funzione quando riceve un messaggio di callback.</span><span class="sxs-lookup"><span data-stu-id="c24a4-260">The application calls the function when it receives a callback message.</span></span> <span data-ttu-id="c24a4-261">La funzione determina se l'utente ha fatto clic su una delle icone e, se si è verificato un clic, chiama una funzione definita dall'applicazione per visualizzare le informazioni sullo stato.</span><span class="sxs-lookup"><span data-stu-id="c24a4-261">The function determines whether the user has clicked one of the icons and, if a click has occurred, calls an application-defined function to display status information.</span></span>


```
// On_MYWM_NOTIFYICON - processes callback messages for taskbar icons. 
// wParam - first message parameter of the callback message. 
// lParam - second message parameter of the callback message. 

void On_MYWM_NOTIFYICON(WPARAM wParam, LPARAM lParam) 
{ 
    UINT uID; 
    UINT uMouseMsg; 
 
    uID = (UINT) wParam; 
    uMouseMsg = (UINT) lParam; 
 
    if (uMouseMsg == WM_LBUTTONDOWN) 
    { 
        switch (uID) 
        { 
            case IDI_MYBATTERYICON: 
 
                // The user clicked the battery icon. Display the 
                // battery status. 
                ShowBatteryStatus(); 
                break; 
 
            case IDI_MYPRINTERICON: 
 
                // The user clicked the printer icon. Display the 
                // status of the print job. 
                ShowJobStatus(); 
                break; 
 
            default: 
                break; 
        } 
     } 

     return; 
 }
```



 

 
