---
description: Molte applicazioni consentono agli utenti di trasferire i dati a un'altra applicazione trascinando i dati con il mouse o usando gli Appunti.
title: Trasferimento di oggetti Shell con trascinamento della selezione e degli Appunti
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979746"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="526a8-103">Trasferimento di oggetti Shell con trascinamento della selezione e degli Appunti</span><span class="sxs-lookup"><span data-stu-id="526a8-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="526a8-104">Molte applicazioni consentono agli utenti di trasferire i dati a un'altra applicazione trascinando i dati con il mouse o usando gli Appunti.</span><span class="sxs-lookup"><span data-stu-id="526a8-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="526a8-105">Tra i molti tipi di dati che possono essere trasferiti si trovano oggetti Shell, ad esempio file o cartelle.</span><span class="sxs-lookup"><span data-stu-id="526a8-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="526a8-106">Il trasferimento dei dati della shell può avvenire tra due applicazioni, ma gli utenti possono anche trasferire dati della shell da e verso il desktop o Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="526a8-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="526a8-107">Anche se i file sono l'oggetto Shell trasferito più di frequente, il trasferimento dei dati della shell può coinvolgere qualsiasi varietà di oggetti disponibili nello [spazio dei nomi della shell](namespace-intro.md).</span><span class="sxs-lookup"><span data-stu-id="526a8-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="526a8-108">Ad esempio, è possibile che l'applicazione debba trasferire un file in una cartella virtuale, ad esempio il Cestino, oppure accettare un oggetto da un'estensione dello spazio dei nomi non Microsoft.</span><span class="sxs-lookup"><span data-stu-id="526a8-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="526a8-109">Se si implementa un'estensione dello spazio dei nomi, è necessario che sia in grado di funzionare correttamente come origine di rilascio e destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="526a8-110">Questo documento illustra in che modo le applicazioni possono implementare trasferimenti di dati di trascinamento e appunti con oggetti Shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="526a8-111">Oggetto dati della shell</span><span class="sxs-lookup"><span data-stu-id="526a8-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="526a8-112">Formati degli Appunti della shell</span><span class="sxs-lookup"><span data-stu-id="526a8-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="526a8-113">Gestione di scenari di trasferimento dei dati shell</span><span class="sxs-lookup"><span data-stu-id="526a8-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="526a8-114">Funzionamento del trascinamento della selezione con gli oggetti Shell</span><span class="sxs-lookup"><span data-stu-id="526a8-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="526a8-115">Le applicazioni spesso devono fornire agli utenti un modo per trasferire i dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="526a8-116">Di seguito sono riportati alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="526a8-116">Some examples are:</span></span>

-   <span data-ttu-id="526a8-117">Trascinando un file da Esplora risorse o dal desktop e rilasciandolo in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="526a8-118">Copiare un file negli Appunti in Esplora risorse e incollarlo in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="526a8-119">Il trascinamento di un file da un'applicazione al Cestino.</span><span class="sxs-lookup"><span data-stu-id="526a8-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="526a8-120">Per una descrizione dettagliata di come gestire questi e altri scenari, vedere [gestione degli scenari di trasferimento dati della shell](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="526a8-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="526a8-121">Questo documento è incentrato sui principi generali alla base del trasferimento dei dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="526a8-122">In Windows sono disponibili due modalità standard per trasferire i dati della shell dalle applicazioni:</span><span class="sxs-lookup"><span data-stu-id="526a8-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="526a8-123">Un utente taglia o copia i dati della shell, ad esempio uno o più file, negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="526a8-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="526a8-124">L'altra applicazione recupera i dati dagli Appunti.</span><span class="sxs-lookup"><span data-stu-id="526a8-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="526a8-125">Un utente trascina un'icona che rappresenta i dati dell'applicazione di origine e rilascia l'icona in una finestra di proprietà della destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="526a8-126">In entrambi i casi, i dati trasferiti sono contenuti in un *oggetto dati*.</span><span class="sxs-lookup"><span data-stu-id="526a8-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="526a8-127">Gli oggetti dati sono oggetti Component Object Model (COM) che espongono l'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="526a8-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="526a8-128">Schematicamente, sono necessari tre passaggi essenziali che devono essere seguiti da tutti i trasferimenti di dati della shell:</span><span class="sxs-lookup"><span data-stu-id="526a8-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="526a8-129">L'origine crea un oggetto dati che rappresenta i dati da trasferire.</span><span class="sxs-lookup"><span data-stu-id="526a8-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="526a8-130">La destinazione riceve un puntatore all'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) dell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="526a8-131">La destinazione chiama l'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) per estrarre i dati da esso.</span><span class="sxs-lookup"><span data-stu-id="526a8-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="526a8-132">La differenza tra gli appunti e i trasferimenti di dati con trascinamento della selezione risiede principalmente nel modo in cui il puntatore [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) viene trasferito dall'origine alla destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="526a8-133">Trasferimenti di dati negli Appunti</span><span class="sxs-lookup"><span data-stu-id="526a8-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="526a8-134">Gli Appunti sono il modo più semplice per trasferire i dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="526a8-135">La procedura di base è simile ai trasferimenti di dati degli Appunti standard.</span><span class="sxs-lookup"><span data-stu-id="526a8-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="526a8-136">Tuttavia, poiché si trasferisce un puntatore a un oggetto dati, non ai dati stessi, è necessario utilizzare l'API degli Appunti OLE anziché l'API degli Appunti standard.</span><span class="sxs-lookup"><span data-stu-id="526a8-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="526a8-137">La procedura seguente illustra come usare l'API degli Appunti OLE per trasferire i dati della shell con gli Appunti:</span><span class="sxs-lookup"><span data-stu-id="526a8-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="526a8-138">L'origine dati consente di creare un oggetto dati per contenere i dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="526a8-139">L'origine dati chiama [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), che inserisce un puntatore all'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) dell'oggetto dati negli Appunti.</span><span class="sxs-lookup"><span data-stu-id="526a8-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="526a8-140">La destinazione chiama [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) per recuperare il puntatore all'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) dell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="526a8-141">La destinazione estrae i dati chiamando il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) .</span><span class="sxs-lookup"><span data-stu-id="526a8-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="526a8-142">Con alcuni trasferimenti di dati della shell, potrebbe essere necessario che la destinazione chiami anche il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) dell'oggetto dati per fornire commenti e suggerimenti all'oggetto dati sul risultato del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="526a8-143">Per un esempio di questo tipo di operazione, vedere [gestione delle operazioni di spostamento ottimizzate](datascenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="526a8-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="526a8-144">Trasferimenti di dati con trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="526a8-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="526a8-145">Sebbene un po' più complesso da implementare, il trasferimento dei dati con trascinamento della selezione presenta alcuni vantaggi significativi rispetto agli Appunti:</span><span class="sxs-lookup"><span data-stu-id="526a8-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="526a8-146">I trasferimenti con trascinamento della selezione possono essere eseguiti con un semplice movimento del mouse, rendendo l'operazione più flessibile e intuitiva da usare degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="526a8-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="526a8-147">Il trascinamento della selezione fornisce all'utente una rappresentazione visiva dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="526a8-148">L'utente può seguire l'icona mentre passa dall'origine alla destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="526a8-149">Il trascinamento della selezione Invia una notifica alla destinazione quando i dati sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="526a8-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="526a8-150">Anche le operazioni di trascinamento della selezione utilizzano oggetti dati per trasferire i dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="526a8-151">Tuttavia, l'origine di rilascio deve fornire funzionalità oltre a quelle richieste per i trasferimenti degli Appunti:</span><span class="sxs-lookup"><span data-stu-id="526a8-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="526a8-152">L'origine di rilascio deve anche creare un oggetto che espone un'interfaccia [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) .</span><span class="sxs-lookup"><span data-stu-id="526a8-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="526a8-153">Il sistema usa **IDropSource** per comunicare con l'origine mentre è in corso l'operazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="526a8-154">L'oggetto dati con trascinamento della selezione è responsabile del rilevamento del movimento del cursore e della visualizzazione di un'icona per rappresentare l'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="526a8-155">Le destinazioni di rilascio devono inoltre fornire più funzionalità rispetto a quelle necessarie per gestire i trasferimenti degli Appunti:</span><span class="sxs-lookup"><span data-stu-id="526a8-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="526a8-156">L'obiettivo di rilascio deve esporre un'interfaccia [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="526a8-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="526a8-157">Quando il cursore si trova su una finestra di destinazione, il sistema utilizza **IDropTarget** per fornire la destinazione con informazioni come la posizione del cursore e per notificarlo quando i dati vengono eliminati.</span><span class="sxs-lookup"><span data-stu-id="526a8-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="526a8-158">La destinazione di rilascio deve registrarsi con il sistema chiamando [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span><span class="sxs-lookup"><span data-stu-id="526a8-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="526a8-159">Questa funzione fornisce al sistema l'handle di una finestra di destinazione e un puntatore all'interfaccia [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) dell'applicazione di destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="526a8-160">Per le operazioni di trascinamento della selezione, l'applicazione deve inizializzare COM con [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), non [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span><span class="sxs-lookup"><span data-stu-id="526a8-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="526a8-161">La procedura seguente illustra i passaggi essenziali che vengono in genere usati per trasferire i dati della shell con il trascinamento della selezione:</span><span class="sxs-lookup"><span data-stu-id="526a8-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="526a8-162">La destinazione chiama [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) per fornire al sistema un puntatore all'interfaccia [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) e registrare una finestra come destinazione di rilascio.</span><span class="sxs-lookup"><span data-stu-id="526a8-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="526a8-163">Quando l'utente avvia un'operazione di trascinamento della selezione, l'origine crea un oggetto dati e avvia un *ciclo di trascinamento* chiamando [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span><span class="sxs-lookup"><span data-stu-id="526a8-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="526a8-164">Quando il cursore si trova sulla finestra di destinazione, il sistema invia una notifica alla destinazione chiamando uno dei metodi [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) della destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="526a8-165">Il sistema chiama [**IDropTarget::D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) quando il cursore entra nella finestra di destinazione e [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) quando il cursore passa sulla finestra di destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="526a8-166">Entrambi i metodi forniscono la destinazione di rilascio con la posizione corrente del cursore e lo stato dei tasti di modifica della tastiera, ad esempio CTRL o ALT.</span><span class="sxs-lookup"><span data-stu-id="526a8-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="526a8-167">Quando il cursore esce dalla finestra di destinazione, il sistema invia una notifica alla destinazione chiamando [**IDropTarget::D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span><span class="sxs-lookup"><span data-stu-id="526a8-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="526a8-168">Quando uno di questi metodi restituisce, il sistema chiama l'interfaccia [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) per passare il valore restituito all'origine.</span><span class="sxs-lookup"><span data-stu-id="526a8-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="526a8-169">Quando l'utente rilascia il pulsante del mouse per eliminare i dati, il sistema chiama il metodo [**IDropTarget::D por**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) della destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="526a8-170">Tra i parametri del metodo è presente un puntatore all'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) dell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="526a8-171">La destinazione chiama il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) dell'oggetto dati per estrarre i dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="526a8-172">Con alcuni trasferimenti di dati della shell, potrebbe essere necessario che la destinazione chiami anche il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) dell'oggetto dati per fornire commenti e suggerimenti all'origine sul risultato del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="526a8-173">Quando la destinazione termina con l'oggetto dati, viene restituito da [**IDropTarget::D por**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span><span class="sxs-lookup"><span data-stu-id="526a8-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="526a8-174">Il sistema restituisce la chiamata [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) dell'origine per notificare all'origine che il trasferimento dei dati è stato completato.</span><span class="sxs-lookup"><span data-stu-id="526a8-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="526a8-175">A seconda dello scenario di [trasferimento dei dati](datascenarios.md)specifico, è possibile che l'origine debba eseguire ulteriori azioni in base al valore restituito da [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) e ai valori passati all'oggetto dati dalla destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="526a8-176">Ad esempio, quando un file viene spostato, l'origine deve controllare questi valori per determinare se deve eliminare il file originale.</span><span class="sxs-lookup"><span data-stu-id="526a8-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="526a8-177">L'origine rilascia l'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-177">The source releases the data object.</span></span>

<span data-ttu-id="526a8-178">Sebbene le procedure descritte in precedenza forniscano un modello generale valido per il trasferimento dei dati della shell, esistono molti tipi diversi di dati che possono essere contenuti in un oggetto dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="526a8-179">Sono inoltre disponibili diversi scenari di trasferimento dei dati che possono essere gestiti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="526a8-180">Per ogni tipo di dati e scenario è necessario un approccio leggermente diverso a tre passaggi principali della procedura:</span><span class="sxs-lookup"><span data-stu-id="526a8-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="526a8-181">Il modo in cui un'origine costruisce un oggetto dati per contenere i dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="526a8-182">Modalità di estrazione dei dati della shell dall'oggetto dati da parte di una destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="526a8-183">Il modo in cui l'origine completa l'operazione di trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="526a8-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="526a8-184">L' [oggetto dati della shell](dataobject.md) fornisce una descrizione generale del modo in cui un'origine costruisce un oggetto dati della shell e in che modo l'oggetto dati può essere gestito dalla destinazione.</span><span class="sxs-lookup"><span data-stu-id="526a8-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="526a8-185">[Gestione degli scenari di trasferimento dati della shell](datascenarios.md) illustra in dettaglio come gestire diversi scenari comuni di trasferimento dei dati della shell.</span><span class="sxs-lookup"><span data-stu-id="526a8-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
