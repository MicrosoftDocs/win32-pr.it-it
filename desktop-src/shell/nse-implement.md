---
description: La procedura per implementare un'estensione dello spazio dei nomi è simile a quella per qualsiasi altro oggetto Component Object Model (COM) in-process.
title: Implementazione delle interfacce di oggetti della cartella di base
ms.topic: article
ms.date: 05/31/2018
ms.assetid: a45b8011-5355-429b-8935-4a7bdb5d2316
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: c05f5d2e4c21a923856c7324ad2d407230fa7595
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980002"
---
# <a name="implementing-the-basic-folder-object-interfaces"></a><span data-ttu-id="2b0f0-103">Implementazione delle interfacce di oggetti della cartella di base</span><span class="sxs-lookup"><span data-stu-id="2b0f0-103">Implementing the Basic Folder Object Interfaces</span></span>

<span data-ttu-id="2b0f0-104">La procedura per implementare un'estensione dello spazio dei nomi è simile a quella per qualsiasi altro oggetto Component Object Model (COM) in-process.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-104">The procedure for implementing a namespace extension is similar to that for any other in-process Component Object Model (COM) object.</span></span> <span data-ttu-id="2b0f0-105">Tutte le estensioni devono supportare tre interfacce primarie che forniscono a Esplora risorse le informazioni di base necessarie per visualizzare le cartelle dell'estensione nella visualizzazione albero.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-105">All extensions must support three primary interfaces that provide Windows Explorer with the basic information needed to display the extension's folders in the tree view.</span></span> <span data-ttu-id="2b0f0-106">Tuttavia, per sfruttare appieno le funzionalità di Esplora risorse, è necessario che l'estensione esponga anche una o più interfacce facoltative che supportano funzionalità più sofisticate, come i menu di scelta rapida o il trascinamento della selezione, e forniscono una visualizzazione cartelle.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-106">However, to make full use of the capabilities of Windows Explorer, your extension must also expose one or more optional interfaces that support more sophisticated features, such as shortcut menus or drag-and-drop, and provide a folder view.</span></span>

<span data-ttu-id="2b0f0-107">In questo documento viene illustrato come implementare le interfacce primarie e facoltative chiamate da Esplora risorse per informazioni sul contenuto dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-107">This document discusses how to implement the primary and optional interfaces that Windows Explorer calls for information about the contents of your extension.</span></span> <span data-ttu-id="2b0f0-108">Per informazioni su come implementare una visualizzazione cartelle e su come personalizzare Esplora risorse, vedere Implementazione di [una visualizzazione cartelle](../lwef/nse-folderview.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-108">For a discussion of how to implement a folder view and how to customize Windows Explorer, see [Implementing a Folder View](../lwef/nse-folderview.md).</span></span>

-   [<span data-ttu-id="2b0f0-109">Implementazione e registrazione di base</span><span class="sxs-lookup"><span data-stu-id="2b0f0-109">Basic Implementation and Registration</span></span>](#basic-implementation-and-registration)
    -   [<span data-ttu-id="2b0f0-110">Registrazione di un'estensione</span><span class="sxs-lookup"><span data-stu-id="2b0f0-110">Registering an Extension</span></span>](#registering-an-extension)
-   [<span data-ttu-id="2b0f0-111">Gestione di PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-111">Handling PIDLs</span></span>](#handling-pidls)
    -   [<span data-ttu-id="2b0f0-112">Creazione di una struttura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="2b0f0-112">Creating an SHITEMID Structure</span></span>](#creating-an-shitemid-structure)
    -   [<span data-ttu-id="2b0f0-113">Creazione di un PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-113">Constructing a PIDL</span></span>](#constructing-a-pidl)
    -   [<span data-ttu-id="2b0f0-114">Interpretazione di PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-114">Interpreting PIDLs</span></span>](#interpreting-pidls)
-   [<span data-ttu-id="2b0f0-115">Implementazione delle interfacce primarie</span><span class="sxs-lookup"><span data-stu-id="2b0f0-115">Implementing the Primary Interfaces</span></span>](#implementing-the-primary-interfaces)
    -   [<span data-ttu-id="2b0f0-116">Interfaccia IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="2b0f0-116">IPersistFolder Interface</span></span>](#ipersistfolder-interface)
    -   [<span data-ttu-id="2b0f0-117">Interfaccia IShellFolder</span><span class="sxs-lookup"><span data-stu-id="2b0f0-117">IShellFolder Interface</span></span>](#ishellfolder-interface)
    -   [<span data-ttu-id="2b0f0-118">Interfaccia IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="2b0f0-118">IEnumIDList Interface</span></span>](#ienumidlist-interface)
-   [<span data-ttu-id="2b0f0-119">Implementazione delle interfacce facoltative</span><span class="sxs-lookup"><span data-stu-id="2b0f0-119">Implementing the Optional Interfaces</span></span>](#implementing-the-optional-interfaces)
    -   [<span data-ttu-id="2b0f0-120">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="2b0f0-120">IExtractIcon</span></span>](#iextracticon)
    -   [<span data-ttu-id="2b0f0-121">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="2b0f0-121">IContextMenu</span></span>](#icontextmenu)
    -   [<span data-ttu-id="2b0f0-122">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="2b0f0-122">IQueryInfo</span></span>](#iqueryinfo)
    -   [<span data-ttu-id="2b0f0-123">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="2b0f0-123">IDataObject and IDropTarget</span></span>](#idataobject-and-idroptarget)
-   [<span data-ttu-id="2b0f0-124">Utilizzo dell'implementazione della visualizzazione della cartella della shell predefinita</span><span class="sxs-lookup"><span data-stu-id="2b0f0-124">Working With the Default Shell Folder View Implementation</span></span>](#working-with-the-default-shell-folder-view-implementation)

## <a name="basic-implementation-and-registration"></a><span data-ttu-id="2b0f0-125">Implementazione e registrazione di base</span><span class="sxs-lookup"><span data-stu-id="2b0f0-125">Basic Implementation and Registration</span></span>

<span data-ttu-id="2b0f0-126">Come server COM in-process, la DLL deve esporre diverse funzioni e interfacce standard:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-126">As an in-process COM server, your DLL must expose several standard functions and interfaces:</span></span>

-   [<span data-ttu-id="2b0f0-127">**DllCanUnloadNow**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-127">**DllCanUnloadNow**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)
-   [<span data-ttu-id="2b0f0-128">**DllGetClassObject**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-128">**DllGetClassObject**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)
-   [<span data-ttu-id="2b0f0-129">**IClassFactory**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-129">**IClassFactory**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)
-   [<span data-ttu-id="2b0f0-130">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-130">**IUnknown**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iunknown)

<span data-ttu-id="2b0f0-131">Queste funzioni e interfacce vengono implementate nello stesso modo in cui si trovano per la maggior parte degli altri oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-131">These functions and interfaces are implemented in the same way as they are for most other COM objects.</span></span> <span data-ttu-id="2b0f0-132">Per informazioni dettagliate, vedere la [documentazione com](../com/the-component-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-132">For details, see the [COM documentation](../com/the-component-object-model.md).</span></span>

### <a name="registering-an-extension"></a><span data-ttu-id="2b0f0-133">Registrazione di un'estensione</span><span class="sxs-lookup"><span data-stu-id="2b0f0-133">Registering an Extension</span></span>

<span data-ttu-id="2b0f0-134">Come per tutti gli oggetti COM, è necessario creare un GUID identificatore di classe (CLSID) per l'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-134">As with all COM objects, you must create a class identifier (CLSID) GUID for your extension.</span></span> <span data-ttu-id="2b0f0-135">Registrare l'oggetto creando una sottochiave del **CLSID \_ \_ radice delle classi HKEY** \\  denominato per il CLSID dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-135">Register the object by creating a subkey of **HKEY\_CLASSES\_ROOT**\\**CLSID** named for the CLSID of your extension.</span></span> <span data-ttu-id="2b0f0-136">La DLL deve essere registrata come server in-process e deve specificare il modello di threading dell'Apartment.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-136">The DLL should be registered as an in-process server and should specify the apartment threading model.</span></span> <span data-ttu-id="2b0f0-137">È possibile personalizzare il comportamento della cartella radice di un'estensione aggiungendo un'ampia gamma di sottochiavi e valori alla chiave CLSID dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-137">You can customize the behavior of an extension's root folder by adding a variety of subkeys and values to the extension's CLSID key.</span></span>

<span data-ttu-id="2b0f0-138">Molti di questi valori si applicano solo alle estensioni con i punti di giunzione virtuali.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-138">Several of these values apply only to extensions with virtual junction points.</span></span> <span data-ttu-id="2b0f0-139">Questi valori non si applicano alle estensioni i cui punti di giunzione sono file system cartelle.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-139">These values do not apply to extensions whose junction points are file system folders.</span></span> <span data-ttu-id="2b0f0-140">Per ulteriori informazioni, vedere [specifica del percorso di un'estensione dello spazio dei nomi](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-140">For further discussion, see [Specifying a Namespace Extension's Location](nse-junction.md).</span></span> <span data-ttu-id="2b0f0-141">Per modificare il comportamento di un'estensione con un punto di giunzione virtuale, aggiungere uno o più dei valori seguenti alla chiave CLSID dell'estensione:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-141">To modify the behavior of an extension with a virtual junction point, add one or more of the following values to the extension's CLSID key:</span></span>

-   <span data-ttu-id="2b0f0-142">WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-142">WantsFORPARSING.</span></span> <span data-ttu-id="2b0f0-143">Il nome di analisi per un'estensione con un punto di giunzione virtuale in genere avrà il formato:: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-143">The parsing name for an extension with a virtual junction point will normally have the form ::{*GUID*}.</span></span> <span data-ttu-id="2b0f0-144">Le estensioni di questo tipo contengono in genere elementi virtuali.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-144">Extensions of this type normally contain virtual items.</span></span> <span data-ttu-id="2b0f0-145">Tuttavia, alcune estensioni, ad esempio documenti, corrispondono in realtà a file system cartelle, anche se hanno punti di giunzione virtuali.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-145">However, some extensions, such as My Documents, actually correspond to file system folders, even though they have virtual junction points.</span></span> <span data-ttu-id="2b0f0-146">Se l'estensione rappresenta file system oggetti in questo modo, è possibile impostare il valore WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-146">If your extension represents file system objects in this way, you can set the WantsFORPARSING value.</span></span> <span data-ttu-id="2b0f0-147">In Esplora risorse verrà quindi richiesto il nome di analisi della cartella radice chiamando il metodo [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) dell'oggetto Folder con *UFlags* impostato su **SHGDN \_ FORPARSING** e *PIDL* impostato su un singolo puntatore vuoto a un elenco di identificatori di elemento (PIDL).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-147">Windows Explorer will then request your root folder's parsing name by calling the folder object's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method with *uFlags* set to **SHGDN\_FORPARSING** and *pidl* set to a single empty pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="2b0f0-148">Un PIDL vuoto contiene solo un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-148">An empty PIDL contains only a terminator.</span></span> <span data-ttu-id="2b0f0-149">Il metodo deve quindi restituire il nome di analisi della cartella radice:: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-149">Your method should then return the root folder's ::{*GUID*} parsing name.</span></span>
-   <span data-ttu-id="2b0f0-150">HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-150">HideFolderVerbs.</span></span> <span data-ttu-id="2b0f0-151">I verbi registrati nella cartella **\_ \_ radice delle classi HKEY** \\  sono normalmente associati a tutte le estensioni.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-151">The verbs registered under **HKEY\_CLASSES\_ROOT**\\**Folder** normally are associated with all extensions.</span></span> <span data-ttu-id="2b0f0-152">Vengono visualizzati nel menu di scelta rapida dell'estensione e possono essere richiamati da [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-152">They appear on the extension's shortcut menu and can be invoked by [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span></span> <span data-ttu-id="2b0f0-153">Per impedire che uno di questi verbi venga associato all'estensione, impostare il valore HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-153">To prevent any of these verbs from being associated with your extension, set the HideFolderVerbs value.</span></span>
-   <span data-ttu-id="2b0f0-154">HideAsDelete.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-154">HideAsDelete.</span></span> <span data-ttu-id="2b0f0-155">Se un utente tenta di eliminare l'estensione, Esplora risorse nasconde invece l'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-155">If a user attempts to delete your extension, Windows Explorer will instead hide the extension.</span></span>
-   <span data-ttu-id="2b0f0-156">HideAsDeletePerUser.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-156">HideAsDeletePerUser.</span></span> <span data-ttu-id="2b0f0-157">Questo valore ha lo stesso effetto di HideAsDelete, ma per singolo utente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-157">This value has the same effect as HideAsDelete but on a per-user basis.</span></span> <span data-ttu-id="2b0f0-158">L'estensione è nascosta solo per gli utenti che hanno tentato di eliminarla.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-158">The extension is hidden only for those users who have attempted to delete it.</span></span> <span data-ttu-id="2b0f0-159">L'estensione è visibile a tutti gli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-159">The extension is visible to all other users.</span></span>
-   <span data-ttu-id="2b0f0-160">QueryForOverlay.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-160">QueryForOverlay.</span></span> <span data-ttu-id="2b0f0-161">Impostare questo valore per indicare che l'icona della cartella radice può avere una sovrapposizione di icone.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-161">Set this value to indicate that the root folder's icon can have an icon overlay.</span></span> <span data-ttu-id="2b0f0-162">L'oggetto Folder deve supportare l'interfaccia [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-162">The folder object must support the [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) interface.</span></span> <span data-ttu-id="2b0f0-163">Prima di visualizzare l'icona della cartella radice, in Esplora risorse verrà richiesta un'icona di sovrapposizione chiamando uno dei due metodi **IShellIconOverlay** con *pidlItem* impostato su un PIDL vuoto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-163">Before Windows Explorer displays the root folder's icon, it will request an overlay icon by calling one of the two **IShellIconOverlay** methods with *pidlItem* set to an empty PIDL.</span></span>

<span data-ttu-id="2b0f0-164">I valori e le sottochiavi rimanenti si applicano a tutte le estensioni:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-164">The remaining values and subkeys apply to all extensions:</span></span>

-   <span data-ttu-id="2b0f0-165">Per specificare il nome visualizzato della cartella del punto di giunzione dell'estensione, impostare il valore predefinito della sottochiave CLSID dell'estensione su una stringa appropriata.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-165">To specify the display name of the extension's junction point folder, set the default value of the extension's CLSID subkey to an appropriate string.</span></span>
-   <span data-ttu-id="2b0f0-166">Quando il cursore passa su una cartella, viene in genere visualizzato un infotip che descrive il contenuto della cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-166">When the cursor hovers over a folder, an infotip is typically displayed that describes the contents of the folder.</span></span> <span data-ttu-id="2b0f0-167">Per fornire un infotip per la cartella radice dell'estensione, creare un valore InfoTip **reg \_ SZ** per la chiave CLSID dell'estensione e impostarlo su una stringa appropriata.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-167">To provide an infotip for your extension's root folder, create an InfoTip **REG\_SZ** value for the extension's CLSID key, and set it to an appropriate string.</span></span>
-   <span data-ttu-id="2b0f0-168">Per specificare un'icona personalizzata per la cartella radice dell'estensione, creare una sottochiave della sottochiave CLSID dell'estensione denominata **DefaultIcon**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-168">To specify a custom icon for your extension's root folder, create a subkey of the extension's CLSID subkey named **DefaultIcon**.</span></span> <span data-ttu-id="2b0f0-169">Impostare il valore predefinito di **DefaultIcon** su un valore **reg \_ SZ** contenente il nome del file che contiene l'icona, seguito da una virgola, seguita da un segno meno, seguito dall'indice dell'icona in tale file.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-169">Set the default value of **DefaultIcon** to a **REG\_SZ** value containing the name of the file that contains the icon, followed by a comma, followed by a minus sign, followed by the index of the icon in that file.</span></span>
-   <span data-ttu-id="2b0f0-170">Per impostazione predefinita, il menu di scelta rapida della cartella radice dell'estensione conterrà gli elementi definiti nella **\_ \_ \\ cartella radice delle classi HKEY**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-170">By default, the shortcut menu of your extension's root folder will contain the items defined under **HKEY\_CLASSES\_ROOT\\Folder**.</span></span> <span data-ttu-id="2b0f0-171">Gli elementi **Delete**, **Rename** e **Properties** vengono aggiunti se sono stati impostati i flag SFGAO \_ xxx appropriati.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-171">The **Delete**, **Rename**, and **Properties** items are added if you have set the appropriate SFGAO\_XXX flags.</span></span> <span data-ttu-id="2b0f0-172">È possibile aggiungere altri elementi al menu di scelta rapida della cartella radice o eseguire l'override di elementi esistenti in modo analogo a quanto avviene per un [tipo di file](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-172">You can add other items to the root folder's shortcut menu, or override existing items, much as you would for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="2b0f0-173">Creare una sottochiave della **Shell** sotto la chiave CLSID dell'estensione e definire i comandi come descritto in [estensione dei menu di scelta rapida](context.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-173">Create a **Shell** subkey under the extension's CLSID key, and define commands as discussed in [Extending Shortcut Menus](context.md).</span></span>
-   <span data-ttu-id="2b0f0-174">Se è necessario un modo più flessibile per gestire il menu di scelta rapida della cartella radice, è possibile implementare un [gestore di menu di scelta rapida](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-174">If you need a more flexible way to handle the root folder's shortcut menu, you can implement a [shortcut menu handler](context-menu-handlers.md).</span></span> <span data-ttu-id="2b0f0-175">Per registrare il gestore del menu di scelta rapida, creare una chiave **ShellEx** nella chiave CLSID dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-175">To register the shortcut menu handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="2b0f0-176">Registrare il CLSID del gestore come per i [gestori di estensioni della shell di creazione](handlers.md)convenzionali.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-176">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="2b0f0-177">Per aggiungere una pagina alla finestra delle proprietà delle proprietà della cartella radice, assegnare alla cartella l'attributo **\_ HASPROPSHEET di SFGAO** e implementare un [gestore della finestra delle proprietà](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-177">To add a page to the root folder's Properties property sheet, give the folder the **SFGAO\_HASPROPSHEET** attribute and implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="2b0f0-178">Per registrare il gestore della finestra delle proprietà, creare una chiave **ShellEx** nella chiave CLSID dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-178">To register the property sheet handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="2b0f0-179">Registrare il CLSID del gestore come per i [gestori di estensioni della shell di creazione](handlers.md)convenzionali.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-179">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="2b0f0-180">Per specificare gli attributi della cartella radice, aggiungere una sottochiave **ShellFolder** alla sottochiave CLSID dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-180">To specify the attributes of the root folder, add a **ShellFolder** subkey to the extension's CLSID subkey.</span></span> <span data-ttu-id="2b0f0-181">Creare un valore di attributi e impostarlo sulla combinazione appropriata di flag [**SFGAO \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-181">Create an Attributes value, and set it to the appropriate combination of [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags.</span></span>

<span data-ttu-id="2b0f0-182">Nella tabella seguente sono elencati alcuni attributi di uso comune per le cartelle radice.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-182">The following table lists some commonly used attributes for root folders.</span></span>



| <span data-ttu-id="2b0f0-183">Flag</span><span class="sxs-lookup"><span data-stu-id="2b0f0-183">Flag</span></span>                | <span data-ttu-id="2b0f0-184">valore</span><span class="sxs-lookup"><span data-stu-id="2b0f0-184">Value</span></span>      | <span data-ttu-id="2b0f0-185">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2b0f0-185">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|---------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2b0f0-186">\_cartella SFGAO</span><span class="sxs-lookup"><span data-stu-id="2b0f0-186">SFGAO\_FOLDER</span></span>       | <span data-ttu-id="2b0f0-187">0x20000000</span><span class="sxs-lookup"><span data-stu-id="2b0f0-187">0x20000000</span></span> | <span data-ttu-id="2b0f0-188">La cartella radice dell'estensione contiene uno o più elementi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-188">The extension's root folder contains one or more items.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="2b0f0-189">\_HASSUBFOLDER SFGAO</span><span class="sxs-lookup"><span data-stu-id="2b0f0-189">SFGAO\_HASSUBFOLDER</span></span> | <span data-ttu-id="2b0f0-190">0x80000000</span><span class="sxs-lookup"><span data-stu-id="2b0f0-190">0x80000000</span></span> | <span data-ttu-id="2b0f0-191">La cartella radice dell'estensione contiene una o più sottocartelle.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-191">The extension's root folder contains one or more subfolders.</span></span> <span data-ttu-id="2b0f0-192">In Esplora risorse verrà inserito un segno più (+) accanto all'icona della cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-192">Windows Explorer will place a plus sign ( + ) next to the folder icon.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="2b0f0-193">\_CANDELETE SFGAO</span><span class="sxs-lookup"><span data-stu-id="2b0f0-193">SFGAO\_CANDELETE</span></span>    | <span data-ttu-id="2b0f0-194">0x00000020</span><span class="sxs-lookup"><span data-stu-id="2b0f0-194">0x00000020</span></span> | <span data-ttu-id="2b0f0-195">La cartella radice dell'estensione può essere eliminata dall'utente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-195">The extension's root folder can be deleted by the user.</span></span> <span data-ttu-id="2b0f0-196">Il menu di scelta rapida della cartella includerà un elemento **Delete** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-196">The folder's shortcut menu will have a **Delete** item.</span></span> <span data-ttu-id="2b0f0-197">Questo flag deve essere impostato per i punti di giunzione posizionati in una delle [cartelle virtuali](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-197">This flag should be set for junction points that are placed under one of the [virtual folders](nse-junction.md).</span></span>                                                                                 |
| <span data-ttu-id="2b0f0-198">\_CANRENAME SFGAO</span><span class="sxs-lookup"><span data-stu-id="2b0f0-198">SFGAO\_CANRENAME</span></span>    | <span data-ttu-id="2b0f0-199">0x00000010</span><span class="sxs-lookup"><span data-stu-id="2b0f0-199">0x00000010</span></span> | <span data-ttu-id="2b0f0-200">La cartella radice dell'estensione può essere rinominata dall'utente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-200">The extension's root folder can be renamed by the user.</span></span> <span data-ttu-id="2b0f0-201">Il menu di scelta rapida della cartella avrà un elemento **Rename** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-201">The folder's shortcut menu will have a **Rename** item.</span></span>                                                                                                                                                                                                   |
| <span data-ttu-id="2b0f0-202">\_HASPROPSHEET SFGAO</span><span class="sxs-lookup"><span data-stu-id="2b0f0-202">SFGAO\_HASPROPSHEET</span></span> | <span data-ttu-id="2b0f0-203">0x00000040</span><span class="sxs-lookup"><span data-stu-id="2b0f0-203">0x00000040</span></span> | <span data-ttu-id="2b0f0-204">La cartella radice dell'estensione dispone di una finestra delle proprietà **Proprietà** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-204">The extension's root folder has a **Properties** property sheet.</span></span> <span data-ttu-id="2b0f0-205">Il menu di scelta rapida della cartella avrà un elemento **Proprietà** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-205">The folder's shortcut menu will have a **Properties** item.</span></span> <span data-ttu-id="2b0f0-206">Per fornire la finestra delle proprietà, è necessario implementare un [gestore della finestra delle proprietà](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-206">To provide the property sheet, you must implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="2b0f0-207">Registrare il gestore sotto la chiave CLSID dell'estensione, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-207">Register the handler under the extension's CLSID key, as discussed previously.</span></span> |



 

<span data-ttu-id="2b0f0-208">Nell'esempio seguente viene illustrata la voce del registro di sistema CLSID per un'estensione con un nome visualizzato di estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-208">The following example shows the CLSID registry entry for an extension with a display name of MyExtension.</span></span> <span data-ttu-id="2b0f0-209">L'estensione dispone di un'icona personalizzata contenuta nella DLL dell'estensione con indice 1.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-209">The extension has a custom icon that is contained in the extension's DLL with an index of 1.</span></span> <span data-ttu-id="2b0f0-210">Sono impostati gli attributi **SFGAO \_ Folder**, **SFGAO \_ HASSUBFOLDER** e **SFGAO \_ CANDELETE** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-210">The **SFGAO\_FOLDER**, **SFGAO\_HASSUBFOLDER**, and **SFGAO\_CANDELETE** attributes are set.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {Extension CLSID}
         (Default) = MyExtension
         InfoTip = Some appropriate text
      DefaultIcon
         (Default) = c:\MyDir\MyExtension.dll,-1
      InProcServer32
         (Default) = c:\MyDir\MyExtension.dll
         ThreadingModel = Apartment
      ShellFolder
         Attributes = 0xA00000020
```

## <a name="handling-pidls"></a><span data-ttu-id="2b0f0-211">Gestione di PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-211">Handling PIDLs</span></span>

<span data-ttu-id="2b0f0-212">Ogni elemento nello spazio dei nomi della shell deve avere un PIDL univoco.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-212">Every item in the Shell namespace must have a unique PIDL.</span></span> <span data-ttu-id="2b0f0-213">Esplora risorse assegna un PIDL alla cartella radice e passa il valore all'estensione durante l'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-213">Windows Explorer assigns a PIDL to your root folder and passes the value to your extension during initialization.</span></span> <span data-ttu-id="2b0f0-214">L'estensione è quindi responsabile dell'assegnazione di una PIDL costruita correttamente a ognuno dei relativi oggetti e di fornire tali PIDL a Esplora risorse su richiesta.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-214">Your extension is then responsible for assigning a properly constructed PIDL to each of its objects and providing those PIDLs to Windows Explorer on request.</span></span> <span data-ttu-id="2b0f0-215">Quando la shell usa un PIDL per identificare uno degli oggetti dell'estensione, l'estensione deve essere in grado di interpretare il PIDL e identificare l'oggetto specifico.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-215">When the Shell uses a PIDL to identify one of your extension's objects, your extension must be able to interpret the PIDL and identify the particular object.</span></span> <span data-ttu-id="2b0f0-216">L'estensione deve inoltre assegnare un nome [**visualizzato**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) e un *nome di analisi* a ogni oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-216">Your extension must also assign a [**display name**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) and a *parsing name* to each object.</span></span> <span data-ttu-id="2b0f0-217">Poiché PIDL vengono utilizzati praticamente da ogni interfaccia di cartella, le estensioni implementano in genere un singolo *gestore di PIDL* per gestire tutte queste attività.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-217">Because PIDLs are used by virtually every folder interface, extensions commonly implement a single *PIDL manager* to handle all these tasks.</span></span>

<span data-ttu-id="2b0f0-218">Il termine PIDL è breve per una struttura [**ItemId**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) o un puntatore a una struttura di questo tipo, a seconda del contesto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-218">The term PIDL is short for an [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure or a pointer to such a structure, depending on context.</span></span> <span data-ttu-id="2b0f0-219">Come dichiarato, una struttura **ItemId** ha un singolo membro, una struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-219">As declared, an **ITEMIDLIST** structure has a single member, an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="2b0f0-220">La struttura **ItemId** dell'oggetto è in realtà una matrice compressa di due o più strutture **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-220">An object's **ITEMIDLIST** structure is actually a packed array of two or more **SHITEMID** structures.</span></span> <span data-ttu-id="2b0f0-221">L'ordine di queste strutture definisce un percorso attraverso lo spazio dei nomi, nello stesso modo in cui c: \\ directory \\ MyFile definisce un percorso attraverso la file System.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-221">The order of these structures defines a path through the namespace, in much the same way that c:\\MyDirectory\\MyFile defines a path through the file system.</span></span> <span data-ttu-id="2b0f0-222">In genere, il PIDL di un oggetto sarà costituito da una serie di strutture **SHITEMID** che corrispondono alle cartelle che definiscono il percorso dello spazio dei nomi, seguito dalla struttura **SHITEMID** dell'oggetto, seguito da un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-222">Typically, an object's PIDL will consist of a series of **SHITEMID** structures that correspond to the folders that define the namespace path, followed by the object's **SHITEMID** structure, followed by a terminator.</span></span>

<span data-ttu-id="2b0f0-223">Il carattere di terminazione è una struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) e il membro *CB* è impostato su **null**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-223">The terminator is an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, with the *cb* member set to **NULL**.</span></span> <span data-ttu-id="2b0f0-224">Il carattere di terminazione è necessario perché il numero di strutture **SHITEMID** nel PIDL di un oggetto dipende dalla posizione dell'oggetto nello spazio dei nomi della shell e dal punto iniziale del percorso.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-224">The terminator is necessary because the number of **SHITEMID** structures in an object's PIDL depends on the location of the object in the Shell namespace, and the starting point of the path.</span></span> <span data-ttu-id="2b0f0-225">Inoltre, le dimensioni delle varie strutture **SHITEMID** possono variare.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-225">In addition, the size of the various **SHITEMID** structures can vary.</span></span> <span data-ttu-id="2b0f0-226">Quando si riceve un PIDL, non esiste un modo semplice per determinarne le dimensioni o anche il numero totale di strutture **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-226">When you receive a PIDL, you have no simple way of determining its size or even the total number of **SHITEMID** structures.</span></span> <span data-ttu-id="2b0f0-227">Al contrario, è necessario "esaminare" l'array compresso, struttura per struttura, fino a raggiungere il carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-227">Instead, you must "walk" the packed array, structure by structure, until you reach the terminator.</span></span>

<span data-ttu-id="2b0f0-228">Per creare un PIDL, l'applicazione deve:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-228">To create a PIDL, your application needs to:</span></span>

1.  <span data-ttu-id="2b0f0-229">Creare una struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) per ognuno dei relativi oggetti.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-229">Create an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure for each of its objects.</span></span>
2.  <span data-ttu-id="2b0f0-230">Assemblare le strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) rilevanti in un PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-230">Assemble the relevant [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures into a PIDL.</span></span>

### <a name="creating-an-shitemid-structure"></a><span data-ttu-id="2b0f0-231">Creazione di una struttura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="2b0f0-231">Creating an SHITEMID Structure</span></span>

<span data-ttu-id="2b0f0-232">La struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) di un oggetto identifica in modo univoco l'oggetto all'interno della relativa cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-232">An object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure uniquely identifies the object within its folder.</span></span> <span data-ttu-id="2b0f0-233">Infatti, un tipo di PIDL utilizzato da molti metodi [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) è costituito solo dalla struttura **SHITEMID** dell'oggetto, seguita da un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-233">In fact, a type of PIDL used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods consists of just the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="2b0f0-234">La definizione di una struttura **SHITEMID** è la seguente:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-234">The definition of an **SHITEMID** structure is:</span></span>


```C++
typedef struct _SHITEMID { 
    USHORT cb; 
    BYTE   abID[1]; 
} SHITEMID, * LPSHITEMID;
```



<span data-ttu-id="2b0f0-235">Il membro *permanente* è l'identificatore dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-235">The *abID* member is the object's identifier.</span></span> <span data-ttu-id="2b0f0-236">Poiché la lunghezza di *Atter* non è definita e può variare, il membro *CB* viene impostato sulla dimensione della struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , in byte.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-236">Because the length of *abID* is not defined and can vary, the *cb* member is set to the size of the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in bytes.</span></span>

<span data-ttu-id="2b0f0-237">Poiché né la lunghezza né il contenuto dell' *oggetto sono standardizzati, è possibile* utilizzare qualsiasi schema a cui si desidera assegnare i valori di tipo *rispettabile* .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-237">Because neither the length nor the content of *abID* is standardized, you can use any scheme you want to assign *abID* values to your objects.</span></span> <span data-ttu-id="2b0f0-238">L'unico requisito è che non è possibile avere due oggetti nella stessa cartella con valori identici.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-238">The only requirement is that you cannot have two objects in the same folder with identical values.</span></span> <span data-ttu-id="2b0f0-239">Tuttavia, per motivi di prestazioni, la struttura di [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) deve essere allineata a **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-239">However, for performance reasons, your [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure should be **DWORD**-aligned.</span></span> <span data-ttu-id="2b0f0-240">In altre parole, è necessario creare i valori di *dimora* in modo che *CB* sia un multiplo integrale di 4.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-240">In other words, you should construct your *abID* values such that *cb* is an integral multiple of 4.</span></span>

<span data-ttu-id="2b0f0-241">In genere *, fa* riferimento a una struttura definita dall'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-241">Typically, *abID* points to an extension-defined structure.</span></span> <span data-ttu-id="2b0f0-242">Oltre all'ID dell'oggetto, questa struttura viene spesso utilizzata per conservare una serie di informazioni correlate, ad esempio il tipo o gli attributi dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-242">In addition to the object's ID, this structure is often used to hold a variety of related information, such as the object's type or attributes.</span></span> <span data-ttu-id="2b0f0-243">Gli oggetti cartella dell'estensione possono quindi estrarre rapidamente le informazioni dal PIDL anziché dover eseguire una query.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-243">Your extension's folder objects can then quickly extract the information from the PIDL instead of having to query for it.</span></span>

> [!Note]  
> <span data-ttu-id="2b0f0-244">Uno degli aspetti più importanti della progettazione di una struttura di dati per un PIDL consiste nel rendere la struttura permanente e trasportabile.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-244">One of the most important aspects of designing a data structure for a PIDL is to make the structure persistable and transportable.</span></span> <span data-ttu-id="2b0f0-245">Nel contesto di PIDL, il significato di questi termini è:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-245">In the context of PIDLs, the meaning of these terms is:</span></span>
>
> -   <span data-ttu-id="2b0f0-246">Persistente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-246">Persistable.</span></span> <span data-ttu-id="2b0f0-247">Il sistema posiziona spesso PIDL in vari tipi di archiviazione a lungo termine, ad esempio i file di collegamento.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-247">The system frequently places PIDLs in various types of long-term storage, such as shortcut files.</span></span> <span data-ttu-id="2b0f0-248">Può quindi recuperare questi PIDL dalla risorsa di archiviazione in un secondo momento, probabilmente dopo il riavvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-248">It can then recover these PIDLs from storage later, possibly after the system has been rebooted.</span></span> <span data-ttu-id="2b0f0-249">Un PIDL recuperato dalla risorsa di archiviazione deve essere ancora valido e significativo per l'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-249">A PIDL that has been recovered from storage must still be valid and meaningful to your extension.</span></span> <span data-ttu-id="2b0f0-250">Questo requisito significa, ad esempio, che non è consigliabile usare puntatori o handle nella struttura PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-250">This requirement means, for instance, that you should not use pointers or handles in your PIDL structure.</span></span> <span data-ttu-id="2b0f0-251">PIDL che contengono questo tipo di dati normalmente non saranno significativi quando il sistema li recupererà in un secondo momento dalla risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-251">PIDLs containing this type of data will normally be meaningless when the system later recovers them from storage.</span></span>
> -   <span data-ttu-id="2b0f0-252">Trasportabili.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-252">Transportable.</span></span> <span data-ttu-id="2b0f0-253">Un PIDL deve rimanere significativo quando viene trasportato da un computer a un altro.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-253">A PIDL must remain meaningful when transported from one computer to another.</span></span> <span data-ttu-id="2b0f0-254">È ad esempio possibile scrivere un PIDL in un file di collegamento, copiarlo in un disco floppy e trasportarlo in un altro computer.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-254">For example, a PIDL can be written to a shortcut file, copied to a floppy disk, and transported to another computer.</span></span> <span data-ttu-id="2b0f0-255">Il PIDL dovrebbe ancora essere significativo per l'estensione in esecuzione nel secondo computer.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-255">That PIDL should still be meaningful to your extension running on the second computer.</span></span> <span data-ttu-id="2b0f0-256">Ad esempio, per assicurarsi che i PIDL siano trasportabili, usare in modo esplicito i caratteri ANSI o Unicode.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-256">For instance, to ensure that your PIDLs are transportable, use either ANSI or Unicode characters explicitly.</span></span> <span data-ttu-id="2b0f0-257">Evitare i tipi di dati, ad esempio **TCHAR** o **LPTSTR**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-257">Avoid data types such as **TCHAR** or **LPTSTR**.</span></span> <span data-ttu-id="2b0f0-258">Se si usano questi tipi di dati, un PIDL creato in un computer che esegue una versione Unicode dell'estensione non sarà leggibile da una versione ANSI di tale estensione in esecuzione in un computer diverso.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-258">If you use those data types, a PIDL created on a computer running a Unicode version of your extension will not be readable by an ANSI version of that extension running on a different computer.</span></span>

 

<span data-ttu-id="2b0f0-259">Nella dichiarazione seguente viene illustrato un semplice esempio di una struttura di dati.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-259">The following declaration shows a simple example of a data structure.</span></span>


```C++
typedef struct tagMYPIDLDATA {
  USHORT cb;
  DWORD dwType;
  WCHAR wszDisplayName[40];
} MYPIDLDATA, *LPMYPIDLDATA;
```



<span data-ttu-id="2b0f0-260">Il membro **CB** è impostato sulla dimensione della struttura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-260">The **cb** member is set to the size of the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="2b0f0-261">Questo membro rende **MYPIDLDATA** una struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) valida, in e di se stessa.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-261">This member makes **MYPIDLDATA** a valid [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in and of itself.</span></span> <span data-ttu-id="2b0f0-262">Gli altri membri sono equivalenti **al membro di** una struttura **SHITEMID** e contengono dati privati.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-262">The rest of the members are equivalent to the **abID** member of an **SHITEMID** structure and hold private data.</span></span> <span data-ttu-id="2b0f0-263">Il membro **dwType** è un valore definito dall'estensione che indica il tipo di oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-263">The **dwType** member is an extension-defined value that indicates the type of object.</span></span> <span data-ttu-id="2b0f0-264">Per questo esempio, **dwType** è impostato su **true** per le cartelle e **false** in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-264">For this example, **dwType** is set to **TRUE** for folders and **FALSE** otherwise.</span></span> <span data-ttu-id="2b0f0-265">Questo membro consente, ad esempio, di determinare rapidamente se l'oggetto è una cartella o meno.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-265">This member allows you, for instance, to quickly determine whether the object is a folder or not.</span></span> <span data-ttu-id="2b0f0-266">Il membro **wszDisplayName** contiene il nome visualizzato dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-266">The **wszDisplayName** member contains the object's display name.</span></span> <span data-ttu-id="2b0f0-267">Poiché non si assegna lo stesso nome visualizzato a due oggetti diversi nella stessa cartella, il nome visualizzato viene utilizzato anche come ID oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-267">Since you would not assign the same display name to two different objects in the same folder, the display name also serves as the object ID.</span></span> <span data-ttu-id="2b0f0-268">In questo esempio, **wszDisplayName** è impostato su 40 caratteri per garantire che la struttura **SHITEMID** sarà allineata a **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-268">In this example, **wszDisplayName** is set to 40 characters to guarantee that the **SHITEMID** structure will be **DWORD**-aligned.</span></span> <span data-ttu-id="2b0f0-269">Per limitare le dimensioni del PIDL, è possibile usare invece una matrice di caratteri a lunghezza variabile e modificare di conseguenza il valore di CB.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-269">To limit the size of your PIDLs, you can instead use a variable-length character array and adjust the value of cb accordingly.</span></span> <span data-ttu-id="2b0f0-270">Riempire la stringa di visualizzazione con un numero \\ di caratteri ' 0' sufficiente per mantenere l'allineamento **DWORD** della struttura.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-270">Pad the display string with enough '\\0' characters to maintain the structure's **DWORD** alignment.</span></span> <span data-ttu-id="2b0f0-271">Altri membri che potrebbero essere utili da inserire nella struttura includono le dimensioni, gli attributi o il nome di analisi dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-271">Other members that might be useful to put in the structure include the object's size, attributes, or parsing name.</span></span>

### <a name="constructing-a-pidl"></a><span data-ttu-id="2b0f0-272">Creazione di un PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-272">Constructing a PIDL</span></span>

<span data-ttu-id="2b0f0-273">Dopo aver definito le strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) per gli oggetti, è possibile usarle per creare un PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-273">Once you have defined [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for your objects, you can then use them to construct a PIDL.</span></span> <span data-ttu-id="2b0f0-274">PIDL può essere costruito per diversi scopi, ma la maggior parte delle attività usa uno dei due tipi di PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-274">PIDLs can be constructed for a variety of purposes, but most tasks use one of two types of PIDL.</span></span> <span data-ttu-id="2b0f0-275">Il più semplice, un PIDL a livello singolo, identifica l'oggetto relativo alla cartella padre.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-275">The simplest, a single-level PIDL, identifies the object relative to its parent folder.</span></span> <span data-ttu-id="2b0f0-276">Questo tipo di PIDL viene usato da molti dei metodi [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-276">This type of PIDL is used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods.</span></span> <span data-ttu-id="2b0f0-277">Un PIDL a livello singolo contiene la struttura **SHITEMID** dell'oggetto, seguita da un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-277">A single-level PIDL contains the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="2b0f0-278">Un PIDL completo definisce un percorso attraverso la gerarchia dello spazio dei nomi dal desktop all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-278">A fully qualified PIDL defines a path through the namespace hierarchy from the desktop to the object.</span></span> <span data-ttu-id="2b0f0-279">Questo tipo di PIDL inizia sul desktop e contiene una struttura **SHITEMID** per ogni cartella nel percorso, seguita dall'oggetto e dal carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-279">This type of PIDL starts at the desktop and contains one **SHITEMID** structure for each folder in the path, followed by the object and the terminator.</span></span> <span data-ttu-id="2b0f0-280">Un PIDL completo identifica in modo univoco l'oggetto all'interno dell'intero spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-280">A fully qualified PIDL uniquely identifies the object within the entire Shell namespace.</span></span>

<span data-ttu-id="2b0f0-281">Il modo più semplice per costruire un PIDL consiste nel lavorare direttamente con la struttura [**ItemId**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-281">The simplest way to construct a PIDL is to work directly with the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure itself.</span></span> <span data-ttu-id="2b0f0-282">Creare una struttura **ItemId** , ma allocare memoria sufficiente per mantenere tutte le strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-282">Create an **ITEMIDLIST** structure, but allocate enough memory to hold all the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures.</span></span> <span data-ttu-id="2b0f0-283">L'indirizzo di questa struttura punterà alla struttura **SHITEMID** iniziale.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-283">The address of this structure will point to the initial **SHITEMID** structure.</span></span> <span data-ttu-id="2b0f0-284">Definire i valori per i membri di questa struttura iniziale, quindi accodare il numero di strutture **SHITEMID** aggiuntive necessarie nell'ordine appropriato.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-284">Define values for the members of this initial structure, and then append as many additional **SHITEMID** structures as you need, in the appropriate order.</span></span> <span data-ttu-id="2b0f0-285">La procedura seguente illustra come creare un PIDL a un solo livello.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-285">The following procedure outlines how to create a single-level PIDL.</span></span> <span data-ttu-id="2b0f0-286">Contiene due strutture **SHITEMID** , una struttura **MYPIDLDATA** seguita da un carattere di terminazione:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-286">It contains two **SHITEMID** structures—a **MYPIDLDATA** structure followed by a terminator:</span></span>

1.  <span data-ttu-id="2b0f0-287">Utilizzare la funzione [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) per allocare memoria per il PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-287">Use the [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) function to allocate memory for the PIDL.</span></span> <span data-ttu-id="2b0f0-288">Allocare memoria sufficiente per i dati privati più un **ushort** (due byte) per il carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-288">Allocate enough memory for your private data plus a **USHORT** (two bytes) for the terminator.</span></span> <span data-ttu-id="2b0f0-289">Eseguire il cast del risultato a LPMYPIDLDATA.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-289">Cast the result to LPMYPIDLDATA.</span></span>
2.  <span data-ttu-id="2b0f0-290">Impostare il membro CB della prima struttura **MYPIDLDATA** sulla dimensione della struttura.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-290">Set the cb member of the first **MYPIDLDATA** structure to the size of that structure.</span></span> <span data-ttu-id="2b0f0-291">Per questo esempio, è necessario impostare **CB** su sizeof (MYPIDLDATA).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-291">For this example, you would set **cb** to sizeof(MYPIDLDATA).</span></span> <span data-ttu-id="2b0f0-292">Se si vuole usare una struttura a lunghezza variabile, sarà necessario calcolare il valore di **CB**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-292">If you want to use a variable-length structure, you will have to calculate the value of **cb**.</span></span>
3.  <span data-ttu-id="2b0f0-293">Assegnare i valori appropriati ai membri dati privati.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-293">Assign appropriate values to the private data members.</span></span>
4.  <span data-ttu-id="2b0f0-294">Calcolare l'indirizzo della struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) successiva.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-294">Calculate the address of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="2b0f0-295">Eseguire il cast dell'indirizzo della struttura MYPIDLDATA corrente a LPBYTE e aggiungere tale valore al valore di **CB** determinato nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-295">Cast the address of the current MYPIDLDATA structure to LPBYTE, and add that value to the value of **cb** determined in step 3.</span></span>
5.  <span data-ttu-id="2b0f0-296">In questo caso, la struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) successiva è il carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-296">In this case, the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure is the terminator.</span></span> <span data-ttu-id="2b0f0-297">Impostare il membro **CB** della struttura su zero.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-297">Set the structure's **cb** member to zero.</span></span>

<span data-ttu-id="2b0f0-298">Per PIDL più lunghe, allocare memoria sufficiente e ripetere i passaggi 3-5 per ogni struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-298">For longer PIDLs, allocate sufficient memory and repeat steps 3-5 for each additional [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span>

<span data-ttu-id="2b0f0-299">La funzione di esempio seguente accetta il tipo e il nome visualizzato di un oggetto e restituisce il PIDL a singolo livello dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-299">The following sample function takes an object's type and display name and returns the object's single-level PIDL.</span></span> <span data-ttu-id="2b0f0-300">La funzione presuppone che il nome visualizzato, incluso il carattere **null** di terminazione, non superi il numero di caratteri dichiarati per la struttura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-300">The function assumes that the display name, including its terminating **null** character, does not exceed the number of characters declared for the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="2b0f0-301">Se il presupposto risulta errato, la funzione [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) tronca il nome visualizzato.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-301">If that assumption turns out to be erroneous, the [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) function will truncate the display name.</span></span> <span data-ttu-id="2b0f0-302">La variabile **g \_ pMalloc** è un puntatore [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) creato altrove e archiviato in una variabile globale.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-302">The **g\_pMalloc** variable is an [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) pointer created elsewhere and stored in a global variable.</span></span>


```C++
LPITEMIDLIST CreatePIDL(DWORD dwType, LPCWSTR pwszDisplayName)
{
    LPMYPIDLDATA   pidlOut;
    USHORT         uSize;

    pidlOut = NULL;

    //Calculate the size of the MYPIDLDATA structure.
    uSize = sizeof(MYPIDLDATA);

    // Allocate enough memory for the PIDL to hold a MYPIDLDATA structure 
    // plus the terminator
    pidlOut = (LPMYPIDLDATA)m_pMalloc->Alloc(uSize + sizeof(USHORT));

    if(pidlOut)
    {
       //Assign values to the members of the MYPIDLDATA structure
       //that is the PIDL's first SHITEMID structure
       pidlOut->cb = uSize;
       pidlOut->dwType = dwType;
       hr = StringCbCopyW(pidlOut->wszDisplayName, 
                          sizeof(pidlOut->wszDisplayName), pwszDisplayName);
       
       // TODO: Add error handling here to verify the HRESULT returned 
       // by StringCbCopyW.

       //Advance the pointer to the start of the next SHITEMID structure.
       pidlOut = (LPMYPIDLDATA)((LPBYTE)pidlOut + pidlOut->cb);

       //Create the terminating null character by setting cb to 0.
       pidlOut->cb = 0;
    }

    return pidlOut;
```



<span data-ttu-id="2b0f0-303">Un PIDL completo deve avere strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) per ogni oggetto dal desktop all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-303">A fully qualified PIDL must have [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for every object from the desktop to your object.</span></span> <span data-ttu-id="2b0f0-304">L'estensione riceve un PIDL completo per la cartella radice quando la shell chiama [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-304">Your extension receives a fully qualified PIDL for your root folder when the Shell calls [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span></span> <span data-ttu-id="2b0f0-305">Per costruire un PIDL completo per un oggetto, prendere il PIDL che la shell ha assegnato alla cartella radice e aggiungere le strutture **SHITEMID** necessarie per passare dalla cartella radice all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-305">To construct a fully qualified PIDL for an object, take the PIDL that the Shell has assigned to your root folder, and append the **SHITEMID** structures that are needed to take you from the root folder to the object.</span></span>

### <a name="interpreting-pidls"></a><span data-ttu-id="2b0f0-306">Interpretazione di PIDL</span><span class="sxs-lookup"><span data-stu-id="2b0f0-306">Interpreting PIDLs</span></span>

<span data-ttu-id="2b0f0-307">Quando la shell o un'applicazione chiama una delle interfacce dell'estensione per richiedere informazioni su un oggetto, in genere l'oggetto viene identificato da un PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-307">When the Shell or an application calls one of your extension's interfaces to request information about an object, it will usually identify the object by a PIDL.</span></span> <span data-ttu-id="2b0f0-308">Alcuni metodi, ad esempio [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), usano PIDL relativi alla cartella padre e sono semplici da interpretare.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-308">Some methods, such as [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), use PIDLs that are relative to the parent folder and are straightforward to interpret.</span></span> <span data-ttu-id="2b0f0-309">Tuttavia, l'estensione riceverà probabilmente anche PIDL completi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-309">However, your extension will probably also receive fully qualified PIDLs.</span></span> <span data-ttu-id="2b0f0-310">PIDL Manager deve quindi determinare gli oggetti a cui fa riferimento PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-310">Your PIDL manager must then determine which of your objects that PIDL is referring to.</span></span>

<span data-ttu-id="2b0f0-311">Ciò che complica l'attività di associazione di un oggetto a un PIDL completo è che una o più strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) iniziali in PIDL possono appartenere a oggetti che si trovano all'esterno dell'estensione nello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-311">What complicates the task of associating an object with a fully qualified PIDL is that one or more of the initial [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures in the PIDL might belong to objects that lie outside your extension in the Shell namespace.</span></span> <span data-ttu-id="2b0f0-312">Non esiste alcun modo per interpretare il significato del membro *permanente* di tali strutture.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-312">You have no way of interpreting the meaning of the *abID* member of those structures.</span></span> <span data-ttu-id="2b0f0-313">L'estensione deve eseguire il "percorso" dell'elenco di strutture **SHITEMID** fino a raggiungere la struttura che corrisponde alla cartella radice.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-313">What your extension must do is to "walk" the list of **SHITEMID** structures, until you reach the structure that corresponds to your root folder.</span></span> <span data-ttu-id="2b0f0-314">Da questo punto in poi si saprà come interpretare le informazioni nelle strutture **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-314">From then on, you will know how to interpret the information in the **SHITEMID** structures.</span></span>

<span data-ttu-id="2b0f0-315">Per esaminare il PIDL, prendere il primo valore *CB* e aggiungerlo all'indirizzo di PIDL per far avanzare il puntatore all'inizio della struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) successiva.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-315">To walk the PIDL, take the first *cb* value and add it to the address of the PIDL to advance the pointer to the start of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="2b0f0-316">Verrà quindi fatto riferimento al membro *CB* di tale struttura, che può essere usato per far avanzare il puntatore all'inizio della struttura **SHITEMID** successiva e così via.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-316">It then will be pointing to that structure's *cb* member, which you can use to advance the pointer to the start of the next **SHITEMID** structure, and so on.</span></span> <span data-ttu-id="2b0f0-317">Ogni volta che si avanza il puntatore, esaminare la struttura **SHITEMID** per determinare se è stata raggiunta la radice dello spazio dei nomi dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-317">Each time you advance the pointer, examine the **SHITEMID** structure to determine whether you have reached the root of your extension's namespace.</span></span>

## <a name="implementing-the-primary-interfaces"></a><span data-ttu-id="2b0f0-318">Implementazione delle interfacce primarie</span><span class="sxs-lookup"><span data-stu-id="2b0f0-318">Implementing the Primary Interfaces</span></span>

<span data-ttu-id="2b0f0-319">Come per tutti gli oggetti COM, l'implementazione di un'estensione è in gran parte l'implementazione di una raccolta di interfacce.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-319">As with all COM objects, implementing an extension is largely a matter of implementing a collection of interfaces.</span></span> <span data-ttu-id="2b0f0-320">In questa sezione vengono illustrate le tre interfacce principali che devono essere implementate da tutte le estensioni.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-320">This section discusses the three primary interfaces that must be implemented by all extensions.</span></span> <span data-ttu-id="2b0f0-321">Vengono utilizzati per l'inizializzazione e per fornire Windows Explorer con informazioni di base sul contenuto dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-321">They are used for initialization and to provide Windows Explorer with basic information about the contents of the extension.</span></span> <span data-ttu-id="2b0f0-322">Queste interfacce, oltre a una [visualizzazione di cartelle](../lwef/nse-folderview.md), sono tutte richieste per un'estensione funzionale.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-322">These interfaces, plus a [folder view](../lwef/nse-folderview.md), are all that is required for a functional extension.</span></span> <span data-ttu-id="2b0f0-323">Tuttavia, per sfruttare appieno le funzionalità di Esplora risorse, la maggior parte delle estensioni implementa anche una o più interfacce facoltative.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-323">However, to fully exploit the features of Windows Explorer, most extensions also implement one or more of the optional interfaces.</span></span>

### <a name="ipersistfolder-interface"></a><span data-ttu-id="2b0f0-324">Interfaccia IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="2b0f0-324">IPersistFolder Interface</span></span>

<span data-ttu-id="2b0f0-325">L'interfaccia [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) viene chiamata per inizializzare un nuovo oggetto Folder.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-325">The [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) interface is called to initialize a new folder object.</span></span> <span data-ttu-id="2b0f0-326">Il metodo [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) assegna un PIDL completo al nuovo oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-326">The [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) method assigns a fully qualified PIDL to the new object.</span></span> <span data-ttu-id="2b0f0-327">Archiviare questo PIDL per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-327">Store this PIDL for later use.</span></span> <span data-ttu-id="2b0f0-328">Ad esempio, un oggetto Folder deve usare questo PIDL per costruire PIDL completi per gli elementi figlio dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-328">For instance, a folder object must use this PIDL to construct fully qualified PIDLs for the object's children.</span></span> <span data-ttu-id="2b0f0-329">Il creatore dell'oggetto Folder può anche chiamare [**IPersist:: GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) per richiedere il CLSID dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-329">The folder object's creator can also call [**IPersist::GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) to request the object's CLSID.</span></span>

<span data-ttu-id="2b0f0-330">In genere, un oggetto Folder viene creato e inizializzato dal metodo [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) della relativa cartella padre.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-330">Typically, a folder object is created and initialized by its parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="2b0f0-331">Tuttavia, quando un utente accede all'estensione, Esplora risorse crea e Inizializza l'oggetto cartella radice dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-331">However, when a user browses into your extension, Windows Explorer creates and initializes the extension's root folder object.</span></span> <span data-ttu-id="2b0f0-332">Il PIDL che l'oggetto cartella radice riceve tramite [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contiene il percorso dal desktop alla cartella radice, che sarà necessario per costruire PIDL completi per l'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-332">The PIDL that the root folder object receives through [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contains the path from the desktop to the root folder that you will need to construct fully qualified PIDLs for your extension.</span></span>

### <a name="ishellfolder-interface"></a><span data-ttu-id="2b0f0-333">Interfaccia IShellFolder</span><span class="sxs-lookup"><span data-stu-id="2b0f0-333">IShellFolder Interface</span></span>

<span data-ttu-id="2b0f0-334">La shell considera un'estensione come una raccolta ordinata gerarchica di oggetti Folder.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-334">The Shell treats an extension as a hierarchically ordered collection of folder objects.</span></span> <span data-ttu-id="2b0f0-335">L'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) è il nucleo di qualsiasi implementazione di estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-335">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface is the core of any extension implementation.</span></span> <span data-ttu-id="2b0f0-336">Rappresenta un oggetto Folder e fornisce a Esplora risorse la maggior parte delle informazioni necessarie per visualizzare il contenuto della cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-336">It represents a folder object and provides Windows Explorer with much of the information needed to display the contents of the folder.</span></span>

<span data-ttu-id="2b0f0-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) è in genere l'unica interfaccia di cartella diversa da [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) esposta direttamente da un oggetto Folder.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) is typically the only folder interface other than [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) that is directly exposed by a folder object.</span></span> <span data-ttu-id="2b0f0-338">Mentre Esplora risorse usa un'ampia gamma di interfacce obbligatorie e facoltative per ottenere informazioni sul contenuto della cartella, ottiene i puntatori a tali interfacce tramite **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-338">While Windows Explorer uses a variety of required and optional interfaces to obtain information about the contents of the folder, it obtains pointers to those interfaces through **IShellFolder**.</span></span>

<span data-ttu-id="2b0f0-339">Esplora risorse ottiene il CLSID della cartella radice dell'estensione in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-339">Windows Explorer obtains the CLSID of your extension's root folder in a variety of ways.</span></span> <span data-ttu-id="2b0f0-340">Per informazioni dettagliate, vedere [specifica del percorso di un'estensione dello spazio dei nomi](nse-junction.md) o [visualizzazione di una visualizzazione Self-Contained di un'estensione dello spazio dei nomi](nse-view.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-340">For details, see [Specifying a Namespace Extension's Location](nse-junction.md) or [Displaying a Self-Contained View of a Namespace Extension](nse-view.md).</span></span> <span data-ttu-id="2b0f0-341">Esplora risorse utilizza quindi tale CLSID per creare e inizializzare un'istanza della cartella radice e una query per un'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-341">Windows Explorer then uses that CLSID to create and initialize an instance of the root folder and query for an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="2b0f0-342">Tramite l'estensione viene creato un oggetto Folder per rappresentare la cartella radice e viene restituita l'interfaccia **IShellFolder** dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-342">Your extension creates a folder object to represent the root folder and returns the object's **IShellFolder** interface.</span></span> <span data-ttu-id="2b0f0-343">Gran parte del resto dell'interazione tra l'estensione e Esplora risorse viene quindi svolta tramite **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-343">Much of the remainder of the interaction between your extension and Windows Explorer then takes place through **IShellFolder**.</span></span> <span data-ttu-id="2b0f0-344">Esplora risorse chiama **IShellFolder** per:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-344">Windows Explorer calls **IShellFolder** to:</span></span>

-   <span data-ttu-id="2b0f0-345">Richiedere un oggetto in grado di enumerare il contenuto della cartella radice.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-345">Request an object that can enumerate the contents of the root folder.</span></span>
-   <span data-ttu-id="2b0f0-346">Ottenere vari tipi di informazioni sul contenuto della cartella radice.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-346">Obtain various types of information about the contents of the root folder.</span></span>
-   <span data-ttu-id="2b0f0-347">Richiedere un oggetto che espone una delle interfacce facoltative.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-347">Request an object that exposes one of the optional interfaces.</span></span> <span data-ttu-id="2b0f0-348">È quindi possibile eseguire query su tali interfacce per ottenere informazioni aggiuntive, ad esempio icone o menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-348">Those interfaces can then be queried for additional information, such as icons or shortcut menus.</span></span>
-   <span data-ttu-id="2b0f0-349">Richiedere un oggetto cartella che rappresenti una sottocartella della cartella radice.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-349">Request a folder object that represents a subfolder of the root folder.</span></span>

<span data-ttu-id="2b0f0-350">Quando un utente apre una sottocartella della cartella radice, Esplora risorse chiama [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-350">When a user opens a subfolder of the root folder, Windows Explorer calls [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span></span> <span data-ttu-id="2b0f0-351">Tramite l'estensione viene creato e inizializzato un nuovo oggetto Folder per rappresentare la sottocartella e viene restituita l'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-351">Your extension creates and initializes a new folder object to represent the subfolder and returns its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="2b0f0-352">Esplora risorse chiama quindi questa interfaccia per diversi tipi di informazioni e così via fino a quando l'utente non decide di spostarsi altrove nello spazio dei nomi della shell o di chiudere Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-352">Windows Explorer then calls this interface for various types of information, and so on until the user decides to navigate elsewhere in the Shell namespace or close Windows Explorer.</span></span>

<span data-ttu-id="2b0f0-353">Nella parte restante di questa sezione vengono brevemente descritti i metodi [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) più importanti e come implementarli.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-353">The remainder of this section briefly discusses the more important [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods and how to implement them.</span></span>

### <a name="enumobjects"></a><span data-ttu-id="2b0f0-354">EnumObjects</span><span class="sxs-lookup"><span data-stu-id="2b0f0-354">EnumObjects</span></span>

<span data-ttu-id="2b0f0-355">Prima di visualizzare il contenuto di una cartella nella visualizzazione albero, Esplora risorse deve innanzitutto determinare il contenuto della cartella chiamando il metodo [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-355">Before displaying the contents of a folder in the tree view, Windows Explorer must first determine what the folder contains by calling the [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="2b0f0-356">Questo metodo crea un oggetto enumerazione OLE standard che espone un'interfaccia [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) e restituisce il puntatore a tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-356">This method creates a standard OLE enumeration object that exposes an [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and returns that interface pointer.</span></span> <span data-ttu-id="2b0f0-357">L'interfaccia **IEnumIDList** consente a Esplora risorse di ottenere il PIDL di tutti gli oggetti contenuti nella cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-357">The **IEnumIDList** interface allows Windows Explorer to obtain the PIDLs of all the objects contained by the folder.</span></span> <span data-ttu-id="2b0f0-358">Questi PIDL vengono quindi usati per ottenere informazioni sugli oggetti contenuti nella cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-358">These PIDLs are then used to obtain information about the objects contained by the folder.</span></span> <span data-ttu-id="2b0f0-359">Per altri dettagli, vedere [interfaccia IEnumIDList](#ienumidlist-interface).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-359">For further details, see [IEnumIDList Interface](#ienumidlist-interface).</span></span>

> [!Note]  
> <span data-ttu-id="2b0f0-360">Il metodo [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) deve restituire solo PIDL relativi alla cartella padre.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-360">The [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) method should only return PIDLs that are relative to the parent folder.</span></span> <span data-ttu-id="2b0f0-361">PIDL deve contenere solo la struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) dell'oggetto, seguita da un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-361">The PIDL should contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, followed by a terminator.</span></span>

 

### <a name="createviewobject"></a><span data-ttu-id="2b0f0-362">CreateViewObject</span><span class="sxs-lookup"><span data-stu-id="2b0f0-362">CreateViewObject</span></span>

<span data-ttu-id="2b0f0-363">Prima che il contenuto di una cartella venga visualizzato, Esplora risorse chiama questo metodo per richiedere un puntatore a un'interfaccia [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-363">Before the contents of a folder are displayed, Windows Explorer calls this method to request a pointer to an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="2b0f0-364">Questa interfaccia viene utilizzata da Esplora risorse per gestire la visualizzazione cartelle.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-364">This interface is used by Windows Explorer to manage the folder view.</span></span> <span data-ttu-id="2b0f0-365">Creare un oggetto visualizzazione cartelle e restituire l'interfaccia **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-365">Create a folder view object and return its **IShellView** interface.</span></span>

<span data-ttu-id="2b0f0-366">Il metodo [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) viene chiamato anche per richiedere una delle interfacce facoltative, ad esempio [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), per la cartella stessa.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-366">The [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method is also called to request one of the optional interfaces, such as [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), for the folder itself.</span></span> <span data-ttu-id="2b0f0-367">L'implementazione di questo metodo deve creare un oggetto che espone l'interfaccia richiesta e restituisce il puntatore a interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-367">Your implementation of this method should create an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="2b0f0-368">Se Esplora risorse necessita di un'interfaccia facoltativa per uno degli oggetti contenuti nella cartella, viene chiamato [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-368">If Windows Explorer needs an optional interface for one of the objects contained by the folder, it will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span></span>

### <a name="getuiobjectof"></a><span data-ttu-id="2b0f0-369">GetUIObjectOf</span><span class="sxs-lookup"><span data-stu-id="2b0f0-369">GetUIObjectOf</span></span>

<span data-ttu-id="2b0f0-370">Sebbene le informazioni di base sul contenuto di una cartella siano disponibili tramite i metodi [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , l'estensione può fornire anche Esplora risorse con vari tipi di informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-370">While basic information about the contents of a folder is available through the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods, your extension can also provide Windows Explorer with various kinds of additional information.</span></span> <span data-ttu-id="2b0f0-371">Ad esempio, è possibile specificare le icone per il contenuto di una cartella o il menu di scelta rapida di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-371">For instance, you can specify icons for the contents of a folder or an object's shortcut menu.</span></span> <span data-ttu-id="2b0f0-372">Esplora risorse chiama il metodo [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) per tentare di recuperare informazioni aggiuntive su un oggetto contenuto in una cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-372">Windows Explorer calls the [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) method to attempt to retrieve additional information about an object that is contained by a folder.</span></span> <span data-ttu-id="2b0f0-373">In Esplora risorse viene specificato l'oggetto per il quale si desiderano le informazioni e l'IID dell'interfaccia pertinente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-373">Windows Explorer specifies which object it wants the information for, and the IID of the relevant interface.</span></span> <span data-ttu-id="2b0f0-374">L'oggetto Folder Crea quindi un oggetto che espone l'interfaccia richiesta e restituisce il puntatore a interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-374">The folder object then creates an object that exposes the requested interface and returns the interface pointer.</span></span>

<span data-ttu-id="2b0f0-375">Se l'estensione consente agli utenti di trasferire oggetti con il trascinamento della selezione o gli appunti, Esplora risorse chiamerà [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) per richiedere un'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) o [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-375">If your extension allows users to transfer objects with drag-and-drop or the clipboard, Windows Explorer will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) or [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="2b0f0-376">Per informazioni dettagliate, vedere [trasferimento di oggetti Shell con trascinamento della selezione e gli appunti](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-376">For details, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

<span data-ttu-id="2b0f0-377">Esplora risorse chiama [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) quando desidera lo stesso tipo di informazioni sulla cartella stessa.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-377">Windows Explorer calls [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) when it wants the same sort of information about the folder itself.</span></span>

### <a name="bindtoobject"></a><span data-ttu-id="2b0f0-378">BindToObject</span><span class="sxs-lookup"><span data-stu-id="2b0f0-378">BindToObject</span></span>

<span data-ttu-id="2b0f0-379">Esplora risorse chiama il metodo [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) quando un utente tenta di aprire una delle sottocartelle dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-379">Windows Explorer calls the [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method when a user attempts to open one of your extension's subfolders.</span></span> <span data-ttu-id="2b0f0-380">Se *riid* è impostato su IID \_ IShellFolder, è necessario creare e inizializzare un oggetto cartella che rappresenta la sottocartella e restituire l'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-380">If *riid* is set to IID\_IShellFolder, you should create and initialize a folder object that represents the subfolder and return the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

> [!Note]  
> <span data-ttu-id="2b0f0-381">Attualmente, Esplora risorse chiama questo metodo solo per richiedere un'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-381">At present, Windows Explorer calls this method only to request an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="2b0f0-382">Tuttavia, non presupporre che questo sarà sempre il caso.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-382">However, do not assume that this will always be the case.</span></span> <span data-ttu-id="2b0f0-383">Prima di procedere, è consigliabile controllare sempre il valore di *riid* .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-383">You should always check the value of *riid* before proceeding.</span></span>

 

### <a name="getdisplaynameof"></a><span data-ttu-id="2b0f0-384">GetDisplayNameOf</span><span class="sxs-lookup"><span data-stu-id="2b0f0-384">GetDisplayNameOf</span></span>

<span data-ttu-id="2b0f0-385">Esplora risorse chiama il metodo [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) per convertire il PIDL di uno degli oggetti della cartella in un nome.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-385">Windows Explorer calls the [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to convert the PIDL of one of the folder's objects into a name.</span></span> <span data-ttu-id="2b0f0-386">PIDL deve essere relativo alla cartella padre dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-386">That PIDL must be relative to the object's parent folder.</span></span> <span data-ttu-id="2b0f0-387">In altre parole, deve contenere una singola struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) non **null** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-387">In other words, it must contain a single non-**NULL** [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="2b0f0-388">Poiché è possibile denominare gli oggetti in più modi, in Esplora risorse viene specificato il tipo di nome impostando uno o più flag [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) nel parametro *uFlags* .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-388">Because there is more than one possible way to name objects, Windows Explorer specifies the type of name by setting one or more [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) flags in the *uFlags* parameter.</span></span> <span data-ttu-id="2b0f0-389">Uno dei due valori, **SHGDN \_ Normal** o **SHGDN \_ InFolder**, verrà impostato in modo da specificare se il nome deve essere relativo alla cartella o rispetto al desktop.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-389">One of two values, **SHGDN\_NORMAL** or **SHGDN\_INFOLDER**, will be set to specify whether the name should be relative to the folder or relative to the desktop.</span></span> <span data-ttu-id="2b0f0-390">Uno degli altri tre valori, **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** o **SHGDN \_ FORPARSING**, può essere impostato per specificare il nome che verrà usato per.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-390">One of the other three values, **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, or **SHGDN\_FORPARSING**, can be set to specify what the name will be used for.</span></span>

<span data-ttu-id="2b0f0-391">Il nome deve essere restituito sotto forma di struttura [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-391">You must return the name in the form of an [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="2b0f0-392">Se **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** e **SHGDN \_ FORPARSING** non sono impostati, restituire il nome visualizzato dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-392">If **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, and **SHGDN\_FORPARSING** are not set, return the object's display name.</span></span> <span data-ttu-id="2b0f0-393">Se è impostato il flag **SHGDN \_ FORPARSING** , Esplora risorse richiede un nome di analisi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-393">If the **SHGDN\_FORPARSING** flag is set, Windows Explorer is requesting a parsing name.</span></span> <span data-ttu-id="2b0f0-394">I nomi di analisi vengono passati a [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) per ottenere PIDL di un oggetto, anche se potrebbe trovarsi in uno o più livelli sotto la cartella corrente nella gerarchia dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-394">Parsing names are passed to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) to obtain an object's PIDL, even though it might be located one or more levels below the current folder in the namespace hierarchy.</span></span> <span data-ttu-id="2b0f0-395">Ad esempio, il nome di analisi di un oggetto file system è il percorso.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-395">For example, the parsing name of a file system object is its path.</span></span> <span data-ttu-id="2b0f0-396">È possibile passare il percorso completo di qualsiasi oggetto nel file system al metodo **IShellFolder::P arsedisplayname** del desktop e restituirà il PIDL completo dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-396">You can pass the fully qualified path of any object in the file system to the desktop's **IShellFolder::ParseDisplayName** method, and it will return the object's fully qualified PIDL.</span></span>

<span data-ttu-id="2b0f0-397">Mentre i nomi di analisi sono stringhe di testo, non devono necessariamente includere il nome visualizzato.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-397">While parsing names are text strings, they do not necessarily have to include the display name.</span></span> <span data-ttu-id="2b0f0-398">È consigliabile assegnare i nomi di analisi in base a ciò che funzionerà in modo più efficiente quando viene chiamato [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-398">You should assign parsing names based on what will work most efficiently when [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) is called.</span></span> <span data-ttu-id="2b0f0-399">Ad esempio, molte delle cartelle virtuali della shell non fanno parte del file system e non hanno un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-399">For instance, many of the Shell's virtual folders are not part of the file system and do not have a fully qualified path.</span></span> <span data-ttu-id="2b0f0-400">Al contrario, a ogni cartella viene assegnato un GUID e il nome di analisi assume il formato:: {GUID}.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-400">Instead, each folder is assigned a GUID and the parsing name takes the form ::{GUID}.</span></span> <span data-ttu-id="2b0f0-401">Indipendentemente dallo schema usato, dovrebbe essere in grado di "round trip" in modo affidabile.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-401">Regardless of what scheme you use, it should be able to reliably "round trip."</span></span> <span data-ttu-id="2b0f0-402">Se, ad esempio, un chiamante passa un nome di analisi a **IShellFolder::P arsedisplayname** per recuperare PIDL di un oggetto, quindi passa il PIDL a [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) con il flag SHGDN **\_ FORPARSING** impostato, il chiamante deve ripristinare il nome di analisi originale.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-402">For instance, if a caller passes a parsing name to **IShellFolder::ParseDisplayName** to retrieve an object's PIDL, and then passes that PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) with the **SHGDN\_FORPARSING** flag set, the caller should recover the original parsing name.</span></span>

### <a name="getattributesof"></a><span data-ttu-id="2b0f0-403">GetAttributesOf</span><span class="sxs-lookup"><span data-stu-id="2b0f0-403">GetAttributesOf</span></span>

<span data-ttu-id="2b0f0-404">Esplora risorse chiama il metodo [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) per determinare gli attributi di uno o più elementi contenuti in un oggetto cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-404">Windows Explorer calls the [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) method to determine the attributes of one or more items contained by a folder object.</span></span> <span data-ttu-id="2b0f0-405">Il valore di *cidl* indica il numero di elementi nella query e *aPidl* punta a un elenco di PIDL.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-405">The value of *cidl* gives the number of items in the query, and *aPidl* points to a list of their PIDLs.</span></span>

<span data-ttu-id="2b0f0-406">Poiché i test per alcuni attributi possono richiedere molto tempo, in Esplora risorse la query viene in genere limitata a un subset dei flag disponibili, impostando i relativi valori in *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-406">Because testing for some attributes can be time consuming, Windows Explorer typically restricts the query to a subset of the available flags by setting their values in *rfgInOut*.</span></span> <span data-ttu-id="2b0f0-407">Il metodo deve verificare solo gli attributi i cui flag sono impostati in *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-407">Your method should test for only those attributes whose flags are set in *rfgInOut*.</span></span> <span data-ttu-id="2b0f0-408">Lasciare i flag validi impostati e deselezionare il resto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-408">Leave the valid flags set and clear the remainder.</span></span> <span data-ttu-id="2b0f0-409">Se nella query è incluso più di un elemento, impostare solo i flag che si applicano a tutti gli elementi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-409">If more than one item is included in the query, set only those flags that apply to all items.</span></span>

> [!Note]  
> <span data-ttu-id="2b0f0-410">Per visualizzare correttamente un elemento, è necessario che gli attributi siano impostati correttamente.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-410">The attributes must be properly set for an item to be correctly displayed.</span></span> <span data-ttu-id="2b0f0-411">Ad esempio, se un elemento è una cartella che contiene sottocartelle, è necessario impostare il flag **SFGAO \_ HASSUBFOLDER** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-411">For instance, if an item is a folder that contains subfolders, you must set the **SFGAO\_HASSUBFOLDER** flag.</span></span> <span data-ttu-id="2b0f0-412">In caso contrario, Esplora risorse non visualizzerà più accanto all'icona dell'elemento nella visualizzazione albero.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-412">Otherwise, Windows Explorer will not display a + next to the item's icon in the tree view.</span></span>

 

### <a name="parsedisplayname"></a><span data-ttu-id="2b0f0-413">ParseDisplayName</span><span class="sxs-lookup"><span data-stu-id="2b0f0-413">ParseDisplayName</span></span>

<span data-ttu-id="2b0f0-414">Il metodo [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) è in un certo senso un'immagine speculare di [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-414">The [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method is in some sense a mirror image of [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="2b0f0-415">L'uso più comune di questo metodo consiste nel convertire il nome di analisi di un oggetto nel PIDL associato.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-415">The most common use of this method is to convert an object's parsing name into the associated PIDL.</span></span> <span data-ttu-id="2b0f0-416">Il nome di analisi può fare riferimento a qualsiasi oggetto che si trova sotto la cartella nella gerarchia dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-416">The parsing name can refer to any object that lies below the folder in the namespace hierarchy.</span></span> <span data-ttu-id="2b0f0-417">Il PIDL restituito è relativo all'oggetto Folder che espone il metodo e che in genere non è completo.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-417">The returned PIDL is relative to the folder object that exposes the method and is usually not fully qualified.</span></span> <span data-ttu-id="2b0f0-418">In altre parole, sebbene PIDL possa contenere diverse strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , il primo sarà quello dell'oggetto stesso o della prima sottocartella nel percorso dalla cartella all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-418">In other words, although the PIDL can contain several [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures, the first will either be that of the object itself or the first subfolder in the path from the folder to the object.</span></span> <span data-ttu-id="2b0f0-419">Il chiamante dovrà aggiungere questo PIDL al PIDL completo della cartella per ottenere un PIDL completo per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-419">The caller will have to append this PIDL to the folder's fully qualified PIDL to obtain a fully qualified PIDL for the object.</span></span>

<span data-ttu-id="2b0f0-420">[**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) può essere chiamato anche per richiedere gli attributi di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-420">[**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) can also be called to request an object's attributes.</span></span> <span data-ttu-id="2b0f0-421">Poiché determinare tutti gli attributi applicabili può richiedere molto tempo, il chiamante imposterà solo i flag [**SFGAO \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) che rappresentano le informazioni a cui il chiamante è interessato.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-421">Because determining all the applicable attributes can be time consuming, the caller will set only those [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags that represent information that the caller is interested in.</span></span> <span data-ttu-id="2b0f0-422">È necessario determinare quali di questi attributi sono veri per l'oggetto e deselezionare i flag rimanenti.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-422">You should determine which of those attributes are true for the object, and clear the remaining flags.</span></span>

### <a name="ienumidlist-interface"></a><span data-ttu-id="2b0f0-423">Interfaccia IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="2b0f0-423">IEnumIDList Interface</span></span>

<span data-ttu-id="2b0f0-424">Quando in Esplora risorse è necessario enumerare gli oggetti contenuti in una cartella, viene chiamato [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-424">When Windows Explorer needs to enumerate the objects that are contained by a folder, it calls [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span></span> <span data-ttu-id="2b0f0-425">L'oggetto Folder deve creare un oggetto di enumerazione che espone l'interfaccia [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) e restituisce il puntatore a tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-425">The folder object must create an enumeration object that exposes the [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and return that interface pointer.</span></span> <span data-ttu-id="2b0f0-426">Esplora risorse utilizzerà in genere **IEnumIDList** per enumerare il PIDL di tutti gli oggetti contenuti nella cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-426">Windows Explorer will then typically use **IEnumIDList** to enumerate the PIDLs of all the objects contained by the folder.</span></span>

<span data-ttu-id="2b0f0-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) è un'interfaccia di enumerazione OLE standard ed è implementata nel modo consueto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) is a standard OLE enumeration interface and is implemented in the usual way.</span></span> <span data-ttu-id="2b0f0-428">Tenere presente, tuttavia, che la PIDL restituita deve essere relativa alla cartella e contenere solo la struttura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) dell'oggetto e un carattere di terminazione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-428">Remember, however, that the PIDLs that you return must be relative to the folder and contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure and a terminator.</span></span>

## <a name="implementing-the-optional-interfaces"></a><span data-ttu-id="2b0f0-429">Implementazione delle interfacce facoltative</span><span class="sxs-lookup"><span data-stu-id="2b0f0-429">Implementing the Optional Interfaces</span></span>

<span data-ttu-id="2b0f0-430">Sono disponibili diverse interfacce Shell facoltative che possono essere supportate dagli oggetti cartella dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-430">There are a number of optional Shell interfaces that your extension's folder objects can support.</span></span> <span data-ttu-id="2b0f0-431">Molti di essi, ad esempio [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), consentono di personalizzare diversi aspetti del modo in cui l'utente Visualizza l'estensione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-431">Many of them, such as [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), allow you to customize various aspects of the way the user views your extension.</span></span> <span data-ttu-id="2b0f0-432">Altri, ad esempio [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), consentono all'estensione di supportare funzionalità quali il trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-432">Others, such as [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), allow your extension to support features such as drag-and-drop.</span></span>

<span data-ttu-id="2b0f0-433">Nessuna delle interfacce facoltative è esposta direttamente da un oggetto Folder.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-433">None of the optional interfaces are exposed directly by a folder object.</span></span> <span data-ttu-id="2b0f0-434">Esplora risorse chiama invece uno dei due metodi [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) per richiedere un'interfaccia:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-434">Instead, Windows Explorer calls one of two [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods to request an interface:</span></span>

-   <span data-ttu-id="2b0f0-435">Esplora risorse chiama [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) di un oggetto cartella per richiedere un'interfaccia per uno degli oggetti contenuti nella cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-435">Windows Explorer calls a folder object's [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an interface for one of the objects contained by the folder.</span></span>
-   <span data-ttu-id="2b0f0-436">Esplora risorse chiama [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) di un oggetto cartella per richiedere un'interfaccia per la cartella stessa.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-436">Windows Explorer calls a folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) to request an interface for the folder itself.</span></span>

<span data-ttu-id="2b0f0-437">Per fornire le informazioni, l'oggetto Folder Crea un oggetto che espone l'interfaccia richiesta e restituisce il puntatore a interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-437">To provide the information, the folder object creates an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="2b0f0-438">Esplora risorse chiama quindi l'interfaccia per recuperare le informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-438">Windows Explorer then calls that interface to retrieve the needed information.</span></span> <span data-ttu-id="2b0f0-439">In questa sezione vengono descritte le interfacce facoltative più diffuse.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-439">This section discusses the most commonly used optional interfaces.</span></span>

### <a name="iextracticon"></a><span data-ttu-id="2b0f0-440">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="2b0f0-440">IExtractIcon</span></span>

<span data-ttu-id="2b0f0-441">Esplora risorse richiede un'interfaccia [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) prima di visualizzare il contenuto di una cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-441">Windows Explorer requests an [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface before it displays the contents of a folder.</span></span> <span data-ttu-id="2b0f0-442">L'interfaccia consente all'estensione di specificare icone personalizzate per gli oggetti contenuti nella cartella.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-442">The interface allows your extension to specify custom icons for the objects that are contained by the folder.</span></span> <span data-ttu-id="2b0f0-443">In caso contrario, verranno usate le icone di file e cartelle standard.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-443">Otherwise, the standard file and folder icons will be used.</span></span> <span data-ttu-id="2b0f0-444">Per fornire un'icona personalizzata, creare un oggetto di estrazione icona che espone **IExtractIcon** e restituire un puntatore a tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-444">To provide a custom icon, create an icon extraction object that exposes **IExtractIcon** and return a pointer to that interface.</span></span> <span data-ttu-id="2b0f0-445">Per ulteriori informazioni, vedere la documentazione di riferimento di **IExtractIcon** o [creazione di gestori di icone](./how-to-create-icon-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-445">For further discussion, see the **IExtractIcon** reference documentation or [Creating Icon Handlers](./how-to-create-icon-handlers.md).</span></span>

### <a name="icontextmenu"></a><span data-ttu-id="2b0f0-446">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="2b0f0-446">IContextMenu</span></span>

<span data-ttu-id="2b0f0-447">Quando un utente fa clic con il pulsante destro del mouse su un oggetto, Esplora risorse richiede un'interfaccia [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-447">When a user right-clicks an object, Windows Explorer requests an [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interface.</span></span> <span data-ttu-id="2b0f0-448">Per fornire i menu di scelta rapida per gli oggetti, creare un oggetto gestore di menu e restituire l'interfaccia **IContextMenu** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-448">To provide shortcut menus for your objects, create a menu handler object and return its **IContextMenu** interface.</span></span>

<span data-ttu-id="2b0f0-449">Le procedure per la creazione di un oggetto gestore di menu sono molto simili a quelle utilizzate per creare un'estensione della shell del gestore di menu.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-449">The procedures for creating a menu handler object are very similar to those used to create a menu handler Shell extension.</span></span> <span data-ttu-id="2b0f0-450">Per informazioni dettagliate, vedere [creazione di gestori di menu di scelta rapida](context-menu-handlers.md) o riferimento a [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)o [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-450">For details, see [Creating Context Menu Handlers](context-menu-handlers.md) or the [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2), or [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) reference.</span></span>

### <a name="iqueryinfo"></a><span data-ttu-id="2b0f0-451">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="2b0f0-451">IQueryInfo</span></span>

<span data-ttu-id="2b0f0-452">Esplora risorse chiama l'interfaccia [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) per recuperare una stringa di testo infotip.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-452">Windows Explorer calls the [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) interface to retrieve an infotip text string.</span></span>

### <a name="idataobject-and-idroptarget"></a><span data-ttu-id="2b0f0-453">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="2b0f0-453">IDataObject and IDropTarget</span></span>

<span data-ttu-id="2b0f0-454">Quando gli oggetti vengono visualizzati da Esplora risorse, un oggetto Folder non ha un modo diretto per stabilire quando un utente sta tentando di tagliare, copiare o trascinare un oggetto.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-454">When your objects are displayed by Windows Explorer, a folder object has no direct way to know when a user is attempting to cut, copy, or drag an object.</span></span> <span data-ttu-id="2b0f0-455">In Esplora risorse viene invece richiesta un'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-455">Instead, Windows Explorer requests an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="2b0f0-456">Per consentire il trasferimento dell'oggetto, creare un oggetto dati e restituire un puntatore alla relativa interfaccia **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-456">To allow the object to be transferred, create a data object and return a pointer to its **IDataObject** interface.</span></span>

<span data-ttu-id="2b0f0-457">Analogamente, un utente potrebbe tentare di eliminare un oggetto dati in una rappresentazione di Esplora risorse di uno degli oggetti, ad esempio un'icona o un percorso della barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-457">Similarly, a user might attempt to drop a data object on a Windows Explorer representation of one of your objects, such as an icon or address bar path.</span></span> <span data-ttu-id="2b0f0-458">Esplora risorse richiede quindi un'interfaccia [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="2b0f0-458">Windows Explorer then requests an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="2b0f0-459">Per consentire l'eliminazione dell'oggetto dati, creare un oggetto che espone un'interfaccia **IDropTarget** e restituire il puntatore a interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-459">To allow the data object to be dropped, create an object that exposes an **IDropTarget** interface and return the interface pointer.</span></span>

<span data-ttu-id="2b0f0-460">La gestione del trasferimento dei dati è uno degli aspetti più complicati della scrittura delle estensioni dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="2b0f0-460">Handling data transfer is one of the trickier aspects of writing namespace extensions.</span></span> <span data-ttu-id="2b0f0-461">Per una descrizione dettagliata, vedere [trasferimento di oggetti Shell con trascinamento della selezione e gli appunti](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-461">For a detailed discussion, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

## <a name="working-with-the-default-shell-folder-view-implementation"></a><span data-ttu-id="2b0f0-462">Utilizzo dell'implementazione della visualizzazione della cartella della shell predefinita</span><span class="sxs-lookup"><span data-stu-id="2b0f0-462">Working With the Default Shell Folder View Implementation</span></span>

<span data-ttu-id="2b0f0-463">Le origini dati che usano l'oggetto visualizzazione cartella della shell (DefView) predefinito devono implementare queste interfacce:</span><span class="sxs-lookup"><span data-stu-id="2b0f0-463">Data sources that use the default Shell folder view object (DefView) must implement these interfaces:</span></span>

-   [<span data-ttu-id="2b0f0-464">**IShellFolder**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-464">**IShellFolder**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)
-   [<span data-ttu-id="2b0f0-465">**IShellFolder2**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-465">**IShellFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellfolder2)
-   [<span data-ttu-id="2b0f0-466">**IPersistFolder**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-466">**IPersistFolder**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder)
-   [<span data-ttu-id="2b0f0-467">**IPersistFolder2**</span><span class="sxs-lookup"><span data-stu-id="2b0f0-467">**IPersistFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)

<span data-ttu-id="2b0f0-468">Facoltativamente, possono implementare anche [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="2b0f0-468">Optionally, they can also implement [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span>

 

 
