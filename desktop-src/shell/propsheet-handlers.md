---
description: Quando un utente fa clic con il pulsante destro del mouse su un oggetto Shell, il menu di scelta rapida visualizzato include in genere un elemento proprietà.
title: Gestori della finestra delle proprietà
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103882794"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="1a44b-103">Gestori della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="1a44b-103">Property Sheet Handlers</span></span>

<span data-ttu-id="1a44b-104">Quando un utente fa clic con il pulsante destro del mouse su un oggetto Shell, il menu di scelta rapida visualizzato include in genere un elemento **Proprietà** .</span><span class="sxs-lookup"><span data-stu-id="1a44b-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="1a44b-105">Selezionando tale elemento viene avviata una finestra delle proprietà che consente all'utente di visualizzare e, in alcuni casi, di modificare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="1a44b-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="1a44b-106">È possibile personalizzare questa finestra delle proprietà implementando e registrando un *gestore della finestra delle proprietà*.</span><span class="sxs-lookup"><span data-stu-id="1a44b-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="1a44b-107">Le procedure generali per l'implementazione e la registrazione di un gestore di estensione della shell sono descritte in [creazione di gestori di estensioni della shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1a44b-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="1a44b-108">Questo documento è incentrato sugli aspetti dell'implementazione specifici dei gestori della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="1a44b-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="1a44b-109">Funzionamento del gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="1a44b-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="1a44b-110">Registrazione e implementazione di un gestore della finestra delle proprietà per un'unità montata</span><span class="sxs-lookup"><span data-stu-id="1a44b-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="1a44b-111">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1a44b-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="1a44b-112">Funzionamento del gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="1a44b-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="1a44b-113">Nella figura seguente viene illustrata la finestra delle proprietà proprietà per un file di testo di Windows XP.</span><span class="sxs-lookup"><span data-stu-id="1a44b-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![finestra delle proprietà](images/propsheethandler1.jpg)

<span data-ttu-id="1a44b-115">Questa illustrazione mostra la finestra delle proprietà delle proprietà predefinite visualizzata per qualsiasi file.</span><span class="sxs-lookup"><span data-stu-id="1a44b-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="1a44b-116">Per molte finestre delle proprietà di questo tipo, è possibile aggiungere una o più pagine alla finestra delle proprietà implementando e registrando un gestore della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="1a44b-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="1a44b-117">I gestori della finestra delle proprietà sono più comunemente registrati per un [tipo di file](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="1a44b-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="1a44b-118">Ogni gestore può aggiungere una pagina personalizzata alla finestra delle proprietà delle proprietà per la classe.</span><span class="sxs-lookup"><span data-stu-id="1a44b-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="1a44b-119">Queste pagine consentono in genere agli utenti di accedere alle proprietà specifiche del tipo di file specifico.</span><span class="sxs-lookup"><span data-stu-id="1a44b-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="1a44b-120">Un tipo di file costituito da documenti di testo può, ad esempio, visualizzare una pagina in cui sono elencati il titolo e l'autore e un abstract del documento.</span><span class="sxs-lookup"><span data-stu-id="1a44b-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="1a44b-121">Un caso speciale di questo tipo di gestore della finestra delle proprietà viene utilizzato per aggiungere una pagina alla finestra delle proprietà delle proprietà di un'unità montata.</span><span class="sxs-lookup"><span data-stu-id="1a44b-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="1a44b-122">L'altro uso per i gestori della finestra delle proprietà è quello di sostituire le pagine nelle finestre delle proprietà visualizzate dalle applicazioni del pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="1a44b-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="1a44b-123">Un produttore del mouse, ad esempio, può utilizzare un gestore della finestra delle proprietà per sostituire la pagina dei **pulsanti** della finestra delle proprietà **del** pannello di controllo con una pagina personalizzata per le caratteristiche del mouse.</span><span class="sxs-lookup"><span data-stu-id="1a44b-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="1a44b-124">Come tutti i gestori di estensioni della shell, i gestori della finestra delle proprietà sono oggetti COM (Component Object Model in-process) implementati come dll.</span><span class="sxs-lookup"><span data-stu-id="1a44b-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="1a44b-125">Devono esportare due interfacce, oltre a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) e [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span><span class="sxs-lookup"><span data-stu-id="1a44b-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="1a44b-126">L'interfaccia [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) viene utilizzata dalla Shell per inizializzare il gestore.</span><span class="sxs-lookup"><span data-stu-id="1a44b-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="1a44b-127">Quando la shell chiama [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), passa un oggetto dati con il nome dell'oggetto e il puntatore a un elenco di identificatori di elemento (PIDL) della cartella che contiene il file.</span><span class="sxs-lookup"><span data-stu-id="1a44b-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="1a44b-128">Il parametro *hRegKey* non viene usato con i gestori della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="1a44b-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="1a44b-129">Il metodo **IShellExtInit:: Initialize** deve estrarre il nome del file dall'oggetto dati e archiviare il nome e il PIDL della cartella per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="1a44b-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="1a44b-130">Per ulteriori informazioni, vedere la sezione relativa all' *implementazione di IShellExtInit* in creazione di gestori di [estensioni della shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1a44b-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="1a44b-131">Il resto dell'operazione viene eseguita tramite l'interfaccia [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) del gestore.</span><span class="sxs-lookup"><span data-stu-id="1a44b-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="1a44b-132">Se la finestra delle proprietà è associata a un tipo di file, la shell chiama [**IShellPropSheetExt:: AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) per consentire al gestore di aggiungere una pagina alla finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="1a44b-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="1a44b-133">Se la finestra delle proprietà è associata a un'applicazione del pannello di controllo, la shell chiama [**IShellPropSheetExt:: ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) per consentire al gestore di sostituire una pagina.</span><span class="sxs-lookup"><span data-stu-id="1a44b-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="1a44b-134">Registrazione e implementazione di un gestore della finestra delle proprietà per un'unità montata</span><span class="sxs-lookup"><span data-stu-id="1a44b-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="1a44b-135">Ogni unità montata ha una finestra delle proprietà che può essere visualizzata dall'utente.</span><span class="sxs-lookup"><span data-stu-id="1a44b-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="1a44b-136">Nella figura seguente viene illustrata una finestra delle proprietà delle proprietà per un'unità CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="1a44b-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![finestra delle proprietà delle proprietà del CD-ROM](images/propsheethandler2.jpg)

<span data-ttu-id="1a44b-138">È disponibile un'ampia gamma di dispositivi che possono essere montati come unità.</span><span class="sxs-lookup"><span data-stu-id="1a44b-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="1a44b-139">Poiché la finestra delle proprietà predefinita, progettata per le unità disco, potrebbe non essere sufficiente per alcuni dispositivi, è possibile implementare un gestore della finestra delle proprietà per aggiungere una pagina specifica del dispositivo montato.</span><span class="sxs-lookup"><span data-stu-id="1a44b-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="1a44b-140">L'implementazione di base di questo tipo di gestore della finestra delle proprietà è identica a quella descritta in [come registrare e implementare un gestore della finestra delle proprietà per un tipo di file](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), con due eccezioni.</span><span class="sxs-lookup"><span data-stu-id="1a44b-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="1a44b-141">L'oggetto dati passato al metodo [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) del gestore può contenere il percorso dell'unità nel formato [ \_ MOUNTEDVOLUME CFSTR](clipboard.md) anziché il formato [CF \_ HDROP](clipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="1a44b-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="1a44b-142">Il \_ formato CF HDROP viene usato quando il dispositivo viene montato su una lettera di unità.</span><span class="sxs-lookup"><span data-stu-id="1a44b-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="1a44b-143">Il \_ formato CFSTR MOUNTEDVOLUME viene usato con i file system NTFS quando il dispositivo remoto viene montato in una cartella anziché in una lettera di unità.</span><span class="sxs-lookup"><span data-stu-id="1a44b-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="1a44b-144">Il GUID del gestore viene registrato sotto l' **unità \_ \_ radice delle classi HKEY** \\  \\ **ShellEx** \\ chiave **PropertySheetHandlers** .</span><span class="sxs-lookup"><span data-stu-id="1a44b-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a44b-145">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1a44b-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a44b-146">Come registrare e implementare un gestore della finestra delle proprietà per un tipo di file</span><span class="sxs-lookup"><span data-stu-id="1a44b-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="1a44b-147">Come registrare e implementare un gestore della finestra delle proprietà per un'applicazione del pannello di controllo</span><span class="sxs-lookup"><span data-stu-id="1a44b-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
