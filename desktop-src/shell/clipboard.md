---
description: I formati degli Appunti della shell vengono usati per identificare il tipo di dati della shell trasferiti tramite gli Appunti.
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Formati degli Appunti della shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750266"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="54432-103">Formati degli Appunti della shell</span><span class="sxs-lookup"><span data-stu-id="54432-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="54432-104">I formati degli Appunti della shell vengono usati per identificare il tipo di dati della shell trasferiti tramite gli Appunti.</span><span class="sxs-lookup"><span data-stu-id="54432-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="54432-105">La maggior parte dei formati degli Appunti della shell identifica un tipo di dati, ad esempio un elenco di nomi di file o puntatori a elenchi di identificatori di elemento (PIDL).</span><span class="sxs-lookup"><span data-stu-id="54432-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="54432-106">Tuttavia, alcuni formati vengono usati per la comunicazione tra l'origine e la destinazione.</span><span class="sxs-lookup"><span data-stu-id="54432-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="54432-107">Possono accelerare il processo di trasferimento dei dati supportando operazioni della shell come lo [spostamento ottimizzato](datascenarios.md) e la [delete_on_paste](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="54432-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="54432-108">I dati della shell sono sempre contenuti in un [oggetto dati](dataobject.md) che utilizza una struttura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) come metodo più generale per caratterizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="54432-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="54432-109">Il membro **cfFormat** della struttura viene impostato sul formato degli Appunti per un particolare elemento di dati.</span><span class="sxs-lookup"><span data-stu-id="54432-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="54432-110">Gli altri membri forniscono informazioni aggiuntive, ad esempio il meccanismo di trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="54432-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="54432-111">I dati sono contenuti in una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) associata.</span><span class="sxs-lookup"><span data-stu-id="54432-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="54432-112">Gli identificatori di formato degli Appunti standard hanno il formato CF_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="54432-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="54432-113">Un esempio comune è CF_TEXT, che viene utilizzato per il trasferimento di dati di testo ANSI.</span><span class="sxs-lookup"><span data-stu-id="54432-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="54432-114">Questi identificatori hanno valori predefiniti e possono essere usati direttamente con le strutture [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) .</span><span class="sxs-lookup"><span data-stu-id="54432-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="54432-115">Ad eccezione di [CF_HDROP](#cf_hdrop), gli identificatori di formato della shell non sono predefiniti.</span><span class="sxs-lookup"><span data-stu-id="54432-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="54432-116">Ad eccezione di DragWindow, hanno il formato CFSTR_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="54432-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="54432-117">Per distinguere questi valori da formati predefiniti, vengono spesso definiti semplicemente *formati*.</span><span class="sxs-lookup"><span data-stu-id="54432-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="54432-118">Tuttavia, a differenza dei formati predefiniti, devono essere registrati sia per l'origine che per la destinazione prima di poter essere usati per trasferire i dati.</span><span class="sxs-lookup"><span data-stu-id="54432-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="54432-119">Per registrare un formato della shell, includere il file di intestazione shlobj. h e passare l'identificatore di formato CFSTR_ *xxx* a [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="54432-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="54432-120">Questa funzione restituisce un valore di formato degli Appunti valido, che può quindi essere usato come membro **cfFormat** di una struttura **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="54432-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="54432-121">I formati degli Appunti della shell sono organizzati in tre gruppi, in base al modo in cui vengono usati.</span><span class="sxs-lookup"><span data-stu-id="54432-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="54432-122">Formati per il trasferimento di oggetti del file System</span><span class="sxs-lookup"><span data-stu-id="54432-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="54432-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="54432-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="54432-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="54432-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="54432-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="54432-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="54432-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="54432-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="54432-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="54432-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="54432-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="54432-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="54432-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="54432-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="54432-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="54432-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="54432-131">Formati per il trasferimento di oggetti virtuali</span><span class="sxs-lookup"><span data-stu-id="54432-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="54432-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="54432-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="54432-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="54432-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="54432-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="54432-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="54432-135">CFSTR_SHELLURL (deprecato)</span><span class="sxs-lookup"><span data-stu-id="54432-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="54432-136">Formati per la comunicazione tra l'origine e la destinazione</span><span class="sxs-lookup"><span data-stu-id="54432-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="54432-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="54432-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="54432-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="54432-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="54432-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="54432-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="54432-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="54432-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="54432-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="54432-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="54432-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="54432-144">DragWindow</span><span class="sxs-lookup"><span data-stu-id="54432-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="54432-145">Formati per il trasferimento di oggetti del file System</span><span class="sxs-lookup"><span data-stu-id="54432-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="54432-146">Questi formati vengono usati per trasferire uno o più file o altri oggetti della shell.</span><span class="sxs-lookup"><span data-stu-id="54432-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="54432-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="54432-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="54432-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="54432-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="54432-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="54432-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="54432-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="54432-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="54432-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="54432-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="54432-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="54432-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="54432-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="54432-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="54432-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="54432-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="54432-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="54432-155">CF_HDROP</span></span>

<span data-ttu-id="54432-156">Questo formato degli Appunti viene usato quando si trasferiscono i percorsi di un gruppo di file esistenti.</span><span class="sxs-lookup"><span data-stu-id="54432-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="54432-157">Diversamente dagli altri formati della shell, è predefinito, pertanto non è necessario chiamare [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="54432-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="54432-158">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-159">Il membro **hGlobal** della struttura punta a una struttura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) come membro **hGlobal** .</span><span class="sxs-lookup"><span data-stu-id="54432-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="54432-160">Il membro **Pfile** della struttura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contiene un offset a una matrice di caratteri con terminazione **null** che contiene i nomi file.</span><span class="sxs-lookup"><span data-stu-id="54432-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="54432-161">Se si estrae un formato CF_HDROP da un oggetto dati, è possibile utilizzare [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) per estrarre i singoli nomi di file dall'oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="54432-162">Se si sta creando un CF_HDROP formato da inserire in un oggetto dati, è necessario costruire la matrice di nomi di file.</span><span class="sxs-lookup"><span data-stu-id="54432-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="54432-163">La matrice di nomi di file è costituita da una serie di stringhe, ognuna delle quali contiene un percorso completo di un file, incluso il carattere di terminazione **null** .</span><span class="sxs-lookup"><span data-stu-id="54432-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="54432-164">Un carattere **null** aggiuntivo viene aggiunto alla stringa finale per terminare la matrice.</span><span class="sxs-lookup"><span data-stu-id="54432-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="54432-165">Ad esempio, se i file c: \\temp1.txt e c: \\temp2.txt vengono trasferiti, la matrice di caratteri è simile alla seguente:</span><span class="sxs-lookup"><span data-stu-id="54432-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="54432-166">In questo esempio,' \\ 0' viene usato per rappresentare il carattere **null** , non i caratteri letterali che devono essere inclusi.</span><span class="sxs-lookup"><span data-stu-id="54432-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="54432-167">Se l'oggetto è stato copiato negli Appunti come parte di un'operazione di trascinamento della selezione, il membro **PT** della struttura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contiene le coordinate del punto in cui l'oggetto è stato eliminato.</span><span class="sxs-lookup"><span data-stu-id="54432-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="54432-168">È possibile utilizzare [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) per estrarre le coordinate del cursore.</span><span class="sxs-lookup"><span data-stu-id="54432-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="54432-169">Se questo formato è presente in un oggetto dati, un ciclo di trascinamento OLE simula [**WM_DROPFILES**](wm-dropfiles.md) funzionalità con destinazioni di rilascio non OLE.</span><span class="sxs-lookup"><span data-stu-id="54432-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="54432-170">Questo è importante se l'applicazione è l'origine di un'operazione di trascinamento della selezione in un sistema Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="54432-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="54432-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="54432-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="54432-172">Questo identificatore di formato viene usato con il formato [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) per trasferire i dati come se si trattasse di un file, indipendentemente dal modo in cui viene archiviato.</span><span class="sxs-lookup"><span data-stu-id="54432-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="54432-173">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che rappresenta il contenuto di un file.</span><span class="sxs-lookup"><span data-stu-id="54432-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="54432-174">Il file viene in genere rappresentato come oggetto flusso, evitando di dover inserire il contenuto del file in memoria.</span><span class="sxs-lookup"><span data-stu-id="54432-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="54432-175">In tal caso, il membro **TYMED** della struttura **STGMEDIUM** è impostato su TYMED_ISTREAM e il file è rappresentato da un'interfaccia [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="54432-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="54432-176">Il file può essere anche un oggetto di archiviazione o memoria globale (TYMED_ISTORAGE o TYMED_HGLOBAL).</span><span class="sxs-lookup"><span data-stu-id="54432-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="54432-177">Il formato di CFSTR_FILEDESCRIPTOR associato contiene una struttura [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) per ogni file che specifica il nome e gli attributi del file.</span><span class="sxs-lookup"><span data-stu-id="54432-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="54432-178">La destinazione gestisce i dati associati a un formato CFSTR_FILECONTENTS come se fosse un file.</span><span class="sxs-lookup"><span data-stu-id="54432-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="54432-179">Quando la destinazione chiama [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) per estrarre i dati, specifica un determinato file impostando il membro **lIndex** della struttura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) sull'indice in base zero della struttura [**filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) del file nel formato di [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) associato.</span><span class="sxs-lookup"><span data-stu-id="54432-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="54432-180">La destinazione USA quindi il puntatore di interfaccia restituito o l'handle di memoria globale per estrarre i dati.</span><span class="sxs-lookup"><span data-stu-id="54432-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="54432-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="54432-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="54432-182">Questo identificatore di formato viene usato con il formato [CFSTR_FILECONTENTS](#cfstr_filecontents) per trasferire i dati come un gruppo di file.</span><span class="sxs-lookup"><span data-stu-id="54432-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="54432-183">Questi due formati rappresentano il modo migliore per trasferire gli oggetti Shell che non sono archiviati come file di file System.</span><span class="sxs-lookup"><span data-stu-id="54432-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="54432-184">Questi formati, ad esempio, possono essere usati per trasferire un gruppo di messaggi di posta elettronica come singoli file, anche se ogni messaggio di posta elettronica viene effettivamente archiviato come blocco di dati in un database.</span><span class="sxs-lookup"><span data-stu-id="54432-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="54432-185">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-186">Il membro **hGlobal** della struttura punta a una struttura [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) seguita da una matrice contenente una struttura [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) per ogni file nel gruppo.</span><span class="sxs-lookup"><span data-stu-id="54432-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="54432-187">Per ogni struttura **FileDescriptor** , esiste un formato di CFSTR_FILECONTENTS separato che contiene il contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="54432-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="54432-188">Per identificare il formato di CFSTR_FILECONTENTS di un determinato file, impostare il valore **lIndex** della struttura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) sull'indice in base zero della struttura **FileDescriptor** del file.</span><span class="sxs-lookup"><span data-stu-id="54432-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="54432-189">Il formato CFSTR_FILEDESCRIPTOR viene comunemente usato per trasferire i dati come se fosse un gruppo di file, indipendentemente dal modo in cui sono archiviati.</span><span class="sxs-lookup"><span data-stu-id="54432-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="54432-190">Dal punto di vista della destinazione, ogni formato di CFSTR_FILECONTENTS rappresenta un singolo file e viene trattato di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="54432-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="54432-191">Tuttavia, l'origine può archiviare i dati nel modo scelto.</span><span class="sxs-lookup"><span data-stu-id="54432-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="54432-192">Anche se un formato di CSFTR_FILECONTENTS può corrispondere a un singolo file, potrebbe, ad esempio, rappresentare i dati estratti dall'origine da un database o da un documento di testo.</span><span class="sxs-lookup"><span data-stu-id="54432-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="54432-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="54432-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="54432-194">Questo identificatore di formato viene usato per trasferire un singolo file.</span><span class="sxs-lookup"><span data-stu-id="54432-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="54432-195">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-196">Il membro **hGlobal** della struttura punta a una singola stringa con terminazione **null** contenente il percorso completo del file.</span><span class="sxs-lookup"><span data-stu-id="54432-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="54432-197">Questo formato è stato sostituito da [CF_HDROP](#cf_hdrop), ma è supportato per la compatibilità con le versioni precedenti di Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="54432-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="54432-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="54432-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="54432-199">Questo identificatore di formato viene usato quando un gruppo di file in formato [CF_HDROP](#cf_hdrop) viene rinominato e trasferito.</span><span class="sxs-lookup"><span data-stu-id="54432-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="54432-200">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-201">Il membro **hGlobal** della struttura punta a una matrice di caratteri con terminazione **null** doppia.</span><span class="sxs-lookup"><span data-stu-id="54432-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="54432-202">Questa matrice contiene un nuovo nome per ogni file, nello stesso ordine in cui i file sono elencati nel formato di CF_HDROP associato.</span><span class="sxs-lookup"><span data-stu-id="54432-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="54432-203">Il formato della matrice di caratteri è identico a quello usato da CF_HDROP per elencare i file trasferiti.</span><span class="sxs-lookup"><span data-stu-id="54432-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="54432-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="54432-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="54432-205">Questo identificatore di formato viene usato per trasferire un percorso in un volume montato.</span><span class="sxs-lookup"><span data-stu-id="54432-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="54432-206">È simile a [CF_HDROP](#cf_hdrop), ma contiene solo un singolo percorso e può gestire le stringhe di percorso più lunghe che potrebbero essere necessarie per rappresentare un percorso quando il volume è montato in una cartella.</span><span class="sxs-lookup"><span data-stu-id="54432-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="54432-207">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-208">Il membro **hGlobal** della struttura punta a una singola stringa con terminazione **null** che contiene il percorso completo del file.</span><span class="sxs-lookup"><span data-stu-id="54432-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="54432-209">La stringa di percorso deve terminare con un \\ carattere '', seguito dal carattere **null** di terminazione.</span><span class="sxs-lookup"><span data-stu-id="54432-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="54432-210">Prima di Windows 2000, i volumi potevano essere montati solo su lettere di unità.</span><span class="sxs-lookup"><span data-stu-id="54432-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="54432-211">Per i sistemi Windows 2000 e versioni successive con un'unità formattata NTFS, è anche possibile montare volumi in cartelle vuote.</span><span class="sxs-lookup"><span data-stu-id="54432-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="54432-212">Questa funzionalità consente di montare un volume senza occupare una lettera di unità.</span><span class="sxs-lookup"><span data-stu-id="54432-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="54432-213">Il volume montato può usare qualsiasi formato attualmente supportato, tra cui FAT, FAT32, NTFS e CDFS.</span><span class="sxs-lookup"><span data-stu-id="54432-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="54432-214">È possibile aggiungere pagine a una finestra delle proprietà delle proprietà dell'unità implementando un [gestore della finestra delle proprietà](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="54432-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="54432-215">Se il volume è montato su una lettera di unità, la shell passa informazioni sul percorso al gestore con il formato [CF_HDROP](#cf_hdrop) .</span><span class="sxs-lookup"><span data-stu-id="54432-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="54432-216">Con i sistemi Windows 2000 e versioni successive, il formato CF_HDROP viene usato quando un volume viene montato su una lettera di unità, come nei sistemi precedenti.</span><span class="sxs-lookup"><span data-stu-id="54432-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="54432-217">Tuttavia, se un volume viene montato in una cartella, viene utilizzato l'identificatore di formato [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) anziché CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="54432-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="54432-218">Se per il montaggio dei volumi verranno utilizzate solo le lettere di unità, verranno utilizzati solo [CF_HDROP](#cf_hdrop) e i gestori della finestra delle proprietà esistenti funzioneranno come nei sistemi precedenti.</span><span class="sxs-lookup"><span data-stu-id="54432-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="54432-219">Tuttavia, se si desidera che il gestore visualizzi una pagina per i volumi montati sulle cartelle e le lettere di unità, il gestore deve essere in grado di comprendere sia i formati di CSFTR_MOUNTEDVOLUME che di CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="54432-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="54432-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="54432-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="54432-221">Questo identificatore di formato viene utilizzato quando si trasferiscono i percorsi di uno o più oggetti spazio dei nomi esistenti.</span><span class="sxs-lookup"><span data-stu-id="54432-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="54432-222">Viene usato nello stesso modo in cui [CF_HDROP](#cf_hdrop), ma contiene pidl anziché file System percorsi.</span><span class="sxs-lookup"><span data-stu-id="54432-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="54432-223">L'uso di PIDL consente al formato CFSTR_SHELLIDLIST di gestire gli oggetti virtuali e file system oggetti.</span><span class="sxs-lookup"><span data-stu-id="54432-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="54432-224">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-225">Il membro **hGlobal** della struttura punta a una struttura [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) .</span><span class="sxs-lookup"><span data-stu-id="54432-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="54432-226">Il membro **aoffset** della struttura [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) è una matrice contenente offset all'inizio della struttura [**ItemId**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) per ogni PIDL da trasferire.</span><span class="sxs-lookup"><span data-stu-id="54432-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="54432-227">Per estrarre un PIDL specifico, determinare innanzitutto il relativo indice.</span><span class="sxs-lookup"><span data-stu-id="54432-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="54432-228">Aggiungere quindi il valore **aoffset** che corrisponde a tale indice all'indirizzo della struttura **CIDA** .</span><span class="sxs-lookup"><span data-stu-id="54432-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="54432-229">Il primo elemento di **aoffset** contiene un offset per l'PIDL completo di una cartella padre.</span><span class="sxs-lookup"><span data-stu-id="54432-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="54432-230">Se questo PIDL è vuoto, la cartella padre è il desktop.</span><span class="sxs-lookup"><span data-stu-id="54432-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="54432-231">Ognuno degli elementi rimanenti della matrice contiene un offset a uno dei PIDL da trasferire.</span><span class="sxs-lookup"><span data-stu-id="54432-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="54432-232">Tutti questi PIDL sono relativi al PIDL della cartella padre.</span><span class="sxs-lookup"><span data-stu-id="54432-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="54432-233">È possibile utilizzare le due macro seguenti per recuperare PIDL da una struttura [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) .</span><span class="sxs-lookup"><span data-stu-id="54432-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="54432-234">Il primo accetta un puntatore alla struttura e recupera il PIDL della cartella padre.</span><span class="sxs-lookup"><span data-stu-id="54432-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="54432-235">Il secondo accetta un puntatore alla struttura e recupera uno degli altri PIDL, identificato dall'indice in base zero.</span><span class="sxs-lookup"><span data-stu-id="54432-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="54432-236">Il valore restituito da queste macro è un puntatore alla struttura [**ItemId**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) dell'elemento PIDL.</span><span class="sxs-lookup"><span data-stu-id="54432-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="54432-237">Poiché queste strutture variano di lunghezza, è necessario determinare la fine della struttura scorrendo ognuna delle strutture [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) della struttura **ItemId** , fino a raggiungere il **valore null** a due byte che contrassegna la fine.</span><span class="sxs-lookup"><span data-stu-id="54432-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="54432-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="54432-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="54432-239">Questo identificatore di formato viene usato con formati quali [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist)e [CFSTR_FILECONTENTS](#cfstr_filecontents) per specificare la posizione di un gruppo di oggetti che seguono un trasferimento.</span><span class="sxs-lookup"><span data-stu-id="54432-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="54432-240">I dati sono costituiti da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-241">Il membro **hGlobal** della struttura punta a una matrice di strutture [**Point**](/previous-versions//dd162805(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="54432-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="54432-242">La prima struttura specifica le coordinate dello schermo, in pixel, dell'angolo superiore sinistro del rettangolo che racchiude il gruppo.</span><span class="sxs-lookup"><span data-stu-id="54432-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="54432-243">Il resto delle strutture specifica le posizioni dei singoli oggetti rispetto alla posizione del gruppo.</span><span class="sxs-lookup"><span data-stu-id="54432-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="54432-244">Devono essere nello stesso ordine usato per elencare gli oggetti nel formato associato.</span><span class="sxs-lookup"><span data-stu-id="54432-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="54432-245">Formati per il trasferimento di oggetti virtuali</span><span class="sxs-lookup"><span data-stu-id="54432-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="54432-246">È possibile utilizzare il formato CFSTR_SHELLIDLIST per trasferire sia file system che oggetti virtuali.</span><span class="sxs-lookup"><span data-stu-id="54432-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="54432-247">Tuttavia, esistono anche diversi formati specializzati per il trasferimento di particolari tipi di oggetti virtuali.</span><span class="sxs-lookup"><span data-stu-id="54432-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="54432-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="54432-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="54432-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="54432-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="54432-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="54432-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="54432-251">CFSTR_SHELLURL (deprecato)</span><span class="sxs-lookup"><span data-stu-id="54432-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="54432-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="54432-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="54432-253">Questo identificatore di formato viene utilizzato per il trasferimento di risorse di rete, ad esempio un dominio o un server.</span><span class="sxs-lookup"><span data-stu-id="54432-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="54432-254">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-255">Il membro **hGlobal** della struttura punta a una struttura [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) .</span><span class="sxs-lookup"><span data-stu-id="54432-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="54432-256">Il membro **Nr** della struttura indica una struttura [**netresource**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) il cui membro **lpRemoteName** contiene una stringa con terminazione **null** che identifica la risorsa di rete.</span><span class="sxs-lookup"><span data-stu-id="54432-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="54432-257">L'obiettivo di rilascio può quindi usare i dati con qualsiasi funzione API di rete [(WNet) di Windows](../wnet/windows-networking-wnet-.md) , ad esempio [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), per eseguire operazioni di rete sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="54432-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="54432-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="54432-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="54432-259">Questo identificatore di formato viene utilizzato quando si trasferiscono i nomi descrittivi delle stampanti.</span><span class="sxs-lookup"><span data-stu-id="54432-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="54432-260">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-261">Il membro **hGlobal** della struttura punta a una stringa con lo stesso formato usato con [CF_HDROP](#cf_hdrop).</span><span class="sxs-lookup"><span data-stu-id="54432-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="54432-262">Tuttavia, il membro **Pfile** della struttura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contiene uno o più nomi descrittivi delle stampanti anziché i percorsi di file.</span><span class="sxs-lookup"><span data-stu-id="54432-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="54432-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="54432-263">CFSTR_INETURL</span></span>

<span data-ttu-id="54432-264">Questo identificatore di formato sostituisce [CFSTR_SHELLURL (deprecato)](#cfstr_shellurl-deprecated).</span><span class="sxs-lookup"><span data-stu-id="54432-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="54432-265">Se si vuole che l'applicazione modifichi gli URL degli Appunti, usare CFSTR_INETURL anziché CFSTR_SHELLURL (deprecato).</span><span class="sxs-lookup"><span data-stu-id="54432-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="54432-266">Questo formato offre la migliore rappresentazione degli Appunti di un singolo URL.</span><span class="sxs-lookup"><span data-stu-id="54432-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="54432-267">Se UNICODE non è definito, l'applicazione recupera la versione CF_TEXT/CFSTR_SHELLURL dell'URL.</span><span class="sxs-lookup"><span data-stu-id="54432-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="54432-268">Se è definito UNICODE, l'applicazione recupera la versione CF_UNICODE dell'URL.</span><span class="sxs-lookup"><span data-stu-id="54432-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="54432-269">CFSTR_SHELLURL (deprecato)</span><span class="sxs-lookup"><span data-stu-id="54432-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="54432-270">Questo identificatore di formato è stato deprecato. in alternativa, usare CFSTR_INETURL.</span><span class="sxs-lookup"><span data-stu-id="54432-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="54432-271">Formati per la comunicazione tra l'origine e la destinazione</span><span class="sxs-lookup"><span data-stu-id="54432-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="54432-272">Questi identificatori di formato consentono la comunicazione tra l'origine e la destinazione.</span><span class="sxs-lookup"><span data-stu-id="54432-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="54432-273">I formati accompagnano i dati e offrono alle applicazioni un maggiore livello di controllo sulle operazioni di spostamento-copia-incolla o di trascinamento della selezione che coinvolgono oggetti della shell.</span><span class="sxs-lookup"><span data-stu-id="54432-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="54432-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="54432-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="54432-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="54432-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="54432-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="54432-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="54432-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="54432-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="54432-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="54432-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="54432-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="54432-281">DragWindow</span><span class="sxs-lookup"><span data-stu-id="54432-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="54432-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="54432-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="54432-283">Questo identificatore di formato viene usato da un oggetto dati per indicare se si trova in un ciclo di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="54432-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="54432-284">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-285">Il membro **hGlobal** della struttura punta a un valore **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="54432-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="54432-286">Se il valore **DWORD** è diverso da zero, l'oggetto dati si trova all'interno di un ciclo di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="54432-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="54432-287">Se il valore è impostato su zero, l'oggetto dati non si trova all'interno di un ciclo di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="54432-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="54432-288">Alcune destinazioni di rilascio potrebbero chiamare [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) e tentare di estrarre i dati mentre l'oggetto si trova ancora nel ciclo di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="54432-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="54432-289">Il rendering completo dell'oggetto per ogni occorrenza può causare lo stallo del cursore di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="54432-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="54432-290">Se l'oggetto dati supporta [CFSTR_INDRAGLOOP](#cfstr_indragloop), la destinazione può invece utilizzare tale formato per verificare lo stato del ciclo di trascinamento della selezione ed evitare il rendering intensivo della memoria dell'oggetto fino a quando non viene effettivamente eliminato.</span><span class="sxs-lookup"><span data-stu-id="54432-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="54432-291">I formati con utilizzo intensivo di memoria per il rendering devono comunque essere inclusi nell'enumeratore [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) e nelle chiamate a [**IDataObject:: QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span><span class="sxs-lookup"><span data-stu-id="54432-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="54432-292">Se l'oggetto dati non imposta CFSTR_INDRAGLOOP, deve fungere da se il valore è impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="54432-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="54432-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="54432-294">[Versione 5,0.](versions.md) Questo identificatore di formato consente a un'origine di rilascio di chiamare il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) dell'oggetto dati per determinare il risultato di un trasferimento dei dati della shell.</span><span class="sxs-lookup"><span data-stu-id="54432-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="54432-295">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-296">Il membro **hGlobal** della struttura punta a un valore DWORD contenente un valore [**DropEffect**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="54432-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="54432-297">L'identificatore di formato [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) è stato progettato per consentire alla destinazione di indicare all'oggetto dati l'operazione effettivamente eseguita.</span><span class="sxs-lookup"><span data-stu-id="54432-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="54432-298">Tuttavia, la Shell utilizza gli [spostamenti ottimizzati](datascenarios.md) per gli oggetti di file System quando possibile.</span><span class="sxs-lookup"><span data-stu-id="54432-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="54432-299">In tal caso, la shell imposta in genere il valore CFSTR_PERFORMEDDROPEFFECT su DROPEFFECT_NONE, per indicare all'oggetto dati che i dati originali sono stati eliminati.</span><span class="sxs-lookup"><span data-stu-id="54432-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="54432-300">Pertanto, l'origine non può utilizzare il valore CFSTR_PERFORMEDDROPEFFECT per determinare quale operazione è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="54432-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="54432-301">Sebbene la maggior parte delle origini non necessiti di queste informazioni, esistono alcune eccezioni.</span><span class="sxs-lookup"><span data-stu-id="54432-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="54432-302">Ad esempio, anche se lo spostamento ottimizzato Elimina la necessità che un'origine elimini tutti i dati, è possibile che l'origine debba comunque aggiornare un database correlato per indicare che i file sono stati spostati o copiati.</span><span class="sxs-lookup"><span data-stu-id="54432-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="54432-303">Se un'origine deve stabilire quale operazione ha avuto luogo, può chiamare il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) dell'oggetto dati e richiedere il formato CFSTR_LOGICALPERFORMEDDROPEFFECT.</span><span class="sxs-lookup"><span data-stu-id="54432-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="54432-304">Questo formato riflette essenzialmente ciò che accade dal punto di vista dell'utente dopo che l'operazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="54432-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="54432-305">Se viene creato un nuovo file e viene eliminato il file originale, l'utente visualizza un'operazione di spostamento e il valore dei dati del formato è impostato su DROPEFFECT_MOVE.</span><span class="sxs-lookup"><span data-stu-id="54432-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="54432-306">Se il file originale è ancora presente, l'utente visualizza un'operazione di copia e il valore dei dati del formato è impostato su DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="54432-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="54432-307">Se è stato creato un collegamento, il valore dei dati del formato verrà DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="54432-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="54432-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="54432-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="54432-309">Questo identificatore di formato viene usato dalla destinazione per informare l'oggetto dati, tramite il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) , che un'operazione Delete-on-paste ha avuto esito positivo.</span><span class="sxs-lookup"><span data-stu-id="54432-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="54432-310">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-311">Il membro **hGlobal** della struttura punta a un valore **DWORD** contenente un valore [**DropEffect**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="54432-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="54432-312">Questo formato viene utilizzato per notificare all'oggetto dati che deve completare l'operazione di taglio ed eliminare i dati originali, se necessario.</span><span class="sxs-lookup"><span data-stu-id="54432-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="54432-313">Per altre informazioni, vedere [operazioni delete-on-paste](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="54432-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="54432-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="54432-315">Questo identificatore di formato viene usato dalla destinazione per informare l'oggetto dati tramite il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) del risultato di un trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="54432-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="54432-316">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-317">Il membro **hGlobal** della struttura punta a un valore **DWORD** impostato sul valore [**DROPEFFECT**](../com/dropeffect-constants.md) appropriato, in genere DROPEFFECT_MOVE o DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="54432-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="54432-318">Questo formato viene in genere usato quando il risultato di un'operazione può essere uno spostamento o una copia, ad esempio in un'operazione di spostamento o eliminazione su Incolla [ottimizzata](datascenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="54432-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="54432-319">Fornisce un modo affidabile per la destinazione per indicare all'oggetto dati cosa si è effettivamente verificato.</span><span class="sxs-lookup"><span data-stu-id="54432-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="54432-320">È stata introdotta perché il valore di *pdwEffect* restituito da [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) non indica in modo affidabile quale operazione è avvenuta.</span><span class="sxs-lookup"><span data-stu-id="54432-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="54432-321">Il formato [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) è il modo affidabile per indicare che si è verificato uno spostamento non ottimizzato.</span><span class="sxs-lookup"><span data-stu-id="54432-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="54432-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="54432-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="54432-323">Questo identificatore di formato viene usato dall'origine per specificare se il metodo preferito per il trasferimento dei dati è lo spostamento o la copia.</span><span class="sxs-lookup"><span data-stu-id="54432-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="54432-324">Un obiettivo di rilascio richiede questo formato chiamando il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) dell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="54432-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="54432-325">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-326">Il membro **hGlobal** della struttura punta a un valore **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="54432-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="54432-327">Questo valore è impostato su DROPEFFECT_MOVE se un'operazione di spostamento è preferibile o DROPEFFECT_COPY se è preferibile un'operazione di copia.</span><span class="sxs-lookup"><span data-stu-id="54432-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="54432-328">Questa funzionalità viene utilizzata quando un'origine può supportare un'operazione di spostamento o copia.</span><span class="sxs-lookup"><span data-stu-id="54432-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="54432-329">Usa il formato [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) per comunicare la propria preferenza alla destinazione.</span><span class="sxs-lookup"><span data-stu-id="54432-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="54432-330">Poiché la destinazione non è obbligata a rispettare la richiesta, la destinazione deve chiamare il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) dell'origine con un formato [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) per indicare all'oggetto dati l'operazione effettivamente eseguita.</span><span class="sxs-lookup"><span data-stu-id="54432-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="54432-331">Con un'operazione [Delete-on-paste](datascenarios.md) , il formato CFSTR_PREFERREDDROPFORMAT viene usato per indicare alla destinazione se l'origine ha fatto un taglio o una copia.</span><span class="sxs-lookup"><span data-stu-id="54432-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="54432-332">Con un'operazione di trascinamento della selezione, è possibile usare CFSTR_PREFERREDDROPFORMAT per specificare l'azione della shell.</span><span class="sxs-lookup"><span data-stu-id="54432-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="54432-333">Se questo formato non è presente, la shell esegue un'azione predefinita, in base al contesto.</span><span class="sxs-lookup"><span data-stu-id="54432-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="54432-334">Ad esempio, se un utente trascina un file da un volume e lo rilascia in un altro volume, l'azione predefinita della Shell consiste nel copiare il file.</span><span class="sxs-lookup"><span data-stu-id="54432-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="54432-335">Includendo un formato CFSTR_PREFERREDDROPFORMAT nell'oggetto dati, è possibile eseguire l'override dell'azione predefinita e indicare in modo esplicito alla shell di copiare, spostare o collegare il file.</span><span class="sxs-lookup"><span data-stu-id="54432-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="54432-336">Se l'utente sceglie di trascinare con il pulsante destro, CFSTR_PREFERREDDROPFORMAT specifica il comando predefinito nel menu di scelta rapida del [trascinamento della selezione](context-menu-handlers.md) .</span><span class="sxs-lookup"><span data-stu-id="54432-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="54432-337">L'utente è ancora libero di scegliere altri comandi nel menu.</span><span class="sxs-lookup"><span data-stu-id="54432-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="54432-338">Prima di Microsoft Internet Explorer 4,0, un'applicazione indicava che era in corso il trasferimento dei tipi di file di collegamento impostando FD_LINKUI nel membro **dwFlags** della struttura [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) .</span><span class="sxs-lookup"><span data-stu-id="54432-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="54432-339">Le destinazioni hanno quindi dovuto usare una chiamata potenzialmente dispendiosa in termini di tempo a [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) per verificare se è stato impostato il flag di FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="54432-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="54432-340">A questo punto, il modo migliore per indicare che i collegamenti vengono trasferiti consiste nell'usare il formato CFSTR_PREFERREDDROPEFFECT impostato su DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="54432-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="54432-341">Per la compatibilità con le versioni precedenti, tuttavia, le origini devono comunque impostare il flag di FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="54432-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="54432-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="54432-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="54432-343">Questo identificatore di formato viene utilizzato da una destinazione per fornire il relativo CLSID all'origine.</span><span class="sxs-lookup"><span data-stu-id="54432-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="54432-344">I dati sono una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-345">Il membro **hGlobal** della struttura punta al GUID CLSID dell'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="54432-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="54432-346">Questo formato viene usato principalmente per consentire l'eliminazione degli oggetti trascinandoli nel Cestino.</span><span class="sxs-lookup"><span data-stu-id="54432-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="54432-347">Quando un oggetto viene eliminato nel Cestino, viene chiamato il metodo [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) dell'origine con un formato di CFSTR_TARGETCLSID impostato sul CLSID del cestino (CLSID_RecycleBin).</span><span class="sxs-lookup"><span data-stu-id="54432-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="54432-348">L'origine può quindi eliminare l'oggetto originale.</span><span class="sxs-lookup"><span data-stu-id="54432-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="54432-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="54432-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="54432-350">Questo identificatore di formato viene utilizzato da Windows Internet Explorer e dalla shell di Windows per fornire un meccanismo tramite il quale bloccare o richiedere operazioni di trascinamento della selezione provenienti da Internet Explorer insieme al flag di [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="54432-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="54432-351">**CFSTR_UNTRUSTEDDRAGDROP** viene aggiunto dall'origine di un'operazione di trascinamento della selezione per specificare che l'oggetto dati potrebbe contenere dati non attendibili.</span><span class="sxs-lookup"><span data-stu-id="54432-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="54432-352">I dati sono rappresentati da una struttura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) che contiene un oggetto memoria globale.</span><span class="sxs-lookup"><span data-stu-id="54432-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="54432-353">Il membro **hGlobal** della struttura punta a un **valore DWORD** impostato su un flag di [**azione URL**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) appropriato per fare in modo che un criterio controlli tramite il metodo [**IInternetSecurityManager::P rocessurlaction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) , usando il flag di [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="54432-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="54432-354">DragWindow</span><span class="sxs-lookup"><span data-stu-id="54432-354">DragWindow</span></span>

<span data-ttu-id="54432-355">Questo formato viene usato in un'operazione di trascinamento della selezione per identificare l'immagine di trascinamento di un oggetto (finestra), in modo che le informazioni visive possano essere aggiornate dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="54432-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="54432-356">Quando un oggetto viene trascinato su un obiettivo di rilascio, un'applicazione aggiorna la struttura [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) in risposta al metodo [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) o [**IDropSource:: GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) .</span><span class="sxs-lookup"><span data-stu-id="54432-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="54432-357">**DROPDESCRIPTION** viene aggiornato con un nuovo valore [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) che indica la decorazione da applicare all'oggetto visivo della finestra di trascinamento. ad esempio, un'indicazione che indica che il file viene copiato anziché spostato o che l'oggetto non può essere eliminato in tale posizione.</span><span class="sxs-lookup"><span data-stu-id="54432-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="54432-358">Tuttavia, finché l'oggetto non riceve un messaggio di [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) , gli oggetti visivi non vengono aggiornati.</span><span class="sxs-lookup"><span data-stu-id="54432-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="54432-359">Questo formato fornisce l' **HWND** della finestra di trascinamento del destinatario al mittente del messaggio di **DDWM_UPDATEWINDOW** .</span><span class="sxs-lookup"><span data-stu-id="54432-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="54432-360">I dati degli Appunti sono di tipo [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span><span class="sxs-lookup"><span data-stu-id="54432-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="54432-361">Si tratta di una rappresentazione **DWORD** di un **HWND**.</span><span class="sxs-lookup"><span data-stu-id="54432-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="54432-362">I dati possono essere passati alla funzione **ULongToHandle** , definita in Basetsd. h, per fornire un **HWND** a 64 bit da usare in Windows a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="54432-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="54432-363">Questo formato non richiede l'inclusione di Shlobj. h.</span><span class="sxs-lookup"><span data-stu-id="54432-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
