---
description: Questo argomento descrive alcuni aspetti da considerare quando si usano le librerie nel programma.
ms.assetid: 40ACC8F6-1416-4390-A8D7-8F924DC2C2FE
title: Uso delle librerie nel programma
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2812a66b148d9bd16fc3951efab64a4d37afaaff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104350356"
---
# <a name="using-libraries-in-your-program"></a><span data-ttu-id="d1806-103">Uso delle librerie nel programma</span><span class="sxs-lookup"><span data-stu-id="d1806-103">Using Libraries in your Program</span></span>

<span data-ttu-id="d1806-104">Questo argomento descrive alcuni aspetti da considerare quando si usano le librerie nel programma.</span><span class="sxs-lookup"><span data-stu-id="d1806-104">This topic describes some of the things to consider when using libraries in your program.</span></span>

<span data-ttu-id="d1806-105">In questo argomento</span><span class="sxs-lookup"><span data-stu-id="d1806-105">In this topic:</span></span>

-   [<span data-ttu-id="d1806-106">Panoramica della programmazione della libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-106">Library programming overview</span></span>](#library-programming-overview)
-   [<span data-ttu-id="d1806-107">Programmazione con le librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-107">Programming with Libraries</span></span>](#programming-with-libraries)
    -   [<span data-ttu-id="d1806-108">Passaggio da cartelle note a librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-108">Moving from Known Folders to Libraries</span></span>](#moving-from-known-folders-to-libraries)
    -   [<span data-ttu-id="d1806-109">Gruppo Home e librerie condivise</span><span class="sxs-lookup"><span data-stu-id="d1806-109">HomeGroup and shared libraries</span></span>](#homegroup-and-shared-libraries)
-   [<span data-ttu-id="d1806-110">Utilizzo di una finestra di dialogo file comune con le librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-110">Using a common file dialog box with libraries</span></span>](#using-a-common-file-dialog-box-with-libraries)
-   [<span data-ttu-id="d1806-111">Abilitazione della selezione della libreria dall'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="d1806-111">Enabling library selection from the user interface</span></span>](#enabling-library-selection-from-the-user-interface)
-   [<span data-ttu-id="d1806-112">Accesso al contenuto della libreria in un programma</span><span class="sxs-lookup"><span data-stu-id="d1806-112">Accessing library content in a program</span></span>](#accessing-library-content-in-a-program)
    -   [<span data-ttu-id="d1806-113">Accesso al contenuto della libreria con l'interfaccia IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="d1806-113">Accessing library content with the IShellLibrary interface</span></span>](#accessing-library-content-with-the-ishelllibrary-interface)
    -   [<span data-ttu-id="d1806-114">Accesso al contenuto della libreria con le API della shell</span><span class="sxs-lookup"><span data-stu-id="d1806-114">Accessing library content with the Shell APIs</span></span>](#accessing-library-content-with-the-shell-apis)
-   [<span data-ttu-id="d1806-115">Salvataggio del contenuto utente in una raccolta</span><span class="sxs-lookup"><span data-stu-id="d1806-115">Saving user content in a library</span></span>](#saving-user-content-in-a-library)
-   [<span data-ttu-id="d1806-116">Supporto delle operazioni di trascinamento della selezione in una libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-116">Supporting drag-and-drop operations in a library</span></span>](#supporting-drag-and-drop-operations-in-a-library)
-   [<span data-ttu-id="d1806-117">Mantenimento della sincronizzazione con una libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-117">Keeping in sync with a library</span></span>](#keeping-in-sync-with-a-library)
    -   [<span data-ttu-id="d1806-118">Aggiornamento bulk</span><span class="sxs-lookup"><span data-stu-id="d1806-118">Bulk Update</span></span>](#bulk-update)
    -   [<span data-ttu-id="d1806-119">Notifica API shell</span><span class="sxs-lookup"><span data-stu-id="d1806-119">Shell API Notification</span></span>](#shell-api-notification)
    -   [<span data-ttu-id="d1806-120">Notifica dell'API del file System</span><span class="sxs-lookup"><span data-stu-id="d1806-120">File-system API Notification</span></span>](#file-system-api-notification)
-   [<span data-ttu-id="d1806-121">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d1806-121">Related topics</span></span>](#related-topics)

## <a name="library-programming-overview"></a><span data-ttu-id="d1806-122">Panoramica della programmazione della libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-122">Library programming overview</span></span>

<span data-ttu-id="d1806-123">Le librerie consentono agli utenti di organizzare il contenuto basato su file in modo significativo e non limitato dall'organizzazione del file system.</span><span class="sxs-lookup"><span data-stu-id="d1806-123">Libraries enable users to organize their file-based content in a way that is meaningful to them and not limited by the organization of the file system.</span></span> <span data-ttu-id="d1806-124">Quando il programma supporta le librerie, consente all'utente di trovare il contenuto in modo che abbia senso, presentando un'interfaccia utente coerente con l'esperienza utente di Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-124">When your program supports libraries, it allows the user to find their content in a way that makes sense to them while presenting a user interface that is consistent with the Windows 7 user experience.</span></span> <span data-ttu-id="d1806-125">Le librerie consentono inoltre al programma di individuare in modo più semplice contenuto basato su file archiviato in cartelle diverse o in computer diversi.</span><span class="sxs-lookup"><span data-stu-id="d1806-125">Libraries also make it easier for your program to locate file-based content that is stored in different folders or on different machines.</span></span>

<span data-ttu-id="d1806-126">Negli argomenti di questa sezione viene descritto come aggiungere il supporto della libreria al programma e sfruttare le nuove funzionalità offerte dalle librerie.</span><span class="sxs-lookup"><span data-stu-id="d1806-126">The topics in this section describe how you can add library support to your program and take advantage of the new capabilities that libraries offer.</span></span> <span data-ttu-id="d1806-127">Windows 7 fornisce parte del supporto per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="d1806-127">Windows 7 provides some of this support by default.</span></span> <span data-ttu-id="d1806-128">Se il programma non modifica le finestre di dialogo file comuni attualmente in uso, potrebbe essere necessaria una programmazione aggiuntiva minima per supportare le librerie.</span><span class="sxs-lookup"><span data-stu-id="d1806-128">If your program does not modify the common file dialog boxes that it currently uses, it might require very little additional programming to support libraries.</span></span>

<span data-ttu-id="d1806-129">In questa sezione vengono descritte alcune delle funzionalità chiave fornite dalle librerie e il modo in cui supportarle nel programma.</span><span class="sxs-lookup"><span data-stu-id="d1806-129">This section describes some of the key features that libraries provide and how to support them in your program.</span></span> <span data-ttu-id="d1806-130">Con queste informazioni, è possibile decidere quali funzionalità forniranno la migliore esperienza utente dal programma.</span><span class="sxs-lookup"><span data-stu-id="d1806-130">With this information, you can decide which features will provide the best user experience from your program.</span></span> <span data-ttu-id="d1806-131">Se il programma Personalizza le finestre di dialogo file comuni, le informazioni contenute in questa sezione consentono di determinare come utilizzare le nuove finestre di dialogo file comuni per utilizzare le librerie e fornire funzionalità equivalenti in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-131">If your program customizes the common file dialog boxes, the information in this section can help you determine how to use the new common file dialog boxes to use libraries and provide equivalent functionality in Windows 7.</span></span>

## <a name="programming-with-libraries"></a><span data-ttu-id="d1806-132">Programmazione con le librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-132">Programming with Libraries</span></span>

<span data-ttu-id="d1806-133">Il modello di programmazione shell di Windows descrive il modo in cui un programma interagisce con gli oggetti di programmazione della shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="d1806-133">The Windows Shell programming model describes how a program interacts with Windows Shell programming objects.</span></span> <span data-ttu-id="d1806-134">Mentre gli oggetti di file System, ad esempio file e directory, sono rappresentati da oggetti della shell di Windows, non tutti gli oggetti della shell di Windows sono rappresentati dal file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-134">While file-system objects, such as files and directories, are represented by Windows Shell objects, not all Windows Shell objects are represented by the file-system.</span></span> <span data-ttu-id="d1806-135">Le librerie, ad esempio, sono oggetti della shell di Windows che non hanno un equivalente del file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-135">Libraries, for example, are Windows Shell objects that do not have a file-system equivalent.</span></span> <span data-ttu-id="d1806-136">L'uso di oggetti della shell di Windows nel programma consente al programma di accedere a tutti gli oggetti della shell e non solo a oggetti di file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-136">Using Windows Shell objects in your program enables your program to access all Shell objects and not just file-system objects.</span></span>

<span data-ttu-id="d1806-137">Per ottenere risultati ottimali, il programma utilizzerà l' [**API della libreria della shell**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) per interagire con le librerie e accedere al contenuto.</span><span class="sxs-lookup"><span data-stu-id="d1806-137">For the best results, your program would use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) to interact with libraries and access their contents.</span></span> <span data-ttu-id="d1806-138">Mentre le librerie contengono elementi di file System, ad esempio cartelle e file, le librerie non sono elementi del file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-138">While libraries contain file-system items such as folders and files, libraries are not file-system items.</span></span> <span data-ttu-id="d1806-139">Di conseguenza, non è possibile utilizzare le API del file System per accedere alle funzionalità della libreria o al contenuto della raccolta.</span><span class="sxs-lookup"><span data-stu-id="d1806-139">As such, file-system APIs cannot be used to access library features or library contents.</span></span>

<span data-ttu-id="d1806-140">Se si dispone di un programma esistente che attualmente usa molte API del file System, il programma può comunque sfruttare le funzionalità della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-140">If you have an existing program that currently uses many file-system APIs, your program can still take advantage of library features.</span></span> <span data-ttu-id="d1806-141">L' [**API della libreria della shell**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) può fornire riferimenti a file System agli elementi presenti in una raccolta e questi riferimenti del file System, ad esempio il nome e il percorso del file, possono essere passati alle API del file System esistente presenti nel programma esistente.</span><span class="sxs-lookup"><span data-stu-id="d1806-141">The [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) can provide file-system references to the items that are found in a library and these file-system references, such as the file name and path, can be passed to the existing file-system APIs that are in your existing program.</span></span>

### <a name="moving-from-known-folders-to-libraries"></a><span data-ttu-id="d1806-142">Passaggio da cartelle note a librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-142">Moving from Known Folders to Libraries</span></span>

<span data-ttu-id="d1806-143">Prima di Windows 7, era comune usare una cartella nota, ad esempio la cartella documenti, come cartella predefinita in operazioni di salvataggio file o file aperti.</span><span class="sxs-lookup"><span data-stu-id="d1806-143">Before Windows 7 it was common to use a known folder, such as the My Documents folder, as the default folder in file save or file open operations.</span></span> <span data-ttu-id="d1806-144">In Windows 7, è necessario utilizzare la libreria corrispondente in modo che l'utente abbia la stessa esperienza del programma in uso con altri programmi di Windows 7, ad esempio Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="d1806-144">In Windows 7, the corresponding library should be used so the user will have the same experience in your program as they would with other Windows 7 programs, such as the Windows Explorer.</span></span>

<span data-ttu-id="d1806-145">Se attualmente si usa l'API shell di Windows nel programma, l'aggiunta del supporto per le librerie è semplice.</span><span class="sxs-lookup"><span data-stu-id="d1806-145">If you are currently using the Windows Shell API in your program, adding library support is straightforward.</span></span> <span data-ttu-id="d1806-146">Se, ad esempio, si chiama la funzione [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) per ottenere il percorso della cartella documenti, è possibile sostituire il valore [**KNOWNFOLDERID**](knownfolderid.md) della cartella documenti nota con il valore **KNOWNFOLDERID** della libreria corrispondente.</span><span class="sxs-lookup"><span data-stu-id="d1806-146">For example, if you currently call the [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) function to get the location of the My Documents folder, you can replace the [**KNOWNFOLDERID**](knownfolderid.md) value of the My Documents known folder with the **KNOWNFOLDERID** value of the corresponding library.</span></span>

<span data-ttu-id="d1806-147">Nella tabella seguente viene illustrata la relazione tra i valori [**KNOWNFOLDERID**](knownfolderid.md) delle cartelle note e il valore **KNOWNFOLDERID** della libreria corrispondente in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-147">The following table shows the relationship between the [**KNOWNFOLDERID**](knownfolderid.md) values of known folders and the **KNOWNFOLDERID** value of the corresponding library in Windows 7.</span></span> 

| <span data-ttu-id="d1806-148">Valori KNOWNFOLDERID cartella nota</span><span class="sxs-lookup"><span data-stu-id="d1806-148">Known Folder KNOWNFOLDERID values</span></span> | <span data-ttu-id="d1806-149">Valori KNOWNFOLDERID della libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-149">Library KNOWNFOLDERID values</span></span> |
|-----------------------------------|------------------------------|
| <span data-ttu-id="d1806-150">\_Documenti FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-150">FOLDERID\_Documents</span></span>               | <span data-ttu-id="d1806-151">\_DOCUMENTSLIBRARY FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-151">FOLDERID\_DocumentsLibrary</span></span>   |
| <span data-ttu-id="d1806-152">Immagini di FOLDERID \_</span><span class="sxs-lookup"><span data-stu-id="d1806-152">FOLDERID\_Pictures</span></span>                | <span data-ttu-id="d1806-153">\_PICTURESLIBRARY FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-153">FOLDERID\_PicturesLibrary</span></span>    |
| <span data-ttu-id="d1806-154">\_Musica FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-154">FOLDERID\_Music</span></span>                   | <span data-ttu-id="d1806-155">\_MUSICLIBRARY FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-155">FOLDERID\_MusicLibrary</span></span>       |
| <span data-ttu-id="d1806-156">\_RECORDEDTV FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-156">FOLDERID\_RecordedTV</span></span>              | <span data-ttu-id="d1806-157">\_RECORDEDTVLIBRARY FOLDERID</span><span class="sxs-lookup"><span data-stu-id="d1806-157">FOLDERID\_RecordedTVLibrary</span></span>  |



 

### <a name="homegroup-and-shared-libraries"></a><span data-ttu-id="d1806-158">Gruppo Home e librerie condivise</span><span class="sxs-lookup"><span data-stu-id="d1806-158">HomeGroup and shared libraries</span></span>

<span data-ttu-id="d1806-159">L'aggiunta del supporto per la libreria al programma Abilita il supporto per le librerie condivise in un gruppo Home.</span><span class="sxs-lookup"><span data-stu-id="d1806-159">Adding library support to your program will enable support for shared libraries in a HomeGroup.</span></span> <span data-ttu-id="d1806-160">Il gruppo Home è identificato dal relativo valore [**KNOWNFOLDERID**](knownfolderid.md) di [**FOLDERID \_ Gruppo Home**](knownfolderid.md).</span><span class="sxs-lookup"><span data-stu-id="d1806-160">The HomeGroup is identified by its [**KNOWNFOLDERID**](knownfolderid.md) value of [**FOLDERID\_HomeGroup**](knownfolderid.md).</span></span> <span data-ttu-id="d1806-161">Il programma può individuare il percorso di salvataggio predefinito privato o condiviso dell'utente impostando il valore [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) nella chiamata al metodo [**IShellLibrary:: GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) .</span><span class="sxs-lookup"><span data-stu-id="d1806-161">Your program can find identify the user's private or shared default save location by setting the [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) value in the call to [**IShellLibrary::GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) method.</span></span>

## <a name="using-a-common-file-dialog-box-with-libraries"></a><span data-ttu-id="d1806-162">Utilizzo di una finestra di dialogo file comune con le librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-162">Using a common file dialog box with libraries</span></span>

<span data-ttu-id="d1806-163">Utilizzo di una finestra di dialogo file comune con le librerie la finestra di dialogo file comune è stata aggiornata per supportare le librerie in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-163">Using a common file dialog box with libraries The common file dialog box has been updated to support libraries in Windows 7.</span></span> <span data-ttu-id="d1806-164">Nella figura seguente viene illustrato come viene visualizzata la finestra di dialogo file comune di un utente in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-164">The following illustration shows how the common file dialog box appears to a user in Windows 7.</span></span>

![screenshot della finestra di dialogo file comune che mostra le librerie](images/libraries-commonfiledialog.png)

<span data-ttu-id="d1806-166">In Windows 7, se il programma visualizza attualmente una finestra di dialogo file comune e non modifica il modello della finestra di dialogo o non associa alcun evento, verrà visualizzata automaticamente la nuova versione di Windows 7 della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="d1806-166">In Windows 7, if your program currently displays a common file dialog box and does not change the dialog box template or hook any of its events, it will display the new Windows 7 version of the dialog box automatically.</span></span> <span data-ttu-id="d1806-167">In particolare, nella chiamata alla funzione della finestra di dialogo file comune i membri **lpfnHook**, **HINSTANCE**, **lpTemplatename** della struttura [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) devono essere **null** **e i flag OFN ENABLEHOOK \_** e **OFN \_ ENABLETEMPLATE** devono essere cancellati.</span><span class="sxs-lookup"><span data-stu-id="d1806-167">Specifically, in the call to the common file dialog box function, the **lpfnHook**, **hInstance**, **lpTemplatename** members of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must be **NULL** and the **OFN\_ENABLEHOOK** and **OFN\_ENABLETEMPLATE** flags must be clear.</span></span>

<span data-ttu-id="d1806-168">In Windows 7 le interfacce correlate a [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)sostituiscono le funzioni della finestra di dialogo file comuni utilizzate nelle versioni precedenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="d1806-168">In Windows 7, the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces replace the common file dialog box functions that were used in earlier versions of Windows.</span></span> <span data-ttu-id="d1806-169">Le funzioni della finestra di dialogo file comuni precedenti sono ancora supportate in Windows 7 ma non offrono l'esperienza utente completa di Windows 7 e non supportano le librerie.</span><span class="sxs-lookup"><span data-stu-id="d1806-169">The earlier common file dialog box functions are still supported in Windows 7 but they do not provide the complete Windows 7 user experience and they do not support libraries.</span></span> <span data-ttu-id="d1806-170">Di seguito sono riportate alcune delle nuove funzionalità supportate dalle interfacce correlate a **IFileDialog**:</span><span class="sxs-lookup"><span data-stu-id="d1806-170">Some of the new features supported by the **IFileDialog**-related interfaces include:</span></span>

-   <span data-ttu-id="d1806-171">L'utente può accedere alle proprietà del file supportate da Esplora risorse di Windows 7 per la ricerca e la selezione dei file.</span><span class="sxs-lookup"><span data-stu-id="d1806-171">The user can access the file properties supported by the Windows 7 Windows Explorer to search and select the files.</span></span>
-   <span data-ttu-id="d1806-172">Il programma può usare interfacce e metodi dell'API dello spazio dei nomi della Shell per lavorare con gli elementi.</span><span class="sxs-lookup"><span data-stu-id="d1806-172">The program can use interfaces and methods from the Shell namespace API to work with the items.</span></span>
-   <span data-ttu-id="d1806-173">Il programma può utilizzare un modello di personalizzazione basato sui dati anziché un modello di personalizzazione basato sui file di risorse per aggiungere nuovi controlli alle finestre di dialogo file comuni.</span><span class="sxs-lookup"><span data-stu-id="d1806-173">The program can use a data-driven customization model instead of a resource-file-driven customization model to add new controls to the common file dialog boxes.</span></span>

<span data-ttu-id="d1806-174">È consigliabile usare le interfacce correlate a [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="d1806-174">You should use the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces when:</span></span>

-   <span data-ttu-id="d1806-175">è necessario personalizzare la finestra di dialogo file comune per il programma in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-175">you need to customize the common file dialog box for your program in Windows 7.</span></span> <span data-ttu-id="d1806-176">Questo consentirà al programma di lavorare con le librerie e supportare la personalizzazione della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="d1806-176">This will allow your program to work with libraries and support customizing your dialog box.</span></span>
-   <span data-ttu-id="d1806-177">si desidera che l'utente sia in grado di selezionare più file da una finestra di dialogo file comune.</span><span class="sxs-lookup"><span data-stu-id="d1806-177">you want the user to be able to select multiple files from a common file dialog box.</span></span> <span data-ttu-id="d1806-178">In questo modo si otterrà i percorsi corretti per l'oggetto selezionato perché una raccolta può includere contenuto archiviato in cartelle diverse.</span><span class="sxs-lookup"><span data-stu-id="d1806-178">This will ensure you get the correct paths to the selected object because a library can have contents that are stored in different folders.</span></span>

<span data-ttu-id="d1806-179">Per ulteriori informazioni sulle interfacce correlate a [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), vedere:</span><span class="sxs-lookup"><span data-stu-id="d1806-179">For more information on the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces, see:</span></span>

-   [<span data-ttu-id="d1806-180">**IFileDialog**</span><span class="sxs-lookup"><span data-stu-id="d1806-180">**IFileDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)
-   [<span data-ttu-id="d1806-181">**IFileOpenDialog**</span><span class="sxs-lookup"><span data-stu-id="d1806-181">**IFileOpenDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)
-   [<span data-ttu-id="d1806-182">**IFileSaveDialog**</span><span class="sxs-lookup"><span data-stu-id="d1806-182">**IFileSaveDialog**</span></span>](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)
-   [<span data-ttu-id="d1806-183">**IFileDialogCustomize**</span><span class="sxs-lookup"><span data-stu-id="d1806-183">**IFileDialogCustomize**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)
-   [<span data-ttu-id="d1806-184">**IFileDialogEvents**</span><span class="sxs-lookup"><span data-stu-id="d1806-184">**IFileDialogEvents**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)
-   [<span data-ttu-id="d1806-185">**IFileDialogControlEvents**</span><span class="sxs-lookup"><span data-stu-id="d1806-185">**IFileDialogControlEvents**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ifiledialogcontrolevents)

## <a name="enabling-library-selection-from-the-user-interface"></a><span data-ttu-id="d1806-186">Abilitazione della selezione della libreria dall'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="d1806-186">Enabling library selection from the user interface</span></span>

<span data-ttu-id="d1806-187">Se il programma consente all'utente di selezionare una cartella, ad esempio per le funzioni di importazione o esportazione, in Windows 7, deve consentire all'utente di selezionare anche una libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-187">If your program allows the user to select a folder, such as for import or export functions, in Windows 7, it should allow the user to select a library as well.</span></span> <span data-ttu-id="d1806-188">L'interfaccia [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) e la funzione [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) consentono all'utente di selezionare una libreria quando viene richiesto di selezionare una cartella.</span><span class="sxs-lookup"><span data-stu-id="d1806-188">The [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface and [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) function allow the user to select a library when prompted to select a folder.</span></span> <span data-ttu-id="d1806-189">Per la funzione **SHBrowseForFolder** è preferibile l'interfaccia **IFileOpenDialog** , perché **IFileOpenDialog** supporta l'interfaccia utente di Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-189">The **IFileOpenDialog** interface is preferred over the **SHBrowseForFolder** function because **IFileOpenDialog** supports the Windows 7 user interface.</span></span>

<span data-ttu-id="d1806-190">Per consentire agli utenti di selezionare le cartelle quando si usa l'interfaccia [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) , chiamare SetOption con il \_ flag Fos PICKFOLDERS impostato e assicurarsi che il \_ flag Fos FORCEFILESYSTEM sia chiaro.</span><span class="sxs-lookup"><span data-stu-id="d1806-190">To allow users to select folders when using the [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface, call SetOptions with the FOS\_PICKFOLDERS flag set and make sure the FOS\_FORCEFILESYSTEM flag is clear.</span></span>


```C++
FILEOPENDIALOGOPTIONS fileOptions;

hr = fileOpenDialogBox->GetOptions(&fileOptions);
fileOptions = fileOptions | FOS_PICKFOLDERS | ~FOS_FORCEFILESYSTEM;
hr = fileOpenDialogBox->SetOptions(fileOptions);
```



<span data-ttu-id="d1806-191">Per consentire agli utenti di selezionare le cartelle quando si chiama la funzione SHBrowseForFolder, nel membro ulFlags della struttura [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) impostare il \_ flag BIF USENEWUI e deselezionare il \_ flag BIF RETURNONLYFSDIRS.</span><span class="sxs-lookup"><span data-stu-id="d1806-191">To allow users to select folders when calling the SHBrowseForFolder function, in the ulFlags member of the [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) structure, set the BIF\_USENEWUI flag and clear the BIF\_RETURNONLYFSDIRS flag.</span></span>


```C++
BROWSEINFO    browseInfo;
browseInfo.ulFlags = BIF_USENEWUI | ~BIF_RETURNONLYFSDIRS;
// Set other member values
pidl = SHBrowseForFolder(&browseInfo);
```



## <a name="accessing-library-content-in-a-program"></a><span data-ttu-id="d1806-192">Accesso al contenuto della libreria in un programma</span><span class="sxs-lookup"><span data-stu-id="d1806-192">Accessing library content in a program</span></span>

<span data-ttu-id="d1806-193">Per accedere al contenuto di una raccolta, è necessario usare l'API shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="d1806-193">To access the contents of a library, you must use the Windows Shell API.</span></span> <span data-ttu-id="d1806-194">Non è possibile usare le funzioni dell'API del file System per accedere al contenuto della libreria perché le librerie non sono oggetti di file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-194">Functions of the file-system API cannot be used to access library contents because libraries are not file-system objects.</span></span> <span data-ttu-id="d1806-195">Se il programma usa un browser file personalizzato basato sull'API del file System, non sarà in grado di esplorare le librerie o accedere al contenuto della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-195">If your program uses a custom file browser that is based on the file-system API, it will not be able to browse libraries or access library content.</span></span>

<span data-ttu-id="d1806-196">In questa sezione viene descritto come accedere al contenuto della libreria in modo che sia possibile selezionare il modo migliore per aggiornare il programma per l'utilizzo delle librerie.</span><span class="sxs-lookup"><span data-stu-id="d1806-196">This section describes how you can access library content so that you can select the best way to update your program to work with libraries.</span></span>

### <a name="accessing-library-content-with-the-ishelllibrary-interface"></a><span data-ttu-id="d1806-197">Accesso al contenuto della libreria con l'interfaccia IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="d1806-197">Accessing library content with the IShellLibrary interface</span></span>

<span data-ttu-id="d1806-198">Il modo più semplice per accedere al contenuto della libreria consiste nell'usare l' [**API della libreria della shell**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span><span class="sxs-lookup"><span data-stu-id="d1806-198">The easiest way for a program to access library content is to use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span></span> <span data-ttu-id="d1806-199">Se si sta lavorando a un programma che usa l'API del file System, l' **API della libreria shell** può restituire le cartelle del file System di una libreria, riducendo al minimo la modifica apportata al codice del programma esistente.</span><span class="sxs-lookup"><span data-stu-id="d1806-199">If you are working on a program that uses the file-system API, the **Shell Library API** can return the file-system folders of a library, which minimizes the change to your existing program code.</span></span>


```C++
IShellLibrary *picturesLibrary;

hr = SHLoadLibraryFromKnownFolder(FOLDERID_PicturesLibrary, 
                                  STGM_READ, 
                                  IID_PPV_ARGS(&picturesLibrary));

// picturesLibrary now points to the user's picture library
    
IShellItemArray *pictureFolders; 

hr = pslLibrary->GetFolders(LFF_FORCEFILESYSTEM, IID_PPV_ARGS(&pictureFolders));

// pictureFolders now contains an array of Shell items that
// represent the folders found in the user's pictures library
```



### <a name="accessing-library-content-with-the-shell-apis"></a><span data-ttu-id="d1806-200">Accesso al contenuto della libreria con le API della shell</span><span class="sxs-lookup"><span data-stu-id="d1806-200">Accessing library content with the Shell APIs</span></span>

<span data-ttu-id="d1806-201">Poiché gli oggetti libreria fanno parte del modello di programmazione della shell, possono essere usati con altre API della shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="d1806-201">Because the library objects are part of the Shell programming model, they can be used with other Windows Shell APIs.</span></span> <span data-ttu-id="d1806-202">Ad esempio, è possibile usare le interfacce [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) e [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) nel programma, insieme alle funzioni di supporto correlate, per accedere al contenuto di una libreria allo stesso modo in cui si enumerano le cartelle e il contenuto della cartella per accedere al contenuto con le API file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-202">For example you can use the [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) and [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interfaces in your program, along with related helper functions, to access the contents of a library in the same way as you would enumerate folders and folder contents to access content with the file system APIs.</span></span>

<span data-ttu-id="d1806-203">Le API della shell di Windows supportano due modalità di enumerazione per accedere al contenuto di una libreria:</span><span class="sxs-lookup"><span data-stu-id="d1806-203">The Windows Shell APIs support two enumeration modes to access the contents of a library:</span></span>

-   <span data-ttu-id="d1806-204">**Esplora enumerazione**</span><span class="sxs-lookup"><span data-stu-id="d1806-204">**Browse enumeration**</span></span>

    <span data-ttu-id="d1806-205">L'enumerazione Browse è la modalità di enumerazione predefinita ed enumera il contenuto di una cartella di libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-205">Browse enumeration is the default enumeration mode and enumerates the contents of a library folder.</span></span> <span data-ttu-id="d1806-206">\_ \_ Per utilizzare questa modalità, deselezionare il flag di enumerazione di navigazione SHCONTF.</span><span class="sxs-lookup"><span data-stu-id="d1806-206">Clear the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

-   <span data-ttu-id="d1806-207">**Enumerazione di navigazione**</span><span class="sxs-lookup"><span data-stu-id="d1806-207">**Navigation enumeration**</span></span>

    <span data-ttu-id="d1806-208">L'enumerazione di navigazione enumera le cartelle della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-208">Navigation enumeration enumerates the library folders.</span></span> <span data-ttu-id="d1806-209">Impostare il \_ \_ flag di enumerazione di navigazione SHCONTF per utilizzare questa modalità.</span><span class="sxs-lookup"><span data-stu-id="d1806-209">Set the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

<span data-ttu-id="d1806-210">Se il programma utilizza un controllo albero personalizzato per spostarsi tra le cartelle dell'utente, l'enumerazione delle cartelle nella modalità di enumerazione di navigazione fornirà un elenco delle cartelle di una libreria coerenti con il modo in cui Esplora risorse enumera le cartelle in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d1806-210">If your program uses a custom tree control to navigate the user's folders, enumerating the folders in the navigation enumeration mode will give you a list of a library's folders that is consistent with how the Windows Explorer enumerates folders in Windows 7.</span></span>

<span data-ttu-id="d1806-211">Per esempi relativi all'uso di queste funzionalità in un programma, vedere l'esempio ShellStorage nel Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="d1806-211">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="saving-user-content-in-a-library"></a><span data-ttu-id="d1806-212">Salvataggio del contenuto utente in una raccolta</span><span class="sxs-lookup"><span data-stu-id="d1806-212">Saving user content in a library</span></span>

<span data-ttu-id="d1806-213">Il programma può salvare il contenuto utente in una raccolta e in una cartella della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-213">Your program can save user content to a library as well as to a folder in the library.</span></span> <span data-ttu-id="d1806-214">Analogamente, l'utente può salvare in una cartella specifica in una raccolta o semplicemente salvarla nella libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-214">Likewise, the user can save to a specific folder in a library or they can just save to the library.</span></span>

<span data-ttu-id="d1806-215">Ogni libreria ha una cartella che viene designata come percorso di salvataggio predefinito.</span><span class="sxs-lookup"><span data-stu-id="d1806-215">Every library has a folder that is designated as the default save location.</span></span> <span data-ttu-id="d1806-216">Il percorso di salvataggio predefinito viene definito al momento della creazione della libreria. Tuttavia, l'utente può riassegnare il percorso di salvataggio predefinito come qualsiasi cartella della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-216">The default save location is defined when the library is created; however the user can reassign the default save location to be any folder in the library.</span></span> <span data-ttu-id="d1806-217">Mentre l'utente non deve configurare un percorso di salvataggio predefinito, è possibile modificarlo.</span><span class="sxs-lookup"><span data-stu-id="d1806-217">While the user does not need to configure a default save location, they have the option to change it.</span></span> <span data-ttu-id="d1806-218">Se l'utente elimina la cartella attualmente impostata come percorso di salvataggio predefinito, nella libreria la cartella successiva nella libreria verrà automaticamente configurata come percorso di salvataggio predefinito.</span><span class="sxs-lookup"><span data-stu-id="d1806-218">If the user deletes the folder that is currently set as the default save location, the library will automatically configure the next folder in the library to be the default save location.</span></span>

<span data-ttu-id="d1806-219">È possibile salvare il contenuto utente in una raccolta in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="d1806-219">There are several ways you can save user content to a library.</span></span>

-   <span data-ttu-id="d1806-220">**API shell**</span><span class="sxs-lookup"><span data-stu-id="d1806-220">**Shell API**</span></span>

    <span data-ttu-id="d1806-221">Se si usa il modello di programmazione della shell e si salva un elemento della shell, come rappresentato da [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage o IStream, in un oggetto libreria, l'elemento della shell verrà automaticamente archiviato nel percorso di salvataggio predefinito della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-221">If you are using the Shell programming model and save a Shell item, as represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage, or IStream, to a library object, the Shell item will be automatically stored in the default save location of the library.</span></span>

-   <span data-ttu-id="d1806-222">**API del file System**</span><span class="sxs-lookup"><span data-stu-id="d1806-222">**File-system API**</span></span>

    <span data-ttu-id="d1806-223">Se si dispone di un programma esistente che utilizza molte chiamate API del file System, è possibile ottenere il percorso della cartella definita come percorso di salvataggio predefinito della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-223">If you have an existing program that uses many file-system API calls, you can get a path to the folder that is defined as the library's default save location.</span></span> <span data-ttu-id="d1806-224">Il percorso della cartella può quindi essere passato a un'API del file System.</span><span class="sxs-lookup"><span data-stu-id="d1806-224">The folder path can then be passed to a file-system API.</span></span>

<span data-ttu-id="d1806-225">Per esempi relativi all'uso di queste funzionalità in un programma, vedere l'esempio ShellStorage nel Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="d1806-225">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="supporting-drag-and-drop-operations-in-a-library"></a><span data-ttu-id="d1806-226">Supporto delle operazioni di trascinamento della selezione in una libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-226">Supporting drag-and-drop operations in a library</span></span>

<span data-ttu-id="d1806-227">Se il programma supporta le operazioni di trascinamento della selezione, è necessario aggiornarle per supportare l'interazione corretta della libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-227">If your program supports drag-and-drop actions, those should be updated to support the correct library interaction.</span></span> <span data-ttu-id="d1806-228">Se un file viene rilasciato in una raccolta, il file eliminato deve essere salvato nel percorso di salvataggio predefinito.</span><span class="sxs-lookup"><span data-stu-id="d1806-228">If a file is dropped into a library, the dropped file should be saved in the default save location.</span></span> <span data-ttu-id="d1806-229">Se una cartella viene rilasciata in una raccolta, la cartella eliminata deve essere aggiunta come nuova cartella alla libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-229">If a folder is dropped into a library, the dropped folder should be added as a new folder to the library.</span></span> <span data-ttu-id="d1806-230">Se un file viene rilasciato in una cartella esistente che non è il percorso di salvataggio predefinito, il file deve essere aggiunto alla cartella selezionata.</span><span class="sxs-lookup"><span data-stu-id="d1806-230">If a file is dropped into an existing folder that is not the default save location, the file should be added to the selected folder.</span></span>

<span data-ttu-id="d1806-231">Per esempi relativi all'aggiunta del supporto per le librerie per la funzionalità di trascinamento della selezione dei programmi, vedere l'esempio ShellLibraryCommandLine nel Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="d1806-231">For examples of how to add library support for your programs drag-and-drop functionality, see the ShellLibraryCommandLine sample in the Windows SDK.</span></span>

## <a name="keeping-in-sync-with-a-library"></a><span data-ttu-id="d1806-232">Mantenimento della sincronizzazione con una libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-232">Keeping in sync with a library</span></span>

<span data-ttu-id="d1806-233">In questo argomento viene descritto come un programma può rimanere aggiornato sul contenuto di una raccolta.</span><span class="sxs-lookup"><span data-stu-id="d1806-233">This topic describes how a program can keep its view of a library's content up-to-date.</span></span>

### <a name="bulk-update"></a><span data-ttu-id="d1806-234">Aggiornamento bulk</span><span class="sxs-lookup"><span data-stu-id="d1806-234">Bulk Update</span></span>

<span data-ttu-id="d1806-235">Poiché l'utente può modificare le cartelle di una libreria in modo interattivo quando il programma non è in esecuzione, il programma deve chiamare [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) quando inizia a individuare e archiviare le modifiche apportate alla libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-235">Because the user can modify the folders of a library interactively when your program is not running, your program should call [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) when it starts to discover and store any changes to the library.</span></span> <span data-ttu-id="d1806-236">L'API shell fornisce la funzione **SHResolveLibrary** per consentire a un programma di ottenere il contenuto corrente di una raccolta e i percorsi correnti di tutte le cartelle che la libreria potrebbe contenere.</span><span class="sxs-lookup"><span data-stu-id="d1806-236">The Shell API provides the **SHResolveLibrary** function to enable a program to get the current contents of a library and the current locations of any folders the library might contain.</span></span>

<span data-ttu-id="d1806-237">Si noti che [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) è una funzione di blocco che può richiedere molto tempo per la restituzione a seconda di ciò che è stato modificato nella libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-237">Note that [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) is a blocking function that could take a long time to return depending on what has changed in the library.</span></span> <span data-ttu-id="d1806-238">Di conseguenza, non deve essere chiamato da un thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="d1806-238">As such, it should not be called from a UI thread.</span></span>

<span data-ttu-id="d1806-239">Dopo che il programma è stato aggiornato, è possibile registrarsi per le notifiche di modifica per mantenere una visualizzazione corrente.</span><span class="sxs-lookup"><span data-stu-id="d1806-239">After the program has been brought up-to-date, it can then register for change notifications to maintain a current view.</span></span>

### <a name="shell-api-notification"></a><span data-ttu-id="d1806-240">Notifica API shell</span><span class="sxs-lookup"><span data-stu-id="d1806-240">Shell API Notification</span></span>

<span data-ttu-id="d1806-241">L'API shell di Windows fornisce la funzione [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) , che rappresenta la modalità preferita per i processi non di servizio di ricevere una notifica di una modifica nella libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-241">The Windows Shell API provides the [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) function, which is the preferred way for non-service processes to be notified of a change in the library.</span></span>

<span data-ttu-id="d1806-242">Per rilevare le modifiche apportate agli elementi all'interno di una libreria tramite l'API della shell di Windows, chiamare [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) per registrare il programma per le notifiche delle modifiche apportate agli elementi in una cartella di libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-242">To detect changes to items within a library using the Windows Shell API, call [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) to register your program for notifications of changes to items in a library folder.</span></span> <span data-ttu-id="d1806-243">Questa funzione può notificare al programma se è presente una modifica in qualsiasi libreria o solo in una libreria specifica.</span><span class="sxs-lookup"><span data-stu-id="d1806-243">This function can notify your program if there is a change in any library or just in a specific library.</span></span> <span data-ttu-id="d1806-244">Le notifiche vengono inviate immediatamente quando viene modificata una libreria.</span><span class="sxs-lookup"><span data-stu-id="d1806-244">Notifications are sent immediately when a library is changed.</span></span>

### <a name="file-system-api-notification"></a><span data-ttu-id="d1806-245">Notifica dell'API del file System</span><span class="sxs-lookup"><span data-stu-id="d1806-245">File-system API Notification</span></span>

<span data-ttu-id="d1806-246">Le notifiche del file System devono essere usate nei processi del servizio.</span><span class="sxs-lookup"><span data-stu-id="d1806-246">File system notifications must be used in service processes.</span></span>

<span data-ttu-id="d1806-247">Per rilevare le modifiche apportate agli elementi di una raccolta tramite l'API del file System, enumerare le cartelle nella libreria e chiamare [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) per ogni cartella da monitorare.</span><span class="sxs-lookup"><span data-stu-id="d1806-247">To detect changes to items in a library using the file-system API, enumerate the folders in the library and call [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) for each folder to monitor.</span></span> <span data-ttu-id="d1806-248">Il programma riceverà una notifica in caso di modifica di una cartella monitorata.</span><span class="sxs-lookup"><span data-stu-id="d1806-248">Your program will receive notification when a monitored folder changes.</span></span> <span data-ttu-id="d1806-249">Per trovare il file specifico di file modificato nella cartella, chiamare [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span><span class="sxs-lookup"><span data-stu-id="d1806-249">To find the specific file of files that changed in the folder, call [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span></span> <span data-ttu-id="d1806-250">Per rilevare le modifiche nel file di descrizione della libreria, monitorare la cartella che lo contiene.</span><span class="sxs-lookup"><span data-stu-id="d1806-250">To detect changes in the library description file, monitor the folder that contains it.</span></span> <span data-ttu-id="d1806-251">Il file di descrizione della libreria si trova nella cartella [**FOLDERID \_ Libraries**](knownfolderid.md) .</span><span class="sxs-lookup"><span data-stu-id="d1806-251">The library description file can be found in the [**FOLDERID\_Libraries**](knownfolderid.md) folder.</span></span> <span data-ttu-id="d1806-252">Il file di descrizione della libreria, tuttavia, non deve essere aperto o modificato.</span><span class="sxs-lookup"><span data-stu-id="d1806-252">The library description file, however, should not be opened or modified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d1806-253">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d1806-253">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1806-254">Informazioni sulle librerie</span><span class="sxs-lookup"><span data-stu-id="d1806-254">About Libraries</span></span>](library-leverage-to-manage-folders.md)
</dt> <dt>

[<span data-ttu-id="d1806-255">**IShellLibrary**</span><span class="sxs-lookup"><span data-stu-id="d1806-255">**IShellLibrary**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[<span data-ttu-id="d1806-256">Collegamenti Shell</span><span class="sxs-lookup"><span data-stu-id="d1806-256">Shell Links</span></span>](./links.md)
</dt> <dt>

[<span data-ttu-id="d1806-257">Cartelle note</span><span class="sxs-lookup"><span data-stu-id="d1806-257">Known Folders</span></span>](known-folders.md)
</dt> <dt>

[<span data-ttu-id="d1806-258">Schema Descrizione libreria</span><span class="sxs-lookup"><span data-stu-id="d1806-258">Library Description Schema</span></span>](library-schema-entry.md)
</dt> <dt>

[<span data-ttu-id="d1806-259">**argomenti di IID \_ PPV \_**</span><span class="sxs-lookup"><span data-stu-id="d1806-259">**IID\_PPV\_ARGS**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-iid_ppv_args)
</dt> </dl>

 

 
