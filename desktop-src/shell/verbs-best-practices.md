---
description: Informazioni sulle procedure consigliate per i gestori dei menu di scelta rapida e più verbi quando si implementa un formato di file personalizzato nella shell di Windows.
title: Procedure consigliate per gestori di menu di scelta rapida e più verbi
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 4D352ECB-6214-4f6e-A3E5-F79E154D090A
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 14ec2e8915aa1df47ca21c6436ec963be3f590f5
ms.sourcegitcommit: 91530c19d26ba4c57a6af1f37b57f211f580464e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/19/2021
ms.locfileid: "112396446"
---
# <a name="best-practices-for-shortcut-menu-handlers-and-multiple-verbs"></a><span data-ttu-id="65fcd-103">Procedure consigliate per gestori di menu di scelta rapida e più verbi</span><span class="sxs-lookup"><span data-stu-id="65fcd-103">Best Practices for Shortcut Menu Handlers and Multiple Verbs</span></span>

<span data-ttu-id="65fcd-104">Questo argomento è organizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="65fcd-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="65fcd-105">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="65fcd-105">Best Practices</span></span>](#best-practices-for-shortcut-menu-handlers-and-multiple-verbs)
    -   [<span data-ttu-id="65fcd-106">Procedure consigliate per le implementazioni di verbi</span><span class="sxs-lookup"><span data-stu-id="65fcd-106">Best Practices for Verb Implementations</span></span>](#best-practices-for-verb-implementations)
-   [<span data-ttu-id="65fcd-107">Procedure consigliate per più verbi di selezione</span><span class="sxs-lookup"><span data-stu-id="65fcd-107">Best Practices for Multiple Selection Verbs</span></span>](#best-practices-for-multiple-selection-verbs)
    -   [<span data-ttu-id="65fcd-108">Selezioni eterogenee</span><span class="sxs-lookup"><span data-stu-id="65fcd-108">Heterogenous Selections</span></span>](#heterogenous-selections)
-   [<span data-ttu-id="65fcd-109">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="65fcd-109">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="65fcd-110">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="65fcd-110">Best Practices</span></span>

<span data-ttu-id="65fcd-111">I verbi statici sono verbi più semplici da implementare e forniscono funzionalità avanzate.</span><span class="sxs-lookup"><span data-stu-id="65fcd-111">Static verb are simplest verbs to implement, and provide rich functionality.</span></span> <span data-ttu-id="65fcd-112">È consigliabile implementare un verbo usando uno dei metodi di verbi statici.</span><span class="sxs-lookup"><span data-stu-id="65fcd-112">We strongly encourage you to implement a verb using one of the static verb methods.</span></span>

### <a name="best-practices-for-verb-implementations"></a><span data-ttu-id="65fcd-113">Procedure consigliate per le implementazioni di verbi</span><span class="sxs-lookup"><span data-stu-id="65fcd-113">Best Practices for Verb Implementations</span></span>

<span data-ttu-id="65fcd-114">L'elenco seguente rappresenta le procedure consigliate per le implementazioni di verbi:</span><span class="sxs-lookup"><span data-stu-id="65fcd-114">The following list represents best practices for verb implementations:</span></span>

-   <span data-ttu-id="65fcd-115">Scegliere sempre il metodo verbo più semplice che soddisfi le proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="65fcd-115">Always chose the simplest verb method that meets your needs.</span></span>
-   <span data-ttu-id="65fcd-116">Usare un metodo verbo statico, se possibile.</span><span class="sxs-lookup"><span data-stu-id="65fcd-116">Use a static verb method, if possible.</span></span>
-   <span data-ttu-id="65fcd-117">Non eseguire operazioni a elevato utilizzo di risorse o I/O nel thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="65fcd-117">Do not perform resource-intensive operations or I/O on the UI thread.</span></span> <span data-ttu-id="65fcd-118">Sia [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) che [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) devono essere molto conservativi nel lavoro che eseguono.</span><span class="sxs-lookup"><span data-stu-id="65fcd-118">Both [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) need to be very conservative in the work they perform.</span></span> <span data-ttu-id="65fcd-119">[**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) deve essere eseguito in un altro processo oppure è necessario creare un nuovo thread per evitare di bloccare il chiamante.</span><span class="sxs-lookup"><span data-stu-id="65fcd-119">[**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) must be performed in another process, or you must create a new thread to avoid blocking the caller.</span></span>
-   <span data-ttu-id="65fcd-120">Prefissi verbi con il nome del fornitore di software indipendente (ISV) come indicato di seguito, `ISVName.verb` .</span><span class="sxs-lookup"><span data-stu-id="65fcd-120">Prefix verbs with the independent software vendor (ISV) name as follows, `ISVName.verb`.</span></span> <span data-ttu-id="65fcd-121">L'uso di nomi non qualificati può causare conflitti con più ISV che hanno scelto lo stesso nome di verbo.</span><span class="sxs-lookup"><span data-stu-id="65fcd-121">Using unqualified names can result in collisions with multiple ISVs that chose the same verb name.</span></span>
-   <span data-ttu-id="65fcd-122">Usare sempre un ProgID specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="65fcd-122">Always use an application-specific ProgID.</span></span> <span data-ttu-id="65fcd-123">Poiché alcuni tipi di elemento non usano questo mapping, è necessario usare nomi univoci del fornitore.</span><span class="sxs-lookup"><span data-stu-id="65fcd-123">Because some item types do not use this mapping, there is a need for vendor-unique names.</span></span>
-   <span data-ttu-id="65fcd-124">Posizionare l'interfaccia utente rispetto al metodo di chiamata, ma non eseguire su un thread invoker.</span><span class="sxs-lookup"><span data-stu-id="65fcd-124">Position the UI relative to the invoking method, but do not run on an invoker thread.</span></span>
-   <span data-ttu-id="65fcd-125">Non accettare il valore restituito **S \_ OK** per i verbi canonici passati al [**metodo IContextMenu::InvokeCommand.**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand)</span><span class="sxs-lookup"><span data-stu-id="65fcd-125">Do not accept the return value **S\_OK** for canonical verbs passed to the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method.</span></span> <span data-ttu-id="65fcd-126">In questo modo viene richiamato un errore per l'implementazione effettiva del verbo e viene restituito un codice di errore per i verbi canonici.</span><span class="sxs-lookup"><span data-stu-id="65fcd-126">Doing so causes a failure for the real verb implementation to be invoked, and returns a failure code for canonical verbs.</span></span> <span data-ttu-id="65fcd-127">Se non si supportano verbi canonici, viene restituito un errore quando viene rilevato un valore HIWORD(lpVerb) diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="65fcd-127">If you do not support canonical verbs, then return failure when a nonzero HIWORD(lpVerb) value is encountered.</span></span>
-   <span data-ttu-id="65fcd-128">Evitare l'uso **dirundll32.exe** come host per il verbo.</span><span class="sxs-lookup"><span data-stu-id="65fcd-128">Avoid the use of **rundll32.exe** as the host for your verb.</span></span>
-   <span data-ttu-id="65fcd-129">Quando si implementa [**IContextMenu::QueryContextMenu,**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) assicurarsi di restituire il numero di verbi aggiunti al menu tramite il valore **HRESULT** usando la macro ResultFromShort.</span><span class="sxs-lookup"><span data-stu-id="65fcd-129">When implementing [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) be sure to return the number of verbs that have been added to the menu through the **HRESULT** value using the ResultFromShort macro.</span></span>
-   <span data-ttu-id="65fcd-130">Se si registra in una delle voci di chiave del Registro di sistema seguenti, prestare attenzione e assicurarsi di registrare il gestore nel tipo più specifico per ridurre le conseguenze possibilmente impreviste:</span><span class="sxs-lookup"><span data-stu-id="65fcd-130">If you register on one of the following registry key entries, then exercise caution and be sure to register your handler on the most specific type to reduce the possibly unintended consequences:</span></span>
    -   <span data-ttu-id="65fcd-131">**RADICE DELLE \_ CLASSI \_ HKEY\\\***</span><span class="sxs-lookup"><span data-stu-id="65fcd-131">**HKEY\_CLASSES\_ROOT\\\***</span></span>
    -   <span data-ttu-id="65fcd-132">**HKEY \_ CLASSES \_ ROOT \\ AllFileSystemObjects**</span><span class="sxs-lookup"><span data-stu-id="65fcd-132">**HKEY\_CLASSES\_ROOT\\AllFileSystemObjects**</span></span>
    -   <span data-ttu-id="65fcd-133">**Cartella RADICE HKEY \_ CLASSES \_ \\**</span><span class="sxs-lookup"><span data-stu-id="65fcd-133">**HKEY\_CLASSES\_ROOT\\Folder**</span></span>
    -   <span data-ttu-id="65fcd-134">**DIRECTORY RADICE DELLE CLASSI HKEY \_ \_ \\**</span><span class="sxs-lookup"><span data-stu-id="65fcd-134">**HKEY\_CLASSES\_ROOT\\Directory**</span></span>
-   <span data-ttu-id="65fcd-135">Impostare la **chiave MayChangeDefaultMenu** solo se si prevede che potrebbe essere necessario modificare il verbo predefinito nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="65fcd-135">Set the **MayChangeDefaultMenu** key only if you anticipate that you might need to change the default verb in the shortcut menu.</span></span> <span data-ttu-id="65fcd-136">Se il gestore non modifica il verbo predefinito, non è necessario impostare questa chiave perché in questo modo il sistema carica la DLL inutilmente.</span><span class="sxs-lookup"><span data-stu-id="65fcd-136">If your handler does not change the default verb, then you should not set this key because doing so causes the system to load your DLL unnecessarily.</span></span>
-   <span data-ttu-id="65fcd-137">Ridurre al minimo le operazioni eseguite in [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span><span class="sxs-lookup"><span data-stu-id="65fcd-137">Minimize the work you perform in [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span></span> <span data-ttu-id="65fcd-138">Per i gestori del menu di scelta rapida, acquisire l'oggetto dati passato a **IShellExtInit::Initialize** e quindi elaborarlo in [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu)o [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span><span class="sxs-lookup"><span data-stu-id="65fcd-138">For shortcut menu handlers, capture the data object passed to **IShellExtInit::Initialize**, and then process it in [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), or [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span></span>

## <a name="best-practices-for-multiple-selection-verbs"></a><span data-ttu-id="65fcd-139">Procedure consigliate per più verbi di selezione</span><span class="sxs-lookup"><span data-stu-id="65fcd-139">Best Practices for Multiple Selection Verbs</span></span>

<span data-ttu-id="65fcd-140">Poiché il numero di elementi in uno scenario con più verbi di selezione può essere elevato, è importante considerare le implicazioni in termini di prestazioni delle implementazioni dei verbi.</span><span class="sxs-lookup"><span data-stu-id="65fcd-140">Because the number of items in a multi-selection verb scenario can be large, it is important that you consider the performance implications of your verb implementations.</span></span> <span data-ttu-id="65fcd-141">Ad esempio, quando un utente cerca " " su un ambito che include un numero elevato di elementi e quindi fa clic su Seleziona tutto e fa clic con il pulsante destro del mouse, al verbo viene visualizzata una selezione che può contenere migliaia di \* elementi. </span><span class="sxs-lookup"><span data-stu-id="65fcd-141">For example, when a user searches for "\*" over a scope that includes large numbers of items, and then clicks **Select All** and right-clicks, the verb is presented with a selection that can have thousands of items in it.</span></span> <span data-ttu-id="65fcd-142">Di conseguenza, i verbi devono considerare solo il primo elemento nella selezione e il conteggio complessivo degli elementi.</span><span class="sxs-lookup"><span data-stu-id="65fcd-142">As a result, verbs should only consider the first item in the selection, and the overall item count.</span></span> <span data-ttu-id="65fcd-143">Il primo elemento viene definito come elemento nella parte superiore della visualizzazione o come elemento su cui l'utente ha fatto clic con il pulsante destro del mouse.</span><span class="sxs-lookup"><span data-stu-id="65fcd-143">The first item is defined as either the item at the top of the view, or the item that the user first right-clicked.</span></span>

<span data-ttu-id="65fcd-144">In Windows 7 e versioni successive, il numero di elementi passati a un verbo è limitato a 16 quando viene eseguita una query su un menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="65fcd-144">In Windows 7 and later, the number of items passed to a verb is limited to 16 when a shortcut menu is queried.</span></span> <span data-ttu-id="65fcd-145">Il verbo viene quindi ri-creato e inizializzato nuovamente con la selezione completa quando tale verbo viene richiamato.</span><span class="sxs-lookup"><span data-stu-id="65fcd-145">The verb is then re-created and re-initialized with the full selection when that verb is invoked.</span></span>

<span data-ttu-id="65fcd-146">In alcuni casi è opportuno prendere in considerazione un numero ridotto di elementi fissi.</span><span class="sxs-lookup"><span data-stu-id="65fcd-146">It is appropriate in some cases to consider a small number of fixed items.</span></span> <span data-ttu-id="65fcd-147">Ad esempio, è appropriato che un verbo "diff" consideri solo i primi due elementi.</span><span class="sxs-lookup"><span data-stu-id="65fcd-147">For example, it is appropriate for a "diff" verb to consider only the first two items.</span></span> <span data-ttu-id="65fcd-148">In genere, non è necessario testare ogni elemento nella selezione per verificare se si tratta di un determinato tipo o eseguire una query su ogni elemento nella selezione per le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="65fcd-148">Generally, you need not test every item in the selection to see if it is a certain type, or query every item in the selection for its properties.</span></span> <span data-ttu-id="65fcd-149">Esaminare invece il primo elemento e decidere se è appropriato aggiungere il verbo.</span><span class="sxs-lookup"><span data-stu-id="65fcd-149">Look rather at the first item and decide if it is appropriate to add your verb.</span></span>

### <a name="heterogenous-selections"></a><span data-ttu-id="65fcd-150">Selezioni eterogenee</span><span class="sxs-lookup"><span data-stu-id="65fcd-150">Heterogenous Selections</span></span>

<span data-ttu-id="65fcd-151">I verbi ottimistici vengono aggiunti automaticamente nel caso a selezione multipla, presupponendo che gli elementi non selezionati possano essere gestiti dal verbo.</span><span class="sxs-lookup"><span data-stu-id="65fcd-151">Optimistic verbs are automatically added in the multi-selection case, assuming that uninspected items can be handled by the verb.</span></span> <span data-ttu-id="65fcd-152">Al contrario, i verbi pessimistici non vengono aggiunti quando la selezione contiene elementi non selezionati e vengono aggiunti solo nei casi in cui il numero di elementi è ridotto.</span><span class="sxs-lookup"><span data-stu-id="65fcd-152">In contrast, pessimistic verbs are not added when the selection contains uninspected items, and are only added in cases where the number of items is small.</span></span>

<span data-ttu-id="65fcd-153">I verbi di stile del lettore devono essere ottimistici e ignorare automaticamente gli elementi non gestiti.</span><span class="sxs-lookup"><span data-stu-id="65fcd-153">Player style verbs should be optimistic, and silently skip the items that are not handled.</span></span> <span data-ttu-id="65fcd-154">Se un errore di azione sugli elementi può causare perdita di dati o confusione, il verbo deve avvisare gli utenti degli elementi che non possono essere elaborati.</span><span class="sxs-lookup"><span data-stu-id="65fcd-154">If a failure to act on items can cause data loss or confusion, then the verb should warn users about items that cannot be processed.</span></span> <span data-ttu-id="65fcd-155">Ad esempio, un verbo di "backup" deve indicare che non è stato possibile eseguire il backup di alcuni elementi.</span><span class="sxs-lookup"><span data-stu-id="65fcd-155">For example a "backup" verb should indicate that some items could not be backed up.</span></span>

## <a name="related-topics"></a><span data-ttu-id="65fcd-156">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="65fcd-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="65fcd-157">Scelta di un verbo statico o dinamico per il menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="65fcd-157">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="65fcd-158">Creazione di gestori di menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="65fcd-158">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="65fcd-159">Personalizzazione di un menu di scelta rapida tramite verbi dinamici</span><span class="sxs-lookup"><span data-stu-id="65fcd-159">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[<span data-ttu-id="65fcd-160">Menu di scelta rapida e gestori di menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="65fcd-160">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="65fcd-161">Verbi e associazioni di file</span><span class="sxs-lookup"><span data-stu-id="65fcd-161">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="65fcd-162">Informazioni di riferimento sul menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="65fcd-162">Shortcut Menu Reference</span></span>](context-menu-reference.md)
</dt> </dl>

 

 



