---
description: La guida online può essere costituita da diverse forme, da informazioni concettuali dettagliate a definizioni rapide. In questo argomento sono contenute le sezioni seguenti.
title: Gestione della Guida in linea
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 2a3f6034-6ba6-4204-a2e1-59995fbf40fe
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f1c125df135068c2eee37cb33a8a9d2b281b1f83
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994696"
---
# <a name="handling-online-help"></a><span data-ttu-id="8b25e-104">Gestione della Guida in linea</span><span class="sxs-lookup"><span data-stu-id="8b25e-104">Handling Online Help</span></span>

<span data-ttu-id="8b25e-105">La guida online può essere costituita da diverse forme, da informazioni concettuali dettagliate a definizioni rapide.</span><span class="sxs-lookup"><span data-stu-id="8b25e-105">Online help can come in a variety of forms, from detailed conceptual information to quick definitions.</span></span> <span data-ttu-id="8b25e-106">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="8b25e-107">Informazioni sulla guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-107">About Help</span></span>](#about-help)
    -   [<span data-ttu-id="8b25e-108">Richieste della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-108">Help Requests</span></span>](#help-requests)
    -   [<span data-ttu-id="8b25e-109">Guida di visualizzazione e guida di Windows</span><span class="sxs-lookup"><span data-stu-id="8b25e-109">Help Display and Windows Help</span></span>](#help-display-and-windows-help)
-   [<span data-ttu-id="8b25e-110">Uso della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-110">Using Help</span></span>](#using-help)
    -   [<span data-ttu-id="8b25e-111">Fornire la Guida in una finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="8b25e-111">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
    -   [<span data-ttu-id="8b25e-112">Impostazione dell'aspetto di una finestra della guida secondaria</span><span class="sxs-lookup"><span data-stu-id="8b25e-112">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

## <a name="about-help"></a><span data-ttu-id="8b25e-113">Informazioni sulla guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-113">About Help</span></span>

<span data-ttu-id="8b25e-114">Un elemento importante di un'applicazione intuitiva è immediatamente disponibile nella Guida in linea.</span><span class="sxs-lookup"><span data-stu-id="8b25e-114">An important element of a user-friendly application is readily available in online help.</span></span> <span data-ttu-id="8b25e-115">Windows fornisce funzioni e messaggi che, se utilizzati insieme all'applicazione della Guida di Windows, semplificano l'implementazione della guida online nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-115">Windows provides functions and messages that, when used in conjunction with the Windows Help application, make it easy to implement online help in your application.</span></span> <span data-ttu-id="8b25e-116">In questa panoramica vengono illustrati gli elementi di Windows che supportano la Guida in linea.</span><span class="sxs-lookup"><span data-stu-id="8b25e-116">This overview discusses the elements of Windows that support online help.</span></span> <span data-ttu-id="8b25e-117">Viene descritto come utilizzare questi elementi per fornire agli utenti un mezzo per richiedere assistenza e viene illustrato come utilizzare l'applicazione della Guida di Windows per visualizzare la guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-117">It describes how to use these elements to give users a means to request help, and it explains how to use the Windows Help application to display help.</span></span>

### <a name="help-requests"></a><span data-ttu-id="8b25e-118">Richieste della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-118">Help Requests</span></span>

<span data-ttu-id="8b25e-119">La maggior parte delle applicazioni basate su Windows fornisce informazioni della guida online in un'ampia gamma di moduli, dalla Guida concettuale che spiega lo scopo delle funzionalità di un'applicazione alla Guida popup che fornisce definizioni rapide dei singoli elementi nell'interfaccia utente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-119">Most Windows-based applications provide online help information in a variety of forms, ranging from conceptual help that explains the purpose of an application's features to pop-up help that provides quick definitions of individual elements in the application's user interface.</span></span> <span data-ttu-id="8b25e-120">Si usano funzioni e messaggi per offrire agli utenti una serie di modi per richiedere l'accesso a queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="8b25e-120">You use functions and messages to give users a variety of ways to request access to this information.</span></span> <span data-ttu-id="8b25e-121">Nelle sezioni seguenti vengono descritte queste richieste della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-121">The following sections describe these help requests.</span></span>

### <a name="help-menu"></a><span data-ttu-id="8b25e-122">Menu Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-122">Help menu</span></span>

<span data-ttu-id="8b25e-123">La maggior parte delle applicazioni fornisce l'accesso utente alle informazioni **della guida includendo un menu** ? nella finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-123">Most applications provide user access to help information by including a **Help** menu in the main window.</span></span> <span data-ttu-id="8b25e-124">Quando l'utente **Seleziona un elemento da un menu?** , la routine della finestra corrispondente riceve un messaggio di [**\_ comando WM**](../menurc/wm-command.md) che identifica l'elemento selezionato.</span><span class="sxs-lookup"><span data-stu-id="8b25e-124">When the user selects an item from a **Help** menu, the corresponding window procedure receives a [**WM\_COMMAND**](../menurc/wm-command.md) message that identifies the selected item.</span></span> <span data-ttu-id="8b25e-125">L'applicazione risponde visualizzando le informazioni della guida appropriate, ad esempio un elenco di argomenti della guida, un indice o un'introduzione all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-125">The application responds by displaying the appropriate help information, such as a list of help topics, an index, or an introduction to the application.</span></span>

### <a name="help-from-the-keyboard"></a><span data-ttu-id="8b25e-126">Guida dalla tastiera</span><span class="sxs-lookup"><span data-stu-id="8b25e-126">Help from the keyboard</span></span>

<span data-ttu-id="8b25e-127">Windows consente agli utenti di accedere alle informazioni della Guida tramite la tastiera inviando una notifica all'applicazione ogni volta che l'utente preme il tasto F1.</span><span class="sxs-lookup"><span data-stu-id="8b25e-127">Windows provides user access to help information from the keyboard by notifying the application whenever the user presses the F1 key.</span></span> <span data-ttu-id="8b25e-128">Il sistema invia un messaggio della [**\_ Guida WM**](wm-help.md) alla finestra con lo stato attivo quando l'utente preme il tasto.</span><span class="sxs-lookup"><span data-stu-id="8b25e-128">The system sends a [**WM\_HELP**](wm-help.md) message to the window that had the keyboard focus when the user pressed the key.</span></span> <span data-ttu-id="8b25e-129">Se la finestra è una finestra figlio, ad esempio un controllo in una finestra di dialogo, la funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) passa il messaggio alla finestra padre.</span><span class="sxs-lookup"><span data-stu-id="8b25e-129">If the window is a child window (for example, a control in a dialog box), the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="8b25e-130">Se un menu è attivo quando si preme F1, il sistema invia il messaggio alla finestra associata al menu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-130">If a menu is active when F1 is pressed, the system sends the message to the window associated with the menu.</span></span> <span data-ttu-id="8b25e-131">L'applicazione risponde visualizzando le informazioni della Guida associate alla finestra, al controllo o al menu con lo stato attivo o attivo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-131">The application responds by displaying help information associated with the window, control, or menu that has the focus or is active.</span></span> <span data-ttu-id="8b25e-132">Se, ad esempio, l'utente seleziona un controllo in una finestra di dialogo e preme F1, l'applicazione visualizzerà le informazioni della guida relative a tale controllo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-132">For example, if the user selects a control in a dialog box and presses F1, the application displays help information for that control.</span></span>

<span data-ttu-id="8b25e-133">Il parametro *lParam* della [**\_ Guida WM**](wm-help.md) è un puntatore a una struttura [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) contenente informazioni dettagliate sull'elemento per il quale è richiesta la guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-133">The *lParam* parameter of [**WM\_HELP**](wm-help.md) is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested.</span></span> <span data-ttu-id="8b25e-134">Usare queste informazioni per determinare l'argomento della guida da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="8b25e-134">You use this information to determine the help topic to display.</span></span> <span data-ttu-id="8b25e-135">La struttura **HELPINFO** include anche le coordinate del cursore del mouse al momento in cui l'utente ha premuto il tasto.</span><span class="sxs-lookup"><span data-stu-id="8b25e-135">The **HELPINFO** structure also includes the coordinates of the mouse cursor at the time the user pressed the key.</span></span> <span data-ttu-id="8b25e-136">È possibile utilizzare queste informazioni per fornire informazioni sulla posizione del cursore del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-136">You can use this information to provide help based on the location of the mouse cursor.</span></span>

### <a name="help-from-the-mouse"></a><span data-ttu-id="8b25e-137">Guida dal mouse</span><span class="sxs-lookup"><span data-stu-id="8b25e-137">Help from the mouse</span></span>

<span data-ttu-id="8b25e-138">Windows fornisce all'utente l'accesso alle informazioni della guida dal mouse inviando una notifica all'applicazione ogni volta che l'utente fa clic con il pulsante destro del mouse o fa clic su una finestra, un controllo o un menu dopo aver fatto clic sul pulsante question (?).</span><span class="sxs-lookup"><span data-stu-id="8b25e-138">Windows provides the user access to help information from the mouse by notifying the application whenever the user clicks the right mouse button or clicks a window, control, or menu after clicking the Question (?) button.</span></span> <span data-ttu-id="8b25e-139">L'applicazione risponde visualizzando le informazioni della Guida associate alla finestra, al controllo o al menu specificato.</span><span class="sxs-lookup"><span data-stu-id="8b25e-139">The application responds by displaying help information associated with the given window, control, or menu.</span></span>

<span data-ttu-id="8b25e-140">Il sistema invia un messaggio [**WM \_ ContextMenu**](../menurc/wm-contextmenu.md) quando l'utente fa clic con il pulsante destro del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-140">The system sends a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message when the user clicks the right mouse button.</span></span> <span data-ttu-id="8b25e-141">La finestra su cui è stato fatto clic riceve il messaggio.</span><span class="sxs-lookup"><span data-stu-id="8b25e-141">The window that was clicked receives the message.</span></span> <span data-ttu-id="8b25e-142">Se la finestra è una finestra figlio, ad esempio un controllo, la funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) passa il messaggio alla finestra padre.</span><span class="sxs-lookup"><span data-stu-id="8b25e-142">If the window is a child window, such as a control, the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function passes the message to the parent window.</span></span> <span data-ttu-id="8b25e-143">Il messaggio **WM \_ ContextMenu** specifica le coordinate del cursore del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-143">The **WM\_CONTEXTMENU** message specifies the coordinates of the mouse cursor.</span></span> <span data-ttu-id="8b25e-144">La coordinata x si trova nella parola di basso livello del parametro *lParam* e la coordinata y si trova nella parola più ordinata.</span><span class="sxs-lookup"><span data-stu-id="8b25e-144">The x-coordinate is in the low-order word of the *lParam* parameter, and the y-coordinate is in the high-order word.</span></span> <span data-ttu-id="8b25e-145">Se l'utente ha fatto clic su un controllo, il parametro *wParam* è l'handle per il controllo che ha ricevuto il clic.</span><span class="sxs-lookup"><span data-stu-id="8b25e-145">If the user clicked a control, the *wParam* parameter is the handle to the control that received the click.</span></span>

<span data-ttu-id="8b25e-146">Il sistema invia un messaggio della [**\_ Guida WM**](wm-help.md) quando l'utente fa clic su un elemento in una finestra dopo aver fatto clic sul pulsante question (?) che viene visualizzato nella barra del titolo della finestra.</span><span class="sxs-lookup"><span data-stu-id="8b25e-146">The system sends a [**WM\_HELP**](wm-help.md) message when the user clicks an item in a window after clicking the Question (?) button that appears in the title bar of the window.</span></span> <span data-ttu-id="8b25e-147">È possibile aggiungere un pulsante di domanda a una barra del titolo specificando lo stile **WS \_ ex \_ CONTEXTHELP** nella funzione [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) quando si crea la finestra.</span><span class="sxs-lookup"><span data-stu-id="8b25e-147">You can add a Question button to a title bar by specifying the **WS\_EX\_CONTEXTHELP** style in the [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) function when creating the window.</span></span> <span data-ttu-id="8b25e-148">Il parametro *lParam* della **\_ Guida WM** è un puntatore a una struttura [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) contenente informazioni dettagliate sull'elemento per il quale è richiesta la guida, incluse le coordinate del cursore del mouse al momento in cui l'utente ha fatto clic sul pulsante del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-148">The *lParam* parameter of **WM\_HELP** is a pointer to a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that contains detailed information about the item for which help is requested, including the coordinates of the mouse cursor at the time the user clicked the mouse button.</span></span>

<span data-ttu-id="8b25e-149">È consigliabile usare il pulsante domanda solo nelle finestre di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-149">The Question button is recommended for use in dialog boxes only.</span></span> <span data-ttu-id="8b25e-150">In passato, le applicazioni hanno fornito l'accesso utente per ottenere informazioni sulla guida relative a una finestra di dialogo, **fornendo un pulsante** ? nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-150">In the past, applications have provided user access to help information about a dialog box by providing a **Help** button in the dialog box.</span></span> <span data-ttu-id="8b25e-151">Questo metodo non è più consigliato.</span><span class="sxs-lookup"><span data-stu-id="8b25e-151">This method is no longer recommended.</span></span> <span data-ttu-id="8b25e-152">In alternativa, usare il pulsante question.</span><span class="sxs-lookup"><span data-stu-id="8b25e-152">Use the Question button instead.</span></span>

### <a name="help-display-and-windows-help"></a><span data-ttu-id="8b25e-153">Guida di visualizzazione e guida di Windows</span><span class="sxs-lookup"><span data-stu-id="8b25e-153">Help Display and Windows Help</span></span>

<span data-ttu-id="8b25e-154">Quando un'applicazione riceve una richiesta di assistenza, deve visualizzare le informazioni della guida appropriate.</span><span class="sxs-lookup"><span data-stu-id="8b25e-154">Once an application receives a request for help, it should display the appropriate help information.</span></span> <span data-ttu-id="8b25e-155">Poiché l'applicazione della Guida di Windows fornisce un'interfaccia utente coerente, è consigliabile che le applicazioni usino la Guida di Windows invece di altri metodi.</span><span class="sxs-lookup"><span data-stu-id="8b25e-155">Because the Windows Help application supplies a consistent user interface, it is recommended that applications use Windows Help rather than other methods.</span></span> <span data-ttu-id="8b25e-156">Per indirizzare la Guida di Windows alla visualizzazione di informazioni della guida, un'applicazione utilizza la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , specificando dettagli quali le informazioni da visualizzare e il formato della finestra in cui viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="8b25e-156">To direct Windows Help to display help information, an application uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, specifying details such as the information to display and the form of the window in which to display it.</span></span> <span data-ttu-id="8b25e-157">Le sezioni seguenti illustrano come usare **WinHelp** per visualizzare le informazioni della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-157">The following sections explain how to use **WinHelp** to display help information.</span></span>

### <a name="help-files"></a><span data-ttu-id="8b25e-158">file della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-158">Help files</span></span>

<span data-ttu-id="8b25e-159">Per visualizzare le informazioni della guida, è necessario specificare un file della guida quando si chiama la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-159">To view help information, you must specify a help file when calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="8b25e-160">Il file della guida deve avere il formato di file della Guida di Windows (con estensione hlp) e uno o più argomenti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-160">The help file must have the Windows Help (.hlp) file format and one or more topics.</span></span> <span data-ttu-id="8b25e-161">Ogni argomento è un'unità distinta di informazioni, ad esempio una descrizione concettuale, un set di istruzioni, un'immagine, una definizione di glossario e così via.</span><span class="sxs-lookup"><span data-stu-id="8b25e-161">Each topic is a distinct unit of information, such as a conceptual description, a set of instructions, a picture, a glossary definition, and so on.</span></span> <span data-ttu-id="8b25e-162">Gli argomenti devono essere identificati in modo univoco, in modo che la Guida di Windows possa individuarli ogni volta che vengono richiesti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-162">Topics must be uniquely identified so that Windows Help can locate them whenever they are requested.</span></span> <span data-ttu-id="8b25e-163">Internamente, la Guida di Windows utilizza gli identificatori di argomento per individuare gli argomenti, ma le applicazioni utilizzano più spesso identificatori di contesto (valori integer univoci) per specificare gli argomenti da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="8b25e-163">Internally, Windows Help uses topic identifiers to locate topics, but applications most often use context identifiers (unique integer values) to specify the topics to display.</span></span> <span data-ttu-id="8b25e-164">L'autore del file della guida deve eseguire in modo esplicito il mapping degli identificatori di contesto agli identificatori di argomento nella \[ \] sezione della mappa del file di progetto usato per compilare il file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-164">The help file author must explicitly map context identifiers to topic identifiers in the \[MAP\] section of the project file used to build the help file.</span></span>

<span data-ttu-id="8b25e-165">Quando si specifica un file della guida ma non si specifica un percorso, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) Cerca il file della guida nella directory della guida o in una directory specificata dalla variabile di ambiente Path.</span><span class="sxs-lookup"><span data-stu-id="8b25e-165">When you specify a help file but you do not specify a path, [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) looks for the help file in the help directory or in a directory specified by the PATH environment variable.</span></span> <span data-ttu-id="8b25e-166">Inoltre, **WinHelp** è in grado di trovare un file della guida il cui nome è elencato nel seguente percorso del registro di sistema:</span><span class="sxs-lookup"><span data-stu-id="8b25e-166">In addition, **WinHelp** can find a help file whose name is listed in the following registry location:</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            Help
```

<span data-ttu-id="8b25e-167">Per sfruttare i vantaggi del registro di sistema, è necessario creare un nome di valore con lo stesso nome del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-167">To take advantage of the registry, you must create a value name that has the same name as your help file.</span></span> <span data-ttu-id="8b25e-168">Il valore assegnato a tale nome deve corrispondere alla directory in cui risiede il file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-168">The value assigned to that name must be the directory where the help file resides.</span></span>

<span data-ttu-id="8b25e-169">Se [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) non riesce a trovare il file della Guida specificato, viene visualizzata una finestra di dialogo che consente all'utente di specificare il percorso del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-169">If [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) cannot find the given help file, it displays a dialog box that allows the user to specify the location of the help file.</span></span> <span data-ttu-id="8b25e-170">Poiché **WinHelp** Salva le informazioni sul percorso nel registro di sistema, non viene più richiesta la posizione dello stesso file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-170">Because **WinHelp** saves the location information in the registry, it does not ask again for the location of the same help file.</span></span>

<span data-ttu-id="8b25e-171">Per ulteriori informazioni su come creare e compilare un file della guida, vedere la documentazione fornita con gli strumenti di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-171">For more information about how to author and build a help file, see the documentation provided with your development tools.</span></span>

### <a name="starting-windows-help"></a><span data-ttu-id="8b25e-172">Avvio della Guida di Windows</span><span class="sxs-lookup"><span data-stu-id="8b25e-172">Starting Windows Help</span></span>

<span data-ttu-id="8b25e-173">Nell'esempio seguente viene usata la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) per avviare l'applicazione della Guida di Windows e aprire il file della guida nell'argomento relativo al contenuto.</span><span class="sxs-lookup"><span data-stu-id="8b25e-173">The following example uses the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to start the Windows Help application and open the help file to its Contents topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_CONTENTS, 0L);
```



<span data-ttu-id="8b25e-174">Nell'esempio seguente viene aperto il file della Guida dell'utente, viene eseguita una ricerca nel file per l'argomento associato a una stringa di parole chiave, quindi viene visualizzato l'argomento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-174">This next example opens the user help file, searches the file for the topic associated with a keyword string, and then displays the topic.</span></span>


```
HWND hwnd;     // main window handle 
BOOL bResult   // for checking Boolean function result 

bResult = WinHelp(hWnd, "WINNT.HLP", HELP_KEY, (DWORD) "finding topics");
```



### <a name="help-topics-dialog-box"></a><span data-ttu-id="8b25e-175">Finestra di dialogo argomenti della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-175">Help Topics dialog box</span></span>

<span data-ttu-id="8b25e-176">È possibile visualizzare la finestra di dialogo **argomenti della Guida** chiamando la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) con il comando **Help \_ Finder** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-176">You can display the **Help Topics** dialog box by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the **HELP\_FINDER** command.</span></span> <span data-ttu-id="8b25e-177">La finestra di dialogo **argomenti della Guida** consente all'utente di selezionare gli argomenti da visualizzare visualizzando i titoli degli argomenti, le parole chiave associate agli argomenti oppure le parole e le frasi trovate negli argomenti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-177">The **Help Topics** dialog box lets the user select topics to display by viewing the titles of the topics, the keywords associated with the topics, or the words and phrases found in the topics.</span></span> <span data-ttu-id="8b25e-178">In genere, le applicazioni visualizzano questa finestra di dialogo quando l'utente sceglie un comando, ad esempio gli argomenti della guida, dal menu?.</span><span class="sxs-lookup"><span data-stu-id="8b25e-178">Applications typically display this dialog box when the user chooses a command, such as Help Topics, from the Help menu.</span></span> <span data-ttu-id="8b25e-179">Un'applicazione può anche visualizzare questa finestra di dialogo se l'utente preme il tasto quando nessuna finestra, un controllo o un menu specifico nell'applicazione ha lo stato attivo o è attivo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-179">An application may also display this dialog box if the user presses the key when no specific window, control, or menu in the application has the focus or is active.</span></span>

<span data-ttu-id="8b25e-180">In passato, le applicazioni usavano il **\_ contenuto della Guida** e i comandi dell' **\_ Indice** della guida con la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) per visualizzare l'argomento contenuto e la parola chiave index del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-180">In the past, applications have used the **HELP\_CONTENTS** and **HELP\_INDEX** commands with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to display the Contents topic and the keyword index of the Help file.</span></span> <span data-ttu-id="8b25e-181">Questi comandi non sono più consigliati.</span><span class="sxs-lookup"><span data-stu-id="8b25e-181">These commands are no longer recommended.</span></span> <span data-ttu-id="8b25e-182">Usare invece il comando **Help \_ Finder** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-182">Use the **HELP\_FINDER** command instead.</span></span>

### <a name="information-topics"></a><span data-ttu-id="8b25e-183">Argomenti relativi alle informazioni</span><span class="sxs-lookup"><span data-stu-id="8b25e-183">Information topics</span></span>

<span data-ttu-id="8b25e-184">È possibile visualizzare un argomento specifico chiamando la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) con il comando di \_ contesto della guida e specificando l'identificatore di contesto per l'argomento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-184">You can display a specific topic by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_CONTEXT command and specifying the context identifier for the topic.</span></span> <span data-ttu-id="8b25e-185">Le applicazioni utilizzano in genere il comando di contesto della Guida \_ in risposta alle richieste dell'utente per argomenti contenenti informazioni concettuali o la guida procedurale anziché informazioni su un controllo o un menu specifico.</span><span class="sxs-lookup"><span data-stu-id="8b25e-185">Applications typically use the HELP\_CONTEXT command in response to user requests for topics containing conceptual information or procedural help rather than information about a specific control or menu.</span></span> <span data-ttu-id="8b25e-186">In questi casi, l'utente può continuare a esplorare il file della guida cercando le informazioni correlate prima di tornare all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-186">In such cases, the user may continue to browse the help file looking for related information before returning to the application.</span></span>

<span data-ttu-id="8b25e-187">Il \_ comando di contesto della guida richiama una normale istanza della Guida di Windows, consentendo all'utente di trovare altri argomenti nel file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-187">The HELP\_CONTEXT command invokes a regular instance of Windows Help, enabling the user to find other topics in the help file.</span></span> <span data-ttu-id="8b25e-188">Viene in genere visualizzata la finestra della guida principale, che include una barra del titolo, un menu di sistema, i pulsanti Riduci a icona e Ingrandisci, un menu principale, una barra di navigazione facoltativa, un bordo di ridimensionamento e un'area client.</span><span class="sxs-lookup"><span data-stu-id="8b25e-188">It typically displays the main Help window, which includes a title bar, a system menu, minimize and maximize buttons, a main menu, an optional navigation bar, a sizing border, and a client area.</span></span> <span data-ttu-id="8b25e-189">Il testo dell'argomento selezionato viene visualizzato nell'area client e l'utente può spostarsi nel file della guida usando i collegamenti sensibili o i pulsanti di spostamento nella finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-189">The text of the selected topic appears in the client area, and the user can navigate through the help file by using hot links or navigation buttons in the main window.</span></span> <span data-ttu-id="8b25e-190">È inoltre possibile utilizzare la Guida di Windows per visualizzare la Guida in una o più finestre secondarie anziché nella finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-190">The regular instance of Windows Help can also be used to display help in one or more secondary windows instead of the main window.</span></span>

### <a name="pop-up-topics"></a><span data-ttu-id="8b25e-191">Argomenti popup</span><span class="sxs-lookup"><span data-stu-id="8b25e-191">Pop-up topics</span></span>

<span data-ttu-id="8b25e-192">È possibile visualizzare un argomento popup che contiene informazioni per un controllo o un menu specifico chiamando la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) con il \_ comando Guida WM o Guida \_ \_ ContextMenu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-192">You can display a pop-up topic that contains information for a specific control or menu by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function with the HELP\_WM\_HELP or HELP\_CONTEXTMENU command.</span></span> <span data-ttu-id="8b25e-193">Questi comandi visualizzano un argomento in una finestra popup accanto al controllo o al menu corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8b25e-193">These commands display a topic in a pop-up window near the corresponding control or menu.</span></span> <span data-ttu-id="8b25e-194">Per consentire all'utente di tornare immediatamente a lavorare nell'applicazione, la finestra popup viene distrutta non appena l'utente preme un tasto o fa clic con il pulsante sinistro del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-194">To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.</span></span>

<span data-ttu-id="8b25e-195">Usare il comando Help \_ WM \_ Help per elaborare i messaggi della [**\_ Guida WM**](wm-help.md) per le finestre di controllo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-195">You use the HELP\_WM\_HELP command when processing [**WM\_HELP**](wm-help.md) messages for control windows.</span></span> <span data-ttu-id="8b25e-196">Poiché la maggior parte dei controlli passa il messaggio della **\_ Guida WM** alla funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , il messaggio viene elaborato dalla procedura della finestra di dialogo corrispondente (o dalla procedura della finestra padre).</span><span class="sxs-lookup"><span data-stu-id="8b25e-196">Because most controls pass the **WM\_HELP** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="8b25e-197">Anziché assegnare un identificatore di contesto specifico, la routine della finestra di dialogo deve passare una matrice di coppie di controlli e di identificatori di contesto a [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) insieme all'handle di controllo specificato nel membro **HItemHandle** della struttura [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) passata con il messaggio della **\_ Guida WM** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-197">Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) along with the control handle specified in the **hItemHandle** member of the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure passed with the **WM\_HELP** message.</span></span> <span data-ttu-id="8b25e-198">La funzione determina l'identificatore del controllo per il quale è stato generato il messaggio della **\_ Guida WM** e utilizza l'identificatore di contesto corrispondente per visualizzare l'argomento appropriato.</span><span class="sxs-lookup"><span data-stu-id="8b25e-198">The function determines the identifier of the control for which the **WM\_HELP** message was generated and uses the matching context identifier to display the appropriate topic.</span></span>

<span data-ttu-id="8b25e-199">Usare il comando HELP \_ ContextMenu quando si elaborano i messaggi di [**WM \_ ContextMenu**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-199">You use the HELP\_CONTEXTMENU command when processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="8b25e-200">Poiché la maggior parte dei controlli passa il messaggio **WM \_ ContextMenu** alla funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , il messaggio viene elaborato dalla routine della finestra di dialogo corrispondente o dalla routine della finestra padre.</span><span class="sxs-lookup"><span data-stu-id="8b25e-200">Because most controls pass the **WM\_CONTEXTMENU** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, the corresponding dialog box procedure (or parent window procedure) processes this message.</span></span> <span data-ttu-id="8b25e-201">La procedura specifica una matrice di coppie di controllo e di identificatore di contesto. Specifica inoltre l'handle nel parametro *wParam* quando si chiama [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , in modo che la funzione possa selezionare l'identificatore di contesto appropriato dalla matrice e visualizzare l'argomento appropriato.</span><span class="sxs-lookup"><span data-stu-id="8b25e-201">The procedure specifies an array of control and context identifier pairs; it also specifies the handle in the *wParam* parameter when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) so that the function can pick the appropriate context identifier from the array and display the appropriate topic.</span></span> <span data-ttu-id="8b25e-202">A differenza del comando della Guida \_ WM \_ , Help \_ ContextMenu Visualizza prima di tutto un comando **What ' s?** in un menu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-202">Unlike the HELP\_WM\_HELP command, HELP\_CONTEXTMENU first displays a **What's This?** command in a menu.</span></span> <span data-ttu-id="8b25e-203">Se l'utente sceglie il comando, **WinHelp** Visualizza l'argomento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-203">If the user chooses the command, **WinHelp** displays the topic.</span></span> <span data-ttu-id="8b25e-204">In caso contrario, la richiesta viene annullata.</span><span class="sxs-lookup"><span data-stu-id="8b25e-204">Otherwise, the request is canceled.</span></span>

<span data-ttu-id="8b25e-205">È anche possibile visualizzare gli argomenti popup usando il \_ comando help CONTEXTPOPUP e specificando un identificatore di contesto dell'argomento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-205">You can also display pop-up topics by using the HELP\_CONTEXTPOPUP command and specifying a context identifier of the topic.</span></span> <span data-ttu-id="8b25e-206">Questo comando è simile al comando del \_ contesto della guida ma richiama l'istanza popup della Guida di Windows usata dalla Guida di \_ WM e dalla Guida di \_ \_ ContextMenu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-206">This command is similar to the HELP\_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP\_WM\_HELP and HELP\_CONTEXTMENU.</span></span> <span data-ttu-id="8b25e-207">Le applicazioni possono utilizzare questo comando in risposta ai messaggi della [**\_ Guida di WM**](wm-help.md) per visualizzare la guida per i menu e per le finestre che non sono controlli in una finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-207">Applications can use this command in response to [**WM\_HELP**](wm-help.md) messages to display help for menus and for windows that are not controls in a dialog box.</span></span> <span data-ttu-id="8b25e-208">Per usare questo comando in modo più efficace, l'applicazione deve assegnare identificatori di contesto a questi menu e finestre.</span><span class="sxs-lookup"><span data-stu-id="8b25e-208">To use this command most effectively, the application should assign context identifiers to these menus and windows.</span></span>

<span data-ttu-id="8b25e-209">È possibile assegnare un identificatore di contesto a qualsiasi finestra o menu nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-209">You can assign a context identifier to any window or menu in the application.</span></span> <span data-ttu-id="8b25e-210">Quando viene generato un messaggio della [**\_ Guida WM**](wm-help.md) , il sistema include l'identificatore di contesto nella struttura [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) che viene passato alla finestra padre nel messaggio **della \_ Guida WM** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-210">When a [**WM\_HELP**](wm-help.md) message is generated, the system includes the context identifier in the [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure that is passed to the parent window in the **WM\_HELP** message.</span></span> <span data-ttu-id="8b25e-211">La finestra padre può quindi passare l'identificatore di contesto a [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) per visualizzare l'argomento della guida richiesto.</span><span class="sxs-lookup"><span data-stu-id="8b25e-211">The parent window can then pass the context identifier to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) to display the requested help topic.</span></span>

<span data-ttu-id="8b25e-212">Usare la funzione [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) per assegnare un identificatore di contesto a una finestra o a un controllo e la funzione [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) per assegnare un identificatore di contesto a un menu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-212">You use the [**SetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setwindowcontexthelpid) function to assign a context identifier to a window or control and the [**SetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-setmenucontexthelpid) function to assign a context identifier to a menu.</span></span> <span data-ttu-id="8b25e-213">È possibile recuperare l'identificatore di contesto per una finestra o un menu usando la funzione [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) o [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-213">You can retrieve the context identifier for a window or menu by using the [**GetWindowContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getwindowcontexthelpid) or [**GetMenuContextHelpId**](/windows/desktop/api/Winuser/nf-winuser-getmenucontexthelpid) function.</span></span>

### <a name="keyword-searches"></a><span data-ttu-id="8b25e-214">Ricerche di parole chiave</span><span class="sxs-lookup"><span data-stu-id="8b25e-214">Keyword searches</span></span>

<span data-ttu-id="8b25e-215">È possibile consentire all'utente di trovare e visualizzare gli argomenti assegnando parole chiave agli argomenti del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-215">You can enable the user to find and view topics by assigning keywords to topics in the help file.</span></span> <span data-ttu-id="8b25e-216">Una parola chiave è semplicemente una stringa associata a uno o più argomenti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-216">A keyword is simply a string that is associated with one or more topics.</span></span> <span data-ttu-id="8b25e-217">La Guida di Windows raccoglie tutte le parole chiave in un file della guida, le inserisce in una tabella e le Visualizza nell'elenco indice della finestra di dialogo **argomenti della Guida** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-217">Windows Help collects all keywords in a help file, places them in a table, and displays them in the Index list of the **Help Topics** dialog box.</span></span> <span data-ttu-id="8b25e-218">Quando l'utente seleziona una parola chiave, la Guida di Windows Visualizza l'argomento della Guida associato o, se è presente più di un argomento associato alla parola chiave, Visualizza un elenco di argomenti da cui l'utente può scegliere.</span><span class="sxs-lookup"><span data-stu-id="8b25e-218">When the user selects a keyword, Windows Help displays the associated help topic or, if there is more than one topic associated with the keyword, displays a list of topics from which the user can choose.</span></span>

<span data-ttu-id="8b25e-219">In un'applicazione, è possibile usare il \_ tasto Help, la Guida \_ PARTIALKEY o il \_ comando help join con la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) per cercare e visualizzare gli argomenti della Guida in base a parole chiave intere o parziali.</span><span class="sxs-lookup"><span data-stu-id="8b25e-219">In an application, you can use the HELP\_KEY, HELP\_PARTIALKEY, or HELP\_MULTIKEY command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to search for and display help topics based on whole or partial keywords.</span></span> <span data-ttu-id="8b25e-220">Si specificano il comando, la parola chiave String, il file della guida e l'handle per la finestra proprietaria.</span><span class="sxs-lookup"><span data-stu-id="8b25e-220">You specify the command, the keyword string, the help file, and the handle to the owner window.</span></span> <span data-ttu-id="8b25e-221">In tutti i casi, se viene rilevata una corrispondenza singola, **WinHelp** Visualizza l'argomento corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8b25e-221">In all cases, if a single match is found, **WinHelp** displays the corresponding topic.</span></span> <span data-ttu-id="8b25e-222">Se viene trovata più di una corrispondenza, la funzione Visualizza la finestra di dialogo Argomenti trovati e l'utente può scegliere quale argomento visualizzare.</span><span class="sxs-lookup"><span data-stu-id="8b25e-222">If more than one match is found, the function displays the Topics Found dialog box, and the user can choose which topic to view.</span></span> <span data-ttu-id="8b25e-223">Se non viene trovata alcuna corrispondenza, **WinHelp** Visualizza l'elenco degli indici (per la chiave della Guida \_ e la Guida \_ PARTIALKEY) o Visualizza un messaggio di errore (per la Guida \_ join).</span><span class="sxs-lookup"><span data-stu-id="8b25e-223">If no match is found, **WinHelp** either displays the Index list (for HELP\_KEY and HELP\_PARTIALKEY) or displays an error message (for HELP\_MULTIKEY).</span></span>

<span data-ttu-id="8b25e-224">L'applicazione può cercare più parole chiave in una singola chiamata a [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) separando le parole chiave con punti e virgola.</span><span class="sxs-lookup"><span data-stu-id="8b25e-224">Your application can search for multiple keywords in a single call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) by separating the keywords with semicolons.</span></span> <span data-ttu-id="8b25e-225">La ricerca di più parole chiave non è supportata per i file della Guida creati per Windows versione 3. *x*) consente anche di cercare parole chiave in più file della guida se il file della Guida specificato contiene un file di contenuto (. cnt) che contiene i comandi: index o: link.</span><span class="sxs-lookup"><span data-stu-id="8b25e-225">(Searching for multiple keywords is not supported for help files created for Windows version 3.*x*) It can also search for keywords across multiple help files if the help file that is specified has a contents(.cnt) file that contains :Index or :Link commands.</span></span> <span data-ttu-id="8b25e-226">Con il \_ comando della chiave Help, **WinHelp** Cerca le parole chiave in tutti i file specificati da questi comandi.</span><span class="sxs-lookup"><span data-stu-id="8b25e-226">With the HELP\_KEY command, **WinHelp** searches for keywords in all files specified by these commands.</span></span> <span data-ttu-id="8b25e-227">Con i \_ comandi join e Help \_ PARTIALKEY della guida, la funzione Cerca tutti i file tranne quelli specificati da: comandi di collegamento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-227">With the HELP\_MULTIKEY and HELP\_PARTIALKEY commands, the function searches all files except those specified by :Link commands.</span></span>

<span data-ttu-id="8b25e-228">Per impostazione predefinita, la Guida di Windows riconosce solo la tabella delle parole chiave identificata dal carattere a nota K nel file di origine della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-228">By default, Windows Help recognizes only the keyword table identified by the K footnote character in the help source file.</span></span> <span data-ttu-id="8b25e-229">È possibile indirizzare la Guida di Windows alla creazione di tabelle di parole chiave aggiuntive aggiungendo un carattere a piè di pagina diverso da K, con la definizione della parola chiave, nel file di origine della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-229">You can direct Windows Help to create additional keyword tables by adding a footnote character other than K, with the keyword definition, in the help source file.</span></span> <span data-ttu-id="8b25e-230">(Il carattere A piè di pagina A, tuttavia, è riservato). Quando si compila il file della guida, è necessario definire le tabelle di parole chiave aggiuntive usando le istruzioni JOIN nella \[ \] sezione Opzioni del file di progetto.</span><span class="sxs-lookup"><span data-stu-id="8b25e-230">(The footnote character A, however, is reserved.) You must define any additional keyword tables by using MULTIKEY statements in the \[OPTIONS\] section of the project file when building the help file.</span></span>

<span data-ttu-id="8b25e-231">Un'applicazione può usare il \_ comando help SetIndex con la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) per indirizzare la Guida di Windows alla visualizzazione di una tabella di parole chiave diversa da K nell'elenco degli indici.</span><span class="sxs-lookup"><span data-stu-id="8b25e-231">An application can use the HELP\_SETINDEX command with the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function to direct Windows Help to display a keyword table other than K in its Index list.</span></span> <span data-ttu-id="8b25e-232">Per indirizzare la Guida di Windows alla ricerca di una parola chiave in una tabella di parole chiave alternativa, un'applicazione può usare il \_ comando help join.</span><span class="sxs-lookup"><span data-stu-id="8b25e-232">To direct Windows Help to search for a keyword in an alternate keyword table, an application can use the HELP\_MULTIKEY command.</span></span> <span data-ttu-id="8b25e-233">È possibile specificare la parola chiave e la tabella delle parole chiave in una struttura [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) , che viene passata a **WinHelp**.</span><span class="sxs-lookup"><span data-stu-id="8b25e-233">You specify the keyword and keyword table in a [**MULTIKEYHELP**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) structure, which you pass to **WinHelp**.</span></span>

<span data-ttu-id="8b25e-234">Quando in [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) viene visualizzato un argomento, questo viene visualizzato nella finestra specificata dalla nota ">" per l'argomento, nella finestra specificata dal comando: base nel file di contenuto o nella finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-234">When [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) displays a topic, it displays it in the window specified by the ">" footnote for the topic, in the window specified by the :Base command in the contents file, or in the main window.</span></span> <span data-ttu-id="8b25e-235">Se la finestra principale è già aperta a un file della Guida diverso quando si chiama **WinHelp**, la funzione nasconde la finestra principale durante la ricerca.</span><span class="sxs-lookup"><span data-stu-id="8b25e-235">If the main window is already open to a different help file when you call **WinHelp**, the function hides the main window while searching.</span></span> <span data-ttu-id="8b25e-236">In questo caso, l'annullamento di entrambe le finestre di dialogo **argomenti trovati** e **argomenti della Guida** chiude la finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-236">In this case, canceling both the **Topics Found** and **Help Topics** dialog boxes closes the main window.</span></span>

### <a name="secondary-help-windows"></a><span data-ttu-id="8b25e-237">Finestre della guida secondaria</span><span class="sxs-lookup"><span data-stu-id="8b25e-237">Secondary Help windows</span></span>

<span data-ttu-id="8b25e-238">La finestra principale dell'applicazione della Guida di Windows è detta finestra principale.</span><span class="sxs-lookup"><span data-stu-id="8b25e-238">The main window of the Windows Help application is called the primary window.</span></span> <span data-ttu-id="8b25e-239">La Guida di Windows consente inoltre di visualizzare gli argomenti della Guida in una finestra secondaria.</span><span class="sxs-lookup"><span data-stu-id="8b25e-239">Windows Help can also display help topics in a secondary window.</span></span> <span data-ttu-id="8b25e-240">A differenza della finestra della guida principale, una finestra secondaria non contiene una barra dei menu.</span><span class="sxs-lookup"><span data-stu-id="8b25e-240">Unlike the primary Help window, a secondary window does not contain a menu bar.</span></span> <span data-ttu-id="8b25e-241">È possibile includere una barra di navigazione in una finestra secondaria ed è possibile aggiungere pulsanti alla barra.</span><span class="sxs-lookup"><span data-stu-id="8b25e-241">You can include a navigation bar in a secondary window, and you can add buttons to the bar.</span></span> <span data-ttu-id="8b25e-242">È inoltre possibile scegliere di impostare automaticamente la Guida di Windows per regolare l'altezza della finestra secondaria in modo da includere l'argomento.</span><span class="sxs-lookup"><span data-stu-id="8b25e-242">You can also choose to have Windows Help automatically adjust the height of the secondary window to accommodate the topic.</span></span>

<span data-ttu-id="8b25e-243">È necessario definire le finestre secondarie \[ nella \] sezione Windows del file di progetto della guida, specificando il nome e, facoltativamente, le dimensioni iniziali e la posizione di ogni finestra.</span><span class="sxs-lookup"><span data-stu-id="8b25e-243">You must define secondary windows in the \[WINDOWS\] section of your help project file, providing the name and, optionally, initial size and position of each window.</span></span> <span data-ttu-id="8b25e-244">È possibile indirizzare l'applicazione della Guida di Windows per visualizzare un argomento in una finestra secondaria aggiungendo una parentesi uncinata (>) e il nome definito per la finestra secondaria al nome del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-244">You can direct the Windows Help application to display a topic in a secondary window by appending an angle bracket (>) and the name you have defined for the secondary window to the name of the help file.</span></span> <span data-ttu-id="8b25e-245">La stringa risultante viene quindi passata alla funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-245">The resulting string is then passed to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="8b25e-246">Un'applicazione può modificare le dimensioni e la posizione di una finestra primaria o secondaria specificando l'indirizzo di una struttura [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) e il \_ comando help SETWINPOS in una chiamata a [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="8b25e-246">An application can change the size and position of a primary or secondary window by specifying the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure and the HELP\_SETWINPOS command in a call to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="8b25e-247">**HELPWININFO** specifica il nome della finestra e le nuove dimensioni e posizione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-247">**HELPWININFO** specifies the name of the window and its new size and position.</span></span>

### <a name="training-card-help"></a><span data-ttu-id="8b25e-248">Guida alla scheda di formazione</span><span class="sxs-lookup"><span data-stu-id="8b25e-248">Training card help</span></span>

<span data-ttu-id="8b25e-249">Utilizzando la guida alla scheda di training, un'applicazione può visualizzare una sequenza di istruzioni per guidare l'utente nei passaggi di un'attività.</span><span class="sxs-lookup"><span data-stu-id="8b25e-249">Using training card help, an application can display a sequence of instructions to guide the user through the steps of a task.</span></span> <span data-ttu-id="8b25e-250">Una scheda di training è costituita in genere da testo che illustra un particolare passaggio e i pulsanti associati alle macro TCard, che consentono all'utente di indicare all'applicazione cosa fare successivamente.</span><span class="sxs-lookup"><span data-stu-id="8b25e-250">A training card typically consists of text that explains a particular step and buttons that are associated with TCard macros, which allow the user to tell the application what to do next.</span></span> <span data-ttu-id="8b25e-251">Le schede di training possono essere visualizzate solo nelle finestre secondarie e non devono contenere collegamenti sensibili ad altri argomenti del file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-251">Training cards can only be displayed in secondary windows and must not contain hot links to other topics in the help file.</span></span>

<span data-ttu-id="8b25e-252">Un'applicazione avvia l'istanza della scheda di training della Guida di Windows chiamando la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) e specificando il \_ comando help TCARD in combinazione con un altro comando, ad esempio il contesto della Guida \_ .</span><span class="sxs-lookup"><span data-stu-id="8b25e-252">An application initiates the training card instance of Windows Help by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_TCARD command in combination with another command, such as HELP\_CONTEXT.</span></span> <span data-ttu-id="8b25e-253">Successivamente, quando l'utente fa clic su un pulsante nella scheda di training, fa clic su un punto attivo assegnato alla macro TCard o chiude la scheda di training, Windows Help invia una notifica all'applicazione inviando un messaggio [**WM \_ TCard**](wm-tcard.md) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-253">Subsequently, when the user clicks a button in the training card, clicks a hot spot assigned to the TCard macro, or closes the training card, Windows Help notifies the application by sending it a [**WM\_TCARD**](wm-tcard.md) message.</span></span> <span data-ttu-id="8b25e-254">Il parametro *wParam* identifica il pulsante o l'azione dell'utente e il parametro *lParam* contiene dati aggiuntivi, il cui significato dipende dal valore di *wParam*.</span><span class="sxs-lookup"><span data-stu-id="8b25e-254">The *wParam* parameter identifies the button or user action, and the *lParam* parameter contains additional data, the meaning of which depends on the value of *wParam*.</span></span>

### <a name="canceling-help"></a><span data-ttu-id="8b25e-255">Annullamento della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-255">Canceling Help</span></span>

<span data-ttu-id="8b25e-256">La Guida di Windows richiede che un'applicazione annulli esplicitamente la Guida in modo da poter liberare le risorse usate per tenere traccia dell'applicazione e dei relativi file della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-256">Windows Help requires an application to explicitly cancel help so that it can free any resources used to keep track of the application and its help files.</span></span> <span data-ttu-id="8b25e-257">L'applicazione può eseguire questa operazione in qualsiasi momento chiamando la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) e specificando il \_ comando help Quit.</span><span class="sxs-lookup"><span data-stu-id="8b25e-257">The application can do this at any time by calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function and specifying the HELP\_QUIT command.</span></span> <span data-ttu-id="8b25e-258">Si noti che questa operazione non è valida per l'istanza popup della Guida di Windows.</span><span class="sxs-lookup"><span data-stu-id="8b25e-258">Note that this is not true for the pop-up instance of Windows Help.</span></span> <span data-ttu-id="8b25e-259">Un'applicazione non deve tentare di chiudere un'istanza popup.</span><span class="sxs-lookup"><span data-stu-id="8b25e-259">An application should not try to close a pop-up instance.</span></span>

<span data-ttu-id="8b25e-260">Se un'applicazione ha effettuato chiamate a [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), è necessario annullare la guida prima di chiudere la finestra principale (ad esempio, in risposta al messaggio WM \_ Destroy nella procedura della finestra principale).</span><span class="sxs-lookup"><span data-stu-id="8b25e-260">If an application has made any calls to [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa), it must cancel help before it closes its main window (for example, in response to the WM\_DESTROY message in the main window procedure).</span></span> <span data-ttu-id="8b25e-261">Per annullare la guida, un'applicazione deve chiamare **WinHelp** solo una volta, indipendentemente dal numero di file della Guida aperti.</span><span class="sxs-lookup"><span data-stu-id="8b25e-261">An application needs to call **WinHelp** only once to cancel help, no matter how many help files it has opened.</span></span> <span data-ttu-id="8b25e-262">La Guida di Windows rimane in esecuzione fino a quando non viene annullata la guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-262">Windows Help remains running until all applications or DLLs have canceled help.</span></span>

<span data-ttu-id="8b25e-263">Per chiudere l'istanza della scheda di training della Guida di Windows, è necessario specificare sia la Guida \_ TCARD che la Guida \_ Quit quando si chiama [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span><span class="sxs-lookup"><span data-stu-id="8b25e-263">To close the training card instance of Windows Help, you must specify both the HELP\_TCARD and HELP\_QUIT commands when calling [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa).</span></span> <span data-ttu-id="8b25e-264">Non è necessario che un'applicazione annulli l'istanza della carta di formazione della Guida di Windows se l'utente annulla prima l'operazione.</span><span class="sxs-lookup"><span data-stu-id="8b25e-264">An application does not need to cancel the training card instance of Windows Help if the user cancels it first.</span></span> <span data-ttu-id="8b25e-265">La Guida di Windows notifica a un'applicazione quando l'utente annulla l'istanza della carta di training inviando il messaggio [**WM \_ TCARD**](wm-tcard.md) con il parametro *wParam* impostato su IDCLOSE.</span><span class="sxs-lookup"><span data-stu-id="8b25e-265">Windows Help notifies an application when the user cancels the training card instance by sending the [**WM\_TCARD**](wm-tcard.md) message with the *wParam* parameter set to IDCLOSE.</span></span>

## <a name="using-help"></a><span data-ttu-id="8b25e-266">Uso della Guida</span><span class="sxs-lookup"><span data-stu-id="8b25e-266">Using Help</span></span>

<span data-ttu-id="8b25e-267">In questa sezione viene illustrato come fornire la Guida sensibile al contesto per una finestra di dialogo e come impostare l'aspetto di una finestra della guida secondaria.</span><span class="sxs-lookup"><span data-stu-id="8b25e-267">This section shows how to provide context-sensitive help for a dialog box and how to set the appearance of a secondary Help window.</span></span>

-   [<span data-ttu-id="8b25e-268">Fornire la Guida in una finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="8b25e-268">Providing Help in a Dialog Box</span></span>](#providing-help-in-a-dialog-box)
-   [<span data-ttu-id="8b25e-269">Impostazione dell'aspetto di una finestra della guida secondaria</span><span class="sxs-lookup"><span data-stu-id="8b25e-269">Setting the Appearance of a Secondary Help Window</span></span>](#setting-the-appearance-of-a-secondary-help-window)

### <a name="providing-help-in-a-dialog-box"></a><span data-ttu-id="8b25e-270">Fornire la Guida in una finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="8b25e-270">Providing Help in a Dialog Box</span></span>

<span data-ttu-id="8b25e-271">Per fornire la Guida sensibile al contesto in una finestra di dialogo, è necessario creare una matrice costituita da coppie di valori **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-271">To provide context-sensitive help in a dialog box, you must create an array consisting of pairs of **DWORD** values.</span></span> <span data-ttu-id="8b25e-272">Il primo valore in ogni coppia è l'identificatore di un controllo nella finestra di dialogo e il secondo è l'identificatore di contesto dell'argomento della Guida per il controllo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-272">The first value in each pair is the identifier of a control in the dialog box, and the second is the context identifier of the help topic for the control.</span></span> <span data-ttu-id="8b25e-273">La matrice deve contenere una coppia di identificatori per ogni controllo nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-273">The array should contain one pair of identifiers for each control in the dialog box.</span></span>

<span data-ttu-id="8b25e-274">La routine della finestra di dialogo deve elaborare i messaggi della [**\_ Guida WM**](wm-help.md) e del [**\_ ContextMenu di WM**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-274">The dialog box procedure must process the [**WM\_HELP**](wm-help.md) and [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) messages.</span></span> <span data-ttu-id="8b25e-275">La procedura della finestra di dialogo riceve la **\_ Guida di WM** quando l'utente preme il tasto e il file di conferma di **WM \_** quando l'utente fa clic con il pulsante destro del mouse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-275">The dialog box procedure receives **WM\_HELP** when the user presses the key and **WM\_CONTEXTMENU** when the user clicks the right mouse button.</span></span>

<span data-ttu-id="8b25e-276">Il parametro *lParam* della [**\_ Guida di WM**](wm-help.md) contiene l'indirizzo di una struttura [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-276">The *lParam* parameter of [**WM\_HELP**](wm-help.md) contains the address of a [**HELPINFO**](/windows/win32/api/winuser/ns-winuser-helpinfo) structure.</span></span> <span data-ttu-id="8b25e-277">Il membro **hItemHandle** della struttura identifica il controllo per il quale l'utente ha richiesto la guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-277">The **hItemHandle** member of this structure identifies the control for which the user has requested help.</span></span> <span data-ttu-id="8b25e-278">È necessario passare questo handle alla funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) insieme al \_ comando Guida WM \_ , il nome del file della guida e un puntatore alla matrice di identificatori.</span><span class="sxs-lookup"><span data-stu-id="8b25e-278">You must pass this handle to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function along with the HELP\_WM\_HELP command, the name of your help file, and a pointer to the array of identifiers.</span></span> <span data-ttu-id="8b25e-279">La funzione **WinHelp** Cerca nella matrice l'identificatore di controllo del controllo specificato e quindi recupera l'identificatore di contesto della Guida corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8b25e-279">The **WinHelp** function searches the array for the control identifier of the specified control and then retrieves the corresponding help context identifier.</span></span> <span data-ttu-id="8b25e-280">Successivamente, la funzione passa l'identificatore di contesto della Guida alla guida di Windows, che trova l'argomento corrispondente e lo Visualizza in una finestra popup.</span><span class="sxs-lookup"><span data-stu-id="8b25e-280">Next, the function passes the help context identifier to Windows Help, which finds the corresponding topic and displays it in a pop-up window.</span></span> <span data-ttu-id="8b25e-281">Se il controllo ha un identificatore pari a-1, il sistema cerca il controllo successivo che rappresenta una tabulazione, quindi usa il relativo identificatore per trovare l'identificatore di contesto della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-281">If the control has an identifier of -1, the system searches for the next control that is a tab stop and then uses its identifier to find the help context identifier.</span></span> <span data-ttu-id="8b25e-282">Per questo motivo, è importante inserire testo statico prima dei controlli in un file di risorse.</span><span class="sxs-lookup"><span data-stu-id="8b25e-282">For this reason, it is important that you place static text before controls in a resource file.</span></span>

<span data-ttu-id="8b25e-283">Quando si chiama la funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) , l'elaborazione di [**WM \_ ContextMenu**](../menurc/wm-contextmenu.md) è simile all'elaborazione della [**\_ Guida di WM**](wm-help.md) con queste due eccezioni:</span><span class="sxs-lookup"><span data-stu-id="8b25e-283">When calling the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function, processing [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) is similar to processing [**WM\_HELP**](wm-help.md) with these two exceptions:</span></span>

-   <span data-ttu-id="8b25e-284">Il parametro *wParam* viene passato da [**WM \_ ContextMenu**](../menurc/wm-contextmenu.md), che è l'handle per il controllo che ha inviato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="8b25e-284">You pass the *wParam* parameter from [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md), which is the handle to the control that sent the message.</span></span>
-   <span data-ttu-id="8b25e-285">Specificare il comando **Help \_ ContextMenu** anziché la Guida **di \_ WM \_**.</span><span class="sxs-lookup"><span data-stu-id="8b25e-285">You specify the **HELP\_CONTEXTMENU** command instead of **HELP\_WM\_HELP**.</span></span>

<span data-ttu-id="8b25e-286">Il comando **Help \_ ContextMenu** fa sì che la Guida di Windows visualizzi un menu prima di visualizzare l'argomento della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-286">The **HELP\_CONTEXTMENU** command causes Windows Help to display a menu before it displays the help topic.</span></span> <span data-ttu-id="8b25e-287">Il menu è definito dal sistema.</span><span class="sxs-lookup"><span data-stu-id="8b25e-287">The menu is system-defined.</span></span> <span data-ttu-id="8b25e-288">Consente all'utente di visualizzare la guida per il controllo o di visualizzare la finestra di dialogo **argomenti della Guida** .</span><span class="sxs-lookup"><span data-stu-id="8b25e-288">It allows the user to display help for the control or to display the **Help Topics** dialog box.</span></span>

<span data-ttu-id="8b25e-289">Nell'esempio seguente viene illustrato come implementare la Guida sensibile al contesto in una finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8b25e-289">The following example shows how to implement context-sensitive help in a dialog box.</span></span>


```
LRESULT CALLBACK EditDlgProc(HWND hwndDlg, UINT uMsg, 
                             WPARAM wParam, LPARAM lParam) 
{ 
    // Create an array of control identifiers and context identifiers. 
    static DWORD aIds[ ] = 
    { 
        ID_SAVE,   IDH_SAVE, 
        ID_DELETE, IDH_DELETE, 
        ID_COPY,   IDH_COPY, 
        ID_PASTE,  IDH_PASTE, 
        0,0 
    }; 

    switch (uMsg) 
    { 
        case WM_HELP: 
            WinHelp(((LPHELPINFO)lParam)->hItemHandle, "helpfile.hlp", 
                    HELP_WM_HELP, (DWORD)(LPSTR)aIds); 
            break; 

        case WM_CONTEXTMENU: 
            WinHelp((HWND)wParam, "helpfile.hlp", HELP_CONTEXTMENU, 
                    (DWORD)(LPVOID)aIds); 
            break; 
        
        // Process other messages here. 
    } 
    return FALSE; 
}
```



### <a name="setting-the-appearance-of-a-secondary-help-window"></a><span data-ttu-id="8b25e-290">Impostazione dell'aspetto di una finestra della guida secondaria</span><span class="sxs-lookup"><span data-stu-id="8b25e-290">Setting the Appearance of a Secondary Help Window</span></span>

<span data-ttu-id="8b25e-291">Un'applicazione può impostare le dimensioni, la posizione e visualizzare lo stato di una finestra della guida secondaria passando il \_ comando help SETWINPOS e l'indirizzo di una struttura [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) alla funzione [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="8b25e-291">An application can set the size, position, and show state of a secondary help window by passing the HELP\_SETWINPOS command and the address of a [**HELPWININFO**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) structure to the [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa) function.</span></span> <span data-ttu-id="8b25e-292">I membri di **HELPWININFO** specificano il nome della finestra da modificare e le nuove dimensioni, la posizione e lo stato di visualizzazione della finestra.</span><span class="sxs-lookup"><span data-stu-id="8b25e-292">The members of **HELPWININFO** specify the name of the window to change and the window's new size, position, and show state.</span></span>

<span data-ttu-id="8b25e-293">Nell'esempio seguente viene impostato l'aspetto di una finestra secondaria denominata "WND \_ menu".</span><span class="sxs-lookup"><span data-stu-id="8b25e-293">The following example sets the appearance of a secondary window named "wnd\_menu".</span></span> <span data-ttu-id="8b25e-294">Il nome deve essere definito nella \[ sezione Windows \] del file di progetto della guida.</span><span class="sxs-lookup"><span data-stu-id="8b25e-294">The name must be defined in the \[WINDOWS\] section of the help project file.</span></span>


```
BOOL DoWindowSize(VOID) 
{ 
    HANDLE hhwi; 
    LPHELPWININFO lphwi; 
    WORD wSize; 
    char *szWndName = "wnd_menu"; 
    size_t NameLength;      // Does not include the terminating null character
    HRESULT hr
    BOOL retval;

    hr = StringCbLengthA(szWndName, STRSAFE_MAX_CCH, &NameLength);
    
    if (SUCCEEDED(hr))
    {
        // Add 1 to account for the name string's terminating null character.
        NameLength++;
        
        // The HELPWININFO structure contains a minimal TCHAR array of size [2] 
        // that is used for the window name. Since sizeof(HELPWININFO) 
        // includes those two TCHARS, they must be subtracted from the 
        // total when adding the actual string length to calculate the  
        // size of the structure. 
        wSize = sizeof(HELPWININFO) - 2 + NameLength; 
    }
    else
        // Something's amiss with the string.
        return FALSE;
        
    hhwi  = GlobalAlloc(GHND, wSize); 
    lphwi = (LPHELPWININFO)GlobalLock(hhwi); 

    lphwi->wStructSize = wSize; 
    lphwi->x    = 256;      // horizontal position 
    lphwi->y    = 256;      // vertical position 
    lphwi->dx   = 767;      // width 
    lphwi->dy   = 512;      // height 
    lphwi->wMax = SW_SHOW;  // show the window 
    
    // secondary window
    hr = StringCbCopyA(lphwi->rgchMember, sizeof(lphwi->rgchMember), szWndName);
    
    if (SUCCEEDED(hr))
    {
        WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, (DWORD)lphwi); 
     
        GlobalUnlock(hhwi); 
        GlobalFree(hhwi); 

        return TRUE; 
    }
    else
        // There was a problem copying the window name.
        return FALSE;
}
```



 

 
