---
description: Un collegamento della shell è un oggetto dati che contiene informazioni utilizzate per accedere a un altro oggetto nello spazio dei nomi della shell&\# 8212, ovvero qualsiasi oggetto visibile tramite Esplora risorse.
ms.assetid: 32ad306d-54bd-4130-ad30-08db50ef106e
title: Collegamenti Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 327bcb425f998bcc2a4c0714118d4461ded253ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104232114"
---
# <a name="shell-links"></a><span data-ttu-id="403e0-103">Collegamenti Shell</span><span class="sxs-lookup"><span data-stu-id="403e0-103">Shell Links</span></span>

<span data-ttu-id="403e0-104">Un *collegamento della shell* è un oggetto dati che contiene le informazioni utilizzate per accedere a un altro oggetto nello spazio dei nomi della shell, ovvero qualsiasi oggetto visibile tramite Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="403e0-104">A *Shell link* is a data object that contains information used to access another object in the Shell's namespace—that is, any object visible through Windows Explorer.</span></span> <span data-ttu-id="403e0-105">I tipi di oggetti a cui è possibile accedere tramite i collegamenti della shell includono file, cartelle, unità disco e stampanti.</span><span class="sxs-lookup"><span data-stu-id="403e0-105">The types of objects that can be accessed through Shell links include files, folders, disk drives, and printers.</span></span> <span data-ttu-id="403e0-106">Un collegamento della shell consente a un utente o a un'applicazione di accedere a un oggetto da qualsiasi punto dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="403e0-106">A Shell link allows a user or an application to access an object from anywhere in the namespace.</span></span> <span data-ttu-id="403e0-107">Non è necessario che l'utente o l'applicazione conosca il nome e il percorso correnti dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-107">The user or application does not need to know the current name and location of the object.</span></span>

-   [<span data-ttu-id="403e0-108">Informazioni sui collegamenti della shell</span><span class="sxs-lookup"><span data-stu-id="403e0-108">About Shell Links</span></span>](#about-shell-links)
    -   [<span data-ttu-id="403e0-109">Risoluzione dei collegamenti</span><span class="sxs-lookup"><span data-stu-id="403e0-109">Link Resolution</span></span>](#link-resolution)
    -   [<span data-ttu-id="403e0-110">File di collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-110">Link Files</span></span>](#link-files)
    -   [<span data-ttu-id="403e0-111">Identificatori di elementi ed elenchi di identificatori</span><span class="sxs-lookup"><span data-stu-id="403e0-111">Item Identifiers and Identifier Lists</span></span>](#item-identifiers-and-identifier-lists)
-   [<span data-ttu-id="403e0-112">Uso di collegamenti della shell</span><span class="sxs-lookup"><span data-stu-id="403e0-112">Using Shell Links</span></span>](#using-shell-links)
    -   [<span data-ttu-id="403e0-113">Creazione di un collegamento e di un collegamento a una cartella in un file</span><span class="sxs-lookup"><span data-stu-id="403e0-113">Creating a Shortcut and a Folder Shortcut to a File</span></span>](#creating-a-shortcut-and-a-folder-shortcut-to-a-file)
    -   [<span data-ttu-id="403e0-114">Risoluzione di un collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-114">Resolving a Shortcut</span></span>](#resolving-a-shortcut)
    -   [<span data-ttu-id="403e0-115">Creazione di un collegamento a un oggetto non file</span><span class="sxs-lookup"><span data-stu-id="403e0-115">Creating a Shortcut to a Nonfile Object</span></span>](#creating-a-shortcut-to-a-nonfile-object)

## <a name="about-shell-links"></a><span data-ttu-id="403e0-116">Informazioni sui collegamenti della shell</span><span class="sxs-lookup"><span data-stu-id="403e0-116">About Shell Links</span></span>

<span data-ttu-id="403e0-117">L'utente crea un collegamento della shell scegliendo il comando **Crea collegamento** dal menu di scelta rapida di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-117">The user creates a Shell link by choosing the **Create Shortcut** command from an object's shortcut menu.</span></span> <span data-ttu-id="403e0-118">Il sistema crea automaticamente un'icona per il collegamento della shell combinando l'icona dell'oggetto con una piccola freccia (nota come icona della sovrapposizione dei collegamenti definita dal sistema) visualizzata nell'angolo inferiore sinistro dell'icona.</span><span class="sxs-lookup"><span data-stu-id="403e0-118">The system automatically creates an icon for the Shell link by combining the object's icon with a small arrow (known as the system-defined link overlay icon) that appears in the lower left corner of the icon.</span></span> <span data-ttu-id="403e0-119">Un collegamento della shell con un'icona viene definito collegamento. Tuttavia, i termini collegamento e collegamento della shell vengono spesso usati in modo interscambiabile.</span><span class="sxs-lookup"><span data-stu-id="403e0-119">A Shell link that has an icon is called a shortcut; however, the terms Shell link and shortcut are often used interchangeably.</span></span> <span data-ttu-id="403e0-120">In genere, l'utente crea collegamenti per ottenere accesso rapido agli oggetti archiviati nelle sottocartelle o in cartelle condivise in altri computer.</span><span class="sxs-lookup"><span data-stu-id="403e0-120">Typically, the user creates shortcuts to gain quick access to objects stored in subfolders or in shared folders on other computers.</span></span> <span data-ttu-id="403e0-121">Ad esempio, un utente può creare un collegamento a un documento di Microsoft Word che si trova in una sottocartella e posizionare l'icona del collegamento sul desktop.</span><span class="sxs-lookup"><span data-stu-id="403e0-121">For example, a user can create a shortcut to a Microsoft Word document that is located in a subfolder and place the shortcut icon on the desktop.</span></span> <span data-ttu-id="403e0-122">L'utente può quindi aprire il documento facendo doppio clic sull'icona del collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-122">The user can then open the document by double-clicking the shortcut icon.</span></span> <span data-ttu-id="403e0-123">Se il documento viene spostato o rinominato dopo la creazione del collegamento, il sistema tenterà di aggiornare il collegamento alla successiva selezione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="403e0-123">If the document is moved or renamed after the shortcut is created, the system will attempt to update the shortcut the next time the user selects it.</span></span>

<span data-ttu-id="403e0-124">Le applicazioni possono inoltre creare e utilizzare collegamenti a Shell e collegamenti.</span><span class="sxs-lookup"><span data-stu-id="403e0-124">Applications can also create and use Shell links and shortcuts.</span></span> <span data-ttu-id="403e0-125">Ad esempio, un'applicazione di elaborazione di testo può creare un collegamento alla Shell per implementare un elenco dei documenti usati più di recente.</span><span class="sxs-lookup"><span data-stu-id="403e0-125">For example, a word processing application might create a Shell link to implement a list of the most recently used documents.</span></span> <span data-ttu-id="403e0-126">Un'applicazione crea un collegamento della shell usando l'interfaccia [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) per creare un oggetto collegamento della shell.</span><span class="sxs-lookup"><span data-stu-id="403e0-126">An application creates a Shell link by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to create a Shell link object.</span></span> <span data-ttu-id="403e0-127">L'applicazione usa l'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) o [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) per archiviare l'oggetto in un file o un flusso.</span><span class="sxs-lookup"><span data-stu-id="403e0-127">The application uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface to store the object in a file or stream.</span></span>

> [!Note]  
> <span data-ttu-id="403e0-128">Non è possibile usare [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) per creare un collegamento a un URL.</span><span class="sxs-lookup"><span data-stu-id="403e0-128">You cannot use [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) to create a link to a URL.</span></span>

 

<span data-ttu-id="403e0-129">In questa panoramica viene descritta l'interfaccia [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) e viene illustrato come utilizzarla per creare e risolvere i collegamenti a Shell dall'interno di un'applicazione basata su Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="403e0-129">This overview describes the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface and explains how to use it to create and resolve Shell links from within a Microsoft Win32-based application.</span></span> <span data-ttu-id="403e0-130">Poiché la progettazione dei collegamenti della shell si basa su OLE Component Object Model (COM), è necessario acquisire familiarità con i concetti di base della programmazione COM e OLE prima di leggere questa panoramica.</span><span class="sxs-lookup"><span data-stu-id="403e0-130">Because the design of Shell links is based on the OLE Component Object Model (COM), you should be familiar with the basic concepts of COM and OLE programming before reading this overview.</span></span>

### <a name="link-resolution"></a><span data-ttu-id="403e0-131">Risoluzione dei collegamenti</span><span class="sxs-lookup"><span data-stu-id="403e0-131">Link Resolution</span></span>

<span data-ttu-id="403e0-132">Se un utente crea un collegamento a un oggetto e il nome o il percorso dell'oggetto viene modificato in un secondo momento, il sistema esegue automaticamente i passaggi per aggiornare o risolvere il collegamento alla successiva selezione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="403e0-132">If a user creates a shortcut to an object and the name or location of the object is later changed, the system automatically takes steps to update, or resolve, the shortcut the next time the user selects it.</span></span> <span data-ttu-id="403e0-133">Tuttavia, se un'applicazione crea un collegamento della shell e lo archivia in un flusso, il sistema non tenta automaticamente di risolvere il collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-133">However, if an application creates a Shell link and stores it in a stream, the system does not automatically attempt to resolve the link.</span></span> <span data-ttu-id="403e0-134">L'applicazione deve risolvere il collegamento chiamando il metodo [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) .</span><span class="sxs-lookup"><span data-stu-id="403e0-134">The application must resolve the link by calling the [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) method.</span></span>

<span data-ttu-id="403e0-135">Quando viene creato un collegamento alla shell, il sistema salva le informazioni sul collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-135">When a Shell link is created, the system saves information about the link.</span></span> <span data-ttu-id="403e0-136">Quando si risolve un collegamento, in modo automatico o con una chiamata [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) , il sistema recupera innanzitutto il percorso associato al collegamento della shell utilizzando un puntatore all'elenco di identificatori del collegamento della shell.</span><span class="sxs-lookup"><span data-stu-id="403e0-136">When resolving a link—either automatically or with an [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) call—the system first retrieves the path associated with the Shell link by using a pointer to the Shell link's identifier list.</span></span> <span data-ttu-id="403e0-137">Per ulteriori informazioni sull'elenco degli identificatori, vedere [identificatori di elemento ed elenchi di identificatori](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="403e0-137">For more information about the identifier list, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span> <span data-ttu-id="403e0-138">Il sistema cerca l'oggetto associato in tale percorso e, se trova l'oggetto, risolve il collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-138">The system searches for the associated object in that path and, if it finds the object, resolves the link.</span></span> <span data-ttu-id="403e0-139">Se il sistema non riesce a trovare l'oggetto, chiama sul servizio di [rilevamento dei collegamenti distribuiti e degli identificatori di oggetto](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT), se disponibile, per individuare l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-139">If the system cannot find the object, it calls on the [Distributed Link Tracking and Object Identifiers](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT) service, if available, to locate the object.</span></span> <span data-ttu-id="403e0-140">Se il servizio DLT non è disponibile o non è in grado di trovare l'oggetto, il sistema cerca nella stessa directory un oggetto con lo stesso tempo di creazione del file e gli stessi attributi ma con un nome diverso.</span><span class="sxs-lookup"><span data-stu-id="403e0-140">If the DLT service is not available or cannot find the object, the system looks in the same directory for an object with the same file creation time and attributes but with a different name.</span></span> <span data-ttu-id="403e0-141">Questo tipo di ricerca risolve un collegamento a un oggetto che è stato rinominato.</span><span class="sxs-lookup"><span data-stu-id="403e0-141">This type of search resolves a link to an object that has been renamed.</span></span>

<span data-ttu-id="403e0-142">Se il sistema non è ancora in grado di trovare l'oggetto, Cerca le directory, il desktop e i volumi locali, cercando in modo ricorsivo l'albero di directory per un oggetto con lo stesso nome o ora di creazione.</span><span class="sxs-lookup"><span data-stu-id="403e0-142">If the system still cannot find the object, it searches the directories, the desktop, and local volumes, looking recursively though the directory tree for an object with either the same name or creation time.</span></span> <span data-ttu-id="403e0-143">Se il sistema non trova ancora una corrispondenza, viene visualizzata una finestra di dialogo in cui viene richiesto all'utente la presenza di una posizione.</span><span class="sxs-lookup"><span data-stu-id="403e0-143">If the system still does not find a match, it displays a dialog box prompting the user for a location.</span></span> <span data-ttu-id="403e0-144">Un'applicazione può eliminare la finestra di dialogo specificando il valore **SLR \_ Nessuna \_ interfaccia utente** in una chiamata a [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span><span class="sxs-lookup"><span data-stu-id="403e0-144">An application can suppress the dialog box by specifying the **SLR\_NO\_UI** value in a call to [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span></span>

### <a name="initialization-of-the-component-object-library"></a><span data-ttu-id="403e0-145">Inizializzazione della libreria di oggetti componente</span><span class="sxs-lookup"><span data-stu-id="403e0-145">Initialization of the Component Object Library</span></span>

<span data-ttu-id="403e0-146">Prima che un'applicazione possa creare e risolvere i collegamenti, è necessario inizializzare la libreria di oggetti componente chiamando la funzione [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) .</span><span class="sxs-lookup"><span data-stu-id="403e0-146">Before an application can create and resolve shortcuts, it must initialize the component object library by calling the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function.</span></span> <span data-ttu-id="403e0-147">Ogni chiamata a **CoInitialize** richiede una chiamata corrispondente alla funzione [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) , che deve essere chiamata da un'applicazione al momento della terminazione.</span><span class="sxs-lookup"><span data-stu-id="403e0-147">Each call to **CoInitialize** requires a corresponding call to the [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) function, which an application should call when it terminates.</span></span> <span data-ttu-id="403e0-148">La chiamata a **CoUninitialize** garantisce che l'applicazione non venga terminata fino a quando non riceve tutti i messaggi in sospeso.</span><span class="sxs-lookup"><span data-stu-id="403e0-148">The call to **CoUninitialize** ensures that the application does not terminate until it has received all of its pending messages.</span></span>

### <a name="location-independent-names"></a><span data-ttu-id="403e0-149">Nomi Location-Independent</span><span class="sxs-lookup"><span data-stu-id="403e0-149">Location-Independent Names</span></span>

<span data-ttu-id="403e0-150">Il sistema fornisce nomi indipendenti dalla posizione per i collegamenti della shell a oggetti archiviati in cartelle condivise.</span><span class="sxs-lookup"><span data-stu-id="403e0-150">The system provides location-independent names for Shell links to objects stored in shared folders.</span></span> <span data-ttu-id="403e0-151">Se l'oggetto viene archiviato localmente, il sistema fornisce il percorso locale e il nome file per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-151">If the object is stored locally, the system provides the local path and file name for the object.</span></span> <span data-ttu-id="403e0-152">Se l'oggetto viene archiviato in modalità remota, il sistema fornisce un nome di risorsa di rete Universal Naming Convention (UNC) per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-152">If the object is stored remotely, the system provides a Universal Naming Convention (UNC) network resource name for the object.</span></span> <span data-ttu-id="403e0-153">Poiché il sistema fornisce nomi indipendenti dalla località, un collegamento della shell può fungere da nome universale per un file che può essere trasferito ad altri computer.</span><span class="sxs-lookup"><span data-stu-id="403e0-153">Because the system provides location-independent names, a Shell link can serve as a universal name for a file that can be transferred to other computers.</span></span>

### <a name="link-files"></a><span data-ttu-id="403e0-154">File di collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-154">Link Files</span></span>

<span data-ttu-id="403e0-155">Quando l'utente crea un collegamento a un oggetto scegliendo il comando **Crea collegamento** dal menu di scelta rapida dell'oggetto, Windows archivia le informazioni necessarie per accedere all'oggetto in un file di collegamento, ovvero un file binario con estensione lnk.</span><span class="sxs-lookup"><span data-stu-id="403e0-155">When the user creates a shortcut to an object by choosing the **Create Shortcut** command from the object's shortcut menu, Windows stores the information it needs to access the object in a link file—a binary file that has the .lnk file name extension.</span></span> <span data-ttu-id="403e0-156">Un file di collegamento contiene le informazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="403e0-156">A link file contains the following information:</span></span>

-   <span data-ttu-id="403e0-157">Posizione (percorso) dell'oggetto a cui fa riferimento il collegamento, denominato oggetto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="403e0-157">The location (path) of the object referenced by the shortcut (called the corresponding object).</span></span>
-   <span data-ttu-id="403e0-158">Directory di lavoro dell'oggetto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="403e0-158">The working directory of the corresponding object.</span></span>
-   <span data-ttu-id="403e0-159">Elenco di argomenti passati dal sistema all'oggetto corrispondente quando il metodo [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) viene attivato per il collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-159">The list of arguments that the system passes to the corresponding object when the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method is activated for the shortcut.</span></span>
-   <span data-ttu-id="403e0-160">Il comando show utilizzato per impostare lo stato di visualizzazione iniziale dell'oggetto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="403e0-160">The show command used to set the initial show state of the corresponding object.</span></span> <span data-ttu-id="403e0-161">Questo è uno dei valori SW \_ descritti in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span><span class="sxs-lookup"><span data-stu-id="403e0-161">This is one of the SW\_ values described in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span></span>
-   <span data-ttu-id="403e0-162">Posizione (percorso e indice) dell'icona del tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="403e0-162">The location (path and index) of the shortcut's icon.</span></span>
-   <span data-ttu-id="403e0-163">Stringa di descrizione del collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-163">The shortcut's description string.</span></span>
-   <span data-ttu-id="403e0-164">Tasto di scelta rapida per il collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-164">The keyboard shortcut for the shortcut.</span></span>

<span data-ttu-id="403e0-165">Quando viene eliminato un file di collegamento, l'oggetto corrispondente non è interessato.</span><span class="sxs-lookup"><span data-stu-id="403e0-165">When a link file is deleted, the corresponding object is not affected.</span></span>

<span data-ttu-id="403e0-166">Se si crea un collegamento a un altro collegamento, il sistema copia semplicemente il file di collegamento anziché creare un nuovo file di collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-166">If you create a shortcut to another shortcut, the system simply copies the link file rather than creating a new link file.</span></span> <span data-ttu-id="403e0-167">In questo caso, i tasti di scelta rapida non saranno indipendenti l'uno dall'altro.</span><span class="sxs-lookup"><span data-stu-id="403e0-167">In this case, the shortcuts will not be independent of each other.</span></span>

<span data-ttu-id="403e0-168">Un'applicazione può registrare un'estensione di file come tipo di file di collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-168">An application can register a file name extension as a shortcut file type.</span></span> <span data-ttu-id="403e0-169">Se un file ha un'estensione di file che è stata registrata come tipo di file di collegamento, il sistema aggiunge automaticamente l'icona della sovrapposizione dei collegamenti definita dal sistema, ovvero una piccola freccia, all'icona del file.</span><span class="sxs-lookup"><span data-stu-id="403e0-169">If a file has a file name extension that has been registered as a shortcut file type, the system automatically adds the system-defined link overlay icon (a small arrow) to the file's icon.</span></span> <span data-ttu-id="403e0-170">Per registrare un'estensione di file in un tipo di file di collegamento, è necessario aggiungere il valore di nome utente alla descrizione del registro di sistema dell'estensione del nome di file, come illustrato nell'esempio riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="403e0-170">To register a file name extension as a shortcut file type, you must add the IsShortcut value to the registry description of the file name extension, as shown in the example below.</span></span> <span data-ttu-id="403e0-171">Si noti che la shell deve essere riavviata per rendere effettiva l'icona della sovrimpressione.</span><span class="sxs-lookup"><span data-stu-id="403e0-171">Note that the Shell must be restarted for the overlay icon to take effect.</span></span> <span data-ttu-id="403e0-172">Il valore di di collegamento non ha alcun valore di dati.</span><span class="sxs-lookup"><span data-stu-id="403e0-172">IsShortcut has no data value.</span></span>

```
HKEY_CLASSES_ROOT
   .xyz
      (Default) = XYZApp
   XYZApp
      IsShortcut
```

### <a name="shortcut-names"></a><span data-ttu-id="403e0-173">Nomi dei collegamenti</span><span class="sxs-lookup"><span data-stu-id="403e0-173">Shortcut names</span></span>

<span data-ttu-id="403e0-174">Il nome del collegamento, che è una stringa visualizzata sotto l'icona del collegamento della shell, è in realtà il nome del file del collegamento stesso.</span><span class="sxs-lookup"><span data-stu-id="403e0-174">The shortcut's name, which is a string that appears below the Shell link icon, is actually the file name of the shortcut itself.</span></span> <span data-ttu-id="403e0-175">L'utente può modificare la stringa di descrizione selezionandola e immettendo una nuova stringa.</span><span class="sxs-lookup"><span data-stu-id="403e0-175">The user can edit the description string by selecting it and entering a new string.</span></span>

### <a name="location-of-shortcuts-in-the-namespace"></a><span data-ttu-id="403e0-176">Posizione dei collegamenti nello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="403e0-176">Location of shortcuts in the namespace</span></span>

<span data-ttu-id="403e0-177">Sul desktop o in qualsiasi punto dello spazio dei nomi della shell può esistere un collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-177">A shortcut can exist on the desktop or anywhere in the Shell's namespace.</span></span> <span data-ttu-id="403e0-178">Analogamente, l'oggetto associato al collegamento può esistere anche in qualsiasi punto dello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="403e0-178">Similarly, the object that is associated with the shortcut can also exist anywhere in the Shell's namespace.</span></span> <span data-ttu-id="403e0-179">Un'applicazione può usare il metodo [**IShellLink:: SEPATH**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) per impostare il percorso e il nome file per l'oggetto associato e il metodo [**IShellLink:: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) per recuperare il percorso e il nome file correnti per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-179">An application can use the [**IShellLink::SetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) method to set the path and file name for the associated object, and the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) method to retrieve the current path and file name for the object.</span></span>

### <a name="shortcut-working-directory"></a><span data-ttu-id="403e0-180">Directory di lavoro collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-180">Shortcut working directory</span></span>

<span data-ttu-id="403e0-181">La directory di lavoro è la directory in cui l'oggetto corrispondente di un collegamento carica o archivia i file quando l'utente non identifica una directory specifica.</span><span class="sxs-lookup"><span data-stu-id="403e0-181">The working directory is the directory where the corresponding object of a shortcut loads or stores files when the user does not identify a specific directory.</span></span> <span data-ttu-id="403e0-182">Un file di collegamento contiene il nome della directory di lavoro per l'oggetto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="403e0-182">A link file contains the name of the working directory for the corresponding object.</span></span> <span data-ttu-id="403e0-183">Un'applicazione può impostare il nome della directory di lavoro per l'oggetto corrispondente usando il metodo [**IShellLink:: SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) e può recuperare il nome della directory di lavoro corrente per l'oggetto corrispondente usando il metodo [**IShellLink:: GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) .</span><span class="sxs-lookup"><span data-stu-id="403e0-183">An application can set the name of the working directory for the corresponding object by using the [**IShellLink::SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) method and can retrieve the name of the current working directory for the corresponding object by using the [**IShellLink::GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) method.</span></span>

### <a name="shortcut-command-line-arguments"></a><span data-ttu-id="403e0-184">Argomenti della riga di comando di collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-184">Shortcut command-line arguments</span></span>

<span data-ttu-id="403e0-185">Un file di collegamento contiene argomenti della riga di comando che la shell passa all'oggetto corrispondente quando l'utente seleziona il collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-185">A link file contains command-line arguments that the Shell passes to the corresponding object when the user selects the link.</span></span> <span data-ttu-id="403e0-186">Un'applicazione può impostare gli argomenti della riga di comando per un collegamento usando il metodo [**IShellLink:: Searguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) .</span><span class="sxs-lookup"><span data-stu-id="403e0-186">An application can set the command-line arguments for a shortcut by using the [**IShellLink::SetArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) method.</span></span> <span data-ttu-id="403e0-187">È utile impostare gli argomenti della riga di comando quando l'applicazione corrispondente, ad esempio un linker o un compilatore, accetta flag speciali come argomenti.</span><span class="sxs-lookup"><span data-stu-id="403e0-187">It is useful to set command-line arguments when the corresponding application, such as a linker or compiler, takes special flags as arguments.</span></span> <span data-ttu-id="403e0-188">Un'applicazione può recuperare gli argomenti della riga di comando da un collegamento usando il metodo [**IShellLink:: GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) .</span><span class="sxs-lookup"><span data-stu-id="403e0-188">An application can retrieve the command-line arguments from a shortcut by using the [**IShellLink::GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) method.</span></span>

### <a name="shortcut-show-commands"></a><span data-ttu-id="403e0-189">Comandi di visualizzazione collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-189">Shortcut show commands</span></span>

<span data-ttu-id="403e0-190">Quando l'utente fa doppio clic su un collegamento, il sistema avvia l'applicazione associata all'oggetto corrispondente e imposta lo stato di visualizzazione iniziale dell'applicazione in base al comando Mostra specificato dal collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-190">When the user double-clicks a shortcut, the system starts the application associated with the corresponding object and sets the initial show state of the application based on the show command specified by the shortcut.</span></span> <span data-ttu-id="403e0-191">Il comando show può essere uno qualsiasi dei \_ valori SW inclusi nella descrizione della funzione [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) .</span><span class="sxs-lookup"><span data-stu-id="403e0-191">The show command can be any of the SW\_ values included in the description of the [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) function.</span></span> <span data-ttu-id="403e0-192">Un'applicazione può impostare il comando show per un tasto di scelta rapida usando il metodo [**IShellLink:: SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) e può recuperare il comando show corrente usando il metodo [**IShellLink:: GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) .</span><span class="sxs-lookup"><span data-stu-id="403e0-192">An application can set the show command for a shortcut by using the [**IShellLink::SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) method and can retrieve the current show command by using the [**IShellLink::GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) method.</span></span>

### <a name="shortcut-icons"></a><span data-ttu-id="403e0-193">Icone di collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-193">Shortcut icons</span></span>

<span data-ttu-id="403e0-194">Analogamente ad altri oggetti della shell, un collegamento presenta un'icona.</span><span class="sxs-lookup"><span data-stu-id="403e0-194">Like other Shell objects, a shortcut has an icon.</span></span> <span data-ttu-id="403e0-195">L'utente accede all'oggetto associato a un tasto di scelta rapida facendo doppio clic sull'icona del collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-195">The user accesses the object associated with a shortcut by double-clicking the shortcut's icon.</span></span> <span data-ttu-id="403e0-196">Quando il sistema crea un'icona per un collegamento, usa la bitmap dell'oggetto corrispondente e aggiunge l'icona della sovrapposizione dei collegamenti definita dal sistema (una piccola freccia) nell'angolo in basso a sinistra.</span><span class="sxs-lookup"><span data-stu-id="403e0-196">When the system creates an icon for a shortcut, it uses the bitmap of the corresponding object and adds the system-defined link overlay icon (a small arrow) to the lower left corner.</span></span> <span data-ttu-id="403e0-197">Un'applicazione può impostare la posizione (percorso e indice) dell'icona di un tasto di scelta rapida usando il metodo [**IShellLink:: SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="403e0-197">An application can set the location (path and index) of a shortcut's icon by using the [**IShellLink::SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) method.</span></span> <span data-ttu-id="403e0-198">Un'applicazione può recuperare questo percorso usando il metodo [**IShellLink:: GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="403e0-198">An application can retrieve this location by using the [**IShellLink::GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) method.</span></span>

### <a name="shortcut-descriptions"></a><span data-ttu-id="403e0-199">Descrizioni dei collegamenti</span><span class="sxs-lookup"><span data-stu-id="403e0-199">Shortcut descriptions</span></span>

<span data-ttu-id="403e0-200">I collegamenti includono descrizioni, ma l'utente non le Visualizza.</span><span class="sxs-lookup"><span data-stu-id="403e0-200">Shortcuts have descriptions, but the user never sees them.</span></span> <span data-ttu-id="403e0-201">Un'applicazione può usare una descrizione per archiviare le informazioni di testo.</span><span class="sxs-lookup"><span data-stu-id="403e0-201">An application can use a description to store any text information.</span></span> <span data-ttu-id="403e0-202">Le descrizioni vengono impostate usando il metodo [**IShellLink:: sedescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) e recuperate usando il metodo [**IShellLink:: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) .</span><span class="sxs-lookup"><span data-stu-id="403e0-202">Descriptions are set using the [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) method and retrieved using the [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) method.</span></span>

### <a name="shortcut-keyboard-shortcuts"></a><span data-ttu-id="403e0-203">Tasti di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="403e0-203">Shortcut Keyboard Shortcuts</span></span>

<span data-ttu-id="403e0-204">A un oggetto collegamento può essere associato un tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="403e0-204">A shortcut object can have a keyboard shortcut associated with it.</span></span> <span data-ttu-id="403e0-205">Le scelte rapide da tastiera consentono a un utente di premere una combinazione di tasti per attivare un collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-205">Keyboard shortcuts allow a user to press a combination of keys to activate a shortcut.</span></span> <span data-ttu-id="403e0-206">Un'applicazione può impostare il tasto di scelta rapida per un tasto di scelta rapida usando il metodo [**IShellLink:: sehotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) ed è in grado di recuperare il tasto di scelta rapida corrente usando il metodo [**IShellLink:: GetHotKey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) .</span><span class="sxs-lookup"><span data-stu-id="403e0-206">An application can set the keyboard shortcut for a shortcut by using the [**IShellLink::SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) method and can retrieve the current keyboard shortcut by using the [**IShellLink::GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) method.</span></span>

### <a name="item-identifiers-and-identifier-lists"></a><span data-ttu-id="403e0-207">Identificatori di elementi ed elenchi di identificatori</span><span class="sxs-lookup"><span data-stu-id="403e0-207">Item Identifiers and Identifier Lists</span></span>

<span data-ttu-id="403e0-208">La shell usa gli identificatori di oggetto nello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="403e0-208">The Shell uses object identifiers within the Shell's namespace.</span></span> <span data-ttu-id="403e0-209">Tutti gli oggetti visibili nella shell (file, directory, server, gruppi di lavoro e così via) hanno identificatori univoci tra gli oggetti all'interno della cartella padre.</span><span class="sxs-lookup"><span data-stu-id="403e0-209">All objects visible in the Shell (files, directories, servers, workgroups, and so on) have unique identifiers among the objects within their parent folder.</span></span> <span data-ttu-id="403e0-210">Questi identificatori sono denominati identificatori di elemento e hanno il tipo di dati [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) come definito nel file di intestazione shtypes. h.</span><span class="sxs-lookup"><span data-stu-id="403e0-210">These identifiers are called item identifiers, and they have the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) data type as defined in the Shtypes.h header file.</span></span> <span data-ttu-id="403e0-211">Un identificatore di elemento è un flusso di byte a lunghezza variabile che contiene informazioni che identificano un oggetto all'interno di una cartella.</span><span class="sxs-lookup"><span data-stu-id="403e0-211">An item identifier is a variable-length byte stream that contains information that identifies an object within a folder.</span></span> <span data-ttu-id="403e0-212">Solo l'autore di un identificatore di elemento conosce il contenuto e il formato dell'identificatore.</span><span class="sxs-lookup"><span data-stu-id="403e0-212">Only the creator of an item identifier knows the content and format of the identifier.</span></span> <span data-ttu-id="403e0-213">L'unica parte di un identificatore di elemento usato dalla shell è costituita dai primi due byte, che specificano la dimensione dell'identificatore.</span><span class="sxs-lookup"><span data-stu-id="403e0-213">The only part of an item identifier that the Shell uses is the first two bytes, which specify the size of the identifier.</span></span>

<span data-ttu-id="403e0-214">Ogni cartella padre ha un identificatore di elemento che lo identifica all'interno della propria cartella padre.</span><span class="sxs-lookup"><span data-stu-id="403e0-214">Each parent folder has its own item identifier that identifies it within its own parent folder.</span></span> <span data-ttu-id="403e0-215">Pertanto, qualsiasi oggetto Shell può essere identificato in modo univoco da un elenco di identificatori di elemento.</span><span class="sxs-lookup"><span data-stu-id="403e0-215">Thus, any Shell object can be uniquely identified by a list of item identifiers.</span></span> <span data-ttu-id="403e0-216">Una cartella padre mantiene un elenco di identificatori per gli elementi in esso contenuti.</span><span class="sxs-lookup"><span data-stu-id="403e0-216">A parent folder keeps a list of identifiers for the items it contains.</span></span> <span data-ttu-id="403e0-217">L'elenco include il tipo di dati [**ItemId**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="403e0-217">The list has the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) data type.</span></span> <span data-ttu-id="403e0-218">Gli elenchi di identificatori di elemento vengono allocati dalla shell e possono essere passati tra le interfacce della shell, ad esempio [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="403e0-218">Item identifier lists are allocated by the Shell and may be passed across Shell interfaces, such as [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span> <span data-ttu-id="403e0-219">È importante ricordare che ogni identificatore in un elenco di identificatori di elemento è significativo solo all'interno del contesto della relativa cartella padre.</span><span class="sxs-lookup"><span data-stu-id="403e0-219">It is important to remember that each identifier in an item identifier list is only meaningful within the context of its parent folder.</span></span>

<span data-ttu-id="403e0-220">Un'applicazione può impostare un elenco di identificatori di elemento di un collegamento usando il metodo [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) .</span><span class="sxs-lookup"><span data-stu-id="403e0-220">An application can set a shortcut's item identifier list by using the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method.</span></span> <span data-ttu-id="403e0-221">Questo metodo è utile quando si imposta un collegamento a un oggetto che non è un file, ad esempio una stampante o un'unità disco.</span><span class="sxs-lookup"><span data-stu-id="403e0-221">This method is useful when setting a shortcut to an object that is not a file, such as a printer or disk drive.</span></span> <span data-ttu-id="403e0-222">Un'applicazione può recuperare un elenco di identificatori di elemento di un collegamento usando il metodo [**IShellLink:: GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) .</span><span class="sxs-lookup"><span data-stu-id="403e0-222">An application can retrieve a shortcut's item identifier list by using the [**IShellLink::GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) method.</span></span>

## <a name="using-shell-links"></a><span data-ttu-id="403e0-223">Uso di collegamenti della shell</span><span class="sxs-lookup"><span data-stu-id="403e0-223">Using Shell Links</span></span>

<span data-ttu-id="403e0-224">In questa sezione sono contenuti esempi che illustrano come creare e risolvere i collegamenti da un'applicazione basata su Win32.</span><span class="sxs-lookup"><span data-stu-id="403e0-224">This section contains examples that demonstrate how to create and resolve shortcuts from within a Win32-based application.</span></span> <span data-ttu-id="403e0-225">In questa sezione si presuppone che l'utente abbia familiarità con la programmazione Win32, C++ e OLE COM.</span><span class="sxs-lookup"><span data-stu-id="403e0-225">This section assumes you are familiar with Win32, C++, and OLE COM programming.</span></span>

### <a name="creating-a-shortcut-and-a-folder-shortcut-to-a-file"></a><span data-ttu-id="403e0-226">Creazione di un collegamento e di un collegamento a una cartella in un file</span><span class="sxs-lookup"><span data-stu-id="403e0-226">Creating a Shortcut and a Folder Shortcut to a File</span></span>

<span data-ttu-id="403e0-227">La funzione di esempio CreateLink nell'esempio seguente crea un collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-227">The CreateLink sample function in the following example creates a shortcut.</span></span> <span data-ttu-id="403e0-228">I parametri includono un puntatore al nome del file a cui collegarsi, un puntatore al nome del collegamento che si sta creando e un puntatore alla descrizione del collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-228">The parameters include a pointer to the name of the file to link to, a pointer to the name of the shortcut that you are creating, and a pointer to the description of the link.</span></span> <span data-ttu-id="403e0-229">La descrizione è costituita dalla stringa "collegamento al **nome file**", dove **nome file** è il nome del file a cui collegarsi.</span><span class="sxs-lookup"><span data-stu-id="403e0-229">The description consists of the string, "Shortcut to **file name**," where **file name** is the name of the file to link to.</span></span>

<span data-ttu-id="403e0-230">Per creare un collegamento alla cartella utilizzando la funzione di esempio CreateLink, chiamare [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) utilizzando CLSID \_ FOLDERSHORTCUT, anziché CLSID \_ ShellLink (CLSID \_ FolderShortcut supporta IShellLink).</span><span class="sxs-lookup"><span data-stu-id="403e0-230">To create a folder shortcut using the CreateLink sample function, call [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) using CLSID\_FolderShortcut, instead of CLSID\_ShellLink (CLSID\_FolderShortcut supports IShellLink).</span></span> <span data-ttu-id="403e0-231">Tutto il resto del codice rimane invariato.</span><span class="sxs-lookup"><span data-stu-id="403e0-231">All other code remains the same.</span></span>

<span data-ttu-id="403e0-232">Poiché CreateLink chiama la funzione [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) , si presuppone che la funzione [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) sia già stata chiamata.</span><span class="sxs-lookup"><span data-stu-id="403e0-232">Because CreateLink calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function, it is assumed that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="403e0-233">CreateLink usa l'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) per salvare il collegamento e l'interfaccia [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) per archiviare il nome e la descrizione del file.</span><span class="sxs-lookup"><span data-stu-id="403e0-233">CreateLink uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to save the shortcut and the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to store the file name and description.</span></span>


```C++
// CreateLink - Uses the Shell's IShellLink and IPersistFile interfaces 
//              to create and store a shortcut to the specified object. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// lpszPathObj  - Address of a buffer that contains the path of the object,
//                including the file name.
// lpszPathLink - Address of a buffer that contains the path where the 
//                Shell link is to be stored, including the file name.
// lpszDesc     - Address of a buffer that contains a description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "winnls.h"
#include "shobjidl.h"
#include "objbase.h"
#include "objidl.h"
#include "shlguid.h"

HRESULT CreateLink(LPCWSTR lpszPathObj, LPCSTR lpszPathLink, LPCWSTR lpszDesc) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
 
    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called.
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Set the path to the shortcut target and add the description. 
        psl->SetPath(lpszPathObj); 
        psl->SetDescription(lpszDesc); 
 
        // Query IShellLink for the IPersistFile interface, used for saving the 
        // shortcut in persistent storage. 
        hres = psl->QueryInterface(IID_IPersistFile, (LPVOID*)&ppf); 
 
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszPathLink, -1, wsz, MAX_PATH); 
            
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Save the link by calling IPersistFile::Save. 
            hres = ppf->Save(wsz, TRUE); 
            ppf->Release(); 
        } 
        psl->Release(); 
    } 
    return hres; 
```



### <a name="resolving-a-shortcut"></a><span data-ttu-id="403e0-234">Risoluzione di un collegamento</span><span class="sxs-lookup"><span data-stu-id="403e0-234">Resolving a Shortcut</span></span>

<span data-ttu-id="403e0-235">È possibile che un'applicazione debba accedere e modificare un collegamento creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="403e0-235">An application may need to access and manipulate a shortcut that was previously created.</span></span> <span data-ttu-id="403e0-236">Questa operazione viene definita risoluzione del collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-236">This operation is referred to as resolving the shortcut.</span></span>

<span data-ttu-id="403e0-237">La funzione ResolveIt definita dall'applicazione nell'esempio seguente risolve un collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-237">The application-defined ResolveIt function in the following example resolves a shortcut.</span></span> <span data-ttu-id="403e0-238">I parametri includono un handle di finestra, un puntatore al percorso del collegamento e l'indirizzo di un buffer che riceve il nuovo percorso dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-238">Its parameters include a window handle, a pointer to the path of the shortcut, and the address of a buffer that receives the new path to the object.</span></span> <span data-ttu-id="403e0-239">L'handle della finestra identifica la finestra padre per le finestre di messaggio che possono essere visualizzate dalla Shell.</span><span class="sxs-lookup"><span data-stu-id="403e0-239">The window handle identifies the parent window for any message boxes that the Shell may need to display.</span></span> <span data-ttu-id="403e0-240">La shell, ad esempio, può visualizzare una finestra di messaggio se il collegamento si trova su un supporto non condiviso, se si verificano problemi di rete, se l'utente deve inserire un disco floppy e così via.</span><span class="sxs-lookup"><span data-stu-id="403e0-240">For example, the Shell can display a message box if the link is on unshared media, if network problems occur, if the user needs to insert a floppy disk, and so on.</span></span>

<span data-ttu-id="403e0-241">La funzione ResolveIt chiama la funzione [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) e presuppone che la funzione [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) sia già stata chiamata.</span><span class="sxs-lookup"><span data-stu-id="403e0-241">The ResolveIt function calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and assumes that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="403e0-242">Si noti che ResolveIt deve usare l'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) per archiviare le informazioni sul collegamento.</span><span class="sxs-lookup"><span data-stu-id="403e0-242">Note that ResolveIt needs to use the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to store the link information.</span></span> <span data-ttu-id="403e0-243">**IPersistFile** viene implementato dall'oggetto [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="403e0-243">**IPersistFile** is implemented by the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) object.</span></span> <span data-ttu-id="403e0-244">È necessario caricare le informazioni sul collegamento prima di recuperare le informazioni sul percorso, come illustrato più avanti nell'esempio.</span><span class="sxs-lookup"><span data-stu-id="403e0-244">The link information must be loaded before the path information is retrieved, which is shown later in the example.</span></span> <span data-ttu-id="403e0-245">Se non si caricano le informazioni sul collegamento, le chiamate alle funzioni membro [**IShellLink:: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) e [**IShellLink:: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) hanno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="403e0-245">Failing to load the link information causes the calls to the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) and [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) member functions to fail.</span></span>


```C++
// ResolveIt - Uses the Shell's IShellLink and IPersistFile interfaces 
//             to retrieve the path and description from an existing shortcut. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// hwnd         - A handle to the parent window. The Shell uses this window to 
//                display a dialog box if it needs to prompt the user for more 
//                information while resolving the link.
// lpszLinkFile - Address of a buffer that contains the path of the link,
//                including the file name.
// lpszPath     - Address of a buffer that receives the path of the link
                  target, including the file name.
// lpszDesc     - Address of a buffer that receives the description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "shobjidl.h"
#include "shlguid.h"
#include "strsafe.h"
                            
HRESULT ResolveIt(HWND hwnd, LPCSTR lpszLinkFile, LPWSTR lpszPath, int iPathBufferSize) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
    WCHAR szGotPath[MAX_PATH]; 
    WCHAR szDescription[MAX_PATH]; 
    WIN32_FIND_DATA wfd; 
 
    *lpszPath = 0; // Assume failure 

    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called. 
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Get a pointer to the IPersistFile interface. 
        hres = psl->QueryInterface(IID_IPersistFile, (void**)&ppf); 
        
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszLinkFile, -1, wsz, MAX_PATH); 
 
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Load the shortcut. 
            hres = ppf->Load(wsz, STGM_READ); 
            
            if (SUCCEEDED(hres)) 
            { 
                // Resolve the link. 
                hres = psl->Resolve(hwnd, 0); 

                if (SUCCEEDED(hres)) 
                { 
                    // Get the path to the link target. 
                    hres = psl->GetPath(szGotPath, MAX_PATH, (WIN32_FIND_DATA*)&wfd, SLGP_SHORTPATH); 

                    if (SUCCEEDED(hres)) 
                    { 
                        // Get the description of the target. 
                        hres = psl->GetDescription(szDescription, MAX_PATH); 

                        if (SUCCEEDED(hres)) 
                        {
                            hres = StringCbCopy(lpszPath, iPathBufferSize, szGotPath);
                            if (SUCCEEDED(hres))
                            {
                                // Handle success
                            }
                            else
                            {
                                // Handle the error
                            }
                        }
                    }
                } 
            } 

            // Release the pointer to the IPersistFile interface. 
            ppf->Release(); 
        } 

        // Release the pointer to the IShellLink interface. 
        psl->Release(); 
    } 
    return hres; 
}
```



### <a name="creating-a-shortcut-to-a-nonfile-object"></a><span data-ttu-id="403e0-246">Creazione di un collegamento a un oggetto non file</span><span class="sxs-lookup"><span data-stu-id="403e0-246">Creating a Shortcut to a Nonfile Object</span></span>

<span data-ttu-id="403e0-247">La creazione di un collegamento a un oggetto non file, ad esempio una stampante, è simile alla creazione di un collegamento a un file con la differenza che anziché impostare il percorso del file, è necessario impostare l'elenco di identificatori sulla stampante.</span><span class="sxs-lookup"><span data-stu-id="403e0-247">Creating a shortcut to a nonfile object, such as a printer, is similar to creating a shortcut to a file except that rather than setting the path to the file, you must set the identifier list to the printer.</span></span> <span data-ttu-id="403e0-248">Per impostare l'elenco di identificatori, chiamare il metodo [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) , specificando l'indirizzo di un elenco di identificatori.</span><span class="sxs-lookup"><span data-stu-id="403e0-248">To set the identifier list, call the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method, specifying the address of an identifier list.</span></span>

<span data-ttu-id="403e0-249">Ogni oggetto nello spazio dei nomi della shell ha un identificatore di elemento.</span><span class="sxs-lookup"><span data-stu-id="403e0-249">Each object within the Shell's namespace has an item identifier.</span></span> <span data-ttu-id="403e0-250">La shell spesso concatena gli identificatori di elemento in elenchi con terminazione null costituiti da un numero qualsiasi di identificatori di elemento.</span><span class="sxs-lookup"><span data-stu-id="403e0-250">The Shell often concatenates item identifiers into null-terminated lists consisting of any number of item identifiers.</span></span> <span data-ttu-id="403e0-251">Per ulteriori informazioni sugli identificatori di elemento, vedere [identificatori di elemento ed elenchi di identificatori](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="403e0-251">For more information about item identifiers, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span>

<span data-ttu-id="403e0-252">In generale, se è necessario impostare un collegamento a un elemento che non ha un nome file, ad esempio una stampante, sarà già presente un puntatore all'interfaccia [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-252">In general, if you need to set a shortcut to an item that does not have a file name, such as a printer, you will already have a pointer to the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="403e0-253">**IShellFolder** viene utilizzato per creare estensioni dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="403e0-253">**IShellFolder** is used to create namespace extensions.</span></span>

<span data-ttu-id="403e0-254">Una volta ottenuto l'identificatore di classe per [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), è possibile chiamare la funzione [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) per recuperare l'indirizzo dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="403e0-254">Once you have the class identifier for [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), you can call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to retrieve the address of the interface.</span></span> <span data-ttu-id="403e0-255">È quindi possibile chiamare l'interfaccia per enumerare gli oggetti nella cartella e recuperare l'indirizzo dell'identificatore di elemento per l'oggetto che si sta cercando.</span><span class="sxs-lookup"><span data-stu-id="403e0-255">Then you can call the interface to enumerate the objects in the folder and retrieve the address of the item identifier for the object that you are searching for.</span></span> <span data-ttu-id="403e0-256">Infine, è possibile usare l'indirizzo in una chiamata alla funzione membro [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) per creare un collegamento all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="403e0-256">Finally, you can use the address in a call to the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) member function to create a shortcut to the object.</span></span>

 

 
