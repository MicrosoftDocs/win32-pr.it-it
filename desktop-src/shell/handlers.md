---
description: Le funzionalità della shell possono essere estese con le voci del registro di sistema e i file ini.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Creazione di gestori di estensione della shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994701"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="32c0f-103">Creazione di gestori di estensione della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="32c0f-104">Le funzionalità della shell possono essere estese con le voci del registro di sistema e i file ini.</span><span class="sxs-lookup"><span data-stu-id="32c0f-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="32c0f-105">Sebbene questo approccio per estendere la shell sia semplice e appropriato per molti scopi, è limitato.</span><span class="sxs-lookup"><span data-stu-id="32c0f-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="32c0f-106">Se ad esempio si usa il registro di sistema per specificare un'icona personalizzata per un tipo di file, verrà visualizzata la stessa icona per ogni file di quel tipo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="32c0f-107">L'estensione della shell con il registro di sistema non consente di variare l'icona per file diversi dello stesso tipo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="32c0f-108">Altri aspetti della shell, ad esempio la finestra delle proprietà **delle proprietà che** può essere visualizzata quando si fa clic con il pulsante destro del mouse su un file, non possono essere modificati nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="32c0f-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="32c0f-109">Un approccio più potente e flessibile per estendere la Shell consiste nell'implementare i *gestori di estensioni della shell*.</span><span class="sxs-lookup"><span data-stu-id="32c0f-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="32c0f-110">Questi gestori possono essere implementati per un'ampia gamma di azioni che possono essere eseguite dalla Shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="32c0f-111">Prima di eseguire l'azione, la shell esegue una query sul gestore dell'estensione, offrendo la possibilità di modificare l'azione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="32c0f-112">Un esempio comune è un gestore di estensione del menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="32c0f-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="32c0f-113">Se ne viene implementato uno per un tipo di file, verrà eseguita una query ogni volta che viene fatto clic con il pulsante destro del mouse su uno dei file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="32c0f-114">Il gestore può quindi specificare voci di menu aggiuntive in base al file, anziché avere lo stesso set per l'intero tipo di file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="32c0f-115">In questo documento viene illustrato come implementare i gestori di estensione che consentono di modificare un'ampia gamma di azioni della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="32c0f-116">I gestori seguenti sono associati a un tipo di file specifico e consentono di specificare in base al file:</span><span class="sxs-lookup"><span data-stu-id="32c0f-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="32c0f-117">Gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-117">Handler</span></span>                                               | <span data-ttu-id="32c0f-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="32c0f-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="32c0f-119">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="32c0f-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="32c0f-120">Chiamato prima che venga visualizzato il menu di scelta rapida di un file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="32c0f-121">Consente di aggiungere elementi al menu di scelta rapida in base al file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="32c0f-122">Gestore dati</span><span class="sxs-lookup"><span data-stu-id="32c0f-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="32c0f-123">Chiamato quando viene eseguita un'operazione di trascinamento e rilascio sugli oggetti dragShell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="32c0f-124">Consente di fornire altri formati degli Appunti all'obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="32c0f-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="32c0f-125">Gestore di trascinamento</span><span class="sxs-lookup"><span data-stu-id="32c0f-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="32c0f-126">Chiamato quando un oggetto dati viene trascinato o rilasciato in un file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="32c0f-127">Consente di creare un file in un obiettivo di rilascio.</span><span class="sxs-lookup"><span data-stu-id="32c0f-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="32c0f-128">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="32c0f-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="32c0f-129">Chiamato prima che venga visualizzata l'icona di un file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="32c0f-130">Consente di sostituire l'icona predefinita del file con un'icona personalizzata in base al file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="32c0f-131">Gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="32c0f-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="32c0f-132">Chiamato prima della visualizzazione della finestra delle proprietà **delle proprietà di** un oggetto.</span><span class="sxs-lookup"><span data-stu-id="32c0f-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="32c0f-133">Consente di aggiungere o sostituire pagine.</span><span class="sxs-lookup"><span data-stu-id="32c0f-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="32c0f-134">**Gestore immagini di anteprima**</span><span class="sxs-lookup"><span data-stu-id="32c0f-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="32c0f-135">Fornisce un'immagine per rappresentare l'elemento.</span><span class="sxs-lookup"><span data-stu-id="32c0f-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="32c0f-136">**Gestore della finestra popup**</span><span class="sxs-lookup"><span data-stu-id="32c0f-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="32c0f-137">Fornisce il testo popup quando l'utente posiziona il puntatore del mouse sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="32c0f-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="32c0f-138">**Gestore di metadati**</span><span class="sxs-lookup"><span data-stu-id="32c0f-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="32c0f-139">Fornisce l'accesso in lettura e scrittura ai metadati (proprietà) archiviati in un file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="32c0f-140">Questa operazione può essere utilizzata per estendere la visualizzazione dettagli, infotip, la pagina delle proprietà e le funzionalità di raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="32c0f-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="32c0f-141">Altri gestori non sono associati a un tipo di file specifico, ma vengono chiamati prima di alcune operazioni della shell:</span><span class="sxs-lookup"><span data-stu-id="32c0f-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="32c0f-142">Gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-142">Handler</span></span>                                                            | <span data-ttu-id="32c0f-143">Descrizione</span><span class="sxs-lookup"><span data-stu-id="32c0f-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="32c0f-144">Gestore delle colonne</span><span class="sxs-lookup"><span data-stu-id="32c0f-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="32c0f-145">Chiamato da Esplora risorse prima di visualizzare la visualizzazione dettagli di una cartella.</span><span class="sxs-lookup"><span data-stu-id="32c0f-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="32c0f-146">Consente di aggiungere colonne personalizzate alla visualizzazione dettagli.</span><span class="sxs-lookup"><span data-stu-id="32c0f-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="32c0f-147">Gestore hook di copia</span><span class="sxs-lookup"><span data-stu-id="32c0f-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="32c0f-148">Chiamato quando un oggetto Folder o Printer sta per essere spostato, copiato, eliminato o rinominato.</span><span class="sxs-lookup"><span data-stu-id="32c0f-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="32c0f-149">Consente di approvare o porre il veto sull'operazione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="32c0f-150">Gestore di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="32c0f-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="32c0f-151">Chiamato quando un file viene trascinato con il pulsante destro del mouse.</span><span class="sxs-lookup"><span data-stu-id="32c0f-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="32c0f-152">Consente di modificare il menu di scelta rapida visualizzato.</span><span class="sxs-lookup"><span data-stu-id="32c0f-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="32c0f-153">Gestore sovrimpressione icone</span><span class="sxs-lookup"><span data-stu-id="32c0f-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="32c0f-154">Chiamato prima che venga visualizzata l'icona di un file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="32c0f-155">Consente di specificare una sovrapposizione per l'icona del file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="32c0f-156">Gestore ricerche</span><span class="sxs-lookup"><span data-stu-id="32c0f-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="32c0f-157">Chiamato per avviare un motore di ricerca.</span><span class="sxs-lookup"><span data-stu-id="32c0f-157">Called to launch a search engine.</span></span> <span data-ttu-id="32c0f-158">Consente di implementare un motore di ricerca personalizzato accessibile dal menu **Start** o da Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="32c0f-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="32c0f-159">I dettagli relativi all'implementazione di gestori di estensioni specifici sono descritti nelle sezioni elencate in precedenza.</span><span class="sxs-lookup"><span data-stu-id="32c0f-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="32c0f-160">Nella parte restante di questo documento vengono illustrati alcuni problemi di implementazione comuni a tutti i gestori di estensioni della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="32c0f-161">Implementazione di gestori di estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="32c0f-162">Implementazione di IPersistFile</span><span class="sxs-lookup"><span data-stu-id="32c0f-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="32c0f-163">Implementazione di IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="32c0f-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="32c0f-164">Personalizzazione di infotip</span><span class="sxs-lookup"><span data-stu-id="32c0f-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="32c0f-165">Miglioramento della ricerca di Windows con gestori di estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="32c0f-166">Registrazione di gestori estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="32c0f-167">Nomi dei gestori</span><span class="sxs-lookup"><span data-stu-id="32c0f-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="32c0f-168">Oggetti shell predefiniti</span><span class="sxs-lookup"><span data-stu-id="32c0f-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="32c0f-169">Esempio di registrazione di un gestore estensioni</span><span class="sxs-lookup"><span data-stu-id="32c0f-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="32c0f-170">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="32c0f-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="32c0f-171">Implementazione di gestori di estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="32c0f-172">Gran parte dell'implementazione di un oggetto gestore dell'estensione della shell dipende dal tipo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="32c0f-173">Esistono, tuttavia, alcuni elementi comuni.</span><span class="sxs-lookup"><span data-stu-id="32c0f-173">There are, however, some common elements.</span></span> <span data-ttu-id="32c0f-174">Questa sezione illustra gli aspetti dell'implementazione condivisi da tutti i gestori di estensioni della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="32c0f-175">Molti gestori di estensioni della shell sono oggetti Component Object Model (COM) in-process.</span><span class="sxs-lookup"><span data-stu-id="32c0f-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="32c0f-176">È necessario assegnare un GUID e registrarlo come descritto in Registering Shell Extension Handler.</span><span class="sxs-lookup"><span data-stu-id="32c0f-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="32c0f-177">Vengono implementate come dll ed è necessario esportare le funzioni standard seguenti:</span><span class="sxs-lookup"><span data-stu-id="32c0f-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="32c0f-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="32c0f-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="32c0f-179">Il punto di ingresso standard della DLL.</span><span class="sxs-lookup"><span data-stu-id="32c0f-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="32c0f-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="32c0f-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="32c0f-181">Espone la class factory dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="32c0f-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="32c0f-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="32c0f-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="32c0f-183">COM chiama questa funzione per determinare se l'oggetto serve qualsiasi client.</span><span class="sxs-lookup"><span data-stu-id="32c0f-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="32c0f-184">In caso contrario, il sistema può scaricare la DLL e liberare la memoria associata.</span><span class="sxs-lookup"><span data-stu-id="32c0f-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="32c0f-185">Come tutti gli oggetti COM, i gestori di estensioni della shell devono implementare un'interfaccia [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) e un [class factory](../com/implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="32c0f-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="32c0f-186">La maggior parte dei gestori di estensione deve implementare anche un'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) o [**ISHELLEXTINIT**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) in Windows XP o versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="32c0f-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="32c0f-187">Questi sono stati sostituiti da [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) e [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="32c0f-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="32c0f-188">La shell usa queste interfacce per inizializzare il gestore.</span><span class="sxs-lookup"><span data-stu-id="32c0f-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="32c0f-189">L'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) deve essere implementata dai seguenti elementi:</span><span class="sxs-lookup"><span data-stu-id="32c0f-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="32c0f-190">Gestori di dati</span><span class="sxs-lookup"><span data-stu-id="32c0f-190">Data handlers</span></span>
-   <span data-ttu-id="32c0f-191">Gestori di rilascio</span><span class="sxs-lookup"><span data-stu-id="32c0f-191">Drop handlers</span></span>

<span data-ttu-id="32c0f-192">In passato, i gestori delle icone erano necessari anche per implementare [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), ma questo non è più vero.</span><span class="sxs-lookup"><span data-stu-id="32c0f-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="32c0f-193">Per i gestori di icone, **IPersistFile** è ora facoltativo e sono preferibili altre interfacce, ad esempio [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="32c0f-194">L'interfaccia [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) deve essere implementata dai seguenti elementi:</span><span class="sxs-lookup"><span data-stu-id="32c0f-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="32c0f-195">Gestori dei menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="32c0f-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="32c0f-196">Gestori di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="32c0f-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="32c0f-197">Gestori della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="32c0f-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="32c0f-198">Implementazione di IPersistFile</span><span class="sxs-lookup"><span data-stu-id="32c0f-198">Implementing IPersistFile</span></span>

<span data-ttu-id="32c0f-199">L'interfaccia [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) è destinata a consentire il caricamento o il salvataggio di un oggetto in un file su disco.</span><span class="sxs-lookup"><span data-stu-id="32c0f-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="32c0f-200">Sono disponibili sei metodi, oltre a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), cinque dei propri e il metodo [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) che eredita da [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span><span class="sxs-lookup"><span data-stu-id="32c0f-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="32c0f-201">Con le estensioni della shell, **IPersist** viene usato solo per inizializzare un oggetto gestore dell'estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="32c0f-202">Poiché in genere non è necessario leggere o scrivere sul disco, solo i metodi **GetClassID** e [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) richiedono un'implementazione non token.</span><span class="sxs-lookup"><span data-stu-id="32c0f-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="32c0f-203">La shell chiama prima [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) e la funzione restituisce l'identificatore di classe (CLSID) dell'oggetto gestore di estensione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="32c0f-204">La shell chiama quindi [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) e passa due valori.</span><span class="sxs-lookup"><span data-stu-id="32c0f-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="32c0f-205">Il primo, *pszFileName*, è una stringa Unicode con il nome del file o della cartella su cui la Shell sta per operare.</span><span class="sxs-lookup"><span data-stu-id="32c0f-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="32c0f-206">Il secondo è *dwMode*, che indica la modalità di accesso ai file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="32c0f-207">Poiché in genere non è necessario accedere ai file, *dwMode* è in genere pari a zero.</span><span class="sxs-lookup"><span data-stu-id="32c0f-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="32c0f-208">Il metodo archivia questi valori in base alle esigenze per un riferimento successivo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="32c0f-209">Nel frammento di codice seguente viene illustrato il modo in cui un tipico gestore dell'estensione della shell implementa i metodi [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) e [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="32c0f-210">È progettato per gestire ANSI o Unicode.</span><span class="sxs-lookup"><span data-stu-id="32c0f-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="32c0f-211">CLSID \_ SampleExtHandler è il GUID dell'oggetto gestore dell'estensione e CSampleExtHandler è il nome della classe utilizzata per implementare l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="32c0f-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="32c0f-212">Le variabili **m \_ szFileName** e **m \_ dwMode** sono variabili private utilizzate per archiviare i flag di accesso e il nome del file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="32c0f-213">Implementazione di IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="32c0f-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="32c0f-214">L'interfaccia [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) ha un solo metodo, [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), oltre a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="32c0f-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="32c0f-215">Il metodo dispone di tre parametri che la shell può usare per passare vari tipi di informazioni.</span><span class="sxs-lookup"><span data-stu-id="32c0f-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="32c0f-216">I valori passati dipendono dal tipo di gestore e altri possono essere impostati su **null**.</span><span class="sxs-lookup"><span data-stu-id="32c0f-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="32c0f-217">*pIDFolder* include il puntatore di una cartella a un elenco di identificatori di elemento (PIDL).</span><span class="sxs-lookup"><span data-stu-id="32c0f-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="32c0f-218">Per le estensioni della finestra delle proprietà, è **null**.</span><span class="sxs-lookup"><span data-stu-id="32c0f-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="32c0f-219">Per le estensioni del menu di scelta rapida, è il PIDL della cartella che contiene l'elemento di cui viene visualizzato il menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="32c0f-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="32c0f-220">Per i gestori di trascinamento della selezione non predefiniti, è il PIDL della cartella di destinazione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="32c0f-221">*pDataObject* include un puntatore all'interfaccia [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) di un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="32c0f-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="32c0f-222">L'oggetto dati include uno o più nomi di file nel formato [CF \_ HDROP](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="32c0f-223">*hRegKey* include una chiave del registro di sistema per l'oggetto file o il tipo di cartella.</span><span class="sxs-lookup"><span data-stu-id="32c0f-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="32c0f-224">Il metodo [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) archivia il nome file, il puntatore [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) e la chiave del registro di sistema in base alle esigenze per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="32c0f-225">Nel frammento di codice seguente viene illustrata un'implementazione di **IShellExtInit:: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="32c0f-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="32c0f-226">Per semplicità, in questo esempio si presuppone che l'oggetto dati contenga un solo file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="32c0f-227">In generale, potrebbe contenere più file che dovranno essere estratti.</span><span class="sxs-lookup"><span data-stu-id="32c0f-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="32c0f-228">CSampleExtHandler è il nome della classe utilizzata per implementare l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="32c0f-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="32c0f-229">Le **variabili \_ m pIDFolder**, **m \_ pDataObject**, **m \_ szFileName** e **m \_ hRegKey** sono variabili private usate per archiviare le informazioni passate.</span><span class="sxs-lookup"><span data-stu-id="32c0f-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="32c0f-230">Per semplicità, in questo esempio si presuppone che l'oggetto dati conterrà un solo nome file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="32c0f-231">Una volta recuperata la struttura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) dall'oggetto dati, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) viene utilizzato per estrarre il nome file dal membro **Media. hGlobal** della struttura **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="32c0f-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="32c0f-232">Se viene passata una chiave del registro di sistema, il metodo usa [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) per aprire la chiave e assegna l'handle a **m \_ hRegKey**.</span><span class="sxs-lookup"><span data-stu-id="32c0f-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="32c0f-233">Personalizzazione di infotip</span><span class="sxs-lookup"><span data-stu-id="32c0f-233">Infotip Customization</span></span>

<span data-ttu-id="32c0f-234">Esistono due modi per personalizzare infotip:</span><span class="sxs-lookup"><span data-stu-id="32c0f-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="32c0f-235">Implementare un oggetto che supporta [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) e quindi registrare l'oggetto sotto la sottochiave corretta nel registro di sistema. vedere la sezione relativa alla [registrazione dei gestori estensioni della shell](#registering-shell-extension-handlers) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="32c0f-236">Specificare una stringa fissa o un elenco di proprietà di file specifiche da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="32c0f-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="32c0f-237">Per visualizzare una stringa fissa per un'estensione dello spazio dei nomi, creare una voce denominata `InfoTip` nella chiave *{CLSID}* dell'estensione dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="32c0f-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="32c0f-238">Impostare il valore di tale voce su una stringa letterale che si vuole visualizzare, come illustrato in questo esempio, o una stringa indiretta che specifica una risorsa e un indice all'interno di tale risorsa (per finalità di localizzazione).</span><span class="sxs-lookup"><span data-stu-id="32c0f-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="32c0f-239">Per visualizzare una stringa fissa per un tipo di file, creare una voce denominata `InfoTip` nella chiave *ProgID* del tipo di file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="32c0f-240">Impostare il valore di tale voce su una stringa letterale che si desidera visualizzare o su una stringa indiretta che specifichi una risorsa e un indice all'interno di tale risorsa (per finalità di localizzazione), come illustrato in questo esempio.</span><span class="sxs-lookup"><span data-stu-id="32c0f-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="32c0f-241">Se si vuole che la shell visualizzi proprietà specifiche del file in infotip per un tipo di file specifico, creare una voce denominata `InfoTip` nella chiave *ProgID* per quel tipo di file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="32c0f-242">Impostare il valore di tale voce come elenco delimitato da punti e virgola di nomi di proprietà canoniche, coppie di identificatori di formato (FMTID)/Property Identifier (PID) o entrambi.</span><span class="sxs-lookup"><span data-stu-id="32c0f-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="32c0f-243">Questo valore deve iniziare con "prop:" per identificarlo come stringa di elenco delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="32c0f-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="32c0f-244">Se si omette "prop:", il valore viene considerato come stringa letterale e visualizzato come tale.</span><span class="sxs-lookup"><span data-stu-id="32c0f-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="32c0f-245">Nell'esempio seguente, *propName* è un nome di proprietà canonico (ad esempio System. date) e *{fmtid}, PID* è una coppia [**fmtid/PID**](./objects.md) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="32c0f-246">È possibile utilizzare i nomi di proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="32c0f-246">The following property names can be used:</span></span>



| <span data-ttu-id="32c0f-247">Nome proprietà</span><span class="sxs-lookup"><span data-stu-id="32c0f-247">Property Name</span></span>    | <span data-ttu-id="32c0f-248">Descrizione</span><span class="sxs-lookup"><span data-stu-id="32c0f-248">Description</span></span>                   | <span data-ttu-id="32c0f-249">Recuperato da</span><span class="sxs-lookup"><span data-stu-id="32c0f-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="32c0f-250">Autore</span><span class="sxs-lookup"><span data-stu-id="32c0f-250">Author</span></span>           | <span data-ttu-id="32c0f-251">Autore del documento</span><span class="sxs-lookup"><span data-stu-id="32c0f-251">Author of the document</span></span>        | [<span data-ttu-id="32c0f-252">**autore di PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="32c0f-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="32c0f-253">Titolo</span><span class="sxs-lookup"><span data-stu-id="32c0f-253">Title</span></span>            | <span data-ttu-id="32c0f-254">Titolo del documento</span><span class="sxs-lookup"><span data-stu-id="32c0f-254">Title of the document</span></span>         | [<span data-ttu-id="32c0f-255">**\_titolo PIDSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="32c0f-256">Oggetto</span><span class="sxs-lookup"><span data-stu-id="32c0f-256">Subject</span></span>          | <span data-ttu-id="32c0f-257">Riepilogo oggetto</span><span class="sxs-lookup"><span data-stu-id="32c0f-257">Subject summary</span></span>               | [<span data-ttu-id="32c0f-258">**\_oggetto PIDSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="32c0f-259">Commento</span><span class="sxs-lookup"><span data-stu-id="32c0f-259">Comment</span></span>          | <span data-ttu-id="32c0f-260">Commenti del documento</span><span class="sxs-lookup"><span data-stu-id="32c0f-260">Document comments</span></span>             | <span data-ttu-id="32c0f-261">[**PIDSI \_ Proprietà commento**](../stg/the-summary-information-property-set.md) o cartella/driver</span><span class="sxs-lookup"><span data-stu-id="32c0f-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="32c0f-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="32c0f-262">PageCount</span></span>        | <span data-ttu-id="32c0f-263">Numero di pagine</span><span class="sxs-lookup"><span data-stu-id="32c0f-263">Number of pages</span></span>               | [<span data-ttu-id="32c0f-264">**\_PageCount PIDSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="32c0f-265">Nome</span><span class="sxs-lookup"><span data-stu-id="32c0f-265">Name</span></span>             | <span data-ttu-id="32c0f-266">Nome descrittivo</span><span class="sxs-lookup"><span data-stu-id="32c0f-266">Friendly name</span></span>                 | <span data-ttu-id="32c0f-267">Visualizzazione cartelle standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="32c0f-268">OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="32c0f-268">OriginalLocation</span></span> | <span data-ttu-id="32c0f-269">Percorso del file originale</span><span class="sxs-lookup"><span data-stu-id="32c0f-269">Location of original file</span></span>     | <span data-ttu-id="32c0f-270">Cartella valigetta e cartella Cestino</span><span class="sxs-lookup"><span data-stu-id="32c0f-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="32c0f-271">DateDeleted</span><span class="sxs-lookup"><span data-stu-id="32c0f-271">DateDeleted</span></span>      | <span data-ttu-id="32c0f-272">Il file di data è stato eliminato</span><span class="sxs-lookup"><span data-stu-id="32c0f-272">Date file was deleted</span></span>         | <span data-ttu-id="32c0f-273">Cartella Cestino</span><span class="sxs-lookup"><span data-stu-id="32c0f-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="32c0f-274">Tipo</span><span class="sxs-lookup"><span data-stu-id="32c0f-274">Type</span></span>             | <span data-ttu-id="32c0f-275">Tipo di file</span><span class="sxs-lookup"><span data-stu-id="32c0f-275">Type of file</span></span>                  | <span data-ttu-id="32c0f-276">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-277">Dimensione</span><span class="sxs-lookup"><span data-stu-id="32c0f-277">Size</span></span>             | <span data-ttu-id="32c0f-278">Dimensioni del file</span><span class="sxs-lookup"><span data-stu-id="32c0f-278">Size of file</span></span>                  | <span data-ttu-id="32c0f-279">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-280">SyncCopyIn</span><span class="sxs-lookup"><span data-stu-id="32c0f-280">SyncCopyIn</span></span>       | <span data-ttu-id="32c0f-281">Uguale a OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="32c0f-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="32c0f-282">Uguale a OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="32c0f-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="32c0f-283">Ultima modifica</span><span class="sxs-lookup"><span data-stu-id="32c0f-283">Modified</span></span>         | <span data-ttu-id="32c0f-284">Data ultima modifica</span><span class="sxs-lookup"><span data-stu-id="32c0f-284">Date last modified</span></span>            | <span data-ttu-id="32c0f-285">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-286">Data di creazione</span><span class="sxs-lookup"><span data-stu-id="32c0f-286">Created</span></span>          | <span data-ttu-id="32c0f-287">Data creazione</span><span class="sxs-lookup"><span data-stu-id="32c0f-287">Date created</span></span>                  | <span data-ttu-id="32c0f-288">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-289">Accedere</span><span class="sxs-lookup"><span data-stu-id="32c0f-289">Accessed</span></span>         | <span data-ttu-id="32c0f-290">Data ultimo accesso</span><span class="sxs-lookup"><span data-stu-id="32c0f-290">Date last accessed</span></span>            | <span data-ttu-id="32c0f-291">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-292">InCartella</span><span class="sxs-lookup"><span data-stu-id="32c0f-292">InFolder</span></span>         | <span data-ttu-id="32c0f-293">Directory che contiene il file</span><span class="sxs-lookup"><span data-stu-id="32c0f-293">Directory containing the file</span></span> | <span data-ttu-id="32c0f-294">Risultati della ricerca nei documenti</span><span class="sxs-lookup"><span data-stu-id="32c0f-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="32c0f-295">Classifica</span><span class="sxs-lookup"><span data-stu-id="32c0f-295">Rank</span></span>             | <span data-ttu-id="32c0f-296">Qualità della corrispondenza di ricerca</span><span class="sxs-lookup"><span data-stu-id="32c0f-296">Quality of search match</span></span>       | <span data-ttu-id="32c0f-297">Risultati della ricerca nei documenti</span><span class="sxs-lookup"><span data-stu-id="32c0f-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="32c0f-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="32c0f-298">FreeSpace</span></span>        | <span data-ttu-id="32c0f-299">Spazio di archiviazione disponibile</span><span class="sxs-lookup"><span data-stu-id="32c0f-299">Available storage space</span></span>       | <span data-ttu-id="32c0f-300">Unità disco</span><span class="sxs-lookup"><span data-stu-id="32c0f-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="32c0f-301">NumberOfVisits</span><span class="sxs-lookup"><span data-stu-id="32c0f-301">NumberOfVisits</span></span>   | <span data-ttu-id="32c0f-302">Numero di visite</span><span class="sxs-lookup"><span data-stu-id="32c0f-302">Number of visits</span></span>              | <span data-ttu-id="32c0f-303">Cartella Preferiti</span><span class="sxs-lookup"><span data-stu-id="32c0f-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="32c0f-304">Attributi</span><span class="sxs-lookup"><span data-stu-id="32c0f-304">Attributes</span></span>       | <span data-ttu-id="32c0f-305">Attributi file</span><span class="sxs-lookup"><span data-stu-id="32c0f-305">File Attributes</span></span>               | <span data-ttu-id="32c0f-306">Visualizzazione Dettagli cartella standard</span><span class="sxs-lookup"><span data-stu-id="32c0f-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="32c0f-307">Company</span><span class="sxs-lookup"><span data-stu-id="32c0f-307">Company</span></span>          | <span data-ttu-id="32c0f-308">Nome azienda</span><span class="sxs-lookup"><span data-stu-id="32c0f-308">Company name</span></span>                  | [<span data-ttu-id="32c0f-309">**\_società PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="32c0f-310">Category</span><span class="sxs-lookup"><span data-stu-id="32c0f-310">Category</span></span>         | <span data-ttu-id="32c0f-311">Categoria documento</span><span class="sxs-lookup"><span data-stu-id="32c0f-311">Document category</span></span>             | [<span data-ttu-id="32c0f-312">**\_categoria PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="32c0f-313">Copyright</span><span class="sxs-lookup"><span data-stu-id="32c0f-313">Copyright</span></span>        | <span data-ttu-id="32c0f-314">Copyright del supporto</span><span class="sxs-lookup"><span data-stu-id="32c0f-314">Media copyright</span></span>               | [<span data-ttu-id="32c0f-315">**\_Copyright PIDMSI**</span><span class="sxs-lookup"><span data-stu-id="32c0f-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="32c0f-316">HTMLInfoTipFile</span><span class="sxs-lookup"><span data-stu-id="32c0f-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="32c0f-317">File InfoTip HTML</span><span class="sxs-lookup"><span data-stu-id="32c0f-317">HTML InfoTip file</span></span>             | <span data-ttu-id="32c0f-318">File Desktop.ini per la cartella</span><span class="sxs-lookup"><span data-stu-id="32c0f-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="32c0f-319">Miglioramento della ricerca di Windows con gestori di estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="32c0f-320">I gestori di estensioni della shell possono essere usati per migliorare l'esperienza utente fornita da un gestore di protocollo di ricerca di Windows.</span><span class="sxs-lookup"><span data-stu-id="32c0f-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="32c0f-321">Per abilitare tali miglioramenti, il gestore dell'estensione della shell di supporto deve essere progettato per l'integrazione con il gestore di protocollo di ricerca come origine dati.</span><span class="sxs-lookup"><span data-stu-id="32c0f-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="32c0f-322">Per informazioni su come migliorare un gestore del protocollo di ricerca di Windows tramite l'integrazione con un gestore dell'estensione della shell, vedere [aggiunta di icone, anteprime e menu di scelta rapida](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="32c0f-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="32c0f-323">Per ulteriori informazioni sui gestori del protocollo di ricerca di Windows, vedere [sviluppo di gestori di protocollo](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="32c0f-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="32c0f-324">Registrazione di gestori estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="32c0f-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="32c0f-325">Un oggetto gestore dell'estensione della shell deve essere registrato prima che la shell possa usarlo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="32c0f-326">Questa sezione è una descrizione generale di come registrare un gestore dell'estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="32c0f-327">Ogni volta che si crea o si modifica un gestore dell'estensione della shell, è importante notificare al sistema che è stata apportata una modifica a [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specificando l'evento **SHCNE \_ ASSOCCHANGED** .</span><span class="sxs-lookup"><span data-stu-id="32c0f-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="32c0f-328">Se non si chiama **SHChangeNotify**, è possibile che la modifica non venga riconosciuta fino al riavvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="32c0f-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="32c0f-329">Come per tutti gli oggetti COM, è necessario creare un GUID per il gestore usando uno strumento come UUIDGEN.exe.</span><span class="sxs-lookup"><span data-stu-id="32c0f-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="32c0f-330">Creare una chiave in **HKEY \_ classi \_ radice** \\ **CLSID** il cui nome è il formato stringa del GUID.</span><span class="sxs-lookup"><span data-stu-id="32c0f-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="32c0f-331">Poiché i gestori di estensioni della shell sono server in-process, è necessario creare una chiave **InprocServer32** sotto la chiave GUID con il valore predefinito impostato sul percorso della dll del gestore.</span><span class="sxs-lookup"><span data-stu-id="32c0f-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="32c0f-332">Utilizzare il modello di threading dell'Apartment.</span><span class="sxs-lookup"><span data-stu-id="32c0f-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="32c0f-333">Ogni volta che la shell esegue un'azione che può coinvolgere un gestore dell'estensione della shell, verifica la chiave del registro di sistema appropriata.</span><span class="sxs-lookup"><span data-stu-id="32c0f-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="32c0f-334">La chiave in cui viene registrato un gestore di estensione controlla quindi quando verrà chiamato.</span><span class="sxs-lookup"><span data-stu-id="32c0f-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="32c0f-335">Ad esempio, è pratica comune avere un gestore di menu di scelta rapida chiamato quando la shell Visualizza un menu di scelta rapida per un membro di un [tipo di file](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="32c0f-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="32c0f-336">In questo caso, il gestore deve essere registrato sotto la chiave **ProgID** del tipo di file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="32c0f-337">Nomi dei gestori</span><span class="sxs-lookup"><span data-stu-id="32c0f-337">Handler Names</span></span>

<span data-ttu-id="32c0f-338">Per abilitare un gestore dell'estensione della shell, creare una sottochiave con il nome della sottochiave del gestore (vedere di seguito) nella sottochiave **ShellEx** del **ProgID** (per i tipi di file) o il nome del tipo di oggetto della shell (per [gli oggetti shell predefiniti](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="32c0f-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="32c0f-339">Ad esempio, se si desidera registrare un gestore dell'estensione del menu di scelta rapida per il programma. 1, iniziare creando la sottochiave seguente:</span><span class="sxs-lookup"><span data-stu-id="32c0f-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="32c0f-340">Per i gestori seguenti, creare una sottochiave sotto la chiave "Handler nome sottochiave", il cui nome è la versione in formato stringa del CLSID dell'estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="32c0f-341">È possibile registrare più estensioni con la chiave del nome della sottochiave del gestore creando più sottochiavi.</span><span class="sxs-lookup"><span data-stu-id="32c0f-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="32c0f-342">Gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-342">Handler</span></span>                                               | <span data-ttu-id="32c0f-343">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="32c0f-343">Interface</span></span>          | <span data-ttu-id="32c0f-344">Nome sottochiave gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="32c0f-345">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="32c0f-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="32c0f-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="32c0f-346">IContextMenu</span></span>       | <span data-ttu-id="32c0f-347">**ContextMenuHandlers**</span><span class="sxs-lookup"><span data-stu-id="32c0f-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="32c0f-348">Gestore CopyHook</span><span class="sxs-lookup"><span data-stu-id="32c0f-348">Copyhook handler</span></span>                                      | <span data-ttu-id="32c0f-349">ICopyHook</span><span class="sxs-lookup"><span data-stu-id="32c0f-349">ICopyHook</span></span>          | <span data-ttu-id="32c0f-350">**CopyHookHandlers**</span><span class="sxs-lookup"><span data-stu-id="32c0f-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="32c0f-351">Gestore di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="32c0f-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="32c0f-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="32c0f-352">IContextMenu</span></span>       | <span data-ttu-id="32c0f-353">**DragDropHandlers**</span><span class="sxs-lookup"><span data-stu-id="32c0f-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="32c0f-354">Gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="32c0f-354">Property sheet handler</span></span>                                | <span data-ttu-id="32c0f-355">IShellPropSheetExt</span><span class="sxs-lookup"><span data-stu-id="32c0f-355">IShellPropSheetExt</span></span> | <span data-ttu-id="32c0f-356">**PropertySheetHandlers**</span><span class="sxs-lookup"><span data-stu-id="32c0f-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="32c0f-357">Gestore del provider di colonne (deprecato in Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="32c0f-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="32c0f-358">IColumnProvider</span><span class="sxs-lookup"><span data-stu-id="32c0f-358">IColumnProvider</span></span>    | <span data-ttu-id="32c0f-359">**ColumnHandlers**</span><span class="sxs-lookup"><span data-stu-id="32c0f-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="32c0f-360">Per i gestori seguenti, il valore predefinito della chiave del nome della sottochiave del gestore è la versione in formato stringa del CLSID dell'estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="32c0f-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="32c0f-361">Per questi gestori è possibile registrare solo un'estensione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="32c0f-362">Gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-362">Handler</span></span>                 | <span data-ttu-id="32c0f-363">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="32c0f-363">Interface</span></span>                                         | <span data-ttu-id="32c0f-364">Nome sottochiave gestore</span><span class="sxs-lookup"><span data-stu-id="32c0f-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="32c0f-365">Gestore dati</span><span class="sxs-lookup"><span data-stu-id="32c0f-365">Data handler</span></span>            | <span data-ttu-id="32c0f-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="32c0f-366">IDataObject</span></span>                                       | <span data-ttu-id="32c0f-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="32c0f-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="32c0f-368">Gestore di trascinamento</span><span class="sxs-lookup"><span data-stu-id="32c0f-368">Drop handler</span></span>            | <span data-ttu-id="32c0f-369">IDropTarget</span><span class="sxs-lookup"><span data-stu-id="32c0f-369">IDropTarget</span></span>                                       | <span data-ttu-id="32c0f-370">**DropHandler**</span><span class="sxs-lookup"><span data-stu-id="32c0f-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="32c0f-371">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="32c0f-371">Icon handler</span></span>            | <span data-ttu-id="32c0f-372">IExtractIconA/W</span><span class="sxs-lookup"><span data-stu-id="32c0f-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="32c0f-373">**IconHandler**</span><span class="sxs-lookup"><span data-stu-id="32c0f-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="32c0f-374">Gestore immagini</span><span class="sxs-lookup"><span data-stu-id="32c0f-374">Image handler</span></span>           | <span data-ttu-id="32c0f-375">IExtractImage</span><span class="sxs-lookup"><span data-stu-id="32c0f-375">IExtractImage</span></span>                                     | <span data-ttu-id="32c0f-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="32c0f-377">Gestore immagini di anteprima</span><span class="sxs-lookup"><span data-stu-id="32c0f-377">Thumbnail image handler</span></span> | <span data-ttu-id="32c0f-378">IThumbnailProvider</span><span class="sxs-lookup"><span data-stu-id="32c0f-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="32c0f-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="32c0f-380">Gestore della finestra popup</span><span class="sxs-lookup"><span data-stu-id="32c0f-380">Infotip handler</span></span>         | <span data-ttu-id="32c0f-381">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="32c0f-381">IQueryInfo</span></span>                                        | <span data-ttu-id="32c0f-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="32c0f-383">Collegamento della shell (ANSI)</span><span class="sxs-lookup"><span data-stu-id="32c0f-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="32c0f-384">IShellLinkA</span><span class="sxs-lookup"><span data-stu-id="32c0f-384">IShellLinkA</span></span>                                       | <span data-ttu-id="32c0f-385">**{000214EE-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="32c0f-386">Collegamento Shell (UNICODE)</span><span class="sxs-lookup"><span data-stu-id="32c0f-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="32c0f-387">IShellLinkW</span><span class="sxs-lookup"><span data-stu-id="32c0f-387">IShellLinkW</span></span>                                       | <span data-ttu-id="32c0f-388">**{000214F9-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="32c0f-389">Archiviazione strutturata</span><span class="sxs-lookup"><span data-stu-id="32c0f-389">Structured storage</span></span>      | <span data-ttu-id="32c0f-390">IStorage</span><span class="sxs-lookup"><span data-stu-id="32c0f-390">IStorage</span></span>                                          | <span data-ttu-id="32c0f-391">**{0000000B-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="32c0f-392">Metadati</span><span class="sxs-lookup"><span data-stu-id="32c0f-392">Metadata</span></span>                | <span data-ttu-id="32c0f-393">IPropertyStore</span><span class="sxs-lookup"><span data-stu-id="32c0f-393">IPropertyStore</span></span>                                    | <span data-ttu-id="32c0f-394">**Gestoreproprietà**</span><span class="sxs-lookup"><span data-stu-id="32c0f-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="32c0f-395">Metadati</span><span class="sxs-lookup"><span data-stu-id="32c0f-395">Metadata</span></span>                | <span data-ttu-id="32c0f-396">IPropertySetStorage (deprecato in Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="32c0f-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="32c0f-397">**Gestoreproprietà**</span><span class="sxs-lookup"><span data-stu-id="32c0f-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="32c0f-398">Aggiungi a menu Start</span><span class="sxs-lookup"><span data-stu-id="32c0f-398">Pin to Start Menu</span></span>       | <span data-ttu-id="32c0f-399">IStartMenuPinnedList</span><span class="sxs-lookup"><span data-stu-id="32c0f-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="32c0f-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="32c0f-401">Aggiungere alla barra delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="32c0f-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="32c0f-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span><span class="sxs-lookup"><span data-stu-id="32c0f-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="32c0f-403">Le sottochiavi specificate per aggiungere **pin al menu Start** e aggiungere **alla barra delle applicazioni** al menu di scelta rapida di un elemento sono necessarie solo per i tipi di file che includono la voce di [collegamento](./links.md) .</span><span class="sxs-lookup"><span data-stu-id="32c0f-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="32c0f-404">Il supporto per i gestori del provider di colonne è stato rimosso in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="32c0f-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="32c0f-405">Inoltre, a partire da Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) è stato deprecato a favore di [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="32c0f-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="32c0f-406">Sebbene [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) rimanga supportato, è preferibile [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) per Windows Vista e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="32c0f-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="32c0f-407">Oggetti shell predefiniti</span><span class="sxs-lookup"><span data-stu-id="32c0f-407">Predefined Shell Objects</span></span>

<span data-ttu-id="32c0f-408">La shell definisce oggetti aggiuntivi sotto **la \_ \_ radice delle classi HKEY** che possono essere estese in modo analogo ai tipi di file.</span><span class="sxs-lookup"><span data-stu-id="32c0f-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="32c0f-409">Per aggiungere un gestore della finestra delle proprietà per tutti i file, ad esempio, è possibile eseguire la registrazione con la chiave **PropertySheetHandlers** .</span><span class="sxs-lookup"><span data-stu-id="32c0f-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="32c0f-410">La tabella seguente fornisce le varie sottochiavi della **\_ \_ radice delle classi HKEY** in cui è possibile registrare i gestori di estensione.</span><span class="sxs-lookup"><span data-stu-id="32c0f-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="32c0f-411">Si noti che molti gestori di estensioni non possono essere registrati in tutte le sottochiavi elencate.</span><span class="sxs-lookup"><span data-stu-id="32c0f-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="32c0f-412">Per ulteriori informazioni, vedere la documentazione del gestore specifico.</span><span class="sxs-lookup"><span data-stu-id="32c0f-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="32c0f-413">Sottochiave</span><span class="sxs-lookup"><span data-stu-id="32c0f-413">Subkey</span></span>                    | <span data-ttu-id="32c0f-414">Descrizione</span><span class="sxs-lookup"><span data-stu-id="32c0f-414">Description</span></span>                                                          | <span data-ttu-id="32c0f-415">Possibili gestori</span><span class="sxs-lookup"><span data-stu-id="32c0f-415">Possible Handlers</span></span>                                | <span data-ttu-id="32c0f-416">Versione</span><span class="sxs-lookup"><span data-stu-id="32c0f-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="32c0f-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="32c0f-417">\**\** _</span></span>                    | <span data-ttu-id="32c0f-418">Tutti i file</span><span class="sxs-lookup"><span data-stu-id="32c0f-418">All files</span></span>                                                            | <span data-ttu-id="32c0f-419">Menu di scelta rapida, finestra delle proprietà, verbi (vedere di seguito)</span><span class="sxs-lookup"><span data-stu-id="32c0f-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="32c0f-420">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-420">All</span></span>     |
| <span data-ttu-id="32c0f-421">_ *AllFileSystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="32c0f-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="32c0f-422">Tutti i file e le cartelle di file</span><span class="sxs-lookup"><span data-stu-id="32c0f-422">All files and file folders</span></span>                                           | <span data-ttu-id="32c0f-423">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-424">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-424">4.71</span></span>    |
| <span data-ttu-id="32c0f-425">**Cartella**</span><span class="sxs-lookup"><span data-stu-id="32c0f-425">**Folder**</span></span>                | <span data-ttu-id="32c0f-426">Tutte le cartelle</span><span class="sxs-lookup"><span data-stu-id="32c0f-426">All folders</span></span>                                                          | <span data-ttu-id="32c0f-427">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-428">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-428">All</span></span>     |
| <span data-ttu-id="32c0f-429">**Directory**</span><span class="sxs-lookup"><span data-stu-id="32c0f-429">**Directory**</span></span>             | <span data-ttu-id="32c0f-430">Cartelle di file</span><span class="sxs-lookup"><span data-stu-id="32c0f-430">File folders</span></span>                                                         | <span data-ttu-id="32c0f-431">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-432">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-432">All</span></span>     |
| <span data-ttu-id="32c0f-433">**\\Sfondo directory**</span><span class="sxs-lookup"><span data-stu-id="32c0f-433">**Directory\\Background**</span></span> | <span data-ttu-id="32c0f-434">Sfondo cartella file</span><span class="sxs-lookup"><span data-stu-id="32c0f-434">File folder background</span></span>                                               | <span data-ttu-id="32c0f-435">Solo menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="32c0f-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="32c0f-436">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-436">4.71</span></span>    |
| <span data-ttu-id="32c0f-437">**Unità**</span><span class="sxs-lookup"><span data-stu-id="32c0f-437">**Drive**</span></span>                 | <span data-ttu-id="32c0f-438">Tutte le unità in computer, ad esempio "C: \\ "</span><span class="sxs-lookup"><span data-stu-id="32c0f-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="32c0f-439">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-440">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-440">All</span></span>     |
| <span data-ttu-id="32c0f-441">**Network**</span><span class="sxs-lookup"><span data-stu-id="32c0f-441">**Network**</span></span>               | <span data-ttu-id="32c0f-442">Intera rete (in risorse di rete)</span><span class="sxs-lookup"><span data-stu-id="32c0f-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="32c0f-443">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-444">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-444">All</span></span>     |
| <span data-ttu-id="32c0f-445">**Tipo di rete \\\\\#**</span><span class="sxs-lookup"><span data-stu-id="32c0f-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="32c0f-446">Tutti gli oggetti di tipo \# (vedere di seguito)</span><span class="sxs-lookup"><span data-stu-id="32c0f-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="32c0f-447">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-448">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-448">4.71</span></span>    |
| <span data-ttu-id="32c0f-449">**NetShare**</span><span class="sxs-lookup"><span data-stu-id="32c0f-449">**NetShare**</span></span>              | <span data-ttu-id="32c0f-450">Tutte le condivisioni di rete</span><span class="sxs-lookup"><span data-stu-id="32c0f-450">All network shares</span></span>                                                   | <span data-ttu-id="32c0f-451">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-452">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-452">4.71</span></span>    |
| <span data-ttu-id="32c0f-453">**NetServer**</span><span class="sxs-lookup"><span data-stu-id="32c0f-453">**NetServer**</span></span>             | <span data-ttu-id="32c0f-454">Tutti i server di rete</span><span class="sxs-lookup"><span data-stu-id="32c0f-454">All network servers</span></span>                                                  | <span data-ttu-id="32c0f-455">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-456">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-456">4.71</span></span>    |
| <span data-ttu-id="32c0f-457">*\_Nome provider di rete \_*</span><span class="sxs-lookup"><span data-stu-id="32c0f-457">*network\_provider\_name*</span></span> | <span data-ttu-id="32c0f-458">Tutti gli oggetti forniti dal provider di rete "*Network \_ provider \_ Name*"</span><span class="sxs-lookup"><span data-stu-id="32c0f-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="32c0f-459">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-460">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-460">All</span></span>     |
| <span data-ttu-id="32c0f-461">**Stampanti**</span><span class="sxs-lookup"><span data-stu-id="32c0f-461">**Printers**</span></span>              | <span data-ttu-id="32c0f-462">Tutte le stampanti</span><span class="sxs-lookup"><span data-stu-id="32c0f-462">All printers</span></span>                                                         | <span data-ttu-id="32c0f-463">Menu di scelta rapida, finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="32c0f-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="32c0f-464">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-464">All</span></span>     |
| <span data-ttu-id="32c0f-465">**AudioCD**</span><span class="sxs-lookup"><span data-stu-id="32c0f-465">**AudioCD**</span></span>               | <span data-ttu-id="32c0f-466">CD audio nell'unità CD</span><span class="sxs-lookup"><span data-stu-id="32c0f-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="32c0f-467">Solo verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-467">Verbs only</span></span>                                       | <span data-ttu-id="32c0f-468">Tutti</span><span class="sxs-lookup"><span data-stu-id="32c0f-468">All</span></span>     |
| <span data-ttu-id="32c0f-469">**DVD**</span><span class="sxs-lookup"><span data-stu-id="32c0f-469">**DVD**</span></span>                   | <span data-ttu-id="32c0f-470">Unità DVD (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="32c0f-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="32c0f-471">Menu di scelta rapida, finestra delle proprietà, verbi</span><span class="sxs-lookup"><span data-stu-id="32c0f-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="32c0f-472">4,71</span><span class="sxs-lookup"><span data-stu-id="32c0f-472">4.71</span></span>    |



 

<span data-ttu-id="32c0f-473">Note:</span><span class="sxs-lookup"><span data-stu-id="32c0f-473">Notes:</span></span>

-   <span data-ttu-id="32c0f-474">Per accedere al menu di scelta rapida dello sfondo della cartella file, fare clic con il pulsante destro del mouse all'interno di una cartella di file, ma non su uno dei contenuti della cartella.</span><span class="sxs-lookup"><span data-stu-id="32c0f-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="32c0f-475">I "verbi" sono comandi speciali registrati nel verbo della shell della sottochiave **\_ \_ radice delle classi HKEY** \\  \\  \\  .</span><span class="sxs-lookup"><span data-stu-id="32c0f-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="32c0f-476">Per il tipo di **rete** \\  \\ **\#** , " \# " è un codice del tipo di provider di rete in decimale.</span><span class="sxs-lookup"><span data-stu-id="32c0f-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="32c0f-477">Il codice del tipo di provider di rete è la parola più elevata di un tipo di rete.</span><span class="sxs-lookup"><span data-stu-id="32c0f-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="32c0f-478">L'elenco dei tipi di rete viene specificato nel file di intestazione Winnetwk. h (WNNC \_ net \_ \* Values).</span><span class="sxs-lookup"><span data-stu-id="32c0f-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="32c0f-479">Ad esempio, WNNC \_ net \_ Shiva è 0x00330000, quindi la chiave del tipo corrispondente sarà **HKEY \_ classi \_ radice** tipo di \\ **rete** \\  \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="32c0f-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="32c0f-480">"*Network \_ provider \_ Name*" è un nome di provider di rete come specificato da [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), con gli spazi convertiti in caratteri di sottolineatura.</span><span class="sxs-lookup"><span data-stu-id="32c0f-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="32c0f-481">Ad esempio, se è installato il provider rete Microsoft Networking, il nome del provider è "rete Microsoft Windows" e il *nome del \_ provider \_ di rete* corrispondente è **\_ \_ rete Microsoft Windows**.</span><span class="sxs-lookup"><span data-stu-id="32c0f-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="32c0f-482">Esempio di registrazione di un gestore estensioni</span><span class="sxs-lookup"><span data-stu-id="32c0f-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="32c0f-483">Per abilitare un particolare gestore, creare una sottochiave nella chiave del tipo di gestore dell'estensione con il nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="32c0f-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="32c0f-484">La shell non usa il nome del gestore, ma deve essere diverso da tutti gli altri nomi sotto tale sottochiave di tipo.</span><span class="sxs-lookup"><span data-stu-id="32c0f-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="32c0f-485">Impostare il valore predefinito della sottochiave Name sul formato stringa del GUID del gestore.</span><span class="sxs-lookup"><span data-stu-id="32c0f-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="32c0f-486">Nell'esempio seguente vengono illustrate le voci del registro di sistema che consentono il menu di scelta rapida e i gestori dell'estensione della finestra delle proprietà, utilizzando un esempio di file MYP:</span><span class="sxs-lookup"><span data-stu-id="32c0f-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="32c0f-487">La procedura di registrazione descritta in questa sezione deve essere seguita per tutti i sistemi Windows.</span><span class="sxs-lookup"><span data-stu-id="32c0f-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="32c0f-488">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="32c0f-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="32c0f-489">Linee guida per l'implementazione di estensioni In-Process</span><span class="sxs-lookup"><span data-stu-id="32c0f-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
