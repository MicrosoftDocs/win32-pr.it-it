---
description: .
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Esecuzione di query sul processo in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d92d868cb843e96b04d6b4bd575284638b6652ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750346"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="1007d-103">Esecuzione di query sul processo in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="1007d-104">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="1007d-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="1007d-105">Informazioni sulle query in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="1007d-106">Query locali e remote</span><span class="sxs-lookup"><span data-stu-id="1007d-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="1007d-107">Panoramica dell'API di query strutturata</span><span class="sxs-lookup"><span data-stu-id="1007d-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="1007d-108">Esecuzione di query sugli scenari</span><span class="sxs-lookup"><span data-stu-id="1007d-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="1007d-109">Estrazione della condizione e analisi delle query</span><span class="sxs-lookup"><span data-stu-id="1007d-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="1007d-110">Esecuzione di query sull'indice</span><span class="sxs-lookup"><span data-stu-id="1007d-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="1007d-111">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1007d-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="1007d-112">Informazioni sulle query in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-112">About Querying in Windows Search</span></span>

<span data-ttu-id="1007d-113">L'esecuzione di query in Windows Search si basa sui quattro approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="1007d-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="1007d-114">[Sintassi di query avanzate](-search-3x-advancedquerysyntax.md) (AQS)</span><span class="sxs-lookup"><span data-stu-id="1007d-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="1007d-115">Sintassi di query naturali (NQS)</span><span class="sxs-lookup"><span data-stu-id="1007d-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="1007d-116">Structured Query Language (SQL)</span><span class="sxs-lookup"><span data-stu-id="1007d-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="1007d-117">Interfacce di query strutturate</span><span class="sxs-lookup"><span data-stu-id="1007d-117">Structured query interfaces</span></span>

<span data-ttu-id="1007d-118">AQS è la sintassi di query predefinita utilizzata da Windows Search per eseguire una query sull'indice e per perfezionare e restringere i parametri di ricerca.</span><span class="sxs-lookup"><span data-stu-id="1007d-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="1007d-119">AQS è destinato principalmente all'utente e può essere usato dagli utenti per compilare query AQS, ma può anche essere usato dagli sviluppatori per compilare query a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="1007d-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="1007d-120">In Windows 7 è stato introdotto il AQS canonico e deve essere usato per generare query AQS a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="1007d-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="1007d-121">In Windows 7 e versioni successive, può essere disponibile un'opzione di menu di scelta rapida a seconda che venga soddisfatta una condizione AQS.</span><span class="sxs-lookup"><span data-stu-id="1007d-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="1007d-122">Per ulteriori informazioni, vedere "recupero del comportamento dinamico per i verbi statici tramite la sintassi di query avanzata" nella sezione [creazione di gestori di menu di scelta rapida](../shell/context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="1007d-123">Le query AQS possono essere limitate a specifici tipi di file, noti come tipi di file.</span><span class="sxs-lookup"><span data-stu-id="1007d-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="1007d-124">Per altre informazioni, vedere [tipi di file e associazioni](../shell/fa-intro.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="1007d-125">Per la documentazione di riferimento sulle proprietà pertinenti, vedere [System. Kind](../properties/props-system-kind.md)e [System. KindText](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="1007d-126">NQS è una sintassi di query più rilassata rispetto a AQS ed è simile al linguaggio umano.</span><span class="sxs-lookup"><span data-stu-id="1007d-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="1007d-127">NQS può essere usato da Windows Search per eseguire una query sull'indice se è selezionato NQS anziché il valore predefinito AQS.</span><span class="sxs-lookup"><span data-stu-id="1007d-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="1007d-128">SQL è un linguaggio testuale che definisce le query.</span><span class="sxs-lookup"><span data-stu-id="1007d-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="1007d-129">SQL è comune in molte tecnologie di database diverse.</span><span class="sxs-lookup"><span data-stu-id="1007d-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="1007d-130">Windows Search USA SQL, ne implementa un subset e lo estende aggiungendo elementi al linguaggio.</span><span class="sxs-lookup"><span data-stu-id="1007d-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="1007d-131">Windows Search SQL estende la sintassi di query di database standard SQL-92 e SQL-99 per migliorarne l'utilità con le ricerche basate su testo.</span><span class="sxs-lookup"><span data-stu-id="1007d-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="1007d-132">Tutte le funzionalità di Windows Search SQL sono compatibili con Windows Search in Windows XP e Windows Server 2003 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="1007d-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="1007d-133">Per ulteriori informazioni su Windows Search SQL, vedere [esecuzione di query sull'indice con la sintassi SQL di ricerca](-search-sql-windowssearch-entry.md)di Windows e [Panoramica della sintassi SQL di Windows Search](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="1007d-134">Le API di query strutturate sono descritte più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="1007d-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="1007d-135">Per la documentazione di riferimento sulle API di query strutturate, vedere [query sulle interfacce](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="1007d-136">Le interfacce come [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) consentono di costruire stringhe SQL da un set di valori di input.</span><span class="sxs-lookup"><span data-stu-id="1007d-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="1007d-137">Questa interfaccia converte le query utente AQS in Windows Search SQL e specifica le restrizioni di query che possono essere espresse in SQL ma non in AQS.</span><span class="sxs-lookup"><span data-stu-id="1007d-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="1007d-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) ottiene anche una stringa di connessione OLE DB per la connessione al database di Windows Search.</span><span class="sxs-lookup"><span data-stu-id="1007d-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="1007d-139">Query locali e remote</span><span class="sxs-lookup"><span data-stu-id="1007d-139">Local and Remote Queries</span></span>

<span data-ttu-id="1007d-140">È possibile eseguire le query in locale o in remoto.</span><span class="sxs-lookup"><span data-stu-id="1007d-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="1007d-141">Nell'esempio seguente viene illustrata una query locale che usa la [clausola from](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="1007d-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="1007d-142">Una query locale esegue una query solo nel catalogo SystemIndex locale.</span><span class="sxs-lookup"><span data-stu-id="1007d-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="1007d-143">Nell'esempio seguente viene illustrata una query remota che usa la [clausola from](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="1007d-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="1007d-144">L'aggiunta di ComputerName trasforma l'esempio precedente in una query remota.</span><span class="sxs-lookup"><span data-stu-id="1007d-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="1007d-145">Per impostazione predefinita, Windows XP e Windows Server 2003 non hanno installato Windows Search.</span><span class="sxs-lookup"><span data-stu-id="1007d-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="1007d-146">Solo Windows Search 4 (WS4) fornisce il supporto per le query remote.</span><span class="sxs-lookup"><span data-stu-id="1007d-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="1007d-147">Le versioni precedenti di Windows Desktop Search (WDS), ad esempio 3,01 e versioni precedenti, non supportano l'esecuzione di query remote.</span><span class="sxs-lookup"><span data-stu-id="1007d-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="1007d-148">Con Esplora risorse è possibile eseguire una query sull'indice locale di un computer remoto per file system elementi (elementi gestiti dal protocollo "file:").</span><span class="sxs-lookup"><span data-stu-id="1007d-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="1007d-149">Per recuperare un elemento in base a una query remota, è necessario che l'elemento soddisfi i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="1007d-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="1007d-150">Essere accessibile tramite il percorso Universal Naming Convention (UNC).</span><span class="sxs-lookup"><span data-stu-id="1007d-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="1007d-151">Esistere nel computer remoto a cui il client ha accesso.</span><span class="sxs-lookup"><span data-stu-id="1007d-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="1007d-152">Impostare la sicurezza per consentire al client di disporre dell'accesso in lettura.</span><span class="sxs-lookup"><span data-stu-id="1007d-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="1007d-153">Esplora risorse include funzionalità per la condivisione di elementi, tra cui una condivisione "pubblica" ( \\ \\ computer \\ pubblico \\ ...) nel **centro di rete e condivisione** e una condivisione "Users" ( \\ \\ \\ utenti computer \\ ...) per gli elementi condivisi tramite la procedura guidata di condivisione.</span><span class="sxs-lookup"><span data-stu-id="1007d-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="1007d-154">Una volta condivise le cartelle, è possibile eseguire una query sull'indice locale specificando il nome computer del computer remoto nella clausola FROM e un percorso UNC nel computer remoto nella clausola SCOPE.</span><span class="sxs-lookup"><span data-stu-id="1007d-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="1007d-155">Nell'esempio seguente viene illustrata una query remota che usa le clausole FROM e SCOPE.</span><span class="sxs-lookup"><span data-stu-id="1007d-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="1007d-156">Gli esempi forniti qui usano SQL.</span><span class="sxs-lookup"><span data-stu-id="1007d-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="1007d-157">Panoramica dell'API di query strutturata</span><span class="sxs-lookup"><span data-stu-id="1007d-157">Structured Query API Overview</span></span>

<span data-ttu-id="1007d-158">Una query strutturata consente di cercare le informazioni in base a combinazioni booleane di query su singole proprietà.</span><span class="sxs-lookup"><span data-stu-id="1007d-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="1007d-159">In questo argomento viene illustrata la funzionalità delle API e dei metodi di query strutturati più importanti.</span><span class="sxs-lookup"><span data-stu-id="1007d-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="1007d-160">Per la documentazione di riferimento sulle API di query strutturate, vedere [query sulle interfacce](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="1007d-161">IQueryParser</span><span class="sxs-lookup"><span data-stu-id="1007d-161">IQueryParser</span></span>

<span data-ttu-id="1007d-162">Il metodo [**IQueryParser::P ass**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) analizza una stringa di input dell'utente e produce un'interpretazione sotto forma di [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span><span class="sxs-lookup"><span data-stu-id="1007d-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="1007d-163">Se il parametro *pCustomProperties* di tale metodo non è null, è un'enumerazione di oggetti [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) (uno per ogni proprietà personalizzata riconosciuta).</span><span class="sxs-lookup"><span data-stu-id="1007d-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="1007d-164">Gli altri metodi [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) consentono all'applicazione di impostare diverse opzioni, ad esempio impostazioni locali, uno schema, un Word breaker e gestori per vari tipi di entità denominate.</span><span class="sxs-lookup"><span data-stu-id="1007d-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="1007d-165">[**IQueryParser:: GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) restituisce un'interfaccia [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) per l'esplorazione dello schema caricato.</span><span class="sxs-lookup"><span data-stu-id="1007d-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="1007d-166">IQuerySolution : IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="1007d-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="1007d-167">L'interfaccia [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) fornisce tutte le informazioni sul risultato dell'analisi di una stringa di input.</span><span class="sxs-lookup"><span data-stu-id="1007d-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="1007d-168">Poiché **IQuerySolution** è anche un'interfaccia [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) , è possibile creare ulteriori nodi dell'albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="1007d-169">Il metodo [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) produce un albero delle condizioni per l'interpretazione.</span><span class="sxs-lookup"><span data-stu-id="1007d-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="1007d-170">**IQuerySolution:: GetQuery** restituisce anche il tipo semantico.</span><span class="sxs-lookup"><span data-stu-id="1007d-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="1007d-171">IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="1007d-171">IConditionFactory</span></span>

<span data-ttu-id="1007d-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) crea nodi dell'albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="1007d-173">Se il parametro *semplificato* di [**IConditionFactory:: MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) è **Variant \_ true**, il [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) risultante è semplificato e non deve essere un nodo di negazione.</span><span class="sxs-lookup"><span data-stu-id="1007d-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="1007d-174">Se il parametro *pSubConditions* di [**IConditionFactory:: MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) non è null, tale parametro deve essere un'enumerazione di oggetti [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) e diventare sottoalberi. [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) costruisce un nodo foglia con un nome, un'operazione e un valore di proprietà specificati.</span><span class="sxs-lookup"><span data-stu-id="1007d-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="1007d-175">La stringa nel parametro *pValueType* deve corrispondere al nome di un tipo semantico dello schema.</span><span class="sxs-lookup"><span data-stu-id="1007d-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="1007d-176">Se il parametro *expand* è **Variant \_ true** e la proprietà è virtuale, l'albero delle condizioni risultante è in genere una disgiunzione risultante dall'espansione della proprietà nei relativi componenti definiti.</span><span class="sxs-lookup"><span data-stu-id="1007d-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="1007d-177">Se non è null, i parametri *pPropertyNameTerm*, *pOperatorTerm* e *pValueTerm* devono identificare i termini che indicano la proprietà, l'operazione e il valore.</span><span class="sxs-lookup"><span data-stu-id="1007d-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="1007d-178">ICondition: IPersistStream</span><span class="sxs-lookup"><span data-stu-id="1007d-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="1007d-179">L'interfaccia [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) è un singolo nodo in un albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="1007d-180">Il nodo può essere un nodo di negazione, un nodo, un nodo o un nodo foglia.</span><span class="sxs-lookup"><span data-stu-id="1007d-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="1007d-181">Per un nodo non foglia [**ICondition:: GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) restituisce un'enumerazione dei sottoalberi.</span><span class="sxs-lookup"><span data-stu-id="1007d-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="1007d-182">Per un nodo foglia i seguenti metodi di [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) restituiscono i valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="1007d-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="1007d-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) restituisce il nome della proprietà, l'operazione e il valore.</span><span class="sxs-lookup"><span data-stu-id="1007d-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="1007d-184">[**Getvaluetype**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) restituisce il tipo semantico del valore, che è stato specificied nel parametro *pszValueType* di [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span><span class="sxs-lookup"><span data-stu-id="1007d-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="1007d-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) restituisce un formato stringa del valore.</span><span class="sxs-lookup"><span data-stu-id="1007d-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="1007d-186">Se il valore è già una stringa, il form verrà normalizzato in relazione a maiuscole e minuscole, accenti e così via.</span><span class="sxs-lookup"><span data-stu-id="1007d-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="1007d-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) restituisce informazioni sulle parti della frase di input che hanno generato il nome della proprietà, l'operazione e il valore.</span><span class="sxs-lookup"><span data-stu-id="1007d-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="1007d-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) restituisce una copia completa di un albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="1007d-189">IRichChunk</span><span class="sxs-lookup"><span data-stu-id="1007d-189">IRichChunk</span></span>

<span data-ttu-id="1007d-190">Ogni oggetto [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) identifica un intervallo di token e una stringa.</span><span class="sxs-lookup"><span data-stu-id="1007d-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="1007d-191">**IRichChunk** è un'interfaccia di utilità che rappresenta le informazioni su un intervallo (in genere un intervallo di token) identificato da una posizione e una lunghezza iniziali.</span><span class="sxs-lookup"><span data-stu-id="1007d-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="1007d-192">Queste informazioni sull'intervallo includono una stringa e/o una **variante**.</span><span class="sxs-lookup"><span data-stu-id="1007d-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="1007d-193">IConditionGenerator</span><span class="sxs-lookup"><span data-stu-id="1007d-193">IConditionGenerator</span></span>

<span data-ttu-id="1007d-194">L'interfaccia [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) viene fornita dall'applicazione per gestire la generazione dell'albero delle condizioni e del riconoscimento per un tipo di entità denominato.</span><span class="sxs-lookup"><span data-stu-id="1007d-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="1007d-195">Un generatore di condizione viene assegnato a un [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) tramite [**IQueryParser:: SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span><span class="sxs-lookup"><span data-stu-id="1007d-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="1007d-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) chiama [**IConditionGenerator:: Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) con un [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) per lo schema attualmente caricato.</span><span class="sxs-lookup"><span data-stu-id="1007d-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="1007d-197">Questa operazione consente a [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) di ottenere le informazioni sullo schema necessarie.</span><span class="sxs-lookup"><span data-stu-id="1007d-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="1007d-198">Quando si analizza una stringa di input, **IQueryParser** chiama il metodo [**IConditionGenerator:: RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) di ogni [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), in modo che sia possibile segnalare l'occorrenza delle entità denominate riconosciute nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="1007d-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="1007d-199">**IQueryParser** è in grado di utilizzare le impostazioni locali correnti e di utilizzare la suddivisione in token dell'input perché deve segnalare gli intervalli di token di qualsiasi entità denominata.</span><span class="sxs-lookup"><span data-stu-id="1007d-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="1007d-200">Quando [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) sta per emettere un nodo foglia e il tipo semantico del valore corrisponde al tipo di entità denominato per un [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** chiama [**IConditionGenerator:: GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) con le informazioni relative al nodo da generare.</span><span class="sxs-lookup"><span data-stu-id="1007d-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="1007d-201">Se il [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) restituisce S \_ OK, deve restituire un albero delle condizioni (che non deve essere un nodo foglia) e informare **IQueryParser** se annullare l'interpretazione della stringa alternativa che verrebbe normalmente generata come precauzione.</span><span class="sxs-lookup"><span data-stu-id="1007d-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="1007d-202">ITokenCollection</span><span class="sxs-lookup"><span data-stu-id="1007d-202">ITokenCollection</span></span>

<span data-ttu-id="1007d-203">Il metodo [**ITokenCollection:: NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) restituisce il numero di token. [**ITokenCollection:: GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) restituisce informazioni sul token *i* th.</span><span class="sxs-lookup"><span data-stu-id="1007d-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="1007d-204">L'inizio e la lunghezza sono posizioni dei caratteri nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="1007d-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="1007d-205">Il testo restituito sarà non null solo se è presente un testo che esegue l'override dei caratteri dalla stringa di input.</span><span class="sxs-lookup"><span data-stu-id="1007d-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="1007d-206">Viene usato, ad esempio, per eseguire l'override di un trattino nella stringa di input senza quando tale trattino si trova in un contesto in cui deve essere interpretato come una negazione.</span><span class="sxs-lookup"><span data-stu-id="1007d-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="1007d-207">INamedEntityCollector</span><span class="sxs-lookup"><span data-stu-id="1007d-207">INamedEntityCollector</span></span>

<span data-ttu-id="1007d-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) chiama [**INamedEntityCollector:: Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) per ogni entità denominata riconosciuta.</span><span class="sxs-lookup"><span data-stu-id="1007d-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="1007d-209">Gli intervalli sono intervalli di token.</span><span class="sxs-lookup"><span data-stu-id="1007d-209">The spans are token spans.</span></span> <span data-ttu-id="1007d-210">Deve sempre essere il caso *beginSpan* ?</span><span class="sxs-lookup"><span data-stu-id="1007d-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="1007d-211">*beginActual*  <  *endActual* ?</span><span class="sxs-lookup"><span data-stu-id="1007d-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="1007d-212">*endSpan*.</span><span class="sxs-lookup"><span data-stu-id="1007d-212">*endSpan*.</span></span> <span data-ttu-id="1007d-213">*beginSpan* e *endSpan* possono differire da *beginActual* e *endActual* se l'entità denominata inizia e/o termina con token semanticamente non significativi, ad esempio virgolette (che sono comunque coperte dall'entità denominata).</span><span class="sxs-lookup"><span data-stu-id="1007d-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="1007d-214">Il valore deve essere espresso come stringa e successivamente verrà visualizzato in una chiamata a [**IConditionGenerator:: GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span><span class="sxs-lookup"><span data-stu-id="1007d-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="1007d-215">ISchemaProvider</span><span class="sxs-lookup"><span data-stu-id="1007d-215">ISchemaProvider</span></span>

<span data-ttu-id="1007d-216">L'interfaccia [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) può essere utilizzata per esplorare uno schema caricato per le entità (tipi) e le relazioni (proprietà).</span><span class="sxs-lookup"><span data-stu-id="1007d-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="1007d-217">Ecco quali sono i singoli metodi:</span><span class="sxs-lookup"><span data-stu-id="1007d-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="1007d-218">[**Entità**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) restituisce un'enumerazione di ogni entità ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) nello schema.</span><span class="sxs-lookup"><span data-stu-id="1007d-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="1007d-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) restituisce l'entità radice dello schema.</span><span class="sxs-lookup"><span data-stu-id="1007d-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="1007d-220">Per uno schema flat, viene restituito il tipo principale di ogni [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="1007d-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="1007d-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) trova un'entità in base al nome e restituisce \_ false se tale entità non è presente nello schema.</span><span class="sxs-lookup"><span data-stu-id="1007d-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="1007d-222">I [**metadati**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) restituiscono un'enumerazione delle interfacce [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) .</span><span class="sxs-lookup"><span data-stu-id="1007d-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="1007d-223">IEntity</span><span class="sxs-lookup"><span data-stu-id="1007d-223">IEntity</span></span>

<span data-ttu-id="1007d-224">L'interfaccia [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) è un'entità dello schema che rappresenta un tipo con un nome, ha una serie di relazioni denominate con altri tipi (proprietà) e deriva da un'entità di base.</span><span class="sxs-lookup"><span data-stu-id="1007d-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="1007d-225">Ecco quali sono i singoli metodi:</span><span class="sxs-lookup"><span data-stu-id="1007d-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="1007d-226">[**IEntity:: relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) restituisce un'enumerazione di oggetti [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) , uno per ogni relazione in uscita di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="1007d-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="1007d-227">Ogni relazione in uscita di un'entità ha un nome.</span><span class="sxs-lookup"><span data-stu-id="1007d-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="1007d-228">[**IEntity:: GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) trova una relazione in base al nome e restituisce \_ false se non esiste una relazione di questo tipo per questa entità.</span><span class="sxs-lookup"><span data-stu-id="1007d-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="1007d-229">[**IEntity:: Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) restituisce un'enumerazione di interfacce [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , una per ogni coppia di metadati di questa entità.</span><span class="sxs-lookup"><span data-stu-id="1007d-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="1007d-230">[**IEntity::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) restituisce una frase predefinita per facilitare la generazione di una riformulazione AQS o NQS di un albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="1007d-231">IRelationship</span><span class="sxs-lookup"><span data-stu-id="1007d-231">IRelationship</span></span>

<span data-ttu-id="1007d-232">L'interfaccia [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) rappresenta una relazione tra due entità, ovvero un'origine e una destinazione.</span><span class="sxs-lookup"><span data-stu-id="1007d-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="1007d-233">Ecco quali sono i singoli metodi:</span><span class="sxs-lookup"><span data-stu-id="1007d-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="1007d-234">[**IRelationship:: Unreal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) indica se una relazione è reale.</span><span class="sxs-lookup"><span data-stu-id="1007d-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="1007d-235">Se, ad esempio, l'entità A deriva dall'entità B e eredita una relazione denominata R da essa, è possibile che una relazione denominata R sia ancora presente. Tuttavia, la relazione beween A e R deve avere lo stesso tipo di destinazione di B e l'unico motivo per esistere è archiviare i metadati specifici di B. Una relazione di questo tipo è detta non reale.</span><span class="sxs-lookup"><span data-stu-id="1007d-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="1007d-236">[**IRelationship:: medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) restituisce un'enumerazione di interfacce [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , una per ogni coppia di metadati di questa entità.</span><span class="sxs-lookup"><span data-stu-id="1007d-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="1007d-237">[**IRelationship::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) restituisce la frase predefinita da utilizzare per la relazione in riformulazioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="1007d-238">Ogni relazione ha una frase predefinita che la denota per facilitare la generazione di una riformulazione AQS o NQS di un albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="1007d-239">IMetaData</span><span class="sxs-lookup"><span data-stu-id="1007d-239">IMetaData</span></span>

<span data-ttu-id="1007d-240">I metadati sono coppie chiave-valore associate a un'entità, a una relazione o a un intero schema.</span><span class="sxs-lookup"><span data-stu-id="1007d-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="1007d-241">Poiché le chiavi non sono necessariamente univoche, una raccolta di metadati può essere considerata come una mappa a più livelli.</span><span class="sxs-lookup"><span data-stu-id="1007d-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="1007d-242">[**IMetadata:: GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) viene chiamato per recuperare la chiave e il valore per una coppia di metatdata.</span><span class="sxs-lookup"><span data-stu-id="1007d-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="1007d-243">Esecuzione di query sugli scenari</span><span class="sxs-lookup"><span data-stu-id="1007d-243">Querying Scenarios</span></span>

<span data-ttu-id="1007d-244">Negli scenari seguenti viene descritto l'utilizzo di API di query strutturate in Windows Search in scenari comuni di query, ad esempio la creazione di un albero delle condizioni e l'esecuzione di query sull'indice.</span><span class="sxs-lookup"><span data-stu-id="1007d-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="1007d-245">Estrazione della condizione e analisi delle query</span><span class="sxs-lookup"><span data-stu-id="1007d-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="1007d-246">Quando viene creata una query, l'ambito viene definito indicando al sistema dove eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="1007d-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="1007d-247">In questo modo i risultati della ricerca vengono limitati.</span><span class="sxs-lookup"><span data-stu-id="1007d-247">This restricts the search results.</span></span> <span data-ttu-id="1007d-248">Dopo aver definito l'ambito, viene applicato un filtro e viene restituito un set di filtri.</span><span class="sxs-lookup"><span data-stu-id="1007d-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="1007d-249">I risultati della ricerca sono limitati mediante la compilazione di un albero delle condizioni con nodi foglia, simile a un grafico.</span><span class="sxs-lookup"><span data-stu-id="1007d-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="1007d-250">Tali condizioni vengono quindi estratte.</span><span class="sxs-lookup"><span data-stu-id="1007d-250">Those conditions are then extracted.</span></span> <span data-ttu-id="1007d-251">Un albero delle condizioni è una combinazione booleana (AND, OR, NOT) delle condizioni foglia, ognuna delle quali correla una proprietà, tramite un'operazione, a un valore.</span><span class="sxs-lookup"><span data-stu-id="1007d-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="1007d-252">Un nodo foglia rappresenta una restrizione su una singola proprietà a un valore tramite alcune operazioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="1007d-253">Una restrizione di filtro richiede un'espressione logica che descriva la restrizione.</span><span class="sxs-lookup"><span data-stu-id="1007d-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="1007d-254">La definizione di questa espressione inizia con l'interfaccia [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) , che viene usata per creare un singolo nodo in un albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="1007d-255">Poiché nell'esempio seguente è presente una sola condizione, l'albero non cambia.</span><span class="sxs-lookup"><span data-stu-id="1007d-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="1007d-256">Se è presente più di una condizione di filtro, vengono usati e e altri operatori booleani per ottenere un singolo albero.</span><span class="sxs-lookup"><span data-stu-id="1007d-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="1007d-257">AND-Trees e OR-Trees rappresentano le congiunzioni e le disgiunzioni dei rispettivi sottoalberi.</span><span class="sxs-lookup"><span data-stu-id="1007d-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="1007d-258">Un NOT-Tree rappresenta la negazione del singolo sottoalbero.</span><span class="sxs-lookup"><span data-stu-id="1007d-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="1007d-259">AQS fornisce un approccio testuale per ottenere espressioni logiche con operatori booleani ed è spesso più semplice.</span><span class="sxs-lookup"><span data-stu-id="1007d-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="1007d-260">Nell'esempio seguente viene convertito l'albero delle condizioni ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) in formato visivo.</span><span class="sxs-lookup"><span data-stu-id="1007d-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="1007d-261">Il parser di query, usando l'interfaccia [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) , converte [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) in una stringa di query RTF (Rich text formatted).</span><span class="sxs-lookup"><span data-stu-id="1007d-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="1007d-262">Il metodo [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) restituisce il testo della query, mentre il metodo [**IQueryParser::P ass**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) produce un'interfaccia [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="1007d-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="1007d-263">Nell'esempio seguente viene illustrato come eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="1007d-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="1007d-264">L'input principale di [**IQueryParser::P ass**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) è una stringa di input dell'utente da analizzare, ma l'applicazione può anche informare il parser di query delle proprietà riconosciute nell'input (dalla sintassi specifica dell'applicazione).</span><span class="sxs-lookup"><span data-stu-id="1007d-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="1007d-265">L'output di **IQueryParser::P ass** è un [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), che fornisce tutte le informazioni relative alla chiamata di analisi.</span><span class="sxs-lookup"><span data-stu-id="1007d-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="1007d-266">Sono disponibili metodi per ottenere la stringa di input, il modo in cui la stringa di input è stata suddivisa in token, eventuali errori di analisi e la query analizzata come albero delle condizioni, rappresentata da un [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span><span class="sxs-lookup"><span data-stu-id="1007d-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="1007d-267">Nell'esempio seguente viene illustrato...</span><span class="sxs-lookup"><span data-stu-id="1007d-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="1007d-268">Nell'esempio precedente, [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) può ottenere tutte le informazioni sulla query, inclusi il testo originale, i token che comprendono il testo o l'albero delle condizioni.</span><span class="sxs-lookup"><span data-stu-id="1007d-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="1007d-269">Nella tabella seguente sono elencati alcuni esempi di possibili valori di query restituiti.</span><span class="sxs-lookup"><span data-stu-id="1007d-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="1007d-270">Esempi di valori di query restituiti</span><span class="sxs-lookup"><span data-stu-id="1007d-270">Examples of returned query values</span></span>                        | <span data-ttu-id="1007d-271">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1007d-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="1007d-272">Il testo della query restituito da [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring)</span><span class="sxs-lookup"><span data-stu-id="1007d-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="1007d-273">Suddivisione dei token</span><span class="sxs-lookup"><span data-stu-id="1007d-273">The break-down of tokens</span></span>                                                                                  |
| ![albero delle condizioni non risolte](images/queryvalues1.png) | <span data-ttu-id="1007d-275">Albero delle condizioni non risolte</span><span class="sxs-lookup"><span data-stu-id="1007d-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="1007d-276">L'albero della condizione iniziale restituito non è risolto.</span><span class="sxs-lookup"><span data-stu-id="1007d-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="1007d-277">In un albero delle condizioni non risolto, i riferimenti di data e ora, ad esempio `date:yesterday` , non vengono convertiti in tempo assoluto.</span><span class="sxs-lookup"><span data-stu-id="1007d-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="1007d-278">Inoltre, le proprietà virtuali non vengono espanse.</span><span class="sxs-lookup"><span data-stu-id="1007d-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="1007d-279">Le proprietà virtuali sono proprietà che fungono da aggregazioni di più proprietà.</span><span class="sxs-lookup"><span data-stu-id="1007d-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="1007d-280">La query produce ad esempio `kind:email from:reljai` gli alberi delle condizioni non risolte e risolte seguenti.</span><span class="sxs-lookup"><span data-stu-id="1007d-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="1007d-281">L'albero delle condizioni non risolte è a sinistra e l'albero delle condizioni risolto è a destra.</span><span class="sxs-lookup"><span data-stu-id="1007d-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![strutture ad albero delle condizioni non risolte e risolte](images/conditiontree.png)

<span data-ttu-id="1007d-283">È possibile ottenere l'albero risolto chiamando [**IConditionFactory:: Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span><span class="sxs-lookup"><span data-stu-id="1007d-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="1007d-284">Tuttavia, il passaggio di [**SQRO \_ dont \_ Resolve \_ DateTime**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) lascia la data e l'ora non risolte.</span><span class="sxs-lookup"><span data-stu-id="1007d-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="1007d-285">L'albero di una condizione non risolta presenta vantaggi, perché un albero delle condizioni non risolto contiene informazioni sulla query.</span><span class="sxs-lookup"><span data-stu-id="1007d-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="1007d-286">Ogni nodo foglia punta ai token restituiti da [**IQuerySolution:: GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), che corrispondono alla proprietà, all'operatore e al valore quando si usa l'interfaccia [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) .</span><span class="sxs-lookup"><span data-stu-id="1007d-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="1007d-287">Nell'esempio seguente viene illustrato...</span><span class="sxs-lookup"><span data-stu-id="1007d-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="1007d-288">Esecuzione di query sull'indice</span><span class="sxs-lookup"><span data-stu-id="1007d-288">Querying the Index</span></span>

<span data-ttu-id="1007d-289">Esistono diversi approcci per eseguire query sull'indice.</span><span class="sxs-lookup"><span data-stu-id="1007d-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="1007d-290">Alcuni sono basati su SQL e altri sono basati su AQS.</span><span class="sxs-lookup"><span data-stu-id="1007d-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="1007d-291">È anche possibile eseguire una query sull'indice di ricerca di Windows a livello di codice usando le [interfacce di query](./-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="1007d-292">Sono disponibili tre interfacce specifiche per l'esecuzione di query sull'indice: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)e [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="1007d-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="1007d-293">Per informazioni concettuali, vedere [esecuzione di query sull'indice a livello di codice](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="1007d-294">È possibile sviluppare una classe componente o helper per eseguire una query sull'indice usando l'interfaccia [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) .</span><span class="sxs-lookup"><span data-stu-id="1007d-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="1007d-295">Questa interfaccia viene implementata come classe helper per [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (e [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)) ed è ottenuta chiamando [**ISearchCatalogManager:: GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span><span class="sxs-lookup"><span data-stu-id="1007d-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="1007d-296">Per informazioni concettuali, vedere [esecuzione di query sull'indice con ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="1007d-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) consente di:</span><span class="sxs-lookup"><span data-stu-id="1007d-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="1007d-298">Ottenere una stringa di connessione OLE DB per connettersi al database di Windows Search.</span><span class="sxs-lookup"><span data-stu-id="1007d-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="1007d-299">Converte le query utente AQS in SQL Search di Windows.</span><span class="sxs-lookup"><span data-stu-id="1007d-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="1007d-300">Specificare le restrizioni per le query che possono essere espresse in SQL ma non in AQS.</span><span class="sxs-lookup"><span data-stu-id="1007d-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="1007d-301">Le priorità di indicizzazione e gli eventi del set di righe sono supportati in Windows 7 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="1007d-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="1007d-302">Con [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) è presente uno stack di priorità che consente al client di richiedere che agli ambiti utilizzati in una determinata query venga assegnata una priorità più alta rispetto alla priorità normale.</span><span class="sxs-lookup"><span data-stu-id="1007d-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="1007d-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) fornisce la notifica delle modifiche apportate agli elementi nei set di righe, tra cui l'aggiunta di nuovi elementi, l'eliminazione di elementi e la modifica dei dati dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="1007d-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="1007d-304">L'utilizzo delle notifiche degli eventi del set di righe garantisce che i risultati delle query esistenti siano i più aggiornati possibili.</span><span class="sxs-lookup"><span data-stu-id="1007d-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="1007d-305">Per informazioni concettuali, vedere [indicizzazione di priorità e eventi del set di righe in Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="1007d-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1007d-306">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1007d-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1007d-307">Indicizzazione, query e notifiche in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="1007d-308">Contenuto dell'indice</span><span class="sxs-lookup"><span data-stu-id="1007d-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="1007d-309">Processo di indicizzazione in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="1007d-310">Processo di notifica in Windows Search</span><span class="sxs-lookup"><span data-stu-id="1007d-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="1007d-311">Requisiti per la formattazione degli URL</span><span class="sxs-lookup"><span data-stu-id="1007d-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
