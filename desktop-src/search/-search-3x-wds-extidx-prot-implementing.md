---
description: Alcune applicazioni archiviano gli elementi in database o tipi di file personalizzati.
ms.assetid: 0e2b7b4b-ae87-4092-b924-6191cdf42c9b
title: Informazioni sui gestori di protocollo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28c171c5790e47bbf624d9107a5ca5b3dc0b9fd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106306187"
---
# <a name="understanding-protocol-handlers"></a><span data-ttu-id="0e11f-103">Informazioni sui gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-103">Understanding Protocol Handlers</span></span>

<span data-ttu-id="0e11f-104">Alcune applicazioni archiviano gli elementi in database o tipi di file personalizzati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-104">Some applications store their items in databases or custom file types.</span></span> <span data-ttu-id="0e11f-105">Sebbene Windows Search possa indicizzare il nome e le proprietà del file, Windows non è in grado di conoscere il contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="0e11f-105">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="0e11f-106">Di conseguenza, tali elementi non possono essere indicizzati o esposti nella shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="0e11f-106">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="0e11f-107">Creando un gestore di protocollo è possibile rendere disponibili questi elementi per l'indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="0e11f-107">By creating a protocol handler you can make these items available for indexing.</span></span> <span data-ttu-id="0e11f-108">È inoltre possibile indicizzare un formato di file composto, ad esempio un file con estensione zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-108">You can also index a compound file format such as a .zip file.</span></span>

<span data-ttu-id="0e11f-109">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="0e11f-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="0e11f-110">Indicizzazione di archivi dati con gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-110">Indexing Data Stores with Protocol Handlers</span></span>](#indexing-data-stores-with-protocol-handlers)
    -   [<span data-ttu-id="0e11f-111">Archivi dati della shell</span><span class="sxs-lookup"><span data-stu-id="0e11f-111">Shell Data Stores</span></span>](#shell-data-stores)
    -   [<span data-ttu-id="0e11f-112">Gestori del protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-112">Protocol Handlers</span></span>](#protocol-handlers)
    -   [<span data-ttu-id="0e11f-113">Filtri e gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-113">Filters and Protocol Handlers</span></span>](#filters-and-protocol-handlers)
-   [<span data-ttu-id="0e11f-114">Indicizzazione di un formato di file composto</span><span class="sxs-lookup"><span data-stu-id="0e11f-114">Indexing a Compound File Format</span></span>](#indexing-a-compound-file-format)
-   [<span data-ttu-id="0e11f-115">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0e11f-115">Related topics</span></span>](#related-topics)

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="0e11f-116">Indicizzazione di archivi dati con gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-116">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="0e11f-117">Quando gli utenti devono eseguire ricerche in database legacy, archivi di posta elettronica o altre strutture di dati che non sono supportate da Windows Search, è necessario innanzitutto determinare se un gestore di protocollo esiste già per quell'archivio dati, ad esempio per l'uso con un'altra applicazione, ad esempio SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="0e11f-117">When users need to search legacy databases, email stores or other data structures that are not supported by Windows Search, you should first determine whether a protocol handler already exists for that data store, perhaps for use with another application such as SharePoint Server.</span></span> <span data-ttu-id="0e11f-118">In tal caso, è possibile installare il gestore di protocollo nel sistema.</span><span class="sxs-lookup"><span data-stu-id="0e11f-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="0e11f-119">I gestori del protocollo di ricerca di Windows utilizzano specifiche di progettazione simili a quelle di SharePoint Server e spesso possono essere utilizzati in modo interscambiabile.</span><span class="sxs-lookup"><span data-stu-id="0e11f-119">Windows Search protocol handlers use design specifications similar to SharePoint Server, and they can often be used interchangeably.</span></span>

<span data-ttu-id="0e11f-120">Per ulteriori informazioni sulla distribuzione di Search Server 2008 con Office SharePoint Server 2007, vedere la pagina relativa alla ricerca [federata nel \[ server \] 2008](/previous-versions/office/bb931109(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="0e11f-120">For more information about Search Server 2008 deployment with Office SharePoint Server 2007, see [Federated Search \[Search Server 2008\]](/previous-versions/office/bb931109(v=office.14)).</span></span>

### <a name="shell-data-stores"></a><span data-ttu-id="0e11f-121">Archivi dati della shell</span><span class="sxs-lookup"><span data-stu-id="0e11f-121">Shell Data Stores</span></span>

<span data-ttu-id="0e11f-122">Prima che uno sviluppatore di terze parti di nuovi formati di file e archivi dati possa visualizzare i formati e i negozi nei risultati della query in Esplora risorse, lo sviluppatore deve implementare un'origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="0e11f-122">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must implement a Shell data source.</span></span> <span data-ttu-id="0e11f-123">Un'origine dati della shell è un componente usato per estendere lo spazio dei nomi della shell ed esporre gli elementi in un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-123">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="0e11f-124">Un archivio dati è un repository di dati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-124">A data store is a repository of data.</span></span> <span data-ttu-id="0e11f-125">Un archivio dati può essere esposto al modello di programmazione della shell come contenitore che usa un'origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="0e11f-125">A data store can be exposed to the Shell programming model as a container that uses a Shell data source.</span></span> <span data-ttu-id="0e11f-126">Gli elementi in un archivio dati possono essere indicizzati dal sistema di ricerca Windows utilizzando un gestore di protocollo.</span><span class="sxs-lookup"><span data-stu-id="0e11f-126">The items in a data store can be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="0e11f-127">Il gestore di protocollo implementa il protocollo per l'accesso a un'origine di contenuto nel formato nativo.</span><span class="sxs-lookup"><span data-stu-id="0e11f-127">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="0e11f-128">Le interfacce [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) e [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) vengono utilizzate per implementare un gestore di protocollo personalizzato per espandere le origini dati che possono essere indicizzate.</span><span class="sxs-lookup"><span data-stu-id="0e11f-128">The [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span>

<span data-ttu-id="0e11f-129">Se si desidera che i risultati della query vengano visualizzati in Esplora risorse, è necessario implementare un'origine dati della shell prima di poter creare un gestore di protocollo per estendere l'indice.</span><span class="sxs-lookup"><span data-stu-id="0e11f-129">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="0e11f-130">Tuttavia, se tutte le query saranno a livello di codice (tramite OLE DB ad esempio) e interpretate dal codice dell'applicazione anziché dalla shell, uno spazio dei nomi della shell ancora preferito non è strettamente necessario.</span><span class="sxs-lookup"><span data-stu-id="0e11f-130">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace while still preferred is not strictly required.</span></span>

> [!Note]  
> <span data-ttu-id="0e11f-131">Un'origine dati della shell è talvolta nota come estensione dello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="0e11f-131">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="0e11f-132">Un gestore è talvolta noto come estensione della shell o gestore di estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="0e11f-132">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

<span data-ttu-id="0e11f-133">Se si desidera che gli utenti visualizzano i risultati della ricerca in Esplora risorse, è necessario creare un gestore di protocollo e uno o più dei componenti aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="0e11f-133">If you want users to view their search results from within Windows Explorer, then you must create a protocol handler and one or more of the following add-ins:</span></span>

-   <span data-ttu-id="0e11f-134">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="0e11f-134">Shortcut menu handler</span></span>
-   <span data-ttu-id="0e11f-135">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="0e11f-135">Icon handler</span></span>
-   <span data-ttu-id="0e11f-136">Un altro tipo di gestore di file</span><span class="sxs-lookup"><span data-stu-id="0e11f-136">Some other type of file handler</span></span>

<span data-ttu-id="0e11f-137">Per un elenco di gestori identificato dallo scenario di sviluppo che si sta tentando di ottenere, vedere "Panoramica dei gestori" in [Windows Search come piattaforma di sviluppo](-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-137">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span> <span data-ttu-id="0e11f-138">Per informazioni sulla creazione di gestori, vedere [registrazione di estensioni della shell](../shell/reg-shell-exts.md), [menu di scelta rapida](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85))e [gestori di tipi di file](../shell/fa-file-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-138">For information on creating handlers, see [Registering Shell Extensions](../shell/reg-shell-exts.md), [Context Menu](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85)), and [File Type Handlers](../shell/fa-file-extensions.md).</span></span>

### <a name="protocol-handlers"></a><span data-ttu-id="0e11f-139">Gestori del protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-139">Protocol Handlers</span></span>

<span data-ttu-id="0e11f-140">Se l'archivio dati è anche un contenitore, ad esempio una cartella di file system, è necessario implementare un filtro per enumerare gli URL nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="0e11f-140">If the data store is also a container (such as a file system folder), you must implement a filter to enumerate the URLs in the container.</span></span> <span data-ttu-id="0e11f-141">Se l'archivio dati contiene tipi di dati o di file diversi da uno dei tipi di file 200 supportati da Windows Search, è necessario implementare un filtro per accedere e indicizzare il contenuto degli elementi nell'archivio.</span><span class="sxs-lookup"><span data-stu-id="0e11f-141">If the data store contains data or file types other than one of the 200 file types supported by Windows Search, you must implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="0e11f-142">Windows Search usa il gestore di protocollo e la tecnologia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) analoga a quella usata da SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="0e11f-142">Windows Search uses protocol handler and [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) technology similar to that used by SharePoint Server.</span></span> <span data-ttu-id="0e11f-143">Se sono già presenti filtri per un archivio specifico e un tipo di file installati nel sistema indicizzato, è possibile che Windows Search sia in grado di utilizzare le interfacce esistenti per indicizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-143">If you already have filters for a specific store and file type installed on the system being indexed, Windows Search may be able to use the existing interfaces to index this data.</span></span>

<span data-ttu-id="0e11f-144">Per una panoramica del processo di indicizzazione, vedere [il processo di indicizzazione](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-144">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span> <span data-ttu-id="0e11f-145">Per informazioni concettuali sui gestori di filtri, vedere [sviluppo di gestori di filtri](-search-ifilter-conceptual.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-145">For conceptual information on filter handlers, see [Developing Filter Handlers](-search-ifilter-conceptual.md).</span></span>

### <a name="filters-and-protocol-handlers"></a><span data-ttu-id="0e11f-146">Filtri e gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-146">Filters and Protocol Handlers</span></span>

<span data-ttu-id="0e11f-147">I gestori di protocollo consentono all'indicizzatore di ricerca di Windows di accedere agli archivi dati, consentendo all'indicizzatore di eseguire la ricerca per indicizzazione dei nodi di un archivio dati ed estrarre le informazioni rilevanti da indicizzare.</span><span class="sxs-lookup"><span data-stu-id="0e11f-147">Protocol handlers give the Windows Search indexer access to data stores, enabling the indexer to crawl the nodes of a data store and extract relevant information to index.</span></span> <span data-ttu-id="0e11f-148">Windows Search, ad esempio, viene fornito con gestori di protocollo per gli archivi file system e per alcune versioni di entrambi gli archivi dati di Microsoft Outlook.</span><span class="sxs-lookup"><span data-stu-id="0e11f-148">Windows Search, for example, ships with protocol handlers for file system stores and for some versions of both Microsoft Outlook data stores.</span></span> <span data-ttu-id="0e11f-149">Quando si indicizza la posta elettronica di Outlook, il gestore di protocollo esegue la ricerca per indicizzazione di tutti i messaggi in un set di cartelle di Outlook ed estrae informazioni da ogni messaggio e allegato.</span><span class="sxs-lookup"><span data-stu-id="0e11f-149">When indexing Outlook email, the protocol handler crawls all messages in a set of Outlook folders and extracts information from each message and attachment.</span></span> <span data-ttu-id="0e11f-150">Queste informazioni vengono passate all'indicizzatore per l'inclusione nel catalogo di Windows Search.</span><span class="sxs-lookup"><span data-stu-id="0e11f-150">This information is passed to the indexer for inclusion in the Windows Search catalog.</span></span>

<span data-ttu-id="0e11f-151">Per panoramiche su Gestione cataloghi e gestione ambito ricerca per indicizzazione, vedere [utilizzo di gestione cataloghi](-search-3x-wds-mngidx-catalog-manager.md) e [utilizzo di gestione ambito ricerca per indicizzazione](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-151">For overviews of the Catalog Manager and Crawl Scope Manager (CSM), see [Using the Catalog Manager](-search-3x-wds-mngidx-catalog-manager.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="indexing-a-compound-file-format"></a><span data-ttu-id="0e11f-152">Indicizzazione di un formato di file composto</span><span class="sxs-lookup"><span data-stu-id="0e11f-152">Indexing a Compound File Format</span></span>

<span data-ttu-id="0e11f-153">Un formato di file composto può essere indicizzato in modo che i singoli elementi nel file possano essere restituiti come singoli risultati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-153">A compound file format can be indexed so that individual items in the file can can be returned as individual results.</span></span> <span data-ttu-id="0e11f-154">Un formato di file composto, ad esempio un file compresso con estensione zip, è essenzialmente un archivio dati e può essere considerato come tale, per finalità di indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="0e11f-154">A compound file format such as a compressed file with a .zip file name extension is essentially a data store and can be treated as such for indexing purposes.</span></span> <span data-ttu-id="0e11f-155">Nell'esempio seguente viene visualizzato un file con estensione zip nello spazio dei nomi file system (FILE://c:/test/test.zip) in cui sono presenti sia sottocartelle che singoli elementi.</span><span class="sxs-lookup"><span data-stu-id="0e11f-155">The following example displays a .zip file in the file system namespace (FILE://c:/test/test.zip) in which there are both subfolders and individual items.</span></span>

``` syntax
Test.zip 

    |-folder1 

    |    |-folder2 

    |           |- FileX.txt 

    |- FileY.doc
```

<span data-ttu-id="0e11f-156">Il gestore del protocollo FILE rileva quando FILE://c:/test/test.zip modifiche monitorando file system log delle modifiche e richiamerà un [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registrato per i file con estensione zip in tale file quando il file viene modificato, ma non conosce la struttura interna del file con estensione zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-156">The FILE protocol handler discovers when FILE://c:/test/test.zip changes by monitoring file system change logs, and it will invoke an [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registered for .zip files on that file when the file changes, but it has no knowledge of the internal structure of the .zip file itself.</span></span>

<span data-ttu-id="0e11f-157">È necessario informare l'indicizzatore che il formato di file composto è un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-157">You must inform the indexer that the compound file format is a data store.</span></span> <span data-ttu-id="0e11f-158">È necessario fare in modo che i singoli elementi vengano indicizzati e recuperati come entità univoche.</span><span class="sxs-lookup"><span data-stu-id="0e11f-158">It is necessary to do so for individual items to be indexed and retrieved as unique entities.</span></span> <span data-ttu-id="0e11f-159">Dopo aver implementato un'origine dati della shell ed eseguito i passaggi seguenti, si disporrà di un gestore di protocollo che può elaborare ed esporre i dati da un formato di file composto (un file con estensione zip) come singoli elementi.</span><span class="sxs-lookup"><span data-stu-id="0e11f-159">After you have implemented a Shell data source and performed the following steps, you will have a protocol handler that can process and expose the data from a compound file format (a .zip file) as individual items.</span></span>

<span data-ttu-id="0e11f-160">**Per informare l'indicizzatore che un file composto è un archivio dati:**</span><span class="sxs-lookup"><span data-stu-id="0e11f-160">**To inform the indexer that a compound file is a data store:**</span></span>

1.  <span data-ttu-id="0e11f-161">Creare un gestore di protocollo (usando [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) o [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) per i file con estensione zip che hanno la possibilità di eseguire l'associazione al file di origine.</span><span class="sxs-lookup"><span data-stu-id="0e11f-161">Create a protocol handler (using [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) or [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) for .zip files that has the ability bind to the source file.</span></span> <span data-ttu-id="0e11f-162">Per ulteriori informazioni, vedere [installazione e registrazione dei gestori di protocollo](-search-3x-wds-ph-install-registration.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-162">For more information, see [Installing and Registering Protocol Handlers](-search-3x-wds-ph-install-registration.md).</span></span>

    <span data-ttu-id="0e11f-163">Ad esempio, è possibile usare un percorso di escape del file con estensione zip come nome della cartella radice e quindi usare una sintassi della gerarchia come qualsiasi altro formato di file.</span><span class="sxs-lookup"><span data-stu-id="0e11f-163">For example, you could use an escaped path to the .zip file as the root folder name and then use a hierarchy syntax like any other file format.</span></span>

    ``` syntax
    .zip:///escapedPathTo.zipFile/.zipfolder/.../.zipfile
    ```

    <span data-ttu-id="0e11f-164">Usando i dati di esempio precedenti per c: \\ test \\test.zip, gli URL univoci sono i seguenti.</span><span class="sxs-lookup"><span data-stu-id="0e11f-164">Using the above sample data for c:\\test\\test.zip, the unique URLs would be as follows.</span></span> <span data-ttu-id="0e11f-165">Con questi URL, il gestore di protocollo dispone delle informazioni necessarie per eseguire l'associazione al file zip ed enumerare gli URL figlio, inclusi i file interni, in modo che possano essere associati e indicizzati dai filtri doc e txt.</span><span class="sxs-lookup"><span data-stu-id="0e11f-165">With these URLs the protocol handler has the information necessary to bind to the .zip file and enumerate the child URLs including the inner files so that they can be bound to and indexed by the .doc and .txt filters.</span></span>

    ``` syntax
      

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/FileY.Doc 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2/FileX.txt
    ```

2.  <span data-ttu-id="0e11f-166">Verificare che il gestore di protocollo soddisfi le due condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="0e11f-166">Ensure that your protocol handler meets the following two conditions:</span></span>
    -   <span data-ttu-id="0e11f-167">Gli URL radice per un file con estensione zip devono creare PKEY \_ Search \_ IsClosedDirectory ([System. search. IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) sugli URL che corrispondono agli URL del file con estensione zip radice.</span><span class="sxs-lookup"><span data-stu-id="0e11f-167">The root URLs for a .zip file should emit PKEY\_Search\_IsClosedDirectory ([System.Search.IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) on the URLs that are the root .zip file URLs.</span></span> <span data-ttu-id="0e11f-168">Ad esempio,. zip:///FILE:%2f%2f%2fc:%2ftest% 2ftest.zip/deve creare IsClosedDirectory = **true**.</span><span class="sxs-lookup"><span data-stu-id="0e11f-168">For example, .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ should emit IsClosedDirectory = **TRUE**.</span></span> <span data-ttu-id="0e11f-169">In questo modo l'indicizzatore indica che se la data in questo URL non è stata modificata, non è necessario elaborare alcun URL figlio.</span><span class="sxs-lookup"><span data-stu-id="0e11f-169">This tells the indexer that if the date on this URL has not changed, it does not need to process any of the child URLs.</span></span>
    -   <span data-ttu-id="0e11f-170">Ogni URL figlio per tale URL deve creare PKEY \_ Search \_ IsFullyContained ([System. search. IsFullyContained](../properties/props-system-search-isfullycontained.md)) sugli URL figlio dell'URL root. zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-170">Every child URL for that URL should emit PKEY\_Search\_IsFullyContained ([System.Search.IsFullyContained](../properties/props-system-search-isfullycontained.md)) on the child URLs of the root .zip URL.</span></span> <span data-ttu-id="0e11f-171">Normalmente alla fine di una ricerca per indicizzazione incrementale, l'indicizzatore considera tutti gli URL non visitati come elementi che devono essere eliminati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-171">Normally at the end of an incremental crawl, the indexer treats all unvisited URLs as items that should be deleted.</span></span> <span data-ttu-id="0e11f-172">Il file con estensione zip radice, tuttavia, non deve elaborare URL radice perché non è stato modificato nulla.</span><span class="sxs-lookup"><span data-stu-id="0e11f-172">But the root .zip file should not process root URLs because nothing has changed.</span></span> <span data-ttu-id="0e11f-173">La creazione di questa proprietà su **true** indica all'indicizzatore che se l'URL non è stato elaborato alla fine di una ricerca per indicizzazione incrementale, non deve essere eliminato.</span><span class="sxs-lookup"><span data-stu-id="0e11f-173">Emitting this property as **TRUE** tells the indexer that if this URL has not been processed at the end of an incremental crawl, it should not be deleted.</span></span> <span data-ttu-id="0e11f-174">Verrà eliminato solo se l'elemento radice è stato modificato e non viene visitato.</span><span class="sxs-lookup"><span data-stu-id="0e11f-174">It will only be deleted if the root item has changed and it is not visited.</span></span>

<span data-ttu-id="0e11f-175">Windows Search richiede una pagina iniziale per un protocollo per sapere quali URL eseguire la ricerca per indicizzazione in modo incrementale e quali URL devono essere ignorati quando vengono trovati.</span><span class="sxs-lookup"><span data-stu-id="0e11f-175">Windows Search requires a start page for a protocol in order to know what URLs to crawl incrementally and which URLs should be ignored when they are found.</span></span> <span data-ttu-id="0e11f-176">Non è tuttavia possibile iniziare con un URL per ogni file zip, perché non è noto dove si trova ogni file zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-176">But we can't start with a URL for each .zip file, because we don't know where each .zip file is.</span></span> <span data-ttu-id="0e11f-177">Di conseguenza, l'URL della pagina iniziale del gestore del protocollo zip deve essere in grado di enumerare tutti gli elementi alla radice dei percorsi di escape di tutti i file con estensione zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-177">Hence, the .zip protocol handler's start page URL must be able to enumerate everything at the root of the escaped paths of all of the .zip files.</span></span> <span data-ttu-id="0e11f-178">I file zip non sono necessariamente nel FILE: namespace e possono essere un URL di tipo MAPI che punta a un file con estensione zip come allegato, ad esempio.</span><span class="sxs-lookup"><span data-stu-id="0e11f-178">Those .zip files are not necessarily in the FILE: namespace and could be a MAPI type URL that points to a .zip file as an attachment, for example.</span></span>

<span data-ttu-id="0e11f-179">**Per registrare una radice come pagina iniziale:**</span><span class="sxs-lookup"><span data-stu-id="0e11f-179">**To register a root as a start page:**</span></span>

1.  <span data-ttu-id="0e11f-180">Registrare una radice, ad esempio zip:///, come pagina iniziale in modo che tutti i file con estensione zip partano, in effetti.</span><span class="sxs-lookup"><span data-stu-id="0e11f-180">Register a root such as .zip:/// as a start page so that all .zip files start there, in effect.</span></span> <span data-ttu-id="0e11f-181">Quando si elabora l'URL root. zip:, il gestore di protocollo deve generare l'elenco di URL figlio da emettere eseguendo una query su ricerca di Windows per tutti gli URL con System. FileExtension = ". zip".</span><span class="sxs-lookup"><span data-stu-id="0e11f-181">When processing the root .zip: URL, your protocol handler should generate the list of child URLs to emit by querying Windows Search for all of the URLs with System.FileExtension = ".zip".</span></span>
2.  <span data-ttu-id="0e11f-182">Eseguire l'escape degli URL per rimuovere le barre e restituirle come URL figlio.</span><span class="sxs-lookup"><span data-stu-id="0e11f-182">Escape those URLs to remove the slashes and return them as child URLs.</span></span> <span data-ttu-id="0e11f-183">Una query di esempio per recuperare i tipi desiderati potrebbe avere un aspetto simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="0e11f-183">An example query to retrieve the types you want might look as follows.</span></span>

    ``` syntax
    SELECT system.itemurl, System.DateModified FROM SystemIndex 
    WHERE System.FileExtension='.zip' OR System.MimeType='mimetypefor.zip'
    ```

3.  <span data-ttu-id="0e11f-184">Quando Windows Search esegue periodicamente una ricerca per indicizzazione incrementale sull'URL radice. zip:///, è necessario rispecchiare l'elenco di URL che Windows Search sta già gestendo con URL. zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-184">When Windows Search periodically does an incremental crawl on your .zip:/// root URL, you must reflect back the list of URLs that Windows Search is already maintaining that are .zip URLs.</span></span> <span data-ttu-id="0e11f-185">Se un'eliminazione viene individuata nell'archivio nativo in cui è archiviato il file zip, non viene visualizzata nell'enumerazione e il ramo dell'albero nel file zip viene rimosso.</span><span class="sxs-lookup"><span data-stu-id="0e11f-185">If a deletion is discovered in the native store where the .zip file is stored, it does not appear in your enumeration, and that branch of the tree in the .zip is removed.</span></span>
4.  <span data-ttu-id="0e11f-186">Per eseguire il binding ai dati con estensione zip per un altro gestore di protocollo, è consigliabile passare attraverso la [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) per l'URL per l'associazione all'archiviazione dell'oggetto e non presupporre che si tratta sempre di un file.</span><span class="sxs-lookup"><span data-stu-id="0e11f-186">To bind to the .zip data for another protocol handler, you should ideally go through the [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) for that URL to bind to the storage of the object, and not assume it is always a file.</span></span> <span data-ttu-id="0e11f-187">In questo modo si garantisce la flessibilità necessaria per lavorare con gli allegati negli archivi di posta elettronica, ad esempio.</span><span class="sxs-lookup"><span data-stu-id="0e11f-187">Doing so affords you the flexibility to work with attachments in mail stores, for example.</span></span>
5.  <span data-ttu-id="0e11f-188">Quando si creano URL figlio per ogni file con estensione zip, è necessario usare PKEY \_ Search \_ UrlToIndexWithModificationTime ([System. search. UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) per passare pkey \_ DateModified ([System. DateModified](../properties/props-system-datemodified.md)) del file con estensione zip effettivo, in modo che l'indicizzatore indicizzazione del file con estensione zip solo se è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="0e11f-188">When emitting child URLs for each .zip file, you should use PKEY\_Search\_UrlToIndexWithModificationTime ([System.Search.UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) to pass PKEY\_DateModified ([System.DateModified](../properties/props-system-datemodified.md)) of the actual .zip file so that the indexer crawls the .zip file only if it has changed.</span></span>

<span data-ttu-id="0e11f-189">Per eseguire l'indicizzazione degli URL. zip immediatamente dopo la creazione o la modifica e non è necessario attendere la ricerca di una ricerca per indicizzazione incrementale per individuare il nuovo stato, è possibile monitorare il file system per le modifiche del file con estensione zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-189">To have your .zip URLs indexed immediately after they are created or modified, and not have to wait for an incremental crawl to discover their new state, you could conceivably monitor the file system yourself for .zip file changes.</span></span> <span data-ttu-id="0e11f-190">Questo approccio, tuttavia, non funziona per altri archivi dati, ad esempio MAPI.</span><span class="sxs-lookup"><span data-stu-id="0e11f-190">However, such an approach would not work for other data stores such as MAPI.</span></span>

<span data-ttu-id="0e11f-191">**Per indicizzare gli URL con estensione zip quando vengono creati o modificati:**</span><span class="sxs-lookup"><span data-stu-id="0e11f-191">**To have your .zip urls indexed when they are created or modified:**</span></span>

1.  <span data-ttu-id="0e11f-192">Creare un filtro (e l'implementazione dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) per il tipo di file zip.</span><span class="sxs-lookup"><span data-stu-id="0e11f-192">Create a filter (and implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) for the .zip file type.</span></span> <span data-ttu-id="0e11f-193">Per altre informazioni, vedere [sviluppo di gestori di proprietà per la ricerca di Windows](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="0e11f-193">For more information, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>
2.  <span data-ttu-id="0e11f-194">Ogni volta che l'implementazione di [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) viene chiamata, è perché tale URL è stato individuato o modificato.</span><span class="sxs-lookup"><span data-stu-id="0e11f-194">Whenever your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation is called, it is because that URL has been discovered or changed.</span></span> <span data-ttu-id="0e11f-195">Generare quindi un evento per l'URL. zip appropriato per l'URL di origine tramite l'interfaccia [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="0e11f-195">Then, generate an event for the .zip URL appropriate for the source URL, through the [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) interface.</span></span> <span data-ttu-id="0e11f-196">Questa operazione consente di indicare immediatamente all'indicizzatore che sono presenti nuovi dati da indicizzare senza dover attendere la ricerca per indicizzazione incrementale.</span><span class="sxs-lookup"><span data-stu-id="0e11f-196">Doing so gives you the ability to immediately tell the indexer that there is new data to be indexed without having to wait for the incremental crawl.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0e11f-197">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0e11f-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0e11f-198">Sviluppo di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-198">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)
</dt> <dt>

[<span data-ttu-id="0e11f-199">Installazione e registrazione di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-199">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="0e11f-200">Notifica dell'indice delle modifiche</span><span class="sxs-lookup"><span data-stu-id="0e11f-200">Notifying the Index of Changes</span></span>](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="0e11f-201">Aggiunta di icone e menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="0e11f-201">Adding Icons and Context Menus</span></span>](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="0e11f-202">Esempio di codice: estensioni della Shell per i gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-202">Code Sample: Shell Extensions for Protocol Handlers</span></span>](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[<span data-ttu-id="0e11f-203">Installazione e registrazione di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-203">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="0e11f-204">Creazione di un connettore di ricerca per un gestore di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-204">Creating a Search Connector for a Protocol Handler</span></span>](-search-3x-wds-ph-search-connector.md)
</dt> <dt>

[<span data-ttu-id="0e11f-205">Debug di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="0e11f-205">Debugging Protocol Handlers</span></span>](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
