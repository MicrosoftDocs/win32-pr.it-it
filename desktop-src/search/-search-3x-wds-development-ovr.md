---
description: Per indicizzare il contenuto e le proprietà dei nuovi formati di file e degli archivi dati, è necessario estendere la ricerca di Microsoft Windows con i componenti aggiuntivi.
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search come piattaforma di sviluppo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750442"
---
# <a name="windows-search-as-a-development-platform"></a><span data-ttu-id="42526-103">Windows Search come piattaforma di sviluppo</span><span class="sxs-lookup"><span data-stu-id="42526-103">Windows Search as a Development Platform</span></span>

<span data-ttu-id="42526-104">Per indicizzare il contenuto e le proprietà dei nuovi formati di file e degli archivi dati, è necessario estendere la ricerca di Microsoft Windows con i componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="42526-104">To index the contents and properties of new file formats and data stores, Microsoft Windows Search must be extended with add-ins.</span></span>

<span data-ttu-id="42526-105">Prima che uno sviluppatore di terze parti di nuovi formati di file e archivi dati possa visualizzare i formati e i negozi nei risultati della query in Esplora risorse, lo sviluppatore deve eseguire le tre operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="42526-105">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must do the following three things:</span></span>

-   <span data-ttu-id="42526-106">Implementare un'origine dati della Shell per estendere lo spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-106">Implement a Shell data source to extend the Shell namespace.</span></span>
-   <span data-ttu-id="42526-107">Esporre gli elementi in un archivio dati (se aggiungono un nuovo archivio dati, perché sarebbe necessario indicizzare).</span><span class="sxs-lookup"><span data-stu-id="42526-107">Expose items in a data store (if they are adding a new data store, because it would need to be indexed).</span></span>
-   <span data-ttu-id="42526-108">Sviluppare un gestore di protocollo in modo che Windows Search possa accedere ai dati per l'indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="42526-108">Develop a protocol handler so that Windows Search can access the data for indexing.</span></span>

<span data-ttu-id="42526-109">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="42526-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="42526-110">Per iniziare</span><span class="sxs-lookup"><span data-stu-id="42526-110">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="42526-111">Panoramica degli scenari di sviluppo della ricerca</span><span class="sxs-lookup"><span data-stu-id="42526-111">Overview of Search Development Scenarios</span></span>](#overview-of-search-development-scenarios)
    -   [<span data-ttu-id="42526-112">Aggiunta di un nuovo archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-112">Adding a New Data Store</span></span>](#adding-a-new-data-store)
    -   [<span data-ttu-id="42526-113">Aggiunta di un nuovo formato di file</span><span class="sxs-lookup"><span data-stu-id="42526-113">Adding a New File Format</span></span>](#adding-a-new-file-format)
    -   [<span data-ttu-id="42526-114">Utilizzo dei risultati di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-114">Consuming Windows Search Results</span></span>](#consuming-windows-search-results)
-   [<span data-ttu-id="42526-115">Panoramica dei gestori</span><span class="sxs-lookup"><span data-stu-id="42526-115">Overview of Handlers</span></span>](#overview-of-handlers)
-   [<span data-ttu-id="42526-116">Linee guida del programma di installazione del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="42526-116">Add-in Installer Guidelines</span></span>](#add-in-installer-guidelines)
-   [<span data-ttu-id="42526-117">Nota per gli implementatori</span><span class="sxs-lookup"><span data-stu-id="42526-117">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="42526-118">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="42526-118">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="42526-119">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="42526-119">Related topics</span></span>](#related-topics)

## <a name="getting-started"></a><span data-ttu-id="42526-120">Introduzione</span><span class="sxs-lookup"><span data-stu-id="42526-120">Getting Started</span></span>

<span data-ttu-id="42526-121">Prima di iniziare a creare un'applicazione Windows Search, tenere presente che il modo migliore per eseguire questa operazione consiste nell'usare un'origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-121">Before you start creating a Windows Search application, remember that the preferred way to do it is through a Shell data source.</span></span> <span data-ttu-id="42526-122">Un'origine dati della shell estende lo spazio dei nomi della shell ed espone gli elementi in un archivio dati.</span><span class="sxs-lookup"><span data-stu-id="42526-122">A Shell data source extends the Shell namespace and exposes the items in a data store.</span></span> <span data-ttu-id="42526-123">Gli elementi nell'archivio dati possono quindi essere indicizzati dal sistema di ricerca Windows utilizzando un gestore di protocollo.</span><span class="sxs-lookup"><span data-stu-id="42526-123">The items in the data store can then be indexed by the Windows Search system by using a protocol handler.</span></span> <span data-ttu-id="42526-124">Questo approccio indiretto per l'accesso a Windows Search mediante l'implementazione di un'origine dati Shell è preferibile perché consente l'accesso alle funzionalità complete della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-124">This indirect approach for accessing Windows Search by implementing a Shell data source is preferred because it provides access to full Shell functionality.</span></span> <span data-ttu-id="42526-125">In questo modo si garantisce un'esperienza utente ragionevole.</span><span class="sxs-lookup"><span data-stu-id="42526-125">Doing it this way ensures a reasonable user experience.</span></span>

<span data-ttu-id="42526-126">Se si desidera che i risultati della query vengano visualizzati in Esplora risorse, è necessario implementare un'origine dati della shell prima di poter creare un gestore di protocollo per estendere l'indice.</span><span class="sxs-lookup"><span data-stu-id="42526-126">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="42526-127">Tuttavia, se tutte le query saranno programmatiche (tramite OLE DB ad esempio) e interpretate dal codice dell'applicazione invece che dalla shell, lo spazio dei nomi della shell è comunque preferibile ma non obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="42526-127">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="42526-128">Un gestore di protocollo è necessario per Windows per ottenere informazioni sul contenuto dei file, ad esempio elementi nei database o tipi di file personalizzati.</span><span class="sxs-lookup"><span data-stu-id="42526-128">A protocol handler is required for Windows to obtain knowledge of file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="42526-129">Sebbene Windows Search possa indicizzare il nome e le proprietà del file, Windows non è in grado di conoscere il contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="42526-129">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="42526-130">Di conseguenza, tali elementi non possono essere indicizzati o esposti nella shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="42526-130">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="42526-131">Implementando un gestore di protocollo personalizzato, è possibile esporre questi elementi.</span><span class="sxs-lookup"><span data-stu-id="42526-131">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="42526-132">Per un elenco di gestori identificato dallo scenario di sviluppo che si sta tentando di ottenere, vedere [Cenni preliminari sui gestori](#overview-of-handlers).</span><span class="sxs-lookup"><span data-stu-id="42526-132">For a list of handlers identified by the developer scenario you are trying to achieve, see [Overview of Handlers](#overview-of-handlers).</span></span>

## <a name="overview-of-search-development-scenarios"></a><span data-ttu-id="42526-133">Panoramica degli scenari di sviluppo della ricerca</span><span class="sxs-lookup"><span data-stu-id="42526-133">Overview of Search Development Scenarios</span></span>

<span data-ttu-id="42526-134">Gli scenari di sviluppo più comuni in ricerca di Windows sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="42526-134">The most common development scenarios in Windows Search are:</span></span>

-   [<span data-ttu-id="42526-135">Aggiunta di un nuovo archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-135">Adding a new data store</span></span>](#adding-a-new-data-store)
-   [<span data-ttu-id="42526-136">Aggiunta di un nuovo formato di file</span><span class="sxs-lookup"><span data-stu-id="42526-136">Adding a new file format</span></span>](#adding-a-new-file-format)
-   [<span data-ttu-id="42526-137">Utilizzo dei risultati di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-137">Consuming Windows Search results</span></span>](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a><span data-ttu-id="42526-138">Aggiunta di un nuovo archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-138">Adding a New Data Store</span></span>

<span data-ttu-id="42526-139">È necessario un archivio dati della Shell per Windows Search solo se si sta aggiungendo un nuovo archivio dati da indicizzare.</span><span class="sxs-lookup"><span data-stu-id="42526-139">You need a Shell data store for Windows Search only if you are adding a new data store to be indexed.</span></span> <span data-ttu-id="42526-140">Un archivio dati è un repository di dati che possono essere esposti al modello di programmazione della shell come contenitore usando un'origine dati della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-140">A data store is a repository of data that can be exposed to the Shell programming model as a container by using a Shell data source.</span></span> <span data-ttu-id="42526-141">Gli elementi in un archivio dati possono quindi essere indicizzati dal sistema di ricerca Windows utilizzando un gestore di protocollo.</span><span class="sxs-lookup"><span data-stu-id="42526-141">The items in a data store can then be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="42526-142">Il gestore di protocollo implementa il protocollo per l'accesso a un'origine di contenuto nel formato nativo.</span><span class="sxs-lookup"><span data-stu-id="42526-142">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="42526-143">Le interfacce [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) e [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) vengono utilizzate per implementare un gestore di protocollo personalizzato per espandere le origini dati che possono essere indicizzate.</span><span class="sxs-lookup"><span data-stu-id="42526-143">The [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <span data-ttu-id="42526-144">Per informazioni sulla creazione di un'origine dati della shell, vedere [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="42526-144">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

### <a name="adding-a-new-file-format"></a><span data-ttu-id="42526-145">Aggiunta di un nuovo formato di file</span><span class="sxs-lookup"><span data-stu-id="42526-145">Adding a New File Format</span></span>

<span data-ttu-id="42526-146">Se si aggiunge un nuovo formato di file personalizzato, è necessario sviluppare un gestore di filtro o un gestore di proprietà, ma non entrambi.</span><span class="sxs-lookup"><span data-stu-id="42526-146">If you add a new custom file format, you need to develop either a filter handler or a property handler, but not both.</span></span> <span data-ttu-id="42526-147">Un filtro è un'implementazione dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="42526-147">A filter is an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="42526-148">Apre i file di un tipo di file specifico e filtra le proprietà e i blocchi di testo per l'indicizzatore.</span><span class="sxs-lookup"><span data-stu-id="42526-148">It opens files of a particular file type, and filters properties and chunks of text for the indexer.</span></span> <span data-ttu-id="42526-149">I filtri sono associati ai tipi di file, come indicato dalle estensioni dei nomi di file, dai tipi MIME o dagli identificatori di classe (CLSID).</span><span class="sxs-lookup"><span data-stu-id="42526-149">Filters are associated with file types, as denoted by file name extensions, MIME types, or class identifiers (CLSIDs).</span></span> <span data-ttu-id="42526-150">Sebbene un filtro sia in grado di gestire più tipi di file, ogni tipo di file funziona con un solo filtro.</span><span class="sxs-lookup"><span data-stu-id="42526-150">Although one filter can handle multiple file types, each file type works with only one filter.</span></span>

<span data-ttu-id="42526-151">Un gestore proprietà converte i dati archiviati in un file in uno schema strutturato riconosciuto da e accessibile da Esplora risorse, Windows Search e altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="42526-151">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="42526-152">Questi sistemi possono quindi interagire con il gestore delle proprietà per scrivere e leggere le proprietà in e da un file.</span><span class="sxs-lookup"><span data-stu-id="42526-152">These systems can then interact with the property handler to write and read properties to and from a file.</span></span> <span data-ttu-id="42526-153">I dati tradotti includono la visualizzazione dettagli, infotip, il riquadro dettagli, le pagine delle proprietà e così via.</span><span class="sxs-lookup"><span data-stu-id="42526-153">The translated data includes details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="42526-154">Ogni gestore di proprietà è associato a un particolare tipo di file, identificato dall'estensione del nome file.</span><span class="sxs-lookup"><span data-stu-id="42526-154">Each property handler is associated with a particular file type, identified by the file name extension.</span></span> <span data-ttu-id="42526-155">È necessario un gestore proprietà per eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="42526-155">You need a property handler to do the following:</span></span>

-   <span data-ttu-id="42526-156">Mostra le proprietà degli elementi non indicizzati nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="42526-156">Show non-indexed item properties in the UI.</span></span>
-   <span data-ttu-id="42526-157">Supporto per la scrittura di proprietà.</span><span class="sxs-lookup"><span data-stu-id="42526-157">Support writing properties.</span></span>

### <a name="consuming-windows-search-results"></a><span data-ttu-id="42526-158">Utilizzo dei risultati di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-158">Consuming Windows Search Results</span></span>

<span data-ttu-id="42526-159">Le sezioni seguenti descrivono diversi modi per l'utilizzo dei risultati di Windows Search:</span><span class="sxs-lookup"><span data-stu-id="42526-159">The following sections describe several ways of consuming Windows Search results:</span></span>

-   [<span data-ttu-id="42526-160">Esecuzione di query sui dati</span><span class="sxs-lookup"><span data-stu-id="42526-160">Querying data</span></span>](#querying-data)
-   [<span data-ttu-id="42526-161">Esecuzione di query su archivi dati remoti (ricerca federata)</span><span class="sxs-lookup"><span data-stu-id="42526-161">Querying remote data stores (Federated Search)</span></span>](#querying-remote-data-stores-federated-search)
-   [<span data-ttu-id="42526-162">Indicizzazione di file ed elementi</span><span class="sxs-lookup"><span data-stu-id="42526-162">Indexing files and items</span></span>](#indexing-files-and-items)
-   [<span data-ttu-id="42526-163">Indicizzazione di un archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-163">Indexing a data store</span></span>](#indexing-a-data-store)
-   [<span data-ttu-id="42526-164">Gestione del processo di indicizzazione</span><span class="sxs-lookup"><span data-stu-id="42526-164">Managing the indexing process</span></span>](#managing-the-indexing-process)
-   [<span data-ttu-id="42526-165">Integrazione del sistema di proprietà di Windows con le applicazioni di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-165">Integrating the Windows Property System with Windows Search applications</span></span>](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a><span data-ttu-id="42526-166">Esecuzione di query su dati</span><span class="sxs-lookup"><span data-stu-id="42526-166">Querying Data</span></span>

<span data-ttu-id="42526-167">Gli sviluppatori che scrivono applicazioni su Windows Search combinato e il sistema di proprietà Windows possono accedere ai file e agli elementi indipendentemente dall'applicazione o dal tipo di file.</span><span class="sxs-lookup"><span data-stu-id="42526-167">Developers writing applications on top of the combined Windows Search and Windows property system can access files and items regardless of application or file type.</span></span> <span data-ttu-id="42526-168">Esistono due modi per accedere alle applicazioni ai dati dell'indicizzatore:</span><span class="sxs-lookup"><span data-stu-id="42526-168">There are two ways for applications to access the indexer data:</span></span>

-   <span data-ttu-id="42526-169">Le applicazioni comunicano direttamente con OLE DB inviando query di Windows Search Structured Query Language (SQL) al provider di OLE DB Windows Search per recuperare i risultati.</span><span class="sxs-lookup"><span data-stu-id="42526-169">Applications communicate directly with OLE DB by sending Windows Search Structured Query Language (SQL) queries to the Windows Search OLE DB provider to retrieve results.</span></span> <span data-ttu-id="42526-170">Le query possono essere costruite manualmente o usando l'interfaccia [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) per generare le parole chiave di ricerca SQL da e la sintassi di query avanzata (AQS).</span><span class="sxs-lookup"><span data-stu-id="42526-170">Queries can be constructed manually or by using the [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) interface to generate the SQL from search keywords, and Advanced Query Syntax (AQS).</span></span>
-   <span data-ttu-id="42526-171">Le applicazioni utilizzano il livello della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-171">Applications work through the Shell layer.</span></span> <span data-ttu-id="42526-172">Il vantaggio del livello della shell è che supporta anche altre origini, ad esempio grep.</span><span class="sxs-lookup"><span data-stu-id="42526-172">The advantage of the Shell layer is that it also supports other sources like grep.</span></span> <span data-ttu-id="42526-173">Tuttavia, lo svantaggio è che non tutte le funzionalità dell'indicizzatore sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="42526-173">However, the disadvantage is that not all indexer features are available.</span></span>

<span data-ttu-id="42526-174">Un'altra opzione consiste nell'usare i protocolli search-ms://e search://, che eseguono ricerche basate su URL visualizzate tramite Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="42526-174">Another option is using the search-ms:// and search:// protocols, which execute URL-based searches rendered through Windows Explorer.</span></span> <span data-ttu-id="42526-175">Questa opzione consente lo sviluppo più chiaro ma non restituisce risultati o selezioni utente dalla visualizzazione risultati all'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="42526-175">This option enables the lightest-weight development but does not return results or user selections from the results view to the calling application.</span></span> <span data-ttu-id="42526-176">Inoltre, analogamente ad altri protocolli, le applicazioni di ricerca di terze parti possono assumere i protocolli search-ms://e search://se le applicazioni sono conformi al set di funzionalità richiesto.</span><span class="sxs-lookup"><span data-stu-id="42526-176">Also, like other protocols, third-party search applications can take over the search-ms:// and search:// protocols if the applications conform to the required feature set.</span></span> <span data-ttu-id="42526-177">Per altre informazioni sull'esecuzione di query, vedere [esecuzione di query nel processo di ricerca di Windows](querying-process--windows-search-.md) ed [esecuzione di query sull'indice a livello di codice](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="42526-177">For more information on querying, see [Querying Process in Windows Search](querying-process--windows-search-.md) and [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

### <a name="querying-remote-data-stores-federated-search"></a><span data-ttu-id="42526-178">Esecuzione di query su archivi dati remoti (ricerca federata)</span><span class="sxs-lookup"><span data-stu-id="42526-178">Querying Remote Data Stores (Federated Search)</span></span>

<span data-ttu-id="42526-179">In Windows 7 e versioni successive, la ricerca federata offre un nuovo provider di ricerca che esegue query negli archivi dati remoti tramite server Web, tramite il protocollo [OpenSearch](https://github.com/dewitt/opensearch) ed enumera i risultati come feed RSS o Atom XML.</span><span class="sxs-lookup"><span data-stu-id="42526-179">In Windows 7 and later, federated search offers a new search provider that queries remote data stores through web servers, through the [OpenSearch](https://github.com/dewitt/opensearch) protocol, and enumerates the results as RSS or Atom XML feeds.</span></span> <span data-ttu-id="42526-180">I connettori di ricerca sono giunzioni dello spazio dei nomi che simulano il comportamento delle cartelle tramite un provider di ricerca.</span><span class="sxs-lookup"><span data-stu-id="42526-180">Search Connectors are namespace junctions that simulate folder behavior by using a search provider.</span></span> <span data-ttu-id="42526-181">Per ulteriori informazioni sulla Federazione di ricerca negli archivi dati remoti in Windows 7, vedere [ricerca federata in Windows](-search-federated-search-overview.md).</span><span class="sxs-lookup"><span data-stu-id="42526-181">For more information about search federation to remote data stores in Windows 7, see [Federated Search in Windows](-search-federated-search-overview.md).</span></span>

### <a name="indexing-files-and-items"></a><span data-ttu-id="42526-182">Indicizzazione di file ed elementi</span><span class="sxs-lookup"><span data-stu-id="42526-182">Indexing Files and Items</span></span>

<span data-ttu-id="42526-183">Il contenuto indicizzato è basato sul file e sui tipi di dati supportati tramite i componenti aggiuntivi inclusi nella ricerca di Windows e le regole di inclusione ed esclusione predefinite per le cartelle nel file system.</span><span class="sxs-lookup"><span data-stu-id="42526-183">The content that is indexed is based on the file and data types supported through add-ins included with Windows Search and the default inclusion and exclusion rules for folders in the file system.</span></span> <span data-ttu-id="42526-184">Ad esempio, i filtri inclusi in ricerca finestre supportano più di 200 tipi di dati comuni, inclusi Microsoft Office documenti, posta elettronica Microsoft Outlook (insieme al gestore del protocollo MAPI), file di testo normale, HTML e molti altri.</span><span class="sxs-lookup"><span data-stu-id="42526-184">For example, the filters included in Window Search support over 200 common types of data, including Microsoft Office documents, Microsoft Outlook email (in conjunction with the MAPI protocol handler), plain-text files, HTML, and many more.</span></span> <span data-ttu-id="42526-185">Per un elenco completo dei tipi di file supportati in modo nativo, vedere [che cosa è incluso nell'indice](-search-3x-wds-included-in-index.md).</span><span class="sxs-lookup"><span data-stu-id="42526-185">For a full list of file types natively supported, see [What Is Included in the Index](-search-3x-wds-included-in-index.md).</span></span>

<span data-ttu-id="42526-186">L'indice può essere esteso con gestori di proprietà e filtri per esporre il contenuto e le proprietà dei nuovi formati di file nell'indice e in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="42526-186">The index can be extended with property handlers and filters to expose the content and properties of new file formats to the index and Windows Explorer.</span></span> <span data-ttu-id="42526-187">I filtri sono un'implementazione dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="42526-187">Filters are an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="42526-188">Esistono due tipi di filtri: uno che interagisce con singoli elementi, ad esempio i file e uno che interagisce con i contenitori, ad esempio le cartelle.</span><span class="sxs-lookup"><span data-stu-id="42526-188">There are two kinds of filters: one that interacts with individual items such as files and one that interacts with containers such as folders.</span></span> <span data-ttu-id="42526-189">I filtri sono multiscopo in quanto supportano la suddivisione in blocchi di dati, contenuto di testo, alcune proprietà e più lingue.</span><span class="sxs-lookup"><span data-stu-id="42526-189">Filters are multi-purpose in that they support chunking data, text content, some properties, and multiple languages.</span></span>

<span data-ttu-id="42526-190">Al contrario, i gestori delle proprietà hanno uno scopo più specifico: esporre le proprietà dei tipi di file specifici identificati dalle estensioni di file.</span><span class="sxs-lookup"><span data-stu-id="42526-190">In contrast, property handlers have a more specific purpose: to expose the properties of specific file types that are identified by file name extensions.</span></span> <span data-ttu-id="42526-191">Un gestore di proprietà per un tipo di file può abilitare le proprietà Get e set e può enumerare le proprietà associate al tipo di file.</span><span class="sxs-lookup"><span data-stu-id="42526-191">A property handler for a file type can enable get and set properties, and can enumerate the properties associated with that file type.</span></span> <span data-ttu-id="42526-192">A differenza dei filtri, i gestori di proprietà non supportano il mandrino di dati o il contenuto di testo e i gestori di proprietà non hanno modo di indicare la lingua in cui si trova una proprietà di testo, a meno che non supportino la scrittura delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="42526-192">Unlike filters, property handlers do not support chucking data or text content, and property handlers have no way of indicating what language a text property is in unless they support writing properties.</span></span>

### <a name="indexing-a-data-store"></a><span data-ttu-id="42526-193">Indicizzazione di un archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-193">Indexing a Data Store</span></span>

<span data-ttu-id="42526-194">L'indice può essere esteso con i gestori di protocollo per fornire l'accesso agli archivi dati proprietari.</span><span class="sxs-lookup"><span data-stu-id="42526-194">The index can be extended with protocol handlers to provide access to proprietary data stores.</span></span> <span data-ttu-id="42526-195">Ad esempio, i file e gli elementi contenuti in archivi dati non di file System, ad esempio database e archivi di posta elettronica, richiedono un gestore di protocollo per eseguire il mapping da un URL a un flusso.</span><span class="sxs-lookup"><span data-stu-id="42526-195">For example, files and items contained in non-file-system data stores (such as databases and email stores) require a protocol handler to map from a URL to a stream.</span></span> <span data-ttu-id="42526-196">I gestori di protocollo possono anche determinare facoltativamente i filtri corretti da usare per l'estrazione di informazioni da un flusso.</span><span class="sxs-lookup"><span data-stu-id="42526-196">Protocol handlers can also optionally determine the correct filters to use for extracting information from a stream.</span></span> <span data-ttu-id="42526-197">I filtri enumerano gli URL dell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="42526-197">Filters enumerate the data store URLs.</span></span> <span data-ttu-id="42526-198">Gli elementi vengono quindi indicizzati singolarmente tramite il filtro e/o il gestore di proprietà appropriati.</span><span class="sxs-lookup"><span data-stu-id="42526-198">The items are then individually indexed using the proper filter and/or property handler.</span></span> <span data-ttu-id="42526-199">Per ulteriori informazioni, vedere [estensione dell'indice](-search-3x-wds-extidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="42526-199">For more information, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

### <a name="managing-the-indexing-process"></a><span data-ttu-id="42526-200">Gestione del processo di indicizzazione</span><span class="sxs-lookup"><span data-stu-id="42526-200">Managing the Indexing Process</span></span>

<span data-ttu-id="42526-201">Gli sviluppatori di applicazioni possono controllare l'ambito e la frequenza dell'indicizzazione di Windows Search usando varie interfacce di gestione.</span><span class="sxs-lookup"><span data-stu-id="42526-201">Application developers can control the scope and frequency of Windows Search indexing by using various management interfaces.</span></span> <span data-ttu-id="42526-202">Queste interfacce includono funzionalità per aggiungere e rimuovere le directory di cui l'indicizzatore Cerca le modifiche, notificare manualmente l'indice delle modifiche ai dati, verificare lo stato dell'indicizzatore e forzare nuovamente l'indicizzazione di alcuni o tutti i dati.</span><span class="sxs-lookup"><span data-stu-id="42526-202">These interfaces include functionality to add and remove the directories that the indexer scans for changes, manually notify the index of changes to data, check the status of the indexer, and force re-indexing of some or all data.</span></span> <span data-ttu-id="42526-203">Per altre informazioni, vedere [Managing the index](-search-3x-wds-mngidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="42526-203">For more information, see [Managing the Index](-search-3x-wds-mngidx-overview.md).</span></span>

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a><span data-ttu-id="42526-204">Integrazione del sistema di proprietà di Windows con le applicazioni di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-204">Integrating the Windows Property System with Windows Search Applications</span></span>

<span data-ttu-id="42526-205">Il sistema di proprietà di Windows è un sistema di lettura/scrittura estendibile di definizioni dei dati che fornisce un modo uniforme per esprimere i metadati sugli elementi della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-205">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="42526-206">Il sistema di proprietà di Windows in Windows Vista e versioni successive consente di archiviare e recuperare metadati per gli elementi della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-206">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="42526-207">Un elemento della shell è costituito da qualsiasi singolo contenuto, ad esempio un file, una cartella, un messaggio di posta elettronica o un contatto.</span><span class="sxs-lookup"><span data-stu-id="42526-207">A Shell item is any single piece of content, such as a file, folder, email or contact.</span></span> <span data-ttu-id="42526-208">Una proprietà è una singola parte di metadati associata a un elemento della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-208">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="42526-209">I valori delle proprietà vengono espressi come una struttura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="42526-209">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="42526-210">Viene incluso un elenco completo di proprietà comuni per diversi tipi di elemento comuni, ad esempio foto, musica, documenti, messaggi, contatti e file.</span><span class="sxs-lookup"><span data-stu-id="42526-210">An extensive list of common properties is included for a number of common item types such as photos, music, documents, messages, contacts, and files.</span></span> <span data-ttu-id="42526-211">Gli sviluppatori possono anche introdurre le proprie proprietà sulla piattaforma se nessuna proprietà esistente soddisfa le proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="42526-211">Developers can also introduce their own properties to the platform if no existing property meets their needs.</span></span> <span data-ttu-id="42526-212">Per ulteriori informazioni sull'integrazione di applicazioni con il sistema di proprietà di Windows, vedere [sviluppo di gestori di proprietà](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="42526-212">For more information on integrating applications with the Windows property system, see [Developing Property Handlers](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="overview-of-handlers"></a><span data-ttu-id="42526-213">Panoramica dei gestori</span><span class="sxs-lookup"><span data-stu-id="42526-213">Overview of Handlers</span></span>

<span data-ttu-id="42526-214">Un gestore è un oggetto Component Object Model (COM) che fornisce la funzionalità per un elemento della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-214">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="42526-215">La maggior parte delle origini dati della Shell offre un sistema estensibile per l'associazione di gestori agli elementi.</span><span class="sxs-lookup"><span data-stu-id="42526-215">Most Shell data sources offer an extensible system for binding handlers to items.</span></span> <span data-ttu-id="42526-216">Ad esempio, la cartella file system usa il sistema di associazione per cercare i gestori per un tipo di file specifico.</span><span class="sxs-lookup"><span data-stu-id="42526-216">For example, the file system folder uses the association system to look up the handlers for a particular file type.</span></span> <span data-ttu-id="42526-217">Per ogni tipo di file è necessario un gestore specifico.</span><span class="sxs-lookup"><span data-stu-id="42526-217">A specific handler is required for every file type.</span></span> <span data-ttu-id="42526-218">Per il tipo di file Adobe Acrobat. pdf è necessario un gestore di filtri, ad esempio, per il formato di file doc è necessario un altro gestore di filtro e così via.</span><span class="sxs-lookup"><span data-stu-id="42526-218">One filter handler is required for the Adobe Acrobat .pdf file type, for example, another filter handler is required for the .doc file format, and so forth.</span></span>

<span data-ttu-id="42526-219">Gestori diversi hanno alcune comunanze.</span><span class="sxs-lookup"><span data-stu-id="42526-219">Different handlers have some commonality.</span></span> <span data-ttu-id="42526-220">In Windows Vista e versioni successive, tutti i gestori devono usare una delle interfacce seguenti per inizializzare il gestore: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)o [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span><span class="sxs-lookup"><span data-stu-id="42526-220">In Windows Vista and later, all handlers must use one of the following interfaces to initialize the handler: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem), or [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span></span>

<span data-ttu-id="42526-221">Nella tabella seguente sono elencate le attività di alto livello per gli sviluppatori, il tipo di gestore necessario per ogni attività e viene fornito un collegamento alle informazioni concettuali su come eseguire ogni attività.</span><span class="sxs-lookup"><span data-stu-id="42526-221">The following table lists high-level developer tasks, the type of handler needed for each task, and provides a link to conceptual information about how to perform each task.</span></span>



| <span data-ttu-id="42526-222">Attività</span><span class="sxs-lookup"><span data-stu-id="42526-222">Task</span></span>                                                                                                                                                            | <span data-ttu-id="42526-223">Gestore</span><span class="sxs-lookup"><span data-stu-id="42526-223">Handler</span></span>                          | <span data-ttu-id="42526-224">Informazioni concettuali</span><span class="sxs-lookup"><span data-stu-id="42526-224">Conceptual information</span></span>                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="42526-225">Accesso alle proprietà di un file per l'indicizzazione</span><span class="sxs-lookup"><span data-stu-id="42526-225">Accessing the properties of a file for indexing</span></span>                                                                                                                 | <span data-ttu-id="42526-226">Gestore proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-226">Property handler</span></span>                 | [<span data-ttu-id="42526-227">Sviluppo di gestori di proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-227">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/> [<span data-ttu-id="42526-228">Proprietà definite dal sistema per formati di file personalizzati</span><span class="sxs-lookup"><span data-stu-id="42526-228">System-Defined Properties for Custom File Formats</span></span>](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| <span data-ttu-id="42526-229">Aggiunta di formati degli Appunti per l'oggetto dati ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) di un elemento (gli oggetti dati vengono utilizzati negli scenari di trascinamento della selezione e di copia e incolla).</span><span class="sxs-lookup"><span data-stu-id="42526-229">Adding clipboard formats for the data object ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) of an item (Data objects are used in drag-and-drop and copy/paste scenarios.)</span></span> | <span data-ttu-id="42526-230">Gestore dell'oggetto dati</span><span class="sxs-lookup"><span data-stu-id="42526-230">Data object handler</span></span>              | <span data-ttu-id="42526-231">[Creazione di gestori di dati](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="42526-231">[Creating Data Handlers](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span></span>                                                                                                                                                          |
| <span data-ttu-id="42526-232">Aggiunta di verbi per un elemento comunemente visualizzato in un menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="42526-232">Adding verbs for an item that are commonly displayed in a shortcut menu</span></span>                                                                                         | <span data-ttu-id="42526-233">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="42526-233">Shortcut menu handler</span></span>            | [<span data-ttu-id="42526-234">Creazione di gestori di menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="42526-234">Creating Context Menu Handlers</span></span>](../shell/context-menu-handlers.md)<br/> [<span data-ttu-id="42526-235">Personalizzazione di un menu di scelta rapida tramite verbi dinamici</span><span class="sxs-lookup"><span data-stu-id="42526-235">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| <span data-ttu-id="42526-236">Associazione di un tipo di file a un'icona specifica</span><span class="sxs-lookup"><span data-stu-id="42526-236">Associating a file type with a specific icon</span></span>                                                                                                                    | <span data-ttu-id="42526-237">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="42526-237">Icon handler</span></span>                     | [<span data-ttu-id="42526-238">Creazione di gestori di icone</span><span class="sxs-lookup"><span data-stu-id="42526-238">Creating Icon Handlers</span></span>](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| <span data-ttu-id="42526-239">Creazione di finestre delle proprietà con le immagini e i controlli dell'interfaccia utente che consentono l'interazione personalizzata con un tipo di file</span><span class="sxs-lookup"><span data-stu-id="42526-239">Creating property sheets with UI pictures and controls that permit custom interaction with a file type</span></span>                                                          | <span data-ttu-id="42526-240">Gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-240">Property sheet handler</span></span>           | <span data-ttu-id="42526-241">[Gestori della finestra delle proprietà](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="42526-241">[Property Sheet Handlers](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span></span>                                                                                                                                                    |
| <span data-ttu-id="42526-242">Abilitazione di un tipo di elemento per supportare scenari di trascinamento della selezione e di copia e incolla</span><span class="sxs-lookup"><span data-stu-id="42526-242">Enabling an item type to support drag-and-drop and copy/paste scenarios</span></span>                                                                                         | <span data-ttu-id="42526-243">Gestore di trascinamento</span><span class="sxs-lookup"><span data-stu-id="42526-243">Drop handler</span></span>                     | <span data-ttu-id="42526-244">[Trasferimento di oggetti Shell con trascinamento della selezione e degli Appunti](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="42526-244">[Transferring Shell Objects with Drag-and-Drop and the Clipboard](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span></span>                                                                                                                      |
| <span data-ttu-id="42526-245">Estrazione di blocchi di proprietà Text e Document per l'indicizzazione</span><span class="sxs-lookup"><span data-stu-id="42526-245">Extracting chunks of text and document properties for indexing</span></span>                                                                                                  | <span data-ttu-id="42526-246">Gestore filtro</span><span class="sxs-lookup"><span data-stu-id="42526-246">Filter handler</span></span>                   | [<span data-ttu-id="42526-247">Sviluppo di gestori di filtri</span><span class="sxs-lookup"><span data-stu-id="42526-247">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)                                                                                                                                           |
| <span data-ttu-id="42526-248">Indicizzazione di un nuovo tipo di file</span><span class="sxs-lookup"><span data-stu-id="42526-248">Indexing a new file type</span></span>                                                                                                                                        | <span data-ttu-id="42526-249">Gestore di filtro, gestore proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-249">Filter handler, property handler</span></span> | [<span data-ttu-id="42526-250">Sviluppo di gestori di filtri</span><span class="sxs-lookup"><span data-stu-id="42526-250">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)<br/> [<span data-ttu-id="42526-251">Sviluppo di gestori di proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-251">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| <span data-ttu-id="42526-252">Indicizzazione del contenuto di un archivio dati</span><span class="sxs-lookup"><span data-stu-id="42526-252">Indexing the contents of a data store</span></span>                                                                                                                           | <span data-ttu-id="42526-253">Protocol handler</span><span class="sxs-lookup"><span data-stu-id="42526-253">Protocol handler</span></span>                 | [<span data-ttu-id="42526-254">Sviluppo di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="42526-254">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)                                                                                                                                            |
| <span data-ttu-id="42526-255">Visualizzazione in anteprima di una visualizzazione semplificata dell'elemento della shell nel riquadro di anteprima di Esplora risorse</span><span class="sxs-lookup"><span data-stu-id="42526-255">Previewing a simplified view of the Shell item in the Windows Explorer preview pane</span></span>                                                                             | <span data-ttu-id="42526-256">Gestore di anteprime</span><span class="sxs-lookup"><span data-stu-id="42526-256">Preview handler</span></span>                  | [<span data-ttu-id="42526-257">Gestori di anteprime</span><span class="sxs-lookup"><span data-stu-id="42526-257">Preview Handlers</span></span>](../shell/preview-handlers.md)                                                                                                                                                             |
| <span data-ttu-id="42526-258">Fornire il testo popup quando si passa il mouse su un oggetto dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="42526-258">Supplying pop-up text when a mouse hovers over a UI object</span></span>                                                                                                      | <span data-ttu-id="42526-259">Gestore della finestra popup</span><span class="sxs-lookup"><span data-stu-id="42526-259">Infotip handler</span></span>                  | <span data-ttu-id="42526-260">[Creazione di gestori di estensioni della shell](../shell/handlers.md) (personalizzazione infotip)</span><span class="sxs-lookup"><span data-stu-id="42526-260">[Creating Shell Extension Handlers](../shell/handlers.md) (Infotip Customization)</span></span>                                                                                                                            |
| <span data-ttu-id="42526-261">Fornire un'immagine statica per rappresentare un elemento della shell</span><span class="sxs-lookup"><span data-stu-id="42526-261">Supplying a static image to represent a Shell item</span></span>                                                                                                              | <span data-ttu-id="42526-262">Gestore anteprime</span><span class="sxs-lookup"><span data-stu-id="42526-262">Thumbnail handler</span></span>                | <span data-ttu-id="42526-263">[Gestori di anteprime](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="42526-263">[Thumbnail Handlers](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span></span>                                                                                                                                                        |



 

<span data-ttu-id="42526-264">Nella tabella seguente sono elencati i gestori e le interfacce per l'implementazione di ogni tipo di gestore.</span><span class="sxs-lookup"><span data-stu-id="42526-264">The following table lists handlers and the interfaces for implementing each type of handler.</span></span>



| <span data-ttu-id="42526-265">Gestore</span><span class="sxs-lookup"><span data-stu-id="42526-265">Handler</span></span>                | <span data-ttu-id="42526-266">Interfacce</span><span class="sxs-lookup"><span data-stu-id="42526-266">Interfaces</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="42526-267">Gestore di trascinamento</span><span class="sxs-lookup"><span data-stu-id="42526-267">Drop handler</span></span>           | <span data-ttu-id="42526-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="42526-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="42526-269">Gestore dell'oggetto dati</span><span class="sxs-lookup"><span data-stu-id="42526-269">Data object handler</span></span>    | <span data-ttu-id="42526-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="42526-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span>                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="42526-271">Gestore filtro</span><span class="sxs-lookup"><span data-stu-id="42526-271">Filter handler</span></span>         | [<span data-ttu-id="42526-272">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="42526-272">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="42526-273">Gestore icone</span><span class="sxs-lookup"><span data-stu-id="42526-273">Icon handler</span></span>           | [<span data-ttu-id="42526-274">**IExtractIcon**</span><span class="sxs-lookup"><span data-stu-id="42526-274">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> <span data-ttu-id="42526-275">Facoltativo: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="42526-275">Optional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span><br/>                                                                                                                                                                                                                                 |
| <span data-ttu-id="42526-276">Gestore della finestra popup</span><span class="sxs-lookup"><span data-stu-id="42526-276">Infotip handler</span></span>        | [<span data-ttu-id="42526-277">**IQueryInfo**</span><span class="sxs-lookup"><span data-stu-id="42526-277">**IQueryInfo**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="42526-278">Gestore di anteprime</span><span class="sxs-lookup"><span data-stu-id="42526-278">Preview handler</span></span>        | [<span data-ttu-id="42526-279">**IPreviewHandler**</span><span class="sxs-lookup"><span data-stu-id="42526-279">**IPreviewHandler**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="42526-280">Gestore proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-280">Property handler</span></span>       | [<span data-ttu-id="42526-281">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="42526-281">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="42526-282">Protocol handler</span><span class="sxs-lookup"><span data-stu-id="42526-282">Protocol handler</span></span>       | <span data-ttu-id="42526-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span><span class="sxs-lookup"><span data-stu-id="42526-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span></span><br/> <span data-ttu-id="42526-284">Facoltativo: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span><span class="sxs-lookup"><span data-stu-id="42526-284">Optional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span></span><br/> |
| <span data-ttu-id="42526-285">Gestore della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="42526-285">Property sheet handler</span></span> | <span data-ttu-id="42526-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [ **IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span><span class="sxs-lookup"><span data-stu-id="42526-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span></span>                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="42526-287">Gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="42526-287">Shortcut menu handler</span></span>  | <span data-ttu-id="42526-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="42526-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="42526-289">Gestore anteprime</span><span class="sxs-lookup"><span data-stu-id="42526-289">Thumbnail handler</span></span>      | [<span data-ttu-id="42526-290">**IThumbnailProvider**</span><span class="sxs-lookup"><span data-stu-id="42526-290">**IThumbnailProvider**</span></span>](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> <span data-ttu-id="42526-291">Un gestore di proprietà è talvolta kown come gestore di metadati.</span><span class="sxs-lookup"><span data-stu-id="42526-291">A property handler is sometimes kown as a metadata handler.</span></span> <span data-ttu-id="42526-292">Un'origine dati della shell è talvolta nota come estensione dello spazio dei nomi della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-292">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="42526-293">Un gestore di tipi di file è talvolta noto come gestore di estensione della shell o estensione della shell.</span><span class="sxs-lookup"><span data-stu-id="42526-293">A file type handler is sometimes known as a Shell extension handler or a Shell extension.</span></span>

 

<span data-ttu-id="42526-294">Per ulteriori informazioni sulla creazione di gestori, vedere [creazione di gestori di estensioni shell](../shell/handlers.md).</span><span class="sxs-lookup"><span data-stu-id="42526-294">For more information about creating handlers, see [Creating Shell Extension Handlers](../shell/handlers.md).</span></span> <span data-ttu-id="42526-295">Per ulteriori informazioni sulle proprietà, vedere [Windows Property System](../properties/windows-properties-system.md).</span><span class="sxs-lookup"><span data-stu-id="42526-295">For more information about properties, see [Windows Property System](../properties/windows-properties-system.md).</span></span>

## <a name="add-in-installer-guidelines"></a><span data-ttu-id="42526-296">Linee guida del programma di installazione del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="42526-296">Add-in Installer Guidelines</span></span>

<span data-ttu-id="42526-297">Quando si crea un programma di installazione di un componente aggiuntivo, attenersi alle seguenti linee guida:</span><span class="sxs-lookup"><span data-stu-id="42526-297">Use the following guidelines when creating an Add-in installer:</span></span>

-   <span data-ttu-id="42526-298">Il programma di installazione deve usare il programma di installazione EXE o MSI.</span><span class="sxs-lookup"><span data-stu-id="42526-298">The installer must use either the EXE or MSI installer.</span></span>
-   <span data-ttu-id="42526-299">È necessario fornire le note sulla versione.</span><span class="sxs-lookup"><span data-stu-id="42526-299">Release notes must be provided.</span></span>
-   <span data-ttu-id="42526-300">È necessario creare una voce di installazione **applicazioni** per ogni componente aggiuntivo installato.</span><span class="sxs-lookup"><span data-stu-id="42526-300">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="42526-301">Il programma di installazione deve assumere tutte le impostazioni del registro di sistema per il tipo di file o l'archivio specifico che il componente aggiuntivo corrente riconosce.</span><span class="sxs-lookup"><span data-stu-id="42526-301">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="42526-302">Se un componente aggiuntivo precedente viene sovrascritto, il programma di installazione deve inviare una notifica all'utente.</span><span class="sxs-lookup"><span data-stu-id="42526-302">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="42526-303">Se un componente aggiuntivo più recente ha sovrascritto un componente aggiuntivo precedente, l'utente deve essere in grado di ripristinare la funzionalità del componente aggiuntivo precedente e renderlo di nuovo il componente aggiuntivo predefinito per quel tipo di file o archivio.</span><span class="sxs-lookup"><span data-stu-id="42526-303">If a newer add-in has overwritten a previous add-in, the user should be able to restore the previous add-in's functionality and make it the default add-in again for that file type or store.</span></span>

## <a name="note-to-implementers"></a><span data-ttu-id="42526-304">Nota per gli implementatori</span><span class="sxs-lookup"><span data-stu-id="42526-304">Note to Implementers</span></span>

<span data-ttu-id="42526-305">Prima di creare un gestore di filtro o di proprietà, gli sviluppatori devono considerare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="42526-305">Before creating a filter or property handler, developers should consider the following:</span></span>

-   <span data-ttu-id="42526-306">Questi gestori sono estensioni in-process caricate in processi che non si controllano, ad esempio il processo del daemon di filtri, Esplora risorse (ricerca grep) e host di terze parti come Windows Mail.</span><span class="sxs-lookup"><span data-stu-id="42526-306">These handlers are in-process extensions that are loaded into processes that you do not control, such as the filter daemon process, Windows Explorer (grep search), and third-party hosts like Windows Mail).</span></span>
-   <span data-ttu-id="42526-307">È necessario scrivere codice sicuro sufficientemente solido da gestire forme arbitrariamente danneggiate del formato di file creato per attaccare il sistema.</span><span class="sxs-lookup"><span data-stu-id="42526-307">You must write secure code that is robust enough to handle arbitrarily corrupt forms of your file format that were created to attack the system.</span></span>
-   <span data-ttu-id="42526-308">Il componente aggiuntivo non deve perdere risorse che genereranno problemi per i processi host.</span><span class="sxs-lookup"><span data-stu-id="42526-308">Your add-in must not leak resources that will produce problems for the host processes.</span></span>
-   <span data-ttu-id="42526-309">Il componente aggiuntivo non deve arrestarsi in modo anomalo perché questo arresterà in modo anomalo anche i processi host e rallenterà il processo di filtraggio.</span><span class="sxs-lookup"><span data-stu-id="42526-309">Your add-in must not crash as this will also crash the host processes and slow down the filtering process.</span></span>
-   <span data-ttu-id="42526-310">Poiché questi gestori vengono eseguiti in un processo di sistema in background, devono essere eseguiti rapidamente con un minimo di CPU e I/O utilizzati per soddisfare i requisiti di prestazioni del sistema.</span><span class="sxs-lookup"><span data-stu-id="42526-310">Because these handlers are run in a background system process, they must perform quickly with a minimum of CPU and I/O consumed in order to meet the performance requirements of the system.</span></span>

<span data-ttu-id="42526-311">Quindi, questi componenti aggiuntivi devono essere scritti dagli sviluppatori con esperienza nella creazione di codice a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="42526-311">Thus, these add-ins should be written by developers with expertise in creating system-level code.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="42526-312">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="42526-312">Additional Resources</span></span>

-   <span data-ttu-id="42526-313">Per informazioni sulla creazione di un'origine dati della shell, vedere [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="42526-313">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>
-   <span data-ttu-id="42526-314">Per le origini dati che devono usare l'oggetto della visualizzazione cartella di sistema (DefView) predefinito della shell, vedere [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) Function e [**SFV \_ create**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span><span class="sxs-lookup"><span data-stu-id="42526-314">For data sources that need to use the Shell Default System Folder View Object (DefView), see [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) function, and [**SFV\_CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span></span> <span data-ttu-id="42526-315">Le origini dati che usano l'oggetto di visualizzazione della cartella di sistema (DefView) predefinito della shell devono implementare il set di interfacce seguente: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)e (facoltativamente) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="42526-315">Data sources that use the Shell Default System Folder View Object (DefView) must implement the following set of interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2), and (optionally) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span> <span data-ttu-id="42526-316">Se l'implementazione di **IShellFolder** non utilizza **SHCreateShellFolderView** per creare il DefView, è possibile che sia necessario [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview)per l'oggetto visualizzazione Shell.</span><span class="sxs-lookup"><span data-stu-id="42526-316">If your **IShellFolder** implementation does not use **SHCreateShellFolderView** to create the DefView, the Shell view object may need [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span></span>
-   <span data-ttu-id="42526-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) è l'interfaccia principale per i consumer dell'origine dati della shell nota come DBFolder.</span><span class="sxs-lookup"><span data-stu-id="42526-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is the primary interface for consumers of the Shell data source known as DBFolder.</span></span> <span data-ttu-id="42526-318">Per ulteriori informazioni su DBFolder, vedere la descrizione dell'analisi STR \_ \_ con \_ proprietà costante nelle chiavi di [**stringa del contesto di binding**](../shell/str-constants.md).</span><span class="sxs-lookup"><span data-stu-id="42526-318">For more information about DBFolder, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [**Bind Context String Keys**](../shell/str-constants.md).</span></span> <span data-ttu-id="42526-319">Vedere anche [array di associazioni](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) e [**IPropertySystem:: GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span><span class="sxs-lookup"><span data-stu-id="42526-319">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [**IPropertySystem::GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="42526-320">Per informazioni su OLE DB, vedere [Cenni preliminari sulla programmazione OLE DB](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span><span class="sxs-lookup"><span data-stu-id="42526-320">For information on OLE DB, see [OLE DB Programming Overview](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span></span> <span data-ttu-id="42526-321">Per informazioni sul provider di dati di .NET Framework per OLE DB, vedere la documentazione [dello spazio dei nomi System. Data. OleDb](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) .</span><span class="sxs-lookup"><span data-stu-id="42526-321">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) documentation.</span></span>
-   <span data-ttu-id="42526-322">Per bacheche dei messaggi supportati dalla community sulle tecnologie di ricerca, vedere la pagina relativa alla [ricerca nei forum](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) MSDN su Windows.</span><span class="sxs-lookup"><span data-stu-id="42526-322">For community-supported message boards on Search technologies, see [Windows: Search Forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) on MSDN.</span></span>
-   <span data-ttu-id="42526-323">Per esempi di codice correlati, vedere [esempi di codice di Windows Search](-search-samples-ovw.md).</span><span class="sxs-lookup"><span data-stu-id="42526-323">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="42526-324">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="42526-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="42526-325">Panoramica di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-325">Windows Search Overview</span></span>](-search-3x-wds-overview.md)
</dt> <dt>

[<span data-ttu-id="42526-326">Lingue supportate da Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-326">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="42526-327">Uso di codice gestito con i dati della shell e Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-327">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> <dt>

[<span data-ttu-id="42526-328">Guida per gli sviluppatori di Windows Search</span><span class="sxs-lookup"><span data-stu-id="42526-328">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
