---
description: I gestori di filtro, che sono implementazioni dell'interfaccia IFilter, analizzano i documenti per il testo e le proprietà.
ms.assetid: 2ee9ea19-ae03-4f14-8f06-f8aa670e204e
title: Informazioni sui gestori di filtro in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e49cc1d3e479ae03645665618c60a33bdcfe19ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525519"
---
# <a name="understanding-filter-handlers-in-windows-search"></a><span data-ttu-id="c7840-103">Informazioni sui gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="c7840-103">Understanding Filter Handlers in Windows Search</span></span>

<span data-ttu-id="c7840-104">I gestori di filtro, che sono implementazioni dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , analizzano i documenti per il testo e le proprietà.</span><span class="sxs-lookup"><span data-stu-id="c7840-104">Filter handlers, which are implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, scan documents for text and properties.</span></span> <span data-ttu-id="c7840-105">I gestori di filtro estraggono i blocchi di testo da questi elementi, filtrando la formattazione incorporata e mantenendo le informazioni sulla posizione del testo.</span><span class="sxs-lookup"><span data-stu-id="c7840-105">Filter handlers extract chunks of text from these items, filtering out embedded formatting and retaining information about the position of the text.</span></span> <span data-ttu-id="c7840-106">Estraggono anche i blocchi di valori, che sono proprietà del documento.</span><span class="sxs-lookup"><span data-stu-id="c7840-106">They also extract chunks of values, which are document properties.</span></span> <span data-ttu-id="c7840-107">**IFilter** è la base per la creazione di applicazioni di livello superiore, ad esempio indicizzatori di documenti e visualizzatori indipendenti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-107">**IFilter** is the foundation for building higher-level applications such as document indexers and application-independent viewers.</span></span>

<span data-ttu-id="c7840-108">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="c7840-108">This topic is organized as follows:</span></span>

- [<span data-ttu-id="c7840-109">Informazioni sull'interfaccia IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-109">About the IFilter Interface</span></span>](#about-the-ifilter-interface)
  - [<span data-ttu-id="c7840-110">Processo di isolamento</span><span class="sxs-lookup"><span data-stu-id="c7840-110">Isolation Process</span></span>](#isolation-process)
  - [<span data-ttu-id="c7840-111">Dll IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-111">IFilter DLLs</span></span>](#ifilter-dlls)
  - [<span data-ttu-id="c7840-112">Struttura IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-112">IFilter Structure</span></span>](#ifilter-structure)
  - [<span data-ttu-id="c7840-113">Codice nativo</span><span class="sxs-lookup"><span data-stu-id="c7840-113">Native Code</span></span>](#native-code)
- [<span data-ttu-id="c7840-114">Ricerca dell'identificatore di classe IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-114">Finding the IFilter Class Identifier</span></span>](#finding-the-ifilter-class-identifier)
  - [<span data-ttu-id="c7840-115">IFilter:: GetChunk e identificatori di codice delle impostazioni locali</span><span class="sxs-lookup"><span data-stu-id="c7840-115">IFilter::GetChunk and Locale Code Identifiers</span></span>](#ifiltergetchunk-and-locale-code-identifiers)
- [<span data-ttu-id="c7840-116">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="c7840-116">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="c7840-117">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c7840-117">Related topics</span></span>](#related-topics)

## <a name="about-the-ifilter-interface"></a><span data-ttu-id="c7840-118">Informazioni sull'interfaccia IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-118">About the IFilter Interface</span></span>

<span data-ttu-id="c7840-119">Microsoft Windows Search USA i filtri per estrarre il contenuto degli elementi da includere in un indice full-text.</span><span class="sxs-lookup"><span data-stu-id="c7840-119">Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.</span></span> <span data-ttu-id="c7840-120">È possibile estendere la ricerca di Windows per indicizzare i tipi di file nuovi o proprietari scrivendo i filtri per estrarre il contenuto e i gestori delle proprietà per estrarre le proprietà dei file.</span><span class="sxs-lookup"><span data-stu-id="c7840-120">You can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.</span></span>

<span data-ttu-id="c7840-121">L'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) è progettata per soddisfare le esigenze specifiche dei motori di ricerca full-text.</span><span class="sxs-lookup"><span data-stu-id="c7840-121">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface is designed to meet the specific needs of full-text search engines.</span></span> <span data-ttu-id="c7840-122">I motori di ricerca full-text come Windows Search chiamano i metodi **IFilter** per estrarre le informazioni relative a testo e proprietà e aggiungerle a un indice.</span><span class="sxs-lookup"><span data-stu-id="c7840-122">Full-text search engines like Windows Search call the **IFilter** methods to extract text and property information and add them to an index.</span></span> <span data-ttu-id="c7840-123">Windows Search interrompe i risultati del metodo [**IFilter:: GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext) restituito in parole, li normalizza e li salva in un indice.</span><span class="sxs-lookup"><span data-stu-id="c7840-123">Windows Search breaks the results of the returned [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext) method into words, normalizes them, and saves them in an index.</span></span> <span data-ttu-id="c7840-124">Se disponibile, il motore di ricerca usa l'identificatore del codice lingua (LCID) di un blocco di testo per eseguire la normalizzazione e la normalizzazione delle parole specifiche della lingua.</span><span class="sxs-lookup"><span data-stu-id="c7840-124">If available, the search engine uses the language code identifier (LCID) of a text chunk to perform language-specific word breaking and normalization.</span></span>

<span data-ttu-id="c7840-125">Windows Search usa tre funzioni, descritte nella tabella seguente, per accedere ai gestori di filtri registrati (implementazioni dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="c7840-125">Windows Search uses three functions, described in the following table, to access registered filter handlers (implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span> <span data-ttu-id="c7840-126">Queste funzioni sono particolarmente utili quando si caricano e si associano al gestore di filtro di un oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="c7840-126">These functions are especially useful when loading and binding to an embedded object's filter handler.</span></span>

| <span data-ttu-id="c7840-127">Funzione</span><span class="sxs-lookup"><span data-stu-id="c7840-127">Function</span></span>               | <span data-ttu-id="c7840-128">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c7840-128">Description</span></span>                                                                                                                                                                                               |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c7840-129">LoadIFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-129">LoadIFilter</span></span>            | <span data-ttu-id="c7840-130">Ottiene un puntatore all' [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) più adatto per il tipo di contenuto specificato.</span><span class="sxs-lookup"><span data-stu-id="c7840-130">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the specified content type.</span></span>                                                                                            |
| <span data-ttu-id="c7840-131">BindIFilterFromStorage</span><span class="sxs-lookup"><span data-stu-id="c7840-131">BindIFilterFromStorage</span></span> | <span data-ttu-id="c7840-132">Ottiene un puntatore al [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) che è più adatto per il contenuto contenuto in un oggetto di [interfaccia IStorage](/windows/win32/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="c7840-132">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the content contained in an [IStorage Interface](/windows/win32/api/objidl/nn-objidl-istorage) object.</span></span> |
| <span data-ttu-id="c7840-133">BindIFilterFromStream</span><span class="sxs-lookup"><span data-stu-id="c7840-133">BindIFilterFromStream</span></span>  | <span data-ttu-id="c7840-134">Ottiene un puntatore al [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) che è più adatto per un identificatore di classe specificato (CLSID) recuperato da una variabile di flusso.</span><span class="sxs-lookup"><span data-stu-id="c7840-134">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for a specified class identifier (CLSID) retrieved from a stream variable.</span></span>                                                 |

<span data-ttu-id="c7840-135">L'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ha cinque metodi, descritti nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="c7840-135">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface has five methods, described in the following table.</span></span>

| <span data-ttu-id="c7840-136">Metodo</span><span class="sxs-lookup"><span data-stu-id="c7840-136">Method</span></span>                                                    | <span data-ttu-id="c7840-137">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c7840-137">Description</span></span>                                                                                                        |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c7840-138">**IFilter:: init**</span><span class="sxs-lookup"><span data-stu-id="c7840-138">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)          | <span data-ttu-id="c7840-139">Inizializza una sessione di filtro.</span><span class="sxs-lookup"><span data-stu-id="c7840-139">Initializes a filtering session.</span></span>                                                                                   |
| [<span data-ttu-id="c7840-140">**IFilter:: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="c7840-140">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk)     | <span data-ttu-id="c7840-141">Posiziona [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) all'inizio del primo o del blocco successivo e restituisce un descrittore.</span><span class="sxs-lookup"><span data-stu-id="c7840-141">Positions [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) at the beginning of the first or next chunk and returns a descriptor.</span></span> |
| [<span data-ttu-id="c7840-142">**IFilter:: GetText**</span><span class="sxs-lookup"><span data-stu-id="c7840-142">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)       | <span data-ttu-id="c7840-143">Recupera il testo dal blocco corrente.</span><span class="sxs-lookup"><span data-stu-id="c7840-143">Retrieves text from the current chunk.</span></span>                                                                             |
| [<span data-ttu-id="c7840-144">**IFilter:: GetValue**</span><span class="sxs-lookup"><span data-stu-id="c7840-144">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue)     | <span data-ttu-id="c7840-145">Recupera i valori dal blocco corrente.</span><span class="sxs-lookup"><span data-stu-id="c7840-145">Retrieves values from the current chunk.</span></span>                                                                           |
| [<span data-ttu-id="c7840-146">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="c7840-146">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="c7840-147">Recupera un'interfaccia che rappresenta la parte specificata dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c7840-147">Retrieves an interface representing the specified portion of object.</span></span> <span data-ttu-id="c7840-148">Riservato per utilizzi futuri.</span><span class="sxs-lookup"><span data-stu-id="c7840-148">Reserved for future use.</span></span>                      |

### <a name="isolation-process"></a><span data-ttu-id="c7840-149">Processo di isolamento</span><span class="sxs-lookup"><span data-stu-id="c7840-149">Isolation Process</span></span>

<span data-ttu-id="c7840-150">Windows Search esegue IFilters nel contesto di sicurezza del sistema locale con diritti limitati.</span><span class="sxs-lookup"><span data-stu-id="c7840-150">Windows Search runs IFilters in the Local System security context with restricted rights.</span></span> <span data-ttu-id="c7840-151">In questo processo di isolamento host [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) viene rimosso un numero di diritti:</span><span class="sxs-lookup"><span data-stu-id="c7840-151">In this [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) host isolation process, a number of rights are removed:</span></span>

- <span data-ttu-id="c7840-152">Codice con restrizioni</span><span class="sxs-lookup"><span data-stu-id="c7840-152">Restricted Code</span></span>
- <span data-ttu-id="c7840-153">Tutti</span><span class="sxs-lookup"><span data-stu-id="c7840-153">Everyone</span></span>
- <span data-ttu-id="c7840-154">Locale</span><span class="sxs-lookup"><span data-stu-id="c7840-154">Local</span></span>
- <span data-ttu-id="c7840-155">Interattività</span><span class="sxs-lookup"><span data-stu-id="c7840-155">Interactive</span></span>
- <span data-ttu-id="c7840-156">Utenti autenticati</span><span class="sxs-lookup"><span data-stu-id="c7840-156">Authenticated Users</span></span>
- <span data-ttu-id="c7840-157">Utenti predefiniti</span><span class="sxs-lookup"><span data-stu-id="c7840-157">Built-in Users</span></span>
- <span data-ttu-id="c7840-158">ID di sicurezza (SID) degli utenti</span><span class="sxs-lookup"><span data-stu-id="c7840-158">Users' security identifier (SID)</span></span>

<span data-ttu-id="c7840-159">La rimozione di questi diritti indica che l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) non ha accesso al sistema del disco o alla rete o a qualsiasi interfaccia utente o funzione degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="c7840-159">The removal of these rights means the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface does not have access to the disk system or network or to any user interface or clipboard functions.</span></span> <span data-ttu-id="c7840-160">Inoltre, il processo di isolamento viene eseguito in un oggetto processo che impedisce la creazione di processi figlio e impone un limite di 100 MB nel working set.</span><span class="sxs-lookup"><span data-stu-id="c7840-160">Furthermore, the isolation process runs under a job object that prevents child processes from being created and imposes a 100 MB limit on the working set.</span></span> <span data-ttu-id="c7840-161">il processo di isolamento host dell'interfaccia **IFilter** aumenta la stabilità della piattaforma di indicizzazione, a causa della possibilità di applicare erroneamente filtri di terze parti.</span><span class="sxs-lookup"><span data-stu-id="c7840-161">the **IFilter** interface host isolation process increases the stability of the indexing platform, due to the possibility of incorrectly implemented third-party filters.</span></span>

> [!NOTE]  
> <span data-ttu-id="c7840-162">È necessario scrivere i gestori di filtro per gestire i buffer e lo stack correttamente.</span><span class="sxs-lookup"><span data-stu-id="c7840-162">Filter handlers must be written to manage buffers, and stack correctly.</span></span> <span data-ttu-id="c7840-163">Tutte le copie di stringhe devono avere controlli espliciti per evitare sovraccarichi del buffer.</span><span class="sxs-lookup"><span data-stu-id="c7840-163">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="c7840-164">Verificare sempre la dimensione allocata del buffer.</span><span class="sxs-lookup"><span data-stu-id="c7840-164">You should always verify the allocated size of the buffer.</span></span> <span data-ttu-id="c7840-165">È consigliabile testare sempre le dimensioni dei dati rispetto alle dimensioni del buffer.</span><span class="sxs-lookup"><span data-stu-id="c7840-165">You should always test the size of the data against the size of the buffer.</span></span>

### <a name="ifilter-dlls"></a><span data-ttu-id="c7840-166">Dll IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-166">IFilter DLLs</span></span>

<span data-ttu-id="c7840-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) Le DLL implementano l'interfaccia **IFilter** per consentire a un client di estrarre informazioni sul valore di testo e proprietà da un tipo di file, una classe o un tipo percepito.</span><span class="sxs-lookup"><span data-stu-id="c7840-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLLs implement the **IFilter** interface to enable a client to extract text and property value information from a file type, class, or perceived type.</span></span> <span data-ttu-id="c7840-168">Il processo di filtro di ricerca di Windows **SearchFilterHost.exe** viene associato all' **IFilter** registrato per la classe, il tipo percepito o l'estensione del nome dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="c7840-168">The Windows Search filtering process **SearchFilterHost.exe** binds to the **IFilter** that is registered for the class, perceived type, or name extension of the item.</span></span>

### <a name="ifilter-structure"></a><span data-ttu-id="c7840-169">Struttura IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-169">IFilter Structure</span></span>

<span data-ttu-id="c7840-170">Ogni [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) è un file dll che implementa un server in-process Component Object Model (com) per fornire le funzionalità di filtro specificate.</span><span class="sxs-lookup"><span data-stu-id="c7840-170">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) is a DLL file that implements an in-process Component Object Model (COM) server to supply the specified filtering capabilities.</span></span> <span data-ttu-id="c7840-171">Nella figura seguente viene illustrata la struttura complessiva di una tipica dll **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="c7840-171">The following figure illustrates shows the overall structure of a typical **IFilter** DLLs.</span></span> <span data-ttu-id="c7840-172">Un esempio più complesso potrebbe implementare più di una classe **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="c7840-172">A more complex example could implement more than one **IFilter** class.</span></span>

![diagramma della struttura di una dll IFilter tipica](images/ifilter-structure.png)

### <a name="native-code"></a><span data-ttu-id="c7840-174">Codice nativo</span><span class="sxs-lookup"><span data-stu-id="c7840-174">Native Code</span></span>

<span data-ttu-id="c7840-175">I filtri devono essere scritti in codice nativo a causa di potenziali problemi di controllo delle versioni di Common Language Runtime (CLR) con il processo di esecuzione di più componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="c7840-175">Filters must be written in native code due to potential common language runtime (CLR) versioning issues with the process that multiple add-ins run in.</span></span> <span data-ttu-id="c7840-176">In Windows 7 e versioni successive, i filtri scritti nel codice gestito vengono bloccati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="c7840-176">In Windows 7 and later and later, filters written in managed code are explicitly blocked.</span></span>

## <a name="finding-the-ifilter-class-identifier"></a><span data-ttu-id="c7840-177">Ricerca dell'identificatore di classe IFilter</span><span class="sxs-lookup"><span data-stu-id="c7840-177">Finding the IFilter Class Identifier</span></span>

<span data-ttu-id="c7840-178">La classe della dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) è registrata nella chiave del registro di sistema PersistentHandler.</span><span class="sxs-lookup"><span data-stu-id="c7840-178">The class of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL is registered under the PersistentHandler registry key.</span></span> <span data-ttu-id="c7840-179">Nell'esempio seguente, per i file HTML, viene illustrato come trovare la dll **IFilter** per un documento HTML.</span><span class="sxs-lookup"><span data-stu-id="c7840-179">The following example, for HTML files, illustrates how to find the **IFilter** DLL for an HTML document.</span></span> <span data-ttu-id="c7840-180">Questo esempio segue una logica simile a quella usata dal sistema per trovare l' **IFilter** associato a un elemento.</span><span class="sxs-lookup"><span data-stu-id="c7840-180">This example follows logic similar to that used by the system to find the **IFilter** associated with an item.</span></span>

1. <span data-ttu-id="c7840-181">Controllare se l'estensione per il tipo di file che la DLL filtra dispone di un PersistentHandler registrato nella voce del registro di sistema \\ HKEY \_ Local \_ Machine \\ software \\ Classes.</span><span class="sxs-lookup"><span data-stu-id="c7840-181">Check whether the extension for the type of files that the DLL filters has a PersistentHandler registered under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="c7840-182">Lasciare che la chiave sia `Value1` .</span><span class="sxs-lookup"><span data-stu-id="c7840-182">Let this key be `Value1`.</span></span> <span data-ttu-id="c7840-183">Se la voce esiste già, andare al passaggio 4 di questa procedura e usarla `Value1` in tale chiave.</span><span class="sxs-lookup"><span data-stu-id="c7840-183">If that entry already exists, then skip to step 4 of this procedure and use `Value1` in that key.</span></span> <span data-ttu-id="c7840-184">I valori sono di tipo REG \_ SZ.</span><span class="sxs-lookup"><span data-stu-id="c7840-184">The values are of type REG\_SZ.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             .htm
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

2. <span data-ttu-id="c7840-185">In alternativa, se non è presente un PersistentHandler registrato per l'estensione, trovare il CLSID associato al tipo di documento nella voce del registro di sistema \\ HKEY \_ Local \_ Machine \\ software \\ Classes.</span><span class="sxs-lookup"><span data-stu-id="c7840-185">Alternatively, if there is not a PersistentHandler registered for the extension, find the CLSID associated with the document type under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="c7840-186">Lasciare che la chiave sia `Value2` .</span><span class="sxs-lookup"><span data-stu-id="c7840-186">Let this key be `Value2`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                CLSID
                   {25336920-03F9-11CF-8FD0-00AA00686F13}
```

3. <span data-ttu-id="c7840-187">Determinare se un PersistentHandler è registrato per il CLSID.</span><span class="sxs-lookup"><span data-stu-id="c7840-187">Determine whether a PersistentHandler is registered for the CLSID.</span></span> <span data-ttu-id="c7840-188">Utilizzando `Value2` determinato nel passaggio 2, trovare PersistentHandler per le \\ \_ \_ classi software del computer locale HKEY \\ \\ \\ CLSID \\ value2 voce.</span><span class="sxs-lookup"><span data-stu-id="c7840-188">Using `Value2` determined in step 2, find the PersistentHandler for the \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value2 entry.</span></span> <span data-ttu-id="c7840-189">Lasciare che la chiave sia `Value3` .</span><span class="sxs-lookup"><span data-stu-id="c7840-189">Let this key be `Value3`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

4. <span data-ttu-id="c7840-190">Determinare il GUID del gestore persistente [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="c7840-190">Determine the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) persistent handler GUID.</span></span> <span data-ttu-id="c7840-191">Utilizzando `Value1` e `Value3` , trovare il GUID del gestore permanente **IFilter** per il tipo di documento.</span><span class="sxs-lookup"><span data-stu-id="c7840-191">Using `Value1` and `Value3`, find the **IFilter** Persistent Handler GUID for the document type.</span></span> <span data-ttu-id="c7840-192">Il valore nella voce del registro \\ di sistema HKEY \_ Local \_ Machine \\ software \\ classi \\ CLSID \\ Value1 o 3 \\ PersistentAddinsRegistered \\ 89BCB740-6119-101A-BCB7-00DD010655AF "/> restituisce il GUID PersistentHandler **IFilter** per questo tipo di documento.</span><span class="sxs-lookup"><span data-stu-id="c7840-192">The value under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value1 or 3\\PersistentAddinsRegistered\\ 89BCB740-6119-101A-BCB7-00DD010655AF"/> yields the **IFilter** PersistentHandler GUID for this document type.</span></span> <span data-ttu-id="c7840-193">Lasciare che la chiave sia `Value4` .</span><span class="sxs-lookup"><span data-stu-id="c7840-193">Let this key be `Value4`.</span></span> <span data-ttu-id="c7840-194">In questo esempio il GUID dell'interfaccia **IFilter** è 89BCB740-6119-101A-BCB7-00DD010655AF.</span><span class="sxs-lookup"><span data-stu-id="c7840-194">In this example, the **IFilter** interface GUID is 89BCB740-6119-101A-BCB7-00DD010655AF.</span></span>

```
    HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             {EEC97550-47A9-11CF-B952-00AA0051FE20}
                 = HTML File Persistent Handler
                    Data type         REG_SZ
                        PersistentAddinsRegistered
                        {89BCB740-6119-101A-BCB7-00DD010655AF}

                    Data type         REG_SZ
                        default = {E0CA5340-4534-11CF-B952-00AA0051FE20}
```

> [!NOTE]  
> <span data-ttu-id="c7840-195">In questo esempio la dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) per i documenti HTML è nlhtml.dll.</span><span class="sxs-lookup"><span data-stu-id="c7840-195">In this example, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL for HTML documents is nlhtml.dll.</span></span>

### <a name="ifiltergetchunk-and-locale-code-identifiers"></a><span data-ttu-id="c7840-196">IFilter:: GetChunk e identificatori di codice delle impostazioni locali</span><span class="sxs-lookup"><span data-stu-id="c7840-196">IFilter::GetChunk and Locale Code Identifiers</span></span>

<span data-ttu-id="c7840-197">Il valore LCID del testo può essere modificato all'interno di un singolo file.</span><span class="sxs-lookup"><span data-stu-id="c7840-197">The LCID of text can change within a single file.</span></span> <span data-ttu-id="c7840-198">Ad esempio, il testo di un manuale di istruzioni potrebbe essere alternativo tra inglese (en-US) e spagnolo (es) oppure il testo potrebbe includere una singola parola in una lingua diversa dalla lingua primaria.</span><span class="sxs-lookup"><span data-stu-id="c7840-198">For example, the text of an instruction manual might alternate between English (en-us) and Spanish (es) or the text may include a single word in a language other than the primary language.</span></span> <span data-ttu-id="c7840-199">In entrambi i casi, l' [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) deve iniziare un nuovo blocco ogni volta che viene modificato l'identificatore LCID.</span><span class="sxs-lookup"><span data-stu-id="c7840-199">In either case, your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) must begin a new chunk each time the LCID changes.</span></span> <span data-ttu-id="c7840-200">Poiché l'identificatore LCID viene utilizzato per scegliere un Word breaker appropriato, è molto importante identificarlo correttamente.</span><span class="sxs-lookup"><span data-stu-id="c7840-200">Because the LCID is used to choose an appropriate word breaker, it is very important that you correctly identify it.</span></span> <span data-ttu-id="c7840-201">Se **IFilter** non è in grado di determinare le impostazioni locali del testo, deve restituire un identificatore LCID pari a zero con il blocco.</span><span class="sxs-lookup"><span data-stu-id="c7840-201">If the **IFilter** cannot determine the locale of the text, then it should return an LCID of zero with the chunk.</span></span> <span data-ttu-id="c7840-202">Se si restituisce un LCID pari a zero, Windows Search utilizzerà la tecnologia del rilevamento automatico del linguaggio (LAD) per determinare l'ID delle impostazioni locali del blocco.</span><span class="sxs-lookup"><span data-stu-id="c7840-202">Returning an LCID of zero causes Windows Search to use Language Auto-Detection (LAD) technology to determine the locale ID of the chunk.</span></span> <span data-ttu-id="c7840-203">Se la ricerca di Windows non è in grado di trovare una corrispondenza, per impostazione predefinita vengono predefinite le impostazioni locali predefinite del sistema (chiamando la funzione [GetSystemDefaultLocaleName Function](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) ).</span><span class="sxs-lookup"><span data-stu-id="c7840-203">If Windows Search cannot find a match, it defaults to the system default locale (by calling the [GetSystemDefaultLocaleName Function](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) function).</span></span> <span data-ttu-id="c7840-204">Per altre informazioni, vedere [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**chunk \_ BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate)e [**Stat \_ chunk**](/windows/win32/api/filter/ns-filter-stat_chunk).</span><span class="sxs-lookup"><span data-stu-id="c7840-204">For more information, see [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**CHUNK\_BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate), and [**STAT\_CHUNK**](/windows/win32/api/filter/ns-filter-stat_chunk).</span></span>

<span data-ttu-id="c7840-205">Se si controlla il formato del file e attualmente non contiene informazioni sulle impostazioni locali, è necessario aggiungere una funzionalità utente per abilitare l'identificazione delle impostazioni locali corretta.</span><span class="sxs-lookup"><span data-stu-id="c7840-205">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="c7840-206">L'utilizzo di un Word breaker non corrispondente può comportare una scarsa esperienza di query per l'utente.</span><span class="sxs-lookup"><span data-stu-id="c7840-206">Using a mismatched word breaker can result in a poor query experience for the user.</span></span> <span data-ttu-id="c7840-207">Per ulteriori informazioni, vedere [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span><span class="sxs-lookup"><span data-stu-id="c7840-207">For more information, see [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span></span>

> [!NOTE]  
> <span data-ttu-id="c7840-208">I filtri sono associati ai tipi di file, come indicato dalle estensioni dei nomi di file, dai tipi MIME o dai CLSID.</span><span class="sxs-lookup"><span data-stu-id="c7840-208">Filters are associated with file types, as denoted by file name extensions, MIME types or CLSIDs.</span></span> <span data-ttu-id="c7840-209">Mentre un filtro può gestire più tipi di file, ogni tipo funziona con un solo filtro.</span><span class="sxs-lookup"><span data-stu-id="c7840-209">While one filter can handle multiple file types, each type works with only one filter.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="c7840-210">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="c7840-210">Additional Resources</span></span>

- <span data-ttu-id="c7840-211">Nell'esempio di codice [IFilterSample](-search-sample-ifiltersample.md) , disponibile in [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), viene illustrato come creare una classe di base IFilter per implementare l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="c7840-211">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="c7840-212">Per una panoramica del processo di indicizzazione, vedere [il processo di indicizzazione](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c7840-212">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="c7840-213">Per una panoramica dei tipi di file, vedere [tipi di file](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="c7840-213">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="c7840-214">Per eseguire query sugli attributi di associazione file per un tipo di file, vedere [PerceivedTypes, SystemFileAssociations e registrazione dell'applicazione](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="c7840-214">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c7840-215">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c7840-215">Related topics</span></span>

[<span data-ttu-id="c7840-216">Sviluppo di gestori di filtri</span><span class="sxs-lookup"><span data-stu-id="c7840-216">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="c7840-217">Procedure consigliate per la creazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="c7840-217">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="c7840-218">Restituzione di proprietà da un gestore di filtro</span><span class="sxs-lookup"><span data-stu-id="c7840-218">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="c7840-219">Gestori di filtri forniti con Windows</span><span class="sxs-lookup"><span data-stu-id="c7840-219">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="c7840-220">Implementazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="c7840-220">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="c7840-221">Registrazione di gestori di filtro</span><span class="sxs-lookup"><span data-stu-id="c7840-221">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="c7840-222">Test di gestori filtro</span><span class="sxs-lookup"><span data-stu-id="c7840-222">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
