---
description: È importante comprendere la struttura DLL richiesta di un gestore di filtro, ovvero un'implementazione dell'interfaccia IFilter.
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: Implementazione di gestori di filtro in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106306169"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="10f04-103">Implementazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="10f04-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="10f04-104">È importante comprendere la struttura DLL richiesta di un gestore di filtro, ovvero un'implementazione dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="10f04-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="10f04-105">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="10f04-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="10f04-106">Implementazione ed esportazione dei punti di ingresso della DLL</span><span class="sxs-lookup"><span data-stu-id="10f04-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="10f04-107">Implementazione della classe IFilter e della class factory</span><span class="sxs-lookup"><span data-stu-id="10f04-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="10f04-108">Eredità delle interfacce COM</span><span class="sxs-lookup"><span data-stu-id="10f04-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="10f04-109">Implementazione dei metodi dell'interfaccia COM</span><span class="sxs-lookup"><span data-stu-id="10f04-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="10f04-110">Metodi COM non implementati</span><span class="sxs-lookup"><span data-stu-id="10f04-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="10f04-111">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="10f04-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="10f04-112">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="10f04-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="10f04-113">Implementazione ed esportazione dei punti di ingresso della DLL</span><span class="sxs-lookup"><span data-stu-id="10f04-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="10f04-114">Ogni dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) (indicata da Ifilter.dll in questa sezione) deve implementare ed esportare i punti di ingresso seguenti.</span><span class="sxs-lookup"><span data-stu-id="10f04-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="10f04-115">Questi punti di ingresso vengono in genere esportati utilizzando un file di definizione moduli (con estensione def) per l'interfaccia **IFilter** o utilizzando la parola chiave **\_ \_ declspec (dllexport)** .</span><span class="sxs-lookup"><span data-stu-id="10f04-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="10f04-116">Il file DLL può essere registrato in qualsiasi cartella, ma in genere si trova nella cartella% SystemRoot% \\ system32.</span><span class="sxs-lookup"><span data-stu-id="10f04-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="10f04-117">I punti di ingresso della DLL sono elencati e descritti nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="10f04-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="10f04-118">Nome DLL</span><span class="sxs-lookup"><span data-stu-id="10f04-118">DLL name</span></span>                                                                                     | <span data-ttu-id="10f04-119">Descrizione DLL</span><span class="sxs-lookup"><span data-stu-id="10f04-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="10f04-120">DllRegisterServer</span><span class="sxs-lookup"><span data-stu-id="10f04-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="10f04-121">Il punto di ingresso [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) registra la dll come filtro nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="10f04-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="10f04-122">Per registrare la DLL, è necessario eseguire il programma regsvr32.exe con il nome del file DLL dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) come argomento: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="10f04-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="10f04-123">DllUnregisterServer (funzione)</span><span class="sxs-lookup"><span data-stu-id="10f04-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="10f04-124">Il punto di ingresso della [funzione DllUnregisterServer](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) rimuove la dll come gestore permanente nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="10f04-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="10f04-125">Si annulla la registrazione della DLL eseguendo il programma regsvr32.exe con il `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="10f04-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="10f04-126">DllGetClassObject (funzione)</span><span class="sxs-lookup"><span data-stu-id="10f04-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="10f04-127">Il client di indicizzazione del contenuto chiama il punto di ingresso della [funzione DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) , tramite Component Object Model (com), per creare un oggetto class factory per l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) e per ottenere un puntatore all'interfaccia class factory di tale oggetto.</span><span class="sxs-lookup"><span data-stu-id="10f04-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="10f04-128">DllCanUnloadNow (funzione)</span><span class="sxs-lookup"><span data-stu-id="10f04-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="10f04-129">Il client di indicizzazione del contenuto chiama il punto di ingresso della [funzione DllCanUnloadNow](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) , tramite com, per determinare se è possibile scaricare la dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  .</span><span class="sxs-lookup"><span data-stu-id="10f04-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="10f04-130">L'interfaccia **IFilter** viene scaricata dopo essere stata inutilizzata per un intervallo di tempo, come specificato dal valore del registro di sistema FilterIdleTimeOut.</span><span class="sxs-lookup"><span data-stu-id="10f04-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="10f04-131">Implementazione della classe IFilter e della class factory</span><span class="sxs-lookup"><span data-stu-id="10f04-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="10f04-132">Almeno due classi, ad esempio CFilter e CFilterCF, vengono in genere implementate da ogni dll [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="10f04-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="10f04-133">La classe CFilter produce l'oggetto interfaccia **IFilter** che implementa la funzionalità di filtro dei contenuti.</span><span class="sxs-lookup"><span data-stu-id="10f04-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="10f04-134">Le funzioni membro implementano i metodi di interfaccia dell'interfaccia **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="10f04-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="10f04-135">Ogni classe **IFilter** richiede un identificatore di classe univoco (CLSID), generato dall'implementatore dell'interfaccia **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="10f04-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="10f04-136">La classe CFilterCF produce l'oggetto class-factory per l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="10f04-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="10f04-137">Il class factory viene chiamato, tramite l'interfaccia dell' [interfaccia IClassFactory](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , dal punto di ingresso della [funzione DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) della dll.</span><span class="sxs-lookup"><span data-stu-id="10f04-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="10f04-138">La classe CFilterCF crea l'oggetto CFilter e restituisce un puntatore a [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="10f04-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="10f04-139">In casi più complessi, un **IFilter** può implementare una gerarchia di classi al posto della singola classe cfilter.</span><span class="sxs-lookup"><span data-stu-id="10f04-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="10f04-140">Eredità delle interfacce COM</span><span class="sxs-lookup"><span data-stu-id="10f04-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="10f04-141">Windows Search 3,0 e versioni successive richiedono l'uso di [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) per i motivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="10f04-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="10f04-142">Per garantire prestazioni e compatibilità futura.</span><span class="sxs-lookup"><span data-stu-id="10f04-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="10f04-143">Per aumentare la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="10f04-143">To help increase security.</span></span> <span data-ttu-id="10f04-144">I filtri IFilter implementati con [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) sono più sicuri perché il contesto in cui viene eseguita l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) non necessita dei diritti per aprire i file sul disco o sulla rete.</span><span class="sxs-lookup"><span data-stu-id="10f04-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="10f04-145">Sebbene Windows Search usi solo [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), la classe di interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) può anche ereditare l' [interfaccia IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) e/o le implementazioni dell'interfaccia dell' [interfaccia IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) per la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="10f04-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="10f04-146">Queste interfacce sono dichiarate nei file inclusi dalla \\ directory di inclusione MSSDK e hanno identificatori di interfaccia predefiniti (IID).</span><span class="sxs-lookup"><span data-stu-id="10f04-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="10f04-147">Il client di indicizzazione del contenuto esegue una query sull'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) tramite [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) per determinare quali di queste interfacce utilizzare per filtrare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="10f04-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="10f04-148">Implementazione dei metodi dell'interfaccia COM</span><span class="sxs-lookup"><span data-stu-id="10f04-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="10f04-149">L'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementa i metodi [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) sia per la classe di interfaccia **IFilter** sia per l'interfaccia **IFilter** -class factory.</span><span class="sxs-lookup"><span data-stu-id="10f04-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="10f04-150">Nella tabella seguente sono elencati, in ordine vtable, le interfacce e i metodi specifici dell'interfaccia **IFilter** che devono essere implementati dall'interfaccia **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="10f04-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="10f04-151">L'interfaccia **IFilter** deve implementare almeno [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), ma può implementare altre interfacce derivate da IPersist.</span><span class="sxs-lookup"><span data-stu-id="10f04-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="10f04-152">Interfaccia COM</span><span class="sxs-lookup"><span data-stu-id="10f04-152">COM interface</span></span>                                                                             | <span data-ttu-id="10f04-153">Metodo</span><span class="sxs-lookup"><span data-stu-id="10f04-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="10f04-154">Interfaccia IClassFactory</span><span class="sxs-lookup"><span data-stu-id="10f04-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="10f04-155">CreateInstance, LockServer</span><span class="sxs-lookup"><span data-stu-id="10f04-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="10f04-156">Interfaccia IClassFactory2</span><span class="sxs-lookup"><span data-stu-id="10f04-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="10f04-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span><span class="sxs-lookup"><span data-stu-id="10f04-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="10f04-158">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="10f04-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="10f04-159">[**IFilter:: init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter:: GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter:: GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter:: BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="10f04-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="10f04-160">Interfaccia IPersist</span><span class="sxs-lookup"><span data-stu-id="10f04-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="10f04-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="10f04-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="10f04-162">Interfaccia IPersistFile</span><span class="sxs-lookup"><span data-stu-id="10f04-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="10f04-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span><span class="sxs-lookup"><span data-stu-id="10f04-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="10f04-164">Interfaccia IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="10f04-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="10f04-165">IsDirty, Load, Save, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="10f04-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="10f04-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="10f04-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="10f04-167">IsDirty, Load, Save, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="10f04-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="10f04-168">La pagina di riferimento per ogni metodo specifica i parametri e il comportamento funzionale per il metodo.</span><span class="sxs-lookup"><span data-stu-id="10f04-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="10f04-169">Ogni pagina di riferimento fornisce inoltre i codici di risultato da implementare per il metodo.</span><span class="sxs-lookup"><span data-stu-id="10f04-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="10f04-170">Le pagine di riferimento per i metodi [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) forniscono i codici specifici dell'interfaccia nei codici risultato della [funzionalità \_ ITF](../com/codes-in-facility-itf.md) da implementare e il client di indicizzazione del contenuto è in grado di gestire anche i codici di risultato generici, ad esempio la funzionalità \_ null e la funzione \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="10f04-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="10f04-171">Per ulteriori informazioni, vedere la pagina relativa alla [struttura dei codici di errore com](../com/structure-of-com-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="10f04-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="10f04-172">Metodi COM non implementati</span><span class="sxs-lookup"><span data-stu-id="10f04-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="10f04-173">L'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) deve implementare almeno [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), ma non è necessario implementare altre interfacce derivate da IPersist.</span><span class="sxs-lookup"><span data-stu-id="10f04-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="10f04-174">Windows Search non deve implementare i metodi COM elencati nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="10f04-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="10f04-175">Metodo non obbligatorio</span><span class="sxs-lookup"><span data-stu-id="10f04-175">Method that is not required</span></span>                               | <span data-ttu-id="10f04-176">Descrizione</span><span class="sxs-lookup"><span data-stu-id="10f04-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="10f04-177">IPersistStream:: IsDirty</span><span class="sxs-lookup"><span data-stu-id="10f04-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="10f04-178">I filtri devono restituire E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="10f04-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="10f04-179">IPersistStream:: Save</span><span class="sxs-lookup"><span data-stu-id="10f04-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="10f04-180">I filtri devono restituire E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="10f04-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="10f04-181">IPersistStream:: GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="10f04-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="10f04-182">I filtri devono restituire E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="10f04-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="10f04-183">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="10f04-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="10f04-184">I filtri devono restituire E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="10f04-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="10f04-185">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="10f04-185">Additional Resources</span></span>

- <span data-ttu-id="10f04-186">Nell'esempio di codice [IFilterSample](-search-sample-ifiltersample.md) , disponibile in [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), viene illustrato come creare una classe di base IFilter per implementare l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="10f04-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="10f04-187">Per una panoramica del processo di indicizzazione, vedere [il processo di indicizzazione](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="10f04-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="10f04-188">Per una panoramica dei tipi di file, vedere [tipi di file](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="10f04-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="10f04-189">Per eseguire query sugli attributi di associazione file per un tipo di file, vedere [PerceivedTypes, SystemFileAssociations e registrazione dell'applicazione](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="10f04-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="10f04-190">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="10f04-190">Related topics</span></span>

[<span data-ttu-id="10f04-191">Sviluppo di gestori di filtri</span><span class="sxs-lookup"><span data-stu-id="10f04-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="10f04-192">Informazioni sui gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="10f04-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="10f04-193">Procedure consigliate per la creazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="10f04-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="10f04-194">Restituzione di proprietà da un gestore di filtro</span><span class="sxs-lookup"><span data-stu-id="10f04-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="10f04-195">Gestori di filtri forniti con Windows</span><span class="sxs-lookup"><span data-stu-id="10f04-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="10f04-196">Registrazione di gestori di filtro</span><span class="sxs-lookup"><span data-stu-id="10f04-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="10f04-197">Test di gestori filtro</span><span class="sxs-lookup"><span data-stu-id="10f04-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
