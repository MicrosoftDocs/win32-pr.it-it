---
description: Le proprietà vengono estratte da elementi utilizzando gestori di proprietà registrati o utilizzando filtri registrati per tipi di file specifici. Un gestore di filtro (un'implementazione dell'interfaccia IFilter) può interpretare il contenuto di un tipo di file in diversi modi.
ms.assetid: 6701d151-c36f-43e5-929b-9831c5ce5823
title: Restituzione di proprietà da un gestore di filtro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4df0bfc811176e9b0672dbcbe4ef4f04f3c3a6f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106306168"
---
# <a name="returning-properties-from-a-filter-handler"></a><span data-ttu-id="b319d-104">Restituzione di proprietà da un gestore di filtro</span><span class="sxs-lookup"><span data-stu-id="b319d-104">Returning Properties from a Filter Handler</span></span>

<span data-ttu-id="b319d-105">Le proprietà vengono estratte da elementi utilizzando gestori di proprietà registrati o utilizzando filtri registrati per tipi di file specifici.</span><span class="sxs-lookup"><span data-stu-id="b319d-105">Properties are extracted from items using registered property handlers, or using filters registered for specific file types.</span></span> <span data-ttu-id="b319d-106">Un gestore di filtro (un'implementazione dell'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) può interpretare il contenuto di un tipo di file in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="b319d-106">A filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) can interpret the contents of a file type in any number of ways.</span></span>

<span data-ttu-id="b319d-107">Questo argomento è organizzato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="b319d-107">This topic is organized as follows:</span></span>

- [<span data-ttu-id="b319d-108">Filtro proprietà</span><span class="sxs-lookup"><span data-stu-id="b319d-108">Property Filtering</span></span>](#returning-properties-from-a-filter-handler)
  - [<span data-ttu-id="b319d-109">Limitazioni relative alle dimensioni delle proprietà</span><span class="sxs-lookup"><span data-stu-id="b319d-109">Property Size Limitations</span></span>](#property-size-limitations)
- [<span data-ttu-id="b319d-110">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="b319d-110">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="b319d-111">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b319d-111">Related topics</span></span>](#related-topics)

## <a name="property-filtering"></a><span data-ttu-id="b319d-112">Filtro proprietà</span><span class="sxs-lookup"><span data-stu-id="b319d-112">Property Filtering</span></span>

<span data-ttu-id="b319d-113">Nella tabella seguente sono elencate le procedure consigliate per il filtro delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b319d-113">Best practices for property filtering are listed in the following table.</span></span>

| <span data-ttu-id="b319d-114">Metodo</span><span class="sxs-lookup"><span data-stu-id="b319d-114">Method</span></span>                                                | <span data-ttu-id="b319d-115">Descrizione</span><span class="sxs-lookup"><span data-stu-id="b319d-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b319d-116">**IFilter:: init**</span><span class="sxs-lookup"><span data-stu-id="b319d-116">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)      | <span data-ttu-id="b319d-117">Restituisce l'enumerazione dei [**\_ flag IFILTER**](/windows/win32/api/filter/ne-filter-ifilter_flags) .</span><span class="sxs-lookup"><span data-stu-id="b319d-117">Returns the [**IFILTER\_FLAGS**](/windows/win32/api/filter/ne-filter-ifilter_flags) enumeration.</span></span> <span data-ttu-id="b319d-118">Se il membro delle *\_ \_ \_ proprietà OLE dei flag IFILTER* di questa enumerazione è impostato su uno, Windows Search usa le interfacce delle interfacce [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) e [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) per enumerare e accedere alle proprietà del tipo di valore esterno.</span><span class="sxs-lookup"><span data-stu-id="b319d-118">If the *IFILTER\_FLAGS\_OLE\_PROPERTIES* member of this enumeration is set to one, then Windows Search uses the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces interfaces to enumerate and access external value-type properties.</span></span> |
| [<span data-ttu-id="b319d-119">**IFilter:: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="b319d-119">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk) | <span data-ttu-id="b319d-120">Restituisce informazioni da un documento in "blocchi" con il tipo di blocco (testo o valore), il nome e le impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="b319d-120">Returns information from a document in "chunks" with chunk type (text or value), name, and locale.</span></span> <span data-ttu-id="b319d-121">Un blocco contiene una proprietà del documento.</span><span class="sxs-lookup"><span data-stu-id="b319d-121">A chunk contains one document property.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="b319d-122">**IFilter:: GetText**</span><span class="sxs-lookup"><span data-stu-id="b319d-122">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)   | <span data-ttu-id="b319d-123">Ottiene una proprietà di tipo testo da un blocco.</span><span class="sxs-lookup"><span data-stu-id="b319d-123">Gets a text-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="b319d-124">**IFilter:: GetValue**</span><span class="sxs-lookup"><span data-stu-id="b319d-124">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue) | <span data-ttu-id="b319d-125">Ottiene una proprietà di tipo valore da un blocco.</span><span class="sxs-lookup"><span data-stu-id="b319d-125">Gets a value-type property from a chunk.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                        |

<span data-ttu-id="b319d-126">Nella figura seguente viene illustrato un documento di esempio.</span><span class="sxs-lookup"><span data-stu-id="b319d-126">The following illustration shows an example document.</span></span> <span data-ttu-id="b319d-127">La proprietà del tipo di valore esterno, `DocTitle` ottenuta usando i metodi delle interfacce [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) e [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) , e la proprietà del tipo di valore interno `Book` (ottenuta come risultato di un'implementazione personalizzata di [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) descrivono l'intero documento.</span><span class="sxs-lookup"><span data-stu-id="b319d-127">The external value-type property `DocTitle` (obtained using methods of the [IPropertySetStorage](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) and [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) interfaces) and the internal value-type property `Book` (obtained as a result of a custom [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation) describe the document as a whole.</span></span> <span data-ttu-id="b319d-128">Proprietà del tipo di testo `Contents` e `Chapter` descrivono il contenuto del documento.</span><span class="sxs-lookup"><span data-stu-id="b319d-128">The text-type properties `Contents` and `Chapter` describe the content of the document.</span></span> <span data-ttu-id="b319d-129">Quando si elabora questo documento, il gestore di filtro (un'implementazione dell'interfaccia **IFilter** ) identifica ed estrae queste proprietà.</span><span class="sxs-lookup"><span data-stu-id="b319d-129">When processing this document, the filter handler (an implementation of the **IFilter** interface) identifies and extracts these properties.</span></span>

![diagramma che Mostra gli elementi di un documento tipico](images/ifilterpropertyextraction.png)

### <a name="property-size-limitations"></a><span data-ttu-id="b319d-131">Limitazioni relative alle dimensioni delle proprietà</span><span class="sxs-lookup"><span data-stu-id="b319d-131">Property Size Limitations</span></span>

<span data-ttu-id="b319d-132">Esistono due potenziali limitazioni alla dimensione delle proprietà:</span><span class="sxs-lookup"><span data-stu-id="b319d-132">There are two potential limitations to property size:</span></span>

- <span data-ttu-id="b319d-133">Dimensioni massime dei dati accettati da Windows Search per ogni file.</span><span class="sxs-lookup"><span data-stu-id="b319d-133">The maximum size of data that Windows Search accepts per file.</span></span>
- <span data-ttu-id="b319d-134">Dimensione massima per ogni proprietà definita nel file di descrizione della proprietà.</span><span class="sxs-lookup"><span data-stu-id="b319d-134">The maximum size per property as defined in the property description file.</span></span>

<span data-ttu-id="b319d-135">Attualmente, Windows Search non utilizza la dimensione della proprietà definita durante il calcolo della quantità di dati accettata da un elemento.</span><span class="sxs-lookup"><span data-stu-id="b319d-135">Currently, Windows Search does not use the defined property size when calculating the amount of data it accepts from an item.</span></span> <span data-ttu-id="b319d-136">Al contrario, il limite usato da Windows Search è il prodotto delle dimensioni del file e `MaxGrowFactor` (file size N \* MaxGrowFactor) letto dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="b319d-136">Instead, the limit Windows Search uses is the product of the size of the file and the `MaxGrowFactor` (file size N \* MaxGrowFactor) read from the registry.</span></span> <span data-ttu-id="b319d-137">Il valore predefinito `MaxGrowFactor` è quattro.</span><span class="sxs-lookup"><span data-stu-id="b319d-137">The default `MaxGrowFactor` is four.</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Gathering Manager
            MaxGrowFactor
```

<span data-ttu-id="b319d-138">Di conseguenza, se il tipo di file tende a essere ridotto in dimensioni totali ma con proprietà più grandi, è possibile che Windows Search non accetti tutti i dati di proprietà che si desidera creare.</span><span class="sxs-lookup"><span data-stu-id="b319d-138">Consequently, if your file type tends to be small in total size but have larger properties, Windows Search may not accept all the property data you want to emit.</span></span> <span data-ttu-id="b319d-139">Tuttavia, è possibile aumentare il `MaxGrowFactor` in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="b319d-139">However, you can increase the `MaxGrowFactor` to suit your needs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="b319d-140">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="b319d-140">Additional Resources</span></span>

- <span data-ttu-id="b319d-141">Nell'esempio di codice [IFilterSample](-search-sample-ifiltersample.md) , disponibile in [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), viene illustrato come creare una classe di base IFilter per implementare l'interfaccia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="b319d-141">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="b319d-142">Per una panoramica del processo di indicizzazione, vedere [il processo di indicizzazione](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b319d-142">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="b319d-143">Per una panoramica dei tipi di file, vedere [tipi di file](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="b319d-143">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="b319d-144">Per eseguire query sugli attributi di associazione file per un tipo di file, vedere [PerceivedTypes, SystemFileAssociations e registrazione dell'applicazione](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b319d-144">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>
- <span data-ttu-id="b319d-145">Per una panoramica delle proprietà e dei gestori di proprietà e un elenco di proprietà di sistema che è possibile usare per i formati di file, vedere [sviluppo di gestori di proprietà per la ricerca di Windows](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="b319d-145">For an overview of properties and property handlers, and a list of system properties that you can use for your file formats, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b319d-146">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b319d-146">Related topics</span></span>

[<span data-ttu-id="b319d-147">Sviluppo di gestori di filtri</span><span class="sxs-lookup"><span data-stu-id="b319d-147">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="b319d-148">Informazioni sui gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="b319d-148">About Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="b319d-149">Procedure consigliate per la creazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="b319d-149">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="b319d-150">Gestori di filtri forniti con Windows</span><span class="sxs-lookup"><span data-stu-id="b319d-150">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="b319d-151">Implementazione di gestori di filtro in Windows Search</span><span class="sxs-lookup"><span data-stu-id="b319d-151">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="b319d-152">Registrazione di gestori di filtro</span><span class="sxs-lookup"><span data-stu-id="b319d-152">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="b319d-153">Test di gestori filtro</span><span class="sxs-lookup"><span data-stu-id="b319d-153">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
