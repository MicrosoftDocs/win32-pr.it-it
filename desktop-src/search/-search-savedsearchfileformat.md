---
description: Gli utenti di Windows possono salvare le ricerche come una cartella di ricerca generata da un file XML che archivia la query in un modulo che può essere utilizzato dal sottosistema di ricerca di Windows.
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: Formato file di ricerca salvato
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525495"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="9342d-103">Formato file di ricerca salvato</span><span class="sxs-lookup"><span data-stu-id="9342d-103">Saved Search File Format</span></span>

<span data-ttu-id="9342d-104">In Windows Vista e versioni successive, gli utenti possono salvare le ricerche come una cartella di ricerca generata da un file XML in cui è archiviata la query in un modulo che può essere utilizzato dal sottosistema di ricerca di Windows.</span><span class="sxs-lookup"><span data-stu-id="9342d-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="9342d-105">In questo argomento viene descritto il formato di file ( \* . search-ms) e sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="9342d-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="9342d-106">Panoramica delle ricerche salvate</span><span class="sxs-lookup"><span data-stu-id="9342d-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="9342d-107">\<viewInfo> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="9342d-108">\<viewInfo> Attributi</span><span class="sxs-lookup"><span data-stu-id="9342d-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="9342d-109">\<viewInfo> Elementi figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="9342d-110">\<query> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="9342d-111">\<query> Elementi figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="9342d-112">\<properties> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="9342d-113">Specifica completa del formato di file search-ms</span><span class="sxs-lookup"><span data-stu-id="9342d-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="9342d-114">Esempi di ricerche salvate</span><span class="sxs-lookup"><span data-stu-id="9342d-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="9342d-115">Panoramica delle ricerche salvate</span><span class="sxs-lookup"><span data-stu-id="9342d-115">Overview of Saved Searches</span></span>

<span data-ttu-id="9342d-116">Gli utenti possono salvare una query di ricerca come cartella di ricerca, una cartella virtuale visualizzata in Esplora risorse sotto la cartella ricerche.</span><span class="sxs-lookup"><span data-stu-id="9342d-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="9342d-117">Aprendo una cartella di ricerca viene eseguita la ricerca salvata e vengono visualizzati i risultati aggiornati.</span><span class="sxs-lookup"><span data-stu-id="9342d-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="9342d-118">Il file di ricerca salvato archivia la query in un formato in cui Windows Search può agire, specificando gli elementi da cercare, dove eseguire la ricerca e come presentare i risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="9342d-119">La ricerca salvata viene generata da un file XML ( \* con estensione search-ms) nella cartella% UserProfile% search \\ .</span><span class="sxs-lookup"><span data-stu-id="9342d-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="9342d-120">I dati sono divisi in tre elementi primari nel file XML:</span><span class="sxs-lookup"><span data-stu-id="9342d-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="9342d-121">\<viewInfo> Specifica le informazioni di presentazione</span><span class="sxs-lookup"><span data-stu-id="9342d-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="9342d-122">\<query> specifica (Cerca informazioni sulle query</span><span class="sxs-lookup"><span data-stu-id="9342d-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="9342d-123">\<properties> Specifica le proprietà del \* file con estensione search-ms.</span><span class="sxs-lookup"><span data-stu-id="9342d-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="9342d-124">Nell'esempio seguente viene illustrata la struttura di alto livello di un file di ricerca salvato.</span><span class="sxs-lookup"><span data-stu-id="9342d-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="9342d-125">\<viewInfo> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-125">\<viewInfo> Element</span></span>

<span data-ttu-id="9342d-126">L' \<viewInfo> elemento specifica il modo in cui i risultati vengono presentati all'utente finale.</span><span class="sxs-lookup"><span data-stu-id="9342d-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="9342d-127">Nell'esempio seguente viene illustrata la struttura dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="9342d-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="9342d-128">\<viewInfo> Attributi</span><span class="sxs-lookup"><span data-stu-id="9342d-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="9342d-129">La tabella seguente descrive gli attributi dell'elemento \<viewInfo>.</span><span class="sxs-lookup"><span data-stu-id="9342d-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="9342d-130">Attributo</span><span class="sxs-lookup"><span data-stu-id="9342d-130">Attribute</span></span>     | <span data-ttu-id="9342d-131">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9342d-131">Description</span></span>                                                                     | <span data-ttu-id="9342d-132">Valori</span><span class="sxs-lookup"><span data-stu-id="9342d-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="9342d-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="9342d-133">viewMode</span></span>      | <span data-ttu-id="9342d-134">Specifica la visualizzazione cartelle.</span><span class="sxs-lookup"><span data-stu-id="9342d-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="9342d-135">\|Riquadri icone Dettagli \|</span><span class="sxs-lookup"><span data-stu-id="9342d-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="9342d-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="9342d-136">iconSize</span></span>      | <span data-ttu-id="9342d-137">Controlla le dimensioni predefinite delle icone e delle anteprime per gli elementi quando non lo stack.</span><span class="sxs-lookup"><span data-stu-id="9342d-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="9342d-138">Intero compreso tra 16 e 256</span><span class="sxs-lookup"><span data-stu-id="9342d-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="9342d-139">stackIconSize</span><span class="sxs-lookup"><span data-stu-id="9342d-139">stackIconSize</span></span> | <span data-ttu-id="9342d-140">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-140">For internal use only.</span></span> <span data-ttu-id="9342d-141">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-141">Do not use.</span></span>                                              | <span data-ttu-id="9342d-142">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-142">n/a</span></span>                        |
| <span data-ttu-id="9342d-143">displayName</span><span class="sxs-lookup"><span data-stu-id="9342d-143">displayName</span></span>   | <span data-ttu-id="9342d-144">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-144">For internal use only.</span></span> <span data-ttu-id="9342d-145">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-145">Do not use.</span></span>                                              | <span data-ttu-id="9342d-146">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-146">n/a</span></span>                        |
| <span data-ttu-id="9342d-147">autoListFlags</span><span class="sxs-lookup"><span data-stu-id="9342d-147">autoListFlags</span></span> | <span data-ttu-id="9342d-148">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-148">For internal use only.</span></span> <span data-ttu-id="9342d-149">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-149">Do not use.</span></span>                                              | <span data-ttu-id="9342d-150">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-150">n/a</span></span>                        |
| <span data-ttu-id="9342d-151">folderFlags</span><span class="sxs-lookup"><span data-stu-id="9342d-151">folderFlags</span></span>   | <span data-ttu-id="9342d-152">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-152">For internal use only.</span></span> <span data-ttu-id="9342d-153">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-153">Do not use.</span></span>                                              | <span data-ttu-id="9342d-154">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-154">n/a</span></span>                        |
| <span data-ttu-id="9342d-155">taskFlags</span><span class="sxs-lookup"><span data-stu-id="9342d-155">taskFlags</span></span>     | <span data-ttu-id="9342d-156">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-156">For internal use only.</span></span> <span data-ttu-id="9342d-157">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-157">Do not use.</span></span>                                              | <span data-ttu-id="9342d-158">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="9342d-159">\<viewInfo> Elementi figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="9342d-160">Gli elementi figlio dell' \<viewInfo> elemento specificano le colonne visualizzate nei risultati della ricerca in Esplora risorse e il modo in cui i risultati vengono raggruppati e ordinati.</span><span class="sxs-lookup"><span data-stu-id="9342d-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="9342d-161">Ogni elemento figlio contiene un set ordinato di colonne, identificato dai nomi canonici delle proprietà di sistema, ad esempio System. DisplayName.</span><span class="sxs-lookup"><span data-stu-id="9342d-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="9342d-162">Se non è definito nel file di ricerca salvato, i risultati della ricerca vengono presentati con un set predefinito di colonne appropriato per i tipi di file visualizzati.</span><span class="sxs-lookup"><span data-stu-id="9342d-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="9342d-163">Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-163">Element</span></span>               | <span data-ttu-id="9342d-164">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9342d-164">Description</span></span>                                                                                        | <span data-ttu-id="9342d-165">Valori</span><span class="sxs-lookup"><span data-stu-id="9342d-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="9342d-166">visibleColumns</span><span class="sxs-lookup"><span data-stu-id="9342d-166">visibleColumns</span></span>        | <span data-ttu-id="9342d-167">Specifica un elenco ordinato di colonne da visualizzare nella visualizzazione dei risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="9342d-168">L'utente può modificare l'elenco.</span><span class="sxs-lookup"><span data-stu-id="9342d-168">The user can change this list.</span></span> | <span data-ttu-id="9342d-169">Qualsiasi proprietà di sistema.</span><span class="sxs-lookup"><span data-stu-id="9342d-169">Any system property.</span></span>                                         |
| <span data-ttu-id="9342d-170">frequentlyUsedColumns</span><span class="sxs-lookup"><span data-stu-id="9342d-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="9342d-171">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-171">For internal use only.</span></span> <span data-ttu-id="9342d-172">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-172">Do not use.</span></span>                                                                 | <span data-ttu-id="9342d-173">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-173">n/a</span></span>                                                          |
| <span data-ttu-id="9342d-174">columnChooserColumns</span><span class="sxs-lookup"><span data-stu-id="9342d-174">columnChooserColumns</span></span>  | <span data-ttu-id="9342d-175">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-175">For internal use only.</span></span> <span data-ttu-id="9342d-176">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-176">Do not use.</span></span>                                                                 | <span data-ttu-id="9342d-177">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-177">n/a</span></span>                                                          |
| <span data-ttu-id="9342d-178">groupBy</span><span class="sxs-lookup"><span data-stu-id="9342d-178">groupBy</span></span>               | <span data-ttu-id="9342d-179">Specifica una singola proprietà di sistema in base alla quale raggruppare i risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="9342d-180">L'utente può modificare questo valore.</span><span class="sxs-lookup"><span data-stu-id="9342d-180">The user can change this value.</span></span>  | <span data-ttu-id="9342d-181">Qualsiasi proprietà di sistema.</span><span class="sxs-lookup"><span data-stu-id="9342d-181">Any system property.</span></span>                                         |
| <span data-ttu-id="9342d-182">sortList</span><span class="sxs-lookup"><span data-stu-id="9342d-182">sortList</span></span>              | <span data-ttu-id="9342d-183">Specifica un elenco ordinato di colonne per ordinare i risultati in base a.</span><span class="sxs-lookup"><span data-stu-id="9342d-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="9342d-184">Fino a quattro proprietà di sistema.</span><span class="sxs-lookup"><span data-stu-id="9342d-184">Up to four system properties.</span></span> <span data-ttu-id="9342d-185">L'utente può modificare l'elenco.</span><span class="sxs-lookup"><span data-stu-id="9342d-185">The user can change this list.</span></span> |
| <span data-ttu-id="9342d-186">stackList</span><span class="sxs-lookup"><span data-stu-id="9342d-186">stackList</span></span>             | <span data-ttu-id="9342d-187">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-187">For internal use only.</span></span> <span data-ttu-id="9342d-188">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-188">Do not use.</span></span>                                                                 | <span data-ttu-id="9342d-189">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="9342d-190">\<query> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-190">\<query> Element</span></span>

<span data-ttu-id="9342d-191">L' \<query> elemento specifica gli attributi che definiscono il modo in cui vengono eseguite le query sui risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="9342d-192">Nell'esempio seguente viene illustrata la struttura dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="9342d-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="9342d-193">\<query> Elementi figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-193">\<query> Child Elements</span></span>

<span data-ttu-id="9342d-194">La tabella seguente descrive gli elementi figlio dell'elemento \<scope>.</span><span class="sxs-lookup"><span data-stu-id="9342d-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="9342d-195">Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-195">Element</span></span>    | <span data-ttu-id="9342d-196">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9342d-196">Description</span></span>                                                                                                               | <span data-ttu-id="9342d-197">Valore</span><span class="sxs-lookup"><span data-stu-id="9342d-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9342d-198">provider</span><span class="sxs-lookup"><span data-stu-id="9342d-198">providers</span></span>  | <span data-ttu-id="9342d-199">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-199">For internal use only.</span></span> <span data-ttu-id="9342d-200">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="9342d-201">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="9342d-202">Sottoquery</span><span class="sxs-lookup"><span data-stu-id="9342d-202">subQueries</span></span> | <span data-ttu-id="9342d-203">Solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-203">For internal use only.</span></span> <span data-ttu-id="9342d-204">Non usare.</span><span class="sxs-lookup"><span data-stu-id="9342d-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="9342d-205">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="9342d-206">Ambito</span><span class="sxs-lookup"><span data-stu-id="9342d-206">Scope</span></span>      | <span data-ttu-id="9342d-207">Identifica le posizioni da includere o escludere nella ricerca.</span><span class="sxs-lookup"><span data-stu-id="9342d-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="9342d-208">Un percorso o un [ID di cartella noto](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) della posizione da includere o escludere.</span><span class="sxs-lookup"><span data-stu-id="9342d-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="9342d-209">Questo elemento consente inoltre di specificare se la ricerca deve includere/escludere percorsi figlio (ricerca superficiale o approfondita).</span><span class="sxs-lookup"><span data-stu-id="9342d-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="9342d-210">tipo di</span><span class="sxs-lookup"><span data-stu-id="9342d-210">kindList</span></span>   | <span data-ttu-id="9342d-211">Identifica il tipo di file da cercare.</span><span class="sxs-lookup"><span data-stu-id="9342d-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="9342d-212">Qualsiasi valore System. Kind.</span><span class="sxs-lookup"><span data-stu-id="9342d-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="9342d-213">condizioni</span><span class="sxs-lookup"><span data-stu-id="9342d-213">conditions</span></span> | <span data-ttu-id="9342d-214">Specifica le regole per filtrare i risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="9342d-215">Ad esempio, i risultati potrebbero essere limitati ai messaggi di posta elettronica inviati da o a una determinata persona.</span><span class="sxs-lookup"><span data-stu-id="9342d-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="9342d-216">andCondition, orCondition, notCondition, leafCondition.</span><span class="sxs-lookup"><span data-stu-id="9342d-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="9342d-217">\<scope> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-217">\<scope> Element</span></span>

<span data-ttu-id="9342d-218">L' \<scope> elemento identifica i percorsi da includere o escludere dalla ricerca.</span><span class="sxs-lookup"><span data-stu-id="9342d-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="9342d-219">L' \<scope> elemento deve contenere almeno un \<include> elemento figlio presente e zero o più \<exclude> elementi.</span><span class="sxs-lookup"><span data-stu-id="9342d-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="9342d-220">I percorsi possono essere specificati come un percorso (le variabili di ambiente sono supportati) o come un [identificatore di cartella noto](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span><span class="sxs-lookup"><span data-stu-id="9342d-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="9342d-221">Inoltre, è possibile specificare ognuno di questi percorsi per eseguire una ricerca approfondita o superficiale impostando l'oggetto non ricorsivo su "true" o "false" (il valore predefinito è ricorsivo).</span><span class="sxs-lookup"><span data-stu-id="9342d-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="9342d-222">Le parti dell'elenco di percorsi incluso possono essere escluse specificando gli elementi exclude.</span><span class="sxs-lookup"><span data-stu-id="9342d-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="9342d-223">Di seguito viene illustrato un \<scope> elemento che eseguirà la ricerca nella cartella speciale documenti, ma non nei relativi elementi figlio, nel volume "e:" e nei relativi elementi figlio, ma non nella directory "e: \\ Windows" o in uno dei relativi elementi figlio:</span><span class="sxs-lookup"><span data-stu-id="9342d-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="9342d-224">\<kindList> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-224">\<kindList> Element</span></span>

<span data-ttu-id="9342d-225">Questi elementi definiscono l'Unione del "tipo" di elementi che devono essere visualizzati nella libreria.</span><span class="sxs-lookup"><span data-stu-id="9342d-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="9342d-226">I valori validi sono:</span><span class="sxs-lookup"><span data-stu-id="9342d-226">The valid values are:</span></span>

- <span data-ttu-id="9342d-227">calendario</span><span class="sxs-lookup"><span data-stu-id="9342d-227">calendar</span></span>
- <span data-ttu-id="9342d-228">communication</span><span class="sxs-lookup"><span data-stu-id="9342d-228">communication</span></span>
- <span data-ttu-id="9342d-229">contact</span><span class="sxs-lookup"><span data-stu-id="9342d-229">contact</span></span>
- <span data-ttu-id="9342d-230">documento</span><span class="sxs-lookup"><span data-stu-id="9342d-230">document</span></span>
- <span data-ttu-id="9342d-231">email</span><span class="sxs-lookup"><span data-stu-id="9342d-231">email</span></span>
- <span data-ttu-id="9342d-232">feed</span><span class="sxs-lookup"><span data-stu-id="9342d-232">feed</span></span>
- <span data-ttu-id="9342d-233">folder</span><span class="sxs-lookup"><span data-stu-id="9342d-233">folder</span></span>
- <span data-ttu-id="9342d-234">gioco</span><span class="sxs-lookup"><span data-stu-id="9342d-234">game</span></span>
- <span data-ttu-id="9342d-235">instantmessage</span><span class="sxs-lookup"><span data-stu-id="9342d-235">instantmessage</span></span>
- <span data-ttu-id="9342d-236">Journal</span><span class="sxs-lookup"><span data-stu-id="9342d-236">journal</span></span>
- <span data-ttu-id="9342d-237">link</span><span class="sxs-lookup"><span data-stu-id="9342d-237">link</span></span>
- <span data-ttu-id="9342d-238">film</span><span class="sxs-lookup"><span data-stu-id="9342d-238">movie</span></span>
- <span data-ttu-id="9342d-239">music</span><span class="sxs-lookup"><span data-stu-id="9342d-239">music</span></span>
- <span data-ttu-id="9342d-240">nota</span><span class="sxs-lookup"><span data-stu-id="9342d-240">note</span></span>
- <span data-ttu-id="9342d-241">picture</span><span class="sxs-lookup"><span data-stu-id="9342d-241">picture</span></span>
- <span data-ttu-id="9342d-242">programma</span><span class="sxs-lookup"><span data-stu-id="9342d-242">program</span></span>
- <span data-ttu-id="9342d-243">recordedtv</span><span class="sxs-lookup"><span data-stu-id="9342d-243">recordedtv</span></span>
- <span data-ttu-id="9342d-244">SearchFolder</span><span class="sxs-lookup"><span data-stu-id="9342d-244">searchfolder</span></span>
- <span data-ttu-id="9342d-245">attività</span><span class="sxs-lookup"><span data-stu-id="9342d-245">task</span></span>
- <span data-ttu-id="9342d-246">Video</span><span class="sxs-lookup"><span data-stu-id="9342d-246">video</span></span>
- <span data-ttu-id="9342d-247">cronologia webhistory</span><span class="sxs-lookup"><span data-stu-id="9342d-247">webhistory</span></span>
- <span data-ttu-id="9342d-248">item</span><span class="sxs-lookup"><span data-stu-id="9342d-248">item</span></span>
- <span data-ttu-id="9342d-249">altro</span><span class="sxs-lookup"><span data-stu-id="9342d-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="9342d-250">\<conditions> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-250">\<conditions> Element</span></span>

<span data-ttu-id="9342d-251">Le condizioni sono filtri in base ai quali vengono confrontati i risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="9342d-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="9342d-252">Ad esempio, è possibile filtrare i risultati che soddisfano determinati criteri, come il nome dell'autore o le dimensioni del file.</span><span class="sxs-lookup"><span data-stu-id="9342d-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="9342d-253">Il set di condizioni è incorporato in un singolo albero di condizione con rami AND, OR e NOT logici.</span><span class="sxs-lookup"><span data-stu-id="9342d-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="9342d-254">Nell'esempio seguente viene illustrata la struttura dell' \<condition> elemento.</span><span class="sxs-lookup"><span data-stu-id="9342d-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="9342d-255">Il tipo di condizione può essere uno dei seguenti:</span><span class="sxs-lookup"><span data-stu-id="9342d-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="9342d-256">Tipo</span><span class="sxs-lookup"><span data-stu-id="9342d-256">Type</span></span>          | <span data-ttu-id="9342d-257">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9342d-257">Description</span></span>                                 | <span data-ttu-id="9342d-258">Attributi disponibili</span><span class="sxs-lookup"><span data-stu-id="9342d-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="9342d-259">andCondition</span><span class="sxs-lookup"><span data-stu-id="9342d-259">andCondition</span></span>  | <span data-ttu-id="9342d-260">Combinazione di due o più condizioni figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="9342d-261">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-261">n/a</span></span>                                                |
| <span data-ttu-id="9342d-262">orCondition</span><span class="sxs-lookup"><span data-stu-id="9342d-262">orCondition</span></span>   | <span data-ttu-id="9342d-263">Disgiunzione di due di più condizioni figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="9342d-264">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-264">n/a</span></span>                                                |
| <span data-ttu-id="9342d-265">notCondition</span><span class="sxs-lookup"><span data-stu-id="9342d-265">notCondition</span></span>  | <span data-ttu-id="9342d-266">Negazione di una condizione figlio</span><span class="sxs-lookup"><span data-stu-id="9342d-266">Negation of a child condition</span></span>               | <span data-ttu-id="9342d-267">n/d</span><span class="sxs-lookup"><span data-stu-id="9342d-267">n/a</span></span>                                                |
| <span data-ttu-id="9342d-268">leafCondition</span><span class="sxs-lookup"><span data-stu-id="9342d-268">leafCondition</span></span> | <span data-ttu-id="9342d-269">Confronta una proprietà con value</span><span class="sxs-lookup"><span data-stu-id="9342d-269">Compares a property to value</span></span>                | <span data-ttu-id="9342d-270">Proprietà, propertyType, operatore, valore, ValueType</span><span class="sxs-lookup"><span data-stu-id="9342d-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="9342d-271">Gli \<leafCondition> attributi dell'elemento identificano le proprietà e i valori con i quali vengono filtrati i risultati.</span><span class="sxs-lookup"><span data-stu-id="9342d-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="9342d-272">Esempio: \<conditions> element</span><span class="sxs-lookup"><span data-stu-id="9342d-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="9342d-273">Nell'esempio seguente vengono filtrati i risultati per tutti gli elementi non letti creati da John.</span><span class="sxs-lookup"><span data-stu-id="9342d-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="9342d-274">Ovvero la proprietà System. IsAuthorized è false e la stringa "John" viene visualizzata nelle proprietà System. Author o System. ItemAuthors.</span><span class="sxs-lookup"><span data-stu-id="9342d-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="9342d-275">\<properties> Elemento</span><span class="sxs-lookup"><span data-stu-id="9342d-275">\<properties> Element</span></span>

<span data-ttu-id="9342d-276">L' \<properties> elemento descrive le proprietà della ricerca salvata.</span><span class="sxs-lookup"><span data-stu-id="9342d-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="9342d-277">I file di ricerca salvati supportano quattro proprietà: \<author> , \<kind> , \<description> e \<tags> .</span><span class="sxs-lookup"><span data-stu-id="9342d-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="9342d-278">Sono solo per uso interno.</span><span class="sxs-lookup"><span data-stu-id="9342d-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="9342d-279">Specifica completa del formato di file search-ms</span><span class="sxs-lookup"><span data-stu-id="9342d-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="9342d-280">Di seguito è riportato un esempio del codice XML completo per un file di ricerca salvato.</span><span class="sxs-lookup"><span data-stu-id="9342d-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="9342d-281">Esempi di ricerche salvate</span><span class="sxs-lookup"><span data-stu-id="9342d-281">Examples of Saved Searches</span></span>

<span data-ttu-id="9342d-282">Di seguito sono riportati alcuni esempi di \* file con estensione search-ms.</span><span class="sxs-lookup"><span data-stu-id="9342d-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="9342d-283">Documenti recenti. search-ms</span><span class="sxs-lookup"><span data-stu-id="9342d-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="9342d-284">Music recenti. search-ms</span><span class="sxs-lookup"><span data-stu-id="9342d-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="9342d-285">Condiviso recentemente da me. search-ms</span><span class="sxs-lookup"><span data-stu-id="9342d-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
