---
description: Per eseguire il mapping dei dati da un file alla memoria virtuale di un processo, è necessario creare una vista del file.
ms.assetid: b1ebd9a4-cde4-4c0c-80d2-5ccb655cd3a4
title: Creazione di una visualizzazione file
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 498f7ba132efd9ecf82f9ec087492c9622824b51
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967421"
---
# <a name="creating-a-file-view"></a><span data-ttu-id="07f92-103">Creazione di una visualizzazione file</span><span class="sxs-lookup"><span data-stu-id="07f92-103">Creating a File View</span></span>

<span data-ttu-id="07f92-104">Per eseguire il mapping dei dati da un file alla memoria virtuale di un processo, è necessario creare una vista del file.</span><span class="sxs-lookup"><span data-stu-id="07f92-104">To map the data from a file to the virtual memory of a process, you must create a view of the file.</span></span> <span data-ttu-id="07f92-105">Le funzioni [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) e [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) usano l'handle dell'oggetto di mapping dei file restituito da [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) per creare una visualizzazione del file o una parte del file nello spazio degli indirizzi virtuali del processo.</span><span class="sxs-lookup"><span data-stu-id="07f92-105">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) and [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) functions use the file mapping object handle returned by [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) to create a view of the file or a portion of the file in the process's virtual address space.</span></span> <span data-ttu-id="07f92-106">Queste funzioni hanno esito negativo se i flag di accesso sono in conflitto con quelli specificati quando **CreateFileMapping** ha creato l'oggetto di mapping dei file.</span><span class="sxs-lookup"><span data-stu-id="07f92-106">These functions fail if the access flags conflict with those specified when **CreateFileMapping** created the file mapping object.</span></span>

<span data-ttu-id="07f92-107">La funzione [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) restituisce un puntatore alla visualizzazione file.</span><span class="sxs-lookup"><span data-stu-id="07f92-107">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function returns a pointer to the file view.</span></span> <span data-ttu-id="07f92-108">Dereferenziando un puntatore nell'intervallo di indirizzi specificato in **MapViewOfFile**, un'applicazione può leggere i dati dal file e scrivere i dati nel file.</span><span class="sxs-lookup"><span data-stu-id="07f92-108">By dereferencing a pointer in the range of addresses specified in **MapViewOfFile**, an application can read data from the file and write data to the file.</span></span> <span data-ttu-id="07f92-109">La scrittura nella visualizzazione file comporta modifiche all'oggetto mapping dei file.</span><span class="sxs-lookup"><span data-stu-id="07f92-109">Writing to the file view results in changes to the file mapping object.</span></span> <span data-ttu-id="07f92-110">La scrittura effettiva nel file su disco viene gestita dal sistema.</span><span class="sxs-lookup"><span data-stu-id="07f92-110">The actual writing to the file on disk is handled by the system.</span></span> <span data-ttu-id="07f92-111">I dati non vengono effettivamente trasferiti nel momento in cui viene scritto l'oggetto di mapping dei file.</span><span class="sxs-lookup"><span data-stu-id="07f92-111">Data is not actually transferred at the time the file mapping object is written to.</span></span> <span data-ttu-id="07f92-112">Al contrario, gran parte dell'input e dell'output (I/O) del file viene memorizzata nella cache per migliorare le prestazioni generali del sistema.</span><span class="sxs-lookup"><span data-stu-id="07f92-112">Instead, much of the file input and output (I/O) is cached to improve general system performance.</span></span> <span data-ttu-id="07f92-113">Le applicazioni possono eseguire l'override di questo comportamento chiamando la funzione [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) per forzare il sistema a eseguire immediatamente le transazioni disco.</span><span class="sxs-lookup"><span data-stu-id="07f92-113">Applications can override this behavior by calling the [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) function to force the system to perform disk transactions immediately.</span></span>

<span data-ttu-id="07f92-114">La funzione [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) funziona esattamente come la funzione [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) ad eccezione del fatto che consente a un processo di specificare l'indirizzo di base della vista del file nello spazio degli indirizzi virtuali del processo nel parametro *lpvBase* .</span><span class="sxs-lookup"><span data-stu-id="07f92-114">The [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function works exactly like the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function except that it allows a process to specify the base address of the view of the file in the process's virtual address space in the *lpvBase* parameter.</span></span> <span data-ttu-id="07f92-115">Se non è disponibile spazio sufficiente nell'indirizzo specificato, la chiamata ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="07f92-115">If there is not enough space at the specified address, the call fails.</span></span> <span data-ttu-id="07f92-116">Pertanto, se è necessario eseguire il mapping di un file allo stesso indirizzo in più processi, i processi devono negoziare un indirizzo appropriato: il parametro *lpvBase* deve essere un multiplo integrale della granularità dell'allocazione di memoria di sistema o la chiamata non riesce.</span><span class="sxs-lookup"><span data-stu-id="07f92-116">Therefore, if you must map a file to the same address in multiple processes, the processes should negotiate an appropriate address: The *lpvBase* parameter must be an integral multiple of the system memory allocation granularity or the call fails.</span></span> <span data-ttu-id="07f92-117">Per ottenere la granularità dell'allocazione di memoria del sistema, utilizzare la funzione [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) , che compila i membri di una struttura di [**\_ informazioni di sistema**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) .</span><span class="sxs-lookup"><span data-stu-id="07f92-117">To obtain the system's memory allocation granularity, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function, which fills in the members of a [**SYSTEM\_INFO**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) structure.</span></span>

<span data-ttu-id="07f92-118">Un'applicazione può creare più visualizzazioni di file dallo stesso oggetto mapping di file.</span><span class="sxs-lookup"><span data-stu-id="07f92-118">An application can create multiple file views from the same file mapping object.</span></span> <span data-ttu-id="07f92-119">Una visualizzazione file può avere dimensioni diverse rispetto all'oggetto di mapping dei file da cui viene derivata, ma deve essere inferiore all'oggetto mapping di file.</span><span class="sxs-lookup"><span data-stu-id="07f92-119">A file view can be a different size than the file mapping object from which it is derived, but it must be smaller than the file mapping object.</span></span> <span data-ttu-id="07f92-120">L'offset specificato dai parametri *dwOffsetHigh* e *dwOffsetLow* di [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) deve essere un multiplo della granularità di allocazione del sistema.</span><span class="sxs-lookup"><span data-stu-id="07f92-120">The offset specified by the *dwOffsetHigh* and *dwOffsetLow* parameters of [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) must be a multiple of the allocation granularity of the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="07f92-121">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="07f92-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="07f92-122">Creazione di una vista in un file</span><span class="sxs-lookup"><span data-stu-id="07f92-122">Creating a View Within a File</span></span>](creating-a-view-within-a-file.md)
</dt> </dl>

 

 
