---
description: Il mapping dei file può essere usato per condividere un file o una memoria tra due o più processi. Per condividere un file o una memoria, tutti i processi devono usare il nome o l'handle dello stesso oggetto mapping di file.
ms.assetid: 942cb50d-df07-444f-bba5-58194556ae66
title: Condivisione di file e memoria
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98d402eba3f87f1f799593ae0d6b23fba06124a8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103751727"
---
# <a name="sharing-files-and-memory"></a><span data-ttu-id="2d97c-104">Condivisione di file e memoria</span><span class="sxs-lookup"><span data-stu-id="2d97c-104">Sharing Files and Memory</span></span>

<span data-ttu-id="2d97c-105">Il mapping dei file può essere usato per condividere un file o una memoria tra due o più processi.</span><span class="sxs-lookup"><span data-stu-id="2d97c-105">File mapping can be used to share a file or memory between two or more processes.</span></span> <span data-ttu-id="2d97c-106">Per condividere un file o una memoria, tutti i processi devono usare il nome o l'handle dello stesso oggetto mapping di file.</span><span class="sxs-lookup"><span data-stu-id="2d97c-106">To share a file or memory, all of the processes must use the name or the handle of the same file mapping object.</span></span>

<span data-ttu-id="2d97c-107">Per condividere un file, il primo processo crea o apre un file utilizzando la funzione [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="2d97c-107">To share a file, the first process creates or opens a file by using the [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="2d97c-108">Successivamente, viene creato un oggetto mapping di file utilizzando la funzione [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) , specificando l'handle di file e un nome per l'oggetto mapping di file.</span><span class="sxs-lookup"><span data-stu-id="2d97c-108">Next, it creates a file mapping object by using the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function, specifying the file handle and a name for the file mapping object.</span></span> <span data-ttu-id="2d97c-109">I nomi degli oggetti evento, semaforo, mutex, timer waitable, processo e mapping file condividono lo stesso spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="2d97c-109">The names of event, semaphore, mutex, waitable timer, job, and file mapping objects share the same namespace.</span></span> <span data-ttu-id="2d97c-110">Pertanto, le funzioni **CreateFileMapping** e [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) hanno esito negativo se specificano un nome usato da un oggetto di un altro tipo.</span><span class="sxs-lookup"><span data-stu-id="2d97c-110">Therefore, the **CreateFileMapping** and [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) functions fail if they specify a name that is in use by an object of another type.</span></span>

<span data-ttu-id="2d97c-111">Per condividere memoria non associata a un file, un processo deve usare la funzione [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) e specificare un \_ valore di handle non valido \_ come parametro *hFile* anziché come handle di file esistente.</span><span class="sxs-lookup"><span data-stu-id="2d97c-111">To share memory that is not associated with a file, a process must use the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function and specify INVALID\_HANDLE\_VALUE as the *hFile* parameter instead of an existing file handle.</span></span> <span data-ttu-id="2d97c-112">L'oggetto di mapping dei file corrispondente accede alla memoria supportata dal file di paging del sistema.</span><span class="sxs-lookup"><span data-stu-id="2d97c-112">The corresponding file mapping object accesses memory backed by the system paging file.</span></span> <span data-ttu-id="2d97c-113">Quando si specifica un valore *di* handle non valido \_ \_ in una chiamata a **CreateFileMapping**, è necessario specificare una dimensione maggiore di zero.</span><span class="sxs-lookup"><span data-stu-id="2d97c-113">You must specify a size greater than zero when you specify an *hFile* of INVALID\_HANDLE\_VALUE in a call to **CreateFileMapping**.</span></span>

<span data-ttu-id="2d97c-114">Il modo più semplice per ottenere un handle dell'oggetto mapping dei file creato dal primo processo da parte di altri processi consiste nell'utilizzare la funzione [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) e specificare il nome dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2d97c-114">The easiest way for other processes to obtain a handle of the file mapping object created by the first process is to use the [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) function and specify the object's name.</span></span> <span data-ttu-id="2d97c-115">Questa operazione viene definita *memoria condivisa denominata*.</span><span class="sxs-lookup"><span data-stu-id="2d97c-115">This is referred to as *named shared memory*.</span></span> <span data-ttu-id="2d97c-116">Se l'oggetto di mapping dei file non dispone di un nome, il processo deve ottenere un handle tramite l'ereditarietà o la duplicazione.</span><span class="sxs-lookup"><span data-stu-id="2d97c-116">If the file mapping object does not have a name, the process must obtain a handle to it through inheritance or duplication.</span></span> <span data-ttu-id="2d97c-117">Per ulteriori informazioni sull'ereditarietà e la duplicazione, vedere [ereditarietà](../procthread/inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="2d97c-117">For more information on inheritance and duplication, see [Inheritance](../procthread/inheritance.md).</span></span>

<span data-ttu-id="2d97c-118">I processi che condividono file o memoria devono creare visualizzazioni di file tramite la funzione [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) o [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) .</span><span class="sxs-lookup"><span data-stu-id="2d97c-118">Processes that share files or memory must create file views by using the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) or [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function.</span></span> <span data-ttu-id="2d97c-119">Devono coordinare l'accesso tramite semafori, mutex, eventi o altre tecniche di esclusione reciproca.</span><span class="sxs-lookup"><span data-stu-id="2d97c-119">They must coordinate their access using semaphores, mutexes, events, or some other mutual exclusion technique.</span></span> <span data-ttu-id="2d97c-120">Per ulteriori informazioni, vedere [sincronizzazione](../sync/synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="2d97c-120">For more information, see [Synchronization](../sync/synchronization.md).</span></span>

<span data-ttu-id="2d97c-121">Un oggetto mapping dei file condivisi non verrà eliminato definitivamente fino a quando tutti i processi che lo usano non ne chiuderanno gli handle usando la funzione [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="2d97c-121">A shared file mapping object will not be destroyed until all processes that use it close their handles to it by using the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span>

<span data-ttu-id="2d97c-122">Per informazioni sulla sicurezza degli oggetti di mapping dei file, vedere [sicurezza e accesso ai file](file-mapping-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="2d97c-122">For information about file mapping object security, see [File Mapping Security and Access Rights](file-mapping-security-and-access-rights.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2d97c-123">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="2d97c-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2d97c-124">Creazione di una memoria condivisa denominata</span><span class="sxs-lookup"><span data-stu-id="2d97c-124">Creating Named Shared Memory</span></span>](creating-named-shared-memory.md)
</dt> </dl>

 

 
