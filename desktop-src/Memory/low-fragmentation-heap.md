---
description: La frammentazione dell'heap è uno stato in cui la memoria disponibile viene suddivisa in blocchi piccoli e non contigui.
ms.assetid: d10abf82-423c-4942-b05e-55de3a5c4219
title: Heap con frammentazione bassa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8ad14a97fa6d95b663f63b21f0982332ba0de01e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311736"
---
# <a name="low-fragmentation-heap"></a><span data-ttu-id="82e6d-103">Heap con frammentazione bassa</span><span class="sxs-lookup"><span data-stu-id="82e6d-103">Low-fragmentation Heap</span></span>

<span data-ttu-id="82e6d-104">\[Le informazioni contenute in questo argomento si applicano a Windows Server 2003 e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="82e6d-104">\[The information in this topic applies to Windows Server 2003 and Windows XP.</span></span> <span data-ttu-id="82e6d-105">A partire da Windows Vista, il sistema usa l'heap di frammentazione bassa (LFH) in base alle esigenze per soddisfare le richieste di allocazione della memoria.</span><span class="sxs-lookup"><span data-stu-id="82e6d-105">Starting with Windows Vista, the system uses the low-fragmentation heap (LFH) as needed to service memory allocation requests.</span></span> <span data-ttu-id="82e6d-106">Per le applicazioni non è necessario abilitare il LFH per gli heap.\]</span><span class="sxs-lookup"><span data-stu-id="82e6d-106">Applications do not need to enable the LFH for their heaps.\]</span></span>

<span data-ttu-id="82e6d-107">La frammentazione dell'heap è uno stato in cui la memoria disponibile viene suddivisa in blocchi piccoli e non contigui.</span><span class="sxs-lookup"><span data-stu-id="82e6d-107">Heap fragmentation is a state in which available memory is broken into small, noncontiguous blocks.</span></span> <span data-ttu-id="82e6d-108">Quando un heap è frammentato, l'allocazione di memoria può non riuscire anche quando la memoria totale disponibile nell'heap è sufficiente per soddisfare una richiesta, perché nessun singolo blocco di memoria è sufficientemente grande.</span><span class="sxs-lookup"><span data-stu-id="82e6d-108">When a heap is fragmented, memory allocation can fail even when the total available memory in the heap is enough to satisfy a request, because no single block of memory is large enough.</span></span> <span data-ttu-id="82e6d-109">L'heap con frammentazione bassa (LFH) consente di ridurre la frammentazione dell'heap.</span><span class="sxs-lookup"><span data-stu-id="82e6d-109">The low-fragmentation heap (LFH) helps to reduce heap fragmentation.</span></span>

<span data-ttu-id="82e6d-110">LFH non è un heap separato.</span><span class="sxs-lookup"><span data-stu-id="82e6d-110">The LFH is not a separate heap.</span></span> <span data-ttu-id="82e6d-111">Bensì un criterio che le applicazioni possono abilitare per gli heap.</span><span class="sxs-lookup"><span data-stu-id="82e6d-111">Instead, it is a policy that applications can enable for their heaps.</span></span> <span data-ttu-id="82e6d-112">Quando LFH è abilitato, il sistema alloca memoria in determinate dimensioni predeterminate.</span><span class="sxs-lookup"><span data-stu-id="82e6d-112">When the LFH is enabled, the system allocates memory in certain predetermined sizes.</span></span> <span data-ttu-id="82e6d-113">Quando un'applicazione richiede un'allocazione di memoria da un heap in cui è abilitato LFH, il sistema alloca il blocco di memoria più piccolo sufficientemente grande da contenere la dimensione richiesta.</span><span class="sxs-lookup"><span data-stu-id="82e6d-113">When an application requests a memory allocation from a heap that has the LFH enabled, the system allocates the smallest block of memory that is large enough to contain the requested size.</span></span> <span data-ttu-id="82e6d-114">Il sistema non utilizza LFH per le allocazioni maggiori di 16 KB, indipendentemente dal fatto che il LFH sia abilitato o meno.</span><span class="sxs-lookup"><span data-stu-id="82e6d-114">The system does not use the LFH for allocations larger than 16 KB, whether or not the LFH is enabled.</span></span>

<span data-ttu-id="82e6d-115">Un'applicazione deve abilitare il LFH solo per l'heap predefinito del processo chiamante o per gli [heap privati](heap-functions.md) creati dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="82e6d-115">An application should enable the LFH only for the default heap of the calling process or for [private heaps](heap-functions.md) that the application has created.</span></span> <span data-ttu-id="82e6d-116">Per abilitare LFH per un heap, usare la funzione [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) per ottenere un handle per l'heap predefinito del processo chiamante oppure usare l'handle per un heap privato creato dalla funzione [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) .</span><span class="sxs-lookup"><span data-stu-id="82e6d-116">To enable the LFH for a heap, use the [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) function to obtain a handle to the default heap of the calling process, or use the handle to a private heap created by the [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) function.</span></span> <span data-ttu-id="82e6d-117">Chiamare quindi la funzione [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) con l'handle.</span><span class="sxs-lookup"><span data-stu-id="82e6d-117">Then call the [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) function with the handle.</span></span>

<span data-ttu-id="82e6d-118">Non è possibile abilitare LFH per gli heap creati con l' **heap \_ Nessuna \_ serializzazione** o per gli heap creati con una dimensione fissa.</span><span class="sxs-lookup"><span data-stu-id="82e6d-118">The LFH cannot be enabled for heaps created with **HEAP\_NO\_SERIALIZE** or for heaps created with a fixed size.</span></span> <span data-ttu-id="82e6d-119">Non è inoltre possibile abilitare LFH se si usano gli strumenti di debug dell'heap negli [strumenti di debug per Windows](/windows-hardware/drivers/debugger/) o [Microsoft Application Verifier](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en).</span><span class="sxs-lookup"><span data-stu-id="82e6d-119">The LFH also cannot be enabled if you are using the heap debugging tools in [Debugging Tools for Windows](/windows-hardware/drivers/debugger/) or [Microsoft Application Verifier](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en).</span></span>

<span data-ttu-id="82e6d-120">Quando LFH è stato abilitato per un heap, non può essere disabilitato.</span><span class="sxs-lookup"><span data-stu-id="82e6d-120">After the LFH has been enabled for a heap, it cannot be disabled.</span></span>

<span data-ttu-id="82e6d-121">Le applicazioni che traggono vantaggio dalla maggior parte dei LFH sono applicazioni multithread che allocano spesso memoria e utilizzano una varietà di dimensioni di allocazione inferiore a 16 KB.</span><span class="sxs-lookup"><span data-stu-id="82e6d-121">Applications that benefit most from the LFH are multithreaded applications that allocate memory frequently and use a variety of allocation sizes under 16 KB.</span></span> <span data-ttu-id="82e6d-122">Tuttavia, non tutte le applicazioni traggono vantaggio dal LFH.</span><span class="sxs-lookup"><span data-stu-id="82e6d-122">However, not all applications benefit from the LFH.</span></span> <span data-ttu-id="82e6d-123">Per valutare gli effetti dell'abilitazione di LFH nell'applicazione, usare i dati di profilatura delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="82e6d-123">To assess the effects of enabling the LFH in your application, use performance profiling data.</span></span>

 

 
