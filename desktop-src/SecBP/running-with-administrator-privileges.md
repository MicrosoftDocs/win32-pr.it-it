---
description: Per evitare attacchi dannosi, determinare se l'applicazione richiede privilegi di amministratore. Per le funzioni che richiedono autorizzazioni di amministratore, creare un'applicazione separata e utilizzare il comando della riga di comando RunAs di Windows.
ms.assetid: afa520fc-c206-49de-8d73-8f6566ec4fb6
title: Esecuzione con privilegi di amministratore
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc28843195e9b5cabadc13aa2317b0bdd8058ef8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106318250"
---
# <a name="running-with-administrator-privileges"></a><span data-ttu-id="c50ae-104">Esecuzione con privilegi di amministratore</span><span class="sxs-lookup"><span data-stu-id="c50ae-104">Running with Administrator Privileges</span></span>

<span data-ttu-id="c50ae-105">Il primo passaggio per stabilire il tipo di account con cui deve essere eseguita l'applicazione consiste nell'esaminare le risorse che l'applicazione userà e le API con privilegi che chiamerà.</span><span class="sxs-lookup"><span data-stu-id="c50ae-105">The first step in establishing which type of account your application needs to run under is to examine what resources the application will use and what privileged APIs it will call.</span></span> <span data-ttu-id="c50ae-106">È possibile che l'applicazione, o parti di grandi dimensioni, non richieda privilegi di amministratore.</span><span class="sxs-lookup"><span data-stu-id="c50ae-106">You may find that the application, or large parts of it, do not require administrator privileges.</span></span> <span data-ttu-id="c50ae-107">La *scrittura di codice sicuro*, di Michael Howard e David LeBlanc, offre un'ottima descrizione di come eseguire questa valutazione ed è altamente consigliata.</span><span class="sxs-lookup"><span data-stu-id="c50ae-107">*Writing Secure Code*, by Michael Howard and David LeBlanc offers an excellent description of how to carry out this assessment and is highly recommended.</span></span> <span data-ttu-id="c50ae-108">Questa risorsa potrebbe non essere disponibile in alcune lingue e paesi.</span><span class="sxs-lookup"><span data-stu-id="c50ae-108">(This resource may not be available in some languages and countries.)</span></span>

<span data-ttu-id="c50ae-109">È possibile fornire i privilegi necessari per l'applicazione, con minore esposizione ad attacchi dannosi usando uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="c50ae-109">You can provide the privileges your application needs with less exposure to malicious attack by using one of the following approaches:</span></span>

-   <span data-ttu-id="c50ae-110">Eseguire con un account con meno privilegi.</span><span class="sxs-lookup"><span data-stu-id="c50ae-110">Run under an account with less privilege.</span></span> <span data-ttu-id="c50ae-111">Un modo per eseguire questa operazione consiste nell'usare [**PrivilegeCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-privilegecheck) per determinare quali privilegi sono abilitati in un token.</span><span class="sxs-lookup"><span data-stu-id="c50ae-111">One way to do this is to use [**PrivilegeCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-privilegecheck) to determine what privileges are enabled in a token.</span></span> <span data-ttu-id="c50ae-112">Se i privilegi disponibili non sono appropriati per l'operazione corrente, è possibile disabilitare tale codice e chiedere all'utente di accedere a un account con privilegi di amministratore.</span><span class="sxs-lookup"><span data-stu-id="c50ae-112">If the available privileges are not adequate for the current operation, you can disable that code and ask the user to logon to an account with administrator privileges.</span></span>
-   <span data-ttu-id="c50ae-113">Suddividere in una funzione di applicazione separata che richiede autorizzazioni di amministratore.</span><span class="sxs-lookup"><span data-stu-id="c50ae-113">Break into a separate application functions that require administrator permissions.</span></span> <span data-ttu-id="c50ae-114">È possibile fornire all'utente un collegamento che esegue il comando RunAs.</span><span class="sxs-lookup"><span data-stu-id="c50ae-114">You can provide for the user a shortcut that executes the RunAs command.</span></span> <span data-ttu-id="c50ae-115">Per istruzioni dettagliate su come configurare il collegamento, cercare "RunAs" nella Guida di.</span><span class="sxs-lookup"><span data-stu-id="c50ae-115">For detailed instructions on how to set up the shortcut, search for "runas" in Help.</span></span> <span data-ttu-id="c50ae-116">A livello di codice, è possibile configurare il comando [RunAs](/windows/desktop/com/runas) sotto la chiave del registro di sistema della [chiave AppID](/windows/desktop/com/appid-key) per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c50ae-116">Programmatically, you can configure the [RunAs](/windows/desktop/com/runas) command under the [AppId Key](/windows/desktop/com/appid-key) registry key for your application.</span></span>
-   <span data-ttu-id="c50ae-117">Autenticare l'utente chiamando [**CredUIPromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduipromptforcredentialsa) (GUI) o [**CredUICmdLinePromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduicmdlinepromptforcredentialsa) (riga di comando) per ottenere il nome utente e la password.</span><span class="sxs-lookup"><span data-stu-id="c50ae-117">Authenticate the user by calling [**CredUIPromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduipromptforcredentialsa) (GUI) or [**CredUICmdLinePromptForCredentials**](/windows/desktop/api/wincred/nf-wincred-creduicmdlinepromptforcredentialsa) (command line) to obtain user name and password.</span></span> <span data-ttu-id="c50ae-118">Per un esempio, vedere [richiesta di credenziali all'utente](asking-the-user-for-credentials.md).</span><span class="sxs-lookup"><span data-stu-id="c50ae-118">For an example, see [Asking the User for Credentials](asking-the-user-for-credentials.md).</span></span>
-   <span data-ttu-id="c50ae-119">Rappresenta l'utente.</span><span class="sxs-lookup"><span data-stu-id="c50ae-119">Impersonate the user.</span></span> <span data-ttu-id="c50ae-120">Un processo che inizia con un account con privilegi elevati, come System, può rappresentare un account utente chiamando [**ImpersonateLoggedOnUser**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) o funzioni Impersonate simili, riducendo così il livello di privilegio.</span><span class="sxs-lookup"><span data-stu-id="c50ae-120">A process that starts under a highly privileged account like System can impersonate a user account by calling [**ImpersonateLoggedOnUser**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser) or similar Impersonate functions, thus reducing privilege level.</span></span> <span data-ttu-id="c50ae-121">Tuttavia, se una chiamata a [**RevertToSelf**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-reverttoself) viene inserita nel thread, il processo torna ai privilegi di sistema originali.</span><span class="sxs-lookup"><span data-stu-id="c50ae-121">However, if a call to [**RevertToSelf**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-reverttoself) is injected into the thread, the process returns to the original System privileges.</span></span>

<span data-ttu-id="c50ae-122">Se è stato determinato che l'applicazione deve essere eseguita con un account con privilegi di amministratore e che è necessario archiviare una password di amministratore nel sistema software, vedere [gestione delle password](handling-passwords.md) per i metodi di esecuzione sicura.</span><span class="sxs-lookup"><span data-stu-id="c50ae-122">If you have determined that your application must run under an account with administrator privileges and that an administrator password must be stored in the software system, see [Handling Passwords](handling-passwords.md) for methods of doing this safely.</span></span>

 

 
