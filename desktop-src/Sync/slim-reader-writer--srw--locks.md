---
description: I blocchi di lettura/scrittura (SRW) Slim consentono ai thread di un singolo processo di accedere alle risorse condivise; sono ottimizzate per la velocità e occupano molto poca memoria.
ms.assetid: 2d439b21-291f-4ff0-910a-c1c27e800019
title: Blocchi di lettura/scrittura (SRW) Slim
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7d76d956e1425531eae43b0daa6817002a92bc
ms.sourcegitcommit: 663239b4560bfd5314e86901c65805c9bbcab07d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/15/2021
ms.locfileid: "106320064"
---
# <a name="slim-readerwriter-srw-locks"></a><span data-ttu-id="aa70d-103">Blocchi di lettura/scrittura (SRW) Slim</span><span class="sxs-lookup"><span data-stu-id="aa70d-103">Slim Reader/Writer (SRW) Locks</span></span>

<span data-ttu-id="aa70d-104">I blocchi di lettura/scrittura (SRW) Slim consentono ai thread di un singolo processo di accedere alle risorse condivise; sono ottimizzate per la velocità e occupano molto poca memoria.</span><span class="sxs-lookup"><span data-stu-id="aa70d-104">Slim reader/writer (SRW) locks enable the threads of a single process to access shared resources; they are optimized for speed and occupy very little memory.</span></span> <span data-ttu-id="aa70d-105">I blocchi di lettura/scrittura Slim non possono essere condivisi tra i processi.</span><span class="sxs-lookup"><span data-stu-id="aa70d-105">Slim reader-writer locks cannot be shared across processes.</span></span>

<span data-ttu-id="aa70d-106">I thread di lettura leggono i dati da una risorsa condivisa, mentre i thread del writer scrivono i dati in una risorsa condivisa.</span><span class="sxs-lookup"><span data-stu-id="aa70d-106">Reader threads read data from a shared resource whereas writer threads write data to a shared resource.</span></span> <span data-ttu-id="aa70d-107">Quando più thread leggono e scrivono usando una risorsa condivisa, i blocchi esclusivi come una sezione critica o un mutex possono diventare un collo di bottiglia se i thread di lettura vengono eseguiti in modo continuo, ma le operazioni di scrittura sono rare.</span><span class="sxs-lookup"><span data-stu-id="aa70d-107">When multiple threads are reading and writing using a shared resource, exclusive locks such as a critical section or mutex can become a bottleneck if the reader threads run continuously but write operations are rare.</span></span>

<span data-ttu-id="aa70d-108">I blocchi SRW forniscono due modalità in cui i thread possono accedere a una risorsa condivisa:</span><span class="sxs-lookup"><span data-stu-id="aa70d-108">SRW locks provide two modes in which threads can access a shared resource:</span></span>

-   <span data-ttu-id="aa70d-109">**Modalità condivisa**, che concede l'accesso condiviso di sola lettura a più thread di lettura, che consente di leggere i dati dalla risorsa condivisa simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="aa70d-109">**Shared mode**, which grants shared read-only access to multiple reader threads, which enables them to read data from the shared resource concurrently.</span></span> <span data-ttu-id="aa70d-110">Se le operazioni di lettura superano le operazioni di scrittura, la concorrenza aumenta le prestazioni e la velocità effettiva rispetto alle sezioni critiche.</span><span class="sxs-lookup"><span data-stu-id="aa70d-110">If read operations exceed write operations, this concurrency increases performance and throughput compared to critical sections.</span></span>
    > [!NOTE]
    > <span data-ttu-id="aa70d-111">I blocchi SRW in modalità condivisa non devono essere acquisiti in modo ricorsivo perché questo può causare deadlock in caso di combinazione con acquisizione esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-111">Shared mode SRW locks should not be acquired recursively as this can lead to deadlocks when combined with exclusive acquisition.</span></span>

-   <span data-ttu-id="aa70d-112">**Modalità esclusiva**, che concede l'accesso in lettura/scrittura a un thread del writer alla volta.</span><span class="sxs-lookup"><span data-stu-id="aa70d-112">**Exclusive mode**, which grants read/write access to one writer thread at a time.</span></span> <span data-ttu-id="aa70d-113">Quando il blocco è stato acquisito in modalità esclusiva, nessun altro thread può accedere alla risorsa condivisa finché il writer non rilascia il blocco.</span><span class="sxs-lookup"><span data-stu-id="aa70d-113">When the lock has been acquired in exclusive mode, no other thread can access the shared resource until the writer releases the lock.</span></span>
    > [!NOTE]
    > <span data-ttu-id="aa70d-114">Impossibile acquisire in modo ricorsivo i blocchi SRW in modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-114">Exclusive mode SRW locks cannot be acquired recursively.</span></span> <span data-ttu-id="aa70d-115">Se un thread tenta di acquisire un blocco che possiede già, il tentativo avrà esito negativo (per [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) o un deadlock (per [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span><span class="sxs-lookup"><span data-stu-id="aa70d-115">If a thread tries to acquire a lock that it already holds, that attempt will fail (for [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) or deadlock (for [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span></span>

<span data-ttu-id="aa70d-116">In entrambe le modalità è possibile acquisire un singolo blocco SRW; i thread Reader possono acquisirlo in modalità condivisa, mentre i thread di scrittura possono acquisirlo in modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-116">A single SRW lock can be acquired in either mode; reader threads can acquire it in shared mode whereas writer threads can acquire it in exclusive mode.</span></span> <span data-ttu-id="aa70d-117">Non esiste alcuna garanzia sull'ordine in cui i thread a cui viene richiesta la proprietà verranno concessi la proprietà; I blocchi SRW non sono corretti né FIFO.</span><span class="sxs-lookup"><span data-stu-id="aa70d-117">There is no guarantee about the order in which threads that request ownership will be granted ownership; SRW locks are neither fair nor FIFO.</span></span>

<span data-ttu-id="aa70d-118">Un blocco SRW è la dimensione di un puntatore.</span><span class="sxs-lookup"><span data-stu-id="aa70d-118">An SRW lock is the size of a pointer.</span></span> <span data-ttu-id="aa70d-119">Il vantaggio è che è veloce aggiornare lo stato di blocco.</span><span class="sxs-lookup"><span data-stu-id="aa70d-119">The advantage is that it is fast to update the lock state.</span></span> <span data-ttu-id="aa70d-120">Lo svantaggio è che è possibile archiviare pochissime informazioni sullo stato, quindi i blocchi SRW non rilevano l'utilizzo ricorsivo errato in modalità condivisa.</span><span class="sxs-lookup"><span data-stu-id="aa70d-120">The disadvantage is that very little state information can be stored, so SRW locks do not detect incorrect recursive use in shared mode.</span></span> <span data-ttu-id="aa70d-121">Inoltre, un thread proprietario di un blocco SRW in modalità condivisa non può aggiornare la propria proprietà del blocco alla modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-121">In addition, a thread that owns an SRW lock in shared mode cannot upgrade its ownership of the lock to exclusive mode.</span></span>

<span data-ttu-id="aa70d-122">Il chiamante deve allocare una struttura SRWLOCK e inizializzarla chiamando [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (per inizializzare la struttura in modo dinamico) o assegnare la costante **SRWLock \_ init** alla variabile della struttura (per inizializzare la struttura in modo statico).</span><span class="sxs-lookup"><span data-stu-id="aa70d-122">The caller must allocate an SRWLOCK structure and initialize it by either calling [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (to initialize the structure dynamically) or assign the constant **SRWLOCK\_INIT** to the structure variable (to initialize the structure statically).</span></span>

<span data-ttu-id="aa70d-123">È possibile usare [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) per trovare l'uso ricorsivo (rientrante) dei blocchi SRW.</span><span class="sxs-lookup"><span data-stu-id="aa70d-123">You can use [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) to find recursive (reentrant) use of SRW locks.</span></span>

<span data-ttu-id="aa70d-124">Di seguito sono riportate le funzioni di blocco SRW.</span><span class="sxs-lookup"><span data-stu-id="aa70d-124">The following are the SRW lock functions.</span></span>

| <span data-ttu-id="aa70d-125">Funzione Lock SRW</span><span class="sxs-lookup"><span data-stu-id="aa70d-125">SRW lock function</span></span>                                                | <span data-ttu-id="aa70d-126">Descrizione</span><span class="sxs-lookup"><span data-stu-id="aa70d-126">Description</span></span>                                                                                                                                       |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="aa70d-127">**AcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="aa70d-127">**AcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)       | <span data-ttu-id="aa70d-128">Acquisisce un blocco SRW in modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-128">Acquires an SRW lock in exclusive mode.</span></span>                                                                                                           |
| [<span data-ttu-id="aa70d-129">**AcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="aa70d-129">**AcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockshared)             | <span data-ttu-id="aa70d-130">Acquisisce un blocco SRW in modalità condivisa.</span><span class="sxs-lookup"><span data-stu-id="aa70d-130">Acquires an SRW lock in shared mode.</span></span>                                                                                                              |
| [<span data-ttu-id="aa70d-131">**InitializeSRWLock**</span><span class="sxs-lookup"><span data-stu-id="aa70d-131">**InitializeSRWLock**</span></span>](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock)                   | <span data-ttu-id="aa70d-132">Inizializzare un blocco SRW.</span><span class="sxs-lookup"><span data-stu-id="aa70d-132">Initialize an SRW lock.</span></span>                                                                                                                           |
| [<span data-ttu-id="aa70d-133">**ComplementareReleaseSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="aa70d-133">**ReleaseSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockexclusive)       | <span data-ttu-id="aa70d-134">Rilascia un blocco SRW aperto in modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-134">Releases an SRW lock that was opened in exclusive mode.</span></span>                                                                                           |
| [<span data-ttu-id="aa70d-135">**ReleaseSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="aa70d-135">**ReleaseSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockshared)             | <span data-ttu-id="aa70d-136">Rilascia un blocco SRW aperto in modalità condivisa.</span><span class="sxs-lookup"><span data-stu-id="aa70d-136">Releases an SRW lock that was opened in shared mode.</span></span>                                                                                              |
| [<span data-ttu-id="aa70d-137">**SleepConditionVariableSRW**</span><span class="sxs-lookup"><span data-stu-id="aa70d-137">**SleepConditionVariableSRW**</span></span>](/windows/win32/api/synchapi/nf-synchapi-sleepconditionvariablesrw)   | <span data-ttu-id="aa70d-138">Dorme sulla variabile di condizione specificata e rilascia il blocco specificato come operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="aa70d-138">Sleeps on the specified condition variable and releases the specified lock as an atomic operation.</span></span>                                                |
| [<span data-ttu-id="aa70d-139">**TryAcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="aa70d-139">**TryAcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive) | <span data-ttu-id="aa70d-140">Tenta di acquisire un blocco di lettura/scrittura (SRW) Slim in modalità esclusiva.</span><span class="sxs-lookup"><span data-stu-id="aa70d-140">Attempts to acquire a slim reader/writer (SRW) lock in exclusive mode.</span></span> <span data-ttu-id="aa70d-141">Se la chiamata ha esito positivo, il thread chiamante acquisisce la proprietà del blocco.</span><span class="sxs-lookup"><span data-stu-id="aa70d-141">If the call is successful, the calling thread takes ownership of the lock.</span></span> |
| [<span data-ttu-id="aa70d-142">**TryAcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="aa70d-142">**TryAcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockshared)       | <span data-ttu-id="aa70d-143">Tenta di acquisire un blocco di lettura/scrittura (SRW) Slim in modalità condivisa.</span><span class="sxs-lookup"><span data-stu-id="aa70d-143">Attempts to acquire a slim reader/writer (SRW) lock in shared mode.</span></span> <span data-ttu-id="aa70d-144">Se la chiamata ha esito positivo, il thread chiamante acquisisce la proprietà del blocco.</span><span class="sxs-lookup"><span data-stu-id="aa70d-144">If the call is successful, the calling thread takes ownership of the lock.</span></span>    |

 
