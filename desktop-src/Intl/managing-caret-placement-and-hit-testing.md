---
description: I linguaggi di script complessi vengono suddivisi in cluster per ScriptShape. Il riordinamento dei caratteri si verifica sempre all'interno dei limiti del cluster. I cluster stessi sono garantiti per avanzare nella direzione dell'ordine di lettura.
ms.assetid: 50b4b643-af96-4a6f-80f9-27a71ce16b0e
title: Gestione della selezione host e hit testing del cursore
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60396a668c89f7392b28adde0bb123060bf50348
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308699"
---
# <a name="managing-caret-placement-and-hit-testing"></a><span data-ttu-id="11ef4-105">Gestione della selezione host e hit testing del cursore</span><span class="sxs-lookup"><span data-stu-id="11ef4-105">Managing Caret Placement and Hit Testing</span></span>

<span data-ttu-id="11ef4-106">I linguaggi di script complessi vengono suddivisi in [cluster](uniscribe-glossary.md) per [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="11ef4-106">Complex script languages are broken into [clusters](uniscribe-glossary.md) by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span> <span data-ttu-id="11ef4-107">Il riordinamento dei caratteri si verifica sempre all'interno dei limiti del cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-107">Character reordering always occurs within cluster boundaries.</span></span> <span data-ttu-id="11ef4-108">I cluster stessi sono garantiti per avanzare nella direzione dell'ordine di lettura.</span><span class="sxs-lookup"><span data-stu-id="11ef4-108">The clusters themselves are guaranteed to advance in the direction of the reading order.</span></span>

<span data-ttu-id="11ef4-109">Le informazioni sul cluster nella matrice del cluster logico vengono utilizzate per condividere equamente la larghezza di un cluster di glifi tra i caratteri logici che rappresentano.</span><span class="sxs-lookup"><span data-stu-id="11ef4-109">Cluster information in the logical cluster array is used to share the width of a cluster of glyphs equally among the logical characters they represent.</span></span> <span data-ttu-id="11ef4-110">Il glifo di lam Alef, ad esempio, è suddiviso in quattro aree:</span><span class="sxs-lookup"><span data-stu-id="11ef4-110">For example, the lam alef glyph is divided into four areas:</span></span>

-   <span data-ttu-id="11ef4-111">Metà principale del Lam.</span><span class="sxs-lookup"><span data-stu-id="11ef4-111">The leading half of the lam.</span></span>
-   <span data-ttu-id="11ef4-112">Metà finale della lam.</span><span class="sxs-lookup"><span data-stu-id="11ef4-112">The trailing half of the lam.</span></span>
-   <span data-ttu-id="11ef4-113">Metà principale del Alef.</span><span class="sxs-lookup"><span data-stu-id="11ef4-113">The leading half of the alef.</span></span>
-   <span data-ttu-id="11ef4-114">Metà finale dell'oggetto Alef.</span><span class="sxs-lookup"><span data-stu-id="11ef4-114">The trailing half of the alef.</span></span>

<span data-ttu-id="11ef4-115">Le convenzioni per la posizione del punto di inserimento all'interno dei cluster dipendono dallo script.</span><span class="sxs-lookup"><span data-stu-id="11ef4-115">Conventions for caret placement within clusters depend on the script.</span></span> <span data-ttu-id="11ef4-116">Per lo script arabo, se la posizione del punto di inserimento è impostata tra un carattere di base e il contrassegno di combinazione, il cursore viene visualizzato a metà del carattere di base.</span><span class="sxs-lookup"><span data-stu-id="11ef4-116">For the Arabic script, if the caret position is set between a base character and its combining mark, the caret is displayed halfway through the base character.</span></span> <span data-ttu-id="11ef4-117">Per lo script tailandese, il punto di inserimento non può essere posizionato all'interno di un cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-117">For the Thai script, the caret cannot be positioned within a cluster.</span></span> <span data-ttu-id="11ef4-118">Quindi, quando l'utente sposta il cursore, l'applicazione deve superare tutti i glifi che compongono il cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-118">Thus, when the user advances the caret, the application must advance past all the glyphs that make up the cluster.</span></span>

<span data-ttu-id="11ef4-119">Le funzioni [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) e [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) si traducono tra le posizioni del cursore (negli offset dei punti di codice) e le posizioni x (in pixel).</span><span class="sxs-lookup"><span data-stu-id="11ef4-119">The [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) functions translate between caret positions (in code point offsets) and x positions (in pixels).</span></span> <span data-ttu-id="11ef4-120">La funzione **ScriptXtoCP** conosce le convenzioni di posizione del punto di inserimento di ogni script:</span><span class="sxs-lookup"><span data-stu-id="11ef4-120">The **ScriptXtoCP** function has knowledge of the caret position conventions of each script:</span></span>

-   <span data-ttu-id="11ef4-121">Per Indian e Thai, le posizioni del punto di inserimento vengono bloccate ai limiti del cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-121">For Indian and Thai, caret positions are snapped to cluster boundaries.</span></span>
-   <span data-ttu-id="11ef4-122">Per l'arabo, le posizioni del punto di inserimento vengono interpolate con i cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-122">For Arabic, caret positions are interpolated with clusters.</span></span>
-   <span data-ttu-id="11ef4-123">Per l'ebraico, nelle versioni precedenti Usp10.dll, la versione 1,420, le posizioni del punto di inserimento vengono interpolate con i cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-123">For Hebrew, in versions prior to Usp10.dll, version 1.420, caret positions are interpolated with clusters.</span></span> <span data-ttu-id="11ef4-124">A partire da Usp10.dll, la versione 1,420, le posizioni del punto di inserimento vengono bloccate ai limiti del cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-124">Beginning with Usp10.dll, version 1.420, caret positions are snapped to cluster boundaries.</span></span>

<span data-ttu-id="11ef4-125">Sia [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) che [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) funzionano solo all'interno delle esecuzioni.</span><span class="sxs-lookup"><span data-stu-id="11ef4-125">Both [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) operate only within runs.</span></span> <span data-ttu-id="11ef4-126">Per le funzioni è necessario che determinati parametri provengano dalle chiamate Uniscribe precedenti, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="11ef4-126">The functions require that certain parameters come from earlier Uniscribe calls, as shown in the following table.</span></span>



| <span data-ttu-id="11ef4-127">Parametro</span><span class="sxs-lookup"><span data-stu-id="11ef4-127">Parameter</span></span>                                        | <span data-ttu-id="11ef4-128">Source (Sorgente)</span><span class="sxs-lookup"><span data-stu-id="11ef4-128">Source</span></span>                                                 |
|--------------------------------------------------|--------------------------------------------------------|
| <span data-ttu-id="11ef4-129">*nei*</span><span class="sxs-lookup"><span data-stu-id="11ef4-129">*psa*</span></span>                                            | <span data-ttu-id="11ef4-130">Come restituito da [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span><span class="sxs-lookup"><span data-stu-id="11ef4-130">As returned by [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span></span> |
| <span data-ttu-id="11ef4-131">*cGlyphspwLogClust*</span><span class="sxs-lookup"><span data-stu-id="11ef4-131">*cGlyphspwLogClust*</span></span><br/> <span data-ttu-id="11ef4-132">*psva*</span><span class="sxs-lookup"><span data-stu-id="11ef4-132">*psva*</span></span><br/> | <span data-ttu-id="11ef4-133">Come restituito da [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="11ef4-133">As returned by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span>     |
| <span data-ttu-id="11ef4-134">*piAdvance*</span><span class="sxs-lookup"><span data-stu-id="11ef4-134">*piAdvance*</span></span>                                      | <span data-ttu-id="11ef4-135">Come restituito da [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span><span class="sxs-lookup"><span data-stu-id="11ef4-135">As returned by [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span></span>     |



 

<span data-ttu-id="11ef4-136">L'applicazione deve stabilire l'esecuzione in cui un determinato offset del cursore o una posizione x è prima di passare le informazioni a [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) o [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span><span class="sxs-lookup"><span data-stu-id="11ef4-136">The application must establish the run in which a given caret offset or x position is before passing the information to [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) or [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span></span> <span data-ttu-id="11ef4-137">Se l'applicazione non salva le informazioni sulla larghezza, può eseguire l'hit testing e il posizionamento del punto di inserimento dopo la visualizzazione di ogni esecuzione.</span><span class="sxs-lookup"><span data-stu-id="11ef4-137">If the application does not save the width information, it can do hit testing and caret placement after displaying each run.</span></span> <span data-ttu-id="11ef4-138">In alternativa, l'applicazione può memorizzare nella cache informazioni sufficienti per eseguire l'hit testing e il posizionamento del punto di inserimento nella riga corrente senza richiedere la rielaborazione del paragrafo.</span><span class="sxs-lookup"><span data-stu-id="11ef4-138">As an alternative, the application can cache enough information to do hit testing and caret placement on the current line without requiring reprocessing of the paragraph.</span></span>

<span data-ttu-id="11ef4-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) restituisce un valore perimetrale finale in modo che l'applicazione conosca il lato del carattere o del cluster su cui l'utente ha fatto clic.</span><span class="sxs-lookup"><span data-stu-id="11ef4-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) returns a trailing edge value so that the application knows the side of the character or cluster on which the user has clicked.</span></span> <span data-ttu-id="11ef4-140">Il valore è 0 o la larghezza del carattere o del cluster nei punti di codice.</span><span class="sxs-lookup"><span data-stu-id="11ef4-140">The value is either 0 or the width of the character or cluster in code points.</span></span> <span data-ttu-id="11ef4-141">La posizione del carattere restituita è la posizione del carattere su cui l'utente ha fatto clic.</span><span class="sxs-lookup"><span data-stu-id="11ef4-141">The returned character position is the position of the character on which the user clicked.</span></span> <span data-ttu-id="11ef4-142">Per altre informazioni, vedere [visualizzazione del cursore nelle stringhe bidirezionali](displaying-the-caret-in-bidirectional-strings.md).</span><span class="sxs-lookup"><span data-stu-id="11ef4-142">For more information, see [Displaying the Caret in Bidirectional Strings](displaying-the-caret-in-bidirectional-strings.md).</span></span>

<span data-ttu-id="11ef4-143">Per i linguaggi come Thai, per i quali l'utente non vuole inserire il punto di inserimento in un cluster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) imposta il flag del lato finale su 0 o sulla larghezza del cluster.</span><span class="sxs-lookup"><span data-stu-id="11ef4-143">For languages such as Thai, for which the user conventionally does not want to place the caret into a cluster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) sets the trailing side flag to 0 or to the cluster width.</span></span> <span data-ttu-id="11ef4-144">Per lingue quali l'arabo, per le quali l'utente si aspetta di poter modificare all'interno di un cluster, **ScriptXtoCP** imposta il flag del lato finale su 0 o su 1.</span><span class="sxs-lookup"><span data-stu-id="11ef4-144">For languages such as Arabic, for which the user expects to be able to edit within a cluster, **ScriptXtoCP** sets the trailing side flag to 0 or to 1.</span></span>

<span data-ttu-id="11ef4-145">Per consentire all'applicazione di definire percorsi validi per il punto di inserimento quando si gestiscono i tasti di direzione, Uniscribe fornisce informazioni sulle posizioni del punto di inserimento valide nel membro **fCharStop** negli attributi logici restituiti da [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span><span class="sxs-lookup"><span data-stu-id="11ef4-145">To help the application establish valid locations for the caret when handling the arrow keys, Uniscribe provides information on valid caret positions in the **fCharStop** member in the logical attributes returned by [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span></span> <span data-ttu-id="11ef4-146">Viene restituito **true** per la maggior parte dei caratteri e **false** per i caratteri Intercluster negli script, ad esempio Thai.</span><span class="sxs-lookup"><span data-stu-id="11ef4-146">**TRUE** is returned for most characters and **FALSE** for intercluster characters in scripts such as Thai.</span></span> <span data-ttu-id="11ef4-147">L'applicazione deve controllare il valore **fNeedsCaretInfo** nella struttura [**delle \_ proprietà dello script**](/windows/desktop/api/Usp10/ns-usp10-script_properties) per un elemento per vedere se è necessario chiamare **ScriptBreak** per verificare la presenza di posizioni di cursore valide.</span><span class="sxs-lookup"><span data-stu-id="11ef4-147">The application should check the **fNeedsCaretInfo** value in the [**SCRIPT\_PROPERTIES**](/windows/desktop/api/Usp10/ns-usp10-script_properties) structure for an item to see if it is necessary to call **ScriptBreak** to check for valid caret positions.</span></span> <span data-ttu-id="11ef4-148">Se il valore **fNeedsCaretInfo** è **false**, tutti i punti di codice sono posizioni di cursore valide.</span><span class="sxs-lookup"><span data-stu-id="11ef4-148">If the **fNeedsCaretInfo** value is **FALSE**, all code points are valid caret positions.</span></span>

## <a name="related-topics"></a><span data-ttu-id="11ef4-149">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="11ef4-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="11ef4-150">Uso di Uniscribe</span><span class="sxs-lookup"><span data-stu-id="11ef4-150">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 




