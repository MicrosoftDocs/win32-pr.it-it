---
description: Questo argomento descrive le istruzioni di programmazione per individuare le stringhe del registro di sistema reindirizzate Per ulteriori informazioni, vedere Utilizzo del reindirizzamento delle stringhe del registro di sistema.
ms.assetid: 03d1512f-35a6-4b3a-9a0e-97e17bd9b126
title: Individuazione di stringhe reindirizzate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f11600ad57c04de54d914c2c876b67967dfa1467
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308702"
---
# <a name="locating-redirected-strings"></a><span data-ttu-id="ee8f5-104">Individuazione di stringhe reindirizzate</span><span class="sxs-lookup"><span data-stu-id="ee8f5-104">Locating Redirected Strings</span></span>

<span data-ttu-id="ee8f5-105">Questo argomento descrive le istruzioni di programmazione per individuare le stringhe del registro di sistema reindirizzate</span><span class="sxs-lookup"><span data-stu-id="ee8f5-105">This topic discusses programming instructions for locating redirected registry strings.</span></span> <span data-ttu-id="ee8f5-106">Per ulteriori informazioni, vedere [utilizzo del reindirizzamento delle stringhe del registro di sistema](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-106">For more information, see [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

## <a name="load-a-language-neutral-registry-value"></a><span data-ttu-id="ee8f5-107">Carica un valore del registro di sistema Language-Neutral</span><span class="sxs-lookup"><span data-stu-id="ee8f5-107">Load a Language-Neutral Registry Value</span></span>

<span data-ttu-id="ee8f5-108">In Windows Vista e versioni successive, l'applicazione MUI utilizza un valore del registro di sistema indipendente dalla lingua per consentire l'accesso alle stringhe specifiche della lingua archiviate in una tabella delle risorse di stringa.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-108">On Windows Vista and later, the MUI application uses a language-neutral registry value to allow access to language-specific strings stored in a string resource table.</span></span> <span data-ttu-id="ee8f5-109">Per altre informazioni, vedere creare una risorsa Language-Neutral in [uso del reindirizzamento delle stringhe del registro di sistema](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-109">For more information, see Create a Language-Neutral Resource in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ee8f5-110">Il codice dell'applicazione che legge il valore indipendente dalla lingua dal registro di sistema deve caricare le stringhe nella lingua dell'interfaccia utente corretta chiamando [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-110">Application code that reads the language-neutral value from the registry should load the strings in the correct user interface language by calling [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span></span> <span data-ttu-id="ee8f5-111">Se si usa questa funzione, l'applicazione non deve gestire in modo esplicito il caricamento delle risorse.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-111">If using this function, your application does not have to deal explicitly with resource loading.</span></span>

<span data-ttu-id="ee8f5-112">Se si sta aggiornando un'applicazione esistente all'uso indipendente dalla lingua del registro di sistema, in genere si manterranno i valori di stringa esistenti, localizzati in inglese o in un'altra lingua singola nel registro di sistema, come fallback e per compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-112">If you are updating an existing application to the language-neutral use of the registry, you will typically keep the existing string values, localized to English or to some other single language in the registry, as fallbacks and for backward compatibility.</span></span> <span data-ttu-id="ee8f5-113">Il mantenimento di una stringa letterale nel registro di sistema consente all'applicazione di eseguire il fallback alla stringa letterale se una chiamata a [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-113">Keeping a literal string in the registry allows the application to fall back to the literal string if a call to [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) fails.</span></span> <span data-ttu-id="ee8f5-114">È necessario decidere come implementare tale fallback, perché MUI non fornisce alcun supporto per tale implementazione.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-114">You must decide how to implement such a fallback, as MUI provides no support for such an implementation.</span></span>

## <a name="use-shell-api-to-set-shortcut-strings-from-the-registry"></a><span data-ttu-id="ee8f5-115">Usare l'API shell per impostare le stringhe di collegamento dal registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-115">Use Shell API to Set Shortcut Strings from the Registry</span></span>

<span data-ttu-id="ee8f5-116">L'applicazione può usare l'API shell per creare stringhe per i collegamenti che collegano file o cartelle nel menu **Start** o sul desktop.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-116">Your application can use the shell API to create strings for shortcuts that link files or folders in the **Start** menu or on the desktop.</span></span> <span data-ttu-id="ee8f5-117">Per altre informazioni, vedere creare risorse per le stringhe di collegamento in [uso del reindirizzamento delle stringhe del registro di sistema](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-117">For more information, see Create Resources for Shortcut Strings in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ee8f5-118">L'applicazione può usare [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) per caricare il nome visualizzato compatibile con MUI per un collegamento.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-118">The application can use [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to load the MUI-compliant display name for a shortcut.</span></span> <span data-ttu-id="ee8f5-119">Per impostare il InfoTip associato, è necessario utilizzare [**IShellLink:: FileDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) .</span><span class="sxs-lookup"><span data-stu-id="ee8f5-119">It should use [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) to set the associated InfoTip.</span></span> <span data-ttu-id="ee8f5-120">Le chiamate registrano le stringhe con il registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-120">The calls register the strings with the registry.</span></span> <span data-ttu-id="ee8f5-121">Si considerino gli esempi seguenti, per i quali "HKCR" rappresenta la \_ \_ chiave del registro di sistema radice delle classi HKEY:</span><span class="sxs-lookup"><span data-stu-id="ee8f5-121">Consider the following examples, for which "HKCR" represents the HKEY\_CLASSES\_ROOT registry key:</span></span>


```C++
HKCR,"CLSID\%CLSID_AntiSpyware%",,,"Windows AntiSpyware"

HKCR,"CLSID\%CLSID_AntiSpyware%","LocalizedString",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-104"

HKCR,"CLSID\%CLSID_AntiSpyware%","InfoTip",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-208"
```



<span data-ttu-id="ee8f5-122">La prima riga fornisce una stringa letterale non localizzata per il fallback e la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-122">The first line provides an unlocalized literal string for fallback and backward compatibility.</span></span> <span data-ttu-id="ee8f5-123">La seconda riga Mostra il modo conforme a MUI per registrare il nome visualizzato.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-123">The second line shows the MUI-compliant way to register the display name.</span></span> <span data-ttu-id="ee8f5-124">Questa riga indica l'identificatore di stringa 104 archiviato in Msascui.exe (per Windows XP) o nel file specifico della lingua associato (per Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-124">This line indicates the string identifier 104 stored in Msascui.exe (for Windows XP) or in its associated language-specific file (for Windows Vista).</span></span> <span data-ttu-id="ee8f5-125">Questo identificatore di stringa corrisponde a "My Network posizioni".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-125">This string identifier corresponds to "My Network Places".</span></span> <span data-ttu-id="ee8f5-126">La terza riga nell'esempio gestisce la registrazione di InfoTip.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-126">The third line in the example handles InfoTip registration.</span></span> <span data-ttu-id="ee8f5-127">% CLSID \_ antispyware% specifica una variabile di ambiente che rappresenta il GUID corrispondente all'identificatore di classe del componente.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-127">%CLSID\_AntiSpyware% specifies an environment variable representing the GUID that matches the class identifier of this component.</span></span>

<span data-ttu-id="ee8f5-128">Per l'esempio illustrato in precedenza, l'applicazione chiama [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) per specificare il percorso del file eseguibile per i primi due parametri e specificare *idsRes* come "@% ProgramFiles% \\ Windows AntiSpyware \\MSASCui.exe, 104".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-128">For the example shown above, the application calls [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to specify the path of the executable for the first two parameters, and specify *idsRes* as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,104".</span></span> <span data-ttu-id="ee8f5-129">Una chiamata a [**IShellLink:: FileDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription)specifica il percorso di infotip come "@% ProgramFiles% \\ Windows AntiSpyware \\MSASCui.exe, 208".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-129">A call to [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription), specifies the path for the InfoTip as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,208".</span></span>

## <a name="query-friendly-document-type-names-in-the-registry"></a><span data-ttu-id="ee8f5-130">Eseguire query sui nomi dei tipi di documento nel registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-130">Query Friendly Document Type Names in the Registry</span></span>

<span data-ttu-id="ee8f5-131">La creazione di risorse per i nomi descrittivi dei tipi di documento è illustrata in creare risorse per i nomi dei tipi di documenti descrittivi in [uso del reindirizzamento delle stringhe](using-registry-string-redirection.md)</span><span class="sxs-lookup"><span data-stu-id="ee8f5-131">Resource creation for friendly document type names is discussed in Create Resources for Friendly Document Type Names in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="ee8f5-132">Per eseguire una query su un nome descrittivo del documento, l'applicazione deve usare [**IQueryAssociations:: init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), seguito da una chiamata a [**IQueryAssociations:: GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-132">To query a friendly document name, the application should use [**IQueryAssociations::Init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), followed by a call to [**IQueryAssociations::GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span></span> <span data-ttu-id="ee8f5-133">La chiamata a **IQueryAssociations:: init** specifica il tipo di documento, ad esempio ". txt".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-133">The call to **IQueryAssociations::Init** specifies the document type, for example, ".txt".</span></span> <span data-ttu-id="ee8f5-134">La chiamata a **IQueryAssociations:: GetString** deve specificare ASSOCSTR \_ FRIENDLYDOCNAME come identificatore di stringa.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-134">The call to **IQueryAssociations::GetString** must specify ASSOCSTR\_FRIENDLYDOCNAME as the string identifier.</span></span>

## <a name="register-microsoft-management-console-snap-in-strings-not-read-from-the-registry"></a><span data-ttu-id="ee8f5-135">Registra stringhe di snap-in di Microsoft Management Console non lette dal registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-135">Register Microsoft Management Console Snap-in Strings Not Read from the Registry</span></span>

<span data-ttu-id="ee8f5-136">L'applicazione può utilizzare uno snap-in di Microsoft Management Console (MMC) per ospitare le attività di gestione.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-136">Your application can use a Microsoft Management Console (MMC) snap-in to host its management tasks.</span></span> <span data-ttu-id="ee8f5-137">La maggior parte delle stringhe viene gestita come risorse usando le impostazioni del registro di sistema descritte in creare risorse stringa per Microsoft Management Console Snap-Ins in [uso del reindirizzamento delle stringhe del registro di sistema](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-137">Most strings are handled as resources using the registry settings described in Create String Resources for Microsoft Management Console Snap-Ins in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="ee8f5-138">Tuttavia, alcuni snap-in registrano i valori stringa del registro di sistema che MMC non è in grado di leggere dal registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-138">However, some snap-ins register registry string values that MMC cannot read from the registry.</span></span> <span data-ttu-id="ee8f5-139">In questo caso, è necessario che lo snap-in ottenga i valori usando l'interfaccia [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) , che è compatibile con MUI.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-139">In this case, the snap-in must obtain the values using the [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) interface, which is MUI-compatible.</span></span>

## <a name="set-the-display-name-and-description-for-a-windows-service-from-the-registry"></a><span data-ttu-id="ee8f5-140">Impostare il nome visualizzato e la descrizione di un servizio Windows dal registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-140">Set the Display Name and Description for a Windows Service from the Registry</span></span>

<span data-ttu-id="ee8f5-141">Se l'applicazione MUI usa un servizio Windows, deve visualizzare il nome visualizzato e la descrizione del servizio.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-141">If your MUI application is using a Windows service, it must display the service display name and description.</span></span> <span data-ttu-id="ee8f5-142">Le risorse associate sono descritte in "creare risorse di stringa per un servizio Windows" in [uso del reindirizzamento delle stringhe del registro di sistema](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-142">The associated resources are discussed in "Create String Resources for a Windows Service" in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="ee8f5-143">Per impostare il nome visualizzato del servizio, l'applicazione MUI chiama [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) o [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span><span class="sxs-lookup"><span data-stu-id="ee8f5-143">To set the service display name, the MUI application calls [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) or [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span></span> <span data-ttu-id="ee8f5-144">Il nome è una stringa nel formato " `@<PE-path>,-<stringID>[;<comment>]` ".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-144">The name is a string of the form "`@<PE-path>,-<stringID>[;<comment>]`".</span></span> <span data-ttu-id="ee8f5-145">Se, ad esempio, il servizio è implementato da un file con estensione dll con percorso% ProgramFiles% \\ % MyFile% \\MyDll.dll e l'identificatore di stringa del nome visualizzato specifico della lingua è 347, il parametro viene specificato come " `@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347` ".</span><span class="sxs-lookup"><span data-stu-id="ee8f5-145">For example, if your service is implemented by a .dll file with path %ProgramFiles%\\%MyPath%\\MyDll.dll, and the string identifier of the language-specific display name is 347, the parameter is specified as "`@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347`".</span></span> <span data-ttu-id="ee8f5-146">Le barre rovesciate doppie ( \\ \\ ) sono necessarie perché C/C++ usa la barra rovesciata come carattere di escape nelle stringhe.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-146">The double backslashes (\\\\) are necessary because C/C++ uses the backslash as an escape character in strings.</span></span>

<span data-ttu-id="ee8f5-147">Per impostare la descrizione del servizio specifica del linguaggio, l'applicazione MUI deve fare in modo che il membro **lpDescription** di una struttura di [**\_ Descrizione del servizio**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) indichi una stringa di formato " `@<PE-path>,-<stringID>[;<comment>]` ", facendo riferimento all'identificatore di stringa appropriato.</span><span class="sxs-lookup"><span data-stu-id="ee8f5-147">To set the language-specific service description, the MUI application should make the **lpDescription** member of a [**SERVICE\_DESCRIPTION**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) structure indicate a string of form "`@<PE-path>,-<stringID>[;<comment>]`", referencing the appropriate string identifier.</span></span> <span data-ttu-id="ee8f5-148">Quindi, l'applicazione chiama [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) con il parametro *dwInfoLevel* specificato \_ come \_ Descrizione della configurazione del servizio e il parametro *LpInfo* specificato come struttura della **\_ Descrizione del servizio** .</span><span class="sxs-lookup"><span data-stu-id="ee8f5-148">Then the application calls [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) with parameter *dwInfoLevel* specified as SERVICE\_CONFIG\_DESCRIPTION and parameter *lpInfo* specified as the **SERVICE\_DESCRIPTION** structure.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ee8f5-149">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="ee8f5-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ee8f5-150">Individuazione delle risorse PE Win32</span><span class="sxs-lookup"><span data-stu-id="ee8f5-150">Locating Win32 PE Resources</span></span>](locating-win32-pe-resources.md)
</dt> <dt>

[<span data-ttu-id="ee8f5-151">Uso del reindirizzamento delle stringhe del registro di sistema</span><span class="sxs-lookup"><span data-stu-id="ee8f5-151">Using Registry String Redirection</span></span>](using-registry-string-redirection.md)
</dt> </dl>

 

 
