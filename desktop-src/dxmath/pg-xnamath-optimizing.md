---
description: Questo argomento descrive le considerazioni e le strategie di ottimizzazione con la libreria DirectXMath.
ms.assetid: bcbf8ae1-ed49-fdf7-812d-b2089537ab28
title: Ottimizzazione del codice con la libreria DirectXMath
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15369ab36e199eb1a204cc4b761dc637f114f2a1
ms.sourcegitcommit: adba238660d8a5f4fe98fc6f5d105d56aac3a400
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2021
ms.locfileid: "111827255"
---
# <a name="code-optimization-with-the-directxmath-library"></a><span data-ttu-id="6bad7-103">Ottimizzazione del codice con la libreria DirectXMath</span><span class="sxs-lookup"><span data-stu-id="6bad7-103">Code Optimization with the DirectXMath Library</span></span>

<span data-ttu-id="6bad7-104">Questo argomento descrive le considerazioni e le strategie di ottimizzazione con la libreria DirectXMath.</span><span class="sxs-lookup"><span data-stu-id="6bad7-104">This topic describes optimization considerations and strategies with the DirectXMath Library.</span></span>

-   [<span data-ttu-id="6bad7-105">Usare le funzioni di accesso con parsimonio</span><span class="sxs-lookup"><span data-stu-id="6bad7-105">Use accessors sparingly</span></span>](#use-accessors-sparingly)
-   [<span data-ttu-id="6bad7-106">Usare le impostazioni di compilazione corrette</span><span class="sxs-lookup"><span data-stu-id="6bad7-106">Use correct compilation settings</span></span>](#use-correct-compilation-settings)
-   [<span data-ttu-id="6bad7-107">Usare le funzioni Est quando appropriato</span><span class="sxs-lookup"><span data-stu-id="6bad7-107">Use Est functions when appropriate</span></span>](#use-est-functions-when-appropriate)
-   [<span data-ttu-id="6bad7-108">Usare tipi di dati e operazioni allineati</span><span class="sxs-lookup"><span data-stu-id="6bad7-108">Use Aligned Data Types and Operations</span></span>](#use-aligned-data-types-and-operations)
-   [<span data-ttu-id="6bad7-109">Allineare correttamente le allocazioni</span><span class="sxs-lookup"><span data-stu-id="6bad7-109">Properly Align Allocations</span></span>](#properly-align-allocations)
-   [<span data-ttu-id="6bad7-110">Evitare gli overload degli operatori quando possibile</span><span class="sxs-lookup"><span data-stu-id="6bad7-110">Avoid Operator Overloads When Possible</span></span>](#avoid-operator-overloads-when-possible)
-   [<span data-ttu-id="6bad7-111">Valori denormalizzati</span><span class="sxs-lookup"><span data-stu-id="6bad7-111">Denormals</span></span>](#denormals)
-   [<span data-ttu-id="6bad7-112">Sfruttare la dualità a virgola mobile integer</span><span class="sxs-lookup"><span data-stu-id="6bad7-112">Take Advantage of the Integer Floating Point Duality</span></span>](#take-advantage-of-the-integer-floating-point-duality)
-   [<span data-ttu-id="6bad7-113">Preferisci moduli modello</span><span class="sxs-lookup"><span data-stu-id="6bad7-113">Prefer Template Forms</span></span>](#prefer-template-forms)
-   [<span data-ttu-id="6bad7-114">Uso di DirectXMath con Direct3D</span><span class="sxs-lookup"><span data-stu-id="6bad7-114">Using DirectXMath with Direct3D</span></span>](#using-directxmath-with-direct3d)
-   [<span data-ttu-id="6bad7-115">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6bad7-115">Related topics</span></span>](#related-topics)

## <a name="use-accessors-sparingly"></a><span data-ttu-id="6bad7-116">Usare le funzioni di accesso con parsimonio</span><span class="sxs-lookup"><span data-stu-id="6bad7-116">Use accessors sparingly</span></span>

<span data-ttu-id="6bad7-117">Le operazioni basate su vettori usano i set di istruzioni SIMD e usano registri speciali.</span><span class="sxs-lookup"><span data-stu-id="6bad7-117">Vector-based operations use the SIMD instruction sets and these make use of special registers.</span></span> <span data-ttu-id="6bad7-118">L'accesso ai singoli componenti richiede lo spostamento dai registri SIMD a quelli scalari e di nuovo.</span><span class="sxs-lookup"><span data-stu-id="6bad7-118">Accessing individual components requires moving from the SIMD registers to the scalar ones and back again.</span></span>

<span data-ttu-id="6bad7-119">Quando possibile, è più efficiente inizializzare tutti i componenti di [**un oggetto XMVECTOR**](xmvector-data-type.md) contemporaneamente, anziché usare una serie di singole funzioni di accesso vettoriali.</span><span class="sxs-lookup"><span data-stu-id="6bad7-119">When possible, it is more efficient to initialize all of the components of an [**XMVECTOR**](xmvector-data-type.md) at one time, instead of using a series of individual vector accessors.</span></span>

## <a name="use-correct-compilation-settings"></a><span data-ttu-id="6bad7-120">Usare le impostazioni di compilazione corrette</span><span class="sxs-lookup"><span data-stu-id="6bad7-120">Use correct compilation settings</span></span>

<span data-ttu-id="6bad7-121">Per le destinazioni x86 di Windows, abilitare /arch:SSE2.</span><span class="sxs-lookup"><span data-stu-id="6bad7-121">For Windows x86 targets, enable /arch:SSE2.</span></span> <span data-ttu-id="6bad7-122">Per tutte le destinazioni di Windows, abilitare /fp:fast.</span><span class="sxs-lookup"><span data-stu-id="6bad7-122">For all Windows targets, enable /fp:fast.</span></span>

<span data-ttu-id="6bad7-123">Per impostazione predefinita, la compilazione nella libreria DirectXMath per le destinazioni x86 di Windows viene eseguita con \_ intrinseci SSE XM \_ \_ \_ definiti.</span><span class="sxs-lookup"><span data-stu-id="6bad7-123">By default, compilation against the DirectXMath Library for Window x86 targets is done with \_XM\_SSE\_INTRINSICS\_ defined.</span></span> <span data-ttu-id="6bad7-124">Ciò significa che tutte le funzionalità di DirectXMath useranno le istruzioni SSE2.</span><span class="sxs-lookup"><span data-stu-id="6bad7-124">This means that all DirectXMath functionality will make use of SSE2 instructions.</span></span> <span data-ttu-id="6bad7-125">Tuttavia, lo stesso non vale per altro codice.</span><span class="sxs-lookup"><span data-stu-id="6bad7-125">However, the same is not true for other code.</span></span>

<span data-ttu-id="6bad7-126">Il codice esterno a DirectXMath viene gestito usando le impostazioni predefinite del compilatore.</span><span class="sxs-lookup"><span data-stu-id="6bad7-126">Code outside of DirectXMath is handled using compiler defaults.</span></span> <span data-ttu-id="6bad7-127">Senza questa opzione, il codice generato può spesso usare il codice x87 meno efficiente.</span><span class="sxs-lookup"><span data-stu-id="6bad7-127">Without this switch, the generated code may often use the less efficient x87 code.</span></span>

<span data-ttu-id="6bad7-128">È consigliabile usare sempre la versione più recente disponibile del compilatore.</span><span class="sxs-lookup"><span data-stu-id="6bad7-128">We highly recommend that you always use the latest available version of the compiler.</span></span>

## <a name="use-est-functions-when-appropriate"></a><span data-ttu-id="6bad7-129">Usare le funzioni Est quando appropriato</span><span class="sxs-lookup"><span data-stu-id="6bad7-129">Use Est functions when appropriate</span></span>

<span data-ttu-id="6bad7-130">Molte funzioni hanno una funzione di stima equivalente che termina in Est.</span><span class="sxs-lookup"><span data-stu-id="6bad7-130">Many functions have an equivalent estimation function ending in Est.</span></span> <span data-ttu-id="6bad7-131">Queste funzioni scambiano una certa accuratezza per migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6bad7-131">These functions trade some accuracy for improved performance.</span></span> <span data-ttu-id="6bad7-132">Le funzioni Est sono appropriate per i calcoli non critici in cui l'accuratezza può essere sacrificata per la velocità.</span><span class="sxs-lookup"><span data-stu-id="6bad7-132">Est functions are appropriate for non-critical calculations where accuracy can be sacrificed for speed.</span></span> <span data-ttu-id="6bad7-133">La quantità esatta di accuratezza persa e aumento di velocità dipende dalla piattaforma.</span><span class="sxs-lookup"><span data-stu-id="6bad7-133">The exact amount of lost accuracy and speed increase are platform dependent.</span></span>

<span data-ttu-id="6bad7-134">Ad esempio, è possibile usare la funzione [**XMVector3AngleBetweenNormalsEst**](/windows/win32/api/directxmath/nf-directxmath-xmvector3anglebetweennormalsest) al posto della funzione [**XMVector3AngleBetweenNormals.**](/windows/win32/api/directxmath/nf-directxmath-xmvector3anglebetweennormals)</span><span class="sxs-lookup"><span data-stu-id="6bad7-134">For example, the [**XMVector3AngleBetweenNormalsEst**](/windows/win32/api/directxmath/nf-directxmath-xmvector3anglebetweennormalsest) function could be used in place of the [**XMVector3AngleBetweenNormals**](/windows/win32/api/directxmath/nf-directxmath-xmvector3anglebetweennormals) function.</span></span>

## <a name="use-aligned-data-types-and-operations"></a><span data-ttu-id="6bad7-135">Usare tipi di dati e operazioni allineati</span><span class="sxs-lookup"><span data-stu-id="6bad7-135">Use Aligned Data Types and Operations</span></span>

<span data-ttu-id="6bad7-136">I set di istruzioni SIMD nelle versioni di Windows che supportano SSE2 hanno in genere versioni allineate e non allineate delle operazioni di memoria.</span><span class="sxs-lookup"><span data-stu-id="6bad7-136">The SIMD instruction sets on versions of windows supporting SSE2 typically have aligned and unaligned versions of memory operations.</span></span> <span data-ttu-id="6bad7-137">L'uso delle operazioni allineate è più rapido e deve essere preferibile laddove possibile.</span><span class="sxs-lookup"><span data-stu-id="6bad7-137">The use of the aligned operations is faster, and should be preferred wherever possible.</span></span>

<span data-ttu-id="6bad7-138">La libreria DirectXMath fornisce funzionalità allineate e non allineate di accesso tramite tipi di vettori varianti, struttura e funzioni.</span><span class="sxs-lookup"><span data-stu-id="6bad7-138">The DirectXMath Library provides access aligned and unaligned functionality through variant vector types, structure, and functions.</span></span> <span data-ttu-id="6bad7-139">Queste varianti sono indicate da una "A" alla fine del nome.</span><span class="sxs-lookup"><span data-stu-id="6bad7-139">These variants are indicated by an "A" at the end of the name.</span></span>

<span data-ttu-id="6bad7-140">Ad esempio, sono presenti una struttura [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4) non allineata e una struttura [**XMFLOAT4X4A**](/previous-versions/windows/desktop/legacy/ee419623(v=vs.85)) allineata, usate rispettivamente dalle funzioni [**XMStoreFloat4**](/windows/win32/api/directxmath/nf-directxmath-xmstorefloat4) e [**XMStoreFloat4A.**](/windows/win32/api/directxmath/nf-directxmath-xmstorefloat4a)</span><span class="sxs-lookup"><span data-stu-id="6bad7-140">For example, there are an unaligned [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4) structure and an aligned [**XMFLOAT4X4A**](/previous-versions/windows/desktop/legacy/ee419623(v=vs.85)) structure, which are used by the [**XMStoreFloat4**](/windows/win32/api/directxmath/nf-directxmath-xmstorefloat4) and [**XMStoreFloat4A**](/windows/win32/api/directxmath/nf-directxmath-xmstorefloat4a) functions respectively.</span></span>

## <a name="properly-align-allocations"></a><span data-ttu-id="6bad7-141">Allineare correttamente le allocazioni</span><span class="sxs-lookup"><span data-stu-id="6bad7-141">Properly Align Allocations</span></span>

<span data-ttu-id="6bad7-142">Le versioni allineate degli intrinseci [SSE](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100)) sottostanti la libreria DirectXMath sono più veloci rispetto a quelle non allineate.</span><span class="sxs-lookup"><span data-stu-id="6bad7-142">The aligned versions of the [SSE](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100)) intrinsics underlying the DirectXMath Library are faster than the unaligned.</span></span>

<span data-ttu-id="6bad7-143">Per questo motivo, le operazioni DirectXMath che usano [**oggetti XMVECTOR**](xmvector-data-type.md) e [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) presuppongono che tali oggetti siano allineati a 16 byte.</span><span class="sxs-lookup"><span data-stu-id="6bad7-143">For this reason, DirectXMath operations using [**XMVECTOR**](xmvector-data-type.md) and [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) objects assume those objects are 16-byte aligned.</span></span> <span data-ttu-id="6bad7-144">Questa operazione è automatica per le allocazioni basate su stack, se il codice viene compilato nella libreria DirectXMath usando le impostazioni del compilatore consigliate di Windows (vedere Usare le [impostazioni di](#use-correct-compilation-settings)compilazione corrette).</span><span class="sxs-lookup"><span data-stu-id="6bad7-144">This is automatic for stack based allocations, if code is compiled against the DirectXMath Library using the recommended Windows (see [Use Correct Compilation Settings](#use-correct-compilation-settings)) compiler settings.</span></span> <span data-ttu-id="6bad7-145">Tuttavia, è importante assicurarsi che l'allocazione dell'heap contenente oggetti **XMVECTOR** e **XMMATRIX** o cast a questi tipi soddisfi questi requisiti di allineamento.</span><span class="sxs-lookup"><span data-stu-id="6bad7-145">However, it is important to ensure that heap-allocation containing **XMVECTOR** and **XMMATRIX** objects, or casts to these types, meet these alignment requirements.</span></span>

<span data-ttu-id="6bad7-146">Mentre le allocazioni di memoria di Windows a 64 bit sono allineate a 16 byte, per impostazione predefinita nelle versioni a 32 bit della memoria di Windows allocata è allineata solo a 8 byte.</span><span class="sxs-lookup"><span data-stu-id="6bad7-146">While 64-bit Windows memory allocations are 16-byte aligned, by default on 32 bit versions of Windows memory allocated is only 8-byte aligned.</span></span> <span data-ttu-id="6bad7-147">Per informazioni sul controllo dell'allineamento della memoria, vedere [ \_ aligned \_ malloc](https://docs.microsoft.com/cpp/c-runtime-library/reference/aligned-malloc).</span><span class="sxs-lookup"><span data-stu-id="6bad7-147">For information on controlling memory alignment, see [\_aligned\_malloc](https://docs.microsoft.com/cpp/c-runtime-library/reference/aligned-malloc).</span></span>

<span data-ttu-id="6bad7-148">Quando si usano tipi DirectXMath allineati con la libreria STL (Standard Template Library), è necessario fornire un allocatore personalizzato che garantisca l'allineamento a 16 byte.</span><span class="sxs-lookup"><span data-stu-id="6bad7-148">When using aligned DirectXMath types with the Standard Template Library (STL), you will need to provide a custom allocator that ensures the 16-byte alignment.</span></span> <span data-ttu-id="6bad7-149">Per un esempio di scrittura di un allocatore personalizzato, vedere il [blog](https://devblogs.microsoft.com/cppblog/the-mallocator/) del team di Visual C++ (invece di malloc/free è possibile usare malloc allineato e allineato gratuitamente \_ \_ \_ \_ nell'implementazione).</span><span class="sxs-lookup"><span data-stu-id="6bad7-149">See the Visual C++ Team [blog](https://devblogs.microsoft.com/cppblog/the-mallocator/) for an example of writing a custom allocator (instead of malloc/free you'll want to use \_aligned\_malloc and \_aligned\_free in your implementation).</span></span>

> [!Note]  
> <span data-ttu-id="6bad7-150">Alcuni modelli STL modificano l'allineamento del tipo specificato.</span><span class="sxs-lookup"><span data-stu-id="6bad7-150">Some STL templates modify the provided type's alignment.</span></span> <span data-ttu-id="6bad7-151">Ad esempio, [creare \_ ](/cpp/standard-library/memory-functions?view=vs-2017&preserve-view=true)<>aggiunge alcune informazioni di rilevamento interne che possono o meno rispettare l'allineamento del tipo di utente specificato, determinando membri dati non allineati.</span><span class="sxs-lookup"><span data-stu-id="6bad7-151">For example, [make\_shared<>](/cpp/standard-library/memory-functions?view=vs-2017&preserve-view=true) adds some internal tracking information which may or may not respect the alignment of the provided user type, resulting in unaligned data members.</span></span> <span data-ttu-id="6bad7-152">In questo caso, è necessario usare tipi non allineati anziché tipi allineati.</span><span class="sxs-lookup"><span data-stu-id="6bad7-152">In this case, you need to use unaligned types instead of aligned types.</span></span> <span data-ttu-id="6bad7-153">Se si deriva da classi esistenti, inclusi molti Windows Runtime, è anche possibile modificare l'allineamento di una classe o di una struttura.</span><span class="sxs-lookup"><span data-stu-id="6bad7-153">If you derive from existing classes, including many Windows Runtime objects, you can also modify the alignment of a class or structure.</span></span>

 

## <a name="avoid-operator-overloads-when-possible"></a><span data-ttu-id="6bad7-154">Evitare gli overload degli operatori quando possibile</span><span class="sxs-lookup"><span data-stu-id="6bad7-154">Avoid Operator Overloads When Possible</span></span>

<span data-ttu-id="6bad7-155">Per praticità, diversi tipi, ad esempio [**XMVECTOR**](xmvector-data-type.md) e [**XMMATRIX,**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) dispongono di overload dell'operatore per operazioni aritmetiche comuni.</span><span class="sxs-lookup"><span data-stu-id="6bad7-155">As a convenience feature, a number of types such as [**XMVECTOR**](xmvector-data-type.md) and [**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) have operator overloads for common arithmetic operations.</span></span> <span data-ttu-id="6bad7-156">Questi overload degli operatori tendono a creare numerosi oggetti temporanei.</span><span class="sxs-lookup"><span data-stu-id="6bad7-156">Such operator overloads tend to create numerous temporary objects.</span></span> <span data-ttu-id="6bad7-157">È consigliabile evitare questi overload degli operatori nel codice sensibile alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6bad7-157">We recommend that you avoid these operator overloads in performance sensitive code.</span></span>

## <a name="denormals"></a><span data-ttu-id="6bad7-158">Valori denormalizzati</span><span class="sxs-lookup"><span data-stu-id="6bad7-158">Denormals</span></span>

<span data-ttu-id="6bad7-159">Per supportare calcoli vicini a 0, lo standard A virgola mobile IEEE 754 include il supporto per un underflow graduale.</span><span class="sxs-lookup"><span data-stu-id="6bad7-159">To support computations close to 0, the IEEE 754 float-point standard includes support for gradual underflow.</span></span> <span data-ttu-id="6bad7-160">Il underflow graduale viene implementato tramite l'uso di valori denormalizzati e molte implementazioni hardware sono lente durante la gestione dei denormali.</span><span class="sxs-lookup"><span data-stu-id="6bad7-160">Gradual underflow is implemented through the use of denormalized values, and many hardware implementations are slow when handling denormals.</span></span> <span data-ttu-id="6bad7-161">Un'ottimizzazione da considerare è disabilitare la gestione dei denormali per le operazioni vettoriali usate da DirectXMath.</span><span class="sxs-lookup"><span data-stu-id="6bad7-161">An optimization to consider is to disable the handling of denormals for the vector operations used by DirectXMath.</span></span>

<span data-ttu-id="6bad7-162">La modifica della gestione dei denormali viene eseguita usando la routine [ \_ controlfp \_ s](/cpp/c-runtime-library/reference/controlfp-s) in base al pre-thread e può comportare miglioramenti delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6bad7-162">Changing the handling of denormals is done by using the [\_controlfp\_s](/cpp/c-runtime-library/reference/controlfp-s) routine on a pre-thread basis, and can result in performance improvements.</span></span> <span data-ttu-id="6bad7-163">Usare questo codice per modificare la gestione dei denormali:</span><span class="sxs-lookup"><span data-stu-id="6bad7-163">Use this code to change the handling of denormals:</span></span>


```
  #include <float.h>;
    unsigned int control_word;
    _controlfp_s( &control_word, _DN_FLUSH, _MCW_DN );
```



> [!Note]  
> <span data-ttu-id="6bad7-164">Nelle versioni a 64 bit di Windows, le istruzioni [SSE](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100)) vengono usate per tutti i calcoli, non solo per le operazioni vettoriali.</span><span class="sxs-lookup"><span data-stu-id="6bad7-164">On 64-bit versions of Windows, [SSE](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100)) instructions are used for all computations, not just the vector operations.</span></span> <span data-ttu-id="6bad7-165">La modifica della gestione denormale influisce su tutti i calcoli a virgola mobile nel programma, non solo sulle operazioni vettoriali usate da DirectXMath.</span><span class="sxs-lookup"><span data-stu-id="6bad7-165">Changing the denormal handling affects all floating-point computations in your program, not just the vector operations used by DirectXMath.</span></span>

 

## <a name="take-advantage-of-the-integer-floating-point-duality"></a><span data-ttu-id="6bad7-166">Sfruttare la dualità a virgola mobile integer</span><span class="sxs-lookup"><span data-stu-id="6bad7-166">Take Advantage of the Integer Floating Point Duality</span></span>

<span data-ttu-id="6bad7-167">DirectXMath supporta vettori di 4 valori a virgola mobile e precisione singola o quattro valori a 32 bit (con o senza segno).</span><span class="sxs-lookup"><span data-stu-id="6bad7-167">DirectXMath supports vectors of 4 single-precision floating-point or four 32-bit (signed or unsigned) values.</span></span>

<span data-ttu-id="6bad7-168">Poiché i set di istruzioni usati per implementare la libreria DirectXMath hanno la possibilità di trattare gli stessi dati di più tipi diversi, ad esempio, è possibile considerare lo stesso vettore come ottimizzazioni di dati a virgola mobile e integer.</span><span class="sxs-lookup"><span data-stu-id="6bad7-168">Because the instruction sets used to implement the DirectXMath Library have the ability to treat the same data as multiple different types-for example, treat the same vector as floating-point and integer data-certain optimizations can be achieved.</span></span> <span data-ttu-id="6bad7-169">È possibile ottenere queste ottimizzazioni usando le routine di inizializzazione del vettore integer e gli operatori bit per bit per modificare i valori a virgola mobile.</span><span class="sxs-lookup"><span data-stu-id="6bad7-169">You can get these optimizations by using the integer vector initialization routines and bit-wise operators to manipulate floating-point values.</span></span>

<span data-ttu-id="6bad7-170">Il formato binario dei numeri a virgola mobile a precisione singola usati dalla libreria DirectXMath è completamente conforme allo standard IEEE 764:</span><span class="sxs-lookup"><span data-stu-id="6bad7-170">The binary format of single-precision floating-point numbers used by the DirectXMath Library completely conforms to the IEEE 764 standard:</span></span>

``` syntax
     SIGN    EXPONENT   MANTISSA
     X       XXXXXXXX   XXXXXXXXXXXXXXXXXXXXXXX
     1 bit   8 bits     23 bits
```

<span data-ttu-id="6bad7-171">Quando si utilizza il numero a virgola mobile a precisione singola IEEE 764, è importante tenere presente che alcune rappresentazioni hanno un significato speciale, ovvero non sono conformi alla descrizione precedente.</span><span class="sxs-lookup"><span data-stu-id="6bad7-171">When working with the IEEE 764 single precision floating-point number, it is important to keep in mind, that some representations have special meaning (that is, they do not conform to the preceding description).</span></span> <span data-ttu-id="6bad7-172">Alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="6bad7-172">Examples include:</span></span>

-   <span data-ttu-id="6bad7-173">Lo zero positivo è 0</span><span class="sxs-lookup"><span data-stu-id="6bad7-173">Positive zero is 0</span></span>
-   <span data-ttu-id="6bad7-174">Lo zero negativo è 0x80000000</span><span class="sxs-lookup"><span data-stu-id="6bad7-174">Negative zero is 0x80000000</span></span>
-   <span data-ttu-id="6bad7-175">Q \_ NAN è 07FC0000</span><span class="sxs-lookup"><span data-stu-id="6bad7-175">Q\_NAN is 07FC0000</span></span>
-   <span data-ttu-id="6bad7-176">+INF è 0x7F800000</span><span class="sxs-lookup"><span data-stu-id="6bad7-176">+INF is 0x7F800000</span></span>
-   <span data-ttu-id="6bad7-177">-INF è 0xFF800000</span><span class="sxs-lookup"><span data-stu-id="6bad7-177">-INF is 0xFF800000</span></span>

## <a name="prefer-template-forms"></a><span data-ttu-id="6bad7-178">Preferisci moduli modello</span><span class="sxs-lookup"><span data-stu-id="6bad7-178">Prefer Template Forms</span></span>

<span data-ttu-id="6bad7-179">Il modulo modello esiste per [**XMVectorSwizzle,**](/windows/win32/api/directxmath/nf-directxmath-xmvectorswizzle) [**XMVectorPermute,**](/windows/win32/api/directxmath/nf-directxmath-xmvectorpermute) [**XMVectorInsert,**](/windows/win32/api/directxmath/nf-directxmath-xmvectorinsert) [**XMVectorShiftLeft,**](/windows/win32/api/directxmath/nf-directxmath-xmvectorshiftleft) [**XMVectorRotateLeft**](/windows/win32/api/directxmath/nf-directxmath-xmvectorrotateleft)e [**XMVectorRotateRight.**](/windows/win32/api/directxmath/nf-directxmath-xmvectorrotateright)</span><span class="sxs-lookup"><span data-stu-id="6bad7-179">Template form exists for [**XMVectorSwizzle**](/windows/win32/api/directxmath/nf-directxmath-xmvectorswizzle), [**XMVectorPermute**](/windows/win32/api/directxmath/nf-directxmath-xmvectorpermute), [**XMVectorInsert**](/windows/win32/api/directxmath/nf-directxmath-xmvectorinsert), [**XMVectorShiftLeft**](/windows/win32/api/directxmath/nf-directxmath-xmvectorshiftleft), [**XMVectorRotateLeft**](/windows/win32/api/directxmath/nf-directxmath-xmvectorrotateleft), and [**XMVectorRotateRight**](/windows/win32/api/directxmath/nf-directxmath-xmvectorrotateright).</span></span> <span data-ttu-id="6bad7-180">L'uso di questi elementi al posto del modulo di funzione generale consente al compilatore di creare implementazioni molto più efficenti.</span><span class="sxs-lookup"><span data-stu-id="6bad7-180">Using these instead of the general function form allows the compiler to create much more efficent implementations.</span></span> <span data-ttu-id="6bad7-181">Per [SSE,](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100))questo spesso viene compresso fino a uno o due \_ valori ps \_ \_ casuali.</span><span class="sxs-lookup"><span data-stu-id="6bad7-181">For [SSE](/previous-versions/visualstudio/visual-studio-2010/t467de55(v=vs.100)), this often collapses down to one or two \_mm\_shuffle\_ps values.</span></span> <span data-ttu-id="6bad7-182">Per ARM-NEON, il modello **XMVectorSwizzle** può usare una serie di casi speciali anziché lo swizzle/permute VTBL più generale.</span><span class="sxs-lookup"><span data-stu-id="6bad7-182">For ARM-NEON, the **XMVectorSwizzle** template can utilize a number of special cases rather than the more general VTBL swizzle/permute.</span></span>

## <a name="using-directxmath-with-direct3d"></a><span data-ttu-id="6bad7-183">Uso di DirectXMath con Direct3D</span><span class="sxs-lookup"><span data-stu-id="6bad7-183">Using DirectXMath with Direct3D</span></span>

<span data-ttu-id="6bad7-184">Un uso comune per DirectXMath è eseguire calcoli grafici da usare con Direct3D.</span><span class="sxs-lookup"><span data-stu-id="6bad7-184">A common use for DirectXMath is to perform graphics computations for use with Direct3D.</span></span> <span data-ttu-id="6bad7-185">Con Direct3D 10.x e Direct3D 11.x è possibile usare la libreria DirectXMath in questi modi diretti:</span><span class="sxs-lookup"><span data-stu-id="6bad7-185">With Direct3D 10.x and Direct3D 11.x, you can use the DirectXMath library in these direct ways:</span></span>

-   <span data-ttu-id="6bad7-186">Usare le [](ovw-xnamath-reference-constants.md) costanti dello spazio dei nomi Colors direttamente nel parametro *ColorRGBA* in una chiamata al metodo [**ID3D11DeviceContext::ClearRenderTargetView**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-clearrendertargetview) [**o ID3D10Device::ClearRenderTargetView.**](/windows/win32/api/d3d10/nf-d3d10-id3d10device-clearrendertargetview)</span><span class="sxs-lookup"><span data-stu-id="6bad7-186">Use the Colors namespace [constants](ovw-xnamath-reference-constants.md) directly in the *ColorRGBA* parameter in a call to the [**ID3D11DeviceContext::ClearRenderTargetView**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-clearrendertargetview) or [**ID3D10Device::ClearRenderTargetView**](/windows/win32/api/d3d10/nf-d3d10-id3d10device-clearrendertargetview) method.</span></span> <span data-ttu-id="6bad7-187">Per Direct3D 9, è necessario eseguire la conversione nel tipo [**XMCOLOR**](/windows/desktop/api/DirectXPackedVector/ns-directxpackedvector-xmcolor) per usarlo come parametro *Color* in una chiamata al metodo [**IDirect3DDevice9::Clear.**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear)</span><span class="sxs-lookup"><span data-stu-id="6bad7-187">For Direct3D 9, you must convert to the [**XMCOLOR**](/windows/desktop/api/DirectXPackedVector/ns-directxpackedvector-xmcolor) type to use it as the *Color* parameter in a call to the [**IDirect3DDevice9::Clear**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-clear) method.</span></span>
-   <span data-ttu-id="6bad7-188">Usare i [**tipi XMFLOAT4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4) / [**XMVECTOR**](xmvector-data-type.md) e [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4)XMMATRIX per configurare strutture di buffer costanti per il riferimento da tipi / [](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) [**float4**](../direct3dhlsl/dx-graphics-hlsl-scalar.md) o matrice /float4x4. [](../direct3dhlsl/dx-graphics-hlsl-matrix.md)</span><span class="sxs-lookup"><span data-stu-id="6bad7-188">Use the [**XMFLOAT4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4)/[**XMVECTOR**](xmvector-data-type.md) and [**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4)/[**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) types to setup constant buffer structures for reference by HLSL [**float4**](../direct3dhlsl/dx-graphics-hlsl-scalar.md) or [**matrix**](../direct3dhlsl/dx-graphics-hlsl-matrix.md)/float4x4 types.</span></span>
    > [!Note]  
    > <span data-ttu-id="6bad7-189">[**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4) / [**I tipi XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) sono in formato principale di riga.</span><span class="sxs-lookup"><span data-stu-id="6bad7-189">[**XMFLOAT4X4**](/windows/win32/api/directxmath/ns-directxmath-xmfloat4x4)/[**XMMATRIX**](/windows/win32/api/directxmath/ns-directxmath-xmmatrix) types are in row-major format.</span></span> <span data-ttu-id="6bad7-190">Pertanto, se si usa l'opzione del compilatore /Zpr (flag di compilazione [**D3DCOMPILE \_ PACK MATRIX COLUMN \_ \_ \_ MAJOR)**](../direct3dhlsl/d3dcompile-constants.md) o si omette la parola chiave row major quando si dichiara il tipo di matrice \_ in HLSL, è necessario trasporre la matrice quando viene impostata nel buffer costante. [](../direct3dhlsl/dx-graphics-hlsl-appendix-keywords.md)</span><span class="sxs-lookup"><span data-stu-id="6bad7-190">Therefore, if you use the /Zpr compiler switch (the [**D3DCOMPILE\_PACK\_MATRIX\_COLUMN\_MAJOR**](../direct3dhlsl/d3dcompile-constants.md) compile flag) or omit the row\_major [keyword](../direct3dhlsl/dx-graphics-hlsl-appendix-keywords.md) when you declare the matrix type in HLSL, you must transpose the matrix when you set it into the constant buffer.</span></span>

     

-   <span data-ttu-id="6bad7-191">Con Direct3D 10.x e Direct3D 11.x, è possibile presupporre che il puntatore restituito dal metodo Map (ad [**esempio, ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)) nel membro **pData** ([**D3D10 \_ MAPPED \_ TEXTURE2D**](/windows/win32/api/d3d10/ns-d3d10-d3d10_mapped_texture2d)).**pData**, [**D3D10 \_ MAPPED \_ TEXTURE3D**](/windows/win32/api/d3d10/ns-d3d10-d3d10_mapped_texture3d).**pData** o [**D3D11 \_ MAPPED \_ SUBRESOURCE**](/windows/win32/api/d3d11/ns-d3d11-d3d11_mapped_subresource).**pData**) è allineato a 16 byte se si usa il livello di funzionalità [10](../direct3d11/overviews-direct3d-11-devices-downlevel-intro.md) 0 o superiore o ogni volta che si usano risorse \_ [**D3D11 \_ USAGE \_ STAGING.**](/windows/win32/api/d3d11/ne-d3d11-d3d11_usage)</span><span class="sxs-lookup"><span data-stu-id="6bad7-191">With Direct3D 10.x and Direct3D 11.x, you can assume that the pointer returned by the Map method (for example, [**ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)) in the **pData** member ([**D3D10\_MAPPED\_TEXTURE2D**](/windows/win32/api/d3d10/ns-d3d10-d3d10_mapped_texture2d).**pData**, [**D3D10\_MAPPED\_TEXTURE3D**](/windows/win32/api/d3d10/ns-d3d10-d3d10_mapped_texture3d).**pData**, or [**D3D11\_MAPPED\_SUBRESOURCE**](/windows/win32/api/d3d11/ns-d3d11-d3d11_mapped_subresource).**pData**) is 16-byte aligned if you use [feature level](../direct3d11/overviews-direct3d-11-devices-downlevel-intro.md) 10\_0 or higher or whenever you use [**D3D11\_USAGE\_STAGING**](/windows/win32/api/d3d11/ne-d3d11-d3d11_usage) resources.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6bad7-192">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6bad7-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6bad7-193">Guida per programmatori DirectXMath</span><span class="sxs-lookup"><span data-stu-id="6bad7-193">DirectXMath Programming Guide</span></span>](ovw-xnamath-progguide.md)
</dt> </dl>

 

 
