---
description: Le operazioni pipe, inclusi i client e i server pipe, possono chiamare una delle diverse funzioni, oltre a CallNamedPipe, per leggere e scrivere in un named pipe.
ms.assetid: ae06455e-33bc-433d-be8f-aeb8eeb99b1d
title: Operazioni named pipe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 703189a129fc44b956ab65c2f70bbf88bfd22700
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104128139"
---
# <a name="named-pipe-operations"></a><span data-ttu-id="89b96-103">Operazioni named pipe</span><span class="sxs-lookup"><span data-stu-id="89b96-103">Named Pipe Operations</span></span>

<span data-ttu-id="89b96-104">La prima volta che il server pipe chiama la funzione [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) , usa il parametro *nMaxInstances* per specificare il numero massimo di istanze della pipe che possono esistere simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="89b96-104">The first time the pipe server calls the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function, it uses the *nMaxInstances* parameter to specify the maximum number of instances of the pipe that can exist simultaneously.</span></span> <span data-ttu-id="89b96-105">Il server può chiamare ripetutamente **CreateNamedPipe** per creare istanze aggiuntive della pipe, purché non superi il numero massimo di istanze.</span><span class="sxs-lookup"><span data-stu-id="89b96-105">The server can call **CreateNamedPipe** repeatedly to create additional instances of the pipe, as long as it does not exceed the maximum number of instances.</span></span> <span data-ttu-id="89b96-106">Se la funzione ha esito positivo, ogni chiamata restituisce un handle per la fine del server di un'istanza di named pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-106">If the function succeeds, each call returns a handle to the server end of a named pipe instance.</span></span>

<span data-ttu-id="89b96-107">Non appena il server pipe crea un'istanza di pipe, un client pipe può connettersi ad essa chiamando la funzione [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) o [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) .</span><span class="sxs-lookup"><span data-stu-id="89b96-107">As soon as the pipe server creates a pipe instance, a pipe client can connect to it by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) function.</span></span> <span data-ttu-id="89b96-108">Se è disponibile un'istanza pipe, **CreateFile** restituisce un handle per la fine client dell'istanza pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-108">If a pipe instance is available, **CreateFile** returns a handle to the client end of the pipe instance.</span></span> <span data-ttu-id="89b96-109">Se non sono disponibili istanze della pipe, un client pipe può usare la funzione [**WaitNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-waitnamedpipea) per attendere il completamento della disponibilità di una pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-109">If no instances of the pipe are available, a pipe client can use the [**WaitNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-waitnamedpipea) function to wait until a pipe becomes available.</span></span>

<span data-ttu-id="89b96-110">Un server pipe può determinare quando un client pipe è connesso a un'istanza di pipe chiamando la funzione [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) .</span><span class="sxs-lookup"><span data-stu-id="89b96-110">A pipe server can determine when a pipe client is connected to a pipe instance by calling the [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) function.</span></span> <span data-ttu-id="89b96-111">Se l'handle della pipe è in modalità di blocco-attesa, **ConnectNamedPipe** non restituisce alcun risultato finché non viene connesso un client.</span><span class="sxs-lookup"><span data-stu-id="89b96-111">If the pipe handle is in blocking-wait mode, **ConnectNamedPipe** does not return until a client is connected.</span></span>

<span data-ttu-id="89b96-112">I client e i server pipe possono chiamare una delle diverse funzioni, oltre a [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) , per leggere e scrivere in un named pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-112">Pipe clients and servers can call one of several functions — in addition to [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) — to read from and write to a named pipe.</span></span> <span data-ttu-id="89b96-113">Il comportamento di queste funzioni dipende dal tipo di pipe e dalle modalità attive per l'handle di pipe specificato, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="89b96-113">The behavior of these functions depends on the type of pipe and the modes in effect for the specified pipe handle, as follows:</span></span>

-   <span data-ttu-id="89b96-114">Le funzioni [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) possono essere usate con pipe di tipo byte o di tipo messaggio.</span><span class="sxs-lookup"><span data-stu-id="89b96-114">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) functions can be used with either byte-type or message-type pipes.</span></span>
-   <span data-ttu-id="89b96-115">Le funzioni [**ReadFileEx**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) e [**WriteFileEx**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) possono essere usate con pipe di tipo byte o di tipo messaggio se è stato aperto l'handle della pipe per le operazioni sovrapposte.</span><span class="sxs-lookup"><span data-stu-id="89b96-115">The [**ReadFileEx**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) and [**WriteFileEx**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) functions can be used with either byte-type or message-type pipes if the pipe handle was opened for overlapped operations.</span></span>
-   <span data-ttu-id="89b96-116">La funzione [**PeekNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-peeknamedpipe) può essere utilizzata per leggere senza rimuovere il contenuto di una pipe di tipo byte o una pipe di tipo messaggio.</span><span class="sxs-lookup"><span data-stu-id="89b96-116">The [**PeekNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-peeknamedpipe) function can be used to read without removing the contents of either a byte-type pipe or a message-type pipe.</span></span> <span data-ttu-id="89b96-117">**PeekNamedPipe** può inoltre restituire informazioni aggiuntive sull'istanza della pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-117">**PeekNamedPipe** can also return additional information about the pipe instance.</span></span>
-   <span data-ttu-id="89b96-118">La funzione [**TransactNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe) può essere usata con pipe duplex di tipo messaggio se l'handle della pipe per il processo chiamante è impostato sulla modalità di lettura del messaggio.</span><span class="sxs-lookup"><span data-stu-id="89b96-118">The [**TransactNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe) function can be used with message-type duplex pipes if the pipe handle to the calling process is set to message-read mode.</span></span> <span data-ttu-id="89b96-119">La funzione scrive un messaggio di richiesta e legge un messaggio di risposta in un'unica operazione, migliorando le prestazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="89b96-119">The function writes a request message and reads a reply message in a single operation, enhancing network performance.</span></span>

<span data-ttu-id="89b96-120">Il server pipe non deve eseguire un'operazione di lettura di blocco finché il client pipe non è stato avviato.</span><span class="sxs-lookup"><span data-stu-id="89b96-120">The pipe server should not perform a blocking read operation until the pipe client has started.</span></span> <span data-ttu-id="89b96-121">In caso contrario, può verificarsi un race condition.</span><span class="sxs-lookup"><span data-stu-id="89b96-121">Otherwise, a race condition can occur.</span></span> <span data-ttu-id="89b96-122">Questo problema si verifica in genere quando il codice di inizializzazione, ad esempio quello della libreria di runtime del linguaggio C, deve bloccare ed esaminare gli handle ereditati.</span><span class="sxs-lookup"><span data-stu-id="89b96-122">This typically occurs when initialization code, such as that of the C run-time library, needs to lock and examine inherited handles.</span></span>

<span data-ttu-id="89b96-123">Quando un client e un server completano l'utilizzo di un'istanza pipe, il server deve prima chiamare la funzione [**FlushFileBuffers**](/windows/desktop/api/fileapi/nf-fileapi-flushfilebuffers) , per garantire che tutti i byte o i messaggi scritti sulla pipe siano letti dal client.</span><span class="sxs-lookup"><span data-stu-id="89b96-123">When a client and server finish using a pipe instance, the server should first call the [**FlushFileBuffers**](/windows/desktop/api/fileapi/nf-fileapi-flushfilebuffers) function, to ensure that all bytes or messages written to the pipe are read by the client.</span></span> <span data-ttu-id="89b96-124">**FlushFileBuffers** non restituisce alcun risultato finché il client non ha letto tutti i dati dalla pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-124">**FlushFileBuffers** does not return until the client has read all data from the pipe.</span></span> <span data-ttu-id="89b96-125">Il server chiama quindi la funzione [**DisconnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-disconnectnamedpipe) per chiudere la connessione al client della pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-125">The server then calls the [**DisconnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-disconnectnamedpipe) function to close the connection to the pipe client.</span></span> <span data-ttu-id="89b96-126">Questa funzione rende l'handle del client non valido, se non è già stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="89b96-126">This function makes the client's handle invalid, if it has not already been closed.</span></span> <span data-ttu-id="89b96-127">Tutti i dati non letti nella pipe vengono eliminati.</span><span class="sxs-lookup"><span data-stu-id="89b96-127">Any unread data in the pipe is discarded.</span></span> <span data-ttu-id="89b96-128">Dopo che il client è stato disconnesso, il server chiama la funzione [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) per chiudere il relativo handle per l'istanza della pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-128">After the client is disconnected, the server calls the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function to close its handle to the pipe instance.</span></span> <span data-ttu-id="89b96-129">In alternativa, il server può utilizzare [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) per consentire a un nuovo client di connettersi a questa istanza della pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-129">Alternatively, the server can use [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) to enable a new client to connect to this instance of the pipe.</span></span>

<span data-ttu-id="89b96-130">Un processo può recuperare informazioni su un named pipe chiamando la funzione [**GetNamedPipeInfo**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-getnamedpipeinfo) , che restituisce il tipo della pipe, le dimensioni dei buffer di input e di output e il numero massimo di istanze di pipe che è possibile creare.</span><span class="sxs-lookup"><span data-stu-id="89b96-130">A process can retrieve information about a named pipe by calling the [**GetNamedPipeInfo**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-getnamedpipeinfo) function, which returns the type of the pipe, the size of the input and output buffers, and the maximum number of pipe instances that can be created.</span></span> <span data-ttu-id="89b96-131">La funzione [**GetNamedPipeHandleState**](/windows/desktop/api/Winbase/nf-winbase-getnamedpipehandlestatea) segnala le modalità di lettura e di attesa di un handle di pipe, il numero corrente di istanze di pipe e informazioni aggiuntive per le pipe che comunicano su una rete.</span><span class="sxs-lookup"><span data-stu-id="89b96-131">The [**GetNamedPipeHandleState**](/windows/desktop/api/Winbase/nf-winbase-getnamedpipehandlestatea) function reports on the read and wait modes of a pipe handle, the current number of pipe instances, and additional information for pipes that communicate over a network.</span></span> <span data-ttu-id="89b96-132">La funzione [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) imposta la modalità di lettura e le modalità di attesa di un handle di pipe.</span><span class="sxs-lookup"><span data-stu-id="89b96-132">The [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) function sets the read mode and wait modes of a pipe handle.</span></span> <span data-ttu-id="89b96-133">Per i client pipe che comunicano con un server remoto, la funzione controlla anche il numero massimo di byte da raccogliere o il tempo massimo di attesa prima della trasmissione di un messaggio (presupponendo che l'handle del client non sia stato aperto con la modalità Write-through abilitata).</span><span class="sxs-lookup"><span data-stu-id="89b96-133">For pipe clients communicating with a remote server, the function also controls the maximum number of bytes to collect or the maximum time to wait before transmitting a message (assuming the client's handle was not opened with write-through mode enabled).</span></span>

 

 
