---
description: Il server pipe controlla se è possibile ereditare i relativi handle nei modi seguenti.
ms.assetid: 72302f8b-f3a2-4efc-aab1-e596b8323984
title: Ereditarietà dell'handle della pipe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 21cf91d4393b43011a2df632806f96da1e713b96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103749671"
---
# <a name="pipe-handle-inheritance"></a><span data-ttu-id="24a7d-103">Ereditarietà dell'handle della pipe</span><span class="sxs-lookup"><span data-stu-id="24a7d-103">Pipe Handle Inheritance</span></span>

<span data-ttu-id="24a7d-104">Il server pipe controlla se è possibile ereditare i relativi handle nei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="24a7d-104">The pipe server controls whether its handles can be inherited in the following ways:</span></span>

-   <span data-ttu-id="24a7d-105">La funzione [**non**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) riceve una struttura degli [**\_ attributi di sicurezza**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="24a7d-105">The [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) function receives a [**SECURITY\_ATTRIBUTES**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) structure.</span></span> <span data-ttu-id="24a7d-106">Se il server pipe imposta il membro **bInheritHandle** della struttura su **true**, è possibile ereditare gli handle creati da **non** .</span><span class="sxs-lookup"><span data-stu-id="24a7d-106">If the pipe server sets the **bInheritHandle** member of this structure to **TRUE**, the handles created by **CreatePipe** can be inherited.</span></span>
-   <span data-ttu-id="24a7d-107">Il server pipe può utilizzare la funzione [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) per modificare l'ereditarietà di un handle di pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-107">The pipe server can use the [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) function to change the inheritance of a pipe handle.</span></span> <span data-ttu-id="24a7d-108">Il server pipe può creare un duplicato non ereditabile di un handle di pipe ereditabile o un duplicato ereditabile di un handle di pipe non ereditabile.</span><span class="sxs-lookup"><span data-stu-id="24a7d-108">The pipe server can create a noninheritable duplicate of an inheritable pipe handle or an inheritable duplicate of a noninheritable pipe handle.</span></span>
-   <span data-ttu-id="24a7d-109">La funzione [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) consente al server pipe di specificare se un processo figlio eredita tutti o nessuno dei relativi handle ereditabili.</span><span class="sxs-lookup"><span data-stu-id="24a7d-109">The [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function enables the pipe server to specify whether a child process inherits all or none of its inheritable handles.</span></span>

<span data-ttu-id="24a7d-110">Quando un processo figlio eredita un handle di pipe, il sistema consente al processo di accedere alla pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-110">When a child process inherits a pipe handle, the system enables the process to access the pipe.</span></span> <span data-ttu-id="24a7d-111">Tuttavia, il processo padre deve comunicare il valore dell'handle al processo figlio.</span><span class="sxs-lookup"><span data-stu-id="24a7d-111">However, the parent process must communicate the handle value to the child process.</span></span> <span data-ttu-id="24a7d-112">Il processo padre esegue in genere questa operazione tramite il reindirizzamento dell'handle di output standard al processo figlio, come illustrato nei passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="24a7d-112">The parent process typically does this by redirecting the standard output handle to the child process, as shown in the following steps:</span></span>

1.  <span data-ttu-id="24a7d-113">Chiamare la funzione [**GetStdHandle**](/windows/console/getstdhandle) per ottenere l'handle di output standard corrente; salvare questo handle per poter ripristinare l'handle di output standard originale dopo che è stato creato il processo figlio.</span><span class="sxs-lookup"><span data-stu-id="24a7d-113">Call the [**GetStdHandle**](/windows/console/getstdhandle) function to get the current standard output handle; save this handle so you can restore the original standard output handle after the child process has been created.</span></span>
2.  <span data-ttu-id="24a7d-114">Chiamare la funzione [**SetStdHandle**](/windows/console/setstdhandle) per impostare l'handle di output standard sull'handle di scrittura sulla pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-114">Call the [**SetStdHandle**](/windows/console/setstdhandle) function to set the standard output handle to the write handle to the pipe.</span></span> <span data-ttu-id="24a7d-115">A questo punto il processo padre può creare il processo figlio.</span><span class="sxs-lookup"><span data-stu-id="24a7d-115">Now the parent process can create the child process.</span></span>
3.  <span data-ttu-id="24a7d-116">Chiamare la funzione [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) per chiudere l'handle di scrittura sulla pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-116">Call the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function to close the write handle to the pipe.</span></span> <span data-ttu-id="24a7d-117">Quando il processo figlio eredita l'handle di scrittura, la copia non è più necessaria per il processo padre.</span><span class="sxs-lookup"><span data-stu-id="24a7d-117">After the child process inherits the write handle, the parent process no longer needs its copy.</span></span>
4.  <span data-ttu-id="24a7d-118">Chiamare [**SetStdHandle**](/windows/console/setstdhandle) per ripristinare l'handle di output standard originale.</span><span class="sxs-lookup"><span data-stu-id="24a7d-118">Call [**SetStdHandle**](/windows/console/setstdhandle) to restore the original standard output handle.</span></span>

<span data-ttu-id="24a7d-119">Il processo figlio usa la funzione [**GetStdHandle**](/windows/console/getstdhandle) per ottenere il relativo handle di output standard, che ora è un handle per l'estremità di scrittura di una pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-119">The child process uses the [**GetStdHandle**](/windows/console/getstdhandle) function to get its standard output handle, which is now a handle to the write end of a pipe.</span></span> <span data-ttu-id="24a7d-120">Il processo figlio usa quindi la funzione [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) per inviare l'output alla pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-120">The child process then uses the [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) function to send its output to the pipe.</span></span> <span data-ttu-id="24a7d-121">Quando l'elemento figlio termina con la pipe, deve chiudere l'handle della pipe chiamando [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) o terminando, che chiude automaticamente l'handle.</span><span class="sxs-lookup"><span data-stu-id="24a7d-121">When the child has finished with the pipe, it should close the pipe handle by calling [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) or by terminating, which automatically closes the handle.</span></span>

<span data-ttu-id="24a7d-122">Il processo padre usa la funzione [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) per ricevere input dalla pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-122">The parent process uses the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) function to receive input from the pipe.</span></span> <span data-ttu-id="24a7d-123">I dati vengono scritti in una pipe anonima come flusso di byte.</span><span class="sxs-lookup"><span data-stu-id="24a7d-123">Data is written to an anonymous pipe as a stream of bytes.</span></span> <span data-ttu-id="24a7d-124">Ciò significa che il processo padre che legge da una pipe non è in grado di distinguere tra i byte scritti in operazioni di scrittura separate, a meno che i processi padre e figlio non usino un protocollo per indicare dove termina l'operazione di scrittura.</span><span class="sxs-lookup"><span data-stu-id="24a7d-124">This means that the parent process reading from a pipe cannot distinguish between the bytes written in separate write operations, unless both the parent and child processes use a protocol to indicate where the write operation ends.</span></span> <span data-ttu-id="24a7d-125">Quando tutti gli handle di scrittura sulla pipe sono chiusi, la funzione **ReadFile** restituisce zero.</span><span class="sxs-lookup"><span data-stu-id="24a7d-125">When all write handles to the pipe are closed, the **ReadFile** function returns zero.</span></span> <span data-ttu-id="24a7d-126">È importante che il processo padre chiuda il relativo handle all'estremità di scrittura della pipe prima di chiamare **ReadFile**.</span><span class="sxs-lookup"><span data-stu-id="24a7d-126">It is important for the parent process to close its handle to the write end of the pipe before calling **ReadFile**.</span></span> <span data-ttu-id="24a7d-127">Se questa operazione non viene eseguita, l'operazione **ReadFile** non può restituire zero perché il processo padre ha un handle aperto per l'estremità di scrittura della pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-127">If this is not done, the **ReadFile** operation cannot return zero because the parent process has an open handle to the write end of the pipe.</span></span>

<span data-ttu-id="24a7d-128">La procedura per il reindirizzamento dell'handle di input standard è simile a quella per il reindirizzamento dell'handle di output standard, ad eccezione del fatto che l'handle di lettura della pipe viene usato come handle di input standard del figlio.</span><span class="sxs-lookup"><span data-stu-id="24a7d-128">The procedure for redirecting the standard input handle is similar to that for redirecting the standard output handle, except that the pipe's read handle is used as the child's standard input handle.</span></span> <span data-ttu-id="24a7d-129">In questo caso, il processo padre deve garantire che il processo figlio non erediti l'handle di scrittura della pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-129">In this case, the parent process must ensure that the child process does not inherit the pipe's write handle.</span></span> <span data-ttu-id="24a7d-130">Se questa operazione non viene eseguita, l'operazione [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) eseguita dal processo figlio non può restituire zero perché il processo figlio ha un handle aperto per l'estremità di scrittura della pipe.</span><span class="sxs-lookup"><span data-stu-id="24a7d-130">If this is not done, the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) operation performed by the child process cannot return zero because the child process has an open handle to the write end of the pipe.</span></span>

<span data-ttu-id="24a7d-131">Per un programma di esempio che usa le pipe anonime per reindirizzare gli handle standard di un processo figlio, vedere [creazione di un processo figlio con input e output reindirizzati](/windows/desktop/ProcThread/creating-a-child-process-with-redirected-input-and-output).</span><span class="sxs-lookup"><span data-stu-id="24a7d-131">For an example program that uses anonymous pipes to redirect the standard handles of a child process, see [Creating a Child Process with Redirected Input and Output](/windows/desktop/ProcThread/creating-a-child-process-with-redirected-input-and-output).</span></span>

 

 
