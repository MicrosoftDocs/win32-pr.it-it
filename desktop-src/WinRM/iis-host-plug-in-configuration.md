---
title: Configurazione del plug-in host IIS
description: La configurazione del plug-in host Internet Information Services (IIS) di gestione remota Windows (WinRM) fornisce un meccanismo di hosting che consente ai plug-in WinRM di terze parti di esporre i dati di gestione all'interno dell'infrastruttura WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9547c96aedc5af23f2194bb9887238525b4ecf6fc6dc0ef8060b1318a960d637
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "119997641"
---
# <a name="iis-host-plug-in-configuration"></a>Configurazione del plug-in host IIS

La configurazione del plug-in host Internet Information Services (IIS) di gestione remota Windows (WinRM) fornisce un meccanismo di hosting che consente ai plug-in WinRM di terze parti di esporre i dati di gestione all'interno dell'infrastruttura WinRM.

Le sezioni seguenti descrivono la configurazione del plug-in host IIS:

-   [Dettagli dell'hosting IIS](#iis-hosting-details)
-   [Modello di configurazione host IIS](#iis-host-configuration-model)
-   [Installazione e dettagli della configurazione dell'host IIS (WinRM)](/windows)
-   [Lettura della configurazione dell'host IIS](#reading-iis-host-configuration)
-   [Enumerazione dei plug-in nel servizio Gestione remota Windows](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Dettagli dell'hosting IIS

Un'applicazione che configura e inizializza il processore SOAP WinRM in IIS riceverà le richieste direttamente da un client WinRM in un altro computer usando il WS-Management remoto. L'applicazione deve anche configurare un endpoint HTTP che identifichi l'applicazione per garantire che tutte le richieste siano indirizzate direttamente ai plug-in specifici dell'applicazione. L'applicazione deve anche configurare i plug-in da caricare nell'host IIS e i meccanismi di autorizzazione e autenticazione necessari. Quando si usa il servizio Gestione remota Windows in IIS, è necessario considerare i fattori seguenti:

-   IIS non supporta l'autenticazione Kerberos per impostazione predefinita. È tuttavia possibile creare un modulo IIS per supportare l'autenticazione Kerberos.
-   Il servizio IIS non accetterà richieste di servizio WinRM crittografate su HTTP.
-   Dopo aver configurato un endpoint IIS, la prima richiesta inviata con credenziali implicite avrà esito negativo. Tuttavia, tutte le richieste successive avranno esito positivo. Si tratta di un problema noto con un sito IIS configurato con l'autenticazione in modalità kernel predefinita. Se si tratta di un problema di blocco, è consigliabile disattivare l'autenticazione in modalità kernel.

## <a name="iis-host-configuration-model"></a>Modello di configurazione host IIS

Tutte le applicazioni che ospitano un processore Soap (WinRM Simple Object Access Protocol) in IIS richiedono la configurazione prima che funzionino.

Ogni configurazione dell'applicazione è separata da quella delle altre applicazioni. I set di configurazioni seguenti sono necessari, anche se probabilmente non tutte le configurazioni devono essere modificate e vengono eseguite tramite il servizio Gestione remota Windows principale:

-   Configurazione generale dell'applicazione, inclusi i timeout delle operazioni.
-   Plug-in di autorizzazione per autorizzare le richieste LiveID o per eseguire il mapping Windows account utente a un account del servizio più generico.
-   Plug-in dell'operazione che devono essere ospitati e utilizzati dal processore SOAP WinRM per eseguire le richieste effettive.

Potrebbe essere necessario configurare le configurazioni seguenti all'interno di IIS:

-   [*Informazioni*](windows-remote-management-glossary.md) sull'endpoint del listener che definiscono quali porte e indirizzi sono in ascolto delle richieste insieme a eventuali certificati Secure Sockets Layer (SSL).
-   Mapping dei certificati client per eseguire il mapping dei certificati client agli account utente.
-   Configurazione dell'autorizzazione per limitare gli utenti autorizzati ad accedere al sito virtuale.

Il servizio Gestione remota Windows registra la porta 5985 con il prefisso "wsman" per impostazione predefinita. Se il listener HTTP di compatibilità è abilitato, il servizio Gestione remota Windows registra la porta 80 con il prefisso "wsman" per impostazione predefinita. Poiché IIS è in ascolto anche sulla porta 80 per impostazione predefinita, è consigliabile che i servizi host IIS creino [*listener*](windows-remote-management-glossary.md) su una porta diversa.

Se sia IIS che il servizio Gestione remota Windows condividono la porta 80, per condividere la porta è necessaria la configurazione seguente:

-   Il servizio host IIS deve abilitare Gestione remota Windows in un'applicazione nel sito.
-   Il nome dell'applicazione deve essere aggiunto all'URI. Ad esempio: https://servername/myapplication.

Ogni applicazione host IIS viene archiviata nella configurazione di IIS come file web.config che si trova nella directory fisica corrispondente alla directory virtuale configurata. La sezione seguente descrive il funzionamento del sistema di configurazione iis e come può essere esteso per supportare la configurazione dell'host IIS WinRM.

### <a name="how-iis-configuration-works"></a>Funzionamento di Configurazione IIS

L'infrastruttura di configurazione di IIS è costituita da un set di file XML usati per archiviare i dati di configurazione e da un set di file di schema usati per convalidare i dati scritti o letti tramite le API di amministrazione di IIS. A livello di radice, è presente un file ApplicationHost.config nella stessa directory di IIS (in genere, %windir% \\ System32 \\ InetSrv \\ Config). Questo è il file di configurazione principale per IIS, in cui vengono archiviati l'elenco di siti, applicazioni, directory virtuali, impostazioni generali, registrazione, memorizzazione nella cache e così via. I dati di configurazione sono suddivisi in entità indipendenti denominate **sezioni** e vi si accede.

Ad esempio, sono disponibili sezioni separate **per siti,** registrazione, memorizzazione nella cache e così via. Tutti i dati di configurazione contenuti in ApplicationHost.config vengono applicati a tutti i siti, le applicazioni e le directory virtuali configurate all'interno di IIS. A livello di directory virtuale, un file web.config definisce i dati di configurazione specifici dell'applicazione, possibilmente eseguendo l'override di altri dati già definiti in ApplicationHost.config. Web.config file vengono archiviati nella radice (directory fisica) corrispondente al sito, all'applicazione o alla directory virtuale a cui si applica la configurazione.

Per altre informazioni sulla configurazione di IIS, vedere quanto segue:

-   [Schema di Impostazioni IIS 7.0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

Lo schema di configurazione di IIS usato per convalidare i dati di configurazione di IIS è un file XML archiviato nella directory dello schema IIS (in genere % windir% \\ System32 \\ InetSrv \\ Config \\ Schema). Lo schema di configurazione iis non è XSD. La configurazione di IIS supporta l'estendibilità. Le nuove sezioni di configurazione possono essere integrate direttamente nel sistema di configurazione di IIS e le impostazioni del sistema di configurazione IIS possono essere manipolate usando le API di amministrazione esistenti.

Di seguito sono riportati i passaggi principali necessari:

-   Definire una nuova sezione di configurazione in un file di XML Schema.
-   Inserire il file nella directory dello schema iis 7 (%windir% \\ System32 \\ InetSrv \\ Config \\ Schema).
-   Registrare la nuova sezione nel file di configurazione globale IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Installazione e dettagli della configurazione dell'host IIS (WinRM)

In questa sezione vengono descritti i passaggi da eseguire durante l'installazione per integrare e inizializzare la configurazione dell'host IIS. In questo caso, la configurazione dell'host IIS fa riferimento ai dati di configurazione necessari per eseguire il servizio Gestione remota Windows all'interno di IIS. Il modulo di estensione IIS di Gestione remota Windows è un componente facoltativo che viene installato usando il **Server Manager**.

La sezione di configurazione di IIS che definisce la configurazione richiesta è denominata **system.management.wsmanagement.config**. In genere, la configurazione dell'host IIS viene definita durante l'installazione. Questa operazione può essere eseguita creando un file web.config e aggiungendo il codice XML appropriato. Qualsiasi modifica al file web.config richiede il riavvio del sito che ospita il servizio Gestione remota Windows.

La procedura seguente descrive in dettaglio la configurazione dell'estensione IIS di Gestione remota Windows.

**Per installare l'estensione IIS di Gestione remota Windows**

1.  Nella sezione **Riepilogo funzionalità** del Server Manager **fare** clic su **Aggiungi funzionalità.**
2.  Nell'Aggiunta guidata funzionalità selezionare Estensione IIS WinRM.
3.  Seguire le istruzioni della procedura guidata, inclusa l'installazione del software necessario, se indicato. Per altre informazioni sull'uso dell'Aggiunta guidata funzionalità, vedere la guida **Server Manager** online.

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Inizializzazione della configurazione winrm per l'applicazione ospitata

Questo passaggio comporta la definizione del file XML di configurazione dell'host IIS web.config file. Questo file si trova nella directory fisica corrispondente alla directory virtuale in cui è configurata l'applicazione ospitata. Il contenuto XML per **la sezionesystem.management.wsmanagement.config** deve essere conforme allo schema definito in wsmanconfigschema.xml; in caso contrario, le API di amministrazione di IIS non saranno in grado di \_ elaborarlo. Di seguito è riportato un esempio di contenuto XML che può essere contenuto nel file web.config seguente:


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



Nell'elenco seguente vengono descritti gli elementi XML in modo più dettagliato ed è seguito da un esempio di fileschema.xml wsmanconfig. \_



| Elemento                                                        | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | Dimensione massima dei pacchetti SOAP che verranno emesse dal servizio Gestione remota Windows. Il valore predefinito è 150 KB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | Intervallo di timeout massimo per tutte le operazioni. Questo valore esegue l'override di qualsiasi valore ricevuto in un pacchetto SOAP. Se un provider supera questo valore, viene inviato un timeout al client e l'operazione verrà annullata. Alcune operazioni, come le enumerazioni, possono mantenere aperta un'enumerazione dopo un timeout. Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | Intervallo di timeout massimo per le enumerazioni. Se il tempo tra le richieste di enumerazione è maggiore di questo valore, l'enumerazione viene annullata e il contesto di enumerazione rilasciato in precedenza non è più valido. Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | Intervallo di timeout massimo per le operazioni di sottoscrizione. Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | Tempo massimo in minuti prima dell'eliminazione di una shell remota inattiva. Il valore predefinito è 15 minuti.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | Intervallo prima dell'aggiornamento delle informazioni sulla quota per un utente. Le richieste in sospeso per l'utente specificato continuano a essere eseguite nel contesto di autorizzazione e quota precedente fino al completamento dell'aggiornamento. Il valore predefinito è 900 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | Durata della finestra temporale scorrevole della limitazione del sistema. Il valore predefinito è 2 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | Numero di operazioni che vengono eseguite attraverso la limitazione del sistema durante la finestra temporale scorrevole. Il valore predefinito è 1000 operazioni.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | Questo nodo è facoltativo. Un plug-in di autorizzazione consente di accettare o rifiutare un utente in ingresso a livello di codice in base a schemi di autenticazione diversi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/Name                         | Specifica il nome visualizzato da utilizzare per il plug-in. Se viene restituito un errore dal plug-in, questo nome verrà inserito nel codice XML dell'errore restituito all'applicazione client. Il nome non è specifico delle impostazioni locali.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/Filename                     | Specifica il nome file del plug-in di autorizzazione. Tutte le variabili di ambiente che vengono inserite in questa voce verranno espanse in base all'identità con cui viene eseguito l'host IIS, ad esempio Servizio di rete. Il valore predefinito per questa voce è vuoto, a indicare che non viene usato alcun plug-in di autorizzazione.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | Specifica la versione del Software Development Kit (SDK) per cui è stato scritto un particolare plug-in. Questo elemento deve essere impostato su 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | Specifica se il plug-in di autorizzazione supporta le quote.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/Name                           | Specifica il nome visualizzato da utilizzare per il plug-in. Se viene restituito un errore dal plug-in, questo nome verrà inserito nel codice XML dell'errore restituito all'applicazione client. Il nome non è specifico delle impostazioni locali.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/FileName                       | Specifica il nome file del plug-in dell'operazione. Tutte le variabili di ambiente che vengono inserite in questa voce verranno espanse nel contesto dell'utente quando arriva una richiesta. Ogni utente potrebbe avere una versione diversa della stessa variabile di ambiente, quindi ogni utente potrebbe avere un plug-in diverso. Questa voce non può essere vuota e deve puntare a un plug-in valido.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | Specifica la versione dell'SDK per cui è stato scritto un particolare plug-in. Questo elemento deve essere impostato su 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/XmlRenderingType               | Configura il formato in cui XML viene passato ai plug-in tramite [**l'oggetto WSMAN \_ DATA.**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) **XmlRenderingType è** impostato su text. I dati XML in ingresso sono contenuti in una struttura WSMAN DATA TYPE TEXT, che rappresenta \_ il codice XML come buffer di memoria \_ \_ **PCWSTR.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | Questo nodo è facoltativo e consente a un plug-in di configurare codice XML aggiuntivo che verrà passato al [**metodo WSManPluginStartup.**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) La maggior parte dei plug-in non necessita di queste informazioni aggiuntive, ma se è necessario usare un plug-in in più di uno scenario che richiede una semantica di run-time diversa, questo codice XML offrirà al plug-in la flessibilità necessaria.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/Resources                      | Specifica un elenco [*di URI di risorsa*](windows-remote-management-glossary.md) supportati da questo plug-in. È necessario specificare almeno una voce **ResourceUri.** In caso contrario, il codice XML verrà rifiutato.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/Resources/Resource             | Rappresenta una singola [*configurazione URI di*](windows-remote-management-glossary.md) risorsa.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri | Specifica un singolo [*URI di risorsa*](windows-remote-management-glossary.md) completo o come stringa di corrispondenza parziale in base all'attributo **ExactMatch.** Se **ExactMatch** non è presente, il valore predefinito è **False,** il che significa che il processore SOAP WinRM farà una corrispondenza parziale con l'inizio dell'URI della risorsa e, se esiste una corrispondenza, la passerà al plug-in.  È **possibile specificare l'attributo SupportsOptions** se a questo *URI* di risorsa è consentito passare opzioni. Per impostazione predefinita, non sono supportate opzioni e, se presenti nella richiesta del client, verrà restituito un errore. Se le opzioni sono supportate dal plug-in, è importante che il plug-in restituisca l'errore corretto se è presente un'opzione che il plug-in non è in grado di comprendere quando il flag **mustUnderstand** è impostato su **TRUE.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/Resource/Capability            | Specifica una funzionalità disponibile [*nell'URI della risorsa.*](windows-remote-management-glossary.md) Sarà presente una voce per ogni tipo di operazione supportato. Sono disponibili le opzioni seguenti:<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Ottieni</dt> <dd> Le operazioni Get sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** viene usato se l'operazione get supporta il concetto. **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Mettere</dt> <dd> Le operazioni Put sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** viene usato se l'operazione put supporta il concetto. **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Crea</dt> <dd> Le operazioni di creazione sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** viene usato se l'operazione di creazione supporta il concetto. **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Elimina</dt> <dd> Le operazioni di eliminazione sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** viene usato se l'operazione di eliminazione supporta il concetto. **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>evocare</dt> <dd> Le operazioni invoke sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** non è supportato per le operazioni invoke e deve essere impostato su **False.** **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Enumerazione</dt> <dd> Le operazioni di enumerazione sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** non è supportato per le operazioni di enumerazione e deve essere impostato su **False.** **L'attributo SupportFiltering** è valido e, se il plug-in supporta il filtro, questo attributo deve essere impostato su **True.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Sottoscrivere</dt> <dd> Le operazioni di sottoscrizione sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** non è supportato per le operazioni di sottoscrizione e deve essere impostato su **False.** **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Le operazioni della shell sono supportate [*nell'URI della risorsa*](windows-remote-management-glossary.md). **L'attributo SupportFragment** non è supportato per le operazioni della shell e deve essere impostato su **False.** **L'attributo SupportFiltering** non è valido e deve essere impostato su **False.** Questa funzionalità non è valida per un *URI di risorsa* se è supportata anche qualsiasi altra funzionalità operativa. Se una funzionalità dell'operazione della shell è configurata per un *URI* di risorsa, le operazioni get, put, create, delete, invoke ed enumerate vengono elaborate internamente all'interno del servizio WinRM per gestire le shell. Di conseguenza, il plug-in non può gestire le operazioni.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Esempio di fileschema.xml wsmanconfig \_

Durante la configurazione, nella directory dello schema IIS viene eliminato un file XML denominato wsmanconfigschema.xml contenente il contenuto \_ seguente:


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Lettura della configurazione dell'host IIS

La configurazione dell'host IIS viene letta durante il processore SOAP di avvio nell'applicazione ospitata. Poiché web.config i file possono essere modificati manualmente e pertanto sono incappati in errori di convalida dello schema, possono verificarsi problemi durante la lettura di una configurazione. Durante un errore di lettura o convalida della configurazione, l'applicazione ospitata non verrà avviata e restituirà un messaggio di errore appropriato al client. Verrà registrato un evento contenente una descrizione dettagliata di ciò che ha causato l'errore.

Di seguito sono riportati gli errori comuni:

-   Accesso negato
-   XML di configurazione non valido
-   Nessun plug-in configurato (ne è necessario almeno uno)

I plug-in standard non sono configurati per impostazione predefinita. Devono essere configurate in modo esplicito nel file web.config prima di iniziare a ricevere richieste.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Enumerazione dei plug-in nel servizio Gestione remota Windows

Il comando seguente illustra come usare l'utilità winrm per determinare quali plug-in sono disponibili nel servizio WinRM: **winrm enumerate winrm/config/plugin -format:pretty**.

 

