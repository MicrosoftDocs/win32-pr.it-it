---
title: Configurazione del plug-in host IIS
description: La configurazione del plug-in dell'host Gestione remota Windows (WinRM) Internet Information Services (IIS) fornisce un meccanismo di hosting che consente ai plug-in di terze parti di WinRM di esporre i dati di gestione nell'infrastruttura WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103963116"
---
# <a name="iis-host-plug-in-configuration"></a>Configurazione del plug-in host IIS

La configurazione del plug-in dell'host Gestione remota Windows (WinRM) Internet Information Services (IIS) fornisce un meccanismo di hosting che consente ai plug-in di terze parti di WinRM di esporre i dati di gestione nell'infrastruttura WinRM.

Nelle sezioni seguenti viene descritta la configurazione del plug-in host IIS:

-   [Dettagli sull'hosting di IIS](#iis-hosting-details)
-   [Modello di configurazione host IIS](#iis-host-configuration-model)
-   [Installazione e dettagli della configurazione dell'host IIS (WinRM)](/windows)
-   [Lettura della configurazione dell'host IIS](#reading-iis-host-configuration)
-   [Enumerazione dei plug-in nel servizio gestione remota Windows](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Dettagli sull'hosting di IIS

Un'applicazione che configura e inizializza il processore SOAP WinRM in IIS riceverà le richieste direttamente da un client WinRM in un altro computer utilizzando il protocollo WS-Management. L'applicazione deve inoltre configurare un endpoint HTTP che identifichi l'applicazione per garantire che tutte le richieste vengano indirizzate direttamente ai plug-in specifici dell'applicazione. L'applicazione deve inoltre configurare i plug-in da caricare nell'host IIS e i meccanismi di autenticazione e autorizzazione necessari. Quando si utilizza il servizio gestione remota Windows in IIS, è necessario considerare i fattori seguenti:

-   IIS non supporta l'autenticazione Kerberos per impostazione predefinita. Tuttavia, è possibile creare un modulo IIS per supportare l'autenticazione Kerberos.
-   Il servizio IIS non accetterà richieste di servizio WinRM crittografate tramite HTTP.
-   Dopo aver configurato un endpoint IIS, la prima richiesta inviata con le credenziali implicite avrà esito negativo. Tuttavia, tutte le richieste successive riusciranno. Si tratta di un problema noto relativo a un sito IIS configurato con l'autenticazione in modalità kernel predefinita. Se si tratta di un problema di blocco, è consigliabile disattivare l'autenticazione in modalità kernel.

## <a name="iis-host-configuration-model"></a>Modello di configurazione host IIS

Tutte le applicazioni che ospitano un processore WinRM Simple Object Access Protocol (SOAP) in IIS richiedono la configurazione prima che funzionino.

Ogni configurazione dell'applicazione è separata da quella di altre applicazioni. Sono necessari i set di configurazioni seguenti, sebbene sia possibile che non tutte le configurazioni debbano essere modificate e vengano eseguite tramite il servizio WinRM principale:

-   Configurazione generale dell'applicazione, inclusi i timeout delle operazioni.
-   Un plug-in di autorizzazione per autorizzare le richieste LiveID o per eseguire il mapping dell'account utente di Windows a un account del servizio più generico.
-   I plug-in di operazione devono essere ospitati e usati dal processore SOAP WinRM per eseguire le richieste effettive.

È possibile che sia necessario configurare le configurazioni seguenti in IIS:

-   Informazioni sull'endpoint del [*listener*](windows-remote-management-glossary.md) che definiscono le porte e gli indirizzi in ascolto delle richieste insieme ai certificati di Secure Sockets Layer (SSL).
-   Mapping del certificato client per eseguire il mapping dei certificati client agli account utente.
-   Configurazione dell'autorizzazione per limitare l'accesso al sito virtuale.

Per impostazione predefinita, il servizio WinRM registra la porta 5985 con il prefisso "WSMan". Se il listener HTTP di compatibilità è abilitato, il servizio WinRM registra la porta 80 con il prefisso "WSMan" per impostazione predefinita. Poiché IIS è inoltre in ascolto sulla porta 80 per impostazione predefinita, è consigliabile che i servizi host IIS creino [*listener*](windows-remote-management-glossary.md) su una porta diversa.

Se il servizio IIS e WinRM condividono la porta 80, per condividere la porta è necessaria la configurazione seguente:

-   Il servizio host IIS deve abilitare WinRM in un'applicazione nel sito.
-   Il nome dell'applicazione deve essere aggiunto all'URI. Ad esempio: https://servername/myapplication.

Ogni applicazione host IIS viene archiviata nella configurazione di IIS come file web.config che risiede nella directory fisica corrispondente alla directory virtuale configurata. Nella sezione seguente viene descritto il funzionamento del sistema di configurazione IIS e il modo in cui è possibile estenderlo per supportare la configurazione host IIS WinRM.

### <a name="how-iis-configuration-works"></a>Funzionamento della configurazione di IIS

L'infrastruttura di configurazione di IIS è costituita da un set di file XML utilizzato per archiviare i dati di configurazione e da un set di file di schema utilizzati per convalidare i dati scritti o letti tramite le API di amministrazione di IIS. Al livello radice è presente un file di ApplicationHost.config nella stessa directory di IIS (in genere,% windir% \\ system32 \\ inetsrv \\ config). Si tratta del file di configurazione principale per IIS, in cui vengono archiviati l'elenco di siti, applicazioni, directory virtuali, impostazioni generali, registrazione, Caching e così via. I dati di configurazione vengono suddivisi in ed è possibile accedervi come entità indipendenti denominate **sezioni**.

Sono ad esempio disponibili **sezioni** separate per i siti, la registrazione, la memorizzazione nella cache e così via. Tutti i dati di configurazione contenuti in ApplicationHost.config vengono applicati a tutti i siti, le applicazioni e le directory virtuali configurate in IIS. A livello di directory virtuale, un file di web.config definisce i dati di configurazione specifici dell'applicazione, possibilmente eseguendo l'override di altri dati già definiti nel ApplicationHost.config. I file Web.config vengono archiviati nella radice (directory fisica) corrispondente al sito, all'applicazione o alla directory virtuale a cui si applica la configurazione.

Per ulteriori informazioni sulla configurazione di IIS, vedere gli argomenti seguenti:

-   [Schema delle impostazioni di IIS 7,0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

Lo schema di configurazione di IIS utilizzato per convalidare i dati di configurazione IIS è costituito da file XML archiviati nella directory dello schema IIS (in genere,% windir% \\ system32 \\ inetsrv \\ config \\ schema). Lo schema di configurazione di IIS non è XSD. La configurazione di IIS supporta l'estensibilità. Le nuove sezioni di configurazione possono essere integrate direttamente nel sistema di configurazione di IIS e le impostazioni del sistema di configurazione IIS possono essere modificate usando le API di amministrazione esistenti.

Di seguito sono riportati i passaggi principali necessari:

-   Definire una nuova sezione di configurazione in un file di XML Schema.
-   Inserire il file nella directory dello schema di IIS 7 (% windir% \\ system32 \\ inetsrv \\ config \\ schema).
-   Registrare la nuova sezione nel file di configurazione globale IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Installazione e dettagli della configurazione dell'host IIS (WinRM)

In questa sezione vengono descritti i passaggi da eseguire durante l'installazione di per integrare e inizializzare la configurazione host IIS. In questa configurazione host IIS si riferisce ai dati di configurazione necessari per eseguire il servizio gestione remota Windows in IIS. Il modulo di estensione IIS WinRM è un componente facoltativo installato utilizzando il **Server Manager**.

La sezione di configurazione di IIS che definisce la configurazione richiesta viene chiamata **system.management.wsmanagement.config**. In genere, la configurazione dell'host IIS viene definita durante l'installazione. A tale scopo, è possibile creare un file di web.config e aggiungere il codice XML appropriato. Tutte le modifiche apportate al file web.config richiedono il riavvio del sito che ospita il servizio gestione remota Windows.

Nella procedura riportata di seguito viene descritta in dettaglio la configurazione dell'estensione IIS WinRM.

**Per installare l'estensione IIS WinRM**

1.  Nella sezione **Riepilogo funzionalità** della **Server Manager** fare clic su **Aggiungi funzionalità**.
2.  Nell'aggiunta guidata funzionalità selezionare estensione IIS WinRM.
3.  Seguire le istruzioni della procedura guidata, inclusa l'installazione del software richiesto, se presente. Per ulteriori informazioni sull'utilizzo della procedura guidata Aggiungi funzionalità, consultare la Guida in linea di **Server Manager** .

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Inizializzazione della configurazione WinRM per l'applicazione ospitata

Questo passaggio prevede la definizione dell'XML di configurazione host IIS nel file di web.config. Questo file si trova nella directory fisica corrispondente alla directory virtuale in cui è configurata l'applicazione ospitata. Il contenuto XML per la sezione **system.management.wsmanagement.config** deve essere conforme allo schema definito in WSManConfig \_schema.xml. in caso contrario, le API di amministrazione di IIS non saranno in grado di elaborarlo. Di seguito è riportato un esempio di contenuto XML che può essere contenuto nel file di web.config:


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



Nell'elenco seguente vengono descritti in modo più dettagliato gli elementi XML ed è seguito da un esempio di un \_ file dischema.xml WSManConfig.



| Elemento                                                        | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | Dimensione massima dei pacchetti SOAP elaborati dal servizio gestione remota Windows. Il valore predefinito è 150 KB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | Intervallo massimo di timeout per tutte le operazioni. Questo valore esegue l'override di qualsiasi valore ricevuto in un pacchetto SOAP. Se un provider supera questo valore, viene inviato un timeout al client e l'operazione verrà annullata. (Alcune operazioni, come le enumerazioni, possono impedire l'apertura di un'enumerazione dopo un timeout). Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | Intervallo massimo di timeout per le enumerazioni. Se il tempo tra le richieste di enumerazione è maggiore di questo valore, l'enumerazione viene annullata e il contesto di enumerazione emesso in precedenza non è più valido. Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | Intervallo di timeout massimo per le operazioni di sottoscrizione. Il valore predefinito è 60 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | Tempo massimo in minuti prima dell'eliminazione di una shell remota inattiva. Il valore predefinito è 15 minuti.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | Intervallo prima dell'aggiornamento delle informazioni sulle quote per un utente. Le richieste in sospeso per l'utente specificato continuano a essere eseguite con l'autorizzazione e il contesto della quota precedenti fino al completamento dell'aggiornamento. Il valore predefinito è 900 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | Durata della finestra temporale scorrevole della limitazione del sistema. Il valore predefinito è 2 secondi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | Numero di operazioni ammesse attraverso la limitazione di sistema durante la finestra temporale scorrevole. Il valore predefinito è 1000 operazioni.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | Questo nodo è facoltativo. Un plug-in di autorizzazione consente di accettare o rifiutare un utente in ingresso a livello di codice in base a schemi di autenticazione diversi.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/nome                         | Specifica il nome visualizzato da usare per il plug-in. Se dal plug-in viene restituito un errore, questo nome verrà inserito nel codice XML dell'errore restituito all'applicazione client. Il nome non è specifico delle impostazioni locali.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/filename                     | Specifica il nome file del plug-in di autorizzazione. Tutte le variabili di ambiente inserite in questa voce verranno espanse in base all'identità con cui viene eseguito l'host IIS, ad esempio servizio di rete. Il valore predefinito per questa voce è vuoto, che indica che non viene utilizzato alcun plug-in di autorizzazione.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | Specifica la versione del Software Development Kit (SDK) per cui è stato scritto un particolare plug-in. Questo elemento deve essere impostato su 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | Specifica se il plug-in di autorizzazione supporta le quote.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/nome                           | Specifica il nome visualizzato da usare per il plug-in. Se dal plug-in viene restituito un errore, questo nome verrà inserito nel codice XML dell'errore restituito all'applicazione client. Il nome non è specifico delle impostazioni locali.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/FileName                       | Specifica il nome file del plug-in dell'operazione. Tutte le variabili di ambiente inserite in questa voce verranno espanse nel contesto dell'utente quando viene ricevuta una richiesta. Ogni utente potrebbe avere una versione diversa della stessa variabile di ambiente, quindi ogni utente potrebbe finire con un plug-in diverso. Questa voce non può essere vuota e deve puntare a un plug-in valido.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | Specifica la versione dell'SDK per cui è stato scritto un particolare plug-in. Questo elemento deve essere impostato su 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/XmlRenderingType               | Configura il formato in cui XML viene passato ai plug-in tramite l'oggetto [**\_ dati WSMan**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) . **XmlRenderingType** è impostato su Text. I dati XML in arrivo sono contenuti in una \_ \_ struttura di testo del tipo di dati WSMan \_ , che rappresenta l'XML come buffer di memoria **PCWSTR** .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | Questo nodo è facoltativo e consente a un plug-in di configurare codice XML aggiuntivo che verrà passato al metodo [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) . Questa informazione aggiuntiva non è necessaria per la maggior parte dei plug-in, ma se è necessario usare un plug-in in più scenari che richiedono una semantica di runtime diversa, questo codice XML fornirà la flessibilità necessaria per il plug-in.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/risorse                      | Specifica un elenco di [*URI di risorsa*](windows-remote-management-glossary.md) supportati da questo plug-in. È necessario specificare almeno una voce **resourceUri** . in caso contrario, il codice XML verrà rifiutato.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/risorse/risorsa             | Rappresenta una singola configurazione [*URI di risorsa*](windows-remote-management-glossary.md) .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri | Specifica un singolo [*URI di risorsa*](windows-remote-management-glossary.md) in formato completo o come stringa di corrispondenza parziale basata sull'attributo **exactMatch** . Se **exactMatch** non è presente, il valore predefinito è **false**, il che significa che il processore SOAP WinRM eseguirà una corrispondenza parziale all'inizio dell' *URI della risorsa* e, in caso di corrispondenza, lo passerà al plug-in. È possibile specificare l'attributo **SupportsOptions** se all' *URI della risorsa* è consentito passare qualsiasi opzione. Per impostazione predefinita, non sono supportate opzioni e, se presenti nella richiesta client, viene restituito un errore. Se le opzioni sono supportate dal plug-in, è importante che il plug-in restituisca l'errore corretto se è presente un'opzione che il plug-in non riconosce quando il flag **MustUnderstand** è impostato su **true**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/risorsa/funzionalità            | Specifica una funzionalità disponibile in questo URI di [*risorsa*](windows-remote-management-glossary.md). Sarà presente una voce per ogni tipo di operazione supportata. Sono disponibili le opzioni seguenti:<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Recupero</dt> <dd> Le operazioni get sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** viene usato se l'operazione Get supporta il concetto. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Mettere</dt> <dd> Le operazioni Put sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** viene usato se l'operazione Put supporta il concetto. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Creare</dt> <dd> Le operazioni di creazione sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** viene usato se l'operazione Create supporta il concetto. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Delete</dt> <dd> Le operazioni di eliminazione sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** viene usato se l'operazione Delete supporta il concetto. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Richiamare</dt> <dd> Le operazioni Invoke sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** non è supportato per le operazioni Invoke e deve essere impostato su **false**. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Enumerazione</dt> <dd> Le operazioni di enumerazione sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** non è supportato per le operazioni di enumerazione e deve essere impostato su **false**. L'attributo **SupportFiltering** è valido e se il plug-in supporta l'applicazione di filtri, questo attributo deve essere impostato su **true**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Sottoscrivi</dt> <dd> Le operazioni di sottoscrizione sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** non è supportato per le operazioni di sottoscrizione e deve essere impostato su **false**. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se sono supportate anche le operazioni della shell.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Le operazioni della shell sono supportate nell' [*URI della risorsa*](windows-remote-management-glossary.md). L'attributo **SupportFragment** non è supportato per le operazioni della shell e deve essere impostato su **false**. L'attributo **SupportFiltering** non è valido e deve essere impostato su **false**. Questa funzionalità non è valida per un *URI di risorsa* se è supportata anche un'altra funzionalità dell'operazione. Se è configurata una funzionalità di operazione Shell per un *URI di risorsa*, le operazioni get, put, create, DELETE, Invoke ed enumerate vengono elaborate internamente nel servizio WinRM per gestire le shell. Di conseguenza, il plug-in non è in grado di gestire le operazioni.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Esempio di \_ file dischema.xml WSManConfig

Durante la configurazione, un file XML denominato WSManConfig \_schema.xml contenente il contenuto seguente viene eliminato nella directory dello schema IIS:


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Lettura della configurazione dell'host IIS

La configurazione dell'host IIS viene letta durante il processo di avvio del processore SOAP nell'applicazione ospitata. Poiché i file di web.config possono essere modificati manualmente e, pertanto, sono soggetti a errori di convalida dello schema, è possibile che si verifichino problemi quando viene letta una configurazione. Durante un errore di lettura o convalida della configurazione, l'applicazione ospitata non verrà avviata e restituirà al client un messaggio di errore appropriato. Verrà registrato un evento contenente una descrizione dettagliata di ciò che ha causato l'errore.

Gli errori comuni includono i seguenti:

-   Accesso negato
-   XML di configurazione non valido
-   Nessun plug-in configurato (è necessario almeno uno)

I plug-in standard non sono configurati per impostazione predefinita. Devono essere configurati in modo esplicito nel file di web.config prima che inizino a ricevere le richieste.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Enumerazione dei plug-in nel servizio gestione remota Windows

Il comando seguente illustra come usare l'utilità WinRM per determinare quali plug-in sono disponibili nel servizio WinRM: **WinRM enumerate winrm/config/Plugin-Format: Pretty**.

 

