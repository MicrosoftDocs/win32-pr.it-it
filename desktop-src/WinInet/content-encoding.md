---
title: Codifica contenuto
description: A partire da Windows Server 2008 e Windows Vista, l'applicazione può indirizzare WinINet per eseguire la decodifica del contenuto per gli schemi di codifica del contenuto gzip e Deflate.
ms.assetid: 136f22a6-e5ca-41c5-8651-6e132655d268
keywords:
- Codifica contenuto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09b089ae2aa4cbacdfc9b6ebefe5cbdfc1bfc10e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047228"
---
# <a name="content-encoding"></a><span data-ttu-id="303f4-104">Codifica contenuto</span><span class="sxs-lookup"><span data-stu-id="303f4-104">Content Encoding</span></span>

<span data-ttu-id="303f4-105">Come specificato nel protocollo HTTP (RFC 2616), le applicazioni possono richiedere che il server restituisca risposte HTTP in formato codificato.</span><span class="sxs-lookup"><span data-stu-id="303f4-105">As specified in the HTTP protocol (RFC 2616) applications can request that the server return HTTP responses in encoded format.</span></span> <span data-ttu-id="303f4-106">Prima di Windows Server 2008 e Windows Vista, le richieste con codifica del contenuto venivano inviate all'applicazione per l'elaborazione a livello di livello.</span><span class="sxs-lookup"><span data-stu-id="303f4-106">Prior to Windows Server 2008 and Windows Vista, requests with content encoding were sent to the application for processing at their level.</span></span> <span data-ttu-id="303f4-107">A partire da Windows Server 2008 e Windows Vista, l'applicazione può indirizzare WinINet per eseguire la decodifica del contenuto per gli schemi di codifica del contenuto gzip e Deflate.</span><span class="sxs-lookup"><span data-stu-id="303f4-107">Starting in Windows Server 2008 and Windows Vista, the application can direct WinINet to perform content decoding for the gzip and deflate content encoding schemes.</span></span>

<span data-ttu-id="303f4-108">Per abilitare la decodifica del contenuto, l'applicazione imposta l'opzione di decodifica che richiede che WinINet esegua la decodifica per conto dell'utente.</span><span class="sxs-lookup"><span data-stu-id="303f4-108">To enable content decoding, the application sets the decoding option requesting that WinINet perform decoding on their behalf.</span></span> <span data-ttu-id="303f4-109">Tuttavia, l'abilitazione della decodifica non garantisce che WinINet esegua la decodifica del contenuto e l'applicazione deve essere preparata per la gestione della decodifica.</span><span class="sxs-lookup"><span data-stu-id="303f4-109">However, enabling decoding does not guarantee that WinINet will perform content decoding, and the application should be prepared to handle decoding.</span></span> <span data-ttu-id="303f4-110">WinINet rimuove l'intestazione Content-Encoding dalla risposta quando la decodifica del contenuto viene eseguita correttamente.</span><span class="sxs-lookup"><span data-stu-id="303f4-110">WinINet strips the content-encoding header from the response when content decoding is successfully performed.</span></span> <span data-ttu-id="303f4-111">Si prevede che le applicazioni gestiscano la decodifica del contenuto, indipendentemente dal fatto che l'opzione di decodifica sia abilitata o disabilitata quando l'intestazione Content-Encoding è presente nella risposta.</span><span class="sxs-lookup"><span data-stu-id="303f4-111">Applications are expected to handle content decoding regardless of whether the decoding option is enabled or disabled when the content-encoding header is present in the response.</span></span>

<span data-ttu-id="303f4-112">Quando è abilitata la decodifica, l'applicazione deve specificare l'elenco di codifiche supportate nell'intestazione Accept-Encoding della richiesta.</span><span class="sxs-lookup"><span data-stu-id="303f4-112">When decoding is enabled, the application must specify the list of supported encodings in the Accept-Encoding header of the request.</span></span> <span data-ttu-id="303f4-113">L'intestazione Accept-Encoding, tuttavia, non obbliga il server a inviare una risposta codificata.</span><span class="sxs-lookup"><span data-stu-id="303f4-113">The Accept-Encoding header, however, does not obligate the server to send an encoded response.</span></span> <span data-ttu-id="303f4-114">WinINet invierà risposte che non corrispondono all'elenco di codifiche accettabili all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="303f4-114">WinINet will send responses that do not match the list of acceptable encodings back to the application.</span></span>

<span data-ttu-id="303f4-115">Nell'elenco seguente vengono descritte le condizioni in base alle quali WinINet eseguirà la decodifica del contenuto quando l'opzione è abilitata:</span><span class="sxs-lookup"><span data-stu-id="303f4-115">The following list describes the conditions under which WinINet will perform content decoding when the option is enabled:</span></span>

-   <span data-ttu-id="303f4-116">L'intestazione Accept-Encoding deve essere presente nella richiesta ed è necessario specificare gli schemi di codifica gzip, deflate o gzip e Deflate.</span><span class="sxs-lookup"><span data-stu-id="303f4-116">The Accept-Encoding header must be present in the request, and it must specify the gzip, deflate, or both gzip and deflate encoding schemes.</span></span>
-   <span data-ttu-id="303f4-117">Lo schema di codifica specificato nell'intestazione Content-Encoding deve corrispondere a uno degli schemi di codifica specificati nell'intestazione Accept-Encoding.</span><span class="sxs-lookup"><span data-stu-id="303f4-117">The encoding scheme specified in the Content-Encoding header must match one of the encoding schemes specified in the Accept-Encoding header.</span></span>
-   <span data-ttu-id="303f4-118">L'intestazione Content-Encoding nella risposta specifica un solo schema di codifica.</span><span class="sxs-lookup"><span data-stu-id="303f4-118">The Content-Encoding header in the response specifies only one encoding scheme.</span></span>
-   <span data-ttu-id="303f4-119">La risposta deve contenere solo un'intestazione Content-Encoding.</span><span class="sxs-lookup"><span data-stu-id="303f4-119">The response must contain only one Content- Encoding header.</span></span> <span data-ttu-id="303f4-120">WinINet decodifica il contenuto codificato con un solo schema di codifica.</span><span class="sxs-lookup"><span data-stu-id="303f4-120">WinINet decodes content that is encoded with only one encoding scheme.</span></span>
-   <span data-ttu-id="303f4-121">L'intestazione Cache-Control non deve contenere la direttiva no-transform.</span><span class="sxs-lookup"><span data-stu-id="303f4-121">The Cache-Control header must not contain the no-transform directive.</span></span>
-   <span data-ttu-id="303f4-122">L'intestazione Content-Range non deve essere presente nella risposta.</span><span class="sxs-lookup"><span data-stu-id="303f4-122">The Content-Range header must not be present in the response.</span></span>

## <a name="setting-the-decompression-option"></a><span data-ttu-id="303f4-123">Impostazione dell'opzione di decompressione</span><span class="sxs-lookup"><span data-stu-id="303f4-123">Setting the Decompression Option</span></span>

<span data-ttu-id="303f4-124">È possibile impostare l'opzione decodifica nell'handle di sessione, nell'handle della richiesta o nell'handle di connessione.</span><span class="sxs-lookup"><span data-stu-id="303f4-124">The decoding option can be set on the session handle, the request handle or the connection handle.</span></span> <span data-ttu-id="303f4-125">L'handle su cui è impostata l'opzione di decodifica definisce l'ambito dell'opzione di decodifica.</span><span class="sxs-lookup"><span data-stu-id="303f4-125">The handle on which the decoding option is set, defines the scope of the decoding option.</span></span> <span data-ttu-id="303f4-126">Se, ad esempio, si imposta la decodifica nella sessione, la decodifica di tutte le connessioni e richieste create con tale handle.</span><span class="sxs-lookup"><span data-stu-id="303f4-126">For example, setting decoding on the session will enable decoding an all connections and requests created under that handle.</span></span>

<span data-ttu-id="303f4-127">Per impostare l'opzione di decodifica, l'applicazione chiama [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) con l'handle restituito da [**internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta)o [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span><span class="sxs-lookup"><span data-stu-id="303f4-127">To set the decoding option, the application calls [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) with the handle returned from [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta), or [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span></span> <span data-ttu-id="303f4-128">L' **opzione \_ Internet \_ \_ decodifica http** è specificata nel parametro *dwOption* e il parametro *lpBuffer* punta a una variabile booleana impostata su true.</span><span class="sxs-lookup"><span data-stu-id="303f4-128">The **INTERNET\_OPTION\_HTTP\_DECODING** option is specified in the *dwOption* parameter, and the *lpBuffer* parameter points to a boolean variable set to true.</span></span> <span data-ttu-id="303f4-129">Per disabilitare la decodifica, l'applicazione chiama **InternetSetOption** con l' **opzione \_ Internet \_ \_ decodifica http** e la variabile booleana impostata su false.</span><span class="sxs-lookup"><span data-stu-id="303f4-129">To disable decoding, the application calls **InternetSetOption** with the **INTERNET\_OPTION\_HTTP\_DECODING** option and the boolean variable set to false.</span></span>

<span data-ttu-id="303f4-130">Quando viene impostata l'opzione decodifica, WinINet esegue la decodifica sulla richiesta quando l'applicazione chiama [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span><span class="sxs-lookup"><span data-stu-id="303f4-130">When the decoding option is set, WinINet performs decoding on the request when the application calls [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span></span> <span data-ttu-id="303f4-131">Se WinINet rileva un errore durante l'esecuzione della decodifica del contenuto, la chiamata a **InternetReadFile** ha esito negativo e si verifica un **errore di \_ \_ decodifica \_ Internet**.</span><span class="sxs-lookup"><span data-stu-id="303f4-131">If WinINet encounters an error while performing content decoding, the call to **InternetReadFile** fails with an **ERROR\_INTERNET\_DECODING\_FAILED**.</span></span> <span data-ttu-id="303f4-132">Quando la decodifica ha esito negativo, l'applicazione ha due opzioni: può rimuovere l'intestazione Accept-Encoding e inviare di nuovo la richiesta oppure impostare l' **opzione \_ Internet \_ \_ decodifica http** per la richiesta su false e quindi inviare nuovamente la richiesta.</span><span class="sxs-lookup"><span data-stu-id="303f4-132">When decoding fails, the application has two options: it can remove the Accept-Encoding header and resend the request, or it can set the **INTERNET\_OPTION\_HTTP\_DECODING** option on the request to false and then resend the request.</span></span> <span data-ttu-id="303f4-133">Se l'opzione decodifica è impostata su false, l'applicazione deve controllare l'intestazione Content-Encoding ed eseguire qualsiasi decodifica a livello di applicazione.</span><span class="sxs-lookup"><span data-stu-id="303f4-133">If the decoding option is set to false, the application must check the Content-Encoding header and perform any decoding at the application level.</span></span>

> [!Note]  
> <span data-ttu-id="303f4-134">WinINet non supporta le implementazioni del server.</span><span class="sxs-lookup"><span data-stu-id="303f4-134">WinINet does not support server implementations.</span></span> <span data-ttu-id="303f4-135">Inoltre, non deve essere utilizzato da un servizio.</span><span class="sxs-lookup"><span data-stu-id="303f4-135">In addition, it should not be used from a service.</span></span> <span data-ttu-id="303f4-136">Per le implementazioni o i servizi del server, usare i [Servizi http di Microsoft Windows (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="303f4-136">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

 