---
title: Abilitazione della funzionalità Internet
description: Prima di utilizzare le funzioni WinINet, l'applicazione deve tentare di effettuare una connessione a Internet tramite la funzione InternetAttemptConnect.
ms.assetid: 80747c0d-5a09-4ffa-a0ca-b051b82acbf8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: adb44fadaf0726b81618dde19105da7517673a00
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047227"
---
# <a name="enabling-internet-functionality"></a><span data-ttu-id="d6911-103">Abilitazione della funzionalità Internet</span><span class="sxs-lookup"><span data-stu-id="d6911-103">Enabling Internet Functionality</span></span>

<span data-ttu-id="d6911-104">Prima di utilizzare le funzioni WinINet, l'applicazione deve tentare di effettuare una connessione a Internet tramite la funzione [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) .</span><span class="sxs-lookup"><span data-stu-id="d6911-104">Before using the WinINet functions, the application should attempt to make a connection to the Internet by using the [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) function.</span></span> <span data-ttu-id="d6911-105">Questa funzione chiama la finestra di dialogo di connessione remota per avviare una connessione a Internet o controllare se esiste già una connessione.</span><span class="sxs-lookup"><span data-stu-id="d6911-105">This function calls the dial-up dialog box to initiate a connection to the Internet or check if a connection already exists.</span></span> <span data-ttu-id="d6911-106">Se questa funzione ha esito negativo, l'applicazione può accedere alla modalità offline, che consente di accedere alle informazioni memorizzate nella cache durante le connessioni precedenti a Internet.</span><span class="sxs-lookup"><span data-stu-id="d6911-106">If this function fails, the application can enter offline mode, which allows it to access information that was cached during previous connections to the Internet.</span></span>

<span data-ttu-id="d6911-107">Utilizzare la funzione [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) per verificare la connessione a Internet.</span><span class="sxs-lookup"><span data-stu-id="d6911-107">Use the [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) function to check the connection to the Internet.</span></span> <span data-ttu-id="d6911-108">Tenta di effettuare il ping del server designato dall'URL passato alla funzione.</span><span class="sxs-lookup"><span data-stu-id="d6911-108">It attempts to ping the server designated by the URL that is passed to the function.</span></span> <span data-ttu-id="d6911-109">Se \_ viene impostato il flag di connessione del flag ICC \_ Force \_ e l'URL è **null**, la funzione verifica se è presente una voce nel database del server per il server più vicino.</span><span class="sxs-lookup"><span data-stu-id="d6911-109">If the FLAG\_ICC\_FORCE\_CONNECTION flag is set and the URL is **NULL**, the function checks to see if there is an entry in the server database for the nearest server.</span></span> <span data-ttu-id="d6911-110">Se ne esiste una, la funzione effettua il ping del server.</span><span class="sxs-lookup"><span data-stu-id="d6911-110">If one exists, the function pings that server.</span></span>

<span data-ttu-id="d6911-111">Utilizzare quindi la funzione [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) per stabilire le caratteristiche della connessione Internet utilizzata dall'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="d6911-111">Next, use the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function to establish the characteristics of the Internet connection the client application is using.</span></span> <span data-ttu-id="d6911-112">[**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) crea l'handle [**HINTERNET**](appendix-a-hinternet-handles.md) radice utilizzato per stabilire sessioni FTP [http](http-sessions.md)[](ftp-sessions.md) .</span><span class="sxs-lookup"><span data-stu-id="d6911-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) creates the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is used to establish [http](http-sessions.md)[ftp](ftp-sessions.md) sessions.</span></span> <span data-ttu-id="d6911-113">[**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) non verifica la connessione a Internet per verificare che le caratteristiche passate alla funzione siano corrette.</span><span class="sxs-lookup"><span data-stu-id="d6911-113">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) does not test the connection to the Internet to verify that the characteristics passed to the function are correct.</span></span>

<span data-ttu-id="d6911-114">Usare la funzione [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) per creare una sessione specifica.</span><span class="sxs-lookup"><span data-stu-id="d6911-114">Use the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function to create a specific session.</span></span> <span data-ttu-id="d6911-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) Inizializza una sessione per il sito specificato usando gli argomenti passati e crea un handle [**HINTERNET**](appendix-a-hinternet-handles.md) che è un ramo dall'handle radice.</span><span class="sxs-lookup"><span data-stu-id="d6911-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) initializes a session for the specified site using the arguments passed to it and creates an [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is a branch off the root handle.</span></span> <span data-ttu-id="d6911-116">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) non tenta di accedere o stabilire una connessione al sito specificato, tranne nel caso di una sessione FTP.</span><span class="sxs-lookup"><span data-stu-id="d6911-116">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not attempt to access or establish a connection to the specified site, except in the case of an FTP session.</span></span> <span data-ttu-id="d6911-117">Le funzioni [**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea)e [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) usano l'handle creato da [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) per stabilire una connessione al sito specificato.</span><span class="sxs-lookup"><span data-stu-id="d6911-117">[**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea), and [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) functions use the handle created by [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) to establish a connection to the specified site.</span></span>

## <a name="using-internetopen"></a><span data-ttu-id="d6911-118">Uso di InternetOpen</span><span class="sxs-lookup"><span data-stu-id="d6911-118">Using InternetOpen</span></span>

<span data-ttu-id="d6911-119">Per abilitare una connessione a Internet, è necessario creare un handle [**HINTERNET**](appendix-a-hinternet-handles.md) radice usando [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="d6911-119">To enable a connection to the Internet, a root [**HINTERNET**](appendix-a-hinternet-handles.md) handle must be created by using [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="d6911-120">Informazioni sull'agente utente (l'applicazione che chiama le funzioni Internet), il tipo di accesso a Internet, i nomi dei proxy, gli host e gli indirizzi che ignorano il proxy e il comportamento vengono passati a [**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="d6911-120">Information about the user agent (the application calling the Internet functions), the type of access to the Internet, the proxy names, the hosts and addresses that bypass the proxy, and the behavior are passed to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="setting-the-user-agent"></a><span data-ttu-id="d6911-121">Impostazione dell'agente utente</span><span class="sxs-lookup"><span data-stu-id="d6911-121">Setting the User Agent</span></span>

<span data-ttu-id="d6911-122">L'applicazione chiamante deve assegnare a una stringa che contiene il nome dell'applicazione o dell'entità che accede a Internet al parametro *lpszAgent* di [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="d6911-122">The calling application should give a string that contains the name of the application or entity accessing the Internet to the *lpszAgent* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="d6911-123">Questa stringa viene utilizzata come agente utente nel protocollo HTTP.</span><span class="sxs-lookup"><span data-stu-id="d6911-123">This string is used as the user agent in the HTTP protocol.</span></span> <span data-ttu-id="d6911-124">Ad esempio, in Microsoft Internet Explorer viene utilizzato "Microsoft Internet Explorer".</span><span class="sxs-lookup"><span data-stu-id="d6911-124">For example, Microsoft Internet Explorer uses "Microsoft Internet Explorer".</span></span>

### <a name="setting-access-types"></a><span data-ttu-id="d6911-125">Impostazione di tipi di accesso</span><span class="sxs-lookup"><span data-stu-id="d6911-125">Setting Access Types</span></span>

<span data-ttu-id="d6911-126">[**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) supporta tre tipi di accesso:</span><span class="sxs-lookup"><span data-stu-id="d6911-126">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) supports three access types:</span></span>

-   <span data-ttu-id="d6911-127">USA INTERNET \_ Open \_ Type \_ Direct se il sistema in cui è in esecuzione l'applicazione usa una connessione diretta a Internet.</span><span class="sxs-lookup"><span data-stu-id="d6911-127">Use INTERNET\_OPEN\_TYPE\_DIRECT if the system on which the application is running uses a direct connection to the Internet.</span></span> <span data-ttu-id="d6911-128">I parametri *lpszProxyName* e *LpszProxyBypass* di [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) non vengono usati e devono essere impostati su **null**.</span><span class="sxs-lookup"><span data-stu-id="d6911-128">The *lpszProxyName* and *lpszProxyBypass* parameters of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) are not used and should be set to **NULL**.</span></span>
-   <span data-ttu-id="d6911-129">Utilizzare il \_ \_ proxy di tipo Internet aperto \_ se il sistema in cui viene eseguita l'applicazione utilizza uno o più server proxy per accedere a Internet.</span><span class="sxs-lookup"><span data-stu-id="d6911-129">Use INTERNET\_OPEN\_TYPE\_PROXY if the system on which the application is running uses one or more proxy servers to access the Internet.</span></span> <span data-ttu-id="d6911-130">[**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) usa i server proxy indicati da *lpszProxyName* e ignora il proxy per qualsiasi nome host o indirizzo IP specificato da *lpszProxyBypass*.</span><span class="sxs-lookup"><span data-stu-id="d6911-130">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) uses the proxy servers indicated by *lpszProxyName* and bypasses the proxy for any host names or IP addresses specified by *lpszProxyBypass*.</span></span>
-   <span data-ttu-id="d6911-131">Utilizzare la \_ \_ preconfigurazione di tipo Internet Open \_ per indicare all'applicazione di recuperare la configurazione dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="d6911-131">Use INTERNET\_OPEN\_TYPE\_PRECONFIG to instruct your application to retrieve the configuration from the registry.</span></span> <span data-ttu-id="d6911-132">Si tratta in genere della scelta migliore, perché la maggior parte delle applicazioni che includono i Web browser utilizzano questa opzione.</span><span class="sxs-lookup"><span data-stu-id="d6911-132">This is typically the best choice, as most applications including web browsers use this option.</span></span>

<span data-ttu-id="d6911-133">\_ \_ La preconfigurazione di Internet Open Type \_ esamina i valori del registro di sistema **ProxyEnable**, **ProxyServer** e **ProxyOverride**.</span><span class="sxs-lookup"><span data-stu-id="d6911-133">INTERNET\_OPEN\_TYPE\_PRECONFIG looks at the registry values **ProxyEnable**, **ProxyServer**, and **ProxyOverride**.</span></span> <span data-ttu-id="d6911-134">Questi valori si trovano in "HKEY \_ Current \_ User \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings".</span><span class="sxs-lookup"><span data-stu-id="d6911-134">These values are located under "HKEY\_CURRENT\_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings".</span></span>

<span data-ttu-id="d6911-135">Se **ProxyEnable** è zero, l'applicazione usa Internet \_ Open \_ Type \_ Direct.</span><span class="sxs-lookup"><span data-stu-id="d6911-135">If **ProxyEnable** is zero, the application uses INTERNET\_OPEN\_TYPE\_DIRECT.</span></span> <span data-ttu-id="d6911-136">In caso contrario, l'applicazione \_ Usa \_ \_ il proxy di tipo Internet Open e usa le informazioni **ProxyServer** e **ProxyOverride** .</span><span class="sxs-lookup"><span data-stu-id="d6911-136">Otherwise, the application uses INTERNET\_OPEN\_TYPE\_PROXY and uses the **ProxyServer** and **ProxyOverride** information.</span></span>

<span data-ttu-id="d6911-137">Le funzioni WinINet forniscono supporto per i proxy di tipo SOCKS solo se è installato Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="d6911-137">The WinINet functions provide support for SOCKS type proxies only if Internet Explorer is installed.</span></span> <span data-ttu-id="d6911-138">L'installazione di Internet Explorer include il file di Wsock32n.dll, che è necessario per supportare i proxy SOCKS.</span><span class="sxs-lookup"><span data-stu-id="d6911-138">The installation of Internet Explorer includes the Wsock32n.dll file, which is needed to support SOCKS proxies.</span></span> <span data-ttu-id="d6911-139">Wsock32n.dll non è ridistribuibile.</span><span class="sxs-lookup"><span data-stu-id="d6911-139">Wsock32n.dll is not redistributable.</span></span>

### <a name="listing-proxy-servers"></a><span data-ttu-id="d6911-140">Elenco di server proxy</span><span class="sxs-lookup"><span data-stu-id="d6911-140">Listing Proxy Servers</span></span>

<span data-ttu-id="d6911-141">WinINet riconosce due tipi di proxy: proxy di tipo CERN (solo HTTP) e proxy FTP TIS (solo FTP).</span><span class="sxs-lookup"><span data-stu-id="d6911-141">WinINet recognizes two types of proxies: CERN type proxies (HTTP only) and TIS FTP proxies (FTP only).</span></span> <span data-ttu-id="d6911-142">Se Internet Explorer è installato, WinINet supporta anche i proxy di tipo SOCKS.</span><span class="sxs-lookup"><span data-stu-id="d6911-142">If Internet Explorer is installed, WinINet also support SOCKS type proxies.</span></span> <span data-ttu-id="d6911-143">Per impostazione predefinita, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) presuppone che il proxy specificato sia un proxy CERN.</span><span class="sxs-lookup"><span data-stu-id="d6911-143">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) assumes, by default, that the specified proxy is a CERN proxy.</span></span> <span data-ttu-id="d6911-144">Se il tipo di accesso è impostato su \_ Internet Open \_ Type \_ Direct o Internet \_ Open \_ Type \_ preconfig, il parametro *lpszProxyName* di [**internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) deve essere impostato su **null**.</span><span class="sxs-lookup"><span data-stu-id="d6911-144">If the access type is set to INTERNET\_OPEN\_TYPE\_DIRECT or INTERNET\_OPEN\_TYPE\_PRECONFIG, the *lpszProxyName* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) should be set to **NULL**.</span></span> <span data-ttu-id="d6911-145">In caso contrario, il valore passato a *lpszProxyName* deve contenere i proxy in una stringa delimitata da spazi.</span><span class="sxs-lookup"><span data-stu-id="d6911-145">Otherwise, the value passed to *lpszProxyName* must contain the proxies in a space-delimited string.</span></span> <span data-ttu-id="d6911-146">Gli elenchi proxy possono contenere il numero di porta utilizzato per accedere al proxy.</span><span class="sxs-lookup"><span data-stu-id="d6911-146">The proxy listings can contain the port number that is used to access the proxy.</span></span>

<span data-ttu-id="d6911-147">Per elencare un proxy per un protocollo specifico, la stringa deve seguire il formato "" <protocol> <protocol> ://<\_ nome proxy> "".</span><span class="sxs-lookup"><span data-stu-id="d6911-147">To list a proxy for a specific protocol, the string must follow the format ""<protocol><protocol>://<proxy\_name>"".</span></span> <span data-ttu-id="d6911-148">I protocolli validi sono HTTP, HTTPS e FTP.</span><span class="sxs-lookup"><span data-stu-id="d6911-148">The valid protocols are HTTP, HTTPS and FTP.</span></span> <span data-ttu-id="d6911-149">Ad esempio, per elencare un proxy FTP, una stringa valida è "" FTP = FTP://FTP \_ \_ nome proxy: 21 "", dove \_ nome proxy FTP \_ è il nome del proxy FTP e 21 è il numero di porta che deve essere usato per accedere al proxy.</span><span class="sxs-lookup"><span data-stu-id="d6911-149">For example, to list an FTP proxy, a valid string would be ""ftp=ftp://ftp\_proxy\_name:21"", where ftp\_proxy\_name is the name of the FTP proxy and 21 is the port number that must be used to access the proxy.</span></span> <span data-ttu-id="d6911-150">Se il proxy usa il numero di porta predefinito per quel protocollo, il numero di porta può essere omesso.</span><span class="sxs-lookup"><span data-stu-id="d6911-150">If the proxy uses the default port number for that protocol, the port number can be omitted.</span></span> <span data-ttu-id="d6911-151">Se il nome di un proxy è elencato da solo, viene usato come proxy predefinito per i protocolli per i quali non è specificato un proxy specifico.</span><span class="sxs-lookup"><span data-stu-id="d6911-151">If a proxy name is listed by itself, it is used as the default proxy for any protocols that do not have a specific proxy specified.</span></span> <span data-ttu-id="d6911-152">Ad esempio, "" http = https://http\_proxy other "" utilizzerebbe il \_ proxy HTTP per qualsiasi operazione http, mentre tutti gli altri protocolli useranno altri.</span><span class="sxs-lookup"><span data-stu-id="d6911-152">For example, ""http=https://http\_proxy other"" would use http\_proxy for any HTTP operations, while all other protocols would use other.</span></span>

<span data-ttu-id="d6911-153">Per impostazione predefinita, la funzione presuppone che il proxy specificato da *lpszProxyName* sia un proxy CERN.</span><span class="sxs-lookup"><span data-stu-id="d6911-153">By default, the function assumes that the proxy specified by *lpszProxyName* is a CERN proxy.</span></span> <span data-ttu-id="d6911-154">Un'applicazione può specificare più di un proxy, inclusi proxy diversi per i diversi protocolli.</span><span class="sxs-lookup"><span data-stu-id="d6911-154">An application can specify more than one proxy, including different proxies for the different protocols.</span></span> <span data-ttu-id="d6911-155">Se ad esempio si specifica "" FTP = FTP://FTP-GW HTTP = https://jericho:99 proxy "", le richieste FTP vengono effettuate tramite il proxy FTP-GW, che è in ascolto sulla porta 21 e le richieste HTTP vengono effettuate tramite un proxy CERN chiamato Jericho, che è in ascolto sulla porta 99.</span><span class="sxs-lookup"><span data-stu-id="d6911-155">For example, if you specify ""ftp=ftp://ftp-gw HTTP=https://jericho:99 proxy"", FTP requests are made through the ftp-gw proxy, which listens at port 21, and HTTP requests are made through a CERN proxy called jericho, which listens at port 99.</span></span> <span data-ttu-id="d6911-156">In caso contrario, le richieste HTTP vengono effettuate tramite il proxy CERN denominato proxy, che è in ascolto sulla porta 80.</span><span class="sxs-lookup"><span data-stu-id="d6911-156">Otherwise, HTTP requests would be made through the CERN proxy called proxy, which listens at port 80.</span></span> <span data-ttu-id="d6911-157">Si noti che se l'applicazione usa solo FTP, ad esempio, non è necessario specificare "" FTP = FTP://FTP-GW: 21 "".</span><span class="sxs-lookup"><span data-stu-id="d6911-157">Note that if the application is only using FTP, for example, it would not need to specify ""ftp=ftp://ftp-gw:21"".</span></span> <span data-ttu-id="d6911-158">Potrebbe specificare solo "" FTP-GW "".</span><span class="sxs-lookup"><span data-stu-id="d6911-158">It could specify just ""ftp-gw"".</span></span> <span data-ttu-id="d6911-159">Un'applicazione è necessaria solo per specificare i nomi di protocollo se usa più di un protocollo per handle restituito da [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="d6911-159">An application is only required to specify the protocol names if it is using more than one protocol per handle returned by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="listing-the-proxy-bypass"></a><span data-ttu-id="d6911-160">Elenco del bypass proxy</span><span class="sxs-lookup"><span data-stu-id="d6911-160">Listing the Proxy Bypass</span></span>

<span data-ttu-id="d6911-161">I nomi host o gli indirizzi IP che non devono essere inviati al proxy possono essere elencati nell'elenco proxy bypass.</span><span class="sxs-lookup"><span data-stu-id="d6911-161">Host names or IP addresses that should not be sent to the proxy can be listed in the proxy bypass list.</span></span> <span data-ttu-id="d6911-162">Questo elenco può contenere caratteri jolly, " \* ", che fanno sì che l'applicazione ignori il server proxy per gli indirizzi che soddisfano il criterio specificato.</span><span class="sxs-lookup"><span data-stu-id="d6911-162">This list can contain wildcards, "\*", which cause the application to bypass the proxy server for addresses that fit the specified pattern.</span></span> <span data-ttu-id="d6911-163">Per elencare più indirizzi e nomi host, separarli con punti e virgola nella stringa di bypass del proxy.</span><span class="sxs-lookup"><span data-stu-id="d6911-163">To list multiple addresses and host names, separate them with semicolons in the proxy bypass string.</span></span> <span data-ttu-id="d6911-164">Se <local> viene specificata la macro "", la funzione ignora il proxy per qualsiasi nome host che non contiene un punto.</span><span class="sxs-lookup"><span data-stu-id="d6911-164">If the "<local>" macro is specified, the function bypasses the proxy for any host name that does not contain a period.</span></span>

<span data-ttu-id="d6911-165">Per impostazione predefinita, WinINet ignorerà il proxy per le richieste che utilizzano i nomi host "localhost", "loopback", "127.0.0.1" o " \[ :: 1 \] ".</span><span class="sxs-lookup"><span data-stu-id="d6911-165">By default, WinINet will bypass the proxy for requests that use the host names "localhost", "loopback", "127.0.0.1", or "\[::1\]".</span></span> <span data-ttu-id="d6911-166">Questo comportamento è dovuto al fatto che un server proxy remoto non risolve questi indirizzi in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="d6911-166">This behavior exists because a remote proxy server typically will not resolve these addresses properly.</span></span>

<span data-ttu-id="d6911-167">**Internet Explorer 9:** È possibile rimuovere il computer locale dall'elenco proxy bypass usando la macro "<-loopback>".</span><span class="sxs-lookup"><span data-stu-id="d6911-167">**Internet Explorer 9:** You can remove the local computer from the proxy bypass list using the "<-loopback>" macro.</span></span>

<span data-ttu-id="d6911-168">Nell'esempio seguente vengono illustrate le chiamate di esempio a [**Internetopn**](/windows/desktop/api/Wininet/nf-wininet-internetopena) usando stringhe di bypass proxy diverse.</span><span class="sxs-lookup"><span data-stu-id="d6911-168">The following example shows sample calls to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) using different proxy bypass strings.</span></span> <span data-ttu-id="d6911-169">I commenti sopra ogni chiamata descrivono l'effetto della stringa di bypass sui nomi host a cui si accede dall'handle [**HINTERNET**](appendix-a-hinternet-handles.md) creato.</span><span class="sxs-lookup"><span data-stu-id="d6911-169">The comments above each call describe what effect the bypass string has on the host names that are accessed from the [**HINTERNET**](appendix-a-hinternet-handles.md) handle it creates.</span></span>


```C++
HINTERNET hInternetRoot;

/* bypass the proxy for any host name that does not 
    contain a period */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("<local>"), 0);

/* bypass the proxy for any host name that starts with the 
    letters "ms" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("ms*"), 0);

/* bypass the proxy for any host name that contains "int", 
    such as "internet" and "painter" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("*int*"), 0);

/* bypass the proxy for the host name "example" and any 
    host name that contains "test" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("example *test*"), 0);

/* Disable the loopback proxy bypass for localhost */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("127.0.0.1:8888"),TEXT("<-loopback>"), 0);
```



## <a name="using-internetconnect"></a><span data-ttu-id="d6911-170">Uso di InternetConnect</span><span class="sxs-lookup"><span data-stu-id="d6911-170">Using InternetConnect</span></span>

<span data-ttu-id="d6911-171">Per iniziare una sessione, la funzione [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) deve creare un handle dall'handle radice restituito dalla funzione [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) .</span><span class="sxs-lookup"><span data-stu-id="d6911-171">To begin a session, the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function must create a handle off the root handle returned by the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function.</span></span> <span data-ttu-id="d6911-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) imposta l'indirizzo del server, il numero di porta, il nome utente, la password e il tipo di servizio.</span><span class="sxs-lookup"><span data-stu-id="d6911-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) sets the server address, port number, user name, password, and type of service.</span></span>

<span data-ttu-id="d6911-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) usa l'handle [**HINTERNET**](appendix-a-hinternet-handles.md) radice creato da [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) per stabilire un handle di sessione.</span><span class="sxs-lookup"><span data-stu-id="d6911-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle created by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) to establish a session handle.</span></span> <span data-ttu-id="d6911-174">Se il flag di [ \_ flag \_ asincrono Internet](api-flags.md) è stato impostato nella chiamata a [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), la chiamata a [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) deve includere un valore di contesto diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="d6911-174">If the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag was set in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), the call to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) should include a nonzero context value.</span></span>

<span data-ttu-id="d6911-175">Il nome del server può contenere il nome host (ad esempio, "www.servername.com") o il numero IP del sito in formato ASCII punteggiato-decimale (ad esempio, "10.0.1.45").</span><span class="sxs-lookup"><span data-stu-id="d6911-175">The server name can contain either the host name (for example, "www.servername.com") or IP number of the site in ASCII dotted-decimal format (for example, "10.0.1.45").</span></span>

<span data-ttu-id="d6911-176">La porta del server è il numero di porta TCP/IP (Transmission Control Protocol/Internet Protocol) a cui connettersi nel server.</span><span class="sxs-lookup"><span data-stu-id="d6911-176">The server port is the Transmission Control Protocol/Internet Protocol (TCP/IP) port number to connect to on the server.</span></span> <span data-ttu-id="d6911-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) utilizza la porta predefinita per il tipo di servizio selezionato se \_ viene utilizzato il valore del numero di porta non valido Internet \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="d6911-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the default port for the selected service type if the INTERNET\_INVALID\_PORT\_NUMBER value is used.</span></span> <span data-ttu-id="d6911-178">Le tabelle seguenti contengono le impostazioni predefinite della porta del server per WinINet.</span><span class="sxs-lookup"><span data-stu-id="d6911-178">The following tables contain the server port defaults for WinINet.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="d6911-179">Valore</span><span class="sxs-lookup"><span data-stu-id="d6911-179">Value</span></span></th>
<th><span data-ttu-id="d6911-180">Significato</span><span class="sxs-lookup"><span data-stu-id="d6911-180">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="d6911-181">INTERNET_DEFAULT_FTP_PORT</span><span class="sxs-lookup"><span data-stu-id="d6911-181">INTERNET_DEFAULT_FTP_PORT</span></span></td>
<td><span data-ttu-id="d6911-182">Utilizzare la porta predefinita per i server FTP (porta 21).</span><span class="sxs-lookup"><span data-stu-id="d6911-182">Use the default port for ftp servers (port 21).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d6911-183">INTERNET_DEFAULT_GOPHER_PORT</span><span class="sxs-lookup"><span data-stu-id="d6911-183">INTERNET_DEFAULT_GOPHER_PORT</span></span></td>
<td><span data-ttu-id="d6911-184">Utilizzare la porta predefinita per i server Gopher (porta 70).</span><span class="sxs-lookup"><span data-stu-id="d6911-184">Use the default port for gopher servers (port 70).</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="d6911-185">Windows XP e Windows Server 2003 R2 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="d6911-185">Windows XP and Windows Server 2003 R2 and earlier only.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d6911-186">INTERNET_DEFAULT_HTTP_PORT</span><span class="sxs-lookup"><span data-stu-id="d6911-186">INTERNET_DEFAULT_HTTP_PORT</span></span></td>
<td><span data-ttu-id="d6911-187">Utilizzare la porta predefinita per i server http (porta 80).</span><span class="sxs-lookup"><span data-stu-id="d6911-187">Use the default port for http servers (port 80).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d6911-188">INTERNET_DEFAULT_HTTPS_PORT</span><span class="sxs-lookup"><span data-stu-id="d6911-188">INTERNET_DEFAULT_HTTPS_PORT</span></span></td>
<td><span data-ttu-id="d6911-189">Utilizzare la porta predefinita per i server HTTPS (porta 443).</span><span class="sxs-lookup"><span data-stu-id="d6911-189">Use the default port for https servers (port 443).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d6911-190">INTERNET_DEFAULT_SOCKS_PORT</span><span class="sxs-lookup"><span data-stu-id="d6911-190">INTERNET_DEFAULT_SOCKS_PORT</span></span></td>
<td><span data-ttu-id="d6911-191">Usare la porta predefinita per i server del firewall SOCKS (porta 1080).</span><span class="sxs-lookup"><span data-stu-id="d6911-191">Use the default port for SOCKS firewall servers (port 1080).</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="defining-the-user-name-and-password"></a><span data-ttu-id="d6911-192">Definizione del nome utente e della password</span><span class="sxs-lookup"><span data-stu-id="d6911-192">Defining the User Name and Password</span></span>

<span data-ttu-id="d6911-193">Il valore di *lpszUsername* è l'indirizzo di una stringa con terminazione **null** che contiene il nome dell'utente che esegue l'accesso.</span><span class="sxs-lookup"><span data-stu-id="d6911-193">The value of *lpszUsername* is the address of a **null**-terminated string that contains the name of the user who is logging on.</span></span> <span data-ttu-id="d6911-194">Se questo parametro è **null**, la funzione userà un valore predefinito appropriato, ad eccezione di http.</span><span class="sxs-lookup"><span data-stu-id="d6911-194">If this parameter is **NULL**, the function uses an appropriate default, except for HTTP.</span></span> <span data-ttu-id="d6911-195">Un parametro **null** in http fa in modo che il server restituisca un errore.</span><span class="sxs-lookup"><span data-stu-id="d6911-195">A **NULL** parameter in HTTP causes the server to return an error.</span></span> <span data-ttu-id="d6911-196">Per il protocollo FTP, il valore predefinito è anonimo.</span><span class="sxs-lookup"><span data-stu-id="d6911-196">For the FTP protocol, the default is anonymous.</span></span>

<span data-ttu-id="d6911-197">Il valore di *lpszPassword* è l'indirizzo di una stringa con terminazione **null** che contiene la password di accesso.</span><span class="sxs-lookup"><span data-stu-id="d6911-197">The value of *lpszPassword* is the address of a **null**-terminated string that contains the log-on password.</span></span> <span data-ttu-id="d6911-198">Se *lpszUsername* e *LpszPassword* sono entrambi **null**, la funzione userà la password anonima predefinita.</span><span class="sxs-lookup"><span data-stu-id="d6911-198">If both *lpszUsername* and *lpszPassword* are **NULL**, the function uses the default anonymous password.</span></span> <span data-ttu-id="d6911-199">Nel caso di FTP, la password anonima predefinita corrisponde al nome di posta elettronica dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d6911-199">In the case of FTP, the default anonymous password is the user's email name.</span></span> <span data-ttu-id="d6911-200">Se *lpszUsername* non è **null** e *lpszPassword* è **null**, la funzione userà una password vuota.</span><span class="sxs-lookup"><span data-stu-id="d6911-200">If *lpszUsername* is not **NULL** and *lpszPassword* is **NULL**, the function uses a blank password.</span></span> <span data-ttu-id="d6911-201">Sono disponibili quattro possibili impostazioni di *lpszUsername* e *lpszPassword*, che producono i comportamenti illustrati nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="d6911-201">There are four possible settings of *lpszUsername* and *lpszPassword*, which produce the behaviors shown in the following table.</span></span>



| <span data-ttu-id="d6911-202">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="d6911-202">*lpszUsername*</span></span>      | <span data-ttu-id="d6911-203">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="d6911-203">*lpszPassword*</span></span>      | <span data-ttu-id="d6911-204">Nome utente inviato al server FTP</span><span class="sxs-lookup"><span data-stu-id="d6911-204">User name sent to FTP server</span></span> | <span data-ttu-id="d6911-205">Password inviata al server FTP</span><span class="sxs-lookup"><span data-stu-id="d6911-205">Password sent to FTP server</span></span> |
|---------------------|---------------------|------------------------------|-----------------------------|
| <span data-ttu-id="d6911-206">**NULL**</span><span class="sxs-lookup"><span data-stu-id="d6911-206">**NULL**</span></span>            | <span data-ttu-id="d6911-207">**NULL**</span><span class="sxs-lookup"><span data-stu-id="d6911-207">**NULL**</span></span>            | <span data-ttu-id="d6911-208">Anonimo</span><span class="sxs-lookup"><span data-stu-id="d6911-208">"anonymous"</span></span>                  | <span data-ttu-id="d6911-209">Nome di posta elettronica dell'utente</span><span class="sxs-lookup"><span data-stu-id="d6911-209">User's email name</span></span>           |
| <span data-ttu-id="d6911-210">Stringa non **null**</span><span class="sxs-lookup"><span data-stu-id="d6911-210">Non-**NULL** string</span></span> | <span data-ttu-id="d6911-211">**NULL**</span><span class="sxs-lookup"><span data-stu-id="d6911-211">**NULL**</span></span>            | <span data-ttu-id="d6911-212">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="d6911-212">*lpszUsername*</span></span>               | <span data-ttu-id="d6911-213">""</span><span class="sxs-lookup"><span data-stu-id="d6911-213">""</span></span>                          |
| <span data-ttu-id="d6911-214">**NULL**</span><span class="sxs-lookup"><span data-stu-id="d6911-214">**NULL**</span></span>            | <span data-ttu-id="d6911-215">Stringa non **null**</span><span class="sxs-lookup"><span data-stu-id="d6911-215">Non-**NULL** string</span></span> | <span data-ttu-id="d6911-216">ERRORE</span><span class="sxs-lookup"><span data-stu-id="d6911-216">ERROR</span></span>                        | <span data-ttu-id="d6911-217">ERRORE</span><span class="sxs-lookup"><span data-stu-id="d6911-217">ERROR</span></span>                       |
| <span data-ttu-id="d6911-218">Stringa non **null**</span><span class="sxs-lookup"><span data-stu-id="d6911-218">Non-**NULL** string</span></span> | <span data-ttu-id="d6911-219">Stringa non **null**</span><span class="sxs-lookup"><span data-stu-id="d6911-219">Non-**NULL** string</span></span> | <span data-ttu-id="d6911-220">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="d6911-220">*lpszUsername*</span></span>               | <span data-ttu-id="d6911-221">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="d6911-221">*lpszPassword*</span></span>              |



 

<span data-ttu-id="d6911-222">Queste informazioni possono essere modificate usando le funzioni [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) e [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) .</span><span class="sxs-lookup"><span data-stu-id="d6911-222">This information can be changed by using the [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) and [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) functions.</span></span> <span data-ttu-id="d6911-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) modifica i valori di nome utente e password, mentre [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) Visualizza una finestra di dialogo che richiede il nome utente e la password appropriati.</span><span class="sxs-lookup"><span data-stu-id="d6911-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) changes the user name and password values, while [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) displays a dialog box that requests the proper user name and password.</span></span>

### <a name="defining-the-session"></a><span data-ttu-id="d6911-224">Definizione della sessione</span><span class="sxs-lookup"><span data-stu-id="d6911-224">Defining the Session</span></span>

<span data-ttu-id="d6911-225">Per definire la sessione stabilita, impostare il tipo di servizio, i flag e il valore di contesto per [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span><span class="sxs-lookup"><span data-stu-id="d6911-225">To define the session that is being established, set the service type, flags, and context value for [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span></span>

<span data-ttu-id="d6911-226">Per [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta)sono disponibili due tipi di servizio: \_ FTP servizio Internet \_ e \_ http servizio Internet \_ .</span><span class="sxs-lookup"><span data-stu-id="d6911-226">There are two service types available to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): INTERNET\_SERVICE\_FTP and INTERNET\_SERVICE\_HTTP.</span></span> <span data-ttu-id="d6911-227">Il \_ servizio Internet \_ http viene usato per le sessioni HTTP e HTTPS.</span><span class="sxs-lookup"><span data-stu-id="d6911-227">INTERNET\_SERVICE\_HTTP is used for both HTTP and HTTPS sessions.</span></span>

<span data-ttu-id="d6911-228">[Internet \_ FLAG \_ passive](api-flags.md) è l'unico flag specifico del servizio usato dalle funzioni WinInet.</span><span class="sxs-lookup"><span data-stu-id="d6911-228">[INTERNET\_FLAG\_PASSIVE](api-flags.md) is the only service-specific flag used by the WinINet functions.</span></span> <span data-ttu-id="d6911-229">Questo flag può essere impostato quando il tipo di servizio è \_ FTP servizio Internet per \_ utilizzare la semantica FTP passiva.</span><span class="sxs-lookup"><span data-stu-id="d6911-229">This flag can be set when the service type is INTERNET\_SERVICE\_FTP in order to use passive FTP semantics.</span></span>

<span data-ttu-id="d6911-230">Per tutte le operazioni sincrone, il valore di *dwContext* deve essere impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="d6911-230">For all synchronous operations, the value of *dwContext* should be set to zero.</span></span> <span data-ttu-id="d6911-231">Se le operazioni asincrone sono state stabilite impostando il flag del [ \_ flag \_ asincrono per Internet](api-flags.md) nella chiamata a [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), è necessario specificare un valore diverso da zero per *dwContext*.</span><span class="sxs-lookup"><span data-stu-id="d6911-231">If asynchronous operations were established by setting the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), a nonzero value should be supplied for *dwContext*.</span></span> <span data-ttu-id="d6911-232">Per ulteriori informazioni sulle operazioni asincrone, vedere [configurazione di operazioni asincrone](common-functions.md).</span><span class="sxs-lookup"><span data-stu-id="d6911-232">For more information on asynchronous operations, see [Setting Up Asynchronous Operations](common-functions.md).</span></span>

<span data-ttu-id="d6911-233">Per le sessioni FTP, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tenta di stabilire una connessione al server su Internet.</span><span class="sxs-lookup"><span data-stu-id="d6911-233">For FTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tries to establish a connection to the server on the Internet.</span></span> <span data-ttu-id="d6911-234">Per le sessioni HTTP, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) non stabilisce una connessione finché un'altra funzione non tenta di ottenere informazioni dal server.</span><span class="sxs-lookup"><span data-stu-id="d6911-234">For HTTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not establish a connection until another function attempts to get information from the server.</span></span>

> [!Note]  
> <span data-ttu-id="d6911-235">WinINet non supporta le implementazioni del server.</span><span class="sxs-lookup"><span data-stu-id="d6911-235">WinINet does not support server implementations.</span></span> <span data-ttu-id="d6911-236">Inoltre, non deve essere utilizzato da un servizio.</span><span class="sxs-lookup"><span data-stu-id="d6911-236">In addition, it should not be used from a service.</span></span> <span data-ttu-id="d6911-237">Per le implementazioni o i servizi del server, usare i [Servizi http di Microsoft Windows (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="d6911-237">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

