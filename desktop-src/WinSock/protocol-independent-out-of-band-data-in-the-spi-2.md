---
description: I dati fuori banda (OOB) sono un canale di trasmissione logicamente indipendente associato a una coppia di socket di flusso connessi.
ms.assetid: 30f667cd-5be9-45f2-9d55-bff04834078f
title: Dati indipendenti dal protocollo in banda in SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b53e5c7c5c8c8ad7a5985ec101dd157370c5f32f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526113"
---
# <a name="protocol-independentout-of-band-data-in-the-spi"></a><span data-ttu-id="7ab71-103">Dati indipendenti dal protocollo in banda in SPI</span><span class="sxs-lookup"><span data-stu-id="7ab71-103">Protocol IndependentOut-of-Band Data in the SPI</span></span>

<span data-ttu-id="7ab71-104">I dati fuori banda (OOB) sono un canale di trasmissione logicamente indipendente associato a una coppia di socket di flusso connessi.</span><span class="sxs-lookup"><span data-stu-id="7ab71-104">Out-of-Band (OOB) data is a logically independent transmission channel associated with a pair of connected stream sockets.</span></span> <span data-ttu-id="7ab71-105">I dati di OOB possono essere recapitati all'utente indipendentemente dai dati normali.</span><span class="sxs-lookup"><span data-stu-id="7ab71-105">OOB data may be delivered to the user independently of normal data.</span></span> <span data-ttu-id="7ab71-106">L'astrazione definisce che le funzionalità dei dati OOB devono supportare il recapito affidabile di almeno un blocco di dati OOB alla volta.</span><span class="sxs-lookup"><span data-stu-id="7ab71-106">The abstraction defines that the OOB data facilities must support the reliable delivery of at least one OOB data block at a time.</span></span> <span data-ttu-id="7ab71-107">Questo blocco di dati può contenere almeno un byte di dati e almeno un blocco di dati OOB potrebbe essere recapitato in attesa all'utente in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="7ab71-107">This data block may contain at least one byte of data, and at least one OOB data block may be pending delivery to the user at any one time.</span></span> <span data-ttu-id="7ab71-108">Per i protocolli di comunicazione che supportano la segnalazione in banda (ovvero TCP, in cui i dati urgenti vengono recapitati in sequenza con i dati normali), il sistema estrae in genere i dati OOB dal flusso di dati normale e li archivia separatamente (lasciando un gap nel flusso di dati normale).</span><span class="sxs-lookup"><span data-stu-id="7ab71-108">For communications protocols which support in-band signaling (that is, TCP, where the urgent data is delivered in sequence with the normal data), the system normally extracts the OOB data from the normal data stream and stores it separately (leaving a gap in the normal data stream).</span></span> <span data-ttu-id="7ab71-109">Ciò consente agli utenti di scegliere tra la ricezione dei dati di OOB nell'ordine e la ricezione fuori sequenza senza dover memorizzare nel buffer tutti i dati interessati.</span><span class="sxs-lookup"><span data-stu-id="7ab71-109">This allows users to choose between receiving the OOB data in order and receiving it out of sequence without having to buffer all the intervening data.</span></span> <span data-ttu-id="7ab71-110">È possibile leggere i dati di OOB.</span><span class="sxs-lookup"><span data-stu-id="7ab71-110">It is possible to peek at OOB data.</span></span>

<span data-ttu-id="7ab71-111">Un utente può determinare se sono presenti dati OOB in attesa di essere letti tramite la funzione [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK).</span><span class="sxs-lookup"><span data-stu-id="7ab71-111">A user can determine if there is any OOB data waiting to be read using the [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK) function.</span></span> <span data-ttu-id="7ab71-112">Per i protocolli in cui il concetto di posizione del blocco di dati OOB all'interno del flusso di dati normale è significativo (ovvero TCP), un provider di servizi Windows Sockets manterrà un marcatore concettuale che indica la posizione dell'ultimo byte dei dati OOB all'interno del flusso di dati normale.</span><span class="sxs-lookup"><span data-stu-id="7ab71-112">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful (that is, TCP), a Windows Sockets service provider will maintain a conceptual marker indicating the position of the last byte of OOB data within the normal data stream.</span></span> <span data-ttu-id="7ab71-113">Questa operazione non è necessaria per l'implementazione della funzionalità **WSPIoctl** (SIOCATMARK), ovvero la presenza o l'assenza di dati OOB è sufficiente.</span><span class="sxs-lookup"><span data-stu-id="7ab71-113">This is not necessary for the implementation of the **WSPIoctl** (SIOCATMARK) functionality — the presence or absence of OOB data is all that is required.</span></span>

<span data-ttu-id="7ab71-114">Per i protocolli in cui il concetto di posizione del blocco di dati OOB all'interno del flusso di dati normale è significativo, un'applicazione può preferire elaborare dati fuori banda inline, come parte del normale flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="7ab71-114">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful an application may prefer to process out-of-band data inline, as part of the normal data stream.</span></span> <span data-ttu-id="7ab71-115">Questa operazione viene eseguita impostando l'opzione socket in modo da \_ OOBINLINE (vedere la sezione [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span><span class="sxs-lookup"><span data-stu-id="7ab71-115">This is achieved by setting the socket option SO\_OOBINLINE (see section [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span></span> <span data-ttu-id="7ab71-116">Per altri protocolli in cui i blocchi di dati OOB sono realmente indipendenti dal flusso di dati normale, il tentativo di impostare in modo che \_ OOBINLINE provochi un errore.</span><span class="sxs-lookup"><span data-stu-id="7ab71-116">For other protocols where the OOB data blocks are truly independent of the normal data stream, attempting to set SO\_OOBINLINE will result in an error.</span></span> <span data-ttu-id="7ab71-117">Un'applicazione può usare il comando SIOCATMARK WSPIoctl per determinare se sono presenti dati OOB non letti che precedono il contrassegno.</span><span class="sxs-lookup"><span data-stu-id="7ab71-117">An application can use the SIOCATMARK WSPIoctl command to determine whether there is any unread OOB data preceding the mark.</span></span> <span data-ttu-id="7ab71-118">Ad esempio, può utilizzare questo oggetto per risincronizzare con il relativo peer garantendo che tutti i dati fino al contrassegno nel flusso di dati vengano eliminati quando appropriato.</span><span class="sxs-lookup"><span data-stu-id="7ab71-118">For example, it might use this to resynchronize with its peer by ensuring that all data up to the mark in the data stream is discarded when appropriate.</span></span>

<span data-ttu-id="7ab71-119">Con \_ OOBINLINE disabilitato (per impostazione predefinita):</span><span class="sxs-lookup"><span data-stu-id="7ab71-119">With SO\_OOBINLINE disabled (by default):</span></span>

-   <span data-ttu-id="7ab71-120">Il provider di servizi Winsock invia una notifica a un client di un \_ evento OOB FD, se il client registrato per la notifica con [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), nello stesso modo in \_ cui viene usato FD Read per notificare la presenza di dati normali.</span><span class="sxs-lookup"><span data-stu-id="7ab71-120">The Winsock service provider notifies a client of an FD\_OOB event, if the client registered for notification with [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), in exactly the same way FD\_READ is used to notify of the presence of normal data.</span></span> <span data-ttu-id="7ab71-121">Ovvero, FD \_ OOB viene pubblicato all'arrivo dei dati OOB e non sono presenti dati OOB accodati in precedenza e anche quando i dati vengono letti utilizzando il \_ flag msg OOB e alcuni dati OOB restano da leggere dopo che è stata restituita l'operazione di lettura.</span><span class="sxs-lookup"><span data-stu-id="7ab71-121">That is, FD\_OOB is posted when OOB data arrives and there was no OOB data previously queued, and also when data is read using the MSG\_OOB flag, and some OOB data remains to be read after the read operation has returned.</span></span> <span data-ttu-id="7ab71-122">\_I messaggi di lettura FD non vengono inviati per i dati OOB.</span><span class="sxs-lookup"><span data-stu-id="7ab71-122">FD\_READ messages are not posted for OOB data.</span></span>
-   <span data-ttu-id="7ab71-123">Il provider di servizi Winsock restituisce da [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) con il set di socket *exceptfds* appropriato se i dati OOB sono accodati nel socket.</span><span class="sxs-lookup"><span data-stu-id="7ab71-123">The Winsock service provider returns from [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) with the appropriate *exceptfds* socket set if OOB data is queued on the socket.</span></span>
-   <span data-ttu-id="7ab71-124">Il client può chiamare [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) con msg \_ OOB per leggere il blocco di dati urgente in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="7ab71-124">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with MSG\_OOB to read the urgent data block at any time.</span></span> <span data-ttu-id="7ab71-125">Il blocco dei dati di OOB salta la coda.</span><span class="sxs-lookup"><span data-stu-id="7ab71-125">The block of OOB data jumps the queue.</span></span>
-   <span data-ttu-id="7ab71-126">Il client può chiamare [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) senza MSG \_ OOB per leggere il flusso di dati normale.</span><span class="sxs-lookup"><span data-stu-id="7ab71-126">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without MSG\_OOB to read the normal data stream.</span></span> <span data-ttu-id="7ab71-127">Il blocco di dati OOB non verrà visualizzato nel flusso di dati con dati normali.</span><span class="sxs-lookup"><span data-stu-id="7ab71-127">The OOB data block will not appear in the data stream with normal data.</span></span> <span data-ttu-id="7ab71-128">Se i dati OOB rimangono dopo una chiamata a **WSPRecv**, il provider di servizi invia una notifica al client con FD \_ OOB o tramite *exceptfds* quando si usa [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="7ab71-128">If OOB data remains after any call to **WSPRecv**, the service provider notifies the client with FD\_OOB or through *exceptfds* when using [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span></span>
-   <span data-ttu-id="7ab71-129">Per i protocolli in cui i dati di OOB hanno una posizione all'interno del flusso di dati normale, una singola operazione [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) non si estenderà a tale posizione.</span><span class="sxs-lookup"><span data-stu-id="7ab71-129">For protocols where the OOB data has a position within the normal data stream, a single [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) operation will not span that position.</span></span> <span data-ttu-id="7ab71-130">Un **WSPRecv** restituirà i dati normali prima del contrassegno e una seconda **WSPRecv** sarà necessaria per iniziare a leggere i dati dopo il contrassegno.</span><span class="sxs-lookup"><span data-stu-id="7ab71-130">One **WSPRecv** will return the normal data before the mark, and a second **WSPRecv** is required to begin reading data after the mark.</span></span>

<span data-ttu-id="7ab71-131">Con \_ OOBINLINE abilitato:</span><span class="sxs-lookup"><span data-stu-id="7ab71-131">With SO\_OOBINLINE enabled:</span></span>

-   <span data-ttu-id="7ab71-132">I \_ messaggi FD OOB non vengono inviati per i dati OOB: ai fini delle funzioni [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) e [**WSPASYNCSELECT**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) , i dati OOB vengono considerati come dati normali e indicati impostando il socket in *readfds* o inviando rispettivamente un \_ messaggio di lettura FD.</span><span class="sxs-lookup"><span data-stu-id="7ab71-132">FD\_OOB messages are not posted for OOB data — for the purpose of the [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) and [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) functions, OOB data is treated as normal data, and indicated by setting the socket in *readfds* or by sending an FD\_READ message respectively.</span></span>
-   <span data-ttu-id="7ab71-133">Il client non può chiamare [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) con il \_ flag msg OOB impostato per leggere il blocco di dati OOB. verrà restituito il codice di errore WSAEINVAL.</span><span class="sxs-lookup"><span data-stu-id="7ab71-133">The client may not call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with the MSG\_OOB flag set to read the OOB data block — the error code WSAEINVAL will be returned.</span></span>
-   <span data-ttu-id="7ab71-134">Il client può chiamare [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) senza il \_ set di flag OOB msg.</span><span class="sxs-lookup"><span data-stu-id="7ab71-134">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without the MSG\_OOB flag set.</span></span> <span data-ttu-id="7ab71-135">Tutti i dati di OOB verranno recapitati nell'ordine corretto nel flusso di dati normale.</span><span class="sxs-lookup"><span data-stu-id="7ab71-135">Any OOB data will be delivered in its correct order within the normal data stream.</span></span> <span data-ttu-id="7ab71-136">I dati di OOB non verranno mai combinati con i dati normali. devono essere presenti tre richieste di lettura per superare i dati di OOB.</span><span class="sxs-lookup"><span data-stu-id="7ab71-136">OOB data will never be mixed with normal data — there must be three read requests to get past the OOB data.</span></span> <span data-ttu-id="7ab71-137">Il primo restituisce i dati normali prima del blocco di dati OOB, il secondo restituisce i dati OOB, il terzo restituisce i dati normali che seguono i dati OOB.</span><span class="sxs-lookup"><span data-stu-id="7ab71-137">The first returns the normal data prior to the OOB data block, the second returns the OOB data, the third returns the normal data following the OOB data.</span></span> <span data-ttu-id="7ab71-138">In altre parole, vengono conservati i limiti dei blocchi di dati OOB.</span><span class="sxs-lookup"><span data-stu-id="7ab71-138">In other words, the OOB data block boundaries are preserved.</span></span>

<span data-ttu-id="7ab71-139">La routine [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) è particolarmente adatta per la gestione della notifica della presenza di dati OOB quando \_ OOBINLINE è disattivato.</span><span class="sxs-lookup"><span data-stu-id="7ab71-139">The [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) routine is particularly well suited to handling notification of the presence of OOB data when SO\_OOBINLINE is off.</span></span>

 

 
