---
description: Questa configurazione crea un'associazione di sicurezza IPsec (SA) tra due host nella stessa subnet per eseguire l'autenticazione usando l'intestazione di autenticazione (AH) e l'algoritmo di hashing Message Digest 5 (MD5).
ms.assetid: ed88d8ee-ac65-4310-a988-ead50ff743fd
title: 'Configurazione 3: uso di IPsec tra due host con collegamento locale'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 994e7a760b6ae1ba87678d6061881e5eb80faf88
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129215"
---
# <a name="configuration-3-using-ipsec-between-two-local-link-hosts"></a><span data-ttu-id="b2c7d-103">Configurazione 3: uso di IPsec tra due host con collegamento locale</span><span class="sxs-lookup"><span data-stu-id="b2c7d-103">Configuration 3: Using IPsec Between Two Local-link Hosts</span></span>

<span data-ttu-id="b2c7d-104">Questa configurazione crea un'associazione di sicurezza IPsec (SA) tra due host nella stessa subnet per eseguire l'autenticazione usando l'intestazione di autenticazione (AH) e l'algoritmo di hashing Message Digest 5 (MD5).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-104">This configuration creates an IPsec Security Association (SA) between two hosts on the same subnet to perform authentication using the Authentication Header (AH) and the Message Digest 5 (MD5) hashing algorithm.</span></span> <span data-ttu-id="b2c7d-105">In questo esempio, la configurazione mostrata protegge tutto il traffico tra due host adiacenti: host 1, con indirizzo locale rispetto al collegamento FE80:: 2AA: FF: FE53: A92C e host 2, con indirizzo locale rispetto al collegamento FE80:: 2AA: FF: FE92: D0F1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-105">In this example, the configuration shown secures all traffic between two neighboring hosts: Host 1, with the link-local address FE80::2AA:FF:FE53:A92C, and Host 2, with the link-local address FE80::2AA:FF:FE92:D0F1.</span></span>

<span data-ttu-id="b2c7d-106">**Per utilizzare IPsec tra due host con collegamento locale**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-106">**To use IPsec between two local-link hosts**</span></span>

1.  <span data-ttu-id="b2c7d-107">Nell'host 1 creare i file di associazione di sicurezza (SAD) e dei criteri di sicurezza (SPD) vuoti usando il comando ipsec6 c.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-107">On Host 1, create blank security association (SAD) and security policy (SPD) files by using the ipsec6 c command.</span></span> <span data-ttu-id="b2c7d-108">In questo esempio il comando Ipsec6.exe è ipsec6 c test.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-108">In this example, the Ipsec6.exe command is ipsec6 c test.</span></span> <span data-ttu-id="b2c7d-109">In questo modo vengono creati due file per configurare manualmente le associazioni di sicurezza (test. Sad) e i criteri di sicurezza (test. SPD).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-109">This creates two files to manually configure security associations (Test.sad) and security policies (Test.spd).</span></span>
2.  <span data-ttu-id="b2c7d-110">Nell'host 1 modificare il file SPD per aggiungere un criterio di sicurezza che protegga tutto il traffico tra l'host 1 e l'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-110">On Host 1, edit the SPD file to add a security policy that secures all traffic between Host 1 and Host 2.</span></span>

    <span data-ttu-id="b2c7d-111">La tabella seguente illustra i criteri di sicurezza aggiunti al file test. SPD prima della prima voce per questo esempio (la prima voce nel file test. SPD non è stata modificata).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-111">The following table shows the security policy added to the Test.spd file before the first entry for this example (the first entry in the Test.spd file was not modified).</span></span>

    | <span data-ttu-id="b2c7d-112">Nome campo file SPD</span><span class="sxs-lookup"><span data-stu-id="b2c7d-112">SPD file field name</span></span> | <span data-ttu-id="b2c7d-113">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-113">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-114">**Criteri**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-114">**Policy**</span></span>          | <span data-ttu-id="b2c7d-115">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-115">2</span></span>                          |
    | <span data-ttu-id="b2c7d-116">**RemoteIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-116">**RemoteIPAddr**</span></span>    | <span data-ttu-id="b2c7d-117">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-117">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="b2c7d-118">**IndirIPLocale**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-118">**LocalIPAddr**</span></span>     | \*                         |
    | <span data-ttu-id="b2c7d-119">**RemotePort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-119">**RemotePort**</span></span>      | \*                         |
    | <span data-ttu-id="b2c7d-120">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-120">**Protocol**</span></span>        | \*                         |
    | <span data-ttu-id="b2c7d-121">**LocalPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-121">**LocalPort**</span></span>       | \*                         |
    | <span data-ttu-id="b2c7d-122">**IPSecProtocol**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-122">**IPSecProtocol**</span></span>   | <span data-ttu-id="b2c7d-123">**AH**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-123">**AH**</span></span>                     |
    | <span data-ttu-id="b2c7d-124">**IPSecMode**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-124">**IPSecMode**</span></span>       | <span data-ttu-id="b2c7d-125">**TRASPORTO**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-125">**TRANSPORT**</span></span>              |
    | <span data-ttu-id="b2c7d-126">**RemoteGWIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-126">**RemoteGWIPAddr**</span></span>  | \*                         |
    | <span data-ttu-id="b2c7d-127">**SABundleIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-127">**SABundleIndex**</span></span>   | <span data-ttu-id="b2c7d-128">**NONE**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-128">**NONE**</span></span>                   |
    | <span data-ttu-id="b2c7d-129">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-129">**Direction**</span></span>       | <span data-ttu-id="b2c7d-130">**Bidirect**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-130">**BIDIRECT**</span></span>               |
    | <span data-ttu-id="b2c7d-131">**Azione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-131">**Action**</span></span>          | <span data-ttu-id="b2c7d-132">**APPLICARE**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-132">**APPLY**</span></span>                  |
    | <span data-ttu-id="b2c7d-133">**IndiceInterfaccia**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-133">**InterfaceIndex**</span></span>  | <span data-ttu-id="b2c7d-134">0</span><span class="sxs-lookup"><span data-stu-id="b2c7d-134">0</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-135">Posizionare un punto e virgola alla fine della riga configurazione di questi criteri di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-135">Place a semicolon at the end of the line configuring this security policy.</span></span> <span data-ttu-id="b2c7d-136">Le voci di criteri devono essere inserite in ordine numerico decrescente.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-136">The policy entries must be placed in decreasing numerical order.</span></span>

3.  <span data-ttu-id="b2c7d-137">Nell'host 1 modificare il file triste aggiungendo le voci SA per proteggere tutto il traffico tra l'host 1 e l'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-137">On Host 1, edit the SAD file, adding SA entries to secure all traffic between Host 1 and Host 2.</span></span> <span data-ttu-id="b2c7d-138">È necessario creare due associazioni di sicurezza, una per il traffico nell'host 2 e una per il traffico dall'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-138">Two security associations must be created, one for traffic to Host 2 and one for traffic from Host 2.</span></span>

    <span data-ttu-id="b2c7d-139">La tabella seguente illustra la prima voce SA aggiunta al file test. Sad per questo esempio (per il traffico nell'host 2).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-139">The following table shows the first SA entry added to the Test.sad file for this example (for traffic to Host 2).</span></span>

    | <span data-ttu-id="b2c7d-140">Nome campo file triste</span><span class="sxs-lookup"><span data-stu-id="b2c7d-140">SAD file field name</span></span> | <span data-ttu-id="b2c7d-141">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-141">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-142">**SAEntry**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-142">**SAEntry**</span></span>         | <span data-ttu-id="b2c7d-143">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-143">2</span></span>                          |
    | <span data-ttu-id="b2c7d-144">**SPI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-144">**SPI**</span></span>             | <span data-ttu-id="b2c7d-145">3001</span><span class="sxs-lookup"><span data-stu-id="b2c7d-145">3001</span></span>                       |
    | <span data-ttu-id="b2c7d-146">**SADestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-146">**SADestIPAddr**</span></span>    | <span data-ttu-id="b2c7d-147">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-147">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="b2c7d-148">**DestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-148">**DestIPAddr**</span></span>      | <span data-ttu-id="b2c7d-149">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-149">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-150">**SrcIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-150">**SrcIPAddr**</span></span>       | <span data-ttu-id="b2c7d-151">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-151">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-152">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-152">**Protocol**</span></span>        | <span data-ttu-id="b2c7d-153">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-153">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-154">**Porta**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-154">**DestPort**</span></span>        | <span data-ttu-id="b2c7d-155">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-155">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-156">**SrcPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-156">**SrcPort**</span></span>         | <span data-ttu-id="b2c7d-157">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-157">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-158">**Algaut**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-158">**AuthAlg**</span></span>         | <span data-ttu-id="b2c7d-159">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-159">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="b2c7d-160">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-160">**KeyFile**</span></span>         | <span data-ttu-id="b2c7d-161">**Test. chiave**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-161">**Test.key**</span></span>               |
    | <span data-ttu-id="b2c7d-162">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-162">**Direction**</span></span>       | <span data-ttu-id="b2c7d-163">**IN uscita**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-163">**OUTBOUND**</span></span>               |
    | <span data-ttu-id="b2c7d-164">**SecPolicyIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-164">**SecPolicyIndex**</span></span>  | <span data-ttu-id="b2c7d-165">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-165">2</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-166">Posizionare un punto e virgola alla fine della riga configurazione di questa SA.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-166">Place a semicolon at the end of the line configuring this SA.</span></span>

    <span data-ttu-id="b2c7d-167">La tabella seguente illustra la seconda voce SA aggiunta al file test. Sad per questo esempio (per il traffico dall'host 2).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-167">The following table shows the second SA entry added to the Test.sad file for this example (for traffic from Host 2).</span></span>

    | <span data-ttu-id="b2c7d-168">Nome campo file triste</span><span class="sxs-lookup"><span data-stu-id="b2c7d-168">SAD file field name</span></span> | <span data-ttu-id="b2c7d-169">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-169">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-170">**SAEntry**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-170">**SAEntry**</span></span>         | <span data-ttu-id="b2c7d-171">1</span><span class="sxs-lookup"><span data-stu-id="b2c7d-171">1</span></span>                          |
    | <span data-ttu-id="b2c7d-172">**SPI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-172">**SPI**</span></span>             | <span data-ttu-id="b2c7d-173">3000</span><span class="sxs-lookup"><span data-stu-id="b2c7d-173">3000</span></span>                       |
    | <span data-ttu-id="b2c7d-174">**SADestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-174">**SADestIPAddr**</span></span>    | <span data-ttu-id="b2c7d-175">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-175">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="b2c7d-176">**DestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-176">**DestIPAddr**</span></span>      | <span data-ttu-id="b2c7d-177">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-177">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-178">**SrcIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-178">**SrcIPAddr**</span></span>       | <span data-ttu-id="b2c7d-179">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-179">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-180">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-180">**Protocol**</span></span>        | <span data-ttu-id="b2c7d-181">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-181">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-182">**Porta**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-182">**DestPort**</span></span>        | <span data-ttu-id="b2c7d-183">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-183">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-184">**SrcPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-184">**SrcPort**</span></span>         | <span data-ttu-id="b2c7d-185">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-185">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-186">**Algaut**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-186">**AuthAlg**</span></span>         | <span data-ttu-id="b2c7d-187">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-187">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="b2c7d-188">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-188">**KeyFile**</span></span>         | <span data-ttu-id="b2c7d-189">**Test. chiave**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-189">**Test.key**</span></span>               |
    | <span data-ttu-id="b2c7d-190">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-190">**Direction**</span></span>       | <span data-ttu-id="b2c7d-191">**IN ingresso**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-191">**INBOUND**</span></span>                |
    | <span data-ttu-id="b2c7d-192">**SecPolicyIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-192">**SecPolicyIndex**</span></span>  | <span data-ttu-id="b2c7d-193">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-193">2</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-194">Posizionare un punto e virgola alla fine della riga configurazione di questa SA.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-194">Place a semicolon at the end of the line configuring this SA.</span></span> <span data-ttu-id="b2c7d-195">Le voci SA devono essere posizionate in ordine numerico decrescente.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-195">The SA entries must be placed in decreasing numerical order.</span></span>

4.  <span data-ttu-id="b2c7d-196">Nell'host 1 creare un file di testo contenente una stringa di testo utilizzata per autenticare la firma di accesso condiviso creata con l'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-196">On Host 1, create a text file that contains a text string used to authenticate the SAs created with Host 2.</span></span> <span data-ttu-id="b2c7d-197">In questo esempio, il file test. Key viene creato con il contenuto "This is a test".</span><span class="sxs-lookup"><span data-stu-id="b2c7d-197">In this example, the file Test.key is created with the contents "This is a test".</span></span> <span data-ttu-id="b2c7d-198">È necessario includere le virgolette doppie intorno alla stringa chiave affinché la chiave venga letta dallo strumento ipsec6.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-198">You must include double quotes around the key string in order for the key to be read by the ipsec6 tool.</span></span>

    <span data-ttu-id="b2c7d-199">Microsoft IPv6 Technology Preview supporta solo le chiavi configurate manualmente per l'autenticazione di SAs IPsec.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-199">The Microsoft IPv6 Technology Preview only supports manually configured keys for the authentication of IPsec SAs.</span></span> <span data-ttu-id="b2c7d-200">Le chiavi manuali vengono configurate creando file di testo che contengono la stringa di testo della chiave manuale.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-200">The manual keys are configured by creating text files that contain the text string of the manual key.</span></span> <span data-ttu-id="b2c7d-201">In questo esempio, la stessa chiave per la firma di accesso condiviso viene usata in entrambe le direzioni.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-201">In this example, the same key for the SAs is used in both directions.</span></span> <span data-ttu-id="b2c7d-202">È possibile usare chiavi diverse per la firma di accesso condiviso in ingresso e in uscita creando file di chiave diversi e facendo riferimento a essi con il campo chiave nel file triste.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-202">You can use different keys for inbound and outbound SAs by creating different key files and referencing them with the KeyFile field in the SAD file.</span></span>

5.  <span data-ttu-id="b2c7d-203">Nell'host 2 creare file di associazione di sicurezza (SAD) e di criteri di sicurezza (SPD) vuoti usando il comando ipsec6 c.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-203">On Host 2, create blank security association (SAD) and security policy (SPD) files by using the ipsec6 c command.</span></span> <span data-ttu-id="b2c7d-204">In questo esempio il comando Ipsec6.exe è ipsec6 c test.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-204">In this example, the Ipsec6.exe command is ipsec6 c test.</span></span> <span data-ttu-id="b2c7d-205">Vengono creati due file con voci vuote per la configurazione manuale delle associazioni di sicurezza (test. Sad) e dei criteri di sicurezza (test. SPD).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-205">This creates two files with blank entries for manually configuring security associations (Test.sad) and security policies (Test.spd).</span></span>

    <span data-ttu-id="b2c7d-206">Per semplificare l'esempio, vengono usati gli stessi nomi di file per i file SAD e SPD nell'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-206">To simplify the example, the same file names for the SAD and SPD files are used on Host 2.</span></span> <span data-ttu-id="b2c7d-207">È possibile scegliere di utilizzare nomi di file diversi in ogni host.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-207">You can choose to use different file names on each host.</span></span>

6.  <span data-ttu-id="b2c7d-208">Nell'host 2 modificare il file SPD per aggiungere un criterio di sicurezza che protegga tutto il traffico tra host 2 e host 1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-208">On Host 2, edit the SPD file to add a security policy that secures all traffic between Host 2 and Host 1.</span></span>

    <span data-ttu-id="b2c7d-209">Nella tabella seguente viene illustrata la voce relativa ai criteri di sicurezza aggiunta prima della prima voce al file test. SPD per questo esempio (la prima voce nel file test. SPD non è stata modificata).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-209">The following table shows the security policy entry added before the first entry to the Test.spd file for this example (the first entry in the Test.spd file was not modified).</span></span>

    | <span data-ttu-id="b2c7d-210">Nome campo file SPD</span><span class="sxs-lookup"><span data-stu-id="b2c7d-210">SPD file field name</span></span> | <span data-ttu-id="b2c7d-211">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-211">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-212">**Criteri**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-212">**Policy**</span></span>          | <span data-ttu-id="b2c7d-213">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-213">2</span></span>                          |
    | <span data-ttu-id="b2c7d-214">**RemoteIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-214">**RemoteIPAddr**</span></span>    | <span data-ttu-id="b2c7d-215">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-215">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="b2c7d-216">**IndirIPLocale**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-216">**LocalIPAddr**</span></span>     | \*                         |
    | <span data-ttu-id="b2c7d-217">**RemotePort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-217">**RemotePort**</span></span>      | \*                         |
    | <span data-ttu-id="b2c7d-218">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-218">**Protocol**</span></span>        | \*                         |
    | <span data-ttu-id="b2c7d-219">**LocalPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-219">**LocalPort**</span></span>       | \*                         |
    | <span data-ttu-id="b2c7d-220">**IPSecProtocol**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-220">**IPSecProtocol**</span></span>   | <span data-ttu-id="b2c7d-221">**AH**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-221">**AH**</span></span>                     |
    | <span data-ttu-id="b2c7d-222">**IPSecMode**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-222">**IPSecMode**</span></span>       | <span data-ttu-id="b2c7d-223">**TRASPORTO**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-223">**TRANSPORT**</span></span>              |
    | <span data-ttu-id="b2c7d-224">**RemoteGWIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-224">**RemoteGWIPAddr**</span></span>  | \*                         |
    | <span data-ttu-id="b2c7d-225">**SABundleIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-225">**SABundleIndex**</span></span>   | <span data-ttu-id="b2c7d-226">**NONE**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-226">**NONE**</span></span>                   |
    | <span data-ttu-id="b2c7d-227">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-227">**Direction**</span></span>       | <span data-ttu-id="b2c7d-228">**Bidirect**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-228">**BIDIRECT**</span></span>               |
    | <span data-ttu-id="b2c7d-229">**Azione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-229">**Action**</span></span>          | <span data-ttu-id="b2c7d-230">**APPLICARE**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-230">**APPLY**</span></span>                  |
    | <span data-ttu-id="b2c7d-231">**IndiceInterfaccia**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-231">**InterfaceIndex**</span></span>  | <span data-ttu-id="b2c7d-232">0</span><span class="sxs-lookup"><span data-stu-id="b2c7d-232">0</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-233">Posizionare un punto e virgola alla fine della riga configurazione di questi criteri di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-233">Place a semicolon at the end of the line configuring this security policy.</span></span> <span data-ttu-id="b2c7d-234">Le voci di criteri devono essere inserite in ordine numerico decrescente.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-234">The policy entries must be placed in decreasing numerical order.</span></span>

7.  <span data-ttu-id="b2c7d-235">Nell'host 2 modificare il file triste aggiungendo le voci SA per proteggere tutto il traffico tra host 2 e host 1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-235">On Host 2, edit the SAD file, adding SA entries to secure all traffic between Host 2 and Host 1.</span></span> <span data-ttu-id="b2c7d-236">È necessario creare due associazioni di sicurezza, una per il traffico nell'host 1 e una per il traffico dall'host 1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-236">Two security associations must be created-one for traffic to Host 1 and one for traffic from Host 1.</span></span>

    <span data-ttu-id="b2c7d-237">La tabella seguente illustra il primo SA aggiunto al file test. Sad per questo esempio (per il traffico dall'host 1).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-237">The following table shows the first SA added to the Test.sad file for this example (for traffic from Host 1).</span></span>

    | <span data-ttu-id="b2c7d-238">Nome campo file triste</span><span class="sxs-lookup"><span data-stu-id="b2c7d-238">SAD file field name</span></span> | <span data-ttu-id="b2c7d-239">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-239">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-240">**SAEntry**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-240">**SAEntry**</span></span>         | <span data-ttu-id="b2c7d-241">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-241">2</span></span>                          |
    | <span data-ttu-id="b2c7d-242">**SPI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-242">**SPI**</span></span>             | <span data-ttu-id="b2c7d-243">3001</span><span class="sxs-lookup"><span data-stu-id="b2c7d-243">3001</span></span>                       |
    | <span data-ttu-id="b2c7d-244">**SADestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-244">**SADestIPAddr**</span></span>    | <span data-ttu-id="b2c7d-245">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-245">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="b2c7d-246">**DestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-246">**DestIPAddr**</span></span>      | <span data-ttu-id="b2c7d-247">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-247">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-248">**SrcIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-248">**SrcIPAddr**</span></span>       | <span data-ttu-id="b2c7d-249">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-249">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-250">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-250">**Protocol**</span></span>        | <span data-ttu-id="b2c7d-251">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-251">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-252">**Porta**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-252">**DestPort**</span></span>        | <span data-ttu-id="b2c7d-253">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-253">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-254">**SrcPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-254">**SrcPort**</span></span>         | <span data-ttu-id="b2c7d-255">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-255">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-256">**Algaut**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-256">**AuthAlg**</span></span>         | <span data-ttu-id="b2c7d-257">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-257">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="b2c7d-258">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-258">**KeyFile**</span></span>         | <span data-ttu-id="b2c7d-259">**Test. chiave**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-259">**Test.key**</span></span>               |
    | <span data-ttu-id="b2c7d-260">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-260">**Direction**</span></span>       | <span data-ttu-id="b2c7d-261">**IN ingresso**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-261">**INBOUND**</span></span>                |
    | <span data-ttu-id="b2c7d-262">**SecPolicyIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-262">**SecPolicyIndex**</span></span>  | <span data-ttu-id="b2c7d-263">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-263">2</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-264">Posizionare un punto e virgola alla fine della riga configurazione di questa SA.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-264">Place a semicolon at the end of the line configuring this SA.</span></span>

    <span data-ttu-id="b2c7d-265">La tabella seguente illustra la seconda voce SA aggiunta al file test. Sad per questo esempio (per il traffico nell'host 1).</span><span class="sxs-lookup"><span data-stu-id="b2c7d-265">The following table shows the second SA entry added to the Test.sad file for this example (for traffic to Host 1).</span></span>

    | <span data-ttu-id="b2c7d-266">Nome campo file triste</span><span class="sxs-lookup"><span data-stu-id="b2c7d-266">SAD file field name</span></span> | <span data-ttu-id="b2c7d-267">Valore di esempio</span><span class="sxs-lookup"><span data-stu-id="b2c7d-267">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="b2c7d-268">**SAEntry**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-268">**SAEntry**</span></span>         | <span data-ttu-id="b2c7d-269">1</span><span class="sxs-lookup"><span data-stu-id="b2c7d-269">1</span></span>                          |
    | <span data-ttu-id="b2c7d-270">**SPI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-270">**SPI**</span></span>             | <span data-ttu-id="b2c7d-271">3000</span><span class="sxs-lookup"><span data-stu-id="b2c7d-271">3000</span></span>                       |
    | <span data-ttu-id="b2c7d-272">**SADestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-272">**SADestIPAddr**</span></span>    | <span data-ttu-id="b2c7d-273">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-273">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="b2c7d-274">**DestIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-274">**DestIPAddr**</span></span>      | <span data-ttu-id="b2c7d-275">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-275">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-276">**SrcIPAddr**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-276">**SrcIPAddr**</span></span>       | <span data-ttu-id="b2c7d-277">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-277">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-278">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-278">**Protocol**</span></span>        | <span data-ttu-id="b2c7d-279">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-279">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-280">**Porta**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-280">**DestPort**</span></span>        | <span data-ttu-id="b2c7d-281">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-281">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-282">**SrcPort**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-282">**SrcPort**</span></span>         | <span data-ttu-id="b2c7d-283">**CRITERI**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-283">**POLICY**</span></span>                 |
    | <span data-ttu-id="b2c7d-284">**Algaut**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-284">**AuthAlg**</span></span>         | <span data-ttu-id="b2c7d-285">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-285">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="b2c7d-286">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-286">**KeyFile**</span></span>         | <span data-ttu-id="b2c7d-287">**Test. chiave**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-287">**Test.key**</span></span>               |
    | <span data-ttu-id="b2c7d-288">**Direzione**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-288">**Direction**</span></span>       | <span data-ttu-id="b2c7d-289">**IN uscita**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-289">**OUTBOUND**</span></span>               |
    | <span data-ttu-id="b2c7d-290">**SecPolicyIndex**</span><span class="sxs-lookup"><span data-stu-id="b2c7d-290">**SecPolicyIndex**</span></span>  | <span data-ttu-id="b2c7d-291">2</span><span class="sxs-lookup"><span data-stu-id="b2c7d-291">2</span></span>                          |

    

     

    <span data-ttu-id="b2c7d-292">Posizionare un punto e virgola alla fine della riga configurazione di questa SA.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-292">Place a semicolon at the end of the line configuring this SA.</span></span> <span data-ttu-id="b2c7d-293">Le voci SA devono essere posizionate in ordine numerico decrescente.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-293">The SA entries must be placed in decreasing numerical order.</span></span>

8.  <span data-ttu-id="b2c7d-294">Nell'host 2 creare un file di testo contenente una stringa di testo usata per autenticare la firma di accesso condiviso creata con l'host 1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-294">On Host 2, create a text file that contains a text string used to authenticate the SAs created with Host 1.</span></span> <span data-ttu-id="b2c7d-295">In questo esempio, il file test. Key viene creato con il contenuto "This is a test".</span><span class="sxs-lookup"><span data-stu-id="b2c7d-295">In this example, the file Test.key is created with the contents "This is a test".</span></span> <span data-ttu-id="b2c7d-296">È necessario includere le virgolette doppie intorno alla stringa chiave affinché la chiave venga letta dallo strumento ipsec6.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-296">You must include double quotes around the key string in order for the key to be read by the ipsec6 tool.</span></span>
9.  <span data-ttu-id="b2c7d-297">Nell'host 1 aggiungere i criteri di sicurezza e la firma di accesso condiviso configurati dai file SPD e SAD usando il comando ipsec6 a.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-297">On Host 1, add the configured security policies and SAs from the SPD and SAD files using the ipsec6 a command.</span></span> <span data-ttu-id="b2c7d-298">In questo esempio, ipsec6 viene eseguito un comando di test sull'host 1.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-298">In this example, the ipsec6 a test command is run on Host 1.</span></span>
10. <span data-ttu-id="b2c7d-299">Nell'host 2 aggiungere i criteri di sicurezza e la firma di accesso condiviso configurati dai file SPD e SAD usando il comando ipsec6 a.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-299">On Host 2, add the configured security policies and SAs from the SPD and SAD files by using the ipsec6 a command.</span></span> <span data-ttu-id="b2c7d-300">In questo esempio, il ipsec6 un comando di test viene eseguito sull'host 2.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-300">In this example, the ipsec6 a test command is run on Host 2.</span></span>
11. <span data-ttu-id="b2c7d-301">Eseguire il ping dell'host 1 dall'host 2 con il comando ping6.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-301">Ping Host 1 from Host 2 with the ping6 command.</span></span>

    <span data-ttu-id="b2c7d-302">Se si acquisisce il traffico utilizzando Microsoft Network Monitor o un altro sniffer di pacchetti, verrà visualizzato lo scambio dei messaggi di richiesta echo e risposta echo ICMPv6 con un'intestazione di autenticazione tra l'intestazione IPv6 e l'intestazione ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="b2c7d-302">If you capture the traffic using Microsoft Network Monitor or another packet sniffer, you should see the exchange of ICMPv6 Echo Request and Echo Reply messages with an Authentication Header between the IPv6 header and the ICMPv6 header.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b2c7d-303">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b2c7d-303">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b2c7d-304">Configurazioni consigliate per IPv6</span><span class="sxs-lookup"><span data-stu-id="b2c7d-304">Recommended Configurations for IPv6</span></span>](recommended-configurations-2.md)
</dt> <dt>

[<span data-ttu-id="b2c7d-305">Singola subnet con indirizzi locali rispetto al collegamento</span><span class="sxs-lookup"><span data-stu-id="b2c7d-305">Single subnet with link-local addresses</span></span>](configuration-1-single-subnet-with-link-local-addresses-2.md)
</dt> <dt>

[<span data-ttu-id="b2c7d-306">Traffico IPv6 tra nodi in subnet diverse di un Internet (6to4) IPv4</span><span class="sxs-lookup"><span data-stu-id="b2c7d-306">IPv6 traffic between nodes on different subnets of an IPv4 internetwork (6to4)</span></span>](configuration-2-ipv6-traffic-between-nodes-on-different-subnets-of-an-ipv4-internetwork-6to4--2.md)
</dt> </dl>

 

 



