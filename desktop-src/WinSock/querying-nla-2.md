---
description: Per ottenere la notifica di reti logiche Invalidate, utilizzare la funzione WSANSPIoctl per registrare gli eventi di modifica del percorso di rete.
ms.assetid: 531b6269-5f35-44c1-ad0f-c5f103029893
title: Esecuzione di query su NLA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ac7a4f57e14bb967b04d3a9fd6fe66717da3878
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106310457"
---
# <a name="querying-nla"></a><span data-ttu-id="f59dd-103">Esecuzione di query su NLA</span><span class="sxs-lookup"><span data-stu-id="f59dd-103">Querying NLA</span></span>

<span data-ttu-id="f59dd-104">Per ottenere la notifica di reti logiche Invalidate, utilizzare la funzione [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) per registrare gli eventi di modifica del percorso di rete.</span><span class="sxs-lookup"><span data-stu-id="f59dd-104">To obtain notification of invalidated logical networks, use the [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) function to register for network location change events.</span></span> <span data-ttu-id="f59dd-105">È possibile utilizzare due metodi per determinare se un percorso di rete valido in precedenza non è più valido: metodi di polling o notifica mediante I/O sovrapposti o messaggistica di Windows.</span><span class="sxs-lookup"><span data-stu-id="f59dd-105">Two methods can be used to determine whether a previously valid network location has become invalid: polling methods, or notification using overlapped I/O or Windows messaging.</span></span>

<span data-ttu-id="f59dd-106">Le query vengono create utilizzando le funzioni [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) e [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) per enumerare tutte le reti logiche disponibili.</span><span class="sxs-lookup"><span data-stu-id="f59dd-106">Queries are formed using the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), [**WSALookupServiceNext,**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) and [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) functions to enumerate all available logical networks.</span></span> <span data-ttu-id="f59dd-107">L'uso di ciascuna di queste funzioni viene illustrato singolarmente nel resto di questa sezione, a partire dalla funzione **WSALookupServiceBegin** .</span><span class="sxs-lookup"><span data-stu-id="f59dd-107">The use of each of these functions is explained individually throughout the remainder of this section, beginning with the **WSALookupServiceBegin** function.</span></span>

> [!Note]  
> <span data-ttu-id="f59dd-108">NLA richiede il file di intestazione mswsock. h, che per impostazione predefinita non è incluso nel file Winsock2. h.</span><span class="sxs-lookup"><span data-stu-id="f59dd-108">NLA requires the Mswsock.h header file, which by default is not included in the Winsock2.h file.</span></span>

 

## <a name="step-1-initiate-the-query"></a><span data-ttu-id="f59dd-109">Passaggio 1: avviare la query</span><span class="sxs-lookup"><span data-stu-id="f59dd-109">Step 1: Initiate the Query</span></span>

<span data-ttu-id="f59dd-110">Per riferimento rapido, la funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) presenta la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="f59dd-110">For quick reference, the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function has the following syntax:</span></span>

``` syntax
INT WSALookupServiceBegin(
  LPWSAQUERYSET lpqsRestrictions,
  DWORD dwControlFlags,
  LPHANDLE lphLookup
);
```

<span data-ttu-id="f59dd-111">NLA supporta i flag di ricerca *dwControlFlags* seguenti:</span><span class="sxs-lookup"><span data-stu-id="f59dd-111">NLA supports the following *dwControlFlags* lookup flags:</span></span>

<dl> <span data-ttu-id="f59dd-112">\_nome restituito \_ LUP</span><span class="sxs-lookup"><span data-stu-id="f59dd-112">LUP\_RETURN\_NAME</span></span>  
<span data-ttu-id="f59dd-113">LUP \_ \_ Commento restituito</span><span class="sxs-lookup"><span data-stu-id="f59dd-113">LUP\_RETURN\_COMMENT</span></span>  
<span data-ttu-id="f59dd-114">\_BLOB restituito \_ LUP</span><span class="sxs-lookup"><span data-stu-id="f59dd-114">LUP\_RETURN\_BLOB</span></span>  
<span data-ttu-id="f59dd-115">LUP \_ restituisce \_ tutto</span><span class="sxs-lookup"><span data-stu-id="f59dd-115">LUP\_RETURN\_ALL</span></span>  
<span data-ttu-id="f59dd-116">LUP \_ Deep</span><span class="sxs-lookup"><span data-stu-id="f59dd-116">LUP\_DEEP</span></span>  
</dl>

<span data-ttu-id="f59dd-117">Questi flag limitano i set di risultati restituiti nelle chiamate successive a [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), funzione alle reti che contengono campi del tipo specificato.</span><span class="sxs-lookup"><span data-stu-id="f59dd-117">These flags restrict the result sets returned in subsequent calls to the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function to networks that contain fields of the specified type.</span></span> <span data-ttu-id="f59dd-118">Se ad esempio si specifica LUP \_ return \_ BLOB nel parametro *dwControlFlags* della chiamata di funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) , i set di risultati delle chiamate successive a **WSALookupServiceNext** vengono limitati alle reti che contengono informazioni BLOB.</span><span class="sxs-lookup"><span data-stu-id="f59dd-118">For example, specifying LUP\_RETURN\_BLOB in the *dwControlFlags* parameter of the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function call restricts result sets from subsequent calls to **WSALookupServiceNext**, to networks that contain BLOB information.</span></span> <span data-ttu-id="f59dd-119">L'utilizzo del \_ flag LUP return \_ All equivale a specificare il \_ nome restituito LUP \_ , LUP \_ return \_ Comment e LUP \_ return \_ BLOB, ma non LUP \_ Deep.</span><span class="sxs-lookup"><span data-stu-id="f59dd-119">Using the LUP\_RETURN\_ALL flag is equivalent to specifying LUP\_RETURN\_NAME, LUP\_RETURN\_COMMENT, and LUP\_RETURN\_BLOB, but not LUP\_DEEP.</span></span>

<span data-ttu-id="f59dd-120">Per una spiegazione di questi flag di ricerca, vedere la pagina di riferimento per la funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-120">For an explanation of these lookup flags, consult the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function reference page.</span></span>

<span data-ttu-id="f59dd-121">L'handle di ricerca restituito da NLA nel parametro *lphLookup* è privato per NLA e non deve essere modificato.</span><span class="sxs-lookup"><span data-stu-id="f59dd-121">The lookup handle returned by NLA in the *lphLookup* parameter is private to NLA, and should not be modified.</span></span> <span data-ttu-id="f59dd-122">Poiché l'handle restituito è privato per NLA, le funzioni come [**WSAGetOverlappedResult**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetoverlappedresult) non sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="f59dd-122">Since the returned handle is private to NLA, functions such as [**WSAGetOverlappedResult**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetoverlappedresult) are not available.</span></span>

<span data-ttu-id="f59dd-123">NLA restituisce zero al completamento, come definito nella pagina di riferimento della funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-123">NLA returns zero upon successful completion, as defined in the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function reference page.</span></span> <span data-ttu-id="f59dd-124">In caso contrario, NLA supporta i codici di errore seguenti.</span><span class="sxs-lookup"><span data-stu-id="f59dd-124">Otherwise, NLA supports the following error codes.</span></span>

| <span data-ttu-id="f59dd-125">Errore</span><span class="sxs-lookup"><span data-stu-id="f59dd-125">Error</span></span>                    | <span data-ttu-id="f59dd-126">Significato</span><span class="sxs-lookup"><span data-stu-id="f59dd-126">Meaning</span></span>                                                                                                                                                     |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f59dd-127">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="f59dd-127">WSANOTINITIALISED</span></span>        | <span data-ttu-id="f59dd-128">Una chiamata riuscita alla funzione [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) per inizializzare NLA non è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="f59dd-128">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function to initialize NLA was not performed.</span></span>                                                   |
| <span data-ttu-id="f59dd-129">WSAEINVAL</span><span class="sxs-lookup"><span data-stu-id="f59dd-129">WSAEINVAL</span></span>                | <span data-ttu-id="f59dd-130">Uno o più parametri non sono validi oppure i parametri specificati nella chiamata di funzione si applicano a protocolli diversi da IP.</span><span class="sxs-lookup"><span data-stu-id="f59dd-130">One or more parameters were invalid, or parameters specified in the function call apply to protocols other than IP.</span></span>                                         |
| <span data-ttu-id="f59dd-131">WSASERVICE \_ non \_ trovato</span><span class="sxs-lookup"><span data-stu-id="f59dd-131">WSASERVICE\_NOT\_FOUND</span></span>   | <span data-ttu-id="f59dd-132">Il parametro *lpServiceClassId* della struttura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) passata nel parametro *lpqsRestrictions* contiene un GUID non valido.</span><span class="sxs-lookup"><span data-stu-id="f59dd-132">The *lpServiceClassId* parameter of the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure passed in the *lpqsRestrictions* parameter contains an invalid GUID.</span></span> |
| <span data-ttu-id="f59dd-133">\_dati WSANO</span><span class="sxs-lookup"><span data-stu-id="f59dd-133">WSANO\_DATA</span></span>              | <span data-ttu-id="f59dd-134">Il \_ flag LUP Containers è stato specificato nel parametro *dwControlFlags* .</span><span class="sxs-lookup"><span data-stu-id="f59dd-134">The LUP\_CONTAINERS flag was specified in *dwControlFlags* parameter.</span></span>                                                                                       |
| <span data-ttu-id="f59dd-135">WSAEFAULT</span><span class="sxs-lookup"><span data-stu-id="f59dd-135">WSAEFAULT</span></span>                | <span data-ttu-id="f59dd-136">Si è verificata una violazione di accesso durante il tentativo di accedere ai parametri forniti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="f59dd-136">An access violation occurred when attempting to access user-supplied parameters.</span></span>                                                                            |
| <span data-ttu-id="f59dd-137">WSASYSNOTREADY</span><span class="sxs-lookup"><span data-stu-id="f59dd-137">WSASYSNOTREADY</span></span>           | <span data-ttu-id="f59dd-138">Il servizio NLA non è disponibile per l'elaborazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="f59dd-138">The NLA service is unavailable to process the request.</span></span>                                                                                                      |
| <span data-ttu-id="f59dd-139">\_ \_ memoria insufficiente per WSA \_</span><span class="sxs-lookup"><span data-stu-id="f59dd-139">WSA\_NOT\_ENOUGH\_MEMORY</span></span> | <span data-ttu-id="f59dd-140">NLA o il servizio NLA non è stato in grado di allocare memoria sufficiente per elaborare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="f59dd-140">NLA or the NLA service was unable to allocate enough memory to process this request.</span></span>                                                                        |



 

## <a name="step-2-perform-the-query"></a><span data-ttu-id="f59dd-141">Passaggio 2: eseguire la query</span><span class="sxs-lookup"><span data-stu-id="f59dd-141">Step 2: Perform the Query</span></span>

<span data-ttu-id="f59dd-142">Il passaggio successivo per l'esecuzione di query su NLA richiede l'uso della funzione [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-142">The next step in querying NLA requires use of the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span> <span data-ttu-id="f59dd-143">Per riferimento rapido, la funzione **WSALookupServiceNext** ha la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="f59dd-143">For quick reference, the **WSALookupServiceNext**, function has the following syntax:</span></span>

``` syntax
INT WSALookupServiceNext(
  HANDLE hLookup,
  DWORD dwControlFlags,
  LPDWORD lpdwBufferLength,
  LPWSAQUERYSET lpqsResults
);
```

<span data-ttu-id="f59dd-144">Il parametro *lLookup* è l'handle di ricerca restituito dalla chiamata precedente alla funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-144">The *lLookup* parameter is the lookup handle returned from the previous call to the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function.</span></span>

<span data-ttu-id="f59dd-145">Il parametro *dwControlFlags* supporta i flag seguenti:</span><span class="sxs-lookup"><span data-stu-id="f59dd-145">The *dwControlFlags* parameter supports the following flags:</span></span>

<dl> <span data-ttu-id="f59dd-146">\_nome restituito \_ LUP</span><span class="sxs-lookup"><span data-stu-id="f59dd-146">LUP\_RETURN\_NAME</span></span>  
<span data-ttu-id="f59dd-147">LUP \_ \_ Commento restituito</span><span class="sxs-lookup"><span data-stu-id="f59dd-147">LUP\_RETURN\_COMMENT</span></span>  
<span data-ttu-id="f59dd-148">\_BLOB restituito \_ LUP</span><span class="sxs-lookup"><span data-stu-id="f59dd-148">LUP\_RETURN\_BLOB</span></span>  
<span data-ttu-id="f59dd-149">LUP \_ restituisce \_ tutto</span><span class="sxs-lookup"><span data-stu-id="f59dd-149">LUP\_RETURN\_ALL</span></span>  
<span data-ttu-id="f59dd-150">\_FLUSHPREVIOUS LUP</span><span class="sxs-lookup"><span data-stu-id="f59dd-150">LUP\_FLUSHPREVIOUS</span></span>  
</dl>

<span data-ttu-id="f59dd-151">Questi flag sono indipendenti dai flag supportati nella chiamata di funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-151">These flags are independent of the flags supported in the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function call.</span></span> <span data-ttu-id="f59dd-152">Si noti che tutti i vincoli specificati nella chiamata precedente alla funzione **WSALookupServiceBegin** vincolano la ricerca; l'aggiunta di flag con la funzione [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) nel tentativo di ampliare la query oltre i vincoli specificati nella chiamata **WSALookupServiceBegin** viene ignorata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f59dd-152">Note that any constraints specified in the previous call to the **WSALookupServiceBegin** function constrain the lookup; adding flags with the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function in an attempt to broaden the query beyond the constraints specified in the **WSALookupServiceBegin** call are silently ignored.</span></span> <span data-ttu-id="f59dd-153">Tuttavia, è consentito specificare un set più restrittivo di flag rispetto a quello specificato nella chiamata **WSALookupServiceBegin** .</span><span class="sxs-lookup"><span data-stu-id="f59dd-153">Specifying a more restrictive set of flags than that specified in the **WSALookupServiceBegin** call, however, is allowed.</span></span>

<span data-ttu-id="f59dd-154">Se la rete descritta in dettaglio in *lpqsResults* è una rete attiva, viene aggiunta una serie di strutture **\_ BLOB NLA** come specificato nel **membro lpBlob** della struttura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) restituita in *lpqsResults*.</span><span class="sxs-lookup"><span data-stu-id="f59dd-154">If the network detailed in *lpqsResults* is an active network, a series of **NLA\_BLOB** structures is appended as specified in the **lpBlob** member of the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure returned in *lpqsResults*.</span></span> <span data-ttu-id="f59dd-155">Queste strutture del **\_ BLOB NLA** possono essere concatenate e possono essere enumerate attraversando l'elenco mentre NLA \_ BLOB. Header. nextOffset è diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="f59dd-155">These **NLA\_BLOB** structures may be chained, and can be enumerated by traversing the list while NLA\_BLOB.header.nextOffset is nonzero.</span></span> <span data-ttu-id="f59dd-156">Per ottenere risultati per tutte le informazioni sul percorso di rete, continuare a chiamare la funzione [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta)fino a quando \_ \_ non \_ viene restituito l'errore WSA e, come illustrato nella pagina di riferimento **WSALookupServiceNext**.</span><span class="sxs-lookup"><span data-stu-id="f59dd-156">To obtain results for all network location information, continue calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function until the WSA\_E\_NO\_MORE error is returned, as explained in the **WSALookupServiceNext**, reference page.</span></span>

<span data-ttu-id="f59dd-157">La funzione [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) viene usata anche in combinazione con la funzione [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) per ricevere la notifica delle modifiche di rete.</span><span class="sxs-lookup"><span data-stu-id="f59dd-157">The [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function is also used in conjunction with the [**WSANSPIoctl**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) function to receive notification of network changes.</span></span> <span data-ttu-id="f59dd-158">Per ulteriori informazioni, vedere [notifica da NLA](notification-from-nla-2.md) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-158">See [Notification from NLA](notification-from-nla-2.md) for more information.</span></span>

<span data-ttu-id="f59dd-159">NLA restituisce zero al termine del completamento.</span><span class="sxs-lookup"><span data-stu-id="f59dd-159">NLA returns zero upon successful completion.</span></span> <span data-ttu-id="f59dd-160">I client di NLA devono continuare a chiamare il [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), funzione fino a quando \_ \_ non \_ viene restituito WSA E, a indicare che sono state restituite tutte le informazioni sulle reti disponibili.</span><span class="sxs-lookup"><span data-stu-id="f59dd-160">Clients of NLA should continue calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function until WSA\_E\_NO\_MORE is returned, indicating that all of the information about available networks has been returned.</span></span>

<span data-ttu-id="f59dd-161">In caso contrario, la chiamata a [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), funzione per NLA supporta i codici di errore seguenti.</span><span class="sxs-lookup"><span data-stu-id="f59dd-161">Otherwise, calling the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta), function for NLA supports the following error codes.</span></span>

| <span data-ttu-id="f59dd-162">Errore</span><span class="sxs-lookup"><span data-stu-id="f59dd-162">Error</span></span>                    | <span data-ttu-id="f59dd-163">Significato</span><span class="sxs-lookup"><span data-stu-id="f59dd-163">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                     |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f59dd-164">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="f59dd-164">WSANOTINITIALISED</span></span>        | <span data-ttu-id="f59dd-165">Una chiamata alla funzione [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) che ha inizializzato l'NLA non è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="f59dd-165">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function that initialized NLA was not performed.</span></span>                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="f59dd-166">\_handle non valido WSA \_</span><span class="sxs-lookup"><span data-stu-id="f59dd-166">WSA\_INVALID\_HANDLE</span></span>     | <span data-ttu-id="f59dd-167">L'handle di ricerca specificato nel parametro *hLookup* non è un handle NLA SP valido.</span><span class="sxs-lookup"><span data-stu-id="f59dd-167">The lookup handle provided in the *hLookup* parameter was not a valid NLA SP handle.</span></span> <span data-ttu-id="f59dd-168">I client devono prima chiamare la funzione [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) e ricevere un handle NLA SP valido per ottenere i risultati della query.</span><span class="sxs-lookup"><span data-stu-id="f59dd-168">Clients must first call the [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) function and receive a valid NLA SP handle to obtain query results.</span></span>                                                                                                                                                               |
| <span data-ttu-id="f59dd-169">WSAESYSNOTREADY</span><span class="sxs-lookup"><span data-stu-id="f59dd-169">WSAESYSNOTREADY</span></span>          | <span data-ttu-id="f59dd-170">Il servizio NLA non è disponibile per l'elaborazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="f59dd-170">The NLA service is unavailable to process this request.</span></span>                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="f59dd-171">WSAEFAULT</span><span class="sxs-lookup"><span data-stu-id="f59dd-171">WSAEFAULT</span></span>                | <span data-ttu-id="f59dd-172">La dimensione del buffer specificata nel parametro *lpdwBufferLength* non è sufficiente per conservare i risultati a cui punta *lpqsResults*.</span><span class="sxs-lookup"><span data-stu-id="f59dd-172">The buffer size specified in the *lpdwBufferLength* parameter was insufficient to hold the results pointed to by *lpqsResults*.</span></span> <span data-ttu-id="f59dd-173">Il buffer richiesto è specificato in *lpdwBufferLength*; Se il client non è in grado di fornire un buffer sufficientemente grande, il client può chiamare la funzione [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) con *DWCONTROLFLAGS* impostato su LUP \_ FLUSHPREVIOUS per ignorare la voce.</span><span class="sxs-lookup"><span data-stu-id="f59dd-173">The required buffer is specified in *lpdwBufferLength*; if the client cannot supply a sufficiently large buffer, the client can call the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function with *dwControlFlags* set to LUP\_FLUSHPREVIOUS to skip the entry.</span></span> |
| <span data-ttu-id="f59dd-174">\_ \_ memoria insufficiente per WSA \_</span><span class="sxs-lookup"><span data-stu-id="f59dd-174">WSA\_NOT\_ENOUGH\_MEMORY</span></span> | <span data-ttu-id="f59dd-175">NLA non è in grado di ottenere le informazioni di rete dal servizio di sistema NLA a causa di memoria insufficiente nel processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="f59dd-175">NLA is unable to obtain network information from the NLA system service due to insufficient memory in the calling process.</span></span>                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="f59dd-176">WSA \_ E \_ nient' \_ altro</span><span class="sxs-lookup"><span data-stu-id="f59dd-176">WSA\_E\_NO\_MORE</span></span>         | <span data-ttu-id="f59dd-177">Non sono presenti reti aggiuntive da enumerare per la query.</span><span class="sxs-lookup"><span data-stu-id="f59dd-177">There are no additional networks to enumerate for the query.</span></span>                                                                                                                                                                                                                                                                                                                                                |



 

## <a name="step-3-terminate-the-query"></a><span data-ttu-id="f59dd-178">Passaggio 3: terminare la query</span><span class="sxs-lookup"><span data-stu-id="f59dd-178">Step 3: Terminate the Query</span></span>

<span data-ttu-id="f59dd-179">Quando tutte le query a NLA sono completate e per un'applicazione non è più necessario usare NLA, è necessario effettuare una chiamata alla funzione [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-179">When all queries to NLA are complete and an application no longer requires use of NLA, a call to the [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) function should be made.</span></span> <span data-ttu-id="f59dd-180">Non chiamare **WSALookupServiceEnd** se l'applicazione riceverà una notifica di modifica basata sulla query inviata.</span><span class="sxs-lookup"><span data-stu-id="f59dd-180">Do not call **WSALookupServiceEnd** if the application will receive change notification based on the submitted query.</span></span> <span data-ttu-id="f59dd-181">Per ulteriori informazioni sulla ricezione di notifiche, vedere [notifica da NLA](notification-from-nla-2.md) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-181">See [Notification from NLA](notification-from-nla-2.md) for more information on receiving notification.</span></span> <span data-ttu-id="f59dd-182">Come per la maggior parte dei provider di servizi Windows Sockets, NLA mantiene un conteggio dei riferimenti per i client.</span><span class="sxs-lookup"><span data-stu-id="f59dd-182">Like most Windows Sockets service providers, NLA maintains a reference count for its clients.</span></span> <span data-ttu-id="f59dd-183">La chiamata della funzione **WSALookupServiceEnd** quando vengono completate le query per NLA consente di liberare le risorse di sistema non più richieste da NLA.</span><span class="sxs-lookup"><span data-stu-id="f59dd-183">Calling the **WSALookupServiceEnd** function when queries to NLA are completed enables system resources no longer required by NLA to be freed.</span></span>

<span data-ttu-id="f59dd-184">NLA supporta i codici di errore seguenti per le chiamate di funzione [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) .</span><span class="sxs-lookup"><span data-stu-id="f59dd-184">NLA supports the following error codes for [**WSALookupServiceEnd**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) function calls.</span></span>

| <span data-ttu-id="f59dd-185">Errore</span><span class="sxs-lookup"><span data-stu-id="f59dd-185">Error</span></span>                | <span data-ttu-id="f59dd-186">Significato</span><span class="sxs-lookup"><span data-stu-id="f59dd-186">Meaning</span></span>                                                                                                   |
|----------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f59dd-187">WSANOTINITIALISED</span><span class="sxs-lookup"><span data-stu-id="f59dd-187">WSANOTINITIALISED</span></span>    | <span data-ttu-id="f59dd-188">Una chiamata riuscita alla funzione [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) per inizializzare NLA non è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="f59dd-188">A successful call to the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function to initialize NLA was not performed.</span></span> |
| <span data-ttu-id="f59dd-189">\_handle non valido WSA \_</span><span class="sxs-lookup"><span data-stu-id="f59dd-189">WSA\_INVALID\_HANDLE</span></span> | <span data-ttu-id="f59dd-190">L'handle specificato nel parametro *hLookup* non è un handle di NLA SP valido.</span><span class="sxs-lookup"><span data-stu-id="f59dd-190">The handle provided in the *hLookup* parameter was not a valid NLA SP handle.</span></span>                             |



 

 

 



