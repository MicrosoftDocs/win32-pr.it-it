---
title: Categorizzazione di app e provider di servizi a più livelli
description: Winsock 2 supporta i protocolli a livelli.
ms.assetid: 1c5efd2e-1b42-4c20-a4da-b81a5fc4243c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a966d54da0be26f75a074de18abe1b9e080c0c9f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307023"
---
# <a name="categorizing-layered-service-providers-and-apps"></a><span data-ttu-id="c7840-103">Categorizzazione di app e provider di servizi a più livelli</span><span class="sxs-lookup"><span data-stu-id="c7840-103">Categorizing layered service providers and apps</span></span>

> [!Note]  
> <span data-ttu-id="c7840-104">I provider di servizi sovrapposti sono deprecati.</span><span class="sxs-lookup"><span data-stu-id="c7840-104">Layered Service Providers are deprecated.</span></span> <span data-ttu-id="c7840-105">A partire da Windows 8 e Windows Server 2012, usare la [piattaforma filtro Windows](../fwp/windows-filtering-platform-start-page.md).</span><span class="sxs-lookup"><span data-stu-id="c7840-105">Starting with Windows 8 and Windows Server 2012, use [Windows Filtering Platform](../fwp/windows-filtering-platform-start-page.md).</span></span>

 

<span data-ttu-id="c7840-106">Winsock 2 supporta i protocolli a livelli.</span><span class="sxs-lookup"><span data-stu-id="c7840-106">Winsock 2 accommodates layered protocols.</span></span> <span data-ttu-id="c7840-107">Un protocollo a più livelli è uno che implementa solo funzioni di comunicazione di livello superiore, mentre si basa su uno stack di trasporto sottostante per lo scambio effettivo di dati con un endpoint remoto.</span><span class="sxs-lookup"><span data-stu-id="c7840-107">A layered protocol is one that implements only higher level communications functions, while relying on an underlying transport stack for the actual exchange of data with a remote endpoint.</span></span> <span data-ttu-id="c7840-108">Un esempio di protocollo a più livelli o di un provider di servizi su più livelli è un livello di sicurezza che aggiunge il protocollo al processo di creazione della connessione per poter eseguire l'autenticazione e stabilire uno schema di crittografia concordato a vicenda.</span><span class="sxs-lookup"><span data-stu-id="c7840-108">An example of a layered protocol or layered service provider would be a security layer that adds protocol to the connection establishment process in order to perform authentication and to establish a mutually agreed upon encryption scheme.</span></span> <span data-ttu-id="c7840-109">Un protocollo di sicurezza di questo tipo richiede in genere i servizi di un protocollo di trasporto affidabile sottostante, ad esempio TCP o SPX.</span><span class="sxs-lookup"><span data-stu-id="c7840-109">Such a security protocol would generally require the services of an underlying reliable transport protocol such as TCP or SPX.</span></span> <span data-ttu-id="c7840-110">Il termine protocollo di base implementato dal provider di base fa riferimento a un provider Winsock che implementa un protocollo, ad esempio TCP o SPX, che è in grado di eseguire le comunicazioni dati con un endpoint remoto.</span><span class="sxs-lookup"><span data-stu-id="c7840-110">The term base protocol implemented by base provider refers to a Winsock provider that implements a protocol such as TCP or SPX which is capable of performing data communications with a remote endpoint.</span></span> <span data-ttu-id="c7840-111">Il termine protocollo a più livelli viene usato per descrivere un protocollo che non può essere autonomo.</span><span class="sxs-lookup"><span data-stu-id="c7840-111">The term layered protocol is used to describe a protocol that cannot stand alone.</span></span> <span data-ttu-id="c7840-112">Questi protocolli a più livelli vengono installati come provider di servizi a più livelli Winsock (LSP).</span><span class="sxs-lookup"><span data-stu-id="c7840-112">These layered protocols are installed as Winsock Layered Service Providers (LSPs).</span></span>

<span data-ttu-id="c7840-113">Un esempio di LSP è il provider di servizi client di Microsoft Firewall installato come parte di Internet secutity e Authentication Server (ISA) sui client.</span><span class="sxs-lookup"><span data-stu-id="c7840-113">An example of an LSP is the Microsoft Firewall Client Service Provider installed as part of the Internet Secutity and Authentication Server (ISA) on clients.</span></span> <span data-ttu-id="c7840-114">Il provider di servizi client di Microsoft Firewall viene installato sui provider di base Winsock per TCP e UDP.</span><span class="sxs-lookup"><span data-stu-id="c7840-114">The Microsoft Firewall Client Service Provider installs over the Winsock base providers for TCP and UDP.</span></span> <span data-ttu-id="c7840-115">Una libreria di collegamento dinamico (DLL) nel software client ISA Firewall diventa un provider di servizi a più livelli Winsock che tutte le applicazioni Winsock utilizzano in modo trasparente.</span><span class="sxs-lookup"><span data-stu-id="c7840-115">A dynamic-link library (DLL) in the ISA Firewall Client software becomes a Winsock layered service provider that all Winsock applications use transparently.</span></span> <span data-ttu-id="c7840-116">In questo modo, il client ISA Firewall LSP può intercettare le chiamate di funzione Winsock dalle applicazioni client e quindi indirizzare una richiesta al provider del servizio di base sottostante originale se la destinazione è locale o al servizio firewall in un computer ISA Server se la destinazione è remota.</span><span class="sxs-lookup"><span data-stu-id="c7840-116">This way, the ISA Firewall Client LSP can intercept Winsock function calls from client applications and then route a request to the original underlying base service provider if the destination is local or to the Firewall service on an ISA Server computer if the destination is remote.</span></span> <span data-ttu-id="c7840-117">Un LSP simile viene installato come parte del servizio Microsoft Forefront firewall e del client di Threat Management Gateway (TMG) sui client.</span><span class="sxs-lookup"><span data-stu-id="c7840-117">A similar LSP is installed as part of the Microsoft Forefront Firewall Service and the Threat Management Gateway (TMG) Client on clients.</span></span>

<span data-ttu-id="c7840-118">Durante l'inizializzazione di LSP, lo LSP deve fornire puntatori a una serie di funzioni di interfaccia del provider di servizi (SPI) Winsock.</span><span class="sxs-lookup"><span data-stu-id="c7840-118">During LSP initialization, the LSP must provide pointers to a number of Winsock Service Provider Interface (SPI) functions.</span></span> <span data-ttu-id="c7840-119">Queste funzioni verranno chiamate durante la normale elaborazione da parte del livello immediatamente superiore a LSP (un altro LSP o WS2 \_32.DLL).</span><span class="sxs-lookup"><span data-stu-id="c7840-119">These functions will be called during normal processing by the layer directly above the LSP (either another LSP or Ws2\_32.DLL).</span></span>

<span data-ttu-id="c7840-120">È possibile definire le categorie LSP basate sul subset di funzioni SPI implementate da LSP e sulla natura dell'elaborazione aggiuntiva eseguita per ognuna di queste funzioni.</span><span class="sxs-lookup"><span data-stu-id="c7840-120">It is possible to define LSP categories based upon the subset of SPI functions an LSP implements and the nature of the extra processing performed for each of those functions.</span></span> <span data-ttu-id="c7840-121">Classificando LSP, oltre a classificare le applicazioni che usano i socket Winsock, è possibile determinare in modo selettivo se uno LSP deve essere associato a un determinato processo in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="c7840-121">By classifying LSPs, as well as classifying applications which use Winsock sockets, it becomes possible to selectively determine if an LSP should be involved in a given process at runtime.</span></span>

<span data-ttu-id="c7840-122">In Windows Vista e versioni successive viene fornito un nuovo metodo per la categorizzazione di applicazioni e provider di servizi a più livelli Winsock, in modo che vengano caricati solo determinati LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-122">On Windows Vista and later, a new method is provided for categorizing both Winsock Layered Service Providers and applications so that only certain LSPs will be loaded.</span></span> <span data-ttu-id="c7840-123">Esistono diversi motivi per aggiungere queste funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c7840-123">There are several reasons for adding these features.</span></span>

<span data-ttu-id="c7840-124">Uno dei motivi principali è che alcuni processi critici del sistema, ad esempio Winlogon e LSASS creano socket, ma questi processi non utilizzano questi socket per inviare traffico sulla rete.</span><span class="sxs-lookup"><span data-stu-id="c7840-124">One of the primary reasons is that certain system critical processes such as winlogon and lsass create sockets, but these processes do not use these sockets to send any traffic on the network.</span></span> <span data-ttu-id="c7840-125">Quindi, la maggior parte dei LSP non deve essere caricata in questi processi.</span><span class="sxs-lookup"><span data-stu-id="c7840-125">So most LSPs should not be loaded into these processes.</span></span> <span data-ttu-id="c7840-126">È stato inoltre documentato un numero di casi in cui la LSP di bug può causare l'arresto anomalo *lsass.exe* .</span><span class="sxs-lookup"><span data-stu-id="c7840-126">A number of cases have also been documented where buggy LSPs can cause *lsass.exe* to crash.</span></span> <span data-ttu-id="c7840-127">Se LSASS si arresta in modo anomalo, il sistema impone un arresto.</span><span class="sxs-lookup"><span data-stu-id="c7840-127">If lsass crashes, the system forces a shutdown.</span></span> <span data-ttu-id="c7840-128">Un effetto collaterale di questi processi di sistema durante il caricamento di LSP è che questi processi non vengono mai chiusi, quindi è necessario riavviare il computer quando viene installato o rimosso uno LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-128">A side affect of these system processes loading LSPs is that these processes never exit so when an LSP is installed or removed, a reboot is required.</span></span>

<span data-ttu-id="c7840-129">Un motivo secondario è che in alcuni casi è possibile che le applicazioni non desiderino caricare determinati LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-129">A secondary reason is that there are some cases where applications may not want to load certain LSPs.</span></span> <span data-ttu-id="c7840-130">Ad esempio, alcune applicazioni potrebbero non voler caricare lsp crittografici, che potrebbero impedire la comunicazione dell'applicazione con altri sistemi in cui non è installato il cyptographic LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-130">For example, some applications may not want to load cryptographic LSPs which could prevent the application from communicating with other systems that do not have the cyptographic LSP installed.</span></span>

<span data-ttu-id="c7840-131">Infine, le categorie LSP possono essere utilizzate da altri LSP per determinare la posizione della catena di protocollo Winsock da installare.</span><span class="sxs-lookup"><span data-stu-id="c7840-131">Finally, LSP categories can be used by other LSPs to determine where in the Winsock protocol chain they should install themselves.</span></span> <span data-ttu-id="c7840-132">Per anni, diversi sviluppatori di LSP hanno voluto conoscere il comportamento di uno LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-132">For years, various LSP developers have wanted a way of knowing how an LSP will behave.</span></span> <span data-ttu-id="c7840-133">Ad esempio, un LSP che controlla il flusso di dati deve essere superiore a uno LSP che crittografa i dati.</span><span class="sxs-lookup"><span data-stu-id="c7840-133">For example, an LSP that inspects the data stream would want to be above an LSP that encrypts the data.</span></span> <span data-ttu-id="c7840-134">Naturalmente, questo metodo per la categorizzazione di LSP non è una prova, perché si basa su LSP di terze parti per categorizzare se stesso in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="c7840-134">Of course, this method of LSP categorization isn't fool proof since it relies on third-party LSPs to categorize themselves appropriately.</span></span>

<span data-ttu-id="c7840-135">La categorizzazione di LSP e altri miglioramenti della sicurezza in Windows Vista e versioni successive sono progettati per impedire agli utenti di installare involontariamente LSP dannosi.</span><span class="sxs-lookup"><span data-stu-id="c7840-135">The LSP categorization and other security enhancements in Windows Vista and later are designed to help prevent users from unintentionally installing malicious LSPs.</span></span>

## <a name="lsp-categories"></a><span data-ttu-id="c7840-136">Categorie LSP</span><span class="sxs-lookup"><span data-stu-id="c7840-136">LSP Categories</span></span>

<span data-ttu-id="c7840-137">In Windows Vista e versioni successive, un LSP può essere classificato in base al modo in cui interagisce con le chiamate e i dati di Windows Sockets.</span><span class="sxs-lookup"><span data-stu-id="c7840-137">On Windows Vista and later, an LSP can be classified based on how it interacts with Windows Sockets calls and data.</span></span> <span data-ttu-id="c7840-138">Una categoria LSP è un gruppo di comportamenti identificabili in un subset di funzioni Winsock SPI.</span><span class="sxs-lookup"><span data-stu-id="c7840-138">An LSP category is an identifiable group of behaviors on a subset of Winsock SPI functions.</span></span> <span data-ttu-id="c7840-139">Un filtro di contenuto HTTP, ad esempio, verrebbe categorizzato come controllo dati (categoria di \_ controllo LSP).</span><span class="sxs-lookup"><span data-stu-id="c7840-139">For example, an HTTP content filter would be categorized as a data inspector (the LSP\_INSPECTOR category).</span></span> <span data-ttu-id="c7840-140">La \_ categoria di controllo LSP controlla (ma non modifica) i parametri per le funzioni SPI per il trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="c7840-140">The LSP\_INSPECTOR category will inspect (but not alter) parameters to data transfer SPI functions.</span></span> <span data-ttu-id="c7840-141">Un'applicazione può eseguire una query per la categoria di un LSP e scegliere di non caricare il LSP in base alla categoria LSP e al set di categorie di LSP consentite dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-141">An application can query for the category of an LSP and choose to not load the LSP based on the LSP category and the application's set of permitted LSP categories.</span></span>

<span data-ttu-id="c7840-142">Nella tabella seguente sono elencate le categorie in cui è possibile classificare LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-142">The following table lists categories that an LSP can be classified into.</span></span>

| <span data-ttu-id="c7840-143">Categoria LSP</span><span class="sxs-lookup"><span data-stu-id="c7840-143">LSP Category</span></span>              | <span data-ttu-id="c7840-144">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c7840-144">Description</span></span>                                                     |
|---------------------------|-----------------------------------------------------------------|
| <span data-ttu-id="c7840-145">**\_compressione crittografica LSP \_**</span><span class="sxs-lookup"><span data-stu-id="c7840-145">**LSP\_CRYPTO\_COMPRESS**</span></span> | <span data-ttu-id="c7840-146">LSP è un provider di crittografia o di compressione dei dati.</span><span class="sxs-lookup"><span data-stu-id="c7840-146">The LSP is a cryptography or data compression provider.</span></span>         |
| <span data-ttu-id="c7840-147">**\_Firewall LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-147">**LSP\_FIREWALL**</span></span>         | <span data-ttu-id="c7840-148">LSP è un provider del firewall.</span><span class="sxs-lookup"><span data-stu-id="c7840-148">The LSP is a firewall provider.</span></span>                                 |
| <span data-ttu-id="c7840-149">**\_cache locale \_ LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-149">**LSP\_LOCAL\_CACHE**</span></span>     | <span data-ttu-id="c7840-150">LSP è un provider di cache locale.</span><span class="sxs-lookup"><span data-stu-id="c7840-150">The LSP is a local cache provider.</span></span>                              |
| <span data-ttu-id="c7840-151">**\_modifica in ingresso \_ LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-151">**LSP\_INBOUND\_MODIFY**</span></span>  | <span data-ttu-id="c7840-152">Il LSP modifica i dati in ingresso.</span><span class="sxs-lookup"><span data-stu-id="c7840-152">The LSP modifies inbound data.</span></span>                                  |
| <span data-ttu-id="c7840-153">**\_controllo LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-153">**LSP\_INSPECTOR**</span></span>        | <span data-ttu-id="c7840-154">Il LSP controlla o filtra i dati.</span><span class="sxs-lookup"><span data-stu-id="c7840-154">The LSP inspects or filters data.</span></span>                               |
| <span data-ttu-id="c7840-155">**\_modifica in uscita \_ LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-155">**LSP\_OUTBOUND\_MODIFY**</span></span> | <span data-ttu-id="c7840-156">Il LSP modifica i dati in uscita.</span><span class="sxs-lookup"><span data-stu-id="c7840-156">The LSP modifies outbound data.</span></span>                                 |
| <span data-ttu-id="c7840-157">**\_proxy LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-157">**LSP\_PROXY**</span></span>            | <span data-ttu-id="c7840-158">Il LSP funge da proxy e reindirizza i pacchetti.</span><span class="sxs-lookup"><span data-stu-id="c7840-158">The LSP acts as a proxy and redirects packets.</span></span>                  |
| <span data-ttu-id="c7840-159">**redirector LSP \_**</span><span class="sxs-lookup"><span data-stu-id="c7840-159">**LSP\_REDIRECTOR**</span></span>       | <span data-ttu-id="c7840-160">LSP è un redirector di rete.</span><span class="sxs-lookup"><span data-stu-id="c7840-160">The LSP is a network redirector.</span></span>                                |
| <span data-ttu-id="c7840-161">**\_sistema LSP**</span><span class="sxs-lookup"><span data-stu-id="c7840-161">**LSP\_SYSTEM**</span></span>           | <span data-ttu-id="c7840-162">Il LSP è accettabile per l'uso nei servizi e nei processi di sistema.</span><span class="sxs-lookup"><span data-stu-id="c7840-162">The LSP is acceptable for use in services and system processes.</span></span> |



 

<span data-ttu-id="c7840-163">Uno LSP può appartenere a più di una categoria.</span><span class="sxs-lookup"><span data-stu-id="c7840-163">An LSP may belong to more than one category.</span></span> <span data-ttu-id="c7840-164">Ad esempio, un firewall/LSP di sicurezza può appartenere alle categorie Inspector **( \_ controllo LSP**) e firewall **( \_ LSP firewall**).</span><span class="sxs-lookup"><span data-stu-id="c7840-164">For example, a firewall/security LSP could belong to both the inspector (**LSP\_INSPECTOR**) and firewall (**LSP\_FIREWALL**) categories.</span></span>

<span data-ttu-id="c7840-165">Se uno LSP non dispone di un set di categorie, viene considerato nella categoria tutti gli altri.</span><span class="sxs-lookup"><span data-stu-id="c7840-165">If an LSP does not have a category set, it is considered to be in the All Other category.</span></span> <span data-ttu-id="c7840-166">Questa categoria LSP non verrà caricata nei servizi o nei processi di sistema, ad esempio LSASS, Winlogon e molti processi svchost.</span><span class="sxs-lookup"><span data-stu-id="c7840-166">This LSP category will not be loaded in services or system processes (for example, lsass, winlogon, and many svchost processes).</span></span>

## <a name="categorizing-lsps"></a><span data-ttu-id="c7840-167">Categorizzazione di LSP</span><span class="sxs-lookup"><span data-stu-id="c7840-167">Categorizing LSPs</span></span>

<span data-ttu-id="c7840-168">In Windows Vista e versioni successive sono disponibili diverse nuove funzioni per la categorizzazione di un LSP:</span><span class="sxs-lookup"><span data-stu-id="c7840-168">Several new functions are available on Windows Vista and later for categorizing an LSP:</span></span>

-   [<span data-ttu-id="c7840-169">**WSCGetProviderInfo**</span><span class="sxs-lookup"><span data-stu-id="c7840-169">**WSCGetProviderInfo**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo)
-   [<span data-ttu-id="c7840-170">**WSCGetProviderInfo32**</span><span class="sxs-lookup"><span data-stu-id="c7840-170">**WSCGetProviderInfo32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo32)
-   [<span data-ttu-id="c7840-171">**WSCSetProviderInfo**</span><span class="sxs-lookup"><span data-stu-id="c7840-171">**WSCSetProviderInfo**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo)
-   [<span data-ttu-id="c7840-172">**WSCSetProviderInfo32**</span><span class="sxs-lookup"><span data-stu-id="c7840-172">**WSCSetProviderInfo32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo32)

<span data-ttu-id="c7840-173">Per categorizzare un LSP, la funzione [**WSCSetProviderInfo**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo) o [**WSCSetProviderInfo32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo32) viene chiamata con un GUID per identificare la voce nascosta LSP, la classe Information da impostare per questa voce del protocollo LSP e un set di flag usati per modificare il comportamento della funzione.</span><span class="sxs-lookup"><span data-stu-id="c7840-173">In order to categorize an LSP, the [**WSCSetProviderInfo**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo) or [**WSCSetProviderInfo32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetproviderinfo32) function is called with a GUID to identify the LSP hidden entry, the information class to be set for this LSP protocol entry, and a set of flags used to modify the behavior of the function.</span></span>

<span data-ttu-id="c7840-174">La funzione [**WSCGetProviderInfo**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo) o [**WSCGetProviderInfo32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo32) viene usata in modo analogo per recuperare i dati associati a una classe di informazioni per uno LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-174">The [**WSCGetProviderInfo**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo) or [**WSCGetProviderInfo32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetproviderinfo32) function is similarly used to retrieve the data associated with an information class for an LSP.</span></span>

## <a name="categorizing-applications"></a><span data-ttu-id="c7840-175">Categorizzazione di applicazioni</span><span class="sxs-lookup"><span data-stu-id="c7840-175">Categorizing Applications</span></span>

<span data-ttu-id="c7840-176">In Windows Vista e versioni successive sono disponibili diverse nuove funzioni per la categorizzazione di un'applicazione:</span><span class="sxs-lookup"><span data-stu-id="c7840-176">Several new functions are available on Windows Vista and later for categorizing an application:</span></span>

-   [<span data-ttu-id="c7840-177">**WSCGetApplicationCategory**</span><span class="sxs-lookup"><span data-stu-id="c7840-177">**WSCGetApplicationCategory**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetapplicationcategory)
-   [<span data-ttu-id="c7840-178">**WSCSetApplicationCategory**</span><span class="sxs-lookup"><span data-stu-id="c7840-178">**WSCSetApplicationCategory**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetapplicationcategory)

<span data-ttu-id="c7840-179">Per categorizzare un'applicazione, la funzione [**WSCSetApplicationCategory**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetapplicationcategory) viene chiamata con il percorso di caricamento dell'immagine eseguibile per identificare l'applicazione, gli argomenti della riga di comando usati all'avvio dell'applicazione e le categorie LSP consentite per tutte le istanze dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-179">In order to categorize an application, the [**WSCSetApplicationCategory**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscsetapplicationcategory) function is called with the load path to the executable image to identify the application, the command line arguments used when starting the application, and the LSP categories which are permitted for all instances of this application.</span></span>

<span data-ttu-id="c7840-180">La funzione [**WSCGetApplicationCategory**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetapplicationcategory) viene usata in modo analogo per recuperare le categorie del provider di servizi a più livelli (LSP) associate a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-180">The [**WSCGetApplicationCategory**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscgetapplicationcategory) function is similarly used to retrieve the layered service provider (LSP) categories associated with an application.</span></span>

## <a name="determining-which-lsps-get-loaded"></a><span data-ttu-id="c7840-181">Determinare quali LSP vengono caricati</span><span class="sxs-lookup"><span data-stu-id="c7840-181">Determining Which LSPs Get Loaded</span></span>

<span data-ttu-id="c7840-182">La parte finale della categorizzazione di LSP consiste nel determinare quali lsp verranno caricati in quali processi.</span><span class="sxs-lookup"><span data-stu-id="c7840-182">The final part of LSP categorization is determining which LSPs will be loaded into which processes.</span></span> <span data-ttu-id="c7840-183">Quando un processo carica Winsock, vengono eseguiti i confronti seguenti tra la categoria dell'applicazione e le categorie LSP per tutti LSP installati:</span><span class="sxs-lookup"><span data-stu-id="c7840-183">When a process loads Winsock, the following comparisons are made of the application category and the LSP categories for all installed LSPs:</span></span>

-   <span data-ttu-id="c7840-184">Se l'applicazione non è categorizzata, consentire il caricamento di tutti i LSP nel processo.</span><span class="sxs-lookup"><span data-stu-id="c7840-184">If the application is not categorized, allow all LSPs to be loaded into the process.</span></span>
-   <span data-ttu-id="c7840-185">Se per l'applicazione e il LSP sono state assegnate categorie, è necessario che siano soddisfatte tutte le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c7840-185">If both the application and the LSP have assigned categories, all of the following must be true:</span></span> <dl> <span data-ttu-id="c7840-186">Almeno una delle categorie di LSP è presente nelle categorie specificate dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-186">At least one of the LSP categories is present in the application's specified categories.</span></span>  
    <span data-ttu-id="c7840-187">Nelle categorie LSP vengono specificate solo le categorie specificate nelle categorie specificate dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7840-187">Only categories specified in the application's specified categories are specified in the LSPs categories.</span></span> <span data-ttu-id="c7840-188">Se, ad esempio, l'applicazione specifica una categoria, deve trovarsi nella categoria del LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-188">For example, if the application specifies a category it must be in the LSP's category.</span></span>  
    <span data-ttu-id="c7840-189">Se la \_ categoria di sistema LSP è presente nella categoria dell'applicazione, deve essere presente nelle categorie del LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-189">If the LSP\_SYSTEM category is present in the application's category, it must be present in the LSP's categories.</span></span>  
    </dl>

> [!Note]  
> <span data-ttu-id="c7840-190">Se uno LSP non è categorizzato, la relativa categoria è effettivamente zero.</span><span class="sxs-lookup"><span data-stu-id="c7840-190">If an LSP is not categorized, its category is effectively zero.</span></span> <span data-ttu-id="c7840-191">Per trovare una corrispondenza, è necessario che tutte le categorie specificate di LSP siano presenti nelle categorie dell'applicazione (le categorie dell'applicazione devono essere un superset delle categorie di LSP) con l'avvertenza che se il \_ sistema LSP è presente nella categoria dell'applicazione, deve essere presente anche nella categoria del LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-191">For a match to occur, all the LSP's specified categories must be present in the application's categories (the application's categories must be a superset of the LSP's categories) with the caveat that if LSP\_SYSTEM is present in the application's category it must also be present in the LSP's category.</span></span>

 

<span data-ttu-id="c7840-192">Si consideri l'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="c7840-192">Consider the following example:</span></span>

<span data-ttu-id="c7840-193">L'applicazione *Foo.exe* è categorizzata come LSP \_ System + LSP \_ Firewall + LSP \_ Crypto \_ Compress.</span><span class="sxs-lookup"><span data-stu-id="c7840-193">The *Foo.exe* application is categorized as LSP\_SYSTEM + LSP\_FIREWALL + LSP\_CRYPTO\_COMPRESS.</span></span> <span data-ttu-id="c7840-194">Il *Bar.exe* di applicazione è categorizzato come LSP \_ Firewall + LSP \_ Crypto \_ Compress.</span><span class="sxs-lookup"><span data-stu-id="c7840-194">The application *Bar.exe* is categorized as LSP\_FIREWALL + LSP\_CRYPTO\_COMPRESS.</span></span> <span data-ttu-id="c7840-195">Nel sistema sono installati quattro LSP:</span><span class="sxs-lookup"><span data-stu-id="c7840-195">There are four LSPs installed on the system:</span></span>

-   <span data-ttu-id="c7840-196">LSP1 ha impostato una categoria di \_ sistema LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-196">LSP1 has set a category of LSP\_SYSTEM.</span></span>
-   <span data-ttu-id="c7840-197">LSP2 non è un set di categorie, quindi la relativa categoria è zero.</span><span class="sxs-lookup"><span data-stu-id="c7840-197">LSP2 is not categories set, so its category is zero.</span></span>
-   <span data-ttu-id="c7840-198">LSP3 ha impostato una categoria di \_ Firewall LSP.</span><span class="sxs-lookup"><span data-stu-id="c7840-198">LSP3 has set a category of LSP\_FIREWALL.</span></span>
-   <span data-ttu-id="c7840-199">LSP4 ha impostato categorie di LSP \_ System + LSP \_ Firewall + LSP \_ Crypto \_ Compress + LSP \_ Inspector</span><span class="sxs-lookup"><span data-stu-id="c7840-199">LSP4 has set categories of LSP\_SYSTEM + LSP\_FIREWALL + LSP\_CRYPTO\_COMPRESS + LSP\_INSPECTOR</span></span>

<span data-ttu-id="c7840-200">In questo esempio, l'applicazione *Foo.exe* CARICHERÀ solo LSP1, mentre l'applicazione *Bar.exe* caricherà LSP3.</span><span class="sxs-lookup"><span data-stu-id="c7840-200">In this example, the *Foo.exe* application would only load LSP1, while the *Bar.exe* application would load LSP3.</span></span>

## <a name="determining-winsock-providers-installed"></a><span data-ttu-id="c7840-201">Determinazione del provider Winsock installato</span><span class="sxs-lookup"><span data-stu-id="c7840-201">Determining Winsock Providers Installed</span></span>

<span data-ttu-id="c7840-202">Il Software Development Kit (SDK) di Microsoft Windows include un programma Winsock di esempio che può essere usato per determinare i provider di trasporto Winsock installati in un computer locale.</span><span class="sxs-lookup"><span data-stu-id="c7840-202">The Microsoft Windows Software Development Kit (SDK) includes a sample Winsock program that can be used to determine the Winsock transport providers installed on a local computer.</span></span> <span data-ttu-id="c7840-203">Per impostazione predefinita, il codice sorgente per questo esempio Winsock è installato nella seguente directory del Windows SDK per Windows 7:</span><span class="sxs-lookup"><span data-stu-id="c7840-203">By default, the source code for this Winsock sample is installed in the following directory of the Windows SDK for Windows 7:</span></span>

<span data-ttu-id="c7840-204">*C: \\ programmi \\ Microsoft SDK \\ Windows \\ v 7.0 \\ esempi \\ NetDs \\ Winsock \\ LSP*</span><span class="sxs-lookup"><span data-stu-id="c7840-204">*C:\\Program Files\\Microsoft SDKs\\Windows\\v7.0\\Samples\\NetDs\\winsock\\LSP*</span></span>

<span data-ttu-id="c7840-205">Questo esempio è un'utilità per l'installazione e il test di provider di servizi a più livelli.</span><span class="sxs-lookup"><span data-stu-id="c7840-205">This sample is a utility for installing and testing layered service providers.</span></span> <span data-ttu-id="c7840-206">Ma può anche essere usato per raccogliere informazioni dettagliate a livello di codice dal catalogo Winsock in un computer locale.</span><span class="sxs-lookup"><span data-stu-id="c7840-206">But it can also be used to programmatically collect detailed information from the Winsock catalog on a local computer.</span></span> <span data-ttu-id="c7840-207">Per elencare tutti i provider Winsock correnti, inclusi i provider di base e i provider di servizi del livello, compilare questo esempio Winsock ed eseguire il comando seguente della console:</span><span class="sxs-lookup"><span data-stu-id="c7840-207">To list all of the current Winsock providers including both base providers and layer service providers, build this Winsock sample and execute the following console command:</span></span>

<span data-ttu-id="c7840-208">**instlsp-p**</span><span class="sxs-lookup"><span data-stu-id="c7840-208">**instlsp -p**</span></span>

<span data-ttu-id="c7840-209">L'output sarà un elenco di provider Winsock installati nel computer locale, inclusi i provider di servizi a più livelli.</span><span class="sxs-lookup"><span data-stu-id="c7840-209">The output will be a list of Winsock providers installed on the local computer including layered service providers.</span></span> <span data-ttu-id="c7840-210">L'output elenca l'ID del catalogo e il nome della stringa per il provider Winsock</span><span class="sxs-lookup"><span data-stu-id="c7840-210">The output lists the catalog ID and the string name for the Winsock provider</span></span>

<span data-ttu-id="c7840-211">Per raccogliere informazioni più dettagliate su tutti i provider Winsock, eseguire il comando seguente della console:</span><span class="sxs-lookup"><span data-stu-id="c7840-211">To collect more detailed information on all Winsock providers, execute the following console command:</span></span>

<span data-ttu-id="c7840-212">**instlsp-p-v**</span><span class="sxs-lookup"><span data-stu-id="c7840-212">**instlsp -p -v**</span></span>

<span data-ttu-id="c7840-213">L'output sarà un elenco di strutture di [**\_ informazioni WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) supportate nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="c7840-213">The output will be a list [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structures supported on the local computer.</span></span>

<span data-ttu-id="c7840-214">Per un elenco di provider di servizi su più livelli installati nel computer locale, eseguire il comando seguente della console:</span><span class="sxs-lookup"><span data-stu-id="c7840-214">For a list of only layered service providers installed on the local computer, execute the following console command:</span></span>

<span data-ttu-id="c7840-215">**instlsp-l**</span><span class="sxs-lookup"><span data-stu-id="c7840-215">**instlsp -l**</span></span>

<span data-ttu-id="c7840-216">Per eseguire il mapping della struttura LSP, eseguire il comando seguente della console:</span><span class="sxs-lookup"><span data-stu-id="c7840-216">To map the LSP structure, execute the following console command:</span></span>

<span data-ttu-id="c7840-217">**instlsp-m**</span><span class="sxs-lookup"><span data-stu-id="c7840-217">**instlsp -m**</span></span>

> [!Note]  
> <span data-ttu-id="c7840-218">La funzionalità TDI è deprecata e verrà rimossa nelle versioni future di Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="c7840-218">The TDI feature is deprecated and will be removed in future versions of Microsoft Windows.</span></span> <span data-ttu-id="c7840-219">A seconda di come si usa TDI, usare il kernel Winsock (WSK) o Windows Filtering Platform (WFP).</span><span class="sxs-lookup"><span data-stu-id="c7840-219">Depending on how you use TDI, use either the Winsock Kernel (WSK) or Windows Filtering Platform (WFP).</span></span> <span data-ttu-id="c7840-220">Per ulteriori informazioni su WFP e WSK, vedere [Windows Filtering Platform](../fwp/windows-filtering-platform-start-page.md) e [Winsock Kernel](/windows-hardware/drivers/ddi/_netvista/).</span><span class="sxs-lookup"><span data-stu-id="c7840-220">For more information about WFP and WSK, see [Windows Filtering Platform](../fwp/windows-filtering-platform-start-page.md) and [Winsock Kernel](/windows-hardware/drivers/ddi/_netvista/).</span></span> <span data-ttu-id="c7840-221">Per un intervento di Blog sulla rete di Windows Core su WSK e TDI, vedere [Introduzione al kernel Winsock (WSK)](/archive/blogs/wndp/).</span><span class="sxs-lookup"><span data-stu-id="c7840-221">For a Windows Core Networking blog entry about WSK and TDI, see [Introduction to Winsock Kernel (WSK)](/archive/blogs/wndp/).</span></span>

 

 

 
