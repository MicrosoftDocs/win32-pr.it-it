---
description: Nozioni di base sui protocolli di WSPListen, WSPAccept e WSPConnect per stabilire una connessione socket con Windows Sockets (Winsock).
ms.assetid: b1b4d6b9-36db-4000-9c6b-662765b6d091
title: 'Nozioni fondamentali sui protocolli: ascolto, connessione, accettazione'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d62ef290d71e571154b4d022c24c7e21f8fffa1c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129134"
---
# <a name="protocol-basics-listen-connect-accept"></a><span data-ttu-id="ba758-103">Nozioni fondamentali sui protocolli: ascolto, connessione, accettazione</span><span class="sxs-lookup"><span data-stu-id="ba758-103">Protocol Basics: Listen, Connect, Accept</span></span>

<span data-ttu-id="ba758-104">Le operazioni di base necessarie per stabilire una connessione socket possono essere descritte più facilmente in termini di paradigma client-server.</span><span class="sxs-lookup"><span data-stu-id="ba758-104">The basic operations involved with establishing a socket connection can be most conveniently explained in terms of the client-server paradigm.</span></span>

<span data-ttu-id="ba758-105">Il lato server creerà prima di tutto un socket, lo associerà a un indirizzo locale noto (in modo che il client possa trovarlo) e inserirà il socket in modalità di ascolto, tramite [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)), per preparare le richieste di connessione in ingresso e per specificare la lunghezza della coda di backlog della connessione.</span><span class="sxs-lookup"><span data-stu-id="ba758-105">The server side will first create a socket, bind it to a well known local address (so that the client can find it), and put the socket in listening mode, through [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)), in order to prepare for any incoming connection requests and to specify the length of the connection backlog queue.</span></span> <span data-ttu-id="ba758-106">I provider di servizi contengono richieste di connessione in sospeso in una coda di backlog fino a quando non vengono eseguite dal server o non vengono ritirate (a causa di un timeout) da parte del client.</span><span class="sxs-lookup"><span data-stu-id="ba758-106">Service providers hold pending connection requests in a backlog queue until they are acted upon by the server or are withdrawn (due to a time-out) by the client.</span></span> <span data-ttu-id="ba758-107">Un provider di servizi può ignorare automaticamente le richieste per estendere le dimensioni della coda di backlog oltre un limite superiore definito dal provider.</span><span class="sxs-lookup"><span data-stu-id="ba758-107">A service provider may silently ignore requests to extend the size of the backlog queue beyond a provider-defined upper limit.</span></span>

<span data-ttu-id="ba758-108">A questo punto, se viene utilizzato un socket di blocco, il lato server può chiamare immediatamente [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) che si bloccherà fino a quando una richiesta di connessione non è in sospeso.</span><span class="sxs-lookup"><span data-stu-id="ba758-108">At this point, if a blocking socket is being used, the server side may immediately call [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) which will block until a connection request is pending.</span></span> <span data-ttu-id="ba758-109">Viceversa, il server può utilizzare anche uno dei meccanismi di indicazione degli eventi di rete descritti in precedenza per disporre la notifica delle richieste di connessione in ingresso.</span><span class="sxs-lookup"><span data-stu-id="ba758-109">Conversely, the server may also use one of the network event indication mechanisms discussed previously to arrange for notification of incoming connection requests.</span></span> <span data-ttu-id="ba758-110">A seconda del meccanismo di notifica selezionato, il provider emetterà un messaggio di Windows o segnalerà un oggetto evento all'arrivo delle richieste di connessione.</span><span class="sxs-lookup"><span data-stu-id="ba758-110">Depending on the notification mechanism selected, the provider will either issue a Windows message or signal an event object when connection requests arrive.</span></span> <span data-ttu-id="ba758-111">Vedere [notifica degli eventi di rete](notification-of-network-events-2.md) per informazioni su come eseguire la registrazione per l' \_ evento di rete di accettazione FD.</span><span class="sxs-lookup"><span data-stu-id="ba758-111">See [Notification of Network Events](notification-of-network-events-2.md) for how to register for the FD\_ACCEPT network event.</span></span>

<span data-ttu-id="ba758-112">Il lato client creerà un socket appropriato e avvierà la connessione chiamando [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85)), specificando l'indirizzo del server noto.</span><span class="sxs-lookup"><span data-stu-id="ba758-112">The client side will create an appropriate socket, and initiate the connection by calling [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85)), specifying the known server address.</span></span> <span data-ttu-id="ba758-113">I client in genere non eseguono un'operazione di [**Binding**](/windows/desktop/api/winsock/nf-winsock-bind) esplicita prima di avviare una connessione, consentendo al provider di servizi di eseguire un'associazione implicita per loro conto.</span><span class="sxs-lookup"><span data-stu-id="ba758-113">Clients usually do not perform an explicit [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) operation prior to initiating a connection, allowing the service provider to perform an implicit bind on their behalf.</span></span> <span data-ttu-id="ba758-114">Se il socket è in modalità di blocco, **WSPConnect** si bloccherà fino a quando il server non ha ricevuto e agito sulla richiesta di connessione (o fino a quando non si verifica un timeout).</span><span class="sxs-lookup"><span data-stu-id="ba758-114">If the socket is in blocking mode, **WSPConnect** will block until the server has received and acted upon the connection request (or until a time-out occurs).</span></span> <span data-ttu-id="ba758-115">In caso contrario, il client deve usare uno dei meccanismi di indicazione degli eventi di rete descritti in precedenza per organizzare la notifica di una nuova connessione stabilita.</span><span class="sxs-lookup"><span data-stu-id="ba758-115">Otherwise, the client should use one of the network event indication mechanisms discussed previously to arrange for notification of a new connection being established.</span></span> <span data-ttu-id="ba758-116">A seconda del meccanismo di notifica selezionato, il provider indicherà questa impostazione tramite un messaggio di Windows o segnalando un oggetto evento.</span><span class="sxs-lookup"><span data-stu-id="ba758-116">Depending on the notification mechanism selected, the provider will indicate this either through a Windows message or by signaling an event object.</span></span>

<span data-ttu-id="ba758-117">Quando il lato server richiama [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept), il provider di servizi chiama la funzione di condizione fornita dall'applicazione, usando i parametri della funzione per passare le informazioni sul server dalla voce superiore della coda di backlog della richiesta di connessione.</span><span class="sxs-lookup"><span data-stu-id="ba758-117">When the server side invokes [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept), the service provider calls the application-supplied condition function, using function parameters to pass into the server information from the top entry in the connection request backlog queue.</span></span> <span data-ttu-id="ba758-118">Queste informazioni includono elementi come indirizzo di connessione host, eventuali dati utente disponibili ed eventuali informazioni QoS disponibili.</span><span class="sxs-lookup"><span data-stu-id="ba758-118">This information includes such things as address of connecting host, any available user data, and any available QoS information.</span></span> <span data-ttu-id="ba758-119">Utilizzando queste informazioni, la funzione di condizione del server determina se accettare la richiesta, rifiutare la richiesta o posticipare la decisione fino a un momento successivo.</span><span class="sxs-lookup"><span data-stu-id="ba758-119">Using this information the server's condition function determines whether to accept the request, reject the request, or defer making a decision until later.</span></span> <span data-ttu-id="ba758-120">Questa decisione viene indicata tramite il valore restituito della funzione Condition.</span><span class="sxs-lookup"><span data-stu-id="ba758-120">This decision is indicated through the return value of the condition function.</span></span> <span data-ttu-id="ba758-121">Per informazioni su come eseguire la registrazione per l'evento di rete FD Connect, vedere [notifica degli eventi di rete](notification-of-network-events-2.md) \_ .</span><span class="sxs-lookup"><span data-stu-id="ba758-121">See [Notification of Network Events](notification-of-network-events-2.md) for how to register for the FD\_CONNECT network event.</span></span>

<span data-ttu-id="ba758-122">Se il server decide di accettare la richiesta, il provider deve creare un nuovo socket con tutti gli stessi attributi e registrazioni di eventi del socket in ascolto.</span><span class="sxs-lookup"><span data-stu-id="ba758-122">If the server decides to accept the request, the provider must create a new socket with all of the same attributes and event registrations as the listening socket.</span></span> <span data-ttu-id="ba758-123">Il socket originale rimane nello stato di ascolto, in modo che possano essere ricevute le richieste di connessione successive.</span><span class="sxs-lookup"><span data-stu-id="ba758-123">The original socket remains in the listening state so that subsequent connection requests can be received.</span></span> <span data-ttu-id="ba758-124">Tramite i parametri di output della funzione condition, il server può anche fornire qualsiasi dato utente di risposta e assegnare parametri QoS (presupponendo che queste operazioni siano supportate dal provider di servizi).</span><span class="sxs-lookup"><span data-stu-id="ba758-124">Through output parameters of the condition function, the server may also supply any response user data and assign QoS parameters (assuming that these operations are supported by the service provider).</span></span>

 

 
