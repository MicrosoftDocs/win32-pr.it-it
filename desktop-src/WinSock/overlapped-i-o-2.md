---
description: Windows Sockets 2 introduce I/O sovrapposti e richiede che tutti i provider di trasporto supportino questa funzionalità.
ms.assetid: 90d49171-e211-4426-aa56-88aaeac7c578
title: Input/output sovrapposto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d8caa13dd3d50e4f0fdaa1b92fa8e99afd8e2e1
ms.sourcegitcommit: 3d9dce1bd6c84e2b51759e940aa95aa9b459cd20
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/04/2021
ms.locfileid: "103886038"
---
# <a name="overlapped-inputoutput"></a><span data-ttu-id="82b91-103">Input/output sovrapposto</span><span class="sxs-lookup"><span data-stu-id="82b91-103">Overlapped Input/Output</span></span>

<span data-ttu-id="82b91-104">Windows Sockets 2 introduce I/O sovrapposti e richiede che tutti i provider di trasporto supportino questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="82b91-104">Windows Sockets 2 introduces overlapped I/O and requires that all transport providers support this capability.</span></span> <span data-ttu-id="82b91-105">Le operazioni di I/O sovrapposte possono essere eseguite solo su socket creati tramite la funzione [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) con il flag WSA \_ \_ sovrapposto impostato e seguono il modello stabilito in Windows.</span><span class="sxs-lookup"><span data-stu-id="82b91-105">Overlapped I/O can be performed only on sockets that were created through the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function with the WSA\_FLAG\_OVERLAPPED flag set, and follow the model established in Windows.</span></span>

<span data-ttu-id="82b91-106">Per la ricezione, un client utilizza [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) o [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) per fornire i buffer in cui devono essere ricevuti i dati.</span><span class="sxs-lookup"><span data-stu-id="82b91-106">For receiving, a client uses [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) or [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) to supply buffers into which data is to be received.</span></span> <span data-ttu-id="82b91-107">Se uno o più buffer vengono inviati prima del momento in cui i dati sono stati ricevuti dalla rete, è possibile che i dati vengano inseriti nei buffer dell'utente immediatamente dopo l'arrivo, evitando in questo modo l'operazione di copia che altrimenti verrebbe eseguita.</span><span class="sxs-lookup"><span data-stu-id="82b91-107">If one or more buffers are posted prior to the time when data has been received by the network, it is possible that data will be placed into the user's buffers immediately as it arrives and thereby avoid the copy operation that would otherwise occur.</span></span> <span data-ttu-id="82b91-108">Se i dati arrivano quando i buffer di ricezione sono già stati pubblicati, vengono copiati immediatamente nei buffer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="82b91-108">If data arrives when receive buffers have already been posted, it is copied immediately into the user's buffers.</span></span> <span data-ttu-id="82b91-109">Se i dati arrivano quando l'applicazione non dispone di buffer di ricezione, il provider di servizi ricorre allo stile sincrono dell'operazione in cui i dati in arrivo vengono memorizzati nel buffer internamente fino al momento in cui il client invia una chiamata di ricezione e quindi fornisce un buffer in cui i dati possono essere copiati.</span><span class="sxs-lookup"><span data-stu-id="82b91-109">If data arrives when no receive buffers have been posted by the application, the service provider resorts to the synchronous style of operation where the incoming data is buffered internally until such time as the client issues a receive call and thereby supplies a buffer into which the data may be copied.</span></span> <span data-ttu-id="82b91-110">Un'eccezione è costituita dal caso in cui l'applicazione utilizza [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) per impostare la dimensione del buffer di ricezione su zero.</span><span class="sxs-lookup"><span data-stu-id="82b91-110">An exception to this would be if the application used [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) to set the size of the receive buffer to zero.</span></span> <span data-ttu-id="82b91-111">In questo caso, i protocolli affidabili consentono di ricevere solo i dati quando i buffer dell'applicazione sono stati inviati e i dati su protocolli non affidabili andranno perduti.</span><span class="sxs-lookup"><span data-stu-id="82b91-111">In this instance, reliable protocols would only allow data to be received when application buffers had been posted, and data on unreliable protocols would be lost.</span></span>

<span data-ttu-id="82b91-112">Sul lato di invio, i client usano [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) o [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) per fornire i puntatori ai buffer pieni e quindi accettano di non disturbare i buffer in alcun modo finché la rete non ha utilizzato il contenuto del buffer.</span><span class="sxs-lookup"><span data-stu-id="82b91-112">On the sending side, clients use [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) or [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) to supply pointers to filled buffers and then agree not to disturb the buffers in any way until the network has consumed the buffer's contents.</span></span>

<span data-ttu-id="82b91-113">Le chiamate di invio e ricezione sovrapposte vengono restituite immediatamente.</span><span class="sxs-lookup"><span data-stu-id="82b91-113">Overlapped send and receive calls return immediately.</span></span> <span data-ttu-id="82b91-114">Un valore restituito pari a zero indica che l'operazione di I/O è stata completata immediatamente e che l'indicazione di completamento corrispondente è già stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="82b91-114">A return value of zero indicates that the I/O operation completed immediately and that the corresponding completion indication has already occurred.</span></span> <span data-ttu-id="82b91-115">Ovvero l'oggetto evento associato è stato segnalato o la routine di completamento è stata accodata tramite [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="82b91-115">That is, the associated event object has been signaled, or the completion routine has been queued through [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="82b91-116">Un valore restituito dell'errore del SOCKET \_ associato a un codice di errore di i/o WSA \_ \_ in sospeso indica che l'operazione sovrapposta è stata avviata correttamente e che verrà fornita un'indicazione successiva quando vengono utilizzati i buffer di invio o quando vengono riempiti i buffer di ricezione.</span><span class="sxs-lookup"><span data-stu-id="82b91-116">A return value of SOCKET\_ERROR coupled with an error code of WSA\_IO\_PENDING indicates that the overlapped operation has been successfully initiated and that a subsequent indication will be provided when send buffers have been consumed or when receive buffers are filled.</span></span> <span data-ttu-id="82b91-117">Qualsiasi altro codice di errore indica che l'operazione sovrapposta non è stata avviata correttamente e che l'indicazione di completamento non sarà imminente.</span><span class="sxs-lookup"><span data-stu-id="82b91-117">Any other error code indicates that the overlapped operation was not successfully initiated and that no completion indication will be forthcoming.</span></span>

<span data-ttu-id="82b91-118">È possibile sovrapporre le operazioni di invio e ricezione.</span><span class="sxs-lookup"><span data-stu-id="82b91-118">Both send and receive operations can be overlapped.</span></span> <span data-ttu-id="82b91-119">Le funzioni receive possono essere richiamate più volte per inserire i buffer di ricezione in preparazione ai dati in ingresso e le funzioni di invio possono essere richiamate più volte per accodare più buffer da inviare.</span><span class="sxs-lookup"><span data-stu-id="82b91-119">The receive functions may be invoked multiple times to post receive buffers in preparation for incoming data, and the send functions may be invoked multiple times to queue up multiple buffers to be sent.</span></span> <span data-ttu-id="82b91-120">Si noti che, mentre una serie di buffer di invio sovrapposti viene inviata nell'ordine specificato, le indicazioni di completamento corrispondenti possono verificarsi in un ordine diverso.</span><span class="sxs-lookup"><span data-stu-id="82b91-120">Note that while a series of overlapped send buffers will be sent in the order supplied, the corresponding completion indications may occur in a different order.</span></span> <span data-ttu-id="82b91-121">Analogamente, sul lato ricevente, i buffer verranno compilati nell'ordine in cui vengono forniti, ma le indicazioni di completamento possono verificarsi in un ordine diverso.</span><span class="sxs-lookup"><span data-stu-id="82b91-121">Likewise, on the receiving side, buffers will be filled in the order they are supplied, but completion indications may occur in a different order.</span></span>

<span data-ttu-id="82b91-122">Per [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))è disponibile anche la funzionalità di completamento posticipato dell'I/O sovrapposto.</span><span class="sxs-lookup"><span data-stu-id="82b91-122">The deferred completion feature of overlapped I/O is also available for [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span></span>

## <a name="delivering-completion-indications"></a><span data-ttu-id="82b91-123">Recapito delle indicazioni di completamento</span><span class="sxs-lookup"><span data-stu-id="82b91-123">Delivering Completion Indications</span></span>

<span data-ttu-id="82b91-124">I provider di servizi hanno due modi per indicare il completamento sovrapposto: l'impostazione di un oggetto evento specificato dal client o la chiamata di una routine di completamento specificata dal client.</span><span class="sxs-lookup"><span data-stu-id="82b91-124">Service providers have two ways to indicate overlapped completion: setting a client-specified event object, or invoking a client-specified completion routine.</span></span> <span data-ttu-id="82b91-125">In entrambi i casi, una struttura di dati, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), è associata a ogni operazione sovrapposta.</span><span class="sxs-lookup"><span data-stu-id="82b91-125">In both cases a data structure, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), is associated with each overlapped operation.</span></span> <span data-ttu-id="82b91-126">Questa struttura viene allocata dal client e utilizzata per indicare quale oggetto evento (se presente) deve essere impostato quando si verifica il completamento.</span><span class="sxs-lookup"><span data-stu-id="82b91-126">This structure is allocated by the client and used by it to indicate which event object (if any) is to be set when completion occurs.</span></span> <span data-ttu-id="82b91-127">La struttura **WSAOVERLAPPED** può essere usata dal provider di servizi come posizione in cui archiviare un handle per i risultati (ad esempio, il numero di byte trasferiti, i flag aggiornati, i codici di errore e così via) per una particolare operazione sovrapposta.</span><span class="sxs-lookup"><span data-stu-id="82b91-127">The **WSAOVERLAPPED** structure may be used by the service provider as a place to store a handle to the results (for example, number of bytes transferred, updated flags, error codes, etc.) for a particular overlapped operation.</span></span> <span data-ttu-id="82b91-128">Per ottenere questi risultati i client devono richiamare [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passando un puntatore alla struttura sovrapposta corrispondente.</span><span class="sxs-lookup"><span data-stu-id="82b91-128">To obtain these results clients must invoke [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passing in a pointer to the corresponding overlapped structure.</span></span>

<span data-ttu-id="82b91-129">Se per una determinata richiesta di I/O sovrapposta è selezionata l'indicazione di completamento basato su eventi, la routine [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) può essere utilizzata dai client per eseguire il polling o attendere il completamento dell'operazione sovrapposta.</span><span class="sxs-lookup"><span data-stu-id="82b91-129">If event based completion indication is selected for a particular overlapped I/O request, the [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) routine may itself be used by clients to either poll or wait for completion of the overlapped operation.</span></span> <span data-ttu-id="82b91-130">Se per una particolare richiesta di I/O sovrapposta è selezionata l'indicazione di completamento basato su routine, è disponibile solo l'opzione di polling di **WSPGetOverlappedResult** .</span><span class="sxs-lookup"><span data-stu-id="82b91-130">If completion-routine-based completion indication is selected for a particular overlapped I/O request, only the polling option of **WSPGetOverlappedResult** is available.</span></span> <span data-ttu-id="82b91-131">Un client può inoltre utilizzare altri mezzi per attendere (ad esempio, l'utilizzo di [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) fino a quando l'oggetto evento corrispondente non è stato segnalato o la routine di completamento specificata è stata richiamata dal provider di servizi.</span><span class="sxs-lookup"><span data-stu-id="82b91-131">A client may also use other means to wait (such as using [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) until the corresponding event object has been signaled or the specified completion routine has been invoked by the service provider.</span></span> <span data-ttu-id="82b91-132">Una volta indicato il completamento, il client può richiamare **WSPGetOverlappedResult**, con la previsione che la chiamata venga completata immediatamente.</span><span class="sxs-lookup"><span data-stu-id="82b91-132">Once completion has been indicated, the client may invoke **WSPGetOverlappedResult**, with the expectation that the call will complete immediately.</span></span>

## <a name="invoking-socket-io-completion-routines"></a><span data-ttu-id="82b91-133">Richiamo di routine di completamento I/O socket</span><span class="sxs-lookup"><span data-stu-id="82b91-133">Invoking Socket I/O Completion Routines</span></span>

<span data-ttu-id="82b91-134">Se il parametro *il lpCompletionRoutine* di un'operazione sovrapposta non è **null**, è responsabilità del provider di servizi disporre la chiamata della routine di completamento specificata dal client al termine dell'operazione sovrapposta.</span><span class="sxs-lookup"><span data-stu-id="82b91-134">If the *lpCompletionRoutine* parameter to an overlapped operation is not **NULL**, it is the service provider's responsibility to arrange for invocation of the client-specified completion routine when the overlapped operation completes.</span></span> <span data-ttu-id="82b91-135">Poiché la routine di completamento deve essere eseguita nel contesto dello stesso thread che ha avviato l'operazione sovrapposta, non può essere richiamata direttamente dal provider di servizi.</span><span class="sxs-lookup"><span data-stu-id="82b91-135">Since the completion routine must be executed in the context of the same thread that initiated the overlapped operation, it cannot be invoked directly from the service provider.</span></span> <span data-ttu-id="82b91-136">Il \_32.DLL WS2 offre un meccanismo APC (Asynchronous Procedure Call) per facilitare la chiamata delle routine di completamento.</span><span class="sxs-lookup"><span data-stu-id="82b91-136">The Ws2\_32.DLL offers an asynchronous procedure call (APC) mechanism to facilitate invocation of completion routines.</span></span>

<span data-ttu-id="82b91-137">Un provider di servizi dispone che una funzione venga eseguita nel thread appropriato chiamando [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="82b91-137">A service provider arranges for a function to be executed in the proper thread by calling [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="82b91-138">Questa funzione può essere chiamata da qualsiasi contesto di processo e thread, anche da un contesto diverso dal thread e dal processo utilizzati per avviare l'operazione sovrapposta.</span><span class="sxs-lookup"><span data-stu-id="82b91-138">This function can be called from any process and thread context, even a context different from the thread and process that was used to initiate the overlapped operation.</span></span>

<span data-ttu-id="82b91-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) accetta come parametri di input un puntatore a una struttura [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) , un puntatore a una funzione APC da richiamare e un valore di contesto a 32 bit che viene successivamente passato alla funzione APC.</span><span class="sxs-lookup"><span data-stu-id="82b91-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) takes as input parameters a pointer to a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) structure, a pointer to an APC function to be invoked, and a 32-bit context value that is subsequently passed to the APC function.</span></span> <span data-ttu-id="82b91-140">I provider di servizi vengono sempre forniti con un puntatore alla struttura **WSATHREADID** corretta tramite il parametro *lpThreadId* alla funzione Overlapped.</span><span class="sxs-lookup"><span data-stu-id="82b91-140">Service providers are always supplied with a pointer to the proper **WSATHREADID** structure through the *lpThreadId* parameter to the overlapped function.</span></span> <span data-ttu-id="82b91-141">Il provider deve archiviare la struttura **WSATHREADID** localmente e fornire un puntatore a questa copia della struttura **WSATHREADID** come parametro di input per **WPUQueueApc**.</span><span class="sxs-lookup"><span data-stu-id="82b91-141">The provider should store the **WSATHREADID** structure locally and supply a pointer to this copy of the **WSATHREADID** structure as an input parameter to **WPUQueueApc**.</span></span> <span data-ttu-id="82b91-142">Una volta che la funzione **WPUQueueApc** restituisce, il provider può eliminare la propria copia di **WSATHREADID**.</span><span class="sxs-lookup"><span data-stu-id="82b91-142">Once the **WPUQueueApc** function returns, the provider can dispose of its copy of the **WSATHREADID**.</span></span>

<span data-ttu-id="82b91-143">La procedura [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) Accoda semplicemente informazioni sufficienti per chiamare la funzione APC indicata con i parametri specificati, ma non la chiama.</span><span class="sxs-lookup"><span data-stu-id="82b91-143">The procedure [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simply enqueues sufficient information to call the indicated APC function with the given parameters, but does not call it.</span></span> <span data-ttu-id="82b91-144">Quando il thread di destinazione entra in uno stato di attesa di avviso, queste informazioni vengono rimossi dalla coda e viene eseguita una chiamata alla funzione APC nel contesto del thread e del processo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="82b91-144">When the target thread enters an alertable wait state, this information is dequeued and a call is made to the APC function in that target thread and process context.</span></span> <span data-ttu-id="82b91-145">Poiché il meccanismo APC supporta solo un singolo valore di contesto a 32 bit, la funzione APC non può essere la routine di completamento specificata dal client, che prevede più parametri.</span><span class="sxs-lookup"><span data-stu-id="82b91-145">Because the APC mechanism supports only a single 32-bit context value, the APC function cannot itself be the client-specified completion routine, which involves more parameters.</span></span> <span data-ttu-id="82b91-146">Il provider di servizi deve invece fornire un puntatore alla propria funzione APC che usa il valore di contesto fornito per accedere alle informazioni sui risultati necessarie per l'operazione sovrapposta, quindi richiama la routine di completamento specificata dal client.</span><span class="sxs-lookup"><span data-stu-id="82b91-146">The service provider must instead supply a pointer to its own APC function which uses the supplied context value to access the needed result information for the overlapped operation, and then invokes the client-specified completion routine.</span></span>

<span data-ttu-id="82b91-147">Per i provider di servizi in cui un componente in modalità utente implementa I/O sovrapposti, un utilizzo tipico del meccanismo APC è il seguente:</span><span class="sxs-lookup"><span data-stu-id="82b91-147">For service providers where a user-mode component implements overlapped I/O, a typical usage of the APC mechanism is as follows:</span></span>

-   <span data-ttu-id="82b91-148">Quando l'operazione di I/O viene completata, il provider alloca un buffer di piccole dimensioni e lo comprime con un puntatore alla procedura di completamento fornita dal client e ai valori dei parametri da passare alla procedura.</span><span class="sxs-lookup"><span data-stu-id="82b91-148">When the I/O operation completes, the provider allocates a small buffer and packs it with a pointer to the client-supplied completion procedure and parameter values to pass to the procedure.</span></span>
-   <span data-ttu-id="82b91-149">Accoda un APC, specificando il puntatore al buffer come valore di contesto e la relativa procedura intermedia come procedura di destinazione.</span><span class="sxs-lookup"><span data-stu-id="82b91-149">It queues an APC, specifying the pointer to the buffer as the context value and its own intermediate procedure as the target procedure.</span></span>
-   <span data-ttu-id="82b91-150">Quando il thread di destinazione immette lo stato di attesa di avviso, la procedura intermedia del provider di servizi viene chiamata nel contesto del thread appropriato.</span><span class="sxs-lookup"><span data-stu-id="82b91-150">When the target thread eventually enters alertable wait state, the service provider's intermediate procedure is called in the proper thread context.</span></span>
-   <span data-ttu-id="82b91-151">Con la procedura intermedia è sufficiente decomprimere i parametri, deallocare il buffer e chiamare la procedura di completamento fornita dal client.</span><span class="sxs-lookup"><span data-stu-id="82b91-151">The intermediate procedure simply unpacks parameters, deallocates the buffer, and calls the client-supplied completion procedure.</span></span>
-   <span data-ttu-id="82b91-152">Per i provider di servizi in cui un componente in modalità kernel implementa l'I/O sovrapposto, un'implementazione tipica è simile, ad eccezione del fatto che l'implementazione userà interfacce kernel standard per accodare l'APC.</span><span class="sxs-lookup"><span data-stu-id="82b91-152">For service providers where a kernel-mode component implements overlapped I/O, a typical implementation is similar, except that the implementation would use standard kernel interfaces to enqueue the APC.</span></span>

<span data-ttu-id="82b91-153">La descrizione delle interfacce kernel pertinenti esula dall'ambito della specifica di Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="82b91-153">Description of the relevant kernel interfaces is outside the scope of the Windows Sockets 2 specification.</span></span>

> [!Note]  
> <span data-ttu-id="82b91-154">I provider di servizi devono consentire ai client di Windows Sockets 2 di richiamare le operazioni di invio e ricezione dall'interno del contesto della routine di completamento I/O del socket e garantiscono che per un socket specifico, le routine di completamento I/O non saranno nidificate.</span><span class="sxs-lookup"><span data-stu-id="82b91-154">Service providers must allow Windows Sockets 2 clients to invoke send and receive operations from within the context of the socket I/O completion routine and guarantee that for a given socket, I/O completion routines will not be nested.</span></span>

 

<span data-ttu-id="82b91-155">In alcuni casi, un provider di servizi su più livelli potrebbe dover avviare e completare le operazioni sovrapposte dall'interno di un thread di lavoro interno.</span><span class="sxs-lookup"><span data-stu-id="82b91-155">Under some circumstances, a layered service provider may need to initiate and complete overlapped operations from within an internal worker thread.</span></span> <span data-ttu-id="82b91-156">In questo caso, un [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) non sarebbe disponibile da una chiamata di funzione in entrata.</span><span class="sxs-lookup"><span data-stu-id="82b91-156">In this case, a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) would not be available from an incoming function call.</span></span> <span data-ttu-id="82b91-157">L'interfaccia del provider di servizi fornisce una chiamata [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread)per ottenere un **WSATHREADID** per il thread corrente.</span><span class="sxs-lookup"><span data-stu-id="82b91-157">The service provider interface provides an upcall, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), to obtain a **WSATHREADID** for the current thread.</span></span> <span data-ttu-id="82b91-158">Quando questo **WSATHREADID** non è più necessario, le relative risorse devono essere restituite chiamando [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span><span class="sxs-lookup"><span data-stu-id="82b91-158">When this **WSATHREADID** is no longer needed, its resources should be returned by calling [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span></span>

 

 
