---
description: Implementazione del codec.
ms.assetid: 5ec23f95-cc7d-4c16-979a-f1d2cc485bb0
title: Implementazione di codec
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 201c0cb46fc61f117c9b45d059b102560986d5b7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103878469"
---
# <a name="codec-implementation"></a><span data-ttu-id="57e99-103">Implementazione di codec</span><span class="sxs-lookup"><span data-stu-id="57e99-103">Codec implementation</span></span>

<span data-ttu-id="57e99-104">I codec Windows Media Audio e video sono implementati come oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="57e99-104">The Windows Media Audio and Video codecs are implemented as COM objects.</span></span> <span data-ttu-id="57e99-105">Un codec viene in genere implementato come una coppia di oggetti COM: uno per il codificatore e uno per il decodificatore.</span><span class="sxs-lookup"><span data-stu-id="57e99-105">Typically, a codec is implemented as a pair of COM objects: one for the encoder and one for the decoder.</span></span> <span data-ttu-id="57e99-106">Il codificatore ha un identificatore di classe (CLSID) e il decodificatore ha un CLSID diverso.</span><span class="sxs-lookup"><span data-stu-id="57e99-106">The encoder has a class identifier (CLSID) and the decoder has a different CLSID.</span></span> <span data-ttu-id="57e99-107">Ad esempio, la parte del codificatore del codec Windows Media Audio 9 ha un CLSID rappresentato dalla costante **CLSID \_ CWMAEncMediaObject** e la parte del decodificatore dello stesso codec presenta un CLSID rappresentato dalla costante **CLSID \_ CWMADecMediaObject**.</span><span class="sxs-lookup"><span data-stu-id="57e99-107">For example, the encoder portion of the Windows Media Audio 9 codec has a CLSID represented by the constant **CLSID\_CWMAEncMediaObject**, and the decoder portion of that same codec has a CLSID represented by the constant **CLSID\_CWMADecMediaObject**.</span></span>

<span data-ttu-id="57e99-108">In alcuni casi, più di un codificatore è incluso in un singolo oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="57e99-108">In some cases, more than one encoder is included in a single COM object.</span></span> <span data-ttu-id="57e99-109">Ad esempio, il codificatore Windows Media Video 9 e il codificatore Windows Media Video 9,1 sono entrambi parte dello stesso oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="57e99-109">For example, the Windows Media Video 9 encoder and the Windows Media Video 9.1 encoder are both part of the same COM object.</span></span> <span data-ttu-id="57e99-110">Di conseguenza, entrambi hanno lo stesso CLSID, rappresentato dalla costante **CLSID \_ CWMV9EncMediaObject**.</span><span class="sxs-lookup"><span data-stu-id="57e99-110">Consequently, they both have the same CLSID, which is represented by the constant **CLSID\_CWMV9EncMediaObject**.</span></span> <span data-ttu-id="57e99-111">Analogamente, alcuni oggetti COM includono più di un decodificatore.</span><span class="sxs-lookup"><span data-stu-id="57e99-111">Similarly, some COM objects include more than one decoder.</span></span>

<span data-ttu-id="57e99-112">Ogni oggetto codificatore o decodificatore espone l'interfaccia [**IMediaObject**](/previous-versions/ms785953%28v%3dvs.85%29) in modo che l'oggetto possa essere usato come DMO (DirectX Media Object) e l'interfaccia [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) in modo che l'oggetto possa essere usato come trasformazione Media Foundation (MFT).</span><span class="sxs-lookup"><span data-stu-id="57e99-112">Each encoder or decoder object exposes the [**IMediaObject**](/previous-versions/ms785953%28v%3dvs.85%29) interface so that the object can be used as a DirectX Media Object (DMO) and the [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface so that the object can be used as a Media Foundation Transform (MFT).</span></span>

<span data-ttu-id="57e99-113">Per la maggior parte dei codificatori, indipendentemente dal fatto che si usi il codificatore come DMO o MFT, si usa lo stesso CLSID per creare un'istanza del codificatore.</span><span class="sxs-lookup"><span data-stu-id="57e99-113">For most encoders, regardless of whether you use the encoder as a DMO or an MFT, you use the same CLSID to create an instance of the encoder.</span></span> <span data-ttu-id="57e99-114">Per creare, ad esempio, un'istanza del codificatore Windows Media Video 9, usare **CLSID \_ CWMV9EncMediaObject**, indipendentemente dal fatto che si intenda usare il codificatore come DMO o MFT.</span><span class="sxs-lookup"><span data-stu-id="57e99-114">For example, to create an instance of the Windows Media Video 9 encoder, you use **CLSID\_CWMV9EncMediaObject**, regardless of whether you intend to use the encoder as a DMO or an MFT.</span></span> <span data-ttu-id="57e99-115">Analogamente, per la maggior parte dei decodificatori ogni decodificatore ha un solo CLSID, indipendentemente dal fatto che si usi il decodificatore come DMO o MFT.</span><span class="sxs-lookup"><span data-stu-id="57e99-115">Similarly, for most decoders, each decoder has a single CLSID regardless of whether you use the decoder as a DMO or an MFT.</span></span>

> [!Note]  
> <span data-ttu-id="57e99-116">Esistono alcune eccezioni all'istruzione precedente sull'uso di un solo CLSID per DMO e MFT.</span><span class="sxs-lookup"><span data-stu-id="57e99-116">There are some exceptions to the preceding statement about using a single CLSID for both the DMO and the MFT.</span></span> <span data-ttu-id="57e99-117">Ad esempio, il decodificatore MPEG-4 Part 2 ha un CLSID quando funge da DMO e un CLSID diverso quando funge da MFT.</span><span class="sxs-lookup"><span data-stu-id="57e99-117">For example, the MPEG-4 Part 2 decoder has one CLSID when it is acting as a DMO and a different CLSID when it is acting as an MFT.</span></span>

 

<span data-ttu-id="57e99-118">Oltre alle interfacce di base, ogni oggetto codificatore o decodificatore implementa due interfacce simili per l'utilizzo delle proprietà del codec, **IPropertyBag** e **IPropertyStore**.</span><span class="sxs-lookup"><span data-stu-id="57e99-118">In addition to the core interfaces, each encoder or decoder object implements two similar interfaces for working with codec properties, **IPropertyBag** and **IPropertyStore**.</span></span> <span data-ttu-id="57e99-119">Le versioni precedenti degli oggetti codificatore e decodificatore usavano **IPropertyBag**, che identifica ogni proprietà in base a un valore stringa contenente un nome di proprietà.</span><span class="sxs-lookup"><span data-stu-id="57e99-119">Older versions of the encoder and decoder objects used **IPropertyBag**, which identifies each property by a string value containing a property name.</span></span> <span data-ttu-id="57e99-120">**IPropertyStore** è un'interfaccia più recente che identifica le proprietà con un valore di chiave di proprietà univoco.</span><span class="sxs-lookup"><span data-stu-id="57e99-120">**IPropertyStore** is a newer interface that identifies properties with a unique property key value.</span></span> <span data-ttu-id="57e99-121">È stato aggiunto il supporto per **IPropertyStore** per fornire supporto per MFTS.</span><span class="sxs-lookup"><span data-stu-id="57e99-121">Support for **IPropertyStore** was added to provide support for MFTs.</span></span> <span data-ttu-id="57e99-122">La maggior parte delle stringhe del nome di proprietà di **IPropertyBag** dispone di un GUID della chiave della proprietà **IPropertyStore** corrispondente e la maggior parte dei GUID ha una stringa del nome **IPropertyBag** corrispondente, con alcune eccezioni.</span><span class="sxs-lookup"><span data-stu-id="57e99-122">Most **IPropertyBag** property name strings have a corresponding **IPropertyStore** property key GUID and most of the GUIDs have a corresponding **IPropertyBag** name string, with a few exceptions.</span></span>

<span data-ttu-id="57e99-123">Questa documentazione elenca le proprietà in base alla costante della chiave della proprietà, ma ogni voce include la costante della stringa del nome di proprietà da usare con **IPropertyBag** quando appropriato.</span><span class="sxs-lookup"><span data-stu-id="57e99-123">This documentation lists the properties by property key constant, but each entry includes the property-name string constant for use with **IPropertyBag** when appropriate.</span></span>

## <a name="related-topics"></a><span data-ttu-id="57e99-124">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="57e99-124">Related topics</span></span>

[<span data-ttu-id="57e99-125">Codec Windows Media</span><span class="sxs-lookup"><span data-stu-id="57e99-125">Windows Media Codecs</span></span>](windows-media-codecs.md)
