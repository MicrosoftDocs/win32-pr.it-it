---
description: Questo argomento descrive come scrivere una trasformazione Media Foundation (MFT) che funge da proxy per un codificatore hardware, un decodificatore o un processore di segnale digitale (DSP).
ms.assetid: 9922d403-5d0d-433f-ad9f-c86142ac0f46
title: MFTs hardware
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ac5ce05b4fdad6040b51f66f543c1737fc3918d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104226460"
---
# <a name="hardware-mfts"></a><span data-ttu-id="6810e-103">MFTs hardware</span><span class="sxs-lookup"><span data-stu-id="6810e-103">Hardware MFTs</span></span>

> [!Note]  
> <span data-ttu-id="6810e-104">Questo argomento si applica a Windows 7 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="6810e-104">This topic applies to Windows 7 or later.</span></span>

 

<span data-ttu-id="6810e-105">Questo argomento descrive come scrivere una trasformazione Media Foundation (MFT) che funge da proxy per un codificatore hardware, un decodificatore o un processore di segnale digitale (DSP).</span><span class="sxs-lookup"><span data-stu-id="6810e-105">This topic describes how to write a Media Foundation transform (MFT) that acts as a proxy to a hardware encoder, decoder, or digital signal processor (DSP).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6810e-106">Se un codec hardware usa il driver della classe multimediale AVStream, non richiede un MFT personalizzato.</span><span class="sxs-lookup"><span data-stu-id="6810e-106">If a hardware codec uses the AVStream multimedia class driver, it does not require a custom MFT.</span></span> <span data-ttu-id="6810e-107">Media Foundation fornisce un proxy AVStream a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="6810e-107">Media Foundation provides an AVStream proxy for this purpose.</span></span> <span data-ttu-id="6810e-108">Le informazioni contenute in questo argomento si applicano solo nel caso speciale in cui il codec hardware non utilizza AVStream.</span><span class="sxs-lookup"><span data-stu-id="6810e-108">The information in this topic applies only in the special case where the hardware codec does not use AVStream.</span></span> <span data-ttu-id="6810e-109">Per ulteriori informazioni, vedere [supporto dei codec hardware in AVStream](https://msdn.microsoft.com/library/dd568169.aspx).</span><span class="sxs-lookup"><span data-stu-id="6810e-109">For more information, see [Hardware Codec Support in AVStream](https://msdn.microsoft.com/library/dd568169.aspx).</span></span>

 

<span data-ttu-id="6810e-110">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6810e-110">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="6810e-111">Introduzione</span><span class="sxs-lookup"><span data-stu-id="6810e-111">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="6810e-112">Attributi hardware MFT</span><span class="sxs-lookup"><span data-stu-id="6810e-112">Hardware MFT Attributes</span></span>](#hardware-mft-attributes)
-   [<span data-ttu-id="6810e-113">Sequenza di handshake hardware</span><span class="sxs-lookup"><span data-stu-id="6810e-113">Hardware Handshake Sequence</span></span>](#hardware-handshake-sequence)
-   [<span data-ttu-id="6810e-114">Elaborazione dati</span><span class="sxs-lookup"><span data-stu-id="6810e-114">Data Processing</span></span>](#data-processing)
-   [<span data-ttu-id="6810e-115">Codificatore/codificatore abbinato</span><span class="sxs-lookup"><span data-stu-id="6810e-115">Paired Decoder/Encoder</span></span>](#paired-decoderencoder)
-   [<span data-ttu-id="6810e-116">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6810e-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="6810e-117">Introduzione</span><span class="sxs-lookup"><span data-stu-id="6810e-117">Introduction</span></span>

<span data-ttu-id="6810e-118">Qualsiasi codec hardware non basato su AVStream deve fornire il proprio MFT per fungere da proxy per il driver.</span><span class="sxs-lookup"><span data-stu-id="6810e-118">Any hardware codec that is not based on AVStream must provide its own MFT to act as a proxy to the driver.</span></span> <span data-ttu-id="6810e-119">Un codec hardware può incorporare diversi blocchi funzionali distinti:</span><span class="sxs-lookup"><span data-stu-id="6810e-119">A hardware codec might incorporate several distinct functional blocks:</span></span>

-   <span data-ttu-id="6810e-120">Codificatore</span><span class="sxs-lookup"><span data-stu-id="6810e-120">Encoder</span></span>
-   <span data-ttu-id="6810e-121">Decodificatore</span><span class="sxs-lookup"><span data-stu-id="6810e-121">Decoder</span></span>
-   <span data-ttu-id="6810e-122">Ridimensionamento del frame/conversione del formato</span><span class="sxs-lookup"><span data-stu-id="6810e-122">Frame scaling/format conversion</span></span>

<span data-ttu-id="6810e-123">Ognuna di queste funzioni deve essere gestita da un MFT separato.</span><span class="sxs-lookup"><span data-stu-id="6810e-123">Each of these functions should be managed by a separate MFT.</span></span> <span data-ttu-id="6810e-124">Una MFT hardware non deve mai fungere da "transcodificatore multifunzione".</span><span class="sxs-lookup"><span data-stu-id="6810e-124">A hardware MFT should never act as a multi-purpose "transcoder."</span></span> <span data-ttu-id="6810e-125">Al contrario, inserire le funzioni di codifica in un codificatore MFT e decodifica le funzioni in un decodificatore MFT.</span><span class="sxs-lookup"><span data-stu-id="6810e-125">Instead, put encoding functions into an encoder MFT and decoding functions into a decoder MFT.</span></span> <span data-ttu-id="6810e-126">Se l'hardware offre la scalabilità dei frame e le conversioni di formato, inserire le funzioni in un processore video separato, registrato nella categoria del **\_ \_ \_ processore video della categoria MFT** .</span><span class="sxs-lookup"><span data-stu-id="6810e-126">If the hardware offers frame scaling and format conversions, place those functions in a separate video processor, registered in the **MFT\_CATEGORY\_VIDEO\_PROCESSOR** category.</span></span> <span data-ttu-id="6810e-127">Se l'hardware non supporta il ridimensionamento dei frame o la conversione del formato, Media Foundation fornisce un processore video software.</span><span class="sxs-lookup"><span data-stu-id="6810e-127">If the hardware does not support frame scaling or format conversion, Media Foundation provides a software video processor.</span></span>

<span data-ttu-id="6810e-128">I requisiti generali per MFTs hardware sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="6810e-128">Hardware MFTs have the following general requirements:</span></span>

-   <span data-ttu-id="6810e-129">MFTs hardware deve usare il nuovo modello di elaborazione asincrona, come descritto in [MFTS asincrono](asynchronous-mfts.md).</span><span class="sxs-lookup"><span data-stu-id="6810e-129">Hardware MFTs must use the new asynchronous processing model, as described in [Asynchronous MFTs](asynchronous-mfts.md).</span></span>
-   <span data-ttu-id="6810e-130">MFTs hardware deve supportare le modifiche del formato dinamico, come descritto in [modifiche al formato dinamico](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="6810e-130">Hardware MFTs must support dynamic format changes, as described in [Dynamic Format Changes](basic-mft-processing-model.md).</span></span>

## <a name="hardware-mft-attributes"></a><span data-ttu-id="6810e-131">Attributi hardware MFT</span><span class="sxs-lookup"><span data-stu-id="6810e-131">Hardware MFT Attributes</span></span>

<span data-ttu-id="6810e-132">Una MFT hardware deve implementare i metodi seguenti correlati agli attributi:</span><span class="sxs-lookup"><span data-stu-id="6810e-132">A hardware MFT must implement following methods related to attributes:</span></span>

-   <span data-ttu-id="6810e-133">[**IMFTransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes): restituisce un archivio di attributi per gli attributi MFT globali.</span><span class="sxs-lookup"><span data-stu-id="6810e-133">[**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes): Returns an attribute store for global MFT attributes.</span></span>
-   <span data-ttu-id="6810e-134">[**IMFTransform:: GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes): restituisce un archivio di attributi per un flusso di input.</span><span class="sxs-lookup"><span data-stu-id="6810e-134">[**IMFTransform::GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes): Returns an attribute store for an input stream.</span></span>
-   <span data-ttu-id="6810e-135">[**IMFTransform:: GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes): restituisce un archivio di attributi per un flusso di output.</span><span class="sxs-lookup"><span data-stu-id="6810e-135">[**IMFTransform::GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes): Returns an attribute store for an output stream.</span></span>

<span data-ttu-id="6810e-136">Quando il file MFT viene creato per la prima volta, deve impostare gli attributi seguenti nel relativo archivio attributi globale (ovvero l'archivio di attributi restituito da [**GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes)):</span><span class="sxs-lookup"><span data-stu-id="6810e-136">When the MFT is first created, it must set the following attributes on its own global attribute store (that is, the attribute store returned by [**GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes)):</span></span>



| <span data-ttu-id="6810e-137">Attributo</span><span class="sxs-lookup"><span data-stu-id="6810e-137">Attribute</span></span>                                                                                    | <span data-ttu-id="6810e-138">Descrizione</span><span class="sxs-lookup"><span data-stu-id="6810e-138">Description</span></span>                                                                                                                                                                            |
|----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6810e-139">MF \_ trasforma \_ asincrono</span><span class="sxs-lookup"><span data-stu-id="6810e-139">MF\_TRANSFORM\_ASYNC</span></span>](mf-transform-async.md)                                               | <span data-ttu-id="6810e-140">Deve essere impostato su **true**.</span><span class="sxs-lookup"><span data-stu-id="6810e-140">Must be set to **TRUE**.</span></span> <span data-ttu-id="6810e-141">Indica che il MFT esegue l'elaborazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="6810e-141">Indicates that the MFT performs asynchronous processing.</span></span>                                                                                                      |
| [<span data-ttu-id="6810e-142">\_ \_ \_ Attributo URL hardware dell'enumerazione MFT \_</span><span class="sxs-lookup"><span data-stu-id="6810e-142">MFT\_ENUM\_HARDWARE\_URL\_Attribute</span></span>](mft-enum-hardware-url-attribute.md)                   | <span data-ttu-id="6810e-143">Contiene il collegamento simbolico per il dispositivo hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-143">Contains the symbolic link for the hardware device.</span></span><br/> <span data-ttu-id="6810e-144">Il caricatore della topologia usa la presenza di questo attributo per verificare se una MFT rappresenta un dispositivo hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-144">The topology loader uses the presence of this attribute to test whether an MFT represents a hardware device.</span></span><br/> |
| [<span data-ttu-id="6810e-145">**la \_ \_ modifica del \_ formato \_ dinamico del supporto MFT**</span><span class="sxs-lookup"><span data-stu-id="6810e-145">**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**</span></span>](mft-support-dynamic-format-change-attribute.md) | <span data-ttu-id="6810e-146">Deve essere impostato su **true**.</span><span class="sxs-lookup"><span data-stu-id="6810e-146">Must be set to **TRUE**.</span></span> <span data-ttu-id="6810e-147">Indica che il MFT supporta le modifiche del formato dinamico.</span><span class="sxs-lookup"><span data-stu-id="6810e-147">Indicates that the MFT supports dynamic format changes.</span></span>                                                                                                       |



 

## <a name="hardware-handshake-sequence"></a><span data-ttu-id="6810e-148">Sequenza di handshake hardware</span><span class="sxs-lookup"><span data-stu-id="6810e-148">Hardware Handshake Sequence</span></span>

<span data-ttu-id="6810e-149">Se due MFTs rappresentano lo stesso dispositivo fisico, possono scambiare dati all'interno dell'hardware, ad esempio tramite un bus hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-149">If two MFTs represent the same physical device, they can exchange data within the hardware—for example, over a hardware bus.</span></span> <span data-ttu-id="6810e-150">Non è necessario copiare i dati nella memoria di sistema e quindi tornare al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6810e-150">There is no need to copy the data into system memory and then back to the device.</span></span>

<span data-ttu-id="6810e-151">Nel diagramma seguente i MFTs con etichetta "A" e "B" rappresentano i blocchi funzionali all'interno dello stesso hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-151">In the following diagram, the MFTs labeled "A" and "B" represent functional blocks within the same hardware.</span></span> <span data-ttu-id="6810e-152">In uno scenario di transcodifica, ad esempio, è possibile che "A" rappresenti un decodificatore hardware e che "B" rappresenti un codificatore hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-152">For example, in a transcoding scenario, "A" might represent a hardware decoder and "B" might represent a hardware encoder.</span></span> <span data-ttu-id="6810e-153">Il flusso di dati tra "A" e "B" si verifica all'interno dell'hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-153">The data flow between "A" and "B" occurs within the hardware.</span></span> <span data-ttu-id="6810e-154">Il MFT denominato "C" è un software MFT.</span><span class="sxs-lookup"><span data-stu-id="6810e-154">The MFT labeled "C" is a software MFT.</span></span> <span data-ttu-id="6810e-155">Il flusso di dati da "B" a "C" utilizza la memoria di sistema.</span><span class="sxs-lookup"><span data-stu-id="6810e-155">Data flow from "B" to "C" uses system memory.</span></span>

![diagramma che mostra le caselle con etichetta da a a c e un codec hardware: un punta a b e il codec, il codec punta a b e b punta a c](images/proxy-mft.png)

<span data-ttu-id="6810e-157">Per stabilire una connessione hardware, i due MFTs hardware devono usare un canale di comunicazione privato.</span><span class="sxs-lookup"><span data-stu-id="6810e-157">To establish a hardware connection, the two hardware MFTs must use a private communication channel.</span></span> <span data-ttu-id="6810e-158">Questa connessione viene stabilita durante la negoziazione del formato, prima che vengano impostati i tipi di supporto e prima della prima chiamata a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="6810e-158">This connection is established during format negotiation, before the media types are set and before the first call to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span> <span data-ttu-id="6810e-159">Il processo di connessione funziona nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="6810e-159">The connection process works as follows:</span></span>

1.  <span data-ttu-id="6810e-160">Il caricatore della topologia verifica sia MFTs per la presenza dell'attributo dell' [ \_ \_ \_ \_ attributo dell'URL dell'enumerazione MFT](mft-enum-hardware-url-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="6810e-160">The topology loader checks both MFTs for the presence of the [MFT\_ENUM\_HARDWARE\_URL\_Attribute](mft-enum-hardware-url-attribute.md) attribute.</span></span> <span data-ttu-id="6810e-161">Si noti che non viene esaminato il valore di questo attributo.</span><span class="sxs-lookup"><span data-stu-id="6810e-161">Note that it does not examine the value of this attribute.</span></span>
2.  <span data-ttu-id="6810e-162">Se [l' \_ \_ attributo dell' \_ URL \_ hardware dell'enumerazione MFT](mft-enum-hardware-url-attribute.md) è presente in entrambi MFTS, il caricatore della topologia esegue le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6810e-162">If [MFT\_ENUM\_HARDWARE\_URL\_Attribute](mft-enum-hardware-url-attribute.md) is present on both MFTs, the topology loader does the following:</span></span>
    1.  <span data-ttu-id="6810e-163">Il caricatore della topologia chiama [**IMFTransform:: GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes) sulla MFT upstream (A).</span><span class="sxs-lookup"><span data-stu-id="6810e-163">The topology loader calls [**IMFTransform::GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes) on the upstream MFT (A).</span></span> <span data-ttu-id="6810e-164">Questo metodo restituisce un puntatore [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) .</span><span class="sxs-lookup"><span data-stu-id="6810e-164">This method returns an [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer.</span></span> <span data-ttu-id="6810e-165">Lasciare che il puntatore venga indicato come *pUpstream*.</span><span class="sxs-lookup"><span data-stu-id="6810e-165">Let this pointer be denoted *pUpstream*.</span></span>
    2.  <span data-ttu-id="6810e-166">Il caricatore della topologia chiama [**IMFTransform:: GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes) nella MFT downstream (B).</span><span class="sxs-lookup"><span data-stu-id="6810e-166">The topology loader calls [**IMFTransform::GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes) on the downstream MFT (B).</span></span> <span data-ttu-id="6810e-167">Questa chiamata restituisce anche un puntatore [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) .</span><span class="sxs-lookup"><span data-stu-id="6810e-167">This call also returns an [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer.</span></span> <span data-ttu-id="6810e-168">Lasciare che il puntatore venga indicato come *pDownstream*.</span><span class="sxs-lookup"><span data-stu-id="6810e-168">Let this pointer be denoted *pDownstream*.</span></span>
    3.  <span data-ttu-id="6810e-169">Il caricatore della topologia imposta l'attributo dell' [ \_ \_ \_ attributo del flusso connesso a MFT](mft-connected-stream-attribute.md) in *PDownstream* chiamando [**IMFAttributes:: seunknown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfattributes-setunknown).</span><span class="sxs-lookup"><span data-stu-id="6810e-169">The topology loader sets the [MFT\_CONNECTED\_STREAM\_ATTRIBUTE](mft-connected-stream-attribute.md) attribute on *pDownstream* by calling [**IMFAttributes::SetUnknown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfattributes-setunknown).</span></span> <span data-ttu-id="6810e-170">Il valore dell'attributo è il puntatore *pUpstream* .</span><span class="sxs-lookup"><span data-stu-id="6810e-170">The value of the attribute is the *pUpstream* pointer.</span></span>
    4.  <span data-ttu-id="6810e-171">Il caricatore della topologia imposta il [MFT \_ connesso all'attributo del \_ \_ \_ flusso HW](mft-connected-to-hw-stream.md) su **true** sia in *pDownstream* che in *pUpstream*.</span><span class="sxs-lookup"><span data-stu-id="6810e-171">The topology loader sets the [MFT\_CONNECTED\_TO\_HW\_STREAM](mft-connected-to-hw-stream.md) attribute to **TRUE** on both *pDownstream* and *pUpstream*.</span></span>
3.  <span data-ttu-id="6810e-172">A questo punto, la MFT downstream presenta un puntatore all'archivio attributi dell'oggetto MFT upstream, come illustrato nel diagramma seguente.</span><span class="sxs-lookup"><span data-stu-id="6810e-172">At this point, the downstream MFT has a pointer to the upstream MFT's attribute store, as shown in the following diagram.</span></span>

    ![diagramma con ogni MFTS che punta al relativo flusso, ogni flusso che punta al relativo archivio e l'archivio di input con una linea tratteggiata nell'archivio di output](images/proxy-mft2.png)

    > [!Note]  
    > <span data-ttu-id="6810e-174">Per maggiore chiarezza, questo diagramma mostra i flussi e gli archivi di attributi come oggetti distinti, ma ciò non è necessario per l'implementazione.</span><span class="sxs-lookup"><span data-stu-id="6810e-174">For clarity, this diagram shows the streams and the attribute stores as distinct objects, but that is not required for the implementation.</span></span>

     

4.  <span data-ttu-id="6810e-175">La MFT downstream usa il puntatore [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) per stabilire un canale di comunicazione privato con la MFT upstream.</span><span class="sxs-lookup"><span data-stu-id="6810e-175">The downstream MFT uses the [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer to establish a private communication channel with the upstream MFT.</span></span> <span data-ttu-id="6810e-176">Poiché il canale è privato, il meccanismo esatto viene definito dall'implementazione di.</span><span class="sxs-lookup"><span data-stu-id="6810e-176">Because the channel is private, the exact mechanism is defined by the implementation.</span></span> <span data-ttu-id="6810e-177">Ad esempio, il MFT potrebbe eseguire una query per un'interfaccia COM privata.</span><span class="sxs-lookup"><span data-stu-id="6810e-177">For example, the MFT might query for a private COM interface.</span></span>

<span data-ttu-id="6810e-178">Durante il passaggio 4, l'MFT downstream deve verificare se le due MFTs condividono lo stesso dispositivo fisico.</span><span class="sxs-lookup"><span data-stu-id="6810e-178">During step 4, the downstream MFT must verify whether the two MFTs share the same physical device.</span></span> <span data-ttu-id="6810e-179">In caso contrario, devono usare la memoria di sistema per il trasporto dei dati.</span><span class="sxs-lookup"><span data-stu-id="6810e-179">If not, they must fall back to using system memory for data transport.</span></span> <span data-ttu-id="6810e-180">In questo modo, le MFT funzionano correttamente con MFTs software e altri dispositivi hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-180">This enables the MFT to operate correctly with software MFTs and other hardware devices.</span></span>

<span data-ttu-id="6810e-181">Se l'handshake ha esito positivo e le due MFTs condividono un canale dati privato, non usano il modello di elaborazione dati standard (descritto nella sezione successiva) nel punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="6810e-181">If the handshake succeeds and the two MFTs share a private data channel, they do not use the standard data processing model (described in the next section) at the connection point.</span></span> <span data-ttu-id="6810e-182">In particolare, l'MFT downstream non invia eventi [METransformNeedInput](metransformneedinput.md) ; Per ulteriori informazioni, vedere la sezione successiva in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="6810e-182">Specifically, the downstream MFT does not send [METransformNeedInput](metransformneedinput.md) events; for more details, refer to the next section in this topic.</span></span>

## <a name="data-processing"></a><span data-ttu-id="6810e-183">Elaborazione dei dati</span><span class="sxs-lookup"><span data-stu-id="6810e-183">Data Processing</span></span>

<span data-ttu-id="6810e-184">Quando una MFT hardware usa la memoria di sistema per il trasporto dei dati, il processo funziona nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="6810e-184">When a hardware MFT uses system memory for data transport, the process works as follows:</span></span>

1.  <span data-ttu-id="6810e-185">Per richiedere più input, il MFT Invia un evento [METransformNeedInput](metransformneedinput.md) .</span><span class="sxs-lookup"><span data-stu-id="6810e-185">To request more input, the MFT sends an [METransformNeedInput](metransformneedinput.md) event.</span></span>
2.  <span data-ttu-id="6810e-186">L'evento [METransformNeedInput](metransformneedinput.md) fa sì che la pipeline chiami [**IMFTransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="6810e-186">The [METransformNeedInput](metransformneedinput.md) event causes the pipeline to call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>
3.  <span data-ttu-id="6810e-187">Quando il MFT contiene dati di output, il MFT Invia un evento [METransformHaveOutput](metransformhaveoutput.md) .</span><span class="sxs-lookup"><span data-stu-id="6810e-187">When the MFT has output data, the MFT sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
4.  <span data-ttu-id="6810e-188">L'evento [METransformHaveOutput](metransformhaveoutput.md) fa sì che la pipeline chiami [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="6810e-188">The [METransformHaveOutput](metransformhaveoutput.md) event causes the pipeline to call [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="6810e-189">Per informazioni dettagliate, vedere [MFTS asincrono](asynchronous-mfts.md).</span><span class="sxs-lookup"><span data-stu-id="6810e-189">For details, refer to [Asynchronous MFTs](asynchronous-mfts.md).</span></span>

<span data-ttu-id="6810e-190">Se la MFT utilizza un canale hardware, tuttavia, questi eventi non vengono inviati al punto di connessione hardware perché tutto il trasferimento dei dati avviene internamente nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-190">If the MFT uses a hardware channel, however, it does not send these events at the hardware connection point, because all data transfer happens internally within the hardware.</span></span> <span data-ttu-id="6810e-191">Pertanto, la pipeline non chiama [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) o [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) in corrispondenza del punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="6810e-191">Therefore, the pipeline does not call [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) or [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at the connection point.</span></span>

<span data-ttu-id="6810e-192">Si consideri, ad esempio, il primo diagramma di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="6810e-192">For example, consider the first diagram in this topic.</span></span> <span data-ttu-id="6810e-193">Data questa configurazione, l'elaborazione dei dati verrebbe eseguita nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="6810e-193">Given this configuration, data processing would occur as follows:</span></span>

1.  <span data-ttu-id="6810e-194">"A" Invia [METransformNeedInput](metransformneedinput.md) ai dati della richiesta.</span><span class="sxs-lookup"><span data-stu-id="6810e-194">"A" sends [METransformNeedInput](metransformneedinput.md) to request data.</span></span>
2.  <span data-ttu-id="6810e-195">La pipeline chiama [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) su "A".</span><span class="sxs-lookup"><span data-stu-id="6810e-195">The pipeline calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) on "A".</span></span>
3.  <span data-ttu-id="6810e-196">"A" e "B" elaborano i dati nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="6810e-196">"A" and "B" process the data in hardware.</span></span>
4.  <span data-ttu-id="6810e-197">Al termine dell'elaborazione, "B" Invia un evento [METransformHaveOutput](metransformhaveoutput.md) .</span><span class="sxs-lookup"><span data-stu-id="6810e-197">When the processing is complete, "B" sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
5.  <span data-ttu-id="6810e-198">La pipeline chiama [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) su "B".</span><span class="sxs-lookup"><span data-stu-id="6810e-198">The pipeline calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) on "B".</span></span>

## <a name="paired-decoderencoder"></a><span data-ttu-id="6810e-199">Codificatore/codificatore abbinato</span><span class="sxs-lookup"><span data-stu-id="6810e-199">Paired Decoder/Encoder</span></span>

<span data-ttu-id="6810e-200">Se un codificatore e un codificatore si trovano nello stesso chip hardware, può essere preferibile utilizzarli insieme durante la transcodifica.</span><span class="sxs-lookup"><span data-stu-id="6810e-200">If a decoder and encoder are located on the same hardware chip, it may be preferable to use them together when transcoding.</span></span> <span data-ttu-id="6810e-201">In altre termini, la selezione di uno deve causare la selezione dell'altra nella pipeline di transcodifica.</span><span class="sxs-lookup"><span data-stu-id="6810e-201">That is, selecting one should cause the other to be selected in the transcoding pipeline.</span></span> <span data-ttu-id="6810e-202">Per assicurarsi che vengano scelti i codec hardware corrispondenti, sia il codec MFTs dovrebbe offrire un tipo di supporto personalizzato.</span><span class="sxs-lookup"><span data-stu-id="6810e-202">To ensure that matching hardware codecs are chosen, both codec MFTs should offer a custom media type.</span></span> <span data-ttu-id="6810e-203">Per creare un tipo di supporto personalizzato:</span><span class="sxs-lookup"><span data-stu-id="6810e-203">To create a custom media type:</span></span>

-   <span data-ttu-id="6810e-204">Impostare l'attributo di [**\_ \_ \_ tipo principale MF mt**](mf-mt-major-type-attribute.md) su **MFMediaType \_ audio** o **MFMediaType \_ video**, in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="6810e-204">Set the [**MF\_MT\_MAJOR\_TYPE**](mf-mt-major-type-attribute.md) attribute to **MFMediaType\_Audio** or **MFMediaType\_Video**, as appropriate.</span></span>
-   <span data-ttu-id="6810e-205">Impostare l'attributo del [**\_ \_ sottotipo MF mt**](mf-mt-subtype-attribute.md) su un valore GUID personalizzato.</span><span class="sxs-lookup"><span data-stu-id="6810e-205">Set the [**MF\_MT\_SUBTYPE**](mf-mt-subtype-attribute.md) attribute to a custom GUID value.</span></span>

<span data-ttu-id="6810e-206">Altri attributi di tipo sono facoltativi.</span><span class="sxs-lookup"><span data-stu-id="6810e-206">Other type attributes are optional.</span></span> <span data-ttu-id="6810e-207">Il decodificatore restituisce il tipo personalizzato dal relativo [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype)e il codificatore restituisce il tipo personalizzato dal metodo [**IMFTransform:: GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) .</span><span class="sxs-lookup"><span data-stu-id="6810e-207">The decoder returns the custom type from its [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype), and the encoder returns the custom type from its [**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) method.</span></span> <span data-ttu-id="6810e-208">In entrambi i casi, il tipo personalizzato deve essere la prima voce dell'elenco (*dwTypeIndex* = 0).</span><span class="sxs-lookup"><span data-stu-id="6810e-208">In both cases, the custom type must be the first entry in the list (*dwTypeIndex* = 0).</span></span>

<span data-ttu-id="6810e-209">Per lavorare con i codec software, il codec deve anche restituire almeno un formato standard, ad esempio NV12 per il video.</span><span class="sxs-lookup"><span data-stu-id="6810e-209">To work with software codecs, the codec should also return at least one standard format, such as NV12 for video.</span></span> <span data-ttu-id="6810e-210">I formati standard devono essere visualizzati dopo il tipo personalizzato (*dwTypeIndex* > 0).</span><span class="sxs-lookup"><span data-stu-id="6810e-210">Standard formats should appear after the custom type (*dwTypeIndex* > 0).</span></span> <span data-ttu-id="6810e-211">Se i due codec devono essere sempre abbinati e non possono interagire con i codec software, MFTs deve restituire solo il formato personalizzato e non restituire alcun formato standard.</span><span class="sxs-lookup"><span data-stu-id="6810e-211">If the two codecs must always be paired and cannot interoperate with software codecs, the MFTs should return only the custom format and not return any standard formats.</span></span>

> [!Note]  
> <span data-ttu-id="6810e-212">Se un decodificatore non restituisce formati standard, non può essere usato per la riproduzione con il [renderer video migliorato](enhanced-video-renderer.md).</span><span class="sxs-lookup"><span data-stu-id="6810e-212">If a decoder does not return any standard formats, it cannot be used for playback with the [Enhanced Video Renderer](enhanced-video-renderer.md).</span></span> <span data-ttu-id="6810e-213">In tal caso, deve essere registrato come decodificatore solo transcodifica.</span><span class="sxs-lookup"><span data-stu-id="6810e-213">In that case, it should be registered as a transcode-only decoder.</span></span> <span data-ttu-id="6810e-214">Vedere [decodificatori solo transcodificati](implementing-a-codec-mft.md).</span><span class="sxs-lookup"><span data-stu-id="6810e-214">See [Transcode-Only Decoders](implementing-a-codec-mft.md).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="6810e-215">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6810e-215">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6810e-216">Scrittura di un MFT personalizzato</span><span class="sxs-lookup"><span data-stu-id="6810e-216">Writing a Custom MFT</span></span>](writing-a-custom-mft.md)
</dt> <dt>

[<span data-ttu-id="6810e-217">Implementazione di un codec MFT</span><span class="sxs-lookup"><span data-stu-id="6810e-217">Implementing a Codec MFT</span></span>](implementing-a-codec-mft.md)
</dt> <dt>

[<span data-ttu-id="6810e-218">Trasformazioni Media Foundation</span><span class="sxs-lookup"><span data-stu-id="6810e-218">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 




