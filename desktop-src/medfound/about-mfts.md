---
description: Informazioni su MFTs
ms.assetid: ca9cef70-b897-4fd5-9a13-8bf1c2b84b00
title: Informazioni su MFTs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09adce4bc93c110cf98e4fd8ed427ffcd009c3c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103879398"
---
# <a name="about-mfts"></a><span data-ttu-id="8ea6b-103">Informazioni su MFTs</span><span class="sxs-lookup"><span data-stu-id="8ea6b-103">About MFTs</span></span>

<span data-ttu-id="8ea6b-104">Le trasformazioni Media Foundation (MFTs) forniscono un modello generico per l'elaborazione dei dati multimediali.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-104">Media Foundation transforms (MFTs) provide a generic model for processing media data.</span></span> <span data-ttu-id="8ea6b-105">MFTs vengono usati per i decodificatori, i codificatori e i processori di segnale digitale (DSP).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-105">MFTs are used for decoders, encoders, and digital signal processors (DSPs).</span></span> <span data-ttu-id="8ea6b-106">In breve, tutto ciò che si trova nella pipeline multimediale tra l'origine multimediale e il sink multimediale è un MFT.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-106">In short, anything that sits in the media pipeline between the media source and the media sink is an MFT.</span></span>

<span data-ttu-id="8ea6b-107">Per la maggior parte delle applicazioni, i dettagli dell'elaborazione dei dati MFT sono nascosti da livelli più elevati dell'architettura Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-107">For most applications, the details of MFT data processing are hidden by higher layers of the Media Foundation architecture.</span></span> <span data-ttu-id="8ea6b-108">Molte applicazioni Media Foundation non effettueranno mai una chiamata diretta a un MFT.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-108">Many Media Foundation applications will never make a direct call to an MFT.</span></span> <span data-ttu-id="8ea6b-109">Tuttavia, è certamente possibile ospitare un MFT direttamente nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-109">However, it is certainly possible to host an MFT directly in your application.</span></span>

<span data-ttu-id="8ea6b-110">MFTs sono un'evoluzione del modello Transform introdotto per la prima volta con DirectX Media Objects (DMOs).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-110">MFTs are an evolution of the transform model first introduced with DirectX Media Objects (DMOs).</span></span> <span data-ttu-id="8ea6b-111">Di fatto, è relativamente facile creare una trasformazione che supporti entrambi i modelli.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-111">In fact, it is relatively easy to create a transform that supports both models.</span></span> <span data-ttu-id="8ea6b-112">Rispetto a DMOs, i comportamenti necessari di MFTs sono specificati in modo più chiaro, semplificando la scrittura di un'implementazione corretta.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-112">Compared with DMOs, the required behaviors of MFTs are more clearly specified, which makes it easier to write a correct implementation.</span></span> <span data-ttu-id="8ea6b-113">Inoltre, MFTs può supportare l'elaborazione video con accelerazione hardware.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-113">In addition, MFTs can support hardware-accelerated video processing.</span></span>

<span data-ttu-id="8ea6b-114">In questo argomento viene illustrata una breve panoramica del modello di elaborazione MFT, che si concentra sulla progettazione complessiva anziché sulle chiamate di metodo specifiche.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-114">This topic gives a brief overview of the MFT processing model, focusing on the overall design rather than specific method calls.</span></span> <span data-ttu-id="8ea6b-115">Per una descrizione dettagliata, vedere [modello di elaborazione MFT di base](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-115">For a more detailed, step-by-step description, see [Basic MFT Processing Model](basic-mft-processing-model.md).</span></span>

## <a name="streams"></a><span data-ttu-id="8ea6b-116">Flussi</span><span class="sxs-lookup"><span data-stu-id="8ea6b-116">Streams</span></span>

<span data-ttu-id="8ea6b-117">Un MFT presenta flussi di input e flussi di output.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-117">An MFT has input streams and output streams.</span></span> <span data-ttu-id="8ea6b-118">I flussi di input ricevono i dati e i flussi di output producono dati.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-118">Input streams receive data, and output streams produce data.</span></span> <span data-ttu-id="8ea6b-119">Ad esempio, un decodificatore ha un flusso di input, che riceve i dati codificati e un flusso di output, che produce i dati decodificati.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-119">For example, a decoder has one input stream, which receives the encoded data, and one output stream, which produces the decoded data.</span></span>

<span data-ttu-id="8ea6b-120">I flussi in un MFT non sono rappresentati come oggetti COM distinti.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-120">The streams on an MFT are not represented as distinct COM objects.</span></span> <span data-ttu-id="8ea6b-121">Al contrario, ogni flusso ha un identificatore di flusso designato e i metodi nell'interfaccia [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) accettano gli identificatori di flusso come parametri di input.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-121">Instead, each stream has a designated stream identifier, and the methods in the [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface take stream identifiers as input parameters.</span></span>

<span data-ttu-id="8ea6b-122">Alcuni MFTs hanno un numero fisso di flussi.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-122">Some MFTs have a fixed number of streams.</span></span> <span data-ttu-id="8ea6b-123">Ad esempio, i decodificatori e i codificatori hanno in genere esattamente un input e un output.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-123">For example, decoders and encoders normally have exactly one input and one output.</span></span> <span data-ttu-id="8ea6b-124">Altri MFTs hanno un numero dinamico di flussi.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-124">Other MFTs have a dynamic number of streams.</span></span> <span data-ttu-id="8ea6b-125">Se una MFT supporta flussi dinamici, il client può aggiungere nuovi flussi di input.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-125">If an MFT supports dynamic streams, the client can add new input streams.</span></span> <span data-ttu-id="8ea6b-126">Il client non può aggiungere flussi di output, ma MFT potrebbe aggiungere o rimuovere i flussi di output durante l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-126">The client cannot add output streams, but the MFT might add or remove output streams during processing.</span></span> <span data-ttu-id="8ea6b-127">Ad esempio, i multiplexer consentono in genere al client di aggiungere flussi di input e avere un output per il flusso multiplexato.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-127">For example, multiplexers typically allow the client to add input streams and have one output for the multiplexed stream.</span></span> <span data-ttu-id="8ea6b-128">I Demultiplexer sono l'inverso, con un input ma un numero dinamico di flussi di output, a seconda del contenuto del flusso di input.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-128">Demultiplexers are the reverse, with one input but a dynamic number of output streams, depending on the contents of the input stream.</span></span> <span data-ttu-id="8ea6b-129">Nella figura seguente viene illustrata la differenza tra multiplexer e Demultiplexer.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-129">The following illustration shows the difference between multiplexer and demultiplexer.</span></span>

![diagramma che mostra un codificatore/decodificatore (1 input, 1 output), un multiplexer (2 input, 1 output) e un Demultiplexer (1 input, 2 output)](images/f2b95bd5-f862-4d66-9d75-550a90f6cc97.gif)

## <a name="media-types"></a><span data-ttu-id="8ea6b-131">Tipi di supporto</span><span class="sxs-lookup"><span data-stu-id="8ea6b-131">Media Types</span></span>

<span data-ttu-id="8ea6b-132">Quando viene creata una MFT, nessuno dei flussi ha un formato consolidato.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-132">When an MFT is first created, none of the streams has an established format.</span></span> <span data-ttu-id="8ea6b-133">Prima che il MFT possa elaborare i dati, il client deve impostare i formati per i flussi.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-133">Before the MFT can process data, the client must set the formats for the streams.</span></span> <span data-ttu-id="8ea6b-134">Con un decodificatore, ad esempio, il formato di input è il formato di compressione usato nel file di origine originale e il formato di output è un formato non compresso, ad esempio audio PCM o video RGB.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-134">For example, with a decoder, the input format is the compression format used in the original source file, and the output format is an uncompressed format, such as PCM audio or RGB video.</span></span> <span data-ttu-id="8ea6b-135">I formati dei flussi vengono descritti utilizzando i [tipi di supporto](media-types.md).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-135">The stream formats are described using [Media Types](media-types.md).</span></span>

<span data-ttu-id="8ea6b-136">A seconda dello stato interno della MFT, potrebbe fornire un elenco di tipi di supporti possibili per ogni flusso.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-136">Depending on the internal state of the MFT, it might provide a list of possible media types for each stream.</span></span> <span data-ttu-id="8ea6b-137">È possibile utilizzare questo elenco come hint quando si impostano i tipi di supporto.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-137">You can use this list as a hint when you set the media types.</span></span> <span data-ttu-id="8ea6b-138">Impostando il tipo di supporto in un flusso, è possibile modificare l'elenco dei tipi possibili per un altro flusso.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-138">Setting the media type on one stream can change the list of possible types for a another stream.</span></span> <span data-ttu-id="8ea6b-139">Un decodificatore, ad esempio, non può in genere fornire tipi di output fino a quando il client non imposta il tipo di input.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-139">For example, a decoder typically cannot provide any output types until the client sets the input type.</span></span> <span data-ttu-id="8ea6b-140">Il tipo di input contiene le informazioni necessarie al decodificatore per restituire un elenco di tipi di output possibili.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-140">The input type contains the information that the decoder needs to return a list of possible output types.</span></span>

<span data-ttu-id="8ea6b-141">Per impostare il tipo di supporto in un flusso, chiamare [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) o [**IMFTransform:: SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-141">To set the media type on a stream, call [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) or [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span> <span data-ttu-id="8ea6b-142">Per ottenere l'elenco dei tipi di supporti possibili per un flusso, chiamare [**IMFTransform:: GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) o [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-142">To get the list of possible media types for a stream, call [**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) or [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span></span>

## <a name="processing-data"></a><span data-ttu-id="8ea6b-143">Elaborazione dei dati</span><span class="sxs-lookup"><span data-stu-id="8ea6b-143">Processing Data</span></span>

<span data-ttu-id="8ea6b-144">Quando il client imposta i tipi di supporto nei flussi, il file MFT è pronto per l'elaborazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-144">After the client sets the media types on the streams, the MFT is ready to process data.</span></span> <span data-ttu-id="8ea6b-145">A tale proposito, il client alterna la fornitura di dati di input alla MFT e la ricezione dei dati di output dalla MFT:</span><span class="sxs-lookup"><span data-stu-id="8ea6b-145">To make this happen, the client alternates between providing input data to the MFT and getting output data from the MFT:</span></span>

-   <span data-ttu-id="8ea6b-146">Per assegnare i dati di input a MFT, chiamare [**IMFTransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-146">To give input data to the MFT, call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>
-   <span data-ttu-id="8ea6b-147">Per eseguire il pull dei dati di output dalla MFT, chiamare [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-147">To pull output data from the MFT, call [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="8ea6b-148">Il metodo [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) accetta un puntatore a un esempio multimediale allocato dal client.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-148">The [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) method takes a pointer to a media sample allocated by the client.</span></span> <span data-ttu-id="8ea6b-149">L'esempio multimediale contiene uno o più buffer e ogni buffer contiene i dati di input per l'elaborazione di MFT.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-149">The media sample contains one or more buffers, and each buffer contains input data for the MFT to process.</span></span>

<span data-ttu-id="8ea6b-150">Il metodo [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) supporta due modelli di allocazione diversi: il MFT alloca i buffer di output o il client alloca i buffer di output.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-150">The [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method supports two different allocation models: Either the MFT allocates the output buffers, or the client allocates the output buffers.</span></span> <span data-ttu-id="8ea6b-151">Alcuni MFTs supportano entrambi i modelli di allocazione, ma non è necessario che un MFT supporti entrambi.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-151">Some MFTs support both allocation models, but it is not required for an MFT to support both.</span></span> <span data-ttu-id="8ea6b-152">Ad esempio, un MFT potrebbe richiedere al client di allocare i buffer di output.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-152">For example, an MFT might require the client to allocate the output buffers.</span></span> <span data-ttu-id="8ea6b-153">Il metodo [**IMFTransform:: GetOutputStreamInfo**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreaminfo) restituisce informazioni su un flusso di output, incluso il modello di allocazione supportato da MFT.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-153">The [**IMFTransform::GetOutputStreamInfo**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreaminfo) method returns information about an output stream, including which allocation model the MFT supports.</span></span>

<span data-ttu-id="8ea6b-154">MFTs sono progettati per memorizzare nel buffer il minor quantità possibile di dati, in modo da ridurre al minimo la latenza nella pipeline.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-154">MFTs are designed to buffer as little data as possible, in order to minimize latency in the pipeline.</span></span> <span data-ttu-id="8ea6b-155">Pertanto, in un determinato momento, la MFT può segnalare una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8ea6b-155">Therefore, at any given time, the MFT can signal one of the following conditions:</span></span>

-   <span data-ttu-id="8ea6b-156">Il MFT richiede più dati di input.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-156">The MFT requires more input data.</span></span> <span data-ttu-id="8ea6b-157">In questo stato, il MFT non può produrre output finché il client non chiama [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) almeno una volta.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-157">In this state, the MFT cannot produce output until the client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) at least once.</span></span>
-   <span data-ttu-id="8ea6b-158">In MFT non verrà accettato alcun input finché il client non chiamerà [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) almeno una volta.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-158">The MFT will not accept any more input until the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at least once.</span></span>

<span data-ttu-id="8ea6b-159">Si supponga, ad esempio, di usare un decodificatore video per decodificare un flusso video che contiene una combinazione di fotogrammi chiave e frame Delta.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-159">For example, suppose that you are using a video decoder to decode a video stream that contains a mix of key frames and delta frames.</span></span> <span data-ttu-id="8ea6b-160">Inizialmente, il MFT richiede un input prima di poter decodificare eventuali frame.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-160">Initially, the MFT requires some input before it can decode any frames.</span></span> <span data-ttu-id="8ea6b-161">Il client chiama [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) per recapitare il primo frame.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-161">The client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) to deliver the first frame.</span></span> <span data-ttu-id="8ea6b-162">Si supponga che il primo frame sia un frame Delta, illustrato nel diagramma seguente come "P" per il frame stimato.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-162">Suppose that the first frame is a delta frame (shown in the following diagram as 'P' for predicted frame).</span></span> <span data-ttu-id="8ea6b-163">Il decodificatore utilizza questo frame, ma non può produrre alcun output finché non ottiene il fotogramma chiave successivo.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-163">The decoder holds onto this frame, but it cannot produce any output until it gets the next key frame.</span></span>

![diagramma che mostra il MFT che necessita di input, che punta a un frame stimato](images/f5a88ac6-24da-40e5-b356-649aa6f811c3.gif)

<span data-ttu-id="8ea6b-165">Il client continua a chiamare [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) e infine raggiunge il fotogramma chiave successivo, illustrato nel diagramma seguente come ' I ' per il frame intra-codificato.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-165">The client continues to call [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and eventually reaches the next key frame (shown in the next diagram as 'I' for intra-coded frame).</span></span> <span data-ttu-id="8ea6b-166">Il decodificatore dispone ora di un numero sufficiente di frame per iniziare la decodifica.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-166">Now the decoder has enough frames to start decoding.</span></span> <span data-ttu-id="8ea6b-167">A questo punto interrompe l'accettazione dell'input e il client deve chiamare [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) per ottenere i frame decodificati.</span><span class="sxs-lookup"><span data-stu-id="8ea6b-167">At this point it stops accepting input, and the client must call [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) to get the decoded frames.</span></span>

![diagramma che mostra un MFT che non accetta input, puntando a un frame intra-codificato e a tre frame stimati](images/ae014a1a-9d03-4cfa-a04d-4a63bdc83f73.gif)

<span data-ttu-id="8ea6b-169">L'approccio più semplice per il client è semplicemente quello di effettuare chiamate alternative a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) e [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-169">The simplest approach for the client is simply to alternate calls to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span> <span data-ttu-id="8ea6b-170">Un algoritmo più sofisticato è descritto nell'argomento [modello di elaborazione MFT di base](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="8ea6b-170">A more sophisticated algorithm is described in the topic [Basic MFT Processing Model](basic-mft-processing-model.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8ea6b-171">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8ea6b-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8ea6b-172">Trasformazioni Media Foundation</span><span class="sxs-lookup"><span data-stu-id="8ea6b-172">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 



