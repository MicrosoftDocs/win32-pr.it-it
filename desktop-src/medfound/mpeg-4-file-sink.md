---
description: Il sink di file MPEG-4 crea file MP4.
ms.assetid: 069b8e72-d081-466e-ac8d-c3f81c8a6f35
title: Sink di file MPEG-4
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6c27517463bca7dfa88fdbc09d77f7a6512c896d
ms.sourcegitcommit: 9c8ddec1e955f181beecad0478c1fb79013b5e9d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/21/2021
ms.locfileid: "106320070"
---
# <a name="mpeg-4-file-sink"></a><span data-ttu-id="209f1-103">Sink di file MPEG-4</span><span class="sxs-lookup"><span data-stu-id="209f1-103">MPEG-4 File Sink</span></span>

<span data-ttu-id="209f1-104">Il sink di file MPEG-4 crea file MP4.</span><span class="sxs-lookup"><span data-stu-id="209f1-104">The MPEG-4 file sink creates MP4 files.</span></span> <span data-ttu-id="209f1-105">Per ulteriori informazioni sul formato di file MP4, vedere i documenti standard seguenti:</span><span class="sxs-lookup"><span data-stu-id="209f1-105">For more information about the MP4 file format, refer to the following standards documents:</span></span>

-   <span data-ttu-id="209f1-106">ISO/IEC 14496-12: *Information Technology--codifica di oggetti visivi audio--parte 12: formato del file multimediale di base ISO*</span><span class="sxs-lookup"><span data-stu-id="209f1-106">ISO/IEC 14496-12: *Information technology -- Coding of audio-visual objects -- Part 12: ISO Base Media File Format*</span></span>
-   <span data-ttu-id="209f1-107">ISO/IEC 14496-14: *Information Technology--codifica di oggetti visivi audio--parte 14: formato file MP4*</span><span class="sxs-lookup"><span data-stu-id="209f1-107">ISO/IEC 14496-14: *Information technology -- Coding of audio-visual objects -- Part 14: MP4 File Format*</span></span>

> [!Note]  
> <span data-ttu-id="209f1-108">Queste risorse potrebbero non essere disponibili in alcune lingue e paesi.</span><span class="sxs-lookup"><span data-stu-id="209f1-108">(These resources may not be available in some languages and countries.)</span></span>

 

<span data-ttu-id="209f1-109">Il sink di file MPEG-4 non incapsula la funzionalità di codifica.</span><span class="sxs-lookup"><span data-stu-id="209f1-109">The MPEG-4 file sink does not encapsulate encoding functionality.</span></span>

<span data-ttu-id="209f1-110">Per creare il sink di file MPEG-4, chiamare la funzione [**MFCreateMPEG4MediaSink**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatempeg4mediasink) .</span><span class="sxs-lookup"><span data-stu-id="209f1-110">To create the MPEG-4 file sink, call the [**MFCreateMPEG4MediaSink**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatempeg4mediasink) function.</span></span> <span data-ttu-id="209f1-111">Il sink di file MPEG-4 espone le interfacce seguenti tramite **QueryInterface**:</span><span class="sxs-lookup"><span data-stu-id="209f1-111">The MPEG-4 file sink exposes the following interfaces through **QueryInterface**:</span></span>

-   [<span data-ttu-id="209f1-112">**IMFClockStateSink**</span><span class="sxs-lookup"><span data-stu-id="209f1-112">**IMFClockStateSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink)
-   [<span data-ttu-id="209f1-113">**IMFFinalizableMediaSink**</span><span class="sxs-lookup"><span data-stu-id="209f1-113">**IMFFinalizableMediaSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imffinalizablemediasink)
-   [<span data-ttu-id="209f1-114">**IMFGetService**</span><span class="sxs-lookup"><span data-stu-id="209f1-114">**IMFGetService**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)
-   [<span data-ttu-id="209f1-115">**IMFMediaEventGenerator**</span><span class="sxs-lookup"><span data-stu-id="209f1-115">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)
-   [<span data-ttu-id="209f1-116">**IMFMediaSink**</span><span class="sxs-lookup"><span data-stu-id="209f1-116">**IMFMediaSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink)

## <a name="sample-description-box"></a><span data-ttu-id="209f1-117">Casella Descrizione esempio</span><span class="sxs-lookup"><span data-stu-id="209f1-117">Sample Description Box</span></span>

<span data-ttu-id="209f1-118">MP4 è un formato di contenitore estensibile.</span><span class="sxs-lookup"><span data-stu-id="209f1-118">MP4 is an extensible container format.</span></span> <span data-ttu-id="209f1-119">La specifica MP4 non definisce una struttura fissa per la descrizione dei tipi di supporto in un contenitore MP4.</span><span class="sxs-lookup"><span data-stu-id="209f1-119">The MP4 specification does not define a fixed structure for describing media types in an MP4 container.</span></span> <span data-ttu-id="209f1-120">Definisce invece una gerarchia di oggetti che consente di definire strutture personalizzate per ogni formato.</span><span class="sxs-lookup"><span data-stu-id="209f1-120">Instead, it defines an object hierarchy that allows custom structures to be defined for each format.</span></span> <span data-ttu-id="209f1-121">La descrizione del formato viene archiviata nella casella Descrizione esempio (' STSD ') per ogni flusso.</span><span class="sxs-lookup"><span data-stu-id="209f1-121">The format description is stored in the sample description ('stsd') box for each stream.</span></span> <span data-ttu-id="209f1-122">Nella casella Descrizione esempio è incluso un elenco di voci di esempio.</span><span class="sxs-lookup"><span data-stu-id="209f1-122">The sample description box contains a list of sample entries.</span></span> <span data-ttu-id="209f1-123">Per ogni voce di esempio, un codice a 4 byte, simile a un FOURCC, definisce la struttura del formato.</span><span class="sxs-lookup"><span data-stu-id="209f1-123">For each sample entry, a 4-byte code, similar to a FOURCC, defines the format structure.</span></span>

<span data-ttu-id="209f1-124">Il sink di file MPEG-4 può generare la casella Descrizione esempio per i formati seguenti:</span><span class="sxs-lookup"><span data-stu-id="209f1-124">The MPEG-4 File Sink can generate the sample description box for the following formats:</span></span>

-   <span data-ttu-id="209f1-125">Video H. 264/AVC</span><span class="sxs-lookup"><span data-stu-id="209f1-125">H.264/AVC video</span></span>
-   <span data-ttu-id="209f1-126">Audio AAC</span><span class="sxs-lookup"><span data-stu-id="209f1-126">AAC audio</span></span>
-   <span data-ttu-id="209f1-127">Audio MP3</span><span class="sxs-lookup"><span data-stu-id="209f1-127">MP3 audio</span></span>

<span data-ttu-id="209f1-128">Per gli altri formati, è necessario specificare la casella Descrizione esempio nel tipo di supporto per ogni flusso.</span><span class="sxs-lookup"><span data-stu-id="209f1-128">For other formats, the sample description box must be provided in the media type for each stream.</span></span> <span data-ttu-id="209f1-129">Per specificare la casella Descrizione esempio, impostare i seguenti attributi sul tipo di supporto:</span><span class="sxs-lookup"><span data-stu-id="209f1-129">To specify the sample description box, set the following attributes on the media type:</span></span>



| <span data-ttu-id="209f1-130">Attributo</span><span class="sxs-lookup"><span data-stu-id="209f1-130">Attribute</span></span>                                                                     | <span data-ttu-id="209f1-131">Descrizione</span><span class="sxs-lookup"><span data-stu-id="209f1-131">Description</span></span>                                                                                                                                                   |
|-------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="209f1-132">\_Descrizione dell'esempio MF mt \_ MPEG4 \_ \_</span><span class="sxs-lookup"><span data-stu-id="209f1-132">MF\_MT\_MPEG4\_SAMPLE\_DESCRIPTION</span></span>](mf-mt-mpeg4-sample-description.md)      | <span data-ttu-id="209f1-133">Contiene la casella Descrizione esempio come BLOB binario.</span><span class="sxs-lookup"><span data-stu-id="209f1-133">Contains the sample description box as a binary blob.</span></span>                                                                                                         |
| [<span data-ttu-id="209f1-134">\_Voce di \_ \_ esempio corrente \_ MF mt MPEG4 \_</span><span class="sxs-lookup"><span data-stu-id="209f1-134">MF\_MT\_MPEG4\_CURRENT\_SAMPLE\_ENTRY</span></span>](mf-mt-mpeg4-current-sample-entry.md) | <span data-ttu-id="209f1-135">Specifica quale delle voci di esempio nella casella Descrizione esempio è attualmente attiva.</span><span class="sxs-lookup"><span data-stu-id="209f1-135">Specifies which of the sample entries in the sample description box is currently active.</span></span> <span data-ttu-id="209f1-136">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="209f1-136">(Optional.)</span></span><br/> <span data-ttu-id="209f1-137">Attualmente, il valore deve essere zero.</span><span class="sxs-lookup"><span data-stu-id="209f1-137">Currently, the value must be zero.</span></span><br/> |



 

<span data-ttu-id="209f1-138">In alcuni casi, non è possibile generare una casella Descrizione di esempio finché tutti i dati non sono stati codificati.</span><span class="sxs-lookup"><span data-stu-id="209f1-138">In some cases, it is not possible to generate a sample description box until all of the data has been encoded.</span></span> <span data-ttu-id="209f1-139">Ad esempio, le informazioni come la velocità in bit media potrebbero non essere note in anticipo.</span><span class="sxs-lookup"><span data-stu-id="209f1-139">For example, information such as the average bit rate might not be known ahead of time.</span></span> <span data-ttu-id="209f1-140">In tal caso, è possibile aggiornare il tipo di supporto usando l'interfaccia [**IMFMediaTypeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfmediatypehandler) nel sink di file MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="209f1-140">In that case, you can update the media type by using the [**IMFMediaTypeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfmediatypehandler) interface on the MPEG-4 file sink.</span></span> <span data-ttu-id="209f1-141">Questa operazione deve essere eseguita prima della finalizzazione del sink multimediale.</span><span class="sxs-lookup"><span data-stu-id="209f1-141">This must be done before the media sink is finalized.</span></span>

<span data-ttu-id="209f1-142">Il tipo di supporto viene in genere creato da un codificatore upstream.</span><span class="sxs-lookup"><span data-stu-id="209f1-142">Typically the media type is created by an upstream encoder.</span></span> <span data-ttu-id="209f1-143">Il codificatore può generare un nuovo tipo di supporto durante lo streaming, tramite una modifica di formato dinamico.</span><span class="sxs-lookup"><span data-stu-id="209f1-143">The encoder can generate a new media type during streaming, through a dynamic format change.</span></span> <span data-ttu-id="209f1-144">Per altre informazioni, vedere [Dynamic Format Changes](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="209f1-144">For more information, see [Dynamic Format Changes](basic-mft-processing-model.md).</span></span>

## <a name="h264avc-video"></a><span data-ttu-id="209f1-145">Video H. 264/AVC</span><span class="sxs-lookup"><span data-stu-id="209f1-145">H.264/AVC Video</span></span>

<span data-ttu-id="209f1-146">Il sink di file MPEG-4 supporta la versione del flusso AVC che dispone di un flusso video elementare, con il set di parametri di sequenza (SPS) e il set di parametri immagine (PPS) NALUs contenuti nella casella Descrizione esempio, come definito in ISO/IEC 14496 parte 15 sezione 5,1.</span><span class="sxs-lookup"><span data-stu-id="209f1-146">The MPEG-4 file sink supports the version of the AVC stream that has an elementary video stream, with sequence parameter set (SPS) and picture parameter set (PPS) NALUs contained in the sample description box, as defined in ISO/IEC 14496 part 15 section 5.1.</span></span> <span data-ttu-id="209f1-147">Il sink di file non supporta il metodo alternativo di archiviazione di SPS/PPS NALUs come flusso elementare del set di parametri separato.</span><span class="sxs-lookup"><span data-stu-id="209f1-147">The file sink does not support the alternate method of storing SPS/PPS NALUs as a separate parameter-set elementary stream.</span></span>

<span data-ttu-id="209f1-148">Il sink di file MPEG-4 può generare la casella Descrizione dell'esempio, ma deve essere fornita con la NALUs SPS e PPS.</span><span class="sxs-lookup"><span data-stu-id="209f1-148">The MPEG-4 file sink can generate the sample description box, but must be provided with the SPS and PPS NALUs.</span></span> <span data-ttu-id="209f1-149">Specificare queste informazioni nel tipo di supporto impostando l'attributo di [**\_ intestazione della sequenza MF mt \_ MPEG \_ \_**](mf-mt-mpeg-sequence-header-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="209f1-149">Specify this information in the media type by setting the [**MF\_MT\_MPEG\_SEQUENCE\_HEADER**](mf-mt-mpeg-sequence-header-attribute.md) attribute.</span></span> <span data-ttu-id="209f1-150">Il valore dell'attributo è l'intestazione della sequenza H. 264.</span><span class="sxs-lookup"><span data-stu-id="209f1-150">The value of the attribute is the H.264 sequence header.</span></span> <span data-ttu-id="209f1-151">L'intestazione della sequenza deve essere costituita dalle NALUs SPS e PPS delimitate da codici iniziali a 3 o a 4 byte.</span><span class="sxs-lookup"><span data-stu-id="209f1-151">The sequence header must consist of the SPS and PPS NALUs delimited by either 3-byte or 4-byte start codes.</span></span>

<span data-ttu-id="209f1-152">Facoltativamente, quando si configura il sink di file, è possibile omettere l'attributo di [**\_ intestazione di sequenza MF mt \_ MPEG \_ \_**](mf-mt-mpeg-sequence-header-attribute.md) dal tipo di supporto iniziale.</span><span class="sxs-lookup"><span data-stu-id="209f1-152">Optionally, when you configure the file sink, you can omit the [**MF\_MT\_MPEG\_SEQUENCE\_HEADER**](mf-mt-mpeg-sequence-header-attribute.md) attribute from the initial media type.</span></span> <span data-ttu-id="209f1-153">In tal caso, è necessario aggiornare il tipo di supporto in un secondo momento per includere l'intestazione della sequenza.</span><span class="sxs-lookup"><span data-stu-id="209f1-153">In that case, you must update the media type later to include the sequence header.</span></span>

<span data-ttu-id="209f1-154">Il sink di file MPEG-4 presenta i requisiti seguenti per i Bitstream AVC:</span><span class="sxs-lookup"><span data-stu-id="209f1-154">The MPEG-4 file sink has the following requirements for AVC bitstreams:</span></span>

-   <span data-ttu-id="209f1-155">Il Bitstream deve essere conforme alla specifica del formato H. 264 Annex B.</span><span class="sxs-lookup"><span data-stu-id="209f1-155">The bitstream must conform to the H.264 Annex B format specification.</span></span> <span data-ttu-id="209f1-156">In particolare, NALUs deve essere delimitato da codici iniziali a 3 o a 4 byte.</span><span class="sxs-lookup"><span data-stu-id="209f1-156">In particular, NALUs must be delimited with either 3-byte or 4-byte start codes.</span></span>
-   <span data-ttu-id="209f1-157">Gli esempi di supporti devono contenere tutti i NALUs di sezione e dati che corrispondono a una singola ora di presentazione.</span><span class="sxs-lookup"><span data-stu-id="209f1-157">Media samples must contain all slice and data NALUs that correspond to a single presentation time.</span></span>
-   <span data-ttu-id="209f1-158">Quando si scrivono fotogrammi B in un file MP4, è necessario impostare sia il timestamp di presentazione che il timestamp di decodifica.</span><span class="sxs-lookup"><span data-stu-id="209f1-158">When writing B-frames into an MP4 file, you must set both the presentation time stamp and the decode time stamp.</span></span> <span data-ttu-id="209f1-159">Se il flusso ha un frame B e il timestamp di decodifica non è impostato, il writer MP4 visualizzerà il tempo del fotogramma indietro e ridurrà il frame.</span><span class="sxs-lookup"><span data-stu-id="209f1-159">If stream has a B frame and the decode timestamp is not set, the MP4 writer will see the frame time going backwards and will drop the frame.</span></span> 

## <a name="aac-audio"></a><span data-ttu-id="209f1-160">Audio ACC</span><span class="sxs-lookup"><span data-stu-id="209f1-160">AAC Audio</span></span>

<span data-ttu-id="209f1-161">Per l'audio AAC, il sink di file MPEG-4 può generare la casella Descrizione esempio per i sottotipi seguenti:</span><span class="sxs-lookup"><span data-stu-id="209f1-161">For AAC audio, the MPEG-4 file sink can generate the sample description box for the following subtypes:</span></span>

-   <span data-ttu-id="209f1-162">**MFAudioFormat \_ AAC**</span><span class="sxs-lookup"><span data-stu-id="209f1-162">**MFAudioFormat\_AAC**</span></span>
-   <span data-ttu-id="209f1-163">**MEDIASUBTYPE \_ RAW \_ AAC1**</span><span class="sxs-lookup"><span data-stu-id="209f1-163">**MEDIASUBTYPE\_RAW\_AAC1**</span></span>

<span data-ttu-id="209f1-164">Per ulteriori informazioni su questi substypes, vedere [AAC media types](aac-media-types.md).</span><span class="sxs-lookup"><span data-stu-id="209f1-164">For more information about these substypes, see [AAC Media Types](aac-media-types.md).</span></span>

<span data-ttu-id="209f1-165">Per il sottotipo **\_ AAC MFAudioFormat** , il tipo di supporto contiene facoltativamente l'attributo [**\_ \_ \_ dati utente MF mt**](mf-mt-user-data-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="209f1-165">For the **MFAudioFormat\_AAC** subtype, the media type optionally contains the [**MF\_MT\_USER\_DATA**](mf-mt-user-data-attribute.md) attribute.</span></span> <span data-ttu-id="209f1-166">Se presente, questo attributo indica la parte della struttura [**HEAACWAVEINFO**](/windows/win32/api/mmreg/ns-mmreg-heaacwaveinfo) visualizzata dopo la struttura **WAVEFORMATEX** (ovvero dopo il membro **wfx** ).</span><span class="sxs-lookup"><span data-stu-id="209f1-166">If present, this attribute the portion of the [**HEAACWAVEINFO**](/windows/win32/api/mmreg/ns-mmreg-heaacwaveinfo) structure that appears after the **WAVEFORMATEX** structure (that is, after the **wfx** member).</span></span> <span data-ttu-id="209f1-167">Questa operazione è seguita dai dati di AudioSpecificConfig (), definiti da ISO/IEC 14496-3.</span><span class="sxs-lookup"><span data-stu-id="209f1-167">This is followed by the AudioSpecificConfig() data, as defined by ISO/IEC 14496-3.</span></span> <span data-ttu-id="209f1-168">Se l' **attributo \_ \_ \_ dei dati utente MF mt** non è presente, si presuppone che il flusso sia un profilo con complessità AAC (LC) e che il sink di file MPEG-4 generi una casella di descrizione di esempio appropriata.</span><span class="sxs-lookup"><span data-stu-id="209f1-168">If the **MF\_MT\_USER\_DATA** attribute is not present, the stream is assumed to be AAC Low Complexity (LC) profile, and the MPEG-4 file sink generates a suitable sample description box.</span></span>

<span data-ttu-id="209f1-169">Per il sottotipo **MEDIASUBTYPE \_ RAW \_ AAC1** , il sink multimediale deve contenere l' [**attributo \_ \_ \_ dati utente MF mt**](mf-mt-user-data-attribute.md) e l'attributo deve contenere i dati AudioSpecificConfig ().</span><span class="sxs-lookup"><span data-stu-id="209f1-169">For the **MEDIASUBTYPE\_RAW\_AAC1** subtype, the media sink must contain the [**MF\_MT\_USER\_DATA**](mf-mt-user-data-attribute.md) attribute, and the attribute must contain the AudioSpecificConfig() data.</span></span>

<span data-ttu-id="209f1-170">Il sink di file MPEG-4 crea la variante MPEG-4 della casella della descrizione dell'esempio AAC, usando una voce di esempio ' mp4a ' con objectTypeIndication = 0x40.</span><span class="sxs-lookup"><span data-stu-id="209f1-170">The MPEG-4 file sink creates the MPEG-4 variant of the AAC sample description box, using an 'mp4a' sample entry with objectTypeIndication = 0x40.</span></span> <span data-ttu-id="209f1-171">Non usa i tipi di oggetto MPEG-2.</span><span class="sxs-lookup"><span data-stu-id="209f1-171">It does not use MPEG-2 object types.</span></span>

## <a name="mp3-audio"></a><span data-ttu-id="209f1-172">Audio MP3</span><span class="sxs-lookup"><span data-stu-id="209f1-172">MP3 Audio</span></span>

<span data-ttu-id="209f1-173">Per l'audio MP3, il sink di file MPEG-4 può generare la casella Descrizione esempio da un tipo di supporto audio standard.</span><span class="sxs-lookup"><span data-stu-id="209f1-173">For MP3 audio, the MPEG-4 file sink can generate the sample description box from a standard audio media type.</span></span> <span data-ttu-id="209f1-174">Vedere [tipi di supporti audio](audio-media-types.md).</span><span class="sxs-lookup"><span data-stu-id="209f1-174">(See [Audio Media Types](audio-media-types.md).)</span></span>

<span data-ttu-id="209f1-175">Il sink di file MPEG-4 crea la variante MPEG-4 della casella Descrizione di esempio MP3, usando una voce di esempio "mp4a" con objectTypeIndication = 0x6B per l'audio MPEG-1.</span><span class="sxs-lookup"><span data-stu-id="209f1-175">The MPEG-4 file sink creates the MPEG-4 variant of the MP3 sample description box, using an 'mp4a' sample entry with objectTypeIndication = 0x6b for MPEG-1 audio.</span></span>

## <a name="limitations"></a><span data-ttu-id="209f1-176">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="209f1-176">Limitations</span></span>

-   <span data-ttu-id="209f1-177">La dimensione massima del file creato è 4 GB.</span><span class="sxs-lookup"><span data-stu-id="209f1-177">The maximum size of the authored file is 4 GB.</span></span> <span data-ttu-id="209f1-178">In Windows 8 sono supportati i file di dimensioni maggiori di 4 GBGB.</span><span class="sxs-lookup"><span data-stu-id="209f1-178">In Windows 8, files large than 4 GBGB are supported.</span></span>
-   <span data-ttu-id="209f1-179">Il sink di file MPEG-4 non supporta gli elenchi di modifica (caselle ' Edts ' è Elst ').</span><span class="sxs-lookup"><span data-stu-id="209f1-179">The MPEG-4 file sink does not support edit lists ('edts' and 'elst' boxes).</span></span>

## <a name="windows-8-updates-to-mpeg-4-source-and-sink"></a><span data-ttu-id="209f1-180">Aggiornamenti di Windows 8 per l'origine e il sink MPEG-4</span><span class="sxs-lookup"><span data-stu-id="209f1-180">Windows 8 updates to MPEG-4 source and sink</span></span>

-   <span data-ttu-id="209f1-181">Supporto di lettura e scrittura della rotazione aggiunto in Windows 8 MPEG-4 source e sink.</span><span class="sxs-lookup"><span data-stu-id="209f1-181">Rotation read and write support added in Windows 8 MPEG-4 source and sink.</span></span> <span data-ttu-id="209f1-182">Questa operazione non è supportata in Windows 7 MPEG-4 source e sink.</span><span class="sxs-lookup"><span data-stu-id="209f1-182">This is not supported in the Windows 7 MPEG-4 source and sink.</span></span>

    <span data-ttu-id="209f1-183">MPEG-4 source legge l'angolo di rotazione per una traccia video attiva come somma dell'angolo di rotazione tra' mvhd ' è tkhd '.</span><span class="sxs-lookup"><span data-stu-id="209f1-183">MPEG-4 source reads the rotation angle for an active video track as the sum of the rotation angle from ‘mvhd’ and from ‘tkhd’.</span></span>

    <span data-ttu-id="209f1-184">Microsoft MPEG-4 sink scrive l'angolo di rotazione in ' tkhd ', ma scrive una matrice di 0 gradi (identità) in ' mvhd '.</span><span class="sxs-lookup"><span data-stu-id="209f1-184">Microsoft MPEG-4 sink writes the rotation angle in ‘tkhd’ but writes 0 degree (identity) matrix in ‘mvhd’.</span></span> <span data-ttu-id="209f1-185">Si noti che il sink Microsoft MPEG-4 supporta solo una singola traccia video.</span><span class="sxs-lookup"><span data-stu-id="209f1-185">Note, Microsoft MPEG-4 sink only supports single video track.</span></span>

    <span data-ttu-id="209f1-186">IPropertyStore legge l'angolo di rotazione solo per la prima traccia video come somma dell'angolo di rotazione tra' mvhd ' è tkhd '.</span><span class="sxs-lookup"><span data-stu-id="209f1-186">IPropertyStore reads the rotation angle for only the first video track as the sum of the rotation angle from ‘mvhd’ and from ‘tkhd’.</span></span>

    <span data-ttu-id="209f1-187">IPropertyStore scrive l'angolo di rotazione solo per la prima traccia video in ' tkhd ' dopo che l'angolo di rotazione viene regolato in base all'angolo di rotazione in ' mvhd ', se esistente.</span><span class="sxs-lookup"><span data-stu-id="209f1-187">IPropertyStore writes the rotation angle for only the first video track in ‘tkhd’ after the rotation angle is adjusted according to the rotation angle in ‘mvhd’, if it exists.</span></span>

-   <span data-ttu-id="209f1-188">I frammenti di film (' Moof ') sono supportati nell'origine e nel sink di Windows 8 MPEG-4, ma ' MFRA ' non lo è.</span><span class="sxs-lookup"><span data-stu-id="209f1-188">Movie fragments ('moof') is supported in Windows 8 MPEG-4 source and sink, but 'mfra' is not.</span></span>
-   <span data-ttu-id="209f1-189">H. 263 è supportato nell'origine MPEG-4 di Windows 8.</span><span class="sxs-lookup"><span data-stu-id="209f1-189">H.263 is supported in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="209f1-190">MPEG-4 source ora esegue il mapping di due FourCC ' H263' è 263' nel formato di file MPEG-4 al tipo di supporto di **MFVideoFormat \_ H263**.</span><span class="sxs-lookup"><span data-stu-id="209f1-190">MPEG-4 source now maps two fourcc’s of ‘h263’ and ‘s263’ in MPEG-4 file format to the media type of **MFVideoFormat\_H263**.</span></span>

-   <span data-ttu-id="209f1-191">È stato aggiunto un ulteriore supporto FourCC per MJPEG nell'origine MPEG-4 di Windows 8.</span><span class="sxs-lookup"><span data-stu-id="209f1-191">More fourcc support added for MJPEG in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="209f1-192">L'origine MPEG-4 esegue il mapping di foucc di ' dmb1' al tipo di supporto di **MFVideoFormat \_ MJPG**.</span><span class="sxs-lookup"><span data-stu-id="209f1-192">MPEG-4 source maps foucc of ‘dmb1’ to the media type of **MFVideoFormat\_MJPG**.</span></span>

-   <span data-ttu-id="209f1-193">Supporto dei metadati Furigana aggiunto nell'origine MPEG-4 di Windows 8.</span><span class="sxs-lookup"><span data-stu-id="209f1-193">Furigana metadata support added in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="209f1-194">L'origine MPEG-4 legge i metadati Furigana da' Soal ',' Soar ',' soaa ',' sonm ' è Soco '.</span><span class="sxs-lookup"><span data-stu-id="209f1-194">MPEG-4 source reads Furigana metadata from ’soal’, ‘soar’, ‘soaa’, ‘sonm’, and ‘soco’.</span></span> <span data-ttu-id="209f1-195">IPropertyStore legge i metadati Furignana tramite il set di PKEYs corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="209f1-195">IPropertyStore reads Furignana metadata through the set of corresponding PKEYs.</span></span>

    <span data-ttu-id="209f1-196">La tabella seguente illustra il mapping tra il nome canonico della shell, la chiave della proprietà e l'ID box/Tag nel formato di file MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="209f1-196">The following table shows the mapping between the shell canonical name, the property key, and the box/tag ID in MPEG-4 file format.</span></span>

    

    | <span data-ttu-id="209f1-197">Campo</span><span class="sxs-lookup"><span data-stu-id="209f1-197">Field</span></span>                                | <span data-ttu-id="209f1-198">Chiave della proprietà</span><span class="sxs-lookup"><span data-stu-id="209f1-198">Property Key</span></span>                         | <span data-ttu-id="209f1-199">ID Tag/box</span><span class="sxs-lookup"><span data-stu-id="209f1-199">Tag/Box ID</span></span> |
    |--------------------------------------|--------------------------------------|------------|
    | <span data-ttu-id="209f1-200">System. Music. AlbumTitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-200">System.Music.AlbumTitleSortOverride</span></span>  | <span data-ttu-id="209f1-201">PKEY \_ Music \_ AlbumTitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-201">PKEY\_Music\_AlbumTitleSortOverride</span></span>  | <span data-ttu-id="209f1-202">Soal</span><span class="sxs-lookup"><span data-stu-id="209f1-202">soal</span></span>       |
    | <span data-ttu-id="209f1-203">System. Music. ArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-203">System.Music.ArtistSortOverride</span></span>      | <span data-ttu-id="209f1-204">PKEY \_ Music \_ ArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-204">PKEY\_Music\_ArtistSortOverride</span></span>      | <span data-ttu-id="209f1-205">aumenterà</span><span class="sxs-lookup"><span data-stu-id="209f1-205">soar</span></span>       |
    | <span data-ttu-id="209f1-206">System. Music. AlbumArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-206">System.Music.AlbumArtistSortOverride</span></span> | <span data-ttu-id="209f1-207">PKEY \_ Music \_ AlbumArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-207">PKEY\_Music\_AlbumArtistSortOverride</span></span> | <span data-ttu-id="209f1-208">soaa</span><span class="sxs-lookup"><span data-stu-id="209f1-208">soaa</span></span>       |
    | <span data-ttu-id="209f1-209">System. TitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-209">System.TitleSortOverride</span></span>             | <span data-ttu-id="209f1-210">\_TITLESORTOVERRIDE pkey</span><span class="sxs-lookup"><span data-stu-id="209f1-210">PKEY \_TitleSortOverride</span></span>             | <span data-ttu-id="209f1-211">sonm</span><span class="sxs-lookup"><span data-stu-id="209f1-211">sonm</span></span>       |
    | <span data-ttu-id="209f1-212">System. Music. ComposerSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-212">System.Music.ComposerSortOverride</span></span>    | <span data-ttu-id="209f1-213">PKEY \_ Music \_ ComposerSortOverride</span><span class="sxs-lookup"><span data-stu-id="209f1-213">PKEY\_Music\_ComposerSortOverride</span></span>    | <span data-ttu-id="209f1-214">Soco</span><span class="sxs-lookup"><span data-stu-id="209f1-214">soco</span></span>       |

    

     

-   <span data-ttu-id="209f1-215">Supporto Atom stereo 3D aggiunto nell'origine MPEG-4 di Windows 8.</span><span class="sxs-lookup"><span data-stu-id="209f1-215">Stereo 3D atom support added in Windows 8 MPEG-4 source.</span></span>

-   <span data-ttu-id="209f1-216">Supporto per AC3 e DD + aggiunto in Windows 8 MPEG-4 source e sink.</span><span class="sxs-lookup"><span data-stu-id="209f1-216">AC3 and DD+ support added in Windows 8 MPEG-4 source and sink.</span></span>
-   <span data-ttu-id="209f1-217">I file di dimensioni superiori a 4 GB sono supportati nel sink MPEG-4 di Windows 8 per MP4 non frammentato.</span><span class="sxs-lookup"><span data-stu-id="209f1-217">Files larger than 4 GB are supported in Windows 8 MPEG-4 sink for non-fragmental MP4.</span></span>
-   <span data-ttu-id="209f1-218">Lo scrubbing è stato ottimizzato nell'origine MPEG-4 di Windows 8.</span><span class="sxs-lookup"><span data-stu-id="209f1-218">Scrubbing has been optimized in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="209f1-219">Per ridurre la latenza, le informazioni per i due fotogrammi chiave più vicini per una particolare posizione di ricerca vengono esposte tramite [**IMFSeekInfo:: GetNearestKeyFrames**](/windows/desktop/api/mfidl/nf-mfidl-imfseekinfo-getnearestkeyframes).</span><span class="sxs-lookup"><span data-stu-id="209f1-219">To reduce latency, information for the two nearest key frames for a particular seek position are exposed through [**IMFSeekInfo::GetNearestKeyFrames**](/windows/desktop/api/mfidl/nf-mfidl-imfseekinfo-getnearestkeyframes).</span></span> <span data-ttu-id="209f1-220">Poiché il fotogramma chiave non dispone di frame dipendenti, presenta il frame dopo la decodifica di un solo frame.</span><span class="sxs-lookup"><span data-stu-id="209f1-220">Since the key frame does not have dependent frames, it presents the frame after decoding only one frame.</span></span> <span data-ttu-id="209f1-221">Usare [**IMFGetService:: GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) per ottenere questa interfaccia tramite l'origine multimediale, la pipeline o l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="209f1-221">Use [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to obtain this interface through the media source, pipeline, or application.</span></span>

    <span data-ttu-id="209f1-222">Impostare la frequenza su zero nell'origine MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="209f1-222">Set rate to zero in MPEG-4 source.</span></span> <span data-ttu-id="209f1-223">Quando la pipeline è in modalità di pulitura, la frequenza è zero.</span><span class="sxs-lookup"><span data-stu-id="209f1-223">When the pipeline is in scrubbing mode, the rate is zero.</span></span>

-   <span data-ttu-id="209f1-224">SPS e PPS possono essere archiviati nei dati di esempio nel sink MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="209f1-224">SPS and PPS can be stored in sample data in MPEG-4 sink.</span></span>

    <span data-ttu-id="209f1-225">[MF \_ L' \_ attributo \_ PassThrough MPEG4SINK SPSPPS](mf-mpeg4sink-spspps-passthrough.md) sul sink MPEG-4 è definito in modo da consentire il salvataggio di SPS e PPS insieme agli esempi di input (dati video H. 264).</span><span class="sxs-lookup"><span data-stu-id="209f1-225">[MF\_MPEG4SINK\_SPSPPS\_PASSTHROUGH](mf-mpeg4sink-spspps-passthrough.md) attribute on MPEG-4 sink is defined to allow SPS’s and PPS’s to be saved together with input samples (H.264 video data).</span></span> <span data-ttu-id="209f1-226">Le clip MP4 prodotte sono riprodotte da Windows 7 MPEG-4 source e altri.</span><span class="sxs-lookup"><span data-stu-id="209f1-226">The produced mp4 clips are play-able by Windows 7 MPEG-4 source and others.</span></span>

-   <span data-ttu-id="209f1-227">SPS e PPS possono essere estratti dagli esempi di input nel sink MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="209f1-227">SPS and PPS can be extracted from input samples in MPEG-4 sink.</span></span>

    <span data-ttu-id="209f1-228">Quando SPS e PPS non vengono impostati tramite [l' \_ \_ intestazione della \_ sequenza \_ MPEG mt MPEG](mf-mt-mpeg-sequence-header-attribute.md) per il tipo di supporto di input del sink MPEG-4, il sink MPEG-4 tenterà di estrarre SPS e PPS dagli esempi di input.</span><span class="sxs-lookup"><span data-stu-id="209f1-228">When SPS and PPS are not set through [MF\_MT\_MPEG\_SEQUENCE\_HEADER](mf-mt-mpeg-sequence-header-attribute.md) on input media type of the MPEG-4 sink, MPEG-4 sink will try to extract SPS and PPS from input samples.</span></span> <span data-ttu-id="209f1-229">Il sink MPEG-4 ignora gli esempi di input fino a quando non trova il primo SPS e PPS, perché tutti gli esempi di input senza SPS e PPS non sono decodificabili.</span><span class="sxs-lookup"><span data-stu-id="209f1-229">MPEG-4 sink ignores any input samples until it finds the first SPS and PPS, because all input samples without SPS and PPS are not decode-able.</span></span>

-   <span data-ttu-id="209f1-230">le informazioni 3D nel record di configurazione AVC sono supportate per MP4 non frammentato.</span><span class="sxs-lookup"><span data-stu-id="209f1-230">3D information in AVC configuration record is supported for non-fragmental MP4.</span></span>
-   <span data-ttu-id="209f1-231">La lunghezza di NALU è esposta per gli esempi compressi H. 264 per ottimizzare la decodifica DXVA H. 264 VLD.</span><span class="sxs-lookup"><span data-stu-id="209f1-231">NALU length is exposed for H.264 compressed samples to optimize H.264 VLD DXVA decoding.</span></span>

    <span data-ttu-id="209f1-232">MPEG-4 source sets [MF \_ Nalu \_ length \_ set](mf-nalu-length-set.md) on the output media type of **MFVideoFormat \_ H264** o **MFVideoFormat \_ H264**.</span><span class="sxs-lookup"><span data-stu-id="209f1-232">MPEG-4 source sets [MF\_NALU\_LENGTH\_SET](mf-nalu-length-set.md) on the output media type of **MFVideoFormat\_H264** or **MFVideoFormat\_h264**.</span></span> <span data-ttu-id="209f1-233">Imposta il BLOB delle [informazioni sulla \_ \_ lunghezza MF \_ Nalu](mf-nalu-length-information.md) in ogni esempio di output, con lunghezza NALU a quattro byte per Nalu diversi in un campione compresso.</span><span class="sxs-lookup"><span data-stu-id="209f1-233">It sets the blob of [MF\_NALU\_LENGTH\_INFORMATION](mf-nalu-length-information.md) on each output sample, with four-byte NALU length for different NALU’s in one compressed sample.</span></span>

-   <span data-ttu-id="209f1-234">Aggiunto il supporto per l'audio MPEG2 ADTS in MP4 source.</span><span class="sxs-lookup"><span data-stu-id="209f1-234">Support added for MPEG2 ADTS audio in MP4 source.</span></span>

## <a name="requirements"></a><span data-ttu-id="209f1-235">Requisiti</span><span class="sxs-lookup"><span data-stu-id="209f1-235">Requirements</span></span>



| <span data-ttu-id="209f1-236">Requisito</span><span class="sxs-lookup"><span data-stu-id="209f1-236">Requirement</span></span> | <span data-ttu-id="209f1-237">Valore</span><span class="sxs-lookup"><span data-stu-id="209f1-237">Value</span></span> |
|-------------------------------------|---------------------------------------------------------|
| <span data-ttu-id="209f1-238">Client minimo supportato</span><span class="sxs-lookup"><span data-stu-id="209f1-238">Minimum supported client</span></span><br/> | <span data-ttu-id="209f1-239">\[Solo app desktop di Windows 7\]</span><span class="sxs-lookup"><span data-stu-id="209f1-239">Windows 7 \[desktop apps only\]</span></span><br/>              |
| <span data-ttu-id="209f1-240">Server minimo supportato</span><span class="sxs-lookup"><span data-stu-id="209f1-240">Minimum supported server</span></span><br/> | <span data-ttu-id="209f1-241">Solo app desktop Windows Server 2008 R2 \[\]</span><span class="sxs-lookup"><span data-stu-id="209f1-241">Windows Server 2008 R2 \[desktop apps only\]</span></span><br/> |



## <a name="see-also"></a><span data-ttu-id="209f1-242">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="209f1-242">See also</span></span>

<dl> <dt>

[<span data-ttu-id="209f1-243">Origini e sink multimediali</span><span class="sxs-lookup"><span data-stu-id="209f1-243">Media Sources and Sinks</span></span>](media-sources-and-sinks.md)
</dt> <dt>

[<span data-ttu-id="209f1-244">Sink di supporti</span><span class="sxs-lookup"><span data-stu-id="209f1-244">Media Sinks</span></span>](media-sinks.md)
</dt> <dt>

[<span data-ttu-id="209f1-245">Supporto MPEG-4 in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="209f1-245">MPEG-4 Support in Media Foundation</span></span>](mpeg-4-support-in-media-foundation.md)
</dt> <dt>

[<span data-ttu-id="209f1-246">Formati multimediali supportati in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="209f1-246">Supported Media Formats in Media Foundation</span></span>](supported-media-formats-in-media-foundation.md)
</dt> </dl>

 

 
