---
description: Informazioni sulla creazione del sink di file ASF, che un'applicazione può usare per archiviare i dati multimediali di ASF in un file.
ms.assetid: 991f3345-a6b4-45c2-a89d-3c13c70b6bbc
title: Creazione del sink del file ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6fcd9ea19f0200dfd330f421fd5dac2cd100b702
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/19/2021
ms.locfileid: "112409924"
---
# <a name="creating-the-asf-file-sink"></a><span data-ttu-id="96d77-103">Creazione del sink del file ASF</span><span class="sxs-lookup"><span data-stu-id="96d77-103">Creating the ASF File Sink</span></span>

<span data-ttu-id="96d77-104">Il sink di file ASF è un'implementazione di [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) fornita da Media Foundation che un'applicazione può usare per archiviare i dati multimediali di ASF in un file.</span><span class="sxs-lookup"><span data-stu-id="96d77-104">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="96d77-105">Per informazioni sul modello a oggetti di ASF Media Sinks e sull'utilizzo generale, vedere [AsF Media Sinks](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="96d77-105">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="96d77-106">Esistono due modi per creare un'istanza del sink di file ASF.</span><span class="sxs-lookup"><span data-stu-id="96d77-106">There are two ways of creating an instance of the ASF file sink.</span></span> <span data-ttu-id="96d77-107">È possibile chiamare [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) o [**MFCreateASFMediaSinkActivate.**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)</span><span class="sxs-lookup"><span data-stu-id="96d77-107">You can call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) or [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span>

<span data-ttu-id="96d77-108">Se si chiama [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), è necessario specificare un flusso di byte, per il file di output, in cui il sink scriverà il contenuto asf durante una sessione di codifica.</span><span class="sxs-lookup"><span data-stu-id="96d77-108">If you call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), you must specify a byte stream, for the output file, into which the sink will write the ASF content during an encoding session.</span></span> <span data-ttu-id="96d77-109">Il flusso di byte specificato deve avere funzionalità ricercabili e scrivibili; in caso contrario, la chiamata **MFCreateASFMediaSink** ha esito negativo con il codice di errore E \_ FAIL.</span><span class="sxs-lookup"><span data-stu-id="96d77-109">The specified byte stream must have seekable and writable capabilities otherwise the **MFCreateASFMediaSink** call fails with the E\_FAIL error code.</span></span> <span data-ttu-id="96d77-110">Questa chiamata crea un oggetto sink di file in-process e restituisce un puntatore [**all'interfaccia IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) del sink di file.</span><span class="sxs-lookup"><span data-stu-id="96d77-110">This call creates an in-process file sink object and returns a pointer to the [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) interface of the file sink.</span></span>

<span data-ttu-id="96d77-111">Se si chiama [**MFCreateASFMediaSinkActivate,**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)è necessario specificare l'URL del file di output in cui il sink di file scriverà i dati multimediali.</span><span class="sxs-lookup"><span data-stu-id="96d77-111">If you call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), you must specify the URL of the output file into which the file sink will write media data.</span></span> <span data-ttu-id="96d77-112">In questo caso, il sink di file crea internamente il flusso di byte.</span><span class="sxs-lookup"><span data-stu-id="96d77-112">In this case, the file sink internally creates the byte stream.</span></span> <span data-ttu-id="96d77-113">La funzione restituisce un puntatore [**all'interfaccia IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) del sink di file.</span><span class="sxs-lookup"><span data-stu-id="96d77-113">The function returns a pointer to the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface of the file sink.</span></span> <span data-ttu-id="96d77-114">Per</span><span class="sxs-lookup"><span data-stu-id="96d77-114">To</span></span>

<span data-ttu-id="96d77-115">Prendere [**in considerazione MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) anziché [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink)quando la topologia di codifica è progettata come segue:</span><span class="sxs-lookup"><span data-stu-id="96d77-115">Consider [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) instead of [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), when your encoding topology is designed as follows:</span></span>

-   <span data-ttu-id="96d77-116">La topologia di codifica è per il percorso del supporto protetto (PMP) e il sink di file viene usato out-of-process.</span><span class="sxs-lookup"><span data-stu-id="96d77-116">The encoding topology is for the protected media path (PMP) and the file sink is used out-of-process.</span></span>
-   <span data-ttu-id="96d77-117">Il nodo di output della topologia viene creato usando il puntatore restituito all'oggetto activate del sink di file e l'applicazione tiene traccia dei flussi nel sink di file in base ai numeri di flusso.</span><span class="sxs-lookup"><span data-stu-id="96d77-117">The output node of the topology is created by using the returned pointer to the activate object of the file sink and your application is keeping track of the streams in the file sink by stream numbers.</span></span>
    > [!Note]  
    > <span data-ttu-id="96d77-118">È possibile attivare il sink di file chiamando [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span><span class="sxs-lookup"><span data-stu-id="96d77-118">You can activate the file sink by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span></span> <span data-ttu-id="96d77-119">Non è tuttavia necessario attivare esplicitamente l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="96d77-119">However you do not need to activate the object explictly.</span></span> <span data-ttu-id="96d77-120">La sessione multimediale tiene traccia dell'oggetto attivazione e attiva automaticamente il sink del file durante la sessione di codifica.</span><span class="sxs-lookup"><span data-stu-id="96d77-120">The Media Session keeps track of the activation object and activates the file sink automatically during the encoding session.</span></span>

     

-   <span data-ttu-id="96d77-121">Le informazioni sul flusso vengono configurate nell'oggetto ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="96d77-121">The stream information is configured in the ContentInfo object.</span></span> <span data-ttu-id="96d77-122">Disucssed nella sottosezioni successiva.</span><span class="sxs-lookup"><span data-stu-id="96d77-122">Disucssed in the next sub-section.</span></span>

<span data-ttu-id="96d77-123">Dopo aver creato il sink di file ASF, è necessario configurarlo prima di compilare la topologia.</span><span class="sxs-lookup"><span data-stu-id="96d77-123">After creating the ASF file sink it must be configured before building the topology.</span></span> <span data-ttu-id="96d77-124">Il sink di file deve conoscere le informazioni seguenti per generare il file di output.</span><span class="sxs-lookup"><span data-stu-id="96d77-124">The file sink needs to know the following information in order to generate the output file.</span></span>

-   <span data-ttu-id="96d77-125">Informazioni di base sul flusso</span><span class="sxs-lookup"><span data-stu-id="96d77-125">Basic stream information</span></span>
-   <span data-ttu-id="96d77-126">Informazioni sulla modalità di codifica</span><span class="sxs-lookup"><span data-stu-id="96d77-126">Encoding mode information</span></span>
-   <span data-ttu-id="96d77-127">Metadati</span><span class="sxs-lookup"><span data-stu-id="96d77-127">Metadata</span></span>

<span data-ttu-id="96d77-128">Il sink di file implementa [l'oggetto ContentInfo](asf-contentinfo-object.md) di ASF ed espone l'interfaccia [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) in modo che un'applicazione possa usarla per impostare informazioni correlate ai flussi e alla codifica.</span><span class="sxs-lookup"><span data-stu-id="96d77-128">The file sink implements the [ASF ContentInfo Object](asf-contentinfo-object.md) and exposes the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface so that an application can use it to set information related to the streams and encoding.</span></span> <span data-ttu-id="96d77-129">A seconda della funzione chiamata per creare il sink di file, esistono due modi per ottenere un riferimento **all'interfaccia IMFASFContentInfo.**</span><span class="sxs-lookup"><span data-stu-id="96d77-129">Depending on the function you called to create the file sink, there are two ways of getting a reference to the **IMFASFContentInfo** interface.</span></span>

-   <span data-ttu-id="96d77-130">Se si chiama la [**funzione MFCreateASFMediaSink,**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) l'applicazione deve eseguire una query per l'interfaccia [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) chiamando **IMFMediaSink::QueryInterface** sul sink di file restituito.</span><span class="sxs-lookup"><span data-stu-id="96d77-130">If you call the [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) function, the application must query for [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface by calling **IMFMediaSink::QueryInterface** on the returned file sink.</span></span>
-   <span data-ttu-id="96d77-131">Se si sceglie di chiamare [**MFCreateASFMediaSinkActivate,**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)questa funzione prevede che sia presente un oggetto ContentInfo completamente configurato prima della chiamata.</span><span class="sxs-lookup"><span data-stu-id="96d77-131">If you choose to call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), this function expects that you have a fully-configured ContentInfo object prior to the call.</span></span> <span data-ttu-id="96d77-132">A tale scopo, è necessario creare un oggetto ContentInfo vuoto chiamando [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) e quindi configurarlo con tutte le informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="96d77-132">To do this, you need to create an empty ContentInfo object by calling [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) and then configure it with all the required information.</span></span> <span data-ttu-id="96d77-133">Passare l'oggetto ContentInfo configurato a **MFCreateASFMediaSinkActivate** per ricevere un puntatore all'oggetto di attivazione sink.</span><span class="sxs-lookup"><span data-stu-id="96d77-133">Pass the configured ContentInfo object to the **MFCreateASFMediaSinkActivate** to receive a pointer to the sink activate object.</span></span> <span data-ttu-id="96d77-134">Non è possibile attivare il sink di file usando l'oggetto di attivazione restituito e quindi modificare le informazioni di flusso o codifica.</span><span class="sxs-lookup"><span data-stu-id="96d77-134">You cannot activate the file sink by using the returned activation object and then change any stream or encoding information.</span></span>

<span data-ttu-id="96d77-135">Per informazioni sulla configurazione di flussi di sink e proprietà specifiche, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="96d77-135">For information about configuring sink streams and specific properties, see the following topics:</span></span>

-   [<span data-ttu-id="96d77-136">Aggiunta di informazioni di flusso al sink del file ASF</span><span class="sxs-lookup"><span data-stu-id="96d77-136">Adding Stream Information to the ASF File Sink</span></span>](adding-stream-information-to-the-asf-file-sink.md)
-   [<span data-ttu-id="96d77-137">Impostazione delle proprietà nel sink file</span><span class="sxs-lookup"><span data-stu-id="96d77-137">Setting Properties in the File Sink</span></span>](setting-properties-in-the-file-sink.md)
-   [<span data-ttu-id="96d77-138">Aggiunta di metadati al sink di file</span><span class="sxs-lookup"><span data-stu-id="96d77-138">Adding Metadata to the File Sink</span></span>](adding-metadata-to-the-file-sink.md)

## <a name="related-topics"></a><span data-ttu-id="96d77-139">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="96d77-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="96d77-140">Sink multimediali asf</span><span class="sxs-lookup"><span data-stu-id="96d77-140">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="96d77-141">Componenti ASF del livello pipeline</span><span class="sxs-lookup"><span data-stu-id="96d77-141">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="96d77-142">Supporto di ASF in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="96d77-142">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 



