---
description: Il sink di file ASF è un'implementazione di IMFMediaSink fornita da Media Foundation che un'applicazione può usare per archiviare i dati del supporto ASF in un file. Per informazioni sul modello a oggetti dei sink multimediali ASF e sull'utilizzo generale, vedere la pagina relativa ai sink di supporto ASF.
ms.assetid: 991f3345-a6b4-45c2-a89d-3c13c70b6bbc
title: Creazione del sink di file ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c43625bcbc581b4967d4db99cef71a0fc779f070
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127943"
---
# <a name="creating-the-asf-file-sink"></a><span data-ttu-id="cb065-104">Creazione del sink di file ASF</span><span class="sxs-lookup"><span data-stu-id="cb065-104">Creating the ASF File Sink</span></span>

<span data-ttu-id="cb065-105">Il sink di file ASF è un'implementazione di [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) fornita da Media Foundation che un'applicazione può usare per archiviare i dati del supporto ASF in un file.</span><span class="sxs-lookup"><span data-stu-id="cb065-105">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="cb065-106">Per informazioni sul modello a oggetti dei sink multimediali ASF e sull'utilizzo generale, vedere la pagina relativa ai [sink di supporto ASF](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="cb065-106">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="cb065-107">Esistono due modi per creare un'istanza del sink di file ASF.</span><span class="sxs-lookup"><span data-stu-id="cb065-107">There are two ways of creating an instance of the ASF file sink.</span></span> <span data-ttu-id="cb065-108">È possibile chiamare [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) o [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span><span class="sxs-lookup"><span data-stu-id="cb065-108">You can call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) or [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span>

<span data-ttu-id="cb065-109">Se si chiama [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), è necessario specificare un flusso di byte, per il file di output, in cui il sink scriverà il contenuto ASF durante una sessione di codifica.</span><span class="sxs-lookup"><span data-stu-id="cb065-109">If you call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), you must specify a byte stream, for the output file, into which the sink will write the ASF content during an encoding session.</span></span> <span data-ttu-id="cb065-110">Il flusso di byte specificato deve avere funzionalità ricercabili e scrivibili in caso contrario, la chiamata a **MFCreateASFMediaSink** ha esito negativo con il \_ codice di errore E non riuscito.</span><span class="sxs-lookup"><span data-stu-id="cb065-110">The specified byte stream must have seekable and writable capabilities otherwise the **MFCreateASFMediaSink** call fails with the E\_FAIL error code.</span></span> <span data-ttu-id="cb065-111">Questa chiamata crea un oggetto sink di file in-process e restituisce un puntatore all'interfaccia [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) del sink di file.</span><span class="sxs-lookup"><span data-stu-id="cb065-111">This call creates an in-process file sink object and returns a pointer to the [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) interface of the file sink.</span></span>

<span data-ttu-id="cb065-112">Se si chiama [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), è necessario specificare l'URL del file di output in cui il sink di file scriverà i dati multimediali.</span><span class="sxs-lookup"><span data-stu-id="cb065-112">If you call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), you must specify the URL of the output file into which the file sink will write media data.</span></span> <span data-ttu-id="cb065-113">In questo caso, il sink di file crea internamente il flusso di byte.</span><span class="sxs-lookup"><span data-stu-id="cb065-113">In this case, the file sink internally creates the byte stream.</span></span> <span data-ttu-id="cb065-114">La funzione restituisce un puntatore all'interfaccia [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) del sink di file.</span><span class="sxs-lookup"><span data-stu-id="cb065-114">The function returns a pointer to the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface of the file sink.</span></span> <span data-ttu-id="cb065-115">A</span><span class="sxs-lookup"><span data-stu-id="cb065-115">To</span></span>

<span data-ttu-id="cb065-116">Prendere in considerazione [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) anziché [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink)quando la topologia di codifica è progettata come segue:</span><span class="sxs-lookup"><span data-stu-id="cb065-116">Consider [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) instead of [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), when your encoding topology is designed as follows:</span></span>

-   <span data-ttu-id="cb065-117">La topologia di codifica è per il percorso del supporto protetto (PMP) e il sink di file viene usato out-of-process.</span><span class="sxs-lookup"><span data-stu-id="cb065-117">The encoding topology is for the protected media path (PMP) and the file sink is used out-of-process.</span></span>
-   <span data-ttu-id="cb065-118">Il nodo di output della topologia viene creato usando il puntatore restituito all'oggetto Activate del sink di file e l'applicazione tiene traccia dei flussi nel sink di file in base ai numeri di flusso.</span><span class="sxs-lookup"><span data-stu-id="cb065-118">The output node of the topology is created by using the returned pointer to the activate object of the file sink and your application is keeping track of the streams in the file sink by stream numbers.</span></span>
    > [!Note]  
    > <span data-ttu-id="cb065-119">È possibile attivare il sink di file chiamando [**IMFActivate:: ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span><span class="sxs-lookup"><span data-stu-id="cb065-119">You can activate the file sink by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span></span> <span data-ttu-id="cb065-120">Tuttavia, non è necessario attivare l'oggetto esplicitamente.</span><span class="sxs-lookup"><span data-stu-id="cb065-120">However you do not need to activate the object explictly.</span></span> <span data-ttu-id="cb065-121">La sessione multimediale tiene traccia dell'oggetto attivazione e attiva automaticamente il sink di file durante la sessione di codifica.</span><span class="sxs-lookup"><span data-stu-id="cb065-121">The Media Session keeps track of the activation object and activates the file sink automatically during the encoding session.</span></span>

     

-   <span data-ttu-id="cb065-122">Le informazioni sul flusso sono configurate nell'oggetto ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="cb065-122">The stream information is configured in the ContentInfo object.</span></span> <span data-ttu-id="cb065-123">Disucssed nella sottosezione successiva.</span><span class="sxs-lookup"><span data-stu-id="cb065-123">Disucssed in the next sub-section.</span></span>

<span data-ttu-id="cb065-124">Dopo aver creato il sink di file ASF, è necessario configurarlo prima di compilare la topologia.</span><span class="sxs-lookup"><span data-stu-id="cb065-124">After creating the ASF file sink it must be configured before building the topology.</span></span> <span data-ttu-id="cb065-125">Per generare il file di output, è necessario che il sink di file conosca le informazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="cb065-125">The file sink needs to know the following information in order to generate the output file.</span></span>

-   <span data-ttu-id="cb065-126">Informazioni sul flusso di base</span><span class="sxs-lookup"><span data-stu-id="cb065-126">Basic stream information</span></span>
-   <span data-ttu-id="cb065-127">Informazioni sulla modalità di codifica</span><span class="sxs-lookup"><span data-stu-id="cb065-127">Encoding mode information</span></span>
-   <span data-ttu-id="cb065-128">Metadati</span><span class="sxs-lookup"><span data-stu-id="cb065-128">Metadata</span></span>

<span data-ttu-id="cb065-129">Il sink di file implementa l' [oggetto ContentInfo ASF](asf-contentinfo-object.md) ed espone l'interfaccia [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) in modo che possa essere usata da un'applicazione per impostare informazioni correlate ai flussi e alla codifica.</span><span class="sxs-lookup"><span data-stu-id="cb065-129">The file sink implements the [ASF ContentInfo Object](asf-contentinfo-object.md) and exposes the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface so that an application can use it to set information related to the streams and encoding.</span></span> <span data-ttu-id="cb065-130">A seconda della funzione chiamata per creare il sink di file, esistono due modi per ottenere un riferimento all'interfaccia **IMFASFContentInfo** .</span><span class="sxs-lookup"><span data-stu-id="cb065-130">Depending on the function you called to create the file sink, there are two ways of getting a reference to the **IMFASFContentInfo** interface.</span></span>

-   <span data-ttu-id="cb065-131">Se si chiama la funzione [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) , l'applicazione deve eseguire una query per l'interfaccia [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) chiamando **IMFMediaSink:: QueryInterface** sul sink di file restituito.</span><span class="sxs-lookup"><span data-stu-id="cb065-131">If you call the [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) function, the application must query for [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface by calling **IMFMediaSink::QueryInterface** on the returned file sink.</span></span>
-   <span data-ttu-id="cb065-132">Se si sceglie di chiamare [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), questa funzione prevede che sia presente un oggetto ContentInfo completamente configurato prima della chiamata.</span><span class="sxs-lookup"><span data-stu-id="cb065-132">If you choose to call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), this function expects that you have a fully-configured ContentInfo object prior to the call.</span></span> <span data-ttu-id="cb065-133">A tale scopo, è necessario creare un oggetto ContentInfo vuoto chiamando [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) e quindi configurarlo con tutte le informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="cb065-133">To do this, you need to create an empty ContentInfo object by calling [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) and then configure it with all the required information.</span></span> <span data-ttu-id="cb065-134">Passare l'oggetto ContentInfo configurato a **MFCreateASFMediaSinkActivate** per ricevere un puntatore all'oggetto Activate del sink.</span><span class="sxs-lookup"><span data-stu-id="cb065-134">Pass the configured ContentInfo object to the **MFCreateASFMediaSinkActivate** to receive a pointer to the sink activate object.</span></span> <span data-ttu-id="cb065-135">Non è possibile attivare il sink di file utilizzando l'oggetto attivazione restituito, quindi modificare le informazioni di flusso o di codifica.</span><span class="sxs-lookup"><span data-stu-id="cb065-135">You cannot activate the file sink by using the returned activation object and then change any stream or encoding information.</span></span>

<span data-ttu-id="cb065-136">Per informazioni sulla configurazione di flussi di sink e proprietà specifiche, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="cb065-136">For information about configuring sink streams and specific properties, see the following topics:</span></span>

-   [<span data-ttu-id="cb065-137">Aggiunta di informazioni sul flusso al sink di file ASF</span><span class="sxs-lookup"><span data-stu-id="cb065-137">Adding Stream Information to the ASF File Sink</span></span>](adding-stream-information-to-the-asf-file-sink.md)
-   [<span data-ttu-id="cb065-138">Impostazione delle proprietà nel sink di file</span><span class="sxs-lookup"><span data-stu-id="cb065-138">Setting Properties in the File Sink</span></span>](setting-properties-in-the-file-sink.md)
-   [<span data-ttu-id="cb065-139">Aggiunta di metadati al sink di file</span><span class="sxs-lookup"><span data-stu-id="cb065-139">Adding Metadata to the File Sink</span></span>](adding-metadata-to-the-file-sink.md)

## <a name="related-topics"></a><span data-ttu-id="cb065-140">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cb065-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cb065-141">Sink di supporti ASF</span><span class="sxs-lookup"><span data-stu-id="cb065-141">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="cb065-142">Componenti ASF a livello pipeline</span><span class="sxs-lookup"><span data-stu-id="cb065-142">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="cb065-143">Supporto ASF in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="cb065-143">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 



