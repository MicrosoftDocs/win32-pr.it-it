---
description: .
ms.assetid: CF3A427D-31D2-45FF-BE87-F192B758204E
title: Sessione multimediale PMP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0e14d9e403620d273bb4aeb3347cba523f304b
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/03/2021
ms.locfileid: "104351176"
---
# <a name="pmp-media-session"></a><span data-ttu-id="be974-103">Sessione multimediale PMP</span><span class="sxs-lookup"><span data-stu-id="be974-103">PMP Media Session</span></span>

<span data-ttu-id="be974-104">Un'applicazione può creare la [sessione multimediale](media-session.md) in un processo separato denominato processo PMP ( [Protected Media Path](protected-media-path.md) ).</span><span class="sxs-lookup"><span data-stu-id="be974-104">An application can create the [Media Session](media-session.md) in a separate process called the [Protected Media Path](protected-media-path.md) (PMP) process.</span></span> <span data-ttu-id="be974-105">Lo scopo principale del processo PMP è quello di abilitare la riproduzione dei contenuti protetti usando Digital Rights Management (DRM).</span><span class="sxs-lookup"><span data-stu-id="be974-105">The main purpose of the PMP process is to enable playback of protected content using digital rights management (DRM).</span></span> <span data-ttu-id="be974-106">Per impostazione predefinita, il processo PMP viene creato all'interno di un ambiente protetto (PE).</span><span class="sxs-lookup"><span data-stu-id="be974-106">By default, the PMP process is created inside a Protected Environment (PE).</span></span> <span data-ttu-id="be974-107">Solo i componenti trusted e firmati possono essere caricati all'interno di un PE.</span><span class="sxs-lookup"><span data-stu-id="be974-107">Only trusted, signed components can be loaded inside a PE.</span></span> <span data-ttu-id="be974-108">Un vantaggio secondario del processo PMP è che isola il processo dell'applicazione dalla pipeline multimediale.</span><span class="sxs-lookup"><span data-stu-id="be974-108">A secondary benefit of the PMP process is that it isolates the application process from the media pipeline.</span></span> <span data-ttu-id="be974-109">Per ulteriori informazioni sul processo PMP, vedere [percorso multimediale protetto](protected-media-path.md).</span><span class="sxs-lookup"><span data-stu-id="be974-109">For more information about the PMP process, see [Protected Media Path](protected-media-path.md).</span></span>

<span data-ttu-id="be974-110">Per creare la sessione multimediale all'interno del processo PMP, chiamare la funzione [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="be974-110">To create the Media Session inside the PMP process, call the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span> <span data-ttu-id="be974-111">Facoltativamente, è possibile passare il flag **di \_ \_ processo MFPMPSESSION non protetto** .</span><span class="sxs-lookup"><span data-stu-id="be974-111">Optionally, you can pass in the **MFPMPSESSION\_UNPROTECTED\_PROCESS** flag.</span></span> <span data-ttu-id="be974-112">Se questo flag è impostato, il processo PMP viene creato all'interno di un processo non protetto e non di un processo PE.</span><span class="sxs-lookup"><span data-stu-id="be974-112">If this flag is set, the PMP process is created inside an unprotected process, and not a PE process.</span></span> <span data-ttu-id="be974-113">Il processo non protetto non può essere usato per la riproduzione DRM, ma offre i vantaggi dell'isolamento dei processi.</span><span class="sxs-lookup"><span data-stu-id="be974-113">The unprotected process cannot be used for DRM playback, but does give you the benefits of process isolation.</span></span>

<span data-ttu-id="be974-114">La funzione [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) restituisce un puntatore a un oggetto proxy per la sessione multimediale.</span><span class="sxs-lookup"><span data-stu-id="be974-114">The [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function returns a pointer to a proxy object for the Media Session.</span></span> <span data-ttu-id="be974-115">L'applicazione comunica con la sessione multimediale tramite il proxy.</span><span class="sxs-lookup"><span data-stu-id="be974-115">The application communicates with the Media Session through the proxy.</span></span>

![illustrazione della sessione multimediale all'interno del processo PMP](images/pmp01.png)

<span data-ttu-id="be974-117">Per impostazione predefinita, quando l'applicazione crea una topologia, l'origine multimediale viene creata all'interno del processo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="be974-117">By default, when the application creates a topology, the media source is created inside the application process.</span></span> <span data-ttu-id="be974-118">Un proxy per l'origine multimediale viene creato all'interno del processo PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-118">A proxy to the media source is created inside the PMP process.</span></span> <span data-ttu-id="be974-119">L'origine multimediale può creare oggetti all'interno del processo PMP usando l'interfaccia [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) .</span><span class="sxs-lookup"><span data-stu-id="be974-119">The media source can create objects inside the PMP process by using the [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) interface.</span></span> <span data-ttu-id="be974-120">Per supportare DRM, ad esempio, un'origine multimediale crea un oggetto denominato *autorità di attendibilità di input* (ITA).</span><span class="sxs-lookup"><span data-stu-id="be974-120">For example, to support DRM, a media source creates an object called an *input trust authority* (ITA).</span></span> <span data-ttu-id="be974-121">Il ITA deve essere creato all'interno del processo PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-121">The ITA must be created inside the PMP process.</span></span> <span data-ttu-id="be974-122">Per ulteriori informazioni su ITAs, vedere [percorso multimediale protetto](protected-media-path.md). Per usare l'interfaccia [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) , eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="be974-122">(For more information about ITAs, see [Protected Media Path](protected-media-path.md).) To use the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, do the following:</span></span>

1.  <span data-ttu-id="be974-123">L'origine multimediale deve implementare l'interfaccia [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) .</span><span class="sxs-lookup"><span data-stu-id="be974-123">The media source must implement the [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) interface.</span></span>
2.  <span data-ttu-id="be974-124">Durante la risoluzione della topologia, il proxy della sessione multimediale chiama il metodo [**IMFPMPClient:: SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) sull'origine multimediale.</span><span class="sxs-lookup"><span data-stu-id="be974-124">During topology resolution, the Media Session proxy calls the [**IMFPMPClient::SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) method on the media source.</span></span>
3.  <span data-ttu-id="be974-125">L'origine multimediale chiama [**IMFPMPHost:: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) per creare l'oggetto all'interno del processo PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-125">The media source calls [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) to create the object inside the PMP process.</span></span> <span data-ttu-id="be974-126">L'oggetto deve avere un CLSID registrato.</span><span class="sxs-lookup"><span data-stu-id="be974-126">The object must have a registered CLSID.</span></span> <span data-ttu-id="be974-127">Inoltre, per il caricamento all'interno del PE, l'oggetto deve essere attendibile e firmato digitalmente.</span><span class="sxs-lookup"><span data-stu-id="be974-127">Also, to load inside the PE, the object must be trusted and digitally signed.</span></span> <span data-ttu-id="be974-128">Per informazioni sui componenti multimediali protetti per la firma del codice, vedere la white paper [firma del codice per i componenti multimediali protetti in Windows Vista](/windows-hardware/test/hlk/)</span><span class="sxs-lookup"><span data-stu-id="be974-128">For information about code signing protected media components, see the white paper [Code Signing for Protected Media Components in Windows Vista](/windows-hardware/test/hlk/)</span></span>

<span data-ttu-id="be974-129">Nella figura seguente viene illustrata l'origine multimediale creata nel processo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="be974-129">The following illustration shows the media source created in the application process.</span></span>

![illustrazione di un'origine multimediale nel processo dell'applicazione.](images/pmp02.png)

<span data-ttu-id="be974-131">Un'altra alternativa consiste nel creare l'origine multimediale all'interno della sessione PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-131">Another alternative is to create the media source inside the PMP session.</span></span>

1.  <span data-ttu-id="be974-132">Impostare l'attributo [**MF \_ Session \_ Remote \_ source \_ mode**](mf-session-remote-source-mode-attribute.md) quando si crea la sessione multimediale.</span><span class="sxs-lookup"><span data-stu-id="be974-132">Set the [**MF\_SESSION\_REMOTE\_SOURCE\_MODE**](mf-session-remote-source-mode-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="be974-133">Gli attributi di configurazione sono specificati nel parametro *pConfiguration* della funzione [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="be974-133">Configuration attributes are specified in the *pConfiguration* parameter of the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span>
2.  <span data-ttu-id="be974-134">Chiamare [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) nella sessione multimediale per ottenere un puntatore all'interfaccia [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) .</span><span class="sxs-lookup"><span data-stu-id="be974-134">Call [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) on the Media Session to get a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface.</span></span> <span data-ttu-id="be974-135">L'identificatore del servizio è il **\_ \_ servizio MF PMP**.</span><span class="sxs-lookup"><span data-stu-id="be974-135">The service identifier is **MF\_PMP\_SERVICE**.</span></span>
3.  <span data-ttu-id="be974-136">Chiamare [**IMFPMPHost:: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) con l'identificatore di classe **CLSID \_ MFSourceResolver** per creare il resolver di origine all'interno del processo PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-136">Call [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) with the class identifier **CLSID\_MFSourceResolver** to create the source resolver inside the PMP process.</span></span> <span data-ttu-id="be974-137">Il metodo restituisce un puntatore a un proxy per il resolver di origine.</span><span class="sxs-lookup"><span data-stu-id="be974-137">The method returns a pointer to a proxy for the source resolver.</span></span>
4.  <span data-ttu-id="be974-138">Chiamare [**IMFSourceResolver:: BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) o [**IMFSourceResolver:: BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) per creare l'origine multimediale.</span><span class="sxs-lookup"><span data-stu-id="be974-138">Call [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) to create the media source.</span></span>
    > [!Note]  
    > <span data-ttu-id="be974-139">In questo caso, è necessario usare le versioni asincrone di questi metodi, perché le versioni sincrone non sono utilizzabili in remoto.</span><span class="sxs-lookup"><span data-stu-id="be974-139">In this case, you must use the asynchronous versions of these methods, because the synchronous versions are not remotable.</span></span>

     

<span data-ttu-id="be974-140">La figura seguente mostra l'origine multimediale creata nel processo PMP.</span><span class="sxs-lookup"><span data-stu-id="be974-140">The following illustration shows the media source created in the PMP process.</span></span>

![illustrazione di un'origine multimediale nel processo PMP.](images/pmp03.png)

## <a name="related-topics"></a><span data-ttu-id="be974-142">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="be974-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="be974-143">Come riprodurre file multimediali protetti</span><span class="sxs-lookup"><span data-stu-id="be974-143">How to Play Protected Media Files</span></span>](how-to-play-protected-media-files.md)
</dt> <dt>

[<span data-ttu-id="be974-144">Sessione multimediale</span><span class="sxs-lookup"><span data-stu-id="be974-144">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="be974-145">Percorso supporto protetto</span><span class="sxs-lookup"><span data-stu-id="be974-145">Protected Media Path</span></span>](protected-media-path.md)
</dt> </dl>

 

 
