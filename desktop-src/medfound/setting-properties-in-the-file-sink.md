---
description: Il sink di file ASF è un'implementazione di IMFMediaSink fornita da Media Foundation che un'applicazione può usare per archiviare i dati del supporto ASF in un file. Per informazioni sul modello a oggetti dei sink multimediali ASF e sull'utilizzo generale, vedere la pagina relativa ai sink di supporto ASF.
ms.assetid: a47caabd-23e3-4d22-b4b6-5fdb79d62ca1
title: Impostazione delle proprietà nel sink di file
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30af39cf13e88f6edf2a6ab68caac27c2400955a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104344401"
---
# <a name="setting-properties-in-the-file-sink"></a><span data-ttu-id="8a15c-104">Impostazione delle proprietà nel sink di file</span><span class="sxs-lookup"><span data-stu-id="8a15c-104">Setting Properties in the File Sink</span></span>

<span data-ttu-id="8a15c-105">Il sink di file ASF è un'implementazione di [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) fornita da Media Foundation che un'applicazione può usare per archiviare i dati del supporto ASF in un file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-105">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="8a15c-106">Per informazioni sul modello a oggetti dei sink multimediali ASF e sull'utilizzo generale, vedere la pagina relativa ai [sink di supporto ASF](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="8a15c-106">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="8a15c-107">Dopo aver [creato il sink di file ASF](creating-the-asf-file-sink.md), è necessario configurarlo con informazioni sui flussi nel file di output.</span><span class="sxs-lookup"><span data-stu-id="8a15c-107">After [Creating the ASF file sink](creating-the-asf-file-sink.md), it must be configured with information about the streams in the output file.</span></span> <span data-ttu-id="8a15c-108">Questa procedura è descritta in [aggiunta di informazioni sul flusso al sink di file ASF](adding-stream-information-to-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="8a15c-108">This procedure is described in [Adding Stream Information to the ASF File Sink](adding-stream-information-to-the-asf-file-sink.md).</span></span> <span data-ttu-id="8a15c-109">È possibile impostare proprietà aggiuntive sul sink di file a seconda del tipo di codifica; Bucket persi; Proprietà generali del file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-109">You can set additional properties on the file sink depending on the type of encoding; leaky buckets; general file properties.</span></span> <span data-ttu-id="8a15c-110">Queste impostazioni non vengono scritte nell'oggetto intestazione ASF finale.</span><span class="sxs-lookup"><span data-stu-id="8a15c-110">These settings are not written in the final ASF Header Object.</span></span> <span data-ttu-id="8a15c-111">In questo argomento viene descritto il processo di aggiunta di queste proprietà nell'archivio delle proprietà del sink di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-111">This topic describes process of adding these properties in the file sink's property store.</span></span>

<span data-ttu-id="8a15c-112">L'oggetto ContentInfo mantiene le proprietà del file globale e le singole proprietà del flusso per il sink di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-112">The ContentInfo object maintains the global file properties and individual stream properties for the file sink.</span></span> <span data-ttu-id="8a15c-113">Per informazioni su come ottenere un riferimento all'oggetto ASF di sink di file, vedere [creazione del sink di file ASF](creating-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="8a15c-113">For information about getting a reference to the file sink's ASF ContentInfo object, see [Creating the ASF File Sink](creating-the-asf-file-sink.md).</span></span>

<span data-ttu-id="8a15c-114">Per ottenere un riferimento all'archivio delle proprietà ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)) del sink di file, chiamare [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) sul riferimento dell'oggetto ContentInfo del sink di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-114">To get a reference to the file sink's property store ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) on the file sink's ContentInfo object's reference.</span></span>

## <a name="stream-encoding-properties"></a><span data-ttu-id="8a15c-115">Proprietà di codifica del flusso</span><span class="sxs-lookup"><span data-stu-id="8a15c-115">Stream Encoding Properties</span></span>

<span data-ttu-id="8a15c-116">Per codificare correttamente il contenuto, è necessario che il file conosca determinate informazioni di codifica, ad esempio il tipo di codifica e i parametri di codifica correlati.</span><span class="sxs-lookup"><span data-stu-id="8a15c-116">To encode content properly the file needs to know certain encoding information such as type of encoding and the related encoding parameters.</span></span> <span data-ttu-id="8a15c-117">Questi valori vengono impostati nel sink di file come valori di proprietà in un archivio di proprietà gestito dall'oggetto ContentInfo ASF.</span><span class="sxs-lookup"><span data-stu-id="8a15c-117">These values are set on the file sink as property values in a property store that is maintained by the ASF ContentInfo object.</span></span> <span data-ttu-id="8a15c-118">Se si sta configurando il sink di file prima di creare un'istanza dei codificatori pertinenti, è possibile usare l'oggetto ContentInfo con tutte le proprietà popolate per creare i codificatori Windows Media.</span><span class="sxs-lookup"><span data-stu-id="8a15c-118">If you are configuring the file sink before instantiating the relevant encoders, you can use the ContentInfo object with all the populated properties to create the Windows Media encoders.</span></span> <span data-ttu-id="8a15c-119">In questo caso, le proprietà vengono impostate automaticamente nei codificatori di cui è stata creata un'istanza.</span><span class="sxs-lookup"><span data-stu-id="8a15c-119">In this case, the properties are automatically set on the instantiated encoders.</span></span> <span data-ttu-id="8a15c-120">Viceversa, se si creano i codificatori prima del sink, assicurarsi che le proprietà impostate nei codificatori vengano copiate nell'archivio delle proprietà del sink di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-120">Conversely, if you are creating the encoders before the sink, make sure that the properties that you set on the encoders are copied into the file sink's property store.</span></span>

<span data-ttu-id="8a15c-121">Per impostare le proprietà di codifica, è necessario accedere all'archivio delle proprietà a livello di flusso del sink di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-121">To set encoding properties, you need access to the file sink's stream-level property store.</span></span> <span data-ttu-id="8a15c-122">Passare il numero del flusso nel parametro *wStreamNumber* del metodo [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="8a15c-122">Pass the stream number in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="8a15c-123">I numeri di flusso devono corrispondere ai valori impostati durante la configurazione di ogni flusso nel profilo.</span><span class="sxs-lookup"><span data-stu-id="8a15c-123">The stream numbers must match the values set while configuring each stream in the profile.</span></span> <span data-ttu-id="8a15c-124">I valori delle proprietà vengono impostati chiamando [**IPropertyStore:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="8a15c-124">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="8a15c-125">Nella tabella seguente vengono descritte le proprietà supportate.</span><span class="sxs-lookup"><span data-stu-id="8a15c-125">The following table describes the supported properties.</span></span>

<span data-ttu-id="8a15c-126">Le proprietà dipendono dal tipo di codifica.</span><span class="sxs-lookup"><span data-stu-id="8a15c-126">The properties depend on the type of encoding.</span></span> <span data-ttu-id="8a15c-127">Per informazioni sulle proprietà e sui rispettivi valori che è necessario impostare, vedere [Encoding Properties (proprietà di codifica](configuring-the-encoder.md)).</span><span class="sxs-lookup"><span data-stu-id="8a15c-127">For information about the properties and the respective values that you must set, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="leaky-bucket-property"></a><span data-ttu-id="8a15c-128">Proprietà bucket a perdita</span><span class="sxs-lookup"><span data-stu-id="8a15c-128">Leaky Bucket Property</span></span>

<span data-ttu-id="8a15c-129">I parametri bucket a perdita determinano la finestra del buffer effettiva utilizzata dal codificatore per il flusso.</span><span class="sxs-lookup"><span data-stu-id="8a15c-129">Leaky bucket parameters determine the actual buffer window used by the encoder for the stream.</span></span> <span data-ttu-id="8a15c-130">La proprietà [**MFPKEY ASFSTREAMSINK con \_ \_ correzione \_**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) del sink di file contiene i parametri del bucket di perdita, la velocità in bit, la finestra del buffer e la completezza del buffer iniziale. Questa proprietà viene impostata nell'archivio delle proprietà della proprietà a livello di flusso per il sink di file e deve essere impostata dopo la creazione e la configurazione di codificatori.</span><span class="sxs-lookup"><span data-stu-id="8a15c-130">The file sink's [**MFPKEY\_ASFSTREAMSINK\_CORRECTED\_LEAKYBUCKET**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) property contains the leaky bucket parameters, bit rate, buffer window, and initial buffer fullness.This property is set in the stream-level property property store for the file sink and must be set after encoders have been created and configured.</span></span> <span data-ttu-id="8a15c-131">Questo valore viene impostato nell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="8a15c-131">This value is set in the .</span></span> <span data-ttu-id="8a15c-132">Durante la negoziazione del tipo di supporto, il codificatore decide la finestra del buffer e la velocità in bit da usare.</span><span class="sxs-lookup"><span data-stu-id="8a15c-132">During the media type negotiation, the encoder decides the buffer window and the bit rate to use.</span></span> <span data-ttu-id="8a15c-133">È possibile ottenere questi valori usando l'interfaccia **IWMCodecLeakyBucket** , definita in wmcodecifaces. h ed è necessario collegarsi a wmcodecdspuuid. lib per chiamare i relativi metodi.</span><span class="sxs-lookup"><span data-stu-id="8a15c-133">You can get these values by using the **IWMCodecLeakyBucket** interface, which is defined in wmcodecifaces.h and you must link to wmcodecdspuuid.lib to call its methods.</span></span>

<span data-ttu-id="8a15c-134">I valori recuperati possono essere impostati per questa proprietà per ogni flusso nel sink di file ASF.</span><span class="sxs-lookup"><span data-stu-id="8a15c-134">The retrieved values can be set for this property for each stream in the ASF file sink.</span></span>

## <a name="global-file-sink-properties"></a><span data-ttu-id="8a15c-135">Proprietà di sink di file globali</span><span class="sxs-lookup"><span data-stu-id="8a15c-135">Global File Sink Properties</span></span>

<span data-ttu-id="8a15c-136">Per ottenere l'archivio delle proprietà globali del sink di file, passare 0 nel parametro *wStreamNumber* del metodo [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="8a15c-136">To get the file sink's global property store, pass 0 in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="8a15c-137">I valori delle proprietà vengono impostati chiamando [**IPropertyStore:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="8a15c-137">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="8a15c-138">Nella tabella seguente vengono descritte le proprietà supportate.</span><span class="sxs-lookup"><span data-stu-id="8a15c-138">The following table describes the supported properties.</span></span>

| <span data-ttu-id="8a15c-139">Proprietà a livello di file</span><span class="sxs-lookup"><span data-stu-id="8a15c-139">File-level Properties</span></span>                                                                                | <span data-ttu-id="8a15c-140">Descrizione</span><span class="sxs-lookup"><span data-stu-id="8a15c-140">Description</span></span>                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a15c-141">**MFPKEY \_ ASFMEDIASINK \_ base \_ SENDTIME**</span><span class="sxs-lookup"><span data-stu-id="8a15c-141">**MFPKEY\_ASFMEDIASINK\_BASE\_SENDTIME**</span></span>](mfpkey-asfmediasink-base-sendtime-property.md)           | <span data-ttu-id="8a15c-142">Il tempo di invio indica quando verrà rilasciato il payload all'interno del bucket.</span><span class="sxs-lookup"><span data-stu-id="8a15c-142">The send time indicates when the payload inside the leaky bucket will be released.</span></span> <span data-ttu-id="8a15c-143">Il valore di questa proprietà indica il primo tempo di invio.</span><span class="sxs-lookup"><span data-stu-id="8a15c-143">This property value indicates the first send time.</span></span> <span data-ttu-id="8a15c-144">Il multiplexer utilizza questo valore per calcolare i tempi di invio successivi per i pacchetti generati e garantisce che i dati scorrano costantemente attraverso il bucket.</span><span class="sxs-lookup"><span data-stu-id="8a15c-144">The multiplexer uses this value to calculate the subsequent send times for the generated packets and ensures that data flows steadily through the leaky bucket.</span></span> |
| [<span data-ttu-id="8a15c-145">**velocità in bit di MFPKEY \_ ASFMEDIASINK \_ AutoAdjust \_**</span><span class="sxs-lookup"><span data-stu-id="8a15c-145">**MFPKEY\_ASFMEDIASINK\_AUTOADJUST\_BITRATE**</span></span>](mfpkey-asfmediasink-autoadjust-bitrate-property.md) | <span data-ttu-id="8a15c-146">Questo valore BOOL indica se il multiplexer deve modificare automaticamente la velocità in bit per assicurarsi che i dati non vengano sottoposto a overflow nel bucket.</span><span class="sxs-lookup"><span data-stu-id="8a15c-146">This BOOL value indicates whether the multiplexer needs to adjust the bit rate automatically to ensure that data does not overflow the leaky bucket.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="8a15c-147">**MFPKEY \_ ASFMEDIASINK \_ DRMACTION**</span><span class="sxs-lookup"><span data-stu-id="8a15c-147">**MFPKEY\_ASFMEDIASINK\_DRMACTION**</span></span>](mfpkey-asfmediasink-drmaction-property.md)                    | <span data-ttu-id="8a15c-148">Ciò indica l'azione DRM del sink multimediale ASF per la generazione di file.</span><span class="sxs-lookup"><span data-stu-id="8a15c-148">This indicates the ASF media sink DRM action for file generation.</span></span> <span data-ttu-id="8a15c-149">In questa versione è supportata solo la transcodifica DRM.</span><span class="sxs-lookup"><span data-stu-id="8a15c-149">In this release, only DRM transcode is supported.</span></span>                                                                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="8a15c-150">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8a15c-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8a15c-151">Sink di supporti ASF</span><span class="sxs-lookup"><span data-stu-id="8a15c-151">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="8a15c-152">Componenti ASF a livello pipeline</span><span class="sxs-lookup"><span data-stu-id="8a15c-152">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="8a15c-153">Supporto ASF in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="8a15c-153">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
