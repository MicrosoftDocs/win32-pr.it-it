---
description: Oggetto che incapsula diversi DSP correlati all'acquisizione vocale.
ms.assetid: 6c77c8f6-289e-4130-b56a-e1f0bcc40f3e
title: DSP di acquisizione vocale (Wmcodecdsp. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6e48c3b3194873008f45ef80ef3a21dad416158b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103755226"
---
# <a name="voice-capture-dsp"></a><span data-ttu-id="834e9-103">DSP di acquisizione vocale</span><span class="sxs-lookup"><span data-stu-id="834e9-103">Voice Capture DSP</span></span>

<span data-ttu-id="834e9-104">Oggetto che incapsula diversi DSP correlati all'acquisizione vocale.</span><span class="sxs-lookup"><span data-stu-id="834e9-104">An object that encapsulates several DSPs related to voice capture.</span></span>

## <a name="clsid"></a><span data-ttu-id="834e9-105">CLSID</span><span class="sxs-lookup"><span data-stu-id="834e9-105">CLSID</span></span>

<span data-ttu-id="834e9-106">\_CWMAUDIOAEC CLSID</span><span class="sxs-lookup"><span data-stu-id="834e9-106">CLSID\_CWMAudioAEC</span></span>

## <a name="interfaces"></a><span data-ttu-id="834e9-107">Interfacce</span><span class="sxs-lookup"><span data-stu-id="834e9-107">Interfaces</span></span>

-   [<span data-ttu-id="834e9-108">**IMediaObject**</span><span class="sxs-lookup"><span data-stu-id="834e9-108">**IMediaObject**</span></span>](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)
-   <span data-ttu-id="834e9-109">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="834e9-109">**IPropertyStore**</span></span>

## <a name="properties"></a><span data-ttu-id="834e9-110">Proprietà</span><span class="sxs-lookup"><span data-stu-id="834e9-110">Properties</span></span>



| <span data-ttu-id="834e9-111">Proprietà</span><span class="sxs-lookup"><span data-stu-id="834e9-111">Property</span></span>                                                                                     | <span data-ttu-id="834e9-112">Descrizione</span><span class="sxs-lookup"><span data-stu-id="834e9-112">Description</span></span>                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="834e9-113">indici del \_ dispositivo WMAAECMA di MFPKEY \_ \_</span><span class="sxs-lookup"><span data-stu-id="834e9-113">MFPKEY\_WMAAECMA\_DEVICE\_INDEXES</span></span>](mfpkey-wmaaecma-device-indexesproperty.md)              | <span data-ttu-id="834e9-114">Specifica i dispositivi audio usati da DMO per l'acquisizione e il rendering dell'audio.</span><span class="sxs-lookup"><span data-stu-id="834e9-114">Specifies which audio devices the DMO uses for capturing and rendering audio.</span></span>                     |
| [<span data-ttu-id="834e9-115">\_ \_ GUID DEVICEPAIR WMAAECMA \_ MFPKEY</span><span class="sxs-lookup"><span data-stu-id="834e9-115">MFPKEY\_WMAAECMA\_DEVICEPAIR\_GUID</span></span>](mfpkey-wmaaecma-devicepair-guidproperty.md)            | <span data-ttu-id="834e9-116">Identifica la combinazione di dispositivi audio attualmente in uso nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="834e9-116">Identifies the combination of audio devices that the application is currently using.</span></span>              |
| [<span data-ttu-id="834e9-117">\_ \_ \_ modalità origine MFPKEY WMAAECMA \_ DMO</span><span class="sxs-lookup"><span data-stu-id="834e9-117">MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE</span></span>](mfpkey-wmaaecma-dmo-source-modeproperty.md)           | <span data-ttu-id="834e9-118">Specifica se DMO utilizza la modalità di origine o filtro.</span><span class="sxs-lookup"><span data-stu-id="834e9-118">Specifies whether the DMO uses source mode or filter mode.</span></span>                                        |
| [<span data-ttu-id="834e9-119">MFPKEY \_ WMAAECMA \_ featr \_ AES</span><span class="sxs-lookup"><span data-stu-id="834e9-119">MFPKEY\_WMAAECMA\_FEATR\_AES</span></span>](mfpkey-wmaaecma-featr-aesproperty.md)                        | <span data-ttu-id="834e9-120">Specifica il numero di volte in cui DMO esegue l'eliminazione dell'eco acustico (AES) sul segnale residuo.</span><span class="sxs-lookup"><span data-stu-id="834e9-120">Specifies how many times the DMO performs acoustic echo suppression (AES) on the residual signal.</span></span> |
| [<span data-ttu-id="834e9-121">MFPKEY \_ WMAAECMA \_ featr \_ AGC</span><span class="sxs-lookup"><span data-stu-id="834e9-121">MFPKEY\_WMAAECMA\_FEATR\_AGC</span></span>](mfpkey-wmaaecma-featr-agcproperty.md)                        | <span data-ttu-id="834e9-122">Specifica se DMO esegue il controllo di guadagno automatico.</span><span class="sxs-lookup"><span data-stu-id="834e9-122">Specifies whether the DMO performs automatic gain control.</span></span>                                        |
| [<span data-ttu-id="834e9-123">\_clip MFPKEY WMAAECMA \_ featr \_ Center \_</span><span class="sxs-lookup"><span data-stu-id="834e9-123">MFPKEY\_WMAAECMA\_FEATR\_CENTER\_CLIP</span></span>](mfpkey-wmaaecma-featr-center-clipproperty.md)       | <span data-ttu-id="834e9-124">Specifica se DMO esegue il ritaglio al centro.</span><span class="sxs-lookup"><span data-stu-id="834e9-124">Specifies whether the DMO performs center clipping.</span></span>                                               |
| [<span data-ttu-id="834e9-125">\_lunghezza Echo MFPKEY WMAAECMA \_ featr \_ \_</span><span class="sxs-lookup"><span data-stu-id="834e9-125">MFPKEY\_WMAAECMA\_FEATR\_ECHO\_LENGTH</span></span>](mfpkey-wmaaecma-featr-echo-lengthproperty.md)       | <span data-ttu-id="834e9-126">Specifica la durata di ECHO che l'algoritmo AEC (Acoustic Echo Cancel) può gestire.</span><span class="sxs-lookup"><span data-stu-id="834e9-126">Specifies the duration of echo that the acoustic echo cancellation (AEC) algorithm can handle.</span></span>    |
| [<span data-ttu-id="834e9-127">\_dimensioni frame MFPKEY WMAAECMA \_ Feater \_ \_</span><span class="sxs-lookup"><span data-stu-id="834e9-127">MFPKEY\_WMAAECMA\_FEATR\_FRAME\_SIZE</span></span>](mfpkey-wmaaecma-featr-frame-sizeproperty.md)         | <span data-ttu-id="834e9-128">Specifica la dimensione del frame audio.</span><span class="sxs-lookup"><span data-stu-id="834e9-128">Specifies the audio frame size.</span></span>                                                                   |
| [<span data-ttu-id="834e9-129">MFPKEY \_ WMAAECMA \_ Feater \_ MICARR \_ Beam</span><span class="sxs-lookup"><span data-stu-id="834e9-129">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_BEAM</span></span>](mfpkey-wmaaecma-featr-micarr-beamproperty.md)       | <span data-ttu-id="834e9-130">Specifica il fascio utilizzato da DMO per l'elaborazione di matrici di microfoni.</span><span class="sxs-lookup"><span data-stu-id="834e9-130">Specifies which beam the DMO uses for microphone array processing.</span></span>                                |
| [<span data-ttu-id="834e9-131">\_modalità MFPKEY WMAAECMA \_ featr \_ MICARR \_</span><span class="sxs-lookup"><span data-stu-id="834e9-131">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_MODE</span></span>](mfpkey-wmaaecma-featr-micarr-modeproperty.md)       | <span data-ttu-id="834e9-132">Specifica il modo in cui DMO esegue l'elaborazione di matrici di microfoni.</span><span class="sxs-lookup"><span data-stu-id="834e9-132">Specifies how the DMO performs microphone array processing.</span></span>                                       |
| [<span data-ttu-id="834e9-133">MFPKEY \_ WMAAECMA \_ featr \_ MICARR \_ Preproc</span><span class="sxs-lookup"><span data-stu-id="834e9-133">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_PREPROC</span></span>](mfpkey-wmaaecma-featr-micarr-preprocproperty.md) | <span data-ttu-id="834e9-134">Specifica se DMO esegue la pre-elaborazione della matrice di microfoni.</span><span class="sxs-lookup"><span data-stu-id="834e9-134">Specifies whether the DMO performs microphone array preprocessing.</span></span>                                |
| [<span data-ttu-id="834e9-135">\_riempimento rumore MFPKEY WMAAECMA \_ featr \_ \_</span><span class="sxs-lookup"><span data-stu-id="834e9-135">MFPKEY\_WMAAECMA\_FEATR\_NOISE\_FILL</span></span>](mfpkey-wmaaecma-featr-noise-fillproperty.md)         | <span data-ttu-id="834e9-136">Specifica se DMO esegue il riempimento del rumore.</span><span class="sxs-lookup"><span data-stu-id="834e9-136">Specifies whether the DMO performs noise filling.</span></span>                                                 |
| [<span data-ttu-id="834e9-137">\_NS MFPKEY WMAAECMA \_ featr \_</span><span class="sxs-lookup"><span data-stu-id="834e9-137">MFPKEY\_WMAAECMA\_FEATR\_NS</span></span>](mfpkey-wmaaecma-featr-nsproperty.md)                          | <span data-ttu-id="834e9-138">Specifica se DMO esegue l'eliminazione del rumore.</span><span class="sxs-lookup"><span data-stu-id="834e9-138">Specifies whether the DMO performs noise suppression.</span></span>                                             |
| [<span data-ttu-id="834e9-139">\_VAD MFPKEY WMAAECMA \_ featr \_</span><span class="sxs-lookup"><span data-stu-id="834e9-139">MFPKEY\_WMAAECMA\_FEATR\_VAD</span></span>](mfpkey-wmaaecma-featr-vadproperty.md)                        | <span data-ttu-id="834e9-140">Specifica il tipo di rilevamento di attività vocali eseguito da DMO.</span><span class="sxs-lookup"><span data-stu-id="834e9-140">Specifies the type of voice activity detection that the DMO performs.</span></span>                             |
| [<span data-ttu-id="834e9-141">\_ \_ modalità funzionalità WMAAECMA \_ MFPKEY</span><span class="sxs-lookup"><span data-stu-id="834e9-141">MFPKEY\_WMAAECMA\_FEATURE\_MODE</span></span>](mfpkey-wmaaecma-feature-modeproperty.md)                  | <span data-ttu-id="834e9-142">Consente all'applicazione di eseguire l'override delle impostazioni predefinite di diverse proprietà.</span><span class="sxs-lookup"><span data-stu-id="834e9-142">Enables the application to override the default settings on various properties.</span></span>                   |
| [<span data-ttu-id="834e9-143">\_ \_ \_ limite guadagno MFPKEY WMAAECMA \_ MIC</span><span class="sxs-lookup"><span data-stu-id="834e9-143">MFPKEY\_WMAAECMA\_MIC\_GAIN\_BOUNDER</span></span>](mfpkey-wmaaecma-mic-gain-bounderproperty.md)         | <span data-ttu-id="834e9-144">Specifica se DMO applica la delimitazione del guadagno del microfono.</span><span class="sxs-lookup"><span data-stu-id="834e9-144">Specifies whether the DMO applies microphone gain bounding.</span></span>                                       |
| [<span data-ttu-id="834e9-145">MFPKEY \_ WMAAECMA \_ MICARRAY \_ DESCPTR</span><span class="sxs-lookup"><span data-stu-id="834e9-145">MFPKEY\_WMAAECMA\_MICARRAY\_DESCPTR</span></span>](mfpkey-wmaaecma-micarray-descptrproperty.md)          | <span data-ttu-id="834e9-146">Specifica la geometria della matrice di microfoni.</span><span class="sxs-lookup"><span data-stu-id="834e9-146">Specifies the microphone array geometry.</span></span>                                                          |
| [<span data-ttu-id="834e9-147">\_metrica della \_ qualità \_ WMAAECMA di MFPKEY</span><span class="sxs-lookup"><span data-stu-id="834e9-147">MFPKEY\_WMAAECMA\_QUALITY\_METRICS</span></span>](mfpkey-wmaaecma-quality-metricsproperty.md)            | <span data-ttu-id="834e9-148">Recupera le metriche di qualità per AEC.</span><span class="sxs-lookup"><span data-stu-id="834e9-148">Retrieves quality metrics for AEC.</span></span>                                                                |
| [<span data-ttu-id="834e9-149">MFPKEY \_ WMAAECMA \_ recuperare le \_ statistiche di Servizi terminal \_</span><span class="sxs-lookup"><span data-stu-id="834e9-149">MFPKEY\_WMAAECMA\_RETRIEVE\_TS\_STATS</span></span>](mfpkey-wmaaecma-retrieve-ts-statsproperty.md)       | <span data-ttu-id="834e9-150">Specifica se DMO archivia le statistiche relative al timestamp nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="834e9-150">Specifies whether the DMO stores time stamp statistics in the registry.</span></span>                           |
| [<span data-ttu-id="834e9-151">\_modalità di \_ sistema \_ WMAAECMA di MFPKEY</span><span class="sxs-lookup"><span data-stu-id="834e9-151">MFPKEY\_WMAAECMA\_SYSTEM\_MODE</span></span>](mfpkey-wmaaecma-system-modeproperty.md)                    | <span data-ttu-id="834e9-152">Imposta la modalità di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="834e9-152">Sets the processing mode.</span></span>                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="834e9-153">Commenti</span><span class="sxs-lookup"><span data-stu-id="834e9-153">Remarks</span></span>

<span data-ttu-id="834e9-154">Diversamente dagli altri DSP, l'oggetto di acquisizione vocale incapsula più DSP in un singolo oggetto e l'oggetto è solo un oggetto DMO (non implementa [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span><span class="sxs-lookup"><span data-stu-id="834e9-154">Unlike the other DSPs, the voice capture object encapsulates multiple DSPs in a single object, and the object is a DMO object only (it does not implement [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span></span> <span data-ttu-id="834e9-155">Il DMO di acquisizione voce include i componenti DSP seguenti:</span><span class="sxs-lookup"><span data-stu-id="834e9-155">The voice capture DMO includes the following DSP components:</span></span>

-   <span data-ttu-id="834e9-156">Annullamento Echo acustico (AEC)</span><span class="sxs-lookup"><span data-stu-id="834e9-156">Acoustic echo cancellation (AEC)</span></span>
-   <span data-ttu-id="834e9-157">Elaborazione di matrici di microfoni</span><span class="sxs-lookup"><span data-stu-id="834e9-157">Microphone array processing</span></span>
-   <span data-ttu-id="834e9-158">Eliminazione del rumore</span><span class="sxs-lookup"><span data-stu-id="834e9-158">Noise suppression</span></span>
-   <span data-ttu-id="834e9-159">Controllo di guadagno automatico</span><span class="sxs-lookup"><span data-stu-id="834e9-159">Automatic gain control</span></span>
-   <span data-ttu-id="834e9-160">Rilevamento di attività vocali</span><span class="sxs-lookup"><span data-stu-id="834e9-160">Voice activity detection</span></span>

<span data-ttu-id="834e9-161">Le applicazioni possono attivare e disattivare ogni componente singolarmente.</span><span class="sxs-lookup"><span data-stu-id="834e9-161">Applications can turn each component on and off individually.</span></span>

<span data-ttu-id="834e9-162">Il servizio di acquisizione voce DMO supporta due modalità operative, modalità *filtro* e modalità *origine* .</span><span class="sxs-lookup"><span data-stu-id="834e9-162">The voice capture DMO supports two modes of operation, *filter* mode and *source* mode.</span></span> <span data-ttu-id="834e9-163">In modalità filtro, l'applicazione invia esempi di audio dal microfono e dalla linea di altoparlanti a DMO e DMO produce l'output.</span><span class="sxs-lookup"><span data-stu-id="834e9-163">In filter mode, the application sends audio samples from the microphone and from the speaker line to the DMO, and the DMO produces output.</span></span>

<span data-ttu-id="834e9-164">In modalità origine, l'applicazione non deve recapitare campioni a DMO.</span><span class="sxs-lookup"><span data-stu-id="834e9-164">In source mode, the application does not need to deliver samples to the DMO.</span></span> <span data-ttu-id="834e9-165">Al contrario, DMO gestisce tutte le operazioni sui dispositivi audio, tra cui l'inizializzazione dei dispositivi, l'acquisizione e la sincronizzazione dei flussi audio, il calcolo dei timestamp e il recupero della geometria della matrice microfonica.</span><span class="sxs-lookup"><span data-stu-id="834e9-165">Instead, the DMO manages all of the operations on the audio devices, including initializing the devices, capturing and synchronizing the audio streams, calculating time stamps, and retrieving the geometry of the microphone array.</span></span> <span data-ttu-id="834e9-166">Utilizzando la modalità origine, l'applicazione configura semplicemente DMO e l'output di DMO è un segnale del microfono pulito ed elaborato.</span><span class="sxs-lookup"><span data-stu-id="834e9-166">Using source mode, the application simply configures the DMO, and the output from the DMO is a clean, processed microphone signal.</span></span> <span data-ttu-id="834e9-167">La modalità di origine è molto più semplice da utilizzare rispetto alla modalità filtro ed è consigliata per la maggior parte delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="834e9-167">Source mode is significantly easier to use than filter mode, and is recommended for most applications.</span></span>

<span data-ttu-id="834e9-168">Attualmente la funzionalità di acquisizione voce DMO supporta solo l'annullamento dell'eco acustico a canale singolo (AEC), quindi l'output della linea del parlante deve essere a canale singolo.</span><span class="sxs-lookup"><span data-stu-id="834e9-168">Currently the voice capture DMO supports only single-channel acoustic echo cancellation (AEC), so the output from the speaker line must be single-channel.</span></span> <span data-ttu-id="834e9-169">Se l'elaborazione della matrice microfonica è disabilitata, l'input multicanale viene ripiegato verso il basso su un canale per l'elaborazione AEC.</span><span class="sxs-lookup"><span data-stu-id="834e9-169">If microphone array processing is disabled, multi-channel input is folded down to one channel for AEC processing.</span></span> <span data-ttu-id="834e9-170">Se sono abilitate sia l'elaborazione dell'array di microfoni che l'elaborazione AEC, l'AEC viene eseguito su ogni elemento Microphone prima dell'elaborazione della matrice del microfono.</span><span class="sxs-lookup"><span data-stu-id="834e9-170">If both microphone array processing and AEC processing are enabled, AEC is performed on each microphone element before microphone array processing.</span></span>

### <a name="microphone-array-processing"></a><span data-ttu-id="834e9-171">Elaborazione di matrici di microfoni</span><span class="sxs-lookup"><span data-stu-id="834e9-171">Microphone Array Processing</span></span>

<span data-ttu-id="834e9-172">Una matrice di microfoni è un set di microfoni molto posizionati.</span><span class="sxs-lookup"><span data-stu-id="834e9-172">A microphone array is a set of closely positioned microphones.</span></span> <span data-ttu-id="834e9-173">Gli array di microfoni raggiungono una maggiore direzionalità rispetto a un singolo microfono, perché le onde acustiche arrivano a ogni microfono in un momento leggermente diverso.</span><span class="sxs-lookup"><span data-stu-id="834e9-173">Microphone arrays achieve better directionality than a single microphone, because the acoustic waves arrive at each microphone at a slightly different time.</span></span> <span data-ttu-id="834e9-174">Per ulteriori informazioni sugli array di microfoni, vedere l'articolo relativo al [supporto di matrici di microfoni in Windows Vista](/windows-hardware/design/component-guidelines/audio) e [come creare e utilizzare matrici di microfoni per Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span><span class="sxs-lookup"><span data-stu-id="834e9-174">For more information on microphone arrays see the web articles [Microphone Array Support in Windows Vista](/windows-hardware/design/component-guidelines/audio) and [How to Build and Use Microphone Arrays for Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span></span>

### <a name="using-the-voice-capture-dsp"></a><span data-ttu-id="834e9-175">Uso del DSP di acquisizione vocale</span><span class="sxs-lookup"><span data-stu-id="834e9-175">Using the Voice Capture DSP</span></span>

<span data-ttu-id="834e9-176">Per usare il DSP di acquisizione vocale, seguire questa procedura.</span><span class="sxs-lookup"><span data-stu-id="834e9-176">To use the Voice Capture DSP, perform the following steps.</span></span>

### <a name="1-initialize-the-dmo"></a><span data-ttu-id="834e9-177">1. inizializzare DMO</span><span class="sxs-lookup"><span data-stu-id="834e9-177">1. Initialize the DMO</span></span>

<span data-ttu-id="834e9-178">Creare il DMO di acquisizione vocale chiamando [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) con CLSID CLSID **\_ CWMAudioAEC**.</span><span class="sxs-lookup"><span data-stu-id="834e9-178">Create the voice capture DMO by calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID **CLSID\_CWMAudioAEC**.</span></span> <span data-ttu-id="834e9-179">Il DSDP di acquisizione vocale espone solo le interfacce [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) e [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) , quindi può essere usato solo come DMO.</span><span class="sxs-lookup"><span data-stu-id="834e9-179">The voice capture DSDP exposes only the [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) and [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interfaces, so it can only be used as a DMO.</span></span>

<span data-ttu-id="834e9-180">Il valore predefinito di DMO è la modalità di origine.</span><span class="sxs-lookup"><span data-stu-id="834e9-180">The DMO defaults to source mode.</span></span> <span data-ttu-id="834e9-181">Per selezionare la modalità di filtro, impostare la proprietà [MFPKEY \_ WMAAECMA \_ DMO \_ source \_ mode](mfpkey-wmaaecma-dmo-source-modeproperty.md) su **Variant \_ false**.</span><span class="sxs-lookup"><span data-stu-id="834e9-181">To select filter mode, set the [MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE](mfpkey-wmaaecma-dmo-source-modeproperty.md) property to **VARIANT\_FALSE**.</span></span>

<span data-ttu-id="834e9-182">Configurare quindi le proprietà interne di DMO usando l'interfaccia [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) .</span><span class="sxs-lookup"><span data-stu-id="834e9-182">Next, configure the internal properties of the DMO by using the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.</span></span> <span data-ttu-id="834e9-183">L'unica proprietà che un'applicazione deve impostare è la proprietà della [ \_ modalità di \_ sistema \_ MFPKEY WMAAECMA](mfpkey-wmaaecma-system-modeproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="834e9-183">The only property that an application must set is the [MFPKEY\_WMAAECMA\_SYSTEM\_MODE](mfpkey-wmaaecma-system-modeproperty.md) property.</span></span> <span data-ttu-id="834e9-184">Questa proprietà configura la pipeline di elaborazione all'interno di DMO.</span><span class="sxs-lookup"><span data-stu-id="834e9-184">This property configures the processing pipeline within the DMO.</span></span> <span data-ttu-id="834e9-185">Le altre proprietà sono facoltative.</span><span class="sxs-lookup"><span data-stu-id="834e9-185">The other properties are optional.</span></span>

### <a name="2-set-the-input-and-output-formats"></a><span data-ttu-id="834e9-186">2. impostare i formati di input e di output</span><span class="sxs-lookup"><span data-stu-id="834e9-186">2. Set the Input and Output Formats</span></span>

<span data-ttu-id="834e9-187">Se si utilizza DMO in modalità filtro, impostare il formato di input chiamando [**IMediaObject:: SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="834e9-187">If you are using the DMO in filter mode, set the input format by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span></span> <span data-ttu-id="834e9-188">Il formato di input può essere quasi qualsiasi tipo di audio a virgola mobile o PCM non compresso valido.</span><span class="sxs-lookup"><span data-stu-id="834e9-188">The input format can be almost any valid uncompressed PCM or IEEE floating-point audio type.</span></span> <span data-ttu-id="834e9-189">Se il formato di input non corrisponde al formato di output, DMO esegue automaticamente la conversione della frequenza di campionamento.</span><span class="sxs-lookup"><span data-stu-id="834e9-189">If the input format does not match the output format, the DMO automatically performs sample-rate conversion.</span></span>

<span data-ttu-id="834e9-190">Se si utilizza DMO in modalità origine, non impostare il formato di input.</span><span class="sxs-lookup"><span data-stu-id="834e9-190">If you are using the DMO in source mode, do not set the input format.</span></span> <span data-ttu-id="834e9-191">DMO configura automaticamente il formato di input in base ai dispositivi audio.</span><span class="sxs-lookup"><span data-stu-id="834e9-191">The DMO automatically configures the input format based on the audio devices.</span></span>

<span data-ttu-id="834e9-192">In entrambe le modalità impostare il formato di output chiamando [**IMediaObject:: SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="834e9-192">In either mode, set the output format by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="834e9-193">Il DMO può accettare i formati di output seguenti:</span><span class="sxs-lookup"><span data-stu-id="834e9-193">The DMO can accept the following output formats:</span></span>

-   <span data-ttu-id="834e9-194">Sottotipo: **MEDIASUBTYPE \_ PCM** o **MEDIASUBTYPE \_ IEEE \_ float**</span><span class="sxs-lookup"><span data-stu-id="834e9-194">Subtype: **MEDIASUBTYPE\_PCM** or **MEDIASUBTYPE\_IEEE\_FLOAT**</span></span>
-   <span data-ttu-id="834e9-195">Blocco di formato: [**WaveFormat**](/windows/win32/api/mmreg/ns-mmreg-waveformat) o [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="834e9-195">Format block: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span></span>
-   <span data-ttu-id="834e9-196">Campioni al secondo: 8.000; 11.025; 16.000; o 22.050</span><span class="sxs-lookup"><span data-stu-id="834e9-196">Samples per second: 8,000; 11,025; 16,000; or 22,050</span></span>
-   <span data-ttu-id="834e9-197">Canali: 1 per la modalità solo AEC, 2 o 4 per l'elaborazione di matrici di microfoni</span><span class="sxs-lookup"><span data-stu-id="834e9-197">Channels: 1 for AEC-only mode, 2 or 4 for microphone array processing</span></span>
-   <span data-ttu-id="834e9-198">BITS per campione: 16</span><span class="sxs-lookup"><span data-stu-id="834e9-198">Bits per sample: 16</span></span>

<span data-ttu-id="834e9-199">Il codice seguente imposta il tipo di output su audio PCM a canale singolo a 16 bit:</span><span class="sxs-lookup"><span data-stu-id="834e9-199">The following code sets the output type to 16-bit single-channel PCM audio:</span></span>


```
DMO_MEDIA_TYPE mt;  // Media type.
mt.majortype = MEDIATYPE_Audio;
mt.subtype = MEDIASUBTYPE_PCM;
mt.lSampleSize = 0;
mt.bFixedSizeSamples = TRUE;
mt.bTemporalCompression = FALSE;
mt.formattype = FORMAT_WaveFormatEx;

// Allocate the format block to hold the WAVEFORMATEX structure.
hr = MoInitMediaType(&mt, sizeof(WAVEFORMATEX));
if (SUCCEEDED(hr))
{
    WAVEFORMATEX *pwav = (WAVEFORMATEX*)mt.pbFormat;
    pwav->wFormatTag = WAVE_FORMAT_PCM;
    pwav->nChannels = 1;
    pwav->nSamplesPerSec = 16000;
    pwav->nAvgBytesPerSec = 32000;
    pwav->nBlockAlign = 2;
    pwav->wBitsPerSample = 16;
    pwav->cbSize = 0;

    // Set the output type.
    if (SUCCEEDED(hr))
    {
        hr = pDMO->SetOutputType(0, &mt, 0); 
    }
    // Free the format block.
    MoFreeMediaType(&mt);
}
```



### <a name="3-process-data"></a><span data-ttu-id="834e9-200">3. elaborare i dati</span><span class="sxs-lookup"><span data-stu-id="834e9-200">3. Process Data</span></span>

<span data-ttu-id="834e9-201">Prima di elaborare i dati, è consigliabile chiamare [**IMediaObject:: AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span><span class="sxs-lookup"><span data-stu-id="834e9-201">Before processing any data, it is recommended to call [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span></span> <span data-ttu-id="834e9-202">Questo metodo alloca le risorse utilizzate internamente da DMO.</span><span class="sxs-lookup"><span data-stu-id="834e9-202">This method allocates the resources used internally by the DMO.</span></span> <span data-ttu-id="834e9-203">Chiamare **AllocateStreamingResources** dopo i passaggi elencati in precedenza, non prima.</span><span class="sxs-lookup"><span data-stu-id="834e9-203">Call **AllocateStreamingResources** after the steps listed previously, not before.</span></span> <span data-ttu-id="834e9-204">Se non si chiama questo metodo, DMO alloca automaticamente le risorse all'avvio dell'elaborazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="834e9-204">If you do not call this method, the DMO automatically allocates resources when data processing starts.</span></span>

<span data-ttu-id="834e9-205">Se si utilizza DMO in modalità filtro, è necessario passare i dati di input a DMO chiamando [**IMediaObject::P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span><span class="sxs-lookup"><span data-stu-id="834e9-205">If you are using the DMO in filter mode, you must pass input data to the DMO by calling [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span></span> <span data-ttu-id="834e9-206">I dati audio dal microfono passano al flusso 0 e i dati audio dalla linea di altoparlanti passano al flusso 1.</span><span class="sxs-lookup"><span data-stu-id="834e9-206">The audio data from the microphone goes to stream 0, and the audio data from the speaker line goes to stream 1.</span></span> <span data-ttu-id="834e9-207">Se si usa DMO in modalità origine, non è necessario chiamare **ProcessInput**.</span><span class="sxs-lookup"><span data-stu-id="834e9-207">If you are using the DMO in source mode, you do not need to call **ProcessInput**.</span></span>

<span data-ttu-id="834e9-208">Per ottenere i dati di output dal DSP, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="834e9-208">To get output data from the DSP, perform the following steps:</span></span>

1.  <span data-ttu-id="834e9-209">Creare un oggetto buffer per memorizzare i dati di output.</span><span class="sxs-lookup"><span data-stu-id="834e9-209">Create a buffer object to hold the output data.</span></span> <span data-ttu-id="834e9-210">L'oggetto buffer deve implementare l'interfaccia [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) .</span><span class="sxs-lookup"><span data-stu-id="834e9-210">The buffer object must implement the [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="834e9-211">Le dimensioni del buffer dipendono dai requisiti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="834e9-211">The size of the buffer depends on the requirements of your application.</span></span> <span data-ttu-id="834e9-212">L'allocazione di un buffer più grande può ridurre le probabilità che si verifichino problemi.</span><span class="sxs-lookup"><span data-stu-id="834e9-212">Allocating a larger buffer can reduce the chances of glitches occurring.</span></span>
2.  <span data-ttu-id="834e9-213">Dichiarare una struttura del [**\_ \_ \_ buffer dei dati di output DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) e impostare il membro **pbuffer** in modo che punti all'oggetto buffer.</span><span class="sxs-lookup"><span data-stu-id="834e9-213">Declare a [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure and set the **pBuffer** member to point to your buffer object.</span></span>
3.  <span data-ttu-id="834e9-214">Passare la struttura del [**\_ \_ \_ buffer dei dati di output DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) al metodo [**IMediaObject::P rocessoutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) .</span><span class="sxs-lookup"><span data-stu-id="834e9-214">Pass the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure to the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) method.</span></span>
4.  <span data-ttu-id="834e9-215">Continuare a chiamare questo metodo per il periodo di tempo in cui DMO contiene dati di output.</span><span class="sxs-lookup"><span data-stu-id="834e9-215">Continue to call this method for as long as the DMO has output data.</span></span> <span data-ttu-id="834e9-216">Il DSP segnala che è presente un maggior output impostando il flag di **\_ output DMO \_ data \_ BUFFERF \_ incomplete** nel membro **dwStatus** della struttura del [**\_ \_ \_ buffer dei dati di output DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) .</span><span class="sxs-lookup"><span data-stu-id="834e9-216">The DSP signals that it has more output by setting the **DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE** flag in the **dwStatus** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="834e9-217">Requisiti</span><span class="sxs-lookup"><span data-stu-id="834e9-217">Requirements</span></span>



| <span data-ttu-id="834e9-218">Requisito</span><span class="sxs-lookup"><span data-stu-id="834e9-218">Requirement</span></span> | <span data-ttu-id="834e9-219">Valore</span><span class="sxs-lookup"><span data-stu-id="834e9-219">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="834e9-220">Client minimo supportato</span><span class="sxs-lookup"><span data-stu-id="834e9-220">Minimum supported client</span></span><br/> | <span data-ttu-id="834e9-221">\[Solo app desktop di Windows Vista\]</span><span class="sxs-lookup"><span data-stu-id="834e9-221">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="834e9-222">Server minimo supportato</span><span class="sxs-lookup"><span data-stu-id="834e9-222">Minimum supported server</span></span><br/> | <span data-ttu-id="834e9-223">\[Solo app desktop Windows Server 2008\]</span><span class="sxs-lookup"><span data-stu-id="834e9-223">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="834e9-224">Intestazione</span><span class="sxs-lookup"><span data-stu-id="834e9-224">Header</span></span><br/>                   | <dl> <span data-ttu-id="834e9-225"><dt>Wmcodecdsp. h</dt></span><span class="sxs-lookup"><span data-stu-id="834e9-225"><dt>Wmcodecdsp.h</dt></span></span> </dl> |
| <span data-ttu-id="834e9-226">DLL</span><span class="sxs-lookup"><span data-stu-id="834e9-226">DLL</span></span><br/>                      | <dl> <span data-ttu-id="834e9-227"><dt>Mfwmaaec.dll</dt></span><span class="sxs-lookup"><span data-stu-id="834e9-227"><dt>Mfwmaaec.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="834e9-228">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="834e9-228">See also</span></span>

<dl> <dt>

[<span data-ttu-id="834e9-229">Processori di segnale digitale</span><span class="sxs-lookup"><span data-stu-id="834e9-229">Digital Signal Processors</span></span>](windowsmediadigitalsignalprocessors.md)
</dt> </dl>

 

 
