---
description: Orologio di presentazione
ms.assetid: cb8bb62a-ef80-4de0-9a44-3bb77edc9dd5
title: Orologio di presentazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f61ad02537a2591c681db78721376651f7854ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130490"
---
# <a name="presentation-clock"></a><span data-ttu-id="086b1-103">Orologio di presentazione</span><span class="sxs-lookup"><span data-stu-id="086b1-103">Presentation Clock</span></span>

<span data-ttu-id="086b1-104">Il *clock di presentazione* è un oggetto che genera il tempo di clock per una presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-104">The *presentation clock* is an object that generates the clock time for a presentation.</span></span> <span data-ttu-id="086b1-105">Il tempo segnalato dal clock di presentazione è denominato *tempo di presentazione*.</span><span class="sxs-lookup"><span data-stu-id="086b1-105">The time reported by the presentation clock is called the *presentation time*.</span></span> <span data-ttu-id="086b1-106">Tutti i flussi in una presentazione vengono sincronizzati con l'ora di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-106">All streams in a presentation are synchronized to the presentation time.</span></span> <span data-ttu-id="086b1-107">Il clock di presentazione espone le interfacce seguenti.</span><span class="sxs-lookup"><span data-stu-id="086b1-107">The presentation clock exposes the following interfaces.</span></span>



| <span data-ttu-id="086b1-108">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="086b1-108">Interface</span></span>                                            | <span data-ttu-id="086b1-109">Descrizione</span><span class="sxs-lookup"><span data-stu-id="086b1-109">Description</span></span>                                         |
|------------------------------------------------------|-----------------------------------------------------|
| [<span data-ttu-id="086b1-110">**IMFPresentationClock**</span><span class="sxs-lookup"><span data-stu-id="086b1-110">**IMFPresentationClock**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationclock) | <span data-ttu-id="086b1-111">Interfaccia principale per l'uso del clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-111">Primary interface for using the presentation clock.</span></span> |
| [<span data-ttu-id="086b1-112">**IMFRateControl**</span><span class="sxs-lookup"><span data-stu-id="086b1-112">**IMFRateControl**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol)             | <span data-ttu-id="086b1-113">Controlla la frequenza di clock.</span><span class="sxs-lookup"><span data-stu-id="086b1-113">Controls the clock rate.</span></span>                            |
| [<span data-ttu-id="086b1-114">**IMFTimer**</span><span class="sxs-lookup"><span data-stu-id="086b1-114">**IMFTimer**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftimer)                         | <span data-ttu-id="086b1-115">Fornisce un callback del timer.</span><span class="sxs-lookup"><span data-stu-id="086b1-115">Provides a timer callback.</span></span>                          |
| [<span data-ttu-id="086b1-116">**IMFShutdown**</span><span class="sxs-lookup"><span data-stu-id="086b1-116">**IMFShutdown**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown)                   | <span data-ttu-id="086b1-117">Arresta il clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-117">Shuts down the presentation clock.</span></span>                  |



 

<span data-ttu-id="086b1-118">I sink di supporto usano l'ora di presentazione per pianificare quando eseguire il rendering degli esempi.</span><span class="sxs-lookup"><span data-stu-id="086b1-118">Media sinks use the presentation time to schedule when to render samples.</span></span> <span data-ttu-id="086b1-119">Ogni volta che un sink multimediale riceve un nuovo esempio, ottiene il timestamp dall'esempio ed esegue il rendering dell'esempio all'ora indicata o il più vicino possibile.</span><span class="sxs-lookup"><span data-stu-id="086b1-119">Whenever a media sink receives a new sample, it gets the time stamp from the sample and renders the sample at the indicated time, or as close to that time as possible.</span></span> <span data-ttu-id="086b1-120">Poiché tutti i sink di supporto in una topologia condividono lo stesso clock di presentazione, vengono sincronizzati più flussi (ad esempio audio e video).</span><span class="sxs-lookup"><span data-stu-id="086b1-120">Because all of the media sinks in a topology share the same presentation clock, multiple streams (such as audio and video) are synchronized.</span></span> <span data-ttu-id="086b1-121">Le origini e le trasformazioni dei supporti non utilizzano il clock di presentazione, perché non pianificano il momento in cui recapitare gli esempi.</span><span class="sxs-lookup"><span data-stu-id="086b1-121">Media sources and transforms do not use the presentation clock, because they do not schedule when to deliver samples.</span></span> <span data-ttu-id="086b1-122">Producono invece campioni ogni volta che la pipeline richiede un nuovo campione.</span><span class="sxs-lookup"><span data-stu-id="086b1-122">Instead, they produce samples whenever the pipeline requests a new sample.</span></span>

<span data-ttu-id="086b1-123">Se si usa la sessione multimediale per la riproduzione, la sessione multimediale gestisce tutti i dettagli relativi alla creazione del clock di presentazione, alla selezione di un'origine dell'ora e alla notifica dei sink dei supporti.</span><span class="sxs-lookup"><span data-stu-id="086b1-123">If you are using the Media Session for playback, the Media Session handles all of the details of creating the presentation clock, selecting a time source, and notifying the media sinks.</span></span> <span data-ttu-id="086b1-124">L'applicazione potrebbe utilizzare il clock di presentazione per ottenere l'ora di presentazione corrente durante la riproduzione, ma in caso contrario non chiamerà alcun metodo sul clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-124">Your application might use the presentation clock to get the current presentation time during playback, but otherwise will not call any methods on the presentation clock.</span></span>

## <a name="clock-time-and-clock-states"></a><span data-ttu-id="086b1-125">Stati di clock e clock</span><span class="sxs-lookup"><span data-stu-id="086b1-125">Clock Time and Clock States</span></span>

<span data-ttu-id="086b1-126">Per ottenere l'ora dell'orologio più recente dal clock di presentazione, chiamare [**IMFPresentationClock:: GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime).</span><span class="sxs-lookup"><span data-stu-id="086b1-126">To get the latest clock time from the presentation clock, call [**IMFPresentationClock::GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime).</span></span> <span data-ttu-id="086b1-127">I tempi di clock sono sempre in unità di 100 nanosecondi, quindi un secondo è 10 milioni (10 ^ 7) Tick.</span><span class="sxs-lookup"><span data-stu-id="086b1-127">Clock times are always in 100-nanosecond units, so one second is 10,000,000 (10^7) ticks.</span></span> <span data-ttu-id="086b1-128">Corrisponde a una frequenza di 10 MHz.</span><span class="sxs-lookup"><span data-stu-id="086b1-128">This corresponds to a frequency of 10 MHz.</span></span>

<span data-ttu-id="086b1-129">Il clock di presentazione ha tre stati: in esecuzione, sospesa e arrestata.</span><span class="sxs-lookup"><span data-stu-id="086b1-129">The presentation clock has three states: Running, paused, and stopped.</span></span>

-   <span data-ttu-id="086b1-130">Per eseguire l'orologio, chiamare [**IMFPresentationClock:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-start).</span><span class="sxs-lookup"><span data-stu-id="086b1-130">To run the clock, call [**IMFPresentationClock::Start**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-start).</span></span> <span data-ttu-id="086b1-131">Il metodo **Start** specifica l'ora di inizio del clock.</span><span class="sxs-lookup"><span data-stu-id="086b1-131">The **Start** method specifies the clock's starting time.</span></span> <span data-ttu-id="086b1-132">Mentre il clock è in esecuzione, il tempo di clock viene incrementato dall'ora di inizio, alla frequenza di clock corrente.</span><span class="sxs-lookup"><span data-stu-id="086b1-132">While the clock is running, the clock time increments from the starting time, at the current clock rate.</span></span>
-   <span data-ttu-id="086b1-133">Per sospendere l'orologio, chiamare [**IMFPresentationClock::P ause**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-pause).</span><span class="sxs-lookup"><span data-stu-id="086b1-133">To pause the clock, call [**IMFPresentationClock::Pause**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-pause).</span></span> <span data-ttu-id="086b1-134">Mentre il clock viene sospeso, il tempo di clock non avanza e [**getTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) restituisce l'ora in cui il clock è stato sospeso.</span><span class="sxs-lookup"><span data-stu-id="086b1-134">While the clock is paused, the clock time does not advance, and [**GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) returns the time at which the clock was paused.</span></span>
-   <span data-ttu-id="086b1-135">Per arrestare l'orologio, chiamare [**IMFPresentationClock:: Stop**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-stop).</span><span class="sxs-lookup"><span data-stu-id="086b1-135">To stop the clock, call [**IMFPresentationClock::Stop**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-stop).</span></span> <span data-ttu-id="086b1-136">Quando il clock viene arrestato, il tempo di clock non avanza e [**getTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) restituisce zero.</span><span class="sxs-lookup"><span data-stu-id="086b1-136">When the clock is stopped, the clock time does not advance, and [**GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) returns zero.</span></span>

<span data-ttu-id="086b1-137">Per impostazione predefinita, l'orologio avanza a una velocità di 1,0, ovvero 1 tick per 100 nanosecondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-137">By default, the clock advances at a rate of 1.0, meaning 1 tick per 100 nanoseconds.</span></span> <span data-ttu-id="086b1-138">Per modificare la frequenza con cui avanza il clock, eseguire una query sul clock di presentazione per l'interfaccia [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) e chiamare [**IMFRateControl:: serate**](/windows/desktop/api/mfidl/nf-mfidl-imfratecontrol-setrate).</span><span class="sxs-lookup"><span data-stu-id="086b1-138">To change the rate at which the clock advances, query the presentation clock for the [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) interface and call [**IMFRateControl::SetRate**](/windows/desktop/api/mfidl/nf-mfidl-imfratecontrol-setrate).</span></span>

<span data-ttu-id="086b1-139">Gli oggetti possono ricevere notifiche delle modifiche di stato (incluse le modifiche di frequenza) dal clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-139">Objects can receive notifications of state changes (including rate changes) from the presentation clock.</span></span> <span data-ttu-id="086b1-140">Per ricevere le notifiche, implementare l'interfaccia [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) e chiamare [**IMFPresentationClock:: AddClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-addclockstatesink) sul clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-140">To receive notifications, implement the [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) interface and call [**IMFPresentationClock::AddClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-addclockstatesink) on the presentation clock.</span></span> <span data-ttu-id="086b1-141">Prima di arrestare, chiamare [**IMFPresentationClock:: RemoveClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-removeclockstatesink) per annullare la registrazione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="086b1-141">Before shutting down, call [**IMFPresentationClock::RemoveClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-removeclockstatesink) to unregister the object.</span></span> <span data-ttu-id="086b1-142">I sink di supporto usano questo meccanismo per ricevere notifiche dal clock.</span><span class="sxs-lookup"><span data-stu-id="086b1-142">Media sinks use this mechanism to receive notifications from the clock.</span></span>

## <a name="presentation-times"></a><span data-ttu-id="086b1-143">Tempi di presentazione</span><span class="sxs-lookup"><span data-stu-id="086b1-143">Presentation Times</span></span>

<span data-ttu-id="086b1-144">Un sink multimediale tenta di pianificare ogni esempio in modo che l'esempio venga sottoposto a rendering all'ora corretta o quanto più vicino possibile al tempo corretto.</span><span class="sxs-lookup"><span data-stu-id="086b1-144">A media sink tries to schedule each sample so that the sample is rendered at the correct time, or as close to the correct time as possible.</span></span> <span data-ttu-id="086b1-145">Si applicano le seguenti definizioni:</span><span class="sxs-lookup"><span data-stu-id="086b1-145">The following definitions apply:</span></span>

-   <span data-ttu-id="086b1-146">*Tempo di presentazione.*</span><span class="sxs-lookup"><span data-stu-id="086b1-146">*Presentation time.*</span></span> <span data-ttu-id="086b1-147">Data e ora in cui deve essere eseguito il rendering di un campione.</span><span class="sxs-lookup"><span data-stu-id="086b1-147">The time when a sample should be rendered.</span></span> <span data-ttu-id="086b1-148">Il tempo è espresso in unità di 100 nanosecondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-148">Time is given in units of 100 nanoseconds.</span></span>
-   <span data-ttu-id="086b1-149">*Tempo dei supporti.*</span><span class="sxs-lookup"><span data-stu-id="086b1-149">*Media time.*</span></span> <span data-ttu-id="086b1-150">Tempo relativo all'inizio del contenuto.</span><span class="sxs-lookup"><span data-stu-id="086b1-150">Time relative to the start of the content.</span></span> <span data-ttu-id="086b1-151">Se, ad esempio, un file video ha una lunghezza di 10 secondi, il tempo medio per il file è pari a 5 secondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-151">For example, if a video file is 10 seconds long, the point half way through the file has a media time of 5 seconds.</span></span>
-   <span data-ttu-id="086b1-152">*Timestamp.*</span><span class="sxs-lookup"><span data-stu-id="086b1-152">*Time stamp.*</span></span> <span data-ttu-id="086b1-153">Ora contrassegnata in un esempio multimediale.</span><span class="sxs-lookup"><span data-stu-id="086b1-153">The time marked on a media sample.</span></span> <span data-ttu-id="086b1-154">Per ottenere il timestamp, chiamare [**IMFSample:: GetSampleTime**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-getsampletime).</span><span class="sxs-lookup"><span data-stu-id="086b1-154">To get the time stamp, call [**IMFSample::GetSampleTime**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-getsampletime).</span></span> <span data-ttu-id="086b1-155">Quando un'origine multimediale produce un esempio, imposta il timestamp uguale al tempo dei supporti.</span><span class="sxs-lookup"><span data-stu-id="086b1-155">When a media source produces a sample, it sets the time stamp equal to the media time.</span></span> <span data-ttu-id="086b1-156">La sessione multimediale converte il timestamp nel tempo di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-156">The Media Session translates the time stamp into presentation time.</span></span>

<span data-ttu-id="086b1-157">Per impostazione predefinita, il tempo dei supporti e l'ora di presentazione sono gli stessi, ad esempio se un frame video viene visualizzato in 5 secondi nel file di origine, il tempo dei supporti e l'ora di presentazione sono entrambi 5 secondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-157">By default, media time and presentation time are the same, For example, if a video frame appears 5 seconds into the source file, the media time and the presentation time are both 5 seconds.</span></span> <span data-ttu-id="086b1-158">Se si utilizza l' [origine sequencer](sequencer-source.md), il modello di temporizzazione è leggermente più complesso, per consentire transizioni uniformi tra i segmenti.</span><span class="sxs-lookup"><span data-stu-id="086b1-158">If you are using the [Sequencer Source](sequencer-source.md), the timing model is somewhat more complicated, to enable smooth transitions between segments.</span></span> <span data-ttu-id="086b1-159">Per altre informazioni sul modello di temporizzazione dell'origine di Sequencer, vedere [tempi di presentazione della sequenza](sequence-presentation-times.md).</span><span class="sxs-lookup"><span data-stu-id="086b1-159">For more information about the sequencer source's timing model, see [Sequence Presentation Times](sequence-presentation-times.md).</span></span>

<span data-ttu-id="086b1-160">L'origine multimediale imposta sempre il timestamp uguale al tempo dei supporti.</span><span class="sxs-lookup"><span data-stu-id="086b1-160">The media source always sets the time stamp equal to the media time.</span></span> <span data-ttu-id="086b1-161">Se l'ora di presentazione non è allineata con il tempo del supporto, la sessione multimediale converte i timestamp sugli esempi di supporti.</span><span class="sxs-lookup"><span data-stu-id="086b1-161">If presentation time is not aligned with media time, the Media Session converts the time stamps on the media samples.</span></span> <span data-ttu-id="086b1-162">Nel momento in cui il sink riceve un campione, il timestamp dell'esempio è stato convertito in tempo di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-162">By the time the sink receives a sample, the sample's time stamp has been converted to presentation time.</span></span> <span data-ttu-id="086b1-163">Il sink pianifica l'esempio rispetto all'ora corrente del clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-163">The sink schedules the sample against the presentation clock's current time.</span></span> <span data-ttu-id="086b1-164">I sink senza frequenza sono un'eccezione, perché ignorano il clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-164">(Rateless sinks are an exception, because they ignore the presentation clock.)</span></span>

<span data-ttu-id="086b1-165">Se l'applicazione cerca una nuova posizione, la sessione multimediale riavvia il clock di presentazione in corrispondenza del tempo di ricerca specificato.</span><span class="sxs-lookup"><span data-stu-id="086b1-165">If the application seeks to a new position, the Media Session restarts the presentation clock at the specified seek time.</span></span> <span data-ttu-id="086b1-166">Se, ad esempio, l'applicazione cerca la posizione di 5 secondi nel file, la sessione multimediale avvia l'orologio a 5 secondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-166">For example, if the application seeks to the 5-second position in the file, the Media Session starts the clock at 5 seconds.</span></span> <span data-ttu-id="086b1-167">L'origine multimediale potrebbe recapitare campioni con un timestamp leggermente precedente se il tempo di ricerca non rientra in un limite del fotogramma chiave.</span><span class="sxs-lookup"><span data-stu-id="086b1-167">The media source might deliver samples with a slightly earlier time stamp if the seek time does not fall on a key-frame boundary.</span></span> <span data-ttu-id="086b1-168">Questa operazione è necessaria in modo che i decodificatori possano decodificare tutti i frame.</span><span class="sxs-lookup"><span data-stu-id="086b1-168">This is required so that the decoders can decode all of the frames.</span></span> <span data-ttu-id="086b1-169">La sessione multimediale Elimina o taglia gli esempi prima che raggiungano i sink multimediali, in modo da corrispondere al tempo di ricerca richiesto.</span><span class="sxs-lookup"><span data-stu-id="086b1-169">The Media Session drops or trims samples before they reach the media sinks, in order to match the requested seek time.</span></span> <span data-ttu-id="086b1-170">Se, ad esempio, il tempo di ricerca è di 5 secondi, il primo campione audio potrebbe iniziare a 4,5 secondi.</span><span class="sxs-lookup"><span data-stu-id="086b1-170">For example, if the seek time is 5 seconds, the first audio sample might start at 4.5 seconds.</span></span> <span data-ttu-id="086b1-171">La sessione multimediale eliminerà i primi 0,5 secondi dal primo campione audio decodificato.</span><span class="sxs-lookup"><span data-stu-id="086b1-171">The Media Session will trim the first 0.5 seconds from the first decoded audio sample.</span></span>

## <a name="creating-the-presentation-clock"></a><span data-ttu-id="086b1-172">Creazione del clock di presentazione</span><span class="sxs-lookup"><span data-stu-id="086b1-172">Creating the Presentation Clock</span></span>

<span data-ttu-id="086b1-173">Per creare il clock di presentazione, chiamare [**MFCreatePresentationClock**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepresentationclock).</span><span class="sxs-lookup"><span data-stu-id="086b1-173">To create the presentation clock, call [**MFCreatePresentationClock**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepresentationclock).</span></span> <span data-ttu-id="086b1-174">Per arrestare l'orologio, eseguire una query per l'interfaccia [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) e chiamare [**IMFShutdown:: Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown).</span><span class="sxs-lookup"><span data-stu-id="086b1-174">To shut down the clock, query for the [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) interface and call [**IMFShutdown::Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown).</span></span> <span data-ttu-id="086b1-175">Il chiamante di **MFCreatePresentationClock** è responsabile della chiamata di **Shutdown**; nella maggior parte dei casi, si tratta della sessione multimediale anziché dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-175">The caller of **MFCreatePresentationClock** is responsible for calling **Shutdown**; in most cases, this is the Media Session rather than the application.</span></span>

## <a name="presentation-time-sources"></a><span data-ttu-id="086b1-176">Origini ora presentazione</span><span class="sxs-lookup"><span data-stu-id="086b1-176">Presentation Time Sources</span></span>

<span data-ttu-id="086b1-177">Nonostante il nome, il clock di presentazione non implementa effettivamente un clock.</span><span class="sxs-lookup"><span data-stu-id="086b1-177">Despite its name, the presentation clock does not actually implement a clock.</span></span> <span data-ttu-id="086b1-178">Ottiene invece i tempi di clock da un altro oggetto, denominato *origine dell'ora di presentazione*.</span><span class="sxs-lookup"><span data-stu-id="086b1-178">Instead, it gets the clock times from another object, called a *presentation time source*.</span></span> <span data-ttu-id="086b1-179">L'origine dell'ora può essere qualsiasi oggetto che genera tick di clock accurati ed espone l'interfaccia [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) .</span><span class="sxs-lookup"><span data-stu-id="086b1-179">The time source can be any object that generates accurate clock ticks and exposes the [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="086b1-180">Questo processo viene illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="086b1-180">The following illustration shows this process.</span></span>

![diagramma che mostra la relazione tra il clock di presentazione e l'origine dell'ora di presentazione](images/dedc255c-eb6d-49fc-8892-7b6076ed4488.gif)

<span data-ttu-id="086b1-182">Quando il clock di presentazione viene creato per la prima volta, non dispone di un'origine dell'ora.</span><span class="sxs-lookup"><span data-stu-id="086b1-182">When the presentation clock is first created, it does not have a time source.</span></span> <span data-ttu-id="086b1-183">Per impostare l'origine dell'ora, chiamare [**IMFPresentationClock:: SetTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-settimesource) con un puntatore all'interfaccia [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) dell'origine dell'ora.</span><span class="sxs-lookup"><span data-stu-id="086b1-183">To set the time source, call [**IMFPresentationClock::SetTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-settimesource) with a pointer to the time source's [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="086b1-184">Un'origine ora supporta gli stessi Stati del clock di presentazione (in esecuzione, sospesa e arrestata) e deve implementare l'interfaccia [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) .</span><span class="sxs-lookup"><span data-stu-id="086b1-184">A time source supports the same states as the presentation clock (running, paused, and stop), and must implement the [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) interface.</span></span> <span data-ttu-id="086b1-185">Il clock di presentazione usa questa interfaccia per notificare all'origine dell'ora quando modificare lo stato.</span><span class="sxs-lookup"><span data-stu-id="086b1-185">The presentation clock uses this interface to notify the time source when to change state.</span></span> <span data-ttu-id="086b1-186">In questo modo, l'origine dell'ora fornisce i tick dell'orologio, ma il clock di presentazione avvia le modifiche di stato nell'orologio.</span><span class="sxs-lookup"><span data-stu-id="086b1-186">In this way, the time source provides the clock ticks, but the presentation clock initiates state changes in the clock.</span></span>

<span data-ttu-id="086b1-187">Alcuni sink di supporto hanno accesso a un clock accurato e pertanto espongono l'interfaccia [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) .</span><span class="sxs-lookup"><span data-stu-id="086b1-187">Some media sinks have access to an accurate clock, and therefore expose the [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="086b1-188">In particolare, il renderer audio può utilizzare la frequenza della scheda audio come clock.</span><span class="sxs-lookup"><span data-stu-id="086b1-188">In particular, the audio renderer can use the frequency of the sound card as a clock.</span></span> <span data-ttu-id="086b1-189">Nella riproduzione audio, il renderer audio può fungere da origine dell'ora, in modo che il video venga sincronizzato con la frequenza di riproduzione audio.</span><span class="sxs-lookup"><span data-stu-id="086b1-189">In audio playback, it is useful for the audio renderer to act as the time source, so that video is synchronized to the audio playback rate.</span></span> <span data-ttu-id="086b1-190">Questo genere produce risultati migliori rispetto al tentativo di abbinare l'audio a un orologio esterno.</span><span class="sxs-lookup"><span data-stu-id="086b1-190">This generally produces better results than attempting to match the audio to an external clock.</span></span>

<span data-ttu-id="086b1-191">Media Foundation fornisce anche un'origine dell'ora di presentazione basata sul clock di sistema.</span><span class="sxs-lookup"><span data-stu-id="086b1-191">Media Foundation also provides a presentation time source based on the system clock.</span></span> <span data-ttu-id="086b1-192">Per creare questo oggetto, chiamare [**MFCreateSystemTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatesystemtimesource).</span><span class="sxs-lookup"><span data-stu-id="086b1-192">To create this object, call [**MFCreateSystemTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatesystemtimesource).</span></span> <span data-ttu-id="086b1-193">L'origine dell'ora di sistema può essere usata quando nessun sink multimediale fornisce un'origine dell'ora.</span><span class="sxs-lookup"><span data-stu-id="086b1-193">The system time source can be used when no media sinks provide a time source.</span></span>

<span data-ttu-id="086b1-194">In generale, un sink multimediale deve utilizzare il clock di presentazione fornito, indipendentemente dall'origine dell'ora utilizzata dal clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-194">In general, a media sink must use the presentation clock provided to it, regardless of which time source the presentation clock uses.</span></span> <span data-ttu-id="086b1-195">Questa regola si applica anche quando un sink multimediale implementa [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource).</span><span class="sxs-lookup"><span data-stu-id="086b1-195">This rule applies even when a media sink implements [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource).</span></span> <span data-ttu-id="086b1-196">Se il clock di presentazione usa un'altra origine ora, il sink multimediale deve seguire tale origine dell'ora, non il proprio clock interno.</span><span class="sxs-lookup"><span data-stu-id="086b1-196">If the presentation clock uses some other time source, the media sink must follow that time source, not its own internal clock.</span></span>

<span data-ttu-id="086b1-197">Ci sono due situazioni in cui un sink multimediale non seguirà il clock di presentazione:</span><span class="sxs-lookup"><span data-stu-id="086b1-197">There are two situations when a media sink will not follow the presentation clock:</span></span>

-   <span data-ttu-id="086b1-198">Alcuni sink di supporto sono *senza frequenza*.</span><span class="sxs-lookup"><span data-stu-id="086b1-198">Some media sinks are *rateless*.</span></span> <span data-ttu-id="086b1-199">Se un sink multimediale è senza frequenza, utilizza gli esempi il più rapidamente possibile, senza pianificarli in base al clock di presentazione.</span><span class="sxs-lookup"><span data-stu-id="086b1-199">If a media sink is rateless, it consumes samples as quickly as possible, without scheduling them according to the presentation clock.</span></span> <span data-ttu-id="086b1-200">In genere, i sink senza frequenza scrivono i dati in un file, pertanto è consigliabile completare l'operazione il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="086b1-200">Typically, rateless sinks write data to a file, so it is desirable to complete the operation as quickly as possible.</span></span> <span data-ttu-id="086b1-201">Un sink senza frequenza restituisce il \_ flag MEDIASINK senza frequenza nel metodo [**IMFMediaSink:: getcaratteristiche**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) .</span><span class="sxs-lookup"><span data-stu-id="086b1-201">A rateless sink returns the MEDIASINK\_RATELESS flag in its [**IMFMediaSink::GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) method.</span></span> <span data-ttu-id="086b1-202">Quando tutti i sink in una topologia sono senza frequenza, la sessione multimediale esegue il push dei dati attraverso la pipeline il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="086b1-202">When all the sinks in a topology are rateless, the Media Session pushes data through the pipeline as quickly as possible.</span></span>

-   <span data-ttu-id="086b1-203">Alcuni sink di supporto non possono corrispondere alle frequenze con un'origine ora diversa da se stessi.</span><span class="sxs-lookup"><span data-stu-id="086b1-203">Some media sinks cannot match rates with a time source other than themselves.</span></span> <span data-ttu-id="086b1-204">In tal caso, il sink restituisce il MEDIASINK \_ non può \_ corrispondere al \_ flag di clock nel metodo [**getcaratteristiche**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) .</span><span class="sxs-lookup"><span data-stu-id="086b1-204">If so, the sink returns the MEDIASINK\_CANNOT\_MATCH\_CLOCK flag in its [**GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) method.</span></span> <span data-ttu-id="086b1-205">La pipeline può comunque utilizzare un'altra origine ora, ma i risultati saranno inferiori a quelli ottimali.</span><span class="sxs-lookup"><span data-stu-id="086b1-205">The pipeline can still use another time source, but the results will be less than optimal.</span></span> <span data-ttu-id="086b1-206">È probabile che il sink si trovi dietro e causi problemi durante la riproduzione.</span><span class="sxs-lookup"><span data-stu-id="086b1-206">The sink will likely fall behind and cause glitches during playback.</span></span>

## <a name="related-topics"></a><span data-ttu-id="086b1-207">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="086b1-207">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="086b1-208">API della piattaforma Media Foundation</span><span class="sxs-lookup"><span data-stu-id="086b1-208">Media Foundation Platform APIs</span></span>](media-foundation-platform-apis.md)
</dt> </dl>

 

 



