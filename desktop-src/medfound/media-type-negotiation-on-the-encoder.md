---
description: Negoziazione del tipo di supporto sul codificatore
ms.assetid: c8ae543e-68f7-4c74-9cb7-2a200bd51820
title: Negoziazione del tipo di supporto sul codificatore
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7845e9d50c5d418198dc0e08313e2e9329ffab8
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/03/2021
ms.locfileid: "103968962"
---
# <a name="media-type-negotiation-on-the-encoder"></a><span data-ttu-id="b4de6-103">Negoziazione del tipo di supporto sul codificatore</span><span class="sxs-lookup"><span data-stu-id="b4de6-103">Media Type Negotiation on the Encoder</span></span>

<span data-ttu-id="b4de6-104">In Microsoft Media Foundation i codificatori vengono implementati come [trasformazioni di Media Foundation](media-foundation-transforms.md) (MFTS) con un input e un output.</span><span class="sxs-lookup"><span data-stu-id="b4de6-104">In Microsoft Media Foundation, encoders are implemented as [Media Foundation transforms](media-foundation-transforms.md) (MFTs) with one input and one output.</span></span> <span data-ttu-id="b4de6-105">Prima di una sessione di codifica, un codificatore deve essere in grado di individuare le caratteristiche del flusso che riceverà come input e il formato del flusso che verrà generato come output.</span><span class="sxs-lookup"><span data-stu-id="b4de6-105">Before an encoding session, an encoder needs to know the characteristics of the stream it will receive as input and the format of the stream it will produce as output.</span></span> <span data-ttu-id="b4de6-106">Prima di passare i dati attraverso il codificatore, è necessario impostare i tipi di supporto di input e di output e le relative caratteristiche.</span><span class="sxs-lookup"><span data-stu-id="b4de6-106">You must set the input and output media types and related characteristics before you pass data through the encoder.</span></span> <span data-ttu-id="b4de6-107">Per specificare i formati di input e di output, è necessario specificare i GUID appropriati per il [tipo di supporto](media-type-guids.md) e impostare le caratteristiche del flusso di output impostando gli attributi del [tipo di supporto](media-type-attributes.md) pertinente sul tipo di supporto di output.</span><span class="sxs-lookup"><span data-stu-id="b4de6-107">You must supply the input and output formats by specifying the appropriate [Media Type GUIDs](media-type-guids.md) and set the characteristics of the output stream by setting the relevant [Media Type Attributes](media-type-attributes.md) on the output media type.</span></span> <span data-ttu-id="b4de6-108">Un nuovo codificatore di cui è stata creata un'istanza non ha alcun tipo di supporto set.</span><span class="sxs-lookup"><span data-stu-id="b4de6-108">A newly instantiated encoder does not have any set media types.</span></span>

<span data-ttu-id="b4de6-109">Il tipo di supporto di input è un formato non compresso, ad esempio audio PCM o video RGB.</span><span class="sxs-lookup"><span data-stu-id="b4de6-109">The input media type is an uncompressed format, such as PCM audio or RGB video.</span></span> <span data-ttu-id="b4de6-110">I tipi di formato utilizzati dal codificatore sono limitati a quelli descritti dalle strutture **VIDEOINFOHEADER** e **WAVEFORMATEX** .</span><span class="sxs-lookup"><span data-stu-id="b4de6-110">The format types that are used by the encoder are limited to those described by the **VIDEOINFOHEADER** and **WAVEFORMATEX** structures.</span></span> <span data-ttu-id="b4de6-111">Per ulteriori informazioni su queste strutture, vedere la documentazione Windows SDK. Media Foundation fornisce funzioni helper per creare tipi di supporto da strutture di formato.</span><span class="sxs-lookup"><span data-stu-id="b4de6-111">For more information about these structures, see the Windows SDK documentation.Media foundation provides helper functions to create media types from format structures.</span></span> <span data-ttu-id="b4de6-112">Ad esempio, la funzione [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) Inizializza un tipo di video da una struttura **VIDEOINFOHEADER** e la funzione [**MFInitMediaTypeFromWaveFormatEx**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) Inizializza un tipo di video da una struttura **WAVEFORMATEX** o **WAVEFORMATEXTENSIBLE** .</span><span class="sxs-lookup"><span data-stu-id="b4de6-112">For example, the [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) function initializes a video type from a **VIDEOINFOHEADER** structure, and the [**MFInitMediaTypeFromWaveFormatEx**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) function initializes a video type from a **WAVEFORMATEX** or **WAVEFORMATEXTENSIBLE** structure.</span></span> <span data-ttu-id="b4de6-113">Per altre informazioni, vedere [conversioni di tipi di supporti](media-type-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="b4de6-113">For more information, see [Media Type Conversions](media-type-conversions.md).</span></span> <span data-ttu-id="b4de6-114">È necessario impostare il tipo di supporto di input nel codificatore chiamando [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="b4de6-114">You must set the input media type on the encoder by calling [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span></span>

<span data-ttu-id="b4de6-115">Il tipo di supporto di output è il formato di compressione usato nel flusso o nel file di origine finale.</span><span class="sxs-lookup"><span data-stu-id="b4de6-115">The output media type is the compression format used in the final source stream or file.</span></span> <span data-ttu-id="b4de6-116">È possibile impostare il tipo di supporto di output disponibile solo dopo aver impostato il tipo di supporto di input.</span><span class="sxs-lookup"><span data-stu-id="b4de6-116">You can set the available output media type only after setting the input media type.</span></span> <span data-ttu-id="b4de6-117">È possibile recuperare i tipi di output supportati chiamando [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) in un ciclo finché il codificatore **non restituisce MF \_ E \_ non \_ più \_ tipi**.</span><span class="sxs-lookup"><span data-stu-id="b4de6-117">You can retrieve the supported output types by calling [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) in a loop until the encoder returns **MF\_E\_NO\_MORE\_TYPES**.</span></span> <span data-ttu-id="b4de6-118">Incrementare l'indice del tipo con ogni iterazione.</span><span class="sxs-lookup"><span data-stu-id="b4de6-118">Increment the type index with each iteration.</span></span> <span data-ttu-id="b4de6-119">Quando si trova un tipo di supporto appropriato, impostare il tipo di supporto di output chiamando [**IMFTransform:: SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="b4de6-119">When you find an appropriate media type, set the output media type by calling [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span>

<span data-ttu-id="b4de6-120">Il fattore decisivo nella scelta del tipo di supporto di output dipende dal tipo di codifica e dai requisiti di codifica.</span><span class="sxs-lookup"><span data-stu-id="b4de6-120">The deciding factor in choosing the output media type depends on the type of encoding and your encoding requirements.</span></span> <span data-ttu-id="b4de6-121">Per i flussi audio con codifica CBR, ad esempio, si vuole trovare un tipo di supporto che corrisponda all'input e che abbia una velocità in bit il più vicino possibile a un valore di destinazione.</span><span class="sxs-lookup"><span data-stu-id="b4de6-121">For example, for audio streams that are CBR-encoded, you want to find a media type that matches your input and has a bit rate that is as close as possible to a target value.</span></span>

<span data-ttu-id="b4de6-122">Se si vuole usare una modalità di codifica diversa da CBR, è necessario impostare la modalità e quindi enumerare i tipi di output per tale modalità, perché il codificatore modifica i tipi di output supportati a seconda della modalità impostata.</span><span class="sxs-lookup"><span data-stu-id="b4de6-122">If you want to use an encoding mode other than CBR, you must set the mode and then enumerate the output types for that mode, because the encoder changes the supported output types depending upon the mode set.</span></span> <span data-ttu-id="b4de6-123">Le proprietà che controllano la modalità di codifica sono [**MFPKEY \_ VBRENABLED**](mfpkey-vbrenabledproperty.md) e [**MFPKEY \_ PASSESUSED**](mfpkey-passesusedproperty.md).</span><span class="sxs-lookup"><span data-stu-id="b4de6-123">The properties that control the encoding mode are [**MFPKEY\_VBRENABLED**](mfpkey-vbrenabledproperty.md) and [**MFPKEY\_PASSESUSED**](mfpkey-passesusedproperty.md).</span></span> <span data-ttu-id="b4de6-124">Se, ad esempio, si enumerano i tipi di output per la codifica di qualità VBR, il tipo di supporto dipende dal valore di qualità che si decide di usare.</span><span class="sxs-lookup"><span data-stu-id="b4de6-124">For example, if you are enumerating output types for VBR-quality encoding, the media type depends on the quality value you decide to use.</span></span> <span data-ttu-id="b4de6-125">Per informazioni sull'impostazione di queste proprietà, vedere [Encoding Properties](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="b4de6-125">For information about setting these properties, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b4de6-126">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b4de6-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b4de6-127">Creazione di un'istanza di un codificatore MFT</span><span class="sxs-lookup"><span data-stu-id="b4de6-127">Instantiating an Encoder MFT</span></span>](instantiating-the-encoder-mft.md)
</dt> <dt>

[<span data-ttu-id="b4de6-128">Codificatori Windows Media</span><span class="sxs-lookup"><span data-stu-id="b4de6-128">Windows Media Encoders</span></span>](windows-media-encoders.md)
</dt> </dl>

 

 



