---
title: Implementazione di gestione categorie di componenti
description: Man mano che aumenta il numero di componenti disponibili, diventa sempre più difficile gestire questi componenti. Per quanto riguarda le interfacce che espongono e le attività che eseguono, molti componenti offrono funzionalità simili.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103955822"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="39497-104">Implementazione di gestione categorie di componenti</span><span class="sxs-lookup"><span data-stu-id="39497-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="39497-105">Man mano che aumenta il numero di componenti disponibili, diventa sempre più difficile gestire questi componenti.</span><span class="sxs-lookup"><span data-stu-id="39497-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="39497-106">Per quanto riguarda le interfacce che espongono e le attività che eseguono, molti componenti offrono funzionalità simili.</span><span class="sxs-lookup"><span data-stu-id="39497-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="39497-107">Spesso è necessario enumerare i componenti che possono essere usati in un determinato contesto.</span><span class="sxs-lookup"><span data-stu-id="39497-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="39497-108">Alcuni esempi sono la finestra di dialogo **Inserisci oggetto** utilizzata in documenti composti OLE e la finestra di dialogo **Inserisci controllo** utilizzata nei controlli OLE.</span><span class="sxs-lookup"><span data-stu-id="39497-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="39497-109">In queste finestre di dialogo sono elencati tutti i componenti che soddisfano (o attestano per soddisfare) i contratti di interfaccia per i documenti o i controlli composti.</span><span class="sxs-lookup"><span data-stu-id="39497-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="39497-110">Queste categorie esistenti (documento OLE, controllo OLE) non implicano una firma dell'interfaccia esatta.</span><span class="sxs-lookup"><span data-stu-id="39497-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="39497-111">I documenti OLE devono esporre un determinato set di interfacce di base, ad esempio [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) o [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), ma possono anche esporre interfacce aggiuntive, ad esempio [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span><span class="sxs-lookup"><span data-stu-id="39497-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="39497-112">In passato, i componenti sono stati contrassegnati con l'aggiunta di un nome leggibile ("Insertable", "Control" e così via) come sottochiave al **\_ CLSID radice delle classi HKEY \_ \\ \\ {...}**</span><span class="sxs-lookup"><span data-stu-id="39497-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="39497-113">chiave del registro di sistema corrispondente al componente.</span><span class="sxs-lookup"><span data-stu-id="39497-113">registry key corresponding to the component.</span></span> <span data-ttu-id="39497-114">Questa funzione è ottimale per una definizione centrale delle categorie ma rischia conflitti di nomi quando molte parti indipendenti definiscono nuove categorie.</span><span class="sxs-lookup"><span data-stu-id="39497-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="39497-115">Come in altre aree di COM, la soluzione per fornire uno spazio dei nomi estendibile consiste nell'utilizzo di identificatori univoci globali (GUID).</span><span class="sxs-lookup"><span data-stu-id="39497-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="39497-116">Invece di usare un nome leggibile, viene assegnato un numero univoco (CATId) a ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="39497-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="39497-117">Un altro limite con la categorizzazione esistente è che è limitato a esprimere le funzionalità del componente stesso.</span><span class="sxs-lookup"><span data-stu-id="39497-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="39497-118">Molti componenti richiedono determinate funzionalità dai contenitori.</span><span class="sxs-lookup"><span data-stu-id="39497-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="39497-119">Quando un componente di questo tipo viene inserito in un contenitore, l'inserimento può avere esito negativo o comportarsi in modo imprevisto, anche se il componente soddisfa i contratti impliciti in una delle categorie.</span><span class="sxs-lookup"><span data-stu-id="39497-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="39497-120">Per enumerare i componenti che possono essere utilizzati correttamente in determinate situazioni, è necessario considerare le funzionalità del componente e del contenitore.</span><span class="sxs-lookup"><span data-stu-id="39497-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="39497-121">A causa di queste considerazioni, sono state apportate le modifiche seguenti alla categorizzazione esistente:</span><span class="sxs-lookup"><span data-stu-id="39497-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="39497-122">Le categorie sono indicate usando CATID che sono identificatori univoci globali.</span><span class="sxs-lookup"><span data-stu-id="39497-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="39497-123">Sotto la sottochiave **Components** della chiave del registro di sistema **HKEY delle \_ classi \_ radice \\** , sono state sviluppate due sottochiavi separate, "Categorie implementate" e "categorie obbligatorie".</span><span class="sxs-lookup"><span data-stu-id="39497-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="39497-124">Queste sottochiavi contengono gli elenchi di CATID forniti dal componente o che il contenitore del componente deve fornire.</span><span class="sxs-lookup"><span data-stu-id="39497-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="39497-125">Per semplificare la gestione delle categorie di componenti, le categorie sono elencate in una posizione centrale nel registro di sistema: **HKEY \_ classi \_ radice dei \\ componenti**.</span><span class="sxs-lookup"><span data-stu-id="39497-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="39497-126">Questa chiave elenca le categorie installate sia con il CATId che con i nomi leggibili localizzati.</span><span class="sxs-lookup"><span data-stu-id="39497-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="39497-127">Per altre informazioni, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="39497-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="39497-128">Categorizzazione in base alle funzionalità del componente</span><span class="sxs-lookup"><span data-stu-id="39497-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="39497-129">Categorizzazione in base alle funzionalità del contenitore</span><span class="sxs-lookup"><span data-stu-id="39497-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="39497-130">Gestione categorie di componenti</span><span class="sxs-lookup"><span data-stu-id="39497-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="39497-131">Classi e associazioni predefinite</span><span class="sxs-lookup"><span data-stu-id="39497-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="39497-132">Definizione delle categorie di componenti</span><span class="sxs-lookup"><span data-stu-id="39497-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="39497-133">Associazione di icone a una categoria</span><span class="sxs-lookup"><span data-stu-id="39497-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




