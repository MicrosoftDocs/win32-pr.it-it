---
title: QueryInterface che si sposta in un oggetto
description: QueryInterface che si sposta in un oggetto
ms.assetid: 7dec015f-7609-40eb-a71e-f6e9c9b9f8ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3dbd44d200bf0a992f47bc375d0782bdadacf6a3
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/29/2020
ms.locfileid: "104336061"
---
# <a name="queryinterface-navigating-in-an-object"></a><span data-ttu-id="717cb-103">QueryInterface: spostamento in un oggetto</span><span class="sxs-lookup"><span data-stu-id="717cb-103">QueryInterface: Navigating in an Object</span></span>

<span data-ttu-id="717cb-104">Quando si dispone di un puntatore iniziale a un'interfaccia su un oggetto, COM dispone di un meccanismo molto semplice per verificare se l'oggetto supporta un'altra interfaccia specifica e, in caso affermativo, ottenere un puntatore.</span><span class="sxs-lookup"><span data-stu-id="717cb-104">After you have an initial pointer to an interface on an object, COM has a very simple mechanism to find out whether the object supports another specific interface and, if so, to get a pointer to it.</span></span> <span data-ttu-id="717cb-105">Per informazioni su come ottenere un puntatore iniziale a un'interfaccia su un oggetto, vedere [recupero di un puntatore a un oggetto](getting-a-pointer-to-an-object.md). Questo meccanismo è il metodo [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) dell'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="717cb-105">(For information about getting an initial pointer to an interface on an object, see [Getting a Pointer to an Object](getting-a-pointer-to-an-object.md).) This mechanism is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method of the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="717cb-106">Se l'oggetto supporta l'interfaccia richiesta, il metodo deve restituire un puntatore a tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="717cb-106">If the object supports the requested interface, the method must return a pointer to that interface.</span></span> <span data-ttu-id="717cb-107">Ciò consente a un oggetto di spostarsi liberamente tra le interfacce supportate da un oggetto.</span><span class="sxs-lookup"><span data-stu-id="717cb-107">This permits an object to navigate freely through the interfaces that an object supports.</span></span> <span data-ttu-id="717cb-108">**QueryInterface** separa la richiesta "si supporta un dato contratto?"</span><span class="sxs-lookup"><span data-stu-id="717cb-108">**QueryInterface** separates the request "Do you support a given contract?"</span></span> <span data-ttu-id="717cb-109">dall'utilizzo a prestazioni elevate di tale contratto una volta che le negoziazioni sono state completate.</span><span class="sxs-lookup"><span data-stu-id="717cb-109">from the high-performance use of that contract once negotiations have been successful.</span></span>

<span data-ttu-id="717cb-110">Quando un client ottiene inizialmente l'accesso a un oggetto, il client riceverà almeno un puntatore all'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) (l'interfaccia più fondamentale) attraverso il quale può controllare la durata dell'oggetto, indicando all'oggetto quando viene eseguita utilizzando l'oggetto, e richiamare [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="717cb-110">When a client initially gains access to an object, that client will receive, at a minimum, an [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointer (the most fundamental interface) through which it can control the lifetime of the object—by telling the object when it is done using the object—and invoke [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span> <span data-ttu-id="717cb-111">Il client viene programmato per chiedere a ogni oggetto gestito di eseguire alcune operazioni, ma l'interfaccia **IUnknown** non dispone di funzioni per tali operazioni.</span><span class="sxs-lookup"><span data-stu-id="717cb-111">The client is programmed to ask each object it manages to perform some operations, but the **IUnknown** interface has no functions for those operations.</span></span> <span data-ttu-id="717cb-112">Queste operazioni vengono invece espresse tramite altre interfacce.</span><span class="sxs-lookup"><span data-stu-id="717cb-112">Instead, those operations are expressed through other interfaces.</span></span> <span data-ttu-id="717cb-113">Il client viene quindi programmato per la negoziazione con gli oggetti per tali interfacce.</span><span class="sxs-lookup"><span data-stu-id="717cb-113">The client is thus programmed to negotiate with objects for those interfaces.</span></span> <span data-ttu-id="717cb-114">In particolare, il client chiamerà **QueryInterface** per chiedere a un oggetto un'interfaccia tramite la quale il client può richiamare le operazioni desiderate.</span><span class="sxs-lookup"><span data-stu-id="717cb-114">Specifically, the client will call **QueryInterface** to ask an object for an interface through which the client may invoke the desired operations.</span></span>

<span data-ttu-id="717cb-115">Poiché l'oggetto implementa [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), è in grado di accettare o rifiutare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="717cb-115">Because the object implements [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it has the ability to accept or reject the request.</span></span> <span data-ttu-id="717cb-116">Se l'oggetto accetta la richiesta del client, **QueryInterface** restituisce al client un nuovo puntatore all'interfaccia richiesta.</span><span class="sxs-lookup"><span data-stu-id="717cb-116">If the object accepts the client's request, **QueryInterface** returns a new pointer to the requested interface to the client.</span></span> <span data-ttu-id="717cb-117">Tramite tale puntatore di interfaccia, il client può accedere ai metodi di tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="717cb-117">Through that interface pointer, the client has access to the methods of that interface.</span></span> <span data-ttu-id="717cb-118">Se invece l'oggetto rifiuta la richiesta del client, **QueryInterface** restituisce un puntatore null, ovvero un errore, e il client non dispone di un puntatore tramite il quale chiamare le funzioni desiderate.</span><span class="sxs-lookup"><span data-stu-id="717cb-118">If, on the other hand, the object rejects the client's request, **QueryInterface** returns a null pointer—an error—and the client has no pointer through which to call the desired functions.</span></span> <span data-ttu-id="717cb-119">In questo caso, il client deve occuparsi normalmente di tale possibilità.</span><span class="sxs-lookup"><span data-stu-id="717cb-119">In this case, the client must deal gracefully with that possibility.</span></span> <span data-ttu-id="717cb-120">Si supponga, ad esempio, che un client disponga di un puntatore all'interfaccia A su un oggetto e chieda le interfacce B e C. si supponga inoltre che l'oggetto supporti l'interfaccia B ma non supporti l'interfaccia C. Il risultato è che l'oggetto restituisce un puntatore a B e segnala che C non è supportato.</span><span class="sxs-lookup"><span data-stu-id="717cb-120">For example, suppose a client has a pointer to interface A on an object and asks for interfaces B and C. Suppose also that the object supports interface B but does not support interface C. The result is that the object returns a pointer to B and reports that C is not supported.</span></span>

<span data-ttu-id="717cb-121">Un punto chiave è che quando un oggetto rifiuta una chiamata a [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), è impossibile per il client chiedere all'oggetto di eseguire le operazioni espresse tramite l'interfaccia richiesta.</span><span class="sxs-lookup"><span data-stu-id="717cb-121">A key point is that when an object rejects a call to [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it is impossible for the client to ask the object to perform the operations expressed through the requested interface.</span></span> <span data-ttu-id="717cb-122">Un client deve disporre di un puntatore a interfaccia per richiamare i metodi in tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="717cb-122">A client must have an interface pointer to invoke methods in that interface.</span></span> <span data-ttu-id="717cb-123">Se l'oggetto rifiuta di fornire il puntatore richiesto, è necessario che il client sia pronto per eseguire l'operazione senza, né in alcun modo che abbia avuto intenzione di eseguire tale oggetto oppure tentando di eseguire il fallback in un'altra interfaccia, forse meno potente.</span><span class="sxs-lookup"><span data-stu-id="717cb-123">If the object refuses to provide the requested pointer, the client must be prepared to do without, either by not doing whatever it had intended to do with that object or by attempting to fall back on another, perhaps less powerful, interface.</span></span> <span data-ttu-id="717cb-124">Questa funzionalità della funzionalità COM funziona in modo ottimale rispetto ad altri sistemi orientati a oggetti in cui non è possibile sapere se una funzione funzionerà finché non si chiama tale funzione e anche in questo caso la gestione degli errori non è certo.</span><span class="sxs-lookup"><span data-stu-id="717cb-124">This feature of COM functionality works well in comparison with other object-oriented systems in which you cannot know whether a function will work until you call that function, and even then, handling failure is uncertain.</span></span> <span data-ttu-id="717cb-125">**QueryInterface** fornisce un modo affidabile e coerente per sapere se un oggetto supporta un'interfaccia prima di tentare di chiamarne i metodi.</span><span class="sxs-lookup"><span data-stu-id="717cb-125">**QueryInterface** provides a reliable and consistent way to know whether an object supports an interface before attempting to call its methods.</span></span>

<span data-ttu-id="717cb-126">Il metodo [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) fornisce inoltre un modo solido e affidabile per un oggetto per indicare che non supporta un determinato contratto.</span><span class="sxs-lookup"><span data-stu-id="717cb-126">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method also provides a robust and reliable way for an object to indicate that it does not support a given contract.</span></span> <span data-ttu-id="717cb-127">Ovvero, se in una chiamata a **QueryInterface** One chiede a un oggetto "obsoleto" se supporta un'interfaccia "nuova" (uno, ad esempio, che è stato inventato dopo che l'oggetto precedente era stato spedito), l'oggetto precedente sarà affidabile, senza causare un arresto anomalo, rispondere a "No".</span><span class="sxs-lookup"><span data-stu-id="717cb-127">That is, if in a call to **QueryInterface** one asks an "old" object whether it supports a "new" interface (one, for example, that was invented after the old object had been shipped), the old object will reliably, without causing a crash, answer "no."</span></span> <span data-ttu-id="717cb-128">La tecnologia che lo supporta è l'algoritmo con cui vengono allocate IID.</span><span class="sxs-lookup"><span data-stu-id="717cb-128">The technology that supports this is the algorithm by which IIDs are allocated.</span></span> <span data-ttu-id="717cb-129">Sebbene possa sembrare un piccolo punto, è estremamente importante per l'architettura complessiva del sistema e la possibilità di richiedere elementi legacy sulle nuove funzionalità è sorprendentemente una funzionalità non presente nella maggior parte delle architetture degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="717cb-129">While this may seem like a small point, it is extremely important to the overall architecture of the system, and the ability to inquire of legacy elements about new functionality is, surprisingly, a feature not present in most other object architectures.</span></span>

## <a name="related-topics"></a><span data-ttu-id="717cb-130">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="717cb-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="717cb-131">Uso e implementazione di IUnknown</span><span class="sxs-lookup"><span data-stu-id="717cb-131">Using and Implementing IUnknown</span></span>](using-and-implementing-iunknown.md)
</dt> </dl>

 

 




