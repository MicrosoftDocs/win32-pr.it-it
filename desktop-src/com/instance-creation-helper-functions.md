---
title: Funzioni di supporto per la creazione di istanze
description: Funzioni di supporto per la creazione di istanze
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104047407"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="07feb-103">Funzioni di supporto per la creazione di istanze</span><span class="sxs-lookup"><span data-stu-id="07feb-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="07feb-104">Nelle versioni precedenti di COM, il meccanismo principale utilizzato per creare un'istanza dell'oggetto era la funzione [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) .</span><span class="sxs-lookup"><span data-stu-id="07feb-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="07feb-105">Questa funzione incapsula il processo di creazione di un oggetto classe, usando tale oggetto per creare una nuova istanza e rilasciare l'oggetto classe.</span><span class="sxs-lookup"><span data-stu-id="07feb-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="07feb-106">Un'altra funzione di questo tipo è la [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate)più specifica, l'helper del documento composito OLE che crea un oggetto classe e recupera un puntatore a un oggetto richiesto.</span><span class="sxs-lookup"><span data-stu-id="07feb-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="07feb-107">Per semplificare il processo di creazione dell'istanza nei sistemi distribuiti, COM ha introdotto quattro importanti nuovi meccanismi di creazione dell'istanza:</span><span class="sxs-lookup"><span data-stu-id="07feb-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="07feb-108">Moniker della classe e [ **IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="07feb-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="07feb-109">**CoCreateInstanceEx**</span><span class="sxs-lookup"><span data-stu-id="07feb-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="07feb-110">**CoGetInstanceFromFile**</span><span class="sxs-lookup"><span data-stu-id="07feb-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="07feb-111">**CoGetInstanceFromIStorage**</span><span class="sxs-lookup"><span data-stu-id="07feb-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="07feb-112">Un moniker della classe consente di identificare la classe di un oggetto e viene in genere usata con un altro moniker, ad esempio un moniker di file, per indicare la posizione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="07feb-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="07feb-113">Ciò consente di eseguire il binding a un oggetto e di specificare il server da avviare per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="07feb-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="07feb-114">I moniker della classe possono anche essere composti a destra dei moniker che supportano l'associazione all'interfaccia [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) .</span><span class="sxs-lookup"><span data-stu-id="07feb-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="07feb-115">Per ulteriori informazioni, vedere [moniker della classe](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="07feb-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="07feb-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) estende [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) per consentire la creazione di un singolo oggetto non INIZIALIZZAto associato al CLSID specificato in un computer remoto specificato.</span><span class="sxs-lookup"><span data-stu-id="07feb-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="07feb-117">Inoltre, anziché richiedere una singola interfaccia e ottenere un singolo puntatore a tale interfaccia, **CoCreateInstanceEx** consente di eseguire una query per più interfacce e, se disponibili, di ricevere puntatori in un unico round trip, consentendo così un minor numero di round trip tra i computer.</span><span class="sxs-lookup"><span data-stu-id="07feb-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="07feb-118">In questo modo è possibile rendere più efficiente l'interazione con gli oggetti remoti.</span><span class="sxs-lookup"><span data-stu-id="07feb-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="07feb-119">A tale scopo, la funzione usa una matrice di strutture a più [**livelli di \_ Qi**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) .</span><span class="sxs-lookup"><span data-stu-id="07feb-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="07feb-120">Per la creazione di un oggetto tramite [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) è ancora necessario che l'oggetto venga inizializzato tramite una chiamata a una delle interfacce di inizializzazione (ad esempio [**IPersistStorage:: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span><span class="sxs-lookup"><span data-stu-id="07feb-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="07feb-121">Le funzioni di supporto [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) e [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) incapsulano sia la potenza di creazione dell'istanza di **CoCreateInstanceEx** che l'inizializzazione, la prima da un file e la seconda da una risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="07feb-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="07feb-122">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="07feb-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="07feb-123">Creazione di un oggetto tramite un oggetto classe</span><span class="sxs-lookup"><span data-stu-id="07feb-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 