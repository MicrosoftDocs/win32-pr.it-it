---
title: Creazione ed elaborazione di chiamate asincrone
description: Gli oggetti COM possono supportare la chiamata asincrona.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 059f55cc64a70f130e7fb654426803edbe8b7209
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "106300526"
---
# <a name="making-and-processing-asynchronous-calls"></a><span data-ttu-id="a01ba-103">Creazione ed elaborazione di chiamate asincrone</span><span class="sxs-lookup"><span data-stu-id="a01ba-103">Making and Processing Asynchronous Calls</span></span>

<span data-ttu-id="a01ba-104">Gli oggetti COM possono supportare la chiamata asincrona.</span><span class="sxs-lookup"><span data-stu-id="a01ba-104">COM objects can support asynchronous calling.</span></span> <span data-ttu-id="a01ba-105">Quando un client effettua una chiamata asincrona, il controllo torna immediatamente al client.</span><span class="sxs-lookup"><span data-stu-id="a01ba-105">When a client makes an asynchronous call, control returns to the client immediately.</span></span> <span data-ttu-id="a01ba-106">Mentre il server elabora la chiamata, il client è libero di eseguire altre operazioni.</span><span class="sxs-lookup"><span data-stu-id="a01ba-106">While the server processes the call, the client is free to do other work.</span></span> <span data-ttu-id="a01ba-107">Quando il client non può più procedere senza i risultati della chiamata, può ottenere i risultati della chiamata in quel momento.</span><span class="sxs-lookup"><span data-stu-id="a01ba-107">When the client can no longer proceed without the results of the call, it can get the results of the call at that time.</span></span>

<span data-ttu-id="a01ba-108">Ad esempio, una richiesta di un recordset di grandi dimensioni o complessi può richiedere molto tempo.</span><span class="sxs-lookup"><span data-stu-id="a01ba-108">For example, a request for a large or complex recordset can be time-consuming.</span></span> <span data-ttu-id="a01ba-109">Un client può richiedere il recordset mediante una chiamata asincrona e quindi eseguire altre operazioni.</span><span class="sxs-lookup"><span data-stu-id="a01ba-109">A client can request the recordset by an asynchronous call and then do other work.</span></span> <span data-ttu-id="a01ba-110">Quando il recordset è disponibile, il client può ottenerlo rapidamente senza bloccarsi.</span><span class="sxs-lookup"><span data-stu-id="a01ba-110">When the recordset is available, the client can obtain it quickly without blocking.</span></span>

<span data-ttu-id="a01ba-111">I client non eseguono chiamate asincrone direttamente nell'oggetto server.</span><span class="sxs-lookup"><span data-stu-id="a01ba-111">Clients do not make asynchronous calls directly on the server object.</span></span> <span data-ttu-id="a01ba-112">Ottengono invece un oggetto chiamata che implementa una versione asincrona di un'interfaccia sincrona nell'oggetto server.</span><span class="sxs-lookup"><span data-stu-id="a01ba-112">Instead, they obtain a call object that implements an asynchronous version of a synchronous interface on the server object.</span></span> <span data-ttu-id="a01ba-113">L'interfaccia asincrona nell'oggetto chiamata ha un nome con formato asincrono *intervisore*.</span><span class="sxs-lookup"><span data-stu-id="a01ba-113">The asynchronous interface on the call object has a name of the form Async *InterfaceName*.</span></span> <span data-ttu-id="a01ba-114">Se, ad esempio, un oggetto server implementa un'interfaccia sincrona denominata IMyInterface, sarà presente un oggetto chiamata che implementa un'interfaccia asincrona denominata AsyncIMyInterface.</span><span class="sxs-lookup"><span data-stu-id="a01ba-114">For example, if a server object implements a synchronous interface named IMyInterface, there will be a call object that implements an asynchronous interface named AsyncIMyInterface.</span></span>

> [!Note]  
> <span data-ttu-id="a01ba-115">Il supporto asincrono non è disponibile per **IDispatch** o per le interfacce che ereditano **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="a01ba-115">Asynchronous support is not available for **IDispatch** or for interfaces that inherit **IDispatch**.</span></span>

 

<span data-ttu-id="a01ba-116">Gli oggetti server che supportano le chiamate asincrone implementano l'interfaccia [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) .</span><span class="sxs-lookup"><span data-stu-id="a01ba-116">Server objects that support asynchronous calls implement the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="a01ba-117">Questa interfaccia espone un solo metodo, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), che crea un'istanza di un oggetto chiamata specificato.</span><span class="sxs-lookup"><span data-stu-id="a01ba-117">This interface exposes a single method, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), which creates an instance of a specified call object.</span></span> <span data-ttu-id="a01ba-118">I client possono eseguire query per **ICallFactory** per determinare se un oggetto supporta la chiamata asincrona.</span><span class="sxs-lookup"><span data-stu-id="a01ba-118">Clients can query for **ICallFactory** to determine whether an object supports asynchronous calling.</span></span>

<span data-ttu-id="a01ba-119">Per ogni metodo su un'interfaccia sincrona, l'interfaccia asincrona corrispondente implementa due metodi.</span><span class="sxs-lookup"><span data-stu-id="a01ba-119">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="a01ba-120">Questi metodi alleghino i prefissi iniziano \_ e terminano \_ con il nome del metodo sincrono.</span><span class="sxs-lookup"><span data-stu-id="a01ba-120">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="a01ba-121">Se, ad esempio, un'interfaccia denominata ISimpleStream dispone di un metodo Read, l'interfaccia AsyncISimpleStream disporrà di un \_ metodo Begin Read e Finish \_ Read.</span><span class="sxs-lookup"><span data-stu-id="a01ba-121">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="a01ba-122">Per iniziare una chiamata asincrona, il client chiama il \_ metodo Begin.</span><span class="sxs-lookup"><span data-stu-id="a01ba-122">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="a01ba-123">Quando si implementa un oggetto server, non è necessario fornire un oggetto chiamata per ogni interfaccia implementata dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="a01ba-123">When you implement a server object, you do not have to provide a call object for every interface the object implements.</span></span> <span data-ttu-id="a01ba-124">Se l'oggetto server implementa l'interfaccia [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) e utilizza il marshalling standard, un client sottoposto a marshalling può sempre ottenere un oggetto chiamata proxy, anche se non è presente alcun oggetto chiamata sul lato server.</span><span class="sxs-lookup"><span data-stu-id="a01ba-124">If the server object implements the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface and uses standard marshaling, a marshaled client can always obtain a proxy call object, even if there is no call object on the server side.</span></span> <span data-ttu-id="a01ba-125">Questo proxy effettuerà il marshalling del \_ metodo Begin come chiamata sincrona, il server elaborerà la chiamata in modo sincrono e il client potrà ottenere i parametri out chiamando il \_ Metodo Finish.</span><span class="sxs-lookup"><span data-stu-id="a01ba-125">This proxy will marshal the Begin\_ method as a synchronous call, the server will process the call synchronously, and the client can obtain the out parameters by calling the Finish\_ method.</span></span>

<span data-ttu-id="a01ba-126">Viceversa, se un client esegue una chiamata sincrona con marshalling su un'interfaccia per la quale è presente un oggetto chiamata sul lato server, il server elaborerà sempre la chiamata in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="a01ba-126">Conversely, if a client makes a marshaled synchronous call on an interface for which there is a call object on the server side, the server will always process the call asynchronously.</span></span> <span data-ttu-id="a01ba-127">Questo comportamento non sarà visibile al client, perché il client riceverà gli stessi parametri out e lo stesso valore restituito che avrebbe ricevuto dal metodo sincrono.</span><span class="sxs-lookup"><span data-stu-id="a01ba-127">This behavior will not be apparent to the client, because the client will receive the same out parameters and the same return value it would have received from the synchronous method.</span></span>

<span data-ttu-id="a01ba-128">In entrambi i casi, l'interazione tra client e server viene sottoposta a marshalling come se la chiamata fosse sincrona: l'output dei proxy sincroni e asincroni non è distinguibile, così come l'output degli stub corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="a01ba-128">In either case, the interaction between client and server is marshaled as if the call were synchronous: The output of synchronous and asynchronous proxies is indistinguishable, as is the output of the corresponding stubs.</span></span> <span data-ttu-id="a01ba-129">Questo comportamento semplifica notevolmente il modello di programmazione di client e server.</span><span class="sxs-lookup"><span data-stu-id="a01ba-129">This behavior greatly simplifies the programming model both of clients and of servers.</span></span> <span data-ttu-id="a01ba-130">Se un oggetto server implementa [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), un client sottoposto a marshalling non deve tentare di creare un oggetto chiamata che potrebbe non essere disponibile: per il client, un oggetto chiamata è sempre disponibile.</span><span class="sxs-lookup"><span data-stu-id="a01ba-130">If a server object implements [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), a marshaled client does not have to attempt to create a call object that may not be available — to the client, a call object is always available.</span></span>

<span data-ttu-id="a01ba-131">Quando il client e il server si trovano nello stesso Apartment, l'oggetto server elaborerà qualsiasi chiamata effettuata dal client.</span><span class="sxs-lookup"><span data-stu-id="a01ba-131">When client and server are in the same apartment, the server object will process whichever call the client makes.</span></span> <span data-ttu-id="a01ba-132">Se un oggetto chiamata non è disponibile, il client deve ottenere in modo esplicito l'interfaccia sincrona ed effettuare una chiamata sincrona.</span><span class="sxs-lookup"><span data-stu-id="a01ba-132">If a call object is not available, the client must explicitly obtain the synchronous interface and make a synchronous call.</span></span>

<span data-ttu-id="a01ba-133">Per altre informazioni, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="a01ba-133">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="a01ba-134">Esecuzione di una chiamata asincrona</span><span class="sxs-lookup"><span data-stu-id="a01ba-134">Making an Asynchronous Call</span></span>](making-an-asynchronous-call.md)
-   [<span data-ttu-id="a01ba-135">Annullamento di una chiamata asincrona</span><span class="sxs-lookup"><span data-stu-id="a01ba-135">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
-   [<span data-ttu-id="a01ba-136">Annullamento di chiamate al metodo</span><span class="sxs-lookup"><span data-stu-id="a01ba-136">Canceling Method Calls</span></span>](canceling-method-calls.md)
-   [<span data-ttu-id="a01ba-137">Sincronizzazione delle chiamate</span><span class="sxs-lookup"><span data-stu-id="a01ba-137">Call Synchronization</span></span>](call-synchronization.md)

 

 