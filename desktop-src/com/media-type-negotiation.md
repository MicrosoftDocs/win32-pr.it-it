---
title: Negoziazione Media-Type
description: Molti protocolli Internet a livello di applicazione sono basati sullo scambio di messaggi in un formato semplice e flessibile denominato Multipurpose Internet Mail Extensions (MIME).
ms.assetid: 7a2c9d8f-639a-4865-a62b-63330175f5f0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb145fa3a76da6574172ddd24888f3b5da7ad85e
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104399782"
---
# <a name="media-type-negotiation"></a><span data-ttu-id="42a92-103">Negoziazione Media-Type</span><span class="sxs-lookup"><span data-stu-id="42a92-103">Media-Type Negotiation</span></span>

<span data-ttu-id="42a92-104">Molti protocolli Internet a livello di applicazione sono basati sullo scambio di messaggi in un formato semplice e flessibile denominato Multipurpose Internet Mail Extensions (MIME).</span><span class="sxs-lookup"><span data-stu-id="42a92-104">Many application-layer Internet protocols are based on the exchange of messages in a simple, flexible format called Multipurpose Internet Mail Extensions (MIME).</span></span> <span data-ttu-id="42a92-105">Sebbene MIME sia stato originato come standard per lo scambio di messaggi di posta elettronica, viene usato oggi da un'ampia gamma di applicazioni per specificare i formati di dati riconosciuti a vicenda come MIME, o supporti, tipi.</span><span class="sxs-lookup"><span data-stu-id="42a92-105">Although MIME originated as a standard for exchanging electronic mail messages, it is used today by a wide variety of applications to specify mutually understood data formats as MIME, or media, types.</span></span> <span data-ttu-id="42a92-106">Il processo è denominato *negoziazione del tipo di supporto*.</span><span class="sxs-lookup"><span data-stu-id="42a92-106">The process is called *media-type negotiation*.</span></span>

<span data-ttu-id="42a92-107">I tipi di supporto sono stringhe semplici che indicano un tipo e un sottotipo (ad esempio "text/plain" o "Text/HTML").</span><span class="sxs-lookup"><span data-stu-id="42a92-107">Media types are simple strings that denote a type and subtype (such as "text/plain" or "text/HTML").</span></span> <span data-ttu-id="42a92-108">Vengono usati per etichettare i dati o qualificare una richiesta.</span><span class="sxs-lookup"><span data-stu-id="42a92-108">They are used to label data or qualify a request.</span></span> <span data-ttu-id="42a92-109">Un Web browser, ad esempio, come parte di una richiesta HTTP for-data o Request-for-info, specifica che richiede i tipi di supporto "image/gif" o "image/jpeg", a cui un server Web risponde restituendo il tipo di supporto appropriato e, se la chiamata era una richiesta di dati, i dati nel formato richiesto.</span><span class="sxs-lookup"><span data-stu-id="42a92-109">A Web browser, for example, as part of an HTTP request-for-data or request-for-info, specifies that it is requesting "image/gif" or "image/jpeg" Media Types, to which a web server responds by returning the appropriate media type and, if the call was a request-for-data, the data itself in the requested format.</span></span>

<span data-ttu-id="42a92-110">La negoziazione del tipo di supporto è spesso simile al modo in cui le applicazioni desktop esistenti negoziano con gli Appunti di sistema per determinare il formato dati da incollare quando un utente sceglie Modifica/Incolla o esegue query per i formati quando riceve un puntatore [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) durante un'operazione di trascinamento della selezione.</span><span class="sxs-lookup"><span data-stu-id="42a92-110">Media-type negotiation is often similar to how existing desktop applications negotiate with the system clipboard to determine which data format to paste when a user chooses Edit/Paste or queries for formats when receiving an [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer during a drag-and-drop operation.</span></span> <span data-ttu-id="42a92-111">La differenza minima nella negoziazione del tipo di supporto HTTP è che il client non è in grado di stabilire in anticipo quali formati sono disponibili nel server.</span><span class="sxs-lookup"><span data-stu-id="42a92-111">The subtle difference in HTTP media-type negotiation is that the client does not know ahead of time which formats the server has available.</span></span> <span data-ttu-id="42a92-112">Pertanto, il client specifica i tipi di supporto supportati, in ordine di fedeltà massima, e il server risponde con il migliore formato disponibile.</span><span class="sxs-lookup"><span data-stu-id="42a92-112">Therefore, the client specifies up-front the media types it supports, in order of greatest fidelity, and the server responds with the best available format.</span></span>

<span data-ttu-id="42a92-113">I moniker URL supportano la negoziazione del tipo di supporto per i client e i server Internet per accettare i formati da usare durante il download dei dati nelle operazioni [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) .</span><span class="sxs-lookup"><span data-stu-id="42a92-113">URL monikers support media-type negotiation as a way for Internet clients and servers to agree upon formats to be used when downloading data in [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) operations.</span></span> <span data-ttu-id="42a92-114">Per supportare la negoziazione del tipo di supporto, un client implementa l'interfaccia [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) e chiama la funzione [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) per registrarla con il contesto di associazione.</span><span class="sxs-lookup"><span data-stu-id="42a92-114">To support media-type negotiation, a client implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface and calls the [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) function to register it with the bind context.</span></span> <span data-ttu-id="42a92-115">L'enumeratore di formato elenca i formati che il client può accettare.</span><span class="sxs-lookup"><span data-stu-id="42a92-115">The format enumerator lists the formats the client can accept.</span></span> <span data-ttu-id="42a92-116">Un moniker URL converte questi formati in tipi di supporto durante l'associazione agli URL HTTP.</span><span class="sxs-lookup"><span data-stu-id="42a92-116">A URL moniker translates these formats into media types when binding to HTTP URLs.</span></span>

<span data-ttu-id="42a92-117">I tipi di supporti possibili richiesti dal client sono rappresentati da moniker URL tramite strutture [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) disponibili nell'enumeratore [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) registrato dal chiamante nel contesto di binding: ogni **FORMATETC** specifica un formato degli appunti che identifica il tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="42a92-117">The possible media types requested by the client are represented to URL monikers through [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures available from the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) enumerator registered by the caller on the bind context: Each **FORMATETC** specifies a clipboard format identifying the media type.</span></span> <span data-ttu-id="42a92-118">Ad esempio, il frammento di codice seguente specifica che il tipo di supporto è post-script.</span><span class="sxs-lookup"><span data-stu-id="42a92-118">For example, the following code fragment specifies that the media type is PostScript.</span></span>

``` syntax
FORMATETC fmtetc;
fmtetc.cfFormat = RegisterClipboardFormat(CF_MIME_POSTSCRIPT);
. . .
```

<span data-ttu-id="42a92-119">Un client può impostare il formato degli Appunti sul tipo di supporto speciale CF \_ null per indicare che il tipo di supporto predefinito della risorsa a cui fa riferimento l'URL deve essere recuperato.</span><span class="sxs-lookup"><span data-stu-id="42a92-119">A client can set the clipboard format to the special media type CF\_NULL to indicate that the default media type of the resource pointed to by the URL should be retrieved.</span></span> <span data-ttu-id="42a92-120">Questo formato è in genere l'ultimo a cui il client è interessato.</span><span class="sxs-lookup"><span data-stu-id="42a92-120">This format is usually the last one in which the client is interested.</span></span> <span data-ttu-id="42a92-121">Quando nessun enumeratore viene registrato con il contesto di binding, un moniker URL funziona come se fosse disponibile un enumeratore contenente un singolo [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) con **cfFormat**= CF \_ null, scaricando automaticamente il tipo di supporto predefinito.</span><span class="sxs-lookup"><span data-stu-id="42a92-121">When no enumerator is registered with the bind context, a URL moniker works as if an enumerator containing a single [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) with **cfFormat**=CF\_NULL is available, automatically downloading the default media-type.</span></span>

<span data-ttu-id="42a92-122">Indipendentemente dal tipo di supporto da usare, il client riceve una notifica della scelta per mezzo dell'argomento *pFormatetc* nel metodo [**IBindStatusCallback:: ondataavailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="42a92-122">Whatever media type is to be used, the client is notified of the choice by means of the *pformatetc* argument on its [**IBindStatusCallback::OnDataAvailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) method.</span></span> <span data-ttu-id="42a92-123">Il callback si verifica nel contesto della chiamata del client a [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="42a92-123">The callback occurs within the context of the client's call to [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span></span>

> [!Note]  
> <span data-ttu-id="42a92-124">Se il contenuto ricevuto è di un tipo di supporto non riconosciuto, il client chiama automaticamente [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) per registrare il nuovo tipo.</span><span class="sxs-lookup"><span data-stu-id="42a92-124">If received content is of an unrecognized media-type, the client automatically calls [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) to register the new type.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="42a92-125">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="42a92-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="42a92-126">Moniker URL</span><span class="sxs-lookup"><span data-stu-id="42a92-126">URL Monikers</span></span>](url-monikers.md)
</dt> </dl>

 

 