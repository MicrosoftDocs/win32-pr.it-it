---
title: Registrazione di una classe durante l'installazione
description: Se una classe deve essere disponibile per i client in qualsiasi momento, come la maggior parte delle applicazioni, in genere viene registrata tramite un programma di installazione e configurazione.
ms.assetid: 6d78c2ce-56d8-4866-9801-35125ec9cac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4253c40cb3feb7e737368c947c0b20715f5becbd
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104339366"
---
# <a name="registering-a-class-at-installation"></a><span data-ttu-id="e63fd-103">Registrazione di una classe durante l'installazione</span><span class="sxs-lookup"><span data-stu-id="e63fd-103">Registering a Class at Installation</span></span>

<span data-ttu-id="e63fd-104">Se una classe deve essere disponibile per i client in qualsiasi momento, come la maggior parte delle applicazioni, in genere viene registrata tramite un programma di installazione e configurazione.</span><span class="sxs-lookup"><span data-stu-id="e63fd-104">If a class is intended to be available to clients at any time, as most applications are, you usually register it through an installation and setup program.</span></span> <span data-ttu-id="e63fd-105">Ciò significa inserire le informazioni relative all'applicazione nel registro di sistema, incluse le modalità e la posizione in cui devono essere create le istanze degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="e63fd-105">This means putting information about the application into the registry, including how and where its objects are to be instantiated.</span></span> <span data-ttu-id="e63fd-106">Queste informazioni devono essere registrate per tutti i CLSID.</span><span class="sxs-lookup"><span data-stu-id="e63fd-106">This information must be registered for all CLSIDs.</span></span> <span data-ttu-id="e63fd-107">Altre informazioni sono facoltative.</span><span class="sxs-lookup"><span data-stu-id="e63fd-107">Other information is optional.</span></span> <span data-ttu-id="e63fd-108">Strumenti come regsvr32 semplificano la scrittura di un programma di installazione che registra i server durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="e63fd-108">Tools such as Regsvr32 make it simple to write a setup program that registers servers at installation.</span></span>

<span data-ttu-id="e63fd-109">Se non si basano sulle impostazioni predefinite di sistema, nel registro di sistema sono presenti due chiavi importanti: CLSID e AppID.</span><span class="sxs-lookup"><span data-stu-id="e63fd-109">If you are not relying on system defaults, there are two important keys in the registry: the CLSID and the AppID.</span></span> <span data-ttu-id="e63fd-110">Tra le informazioni importanti in queste chiavi viene illustrato come creare un'istanza dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e63fd-110">Among the important pieces of information under these keys is how the object is to be instantiated.</span></span> <span data-ttu-id="e63fd-111">Gli oggetti possono essere designati come in-process, out-of-process locale o out-of-process remote.</span><span class="sxs-lookup"><span data-stu-id="e63fd-111">Objects can be designated as in-process, out-of-process local, or out-of-process remote.</span></span>

<span data-ttu-id="e63fd-112">Nella chiave AppID sono disponibili diversi valori che definiscono informazioni specifiche per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e63fd-112">Under the AppID key are several values that define information specific to that application.</span></span> <span data-ttu-id="e63fd-113">Tra questi sono [RemoteServerName](remoteservername.md) e [ActivateAtStorage](activateatstorage.md), entrambi possono essere usati per consentire a un client di creare un oggetto, con il client senza alcuna conoscenza incorporata della posizione del server.</span><span class="sxs-lookup"><span data-stu-id="e63fd-113">Among these are [RemoteServerName](remoteservername.md) and [ActivateAtStorage](activateatstorage.md), both of which can be used to permit a client to create an object, with the client having no built-in knowledge of the location of the server.</span></span> <span data-ttu-id="e63fd-114">Per ulteriori informazioni sulla creazione di istanze remote, vedere [individuazione di](locating-a-remote-object.md) [funzioni di supporto](instance-creation-helper-functions.md)per la creazione di oggetti e istanze remote.</span><span class="sxs-lookup"><span data-stu-id="e63fd-114">(For more information about remote instantiation, see [Locating a Remote Object](locating-a-remote-object.md) and [Instance Creation Helper Functions](instance-creation-helper-functions.md).)</span></span>

<span data-ttu-id="e63fd-115">Un server può anche essere installato come servizio o per l'esecuzione con un account utente specifico.</span><span class="sxs-lookup"><span data-stu-id="e63fd-115">A server can also be installed as a service, or to run under a specific user account.</span></span> <span data-ttu-id="e63fd-116">Per ulteriori informazioni, vedere [installazione come applicazione di servizio](installing-as-a-service-application.md).</span><span class="sxs-lookup"><span data-stu-id="e63fd-116">For more information, see [Installing as a Service Application](installing-as-a-service-application.md).</span></span>

<span data-ttu-id="e63fd-117">Un oggetto server o ROT che non è un servizio o in esecuzione con un account utente specifico può essere definito come server "Activate As Activator".</span><span class="sxs-lookup"><span data-stu-id="e63fd-117">A server or ROT object that is not a service or running under a specific user account can be referred to as an "activate as activator" server.</span></span> <span data-ttu-id="e63fd-118">Per questi server, il contesto di sicurezza e la stazione/desktop della finestra del client devono corrispondere a quelli del server.</span><span class="sxs-lookup"><span data-stu-id="e63fd-118">For these servers, the security context and the window station/desktop of the client must match the server's.</span></span> <span data-ttu-id="e63fd-119">Un client che tenta di connettersi a un server remoto viene considerato con una finestra Station/Desktop **null** , quindi viene confrontato solo il contesto di sicurezza del server in questa istanza.</span><span class="sxs-lookup"><span data-stu-id="e63fd-119">A client attempting to connect to a remote server is considered to have a **NULL** window station/desktop, so only the server security context is compared in this instance.</span></span> <span data-ttu-id="e63fd-120">Per ulteriori informazioni sui SID, vedere [sicurezza in com](security-in-com.md). COM memorizza nella cache la stazione o il desktop di un processo quando il processo si connette per la prima volta al servizio COM distribuito.</span><span class="sxs-lookup"><span data-stu-id="e63fd-120">(For more information about SIDs, see [Security in COM](security-in-com.md).) COM caches the window station/desktop of a process when the process first connects to the distributed COM service.</span></span> <span data-ttu-id="e63fd-121">Di conseguenza, i client e i server COM non devono modificare la stazione di Windows o i desktop dei thread del processo dopo la chiamata di [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span><span class="sxs-lookup"><span data-stu-id="e63fd-121">Therefore, COM clients and servers should not change their window station or thread desktops of the process after calling [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span>

<span data-ttu-id="e63fd-122">Quando una classe viene registrata come in-process, una chiamata a [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) per creare il relativo oggetto classe viene passata automaticamente da com alla funzione [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) , che deve essere implementata dalla classe per assegnare all'oggetto chiamante un puntatore al relativo oggetto classe.</span><span class="sxs-lookup"><span data-stu-id="e63fd-122">When a class is registered as in-process, a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) to create its class object is automatically passed by COM to the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which the class must implement to give the calling object a pointer to its class object.</span></span>

<span data-ttu-id="e63fd-123">Le classi implementate nei file eseguibili possono specificare che COM deve eseguire il processo e attendere che il processo registri l'interfaccia [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) dell'oggetto della classe tramite una chiamata alla funzione [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) .</span><span class="sxs-lookup"><span data-stu-id="e63fd-123">Classes implemented in executables can specify that COM should execute their process and wait for the process to register their class object's [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface through a call to the [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e63fd-124">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="e63fd-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e63fd-125">Chiavi del registro di sistema COM</span><span class="sxs-lookup"><span data-stu-id="e63fd-125">COM Registry Keys</span></span>](com-registry-keys.md)
</dt> <dt>

[<span data-ttu-id="e63fd-126">Installazione come applicazione di servizio</span><span class="sxs-lookup"><span data-stu-id="e63fd-126">Installing as a Service Application</span></span>](installing-as-a-service-application.md)
</dt> <dt>

[<span data-ttu-id="e63fd-127">Registrazione di un server EXE in esecuzione</span><span class="sxs-lookup"><span data-stu-id="e63fd-127">Registering a Running EXE Server</span></span>](registering-a-running-exe-server.md)
</dt> <dt>

[<span data-ttu-id="e63fd-128">Registrazione di componenti</span><span class="sxs-lookup"><span data-stu-id="e63fd-128">Registering Components</span></span>](registering-components.md)
</dt> <dt>

[<span data-ttu-id="e63fd-129">Registrazione di oggetti nella tabella ROT</span><span class="sxs-lookup"><span data-stu-id="e63fd-129">Registering Objects in the ROT</span></span>](registering-objects-in-the-rot.md)
</dt> <dt>

[<span data-ttu-id="e63fd-130">Registrazione automatica</span><span class="sxs-lookup"><span data-stu-id="e63fd-130">Self-Registration</span></span>](self-registration.md)
</dt> </dl>

 

 