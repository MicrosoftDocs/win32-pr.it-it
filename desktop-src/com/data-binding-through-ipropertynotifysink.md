---
title: Data binding tramite IPropertyNotifySink
description: Data binding tramite IPropertyNotifySink
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103714263"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="35f2a-103">Data binding tramite IPropertyNotifySink</span><span class="sxs-lookup"><span data-stu-id="35f2a-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="35f2a-104">Gli oggetti che supportano le proprietà, ad esempio tramite l'automazione OLE e l'interfaccia **IDispatch** , possono consentire ai client di ricevere notifiche quando determinate proprietà modificano il valore.</span><span class="sxs-lookup"><span data-stu-id="35f2a-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="35f2a-105">Tale proprietà viene chiamata proprietà associabile perché le notifiche consentono a un client di sincronizzare la propria visualizzazione dei valori delle proprietà correnti dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="35f2a-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="35f2a-106">Inoltre, è possibile che gli stessi oggetti desiderino consentire a un client di controllare quando è consentita la modifica di determinate proprietà.</span><span class="sxs-lookup"><span data-stu-id="35f2a-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="35f2a-107">Tali proprietà sono denominate proprietà di modifica della richiesta.</span><span class="sxs-lookup"><span data-stu-id="35f2a-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="35f2a-108">[**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) è un'interfaccia di notifica standard che supporta proprietà associabili e di modifica richieste.</span><span class="sxs-lookup"><span data-stu-id="35f2a-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="35f2a-109">**IPropertyNotifySink** è supportato da un oggetto con proprietà come interfaccia in uscita.</span><span class="sxs-lookup"><span data-stu-id="35f2a-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="35f2a-110">Ovvero l'interfaccia stessa viene implementata dall'oggetto sink di un client e il client connette il sink all'oggetto di supporto tramite il meccanismo del punto di connessione descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="35f2a-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="35f2a-111">**IPropertyNotifySink** è definito come segue:</span><span class="sxs-lookup"><span data-stu-id="35f2a-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="35f2a-112">Quando un oggetto desidera notificare ai sink connessi che è stata modificata una proprietà associabile identificata con un DISPID specificato, viene chiamato [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="35f2a-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="35f2a-113">Se un oggetto modifica contemporaneamente più proprietà, può passare \_ il DISPID Unknown a **OnChanged** nel qual caso un client aggiorna la cache di tutti i valori di proprietà di interesse.</span><span class="sxs-lookup"><span data-stu-id="35f2a-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="35f2a-114">Quando una proprietà di modifica della richiesta sta per essere modificata, un oggetto può chiedere al client se consentirà la modifica.</span><span class="sxs-lookup"><span data-stu-id="35f2a-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="35f2a-115">L'oggetto chiama [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passando il DISPID della proprietà in questione (o DISPID \_ sconosciuto per identificare tutte le proprietà).</span><span class="sxs-lookup"><span data-stu-id="35f2a-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="35f2a-116">Il sink del client restituisce \_ OK per indicare che la modifica è consentita, oppure s \_ false (o un errore) per indicare che la modifica non è consentita.</span><span class="sxs-lookup"><span data-stu-id="35f2a-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="35f2a-117">Quando un oggetto chiama **OnRequestEdit**, è necessario rispettare i desideri del client attenendosi alla semantica esatta dei \_ valori restituiti S OK e s \_ false.</span><span class="sxs-lookup"><span data-stu-id="35f2a-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="35f2a-118">Si noti che non è possibile usare [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) per la convalida dei dati perché al momento della chiamata il nuovo valore della proprietà non è ancora disponibile.</span><span class="sxs-lookup"><span data-stu-id="35f2a-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="35f2a-119">La notifica può essere utilizzata solo per controllare uno stato di sola lettura per una proprietà.</span><span class="sxs-lookup"><span data-stu-id="35f2a-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="35f2a-120">Gli oggetti controllano quali proprietà sono associabili e richiedono modifiche e contrassegnano tali proprietà nelle informazioni sul tipo dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="35f2a-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="35f2a-121">Nelle informazioni sul tipo, l'attributo associabile contrassegna una proprietà come supporto di [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="35f2a-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="35f2a-122">L'attributo requestedit contrassegna una proprietà come supporto di [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span><span class="sxs-lookup"><span data-stu-id="35f2a-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="35f2a-123">Una proprietà può supportare entrambi i comportamenti, nel qual caso [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) viene chiamato per primo e solo se la modifica è consentita [**, viene chiamato**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) il metodo.</span><span class="sxs-lookup"><span data-stu-id="35f2a-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="35f2a-124">L'unica eccezione al comportamento di tali proprietà è che non viene inviata alcuna notifica come risultato delle procedure di inizializzazione o caricamento di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="35f2a-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="35f2a-125">In questi casi, si presuppone che tutte le proprietà vengano modificate e che tutte siano consentite per la modifica.</span><span class="sxs-lookup"><span data-stu-id="35f2a-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="35f2a-126">Le notifiche a questa interfaccia sono pertanto significative solo nel contesto di un oggetto completamente inizializzato/caricato.</span><span class="sxs-lookup"><span data-stu-id="35f2a-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="35f2a-127">È possibile applicare altri due attributi alle proprietà nelle informazioni sul tipo di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="35f2a-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="35f2a-128">L'attributo defaultbind contrassegna una proprietà associabile come quella che meglio rappresenta lo stato dell'oggetto nel suo complesso.</span><span class="sxs-lookup"><span data-stu-id="35f2a-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="35f2a-129">L'attributo DisplayBind contrassegna una proprietà associabile come adatta per la visualizzazione nell'interfaccia utente di un client.</span><span class="sxs-lookup"><span data-stu-id="35f2a-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="35f2a-130">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="35f2a-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="35f2a-131">Pagine delle proprietà e finestre delle proprietà</span><span class="sxs-lookup"><span data-stu-id="35f2a-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




