---
title: Definizione di interfacce COM
description: Microsoft definisce numerose interfacce COM. Nella maggior parte dei casi, è possibile riutilizzare queste interfacce generiche. Tuttavia, alcune applicazioni prevedono requisiti specifici che consentono di definire interfacce di oggetti personalizzate.
ms.assetid: 8a94bd7d-d101-411c-97de-9e9a46bf9591
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 516c02a2c337b2c76229094b0e42d75b44f65d16
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104118511"
---
# <a name="defining-com-interfaces"></a><span data-ttu-id="1422c-105">Definizione di interfacce COM</span><span class="sxs-lookup"><span data-stu-id="1422c-105">Defining COM Interfaces</span></span>

<span data-ttu-id="1422c-106">Microsoft definisce numerose interfacce COM.</span><span class="sxs-lookup"><span data-stu-id="1422c-106">Microsoft defines many COM interfaces.</span></span> <span data-ttu-id="1422c-107">Nella maggior parte dei casi, è possibile riutilizzare queste interfacce generiche.</span><span class="sxs-lookup"><span data-stu-id="1422c-107">In most cases, you can reuse these generic interfaces.</span></span> <span data-ttu-id="1422c-108">Tuttavia, alcune applicazioni prevedono requisiti specifici che consentono di definire interfacce di oggetti personalizzate.</span><span class="sxs-lookup"><span data-stu-id="1422c-108">However, some applications have specific requirements that make it desirable or necessary to define your own object interfaces.</span></span>

<span data-ttu-id="1422c-109">Tutte le interfacce COM devono derivare, direttamente o indirettamente, dall'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="1422c-109">All COM interfaces must derive, directly or indirectly, from the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="1422c-110">All'interno di tale vincolo, l'interfaccia personalizzata può supportare quasi qualsiasi metodo o parametro, inclusi i metodi asincroni.</span><span class="sxs-lookup"><span data-stu-id="1422c-110">Within that constraint, your custom interface can support almost any method or parameter, including asynchronous methods.</span></span> <span data-ttu-id="1422c-111">È anche possibile generare una libreria dei tipi per le interfacce personalizzate in modo che i client possano accedere alle informazioni sui metodi dell'oggetto in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="1422c-111">You can also generate a type library for your custom interfaces so that clients can access information about your object's methods at run time.</span></span> <span data-ttu-id="1422c-112">Dopo aver definito un'interfaccia, descriverla in Microsoft Interface Definition Language (MIDL), compilarla e registrarla in modo analogo a qualsiasi interfaccia generica.</span><span class="sxs-lookup"><span data-stu-id="1422c-112">After you define an interface, describe it in Microsoft Interface Definition Language (MIDL), compile and register it, you use it just like any generic interface.</span></span> <span data-ttu-id="1422c-113">Con Distributed COM, i metodi di interfaccia sono disponibili sia per i processi remoti che per altri processi nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="1422c-113">With distributed COM, interface methods are available both to remote processes and to other processes on the same computer.</span></span>

<span data-ttu-id="1422c-114">Infine, la compilazione di interfacce COM richiede un ambiente di sviluppo che includa un compilatore C/C++ e il compilatore Midl.exe.</span><span class="sxs-lookup"><span data-stu-id="1422c-114">Finally, building COM interfaces requires a development environment that includes a C/C++ compiler and the Midl.exe compiler.</span></span>

<span data-ttu-id="1422c-115">I passaggi per la creazione di un'interfaccia COM sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="1422c-115">The steps in creating a COM interface are as follows:</span></span>

-   <span data-ttu-id="1422c-116">Decidere come si desidera fornire supporto per il marshalling per l'interfaccia. con marshalling guidato dalla libreria dei tipi o con una DLL proxy/stub.</span><span class="sxs-lookup"><span data-stu-id="1422c-116">Decide how you want to provide marshaling support for your interface; either with type-library driven marshaling or with a proxy/stub DLL.</span></span> <span data-ttu-id="1422c-117">È necessario effettuare il marshalling anche delle interfacce in-process se devono essere usate tra i limiti dell'Apartment.</span><span class="sxs-lookup"><span data-stu-id="1422c-117">Even in-process interfaces must be marshaled if they are to be used across apartment boundaries.</span></span> <span data-ttu-id="1422c-118">È consigliabile creare il supporto del marshalling in ogni interfaccia COM, anche se non si ritiene che sia necessario.</span><span class="sxs-lookup"><span data-stu-id="1422c-118">It is a good idea to build marshaling support into every COM interface, even if you don't think you will need it.</span></span> <span data-ttu-id="1422c-119">Per ulteriori informazioni, vedere [marshalling di interfaccia](interface-marshaling.md) .</span><span class="sxs-lookup"><span data-stu-id="1422c-119">See [Interface Marshaling](interface-marshaling.md) for more information.</span></span>
-   <span data-ttu-id="1422c-120">Descrivere l'interfaccia o le interfacce in un file di definizione di interfaccia (IDL).</span><span class="sxs-lookup"><span data-stu-id="1422c-120">Describe the interface or interfaces in an interface definition (IDL) file.</span></span> <span data-ttu-id="1422c-121">Inoltre, è possibile specificare determinati aspetti locali dell'interfaccia in un file di configurazione dell'applicazione (ACF).</span><span class="sxs-lookup"><span data-stu-id="1422c-121">In addition, you can specify certain local aspects of your interface in an application configuration file (ACF).</span></span> <span data-ttu-id="1422c-122">Se si usa il marshalling guidato dalla libreria dei tipi, aggiungere un'istruzione [**Library**](/windows/desktop/Midl/library) che faccia riferimento alle interfacce per le quali si desidera generare informazioni sul tipo.</span><span class="sxs-lookup"><span data-stu-id="1422c-122">If you are using type-library driven marshaling, add a [**library**](/windows/desktop/Midl/library) statement that references the interfaces for which you want to generate type information.</span></span>
-   <span data-ttu-id="1422c-123">Usare il compilatore MIDL per generare un file della libreria dei tipi e un file di intestazione, file di proxy/stub del linguaggio C, un file di identificatore di interfaccia, un file di dati DLL e un file di intestazione.</span><span class="sxs-lookup"><span data-stu-id="1422c-123">Use the MIDL compiler to generate a type library file and header file, or C-language proxy/stub files, interface identifier file, DLL data file and header file.</span></span> <span data-ttu-id="1422c-124">Per ulteriori informazioni, vedere [compilazione MIDL](midl-compilation.md) .</span><span class="sxs-lookup"><span data-stu-id="1422c-124">See [MIDL Compilation](midl-compilation.md) for more information.</span></span>
-   <span data-ttu-id="1422c-125">A seconda del metodo di marshalling scelto, scrivere un file di definizione di modulo (DEF), compilare e collegare tutti i file generati da MIDL in una singola DLL proxy e registrare l'interfaccia nel registro di sistema oppure registrare la libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="1422c-125">Depending on the marshaling method you chose, write a module definition (DEF) file, compile and link all the MIDL-generated files into a single proxy DLL, and register the interface in the system registry, or register the type library.</span></span> <span data-ttu-id="1422c-126">Per ulteriori informazioni, vedere [caricamento e registrazione di una libreria dei tipi](loading-and-registering-a-type-library.md) e [compilazione e registrazione di una DLL proxy](building-and-registering-a-proxy-dll.md) .</span><span class="sxs-lookup"><span data-stu-id="1422c-126">See [Loading and Registering a Type Library](loading-and-registering-a-type-library.md) and [Building and Registering a Proxy DLL](building-and-registering-a-proxy-dll.md) for more information.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1422c-127">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1422c-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1422c-128">Anatomia di un file IDL</span><span class="sxs-lookup"><span data-stu-id="1422c-128">Anatomy of an IDL File</span></span>](anatomy-of-an-idl-file.md)
</dt> <dt>

[<span data-ttu-id="1422c-129">Client e server COM</span><span class="sxs-lookup"><span data-stu-id="1422c-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="1422c-130">Regole di progettazione dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="1422c-130">Interface Design Rules</span></span>](interface-design-rules.md)
</dt> <dt>

[<span data-ttu-id="1422c-131">Component Object Model (COM)</span><span class="sxs-lookup"><span data-stu-id="1422c-131">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 