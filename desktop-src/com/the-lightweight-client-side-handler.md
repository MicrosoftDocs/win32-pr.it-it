---
title: Gestore di Client-Side Lightweight
description: I gestori lato client leggeri consentono di creare gestori lato client generali di qualsiasi dimensione, per facilitare l'esecuzione di qualsiasi tipo di attività standard.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730538"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="23a6b-103">Gestore di Client-Side Lightweight</span><span class="sxs-lookup"><span data-stu-id="23a6b-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="23a6b-104">I gestori lato client leggeri consentono di creare gestori lato client generali di qualsiasi dimensione, per facilitare l'esecuzione di qualsiasi tipo di attività standard.</span><span class="sxs-lookup"><span data-stu-id="23a6b-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="23a6b-105">Poiché i gestori sono utilizzabili da più di un client.</span><span class="sxs-lookup"><span data-stu-id="23a6b-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="23a6b-106">Si differenziano dai gestori OLE in quanto non possono essere creati prima che il server venga avviato e la loro durata è legata a quella di gestione proxy, impedendo un possibile race condition in cui il gestore potrebbe altrimenti essere rilasciato prematuramente.</span><span class="sxs-lookup"><span data-stu-id="23a6b-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="23a6b-107">Gestione proxy è l'oggetto creato dal sistema che implementa l'interfaccia [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) .</span><span class="sxs-lookup"><span data-stu-id="23a6b-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="23a6b-108">Se si usa il marshalling standard, il sistema lo crea automaticamente quando si chiama [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (o [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex)per la creazione di un gestore di marshalling aggregato per i gestori Lightweight) e implementa anche le interfacce [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) e [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="23a6b-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="23a6b-109">Sul lato server è presente un oggetto di sistema corrispondente che implementa anche **IMarshal**.</span><span class="sxs-lookup"><span data-stu-id="23a6b-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="23a6b-110">Questi oggetti gestiscono il marshalling per l'utente in modo trasparente.</span><span class="sxs-lookup"><span data-stu-id="23a6b-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="23a6b-111">Esistono due tipi generali di questi gestori che è possibile implementare:</span><span class="sxs-lookup"><span data-stu-id="23a6b-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="23a6b-112">Gestore che esegue un servizio che non richiede dati aggiuntivi dal server</span><span class="sxs-lookup"><span data-stu-id="23a6b-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="23a6b-113">Gestore che utilizza dati aggiuntivi dal server</span><span class="sxs-lookup"><span data-stu-id="23a6b-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="23a6b-114">Di seguito sono riportati alcuni potenziali usi dei dati aggiuntivi nel flusso fornito dal server:</span><span class="sxs-lookup"><span data-stu-id="23a6b-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="23a6b-115">Dati statici dal server.</span><span class="sxs-lookup"><span data-stu-id="23a6b-115">Static data from server.</span></span> <span data-ttu-id="23a6b-116">Indipendentemente dall'interfaccia particolare sottoposta a marshalling, il server scrive gli stessi dati nel flusso.</span><span class="sxs-lookup"><span data-stu-id="23a6b-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="23a6b-117">Dati per interfaccia dal server.</span><span class="sxs-lookup"><span data-stu-id="23a6b-117">Per-interface data from server.</span></span> <span data-ttu-id="23a6b-118">A seconda di quale interfaccia particolare viene sottoposta a marshalling, il server può scrivere dati diversi nel flusso.</span><span class="sxs-lookup"><span data-stu-id="23a6b-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="23a6b-119">Helper per interfaccia.</span><span class="sxs-lookup"><span data-stu-id="23a6b-119">Per-interface helpers.</span></span> <span data-ttu-id="23a6b-120">Componenti COM per interfaccia aggregati nel gestore client e delega al proxy standard.</span><span class="sxs-lookup"><span data-stu-id="23a6b-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="23a6b-121">Per migliorare le prestazioni di rete, ad esempio, un componente COM per [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) può eseguire la memorizzazione nella cache lato client dei dati, il read-ahead, il write-behind, il blocco di operazioni e così via.</span><span class="sxs-lookup"><span data-stu-id="23a6b-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="23a6b-122">Versione di rete di un'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="23a6b-122">Network version of an interface.</span></span> <span data-ttu-id="23a6b-123">La versione di rete dell'interfaccia è diversa dall'interfaccia esposta dal codice dell'applicazione client e server.</span><span class="sxs-lookup"><span data-stu-id="23a6b-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="23a6b-124">È possibile, ad esempio, che le interfacce esposte dal multiplex IA e IB si trovino sulla stessa interfaccia di rete INetAB, il modo in cui il gestore del server di incorporamento.</span><span class="sxs-lookup"><span data-stu-id="23a6b-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="23a6b-125">Ad esempio, è possibile convertire un'interfaccia di trasferimento dati in un'interfaccia di rete che utilizza pipe per un efficace trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="23a6b-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="23a6b-126">I client legacy potrebbero non essere in grado di eseguire l'unmarshalling di interfacce con gestori personalizzati, per due motivi: prima potrebbero non comprendere il CLSID utilizzato nel pacchetto con marshalling personalizzato quando il gestore del server viene aggregato e l'oggetto richiede un gestore.</span><span class="sxs-lookup"><span data-stu-id="23a6b-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="23a6b-127">In secondo luogo, il codice del gestore potrebbe non essere eseguito anche sul lato client se è necessaria una nuova funzionalità di COM per creare il gestore di marshalling standard aggregato ed eseguire chiamate [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) remote.</span><span class="sxs-lookup"><span data-stu-id="23a6b-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="23a6b-128">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="23a6b-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="23a6b-129">Gestore OLE</span><span class="sxs-lookup"><span data-stu-id="23a6b-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 