---
title: Notifica dati
description: Gli oggetti che utilizzano dati provenienti da un'origine esterna talvolta devono essere informati quando vengono modificati i dati di tale origine.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "106300513"
---
# <a name="data-notification"></a><span data-ttu-id="5243d-103">Notifica dati</span><span class="sxs-lookup"><span data-stu-id="5243d-103">Data Notification</span></span>

<span data-ttu-id="5243d-104">Gli oggetti che utilizzano dati provenienti da un'origine esterna talvolta devono essere informati quando vengono modificati i dati di tale origine.</span><span class="sxs-lookup"><span data-stu-id="5243d-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="5243d-105">Ad esempio, un visualizzatore di nastri delle scorte che si basa sui dati in un foglio di calcolo deve ricevere una notifica quando i dati vengono modificati in modo che sia possibile aggiornarne la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="5243d-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="5243d-106">Analogamente, un documento composto necessita di informazioni sulle modifiche ai dati negli oggetti incorporati, in modo che possa aggiornare le cache dei dati.</span><span class="sxs-lookup"><span data-stu-id="5243d-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="5243d-107">In casi come questo, in cui è auspicabile l'aggiornamento dinamico dei dati, le origini dei dati richiedono un meccanismo di notifica ai consumer di modifiche apportate senza obbligare gli utenti a eliminare tutto per aggiornare i dati.</span><span class="sxs-lookup"><span data-stu-id="5243d-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="5243d-108">Idealmente, dopo aver ricevuto una notifica che si è verificata una modifica nell'origine dati, un oggetto consumer può richiedere una copia aggiornata a piacimento.</span><span class="sxs-lookup"><span data-stu-id="5243d-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="5243d-109">Il meccanismo COM per la gestione delle notifiche asincrone di questo tipo è un oggetto denominato sink di notifica, che è semplicemente un oggetto COM che implementa un'interfaccia denominata [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span><span class="sxs-lookup"><span data-stu-id="5243d-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="5243d-110">I consumer di dati implementano **IAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="5243d-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="5243d-111">Si registrano per ricevere le notifiche inviando un puntatore all'oggetto dati di interesse.</span><span class="sxs-lookup"><span data-stu-id="5243d-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="5243d-112">Le interfacce [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) espone i metodi seguenti per la ricezione di notifiche asincrone:</span><span class="sxs-lookup"><span data-stu-id="5243d-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="5243d-113">Metodo</span><span class="sxs-lookup"><span data-stu-id="5243d-113">Method</span></span>                                                      | <span data-ttu-id="5243d-114">Notifica al sink advise che</span><span class="sxs-lookup"><span data-stu-id="5243d-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="5243d-115">**OnDataChange**</span><span class="sxs-lookup"><span data-stu-id="5243d-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="5243d-116">I dati dell'oggetto chiamante sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="5243d-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="5243d-117">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="5243d-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="5243d-118">Le istruzioni per il disegno dell'oggetto chiamante sono state modificate.</span><span class="sxs-lookup"><span data-stu-id="5243d-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="5243d-119">**OnRename**</span><span class="sxs-lookup"><span data-stu-id="5243d-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="5243d-120">Il moniker dell'oggetto chiamante è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="5243d-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="5243d-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="5243d-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="5243d-122">L'oggetto chiamante è stato salvato nell'archivio permanente.</span><span class="sxs-lookup"><span data-stu-id="5243d-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="5243d-123">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="5243d-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="5243d-124">L'oggetto chiamante è stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="5243d-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="5243d-125">Come indicato nella tabella, l'interfaccia [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) espone metodi per notificare al sink advise gli eventi diversi dalle modifiche nei dati dell'oggetto chiamante.</span><span class="sxs-lookup"><span data-stu-id="5243d-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="5243d-126">L'oggetto chiamante può anche inviare una notifica al sink quando il modo in cui disegna le modifiche o viene rinominato, salvato o chiuso.</span><span class="sxs-lookup"><span data-stu-id="5243d-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="5243d-127">Queste altre notifiche vengono utilizzate principalmente o interamente nel contesto dei documenti composti, anche se il meccanismo di notifica è identico.</span><span class="sxs-lookup"><span data-stu-id="5243d-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="5243d-128">Per ulteriori informazioni sulle notifiche dei documenti composti, vedere "documenti composti".</span><span class="sxs-lookup"><span data-stu-id="5243d-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="5243d-129">Per sfruttare i vantaggi del sink di notifica, un'origine dati deve implementare [**IDataObject::D advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D Unadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)e [**IDataObject:: EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span><span class="sxs-lookup"><span data-stu-id="5243d-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="5243d-130">Un consumer di dati chiama il Mothod **DAdvise** per notificare a un oggetto dati che desidera ricevere una notifica quando i dati dell'oggetto cambiano.</span><span class="sxs-lookup"><span data-stu-id="5243d-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="5243d-131">L'oggetto consumer chiama il metodo **DUnadvise** per eliminare questa connessione.</span><span class="sxs-lookup"><span data-stu-id="5243d-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="5243d-132">Qualsiasi parte interessata può chiamare il metodo **EnumDAdvise** per apprendere il numero di oggetti che dispongono di una connessione consultiva a un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="5243d-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="5243d-133">Quando i dati vengono modificati nell'origine, l'oggetto dati chiama [**IAdviseSink:: OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) su tutti i consumer di dati che hanno effettuato la registrazione per la ricezione delle notifiche.</span><span class="sxs-lookup"><span data-stu-id="5243d-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="5243d-134">Per tenere traccia delle connessioni consultive e gestire l'invio di notifiche, le origini dati si basano su un oggetto denominato *titolare dell'avviso dati*.</span><span class="sxs-lookup"><span data-stu-id="5243d-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="5243d-135">È possibile creare il proprio titolare di consulenza dati implementando l'interfaccia [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) .</span><span class="sxs-lookup"><span data-stu-id="5243d-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="5243d-136">In alternativa, è possibile consentire a COM di eseguire questa operazione chiamando la funzione di supporto [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span><span class="sxs-lookup"><span data-stu-id="5243d-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5243d-137">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="5243d-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5243d-138">Trasferimento dati</span><span class="sxs-lookup"><span data-stu-id="5243d-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

