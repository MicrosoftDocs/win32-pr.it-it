---
title: Interfacce di Trasferimento dati
description: Interfacce di Trasferimento dati
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "106300512"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="4745b-103">Interfacce di Trasferimento dati</span><span class="sxs-lookup"><span data-stu-id="4745b-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="4745b-104">L'interfaccia [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fornisce ai consumer dei dati i metodi per ottenere e impostare i dati di un oggetto, determinare quali formati sono supportati dall'oggetto e registrarsi per ricevere notifiche quando vengono modificati i dati nell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="4745b-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="4745b-105">Quando si ottengono dati, un chiamante può specificare il formato in cui desidera eseguire il rendering dei dati.</span><span class="sxs-lookup"><span data-stu-id="4745b-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="4745b-106">L'origine dei dati, tuttavia, determina il supporto di archiviazione, restituito in un parametro out fornito dal chiamante.</span><span class="sxs-lookup"><span data-stu-id="4745b-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="4745b-107">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fornisce tutti gli strumenti necessari per implementare i trasferimenti degli Appunti di Windows o i trasferimenti di documenti compositi nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4745b-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="4745b-108">Se si vuole anche supportare i trasferimenti di trascinamento della selezione, è necessario implementare le interfacce [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) e [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) insieme a **IDataObject**.</span><span class="sxs-lookup"><span data-stu-id="4745b-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="4745b-109">L'interfaccia [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) combinata con le API degli Appunti OLE fornisce tutte le funzionalità delle API degli Appunti di Windows.</span><span class="sxs-lookup"><span data-stu-id="4745b-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="4745b-110">Non è in genere necessario usare entrambe le API degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="4745b-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="4745b-111">I fornitori di dati che supportano i trasferimenti con trascinamento della selezione o i documenti composti OLE devono implementare l'interfaccia **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="4745b-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="4745b-112">Se l'applicazione supporta ora solo i trasferimenti degli Appunti, ma si desidera aggiungere documenti di trascinamento o composti nelle versioni successive, è possibile implementare **IDataObject** e le API degli Appunti OLE per ridurre al minimo la quantità di tempo impiegato per la ricodifica e il debug in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="4745b-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="4745b-113">È anche possibile implementare **IDataObject** per poter utilizzare supporti di trasferimento diversi dalla memoria globale.</span><span class="sxs-lookup"><span data-stu-id="4745b-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="4745b-114">Nella tabella seguente vengono riepilogate le opzioni da utilizzare, a seconda dei tipi di trasferimento dei dati che si desidera supportare:</span><span class="sxs-lookup"><span data-stu-id="4745b-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="4745b-115">Per supportare</span><span class="sxs-lookup"><span data-stu-id="4745b-115">To support</span></span>                                                                       | <span data-ttu-id="4745b-116">Uso</span><span class="sxs-lookup"><span data-stu-id="4745b-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4745b-117">Documenti composti</span><span class="sxs-lookup"><span data-stu-id="4745b-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="4745b-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="4745b-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="4745b-119">Trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="4745b-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="4745b-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (o equivalente)</span><span class="sxs-lookup"><span data-stu-id="4745b-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="4745b-121">Trasferimenti degli Appunti utilizzando esclusivamente la memoria globale</span><span class="sxs-lookup"><span data-stu-id="4745b-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="4745b-122">API Appunti</span><span class="sxs-lookup"><span data-stu-id="4745b-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="4745b-123">Trasferimenti degli Appunti con supporti di Exchange diversi dalla memoria globale.</span><span class="sxs-lookup"><span data-stu-id="4745b-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="4745b-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="4745b-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="4745b-125">Il trasferimento degli Appunti è ora, ma è possibile trascinare e rilasciare documenti compositi</span><span class="sxs-lookup"><span data-stu-id="4745b-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="4745b-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e le interfacce e la funzione elencate in precedenza per i trasferimenti di trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="4745b-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="4745b-127">Quando un utente avvia un'operazione di trasferimento dei dati, l'applicazione di origine crea un'istanza di [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e tramite essa rende disponibili i dati in uno o più formati.</span><span class="sxs-lookup"><span data-stu-id="4745b-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="4745b-128">In un trasferimento degli Appunti, l'applicazione chiama la funzione [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) per passare un puntatore a un oggetto dati a OLE.</span><span class="sxs-lookup"><span data-stu-id="4745b-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="4745b-129">(**OleSetClipboard** offre anche formati di dati degli Appunti standard per le applicazioni OLE versione 1 e non OLE). In un trasferimento con trascinamento della selezione, l'applicazione chiama invece la funzione [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) .</span><span class="sxs-lookup"><span data-stu-id="4745b-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="4745b-130">Sul lato ricevente del trasferimento, la destinazione riceve il puntatore [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) come argomento di una chiamata di [**IDropTarget::D por**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) o chiamando la funzione [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , a seconda che il trasferimento sia mediante trascinamento della selezione o degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="4745b-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="4745b-131">Se si ottiene questo puntatore, la destinazione chiama [**IDataObject:: EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) per informazioni sui formati disponibili per il recupero e sui tipi di supporti che è possibile ottenere.</span><span class="sxs-lookup"><span data-stu-id="4745b-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="4745b-132">Con queste informazioni, l'applicazione ricevente richiede i dati con una chiamata a [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span><span class="sxs-lookup"><span data-stu-id="4745b-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4745b-133">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="4745b-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4745b-134">Trasferimento dati</span><span class="sxs-lookup"><span data-stu-id="4745b-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

