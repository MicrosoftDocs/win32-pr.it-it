---
title: Panoramica delle linee guida per il controllo e il controllo del contenitore
description: Panoramica delle linee guida per il controllo e il controllo del contenitore
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/29/2020
ms.locfileid: "103720047"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="2a08d-103">Panoramica delle linee guida per il controllo e il controllo del contenitore</span><span class="sxs-lookup"><span data-stu-id="2a08d-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="2a08d-104">Un controllo ActiveX è essenzialmente un semplice oggetto OLE che supporta l'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="2a08d-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="2a08d-105">In genere supporta più interfacce per offrire funzionalità, ma tutte le interfacce aggiuntive possono essere visualizzate come facoltative e, di conseguenza, un contenitore di controlli non deve basarsi su interfacce aggiuntive supportate.</span><span class="sxs-lookup"><span data-stu-id="2a08d-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="2a08d-106">Se non si specificano interfacce aggiuntive che un controllo deve supportare, un controllo può essere utilizzato in modo efficiente per una particolare area di funzionalità senza dover supportare interfacce specifiche per qualificarsi come controllo.</span><span class="sxs-lookup"><span data-stu-id="2a08d-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="2a08d-107">Come sempre con OLE, sia che si tratti di un controllo o di un contenitore di controlli, non si deve mai presupporre che un'interfaccia sia disponibile e che le convenzioni standard di controllo restituito debbano sempre essere seguite.</span><span class="sxs-lookup"><span data-stu-id="2a08d-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="2a08d-108">È importante che un contenitore di controlli o controlli si riduca normalmente e offra funzionalità alternative se non è disponibile un'interfaccia richiesta.</span><span class="sxs-lookup"><span data-stu-id="2a08d-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="2a08d-109">Un contenitore di controlli ActiveX deve essere in grado di ospitare un controllo ActiveX minimo; supporta inoltre una serie di interfacce aggiuntive, come specificato nei [contenitori](containers.md).</span><span class="sxs-lookup"><span data-stu-id="2a08d-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="2a08d-110">Sono disponibili diverse interfacce e metodi che possono essere facoltativamente supportati da un contenitore, raggruppati in aree funzionali note come categorie di *componenti*.</span><span class="sxs-lookup"><span data-stu-id="2a08d-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="2a08d-111">Un contenitore può supportare qualsiasi combinazione di categorie di componenti, ad esempio, esiste una categoria di componenti per l'associazione dati e un contenitore può supportare o meno la funzionalità di associazione dati, a seconda delle esigenze di mercato del contenitore.</span><span class="sxs-lookup"><span data-stu-id="2a08d-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="2a08d-112">Se per il funzionamento di un controllo è necessario il supporto dell'associazione dati da un contenitore, questo requisito verrà inserito nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="2a08d-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="2a08d-113">Questo consente a un contenitore di controlli di offrire solo per l'inserimento dei controlli che sa che può ospitare correttamente.</span><span class="sxs-lookup"><span data-stu-id="2a08d-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="2a08d-114">È importante notare che le categorie di componenti vengono specificate come parte di OLE e non sono specifiche dei controlli ActiveX, l'architettura dei controlli utilizza le categorie di componenti per identificare le aree di funzionalità che possono essere supportate da un componente OLE.</span><span class="sxs-lookup"><span data-stu-id="2a08d-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="2a08d-115">Le categorie di componenti non sono cumulative o esclusive, pertanto un contenitore di controlli può supportare una categoria senza necessariamente supportare un'altra categoria.</span><span class="sxs-lookup"><span data-stu-id="2a08d-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="2a08d-116">È importante per i controlli che richiedono funzionalità facoltative o funzionalità specifiche di un determinato contenitore per essere chiaramente impacchettate e commercializzate con tali requisiti.</span><span class="sxs-lookup"><span data-stu-id="2a08d-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="2a08d-117">Analogamente, i contenitori che offrono determinate funzionalità o categorie di componenti devono essere commercializzati e assemblati in modo da offrire i livelli di supporto per l'hosting di controlli ActiveX.</span><span class="sxs-lookup"><span data-stu-id="2a08d-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="2a08d-118">Si consiglia di controllare la destinazione e il test con il maggior numero di contenitori possibile e degradare normalmente per offrire funzionalità meno o alternative se le interfacce o i metodi non sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="2a08d-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="2a08d-119">In una situazione in cui un controllo non è in grado di eseguire la funzione di processo designata senza il supporto di una categoria di componenti, tale categoria deve essere immessa come requisito nel registro di sistema per impedire l'inserimento del controllo in un contenitore non appropriato.</span><span class="sxs-lookup"><span data-stu-id="2a08d-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="2a08d-120">Queste linee guida definiscono le interfacce e i metodi che un controllo può prevedere di supportare da un contenitore di controllo, anche se sempre un controllo deve controllare i valori restituiti quando si usa [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) o altri metodi per ottenere i puntatori a tali interfacce.</span><span class="sxs-lookup"><span data-stu-id="2a08d-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="2a08d-121">Un contenitore non dovrebbe prevedere che un controllo supporti più di quanto l'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) e queste linee guida identificano le interfacce che un controllo può supportare e il significato della presenza di una particolare interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2a08d-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="2a08d-122">Motivi per cui le linee guida per il controllo ActiveX e il controllo del contenitore sono importanti</span><span class="sxs-lookup"><span data-stu-id="2a08d-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="2a08d-123">I controlli ActiveX sono diventati l'architettura principale per lo sviluppo di componenti software programmabili da usare in diversi contenitori, da strumenti di sviluppo software agli strumenti per la produttività degli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="2a08d-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="2a08d-124">Affinché un controllo funzioni correttamente in un'ampia gamma di contenitori, il controllo deve essere in grado di assumere un livello minimo di funzionalità su cui può basarsi in tutti i contenitori.</span><span class="sxs-lookup"><span data-stu-id="2a08d-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="2a08d-125">Seguendo queste linee guida, gli sviluppatori di controlli e contenitori rendono i controlli e i contenitori più affidabili e interoperativi e, infine, componenti migliori e più utilizzabili per la creazione di soluzioni basate su componenti.</span><span class="sxs-lookup"><span data-stu-id="2a08d-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="2a08d-126">Cosa fare quando un'interfaccia necessaria non è disponibile</span><span class="sxs-lookup"><span data-stu-id="2a08d-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="2a08d-127">I programmi OLE devono usare [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) per acquisire i puntatori di interfaccia ed è necessario controllare il valore restituito.</span><span class="sxs-lookup"><span data-stu-id="2a08d-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="2a08d-128">Le applicazioni OLE non possono presupporre in modo sicuro che **QueryInterface** avrà esito positivo.</span><span class="sxs-lookup"><span data-stu-id="2a08d-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="2a08d-129">Questo requisito si applica a tutte le applicazioni OLE.</span><span class="sxs-lookup"><span data-stu-id="2a08d-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="2a08d-130">Se l'interfaccia richiesta non è disponibile (ovvero, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) restituisce E \_ nointerface), il controllo o il contenitore deve peggiorare normalmente, anche se ciò significa che non è in grado di eseguire la funzione di processo designata.</span><span class="sxs-lookup"><span data-stu-id="2a08d-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2a08d-131">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="2a08d-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2a08d-132">Linee guida per il controllo ActiveX e il controllo del contenitore</span><span class="sxs-lookup"><span data-stu-id="2a08d-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




