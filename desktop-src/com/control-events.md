---
title: Eventi di controllo (COM)
description: Oltre a fornire proprietà e metodi, un controllo fornisce anche interfacce in uscita per notificare al client gli eventi.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1833e1396847e09366d1e06193196cfcf981d330
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "104047715"
---
# <a name="control-events-com"></a><span data-ttu-id="25944-103">Eventi di controllo (COM)</span><span class="sxs-lookup"><span data-stu-id="25944-103">Control Events (COM)</span></span>

<span data-ttu-id="25944-104">Oltre a fornire proprietà e metodi, un controllo fornisce anche interfacce in uscita per notificare al client gli eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-104">In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events.</span></span> <span data-ttu-id="25944-105">Il client deve supportare la gestione di questi eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-105">The client must support handling of these events.</span></span> <span data-ttu-id="25944-106">Per ulteriori informazioni sul funzionamento degli oggetti collegabili, vedere [eventi in com e oggetti collegabili](events-in-com-and-connectable-objects.md) .</span><span class="sxs-lookup"><span data-stu-id="25944-106">See [Events in COM and Connectable Objects](events-in-com-and-connectable-objects.md) for more information on how connectable objects work.</span></span>

<span data-ttu-id="25944-107">Un controllo può supportare diverse interfacce in uscita per scopi diversi.</span><span class="sxs-lookup"><span data-stu-id="25944-107">A control can support different outgoing interfaces for different purposes.</span></span> <span data-ttu-id="25944-108">Tutte le interfacce in uscita sono contrassegnate come interfacce di origine nelle informazioni sul tipo del controllo, ma solo una è contrassegnata come predefinita per indicare che si tratta dell'interfaccia in uscita primaria.</span><span class="sxs-lookup"><span data-stu-id="25944-108">All outgoing interfaces are marked as source interfaces in the control's type information, but only one is marked default to indicate that it is the primary outgoing interface.</span></span>

<span data-ttu-id="25944-109">Un contenitore può supportare una o più interfacce in uscita definite da un controllo.</span><span class="sxs-lookup"><span data-stu-id="25944-109">A container can support one or more of the outgoing interfaces defined by a control.</span></span> <span data-ttu-id="25944-110">Il controllo deve essere preparato per gestire i contenitori che forniscono solo il supporto per alcune delle interfacce in uscita.</span><span class="sxs-lookup"><span data-stu-id="25944-110">The control should be prepared to deal with containers that only provide support for some of their outgoing interfaces.</span></span>

<span data-ttu-id="25944-111">I controlli supportano quattro tipi di eventi:</span><span class="sxs-lookup"><span data-stu-id="25944-111">Controls support four kinds of events:</span></span>

-   <span data-ttu-id="25944-112">Eventi della richiesta.</span><span class="sxs-lookup"><span data-stu-id="25944-112">Request events.</span></span> <span data-ttu-id="25944-113">Un controllo richiede l'autorizzazione da parte del client per eseguire un'operazione chiamando un metodo nell'interfaccia in uscita, attivando in tal modo un evento di richiesta.</span><span class="sxs-lookup"><span data-stu-id="25944-113">A control requests permission from its client to do something by calling a method in the outgoing interface, thus triggering a request event.</span></span> <span data-ttu-id="25944-114">Il client segnala il controllo tramite un valore booleano out-parameter nel metodo chiamato dal controllo.</span><span class="sxs-lookup"><span data-stu-id="25944-114">The client signals the control through a boolean, out-parameter in the method that the control called.</span></span> <span data-ttu-id="25944-115">Il client può quindi impedire che il controllo esegua l'azione.</span><span class="sxs-lookup"><span data-stu-id="25944-115">The client can thus prevent the control from performing the action.</span></span>
-   <span data-ttu-id="25944-116">Prima degli eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-116">Before events.</span></span> <span data-ttu-id="25944-117">Un controllo Invia una notifica al cappello client per eseguire un'operazione chiamando un metodo nell'interfaccia in uscita, attivando così un evento Before.</span><span class="sxs-lookup"><span data-stu-id="25944-117">A control notifies its client hat it is going to do something by calling a method in the outgoing interface, thus triggering a before event.</span></span> <span data-ttu-id="25944-118">Il client non ha la possibilità di impedire l'azione, ma può eseguire tutti i passaggi necessari in base all'azione che sta per verificarsi.</span><span class="sxs-lookup"><span data-stu-id="25944-118">The client does not have the opportunity to prevent the action, but it can take any necessary steps given the action that is about to occur.</span></span>
-   <span data-ttu-id="25944-119">Dopo gli eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-119">After events.</span></span> <span data-ttu-id="25944-120">Un controllo Invia una notifica al client che ha appena fatto qualcosa chiamando un metodo nell'interfaccia in uscita, attivando quindi un evento After.</span><span class="sxs-lookup"><span data-stu-id="25944-120">A control notifies its client that it has just done something by calling a method in the outgoing interface, thus triggering an after event.</span></span> <span data-ttu-id="25944-121">Anche in questo caso, il client non è in grado di annullare questa azione, ma è possibile eseguire le operazioni necessarie in base all'azione eseguita.</span><span class="sxs-lookup"><span data-stu-id="25944-121">Again, the client cannot cancel this action, but it can take necessary steps given the action that has occurred.</span></span>
-   <span data-ttu-id="25944-122">Eseguire eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-122">Do events.</span></span> <span data-ttu-id="25944-123">Un controllo attiva un evento do per consentire al client di eseguire l'override dell'azione del controllo e fornire alcune azioni alternative o supplementari.</span><span class="sxs-lookup"><span data-stu-id="25944-123">A control triggers a do event to allow its client to override the control's action and provide some alternative or supplementary actions.</span></span> <span data-ttu-id="25944-124">In genere, il metodo che un controllo chiama per un evento do presenta diversi parametri per negoziare con il client sulle azioni che si verificheranno.</span><span class="sxs-lookup"><span data-stu-id="25944-124">Usually, the method that a control calls for a do event has a number of parameters for negotiating with the client about the actions that will occur.</span></span>

<span data-ttu-id="25944-125">I DISPID seguenti sono definiti per gli eventi standard che i controlli possono supportare: click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp ed Error.</span><span class="sxs-lookup"><span data-stu-id="25944-125">The following dispids are defined for standard events that controls can support: Click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp, and Error.</span></span> <span data-ttu-id="25944-126">Tutti questi eventi standard hanno valori DISPID negativi, che ne indicano lo stato standard.</span><span class="sxs-lookup"><span data-stu-id="25944-126">All of these standard events have negative DISPID values, indicating their standard status.</span></span>

<span data-ttu-id="25944-127">Il metodo [**IOleControl:: FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) , quando viene chiamato con **true**, indica a un controllo se il contenitore infastidisce la gestione degli eventi dal controllo fino a quando **FreezeEvents** viene chiamato nuovamente con **false**.</span><span class="sxs-lookup"><span data-stu-id="25944-127">The [**IOleControl::FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) method, when called with **TRUE**, tells a control whether the container will bother handling events from the control until **FreezeEvents** is again called with **FALSE**.</span></span> <span data-ttu-id="25944-128">Durante questo periodo di tempo, il controllo non può dipendere dal contenitore che gestisce effettivamente gli eventi.</span><span class="sxs-lookup"><span data-stu-id="25944-128">During this time control cannot depend on the container actually handling any events.</span></span> <span data-ttu-id="25944-129">Se è necessario gestire un evento, il controllo deve accodare l'evento per attivarlo quando **FreezeEvents** viene chiamato con **false**.</span><span class="sxs-lookup"><span data-stu-id="25944-129">If an event must be handled, the control should queue the event in order to fire it when **FreezeEvents** is called with **FALSE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="25944-130">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="25944-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="25944-131">Controlli ActiveX</span><span class="sxs-lookup"><span data-stu-id="25944-131">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




