---
title: Persistenza
description: Persistenza
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6cffab1c9a0f2746e57e356a90698caf9903deb
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/27/2021
ms.locfileid: "110549286"
---
# <a name="persistence"></a><span data-ttu-id="988fa-103">Persistenza</span><span class="sxs-lookup"><span data-stu-id="988fa-103">Persistence</span></span>

<span data-ttu-id="988fa-104">Un controllo implementa una o più interfacce di persistenza per supportare la persistenza del relativo stato.</span><span class="sxs-lookup"><span data-stu-id="988fa-104">A control implements one or more of several persistence interfaces to support persistence of its state.</span></span> <span data-ttu-id="988fa-105">Ad esempio, [**l'interfaccia IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) supporta la persistenza basata sul flusso dello stato del controllo.</span><span class="sxs-lookup"><span data-stu-id="988fa-105">For example, the [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) interface supports stream-based persistence of the control's state.</span></span> <span data-ttu-id="988fa-106">**IPersistStreamInit è** una sostituzione di [**IPersistStream e**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) aggiunge un metodo di inizializzazione, [**InitNew.**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew)</span><span class="sxs-lookup"><span data-stu-id="988fa-106">**IPersistStreamInit** is a replacement for [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) and adds an initialization method, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span></span> <span data-ttu-id="988fa-107">Gli altri metodi sono gli stessi in entrambe le interfacce.</span><span class="sxs-lookup"><span data-stu-id="988fa-107">The other methods are the same in both interfaces.</span></span> <span data-ttu-id="988fa-108">**IPersistStreamInit** non è derivato da **IPersistStream;** Un oggetto supporta solo una delle due interfacce a seconda che richieda la possibilità di inizializzare nuove istanze di se stesso.</span><span class="sxs-lookup"><span data-stu-id="988fa-108">**IPersistStreamInit** is not derived from **IPersistStream**; an object supports only one of the two interfaces based on whether it requires the ability to initialize new instances of itself.</span></span>

<span data-ttu-id="988fa-109">Altre interfacce di persistenza che un controllo può offrire includono: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="988fa-109">Other persistence interfaces that a control can offer include: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span></span> <span data-ttu-id="988fa-110">L'implementatore del controllo deve decidere quali tipi di persistenza sono più importanti e implementare le interfacce di persistenza appropriate.</span><span class="sxs-lookup"><span data-stu-id="988fa-110">The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces.</span></span> <span data-ttu-id="988fa-111">L'implementatore del controllo decide anche cosa salvare.</span><span class="sxs-lookup"><span data-stu-id="988fa-111">The control implementer also decides what to save.</span></span> <span data-ttu-id="988fa-112">Ad esempio, un controllo può salvare i valori correnti delle relative proprietà o la posizione e le dimensioni all'interno del contenitore.</span><span class="sxs-lookup"><span data-stu-id="988fa-112">For example, a control can save the current values of its properties or its location and size within its container.</span></span> <span data-ttu-id="988fa-113">Il client decide quale interfaccia preferisce usare.</span><span class="sxs-lookup"><span data-stu-id="988fa-113">The client decides which interface it prefers to use.</span></span>

<span data-ttu-id="988fa-114">Prima di caricare un controllo dallo stato persistente, un client può controllare il flag OLEMISC SETCLIENTSITEFIRST per determinare se il controllo supporta il recupero del sito client e delle proprietà di ambiente prima di caricarne lo stato \_ persistente.</span><span class="sxs-lookup"><span data-stu-id="988fa-114">Before loading a control from its persistent state, a client can check the OLEMISC\_SETCLIENTSITEFIRST flag to determine if the control supports getting its client site and ambient properties before loading its persistent state.</span></span> <span data-ttu-id="988fa-115">Questa ottimizzazione consente di risparmiare tempo quando si crea un'istanza di un controllo poiché il controllo è libero di ignorare i valori persistenti anziché caricarli solo per fare in modo che vengano sottoposti a override dalle proprietà di ambiente fornite dal client.</span><span class="sxs-lookup"><span data-stu-id="988fa-115">This optimization can save time when instantiating a control since the control is then free to ignore its persistent values rather than loading them only to have them overridden by ambient properties supplied by the client.</span></span>

<span data-ttu-id="988fa-116">Un controllo può inoltre supportare il salvataggio e il ripristino del relativo stato in un set di proprietà OLE, un set di identificatori e valori in un formato specificato.</span><span class="sxs-lookup"><span data-stu-id="988fa-116">A control can also support saving and restoring its state in an OLE property set, a set of identifiers and values in a specified format.</span></span> <span data-ttu-id="988fa-117">Questa funzionalità può essere utile con contenitori come Visual Basic, che salva i programmi in un formato testuale.</span><span class="sxs-lookup"><span data-stu-id="988fa-117">This feature can be useful with containers such as Visual Basic, which saves its programs in a textual form.</span></span> <span data-ttu-id="988fa-118">Un controllo che vuole supportare questa funzionalità implementa [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) e [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) per passare rispettivamente i valori delle proprietà a e dal contenitore.</span><span class="sxs-lookup"><span data-stu-id="988fa-118">A control that wants to support this feature implements [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) and [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) to pass its property values to and from the container, respectively.</span></span> <span data-ttu-id="988fa-119">È compito del contenitore convertire queste informazioni in testo e salvarle.</span><span class="sxs-lookup"><span data-stu-id="988fa-119">It is the container's job to convert this information to text and save it.</span></span> <span data-ttu-id="988fa-120">Gli identificatori utilizzati dal controllo corrispondono ai nomi delle proprietà del controllo e ai valori.</span><span class="sxs-lookup"><span data-stu-id="988fa-120">The identifiers used by the control correspond to the control's property names and the values.</span></span> <span data-ttu-id="988fa-121">Per la definizione di questo set di proprietà, vedere OLE CDK.</span><span class="sxs-lookup"><span data-stu-id="988fa-121">See the OLE CDK for the definition of this property set.</span></span>

## <a name="related-topics"></a><span data-ttu-id="988fa-122">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="988fa-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="988fa-123">Controlli ActiveX</span><span class="sxs-lookup"><span data-stu-id="988fa-123">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 