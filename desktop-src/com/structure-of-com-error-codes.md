---
title: Struttura dei codici di errore COM
description: Struttura dei codici di errore COM
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb27143f50028592f6fe0aeb5cab9795dcd10d4a
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/03/2021
ms.locfileid: "104558632"
---
# <a name="structure-of-com-error-codes"></a><span data-ttu-id="7152d-103">Struttura dei codici di errore COM</span><span class="sxs-lookup"><span data-stu-id="7152d-103">Structure of COM Error Codes</span></span>

<span data-ttu-id="7152d-104">Nella figura seguente viene illustrato il formato di un valore [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (o SCODE); i numeri indicano le posizioni dei bit:</span><span class="sxs-lookup"><span data-stu-id="7152d-104">The following illustration shows the format of an [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (or SCODE); the numbers indicate bit positions:</span></span>

![Mostra il formato di "risultato H" o "codice" con i numeri che indicano le posizioni dei bit.](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

<span data-ttu-id="7152d-106">Il bit più significativo in **HRESULT** o SCODE indica se il valore restituito rappresenta l'esito positivo o negativo.</span><span class="sxs-lookup"><span data-stu-id="7152d-106">The high-order bit in the **HRESULT** or SCODE indicates whether the return value represents success or failure.</span></span> <span data-ttu-id="7152d-107">Se impostato su 0, la gravità ha \_ esito positivo, il valore indica l'esito positivo.</span><span class="sxs-lookup"><span data-stu-id="7152d-107">If set to 0, SEVERITY\_SUCCESS, the value indicates success.</span></span> <span data-ttu-id="7152d-108">Se impostato su 1, errore di gravità indica un errore \_ .</span><span class="sxs-lookup"><span data-stu-id="7152d-108">If set to 1, SEVERITY\_ERROR, it indicates failure.</span></span>

<span data-ttu-id="7152d-109">I bit R, C, N e r sono riservati.</span><span class="sxs-lookup"><span data-stu-id="7152d-109">The R, C, N, and r bits are reserved.</span></span>

<span data-ttu-id="7152d-110">Il campo della struttura indica il servizio di sistema responsabile dell'errore.</span><span class="sxs-lookup"><span data-stu-id="7152d-110">The facility field indicates the system service responsible for the error.</span></span> <span data-ttu-id="7152d-111">Microsoft alloca nuovi codici di struttura quando diventano necessari.</span><span class="sxs-lookup"><span data-stu-id="7152d-111">Microsoft allocates new facility codes as they become necessary.</span></span> <span data-ttu-id="7152d-112">La maggior parte dei valori SCODE e **HRESULT** imposta il campo della struttura su struttura \_ ITF, che indica un errore del metodo di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="7152d-112">Most SCODEs and **HRESULT** values set the facility field to FACILITY\_ITF, indicating an interface method error.</span></span>

<span data-ttu-id="7152d-113">I campi della funzionalità comuni sono descritti nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="7152d-113">Common facility fields are described in the following table.</span></span>



| <span data-ttu-id="7152d-114">Campo della struttura</span><span class="sxs-lookup"><span data-stu-id="7152d-114">Facility Field</span></span>                | <span data-ttu-id="7152d-115">Valore</span><span class="sxs-lookup"><span data-stu-id="7152d-115">Value</span></span>        | <span data-ttu-id="7152d-116">Descrizione</span><span class="sxs-lookup"><span data-stu-id="7152d-116">Description</span></span>                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7152d-117">distribuzione della struttura \_</span><span class="sxs-lookup"><span data-stu-id="7152d-117">FACILITY\_DISPATCH</span></span><br/> | <span data-ttu-id="7152d-118">2</span><span class="sxs-lookup"><span data-stu-id="7152d-118">2</span></span><br/> | <span data-ttu-id="7152d-119">Per gli errori dell'interfaccia **IDispatch** con associazione tardiva.</span><span class="sxs-lookup"><span data-stu-id="7152d-119">For late-binding **IDispatch** interface errors.</span></span> <br/>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="7152d-120">FUNZIONALITÀ \_ ITF</span><span class="sxs-lookup"><span data-stu-id="7152d-120">FACILITY\_ITF</span></span><br/>      | <span data-ttu-id="7152d-121">4</span><span class="sxs-lookup"><span data-stu-id="7152d-121">4</span></span><br/> | <span data-ttu-id="7152d-122">Per la maggior parte dei codici di stato restituiti dai metodi di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="7152d-122">For most status codes returned from interface methods.</span></span> <span data-ttu-id="7152d-123">Il significato effettivo dell'errore è definito dall'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="7152d-123">The actual meaning of the error is defined by the interface.</span></span> <span data-ttu-id="7152d-124">Ovvero, due **HRESULT** s con esattamente lo stesso valore a 32 bit restituito da due interfacce diverse possono avere significati diversi.</span><span class="sxs-lookup"><span data-stu-id="7152d-124">That is, two **HRESULT** s with exactly the same 32-bit value returned from two different interfaces might have different meanings.</span></span> <br/>                                                       |
| <span data-ttu-id="7152d-125">FUNZIONE \_ null</span><span class="sxs-lookup"><span data-stu-id="7152d-125">FACILITY\_NULL</span></span><br/>     | <span data-ttu-id="7152d-126">0</span><span class="sxs-lookup"><span data-stu-id="7152d-126">0</span></span><br/> | <span data-ttu-id="7152d-127">Per i codici di stato comuni applicabili a livello generale, ad esempio S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="7152d-127">For broadly applicable common status codes such as S\_OK.</span></span> <br/>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="7152d-128">RPC di struttura \_</span><span class="sxs-lookup"><span data-stu-id="7152d-128">FACILITY\_RPC</span></span><br/>      | <span data-ttu-id="7152d-129">1</span><span class="sxs-lookup"><span data-stu-id="7152d-129">1</span></span><br/> | <span data-ttu-id="7152d-130">Per i codici di stato restituiti dalle chiamate a procedure remote.</span><span class="sxs-lookup"><span data-stu-id="7152d-130">For status codes returned from remote procedure calls.</span></span> <br/>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="7152d-131">archiviazione di strutture \_</span><span class="sxs-lookup"><span data-stu-id="7152d-131">FACILITY\_STORAGE</span></span><br/>  | <span data-ttu-id="7152d-132">3</span><span class="sxs-lookup"><span data-stu-id="7152d-132">3</span></span><br/> | <span data-ttu-id="7152d-133">Per i codici di stato restituiti dalle chiamate al metodo [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) o [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) correlate all'archiviazione strutturata.</span><span class="sxs-lookup"><span data-stu-id="7152d-133">For status codes returned from [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) method calls relating to structured storage.</span></span> <span data-ttu-id="7152d-134">I codici di stato il cui valore (inferiore a 16 bit) è compreso nell'intervallo dei codici di errore MS-DOS, ovvero minori di 256, hanno lo stesso significato dell'errore MS-DOS corrispondente.</span><span class="sxs-lookup"><span data-stu-id="7152d-134">Status codes whose code (lower 16 bits) value is in the range of MS-DOS error codes (that is, less than 256) have the same meaning as the corresponding MS-DOS error.</span></span> <br/> |
| <span data-ttu-id="7152d-135">Win32 della struttura \_</span><span class="sxs-lookup"><span data-stu-id="7152d-135">FACILITY\_WIN32</span></span><br/>    | <span data-ttu-id="7152d-136">7</span><span class="sxs-lookup"><span data-stu-id="7152d-136">7</span></span><br/> | <span data-ttu-id="7152d-137">Utilizzato per fornire un metodo per gestire i codici di errore dalle funzioni nell'API Windows come valore **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="7152d-137">Used to provide a means of handling error codes from functions in the Windows API as an **HRESULT**.</span></span> <span data-ttu-id="7152d-138">I codici di errore in OLE a 16 bit che hanno duplicato i codici di errore di sistema sono stati modificati anche in Win32 della struttura \_ .</span><span class="sxs-lookup"><span data-stu-id="7152d-138">Error codes in 16-bit OLE that duplicated system error codes have also been changed to FACILITY\_WIN32.</span></span> <br/>                                                                                                 |
| <span data-ttu-id="7152d-139">finestre di struttura \_</span><span class="sxs-lookup"><span data-stu-id="7152d-139">FACILITY\_WINDOWS</span></span><br/>  | <span data-ttu-id="7152d-140">8</span><span class="sxs-lookup"><span data-stu-id="7152d-140">8</span></span><br/> | <span data-ttu-id="7152d-141">Utilizzato per ulteriori codici di errore dalle interfacce definite da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7152d-141">Used for additional error codes from Microsoft-defined interfaces.</span></span><br/>                                                                                                                                                                                                                                            |



 

<span data-ttu-id="7152d-142">Il campo del codice è un numero univoco assegnato per rappresentare l'errore o l'avviso.</span><span class="sxs-lookup"><span data-stu-id="7152d-142">The code field is a unique number that is assigned to represent the error or warning.</span></span>

<span data-ttu-id="7152d-143">Per convenzione, i valori **HRESULT** hanno in genere nomi nel formato seguente: motivo della gravità della *struttura* \_  \_ .</span><span class="sxs-lookup"><span data-stu-id="7152d-143">By convention, **HRESULT** values generally have names in the following format: *Facility*\_*Severity*\_*Reason*.</span></span>

<span data-ttu-id="7152d-144">La *struttura* è il nome della struttura o un altro identificatore di distinzione; Il livello di *gravità* è una singola lettera, S o E, che indica se la chiamata di funzione ha avuto esito positivo o ha generato un errore (E); e *reason* è un identificatore che descrive il significato del codice.</span><span class="sxs-lookup"><span data-stu-id="7152d-144">*Facility* is either the facility name or some other distinguishing identifier; *Severity* is a single letter, S or E, that indicates whether the function call succeeded (S) or produced an error (E); and *Reason* is an identifier that describes the meaning of the code.</span></span> <span data-ttu-id="7152d-145">Il codice di stato STG \_ E FileNotFound indica ad esempio che \_ si è verificato un errore relativo all'archiviazione. in particolare, non esiste un file richiesto.</span><span class="sxs-lookup"><span data-stu-id="7152d-145">For example, the status code STG\_E\_FILENOTFOUND indicates a storage-related error has occurred; specifically, a requested file does not exist.</span></span> <span data-ttu-id="7152d-146">I codici di stato della funzionalità \_ null omettono il prefisso della *funzionalità* \_ .</span><span class="sxs-lookup"><span data-stu-id="7152d-146">Status codes from FACILITY\_NULL omit the *Facility*\_ prefix.</span></span>

<span data-ttu-id="7152d-147">I codici di errore sono definiti all'interno del contesto di un'implementazione dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="7152d-147">Error codes are defined within the context of an interface implementation.</span></span> <span data-ttu-id="7152d-148">Una volta definito, i codici di esito positivo non possono essere modificati o nuovi codici di riuscita aggiunti.</span><span class="sxs-lookup"><span data-stu-id="7152d-148">Once defined, success codes cannot be changed or new success codes added.</span></span> <span data-ttu-id="7152d-149">Tuttavia, è possibile scrivere nuovi codici di errore.</span><span class="sxs-lookup"><span data-stu-id="7152d-149">However, new failure codes can be written.</span></span> <span data-ttu-id="7152d-150">Microsoft si riserva il diritto di definire nuovi codici di errore (ma non codici di esito positivo) per le interfacce descritte in funzionalità \_ ITF o in nuove strutture.</span><span class="sxs-lookup"><span data-stu-id="7152d-150">Microsoft reserves the right to define new failure codes (but not success codes) for the interfaces described in FACILITY\_ITF or in new facilities.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7152d-151">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="7152d-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7152d-152">Gestione degli errori in COM</span><span class="sxs-lookup"><span data-stu-id="7152d-152">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> <dt>

[<span data-ttu-id="7152d-153">Protocolli di Windows: HRESULT</span><span class="sxs-lookup"><span data-stu-id="7152d-153">Windows Protocols: HRESULT</span></span>](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

