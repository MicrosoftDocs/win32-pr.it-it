---
title: AppIDFlags
description: Set di flag che controllano il comportamento di attivazione di un server COM.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- Valore AppIDFlags del registro di sistema COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cdad2b80625d6a60460d43f242d7897e0ae7eb40
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "106300544"
---
# <a name="appidflags"></a><span data-ttu-id="09cd7-104">AppIDFlags</span><span class="sxs-lookup"><span data-stu-id="09cd7-104">AppIDFlags</span></span>

<span data-ttu-id="09cd7-105">Set di flag che controllano il comportamento di attivazione di un server COM.</span><span class="sxs-lookup"><span data-stu-id="09cd7-105">A set of flags that control the activation behavior of a COM server.</span></span>

## <a name="registry-entry"></a><span data-ttu-id="09cd7-106">Voce del Registro di sistema</span><span class="sxs-lookup"><span data-stu-id="09cd7-106">Registry Entry</span></span>

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a><span data-ttu-id="09cd7-107">Commenti</span><span class="sxs-lookup"><span data-stu-id="09cd7-107">Remarks</span></span>

<span data-ttu-id="09cd7-108">Si tratta di un valore **reg \_ DWORD** .</span><span class="sxs-lookup"><span data-stu-id="09cd7-108">This is a **REG\_DWORD** value.</span></span>



| <span data-ttu-id="09cd7-109">Valore flag</span><span class="sxs-lookup"><span data-stu-id="09cd7-109">Flag Value</span></span> | <span data-ttu-id="09cd7-110">Costante</span><span class="sxs-lookup"><span data-stu-id="09cd7-110">Constant</span></span>                                              |
|------------|-------------------------------------------------------|
| <span data-ttu-id="09cd7-111">0x1</span><span class="sxs-lookup"><span data-stu-id="09cd7-111">0x1</span></span>        | <span data-ttu-id="09cd7-112">APPIDREGFLAGS \_ attiva \_ IUSERVER \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="09cd7-112">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP</span></span>          |
| <span data-ttu-id="09cd7-113">0x2</span><span class="sxs-lookup"><span data-stu-id="09cd7-113">0x2</span></span>        | <span data-ttu-id="09cd7-114">APPIDREGFLAGS \_ Secure \_ server \_ processo \_ SD \_ e \_ binding</span><span class="sxs-lookup"><span data-stu-id="09cd7-114">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND</span></span> |
| <span data-ttu-id="09cd7-115">0x4</span><span class="sxs-lookup"><span data-stu-id="09cd7-115">0x4</span></span>        | <span data-ttu-id="09cd7-116">APPIDREGFLAGS \_ problema \_ attivazione \_ RPC \_ all' \_ Identificazione</span><span class="sxs-lookup"><span data-stu-id="09cd7-116">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY</span></span>   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a><span data-ttu-id="09cd7-117">APPIDREGFLAGS \_ attiva la \_ Descrizione di IUSERVER \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="09cd7-117">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP Description</span></span>

<span data-ttu-id="09cd7-118">Se il **flag \_ APPIDREGFLAGS Activate \_ IUSERVER \_ indesktop** viene cancellato in **AppIDFlags** o se **AppIDFlags** non è presente, il client in una sessione di Terminal Server che effettua una richiesta di attivazione per un server COM [interattivo](interactive-user.md) , eseguirà l'associazione o l'avvio e l'associazione al server com nel desktop "predefinito" della stazione della [finestra](/windows/desktop/winstation/window-stations) "WinSta0" della sessione nella richiesta di attivazione.</span><span class="sxs-lookup"><span data-stu-id="09cd7-118">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is cleared in **AppIDFlags** or if **AppIDFlags** is not present, the client in a terminal server session making an activation request for an [Interactive User](interactive-user.md) COM server, will either bind to, or launch and bind to, the COM server in the "default" desktop of the "winsta0" [window station](/windows/desktop/winstation/window-stations) of the session in the activation request.</span></span> <span data-ttu-id="09cd7-119">Se, ad esempio, il client esegue "WinSta0 \\ Desktop1" della sessione 3, la richiesta di attivazione per la sessione 3 verrà associata o avviata e associata al server com in "WinSta0 \\ default" della sessione 3, anche se un'istanza del server com è già in esecuzione in "WinSta0 \\ Desktop1" della sessione 3.</span><span class="sxs-lookup"><span data-stu-id="09cd7-119">For example, if the client is running "winsta0\\desktop1" of session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\default" of session 3, even if an instance of the COM server is already running in "winsta0\\desktop1" of session 3.</span></span>

<span data-ttu-id="09cd7-120">Se il flag **APPIDREGFLAGS \_ Activate \_ IUSERVER \_ indesktop** è impostato sul valore **AppIDFlags** , com eseguirà l'associazione a oppure avvierà e eseguirà l'associazione a, il processo server in esecuzione nel desktop del client e la sessione nella richiesta di attivazione.</span><span class="sxs-lookup"><span data-stu-id="09cd7-120">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is set in the **AppIDFlags** value, COM will either bind to, or launch and bind to, the server process running in the client's desktop and the session in the activation request.</span></span> <span data-ttu-id="09cd7-121">Se, ad esempio, il client esegue "WinSta0 \\ Desktop1" nella sessione 3, la richiesta di attivazione per la sessione 3 verrà associata o avviata e associata al server com in "WinSta0 \\ Desktop1" nella sessione 3, anche se un'istanza del server com è già in esecuzione in "WinSta0 \\ default" nella sessione 3.</span><span class="sxs-lookup"><span data-stu-id="09cd7-121">For example, if the client is running "winsta0\\desktop1" in session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\desktop1" in session 3, even if an instance of the COM server is already running in "winsta0\\default" in session 3.</span></span>

<span data-ttu-id="09cd7-122">Il client può usare il [moniker della sessione](/windows/desktop/TermServ/session-monikers) per specificare una sessione diversa dalla sessione del client quando effettua la richiesta di attivazione.</span><span class="sxs-lookup"><span data-stu-id="09cd7-122">The client can use the [session moniker](/windows/desktop/TermServ/session-monikers) to specify a session different than the client's session when it makes the activation request.</span></span>

<span data-ttu-id="09cd7-123">Il flag **APPIDREGFLAGS \_ Activate \_ IUSERVER \_ indesktop** si applica solo ai server COM configurati per RunAs "[Interactive User](interactive-user.md)".</span><span class="sxs-lookup"><span data-stu-id="09cd7-123">The **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag applies only to COM servers that are configured to RunAs "[Interactive User](interactive-user.md)".</span></span>

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a><span data-ttu-id="09cd7-124">APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind Description</span><span class="sxs-lookup"><span data-stu-id="09cd7-124">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND Description</span></span>

<span data-ttu-id="09cd7-125">Se il **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ and \_ Bind** flag è impostato in **AppIDFlags**, i server COM configurati per RunAs "Activator" verranno avviati con un descrittore di sicurezza del processo che consente l' [elaborazione di tutti gli \_ \_ accessi](/windows/desktop/ProcThread/process-security-and-access-rights) al SID IDaccesso del token di processo.</span><span class="sxs-lookup"><span data-stu-id="09cd7-125">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "Activator" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) to the LogonID SID of the process token.</span></span> <span data-ttu-id="09cd7-126">Inoltre, il proprietario del descrittore di sicurezza verrà impostato sul SID IDaccesso del token di processo.</span><span class="sxs-lookup"><span data-stu-id="09cd7-126">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span>

<span data-ttu-id="09cd7-127">Se il **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ and \_ Bind** flag è impostato in **AppIDFlags**, i server COM configurati per RunAs "questo utente" verranno avviati con un descrittore di sicurezza del processo che consente l' [elaborazione di tutti gli \_ \_ accessi](/windows/desktop/ProcThread/process-security-and-access-rights) nel SID IDaccesso del token di processo.</span><span class="sxs-lookup"><span data-stu-id="09cd7-127">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "This User" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) in the LogonID SID of the process token.</span></span> <span data-ttu-id="09cd7-128">Inoltre, il proprietario del descrittore di sicurezza verrà impostato sul SID IDaccesso del token di processo.</span><span class="sxs-lookup"><span data-stu-id="09cd7-128">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span> <span data-ttu-id="09cd7-129">Inoltre, gestione controllo servizi COM modifica il token del processo del server COM nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="09cd7-129">Further, the COM Service Control Manager (SCM) modifies the token of the COM server process as follows:</span></span>

-   <span data-ttu-id="09cd7-130">Aggiunge un SID APPID al token.</span><span class="sxs-lookup"><span data-stu-id="09cd7-130">It adds an APPID SID to the token.</span></span> <span data-ttu-id="09cd7-131">Concede l'accesso completo al SID APPID nell'elenco di controllo di accesso discrezionale (DACL) predefinito del token.</span><span class="sxs-lookup"><span data-stu-id="09cd7-131">It grants the APPID SID full access in the token default discretionary access control list (DACL).</span></span> <span data-ttu-id="09cd7-132">In Windows Vista e nelle versioni successive di Windows, viene concessa l'autorizzazione OwnerRights SID READ \_ Control nell'elenco DACL predefinito del token.</span><span class="sxs-lookup"><span data-stu-id="09cd7-132">In Windows Vista and later versions of Windows, it grants the OwnerRights SID READ\_CONTROL permission in the token default DACL.</span></span> <span data-ttu-id="09cd7-133">Nelle versioni precedenti a Windows Vista di Windows, il proprietario del token viene impostato sul SID APPID.</span><span class="sxs-lookup"><span data-stu-id="09cd7-133">In pre-Windows Vista versions of Windows, it sets the token owner to the APPID SID.</span></span>

<span data-ttu-id="09cd7-134">Quando si usa **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind flag,** è necessario tenere presenti le considerazioni di sicurezza seguenti:</span><span class="sxs-lookup"><span data-stu-id="09cd7-134">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag:</span></span>

-   <span data-ttu-id="09cd7-135">Il flag **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind** deve essere impostato dai server com avviati con uno dei contesti di sicurezza del servizio incorporati, ovvero l'account NetworkService o LocalService.</span><span class="sxs-lookup"><span data-stu-id="09cd7-135">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is meant to be set by COM servers that are launched under one of the built-in service security contexts; either the NetworkService or the LocalService accounts.</span></span> <span data-ttu-id="09cd7-136">Se i server impersonano i client con privilegi e se il flag di **\_ \_ \_ \_ \_ \_ Binding e la SD del processo del server APPIDREGFLAGS Secure** non è impostato, il codice dannoso in esecuzione in altri processi con lo stesso contesto di sicurezza può elevare i privilegi dividendo i token di rappresentazione dei client con privilegi dal processo del server com.</span><span class="sxs-lookup"><span data-stu-id="09cd7-136">If the servers impersonate privileged clients and if the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is not set, malicious code running in other processes with the same security context can elevate privilege by hijacking the impersonation tokens of the privileged clients from the COM server process.</span></span>
-   <span data-ttu-id="09cd7-137">Quando viene impostato il flag **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind** , com consolida il descrittore di sicurezza dell'oggetto processo nel caso di server com RunAs "Activator".</span><span class="sxs-lookup"><span data-stu-id="09cd7-137">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "Activator" COM servers.</span></span> <span data-ttu-id="09cd7-138">Per tali server, il client COM dovrebbe finalizzare il token utilizzato per l'attivazione COM.</span><span class="sxs-lookup"><span data-stu-id="09cd7-138">For such servers, the COM client is expected to harden the token that it uses for the COM activation.</span></span>
-   <span data-ttu-id="09cd7-139">Quando viene impostato il flag **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind** , com consolida il descrittore di sicurezza dell'oggetto processo nel caso di server com RunAs "questo utente".</span><span class="sxs-lookup"><span data-stu-id="09cd7-139">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "This User" COM servers.</span></span> <span data-ttu-id="09cd7-140">Consente inoltre di finalizzare il token di processo del server COM poiché il SCM COM è l'entità che crea il token.</span><span class="sxs-lookup"><span data-stu-id="09cd7-140">It also hardens the process token of the COM server since the COM SCM is the entity that creates the token.</span></span>

<span data-ttu-id="09cd7-141">Il flag **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind** è supportato in Windows XP, Windows server 2003, Windows Vista e Windows Server 2008 solo quando viene applicata la patch MSRC8322 ([Security Bulletin MS09-012](https://support.microsoft.com/kb/959454)).</span><span class="sxs-lookup"><span data-stu-id="09cd7-141">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is supported in Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008 only when the MSRC8322 patch ([security bulletin MS09-012](https://support.microsoft.com/kb/959454)) is applied.</span></span> <span data-ttu-id="09cd7-142">È supportata in modo nativo in Windows 7 e nelle versioni successive di Windows.</span><span class="sxs-lookup"><span data-stu-id="09cd7-142">It is natively supported in Windows 7 and later versions of Windows.</span></span>

<span data-ttu-id="09cd7-143">Il flag **APPIDREGFLAGS \_ Secure \_ server \_ Process \_ SD \_ e \_ Bind** flag si applica solo ai server COM configurati per RunAs "Activator" o "This user".</span><span class="sxs-lookup"><span data-stu-id="09cd7-143">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag applies only to COM servers that are configured to RunAs "Activator" or "This User".</span></span> <span data-ttu-id="09cd7-144">Non si applica ai server COM che sono servizi NT.</span><span class="sxs-lookup"><span data-stu-id="09cd7-144">It does not apply to COM servers that are NT services.</span></span>

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a><span data-ttu-id="09cd7-145">APPIDREGFLAGS \_ problema \_ attivazione \_ RPC \_ in \_ Identificazione Descrizione</span><span class="sxs-lookup"><span data-stu-id="09cd7-145">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY Description</span></span>

<span data-ttu-id="09cd7-146">Se il **APPIDREGFLAGS \_ problema di \_ attivazione \_ RPC \_ al \_** flag di identificazione è impostato in **AppIDFlags**, il SCM com emetterà richieste di attivazione degli oggetti al processo del server COM utilizzando un livello di rappresentazione di [ \_ \_ \_ \_ Identificazione del livello di RPC C](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="09cd7-146">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is set in **AppIDFlags**, the COM SCM will issue object activation requests to the COM server process using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md).</span></span>

<span data-ttu-id="09cd7-147">Se il **APPIDREGFLAGS \_ problema di \_ attivazione \_ RPC \_ al \_** flag di identificazione non è impostato, il SCM com emetterà richieste di attivazione oggetti ai processi del server COM utilizzando un livello di rappresentazione di [RPC \_ C \_ Imp \_ level \_ Impersonate](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="09cd7-147">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is not set, the COM SCM will issue object activation requests to the COM server processes using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IMPERSONATE](impersonation-levels.md).</span></span>

<span data-ttu-id="09cd7-148">Quando si usa il **APPIDREGFLAGS \_ problema \_ attivazione \_ RPC \_ al flag di \_ Identificazione** , è necessario tenere presenti le seguenti considerazioni sulla sicurezza:</span><span class="sxs-lookup"><span data-stu-id="09cd7-148">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag:</span></span>

-   <span data-ttu-id="09cd7-149">Il **APPIDREGFLAGS \_ problema \_ attivazione \_ RPC \_ al \_** flag di identificazione è destinato a essere utilizzato dai server COM che non eseguono operazioni per conto dei client nelle richieste di attivazione oggetti.</span><span class="sxs-lookup"><span data-stu-id="09cd7-149">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is meant to be used by COM servers that do not perform work on behalf of clients in object activation requests.</span></span> <span data-ttu-id="09cd7-150">Per tali server, il fatto che le richieste di attivazione di oggetti di gestione dei servizi di gestione dei servizi di gestione dei servizi di gestione delle identità a livello di utente di [RPC \_ C \_ \_ \_](impersonation-levels.md) riducano al minimo le possibilità di token con privilegi se il livello di [**\_ \_ nome rappresenta**](/windows/desktop/SecAuthZ/privilege-constants)</span><span class="sxs-lookup"><span data-stu-id="09cd7-150">For such servers, having the COM SCM issue object activation requests at [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md) minimizes the chances of privileged tokens with [**SE\_IMPERSONATE\_NAME**](/windows/desktop/SecAuthZ/privilege-constants) level appearing in the process.</span></span>

<span data-ttu-id="09cd7-151">Il **APPIDREGFLAGS \_ problema \_ attivazione \_ RPC \_ al \_** flag di identificazione è supportato in Windows 7 e versioni successive di Windows.</span><span class="sxs-lookup"><span data-stu-id="09cd7-151">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is supported in Windows 7 and later versions of Windows.</span></span>

## <a name="related-topics"></a><span data-ttu-id="09cd7-152">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="09cd7-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="09cd7-153">Desktop</span><span class="sxs-lookup"><span data-stu-id="09cd7-153">Desktops</span></span>](/windows/desktop/winstation/desktops)
</dt> <dt>

[<span data-ttu-id="09cd7-154">Livelli di rappresentazione</span><span class="sxs-lookup"><span data-stu-id="09cd7-154">Impersonation Levels</span></span>](impersonation-levels.md)
</dt> <dt>

[<span data-ttu-id="09cd7-155">Utente interattivo</span><span class="sxs-lookup"><span data-stu-id="09cd7-155">Interactive User</span></span>](interactive-user.md)
</dt> <dt>

[<span data-ttu-id="09cd7-156">Moniker della sessione</span><span class="sxs-lookup"><span data-stu-id="09cd7-156">Session Monikers</span></span>](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[<span data-ttu-id="09cd7-157">Stazioni finestra</span><span class="sxs-lookup"><span data-stu-id="09cd7-157">Window Stations</span></span>](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 