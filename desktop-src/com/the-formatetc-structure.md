---
title: Struttura FORMATETC
description: La struttura FORMATETC è un formato degli Appunti generalizzato, ottimizzato per includere un dispositivo di destinazione, un aspetto o una visualizzazione dei dati e un supporto di archiviazione.
ms.assetid: 46d8988a-4b97-4c86-8b1b-db87044a7e01
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ece0079cf2c0f07b7356f07ee2c53b1279b7ce7
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730543"
---
# <a name="the-formatetc-structure"></a><span data-ttu-id="214d8-103">Struttura FORMATETC</span><span class="sxs-lookup"><span data-stu-id="214d8-103">The FORMATETC Structure</span></span>

<span data-ttu-id="214d8-104">La struttura FORMATETC è un formato degli Appunti generalizzato, ottimizzato per includere un dispositivo di destinazione, un *aspetto* o una visualizzazione dei dati e un supporto di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="214d8-104">The FORMATETC structure is a generalized clipboard format, enhanced to encompass a target device, an *aspect* or view of the data, and a storage medium.</span></span> <span data-ttu-id="214d8-105">Un consumer di dati, ad esempio un'applicazione contenitore OLE, passa la struttura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) come argomento nelle chiamate a [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) per indicare il tipo di dati desiderato da un'origine dati, ad esempio un oggetto documento composto.</span><span class="sxs-lookup"><span data-stu-id="214d8-105">A data consumer, such as an OLE container application, passes the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as an argument in calls to [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) to indicate the type of data it wants from a data source, such as a compound document object.</span></span> <span data-ttu-id="214d8-106">L'origine usa la struttura **FORMATETC** per descrivere i formati che è in grado di fornire.</span><span class="sxs-lookup"><span data-stu-id="214d8-106">The source uses the **FORMATETC** structure to describe what formats it can provide.</span></span>

<span data-ttu-id="214d8-107">[**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) può descrivere praticamente tutti i dati, inclusi altri oggetti, ad esempio moniker.</span><span class="sxs-lookup"><span data-stu-id="214d8-107">[**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) can describe virtually any data, including other objects such as monikers.</span></span> <span data-ttu-id="214d8-108">Un contenitore può chiedere a uno dei suoi oggetti incorporati di elencare i formati di dati chiamando [**IDataObject:: EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), che restituisce un oggetto enumeratore che implementa l'interfaccia [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) .</span><span class="sxs-lookup"><span data-stu-id="214d8-108">A container can ask one of its embedded objects to list its data formats by calling [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), which returns an enumerator object that implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface.</span></span> <span data-ttu-id="214d8-109">Anziché rispondere semplicemente che contiene "testo e una bitmap", l'oggetto può fornire una descrizione dettagliata dei dati, tra cui il dispositivo (normalmente lo schermo o la stampante) per cui viene eseguito il rendering, l'aspetto da presentare all'utente (contenuto completo, anteprima, icona o formattato per la stampa) e il supporto di archiviazione contenente i dati (memoria globale, file su disco, oggetto di archiviazione). , o flusso).</span><span class="sxs-lookup"><span data-stu-id="214d8-109">Instead of replying merely that it has "text and a bitmap," the object can provide a detailed description of the data, including the device (normally screen or printer) for which it is rendered, the aspect to be presented to the user (full contents, thumbnail, icon, or formatted for printing), and the storage medium containing the data (global memory, disk file, storage object, or stream).</span></span> <span data-ttu-id="214d8-110">Questa possibilità di descrivere in modo accurato i dati, nel tempo, comporterà una maggiore qualità di stampa e output dello schermo, oltre a una maggiore efficienza nell'esplorazione dei dati, in cui uno sketch di anteprima è molto più veloce da recuperare e visualizzare rispetto a un rendering completamente dettagliato.</span><span class="sxs-lookup"><span data-stu-id="214d8-110">This ability to tightly describe data will, in time, result in higher quality printer and screen output as well as more efficiency in data browsing, where a thumbnail sketch is much faster to retrieve and display than a fully detailed rendering.</span></span>

<span data-ttu-id="214d8-111">Nella tabella seguente sono elencati i campi della struttura di dati [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) e le informazioni specificate.</span><span class="sxs-lookup"><span data-stu-id="214d8-111">The following table lists fields of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) data structure and the information that they specify.</span></span>



| <span data-ttu-id="214d8-112">Campo</span><span class="sxs-lookup"><span data-stu-id="214d8-112">Field</span></span>                   | <span data-ttu-id="214d8-113">Specifica</span><span class="sxs-lookup"><span data-stu-id="214d8-113">Specifies</span></span>                                                                                                                                                                                                                                                                    |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="214d8-114">**cfFormat**</span><span class="sxs-lookup"><span data-stu-id="214d8-114">**cfFormat**</span></span><br/> | <span data-ttu-id="214d8-115">Formato in cui eseguire il rendering dei dati, che può essere un formato degli Appunti standard, un formato proprietario o un formato OLE.</span><span class="sxs-lookup"><span data-stu-id="214d8-115">The format in which the data is to be rendered, which can be a standard clipboard format, a proprietary format, or an OLE format.</span></span> <span data-ttu-id="214d8-116">Per ulteriori informazioni sui formati OLE, vedere [documenti composti](compound-documents.md).</span><span class="sxs-lookup"><span data-stu-id="214d8-116">For more information on OLE formats, see [Compound Documents](compound-documents.md).</span></span><br/>                                          |
| <span data-ttu-id="214d8-117">**PTD**</span><span class="sxs-lookup"><span data-stu-id="214d8-117">**ptd**</span></span><br/>      | <span data-ttu-id="214d8-118">Struttura [**DVTARGETDEVICE**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , che contiene informazioni sufficienti su un dispositivo di destinazione Windows, ad esempio una schermata o una stampante, in modo che sia possibile creare un handle per il relativo contesto di dispositivo (HDC) utilizzando la funzione [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) .</span><span class="sxs-lookup"><span data-stu-id="214d8-118">A [**DVTARGETDEVICE**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) structure, which contains enough information about a Windows target device, such as a screen or printer, so that a handle to its device context (hDC) can be created using the [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) function.</span></span> <br/> |
| <span data-ttu-id="214d8-119">**dwAspect**</span><span class="sxs-lookup"><span data-stu-id="214d8-119">**dwAspect**</span></span><br/> | <span data-ttu-id="214d8-120">Aspetto o visualizzazione dei dati di cui eseguire il rendering. può essere il contenuto completo, uno schizzo di anteprima, un'icona o formattato per la stampa.</span><span class="sxs-lookup"><span data-stu-id="214d8-120">The aspect or view of the data to be rendered; can be the full contents, a thumbnail sketch, an icon, or formatted for printing.</span></span><br/>                                                                                                                                  |
| <span data-ttu-id="214d8-121">**Lindex**</span><span class="sxs-lookup"><span data-stu-id="214d8-121">**lindex**</span></span><br/>   | <span data-ttu-id="214d8-122">Parte dell'aspetto di interesse. per la presente, il valore deve essere-1, a indicare che l'intera vista è di interesse.</span><span class="sxs-lookup"><span data-stu-id="214d8-122">The part of the aspect that is of interest; for the present, the value must be -1, indicating that the entire view is of interest.</span></span><br/>                                                                                                                                |
| <span data-ttu-id="214d8-123">**TYMED**</span><span class="sxs-lookup"><span data-stu-id="214d8-123">**tymed**</span></span><br/>    | <span data-ttu-id="214d8-124">Supporto di archiviazione dei dati, che può essere una memoria globale, un file su disco o un'istanza di una delle interfacce di archiviazione strutturata di COM.</span><span class="sxs-lookup"><span data-stu-id="214d8-124">The data's storage medium, which can be global memory, disk file, or an instance of one of COM's structured-storage interfaces.</span></span><br/>                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="214d8-125">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="214d8-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="214d8-126">Formati di dati e supporti di trasferimento</span><span class="sxs-lookup"><span data-stu-id="214d8-126">Data Formats and Transfer Media</span></span>](data-formats-and-transfer-media.md)
</dt> </dl>

 

