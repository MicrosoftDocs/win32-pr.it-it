---
title: Uso di IConnectionPointContainer
description: Uso di IConnectionPointContainer
ms.assetid: a87afb25-4d45-4ce2-9b27-840da5107bce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d0b7c691e1ba6a8445af56978b43a2ccbf33e7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/29/2020
ms.locfileid: "106299347"
---
# <a name="using-iconnectionpointcontainer"></a><span data-ttu-id="39b8c-103">Uso di IConnectionPointContainer</span><span class="sxs-lookup"><span data-stu-id="39b8c-103">Using IConnectionPointContainer</span></span>

<span data-ttu-id="39b8c-104">Un oggetto collegabile implementa [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (e lo espone tramite [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) per indicare l'esistenza delle interfacce in uscita.</span><span class="sxs-lookup"><span data-stu-id="39b8c-104">A connectable object implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (and exposes it through [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) to indicate the existence of outgoing interfaces.</span></span> <span data-ttu-id="39b8c-105">Per ogni interfaccia in uscita, l'oggetto collegabile gestisce un oggetto secondario del punto di connessione, che a sua volta implementa [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="39b8c-105">For each outgoing interface, the connectable object manages a connection point sub-object, which itself implements [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span></span> <span data-ttu-id="39b8c-106">L'oggetto collegabile contiene quindi i punti di connessione, di conseguenza la denominazione di **IConnectionPointContainer** e **IConnectionPoint**.</span><span class="sxs-lookup"><span data-stu-id="39b8c-106">The connectable object therefore contains the connection points, hence the naming of **IConnectionPointContainer** and **IConnectionPoint**.</span></span>

<span data-ttu-id="39b8c-107">Tramite [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), un client può eseguire due operazioni.</span><span class="sxs-lookup"><span data-stu-id="39b8c-107">Through [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), a client can perform two operations.</span></span> <span data-ttu-id="39b8c-108">Prima di tutto, se il client ha già l'IID per un'interfaccia in uscita supportata, può individuare il punto di connessione corrispondente per l'IID usando [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="39b8c-108">First, if the client already has the IID for an outgoing interface that it supports, it can locate the corresponding connection point for the IID using [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span> <span data-ttu-id="39b8c-109">Il client non è in grado di eseguire una query per il punto di connessione direttamente a causa della relazione contenitore/contenuto tra l'oggetto collegabile e i punti di connessione contenuti.</span><span class="sxs-lookup"><span data-stu-id="39b8c-109">The client cannot query for the connection point directly because of the container/contained relationship between the connectable object and its contained connection points.</span></span> <span data-ttu-id="39b8c-110">Fondamentalmente, **FindConnectionPoint** è la [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) per le interfacce in uscita quando l'IID è noto al client.</span><span class="sxs-lookup"><span data-stu-id="39b8c-110">Basically, **FindConnectionPoint** is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for outgoing interfaces when the IID is known to the client.</span></span>

<span data-ttu-id="39b8c-111">In secondo luogo, il client può enumerare tutti i punti di connessione all'interno dell'oggetto collegabile tramite [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="39b8c-111">Second, the client can enumerate all connection points within the connectable object through [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="39b8c-112">Questo metodo restituisce un puntatore a interfaccia [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) per un oggetto enumeratore separato.</span><span class="sxs-lookup"><span data-stu-id="39b8c-112">This method returns an [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) interface pointer for a separate enumerator object.</span></span> <span data-ttu-id="39b8c-113">Tramite [**IEnumConnectionPoints:: Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), il client può ottenere puntatori di interfaccia [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) a ogni punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="39b8c-113">Through [**IEnumConnectionPoints::Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), the client can obtain [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface pointers to each connection point.</span></span>

<span data-ttu-id="39b8c-114">Dopo che il client ha ottenuto l'interfaccia [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) , deve chiamare [**IConnectionPoint:: GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) per determinare l'IID dell'interfaccia in uscita supportata da ogni punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="39b8c-114">After the client obtains the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface, it must call [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) to determine the IID of the outgoing interface supported by each connection point.</span></span> <span data-ttu-id="39b8c-115">Se il client supporta già tale interfaccia in uscita, può stabilire una connessione.</span><span class="sxs-lookup"><span data-stu-id="39b8c-115">If the client already supports that outgoing interface, it can establish a connection.</span></span> <span data-ttu-id="39b8c-116">In caso contrario, può comunque essere in grado di supportare l'interfaccia in uscita usando le informazioni della libreria dei tipi dell'oggetto collegabile per fornire supporto in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="39b8c-116">Otherwise, it may still be able to support the outgoing interface by using information from the connectable object's type library to provide support at run time.</span></span> <span data-ttu-id="39b8c-117">Questa tecnica richiede che l'oggetto collegabile supporti l'interfaccia [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) .</span><span class="sxs-lookup"><span data-stu-id="39b8c-117">This technique requires that the connectable object support the [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="39b8c-118">Vedere [uso di IProvideClassInfo](using-iprovideclassinfo.md).</span><span class="sxs-lookup"><span data-stu-id="39b8c-118">(See [Using IProvideClassInfo](using-iprovideclassinfo.md).)</span></span>

<span data-ttu-id="39b8c-119">Poiché l'enumeratore è un oggetto separato, il client deve chiamare **IEnumConnectionPoints:: Release** quando l'enumeratore non è più necessario.</span><span class="sxs-lookup"><span data-stu-id="39b8c-119">Because the enumerator is a separate object, the client must call **IEnumConnectionPoints::Release** when the enumerator is no longer needed.</span></span> <span data-ttu-id="39b8c-120">Inoltre, ogni punto di connessione è un oggetto con un conteggio dei riferimenti separato dall'oggetto che lo contiene.</span><span class="sxs-lookup"><span data-stu-id="39b8c-120">In addition, each connection point is an object with a separate reference count from the containing connectable object.</span></span> <span data-ttu-id="39b8c-121">Il client deve quindi chiamare anche IConnectionPoint:: Release per ogni punto di connessione a cui si accede tramite l'enumeratore o tramite [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span><span class="sxs-lookup"><span data-stu-id="39b8c-121">Therefore, the client must also call IConnectionPoint::Release for each connection point accessed either through the enumerator or through [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span>

## <a name="related-topics"></a><span data-ttu-id="39b8c-122">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="39b8c-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39b8c-123">Interfacce di oggetti collegabili</span><span class="sxs-lookup"><span data-stu-id="39b8c-123">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




