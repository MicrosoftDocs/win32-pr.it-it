---
title: Architettura degli oggetti collegabili
description: Architettura degli oggetti collegabili
ms.assetid: 69949a3b-3ab8-4054-84d8-9256fbf39c7b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e9d8d2909942d1c04aed972e7891a6f4ae3f730
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/03/2021
ms.locfileid: "106320192"
---
# <a name="architecture-of-connectable-objects"></a><span data-ttu-id="3120d-103">Architettura degli oggetti collegabili</span><span class="sxs-lookup"><span data-stu-id="3120d-103">Architecture of Connectable Objects</span></span>

<span data-ttu-id="3120d-104">L'oggetto collegabile è solo una parte dell'architettura complessiva degli oggetti collegabili.</span><span class="sxs-lookup"><span data-stu-id="3120d-104">The connectable object is only one piece of the overall architecture of connectable objects.</span></span> <span data-ttu-id="3120d-105">Questa tecnologia include gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3120d-105">This technology includes the following elements:</span></span>

-   <span data-ttu-id="3120d-106">**Oggetto collegabile.**</span><span class="sxs-lookup"><span data-stu-id="3120d-106">**Connectable object.**</span></span> <span data-ttu-id="3120d-107">Implementa l'interfaccia [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) ; Crea almeno un oggetto punto di connessione; definisce un'interfaccia in uscita per il client.</span><span class="sxs-lookup"><span data-stu-id="3120d-107">Implements the [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface; creates at least one connection point object; defines an outgoing interface for the client.</span></span>
-   <span data-ttu-id="3120d-108">**Client.**</span><span class="sxs-lookup"><span data-stu-id="3120d-108">**Client.**</span></span> <span data-ttu-id="3120d-109">Esegue una query sull'oggetto per [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) per determinare se l'oggetto è collegabile; Crea un oggetto sink per implementare l'interfaccia in uscita definita dall'oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-109">Queries the object for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to determine whether the object is connectable; creates a sink object to implement the outgoing interface defined by the connectable object.</span></span>
-   <span data-ttu-id="3120d-110">**Oggetto sink.**</span><span class="sxs-lookup"><span data-stu-id="3120d-110">**Sink object.**</span></span> <span data-ttu-id="3120d-111">Implementa l'interfaccia in uscita; utilizzato per stabilire una connessione all'oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-111">Implements the outgoing interface; used to establish a connection to the connectable object.</span></span>
-   <span data-ttu-id="3120d-112">**Oggetto punto di connessione.**</span><span class="sxs-lookup"><span data-stu-id="3120d-112">**Connection point object.**</span></span> <span data-ttu-id="3120d-113">Implementa l'interfaccia [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) e gestisce la connessione con il sink del client.</span><span class="sxs-lookup"><span data-stu-id="3120d-113">Implements the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface and manages connection with the client's sink.</span></span>

<span data-ttu-id="3120d-114">Nel diagramma seguente vengono illustrate le relazioni tra il client, l'oggetto collegabile, un punto di connessione e un sink:</span><span class="sxs-lookup"><span data-stu-id="3120d-114">The relationships between client, connectable object, a connection point, and a sink are illustrated in the following diagram:</span></span>

![Diagramma che mostra i punti di connessione tra il client e l'oggetto collegabile.](images/1cd44fec-5d2c-4427-846b-ccab7ec0b08a.png)

<span data-ttu-id="3120d-116">Prima che l'oggetto punto di connessione chiami i metodi nell'interfaccia sink nel passaggio 3 del diagramma precedente, deve essere [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) per l'interfaccia specifica richiesta, anche se il puntatore è già stato passato nella chiamata al passaggio 2 al metodo [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) .</span><span class="sxs-lookup"><span data-stu-id="3120d-116">Before the connection point object calls methods in the sink interface in step 3 in the preceding diagram, it must [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for the specific interface required, even if the pointer was already passed in the step 2 call to the [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) method.</span></span>

<span data-ttu-id="3120d-117">Anche in questa architettura sono inclusi due oggetti enumeratori, anche se non mostrati nell'illustrazione.</span><span class="sxs-lookup"><span data-stu-id="3120d-117">Two enumerator objects are also involved in this architecture though not shown in the illustration.</span></span> <span data-ttu-id="3120d-118">Una viene creata da un metodo in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) per enumerare i punti di connessione all'interno dell'oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-118">One is created by a method in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to enumerate the connection points within the connectable object.</span></span> <span data-ttu-id="3120d-119">L'altro viene creato da un metodo in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) per enumerare le connessioni attualmente stabilite al punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="3120d-119">The other is created by a method in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) to enumerate the connections currently established to that connection point.</span></span> <span data-ttu-id="3120d-120">Un punto di connessione può supportare più interfacce di sink connesse e dovrebbe scorrere l'elenco delle connessioni ogni volta che effettua una chiamata al metodo su tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="3120d-120">One connection point can support multiple connected sink interfaces, and it should iterate through the list of connections each time it makes a method call on that interface.</span></span> <span data-ttu-id="3120d-121">Questo processo è noto come multicast.</span><span class="sxs-lookup"><span data-stu-id="3120d-121">This process is known as multicasting.</span></span>

<span data-ttu-id="3120d-122">Quando si utilizzano oggetti collegabili, è importante comprendere che l'oggetto collegabile, ogni punto di connessione, ogni sink e tutti gli enumeratori sono oggetti separati con implementazioni [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) separate, conteggi dei riferimenti separati e durate separate.</span><span class="sxs-lookup"><span data-stu-id="3120d-122">When working with connectable objects, it is important to understand that the connectable object, each connection point, each sink, and all enumerators are separate objects with separate [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) implementations, separate reference counts, and separate lifetimes.</span></span> <span data-ttu-id="3120d-123">Un client che utilizza questi oggetti è sempre responsabile del rilascio di tutti i conteggi dei riferimenti di cui è proprietario.</span><span class="sxs-lookup"><span data-stu-id="3120d-123">A client using these objects is always responsible for releasing all reference counts it owns.</span></span>

> [!Note]  
> <span data-ttu-id="3120d-124">Un oggetto collegabile può supportare più di un client e può supportare più sink all'interno di un client.</span><span class="sxs-lookup"><span data-stu-id="3120d-124">A connectable object can support more than one client and can support multiple sinks within a client.</span></span> <span data-ttu-id="3120d-125">Analogamente, un sink può essere connesso a più di un oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-125">Likewise, a sink can be connected to more than one connectable object.</span></span>

 

<span data-ttu-id="3120d-126">I passaggi per stabilire una connessione tra un client e un oggetto collegabile sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="3120d-126">The steps for establishing a connection between a client and a connectable object are as follows:</span></span>

1.  <span data-ttu-id="3120d-127">Il client esegue una query per [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) sull'oggetto per determinare se l'oggetto è collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-127">The client queries for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) on the object to determine whether the object is connectable.</span></span> <span data-ttu-id="3120d-128">Se la chiamata ha esito positivo, il client contiene un puntatore all'interfaccia **IConnectionPointContainer** sull'oggetto collegabile e il contatore dei riferimenti agli oggetti collegabili è stato incrementato.</span><span class="sxs-lookup"><span data-stu-id="3120d-128">If this call is successful, the client holds a pointer to the **IConnectionPointContainer** interface on the connectable object and the connectable object reference counter has been incremented.</span></span> <span data-ttu-id="3120d-129">In caso contrario, l'oggetto non è collegabile e non supporta le interfacce in uscita.</span><span class="sxs-lookup"><span data-stu-id="3120d-129">Otherwise, the object is not connectable and does not support outgoing interfaces.</span></span>
2.  <span data-ttu-id="3120d-130">Se l'oggetto è collegabile, il client tenta di ottenere un puntatore all'interfaccia [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) su un punto di connessione all'interno dell'oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-130">If the object is connectable, the client next tries to obtain a pointer to the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface on a connection point within the connectable object.</span></span> <span data-ttu-id="3120d-131">Esistono due metodi per ottenere questo puntatore, sia in [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) che in [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="3120d-131">There are two methods for obtaining this pointer, both in [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) and in [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="3120d-132">Se si usa **EnumConnectionPoints** , è necessario eseguire alcuni passaggi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3120d-132">There are a few additional steps needed if **EnumConnectionPoints** is used.</span></span> <span data-ttu-id="3120d-133">Per ulteriori informazioni, vedere [utilizzo di IConnectionPointContainer](using-iconnectionpointcontainer.md) . In caso di esito positivo, l'oggetto collegabile e il client supportano entrambi la stessa interfaccia in uscita.</span><span class="sxs-lookup"><span data-stu-id="3120d-133">(See [Using IConnectionPointContainer](using-iconnectionpointcontainer.md) for more information.) If successful, the connectable object and the client both support the same outgoing interface.</span></span> <span data-ttu-id="3120d-134">L'oggetto collegabile lo definisce e lo chiama e il client lo implementa.</span><span class="sxs-lookup"><span data-stu-id="3120d-134">The connectable object defines it and calls it, and the client implements it.</span></span> <span data-ttu-id="3120d-135">Il client può quindi comunicare tramite il punto di connessione all'interno dell'oggetto collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-135">The client can then communicate through the connection point within the connectable object.</span></span>
3.  <span data-ttu-id="3120d-136">Il client chiama quindi [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) sul punto di connessione per stabilire una connessione tra l'interfaccia sink e il punto di connessione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="3120d-136">The client then calls [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) on the connection point to establish a connection between its sink interface and the object's connection point.</span></span> <span data-ttu-id="3120d-137">Dopo questa chiamata, il punto di connessione dell'oggetto include un puntatore all'interfaccia in uscita sul sink.</span><span class="sxs-lookup"><span data-stu-id="3120d-137">After this call, the object's connection point holds a pointer to the outgoing interface on the sink.</span></span>
4.  <span data-ttu-id="3120d-138">Il codice all'interno di [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) chiama [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) sul puntatore a interfaccia passato, richiedendo l'identificatore di interfaccia specifico a cui si connette.</span><span class="sxs-lookup"><span data-stu-id="3120d-138">The code inside [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) calls [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) on the interface pointer that is passed in, asking for the specific interface identifier to which it connects.</span></span>
5.  <span data-ttu-id="3120d-139">L'oggetto chiama i metodi sull'interfaccia del sink in base alle esigenze, usando il puntatore utilizzato dal punto di connessione.</span><span class="sxs-lookup"><span data-stu-id="3120d-139">The object calls methods on the sink's interface as needed, using the pointer held by its connection point.</span></span>
6.  <span data-ttu-id="3120d-140">Il client chiama [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) per terminare la connessione.</span><span class="sxs-lookup"><span data-stu-id="3120d-140">The client calls [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) to terminate the connection.</span></span> <span data-ttu-id="3120d-141">Il client chiama quindi **IConnectionPoint:: Release** per liberare il proprio punto di connessione e, pertanto, anche l'oggetto principale collegabile.</span><span class="sxs-lookup"><span data-stu-id="3120d-141">Then the client calls **IConnectionPoint::Release** to free its hold on the connection point and, therefore, the main connectable object also.</span></span> <span data-ttu-id="3120d-142">Il client deve inoltre chiamare **IConnectionPointContainer:: Release** per liberare il relativo oggetto in attesa sull'oggetto collegabile principale.</span><span class="sxs-lookup"><span data-stu-id="3120d-142">The client must also call **IConnectionPointContainer::Release** to free its hold on the main connectable object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3120d-143">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3120d-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3120d-144">Interfacce di oggetti collegabili</span><span class="sxs-lookup"><span data-stu-id="3120d-144">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




