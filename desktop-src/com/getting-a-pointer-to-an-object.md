---
title: Recupero di un puntatore a un oggetto
description: Recupero di un puntatore a un oggetto
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0476d36390e7077e7fdd75eef8d95e8173683891
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2020
ms.locfileid: "106299491"
---
# <a name="getting-a-pointer-to-an-object"></a><span data-ttu-id="29ce4-103">Recupero di un puntatore a un oggetto</span><span class="sxs-lookup"><span data-stu-id="29ce4-103">Getting a Pointer to an Object</span></span>

<span data-ttu-id="29ce4-104">Poiché COM non dispone di un modello di classe rigoroso, è possibile creare un'istanza di un client o ottenere un puntatore a un'interfaccia su un oggetto in quattro modi:</span><span class="sxs-lookup"><span data-stu-id="29ce4-104">Because COM does not have a strict class model, there are four ways that a client can instantiate or get a pointer to an interface on an object:</span></span>

-   <span data-ttu-id="29ce4-105">Chiamare una funzione della libreria COM che crea un oggetto di un tipo predeterminato; ovvero, la funzione restituirà un puntatore a una sola interfaccia specifica per una classe di oggetti specifica.</span><span class="sxs-lookup"><span data-stu-id="29ce4-105">Call a COM library function that creates an object of a predetermined type; that is, the function will return a pointer to only one specific interface for a specific object class.</span></span>
-   <span data-ttu-id="29ce4-106">Chiamare una funzione della libreria COM in grado di creare un oggetto basato su un identificatore di classe (CLSID) e che restituisce qualsiasi tipo di puntatore a interfaccia richiesto.</span><span class="sxs-lookup"><span data-stu-id="29ce4-106">Call a COM library function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</span></span>
-   <span data-ttu-id="29ce4-107">Chiamare un metodo di un'interfaccia che crea un altro oggetto (o si connette a un oggetto esistente) e restituisce un puntatore a interfaccia su tale oggetto separato.</span><span class="sxs-lookup"><span data-stu-id="29ce4-107">Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</span></span>
-   <span data-ttu-id="29ce4-108">Implementare un oggetto con un'interfaccia tramite la quale gli altri oggetti passano il puntatore di interfaccia direttamente al client.</span><span class="sxs-lookup"><span data-stu-id="29ce4-108">Implement an object with an interface through which other objects pass their interface pointer to the client directly.</span></span>

<span data-ttu-id="29ce4-109">Per informazioni su come ottenere i puntatori ad altre interfacce in un oggetto dopo averne il primo, vedere [QueryInterface: navigazione in un oggetto](queryinterface--navigating-in-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="29ce4-109">For information on getting pointers to other interfaces on an object after you have the first one, see [QueryInterface: Navigating in an Object](queryinterface--navigating-in-an-object.md).</span></span>

## <a name="creating-an-object-of-a-predetermined-type"></a><span data-ttu-id="29ce4-110">Creazione di un oggetto di un tipo predeterminato</span><span class="sxs-lookup"><span data-stu-id="29ce4-110">Creating an Object of a Predetermined Type</span></span>

<span data-ttu-id="29ce4-111">Sono disponibili numerose funzioni COM, ad esempio [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), che restituiscono puntatori a implementazioni specifiche dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="29ce4-111">There are numerous COM functions, such as [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), that return pointers to specific interface implementations.</span></span> <span data-ttu-id="29ce4-112">(**CoGetMalloc** recupera un puntatore all'allocatore di memoria com standard). La maggior parte di queste funzioni di supporto e la maggior parte di queste funzioni sono descritte nelle sezioni di riferimento di questa documentazione, nell'area specifica a cui sono correlate, ad esempio l'archiviazione o il trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="29ce4-112">(**CoGetMalloc** retrieves a pointer to the standard COM memory allocator.) Most of these are helper functions, and most of these functions are described in the reference sections of this documentation, under the specific area they are related to, such as storage or data transfer.</span></span>

## <a name="creating-an-object-based-on-a-clsid"></a><span data-ttu-id="29ce4-113">Creazione di un oggetto basato su un CLSID</span><span class="sxs-lookup"><span data-stu-id="29ce4-113">Creating an Object Based on a CLSID</span></span>

<span data-ttu-id="29ce4-114">Esistono diverse funzioni che, dato un CLSID, un client può chiamare per creare un'istanza dell'oggetto e ottenere un puntatore.</span><span class="sxs-lookup"><span data-stu-id="29ce4-114">There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it.</span></span> <span data-ttu-id="29ce4-115">Tutte queste funzioni sono basate sulla funzione [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), che crea un oggetto classe e fornisce un puntatore a un'interfaccia che consente di creare istanze di tale classe.</span><span class="sxs-lookup"><span data-stu-id="29ce4-115">All of these functions are based on the function [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which creates a class object and supplies a pointer to an interface that allows you to create instances of that class.</span></span> <span data-ttu-id="29ce4-116">Sebbene sia necessario disporre di informazioni sul sistema in cui risiede il server, non è necessario che tali informazioni siano contenute nel client.</span><span class="sxs-lookup"><span data-stu-id="29ce4-116">While there must be information that says which system the server resides on, there is no need for that information to be contained in the client.</span></span> <span data-ttu-id="29ce4-117">È necessario che il client conosca solo il CLSID e mai il percorso assoluto del codice server.</span><span class="sxs-lookup"><span data-stu-id="29ce4-117">The client needs to know only the CLSID and never the absolute path of the server code.</span></span> <span data-ttu-id="29ce4-118">Per ulteriori informazioni, vedere [creazione di un oggetto tramite un oggetto classe](creating-an-object-through-a-class-object.md).</span><span class="sxs-lookup"><span data-stu-id="29ce4-118">For more information, see [Creating an Object Through a Class Object](creating-an-object-through-a-class-object.md).</span></span>

## <a name="returning-a-pointer-to-a-separate-object"></a><span data-ttu-id="29ce4-119">Restituzione di un puntatore a un oggetto separato</span><span class="sxs-lookup"><span data-stu-id="29ce4-119">Returning a Pointer to a Separate Object</span></span>

<span data-ttu-id="29ce4-120">Tra i molti metodi di interfaccia che restituiscono un puntatore a un oggetto separato sono diversi che creano e restituiscono un puntatore a un *oggetto enumeratore*, che consente di determinare il numero di elementi di un determinato tipo mantenuto da un oggetto.</span><span class="sxs-lookup"><span data-stu-id="29ce4-120">Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an *enumerator object*, which allows you to determine how many items of a given type an object maintains.</span></span> <span data-ttu-id="29ce4-121">COM definisce le interfacce per l'enumerazione di un'ampia varietà di elementi, ad esempio stringhe, strutture importanti, moniker e puntatori di interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="29ce4-121">COM defines interfaces for enumerating a wide variety of items, such as strings, important structures, monikers, and [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointers.</span></span> <span data-ttu-id="29ce4-122">Il modo più comune per creare un'istanza di enumeratore e ottenere un puntatore alla relativa interfaccia consiste nel chiamare un metodo da un'altra interfaccia.</span><span class="sxs-lookup"><span data-stu-id="29ce4-122">The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface.</span></span> <span data-ttu-id="29ce4-123">L'interfaccia [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , ad esempio, definisce due metodi, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) e [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), che restituiscono puntatori a interfacce su due diversi oggetti di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="29ce4-123">For example, the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface defines two methods, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) and [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), that return pointers to interfaces on two different enumeration objects.</span></span> <span data-ttu-id="29ce4-124">Sono disponibili molti altri esempi in COM di metodi che restituiscono puntatori a oggetti, ad esempio l'interfaccia del documento composito OLE [**IOleObject:: GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), che, quando viene chiamato sull'oggetto incorporato o collegato, restituisce un puntatore all'implementazione dell'oggetto contenitore di [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span><span class="sxs-lookup"><span data-stu-id="29ce4-124">There are many other examples in COM of methods that return pointers to objects, such as the OLE compound document interface [**IOleObject::GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), which, when called on the embedded or linked object, returns a pointer to the container object's implementation of [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span></span>

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a><span data-ttu-id="29ce4-125">Implementazione di un oggetto tramite il quale passare un puntatore di interfaccia direttamente al client</span><span class="sxs-lookup"><span data-stu-id="29ce4-125">Implementing an Object Through Which to Pass an Interface Pointer Directly to the Client</span></span>

<span data-ttu-id="29ce4-126">Quando due oggetti, ad esempio un contenitore e un server di documenti compositi OLE, necessitano di comunicazione bidirezionale, ognuno implementa un oggetto contenente un metodo di interfaccia tramite il quale può passare un puntatore di interfaccia all'altro oggetto.</span><span class="sxs-lookup"><span data-stu-id="29ce4-126">When two objects, such as an OLE compound document container and server, need bidirectional communication, each implements an object containing an interface method through which it can pass an interface pointer to the other object.</span></span> <span data-ttu-id="29ce4-127">L'oggetto di implementazione, che è anche il client dell'oggetto creato, può quindi chiamare il metodo e ottenere il puntatore che è stato passato.</span><span class="sxs-lookup"><span data-stu-id="29ce4-127">The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="29ce4-128">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="29ce4-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="29ce4-129">Client e server COM</span><span class="sxs-lookup"><span data-stu-id="29ce4-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="29ce4-130">Responsabilità server COM</span><span class="sxs-lookup"><span data-stu-id="29ce4-130">COM Server Responsibilities</span></span>](com-server-responsibilities.md)
</dt> </dl>

 

 




