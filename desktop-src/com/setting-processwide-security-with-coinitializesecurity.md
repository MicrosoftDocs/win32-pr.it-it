---
title: Impostazione Process-Wide sicurezza con CoInitializeSecurity
description: La funzione CoInitializeSecurity consente di controllare scenari di sicurezza complessi impostando la sicurezza per un'applicazione a livello di codice.
ms.assetid: 20b66868-fb9a-489f-97a2-59a8a825c8d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 567a6dfaf47dbd278fc248558cd25969c733b24a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104399784"
---
# <a name="setting-process-wide-security-with-coinitializesecurity"></a><span data-ttu-id="43fc2-103">Impostazione Process-Wide sicurezza con CoInitializeSecurity</span><span class="sxs-lookup"><span data-stu-id="43fc2-103">Setting Process-Wide Security with CoInitializeSecurity</span></span>

<span data-ttu-id="43fc2-104">La funzione [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) consente di controllare scenari di sicurezza complessi impostando la sicurezza per un'applicazione a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="43fc2-104">The [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) function allows you to control complex security scenarios by setting security for an application programmatically.</span></span> <span data-ttu-id="43fc2-105">Questo argomento descrive gli scenari in cui è possibile usare **CoInitializeSecurity** e fornisce alcuni dettagli su come usarlo.</span><span class="sxs-lookup"><span data-stu-id="43fc2-105">This topic describes scenarios when you might use **CoInitializeSecurity** and provides some details on how you use it.</span></span>

<span data-ttu-id="43fc2-106">Esistono diversi motivi per cui è consigliabile usare [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) per impostare la sicurezza a livello di processo all'interno del programma.</span><span class="sxs-lookup"><span data-stu-id="43fc2-106">There are several reasons why you might want to use [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set process-wide security within your program.</span></span> <span data-ttu-id="43fc2-107">Ad esempio, anche se è possibile impostare il livello di autenticazione e le autorizzazioni di accesso per l'applicazione tramite dcomcnfg.exe, il livello di rappresentazione predefinito per il computer potrebbe non essere quello desiderato per il processo.</span><span class="sxs-lookup"><span data-stu-id="43fc2-107">For example, although you can set the authentication level and the access permissions for the application using dcomcnfg.exe, the default impersonation level for the computer might not be the one you want for your process.</span></span> <span data-ttu-id="43fc2-108">L'unico modo per modificare questa impostazione per il processo consiste nel chiamare **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="43fc2-108">The only way to change this setting for your process is to call **CoInitializeSecurity**.</span></span>

<span data-ttu-id="43fc2-109">Se si desidera utilizzare il provider di sicurezza Schannel, è necessario specificarlo come servizio di autenticazione in una chiamata a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span><span class="sxs-lookup"><span data-stu-id="43fc2-109">If you want to use the Schannel security provider, you must specify it as an authentication service in a call to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span></span>

<span data-ttu-id="43fc2-110">Un altro scenario comune in cui è possibile impostare la sicurezza a livello di processo a livello di programmazione è quando si desidera impostare la sicurezza predefinita per l'intero processo, ma si dispone di uno o più oggetti all'interno di tale processo che espongono interfacce con requisiti di sicurezza speciali.</span><span class="sxs-lookup"><span data-stu-id="43fc2-110">Another common scenario in which you might set process-wide security programmatically is when you would like to set default security for the entire process but you have one or more objects within that process that expose interfaces with special security requirements.</span></span> <span data-ttu-id="43fc2-111">In questo caso, è possibile chiamare [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) per impostare la sicurezza per il processo, consentendo a com di gestire la maggior parte dei controlli di sicurezza ed è possibile chiamare altri metodi per impostare la sicurezza per gli oggetti con particolari esigenze di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="43fc2-111">In this case, you can call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for the process, allowing COM to handle most of the security checks, and you can call other methods to set security for the objects with special security needs.</span></span> <span data-ttu-id="43fc2-112">La chiamata di questi metodi e funzioni è descritta in [impostazione della sicurezza a livello di proxy di interfaccia](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="43fc2-112">Calling these methods and functions is described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="43fc2-113">Se l'applicazione presenta requisiti di sicurezza molto specializzati, ad esempio consentendo a determinati gruppi di accedere a oggetti diversi a seconda dell'ora del giorno, potrebbe essere necessario gestire la sicurezza a livello di codice, assicurandosi che COM non esegue alcuna verifica automatica.</span><span class="sxs-lookup"><span data-stu-id="43fc2-113">If your application has very specialized security requirements, such as allowing certain groups access to different objects depending on the time of day, you might want to handle all of your security programmatically, ensuring that COM does no automatic checking for you at all.</span></span> <span data-ttu-id="43fc2-114">A tale scopo, è necessario chiamare [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), impostando il parametro *dwAuthnLevel* su None e il parametro *PVOID* su **null**.</span><span class="sxs-lookup"><span data-stu-id="43fc2-114">To do this, you must call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), setting the *dwAuthnLevel* parameter to none and the *pVoid* parameter to **NULL**.</span></span> <span data-ttu-id="43fc2-115">Se si dispone di un pacchetto di sicurezza personalizzato, è necessario registrarlo anche nel parametro *pAuthnSvc* .</span><span class="sxs-lookup"><span data-stu-id="43fc2-115">If you have your own security package you would also need to register it in the *pAuthnSvc* parameter.</span></span> <span data-ttu-id="43fc2-116">È quindi possibile gestire tutta la propria sicurezza a livello di codice tramite chiamate all'interfaccia a livello di proxy e funzioni descritte in [impostazione della sicurezza a livello di proxy di interfaccia](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="43fc2-116">Then you can handle all of your own security programmatically through calls to the proxy-level interface and functions described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="43fc2-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offre un set completo di funzionalità.</span><span class="sxs-lookup"><span data-stu-id="43fc2-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offers a rich set of capabilities.</span></span> <span data-ttu-id="43fc2-118">Se si chiama **CoInitializeSecurity**, i valori del registro di sistema vengono ignorati e vengono invece usati i valori di inizializzazione di sicurezza passati alla chiamata.</span><span class="sxs-lookup"><span data-stu-id="43fc2-118">If you call **CoInitializeSecurity**, the registry values are ignored and the security initialization values you pass in to the call are used instead.</span></span> <span data-ttu-id="43fc2-119">A seconda del risultato desiderato, il primo parametro, *PVOID*, può puntare a tre tipi diversi di valori: un [**\_ descrittore di sicurezza**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , un oggetto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) o un puntatore a un AppID.</span><span class="sxs-lookup"><span data-stu-id="43fc2-119">Depending on the result you want, the first parameter, *pVoid*, can point to three different types of values: a [**SECURITY\_DESCRIPTOR**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object, or a pointer to an AppID.</span></span> <span data-ttu-id="43fc2-120">Nella maggior parte dei casi, si utilizzeranno le funzioni di Windows per creare un **\_ descrittore di sicurezza** a cui punterà *PVOID* .</span><span class="sxs-lookup"><span data-stu-id="43fc2-120">In most cases, you will use Windows functions to create a **SECURITY\_DESCRIPTOR** that *pVoid* will point to.</span></span>

<span data-ttu-id="43fc2-121">Tuttavia, *PVOID* può puntare anche a un oggetto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) .</span><span class="sxs-lookup"><span data-stu-id="43fc2-121">However, *pVoid* can also point to an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object.</span></span>

<span data-ttu-id="43fc2-122">Per indicare a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) che si sta passando un oggetto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) a *PVOID*, è necessario passare il \_ \_ valore di controllo di accesso EOAC al parametro *dwCapabilities* .</span><span class="sxs-lookup"><span data-stu-id="43fc2-122">To indicate to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) that you are passing an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object to *pVoid*, you must pass the EOAC\_ACCESS\_CONTROL value to the *dwCapabilities* parameter.</span></span> <span data-ttu-id="43fc2-123">Poiché **CoInitializeSecurity** memorizza nella cache i risultati dei controlli di accesso, l'elenco di controllo di accesso non deve essere modificato dopo aver chiamato **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="43fc2-123">Since **CoInitializeSecurity** caches the results of access checks, the access control list must not be changed after calling **CoInitializeSecurity**.</span></span>

<span data-ttu-id="43fc2-124">Un altro tipo di valore che è possibile passare al parametro *PVOID* è un puntatore a un GUID, ovvero l'AppID dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="43fc2-124">Another type of value you can pass to the *pVoid* parameter is a pointer to a GUID, which is the AppID of your application.</span></span> <span data-ttu-id="43fc2-125">Se *PVOID* è un puntatore a un AppID, è necessario specificare EOAC \_ AppID nel parametro *pCapabilities* in modo che la funzione sappia quale valore prevedere in *PVOID*.</span><span class="sxs-lookup"><span data-stu-id="43fc2-125">If *pVoid* is a pointer to an AppID, you must specify EOAC\_APPID in the *pCapabilities* parameter so that the function knows what value to expect in *pVoid*.</span></span> <span data-ttu-id="43fc2-126">Se *PVOID* punta a un AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) usa solo il registro di sistema per i valori di autenticazione e ignora tutti gli altri parametri in **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="43fc2-126">If *pVoid* points to an AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) uses only the registry for authentication values and ignores all other parameters to **CoInitializeSecurity**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="43fc2-127">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="43fc2-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="43fc2-128">Impostazione della sicurezza Process-Wide</span><span class="sxs-lookup"><span data-stu-id="43fc2-128">Setting Process-Wide Security</span></span>](setting-processwide-security.md)
</dt> </dl>

 

 