---
title: Oggetti classe COM e CLSID
description: Un server COM viene implementato come classe COM.
ms.assetid: 0073acdf-38a8-4f1a-aa26-379456a95fca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1bbfde2f379c4c7589db4cde283c8c67d720b21d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "106300549"
---
# <a name="com-class-objects-and-clsids"></a><span data-ttu-id="ad908-103">Oggetti classe COM e CLSID</span><span class="sxs-lookup"><span data-stu-id="ad908-103">COM Class Objects and CLSIDs</span></span>

<span data-ttu-id="ad908-104">Un server COM viene implementato come classe COM.</span><span class="sxs-lookup"><span data-stu-id="ad908-104">A COM server is implemented as a COM class.</span></span> <span data-ttu-id="ad908-105">Una *classe com* è un'implementazione di un gruppo di interfacce nel codice eseguito quando si interagisce con un oggetto specificato.</span><span class="sxs-lookup"><span data-stu-id="ad908-105">A *COM class* is an implementation of a group of interfaces in code executed whenever you interact with a given object.</span></span> <span data-ttu-id="ad908-106">Esiste una differenza importante tra una classe C++ e una classe COM: in C++, una classe è un tipo, mentre una classe COM è semplicemente una definizione dell'oggetto e non contiene alcun tipo, sebbene un programmatore C++ possa implementarlo utilizzando una classe C++.</span><span class="sxs-lookup"><span data-stu-id="ad908-106">There is an important distinction between a C++ class and a COM class: In C++, a class is a type, while a COM class is simply a definition of the object and carries no type, although a C++ programmer might implement it by using a C++ class.</span></span> <span data-ttu-id="ad908-107">COM è progettato per consentire l'utilizzo di una classe da applicazioni diverse, incluse le applicazioni scritte senza conoscere l'esistenza di tale classe.</span><span class="sxs-lookup"><span data-stu-id="ad908-107">COM is designed to allow a class to be used by different applications, including applications written without knowledge of that particular class's existence.</span></span> <span data-ttu-id="ad908-108">Pertanto, il codice della classe per un determinato tipo di oggetto esiste in una libreria collegata dinamica (DLL) o in un'altra applicazione eseguibile (EXE).</span><span class="sxs-lookup"><span data-stu-id="ad908-108">Therefore, class code for a given type of object exists either in a dynamic linked library (DLL) or in another executable application (EXE).</span></span>

<span data-ttu-id="ad908-109">Ogni classe COM è identificata da un *CLSID*, un GUID univoco a 128 bit, che deve essere registrato dal server.</span><span class="sxs-lookup"><span data-stu-id="ad908-109">Each COM class is identified by a *CLSID*, a unique 128-bit GUID, which the server must register.</span></span> <span data-ttu-id="ad908-110">COM utilizza questo CLSID, alla richiesta di un client, per associare dati specifici alla DLL o al file EXE contenente il codice che implementa la classe, creando in tal modo un'istanza dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="ad908-110">COM uses this CLSID, at the request of a client, to associate specific data with the DLL or EXE containing the code that implements the class, thus creating an instance of the object.</span></span>

<span data-ttu-id="ad908-111">Per i client e i server nello stesso computer, il CLSID del server è sempre necessario per il client.</span><span class="sxs-lookup"><span data-stu-id="ad908-111">For clients and servers on the same computer, the CLSID of the server is all the client ever needs.</span></span> <span data-ttu-id="ad908-112">In ogni computer, COM gestisce un database, ovvero utilizza il registro di sistema nelle piattaforme Microsoft Windows e Macintosh, di tutti i CLSID per i server installati nel sistema.</span><span class="sxs-lookup"><span data-stu-id="ad908-112">On each computer, COM maintains a database (it makes use of the system registry on Microsoft Windows and Macintosh platforms) of all the CLSIDs for the servers installed on the system.</span></span> <span data-ttu-id="ad908-113">Si tratta di un mapping tra ogni CLSID e il percorso della DLL o del file EXE che ospita il codice per il CLSID.</span><span class="sxs-lookup"><span data-stu-id="ad908-113">This is a mapping between each CLSID and the location of the DLL or EXE that houses the code for that CLSID.</span></span> <span data-ttu-id="ad908-114">COM consulta questo database ogni volta che un client desidera creare un'istanza di una classe COM e utilizzarne i servizi, in modo che il client non debba mai conoscere il percorso assoluto del codice nel computer.</span><span class="sxs-lookup"><span data-stu-id="ad908-114">COM consults this database whenever a client wants to create an instance of a COM class and use its services, so the client never needs to know the absolute location of the code on the computer.</span></span>

<span data-ttu-id="ad908-115">Per i sistemi distribuiti, COM fornisce voci del registro di sistema che consentono a un server remoto di registrarsi per l'uso da un client.</span><span class="sxs-lookup"><span data-stu-id="ad908-115">For distributed systems, COM provides registry entries that allow a remote server to register itself for use by a client.</span></span> <span data-ttu-id="ad908-116">Sebbene sia necessario che le applicazioni conoscano solo il CLSID di un server, perché possono basarsi sul Registro di sistema per individuare il server, COM consente ai client di eseguire l'override delle voci del registro di sistema e di specificare i percorsi del server, per sfruttare al meglio la rete.</span><span class="sxs-lookup"><span data-stu-id="ad908-116">While applications need know only a server's CLSID, because they can rely on the registry to locate the server, COM allows clients to override registry entries and to specify server locations, to take full advantage of the network.</span></span> <span data-ttu-id="ad908-117">Vedere [individuazione di un oggetto remoto](locating-a-remote-object.md).</span><span class="sxs-lookup"><span data-stu-id="ad908-117">(See [Locating a Remote Object](locating-a-remote-object.md).)</span></span>

<span data-ttu-id="ad908-118">Il modo più semplice per creare un'istanza di una classe consiste nell'usare un *oggetto classe* com.</span><span class="sxs-lookup"><span data-stu-id="ad908-118">The basic way to create an instance of a class is through a COM *class object*.</span></span> <span data-ttu-id="ad908-119">Si tratta semplicemente di un oggetto intermedio che supporta funzioni comuni alla creazione di nuove istanze di una determinata classe.</span><span class="sxs-lookup"><span data-stu-id="ad908-119">This is simply an intermediate object that supports functions common to creating new instances of a given class.</span></span> <span data-ttu-id="ad908-120">La maggior parte degli oggetti classe utilizzati per creare oggetti da un CLSID supporta l'interfaccia [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , un'interfaccia che include il metodo [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) importante.</span><span class="sxs-lookup"><span data-stu-id="ad908-120">Most class objects used to create objects from a CLSID support the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, an interface that includes the important [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method.</span></span> <span data-ttu-id="ad908-121">Si implementa un'interfaccia **IClassFactory** per ogni classe di oggetto offerta per la creazione di un'istanza.</span><span class="sxs-lookup"><span data-stu-id="ad908-121">You implement an **IClassFactory** interface for each class of object that you offer to be instantiated.</span></span> <span data-ttu-id="ad908-122">Per ulteriori informazioni sull'implementazione di **IClassFactory**, vedere [Implementing IClassFactory](implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="ad908-122">(For more information about implementing **IClassFactory**, see [Implementing IClassFactory](implementing-iclassfactory.md).)</span></span>

> [!Note]  
> <span data-ttu-id="ad908-123">I server che supportano alcune altre interfacce di class factory personalizzate non devono supportare [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) in modo specifico.</span><span class="sxs-lookup"><span data-stu-id="ad908-123">Servers that support some other custom class factory interface are not required to support [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) specifically.</span></span> <span data-ttu-id="ad908-124">Tuttavia, le chiamate alle funzioni di attivazione diverse da [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (ad esempio [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) richiedono che il server supporti **IClassFactory**.</span><span class="sxs-lookup"><span data-stu-id="ad908-124">However, calls to activation functions other than [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (such as [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) require that the server support **IClassFactory**.</span></span>

 

<span data-ttu-id="ad908-125">Quando un client vuole creare un'istanza dell'oggetto del server, usa il CLSID dell'oggetto desiderato in una chiamata a [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span><span class="sxs-lookup"><span data-stu-id="ad908-125">When a client wants to create an instance of the server's object, it uses the desired object's CLSID in a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span></span> <span data-ttu-id="ad908-126">Questa chiamata può essere diretta o implicita tramite una delle funzioni di supporto per la creazione di oggetti. Questa funzione individua il codice associato al CLSID e crea un oggetto classe e fornisce un puntatore all'interfaccia richiesta.</span><span class="sxs-lookup"><span data-stu-id="ad908-126">(This call can be either direct or implicit, through one of the object creation helper functions.) This function locates the code associated with the CLSID, and creates a class object, and supplies a pointer to the interface requested.</span></span> <span data-ttu-id="ad908-127">(**CoGetClassObject** accetta un parametro *riid* che specifica il puntatore a interfaccia desiderato del client).</span><span class="sxs-lookup"><span data-stu-id="ad908-127">(**CoGetClassObject** takes a *riid* param that specifies the client's desired interface pointer.)</span></span>

> [!Note]  
> <span data-ttu-id="ad908-128">COM dispone solo di alcune funzioni sulle quali sono state compilate molte altre.</span><span class="sxs-lookup"><span data-stu-id="ad908-128">COM has just a few functions upon which many of the others are built.</span></span> <span data-ttu-id="ad908-129">Il più importante di questi è probabilmente [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), che si basa su tutte le funzioni di creazione dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="ad908-129">The most important of these is probably [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which underlies all of the instance creation functions.</span></span>

 

<span data-ttu-id="ad908-130">Con questo puntatore, il chiamante può creare un'istanza dell'oggetto e recuperare un puntatore a un'interfaccia richiesta nell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="ad908-130">With this pointer, the caller can create an instance of the object and retrieve a pointer to a requested interface on the object.</span></span> <span data-ttu-id="ad908-131">Si tratta in genere di un'interfaccia di inizializzazione, usata per attivare l'oggetto (inserirlo nello stato di esecuzione), in modo che il client possa eseguire qualsiasi operazione con l'oggetto desiderato.</span><span class="sxs-lookup"><span data-stu-id="ad908-131">This is usually an initialization interface, used to activate the object (put it in the running state) so that the client can do whatever work with the object that it wants to.</span></span> <span data-ttu-id="ad908-132">Utilizzando le funzioni di base di COM, il client deve inoltre prestare attenzione a rilasciare tutti i puntatori a oggetti.</span><span class="sxs-lookup"><span data-stu-id="ad908-132">Using COM's basic functions, the client must also take care to release all object pointers.</span></span>

<span data-ttu-id="ad908-133">Un altro meccanismo per attivare le istanze degli oggetti è tramite il moniker della classe.</span><span class="sxs-lookup"><span data-stu-id="ad908-133">Another mechanism for activating object instances is through the class moniker.</span></span> <span data-ttu-id="ad908-134">I moniker della classe sono associati all'oggetto classe della classe per cui sono stati creati.</span><span class="sxs-lookup"><span data-stu-id="ad908-134">Class monikers bind to the class object of the class for which they are created.</span></span> <span data-ttu-id="ad908-135">Per ulteriori informazioni, vedere [moniker della classe](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="ad908-135">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="ad908-136">COM fornisce diverse funzioni helper che consentono di ridurre il lavoro di creazione di istanze di oggetti.</span><span class="sxs-lookup"><span data-stu-id="ad908-136">COM provides several helper functions that reduce the work of creating object instances.</span></span> <span data-ttu-id="ad908-137">Questi sono descritti in [funzioni helper](instance-creation-helper-functions.md)per la creazione di istanze.</span><span class="sxs-lookup"><span data-stu-id="ad908-137">These are described in [Instance Creation Helper Functions](instance-creation-helper-functions.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ad908-138">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="ad908-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ad908-139">Creazione di un oggetto tramite un oggetto classe</span><span class="sxs-lookup"><span data-stu-id="ad908-139">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 