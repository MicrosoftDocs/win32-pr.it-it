---
title: Visualizza Caching
description: Visualizza Caching
ms.assetid: d19c111c-1367-43a2-97a9-35dc0ff5dcc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 592c5bc2555e907cdc4e600465b807387c3a5548
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104399756"
---
# <a name="view-caching"></a><span data-ttu-id="cc501-103">Visualizza Caching</span><span class="sxs-lookup"><span data-stu-id="cc501-103">View Caching</span></span>

<span data-ttu-id="cc501-104">Un'applicazione contenitore deve essere in grado di ottenere una presentazione di un oggetto allo scopo di visualizzarlo o stamparlo per gli utenti quando il documento è aperto, ma l'applicazione server dell'oggetto non è in esecuzione o non è installata nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="cc501-104">A container application must be able to obtain a presentation of an object for the purpose of displaying or printing it for users when the document is open but the object's server application is not running or is not installed on the user's machine.</span></span> <span data-ttu-id="cc501-105">Per presupporre, tuttavia, che i server di tutti gli oggetti che potrebbero essere presenti in un documento siano installati nel computer di ogni utente e che possa sempre essere eseguito su richiesta non è realistico.</span><span class="sxs-lookup"><span data-stu-id="cc501-105">To assume, however, that the servers for all the objects that might conceivably be found in a document are installed on every user's machine and can always run on demand is unrealistic.</span></span> <span data-ttu-id="cc501-106">Il gestore di oggetti predefinito, disponibile in qualsiasi momento, risolve questo dilemma memorizzando nella cache le presentazioni degli oggetti nell'archivio del documento e modificando queste presentazioni su qualsiasi piattaforma indipendentemente dalla disponibilità del server oggetti in una particolare installazione del contenitore.</span><span class="sxs-lookup"><span data-stu-id="cc501-106">The default object handler, which is available at all times, solves this dilemma by caching object presentations in the document's storage and manipulating these presentations on any platform regardless of the availablility of the object server on any particular installation of the container.</span></span>

<span data-ttu-id="cc501-107">I contenitori possono mantenere le presentazioni di disegno per uno o più dispositivi di destinazione specifici, oltre a quello necessario per gestire l'oggetto sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="cc501-107">Containers can maintain drawing presentations for one or more specific target devices in addition to the one required to maintain the object on screen.</span></span> <span data-ttu-id="cc501-108">Inoltre, se si trasferisce l'oggetto da una piattaforma a un'altra, OLE converte automaticamente i formati di dati dell'oggetto in quelli supportati nella nuova piattaforma.</span><span class="sxs-lookup"><span data-stu-id="cc501-108">Moreover, if you port the object from one platform to another, OLE automatically converts the object's data formats to ones supported on the new platform.</span></span> <span data-ttu-id="cc501-109">Se, ad esempio, si sposta un oggetto da Windows a Macintosh, OLE convertirà le presentazioni metafile in formati PICT.</span><span class="sxs-lookup"><span data-stu-id="cc501-109">For example, if you move an object from Windows to the Macintosh, OLE will convert its metafile presentations to PICT formats.</span></span>

<span data-ttu-id="cc501-110">Per presentare all'utente una rappresentazione accurata di un oggetto incorporato, l'applicazione contenitore dell'oggetto avvia una finestra di dialogo con il gestore dell'oggetto, richiedendo i dati e le istruzioni di disegno.</span><span class="sxs-lookup"><span data-stu-id="cc501-110">In order to present an accurate representation of an embedded object to the user, the object's container application initiates a dialog with the object handler, requesting data and drawing instructions.</span></span> <span data-ttu-id="cc501-111">Per essere in grado di soddisfare le richieste del contenitore, il gestore deve implementare le interfacce [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)e [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) .</span><span class="sxs-lookup"><span data-stu-id="cc501-111">To be able to fulfill the container's requests, the handler must implement the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interfaces.</span></span>

<span data-ttu-id="cc501-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) consente a un'applicazione contenitore OLE di recuperare e inviare dati ai relativi oggetti incorporati o collegati.</span><span class="sxs-lookup"><span data-stu-id="cc501-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) enables an OLE container application to get data from and send data to its embedded or linked objects.</span></span> <span data-ttu-id="cc501-113">Quando i dati vengono modificati in un oggetto, questa interfaccia fornisce un modo per rendere disponibili i nuovi dati al contenitore da parte dell'oggetto e fornisce al contenitore un modo per aggiornare i dati nella relativa copia dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cc501-113">When data changes in an object, this interface provides a way for the object to make its new data available to its container and provides the container with a way to update the data in its copy of the object.</span></span> <span data-ttu-id="cc501-114">Per informazioni generali sul trasferimento dei dati, vedere il capitolo 4 Trasferimento dati.</span><span class="sxs-lookup"><span data-stu-id="cc501-114">(For a discussion of data transfer in general, see Chapter 4, Data Transfer.)</span></span>

<span data-ttu-id="cc501-115">L'interfaccia [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) è molto simile all'interfaccia [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) con la differenza che richiede a un oggetto di disegnarsi in un contesto di dispositivo, ad esempio una schermata, una stampante o un metafile, anziché spostare o copiare i dati in memoria o in un altro supporto di trasferimento.</span><span class="sxs-lookup"><span data-stu-id="cc501-115">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is very much like the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface except that it asks an object to draw itself on a device context, such as a screen, printer, or metafile, rather than move or copy its data to memory or some other transfer medium.</span></span> <span data-ttu-id="cc501-116">Lo scopo dell'interfaccia è quello di consentire a un contenitore OLE di ottenere rappresentazioni pittoriche alternative degli oggetti incorporati, i cui dati sono già presenti, evitando così il sovraccarico dovuto alla necessità di trasferire le istanze completamente nuove degli stessi oggetti dati semplicemente per ottenere nuove istruzioni di disegno.</span><span class="sxs-lookup"><span data-stu-id="cc501-116">The purpose of the interface is to enable an OLE container to obtain alternative pictorial representations of its embedded objects, whose data it already has, thereby avoiding the overhead of having to transfer entirely new instances of the same data objects simply to obtain new drawing instructions.</span></span> <span data-ttu-id="cc501-117">Al contrario, l'interfaccia **IViewObject2** consente al contenitore di richiedere a un oggetto di fornire una rappresentazione pittorica di se stesso disegnando in un contesto di dispositivo specificato dal contenitore.</span><span class="sxs-lookup"><span data-stu-id="cc501-117">Instead, the **IViewObject2** interface enables the container to ask an object to provide a pictorial representation of itself by drawing on a device context specified by the container.</span></span>

<span data-ttu-id="cc501-118">Quando si chiama l'interfaccia [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) , un'applicazione contenitore può anche specificare che l'oggetto si disegna in un dispositivo di destinazione diverso da quello in cui verrà effettivamente eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="cc501-118">When calling the [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface, a container application can also specify that the object draw itself on a target device different than the one on which it will actually be rendered.</span></span> <span data-ttu-id="cc501-119">In questo modo il contenitore, se necessario, consente di generare rendering diversi da un singolo oggetto.</span><span class="sxs-lookup"><span data-stu-id="cc501-119">This enables the container, as needed, to generate different renderings from a single object.</span></span> <span data-ttu-id="cc501-120">Ad esempio, il chiamante potrebbe chiedere all'oggetto di comporre se stesso per una stampante anche se il disegno risultante verrà visualizzato sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="cc501-120">For example, the caller could ask the object to compose itself for a printer even though the resulting drawing will be rendered on screen.</span></span> <span data-ttu-id="cc501-121">Il risultato, ovviamente, sarebbe un'anteprima di stampa dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cc501-121">The result, of course, would be a print-preview of the object.</span></span>

<span data-ttu-id="cc501-122">L'interfaccia [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)fornisce anche metodi che consentono ai contenitori di registrarsi per le notifiche di modifica della visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc501-122">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface also provides methods that enable containers to register for view-change notifications.</span></span> <span data-ttu-id="cc501-123">Come per i dati e gli avvisi OLE, una connessione di avviso di visualizzazione consente a un contenitore di aggiornare i rendering di un oggetto in base alla propria convenienza piuttosto che in risposta a una chiamata dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cc501-123">As with data and OLE advisories, a view advisory connection enables a container to update its renderings of an object at its own convenience rather than in response to a call from the object.</span></span> <span data-ttu-id="cc501-124">Se, ad esempio, una nuova versione dell'applicazione server di un oggetto è stata in grado di offrire visualizzazioni aggiuntive degli stessi dati, il gestore predefinito dell'oggetto chiamerebbe l'implementazione di [**IAdviseSink:: OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) di ogni contenitore per indicare che le nuove presentazioni erano disponibili.</span><span class="sxs-lookup"><span data-stu-id="cc501-124">For example, if a new version of an object's server application were to offer additional views of the same data, the object's default handler would call each container's implementation of [**IAdviseSink::OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) to let them know that the new presentations were available.</span></span> <span data-ttu-id="cc501-125">Il contenitore recupera queste informazioni dal sink di notifica solo quando necessario.</span><span class="sxs-lookup"><span data-stu-id="cc501-125">The container would retrieve this information from the advise sink only when needed.</span></span>

<span data-ttu-id="cc501-126">Poiché i contesti di dispositivo Windows hanno un significato solo all'interno di un singolo processo, non è possibile passare i puntatori [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) tra i limiti dei processi.</span><span class="sxs-lookup"><span data-stu-id="cc501-126">Because Windows device contexts have meaning only within a single process, you cannot pass [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) pointers across process boundaries.</span></span> <span data-ttu-id="cc501-127">Di conseguenza, i server OLE locali e remoti non necessitano di alcun tipo di implementazione dell'interfaccia, che non funzionerebbe correttamente anche in caso affermativo.</span><span class="sxs-lookup"><span data-stu-id="cc501-127">As a result, OLE local and remote servers have no need whatsoever to implement the interface, which wouldn't work properly even if they did.</span></span> <span data-ttu-id="cc501-128">Solo i gestori di oggetti e i server in-process implementano l'interfaccia **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="cc501-128">Only object handlers and in-process servers implement the **IViewObject2** interface.</span></span> <span data-ttu-id="cc501-129">OLE fornisce un'implementazione predefinita, che è possibile utilizzare nei propri server OLE in-process e gestori di oggetti semplicemente aggregando il gestore predefinito OLE.</span><span class="sxs-lookup"><span data-stu-id="cc501-129">OLE provides a default implementation, which you can use in your own OLE in-process servers and object handlers simply by aggregating the OLE default handler.</span></span> <span data-ttu-id="cc501-130">In alternativa, è possibile scrivere un'implementazione personalizzata di **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="cc501-130">Or you can write your own implementation of **IViewObject2**.</span></span>

<span data-ttu-id="cc501-131">Un oggetto implementa l'interfaccia [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) per consentire al gestore di conoscere le funzionalità che deve memorizzare nella cache.</span><span class="sxs-lookup"><span data-stu-id="cc501-131">An object implements the [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interface in order to let the handler know what capabilities it should cache.</span></span> <span data-ttu-id="cc501-132">Il gestore dell'oggetto possiede inoltre la cache e ne garantisce l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="cc501-132">The object handler also owns the cache and ensures it is kept up to date.</span></span> <span data-ttu-id="cc501-133">Quando l'oggetto incorporato entra nello stato in esecuzione, il gestore imposta le connessioni consultive appropriate sull'oggetto server, che funge da sink.</span><span class="sxs-lookup"><span data-stu-id="cc501-133">As the embedded object enters the running state, the handler sets up appropriate advisory connections on the server object, with itself acting as the sink.</span></span> <span data-ttu-id="cc501-134">Le implementazioni dell'interfaccia [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)operano all'esterno dei dati memorizzati nella cache sul lato client.</span><span class="sxs-lookup"><span data-stu-id="cc501-134">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface implementations operate out of data cached on the client side.</span></span> <span data-ttu-id="cc501-135">L'implementazione del gestore di **IViewObject2** è responsabile della determinazione dei formati di dati da memorizzare nella cache per soddisfare le richieste di creazione del client.</span><span class="sxs-lookup"><span data-stu-id="cc501-135">The handler's implementation of **IViewObject2** is responsible for determining what data formats to cache in order to satisfy client draw requests.</span></span> <span data-ttu-id="cc501-136">L'implementazione del gestore di **IDataObject** è responsabile del recupero dei dati in vari formati e così via tra la memoria e l'istanza [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) sottostante dell'oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="cc501-136">The handler's implementation of **IDataObject** is responsible for getting data in various formats, etc., between memory and the underlying [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance of the embedded object.</span></span> <span data-ttu-id="cc501-137">I gestori personalizzati possono usare queste implementazioni aggregando il gestore predefinito.</span><span class="sxs-lookup"><span data-stu-id="cc501-137">Custom handlers can use these implementations by aggregating on the default handler.</span></span>

> [!Note]  
> <span data-ttu-id="cc501-138">L'interfaccia [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) è un'estensione funzionale semplice di [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) e deve essere implementata al posto della seconda interfaccia, che ora è obsoleta.</span><span class="sxs-lookup"><span data-stu-id="cc501-138">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is a simple functional extension of [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) and should be implemented instead of the latter interface, which is now obsolete.</span></span> <span data-ttu-id="cc501-139">Oltre a fornire i metodi **IViewObject** , l'interfaccia **IViewObject2** fornisce un singolo membro aggiuntivo, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), che consente a un'applicazione contenitore di ottenere le dimensioni della presentazione di un oggetto dalla cache senza dover prima spostare l'oggetto nello stato in esecuzione con una chiamata a [**IOleObject:: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span><span class="sxs-lookup"><span data-stu-id="cc501-139">In addition to providing the **IViewObject** methods, the **IViewObject2** interface provides a single additional member, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), which enables a container application to get the size of an object's presentation from the cache without first having to move the object into the running state with a call to [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="cc501-140">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cc501-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cc501-141">Documenti composti</span><span class="sxs-lookup"><span data-stu-id="cc501-141">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 