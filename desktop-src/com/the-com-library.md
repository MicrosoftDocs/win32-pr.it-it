---
title: Libreria COM
description: Libreria COM
ms.assetid: 51d4db4a-ad88-4627-8140-2f7906945752
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a285a89ca659907c37f92b7d00f3e3e04d0acf51
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/06/2020
ms.locfileid: "103956249"
---
# <a name="the-com-library"></a><span data-ttu-id="02890-103">Libreria COM</span><span class="sxs-lookup"><span data-stu-id="02890-103">The COM Library</span></span>

<span data-ttu-id="02890-104">Qualsiasi processo che utilizza COM deve inizializzare e annullare l'inizializzazione della libreria COM.</span><span class="sxs-lookup"><span data-stu-id="02890-104">Any process that uses COM must both initialize and uninitialize the COM library.</span></span> <span data-ttu-id="02890-105">Oltre a essere una specifica, COM implementa anche alcuni servizi importanti in questa libreria.</span><span class="sxs-lookup"><span data-stu-id="02890-105">In addition to being a specification, COM also implements some important services in this library.</span></span> <span data-ttu-id="02890-106">Fornito come set di dll ed exe (principalmente Ole32.dll e Rpcss.exe) in Microsoft Windows, la libreria COM include quanto segue:</span><span class="sxs-lookup"><span data-stu-id="02890-106">Provided as a set of DLLs and EXEs (primarily Ole32.dll and Rpcss.exe) in Microsoft Windows, the COM library includes the following:</span></span>

-   <span data-ttu-id="02890-107">Un numero ridotto di funzioni fondamentali che semplificano la creazione di applicazioni COM, sia client che server.</span><span class="sxs-lookup"><span data-stu-id="02890-107">A small number of fundamental functions that facilitate the creation of COM applications, both client and server.</span></span> <span data-ttu-id="02890-108">Per i client, COM fornisce funzioni di base per la creazione di oggetti.</span><span class="sxs-lookup"><span data-stu-id="02890-108">For clients, COM supplies basic functions for creating objects.</span></span> <span data-ttu-id="02890-109">Per i server, COM fornisce i mezzi per esporre i relativi oggetti.</span><span class="sxs-lookup"><span data-stu-id="02890-109">For servers, COM supplies the means of exposing their objects.</span></span>

-   <span data-ttu-id="02890-110">Implementazione-servizi del localizzatore tramite cui COM determina, da un identificatore di classe univoco (CLSID), il server che implementa la classe e la posizione in cui si trova il server.</span><span class="sxs-lookup"><span data-stu-id="02890-110">Implementation-locator services through which COM determines, from a unique class identifier (CLSID), which server implements that class and where that server is located.</span></span> <span data-ttu-id="02890-111">Questo servizio include il supporto per un livello di riferimento indiretto, in genere un registro di sistema, tra l'identità di una classe di oggetti e la creazione di pacchetti dell'implementazione in modo che i client siano indipendenti dalla creazione di pacchetti, che può cambiare in futuro.</span><span class="sxs-lookup"><span data-stu-id="02890-111">This service includes support for a level of indirection, usually a system registry, between the identity of an object class and the packaging of the implementation so that clients are independent of the packaging, which can change in the future.</span></span>

-   <span data-ttu-id="02890-112">Chiamate di procedure remote trasparenti quando un oggetto è in esecuzione in un server locale o remoto.</span><span class="sxs-lookup"><span data-stu-id="02890-112">Transparent remote procedure calls when an object is running in a local or remote server.</span></span>

-   <span data-ttu-id="02890-113">Meccanismo standard per consentire a un'applicazione di controllare la modalità di allocazione della memoria all'interno del processo, in particolare la memoria che deve essere passata tra oggetti cooperanti in modo che possa essere liberata correttamente.</span><span class="sxs-lookup"><span data-stu-id="02890-113">A standard mechanism to allow an application to control how memory is allocated within its process, particularly memory that needs to be passed between cooperating objects so that it can be freed properly.</span></span>

<span data-ttu-id="02890-114">Per usare i servizi COM di base, tutti i thread COM di esecuzione nei client e nei server out-of-process devono chiamare la funzione [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) prima di chiamare qualsiasi altra funzione com eccetto le chiamate di allocazione di memoria.</span><span class="sxs-lookup"><span data-stu-id="02890-114">To use basic COM services, all COM threads of execution in clients and out-of-process servers must call either the [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or the [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) function before calling any other COM function except memory allocation calls.</span></span> <span data-ttu-id="02890-115">**CoInitializeEx** sostituisce l'altra funzione, aggiungendo un parametro che consente di specificare il modello di threading del thread, ovvero con threading Apartment o a thread libero.</span><span class="sxs-lookup"><span data-stu-id="02890-115">**CoInitializeEx** replaces the other function, adding a parameter that allows you to specify the threading model of the thread: either apartment-threaded or free-threaded.</span></span> <span data-ttu-id="02890-116">Una chiamata a **CoInitialize** imposta semplicemente il modello di threading su Apartment-Threaded.</span><span class="sxs-lookup"><span data-stu-id="02890-116">A call to **CoInitialize** simply sets the threading model to apartment-threaded.</span></span>

<span data-ttu-id="02890-117">Le applicazioni per documenti compositi OLE chiamano la funzione [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) , che chiama [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) ed esegue anche alcune inizializzazioni necessarie per i documenti composti.</span><span class="sxs-lookup"><span data-stu-id="02890-117">OLE compound document applications call the [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) function, which calls [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) and also does some initialization required for compound documents.</span></span> <span data-ttu-id="02890-118">Di conseguenza, i thread che chiamano **OleInitialize** non possono essere a thread libero.</span><span class="sxs-lookup"><span data-stu-id="02890-118">Therefore, threads that call **OleInitialize** cannot be free-threaded.</span></span> <span data-ttu-id="02890-119">Per informazioni sul threading in client e server, vedere [processi, thread e Apartment](processes--threads--and-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="02890-119">For information on threading in clients and servers, see [Processes, Threads, and Apartments](processes--threads--and-apartments.md).</span></span>

<span data-ttu-id="02890-120">I server in-process non chiamano le funzioni di inizializzazione perché vengono caricati in un processo che lo ha già fatto.</span><span class="sxs-lookup"><span data-stu-id="02890-120">In-process servers do not call the initialization functions because they are being loaded into a process that has already done so.</span></span> <span data-ttu-id="02890-121">Di conseguenza, i server in-process devono impostare il modello di threading nel registro di sistema nella chiave [InprocServer32](inprocserver32.md) .</span><span class="sxs-lookup"><span data-stu-id="02890-121">As a result, in-process servers must set their threading model in the registry under the [InprocServer32](inprocserver32.md) key.</span></span> <span data-ttu-id="02890-122">Per informazioni dettagliate sui problemi di threading nei server in-process, vedere [problemi di threading del server in-process](in-process-server-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="02890-122">For detailed information on threading issues in in-process servers, see [In-Process Server Threading Issues](in-process-server-threading-issues.md).</span></span>

<span data-ttu-id="02890-123">È inoltre importante annullare l'inizializzazione della libreria.</span><span class="sxs-lookup"><span data-stu-id="02890-123">It is also important to uninitialize the library.</span></span> <span data-ttu-id="02890-124">Per ogni chiamata a [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), è necessario che sia presente una chiamata corrispondente a [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span><span class="sxs-lookup"><span data-stu-id="02890-124">For each call to [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), there must be a corresponding call to [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span></span> <span data-ttu-id="02890-125">Per ogni chiamata a [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), è necessario che sia presente una chiamata corrispondente a [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span><span class="sxs-lookup"><span data-stu-id="02890-125">For each call to [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), there must be a corresponding call to [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span></span>

<span data-ttu-id="02890-126">I server in-process possono presupporre che il processo in cui sono stati caricati abbia già eseguito questi passaggi.</span><span class="sxs-lookup"><span data-stu-id="02890-126">In-process servers can assume that the process they are being loaded into has already performed these steps.</span></span>

## <a name="related-topics"></a><span data-ttu-id="02890-127">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="02890-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="02890-128">Component Object Model (COM)</span><span class="sxs-lookup"><span data-stu-id="02890-128">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 




