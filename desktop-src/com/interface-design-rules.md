---
title: Regole di progettazione dell'interfaccia
description: In questa sezione viene fornito un breve riepilogo delle regole e delle linee guida di progettazione dell'interfaccia.
ms.assetid: c43fc385-bcd6-45fc-91b2-ad9827fdb15c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c1cde73527ac79a2e4442910e3053ed96748337
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104118494"
---
# <a name="interface-design-rules"></a><span data-ttu-id="cc7d4-103">Regole di progettazione dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="cc7d4-103">Interface Design Rules</span></span>

<span data-ttu-id="cc7d4-104">In questa sezione viene fornito un breve riepilogo delle regole e delle linee guida di progettazione dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-104">This section provides a short summary of interface design rules and guidelines.</span></span> <span data-ttu-id="cc7d4-105">Alcune di queste regole sono specifiche dell'architettura COM, mentre altre sono restrizioni imposte dal linguaggio di progettazione dell'interfaccia MIDL.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-105">Some of these rules are specific to the COM architecture, while others are restrictions imposed by the interface design language, MIDL.</span></span> <span data-ttu-id="cc7d4-106">Per informazioni dettagliate sulla progettazione dell'interfaccia COM, vedere [anatomia di un file IDL](anatomy-of-an-idl-file.md).</span><span class="sxs-lookup"><span data-stu-id="cc7d4-106">For details of COM interface design, see [Anatomy of an IDL File](anatomy-of-an-idl-file.md).</span></span>

<span data-ttu-id="cc7d4-107">Per definizione, un oggetto non è un oggetto COM a meno che non implementi l'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) o un'interfaccia derivata da **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-107">By definition, an object is not a COM object unless it implements either the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface or an interface that is derived from **IUnknown**.</span></span> <span data-ttu-id="cc7d4-108">Inoltre, le regole seguenti si applicano a tutte le interfacce implementate in un oggetto COM:</span><span class="sxs-lookup"><span data-stu-id="cc7d4-108">In addition, the following rules apply to all interfaces implemented on a COM object:</span></span>

-   <span data-ttu-id="cc7d4-109">Devono avere un identificatore di interfaccia univoco (IID).</span><span class="sxs-lookup"><span data-stu-id="cc7d4-109">They must have a unique interface identifier (IID).</span></span>
-   <span data-ttu-id="cc7d4-110">Devono essere non modificabili.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-110">They must be immutable.</span></span> <span data-ttu-id="cc7d4-111">Una volta creati e pubblicati, nessuna parte della relativa definizione potrebbe cambiare.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-111">Once they are created and published, no part of their definition may change.</span></span>
-   <span data-ttu-id="cc7d4-112">Tutti i metodi di interfaccia devono restituire un valore **HRESULT** in modo che le parti del sistema che gestiscono l'elaborazione remota possano segnalare errori RPC.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-112">All interface methods must return an **HRESULT** value so that the portions of the system that handle remote processing can report RPC errors.</span></span>
-   <span data-ttu-id="cc7d4-113">Tutti i parametri di stringa nei metodi di interfaccia devono essere Unicode.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-113">All string parameters in interface methods must be Unicode.</span></span>
-   <span data-ttu-id="cc7d4-114">I tipi di dati devono essere utilizzabili in remoto.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-114">Your data types must be remotable.</span></span> <span data-ttu-id="cc7d4-115">Se non è possibile convertire un tipo di dati in un tipo utilizzabile in remoto, sarà necessario creare routine di marshalling e di unmarshalling personalizzate.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-115">If you cannot convert a data type to a remotable type, you will have to create your own marshaling and unmarshaling routines.</span></span> <span data-ttu-id="cc7d4-116">Inoltre, **LPVOID** o **void \*** non ha significato in un computer remoto.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-116">Also, **LPVOID**, or **void \***, has no meaning on a remote computer.</span></span> <span data-ttu-id="cc7d4-117">Se necessario, utilizzare un puntatore a [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="cc7d4-117">Use a pointer to [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), if necessary.</span></span>

> [!Note]  
> <span data-ttu-id="cc7d4-118">L'implementazione corrente di MIDL non gestisce l'overload di funzioni o l'ereditarietà multipla.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-118">The current implementation of MIDL does not handle function overloading or multiple inheritance.</span></span>

 

## <a name="other-interface-design-considerations"></a><span data-ttu-id="cc7d4-119">Altre considerazioni sulla progettazione dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="cc7d4-119">Other Interface Design Considerations</span></span>

<span data-ttu-id="cc7d4-120">Utilizzare i puntatori ai dati con molta attenzione.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-120">Use pointers to data very carefully.</span></span> <span data-ttu-id="cc7d4-121">Per ricreare i dati nello spazio degli indirizzi del processo chiamato, è necessario che il tempo di esecuzione RPC conosca le dimensioni esatte dei dati.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-121">To re-create the data in the address space of the process that is called, the RPC run time must know the exact size of the data.</span></span> <span data-ttu-id="cc7d4-122">Se, ad esempio, un **parametro \* char** punta a un buffer di caratteri anziché a un singolo carattere, non sarà possibile ricreare correttamente i dati.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-122">If, for example, a **CHAR \*** parameter points to a buffer of characters rather than to a single character, the data cannot be correctly re-created.</span></span> <span data-ttu-id="cc7d4-123">Usare la sintassi disponibile con MIDL per descrivere accuratamente le strutture dei dati rappresentate dalle definizioni del tipo.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-123">Use the syntax available with MIDL to accurately describe the data structures represented by your type definitions.</span></span>

<span data-ttu-id="cc7d4-124">L'inizializzazione è essenziale per i puntatori incorporati in matrici e strutture e passati attraverso i limiti dei processi.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-124">Initialization is essential for pointers that are embedded in arrays and structures and passed across process boundaries.</span></span> <span data-ttu-id="cc7d4-125">I puntatori non inizializzati possono funzionare quando vengono passati a un programma nello stesso spazio di processo, ma i proxy e gli stub presuppongono che tutti i puntatori siano inizializzati con indirizzi validi o siano null.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-125">Uninitialized pointers may work when passed to a program in the same process space, but proxies and stubs assume that all pointers are initialized with valid addresses or are null.</span></span>

<span data-ttu-id="cc7d4-126">Prestare attenzione quando si esegue l'aliasing dei puntatori (permettendo ai puntatori di puntare alla stessa porzione di memoria).</span><span class="sxs-lookup"><span data-stu-id="cc7d4-126">Be careful when aliasing pointers (allowing pointers to point to the same piece of memory).</span></span> <span data-ttu-id="cc7d4-127">Se l'aliasing è intenzionale, questi puntatori devono essere dichiarati con alias nel file IDL.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-127">If the aliasing is intentional, these pointers should be declared aliased in the IDL file.</span></span> <span data-ttu-id="cc7d4-128">I puntatori dichiarati come non con alias non devono mai essere alias reciprocamente.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-128">Pointers declared as nonaliased should never alias each other.</span></span>

<span data-ttu-id="cc7d4-129">Prestare attenzione a come allocare e liberare memoria.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-129">Pay attention to how you allocate and free memory.</span></span> <span data-ttu-id="cc7d4-130">Tenere presente che, a meno che non si specifichi in modo esplicito un oggetto COM (usando l'attributo [**allocate**](/windows/desktop/Midl/allocate) ) per non liberare una struttura di dati creata durante una chiamata out-of-process, la struttura verrà distrutta al completamento della chiamata.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-130">Remember that, unless you explicitly tell a COM object (by using the [**allocate**](/windows/desktop/Midl/allocate) attribute) not to free a data structure that was created during an out-of-process call, that structure will be destroyed when the call completes.</span></span> <span data-ttu-id="cc7d4-131">Si consideri inoltre il sovraccarico potenzialmente distruttivo creato dall'allocazione inefficiente di strutture di dati di cui è ora necessario effettuare il marshalling e l'unmarshalling.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-131">Also, consider the potentially destructive overhead created by inefficient allocation of data structures that now need to be marshaled and unmarshaled.</span></span>

<span data-ttu-id="cc7d4-132">Infine, prestare attenzione quando si definiscono i valori restituiti **HRESULT** in modo da non creare codici di errore in conflitto con i codici ITF della funzionalità definita da com \_ (i valori compresi tra 0x0000 e 0x01ff sono riservati) o in conflitto con altri valori **HRESULT** con lo stesso valore.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-132">Finally, be careful when defining your **HRESULT** return values so that you don't create error codes that conflict with COM-defined FACILITY\_ITF codes (values between 0x0000 and 0x01FF are reserved) or that conflict with other **HRESULT** values with the same value.</span></span> <span data-ttu-id="cc7d4-133">Quando possibile, utilizzare i valori restituiti Universal COM Success e Failure e utilizzare un parametro [**out**](/windows/desktop/Midl/out-idl) , anziché un **HRESULT**, per restituire informazioni specifiche della chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="cc7d4-133">Whenever possible, use the universal COM success and failure return values, and use an [**out**](/windows/desktop/Midl/out-idl) parameter, rather than an **HRESULT**, to return information specific to the function call.</span></span>

<span data-ttu-id="cc7d4-134">Per altre informazioni, vedere i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="cc7d4-134">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="cc7d4-135">Progettazione di interfacce utilizzabili in remoto</span><span class="sxs-lookup"><span data-stu-id="cc7d4-135">Designing Remotable Interfaces</span></span>](designing-remotable-interfaces.md)
-   [<span data-ttu-id="cc7d4-136">Uso di un'interfaccia COM</span><span class="sxs-lookup"><span data-stu-id="cc7d4-136">Using a COM Interface</span></span>](using-a-com-interface.md)

## <a name="related-topics"></a><span data-ttu-id="cc7d4-137">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cc7d4-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cc7d4-138">Definizioni di interfaccia e librerie dei tipi</span><span class="sxs-lookup"><span data-stu-id="cc7d4-138">Interface Definitions and Type Libraries</span></span>](/windows/desktop/Midl/interface-definitions-and-type-libraries)
</dt> </dl>

 

 