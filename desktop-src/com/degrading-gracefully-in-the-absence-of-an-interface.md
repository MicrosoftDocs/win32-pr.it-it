---
title: Riduzione delle prestazioni in assenza di un'interfaccia
description: Poiché un controllo potrebbe non supportare alcuna interfaccia diversa da IUnknown, un contenitore deve peggiorare normalmente quando rileva l'assenza di un'interfaccia specifica.
ms.assetid: 1b833900-2357-4b39-b88d-5ee6321f488e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fef1b329faa2d4da333cf2e201fc887764af96bc5ea2573060f41774b57c0d56
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "119501276"
---
# <a name="degrading-gracefully-in-the-absence-of-an-interface"></a>Riduzione delle prestazioni in assenza di un'interfaccia

Poiché un controllo potrebbe non supportare alcuna interfaccia diversa da [**IUnknown,**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)un contenitore deve peggiorare normalmente quando rileva l'assenza di un'interfaccia specifica.

È possibile mettere in discussione l'utilità di un controllo con solo [**IUnknown.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Considerare tuttavia i vantaggi che un controllo riceve dall'ambiente di programmazione visivo di un contenitore (ad esempio VB) quando il contenitore riconosce l'oggetto come controllo:

-   Un pulsante per l'oggetto viene visualizzato in una casella degli strumenti.
-   È possibile creare un oggetto trascinandolo dalla casella degli strumenti in un form.
-   È possibile assegnare all'oggetto un nome riconosciuto nell'ambiente di programmazione visiva.
-   Lo stesso nome in (3) precedente può essere usato immediatamente per scrivere qualsiasi altro codice per i controlli nello stesso form (o anche in un modulo diverso).
-   Il contenitore può fornire automaticamente punti di ingresso del codice per tutti gli eventi disponibili da tale oggetto.
-   Il contenitore fornisce la propria interfaccia utente di esplorazione delle proprietà per tutte le proprietà disponibili.

Quando un oggetto non viene riconosciuto come controllo, può perdere tutte queste funzionalità di integrazione molto potenti e vantaggiose. Ad esempio, in Visual Basic 4.0 è molto difficile integrare effettivamente un oggetto casuale che non è un controllo nel senso completo, ma che può comunque avere proprietà ed eventi. Poiché Visual Basic'idea di 4 di un controllo è molto restrittiva, l'oggetto non ottiene alcuna delle funzionalità di integrazione precedenti. Ma anche un controllo con [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), in cui la semplice durata del controllo determina l'esistenza di una risorsa, deve essere in grado di ottenere le funzionalità di integrazione descritte in precedenza.

Poiché gli strumenti correnti richiedono un ampio set di interfacce di controllo per ottenere qualsiasi vantaggio, i controlli sono in genere guidati a un'over-implementazione, in modo che contengano più codice del necessario. I controlli che potrebbero essere 7K potrebbero essere 25.000, il che rappresenta un problema di prestazioni importante in aree come Internet. Ciò ha portato anche alla percezione che si possa implementare un controllo solo con uno strumento come la cdk a causa della complessità dell'implementazione di tutte le interfacce e ciò ha implicazioni quando è necessaria una DLL di grandi dimensioni come OC30.DLL per un controllo di questo tipo, aumentando il working set. Se non tutte le interfacce sono necessarie, molti sviluppatori possono scrivere controlli molto piccoli e leggeri con OLE diretto o con altri strumenti, riducendo al minimo il sovraccarico per ogni controllo.

Questo è il motivo per cui questa appendice riconosce un controllo come qualsiasi oggetto con un CLSID e [**un'interfaccia IUnknown.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Anche con IUnknown, un contenitore con un ambiente di programmazione deve essere in grado di fornire almeno le funzionalità 3 e ) voce del Registro di sistema, che ottiene \# \# 1 e \# 2. Se l'oggetto fornisce [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (e [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) in genere) per un set di eventi, ottiene 5 e, se supporta IDispatch per proprietà e metodi, ne ottiene 6, oltre a una migliore integrazione del codice nel \#  \# contenitore.

In breve, un oggetto deve essere in grado di implementare solo **IDispatch** e un set di eventi esposti tramite [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) per ottenere tutte le funzionalità visive precedenti.

A tale scopo, la tabella seguente descrive le operazioni che un contenitore potrebbe eseguire in assenza di un'interfaccia possibile. Si noti che vengono elencate solo le interfacce che il contenitore o ottiene direttamente tramite [**QueryInterface.**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) Altre interfacce, ad [**esempio IOleInPlaceActiveObject,**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)vengono ottenute con altri mezzi.



| Interfaccia                                                                                                             | Significato dell'assenza dell'interfaccia                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                       | Il controllo non dispone di oggetti visivi che verrà diseettuato, quindi non ha extent determinati da fornire. In fase di esecuzione, il contenitore semplicemente non tenta di disegnare nulla quando questa interfaccia è assente. In fase di progettazione, il contenitore deve almeno disegnare un tipo di rettangolo predefinito con un nome per tale controllo, in modo che un utente in un ambiente di programmazione visiva possa selezionare l'oggetto ed estrarre le proprietà, i metodi e gli eventi esistenti. La gestione dell'assenza di [**IViewObject2 è**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) fondamentale per un buon supporto per la programmazione visiva.<br/> |
| [**Ioleobject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                           | Il controllo non richiede il sito, né fa parte di alcuna negoziazione del layout degli oggetti incorporata. Tutte le informazioni (ad esempio gli extent di controllo) che un contenitore potrebbe aspettarsi da questa interfaccia devono essere compilate con le impostazioni predefinite fornite dal contenitore.<br/>                                                                                                                                                                                                                                                                                                       |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                             | Il controllo non diventa attivo sul posto (ad esempio, un'etichetta) e quindi non tenta mai di eseguire l'attivazione in questo modo. L'unica attivazione può essere la relativa pagina delle proprietà.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                         | Il controllo non ha elementi mnemoici e non usa proprietà di ambiente e non ha attenzione se il contenitore ignora gli eventi. In assenza di questa interfaccia, il contenitore non chiama semplicemente i relativi metodi.<br/>                                                                                                                                                                                                                                                                                                                                                                         |
| [**Idataobject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                         | Il controllo non fornisce set di proprietà né rendering visivi che possono essere memorizzati nella cache, quindi il contenitore sceglie di memorizzare nella cache una presentazione predefinita in assenza di questa interfaccia (in particolare il supporto per CF METAFILEPICT) e disabilitare qualsiasi funzionalità correlata al set di \_ proprietà.<br/>                                                                                                                                                                                                                                                                            |
| **Idispatch**<br/>                                                                                              | Il controllo non dispone di proprietà o metodi personalizzati. Il contenitore non deve provare a visualizzare le proprietà del controllo in questo caso e deve non consentire chiamate a metodi personalizzati che il contenitore non riconosce come appartenenti ai propri controlli estesi (che possono supportare metodi e proprietà). Poiché i controlli estesi delegano in genere determinate chiamate **IDispatch** al controllo, un controllo esteso non deve aspettarsi che il controllo abbia **affatto IDispatch.**<br/>                                                                                          |
| [**Iconnectionpointcontainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                             | Il controllo non ha eventi, quindi il contenitore non deve pensare alla gestione di alcun evento.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/> | Il controllo non ha informazioni sul tipo o eventi oppure il contenitore deve passare alle informazioni sul tipo del controllo tramite le voci del Registro di sistema del controllo. L'esistenza di questa interfaccia è un'ottimizzazione.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                     | Il controllo non ha pagine delle proprietà, quindi se il contenitore ha un'interfaccia utente che le richiama, il contenitore deve disabilitare tale interfaccia utente.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                       | Il controllo non ha alcun nome visualizzato, stringhe e valori predeterminati e nessun mapping tra proprietà e pagina. Questa interfaccia viene quasi sempre usata per generare l'interfaccia utente del contenitore, quindi tali elementi dell'interfaccia utente verrebbero disabilitati in assenza di questa interfaccia.<br/>                                                                                                                                                                                                                                                                                                 |
| Ipersist\*<br/>                                                                                                 | Il controllo non ha uno stato persistente di cui parlare, quindi il contenitore non deve preoccuparsi di salvare dati specifici del controllo. Il contenitore, naturalmente, salverà le proprie informazioni sul controllo nel proprio modulo o documento, ma il controllo stesso non ha nulla da aggiungere a queste informazioni.<br/>                                                                                                                                                                                                                                                        |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                 | L'oggetto non supporta la memorizzazione nella cache. Un contenitore può comunque supportare la memorizzazione nella cache semplicemente creando una cache di dati tramite [**CreateDataCache.**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache)<br/>                                                                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="related-topics"></a>Argomenti correlati

<dl> <dt>

[Contenitori](containers.md)
</dt> </dl>

 

 





