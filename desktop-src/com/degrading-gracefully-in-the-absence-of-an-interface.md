---
title: Peggioramento normale in assenza di un'interfaccia
description: Poiché un controllo potrebbe non supportare alcuna interfaccia diversa da IUnknown, un contenitore deve peggiorare correttamente quando rileva l'assenza di un'interfaccia particolare.
ms.assetid: 1b833900-2357-4b39-b88d-5ee6321f488e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 26618e00f2d959cccfd7ab4d2948fac9c1a3f020
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/29/2020
ms.locfileid: "106299345"
---
# <a name="degrading-gracefully-in-the-absence-of-an-interface"></a>Peggioramento normale in assenza di un'interfaccia

Poiché un controllo potrebbe non supportare alcuna interfaccia diversa da [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), un contenitore deve peggiorare correttamente quando rileva l'assenza di un'interfaccia particolare.

È possibile che si possa mettere in discussione l'utilità di un controllo con nient'altro che [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown). Si considerino tuttavia i vantaggi che un controllo riceve dall'ambiente di programmazione visuale di un contenitore, ad esempio VB, quando il contenitore riconosce l'oggetto come controllo:

-   Un pulsante per l'oggetto viene visualizzato in una casella degli strumenti.
-   Uno può creare un oggetto trascinandolo dalla casella degli strumenti in un form.
-   Uno può assegnare all'oggetto un nome riconosciuto nell'ambiente di programmazione visuale.
-   Lo stesso nome in (3) precedente può essere usato immediatamente per scrivere qualsiasi altro codice per i controlli nello stesso formato o anche in un formato diverso.
-   Il contenitore può fornire automaticamente punti di ingresso del codice per tutti gli eventi disponibili da tale oggetto.
-   Il contenitore fornisce una propria interfaccia utente di esplorazione delle proprietà per tutte le proprietà disponibili.

Quando un oggetto non è riconosciuto come controllo, potrebbe perdere tutte le funzionalità di integrazione molto potenti e utili. Ad esempio, in Visual Basic 4,0 è molto difficile integrare effettivamente un oggetto casuale che non è un controllo nel senso completo, ma può ancora avere proprietà ed eventi. Poiché il concetto di Visual Basic 4 di un controllo è molto restrittivo, l'oggetto non ottiene alcuna delle funzionalità di integrazione precedenti. Ma anche un controllo con [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), in cui la semplice durata del controllo determina l'esistenza di una risorsa, dovrebbe essere in grado di ottenere le funzionalità di integrazione descritte in precedenza.

Poiché gli strumenti correnti richiedono un ampio set di interfacce di controllo per ottenere qualsiasi vantaggio, i controlli sono in genere portati a sovraimplementazione, in modo che contengano un codice maggiore di quello effettivamente necessario. I controlli che potrebbero essere 7K potrebbero essere 25K, che rappresenta un problema di grande prestazioni in aree quali Internet. Ciò ha portato anche alla percezione che è possibile implementare un controllo solo con uno strumento come CDK a causa della complessità dell'implementazione di tutte le interfacce e ciò implica che quando è necessaria una DLL di grandi dimensioni come OC30.DLL per un controllo di questo tipo, aumentando l'working set. Se non sono necessarie tutte le interfacce, viene visualizzato un numero elevato di sviluppatori per la scrittura di controlli molto piccoli e leggeri con OLE diretto o con altri strumenti, riducendo al minimo l'overhead per ogni controllo.

Questo è il motivo per cui questa appendice riconosce un controllo come qualsiasi oggetto con un CLSID e un'interfaccia [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) . Anche senza nient'altro che IUnknown, un contenitore con un ambiente di programmazione deve essere in grado di fornire almeno le funzionalità \# 3 e), ottenendo \# 1 e \# 2. Se l'oggetto fornisce [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (e [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) in genere) per un set di eventi, acquisisce \# 5 e se supporta **IDispatch** per le proprietà e i metodi, acquisisce \# 6, oltre a una migliore integrazione del codice nel contenitore.

In breve, un oggetto deve essere in grado di implementare fino a **IDispatch** e un set di eventi esposto tramite [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) per ottenere tutte queste funzionalità visive.

Tenendo presente questo aspetto, nella tabella seguente vengono descritte le operazioni che un contenitore può eseguire in assenza di qualsiasi interfaccia possibile. Si noti che solo le interfacce sono elencate che il contenitore otterrà direttamente tramite [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)). Altre interfacce, ad esempio [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject), vengono ottenute attraverso altri mezzi.



| Interfaccia                                                                                                             | Significato dell'assenza di interfaccia                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                       | Il controllo non ha oggetti visivi che disegna se stesso, quindi non ha extent definiti da fornire. In fase di esecuzione, il contenitore non tenta di creare nulla quando questa interfaccia è assente. In fase di progettazione il contenitore deve almeno disegnare un tipo di rettangolo predefinito con un nome per tale controllo, quindi un utente in un ambiente di programmazione visiva può selezionare l'oggetto e verificare le proprietà, i metodi e gli eventi esistenti. La gestione dell'assenza di [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) è essenziale per un efficace supporto per la programmazione visiva.<br/> |
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                           | Il controllo non richiede il sito, né fa parte di alcuna negoziazione del layout dell'oggetto incorporato. Tutte le informazioni, ad esempio gli extent del controllo, che un contenitore potrebbe aspettarsi da questa interfaccia devono essere compilate con le impostazioni predefinite fornite dal contenitore.<br/>                                                                                                                                                                                                                                                                                                       |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                             | Il controllo non viene attivato sul posto (ad esempio un'etichetta) e pertanto non tenta mai di eseguire l'attivazione in questo modo. L'unica attivazione può essere costituita dalle pagine delle proprietà.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                         | Il controllo non ha alcun tasto di scelta e non usa le proprietà di ambiente e non è importante se il contenitore ignora gli eventi. In assenza di questa interfaccia, il contenitore non chiama i relativi metodi.<br/>                                                                                                                                                                                                                                                                                                                                                                         |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                         | Il controllo non fornisce alcun set di proprietà né rendering visivi che possono essere memorizzati nella cache, quindi il contenitore sceglie di memorizzare nella cache alcune presentazioni predefinite in assenza di questa interfaccia (supporto per CF \_ METAFILEPICT, in particolare) e disabilitare tutte le funzionalità correlate al set di proprietà.<br/>                                                                                                                                                                                                                                                                            |
| **IDispatch**<br/>                                                                                              | Il controllo non dispone di proprietà o metodi personalizzati. Non è necessario che il contenitore provi a visualizzare le proprietà del controllo in questo caso e non deve consentire le chiamate a metodi personalizzati che il contenitore non riconosce come appartenenti ai propri controlli estesi (che possono supportare metodi e proprietà). Poiché in genere i controlli estesi delegano determinate chiamate **IDispatch** al controllo, un controllo esteso non dovrebbe prevedere il controllo **IDispatch** .<br/>                                                                                          |
| [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                             | Il controllo non ha eventi, quindi non è necessario che il contenitore si preoccupi di gestirne alcuno.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/> | Il controllo non ha informazioni sul tipo o eventi oppure il contenitore deve entrare nelle informazioni sul tipo del controllo tramite le voci del registro di sistema del controllo. L'esistenza di questa interfaccia è un'ottimizzazione.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                     | Il controllo non dispone di pagine di proprietà, quindi se il contenitore dispone di un'interfaccia utente che li richiama, il contenitore deve disabilitare tale interfaccia.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                       | Il controllo non ha alcun nome visualizzato, nessun valore e stringhe predeterminate e nessuna proprietà per il mapping delle pagine. Questa interfaccia viene quasi sempre utilizzata per la generazione dell'interfaccia utente del contenitore, quindi tali elementi dell'interfaccia utente verrebbero disabilitati in assenza di questa interfaccia.<br/>                                                                                                                                                                                                                                                                                                 |
| IPersist\*<br/>                                                                                                 | Il controllo non ha uno stato permanente a cui parlare, quindi non è necessario che il contenitore si preoccupi di salvare i dati specifici del controllo. Il contenitore, ovviamente, Salva le proprie informazioni sul controllo in un form o in un documento, ma il controllo non ha nulla per contribuire a tali informazioni.<br/>                                                                                                                                                                                                                                                        |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                 | L'oggetto non supporta la memorizzazione nella cache. Un contenitore può comunque supportare la memorizzazione nella cache semplicemente creando una cache di dati con [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache).<br/>                                                                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="related-topics"></a>Argomenti correlati

<dl> <dt>

[Contenitori](containers.md)
</dt> </dl>

 

 





