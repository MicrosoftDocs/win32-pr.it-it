---
description: Schannel dispone di un set di comportamenti ben definito per le informazioni incomplete o superflue incluse nei buffer di input per queste funzioni.
ms.assetid: 5fad1e76-6520-4ff7-b2b0-2cc2061062a1
title: Buffer aggiuntivi restituiti da Schannel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b0c9ce7a468b1b04389ad19f91785b64fb50e74
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317081"
---
# <a name="extra-buffers-returned-by-schannel"></a><span data-ttu-id="eec01-103">Buffer aggiuntivi restituiti da Schannel</span><span class="sxs-lookup"><span data-stu-id="eec01-103">Extra Buffers Returned by Schannel</span></span>

<span data-ttu-id="eec01-104">Le informazioni devono essere inviate tra il client e il server mentre viene stabilito un [*contesto di sicurezza*](/windows/desktop/SecGloss/s-gly) e successivamente perché i messaggi protetti vengono scambiati usando le funzionalità di crittografia e decrittografia fornite da Schannel.</span><span class="sxs-lookup"><span data-stu-id="eec01-104">Information must be sent between the client and server while a [*security context*](/windows/desktop/SecGloss/s-gly) is being established and afterward because secure messages are exchanged by using the encryption and decryption features provided by Schannel.</span></span> <span data-ttu-id="eec01-105">Per eseguire queste attività, vengono usate le funzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="eec01-105">The following functions are used to accomplish these tasks:</span></span>

-   [<span data-ttu-id="eec01-106">**AcceptSecurityContext (generale)**</span><span class="sxs-lookup"><span data-stu-id="eec01-106">**AcceptSecurityContext (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)
-   [<span data-ttu-id="eec01-107">**InitializeSecurityContext (generale)**</span><span class="sxs-lookup"><span data-stu-id="eec01-107">**InitializeSecurityContext (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta)
-   [<span data-ttu-id="eec01-108">**DecryptMessage (generale)**</span><span class="sxs-lookup"><span data-stu-id="eec01-108">**DecryptMessage (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-decryptmessage)

<span data-ttu-id="eec01-109">Schannel dispone di un set di comportamenti ben definito per le informazioni incomplete o superflue incluse nei buffer di input per queste funzioni.</span><span class="sxs-lookup"><span data-stu-id="eec01-109">Schannel has a well-defined set of behaviors for incomplete or excess information included in the input buffers to these functions.</span></span> <span data-ttu-id="eec01-110">Le informazioni vengono scambiate tra il client e il server nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="eec01-110">Information is exchanged between the client and server in the following manner:</span></span>

1.  <span data-ttu-id="eec01-111">L'entità locale interagisce con Schannel chiamando una funzione SSPI e passando le informazioni.</span><span class="sxs-lookup"><span data-stu-id="eec01-111">The local party interacts with Schannel by calling an SSPI function and passing in information.</span></span> <span data-ttu-id="eec01-112">In genere, le informazioni sono state ricevute dalla parte remota.</span><span class="sxs-lookup"><span data-stu-id="eec01-112">Typically, the information was received from the remote party.</span></span>
2.  <span data-ttu-id="eec01-113">La funzione restituisce un codice di stato e i buffer di output contenenti informazioni.</span><span class="sxs-lookup"><span data-stu-id="eec01-113">The function returns a status code and output buffers containing information.</span></span>
3.  <span data-ttu-id="eec01-114">A seconda del codice di stato, i buffer di output vengono inviati alla parte remota per mezzo di un meccanismo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="eec01-114">Depending on the status code, the output buffers are sent to the remote party by means of some communication mechanism.</span></span>
4.  <span data-ttu-id="eec01-115">La parte remota legge le informazioni inviate dall'entità locale.</span><span class="sxs-lookup"><span data-stu-id="eec01-115">The remote party reads information sent by the local party.</span></span>
5.  <span data-ttu-id="eec01-116">Il ciclo si ripete, con le entità locali e remote interscambiate.</span><span class="sxs-lookup"><span data-stu-id="eec01-116">The loop repeats, with the local and remote parties interchanged.</span></span> <span data-ttu-id="eec01-117">(L'entità remota chiama una funzione SSPI e passa le informazioni lette nel passaggio precedente).</span><span class="sxs-lookup"><span data-stu-id="eec01-117">(The remote party calls an SSPI function and passes in the information read in the previous step.)</span></span>

<span data-ttu-id="eec01-118">Tutto funziona come previsto quando il buffer di input per la funzione SSPI contiene esattamente le informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="eec01-118">Everything works as expected when the input buffer to the SSPI function contains exactly the information needed.</span></span> <span data-ttu-id="eec01-119">Tuttavia, a causa della natura orientata al flusso di alcuni protocolli di comunicazione, questo potrebbe non essere il caso. un blocco di informazioni ricevute da un'entità remota può contenere meno dati di quelli richiesti o più dati di quelli che possono essere elaborati da Schannel in una singola chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="eec01-119">However, due to the stream-oriented nature of some communications protocols this may not be the case; a block of information received from a remote party may contain less data than is required or more data than can be processed by Schannel in a single function call.</span></span>

<span data-ttu-id="eec01-120">Se il buffer di input contiene informazioni insufficienti, le funzioni restituiscono un \_ \_ messaggio incompleto al secondo E \_ .</span><span class="sxs-lookup"><span data-stu-id="eec01-120">If the input buffer contains too little information, the functions return SEC\_E\_INCOMPLETE\_MESSAGE.</span></span> <span data-ttu-id="eec01-121">Il chiamante deve ottenere dati aggiuntivi dalla parte remota e chiamare di nuovo la funzione.</span><span class="sxs-lookup"><span data-stu-id="eec01-121">The caller must obtain additional data from the remote party and call the function again.</span></span>

<span data-ttu-id="eec01-122">Quando i buffer di input contengono troppe informazioni, Schannel non lo considera come un errore.</span><span class="sxs-lookup"><span data-stu-id="eec01-122">When the input buffers contains too much information, Schannel does not treat this as an error.</span></span> <span data-ttu-id="eec01-123">La funzione elabora la maggior parte dell'input possibile e restituisce il codice di stato per l'attività di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="eec01-123">The function processes as much of the input as it can, and returns the status code for that processing activity.</span></span> <span data-ttu-id="eec01-124">Schannel indica inoltre la presenza di informazioni non elaborate nei buffer di input restituendo un buffer di output di tipo SECBUFFER \_ extra.</span><span class="sxs-lookup"><span data-stu-id="eec01-124">In addition, Schannel indicates the presence of unprocessed information in the input buffers by returning an output buffer of type SECBUFFER\_EXTRA.</span></span> <span data-ttu-id="eec01-125">Il test dei buffer di output per questo tipo di buffer è l'unico modo per rilevare questa situazione.</span><span class="sxs-lookup"><span data-stu-id="eec01-125">Testing the output buffers for this type of buffer is the only way to detect this situation.</span></span> <span data-ttu-id="eec01-126">Il campo **cbBuffer** della struttura del buffer aggiuntiva indica il numero di byte di input non elaborati.</span><span class="sxs-lookup"><span data-stu-id="eec01-126">The **cbBuffer** field of the extra buffer structure indicates how many bytes of input were not processed.</span></span>

> [!Note]  
> <span data-ttu-id="eec01-127">Il campo **pvBuffer** del buffer aggiuntivo non contiene una copia dei dati in eccesso.</span><span class="sxs-lookup"><span data-stu-id="eec01-127">The **pvBuffer** field of the extra buffer does not contain a copy of the excess data.</span></span>

 

<span data-ttu-id="eec01-128">Se si riceve un buffer aggiuntivo da una funzione SSPI, è necessario rimuovere le informazioni già elaborate dal buffer di input e chiamare di nuovo la funzione.</span><span class="sxs-lookup"><span data-stu-id="eec01-128">If you receive an extra buffer from a SSPI function, you must remove the already processed information from the input buffer and call the function again.</span></span> <span data-ttu-id="eec01-129">SChannel può, e spesso, restituisce solo il buffer aggiuntivo e nient'altro nei buffer di output.</span><span class="sxs-lookup"><span data-stu-id="eec01-129">Schannel can, and often does, return only the extra buffer and nothing else in the output buffers.</span></span>

 

 
