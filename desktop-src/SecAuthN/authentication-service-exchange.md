---
description: L'utente inizia ad accedere alla rete digitando un nome di accesso e una password. Il client Kerberos nella workstation dell'utente converte la password in una chiave di crittografia e salva il risultato in una variabile di programma.
ms.assetid: fcb3b601-9953-474c-9a08-1fa25706f3d7
title: Scambio del servizio di autenticazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c14121ed33ae0ac169c590b03dfb0b395306d11f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106313752"
---
# <a name="authentication-service-exchange"></a><span data-ttu-id="e31cd-104">Scambio del servizio di autenticazione</span><span class="sxs-lookup"><span data-stu-id="e31cd-104">Authentication Service Exchange</span></span>

<span data-ttu-id="e31cd-105">L'utente inizia ad accedere alla rete digitando un nome di accesso e una password.</span><span class="sxs-lookup"><span data-stu-id="e31cd-105">The user begins logging on to the network by typing a logon name and password.</span></span> <span data-ttu-id="e31cd-106">Il client [*Kerberos*](/windows/desktop/SecGloss/k-gly) nella workstation dell'utente converte la password in una chiave di crittografia e salva il risultato in una variabile di programma.</span><span class="sxs-lookup"><span data-stu-id="e31cd-106">The [*Kerberos*](/windows/desktop/SecGloss/k-gly) client on the user's workstation converts the password to an encryption key and saves the result in a program variable.</span></span>

<span data-ttu-id="e31cd-107">Il client richiede quindi le [*credenziali*](/windows/desktop/SecGloss/c-gly) per il servizio di concessione ticket (TGS) del [*centro distribuzione chiavi*](/windows/desktop/SecGloss/k-gly) (KDC) inviando il servizio di autenticazione del KDC un messaggio di tipo KRB \_ come \_ req (richiesta del servizio di autenticazione Kerberos).</span><span class="sxs-lookup"><span data-stu-id="e31cd-107">The client then requests [*credentials*](/windows/desktop/SecGloss/c-gly) for the ticket-granting service (TGS) of the [*Key Distribution Center*](/windows/desktop/SecGloss/k-gly) (KDC) by sending the KDC's authentication service a message of type KRB\_AS\_REQ (Kerberos Authentication Service Request).</span></span> <span data-ttu-id="e31cd-108">La prima parte di questo messaggio identifica l'utente e il servizio TGS richiesto.</span><span class="sxs-lookup"><span data-stu-id="e31cd-108">The first part of this message identifies the user and the TGS service being requested.</span></span> <span data-ttu-id="e31cd-109">La seconda parte di questo messaggio contiene i dati di preautenticazione destinati a dimostrare che l'utente conosce la password.</span><span class="sxs-lookup"><span data-stu-id="e31cd-109">The second part of this message contains preauthentication data intended to prove that the user knows the password.</span></span> <span data-ttu-id="e31cd-110">Si tratta semplicemente di un messaggio di autenticazione crittografato con la [*chiave master*](/windows/desktop/SecGloss/m-gly) derivata dalla password di accesso dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e31cd-110">This is simply an authenticator message that is encrypted with the [*master key*](/windows/desktop/SecGloss/m-gly) derived from the user's logon password.</span></span>

<span data-ttu-id="e31cd-111">Quando il KDC riceve KRB \_ come \_ req, Cerca l'utente nel database, ottiene la chiave master dell'utente associato, decrittografa i dati di preautenticazione e valuta il timestamp all'interno.</span><span class="sxs-lookup"><span data-stu-id="e31cd-111">When the KDC receives KRB\_AS\_REQ, it looks up the user in its database, gets the associated user's master key, decrypts the preauthentication data, and evaluates the time stamp inside.</span></span> <span data-ttu-id="e31cd-112">Se il timestamp è valido, è possibile garantire che i dati di preautenticazione siano stati crittografati con la chiave master dell'utente e che quindi il client sia autentico.</span><span class="sxs-lookup"><span data-stu-id="e31cd-112">If the time stamp is valid, the KDC can be assured that the preauthentication data was encrypted with the user's master key and thus that the client is genuine.</span></span>

<span data-ttu-id="e31cd-113">Una volta verificata l'identità dell'utente, il KDC crea le credenziali che il client può presentare al TGS, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="e31cd-113">After the KDC has verified the user's identity, it creates credentials that the client can present to the TGS, as follows:</span></span>

1.  <span data-ttu-id="e31cd-114">Il KDC inventa una chiave della [*sessione*](/windows/desktop/SecGloss/s-gly) di accesso e crittografa una copia con la chiave master dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e31cd-114">The KDC invents a logon [*session key*](/windows/desktop/SecGloss/s-gly) and encrypts a copy with the user's master key.</span></span>
2.  <span data-ttu-id="e31cd-115">Il KDC incorpora un'altra copia della chiave della sessione di accesso e i dati di autorizzazione dell'utente in un ticket di concessione ticket (TGT) e crittografa il TGT con la chiave master del KDC.</span><span class="sxs-lookup"><span data-stu-id="e31cd-115">The KDC embeds another copy of the logon session key and the user's authorization data in a ticket-granting ticket (TGT), and encrypts the TGT with the KDC's own master key.</span></span>
3.  <span data-ttu-id="e31cd-116">Il KDC invia le credenziali al client rispondendo con un messaggio di tipo KRB \_ come \_ Rep (risposta al servizio di autenticazione Kerberos).</span><span class="sxs-lookup"><span data-stu-id="e31cd-116">The KDC sends these credentials back to the client by replying with a message of type KRB\_AS\_REP (Kerberos Authentication Service Reply).</span></span>
4.  <span data-ttu-id="e31cd-117">Quando il client riceve la risposta, usa la chiave derivata dalla password dell'utente per decrittografare la nuova chiave della sessione di accesso.</span><span class="sxs-lookup"><span data-stu-id="e31cd-117">When the client receives the reply, it uses the key derived from the user's password to decrypt the new logon session key.</span></span>
5.  <span data-ttu-id="e31cd-118">Il client archivia la nuova chiave nella relativa cache di ticket.</span><span class="sxs-lookup"><span data-stu-id="e31cd-118">The client stores the new key in its ticket cache.</span></span>
6.  <span data-ttu-id="e31cd-119">Il client estrae il TGT dal messaggio e lo archivia anche nella cache dei ticket.</span><span class="sxs-lookup"><span data-stu-id="e31cd-119">The client extracts the TGT from the message and stores that in its ticket cache as well.</span></span>

 

 
