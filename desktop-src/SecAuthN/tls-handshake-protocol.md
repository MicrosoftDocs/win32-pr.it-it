---
description: Il protocollo di handshake Transport Layer Security (TLS) è responsabile dell'autenticazione e dello scambio di chiave necessari per stabilire o riprendere le sessioni sicure.
ms.assetid: 65fb4db3-e505-457a-9159-dba0b506ea0b
title: Protocollo handshake TLS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0c7cfa9e9db54a6035abe147ce00bbde59bcc86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106316204"
---
# <a name="tls-handshake-protocol"></a><span data-ttu-id="8ef7d-103">Protocollo handshake TLS</span><span class="sxs-lookup"><span data-stu-id="8ef7d-103">TLS Handshake Protocol</span></span>

<span data-ttu-id="8ef7d-104">Il protocollo di handshake [*Transport Layer Security*](../secgloss/t-gly.md) (TLS) è responsabile dell'autenticazione e dello scambio di chiave necessari per stabilire o riprendere le sessioni sicure.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-104">The [*Transport Layer Security*](../secgloss/t-gly.md) (TLS) Handshake Protocol is responsible for the authentication and key exchange necessary to establish or resume secure sessions.</span></span> <span data-ttu-id="8ef7d-105">Quando si stabilisce una [*sessione*](../secgloss/s-gly.md)protetta, il protocollo di handshake gestisce quanto segue:</span><span class="sxs-lookup"><span data-stu-id="8ef7d-105">When establishing a secure [*session*](../secgloss/s-gly.md), the Handshake Protocol manages the following:</span></span>

-   <span data-ttu-id="8ef7d-106">Negoziazione del pacchetto di crittografia</span><span class="sxs-lookup"><span data-stu-id="8ef7d-106">Cipher suite negotiation</span></span>
-   <span data-ttu-id="8ef7d-107">Autenticazione del server e, facoltativamente, del client</span><span class="sxs-lookup"><span data-stu-id="8ef7d-107">Authentication of the server and optionally, the client</span></span>
-   <span data-ttu-id="8ef7d-108">Scambio di informazioni sulla chiave della sessione.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-108">Session key information exchange.</span></span>

## <a name="cipher-suite-negotiation"></a><span data-ttu-id="8ef7d-109">Negoziazione del pacchetto di crittografia</span><span class="sxs-lookup"><span data-stu-id="8ef7d-109">Cipher Suite Negotiation</span></span>

<span data-ttu-id="8ef7d-110">Il client e il server fanno contatto e scelgono il pacchetto di crittografia che verrà usato durante lo scambio di messaggi.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-110">The client and server make contact and choose the cipher suite that will be used throughout their message exchange.</span></span>

## <a name="authentication"></a><span data-ttu-id="8ef7d-111">Authentication</span><span class="sxs-lookup"><span data-stu-id="8ef7d-111">Authentication</span></span>

<span data-ttu-id="8ef7d-112">In TLS, un server dimostra la propria identità al client.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-112">In TLS, a server proves its identity to the client.</span></span> <span data-ttu-id="8ef7d-113">Il client potrebbe anche dover dimostrare la propria identità al server.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-113">The client might also need to prove its identity to the server.</span></span> <span data-ttu-id="8ef7d-114">L'uso di coppie di [*chiavi pubbliche/private*](../secgloss/p-gly.md)è la base di questa autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-114">PKI, the use of [*public/private key pairs*](../secgloss/p-gly.md), is the basis of this authentication.</span></span> <span data-ttu-id="8ef7d-115">Il metodo esatto utilizzato per l'autenticazione è determinato dal pacchetto di crittografia negoziato.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-115">The exact method used for authentication is determined by the cipher suite negotiated.</span></span>

## <a name="key-exchange"></a><span data-ttu-id="8ef7d-116">Scambio di chiave</span><span class="sxs-lookup"><span data-stu-id="8ef7d-116">Key Exchange</span></span>

<span data-ttu-id="8ef7d-117">Il client e il server scambiano numeri casuali e un numero speciale denominato master secret.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-117">The client and server exchange random numbers and a special number called the Pre-Master Secret.</span></span> <span data-ttu-id="8ef7d-118">Questi numeri vengono combinati con dati aggiuntivi che consentono a client e server di creare il segreto condiviso, denominato master secret.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-118">These numbers are combined with additional data permitting client and server to create their shared secret, called the Master Secret.</span></span> <span data-ttu-id="8ef7d-119">Il master secret viene utilizzato dal client e dal server per generare il segreto di scrittura, ovvero la chiave della sessione utilizzata per l' [*hashing*](../secgloss/h-gly.md), e la chiave di scrittura, ovvero la [*chiave di sessione*](../secgloss/s-gly.md) utilizzata per la crittografia.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-119">The Master Secret is used by client and server to generate the write MAC secret, which is the session key used for [*hashing*](../secgloss/h-gly.md), and the write key, which is the [*session key*](../secgloss/s-gly.md) used for encryption.</span></span>

## <a name="establishing-a-secure-session-by-using-tls"></a><span data-ttu-id="8ef7d-120">Stabilire una sessione protetta usando TLS</span><span class="sxs-lookup"><span data-stu-id="8ef7d-120">Establishing a Secure Session by Using TLS</span></span>

<span data-ttu-id="8ef7d-121">Il protocollo di handshake TLS prevede i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="8ef7d-121">The TLS Handshake Protocol involves the following steps:</span></span>

1.  <span data-ttu-id="8ef7d-122">Il client invia al server un messaggio "Hello client", insieme al valore casuale del client e ai pacchetti di crittografia supportati.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-122">The client sends a "Client hello" message to the server, along with the client's random value and supported cipher suites.</span></span>
2.  <span data-ttu-id="8ef7d-123">Il server risponde inviando un messaggio "Server Hello" al client, insieme al valore casuale del server.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-123">The server responds by sending a "Server hello" message to the client, along with the server's random value.</span></span>
3.  <span data-ttu-id="8ef7d-124">Il server invia il certificato al client per l'autenticazione e può richiedere un certificato dal client.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-124">The server sends its certificate to the client for authentication and may request a certificate from the client.</span></span> <span data-ttu-id="8ef7d-125">Il server invia il messaggio "Server Hello done".</span><span class="sxs-lookup"><span data-stu-id="8ef7d-125">The server sends the "Server hello done" message.</span></span>
4.  <span data-ttu-id="8ef7d-126">Se il server ha richiesto un certificato dal client, il client lo invierà.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-126">If the server has requested a certificate from the client, the client sends it.</span></span>
5.  <span data-ttu-id="8ef7d-127">Il client crea un segreto preliminare casuale e lo crittografa con la [*chiave pubblica*](../secgloss/p-gly.md) dal certificato del server, inviando il segreto pre-master crittografato al server.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-127">The client creates a random Pre-Master Secret and encrypts it with the [*public key*](../secgloss/p-gly.md) from the server's certificate, sending the encrypted Pre-Master Secret to the server.</span></span>
6.  <span data-ttu-id="8ef7d-128">Il server riceve il segreto pre-master.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-128">The server receives the Pre-Master Secret.</span></span> <span data-ttu-id="8ef7d-129">Il server e il client generano ognuno il master secret e le [*chiavi di sessione*](../secgloss/s-gly.md) in base al master secret.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-129">The server and client each generate the Master Secret and [*session keys*](../secgloss/s-gly.md) based on the Pre-Master Secret.</span></span>
7.  <span data-ttu-id="8ef7d-130">Il client invia una notifica di "modifica specifica crittografia" al server per indicare che il client inizierà a utilizzare le nuove [*chiavi di sessione*](../secgloss/s-gly.md) per l' [*hashing*](../secgloss/h-gly.md) e la crittografia dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-130">The client sends "Change cipher spec" notification to server to indicate that the client will start using the new [*session keys*](../secgloss/s-gly.md) for [*hashing*](../secgloss/h-gly.md) and encrypting messages.</span></span> <span data-ttu-id="8ef7d-131">Il client invia anche il messaggio "client completato".</span><span class="sxs-lookup"><span data-stu-id="8ef7d-131">Client also sends "Client finished" message.</span></span>
8.  <span data-ttu-id="8ef7d-132">Il server riceve "modifica specifica crittografia" e passa lo stato di sicurezza del livello record alla [*crittografia simmetrica*](../secgloss/s-gly.md) usando le [*chiavi di sessione*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="8ef7d-132">Server receives "Change cipher spec" and switches its record layer security state to [*symmetric encryption*](../secgloss/s-gly.md) using the [*session keys*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="8ef7d-133">Il server invia il messaggio "Server completato" al client.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-133">Server sends "Server finished" message to the client.</span></span>
9.  <span data-ttu-id="8ef7d-134">Il client e il server possono ora scambiare dati dell'applicazione tramite il canale protetto stabilito.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-134">Client and server can now exchange application data over the secured channel they have established.</span></span> <span data-ttu-id="8ef7d-135">Tutti i messaggi inviati dal client al server e dal server al client vengono crittografati tramite la chiave della sessione.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-135">All messages sent from client to server and from server to client are encrypted using session key.</span></span>

## <a name="resuming-a-secure-session-by-using-tls"></a><span data-ttu-id="8ef7d-136">Ripresa di una sessione protetta tramite TLS</span><span class="sxs-lookup"><span data-stu-id="8ef7d-136">Resuming a Secure Session by Using TLS</span></span>

1.  <span data-ttu-id="8ef7d-137">Il client invia un messaggio "Hello client" utilizzando l'ID sessione della sessione da riprendere.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-137">The client sends a "Client hello" message using the Session ID of the session to be resumed.</span></span>
2.  <span data-ttu-id="8ef7d-138">Il server controlla la cache della sessione per un ID di sessione corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-138">The server checks its session cache for a matching Session ID.</span></span> <span data-ttu-id="8ef7d-139">Se viene trovata una corrispondenza e il server è in grado di riprendere la sessione, invia un messaggio "Server Hello" con l'ID sessione.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-139">If a match is found, and the server is able to resume the session, it sends a "Server hello" message with the Session ID.</span></span>
    > [!Note]  
    > <span data-ttu-id="8ef7d-140">Se non viene trovata una corrispondenza con ID di sessione, il server genera un nuovo ID di sessione e il client e il server TLS eseguono un handshake completo.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-140">If a session ID match is not found, the server generates a new session ID and the TLS client and server perform a full handshake.</span></span>

     

3.  <span data-ttu-id="8ef7d-141">Il client e il server devono scambiare messaggi di "modifica della specifica della crittografia" e inviare i messaggi "client terminato" e "Server completato".</span><span class="sxs-lookup"><span data-stu-id="8ef7d-141">Client and server must exchange "Change cipher spec" messages and send "Client finished" and "Server finished" messages.</span></span>
4.  <span data-ttu-id="8ef7d-142">Il client e il server possono ora riprendere lo scambio di dati dell'applicazione sul canale sicuro.</span><span class="sxs-lookup"><span data-stu-id="8ef7d-142">Client and server can now resume application data exchange over the secure channel.</span></span>

 

 
