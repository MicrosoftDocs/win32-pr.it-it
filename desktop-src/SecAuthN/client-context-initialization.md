---
description: Inizializzazione del contesto client
ms.assetid: 0c8aad3e-e726-49ce-8fc9-94dbd60cc5cb
title: Inizializzazione del contesto client
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 615ce5c157371f1ebfec685d6227bd11a1d76531
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131063"
---
# <a name="client-context-initialization"></a><span data-ttu-id="799ac-103">Inizializzazione del contesto client</span><span class="sxs-lookup"><span data-stu-id="799ac-103">Client Context Initialization</span></span>

<span data-ttu-id="799ac-104">Per stabilire una connessione protetta, il client acquisisce un handle delle [*credenziali*](/windows/desktop/SecGloss/c-gly) in uscita prima di inviare una richiesta di autenticazione al server.</span><span class="sxs-lookup"><span data-stu-id="799ac-104">To establish a secure connection, the client acquires an outbound [*credentials*](/windows/desktop/SecGloss/c-gly) handle before sending an authentication request to the server.</span></span> <span data-ttu-id="799ac-105">Il server crea un contesto di sicurezza per il client dalla richiesta di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="799ac-105">The server creates a security context for the client from the authentication request.</span></span> <span data-ttu-id="799ac-106">La configurazione dell'autenticazione prevede due funzioni SSPI sul lato client:</span><span class="sxs-lookup"><span data-stu-id="799ac-106">There are two client-side SSPI functions involved in authentication setup:</span></span>

-   <span data-ttu-id="799ac-107">[**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) ottiene un riferimento alle [*credenziali*](/windows/desktop/SecGloss/c-gly)di accesso ottenute in precedenza.</span><span class="sxs-lookup"><span data-stu-id="799ac-107">[**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) obtains a reference to previously obtained logon [*credentials*](/windows/desktop/SecGloss/c-gly).</span></span>
-   <span data-ttu-id="799ac-108">[**InitializeSecurityContext (generale)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) crea i token di sicurezza della richiesta di autenticazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="799ac-108">[**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) creates the initial authentication request security tokens.</span></span>

<span data-ttu-id="799ac-109">Il codice per questo processo può essere visualizzato nella funzione **GenClientContext** nell' [uso di SSPI con un client Windows Sockets](using-sspi-with-a-windows-sockets-client.md).</span><span class="sxs-lookup"><span data-stu-id="799ac-109">Code for this process can be seen in the **GenClientContext** function in [Using SSPI with a Windows Sockets Client](using-sspi-with-a-windows-sockets-client.md).</span></span>

<span data-ttu-id="799ac-110">Se un programma client deve usare le credenziali in aggiunta alle proprie credenziali di accesso, ad esempio un nome utente, un nome di dominio e una password diversi, li fornisce nella chiamata [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) con una struttura di [**\_ \_ \_ identità di autenticazione WinNT sec**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) che specifica le credenziali aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="799ac-110">If a client program needs to use credentials in addition to its own logon credentials, such as a different user name, domain name, and password, it provides them in the [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) call with a [**SEC\_WINNT\_AUTH\_IDENTITY**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) structure specifying the additional credentials.</span></span> <span data-ttu-id="799ac-111">Per ulteriori informazioni sulle funzioni di credenziali, vedere [gestione delle](authentication-functions.md)credenziali.</span><span class="sxs-lookup"><span data-stu-id="799ac-111">For more information on credentials functions, see [Credential Management](authentication-functions.md).</span></span>

> [!Note]  
> <span data-ttu-id="799ac-112">Il membro dei **flag** della struttura di [**\_ \_ \_ identità di autenticazione WinNT sec**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) può essere impostato su sec \_ WinNT \_ auth \_ Identity \_ ANSI quando le stringhe nella struttura sono asci o OEM.</span><span class="sxs-lookup"><span data-stu-id="799ac-112">The **Flags** member of the [**SEC\_WINNT\_AUTH\_IDENTITY**](/windows/win32/api/sspi/ns-sspi-sec_winnt_auth_identity_a) structure can be set to SEC\_WINNT\_AUTH\_IDENTITY\_ANSI when strings in the structure are ASCI or OEM.</span></span> <span data-ttu-id="799ac-113">Le stringhe ANSI possono essere utilizzate con il membro dei **flag** della struttura di **\_ \_ \_ identità di autenticazione WinNT sec** impostata su sec \_ WinNT \_ auth \_ Identity \_ Unicode se vengono prima convertite in [*Unicode*](/windows/desktop/SecGloss/u-gly) tramite la funzione [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) .</span><span class="sxs-lookup"><span data-stu-id="799ac-113">ANSI strings can be used with the **Flags** member of the **SEC\_WINNT\_AUTH\_IDENTITY** structure set to SEC\_WINNT\_AUTH\_IDENTITY\_UNICODE if they are first converted to [*Unicode*](/windows/desktop/SecGloss/u-gly) by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function.</span></span>

 

<span data-ttu-id="799ac-114">Per avviare la prima parte dell'autenticazione, il client chiama [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) per ottenere un token di sicurezza iniziale da inviare in un messaggio di richiesta di connessione al server.</span><span class="sxs-lookup"><span data-stu-id="799ac-114">To initiate the first leg of the authentication, the client calls [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) to obtain an initial security token to be sent in a connection request message to the server.</span></span>

<span data-ttu-id="799ac-115">Il client utilizza le informazioni sul token di sicurezza ricevute nel descrittore del buffer di output per generare un messaggio da inviare al server.</span><span class="sxs-lookup"><span data-stu-id="799ac-115">The client uses the security token information received in the output buffer descriptor to generate a message to send to the server.</span></span> <span data-ttu-id="799ac-116">La costruzione del messaggio, in termini di posizionamento di diversi buffer e così via, fa parte del [*protocollo dell'applicazione*](/windows/desktop/SecGloss/a-gly) e deve essere riconosciuta da entrambe le parti.</span><span class="sxs-lookup"><span data-stu-id="799ac-116">The construction of the message, in terms of placement of various buffers and so forth, is part of the [*application protocol*](/windows/desktop/SecGloss/a-gly) and must be understood by both parties.</span></span>

<span data-ttu-id="799ac-117">Il client controlla lo stato di restituzione da [**InitializeSecurityContext (generale)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) per verificare se l'autenticazione viene completata in un'unica chiamata.</span><span class="sxs-lookup"><span data-stu-id="799ac-117">The client checks the return status from [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) to see if authentication will complete in a single call.</span></span> <span data-ttu-id="799ac-118">Lo stato di restituzione di SEC \_ \_ continua \_ necessario indica che il protocollo di sicurezza richiede più messaggi di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="799ac-118">A return status of SEC\_I\_CONTINUE\_NEEDED indicates that the security protocol requires multiple authentication messages.</span></span> <span data-ttu-id="799ac-119">Per ulteriori informazioni sulle funzioni di contesto, vedere [gestione del contesto](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="799ac-119">For more information on context functions, see [Context Management](authentication-functions.md).</span></span>

 

 
