---
description: Le funzioni di rete di Windows restituiscono l' \_ esito positivo in caso di esito positivo oppure restituiscono un valore diverso da zero se la funzione rileva un errore. Inoltre, restituiscono informazioni estese sugli errori utilizzando WNetSetLastError e SetLastError.
ms.assetid: cb9d29a1-b3a5-4440-a069-3cd1565b1699
title: Restituzione di valori a MPR
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c96a5636f57d5c926af4e43e676f0b6db75d164
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967391"
---
# <a name="returning-values-to-the-mpr"></a><span data-ttu-id="5ff0c-104">Restituzione di valori a MPR</span><span class="sxs-lookup"><span data-stu-id="5ff0c-104">Returning Values to the MPR</span></span>

<span data-ttu-id="5ff0c-105">Le funzioni di rete di Windows restituiscono l' \_ esito positivo in caso di esito positivo oppure restituiscono un valore diverso da zero se la funzione rileva un errore.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-105">The Windows Networking functions return WN\_SUCCESS on success, or they return a unique nonzero value if the function encounters an error.</span></span> <span data-ttu-id="5ff0c-106">Inoltre, restituiscono informazioni estese sugli errori utilizzando [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) e [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span><span class="sxs-lookup"><span data-stu-id="5ff0c-106">In addition, they return extended error information using [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) and [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror).</span></span>

<span data-ttu-id="5ff0c-107">Per supportare il comportamento precedente, le funzioni del provider di rete non devono chiamare [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) prima di restituire.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-107">To support the above behavior, network provider functions should not call [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) before returning.</span></span> <span data-ttu-id="5ff0c-108">Questo è dovuto al fatto che MPR chiama **SetLastError** per le funzioni nell'API del provider di rete dopo la restituzione.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-108">This is because the MPR calls **SetLastError** for the functions in the Network Provider API after they return.</span></span> <span data-ttu-id="5ff0c-109">Se i provider di rete chiamano direttamente **SetLastError** , verranno effettuate chiamate di funzione ridondanti.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-109">If the network providers call **SetLastError** directly, they will be making redundant function calls.</span></span> <span data-ttu-id="5ff0c-110">Le funzioni del provider di rete devono semplicemente restituire un codice di errore.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-110">Network provider functions should simply return an error code.</span></span> <span data-ttu-id="5ff0c-111">I codici di errore vengono specificati nella descrizione della funzione o nei [valori restituiti](network-security-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="5ff0c-111">The error codes are specified in the function description or [Return Values](network-security-return-values.md).</span></span> <span data-ttu-id="5ff0c-112">Inoltre, le funzioni del provider di rete possono restituire eventuali [codici di errore di sistema](../debug/system-error-codes.md), ad esempio memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-112">Also, network provider functions may return any [System Error Codes](../debug/system-error-codes.md), such as insufficient memory.</span></span> <span data-ttu-id="5ff0c-113">L'unica eccezione è [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), che deve restituire una maschera che indica le funzioni supportate dal provider di rete.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-113">The only exception is [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps), which should return a mask indicating the functions supported by the network provider.</span></span>

<span data-ttu-id="5ff0c-114">Se una funzione del provider di rete deve restituire informazioni estese sugli errori, deve chiamare [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span><span class="sxs-lookup"><span data-stu-id="5ff0c-114">If a network provider function needs to return extended error information, it should call [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora).</span></span> <span data-ttu-id="5ff0c-115">Questa funzione viene fornita dal sistema operativo Windows per l'uso da parte dei provider di rete.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-115">This function is provided by the Windows operating system for use by network providers.</span></span> <span data-ttu-id="5ff0c-116">Quando il provider chiama **WNetSetLastError**, può impostare una stringa contenente informazioni aggiuntive sull'errore.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-116">When the provider calls **WNetSetLastError**, it can set a string containing additional information about the error.</span></span> <span data-ttu-id="5ff0c-117">Queste informazioni vengono archiviate in base ai singoli thread.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-117">This information is stored on a per-thread basis.</span></span> <span data-ttu-id="5ff0c-118">Questo è analogo a [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) per le applicazioni Windows.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-118">This is analogous to [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) for Windows applications.</span></span> <span data-ttu-id="5ff0c-119">Il sistema operativo Windows chiama **WNetSetLastError** per verificare la presenza di una stringa archiviata con **WNetSetLastError** e, se presente, restituisce le informazioni estese sull'errore all'applicazione chiamante che ha avviato la richiesta di rete.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-119">The Windows operating system calls **WNetSetLastError** to check for a string stored using **WNetSetLastError** and, if found, returns the extended error information to the calling application that initiated the network request.</span></span>

> [!Note]  
> <span data-ttu-id="5ff0c-120">Il prefisso WNet di [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) è fuorviante perché questa API, a differenza di **WNetSetLastError**, non fa parte del set di API di rete di Windows.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-120">The WNet prefix of [**WNetSetLastError**](/windows/desktop/api/Npapi/nf-npapi-wnetsetlasterrora) is misleading since this API, unlike **WNetSetLastError**, is not part of the Windows Networking API set.</span></span> <span data-ttu-id="5ff0c-121">**WNetSetLastError** deve essere utilizzato solo dai provider di rete.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-121">**WNetSetLastError** is intended for use only by network providers.</span></span> <span data-ttu-id="5ff0c-122">Il nome **WNetSetLastError** viene mantenuto per la compatibilità con i provider esistenti.</span><span class="sxs-lookup"><span data-stu-id="5ff0c-122">The name, **WNetSetLastError**, is retained for compatibility with existing providers.</span></span>

 

 

 
