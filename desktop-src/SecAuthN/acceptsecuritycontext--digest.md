---
description: Consente al componente server di un'applicazione di trasporto di stabilire un contesto di sicurezza tra il server e un client remoto che utilizza il digest.
ms.assetid: 017683e3-b21a-4e97-9232-582ac7dbd5b2
title: Funzione AcceptSecurityContext (digest) (SSPI. h)
ms.topic: article
ms.date: 07/25/2019
ms.openlocfilehash: 11ffa801612f14f5b9aaf61e7d48b61377bc9e56
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/05/2021
ms.locfileid: "104058486"
---
# <a name="acceptsecuritycontext-digest-function"></a><span data-ttu-id="60044-103">Funzione AcceptSecurityContext (digest)</span><span class="sxs-lookup"><span data-stu-id="60044-103">AcceptSecurityContext (Digest) function</span></span>

<span data-ttu-id="60044-104">La funzione **AcceptSecurityContext (digest)** consente al componente server di un'applicazione di trasporto di stabilire un [*contesto di sicurezza*](../secgloss/s-gly.md) tra il server e un client remoto.</span><span class="sxs-lookup"><span data-stu-id="60044-104">The **AcceptSecurityContext (Digest)** function enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client.</span></span> <span data-ttu-id="60044-105">Il client remoto utilizza la funzione [**InitializeSecurityContext (digest)**](initializesecuritycontext--digest.md) per avviare il processo di creazione di un contesto di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="60044-105">The remote client uses the [**InitializeSecurityContext (Digest)**](initializesecuritycontext--digest.md) function to start the process of establishing a security context.</span></span> <span data-ttu-id="60044-106">Il server può richiedere uno o più token di risposta dal client remoto per completare la creazione del contesto di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="60044-106">The server can require one or more reply tokens from the remote client to complete establishing the security context.</span></span>

## <a name="syntax"></a><span data-ttu-id="60044-107">Sintassi</span><span class="sxs-lookup"><span data-stu-id="60044-107">Syntax</span></span>


```C++
SECURITY_STATUS SEC_Entry AcceptSecurityContext(
  _In_opt_    PCredHandle    phCredential,
  _Inout_opt_ PCtxtHandle    phContext,
  _In_opt_    PSecBufferDesc pInput,
  _In_        ULONG          fContextReq,
  _In_        ULONG          TargetDataRep,
  _Inout_opt_ PCtxtHandle    phNewContext,
  _Inout_opt_ PSecBufferDesc pOutput,
  _Out_       PULONG         pfContextAttr,
  _Out_opt_   PTimeStamp     ptsExpiry
);
```



## <a name="parameters"></a><span data-ttu-id="60044-108">Parametri</span><span class="sxs-lookup"><span data-stu-id="60044-108">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="60044-109">*phCredential* \[ in, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-109">*phCredential* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-110">Handle per le credenziali del server.</span><span class="sxs-lookup"><span data-stu-id="60044-110">A handle to the credentials of the server.</span></span> <span data-ttu-id="60044-111">Il server chiama la funzione [**AcquireCredentialsHandle (digest)**](acquirecredentialshandle--digest.md) con il flag SECPKG \_ cred \_ in ingresso o SECPKG \_ cred \_ entrambi impostati per recuperare questo handle.</span><span class="sxs-lookup"><span data-stu-id="60044-111">The server calls the [**AcquireCredentialsHandle (Digest)**](acquirecredentialshandle--digest.md) function with either the SECPKG\_CRED\_INBOUND or SECPKG\_CRED\_BOTH flag set to retrieve this handle.</span></span>

</dd> <dt>

<span data-ttu-id="60044-112">*phContext* \[ in, out, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-112">*phContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-113">Puntatore a una struttura [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="60044-113">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="60044-114">Alla prima chiamata a **AcceptSecurityContext (digest)**, questo puntatore è **null**.</span><span class="sxs-lookup"><span data-stu-id="60044-114">On the first call to **AcceptSecurityContext (Digest)**, this pointer is **NULL**.</span></span> <span data-ttu-id="60044-115">Nelle chiamate successive, *phContext* è l'handle per il contesto parzialmente formattato che è stato restituito nel parametro *phNewContext* dalla prima chiamata.</span><span class="sxs-lookup"><span data-stu-id="60044-115">On subsequent calls, *phContext* is the handle to the partially formed context that was returned in the *phNewContext* parameter by the first call.</span></span>

</dd> <dt>

<span data-ttu-id="60044-116">*Pinput* \[ in, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-116">*pInput* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-117">Puntatore a una struttura [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) generata da una chiamata client a [**InitializeSecurityContext (digest)**](initializesecuritycontext--digest.md) che contiene il descrittore del buffer di input.</span><span class="sxs-lookup"><span data-stu-id="60044-117">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure generated by a client call to [**InitializeSecurityContext (Digest)**](initializesecuritycontext--digest.md) that contains the input buffer descriptor.</span></span>

<span data-ttu-id="60044-118">La tabella seguente illustra la configurazione del buffer per il digest HTTP.</span><span class="sxs-lookup"><span data-stu-id="60044-118">The following table shows the buffer configuration for Digest HTTP.</span></span> <span data-ttu-id="60044-119">Il primo buffer deve essere di tipo **\_ token SECBUFFER** e il resto deve essere di tipo **SECBUFFER \_ pkg \_ params**.</span><span class="sxs-lookup"><span data-stu-id="60044-119">The first buffer must be of type **SECBUFFER\_TOKEN**, and the rest must be of type **SECBUFFER\_PKG\_PARAMS**.</span></span> <span data-ttu-id="60044-120">SASL richiede solo il buffer zero.</span><span class="sxs-lookup"><span data-stu-id="60044-120">SASL requires only buffer zero.</span></span>



| <span data-ttu-id="60044-121">\#Tipo di/buffer buffer</span><span class="sxs-lookup"><span data-stu-id="60044-121">Buffer \#/buffer type</span></span>                                                                                                                                                                                                 | <span data-ttu-id="60044-122">Significato</span><span class="sxs-lookup"><span data-stu-id="60044-122">Meaning</span></span>                                                                                                                                                                  |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="0"></span><dl> <span data-ttu-id="60044-123"><dt>**0**</dt> <dt> **\_ token SECBUFFER**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-123"><dt>**0**</dt> <dt>**SECBUFFER\_TOKEN**</dt></span></span> </dl>                                        | <span data-ttu-id="60044-124">Empty per la prima chiamata e la risposta alla richiesta di verifica ricevuta dal client per la seconda chiamata.</span><span class="sxs-lookup"><span data-stu-id="60044-124">Empty for the first call and the challenge response received from the client for the second call.</span></span><br/>                                                             |
| <span id="1"></span><dl> <span data-ttu-id="60044-125"><dt>**1**</dt> <dt> **SECBUFFER \_ pkg \_ params**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-125"><dt>**1**</dt> <dt>**SECBUFFER\_PKG\_PARAMS**</dt></span></span> </dl>                                  | <span data-ttu-id="60044-126">Metodo.</span><span class="sxs-lookup"><span data-stu-id="60044-126">Method.</span></span> <span data-ttu-id="60044-127">Il formato dei caratteri è wireline dalla riga della richiesta.</span><span class="sxs-lookup"><span data-stu-id="60044-127">Characters are wireline format from the request line.</span></span> <span data-ttu-id="60044-128">Caratteri US ASCII a byte singolo.</span><span class="sxs-lookup"><span data-stu-id="60044-128">US ASCII single-byte characters.</span></span><br/>                                                                |
| <span id="2"></span><dl> <span data-ttu-id="60044-129"><dt>**2**</dt> <dt> **\_ \_ parametri pkg SECBUFFER**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-129"><dt>**2**</dt> <dt>**SECBUFFER\_PKG\_PARAMS**</dt></span></span> </dl>                                  | <span data-ttu-id="60044-130">Riservato.</span><span class="sxs-lookup"><span data-stu-id="60044-130">Reserved.</span></span><br/>                                                                                                                                                     |
| <span id="3"></span><dl> <span data-ttu-id="60044-131"><dt>**3**</dt> <dt> **\_ \_ params SECBUFFER pkg**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-131"><dt>**3**</dt> <dt>**SECBUFFER\_PKG\_PARAMS**</dt></span></span> </dl>                                  | <span data-ttu-id="60044-132">HEntity.</span><span class="sxs-lookup"><span data-stu-id="60044-132">HEntity.</span></span> <span data-ttu-id="60044-133">Rappresentazione esadecimale di H (entità-Body).</span><span class="sxs-lookup"><span data-stu-id="60044-133">Hexadecimal representation of H(entity-body).</span></span> <span data-ttu-id="60044-134">Caratteri US ASCII a byte singolo.</span><span class="sxs-lookup"><span data-stu-id="60044-134">US ASCII single-byte characters.</span></span><br/>                                                                       |
| <span id="4"></span><dl> <span data-ttu-id="60044-135"><dt>**4**</dt> <dt> **\_ \_ parametri pkg SECBUFFER**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-135"><dt>**4**</dt> <dt>**SECBUFFER\_PKG\_PARAMS**</dt></span></span> </dl>                                  | <span data-ttu-id="60044-136">Autenticazione.</span><span class="sxs-lookup"><span data-stu-id="60044-136">Realm.</span></span> <span data-ttu-id="60044-137">Stringa dell'area di autenticazione per la richiesta.</span><span class="sxs-lookup"><span data-stu-id="60044-137">Realm string for the challenge.</span></span> <span data-ttu-id="60044-138">Stringa Unicode che deve essere rappresentabile nel formato ASCII US.</span><span class="sxs-lookup"><span data-stu-id="60044-138">Unicode string that must be representable in US ASCII.</span></span><br/>                                                                 |
| <span id="5"></span><dl> <span data-ttu-id="60044-139"><dt>**5**</dt> <dt> **\_ \_ binding di canale SECBUFFER** \| **SECBUFFER \_ ReadOnly**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-139"><dt>**5**</dt> <dt>**SECBUFFER\_CHANNEL\_BINDINGS** \| **SECBUFFER\_READONLY**</dt></span></span> </dl> | <span data-ttu-id="60044-140">Contiene il valore del token di associazione del canale.</span><span class="sxs-lookup"><span data-stu-id="60044-140">Contains the channel binding token value.</span></span><br/> <span data-ttu-id="60044-141">**Windows server 2008, Windows Vista, Windows server 2003 e Windows XP:** Questo valore non è supportato.</span><span class="sxs-lookup"><span data-stu-id="60044-141">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** This value is not supported.</span></span><br/> |



 

</dd> <dt>

<span data-ttu-id="60044-142">*fContextReq* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="60044-142">*fContextReq* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-143">Flag di bit che specificano gli attributi necessari al server per stabilire il contesto.</span><span class="sxs-lookup"><span data-stu-id="60044-143">Bit flags that specify the attributes required by the server to establish the context.</span></span> <span data-ttu-id="60044-144">I flag di bit possono essere combinati usando **operazioni OR bit per** bit.</span><span class="sxs-lookup"><span data-stu-id="60044-144">Bit flags can be combined by using bitwise-**OR** operations.</span></span> <span data-ttu-id="60044-145">Il parametro può essere costituito da uno o più dei valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="60044-145">This parameter can be one or more of the following values.</span></span>



| <span data-ttu-id="60044-146">Valore</span><span class="sxs-lookup"><span data-stu-id="60044-146">Value</span></span>                                                                                                                                                                                                                                          | <span data-ttu-id="60044-147">Significato</span><span class="sxs-lookup"><span data-stu-id="60044-147">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="ASC_REQ_ALLOCATE_MEMORY"></span><span id="asc_req_allocate_memory"></span><dl> <span data-ttu-id="60044-148"><dt>**ASC \_ req \_ alloca \_ memoria**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-148"><dt>**ASC\_REQ\_ALLOCATE\_MEMORY**</dt></span></span> </dl>                                                  | <span data-ttu-id="60044-149">Il digest alloca automaticamente i buffer di output.</span><span class="sxs-lookup"><span data-stu-id="60044-149">Digest allocates output buffers for you.</span></span> <span data-ttu-id="60044-150">Al termine dell'utilizzo dei buffer di output, è possibile liberarli chiamando la funzione [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) .</span><span class="sxs-lookup"><span data-stu-id="60044-150">When you have finished using the output buffers, free them by calling the [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span><br/>                                                                                                                                                                                                                                      |
| <span id="ASC_REQ_ALLOW_MISSING_BINDINGS"></span><span id="asc_req_allow_missing_bindings"></span><dl> <span data-ttu-id="60044-151"><dt>**ASC \_ req \_ consente \_ le \_ associazioni mancanti**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-151"><dt>**ASC\_REQ\_ALLOW\_MISSING\_BINDINGS**</dt></span></span> </dl>                            | <span data-ttu-id="60044-152">Indica che il digest non richiede binding di canale per i canali interni ed esterni.</span><span class="sxs-lookup"><span data-stu-id="60044-152">Indicates that Digest does not require channel bindings for both inner and outer channels.</span></span> <span data-ttu-id="60044-153">Questo valore viene utilizzato per la compatibilità con le versioni precedenti quando il supporto per l'associazione di canale dell'endpoint non è noto.</span><span class="sxs-lookup"><span data-stu-id="60044-153">This value is used for backward compatibility when support for endpoint channel binding is not known.</span></span><br/> <span data-ttu-id="60044-154">Questo valore si escludono a vicenda con le **\_ \_ \_ associazioni proxy ASC req**.</span><span class="sxs-lookup"><span data-stu-id="60044-154">This value is mutually exclusive with **ASC\_REQ\_PROXY\_BINDINGS**.</span></span><br/> <span data-ttu-id="60044-155">**Windows server 2008, Windows Vista, Windows server 2003 e Windows XP:** Questo valore non è supportato.</span><span class="sxs-lookup"><span data-stu-id="60044-155">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** This value is not supported.</span></span><br/> <br/> |
| <span id="ASC_REQ_CONFIDENTIALITY"></span><span id="asc_req_confidentiality"></span><dl> <span data-ttu-id="60044-156"><dt>**\_ \_ riservatezza ASC req**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-156"><dt>**ASC\_REQ\_CONFIDENTIALITY**</dt></span></span> </dl>                                                   | <span data-ttu-id="60044-157">Crittografare e decrittografare i messaggi.</span><span class="sxs-lookup"><span data-stu-id="60044-157">Encrypt and decrypt messages.</span></span> <br/> <span data-ttu-id="60044-158">Il provider SSP digest supporta questo flag solo per SASL.</span><span class="sxs-lookup"><span data-stu-id="60044-158">The Digest SSP supports this flag for SASL only.</span></span><br/>                                                                                                                                                                                                                                                                                                                       |
| <span id="ASC_REQ_PROXY_BINDINGS"></span><span id="asc_req_proxy_bindings"></span><dl> <span data-ttu-id="60044-159"><dt>**\_ \_ Binding proxy ASC \_ req**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-159"><dt>**ASC\_REQ\_PROXY\_BINDINGS**</dt></span></span> </dl>                                                     | <span data-ttu-id="60044-160">Indica che il digest richiede l'associazione di canale.</span><span class="sxs-lookup"><span data-stu-id="60044-160">Indicates that Digest requires channel binding.</span></span><br/> <span data-ttu-id="60044-161">Questo valore si escludono a vicenda con **ASC \_ req consente le \_ \_ \_ associazioni mancanti**.</span><span class="sxs-lookup"><span data-stu-id="60044-161">This value is mutually exclusive with **ASC\_REQ\_ALLOW\_MISSING\_BINDINGS**.</span></span><br/> <span data-ttu-id="60044-162">**Windows server 2008, Windows Vista, Windows server 2003 e Windows XP:** Questo valore non è supportato.</span><span class="sxs-lookup"><span data-stu-id="60044-162">**Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP:** This value is not supported.</span></span><br/> <br/>                                                                                                                                         |
| <span id="ASC_REQ_CONNECTION"></span><span id="asc_req_connection"></span><dl> <span data-ttu-id="60044-163"><dt>**\_connessione ASC req \_**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-163"><dt>**ASC\_REQ\_CONNECTION**</dt></span></span> </dl>                                                                  | <span data-ttu-id="60044-164">Il [*contesto di sicurezza*](../secgloss/s-gly.md) non gestirà i messaggi di formattazione.</span><span class="sxs-lookup"><span data-stu-id="60044-164">The [*security context*](../secgloss/s-gly.md) will not handle formatting messages.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                        |
| <span id="ASC_REQ_EXTENDED_ERROR"></span><span id="asc_req_extended_error"></span><dl> <span data-ttu-id="60044-165"><dt>**\_ \_ errore esteso di ASC req \_**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-165"><dt>**ASC\_REQ\_EXTENDED\_ERROR**</dt></span></span> </dl>                                                     | <span data-ttu-id="60044-166">Quando si verificano errori, viene inviata una notifica all'entità remota.</span><span class="sxs-lookup"><span data-stu-id="60044-166">When errors occur, the remote party will be notified.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                            |
| <span id="ASC_REQ_HTTP__0x10000000_"></span><span id="asc_req_http__0x10000000_"></span><span id="ASC_REQ_HTTP__0X10000000_"></span><dl> <span data-ttu-id="60044-167"><dt>**ASC \_ req \_ http (0x10000000)**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-167"><dt>**ASC\_REQ\_HTTP (0x10000000)**</dt></span></span> </dl> | <span data-ttu-id="60044-168">Usare digest per HTTP.</span><span class="sxs-lookup"><span data-stu-id="60044-168">Use Digest for HTTP.</span></span> <span data-ttu-id="60044-169">Omettere questo flag per utilizzare il digest come meccanismo SASL.</span><span class="sxs-lookup"><span data-stu-id="60044-169">Omit this flag to use Digest as an SASL mechanism.</span></span><br/>                                                                                                                                                                                                                                                                                                                                          |
| <span id="ASC_REQ_INTEGRITY"></span><span id="asc_req_integrity"></span><dl> <span data-ttu-id="60044-170"><dt>**integrità di ASC \_ req \_**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-170"><dt>**ASC\_REQ\_INTEGRITY**</dt></span></span> </dl>                                                                     | <span data-ttu-id="60044-171">Firmare i messaggi e verificare le firme.</span><span class="sxs-lookup"><span data-stu-id="60044-171">Sign messages and verify signatures.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="ASC_REQ_REPLAY_DETECT"></span><span id="asc_req_replay_detect"></span><dl> <span data-ttu-id="60044-172"><dt>**\_ \_ rilevamento riesecuzione di ASC req \_**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-172"><dt>**ASC\_REQ\_REPLAY\_DETECT**</dt></span></span> </dl>                                                        | <span data-ttu-id="60044-173">Rilevare i pacchetti riprodotti.</span><span class="sxs-lookup"><span data-stu-id="60044-173">Detect replayed packets.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="ASC_REQ_SEQUENCE_DETECT"></span><span id="asc_req_sequence_detect"></span><dl> <span data-ttu-id="60044-174"><dt>**\_ \_ rilevamento sequenza ASC \_ req**</dt></span><span class="sxs-lookup"><span data-stu-id="60044-174"><dt>**ASC\_REQ\_SEQUENCE\_DETECT**</dt></span></span> </dl>                                                  | <span data-ttu-id="60044-175">Rilevare i messaggi ricevuti fuori sequenza.</span><span class="sxs-lookup"><span data-stu-id="60044-175">Detect messages received out of sequence.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                        |



 

<span data-ttu-id="60044-176">Per i flag di attributo possibili e i relativi significati, vedere [requisiti di contesto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="60044-176">For possible attribute flags and their meanings, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="60044-177">I flag usati per questo parametro sono preceduti dal prefisso ASC \_ req, ad esempio, ASC \_ req \_ delegate.</span><span class="sxs-lookup"><span data-stu-id="60044-177">Flags used for this parameter are prefixed with ASC\_REQ, for example, ASC\_REQ\_DELEGATE.</span></span>

<span data-ttu-id="60044-178">Gli attributi richiesti potrebbero non essere supportati dal client.</span><span class="sxs-lookup"><span data-stu-id="60044-178">The requested attributes may not be supported by the client.</span></span> <span data-ttu-id="60044-179">Per ulteriori informazioni, vedere il parametro *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="60044-179">For more information, see the *pfContextAttr* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="60044-180">*TargetDataRep* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="60044-180">*TargetDataRep* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-181">Rappresentazione dei dati, ad esempio l'ordinamento dei byte, sulla destinazione.</span><span class="sxs-lookup"><span data-stu-id="60044-181">The data representation, such as byte ordering, on the target.</span></span> <span data-ttu-id="60044-182">Questo parametro può essere una sicurezza \_ nativa \_ DREP o DREP della rete di sicurezza \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="60044-182">This parameter can be either SECURITY\_NATIVE\_DREP or SECURITY\_NETWORK\_DREP.</span></span>

<span data-ttu-id="60044-183">Questo parametro non viene utilizzato con il provider SSP del digest.</span><span class="sxs-lookup"><span data-stu-id="60044-183">This parameter is not used with Digest SSP.</span></span> <span data-ttu-id="60044-184">Quando si utilizza SSP digest, specificare zero per questo parametro.</span><span class="sxs-lookup"><span data-stu-id="60044-184">When you use Digest SSP, specify zero for this parameter.</span></span>

</dd> <dt>

<span data-ttu-id="60044-185">*phNewContext* \[ in, out, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-185">*phNewContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-186">Puntatore a una struttura [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="60044-186">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="60044-187">Alla prima chiamata a **AcceptSecurityContext (digest)**, questo puntatore riceve il nuovo handle di contesto.</span><span class="sxs-lookup"><span data-stu-id="60044-187">On the first call to **AcceptSecurityContext (Digest)**, this pointer receives the new context handle.</span></span> <span data-ttu-id="60044-188">Nelle chiamate successive, *phNewContext* può corrispondere all'handle specificato nel parametro *phContext* .</span><span class="sxs-lookup"><span data-stu-id="60044-188">On subsequent calls, *phNewContext* can be the same as the handle specified in the *phContext* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="60044-189">*pOutput* \[ in, out, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-189">*pOutput* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-190">Puntatore a una struttura [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) che contiene il descrittore del buffer di output.</span><span class="sxs-lookup"><span data-stu-id="60044-190">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains the output buffer descriptor.</span></span> <span data-ttu-id="60044-191">Questo buffer viene inviato al client per l'input in chiamate aggiuntive a [**InitializeSecurityContext (digest)**](initializesecuritycontext--digest.md).</span><span class="sxs-lookup"><span data-stu-id="60044-191">This buffer is sent to the client for input into additional calls to [**InitializeSecurityContext (Digest)**](initializesecuritycontext--digest.md).</span></span> <span data-ttu-id="60044-192">Un buffer di output può essere generato anche se la funzione restituisce SEC \_ E \_ OK.</span><span class="sxs-lookup"><span data-stu-id="60044-192">An output buffer may be generated even if the function returns SEC\_E\_OK.</span></span> <span data-ttu-id="60044-193">Qualsiasi buffer generato deve essere restituito all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="60044-193">Any buffer generated must be sent back to the client application.</span></span>

</dd> <dt>

<span data-ttu-id="60044-194">*pfContextAttr* \[ out\]</span><span class="sxs-lookup"><span data-stu-id="60044-194">*pfContextAttr* \[out\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-195">Puntatore a una variabile che riceve un set di flag di bit che indicano gli attributi del contesto stabilito.</span><span class="sxs-lookup"><span data-stu-id="60044-195">A pointer to a variable that receives a set of bit flags that indicate the attributes of the established context.</span></span> <span data-ttu-id="60044-196">Per una descrizione dei vari attributi, vedere [requisiti di contesto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="60044-196">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="60044-197">I flag usati per questo parametro sono preceduti dal prefisso ASC \_ RET, ad esempio ASC \_ ret \_ delegate.</span><span class="sxs-lookup"><span data-stu-id="60044-197">Flags used for this parameter are prefixed with ASC\_RET, for example, ASC\_RET\_DELEGATE.</span></span>

<span data-ttu-id="60044-198">Non controllare gli attributi correlati alla sicurezza finché la chiamata di funzione finale non viene completata correttamente.</span><span class="sxs-lookup"><span data-stu-id="60044-198">Do not check for security-related attributes until the final function call returns successfully.</span></span> <span data-ttu-id="60044-199">I flag di attributo non correlati alla sicurezza, ad esempio \_ il \_ flag ASC RET allocazioned \_ Memory, possono essere controllati prima della restituzione finale.</span><span class="sxs-lookup"><span data-stu-id="60044-199">Attribute flags not related to security, such as the ASC\_RET\_ALLOCATED\_MEMORY flag, can be checked before the final return.</span></span>

</dd> <dt>

<span data-ttu-id="60044-200">*ptsTimeStamp* \[ out, facoltativo\]</span><span class="sxs-lookup"><span data-stu-id="60044-200">*ptsTimeStamp* \[out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="60044-201">Puntatore a una struttura di [**timestamp**](timestamp.md) che riceve l'ora di scadenza del contesto.</span><span class="sxs-lookup"><span data-stu-id="60044-201">A pointer to a [**TimeStamp**](timestamp.md) structure that receives the expiration time of the context.</span></span> <span data-ttu-id="60044-202">È consigliabile che il [*pacchetto di sicurezza*](../secgloss/s-gly.md) restituisca sempre questo valore nell'ora locale.</span><span class="sxs-lookup"><span data-stu-id="60044-202">We recommend that the [*security package*](../secgloss/s-gly.md) always return this value in local time.</span></span>

<span data-ttu-id="60044-203">Questo parametro è impostato su un tempo massimo costante.</span><span class="sxs-lookup"><span data-stu-id="60044-203">This parameter is set to a constant maximum time.</span></span> <span data-ttu-id="60044-204">Non esiste alcuna data di scadenza per il [*contesto di sicurezza*](../secgloss/s-gly.md)del digest o per le credenziali o quando si utilizza il provider SSP del digest.</span><span class="sxs-lookup"><span data-stu-id="60044-204">There is no expiration time for Digest [*security context*](../secgloss/s-gly.md)s or credentials or when using the Digest SSP.</span></span>

> [!Note]  
> <span data-ttu-id="60044-205">Fino all'ultima chiamata del processo di autenticazione, l'ora di scadenza per il contesto può non essere corretta perché verranno fornite ulteriori informazioni durante le fasi successive della negoziazione.</span><span class="sxs-lookup"><span data-stu-id="60044-205">Until the last call of the authentication process, the expiration time for the context can be incorrect because more information will be provided during later stages of the negotiation.</span></span> <span data-ttu-id="60044-206">Pertanto, *ptsTimeStamp* deve essere **null** fino all'ultima chiamata alla funzione.</span><span class="sxs-lookup"><span data-stu-id="60044-206">Therefore, *ptsTimeStamp* must be **NULL** until the last call to the function.</span></span>

 

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="60044-207">Valore restituito</span><span class="sxs-lookup"><span data-stu-id="60044-207">Return value</span></span>

<span data-ttu-id="60044-208">Questa funzione restituisce uno dei valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="60044-208">This function returns one of the following values.</span></span>



<table><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><thead><tr class="header"><th><span data-ttu-id="60044-209">Codice/valore restituito</span><span class="sxs-lookup"><span data-stu-id="60044-209">Return code/value</span></span></th><th><span data-ttu-id="60044-210">Descrizione</span><span class="sxs-lookup"><span data-stu-id="60044-210">Description</span></span></th></tr></thead><tbody><tr class="odd"><td><dl> <span data-ttu-id="60044-211"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-211"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span></span></dl></td><td><span data-ttu-id="60044-212">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-212">The function failed.</span></span> <span data-ttu-id="60044-213">La memoria disponibile non è sufficiente per completare l'azione richiesta.</span><span class="sxs-lookup"><span data-stu-id="60044-213">There is not enough memory available to complete the requested action.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-214"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-214"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span></span></dl></td><td><span data-ttu-id="60044-215">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-215">The function failed.</span></span> <span data-ttu-id="60044-216">Si è verificato un errore che non è stato mappato a un codice di errore SSPI.</span><span class="sxs-lookup"><span data-stu-id="60044-216">An error occurred that did not map to an SSPI error code.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-217"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-217"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span></span></dl></td><td><span data-ttu-id="60044-218">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-218">The function failed.</span></span> <span data-ttu-id="60044-219">L'handle passato alla funzione non è valido.</span><span class="sxs-lookup"><span data-stu-id="60044-219">The handle passed to the function is not valid.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-220"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-220"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span></span></dl></td><td><span data-ttu-id="60044-221">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-221">The function failed.</span></span> <span data-ttu-id="60044-222">Il token passato alla funzione non è valido.</span><span class="sxs-lookup"><span data-stu-id="60044-222">The token passed to the function is not valid.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-223"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-223"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span></span></dl></td><td><span data-ttu-id="60044-224">Accesso non riuscito.</span><span class="sxs-lookup"><span data-stu-id="60044-224">The logon failed.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-225"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-225"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span></span></dl></td><td><span data-ttu-id="60044-226">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-226">The function failed.</span></span> <span data-ttu-id="60044-227">Non è stato possibile contattare un'autorità per l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="60044-227">No authority could be contacted for authentication.</span></span> <span data-ttu-id="60044-228">Questo problema può essere dovuto alle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="60044-228">This could be due to the following conditions:</span></span><br/><ul><li><span data-ttu-id="60044-229">Il nome di dominio dell'entità di autenticazione non è corretto.</span><span class="sxs-lookup"><span data-stu-id="60044-229">The domain name of the authenticating party is incorrect.</span></span></li><li><span data-ttu-id="60044-230">Il dominio non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="60044-230">The domain is unavailable.</span></span></li><li><span data-ttu-id="60044-231">Relazione di trust non riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-231">The trust relationship has failed.</span></span></li></ul></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-232"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-232"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span></span></dl></td><td><span data-ttu-id="60044-233">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-233">The function failed.</span></span> <span data-ttu-id="60044-234">L'handle delle credenziali specificato nel parametro <em>phCredential</em> non è valido.</span><span class="sxs-lookup"><span data-stu-id="60044-234">The credentials handle specified in the <em>phCredential</em> parameter is not valid.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-235"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-235"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000L</dt> </span></span></dl></td><td><span data-ttu-id="60044-236">Funzione completata.</span><span class="sxs-lookup"><span data-stu-id="60044-236">The function succeeded.</span></span> <span data-ttu-id="60044-237">Il [*contesto di sicurezza*](../secgloss/s-gly.md) ricevuto dal client è stato accettato.</span><span class="sxs-lookup"><span data-stu-id="60044-237">The [*security context*](../secgloss/s-gly.md) received from the client was accepted.</span></span> <span data-ttu-id="60044-238">Se è stato generato un token di output dalla funzione, è necessario inviarlo al processo client.</span><span class="sxs-lookup"><span data-stu-id="60044-238">If an output token was generated by the function, it must be sent to the client process.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-239"><dt><strong>SEC_E_SECURITY_QOS_FAILED</strong></dt> <dt>0x80090332L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-239"><dt><strong>SEC_E_SECURITY_QOS_FAILED</strong></dt> <dt>0x80090332L</dt> </span></span></dl></td><td><span data-ttu-id="60044-240">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-240">The function failed.</span></span> <span data-ttu-id="60044-241">Il flag di attributo di contesto non valido è stato specificato nel parametro <em>fContextReq</em> .</span><span class="sxs-lookup"><span data-stu-id="60044-241">A context attribute flag that is not valid was specified in the <em>fContextReq</em> parameter.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-242"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-242"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span></span></dl></td><td><span data-ttu-id="60044-243">Funzione completata.</span><span class="sxs-lookup"><span data-stu-id="60044-243">The function succeeded.</span></span> <span data-ttu-id="60044-244">Il server deve chiamare [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-completeauthtoken) e passare il token di output al client.</span><span class="sxs-lookup"><span data-stu-id="60044-244">The server must call [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) and pass the output token to the client.</span></span> <span data-ttu-id="60044-245">Il server attende quindi un token restituito dal client e quindi effettua un'altra chiamata a [<strong>AcceptSecurityContext (digest)</strong>] (AcceptSecurityContext--digest.MD).</span><span class="sxs-lookup"><span data-stu-id="60044-245">The server then waits for a return token from the client and then makes another call to [<strong>AcceptSecurityContext (Digest)</strong>](acceptsecuritycontext--digest.md).</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-246"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-246"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span></span></dl></td><td><span data-ttu-id="60044-247">Funzione completata.</span><span class="sxs-lookup"><span data-stu-id="60044-247">The function succeeded.</span></span> <span data-ttu-id="60044-248">Il server deve terminare la compilazione del messaggio dal client, quindi chiamare la funzione [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-completeauthtoken).</span><span class="sxs-lookup"><span data-stu-id="60044-248">The server must finish building the message from the client and then call the [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) function.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-249"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-249"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span></span></dl></td><td><span data-ttu-id="60044-250">Funzione completata.</span><span class="sxs-lookup"><span data-stu-id="60044-250">The function succeeded.</span></span> <span data-ttu-id="60044-251">Il server deve inviare il token di output al client e attendere un token restituito.</span><span class="sxs-lookup"><span data-stu-id="60044-251">The server must send the output token to the client and wait for a returned token.</span></span> <span data-ttu-id="60044-252">Il token restituito deve essere passato in <em>Pinput</em> per un'altra chiamata a [<strong>AcceptSecurityContext (digest)</strong>] (AcceptSecurityContext--digest.MD).</span><span class="sxs-lookup"><span data-stu-id="60044-252">The returned token should be passed in <em>pInput</em> for another call to [<strong>AcceptSecurityContext (Digest)</strong>](acceptsecuritycontext--digest.md).</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="60044-253"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-253"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span></span></dl></td><td><span data-ttu-id="60044-254">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-254">The function failed.</span></span> <span data-ttu-id="60044-255">La funzione [<strong>AcceptSecurityContext (digest)</strong>] (AcceptSecurityContext--digest.MD) è stata chiamata dopo che è stato stabilito il contesto specificato.</span><span class="sxs-lookup"><span data-stu-id="60044-255">The [<strong>AcceptSecurityContext (Digest)</strong>](acceptsecuritycontext--digest.md) function was called after the specified context was established.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="60044-256"><dt><strong>SEC_E_BAD_BINDINGS</strong></dt> <dt>0x80090346L</dt> </span><span class="sxs-lookup"><span data-stu-id="60044-256"><dt><strong>SEC_E_BAD_BINDINGS</strong></dt> <dt>0x80090346L</dt> </span></span></dl></td><td><span data-ttu-id="60044-257">La funzione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="60044-257">The function failed.</span></span> <span data-ttu-id="60044-258">Il criterio di associazione del canale non è stato soddisfatto.</span><span class="sxs-lookup"><span data-stu-id="60044-258">Channel binding policy was not satisfied.</span></span><br/></td></tr></tbody></table>



 

## <a name="remarks"></a><span data-ttu-id="60044-259">Commenti</span><span class="sxs-lookup"><span data-stu-id="60044-259">Remarks</span></span>

<span data-ttu-id="60044-260">La funzione **AcceptSecurityContext (digest)** è la controparte del server della funzione [**InitializeSecurityContext (digest)**](initializesecuritycontext--digest.md) .</span><span class="sxs-lookup"><span data-stu-id="60044-260">The **AcceptSecurityContext (Digest)** function is the server counterpart to the [**InitializeSecurityContext (Digest)**](initializesecuritycontext--digest.md) function.</span></span>

<span data-ttu-id="60044-261">Quando il server riceve una richiesta da un client, il server usa il parametro *fContextReq* per specificare cosa richiede la sessione.</span><span class="sxs-lookup"><span data-stu-id="60044-261">When the server receives a request from a client, the server uses the *fContextReq* parameter to specify what it requires of the session.</span></span> <span data-ttu-id="60044-262">In questo modo, un server può specificare che i client devono essere in grado di usare una sessione riservata o controllata dall' [*integrità*](../secgloss/i-gly.md)e rifiutare i client che non sono in grado di soddisfare tale richiesta.</span><span class="sxs-lookup"><span data-stu-id="60044-262">In this fashion, a server can specify that clients must be capable of using a confidential or [*integrity*](../secgloss/i-gly.md)-checked session, and it can reject clients that cannot meet that demand.</span></span> <span data-ttu-id="60044-263">In alternativa, un server può non richiedere alcun elemento e qualsiasi altro elemento che il client può fornire o richiede viene restituito nel parametro *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="60044-263">Alternatively, a server can require nothing, and whatever the client can provide or requires is returned in the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="60044-264">Per un pacchetto che supporta l'autenticazione a più gambe, ad esempio l'autenticazione reciproca, la sequenza chiamante è la seguente:</span><span class="sxs-lookup"><span data-stu-id="60044-264">For a package that supports multiple-leg authentication, such as mutual authentication, the calling sequence is as follows:</span></span>

1.  <span data-ttu-id="60044-265">Il client trasmette un token al server.</span><span class="sxs-lookup"><span data-stu-id="60044-265">The client transmits a token to the server.</span></span>
2.  <span data-ttu-id="60044-266">Il server chiama **AcceptSecurityContext (digest)** la prima volta, che genera un token di risposta che viene quindi inviato al client.</span><span class="sxs-lookup"><span data-stu-id="60044-266">The server calls **AcceptSecurityContext (Digest)** the first time, which generates a reply token that is then sent to the client.</span></span>
3.  <span data-ttu-id="60044-267">Il client riceve il token e lo passa a [**InitializeSecurityContext (digest)**](initializesecuritycontext--digest.md).</span><span class="sxs-lookup"><span data-stu-id="60044-267">The client receives the token and passes it to [**InitializeSecurityContext (Digest)**](initializesecuritycontext--digest.md).</span></span> <span data-ttu-id="60044-268">Se **InitializeSecurityContext (digest)** restituisce sec \_ e \_ OK, l'autenticazione reciproca è stata completata ed è possibile avviare una sessione protetta.</span><span class="sxs-lookup"><span data-stu-id="60044-268">If **InitializeSecurityContext (Digest)** returns SEC\_E\_OK, mutual authentication has been completed and a secure session can begin.</span></span> <span data-ttu-id="60044-269">Se **InitializeSecurityContext (digest)** restituisce un codice di errore, termina la negoziazione di autenticazione reciproca.</span><span class="sxs-lookup"><span data-stu-id="60044-269">If **InitializeSecurityContext (Digest)** returns an error code, the mutual authentication negotiation ends.</span></span> <span data-ttu-id="60044-270">In caso contrario, il token di sicurezza restituito da **InitializeSecurityContext (digest)** viene inviato al client e i passaggi 2 e 3 vengono ripetuti.</span><span class="sxs-lookup"><span data-stu-id="60044-270">Otherwise, the security token returned by **InitializeSecurityContext (Digest)** is sent to the client, and steps 2 and 3 are repeated.</span></span>

<span data-ttu-id="60044-271">I parametri *fContextReq* e *pfContextAttr* sono maschere di maschera che rappresentano vari attributi di contesto.</span><span class="sxs-lookup"><span data-stu-id="60044-271">The *fContextReq* and *pfContextAttr* parameters are bitmasks that represent various context attributes.</span></span> <span data-ttu-id="60044-272">Per una descrizione dei vari attributi, vedere [requisiti di contesto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="60044-272">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

> [!Note]  
> <span data-ttu-id="60044-273">Il parametro *pfContextAttr* è valido in caso di esito positivo, ma solo in caso di esito positivo finale è possibile esaminare i flag relativi agli aspetti di sicurezza del contesto.</span><span class="sxs-lookup"><span data-stu-id="60044-273">The *pfContextAttr* parameter is valid on any successful return, but only on the final successful return should you examine the flags pertaining to security aspects of the context.</span></span> <span data-ttu-id="60044-274">I ritorni intermedi possono impostare, ad esempio, \_ il \_ flag di memoria allocata RET di ISC \_ .</span><span class="sxs-lookup"><span data-stu-id="60044-274">Intermediate returns can set, for example, the ISC\_RET\_ALLOCATED\_MEMORY flag.</span></span>

 

<span data-ttu-id="60044-275">Il chiamante è responsabile di determinare se gli attributi di contesto finali sono sufficienti.</span><span class="sxs-lookup"><span data-stu-id="60044-275">The caller is responsible for determining whether the final context attributes are sufficient.</span></span> <span data-ttu-id="60044-276">Se, ad esempio, è stata richiesta la riservatezza (crittografia) ma non è stato possibile stabilirla, è possibile che alcune applicazioni decidano immediatamente di arrestare la connessione.</span><span class="sxs-lookup"><span data-stu-id="60044-276">If, for example, confidentiality (encryption) was requested, but could not be established, some applications may choose to shut down the connection immediately.</span></span> <span data-ttu-id="60044-277">Se non è possibile stabilire il [*contesto di sicurezza*](../secgloss/s-gly.md) , il server deve liberare il contesto parzialmente creato chiamando la funzione [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="60044-277">If the [*security context*](../secgloss/s-gly.md) cannot be established, the server must free the partially created context by calling the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function.</span></span> <span data-ttu-id="60044-278">Per informazioni sul momento in cui chiamare la funzione **DeleteSecurityContext** , vedere **DeleteSecurityContext**.</span><span class="sxs-lookup"><span data-stu-id="60044-278">For information about when to call the **DeleteSecurityContext** function, see **DeleteSecurityContext**.</span></span>

<span data-ttu-id="60044-279">Una volta stabilito il [*contesto di sicurezza*](../secgloss/s-gly.md) , l'applicazione server può utilizzare la funzione [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) per recuperare un handle per l'account utente a cui è stato eseguito il mapping del certificato client.</span><span class="sxs-lookup"><span data-stu-id="60044-279">After the [*security context*](../secgloss/s-gly.md) has been established, the server application can use the [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) function to retrieve a handle to the user account to which the client certificate was mapped.</span></span> <span data-ttu-id="60044-280">Inoltre, il server può utilizzare la funzione [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) per rappresentare l'utente.</span><span class="sxs-lookup"><span data-stu-id="60044-280">Also, the server can use the [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) function to impersonate the user.</span></span>

## <a name="requirements"></a><span data-ttu-id="60044-281">Requisiti</span><span class="sxs-lookup"><span data-stu-id="60044-281">Requirements</span></span>



| <span data-ttu-id="60044-282">Requisito</span><span class="sxs-lookup"><span data-stu-id="60044-282">Requirement</span></span> | <span data-ttu-id="60044-283">Valore</span><span class="sxs-lookup"><span data-stu-id="60044-283">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="60044-284">Client minimo supportato</span><span class="sxs-lookup"><span data-stu-id="60044-284">Minimum supported client</span></span><br/> | <span data-ttu-id="60044-285">\[Solo app desktop Windows XP\]</span><span class="sxs-lookup"><span data-stu-id="60044-285">Windows XP \[desktop apps only\]</span></span><br/>                                                            |
| <span data-ttu-id="60044-286">Server minimo supportato</span><span class="sxs-lookup"><span data-stu-id="60044-286">Minimum supported server</span></span><br/> | <span data-ttu-id="60044-287">\[Solo app desktop Windows Server 2003\]</span><span class="sxs-lookup"><span data-stu-id="60044-287">Windows Server 2003 \[desktop apps only\]</span></span><br/>                                                   |
| <span data-ttu-id="60044-288">Intestazione</span><span class="sxs-lookup"><span data-stu-id="60044-288">Header</span></span><br/>                   | <dl> <span data-ttu-id="60044-289"><dt>SSPI. h (include Security. h)</dt></span><span class="sxs-lookup"><span data-stu-id="60044-289"><dt>Sspi.h (include Security.h)</dt></span></span> </dl> |
| <span data-ttu-id="60044-290">Libreria</span><span class="sxs-lookup"><span data-stu-id="60044-290">Library</span></span><br/>                  | <dl> <span data-ttu-id="60044-291"><dt>Secur32. lib</dt></span><span class="sxs-lookup"><span data-stu-id="60044-291"><dt>Secur32.lib</dt></span></span> </dl>                 |
| <span data-ttu-id="60044-292">DLL</span><span class="sxs-lookup"><span data-stu-id="60044-292">DLL</span></span><br/>                      | <dl> <span data-ttu-id="60044-293"><dt>Secur32.dll</dt></span><span class="sxs-lookup"><span data-stu-id="60044-293"><dt>Secur32.dll</dt></span></span> </dl>                 |



## <a name="see-also"></a><span data-ttu-id="60044-294">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="60044-294">See also</span></span>

<dl> <dt>

[<span data-ttu-id="60044-295">Funzioni SSPI</span><span class="sxs-lookup"><span data-stu-id="60044-295">SSPI Functions</span></span>](authentication-functions.md#sspi-functions)
</dt> <dt>

[<span data-ttu-id="60044-296">**DeleteSecurityContext**</span><span class="sxs-lookup"><span data-stu-id="60044-296">**DeleteSecurityContext**</span></span>](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext)
</dt> <dt>

[<span data-ttu-id="60044-297">**InitializeSecurityContext (digest)**</span><span class="sxs-lookup"><span data-stu-id="60044-297">**InitializeSecurityContext (Digest)**</span></span>](initializesecuritycontext--digest.md)
</dt> </dl>

 

 
