---
description: Poiché il protocollo Kerberos è stato originariamente progettato, una chiave master per un utente è stata derivata da una password fornita dall'utente.
ms.assetid: b8fcb68d-751e-4495-ab92-8b70c96aaa7a
title: Ticket Ticket-Granting
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39dff161ba2d905f676fe6b6b5e7e7d5289ee550
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129314"
---
# <a name="ticket-granting-tickets"></a><span data-ttu-id="1cf90-103">Ticket Ticket-Granting</span><span class="sxs-lookup"><span data-stu-id="1cf90-103">Ticket-Granting Tickets</span></span>

<span data-ttu-id="1cf90-104">Poiché il [*protocollo Kerberos*](../secgloss/k-gly.md) è stato originariamente progettato, una chiave master per un utente è stata derivata da una password fornita dall'utente.</span><span class="sxs-lookup"><span data-stu-id="1cf90-104">As the [*Kerberos protocol*](../secgloss/k-gly.md) was originally designed, a master key for a user was derived from a password provided by the user.</span></span> <span data-ttu-id="1cf90-105">Quando un utente ha effettuato l'accesso, il client Kerberos nella workstation dell'utente ha accettato la password dall'utente e la ha convertita in una chiave di crittografia passando il testo tramite una funzione [*hash*](../secgloss/h-gly.md) unidirezionale.</span><span class="sxs-lookup"><span data-stu-id="1cf90-105">When a user logged on, the Kerberos client on the user's workstation accepted the password from the user and converted it into an encryption key by passing the text through a one-way [*hash*](../secgloss/h-gly.md) function.</span></span> <span data-ttu-id="1cf90-106">L'hash risultante è la [*chiave master*](../secgloss/m-gly.md)dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1cf90-106">The resulting hash was the user's [*master key*](../secgloss/m-gly.md).</span></span> <span data-ttu-id="1cf90-107">Il client ha utilizzato questa *chiave master* per decrittografare le [*chiavi di sessione*](../secgloss/s-gly.md) ricevute dal KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-107">The client used this *master key* to decrypt [*session keys*](../secgloss/s-gly.md) received from KDC.</span></span>

<span data-ttu-id="1cf90-108">Il problema con la progettazione originale di Kerberos è che il client richiede la chiave master dell'utente ogni volta che viene decrittografata una chiave di sessione dal KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-108">The problem with the original Kerberos design is the client needs the user's master key each time it decrypts a session key from the KDC.</span></span> <span data-ttu-id="1cf90-109">Ciò significa che il client deve chiedere all'utente la password all'inizio di ogni scambio client/server oppure il client deve archiviare la chiave dell'utente nella workstation.</span><span class="sxs-lookup"><span data-stu-id="1cf90-109">That means either the client must ask the user for the password at the beginning of every client/server exchange, or the client must store the user's key on the workstation.</span></span> <span data-ttu-id="1cf90-110">Interruzioni frequenti dell'utente sono troppo intrusive.</span><span class="sxs-lookup"><span data-stu-id="1cf90-110">Frequent interruptions of the user are too intrusive.</span></span> <span data-ttu-id="1cf90-111">L'archiviazione della chiave nella workstation rischia di compromettere una chiave derivata dalla password utente che è una chiave a lungo termine.</span><span class="sxs-lookup"><span data-stu-id="1cf90-111">Storing the key on the workstation risks compromising a key derived from the user password which is a long term key.</span></span>

<span data-ttu-id="1cf90-112">La soluzione del protocollo Kerberos a questo problema è che il client ottenga una chiave temporanea dal KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-112">The Kerberos protocol's solution to this problem is for the client to get a temporary key from the KDC.</span></span> <span data-ttu-id="1cf90-113">Questa chiave temporanea è efficace solo per questa [*sessione di accesso*](../secgloss/l-gly.md).</span><span class="sxs-lookup"><span data-stu-id="1cf90-113">This temporary key is good only for this [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="1cf90-114">Quando un utente esegue l'accesso, il client richiede un ticket per il KDC così come richiederebbe un ticket per qualsiasi altro servizio.</span><span class="sxs-lookup"><span data-stu-id="1cf90-114">When a user logs on, the client requests a ticket for the KDC just as it would request a ticket for any other service.</span></span> <span data-ttu-id="1cf90-115">Il KDC risponde creando una chiave della sessione di accesso e un ticket per un server speciale, il servizio di concessione ticket completo del KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-115">The KDC responds by creating a logon session key and a ticket for a special server, the KDC's full ticket-granting service.</span></span> <span data-ttu-id="1cf90-116">Una copia della chiave della sessione di accesso è incorporata nel ticket e il ticket viene crittografato con la chiave master del KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-116">One copy of the logon session key is embedded in the ticket, and the ticket is encrypted with the KDC's master key.</span></span> <span data-ttu-id="1cf90-117">Un'altra copia della chiave della sessione di accesso viene crittografata con la chiave master dell'utente derivata dalla password di accesso dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1cf90-117">Another copy of the logon session key is encrypted with the user's master key derived from the user's logon password.</span></span> <span data-ttu-id="1cf90-118">Sia il ticket che la chiave della sessione crittografata vengono inviati al client.</span><span class="sxs-lookup"><span data-stu-id="1cf90-118">Both the ticket and the encrypted session key are sent to the client.</span></span>

<span data-ttu-id="1cf90-119">Quando il client riceve la risposta del KDC, decrittografa la chiave della sessione di accesso con la chiave master dell'utente derivata dalla password dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1cf90-119">When the client gets the KDC's reply, it decrypts the logon session key with the user's master key derived from the user's password.</span></span> <span data-ttu-id="1cf90-120">Il client non richiede più la chiave derivata dalla password dell'utente perché il client userà ora la chiave della sessione di accesso per decrittografare la propria copia di qualsiasi chiave di sessione del server ottenuta dal KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-120">The client no longer needs the key derived from the user's password because the client will now use the logon session key to decrypt its copy of any server session key it gets from the KDC.</span></span> <span data-ttu-id="1cf90-121">Il client archivia la chiave della sessione di accesso nella cache dei ticket insieme al relativo ticket per il servizio di concessione ticket completo del KDC.</span><span class="sxs-lookup"><span data-stu-id="1cf90-121">The client stores the logon session key in its ticket cache along with its ticket for the KDC's full ticket-granting service.</span></span>

<span data-ttu-id="1cf90-122">Il ticket per il servizio di concessione ticket completo è denominato ticket di concessione ticket (TGT).</span><span class="sxs-lookup"><span data-stu-id="1cf90-122">The ticket for the full ticket-granting service is called a ticket-granting ticket (TGT).</span></span> <span data-ttu-id="1cf90-123">Quando il client richiede al KDC un ticket a un server, presenta le [*credenziali*](../secgloss/c-gly.md) sotto forma di un messaggio di autenticatore e di un ticket, in questo caso un TGT, proprio come se presentasse le credenziali a qualsiasi altro servizio.</span><span class="sxs-lookup"><span data-stu-id="1cf90-123">When the client asks the KDC for a ticket to a server, it presents [*credentials*](../secgloss/c-gly.md) in the form of an authenticator message and a ticket — in this case a TGT — just as it would present credentials to any other service.</span></span> <span data-ttu-id="1cf90-124">Il servizio di concessione ticket apre il TGT con la chiave master, estrae la chiave della sessione di accesso per il client e usa la chiave della sessione di accesso per crittografare la copia del client di una chiave di sessione per il server.</span><span class="sxs-lookup"><span data-stu-id="1cf90-124">The ticket-granting service opens the TGT with its master key, extracts the logon session key for this client, and uses the logon session key to encrypt the client's copy of a session key for the server.</span></span>

 

 
