---
description: Il server invia al client un riferimento al contesto di sicurezza condiviso usando la direttiva Opaque della richiesta digest.
ms.assetid: 543c4bed-b224-4da7-9746-12c9993a40af
title: Autenticazione delle richieste successive con Microsoft Digest
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8eecccc3be68fb541994e63cdfc5035187e04aa3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103758399"
---
# <a name="authenticating-subsequent-requests-with-microsoft-digest"></a><span data-ttu-id="ce9e5-103">Autenticazione delle richieste successive con Microsoft Digest</span><span class="sxs-lookup"><span data-stu-id="ce9e5-103">Authenticating Subsequent Requests with Microsoft Digest</span></span>

<span data-ttu-id="ce9e5-104">Il server invia al client un riferimento al contesto di [*sicurezza*](/windows/desktop/SecGloss/s-gly) condiviso usando la direttiva Opaque della richiesta digest.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-104">The server sends the client a reference to their shared [*security context*](/windows/desktop/SecGloss/s-gly) using the opaque directive of the Digest challenge.</span></span> <span data-ttu-id="ce9e5-105">Una volta completata l'autenticazione, il client deve specificare questo valore nelle richieste successive al server di destinazione.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-105">After a successful authentication, the client must specify this value in subsequent requests to the target server.</span></span> <span data-ttu-id="ce9e5-106">L'inclusione del valore opaco nelle richieste di risorse accessibili tramite il contesto di sicurezza esistente elimina la necessità di ripetere l'autenticazione nel controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-106">Including the opaque value in requests for resources that are accessible using the existing security context eliminates the need to re-authenticate at the domain controller.</span></span> <span data-ttu-id="ce9e5-107">Tali richieste vengono nuovamente autenticate nel server, utilizzando la [*chiave della sessione*](/windows/desktop/SecGloss/s-gly) digest memorizzata nella cache dopo l'autenticazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-107">Such requests are re-authenticated at the server, using the Digest [*session key*](/windows/desktop/SecGloss/s-gly) cached after the initial authentication.</span></span>

<span data-ttu-id="ce9e5-108">Il diagramma seguente illustra i passaggi eseguiti da client e server durante una richiesta successiva per le risorse protette dall'accesso.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-108">The following diagram illustrates the steps taken by client and server during a subsequent request for access-protected resources.</span></span>

![autenticazione delle richieste successive tramite Microsoft Digest](images/digest2.png)

<span data-ttu-id="ce9e5-110">Per richiedere risorse aggiuntive dopo un'autenticazione corretta, il client chiama la funzione Microsoft Digest [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) per generare una risposta di verifica del digest.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-110">To request additional resources after a successful authentication, the client calls the Microsoft Digest [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) function to generate a Digest challenge response.</span></span> <span data-ttu-id="ce9e5-111">Il valore opaco è incluso nella direttiva Opaque della risposta di richiesta di verifica inviata al server come intestazione di autorizzazione (visualizzata come richiesta HTTP).</span><span class="sxs-lookup"><span data-stu-id="ce9e5-111">The opaque value is included in the opaque directive of the challenge response sent to the server as an Authorization header (shown as HTTP Request).</span></span>

<span data-ttu-id="ce9e5-112">Il server chiama la funzione [**AcceptSecurityContext (digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) per determinare se esiste un contesto di [*sicurezza*](/windows/desktop/SecGloss/s-gly) esistente per il client.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-112">The server calls the [**AcceptSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function to determine whether there is an existing [*security context*](/windows/desktop/SecGloss/s-gly) for the client.</span></span> <span data-ttu-id="ce9e5-113">Quando viene trovato un contesto esistente, la funzione restituisce il secondo \_ E il \_ completamento \_ necessario per indicare che il server deve quindi chiamare la funzione [**CompleteAuthToken**](/windows/desktop/api/Sspi/nf-sspi-completeauthtoken) .</span><span class="sxs-lookup"><span data-stu-id="ce9e5-113">When an existing context is found, the function returns SEC\_E\_COMPLETE\_NEEDED to indicate the server must then call the [**CompleteAuthToken**](/windows/desktop/api/Sspi/nf-sspi-completeauthtoken) function.</span></span> <span data-ttu-id="ce9e5-114">Questa funzione esegue l'autenticazione client usando la [*chiave della sessione*](/windows/desktop/SecGloss/s-gly) digest memorizzata nella cache durante l' [autenticazione iniziale](initial-authentication-using-microsoft-digest.md) anziché eseguire di nuovo l'autenticazione nel controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="ce9e5-114">This function performs the client authentication using the Digest [*session key*](/windows/desktop/SecGloss/s-gly) cached during the [initial authentication](initial-authentication-using-microsoft-digest.md) instead of re-authenticating at the domain controller.</span></span>

 

 
