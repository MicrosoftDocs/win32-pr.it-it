---
description: I contesti di flusso gestiscono i protocolli orientati al flusso sicuro, ad esempio SSL o PCT.
ms.assetid: 05a6b036-1f7f-473f-9813-a1e1534e0f0d
title: Contesti di flusso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53103dc1269c05e5a2c162133d21e167d8035c2c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103967100"
---
# <a name="stream-contexts"></a><span data-ttu-id="99e59-103">Contesti di flusso</span><span class="sxs-lookup"><span data-stu-id="99e59-103">Stream Contexts</span></span>

<span data-ttu-id="99e59-104">I contesti di flusso gestiscono i protocolli orientati al flusso sicuro, ad esempio SSL o PCT.</span><span class="sxs-lookup"><span data-stu-id="99e59-104">Stream contexts handle the secure stream-oriented protocols such as SSL or PCT.</span></span> <span data-ttu-id="99e59-105">Per condividere la stessa interfaccia e la gestione delle credenziali analoghe, SSPI fornisce supporto per i contesti di flusso.</span><span class="sxs-lookup"><span data-stu-id="99e59-105">In the interest of sharing the same interface and similar credential management, SSPI provides support for stream contexts.</span></span> <span data-ttu-id="99e59-106">Il [*protocollo di sicurezza*](../secgloss/s-gly.md) incorpora sia lo schema di autenticazione del flusso che i formati di record.</span><span class="sxs-lookup"><span data-stu-id="99e59-106">The [*security protocol*](../secgloss/s-gly.md) incorporates both the stream authentication scheme and record formats.</span></span>

<span data-ttu-id="99e59-107">Per fornire i protocolli orientati al flusso, i [*pacchetti di sicurezza*](../secgloss/s-gly.md) che supportano i contesti di flusso hanno le caratteristiche di processo seguenti:</span><span class="sxs-lookup"><span data-stu-id="99e59-107">To provide stream-oriented protocols, [*security packages*](../secgloss/s-gly.md) that support stream contexts have the following process characteristics:</span></span>

-   <span data-ttu-id="99e59-108">Il pacchetto imposta il \_ flag del flusso del flag SECPKG \_ per indicare che supporta la semantica del flusso.</span><span class="sxs-lookup"><span data-stu-id="99e59-108">The package sets the SECPKG\_FLAG\_STREAM flag to indicate that it supports stream semantics.</span></span>
-   <span data-ttu-id="99e59-109">Per le applicazioni di trasporto viene richiesta la semantica di flusso impostando il flusso di richiesta \_ di ISC e i flag di flusso per \_ ASC \_ req \_ nelle chiamate alle funzioni [**InitializeSecurityContext (generale)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) e [**AcceptSecurityContext (generale)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="99e59-109">Transport applications requests stream semantics by setting the ISC\_REQ\_STREAM and ASC\_REQ\_STREAM flags in the calls to the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) and [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) functions.</span></span>
-   <span data-ttu-id="99e59-110">L'applicazione chiama la funzione [**QueryContextAttributes (generale)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) con una [**struttura \_ StreamSizes di SecPkgContext**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) per eseguire una query sul [*contesto di sicurezza*](../secgloss/s-gly.md) per il numero di buffer da fornire e le dimensioni da riservare per le intestazioni o i trailer.</span><span class="sxs-lookup"><span data-stu-id="99e59-110">The application calls the [**QueryContextAttributes (General)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function with a [**SecPkgContext\_StreamSizes**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) structure to query the [*security context*](../secgloss/s-gly.md) for the number of buffers to provide and the sizes to reserve for headers or trailers.</span></span>
-   <span data-ttu-id="99e59-111">L'applicazione fornisce descrittori di buffer da riservare durante l'effettiva elaborazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="99e59-111">The application provides buffer descriptors to spare during the actual processing of the data.</span></span> <span data-ttu-id="99e59-112">Specificando la semantica del flusso, il chiamante indica la volontà di eseguire un'elaborazione aggiuntiva, in modo che il [*pacchetto di sicurezza*](../secgloss/s-gly.md) possa gestire il blocco dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="99e59-112">By specifying stream semantics, the caller indicates willingness to do extra processing so that the [*security package*](../secgloss/s-gly.md) can handle the blocking of the messages.</span></span> <span data-ttu-id="99e59-113">In sostanza, per le funzioni [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) e [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) , il chiamante passa un elenco di buffer.</span><span class="sxs-lookup"><span data-stu-id="99e59-113">In essence, for the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) and [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) functions, the caller passes in a list of buffers.</span></span> <span data-ttu-id="99e59-114">Quando viene ricevuto un messaggio da un canale che è orientato al flusso, ad esempio una porta TCP, il chiamante passa un elenco di buffer come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="99e59-114">When a message is received from a channel that is stream-oriented (such as a TCP port), the caller passes in a buffer list as follows.</span></span>

    | <span data-ttu-id="99e59-115">Buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-115">Buffer</span></span> | <span data-ttu-id="99e59-116">Length</span><span class="sxs-lookup"><span data-stu-id="99e59-116">Length</span></span>         | <span data-ttu-id="99e59-117">Tipo di buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-117">Buffer type</span></span>      |
    |--------|----------------|------------------|
    | <span data-ttu-id="99e59-118">1</span><span class="sxs-lookup"><span data-stu-id="99e59-118">1</span></span>      | <span data-ttu-id="99e59-119">Lunghezza messaggio</span><span class="sxs-lookup"><span data-stu-id="99e59-119">Message Length</span></span> | <span data-ttu-id="99e59-120">\_dati SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="99e59-120">SECBUFFER\_DATA</span></span>  |
    | <span data-ttu-id="99e59-121">2</span><span class="sxs-lookup"><span data-stu-id="99e59-121">2</span></span>      | <span data-ttu-id="99e59-122">0</span><span class="sxs-lookup"><span data-stu-id="99e59-122">0</span></span>              | <span data-ttu-id="99e59-123">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-123">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="99e59-124">3</span><span class="sxs-lookup"><span data-stu-id="99e59-124">3</span></span>      | <span data-ttu-id="99e59-125">0</span><span class="sxs-lookup"><span data-stu-id="99e59-125">0</span></span>              | <span data-ttu-id="99e59-126">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-126">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="99e59-127">4</span><span class="sxs-lookup"><span data-stu-id="99e59-127">4</span></span>      | <span data-ttu-id="99e59-128">0</span><span class="sxs-lookup"><span data-stu-id="99e59-128">0</span></span>              | <span data-ttu-id="99e59-129">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-129">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="99e59-130">5</span><span class="sxs-lookup"><span data-stu-id="99e59-130">5</span></span>      | <span data-ttu-id="99e59-131">0</span><span class="sxs-lookup"><span data-stu-id="99e59-131">0</span></span>              | <span data-ttu-id="99e59-132">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-132">SECBUFFER\_EMPTY</span></span> |

    

     

    <span data-ttu-id="99e59-133">Il pacchetto di sicurezza funziona quindi nel [*BLOB*](../secgloss/b-gly.md).</span><span class="sxs-lookup"><span data-stu-id="99e59-133">The security package then works on the [*BLOB*](../secgloss/b-gly.md).</span></span> <span data-ttu-id="99e59-134">Se la funzione viene restituita correttamente, l'elenco dei buffer è simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="99e59-134">If the function returns successfully, the buffer list looks like the following.</span></span>

    

    | <span data-ttu-id="99e59-135">Buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-135">Buffer</span></span> | <span data-ttu-id="99e59-136">Length</span><span class="sxs-lookup"><span data-stu-id="99e59-136">Length</span></span>         | <span data-ttu-id="99e59-137">Tipo di buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-137">Buffer type</span></span>                |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="99e59-138">1</span><span class="sxs-lookup"><span data-stu-id="99e59-138">1</span></span>      | <span data-ttu-id="99e59-139">Lunghezza intestazione</span><span class="sxs-lookup"><span data-stu-id="99e59-139">Header Length</span></span>  | <span data-ttu-id="99e59-140">\_intestazione del flusso SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="99e59-140">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="99e59-141">2</span><span class="sxs-lookup"><span data-stu-id="99e59-141">2</span></span>      | <span data-ttu-id="99e59-142">Lunghezza dei dati</span><span class="sxs-lookup"><span data-stu-id="99e59-142">Data Length</span></span>    | <span data-ttu-id="99e59-143">\_dati SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="99e59-143">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="99e59-144">3</span><span class="sxs-lookup"><span data-stu-id="99e59-144">3</span></span>      | <span data-ttu-id="99e59-145">Lunghezza trailer</span><span class="sxs-lookup"><span data-stu-id="99e59-145">Trailer Length</span></span> | <span data-ttu-id="99e59-146">\_trailer del flusso SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="99e59-146">SECBUFFER\_STREAM\_TRAILER</span></span> |
    | <span data-ttu-id="99e59-147">4</span><span class="sxs-lookup"><span data-stu-id="99e59-147">4</span></span>      | <span data-ttu-id="99e59-148">0</span><span class="sxs-lookup"><span data-stu-id="99e59-148">0</span></span>              | <span data-ttu-id="99e59-149">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-149">SECBUFFER\_EMPTY</span></span>           |
    | <span data-ttu-id="99e59-150">5</span><span class="sxs-lookup"><span data-stu-id="99e59-150">5</span></span>      | <span data-ttu-id="99e59-151">0</span><span class="sxs-lookup"><span data-stu-id="99e59-151">0</span></span>              | <span data-ttu-id="99e59-152">SECBUFFER \_ vuoto</span><span class="sxs-lookup"><span data-stu-id="99e59-152">SECBUFFER\_EMPTY</span></span>           |

    

     

    <span data-ttu-id="99e59-153">Il pacchetto potrebbe avere restituito anche il buffer \# 4 con lunghezza x e tipo di buffer SECBUFFER \_ che indica che i dati in questo buffer fanno parte del record successivo e non sono stati ancora elaborati.</span><span class="sxs-lookup"><span data-stu-id="99e59-153">The package could have also returned buffer \#4 with length x and buffer type SECBUFFER\_EXTRA indicating that the data in this buffer is part of the next record and has not yet been processed.</span></span> <span data-ttu-id="99e59-154">Viceversa, se la funzione Message restituisce il \_ codice di errore del \_ messaggio incompleto e del secondo \_ , l'elenco di buffer restituito sarà simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="99e59-154">Conversely, if the message function returns the SEC\_E\_INCOMPLETE\_MESSAGE error code, the returned buffer list would look like the following.</span></span>

    

    | <span data-ttu-id="99e59-155">Buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-155">Buffer</span></span> | <span data-ttu-id="99e59-156">Length</span><span class="sxs-lookup"><span data-stu-id="99e59-156">Length</span></span> | <span data-ttu-id="99e59-157">Tipo di buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-157">Buffer type</span></span>        |
    |--------|--------|--------------------|
    | <span data-ttu-id="99e59-158">1</span><span class="sxs-lookup"><span data-stu-id="99e59-158">1</span></span>      | <span data-ttu-id="99e59-159">x</span><span class="sxs-lookup"><span data-stu-id="99e59-159">x</span></span>      | <span data-ttu-id="99e59-160">SECBUFFER \_ mancante</span><span class="sxs-lookup"><span data-stu-id="99e59-160">SECBUFFER\_MISSING</span></span> |

    

     

    <span data-ttu-id="99e59-161">Ciò indica che sono necessari più dati per elaborare il record.</span><span class="sxs-lookup"><span data-stu-id="99e59-161">This indicates that more data was needed to process the record.</span></span> <span data-ttu-id="99e59-162">A differenza della maggior parte degli errori restituiti da una funzione di messaggio, questo tipo di buffer non indica che il contesto è stato compromesso.</span><span class="sxs-lookup"><span data-stu-id="99e59-162">Unlike most errors returned from a message function, this buffer type does not indicate that the context has been compromised.</span></span> <span data-ttu-id="99e59-163">Indica invece che sono necessari più dati.</span><span class="sxs-lookup"><span data-stu-id="99e59-163">Instead, it indicates that more data is needed.</span></span> <span data-ttu-id="99e59-164">i [*pacchetti di sicurezza*](../secgloss/s-gly.md) non devono aggiornare [*lo stato*](../secgloss/s-gly.md) in questa condizione.</span><span class="sxs-lookup"><span data-stu-id="99e59-164">[*security packages*](../secgloss/s-gly.md) must not update their [*state*](../secgloss/s-gly.md) in this condition.</span></span>

    <span data-ttu-id="99e59-165">Analogamente, sul lato mittente della comunicazione, il chiamante può chiamare la funzione [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) .</span><span class="sxs-lookup"><span data-stu-id="99e59-165">Similarly, on the sender side of the communication, the caller can call the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) function.</span></span> <span data-ttu-id="99e59-166">Il pacchetto di sicurezza potrebbe dover riallocare il buffer o copiare le informazioni.</span><span class="sxs-lookup"><span data-stu-id="99e59-166">The security package may need to reallocate the buffer or copy things around.</span></span> <span data-ttu-id="99e59-167">Il chiamante può essere più efficiente fornendo un elenco di buffer come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="99e59-167">The caller can be more efficient by providing a buffer list as follows.</span></span>

    

    | <span data-ttu-id="99e59-168">Buffer</span><span class="sxs-lookup"><span data-stu-id="99e59-168">Buffer</span></span> | <span data-ttu-id="99e59-169">Length</span><span class="sxs-lookup"><span data-stu-id="99e59-169">Length</span></span>         | <span data-ttu-id="99e59-170">Tipo</span><span class="sxs-lookup"><span data-stu-id="99e59-170">Type</span></span>                       |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="99e59-171">1</span><span class="sxs-lookup"><span data-stu-id="99e59-171">1</span></span>      | <span data-ttu-id="99e59-172">Lunghezza intestazione</span><span class="sxs-lookup"><span data-stu-id="99e59-172">Header Length</span></span>  | <span data-ttu-id="99e59-173">\_intestazione del flusso SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="99e59-173">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="99e59-174">2</span><span class="sxs-lookup"><span data-stu-id="99e59-174">2</span></span>      | <span data-ttu-id="99e59-175">Lunghezza dei dati</span><span class="sxs-lookup"><span data-stu-id="99e59-175">Data Length</span></span>    | <span data-ttu-id="99e59-176">\_dati SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="99e59-176">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="99e59-177">3</span><span class="sxs-lookup"><span data-stu-id="99e59-177">3</span></span>      | <span data-ttu-id="99e59-178">Lunghezza trailer</span><span class="sxs-lookup"><span data-stu-id="99e59-178">Trailer Length</span></span> | <span data-ttu-id="99e59-179">\_trailer del flusso SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="99e59-179">SECBUFFER\_STREAM\_TRAILER</span></span> |

    

     

    <span data-ttu-id="99e59-180">Ciò consente al chiamante di usare i buffer in modo più efficiente.</span><span class="sxs-lookup"><span data-stu-id="99e59-180">This allows the caller to use the buffers more efficiently.</span></span> <span data-ttu-id="99e59-181">Chiamando la funzione [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) per determinare la quantità di spazio da riservare prima di chiamare [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), l'operazione risulta più efficiente per l'applicazione e il pacchetto di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="99e59-181">By calling the [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function to determine the amount of space to reserve before calling [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), the operation is more efficient for the application and the security package.</span></span>

 

 
