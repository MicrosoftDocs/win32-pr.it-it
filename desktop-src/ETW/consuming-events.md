---
description: Gli utenti di traccia eventi possono elaborare gli eventi da uno o più provider.
ms.assetid: 039a9f66-228e-4258-9967-2b2cd7d31091
title: Utilizzo di eventi (traccia eventi)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68ad8234cc66d07b5a52c10ab39c7d7b3c8aa029
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980855"
---
# <a name="consuming-events-event-tracing"></a><span data-ttu-id="700ac-103">Utilizzo di eventi (traccia eventi)</span><span class="sxs-lookup"><span data-stu-id="700ac-103">Consuming Events (Event Tracing)</span></span>

<span data-ttu-id="700ac-104">Gli utenti di traccia eventi possono elaborare gli eventi da uno o più provider.</span><span class="sxs-lookup"><span data-stu-id="700ac-104">Event trace consumers can process events from one or more providers.</span></span> <span data-ttu-id="700ac-105">I consumer possono elaborare gli eventi da un file di log o in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="700ac-105">Consumers can process events from a log file or in real time.</span></span> <span data-ttu-id="700ac-106">È possibile utilizzare gli eventi in tempo reale solo se il controller specifica la modalità di registrazione in tempo reale per la sessione.</span><span class="sxs-lookup"><span data-stu-id="700ac-106">You can consume events in real time only if the controller specifies the real time logging mode for the session.</span></span> <span data-ttu-id="700ac-107">Per motivi di prestazioni, l'elaborazione in tempo reale non è consigliata prima di Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="700ac-107">For performance reasons, real-time processing is not recommended prior to Windows Vista.</span></span>

<span data-ttu-id="700ac-108">Per specificare la sessione di traccia da cui si desidera elaborare gli eventi, è possibile utilizzare la struttura di [**\_ \_ log di traccia eventi**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) .</span><span class="sxs-lookup"><span data-stu-id="700ac-108">To specify the trace session from which you want to process events, you use the [**EVENT\_TRACE\_LOGFILE**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) structure.</span></span> <span data-ttu-id="700ac-109">È necessario inizializzare una copia di questa struttura per ogni file di log o sessione in tempo reale che si desidera elaborare.</span><span class="sxs-lookup"><span data-stu-id="700ac-109">You must initialize a copy of this structure for each log file or real time session that you want to process.</span></span>

<span data-ttu-id="700ac-110">Per utilizzare gli eventi da un file di log, impostare il membro **LogFileName** sul nome del file di log.</span><span class="sxs-lookup"><span data-stu-id="700ac-110">To consume events from a log file, set the **LogFileName** member to the name of the log file.</span></span> <span data-ttu-id="700ac-111">Per utilizzare gli eventi della sessione in tempo reale, impostare il membro **loggername** sul nome della sessione.</span><span class="sxs-lookup"><span data-stu-id="700ac-111">To consume events from real time session, set the **LoggerName** member to the session name.</span></span> <span data-ttu-id="700ac-112">Questa struttura viene utilizzata anche per specificare il callback [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) e il callback [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) o [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) utilizzato per elaborare gli eventi.</span><span class="sxs-lookup"><span data-stu-id="700ac-112">You also use this structure to specify the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) callback and the [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) or [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) callback used to process the events.</span></span>

-   <span data-ttu-id="700ac-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback): riceve ed elabora tutti gli eventi, incluso l'evento di intestazione, da uno o più file di log e una sessione in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="700ac-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span> <span data-ttu-id="700ac-114">Questo callback viene implementato se si utilizzano le funzioni di supporto dei dati di traccia per analizzare i dati dell'evento o si desidera recuperare i metadati relativi all'evento.</span><span class="sxs-lookup"><span data-stu-id="700ac-114">You implement this callback if you use the trace data helper functions to parse the event data or you want to retrieve metadata about the event.</span></span>
-   <span data-ttu-id="700ac-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback): riceve ed elabora tutti gli eventi, incluso l'evento di intestazione, da uno o più file di log e una sessione in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="700ac-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span>
-   <span data-ttu-id="700ac-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka): riceve ed elabora le informazioni di riepilogo sul buffer corrente, ad esempio gli eventi persi.</span><span class="sxs-lookup"><span data-stu-id="700ac-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka)—Receives and processes summary information about the current buffer, such as events lost.</span></span> <span data-ttu-id="700ac-117">ETW chiama il callback dopo aver recapito tutti gli eventi nel buffer al consumer.</span><span class="sxs-lookup"><span data-stu-id="700ac-117">ETW calls the callback after delivering all events in the buffer to the consumer.</span></span> <span data-ttu-id="700ac-118">Il consumer può inoltre utilizzare questo callback per annullare l'elaborazione degli eventi; Tuttavia, se si utilizzano eventi in tempo reale, ETW recapita gli eventi finché il controller non arresta la sessione.</span><span class="sxs-lookup"><span data-stu-id="700ac-118">The consumer can also use this callback to cancel event processing; however, if you are consuming events in real time, ETW delivers events until the controller stops the session.</span></span>

<span data-ttu-id="700ac-119">Dopo aver definito una o più sessioni di traccia, chiamare la funzione [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) per ogni sessione di traccia che si desidera elaborare. è possibile elaborare gli eventi da uno o più file di log, ma solo da una sessione in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="700ac-119">After defining one or more trace sessions, call the [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) function for each trace session that you want to process; you can process events from one or more log files, but from only one real-time session.</span></span> <span data-ttu-id="700ac-120">Viene quindi passato l'elenco degli handle della sessione di traccia restituiti da **OpenTrace** alla funzione [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) .</span><span class="sxs-lookup"><span data-stu-id="700ac-120">You then pass the list of trace session handles that **OpenTrace** returns to the [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) function.</span></span> <span data-ttu-id="700ac-121">La funzione **ProcessTrace** combina gli eventi, li ordina in ordine cronologico e li recapita ai callback uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="700ac-121">The **ProcessTrace** function combines the events, sorts them into chronological order, and then delivers them to the callbacks one at a time.</span></span> <span data-ttu-id="700ac-122">Gli eventi possono essere filtrati in modo da includere solo quelli che rientrano in un intervallo di tempo specifico usando i parametri *StartTime* e *EndTime* .</span><span class="sxs-lookup"><span data-stu-id="700ac-122">The events can be filtered to include only those that fall into a specific time frame using the *StartTime* and *EndTime* parameters.</span></span> <span data-ttu-id="700ac-123">La funzione **ProcessTrace** blocca il thread fino a quando il consumer non elabora tutti gli eventi nelle sessioni di traccia, il [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) restituisce **false** oppure si chiama [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span><span class="sxs-lookup"><span data-stu-id="700ac-123">The **ProcessTrace** function blocks the thread until your consumer processes all events in the trace sessions, the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) returns **FALSE**, or you call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span></span>

<span data-ttu-id="700ac-124">**Prima di Windows Vista:** È possibile chiamare [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) solo dopo la restituzione di [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) .</span><span class="sxs-lookup"><span data-stu-id="700ac-124">**Prior to Windows Vista:** You can call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) only after [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) returns.</span></span>

<span data-ttu-id="700ac-125">Per un esempio in cui viene illustrato come utilizzare gli eventi pubblicati utilizzando un file manifesto, MOF o MDF, vedere [recupero di dati di evento tramite TDH](retrieving-event-data-using-tdh.md).</span><span class="sxs-lookup"><span data-stu-id="700ac-125">For an example that shows how to consume events published using a manifest, MOF, or TMF files, see [Retrieving Event Data Using TDH](retrieving-event-data-using-tdh.md).</span></span> <span data-ttu-id="700ac-126">Si noti che a partire da Windows Vista, è necessario utilizzare le funzioni helper dei dati di traccia (TDH) per utilizzare gli eventi.</span><span class="sxs-lookup"><span data-stu-id="700ac-126">Note that beginning with Windows Vista, you should use the trace data helper (TDH) functions to consume events.</span></span>

<span data-ttu-id="700ac-127">Per un esempio in cui viene illustrato come utilizzare gli eventi pubblicati utilizzando MOF, vedere [recupero di dati di evento tramite MOF](retrieving-event-data-using-mof.md).</span><span class="sxs-lookup"><span data-stu-id="700ac-127">For an example that shows how to consume events published using MOF, see [Retrieving Event Data Using MOF](retrieving-event-data-using-mof.md).</span></span>

 

 
