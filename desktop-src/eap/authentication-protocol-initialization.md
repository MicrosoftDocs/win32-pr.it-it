---
title: Inizializzazione del protocollo di autenticazione
description: La connessione protetta EAP viene inizializzata tra il client e il server in modo analogo ai client RAS e wireless (802.1 X).
ms.assetid: 1cd5bfc9-2ba3-477c-9bbb-73578a5623c2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 856bd173ef617fb272460f874fa1d2087322c8b4
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104398933"
---
# <a name="authentication-protocol-initialization"></a><span data-ttu-id="d5dd1-103">Inizializzazione del protocollo di autenticazione</span><span class="sxs-lookup"><span data-stu-id="d5dd1-103">Authentication Protocol Initialization</span></span>

<span data-ttu-id="d5dd1-104">La connessione protetta EAP viene inizializzata tra il client e il server in modo analogo ai client RAS e wireless (802.1 X).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-104">The EAP secured connection is initialized between the client and server in similar ways for RAS and wireless (802.1X) clients.</span></span>

## <a name="client"></a><span data-ttu-id="d5dd1-105">Client</span><span class="sxs-lookup"><span data-stu-id="d5dd1-105">Client</span></span>

<span data-ttu-id="d5dd1-106">Quando il client tenta di stabilire la connessione, il servizio di autenticazione ottiene le [informazioni sull'identità](obtaining-identity-information.md) per l'utente.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-106">When the client attempts to establish the connection, the authentication service obtains [identity information](obtaining-identity-information.md) for the user.</span></span> <span data-ttu-id="d5dd1-107">Se il valore **RAS \_ EAP \_ valueName \_ Invoke \_ NAMEDLG** è presente nel registro di sistema per questo protocollo di autenticazione e questo valore è impostato su zero, il servizio di autenticazione chiama [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-107">If the **RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG** value is present in the registry for this authentication protocol and this value is set to zero, the authentication service calls [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span></span> <span data-ttu-id="d5dd1-108">Questa funzione Visualizza in genere un'interfaccia utente che consente alle informazioni di identità di essere di un tipo specifico per il protocollo di autenticazione; ad esempio, un certificato o un ID numerico.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-108">This function typically displays a user interface that allows the identity information to be of a type specific to the authentication protocol; for example, a certificate or numeric ID.</span></span> <span data-ttu-id="d5dd1-109">Se **RAS \_ EAP \_ valueName \_ Invoke \_ NAMEDLG** non è presente o è impostato su uno, il servizio di autenticazione Visualizza la finestra di dialogo del nome utente di sistema standard.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-109">If **RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG** is not present, or is set to one, the authentication service displays the standard system user-name dialog.</span></span>

<span data-ttu-id="d5dd1-110">Una volta ottenute le informazioni di identità per l'utente, il servizio di autenticazione chiama l'implementazione del protocollo di autenticazione di [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-110">Once the authentication service has obtained the identity information for the user, it calls the authentication protocol's implementation of [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span></span> <span data-ttu-id="d5dd1-111">Questa chiamata consente al protocollo di autenticazione di allocare e inizializzare un buffer di lavoro che il servizio passa alle chiamate successive a [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)) e [**RasEapEnd**](/previous-versions/windows/desktop/legacy/aa363521(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-111">This call allows the authentication protocol to allocate and initialize a work buffer that the service passes on subsequent calls to [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)) and [**RasEapEnd**](/previous-versions/windows/desktop/legacy/aa363521(v=vs.85)).</span></span> <span data-ttu-id="d5dd1-112">Il buffer di lavoro è opaco per il servizio e non accede mai al contenuto del buffer di lavoro.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-112">The work buffer is opaque to the service and never accesses the contents of the work buffer.</span></span> <span data-ttu-id="d5dd1-113">Se il protocollo di autenticazione crea un buffer di lavoro distinto per ogni sessione EAP, il buffer di lavoro è di tipo sessione e thread-safe.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-113">If the authentication protocol creates a distinct work buffer for each EAP session, then the work buffer is session and thread safe.</span></span> <span data-ttu-id="d5dd1-114">Poiché il protocollo di autenticazione alloca la memoria per il buffer di lavoro, il protocollo di autenticazione deve liberare anche questa memoria tramite la funzione [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) .</span><span class="sxs-lookup"><span data-stu-id="d5dd1-114">Because the authentication protocol allocates the memory for the work buffer, the authentication protocol should also free this memory using the [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) function.</span></span>

<span data-ttu-id="d5dd1-115">Nella chiamata a [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), il servizio passa anche una struttura [**di \_ \_ input EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) che contiene i puntatori alle informazioni di configurazione per la connessione e le informazioni sull'identità per l'utente.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-115">In the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), the service also passes a [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure that contains pointers to the configuration information for the connection, and the identity information for the user.</span></span> <span data-ttu-id="d5dd1-116">Il servizio passa sempre un valore per il membro **pszIdentity** dell' **\_ \_ input EAP di PPP**.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-116">The service always passes in a value for the **pszIdentity** member of **PPP\_EAP\_INPUT**.</span></span> <span data-ttu-id="d5dd1-117">Tuttavia, il membro **pszPassword** dell' [**\_ \_ input EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) può essere **null**.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-117">However, the **pszPassword** member of [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) may be **NULL**.</span></span>

<span data-ttu-id="d5dd1-118">All'interno della struttura di [**\_ \_ input EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) , il membro **fAuthenticator** indica se il protocollo di autenticazione viene richiamato per l'autenticazione (sul client) o come autenticatore (sul server).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-118">Within the [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure, the **fAuthenticator** member indicates whether the authentication protocol is being invoked to be authenticated (on the client) or as the authenticator (on the server).</span></span>

## <a name="server"></a><span data-ttu-id="d5dd1-119">Server</span><span class="sxs-lookup"><span data-stu-id="d5dd1-119">Server</span></span>

<span data-ttu-id="d5dd1-120">Sul server, il membro **bInitialID** dell' [**\_ \_ input EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) specifica l'ID utilizzato dal server per il primo pacchetto EAP.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-120">On the server, the **bInitialID** member of [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) specifies the ID that the server uses for the first EAP packet.</span></span> <span data-ttu-id="d5dd1-121">Il server incrementa questo ID per i pacchetti successivi.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-121">The server increments this ID for subsequent packets.</span></span>

<span data-ttu-id="d5dd1-122">Inoltre, nel server, il puntatore **pUserAttributes** nell' [**\_ \_ input EAP PPP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) punta a una matrice di attributi del tipo di [**\_ \_ attributo di \_ autenticazione RAS**](/windows/win32/api/raseapif/ne-raseapif-ras_auth_attribute_type) .</span><span class="sxs-lookup"><span data-stu-id="d5dd1-122">Also on the server, the **pUserAttributes** pointer in [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) points to an array of attributes of the [**RAS\_AUTH\_ATTRIBUTE\_TYPE**](/windows/win32/api/raseapif/ne-raseapif-ras_auth_attribute_type) type.</span></span> <span data-ttu-id="d5dd1-123">Si tratta di attributi per l'utente ottenuti dal client.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-123">These are attributes for the user that were obtained from the client.</span></span>

<span data-ttu-id="d5dd1-124">Se la chiamata [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)) restituisce un valore diverso da **nessun \_ errore**, la sessione viene disconnessa.</span><span class="sxs-lookup"><span data-stu-id="d5dd1-124">If the [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)) call returns any value other than **NO\_ERROR**, the session is disconnected.</span></span> <span data-ttu-id="d5dd1-125">L'errore restituito viene registrato (sul server) o visualizzato all'utente (sul client).</span><span class="sxs-lookup"><span data-stu-id="d5dd1-125">The returned error is logged (on the server), or displayed to the user (on the client).</span></span>

 

 