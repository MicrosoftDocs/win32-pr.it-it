---
title: Disegno della finestra
description: È stata creata la finestra. A questo punto si desidera visualizzare elementi al suo interno. Nella terminologia di Windows, questa operazione viene denominata disegno della finestra. Per combinare le metafore, una finestra è un'area di disegno vuota, in attesa del riempimento.
ms.assetid: db97a4c9-7592-42d1-a5de-9c468169eefc
ms.topic: article
ms.date: 08/16/2019
ms.openlocfilehash: f0f9d5c2759ea1735e370eb258743364980daee8
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104565349"
---
# <a name="painting-the-window"></a><span data-ttu-id="a04cf-106">Disegno della finestra</span><span class="sxs-lookup"><span data-stu-id="a04cf-106">Painting the Window</span></span>

<span data-ttu-id="a04cf-107">È stata creata la finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-107">You've created your window.</span></span> <span data-ttu-id="a04cf-108">A questo punto si desidera visualizzare elementi al suo interno.</span><span class="sxs-lookup"><span data-stu-id="a04cf-108">Now you want to show something inside it.</span></span> <span data-ttu-id="a04cf-109">Nella terminologia di Windows, questa operazione viene denominata disegno della finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-109">In Windows terminology, this is called painting the window.</span></span> <span data-ttu-id="a04cf-110">Per combinare le metafore, una finestra è un'area di disegno vuota, in attesa del riempimento.</span><span class="sxs-lookup"><span data-stu-id="a04cf-110">To mix metaphors, a window is a blank canvas, waiting for you to fill it.</span></span>

<span data-ttu-id="a04cf-111">In alcuni casi il programma avvierà il disegno per aggiornare l'aspetto della finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-111">Sometimes your program will initiate painting to update the appearance of the window.</span></span> <span data-ttu-id="a04cf-112">In altri casi, il sistema operativo invierà una notifica che indica che è necessario ridisegnare una parte della finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-112">At other times, the operating system will notify you that you must repaint a portion of the window.</span></span> <span data-ttu-id="a04cf-113">In tal caso, il sistema operativo invia alla finestra un messaggio di [**\_ disegno WM**](/windows/desktop/gdi/wm-paint) .</span><span class="sxs-lookup"><span data-stu-id="a04cf-113">When this occurs, the operating system sends the window a [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message.</span></span> <span data-ttu-id="a04cf-114">La parte della finestra che deve essere disegnata è denominata *area di aggiornamento*.</span><span class="sxs-lookup"><span data-stu-id="a04cf-114">The portion of the window that must be painted is called the *update region*.</span></span>

<span data-ttu-id="a04cf-115">La prima volta che viene visualizzata una finestra, è necessario disegnare l'intera area client della finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-115">The first time a window is shown, the entire client area of the window must be painted.</span></span> <span data-ttu-id="a04cf-116">Pertanto, quando si visualizza una finestra, viene sempre visualizzato almeno un messaggio di [**\_ disegno WM**](/windows/desktop/gdi/wm-paint) .</span><span class="sxs-lookup"><span data-stu-id="a04cf-116">Therefore, you will always receive at least one [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message when you show a window.</span></span>

![illustrazione che mostra l'area di aggiornamento di una finestra](images/painting01.png)

<span data-ttu-id="a04cf-118">L'utente è responsabile solo del disegno dell'area client.</span><span class="sxs-lookup"><span data-stu-id="a04cf-118">You are only responsible for painting the client area.</span></span> <span data-ttu-id="a04cf-119">Il frame circostante, inclusa la barra del titolo, viene automaticamente disegnato dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="a04cf-119">The surrounding frame, including the title bar, is automatically painted by the operating system.</span></span> <span data-ttu-id="a04cf-120">Dopo aver completato il disegno dell'area client, deselezionare l'area di aggiornamento, che indica al sistema operativo che non è necessario inviare un altro messaggio di [**\_ disegno WM**](/windows/desktop/gdi/wm-paint) fino a quando qualcosa non cambia.</span><span class="sxs-lookup"><span data-stu-id="a04cf-120">After you finish painting the client area, you clear the update region, which tells the operating system that it does not need to send another [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message until something changes.</span></span>

<span data-ttu-id="a04cf-121">Si supponga ora che l'utente sposti un'altra finestra in modo che nasconda una parte della finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-121">Now suppose the user moves another window so that it obscures a portion of your window.</span></span> <span data-ttu-id="a04cf-122">Quando la parte nascosta diventa nuovamente visibile, tale parte viene aggiunta all'area di aggiornamento e la finestra riceve un altro messaggio [**di \_ disegno WM**](/windows/desktop/gdi/wm-paint) .</span><span class="sxs-lookup"><span data-stu-id="a04cf-122">When the obscured portion becomes visible again, that portion is added to the update region, and your window receives another [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message.</span></span>

![illustrazione che Mostra come cambia l'area di aggiornamento quando si sovrappongono due finestre](images/painting02.png)

<span data-ttu-id="a04cf-124">L'area di aggiornamento cambia anche se l'utente allunga la finestra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-124">The update region also changes if the user stretches the window.</span></span> <span data-ttu-id="a04cf-125">Nel diagramma seguente l'utente allunga la finestra a destra.</span><span class="sxs-lookup"><span data-stu-id="a04cf-125">In the following diagram, the user stretches the window to the right.</span></span> <span data-ttu-id="a04cf-126">L'area appena esposta sul lato destro della finestra viene aggiunta all'area di aggiornamento:</span><span class="sxs-lookup"><span data-stu-id="a04cf-126">The newly exposed area on the right side of the window is added to the update region:</span></span>

![illustrazione che Mostra come cambia l'area di aggiornamento quando una finestra viene ridimensionata](images/painting03.png)

<span data-ttu-id="a04cf-128">Nel primo programma di esempio, la routine di disegno è molto semplice.</span><span class="sxs-lookup"><span data-stu-id="a04cf-128">In our first example program, the painting routine is very simple.</span></span> <span data-ttu-id="a04cf-129">Riempie semplicemente l'intera area client con un colore a tinta unita.</span><span class="sxs-lookup"><span data-stu-id="a04cf-129">It just fills the entire client area with a solid color.</span></span> <span data-ttu-id="a04cf-130">Questo esempio è ancora sufficiente per illustrare alcuni concetti importanti.</span><span class="sxs-lookup"><span data-stu-id="a04cf-130">Still, this example is enough to demonstrate some of the important concepts.</span></span>

```C++
switch (uMsg)
{
    case WM_PAINT:
    {
        PAINTSTRUCT ps;
        HDC hdc = BeginPaint(hwnd, &ps);

        // All painting occurs here, between BeginPaint and EndPaint.

        FillRect(hdc, &ps.rcPaint, (HBRUSH) (COLOR_WINDOW+1));

        EndPaint(hwnd, &ps);
    }
    return 0;
}
```

<span data-ttu-id="a04cf-131">Avviare l'operazione di disegno chiamando la funzione [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) .</span><span class="sxs-lookup"><span data-stu-id="a04cf-131">Start the painting operation by calling the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function.</span></span> <span data-ttu-id="a04cf-132">Questa funzione compila la struttura [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) con le informazioni sulla richiesta di ridisegno.</span><span class="sxs-lookup"><span data-stu-id="a04cf-132">This function fills in the [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) structure with information on the repaint request.</span></span> <span data-ttu-id="a04cf-133">L'area di aggiornamento corrente viene specificata nel membro **rcPaint** di **PAINTSTRUCT**.</span><span class="sxs-lookup"><span data-stu-id="a04cf-133">The current update region is given in the **rcPaint** member of **PAINTSTRUCT**.</span></span> <span data-ttu-id="a04cf-134">Questa area di aggiornamento è definita in relazione all'area client:</span><span class="sxs-lookup"><span data-stu-id="a04cf-134">This update region is defined relative to the client area:</span></span>

![illustrazione che mostra l'origine dell'area client](images/painting04.png)

<span data-ttu-id="a04cf-136">Nel codice di disegno sono disponibili due opzioni di base:</span><span class="sxs-lookup"><span data-stu-id="a04cf-136">In your painting code, you have two basic options:</span></span>

- <span data-ttu-id="a04cf-137">Disegnare l'intera area client, indipendentemente dalle dimensioni dell'area di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a04cf-137">Paint the entire client area, regardless of the size of the update region.</span></span> <span data-ttu-id="a04cf-138">Qualsiasi elemento che esula dall'area di aggiornamento viene troncato.</span><span class="sxs-lookup"><span data-stu-id="a04cf-138">Anything that falls outside of the update region is clipped.</span></span> <span data-ttu-id="a04cf-139">Ovvero, il sistema operativo lo ignora.</span><span class="sxs-lookup"><span data-stu-id="a04cf-139">That is, the operating system ignores it.</span></span>
- <span data-ttu-id="a04cf-140">Ottimizzare disegnando solo la parte della finestra all'interno dell'area di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a04cf-140">Optimize by painting just the portion of the window inside the update region.</span></span>

<span data-ttu-id="a04cf-141">Se si dipinge sempre l'intera area client, il codice sarà più semplice.</span><span class="sxs-lookup"><span data-stu-id="a04cf-141">If you always paint the entire client area, the code will be simpler.</span></span> <span data-ttu-id="a04cf-142">Se la logica di disegno è complessa, tuttavia, può essere più efficiente ignorare le aree all'esterno dell'area di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a04cf-142">If you have complicated painting logic, however, it can be more efficient to skip the areas outside of the update region.</span></span>

<span data-ttu-id="a04cf-143">La riga di codice seguente riempie l'area di aggiornamento con un solo colore, usando il colore di sfondo della finestra definito dal sistema (**\_ finestra dei colori**).</span><span class="sxs-lookup"><span data-stu-id="a04cf-143">The following line of code fills the update region with a single color, using the system-defined window background color (**COLOR\_WINDOW**).</span></span> <span data-ttu-id="a04cf-144">Il colore effettivo indicato dalla **\_ finestra colore** dipende dalla combinazione di colori corrente dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a04cf-144">The actual color indicated by **COLOR\_WINDOW** depends on the user's current color scheme.</span></span>

```C++
FillRect(hdc, &ps.rcPaint, (HBRUSH) (COLOR_WINDOW+1));
```

<span data-ttu-id="a04cf-145">I dettagli di [**fillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) non sono importanti per questo esempio, ma il secondo parametro fornisce le coordinate del rettangolo da riempire.</span><span class="sxs-lookup"><span data-stu-id="a04cf-145">The details of [**FillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) are not important for this example, but the second parameter gives the coordinates of the rectangle to fill.</span></span> <span data-ttu-id="a04cf-146">In questo caso, viene passata l'intera area di aggiornamento (il membro **rcPaint** di [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct)).</span><span class="sxs-lookup"><span data-stu-id="a04cf-146">In this case, we pass in the entire update region (the **rcPaint** member of [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct)).</span></span> <span data-ttu-id="a04cf-147">Nel primo messaggio [**di \_ disegno WM**](/windows/desktop/gdi/wm-paint) , l'intera area client deve essere disegnata, quindi **rcPaint** conterrà l'intera area client.</span><span class="sxs-lookup"><span data-stu-id="a04cf-147">On the first [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, the entire client area needs to be painted, so **rcPaint** will contain the entire client area.</span></span> <span data-ttu-id="a04cf-148">Nei successivi messaggi di **\_ disegno WM** , **rcPaint** potrebbe contenere un rettangolo più piccolo.</span><span class="sxs-lookup"><span data-stu-id="a04cf-148">On subsequent **WM\_PAINT** messages, **rcPaint** might contain a smaller rectangle.</span></span>

<span data-ttu-id="a04cf-149">La funzione [**fillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) fa parte del Graphics Device Interface (GDI), che ha alimentato la grafica di Windows per un lungo periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="a04cf-149">The [**FillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) function is part of the Graphics Device Interface (GDI), which has powered Windows graphics for a very long time.</span></span> <span data-ttu-id="a04cf-150">In Windows 7, Microsoft ha introdotto un nuovo motore di grafica, denominato Direct2D, che supporta operazioni grafiche a prestazioni elevate, ad esempio l'accelerazione hardware.</span><span class="sxs-lookup"><span data-stu-id="a04cf-150">In Windows 7, Microsoft introduced a new graphics engine, named Direct2D, which supports high-performance graphics operations, such as hardware acceleration.</span></span> <span data-ttu-id="a04cf-151">Direct2D è inoltre disponibile per Windows Vista tramite l' [aggiornamento della piattaforma per Windows Vista](../win7ip/platform-update-for-windows-vista-overview.md) e per windows Server 2008 tramite l'aggiornamento della piattaforma per windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a04cf-151">Direct2D is also available for Windows Vista through the [Platform Update for Windows Vista](../win7ip/platform-update-for-windows-vista-overview.md) and for Windows Server 2008 through the Platform Update for Windows Server 2008.</span></span> <span data-ttu-id="a04cf-152">GDI è ancora completamente supportato.</span><span class="sxs-lookup"><span data-stu-id="a04cf-152">(GDI is still fully supported.)</span></span>

<span data-ttu-id="a04cf-153">Al termine del disegno, chiamare la funzione [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) .</span><span class="sxs-lookup"><span data-stu-id="a04cf-153">After you are done painting, call the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function.</span></span> <span data-ttu-id="a04cf-154">Questa funzione Cancella l'area di aggiornamento, che segnala a Windows che la finestra ha completato il disegno.</span><span class="sxs-lookup"><span data-stu-id="a04cf-154">This function clears the update region, which signals to Windows that the window has completed painting itself.</span></span>

## <a name="next"></a><span data-ttu-id="a04cf-155">Prossima</span><span class="sxs-lookup"><span data-stu-id="a04cf-155">Next</span></span>

[<span data-ttu-id="a04cf-156">Chiusura della finestra</span><span class="sxs-lookup"><span data-stu-id="a04cf-156">Closing the Window</span></span>](closing-the-window.md)