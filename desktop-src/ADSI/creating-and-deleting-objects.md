---
title: Creazione ed eliminazione di oggetti
description: Con ADSI, gli oggetti vengono creati ed eliminati usando l'interfaccia IADsContainer o IDirectoryObject.
ms.assetid: 4d1f7ac5-48d3-4ea9-91e4-0cd4bb2ec9f8
ms.tgt_platform: multiple
keywords:
- Creazione ed eliminazione di oggetti ADSI
- ADSI, creazione ed eliminazione di oggetti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4730c4cc6a95ad37bfd3953474d3d488fcf05abb
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104474235"
---
# <a name="creating-and-deleting-objects"></a><span data-ttu-id="c52d0-105">Creazione ed eliminazione di oggetti</span><span class="sxs-lookup"><span data-stu-id="c52d0-105">Creating and Deleting Objects</span></span>

<span data-ttu-id="c52d0-106">Con ADSI, gli oggetti vengono creati ed eliminati usando l'interfaccia [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) o [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-106">With ADSI, objects are created and deleted using either the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) or [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>

## <a name="creating-an-object-with-iadscontainer"></a><span data-ttu-id="c52d0-107">Creazione di un oggetto con IADsContainer</span><span class="sxs-lookup"><span data-stu-id="c52d0-107">Creating an Object with IADsContainer</span></span>

<span data-ttu-id="c52d0-108">**Per creare un oggetto con l'interfaccia IADsContainer**</span><span class="sxs-lookup"><span data-stu-id="c52d0-108">**To create an object with the IADsContainer interface**</span></span>

1.  <span data-ttu-id="c52d0-109">Eseguire l'associazione al contenitore che conterrà l'oggetto da creare e ottenere l'interfaccia [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-109">Bind to the container that will contain the object to be created and obtain the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span>
2.  <span data-ttu-id="c52d0-110">Usare il metodo [**IADsContainer. Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) per creare un nuovo oggetto nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="c52d0-110">Use the [**IADsContainer.Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method to create a new object in the container.</span></span>
3.  <span data-ttu-id="c52d0-111">Impostare i valori per tutti gli attributi obbligatori per l'oggetto usando il metodo [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) o [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-111">Set the values for all of the required attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="c52d0-112">Gli attributi necessari per creare un oggetto dipenderanno dal servizio directory e dal tipo di oggetto creato.</span><span class="sxs-lookup"><span data-stu-id="c52d0-112">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="c52d0-113">Per ulteriori informazioni sulla creazione di oggetti Active Directory, vedere [creazione ed eliminazione di oggetti di Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="c52d0-113">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="c52d0-114">Impostare i valori per tutti gli attributi facoltativi desiderati per l'oggetto usando il metodo [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) o [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-114">Set the values for all of the desired optional attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span>
5.  <span data-ttu-id="c52d0-115">Chiamare il metodo [**IADs. seinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) per eseguire il commit dell'oggetto e dei relativi attributi.</span><span class="sxs-lookup"><span data-stu-id="c52d0-115">Call the [**IADs.SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method to commit the object and its attributes.</span></span> <span data-ttu-id="c52d0-116">Il nuovo oggetto non viene effettivamente creato nel servizio directory sottostante fino a quando non viene chiamato il metodo **IADs. seinfo** per eseguire il commit degli attributi.</span><span class="sxs-lookup"><span data-stu-id="c52d0-116">The new object is not actually created in the underlying directory service until the **IADs.SetInfo** method is called to commit the attributes.</span></span>

## <a name="creating-an-object-with-idirectoryobject"></a><span data-ttu-id="c52d0-117">Creazione di un oggetto con IDirectoryObject</span><span class="sxs-lookup"><span data-stu-id="c52d0-117">Creating an Object with IDirectoryObject</span></span>

<span data-ttu-id="c52d0-118">**Per creare un oggetto con l'interfaccia IDirectoryObject**</span><span class="sxs-lookup"><span data-stu-id="c52d0-118">**To create an object with the IDirectoryObject interface**</span></span>

1.  <span data-ttu-id="c52d0-119">Eseguire l'associazione al contenitore che conterrà l'oggetto da creare e ottenere l'interfaccia [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-119">Bind to the container that will contain the object to be created and obtain the [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>
2.  <span data-ttu-id="c52d0-120">Allocare una matrice di [**inserzioni \_ attr \_ info**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) Structures che contiene una struttura per ogni attributo da impostare quando viene creato l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c52d0-120">Allocate an array of [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structures that contains one structure for each attribute to be set when the object is created.</span></span>
3.  <span data-ttu-id="c52d0-121">Compilare una struttura [**di \_ \_ informazioni attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) per ogni attributo obbligatorio per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c52d0-121">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each required attribute for the object.</span></span> <span data-ttu-id="c52d0-122">Gli attributi necessari per creare un oggetto dipenderanno dal servizio directory e dal tipo di oggetto creato.</span><span class="sxs-lookup"><span data-stu-id="c52d0-122">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="c52d0-123">Per ulteriori informazioni sulla creazione di oggetti Active Directory, vedere [creazione ed eliminazione di oggetti di Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="c52d0-123">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="c52d0-124">Compilare una struttura [**di \_ \_ informazioni attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) per ogni attributo facoltativo per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c52d0-124">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each optional attribute for the object.</span></span>
5.  <span data-ttu-id="c52d0-125">Usare il metodo [**IDirectoryObject:: CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) per creare l'oggetto nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="c52d0-125">Use the [**IDirectoryObject::CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) method to create the object in the container.</span></span> <span data-ttu-id="c52d0-126">Questo metodo consente inoltre di eseguire il commit dell'oggetto nel servizio directory sottostante.</span><span class="sxs-lookup"><span data-stu-id="c52d0-126">This method also commits the object to the underlying directory service.</span></span> <span data-ttu-id="c52d0-127">Se la matrice di [**\_ \_ informazioni attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) non contiene tutti gli attributi obbligatori per l'oggetto, **IDirectoryObject:: CreateDSObject** avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="c52d0-127">If the [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) array does not contain all of the required attributes for the object, **IDirectoryObject::CreateDSObject** will fail.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="c52d0-128">Eliminazione di un oggetto</span><span class="sxs-lookup"><span data-stu-id="c52d0-128">Deleting an Object</span></span>

<span data-ttu-id="c52d0-129">Per eliminare un oggetto, usare il metodo [**IADsContainer::D Elimina**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) o [**IDirectoryObject::D eletedsobject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) .</span><span class="sxs-lookup"><span data-stu-id="c52d0-129">To delete an object use the [**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) or the [**IDirectoryObject::DeleteDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) method.</span></span> <span data-ttu-id="c52d0-130">Questi metodi avranno esito negativo se l'oggetto eliminato contiene oggetti figlio.</span><span class="sxs-lookup"><span data-stu-id="c52d0-130">These methods will fail if the deleted object contains any child objects.</span></span> <span data-ttu-id="c52d0-131">Usare il metodo [**IADsDeleteOps::D eleteobject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) per eliminare un contenitore e tutti gli oggetti figlio del contenitore.</span><span class="sxs-lookup"><span data-stu-id="c52d0-131">Use the [**IADsDeleteOps::DeleteObject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) method to delete a container and all of the container's child objects.</span></span>

<span data-ttu-id="c52d0-132">Ciò che accade a un oggetto eliminato dipende dal servizio directory sottostante.</span><span class="sxs-lookup"><span data-stu-id="c52d0-132">What happens to a deleted object depends on the underlying directory service.</span></span> <span data-ttu-id="c52d0-133">Per ulteriori informazioni sull'eliminazione di oggetti Active Directory, vedere [creazione ed eliminazione di oggetti di Active Directory](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="c52d0-133">For more information about deleting Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>

 

 