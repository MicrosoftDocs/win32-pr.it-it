---
title: Implementazione di base
description: Un provider ADSI supporta le funzionalità seguenti
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- implementazione di base di ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104047363"
---
# <a name="core-implementation"></a><span data-ttu-id="6ef2e-104">Implementazione di base</span><span class="sxs-lookup"><span data-stu-id="6ef2e-104">Core Implementation</span></span>

<span data-ttu-id="6ef2e-105">Un provider ADSI supporta le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ef2e-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="6ef2e-106">ADsPath stringhe in formato COM e URL.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="6ef2e-107">Per definizione, è possibile recuperare un oggetto Active Directory usando un ADsPath.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="6ef2e-108">I provider supportano la sintassi richiesta dal servizio directory usando l'implementazione di **ParseDisplayName** .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="6ef2e-109">Oggetto spazio dei nomi di primo livello che supporta [**IParseDisplayName::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) e [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span><span class="sxs-lookup"><span data-stu-id="6ef2e-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="6ef2e-110">Questo oggetto contiene i nodi radice per questo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="6ef2e-111">Parte dell'implementazione di **ParseDisplayName** deve includere un parser che verifica la presenza di errori di sintassi per il proprio spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="6ef2e-112">Questo oggetto deve supportare anche [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) e **IADsOpenDSObject**.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="6ef2e-113">Interfaccia [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="6ef2e-114">Questo include una semplice implementazione della cache delle proprietà tramite [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) e [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="6ef2e-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="6ef2e-115">Le operazioni che ottengono o impostano le proprietà dell'oggetto si verificano in modalità cache.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="6ef2e-116">I valori della cache vengono scritti nell'archivio directory sottostante durante **IADs:: SetInfo**.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="6ef2e-117">Un metodo ADSI, tuttavia, non viene memorizzato nella cache, ma viene eseguito immediatamente.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="6ef2e-118">Interfacce [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) e [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) per l'accesso diretto e l'enumerazione delle proprietà nella cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="6ef2e-119">Per i servizi directory che non espongono uno schema, questa interfaccia consente di modificare le proprietà di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="6ef2e-120">Interfaccia [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) per client non di automazione.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="6ef2e-121">Questo usa il protocollo in transito per ottenere le massime prestazioni e ignora la cache della proprietà.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="6ef2e-122">Interfaccia [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="6ef2e-123">Ogni oggetto Active Directory dispone di un contenitore padre che ne controlla la durata.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="6ef2e-124">Tenere presente che per gli oggetti del contenitore ADs, [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) influiscono solo sulle proprietà del contenitore e non sul relativo contenuto.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="6ef2e-125">Le informazioni sugli oggetti contenitore ADs influiscono solo sulle proprietà del contenitore e non influiscono sugli oggetti o sugli oggetti appena creati che esistono già nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="6ef2e-126">Interfaccia [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="6ef2e-127">Si tratta dell'interfaccia di automazione per linguaggi quali Visual Basic Scripting Edition, che non utilizzano l'associazione in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="6ef2e-128">Correlato a questo è il tipo di dati della libreria dei tipi che un provider deve fornire.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="6ef2e-129">Per ulteriori informazioni, vedere [problemi di implementazione per i provider ADSI](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="6ef2e-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="6ef2e-130">Oggetto contenitore della classe di schema e gli oggetti sintassi, proprietà e classe dello schema appropriati che supportano rispettivamente [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)e [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="6ef2e-131">Come minimo, ogni nodo radice deve contenere il proprio oggetto contenitore della classe dello schema.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="6ef2e-132">L'interfaccia [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , se gli attributi supportati sono raccolte di oggetti ADSI, ad esempio gruppi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="6ef2e-133">L'interfaccia [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) , se gli attributi supportati sono raccolte dello stesso tipo di elemento directory con la funzionalità [**IADsCollection:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) e [**IADsCollection:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="6ef2e-134">L'enumerazione **IEnumXXXX** supporta tutti gli oggetti enumeratori specifici.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="6ef2e-135">Routine per eseguire il mapping della sintassi e convertire i dati nativi nel tipo di dati [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="6ef2e-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="6ef2e-136">Seguire le convenzioni ADSI per gli oggetti ADSI forniti dal provider.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="6ef2e-137">Includere i file della guida e le librerie dei tipi che documentano le proprietà e i metodi dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="6ef2e-138">Come per qualsiasi implementazione COM, le chiamate a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) devono restituire **e \_ nointerface** per le interfacce non implementate, **e \_ NOTIMPL** per metodi non implementati di interfacce che altrimenti implementate e restituiscono la **\_ proprietà e Ads \_ \_ non \_ supportata** per le proprietà non implementate.</span><span class="sxs-lookup"><span data-stu-id="6ef2e-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="6ef2e-139">Per altre informazioni sulle interfacce duali e sul modo in cui influiscono sull'implementazione delle proprietà, vedere [interfacce duali](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="6ef2e-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 