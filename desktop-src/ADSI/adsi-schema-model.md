---
title: Modello di schema ADSI
description: Uno schema è simile a un dizionario in quanto include la definizione di ogni tipo di oggetto noto a un servizio directory.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI schema Model ADSI
- ADSI ADSI, informazioni su, schema
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23eec9264ae2692952106802cc06cbad937a42a9
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103963451"
---
# <a name="adsi-schema-model"></a><span data-ttu-id="e692a-105">Modello di schema ADSI</span><span class="sxs-lookup"><span data-stu-id="e692a-105">ADSI Schema Model</span></span>

<span data-ttu-id="e692a-106">Uno schema è simile a un dizionario in quanto include la definizione di ogni tipo di oggetto noto a un servizio directory.</span><span class="sxs-lookup"><span data-stu-id="e692a-106">A schema is similar to a dictionary in that it holds the definition of every type of object known to a directory service.</span></span> <span data-ttu-id="e692a-107">Le applicazioni client ADSI possono esplorare uno schema per individuare le funzionalità di qualsiasi implementazione ADSI specificata.</span><span class="sxs-lookup"><span data-stu-id="e692a-107">ADSI client applications can browse through a schema to discover the features of any given ADSI implementation.</span></span> <span data-ttu-id="e692a-108">ADSI fornisce inoltre interfacce di gestione dello schema che possono essere usate per comunicare con lo schema sottostante di un servizio directory.</span><span class="sxs-lookup"><span data-stu-id="e692a-108">In addition, ADSI supplies schema management interfaces that can be used to communicate with a directory service's underlying schema.</span></span>

<span data-ttu-id="e692a-109">Alcuni schemi sono provider estendibili e ADSI oppure i fornitori di terze parti possono scegliere di pubblicare nuove interfacce o proprietà aggiuntive per le interfacce esistenti.</span><span class="sxs-lookup"><span data-stu-id="e692a-109">Some schemas are extensible and ADSI providers or third-party suppliers may choose to publish new interfaces or additional properties for existing interfaces there.</span></span> <span data-ttu-id="e692a-110">I client ADSI utilizzano questi dati per determinare quali funzionalità sono supportate per ogni servizio directory.</span><span class="sxs-lookup"><span data-stu-id="e692a-110">ADSI clients use this data to determine what features are supported for each directory service.</span></span>

<span data-ttu-id="e692a-111">Esistono tre tipi di oggetti dello schema: classi, proprietà e sintassi, ciascuno dei quali supporta rispettivamente le interfacce di gestione dello schema [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)e [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="e692a-111">There are three kinds of schema objects: classes, properties, and syntaxes, each respectively supporting the schema management interfaces [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span>

> [!Note]  
> <span data-ttu-id="e692a-112">La classe è un termine di overload.</span><span class="sxs-lookup"><span data-stu-id="e692a-112">Class is an overloaded term.</span></span> <span data-ttu-id="e692a-113">Sono disponibili classi C++, classi Java, classi COM e classi ADSI.</span><span class="sxs-lookup"><span data-stu-id="e692a-113">There are C++ classes, Java classes, COM classes, and ADSI classes.</span></span> <span data-ttu-id="e692a-114">In questo documento, la parola classe, a meno che non sia diversamente qualificato, fa riferimento a una categoria o a un tipo di oggetto dello schema.</span><span class="sxs-lookup"><span data-stu-id="e692a-114">In this document, the word class, unless otherwise qualified, refers to a category or type of schema object.</span></span>

 

<span data-ttu-id="e692a-115">ADSI estrae lo schema di ogni servizio directory e lo inserisce in ogni nodo radice di primo livello nell'oggetto **spazio dei nomi** .</span><span class="sxs-lookup"><span data-stu-id="e692a-115">ADSI abstracts the schema of every directory service and places it in every top-level root node in the **Namespace** object.</span></span> <span data-ttu-id="e692a-116">Per identificare le classi supportate da un servizio directory in un nodo radice specifico, è necessario enumerare l'oggetto dello schema e ottenere un elenco di oggetti classe, oggetti proprietà e oggetti sintassi.</span><span class="sxs-lookup"><span data-stu-id="e692a-116">To identify what classes a directory service supports on a given root-node, you enumerate the schema object and get a list of class objects, property objects, and syntax objects.</span></span> <span data-ttu-id="e692a-117">Per ulteriori informazioni, vedere [utilizzo dello schema ADSI](using-the-adsi-schema.md).</span><span class="sxs-lookup"><span data-stu-id="e692a-117">For more information, see [Using the ADSI Schema](using-the-adsi-schema.md).</span></span>

## <a name="adsi-ldap-provider-schema-cache"></a><span data-ttu-id="e692a-118">Cache dello schema del provider LDAP ADSI</span><span class="sxs-lookup"><span data-stu-id="e692a-118">ADSI LDAP Provider Schema Cache</span></span>

<span data-ttu-id="e692a-119">Il provider LDAP per ADSI tenta di memorizzare nella cache i dati dello schema nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="e692a-119">The LDAP provider for ADSI attempts to cache schema data to the local computer.</span></span> <span data-ttu-id="e692a-120">Un sottoschema viene identificato da un nome distinto archiviato nell'attributo [**subschemaSubentry**](/windows/desktop/ADSchema/a-subschemasubentry) che si trova nella radice di Directory Service Enterprise (RootDSE).</span><span class="sxs-lookup"><span data-stu-id="e692a-120">A subschema is identified by a distinguished name stored in the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute located in the root of the directory service enterprise (rootDSE).</span></span> <span data-ttu-id="e692a-121">Oltre a fornire i dati di sottoschema, i server LDAP v3 devono esporre un attributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) usato per determinare l'ultima modifica dello schema.</span><span class="sxs-lookup"><span data-stu-id="e692a-121">In addition to providing the subschema data, LDAP v3 servers should expose a [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute that is used to determine the last time the schema was modified.</span></span>

<span data-ttu-id="e692a-122">Quando ADSI viene prima associato al server LDAP, recupera i dati di sottoschema usando l'attributo [**subschemaSubentry**](/windows/desktop/ADSchema/a-subschemasubentry) .</span><span class="sxs-lookup"><span data-stu-id="e692a-122">When ADSI first binds to the LDAP server, it retrieves the subschema data using the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute.</span></span> <span data-ttu-id="e692a-123">Se ADSI riesce a trovare l'oggetto sottoschema, archivia un puntatore ai dati nel registro di sistema del computer che si connette al server LDAP.</span><span class="sxs-lookup"><span data-stu-id="e692a-123">If ADSI succeeds in finding the subschema object, it stores a pointer to the data in the registry on the computer that is connecting to the LDAP server.</span></span> <span data-ttu-id="e692a-124">Per informazioni sulla posizione esatta in cui questi valori vengono archiviati nel registro di sistema, vedere [ADSI e controllo dell'account utente](adsi-and-uac.md).</span><span class="sxs-lookup"><span data-stu-id="e692a-124">For information on exactly where these values are stored in the registry, see [ADSI and User Account Control](adsi-and-uac.md).</span></span>

<span data-ttu-id="e692a-125">ADSI tenta quindi di elaborare i dati dello schema e di leggere l'attributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="e692a-125">ADSI then attempts to process the schema data and reads the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="e692a-126">Se l'attributo **modifyTimeStamp** esiste e ADSI elabora lo schema, ADSI scrive il sottoschema sul disco e crea i due valori del registro di sistema seguenti sotto la chiave.</span><span class="sxs-lookup"><span data-stu-id="e692a-126">If the **modifyTimeStamp** attribute exists and ADSI successfully processes the schema, ADSI writes the subschema to disk and creates the two following registry values under the key.</span></span> <span data-ttu-id="e692a-127">Se i dati di sottoschema esistono, ma non possono essere elaborati, nessuno dei valori del registro di sistema viene creato:</span><span class="sxs-lookup"><span data-stu-id="e692a-127">If the subschema data exists, but cannot be processed, neither of these registry values is created:</span></span>

-   <span data-ttu-id="e692a-128">Valore di **ora** , che contiene l'attributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="e692a-128">A **Time** value, which contains the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="e692a-129">Questo valore viene utilizzato per garantire che i dati dello schema siano aggiornati e impedisce il ricaricamento costante dei dati dello schema.</span><span class="sxs-lookup"><span data-stu-id="e692a-129">This value is used to ensure that the schema data is current and prevents the constant reloading of the schema data.</span></span>
-   <span data-ttu-id="e692a-130">Valore del **file** che contiene il percorso in cui ADSI archivia i dati dello schema nel file System.</span><span class="sxs-lookup"><span data-stu-id="e692a-130">A **File** value, which contains the path to where ADSI stores the schema data in the file system.</span></span> <span data-ttu-id="e692a-131">Per impostazione predefinita, ADSI memorizza nella cache il sottoschema nella <systemroot> \\ directory SchCache con un nome file corrispondente al nome del server LDAP.</span><span class="sxs-lookup"><span data-stu-id="e692a-131">By default, ADSI caches the subschema in the <systemroot>\\SchCache directory with a file name corresponding to the name of the LDAP server.</span></span>

<span data-ttu-id="e692a-132">Se è possibile elaborare i dati di sottoschema, ma non viene esposto alcun attributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) , i dati dello schema vengono memorizzati nella cache in memoria, ma non vengono scritti su disco.</span><span class="sxs-lookup"><span data-stu-id="e692a-132">If the subschema data can be processed, but no [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute is exposed, the schema data is cached in memory, but not written to disk.</span></span> <span data-ttu-id="e692a-133">Se un server LDAP v3 è stato contattato tramite ADSI nel computer locale e non è presente un sottoschema memorizzato nella cache, è molto probabile per uno dei motivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e692a-133">If an LDAP v3 server has been contacted through ADSI on the local computer and a cached subschema is not present, it is most likely for one of the following reasons:</span></span>

-   <span data-ttu-id="e692a-134">Il server non ha esposto le proprietà corrette.</span><span class="sxs-lookup"><span data-stu-id="e692a-134">The server did not expose the correct properties.</span></span>
-   <span data-ttu-id="e692a-135">ADSI non è stato in grado di elaborare lo schema.</span><span class="sxs-lookup"><span data-stu-id="e692a-135">ADSI was unable to process the schema.</span></span>
-   <span data-ttu-id="e692a-136">ADSI non è stato in grado di scrivere il file nel file system.</span><span class="sxs-lookup"><span data-stu-id="e692a-136">ADSI was unable to write the file to the file system.</span></span>

 

 