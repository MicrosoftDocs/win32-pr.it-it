---
title: Recupero di set di risultati di grandi dimensioni
description: Quando esiste la possibilità che il set di risultati che verrà restituito conterrà più di 1000 elementi, è necessario utilizzare una ricerca di paging.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Recupero di set di risultati di grandi dimensioni ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106297656"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="90254-104">Recupero di set di risultati di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="90254-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="90254-105">Quando esiste la possibilità che il set di risultati che verrà restituito conterrà più di 1000 elementi, è necessario utilizzare una ricerca di paging.</span><span class="sxs-lookup"><span data-stu-id="90254-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="90254-106">Le ricerche di Active Directory eseguite senza paging sono limitate alla restituzione di un massimo di primi 1000 record.</span><span class="sxs-lookup"><span data-stu-id="90254-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="90254-107">Con una ricerca di paging, il set di risultati viene presentato come singole pagine, ognuna delle quali contiene un numero predeterminato di voci di risultato.</span><span class="sxs-lookup"><span data-stu-id="90254-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="90254-108">Con questo tipo di ricerca, vengono restituite nuove pagine delle voci dei risultati fino a quando non viene raggiunta la fine del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="90254-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="90254-109">Per impostazione predefinita, il server che risponde a una richiesta di query calcola completamente un set di risultati prima di restituire i dati.</span><span class="sxs-lookup"><span data-stu-id="90254-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="90254-110">In un set di risultati di grandi dimensioni, questa operazione richiede memoria server mentre viene acquisito il set di risultati e la larghezza di banda di rete quando viene restituito il risultato di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="90254-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="90254-111">L'impostazione di una dimensione di pagina consente al server di inviare i dati nelle pagine durante la compilazione delle pagine.</span><span class="sxs-lookup"><span data-stu-id="90254-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="90254-112">Il client memorizza quindi i dati nella cache e fornisce un cursore al codice a livello di applicazione.</span><span class="sxs-lookup"><span data-stu-id="90254-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="90254-113">Il paging viene impostato definendo il numero di righe calcolate dal server prima che i dati vengano restituiti attraverso la rete al client.</span><span class="sxs-lookup"><span data-stu-id="90254-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="90254-114">La ricerca di paging offre vantaggi sia per il client che per il server.</span><span class="sxs-lookup"><span data-stu-id="90254-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="90254-115">Ad esempio, il client può essere più reattivo nella presentazione dei risultati agli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="90254-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="90254-116">Questo è particolarmente importante per gli strumenti dell'interfaccia utente grafica in grado di visualizzare i dati mentre un altro thread riceve contemporaneamente più dati dal server.</span><span class="sxs-lookup"><span data-stu-id="90254-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="90254-117">Quando si configura la query, se si specifica un tipo di ordinamento per il set di risultati, è necessario che il server calcoli completamente il set di risultati prima di restituire i dati al client, il che influisca sul tempo di risposta per la query.</span><span class="sxs-lookup"><span data-stu-id="90254-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="90254-118">Sul lato server, la ricerca di paging rende l'operazione scalabile.</span><span class="sxs-lookup"><span data-stu-id="90254-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="90254-119">Se, ad esempio, i client 100 inviano richieste di ricerca simultaneamente e, in media, a ogni client vengono restituiti 200 oggetti, se le dimensioni della pagina non vengono specificate, il server deve disporre di memoria sufficiente per contenere il set di risultati completo di 20.000 voci.</span><span class="sxs-lookup"><span data-stu-id="90254-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="90254-120">In alternativa, se ogni client specifica una dimensione di pagina di dieci oggetti, i requisiti di memoria sul server verrebbero ridotti di un fattore di 20.</span><span class="sxs-lookup"><span data-stu-id="90254-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="90254-121">Non tutti i servizi directory supportano le ricerche di paging.</span><span class="sxs-lookup"><span data-stu-id="90254-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="90254-122">Active Directory implementa l'architettura delle dimensioni di pagina.</span><span class="sxs-lookup"><span data-stu-id="90254-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="90254-123">Molti server di directory specificano un limite amministrativo per il numero massimo di oggetti che possono essere restituiti se un client non specifica le dimensioni della pagina.</span><span class="sxs-lookup"><span data-stu-id="90254-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="90254-124">Quando viene raggiunto il limite amministrativo, viene generato il limite di errore Win32 dell'amministratore di DS per gli **errori \_ \_ \_ \_** .</span><span class="sxs-lookup"><span data-stu-id="90254-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="90254-125">Sul lato client, una ricerca di paging consente a un client di arrestare l'operazione mentre è ancora in corso.</span><span class="sxs-lookup"><span data-stu-id="90254-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="90254-126">Al contrario, in una ricerca non di paging, il client viene bloccato fino a quando i dati non vengono restituiti completamente oppure si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="90254-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="90254-127">Questo potrebbe influisca sulle prestazioni di rete se il set di risultati risulta più grande e impiega più tempo del previsto.</span><span class="sxs-lookup"><span data-stu-id="90254-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="90254-128">Per conto del client, ADSI gestisce in modo trasparente le dimensioni della pagina.</span><span class="sxs-lookup"><span data-stu-id="90254-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="90254-129">Il client non deve contare il numero di oggetti in corso.</span><span class="sxs-lookup"><span data-stu-id="90254-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="90254-130">ADSI incapsula l'interazione del server per il client.</span><span class="sxs-lookup"><span data-stu-id="90254-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="90254-131">Dal punto di vista del client, la ricerca restituisce un set di risultati completo.</span><span class="sxs-lookup"><span data-stu-id="90254-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="90254-132">Per ulteriori informazioni sull'utilizzo dell'opzione timeout ricerca con un'interfaccia di ricerca specifica, vedere:</span><span class="sxs-lookup"><span data-stu-id="90254-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="90254-133">Paging con IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="90254-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="90254-134">Ricerca con ActiveX Data Objects</span><span class="sxs-lookup"><span data-stu-id="90254-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="90254-135">Ricerca con OLE DB</span><span class="sxs-lookup"><span data-stu-id="90254-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="90254-136">Una ricerca di paging è trasparente per l'applicazione perché ADSI continua a recuperare automaticamente ulteriori pagine di risultati finché non raggiunge la fine del set di risultati o la fine del limite di tempo impostato.</span><span class="sxs-lookup"><span data-stu-id="90254-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="90254-137">Quando si usa una ricerca di paging, il limite di dimensioni non esegue l'override delle dimensioni della pagina.</span><span class="sxs-lookup"><span data-stu-id="90254-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="90254-138">Il limite di dimensioni può essere utilizzato solo quando si recupera un set di risultati che contiene meno di 1000 voci.</span><span class="sxs-lookup"><span data-stu-id="90254-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




