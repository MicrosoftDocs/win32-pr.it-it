---
title: Risoluzione dei conflitti di nome di funzione/proprietà nell'automazione nelle estensioni
description: In questo argomento, \ 0034; oggetto \ 0034; indica l'oggetto, nel suo complesso, in cui un client ADSI lo Visualizza. Ovvero ADSI e tutte le relative estensioni.
ms.assetid: 76207326-879e-408b-8004-06d940401a41
ms.tgt_platform: multiple
keywords:
- Risoluzione dei conflitti di nomi di proprietà e funzioni nell'automazione nelle estensioni
- estensioni ADSI, risoluzione dei conflitti di funzioni e nomi di proprietà in automazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d9a7ac99b99ecdf0ee1b940f066d9e8166a15542
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104399717"
---
# <a name="resolution-of-functionproperty-name-conflicts-in-automation-in-extensions"></a><span data-ttu-id="84f49-106">Risoluzione dei conflitti di nome di funzione/proprietà nell'automazione nelle estensioni</span><span class="sxs-lookup"><span data-stu-id="84f49-106">Resolution of Function/Property Name Conflicts in Automation in Extensions</span></span>

<span data-ttu-id="84f49-107">In questo argomento, "Object" indica l'oggetto, come un intero, come un client ADSI che lo Visualizza.</span><span class="sxs-lookup"><span data-stu-id="84f49-107">In this topic, "object" indicates the object, as a whole, as an ADSI client views it.</span></span> <span data-ttu-id="84f49-108">Ovvero ADSI e tutte le relative estensioni.</span><span class="sxs-lookup"><span data-stu-id="84f49-108">That is, ADSI and all its extensions.</span></span>

## <a name="same-function-name-with-the-same-parameters"></a><span data-ttu-id="84f49-109">Stesso nome di funzione con gli stessi parametri</span><span class="sxs-lookup"><span data-stu-id="84f49-109">Same Function Name With the Same Parameters</span></span>

<span data-ttu-id="84f49-110">Se due o più interfacce [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) doppie in un oggetto supportano una proprietà o un metodo con lo stesso nome, ad esempio **func1**, la chiamata viene determinata in base ai criteri seguenti.</span><span class="sxs-lookup"><span data-stu-id="84f49-110">If two or more dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in an object support a property or method of the same name, for example, **Func1**, invocation is determined using the following criteria.</span></span> <span data-ttu-id="84f49-111">Se il client dispone di un puntatore a una delle interfacce duali che supportano un metodo denominato **func1** e se l'ambiente di automazione supporta l'accesso vtable, **func1** viene richiamato direttamente tramite l'accesso a vtable di ADSI.</span><span class="sxs-lookup"><span data-stu-id="84f49-111">If the client has a pointer to one of the dual interfaces that support a method called **Func1** and if the Automation environment supports vtable access, **Func1** is invoked directly through ADSI vtable access.</span></span>

<span data-ttu-id="84f49-112">Se una delle condizioni precedenti è false, [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) e [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) vengono chiamati per richiamare **func1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-112">If either of the conditions above is false, [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) and [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) are called to invoke **Func1**.</span></span>

<span data-ttu-id="84f49-113">Per ulteriori informazioni e una breve spiegazione su come un client può aggiungere un puntatore a una doppia interfaccia e una descrizione dei tipi di ambienti che supportano l'accesso a vtable, vedere [associazione tardiva rispetto all'accesso a vtable nel modello di estensione ADSI](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span><span class="sxs-lookup"><span data-stu-id="84f49-113">For more information and a brief explanation about how a client can add a pointer to a dual interface, and a description of the types of environments that support vtable access, see [Late Binding versus Vtable Access in the ADSI Extension Model](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span></span>

<span data-ttu-id="84f49-114">Poiché tutti gli oggetti di estensione reindirizzano le funzioni [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) a aggregator, l'aggregator controlla quale **func1** viene richiamato.</span><span class="sxs-lookup"><span data-stu-id="84f49-114">Because all extension objects redirect the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) functions back to the aggregator, the aggregator controls which **Func1** is invoked.</span></span> <span data-ttu-id="84f49-115">Le regole sono:</span><span class="sxs-lookup"><span data-stu-id="84f49-115">The rules are:</span></span>

-   <span data-ttu-id="84f49-116">Se una qualsiasi interfaccia, e ne sarà presente solo una, se presente, in Aggregator (ADSI) supporta una funzione denominata **func1**, l'aggregator richiama il proprio **func1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-116">If any interface, and there will be only one, if any, in the aggregator (ADSI) supports a function called **Func1**, the aggregator invokes its own **Func1**.</span></span>
-   <span data-ttu-id="84f49-117">In caso contrario, l'aggregatore passa attraverso ognuna delle relative estensioni, nell'ordine elencato nel registro di sistema, e trova la prima estensione che implementa una funzione denominata **func1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-117">Otherwise, the aggregator goes through each of its extensions, in the order listed in the registry, and finds the first extension that implements a function called **Func1**.</span></span> <span data-ttu-id="84f49-118">È possibile, ma improbabile, che più interfacce dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) in questa prima estensione abbiano una funzione denominata **func1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-118">It is possible, but unlikely, that multiple dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in this first extension have a function called **Func1**.</span></span> <span data-ttu-id="84f49-119">L'estensione deve determinare quali **func1** devono sempre essere richiamati in automazione.</span><span class="sxs-lookup"><span data-stu-id="84f49-119">The extension must determine which **Func1** should always be invoked in Automation.</span></span>

## <a name="same-function-name-with-different-parameters"></a><span data-ttu-id="84f49-120">Stesso nome di funzione con parametri diversi</span><span class="sxs-lookup"><span data-stu-id="84f49-120">Same Function Name With Different Parameters</span></span>

<span data-ttu-id="84f49-121">Nella sezione precedente è stato illustrato come risolvere i conflitti di nomi di funzione, ovvero i nomi di funzione che hanno lo stesso nome di funzione e lo stesso elenco di parametri, ad esempio numero, tipo e ordine, quando si verifica in automazione.</span><span class="sxs-lookup"><span data-stu-id="84f49-121">The previous section discussed how to resolve function name conflicts, that is, function names that have the same function name and same parameter list, such as number, type and order, when it occurs in Automation.</span></span> <span data-ttu-id="84f49-122">Cosa accade se due funzioni hanno lo stesso nome ma parametri diversi?</span><span class="sxs-lookup"><span data-stu-id="84f49-122">What if two functions have the same name but different parameters?</span></span> <span data-ttu-id="84f49-123">Se un client ADSI richiama la funzione utilizzando [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) senza utilizzare più nomi per specificare i parametri, il modello di estensione ADSI non può distinguere le funzioni.</span><span class="sxs-lookup"><span data-stu-id="84f49-123">If an ADSI client invokes the function using [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) without using multiple names to specify the parameters, the ADSI extension model cannot disambiguate the functions.</span></span> <span data-ttu-id="84f49-124">In base allo schema di risoluzione descritto in precedenza, la prima estensione nel registro di sistema che supporta questa funzione tramite una delle sue interfacce ha la versione di questa funzione richiamata e la chiamata potrebbe non riuscire o restituire risultati non corretti.</span><span class="sxs-lookup"><span data-stu-id="84f49-124">Based on the resolution scheme discussed in above, the first extension in the registry that supports this function through one of its interfaces has its version of this function invoked, and the call may fail or yield incorrect results.</span></span>

<span data-ttu-id="84f49-125">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="84f49-125">For example:</span></span>

-   <span data-ttu-id="84f49-126">Extn1 (prima nel registro di sistema in classe CA-priorità superiore) supporta **IInterface1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-126">Extn1 (first in the registry under class CA – higher priority) supports **IInterface1**.</span></span>
-   <span data-ttu-id="84f49-127">Extn2 (terzo nel registro di sistema in classe CA-priorità inferiore) supporta **IInterface2**.</span><span class="sxs-lookup"><span data-stu-id="84f49-127">Extn2 (third in the registry under class CA – lower priority) supports **IInterface2**.</span></span>
-   <span data-ttu-id="84f49-128">**IInterface1** supporta **Method1 (int param1, int param2)**.</span><span class="sxs-lookup"><span data-stu-id="84f49-128">**IInterface1** supports **Method1(int param1, int param2)**.</span></span>
-   <span data-ttu-id="84f49-129">**IInterface2** supporta **Method1 (int param1)**.</span><span class="sxs-lookup"><span data-stu-id="84f49-129">**IInterface2** supports **Method1(int param1)**.</span></span>

<span data-ttu-id="84f49-130">Un client ADSI dispone di un puntatore a interfaccia [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) a un oggetto della classe CA.</span><span class="sxs-lookup"><span data-stu-id="84f49-130">An ADSI client has an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface pointer to an object of class CA.</span></span> <span data-ttu-id="84f49-131">Desidera richiamare **IInterface2:: Method1**.</span><span class="sxs-lookup"><span data-stu-id="84f49-131">It wants to invoke **IInterface2::Method1**.</span></span> <span data-ttu-id="84f49-132">Se il client chiama "pDispatch->GetIDsOfNames (IID \_ null, rgszNames, 1, My \_ LCID, rgDispId)" semplicemente archiviando il nome della funzione "Method1" *in \[ rgszNames \] 0*, viene richiamato **IInterface1:: Method1** anziché l'oggetto **IInterface2:: Method1** desiderato e la funzione ha esito negativo perché il numero di parametri è diverso.</span><span class="sxs-lookup"><span data-stu-id="84f49-132">If the client calls "pDispatch->GetIDsOfNames(IID\_NULL, rgszNames, 1, MY\_LCID, rgDispId)" by just storing the function name "Method1" in *rgszNames\[0\]*, then **IInterface1::Method1** instead of the desired **IInterface2::Method1** is invoked, and the function fails because the number of parameters are different.</span></span>

<span data-ttu-id="84f49-133">Per ridurre al minimo questo problema, gli sviluppatori di estensioni possono anteporre i nomi di funzione ai relativi identificatori specifici ed evitare progettazioni di interfacce che usano funzioni con lo stesso nome, ma parametri diversi.</span><span class="sxs-lookup"><span data-stu-id="84f49-133">To minimize this problem, extension developers can prefix their function names with their own specific identifiers and avoid interface designs that use functions of the same name, but different parameters.</span></span>

<span data-ttu-id="84f49-134">Se si verifica un conflitto di nomi, i client ADSI possono evitare il problema tramite l'accesso diretto a vtable se l'interfaccia è una doppia interfaccia.</span><span class="sxs-lookup"><span data-stu-id="84f49-134">If a name conflict does occur, ADSI clients can avoid the problem by direct vtable access if the interface is a dual interface.</span></span> <span data-ttu-id="84f49-135">Se non è possibile accedere direttamente a vtable, i client ADSI devono chiamare [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) con più nomi, specificando i nomi di funzione e i parametri nella matrice *rgszNames* descritta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="84f49-135">If direct vtable access is not possible, ADSI clients should call [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) with multiple names, specifying the function names as well as the parameters in the array *rgszNames* described previously.</span></span>

<span data-ttu-id="84f49-136">Visual Basic 5 non chiama la funzione [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) con più nomi.</span><span class="sxs-lookup"><span data-stu-id="84f49-136">Visual Basic 5 does not call the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) function with multiple names.</span></span> <span data-ttu-id="84f49-137">Ovvero passa solo il nome della funzione a **GetIDsOfNames**, ma non gli argomenti.</span><span class="sxs-lookup"><span data-stu-id="84f49-137">That is, it passes only the function name to **GetIDsOfNames**, but not arguments.</span></span> <span data-ttu-id="84f49-138">Tuttavia, Visual Basic 5 consente agli utenti di richiamare una funzione tramite accesso diretto a vtable, anziché richiamare la funzione **IDispatch:: GetIDsOfNames** se l'interfaccia è un'interfaccia duale.</span><span class="sxs-lookup"><span data-stu-id="84f49-138">However, Visual Basic 5 allows users to invoke a function by direct vtable access, instead of invoking the **IDispatch::GetIDsOfNames** function if the interface is a dual interface.</span></span> <span data-ttu-id="84f49-139">Gli sviluppatori devono usare l'accesso diretto a vtable, se possibile.</span><span class="sxs-lookup"><span data-stu-id="84f49-139">Developers should use direct vtable access, if possible.</span></span>

<span data-ttu-id="84f49-140">Per ulteriori informazioni sulla risoluzione dei conflitti di nome, vedere l' [esempio per la risoluzione dei conflitti di nomi di funzione](example-for-resolving-function-name-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="84f49-140">For more information about name conflict resolution, see [Example for Resolving Function Name Conflicts](example-for-resolving-function-name-conflicts.md).</span></span>

 

 