---
title: Associazione a un oggetto Active Directory
description: Il modo più comune per eseguire l'associazione a un oggetto Active Directory consiste nell'usare la funzione GetObject tra un client ADSI e un provider ADSI.
ms.assetid: d278ea26-2fd5-4343-8d87-ff85515325fb
ms.tgt_platform: multiple
keywords:
- Associazione a un oggetto Active Directory ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 59992dbc88c00be6306dec24523ec4e030d4a516
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103872946"
---
# <a name="binding-to-an-active-directory-object"></a><span data-ttu-id="695d7-104">Associazione a un oggetto Active Directory</span><span class="sxs-lookup"><span data-stu-id="695d7-104">Binding to an Active Directory Object</span></span>

<span data-ttu-id="695d7-105">Il modo più comune per eseguire l'associazione a un oggetto Active Directory consiste nell'usare la funzione **GetObject** tra un client ADSI e un provider ADSI.</span><span class="sxs-lookup"><span data-stu-id="695d7-105">The most common way to bind to an Active Directory object is to use the **GetObject** function between an ADSI client and an ADSI provider.</span></span> <span data-ttu-id="695d7-106">Questo è anche il modo più semplice per illustrare il modo in cui il componente del provider riceve le richieste e i servizi.</span><span class="sxs-lookup"><span data-stu-id="695d7-106">This is also the easiest way to show how the provider component receives and services requests.</span></span> <span data-ttu-id="695d7-107">Sia la funzione API ADSI [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) che la funzione Visual Basic **GetObject** seguono gli stessi passaggi per l'associazione.</span><span class="sxs-lookup"><span data-stu-id="695d7-107">Both the ADSI API function [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) or the Visual Basic function **GetObject** follow the same steps for binding.</span></span>

<span data-ttu-id="695d7-108">Per questo esempio, si supponga che il client ADSI sia un'applicazione Visualizzatore ADSI che ha ricevuto il ADsPath "Sample://Seattle/Redmond/Shelly" dalla relativa interfaccia utente (1).</span><span class="sxs-lookup"><span data-stu-id="695d7-108">For this example, assume the ADSI client is an ADSI viewer application that has received the ADsPath "Sample://Seattle/Redmond/Shelly" from its user interface (1).</span></span> <span data-ttu-id="695d7-109">Nella figura seguente viene illustrata la sequenza di eventi numerando le frecce del flusso.</span><span class="sxs-lookup"><span data-stu-id="695d7-109">The following figure details the sequence of events by numbering the flow arrows.</span></span>

![visualizzazione dettagliata dei componenti ADSI](images/dscsex.png)

<span data-ttu-id="695d7-111">Nella figura precedente, il client avvia la richiesta di un puntatore a interfaccia nell'oggetto Active Directory rappresentato da ADsPath "Sample://Seattle/Redmond/Shelly" da servizi ADSI (2).</span><span class="sxs-lookup"><span data-stu-id="695d7-111">In the preceding figure, the client initiates the request for an interface pointer on the Active Directory object represented by the ADsPath "Sample://Seattle/Redmond/Shelly" from ADSI services (2).</span></span> <span data-ttu-id="695d7-112">Durante l'inizializzazione, il software dei servizi ha popolato una tabella di identificatori a livello di codice (ProgID) installati dal registro di sistema ("LDAP:", "Sample:", "WinNT:" e così via) e abbinati ai **CLSID** corrispondenti che identificano il modulo software appropriato.</span><span class="sxs-lookup"><span data-stu-id="695d7-112">During initialization, the services software populated a table of installed provider programmatic identifiers (ProgIDs) from the registry ("LDAP:","Sample:", "WinNT:", and so on) and paired them with the matching **CLSID** s which identify the appropriate software module.</span></span>

<span data-ttu-id="695d7-113">Il server ADSI verifica che il ProgID, in questo caso "Sample:", esista nella ADsPath.</span><span class="sxs-lookup"><span data-stu-id="695d7-113">The ADSI server verifies that the ProgID, in this case "Sample:", exists in the ADsPath.</span></span> <span data-ttu-id="695d7-114">Viene quindi creato un contesto di associazione per ottimizzare altri riferimenti a questo oggetto e viene chiamata la funzione COM standard [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) per creare un moniker COM che può essere usato per trovare e associare l'oggetto che rappresenta l'utente "Shelly".</span><span class="sxs-lookup"><span data-stu-id="695d7-114">It then creates a bind context to optimize further references to this object, and calls the standard COM function [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) to create a COM moniker that can be used to find and bind to the object that represents the user "Shelly".</span></span>

<span data-ttu-id="695d7-115">Nella sezione seguente, i nomi file del codice sorgente del componente provider di esempio sono inclusi tra parentesi laddove appropriato.</span><span class="sxs-lookup"><span data-stu-id="695d7-115">In the following section, the file names of the example provider component source code are included in parentheses where appropriate.</span></span>

<span data-ttu-id="695d7-116">Come in altre implementazioni di server COM, [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) esamina il ProgID e cerca il **CLSID** appropriato nel registro di sistema (3) per trovare il codice di class factory corrispondente fornito dal provider (Cprovcf. cpp) nell'implementazione del provider appropriata (4).</span><span class="sxs-lookup"><span data-stu-id="695d7-116">As in other COM server implementations, [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) examines the ProgID, and looks up the proper **CLSID** in the registry (3) to find the corresponding provider-supplied class factory code (Cprovcf.cpp) in the appropriate provider implementation (4).</span></span> <span data-ttu-id="695d7-117">Questo codice crea un oggetto iniziale di primo livello che implementa il metodo [**IParseDisplayName::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) (Cprov. cpp).</span><span class="sxs-lookup"><span data-stu-id="695d7-117">This code creates an initial top-level object that implements the [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) method (Cprov.cpp).</span></span> <span data-ttu-id="695d7-118">L'implementazione del provider di **ParseDisplayName** risolve il percorso nello spazio dei nomi del provider.</span><span class="sxs-lookup"><span data-stu-id="695d7-118">The provider's implementation of **ParseDisplayName** resolves the path in the provider's own namespace.</span></span> <span data-ttu-id="695d7-119">Viene infine chiamato ADsObject e viene richiamato il parser fornito con il componente provider (Parse. cpp) per verificare che ADsPath sia sintatticamente corretto per questo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="695d7-119">This eventually calls ADsObject and invokes the parser supplied with the provider component (Parse.cpp) to verify that the ADsPath is syntactically correct for this namespace.</span></span>

<span data-ttu-id="695d7-120">**GetObject**, definito in Getobj. cpp, determina se l'oggetto richiesto è un oggetto spazio dei nomi, un oggetto schema o un altro tipo di oggetto.</span><span class="sxs-lookup"><span data-stu-id="695d7-120">**GetObject**, that is defined in Getobj.cpp, then determines if the object requested is a namespace object, a schema object, or some other type of object.</span></span> <span data-ttu-id="695d7-121">Se uno dei primi due, viene creato tale tipo di oggetto della classe di schema e viene recuperato il puntatore di interfaccia appropriato.</span><span class="sxs-lookup"><span data-stu-id="695d7-121">If either of the first two, that type of schema class object is created and the appropriate interface pointer retrieved.</span></span> <span data-ttu-id="695d7-122">In caso contrario, il percorso della directory di esempio viene creato da ADsPath (ad esempio, " \\ Seattle \\ Redmond \\ Shelly", ma in un altro servizio directory potrebbe essere stato " \\ ou = Seattle \\ ou = Redmond \\ CN = Shelly") e il controllo passa a SampleDSOpenObject che apre l'oggetto nell'archivio dati di esempio e recupera anche il tipo di oggetto (in questo caso "User") (5).</span><span class="sxs-lookup"><span data-stu-id="695d7-122">Otherwise the Sample directory path is created from the ADsPath (for example, "\\Seattle\\Redmond\\Shelly", but in a different directory service it might have had to be "\\OU=Seattle\\OU=Redmond\\CN=Shelly") and control passes to SampleDSOpenObject which opens the object in the example data storage and also retrieves its object type (in this case, "User") (5).</span></span>

<span data-ttu-id="695d7-123">Con i dati raccolti, viene creato un nuovo oggetto (6) per rappresentare l'elemento descritto da ADsPath e viene recuperato un puntatore all'interfaccia [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) su tale oggetto.</span><span class="sxs-lookup"><span data-stu-id="695d7-123">With the data gathered, a new object is created (6) to represent the item described by the ADsPath, and a pointer to the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface on that object is retrieved.</span></span> <span data-ttu-id="695d7-124">In questo caso, viene creato un oggetto Active Directory generico che supporta i metodi **IUnknown** e [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) (Cgenobj. cpp, Core. cpp).</span><span class="sxs-lookup"><span data-stu-id="695d7-124">In this case, a generic Active Directory object is created that supports the **IUnknown** and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) methods (Cgenobj.cpp, Core.cpp).</span></span> <span data-ttu-id="695d7-125">La routine CSampleDSGenObject:: AllocateGenObject legge i dati della libreria dei tipi per creare le voci di distribuzione appropriate per questi nuovi oggetti allo scopo di supportare [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="695d7-125">The CSampleDSGenObject::AllocateGenObject routine reads the type library data to create the proper dispatch entries for these new objects in order to support [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span>

<span data-ttu-id="695d7-126">Il wrapping di questo puntatore di interfaccia in un moniker completa la funzione ResolvePathName (Cprov. cpp) e analizza il nome visualizzato.</span><span class="sxs-lookup"><span data-stu-id="695d7-126">Wrapping this interface pointer into a moniker completes the ResolvePathName (Cprov.cpp) function and parses the display name.</span></span>

<span data-ttu-id="695d7-127">Tutti gli oggetti COM creati durante questo processo vengono memorizzati nella cache per motivi di prestazioni e gestiti tramite il contesto di associazione.</span><span class="sxs-lookup"><span data-stu-id="695d7-127">All the COM objects created during this process are cached for performance reasons and managed through the binding context.</span></span> <span data-ttu-id="695d7-128">Ciò migliora le prestazioni per altre operazioni nello stesso oggetto che segue immediatamente l'associazione del moniker.</span><span class="sxs-lookup"><span data-stu-id="695d7-128">This improves performance for other operations on the same object that immediately follows the moniker binding.</span></span>

<span data-ttu-id="695d7-129">Questo oggetto Active Directory ben formato viene ora sottoposto a query per l'identificatore di interfaccia richiesto per la chiamata [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) iniziale e un puntatore a tale interfaccia viene recuperato (7) e passato attraverso il server ADSI al client (8&9).</span><span class="sxs-lookup"><span data-stu-id="695d7-129">This well-formed Active Directory object is now queried for the interface identifier requested for the initial [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) call and a pointer to that interface is retrieved (7) and passed back through the ADSI server to the client (8&9).</span></span> <span data-ttu-id="695d7-130">Da quel momento in poi, il client interagisce direttamente con il componente provider tramite i metodi di interfaccia finché la richiesta iniziale non viene soddisfatta (10).</span><span class="sxs-lookup"><span data-stu-id="695d7-130">From then on, the client works directly with the provider component through the interface methods until the initial request is satisfied (10).</span></span>

<span data-ttu-id="695d7-131">Inoltre, le richieste di dati dell'oggetto dal client in genere hanno il formato di richieste per le proprietà Gets e Put, tutte ottimizzate tramite l'implementazione del provider di una cache delle proprietà (cProps. cpp).</span><span class="sxs-lookup"><span data-stu-id="695d7-131">Furthermore, requests for object data from the client usually take the form of requests for property gets and puts, all of which are optimized through the provider implementation of a property cache (Cprops.cpp).</span></span> <span data-ttu-id="695d7-132">La compressione e la decompressione intelligenti dei dati, spesso incluse la copia e la liberazione di strutture e stringhe, tra i tipi di dati nativi sul sistema operativo del componente provider di esempio e il tipo di [**variante**](/windows/win32/api/oaidl/ns-oaidl-variant) di automazione supportato da ADSI avvengono prima che le proprietà vengano caricate nella cache (Smpoper. cpp).</span><span class="sxs-lookup"><span data-stu-id="695d7-132">Intelligently packing and unpacking data, often including copying and freeing structures and strings, between the native data types on the example provider component's operating system and the Automation [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type supported by ADSI takes place before the properties are loaded into the cache (Smpoper.cpp).</span></span>

<span data-ttu-id="695d7-133">Il componente provider di esempio è progettato in modo che le chiamate effettive al sistema operativo siano isolate logicamente dal componente provider, creando software portabile in più di un sistema operativo (RegDSAPI. cpp).</span><span class="sxs-lookup"><span data-stu-id="695d7-133">The example provider component is designed so that the actual calls to the operating system are logically isolated from the provider component, creating software portable to more than one operating system (RegDSAPI.cpp).</span></span>

 

 