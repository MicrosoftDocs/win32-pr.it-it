---
title: Che cosa esegue una query veloce
description: Questo argomento elenca i metodi di programmazione preferiti da usare durante l'esecuzione di query su una directory.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:
- Che cosa fa una query ADSI rapida
- query ADSI, che cosa esegue una query veloce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 883db1e9de7b7b7a1179c814d6f66f774685083e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103872958"
---
# <a name="what-makes-a-fast-query"></a><span data-ttu-id="6cbff-105">Che cosa esegue una query veloce?</span><span class="sxs-lookup"><span data-stu-id="6cbff-105">What Makes a Fast Query?</span></span>

<span data-ttu-id="6cbff-106">Quando si esegue una query, tenere presenti i seguenti concetti di miglioramento delle prestazioni:</span><span class="sxs-lookup"><span data-stu-id="6cbff-106">Consider the following performance enhancement concepts when executing a query:</span></span>

-   <span data-ttu-id="6cbff-107">Se possibile, filtrare solo sugli attributi indicizzati.</span><span class="sxs-lookup"><span data-stu-id="6cbff-107">If possible, filter on indexed attributes only.</span></span> <span data-ttu-id="6cbff-108">Usare gli attributi di indice che si prevede genereranno il minor numero di riscontri.</span><span class="sxs-lookup"><span data-stu-id="6cbff-108">Use index attributes that you expect will generate the fewest number of hits.</span></span> <span data-ttu-id="6cbff-109">Per ulteriori informazioni e per un elenco completo degli attributi indicizzati per Windows, vedere [Active Directory schema](/windows/desktop/ADSchema/active-directory-schema).</span><span class="sxs-lookup"><span data-stu-id="6cbff-109">For more information and a comprehensive list of indexed attributes for Windows, see [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span></span>
-   <span data-ttu-id="6cbff-110">Eseguire la ricerca in **objectCategory** anziché in **objectClass** perché **objectClass** non è una proprietà indicizzata.</span><span class="sxs-lookup"><span data-stu-id="6cbff-110">Search on **objectCategory** instead of **objectClass** because **objectClass** is not an indexed property.</span></span>
-   <span data-ttu-id="6cbff-111">Tenere presente i riferimenti.</span><span class="sxs-lookup"><span data-stu-id="6cbff-111">Be aware of referrals.</span></span> <span data-ttu-id="6cbff-112">Se gli attributi sono elencati come GC replicati, provare a eseguire ricerche nel catalogo globale.</span><span class="sxs-lookup"><span data-stu-id="6cbff-112">Consider searching the global catalog if your attributes are listed as GC replicated.</span></span>
-   <span data-ttu-id="6cbff-113">Evitare la ricerca di testo al centro e alla fine di una stringa.</span><span class="sxs-lookup"><span data-stu-id="6cbff-113">Avoid searching for text in the middle and at the end of a string.</span></span> <span data-ttu-id="6cbff-114">Ad esempio, "CN = \* Hille \* " o "CN = \* Larouse".</span><span class="sxs-lookup"><span data-stu-id="6cbff-114">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span>
-   <span data-ttu-id="6cbff-115">Si supponga che una ricerca del sottoalbero restituisca un set di risultati di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6cbff-115">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="6cbff-116">Usare il paging quando si eseguono ricerche di sottoalbero.</span><span class="sxs-lookup"><span data-stu-id="6cbff-116">Use paging when performing subtree searches.</span></span> <span data-ttu-id="6cbff-117">Il server sarà quindi in grado di trasmettere un set di risultati di grandi dimensioni in blocchi riducendo le risorse di memoria sul lato server.</span><span class="sxs-lookup"><span data-stu-id="6cbff-117">The server will then be able to stream a large result set in chunks reducing the server-side memory resources.</span></span> <span data-ttu-id="6cbff-118">Questo semplifica l'utilizzo della rete e riduce la necessità di inviare blocchi di dati molto grandi sulla rete.</span><span class="sxs-lookup"><span data-stu-id="6cbff-118">This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</span></span>
-   <span data-ttu-id="6cbff-119">Definire correttamente l'ambito delle ricerche in modo da non recuperare più di quanto necessario.</span><span class="sxs-lookup"><span data-stu-id="6cbff-119">Properly scope your searches so as to not retrieve more than is necessary.</span></span>
-   <span data-ttu-id="6cbff-120">Eseguire una ricerca complessa su più attributi, perché si tratta di una riduzione delle prestazioni più elevata rispetto all'esecuzione di più ricerche.</span><span class="sxs-lookup"><span data-stu-id="6cbff-120">Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches.</span></span> <span data-ttu-id="6cbff-121">Una ricerca di un oggetto che legge due attributi è più efficiente di due ricerche per lo stesso oggetto, ognuno dei quali restituisce un attributo.</span><span class="sxs-lookup"><span data-stu-id="6cbff-121">One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</span></span>
-   <span data-ttu-id="6cbff-122">Per leggere l'attributo con un numero elevato di valori, usare i limiti di intervallo per ridurre al minimo le dimensioni di ricerca in modo da poter leggere alcune migliaia di membri alla volta.</span><span class="sxs-lookup"><span data-stu-id="6cbff-122">For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time.</span></span> <span data-ttu-id="6cbff-123">Per ulteriori informazioni su come specificare i limiti dell'intervallo di attributi, vedere [recupero di intervalli di attributi](attribute-range-retrieval.md).</span><span class="sxs-lookup"><span data-stu-id="6cbff-123">For more information about specifying attribute range limits, see [Attribute Range Retrieval](attribute-range-retrieval.md).</span></span>
-   <span data-ttu-id="6cbff-124">Eseguire l'associazione a un oggetto per il resto della sessione.</span><span class="sxs-lookup"><span data-stu-id="6cbff-124">Bind to an object hold the binding handle for the remainder of your session.</span></span> <span data-ttu-id="6cbff-125">Non associare e annullare il binding per ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="6cbff-125">Do not bind and unbind for each call.</span></span> <span data-ttu-id="6cbff-126">Se si utilizza ADO o OLE DB, non creare molti oggetti connessione.</span><span class="sxs-lookup"><span data-stu-id="6cbff-126">If you are using ADO or OLE DB, do not create many connection objects.</span></span>
-   <span data-ttu-id="6cbff-127">Leggere il rootDSE una volta e ricordarne il contenuto per il resto della sessione.</span><span class="sxs-lookup"><span data-stu-id="6cbff-127">Read the rootDSE once and remember its contents for the remainder of your session.</span></span>

 

 