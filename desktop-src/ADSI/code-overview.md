---
title: Panoramica del codice
description: La figura seguente è una rappresentazione concettuale dei blocchi di codice necessari per implementare il componente del provider di esempio ADSI.
ms.assetid: b353c2d9-ef86-4e4c-ac00-4756fc9ec57d
ms.tgt_platform: multiple
keywords:
- Panoramica del codice AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e99a4974ac97488fc051ea80dbde7a8a83fa329e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104047364"
---
# <a name="code-overview"></a><span data-ttu-id="9295d-104">Panoramica del codice</span><span class="sxs-lookup"><span data-stu-id="9295d-104">Code Overview</span></span>

<span data-ttu-id="9295d-105">La figura seguente è una rappresentazione concettuale dei blocchi di codice necessari per implementare il componente del provider di esempio ADSI.</span><span class="sxs-lookup"><span data-stu-id="9295d-105">The following figure is a conceptual representation of the blocks of code necessary to implement the ADSI example provider component.</span></span> <span data-ttu-id="9295d-106">Ogni sezione è descritta nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="9295d-106">Each section is described in the following figure.</span></span> <span data-ttu-id="9295d-107">I programmatori COM esperti possono trovare questa è una panoramica appropriata del componente provider di esempio.</span><span class="sxs-lookup"><span data-stu-id="9295d-107">Experienced COM programmers may find this is to be a suitable overview of the example provider component.</span></span> <span data-ttu-id="9295d-108">Per ulteriori informazioni, vedere [Dettagli del codice](code-details.md).</span><span class="sxs-lookup"><span data-stu-id="9295d-108">For more information, see [Code Details](code-details.md).</span></span>

![implementazione del provider di esempio](images/dssmco.png)

<span data-ttu-id="9295d-110">Gli elementi numerati seguenti corrispondono agli elementi Block nella figura.</span><span class="sxs-lookup"><span data-stu-id="9295d-110">The following numbered items correspond to block elements in the figure.</span></span>

1.  <span data-ttu-id="9295d-111">Caricamento della DLL (LibMain. cpp, Guid. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-111">Loading the DLL (Libmain.cpp, Guid.cpp).</span></span> <span data-ttu-id="9295d-112">Il punto di ingresso per la DLL.</span><span class="sxs-lookup"><span data-stu-id="9295d-112">The entry point for the DLL.</span></span> <span data-ttu-id="9295d-113">Definizioni di oggetti statici di class factory per i due oggetti provider: GUID. cpp contiene le definizioni CLSID per le implementazioni dei vari oggetti componente del provider di esempio.</span><span class="sxs-lookup"><span data-stu-id="9295d-113">Class factory static object definitions for the two provider objects: Guid.cpp contains the CLSID definitions for the implementations of the various Example provider component objects.</span></span>
2.  <span data-ttu-id="9295d-114">Oggetto provider class factory e codice di creazione (Cprovcf. cpp, Cprov. cpp, STDFact. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-114">Provider object class factory and creation code (Cprovcf.cpp, Cprov.cpp, Stdfact.cpp).</span></span> <span data-ttu-id="9295d-115">L'oggetto provider è l'oggetto che supporta [**IParseDisplayName**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) durante le operazioni di associazione del moniker come descritto in ricerca e associazione nel componente provider di esempio.</span><span class="sxs-lookup"><span data-stu-id="9295d-115">The provider object is the object that supports [**IParseDisplayName**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) during the moniker binding operations as discussed in Finding and Binding in the Example Provider Component.</span></span>
3.  <span data-ttu-id="9295d-116">Associazione a un oggetto (Getobj. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-116">Binding to an object (Getobj.cpp).</span></span> <span data-ttu-id="9295d-117">Questo codice chiama il parser per verificare che il ADsPath specificato sia sintatticamente corretto, quindi esegue tutti i mapping necessari da ADsPath al percorso del servizio directory nativo per l'elemento creato come oggetto Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9295d-117">This code calls the parser to check that the given ADsPath is syntactically correct, and then performs any necessary mapping from the ADsPath to the native directory service path for the item being created as an Active Directory object.</span></span> <span data-ttu-id="9295d-118">Cerca la definizione dello schema per questo tipo di oggetto e compila le proprietà obbligatorie.</span><span class="sxs-lookup"><span data-stu-id="9295d-118">It looks up the schema definition for this type of object and fills in the mandatory properties.</span></span> <span data-ttu-id="9295d-119">Dopo la creazione dell'oggetto Active Directory, viene recuperato un puntatore di interfaccia a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) per il chiamante.</span><span class="sxs-lookup"><span data-stu-id="9295d-119">After creating the Active Directory object, an interface pointer to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) is retrieved for the caller.</span></span>
4.  <span data-ttu-id="9295d-120">Parser per lo spazio dei nomi del provider (Parse. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-120">Parser for the provider namespace (Parse.cpp).</span></span> <span data-ttu-id="9295d-121">Si tratta del codice richiamato dall'elemento 3.</span><span class="sxs-lookup"><span data-stu-id="9295d-121">This is the code invoked by item 3.</span></span> <span data-ttu-id="9295d-122">Il parser verifica che la stringa ADsPath passata sia sintatticamente corretta per il proprio spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="9295d-122">The parser verifies that the ADsPath string passed in is syntactically correct for its own namespace.</span></span>
5.  <span data-ttu-id="9295d-123">Class factory, creazione ed enumerazione per l'oggetto spazio dei nomi (Cnamcf. cpp, Cnamesp. cpp, Cenumns. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-123">Class factory, creation, and enumeration for the namespace object (Cnamcf.cpp, Cnamesp.cpp, Cenumns.cpp).</span></span> <span data-ttu-id="9295d-124">L'oggetto Namespace è un oggetto contenitore che può essere enumerato per trovare tutti gli oggetti nodo radice per questo spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="9295d-124">The namespace object is a container object that can be enumerated to find all the root node objects for this namespace.</span></span>
6.  <span data-ttu-id="9295d-125">Class factory e codice di creazione per un oggetto generico Active Directory e class factory, codice di creazione ed enumerazione per un oggetto contenitore di annunci generici (Cgenobj. cpp, Cenumobj. cpp, Common. cpp, Core. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-125">Class factory and creation code for a generic Active Directory object, and class factory, creation and enumeration code for a generic ADs container object (Cgenobj.cpp, Cenumobj.cpp, Common.cpp, Core.cpp).</span></span> <span data-ttu-id="9295d-126">Questo codice viene eseguito quando viene creato un oggetto Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9295d-126">This code is executed when an Active Directory object is created.</span></span>
7.  <span data-ttu-id="9295d-127">Filtrare ed enumerare le varianti (Cenumvar. cpp, Object. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-127">Filtering and enumerating VARIANTs (Cenumvar.cpp, Object.cpp).</span></span> <span data-ttu-id="9295d-128">Quando una raccolta di elementi VARIANT di un singolo tipo viene gestita all'interno di ADSI, viene utilizzato questo codice.</span><span class="sxs-lookup"><span data-stu-id="9295d-128">When a collection of VARIANT elements of a single type are managed in within ADSI, this code is used.</span></span>
8.  <span data-ttu-id="9295d-129">Globals (Globals. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-129">Globals (Globals.cpp).</span></span> <span data-ttu-id="9295d-130">Qui sono definite le parole chiave dello spazio dei nomi, le strutture di mapping della sintassi dai formati di dati nativi al tipo VARIANT di automazione degli annunci.</span><span class="sxs-lookup"><span data-stu-id="9295d-130">Namespace keywords, syntax mapping structures from native data formats to the ADs Automation VARIANT type are all defined here.</span></span>
9.  <span data-ttu-id="9295d-131">Marshalling/unmarshalling dei dati (Pack. cpp, Property. cpp, Smpoper. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-131">Marshaling/unmarshaling data (Pack.cpp, Property.cpp, Smpoper.cpp).</span></span> <span data-ttu-id="9295d-132">La conversione da formati di dati nativi al set supportato di tipi VARIANT di automazione si verifica quando le proprietà di un oggetto vengono caricate nella cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="9295d-132">Conversion from native data formats to the supported set of Automation VARIANT types occurs when properties of an object are loaded into the property cache.</span></span> <span data-ttu-id="9295d-133">È necessario eseguire un'altra gestione speciale dei dati quando le strutture con puntatori vengono copiate, eliminate o spostate in memoria.</span><span class="sxs-lookup"><span data-stu-id="9295d-133">Other special handling for data must be performed when structures with pointers are copied, deleted, or moved in memory.</span></span>
10. <span data-ttu-id="9295d-134">Cache delle proprietà (cProps. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-134">Property cache (Cprops.cpp).</span></span> <span data-ttu-id="9295d-135">La memorizzazione nella cache delle proprietà è una funzionalità dell'ambiente ADSI.</span><span class="sxs-lookup"><span data-stu-id="9295d-135">Caching properties is a feature of the ADSI environment.</span></span> <span data-ttu-id="9295d-136">I metodi [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs:: GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex)e [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) agiscono sulla cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="9295d-136">The [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs::GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex), and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) methods act on the property cache.</span></span>
11. <span data-ttu-id="9295d-137">Gestione della memoria (Memory. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-137">Memory management (Memory.cpp).</span></span> <span data-ttu-id="9295d-138">L'utilizzo di un set di funzioni di memoria per allocare e liberare memoria consente al componente provider di esempio di tenere traccia dell'utilizzo della memoria e di arrestare le perdite di memoria.</span><span class="sxs-lookup"><span data-stu-id="9295d-138">Using one set of memory functions to allocate and free memory allows the example provider component to track memory use and stop memory leaks.</span></span>
12. <span data-ttu-id="9295d-139">Oggetti e gestione dello schema (Cschobj. cpp, Cprpobj. cpp, Cclsobj. cpp, Cenumsch. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-139">Schema objects and management (Cschobj.cpp, Cprpobj.cpp, Cclsobj.cpp, Cenumsch.cpp).</span></span> <span data-ttu-id="9295d-140">Sono incluse le routine per creare, gestire ed enumerare gli oggetti dello schema.</span><span class="sxs-lookup"><span data-stu-id="9295d-140">This includes routines to create, manage, and enumerate the schema objects.</span></span> <span data-ttu-id="9295d-141">Sono inclusi oggetti della classe di schema, oggetti proprietà e oggetti sintassi, oltre a poter enumerare l'oggetto contenitore della classe dello schema.</span><span class="sxs-lookup"><span data-stu-id="9295d-141">This includes schema class objects, property objects, and syntax objects, in addition to being able to enumerate the schema class container object.</span></span>
13. <span data-ttu-id="9295d-142">Chiamate specifiche del sistema operativo (RegDSAPI. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-142">Operating-system specific calls (RegDSAPI.cpp).</span></span> <span data-ttu-id="9295d-143">Sono incluse tutte le chiamate che fanno riferimento al sistema operativo nativo.</span><span class="sxs-lookup"><span data-stu-id="9295d-143">This includes all calls that reference the native operating system.</span></span> <span data-ttu-id="9295d-144">Tra le altre funzioni, includono funzioni che aprono, chiudono, leggono e modificano gli oggetti, nonché quelli che accedono ai dati dello schema e della proprietà.</span><span class="sxs-lookup"><span data-stu-id="9295d-144">Among other functions, they include functions opening, closing, reading, and modifying objects as well as those accessing the schema and property data.</span></span> <span data-ttu-id="9295d-145">Il componente provider di esempio è stato usato per simulare una gerarchia di directory tramite il registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="9295d-145">The example provider component happened to simulate a directory hierarchy by using the registry.</span></span> <span data-ttu-id="9295d-146">Solo i nomi di funzione devono essere molto interessanti per un writer del provider.</span><span class="sxs-lookup"><span data-stu-id="9295d-146">Only function names should be of much interest to a provider writer.</span></span>
14. <span data-ttu-id="9295d-147">Implementazione di [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (Cdispmgr. cpp).</span><span class="sxs-lookup"><span data-stu-id="9295d-147">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) implementation (Cdispmgr.cpp).</span></span> <span data-ttu-id="9295d-148">Questo codice accede ai dati della libreria dei tipi per consentire che i metodi di interfaccia vengano richiamati in modo compatibile con l'automazione.</span><span class="sxs-lookup"><span data-stu-id="9295d-148">This code accesses the type library data to allow interface methods to be invoked in an Automation-compatible way.</span></span>

 

 