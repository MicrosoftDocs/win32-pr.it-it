---
title: Problemi di autenticazione per ADSI con ASP
description: A seconda della configurazione della rete Intranet, è possibile che si verifichino problemi di autenticazione quando il codice ADSI viene eseguito da una pagina ASP.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, pagine ASP, problemi di autenticazione
- ADSI, autenticazione, problemi ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730202"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="c9181-105">Problemi di autenticazione per ADSI con ASP</span><span class="sxs-lookup"><span data-stu-id="c9181-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="c9181-106">A seconda della configurazione della rete Intranet, è possibile che si verifichino problemi di autenticazione quando il codice ADSI viene eseguito da una pagina ASP.</span><span class="sxs-lookup"><span data-stu-id="c9181-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="c9181-107">L'autenticazione per l'accesso al controller di dominio può essere assegnata utilizzando la delega.</span><span class="sxs-lookup"><span data-stu-id="c9181-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="c9181-108">La delega consente a un servizio di agire come l'utente, in modo che possa accedere a una risorsa di rete utilizzando le credenziali dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c9181-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="c9181-109">Se la Intranet segue questa configurazione, è necessario configurare IIS per l'uso della delega.</span><span class="sxs-lookup"><span data-stu-id="c9181-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="c9181-110">Impostare il meccanismo di autenticazione IIS come anonimo o NTLM.</span><span class="sxs-lookup"><span data-stu-id="c9181-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="c9181-111">Se si sceglie Anonimo, verrà eseguito il mapping del contesto di sicurezza all' \_ account del computer IUSR.</span><span class="sxs-lookup"><span data-stu-id="c9181-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="c9181-112">Se si seleziona NTLM, il contesto di sicurezza cambierà, a seconda dell'utente che accede al sito Web.</span><span class="sxs-lookup"><span data-stu-id="c9181-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="c9181-113">Per ulteriori informazioni e istruzioni per la configurazione del server IIS per la delega, vedere la pagina relativa al [Resource Kit di Windows 2000](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="c9181-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="c9181-114">Se si usa un server IIS che usa la richiesta di verifica/risposta NT o un client browser che non supporta Kerberos, l'autenticazione a doppio hop non è supportata.</span><span class="sxs-lookup"><span data-stu-id="c9181-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="c9181-115">L'autenticazione a doppio hop indica che le credenziali utente vengono passate dal client browser al server IIS e quindi il server IIS passa le credenziali al server back-end.</span><span class="sxs-lookup"><span data-stu-id="c9181-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="c9181-116">In questa situazione, è possibile utilizzare una delle soluzioni seguenti per consentire l'accesso alla directory dalla pagina ASP:</span><span class="sxs-lookup"><span data-stu-id="c9181-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="c9181-117">Usare [**IADsOpenDSObject:: OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) o [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) per passare le credenziali a Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c9181-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="c9181-118">La pagina Web autentica l'utente connesso sul server IIS.</span><span class="sxs-lookup"><span data-stu-id="c9181-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="c9181-119">Quando l'utente è stato autenticato, la pagina Web può usare OpenDSObject o ADsOpenObject per passare un nome utente e una password al servizio directory per ottenere l'autenticazione al server back-end.</span><span class="sxs-lookup"><span data-stu-id="c9181-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="c9181-120">La pagina Web può quindi accedere ai dati dalla directory.</span><span class="sxs-lookup"><span data-stu-id="c9181-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="c9181-121">Aggiungere il codice a un oggetto COM e inserire questo oggetto in un' [applicazione com+](../cossdk/com--application-overview.md) , denominata in precedenza pacchetto MTS.</span><span class="sxs-lookup"><span data-stu-id="c9181-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="c9181-122">L'applicazione COM+ può quindi essere eseguita come [account utente di dominio](/windows/desktop/AD/domain-user-accounts).</span><span class="sxs-lookup"><span data-stu-id="c9181-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="c9181-123">Usare più pagine ASP, in cui una pagina autentica il client e un'altra pagina passa le credenziali alla directory usando l'autenticazione anonima per un account utente di dominio.</span><span class="sxs-lookup"><span data-stu-id="c9181-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="c9181-124">Questi metodi implicano l'autenticazione del client Web e la modifica delle credenziali quando si contatta la directory perché non è possibile eseguire l'autenticazione a doppio hop con le stesse credenziali.</span><span class="sxs-lookup"><span data-stu-id="c9181-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 