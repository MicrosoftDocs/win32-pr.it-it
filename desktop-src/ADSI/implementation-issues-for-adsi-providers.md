---
title: Problemi di implementazione per i provider ADSI
description: Problemi di implementazione per i provider ADSI
ms.assetid: 0be772aa-e7d8-4d34-b55a-162abfb0bfd4
ms.tgt_platform: multiple
keywords:
- Problemi di implementazione per i provider ADSI ADSI
- provider ADSI, implementazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4c362b04244580e448e7bb7bd78889e66db12fe
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104399731"
---
# <a name="implementation-issues-for-adsi-providers"></a><span data-ttu-id="cf4a2-105">Problemi di implementazione per i provider ADSI</span><span class="sxs-lookup"><span data-stu-id="cf4a2-105">Implementation Issues for ADSI Providers</span></span>

<span data-ttu-id="cf4a2-106">Per implementare le interfacce ADSI, implementare prima l'interfaccia COM [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span><span class="sxs-lookup"><span data-stu-id="cf4a2-106">To implement ADSI interfaces, first implement the COM interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span></span> <span data-ttu-id="cf4a2-107">Fornendo questa interfaccia come livello di overhead minimo, è necessario fornire alle applicazioni client il controllo necessario per accedere agli oggetti directory direttamente dalla directory anziché tramite la cache ADSI, che consente di ottimizzare le prestazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-107">By providing this interface as a minimal overhead layer, you supply client applications the control required to access directory objects directly from the directory rather than through the ADSI cache, which optimizes network performance.</span></span> <span data-ttu-id="cf4a2-108">L'uso di questa interfaccia fornirà anche un'implementazione personalizzata con la massima flessibilità.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-108">Using this interface will also supply your own implementation with the most flexibility.</span></span>

<span data-ttu-id="cf4a2-109">In secondo luogo, implementare le interfacce ADSI di base, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)e le interfacce della cache delle proprietà [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) .</span><span class="sxs-lookup"><span data-stu-id="cf4a2-109">Second, implement the fundamental ADSI interfaces, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection), and the [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) property cache interfaces.</span></span> <span data-ttu-id="cf4a2-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) e [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) sono inoltre interfacce in richiesta frequente da software di amministrazione del sistema.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) and [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) are also interfaces in frequent demand by system administration software.</span></span>

<span data-ttu-id="cf4a2-111">Terzo, implementare le interfacce di gestione dello schema se il servizio directory presenta uno schema sottostante: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="cf4a2-111">Third, implement the schema management interfaces if your directory service has an underlying schema: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span> <span data-ttu-id="cf4a2-112">Se non è presente alcuno schema sottostante, usare queste interfacce per astrarre le classi e le proprietà usate dal servizio directory.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-112">If there is no underlying schema, use these interfaces to abstract the classes and properties used by the directory service.</span></span> <span data-ttu-id="cf4a2-113">Gli schemi possono essere utilizzati per pubblicare le funzionalità del servizio directory nei client ADSI.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-113">Schemas can be used to publish the features of your directory service to ADSI clients.</span></span>

## <a name="collections"></a><span data-ttu-id="cf4a2-114">Raccolte</span><span class="sxs-lookup"><span data-stu-id="cf4a2-114">Collections</span></span>

<span data-ttu-id="cf4a2-115">I componenti del provider ADSI possono seguire uno dei tre modelli per la memorizzazione nella cache delle raccolte durante l'enumerazione.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-115">ADSI provider components can follow one of three models for caching collections during enumeration.</span></span> <span data-ttu-id="cf4a2-116">La scelta di un modello di memorizzazione nella cache determina il comportamento di ADSI quando un oggetto in una raccolta viene eliminato dal servizio directory sottostante esterno a ADSI.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-116">The choice of a caching model determines the behavior of ADSI when an object in a collection is deleted from the underlying directory service external to ADSI.</span></span>

<span data-ttu-id="cf4a2-117">I modelli di Caching includono:</span><span class="sxs-lookup"><span data-stu-id="cf4a2-117">The caching models include:</span></span>

-   <span data-ttu-id="cf4a2-118">Raccolte memorizzate nella cache in anticipo.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-118">Collections cached in advance.</span></span> <span data-ttu-id="cf4a2-119">La raccolta di istanze di oggetti viene recuperata interamente dal servizio directory sottostante quando viene chiamato [**IADsCollection:: Get \_ \_ NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) per creare un nuovo oggetto enumeratore.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-119">The collection of object instances is retrieved from the underlying directory service in its entirety when [**IADsCollection::get\_\_NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) is called to create a new enumerator object.</span></span> <span data-ttu-id="cf4a2-120">Se l'oggetto di origine per un'istanza dell'oggetto Active Directory nella raccolta recuperata viene eliminato dal servizio directory sottostante, il client non riconosce l'eliminazione fino a quando un oggetto [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tenta di accedere alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-120">If the source object for an Active Directory object instance in the retrieved collection is deleted from the underlying directory service, the client does not recognize the deletion until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the collection.</span></span>
-   <span data-ttu-id="cf4a2-121">Raccolte memorizzate in modo incrementale nella cache.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-121">Collections incrementally cached.</span></span> <span data-ttu-id="cf4a2-122">La raccolta viene recuperata dal servizio directory sottostante un oggetto alla volta quando viene chiamato [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) .</span><span class="sxs-lookup"><span data-stu-id="cf4a2-122">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="cf4a2-123">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) tornerà all'inizio della raccolta nella cache e **IEnumVARIANT:: Next** restituirà oggetti memorizzati nella cache fino a quando non viene raggiunta la fine della cache, a cui verranno aggiunti nuovi oggetti dall'archivio sottostante.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-123">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the cache and **IEnumVARIANT::Next** will return cached objects until the end of the cache is reached, at which point new objects will be added from the underlying store.</span></span> <span data-ttu-id="cf4a2-124">Quando un'istanza dell'oggetto Active Directory si trova nella cache, il client non viene a conoscenza dell'eliminazione dal servizio directory sottostante fino a quando [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tenta di accedere all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-124">When an Active Directory object instance is in the cache the client will not become aware of its deletion from the underlying directory service until an [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>
-   <span data-ttu-id="cf4a2-125">Raccolte non memorizzate nella cache.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-125">Collections not cached.</span></span> <span data-ttu-id="cf4a2-126">La raccolta viene recuperata dal servizio directory sottostante un oggetto alla volta quando viene chiamato [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) .</span><span class="sxs-lookup"><span data-stu-id="cf4a2-126">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="cf4a2-127">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) tornerà all'inizio della raccolta nell'archivio sottostante.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-127">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the underlying store.</span></span> <span data-ttu-id="cf4a2-128">Le operazioni **IEnumVARIANT:: Next** e **IEnumVARIANT:: Reset** non possono recuperare gli oggetti eliminati perché gli oggetti vengono recuperati su richiesta dal servizio directory sottostante.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-128">**IEnumVARIANT::Next** and **IEnumVARIANT::Reset** operations cannot retrieve deleted objects, because the objects are retrieved on-demand from the underlying directory service.</span></span> <span data-ttu-id="cf4a2-129">Solo l'oggetto corrente viene memorizzato nella cache. Se l'oggetto corrente viene eliminato, il client non sarà in grado di rilevare l'eliminazione dal servizio directory sottostante fino a quando [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tenta di accedere all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-129">Only the current object is cached; if the current object is deleted, the client will not become aware of its deletion from the underlying directory service until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>

<span data-ttu-id="cf4a2-130">Indipendentemente dal modello di memorizzazione nella cache, tenere presente che l'enumerazione ADSI restituisce Active Directory interfacce del servizio al chiamante.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-130">Regardless of the caching model, be aware that ADSI enumeration returns Active Directory service interfaces to the caller.</span></span> <span data-ttu-id="cf4a2-131">Per evitare il sovraccarico dovuto all'ottenimento di un nuovo puntatore di interfaccia, le applicazioni ADSI devono memorizzare nella cache i puntatori dell'interfaccia restituiti per gli oggetti che desiderano modificare.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-131">To avoid the overhead of obtaining a new interface pointer, ADSI applications should cache the returned interface pointers for objects that they intend to manipulate.</span></span> <span data-ttu-id="cf4a2-132">Ad esempio, un'applicazione Visual Basic che enumera un contenitore e popola una casella di riepilogo con i nomi può memorizzare nella cache i puntatori di interfaccia associati ai nomi per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-132">For example, a Visual Basic application that enumerates a container and populates a list box with names can cache the interface pointers associated with the names for later use.</span></span> <span data-ttu-id="cf4a2-133">Questo approccio offre prestazioni maggiori rispetto al popolamento della casella di riepilogo durante l'enumerazione e al recupero di un nuovo puntatore di interfaccia quando l'utente effettua una selezione.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-133">This approach will provide greater performance than populating the list box during enumeration and obtaining a new interface pointer when the user makes a selection.</span></span>

## <a name="about-dispatch-ids"></a><span data-ttu-id="cf4a2-134">Informazioni sugli ID di invio</span><span class="sxs-lookup"><span data-stu-id="cf4a2-134">About Dispatch IDs</span></span>

<span data-ttu-id="cf4a2-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) è un'interfaccia di automazione definita da com per i controller che non utilizzano direttamente le interfacce com.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) is an Automation interface defined by COM for controllers that do not use COM interfaces directly.</span></span> <span data-ttu-id="cf4a2-136">L'accesso a un oggetto tramite **IDispatch** è denominato accesso con associazione a nome o ad associazione tardiva, perché si verifica in fase di esecuzione ("tardivo") e usa nomi di stringa di proprietà e metodi per risolvere i riferimenti ("Name").</span><span class="sxs-lookup"><span data-stu-id="cf4a2-136">Accessing an object through **IDispatch** is called name-bound or late-bound access, because it occurs at run time ("late") and uses string names of properties and methods to resolve references ("name").</span></span> <span data-ttu-id="cf4a2-137">In fase di esecuzione, i client passano il nome stringa della proprietà o del metodo che desiderano chiamare nel metodo [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)().</span><span class="sxs-lookup"><span data-stu-id="cf4a2-137">At run time, clients pass the string name of the property or method they wish to call into the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)() method.</span></span> <span data-ttu-id="cf4a2-138">Se la proprietà o il metodo esiste nell'oggetto, viene recuperato l'identificatore di invio (dispID) della funzione corrispondente.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-138">If the property or method exists on the object, the dispatch identifier (dispID) of the corresponding function is retrieved.</span></span> <span data-ttu-id="cf4a2-139">Il dispID viene quindi usato per eseguire la funzione tramite [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span><span class="sxs-lookup"><span data-stu-id="cf4a2-139">The dispID is then used to execute the function through [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span></span> <span data-ttu-id="cf4a2-140">Con **IDispatch**, le proprietà e i metodi sulle interfacce esposte da un singolo oggetto vengono visualizzati come un elenco semplice.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-140">Using **IDispatch**, properties and methods on the interfaces exposed by a single object appear as a flat list.</span></span> <span data-ttu-id="cf4a2-141">Poiché l'accesso con associazione al nome richiede due chiamate di funzione, è meno efficiente rispetto all'uso diretto di un'interfaccia COM.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-141">Because name-bound access requires two function calls, it is less efficient than using a COM interface directly.</span></span> <span data-ttu-id="cf4a2-142">È consigliabile che i client usino le interfacce ADSI COM sugli oggetti quando le prestazioni sono una considerazione.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-142">Clients are encouraged to use the ADSI COM interfaces on the objects when performance is a consideration.</span></span> <span data-ttu-id="cf4a2-143">I controller di automazione avanzati, come Visual Basic 4,0, possono chiamare altre interfacce COM e **IDispatch** se le interfacce sono conformi ai vincoli di automazione per i tipi di dati e il passaggio di parametri.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-143">Advanced Automation controllers such as Visual Basic 4.0 can call other COM interfaces as well as **IDispatch**, if the interfaces comply with the Automation constraints for data types and parameter passing.</span></span>

<span data-ttu-id="cf4a2-144">I provider ADSI generano i DISPID in modo dinamico per ogni oggetto Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-144">ADSI providers generate dispIDs dynamically for each Active Directory object.</span></span> <span data-ttu-id="cf4a2-145">I DISPID recuperati tramite [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) per un determinato oggetto sono i valori generati, ma non i valori presenti nell'IDL per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-145">The dispIDs retrieved through [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) for a given object are the generated values, but not the values that are in the IDL for the object.</span></span> <span data-ttu-id="cf4a2-146">Gli utenti [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) devono chiamare **GetIDsOfNames** per ottenere i DISPID validi in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) users must call **GetIDsOfNames** to obtain valid dispIDs at run time.</span></span>

## <a name="type-information-and-type-libraries"></a><span data-ttu-id="cf4a2-147">Informazioni sul tipo e librerie di tipi</span><span class="sxs-lookup"><span data-stu-id="cf4a2-147">Type Information and Type Libraries</span></span>

<span data-ttu-id="cf4a2-148">ADSI SDK fornisce una libreria dei tipi, activeds. tlb, che documenta tutte le interfacce standard supportate da ADSI.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-148">The ADSI SDK supplies a type library, Activeds.tlb, that documents all the standard interfaces supported by ADSI.</span></span> <span data-ttu-id="cf4a2-149">Un provider deve fornire una libreria dei tipi simile per tutte le interfacce presenti in activeds. tlb, più tutti i dati di tipo aggiuntivi per le interfacce implementate all'interno del componente provider.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-149">A provider must supply a similar type library for all interfaces found in Activeds.tlb, plus any additional type data for the interfaces implemented within the provider component.</span></span>

<span data-ttu-id="cf4a2-150">Di seguito è riportato un esempio di codice IDL.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-150">The following is an IDL code example.</span></span>

``` syntax
[ object, uuid(IID_IADsXYZ), oleautomation, dual ]
interface IADsXYZ: IDispatch
{
// Read-only properties.
[propget]
HRESULT AReadOnlyProp ([out, retval]BSTR *pbstrAReadOnlyProp);
 
// Read/write properties.
[propget]
HRESULT AReadWriteProp ([out, retval]long *plAReadWriteProp);
[propput]
HRESULT AReadWriteProp ([in]long lAReadWriteProp);
 
// Methods.
HRESULT AMethod ([in]DATE dateInParameter,
[out, retval]BSTR *pbstrReturnValue);
};
```

## <a name="thread-safety"></a><span data-ttu-id="cf4a2-151">Thread safety</span><span class="sxs-lookup"><span data-stu-id="cf4a2-151">Thread Safety</span></span>

<span data-ttu-id="cf4a2-152">Il Component Object Model (COM) descrive i seguenti tre modelli di Threading.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-152">The Component Object Model (COM) describes the following three threading models.</span></span> <span data-ttu-id="cf4a2-153">Le applicazioni COM indicano quale modello è in uso quando si inizializza la libreria COM usando le funzioni [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) e [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) :</span><span class="sxs-lookup"><span data-stu-id="cf4a2-153">COM applications indicate which model is in use when initializing the COM library using the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) and [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) functions:</span></span>

-   <span data-ttu-id="cf4a2-154">Thread singolo.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-154">Single threading.</span></span> <span data-ttu-id="cf4a2-155">Il modello a thread singolo presuppone un singolo thread di esecuzione in un processo, presupponendo che le strutture di dati COM in un processo non richiedano la serializzazione dell'accesso.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-155">The single threaded model assumes a single thread of execution in a process, further assuming that COM data structures in a process need no access serialization.</span></span>
-   <span data-ttu-id="cf4a2-156">Threading dell'Apartment.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-156">Apartment threading.</span></span> <span data-ttu-id="cf4a2-157">Un oggetto COM è associato al thread che lo ha creato.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-157">A COM object is associated with the thread that created it.</span></span> <span data-ttu-id="cf4a2-158">Le chiamate a un oggetto in un altro thread devono essere eseguite dal thread che ha creato l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-158">Calls to an object on another thread must be executed by the thread that created that object.</span></span> <span data-ttu-id="cf4a2-159">A tale scopo, il thread di origine richiama un proxy client che dispone la chiamata al metodo e la recapita a una funzione stub del server nel thread di destinazione tramite la coda di messaggi Win32 associata al thread di destinazione.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-159">To accomplish this, the source thread invokes a client proxy which arranges the method call and delivers it to a server stub function in the destination thread through the Win32 message queue associated with the destination thread.</span></span>
-   <span data-ttu-id="cf4a2-160">Threading gratuito.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-160">Free threading.</span></span> <span data-ttu-id="cf4a2-161">Si presuppone che gli oggetti COM siano thread-safe.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-161">COM objects are assumed to be thread safe.</span></span> <span data-ttu-id="cf4a2-162">A più thread è consentito l'accesso a qualsiasi oggetto nel processo senza alcuna serializzazione imposta.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-162">Multiple threads are allowed access to any object in the process with no serialization imposed.</span></span>

<span data-ttu-id="cf4a2-163">ADSI non presuppone un modello di threading particolare.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-163">ADSI does not assume any particular threading model.</span></span> <span data-ttu-id="cf4a2-164">I writer dei componenti del provider dovrebbero presupporre il modello di threading libero e garantire la coerenza delle strutture di dati interne proteggendo gli aggiornamenti da thread-unsafe, ovvero non coordinati, tramite l'uso di oggetti di sincronizzazione, ad esempio sezioni critiche o semafori.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-164">Writers of provider components should assume the free threading model and guarantee the consistency of their internal data structures by protecting them from thread-unsafe, that is, uncoordinated, updates through the use of synchronization objects such as critical sections or semaphores.</span></span>

## <a name="object-locking"></a><span data-ttu-id="cf4a2-165">Blocco di oggetti</span><span class="sxs-lookup"><span data-stu-id="cf4a2-165">Object Locking</span></span>

<span data-ttu-id="cf4a2-166">ADSI non impone o definisce uno schema di blocco degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-166">ADSI does not impose or define an object-locking scheme.</span></span> <span data-ttu-id="cf4a2-167">I provider per gli spazi dei nomi che supportano la serializzazione di accesso mediante blocco possono esporre lo schema di blocco sottostante tramite estensioni specifiche del provider a ADSI.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-167">Providers for namespaces that support access serialization using locking can expose the underlying locking scheme through provider-specific extensions to ADSI.</span></span>

## <a name="property-names-within-a-schema"></a><span data-ttu-id="cf4a2-168">Nomi delle proprietà all'interno di uno schema</span><span class="sxs-lookup"><span data-stu-id="cf4a2-168">Property Names Within a Schema</span></span>

<span data-ttu-id="cf4a2-169">ADSI rappresenta le proprietà come oggetti proprietà all'interno del contenitore dello schema ADSI.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-169">ADSI represents properties as property objects within the ADSI schema container.</span></span> <span data-ttu-id="cf4a2-170">Questa operazione richiede che i nomi delle proprietà siano univoci all'interno di ogni contenitore dello schema.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-170">This requires that property names be unique within each schema container.</span></span> <span data-ttu-id="cf4a2-171">Il provider deve assicurarsi che non siano presenti conflitti di nome.</span><span class="sxs-lookup"><span data-stu-id="cf4a2-171">The provider must ensure that there are no name collisions.</span></span>

## <a name="primary-interface"></a><span data-ttu-id="cf4a2-172">Interfaccia primaria</span><span class="sxs-lookup"><span data-stu-id="cf4a2-172">Primary Interface</span></span>

<span data-ttu-id="cf4a2-173">Quando un provider non è in grado di identificare l'interfaccia che deve essere restituita come interfaccia primaria, deve essere restituito **IID \_ IADs** .</span><span class="sxs-lookup"><span data-stu-id="cf4a2-173">When a provider cannot identify which interface should be returned as the primary interface, **IID\_IADs** should be returned.</span></span> <span data-ttu-id="cf4a2-174">In questo modo viene fornito l'accesso associato al nome a tutte le proprietà di un oggetto tramite [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) e i metodi [**IADs:: Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs:: GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::P UT**](/windows/desktop/api/Iads/nf-iads-iads-put)e [**IADs::P UTEX**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="cf4a2-174">This provides name-bound access to all properties of an object through [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) and the [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::Put**](/windows/desktop/api/Iads/nf-iads-iads-put), and [**IADs::PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) methods.</span></span>

 

 