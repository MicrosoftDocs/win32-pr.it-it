---
title: Ambito della query
description: L'ambito di una query è determinato dall'oggetto a cui si esegue l'associazione.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- ambito di query ADSI
- query ADSI, ambito
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103707387"
---
# <a name="scope-of-query"></a><span data-ttu-id="158ae-105">Ambito della query</span><span class="sxs-lookup"><span data-stu-id="158ae-105">Scope of Query</span></span>

<span data-ttu-id="158ae-106">L'ambito di una query è determinato dall'oggetto a cui si esegue l'associazione.</span><span class="sxs-lookup"><span data-stu-id="158ae-106">The scope of a query is determined by the object to which you bind.</span></span> <span data-ttu-id="158ae-107">Se non si è certi della posizione in cui si trova l'oggetto all'interno dell'azienda, sarà necessario eseguire una ricerca più ampia possibile.</span><span class="sxs-lookup"><span data-stu-id="158ae-107">If you are unsure where the object is located within the enterprise then you will need to do as wide a search as possible.</span></span> <span data-ttu-id="158ae-108">Tuttavia, se si è certi che l'oggetto sarà contenuto all'interno di un dominio specifico, ad esempio il dominio a cui l'utente è connesso o all'interno di un gruppo specifico, ad esempio il gruppo Managers, sarà necessario impostare l'ambito della ricerca in modo da riflettere la circostanza.</span><span class="sxs-lookup"><span data-stu-id="158ae-108">However, if you know that the object will be contained within a specific domain, such as the domain that the user is connected to, or within a specific group, such as the Managers group, then you should set the scope of the search to reflect the circumstance.</span></span> <span data-ttu-id="158ae-109">Per ottenere prestazioni ottimali, è consigliabile tentare di specificare come destinazione l'ambito per cercare il minor numero possibile di oggetti.</span><span class="sxs-lookup"><span data-stu-id="158ae-109">For the best performance, you should try to target the scope to search the smallest number of objects possible.</span></span>

<span data-ttu-id="158ae-110">Quando non si è certi della posizione di un oggetto nell'organizzazione, è possibile eseguire l'associazione al servizio catalogo globale.</span><span class="sxs-lookup"><span data-stu-id="158ae-110">When you are not sure where an object will be located in the enterprise, you can bind to the global catalog service.</span></span> <span data-ttu-id="158ae-111">Il servizio catalogo globale contiene un elenco di tutti gli oggetti nella directory e un piccolo subset di tutti gli attributi dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="158ae-111">The global catalog service contains a list of every object in the directory and a small subset of each object's attributes.</span></span> <span data-ttu-id="158ae-112">Dopo aver individuato l'oggetto nel catalogo globale, è possibile recuperare il nome distinto dal catalogo globale e utilizzarlo per l'associazione all'oggetto per eseguire altre operazioni.</span><span class="sxs-lookup"><span data-stu-id="158ae-112">After you find the object in the global catalog, you can retrieve its distinguished name from the global catalog and use it to bind to the object to perform other operations.</span></span>

<span data-ttu-id="158ae-113">Dopo aver scelto l'oggetto da associare, è possibile limitare ulteriormente la query a uno degli ambiti seguenti: una query di base, una query a un livello o una ricerca di sottoalbero, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="158ae-113">After you decide which object to bind to, you can further restrict the query to one of the following scopes: a base query, a one-level query, or a subtree search, as shown in the following illustration.</span></span>

![oggetti alla radice di una ricerca di una ricerca di base, di un livello o di un sottoalbero](images/netds6.png)

## <a name="base"></a><span data-ttu-id="158ae-115">Base</span><span class="sxs-lookup"><span data-stu-id="158ae-115">Base</span></span>

<span data-ttu-id="158ae-116">Una query di base limita la ricerca solo all'oggetto di base.</span><span class="sxs-lookup"><span data-stu-id="158ae-116">A base query limits the search to only the base object.</span></span> <span data-ttu-id="158ae-117">Il numero massimo di oggetti restituiti è sempre uno.</span><span class="sxs-lookup"><span data-stu-id="158ae-117">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="158ae-118">Questa ricerca può essere usata per verificare l'esistenza di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="158ae-118">This search can be used to verify the existence of an object.</span></span> <span data-ttu-id="158ae-119">Se, ad esempio, si dispone di un nome distinto di un oggetto ed è necessario verificare l'esistenza dell'oggetto in base al percorso, è possibile utilizzare una ricerca a un solo livello.</span><span class="sxs-lookup"><span data-stu-id="158ae-119">For example, if you have an object's distinguished name and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="158ae-120">Se la ricerca ha esito negativo, è possibile presupporre che l'oggetto sia stato rinominato o spostato in un percorso diverso o che siano stati forniti dati non corretti sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="158ae-120">If the search fails, you can assume that the object may have been renamed or moved to a different location, or that you were given incorrect data about the object.</span></span> <span data-ttu-id="158ae-121">Si noti che è necessario archiviare il GUID anziché il nome distinto se si vuole rivedere un oggetto.</span><span class="sxs-lookup"><span data-stu-id="158ae-121">Be aware that you should store the GUID instead of the distinguished name if you want to revisit an object.</span></span> <span data-ttu-id="158ae-122">In questo modo è possibile rinominare o spostare l'oggetto nella gerarchia di directory senza suddividere il collegamento permanente.</span><span class="sxs-lookup"><span data-stu-id="158ae-122">This allows the object to be renamed or moved in the directory hierarchy without breaking the persisted link.</span></span>

## <a name="one-level"></a><span data-ttu-id="158ae-123">Un livello</span><span class="sxs-lookup"><span data-stu-id="158ae-123">One Level</span></span>

<span data-ttu-id="158ae-124">Una ricerca a un solo livello è limitata agli elementi figlio immediati di un oggetto di base, ma esclude l'oggetto di base stesso.</span><span class="sxs-lookup"><span data-stu-id="158ae-124">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="158ae-125">Questa impostazione può eseguire una ricerca di destinazione per gli oggetti figlio immediati di un oggetto padre.</span><span class="sxs-lookup"><span data-stu-id="158ae-125">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="158ae-126">Ad esempio, se si dispone di un oggetto padre denominato P1 e i relativi elementi figlio immediati sono: C1, C2, C3, in una ricerca a un livello, C1, C2 e C3 devono essere inclusi durante la valutazione dei criteri, ma P1 non fa parte della ricerca.</span><span class="sxs-lookup"><span data-stu-id="158ae-126">For example, if you have a parent object called P1, and its immediate children are: C1, C2, C3, then in a one-level search, C1, C2, and C3 should be included when evaluating the criteria, but P1 would not be part of the search.</span></span> <span data-ttu-id="158ae-127">Una ricerca a un livello può essere utilizzata per enumerare tutti gli elementi figlio di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="158ae-127">A one-level search can be used to enumerate all children of an object.</span></span> <span data-ttu-id="158ae-128">In alcuni provider ADSI, infatti, l'enumerazione [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) viene convertita in una ricerca a un solo livello.</span><span class="sxs-lookup"><span data-stu-id="158ae-128">In fact, in some ADSI providers, [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>

## <a name="subtree"></a><span data-ttu-id="158ae-129">Sottoalbero</span><span class="sxs-lookup"><span data-stu-id="158ae-129">Subtree</span></span>

<span data-ttu-id="158ae-130">Una ricerca del sottoalbero, nota anche come ricerca completa, include tutti gli oggetti sotto l'oggetto di base, escluso l'oggetto di base stesso.</span><span class="sxs-lookup"><span data-stu-id="158ae-130">A subtree search, also known as a deep search, includes all the objects beneath the base object, excluding the base object itself.</span></span> <span data-ttu-id="158ae-131">Questa ricerca può generare riferimenti ad altri server.</span><span class="sxs-lookup"><span data-stu-id="158ae-131">This search may generate referrals to other servers.</span></span> <span data-ttu-id="158ae-132">Questa ricerca ha l'ambito più grande e può restituire un set di risultati di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="158ae-132">This search has the greatest scope and may return a large result set.</span></span> <span data-ttu-id="158ae-133">Se possibile, eseguire una ricerca su almeno un attributo indicizzato e impostare le impostazioni dei riferimenti (per altre informazioni, vedere [prestazioni e gestione di set di risultati di grandi dimensioni](performance-and-handling-large-result-sets.md)) per soddisfare i requisiti di ricerca.</span><span class="sxs-lookup"><span data-stu-id="158ae-133">If possible, search on at least one indexed attribute and set the referrals settings (for more information, see [Performance and Handling Large Result Sets](performance-and-handling-large-result-sets.md)) to match your search requirements.</span></span> <span data-ttu-id="158ae-134">È inoltre consigliabile che i risultati di una ricerca di sottoalbero vengano eseguiti in modo asincrono e di paging per ridurre l'overhead del server e l'efficacia della rete.</span><span class="sxs-lookup"><span data-stu-id="158ae-134">It is also suggested that the results of a subtree search be performed asynchronously and paged to reduce the server overhead and network effectiveness.</span></span> <span data-ttu-id="158ae-135">Una ricerca di sottoalbero viene in genere usata per cercare oggetti per un ambito specifico.</span><span class="sxs-lookup"><span data-stu-id="158ae-135">A subtree search is normally used to search objects for a given scope.</span></span> <span data-ttu-id="158ae-136">Ad esempio, cercare tutti gli utenti con account che scadranno tra 30 giorni o meno.</span><span class="sxs-lookup"><span data-stu-id="158ae-136">For example, search for all users with accounts that will expire in 30 days or less.</span></span>

 

 




