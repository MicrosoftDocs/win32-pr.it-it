---
title: Barra della lingua (servizi di testo)
description: Barra della lingua
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Framework servizi di testo (TSF), barra della lingua
- TSF (Framework servizi di testo),barra della lingua
- servizi di testo, barra della lingua
- barra della lingua
- Framework servizi di testo (TSF), pulsanti
- TSF (Framework servizi di testo),pulsanti
- servizi di testo, pulsanti
- Framework servizi di testo (TSF), menu
- TSF (Framework servizi di testo),menu
- servizi di testo, menu
- stili pulsante
- pulsanti di menu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e3c4359c6753f5d96613435f9501036f1d5f317
ms.sourcegitcommit: 8ebcf6cd36f67f8bcf78e76ae8923d65b8995c8a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/05/2021
ms.locfileid: "111524445"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="e74fb-115">Barra della lingua (servizi di testo)</span><span class="sxs-lookup"><span data-stu-id="e74fb-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="e74fb-116">Implementazione dell'oggetto Language Bar</span><span class="sxs-lookup"><span data-stu-id="e74fb-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="e74fb-117">Per supportare l'aggiunta di un elemento alla barra del linguaggio, un servizio di testo deve implementare un oggetto che supporta [l'interfaccia ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) e uno degli elementi del controllo [ITfLangBarItem.](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem)</span><span class="sxs-lookup"><span data-stu-id="e74fb-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="e74fb-118">Quando l'elemento viene installato, la barra della lingua installa un sink [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) chiamando il metodo [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) dell'elemento con IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="e74fb-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="e74fb-119">L'elemento usa **l'interfaccia ITfLangBarItemSink** per notificare alla barra della lingua le modifiche, ad esempio quando l'elemento è nascosto, visualizzato, abilitato o disabilitato.</span><span class="sxs-lookup"><span data-stu-id="e74fb-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="e74fb-120">È possibile installare quattro tipi di elementi della barra del linguaggio e ognuna delle interfacce necessarie viene creata da **ITfLangBarItem.**</span><span class="sxs-lookup"><span data-stu-id="e74fb-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="e74fb-121">Di seguito sono riportati i **possibili elementi del controllo ITfLangBarItem.**</span><span class="sxs-lookup"><span data-stu-id="e74fb-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|   <span data-ttu-id="e74fb-122">Elemento</span><span class="sxs-lookup"><span data-stu-id="e74fb-122">Element</span></span>            |    <span data-ttu-id="e74fb-123">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e74fb-123">Description</span></span>                                                                                                                                                                               |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e74fb-124">Pulsante</span><span class="sxs-lookup"><span data-stu-id="e74fb-124">Button</span></span>        | <span data-ttu-id="e74fb-125">Un pulsante della barra della lingua funziona come un pulsante di comando, un interruttore o un menu sulla barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="e74fb-125">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="e74fb-126">L'oggetto deve supportare l'interfaccia ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="e74fb-126">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="e74fb-127">Palloncino</span><span class="sxs-lookup"><span data-stu-id="e74fb-127">Balloon</span></span>       | <span data-ttu-id="e74fb-128">Un fumetto della barra della lingua funziona come una notifica popup sulla barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="e74fb-128">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="e74fb-129">L'oggetto deve supportare l'interfaccia ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="e74fb-129">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="e74fb-130">Bitmap</span><span class="sxs-lookup"><span data-stu-id="e74fb-130">Bitmap</span></span>        | <span data-ttu-id="e74fb-131">Una bitmap della barra della lingua funziona come elemento statico sulla barra della lingua che visualizza una bitmap.</span><span class="sxs-lookup"><span data-stu-id="e74fb-131">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="e74fb-132">L'oggetto deve supportare l'interfaccia ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="e74fb-132">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="e74fb-133">Pulsante Bitmap</span><span class="sxs-lookup"><span data-stu-id="e74fb-133">Bitmap Button</span></span> | <span data-ttu-id="e74fb-134">Un pulsante bitmap della barra della lingua funziona come un elemento pulsante sulla barra della lingua che visualizza testo e bitmap.</span><span class="sxs-lookup"><span data-stu-id="e74fb-134">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="e74fb-135">L'oggetto deve supportare l'interfaccia ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="e74fb-135">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="e74fb-136">Stili dei pulsanti</span><span class="sxs-lookup"><span data-stu-id="e74fb-136">Button Styles</span></span>

<span data-ttu-id="e74fb-137">Un elemento pulsante può funzionare come uno degli elementi seguenti.</span><span class="sxs-lookup"><span data-stu-id="e74fb-137">A button element can function as any of the following.</span></span> <span data-ttu-id="e74fb-138">La funzione dell'elemento pulsante è determinata dai flag impostati nel membro **dwStyle** della struttura [ \_ LANGBARITEMINFO di TF](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) nel [metodo ITfLangBarItem::GetInfo.](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo)</span><span class="sxs-lookup"><span data-stu-id="e74fb-138">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|    <span data-ttu-id="e74fb-139">Elemento</span><span class="sxs-lookup"><span data-stu-id="e74fb-139">Element</span></span>           |    <span data-ttu-id="e74fb-140">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e74fb-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e74fb-141">Pulsante</span><span class="sxs-lookup"><span data-stu-id="e74fb-141">Button</span></span>        | <span data-ttu-id="e74fb-142">Il pulsante funziona come pulsante di comando standard.</span><span class="sxs-lookup"><span data-stu-id="e74fb-142">The button functions as a standard command button.</span></span> <span data-ttu-id="e74fb-143">Questo stile del pulsante è identificato dallo stile TF \_ LBI \_ STYLE \_ BTN \_ BUTTON.</span><span class="sxs-lookup"><span data-stu-id="e74fb-143">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="e74fb-144">ITfLangBarItemButton::OnClick viene chiamato quando si fa clic sull'elemento.</span><span class="sxs-lookup"><span data-stu-id="e74fb-144">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="e74fb-145">ITfLangBarItemButton::InitMenu e ITfLangBarItemButton::OnMenuSelect non vengono usati.</span><span class="sxs-lookup"><span data-stu-id="e74fb-145">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="e74fb-146">Interruttore</span><span class="sxs-lookup"><span data-stu-id="e74fb-146">Toggle Button</span></span> | <span data-ttu-id="e74fb-147">Il pulsante funziona come un controllo Toggle che può mantenere uno stato selezionato, in modo simile a una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="e74fb-147">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="e74fb-148">Questo stile di pulsante è identificato dallo stile TOGGLE TF \_ LBI \_ STYLE \_ BTN. \_</span><span class="sxs-lookup"><span data-stu-id="e74fb-148">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="e74fb-149">ITfLangBarItemButton::OnClick viene chiamato quando si fa clic sull'elemento.</span><span class="sxs-lookup"><span data-stu-id="e74fb-149">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="e74fb-150">ITfLangBarItemButton::InitMenu e ITfLangBarItemButton::OnMenuSelect non vengono usati.</span><span class="sxs-lookup"><span data-stu-id="e74fb-150">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="e74fb-151">Menu</span><span class="sxs-lookup"><span data-stu-id="e74fb-151">Menu</span></span>          | <span data-ttu-id="e74fb-152">Il pulsante funziona come un menu a discesa.</span><span class="sxs-lookup"><span data-stu-id="e74fb-152">The button functions as a drop-down menu.</span></span> <span data-ttu-id="e74fb-153">Questo stile di pulsante è identificato dallo stile TF \_ LBI \_ STYLE \_ BTN \_ MENU.</span><span class="sxs-lookup"><span data-stu-id="e74fb-153">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="e74fb-154">ITfLangBarItemButton::InitMenu viene chiamato quando si fa clic sul pulsante.</span><span class="sxs-lookup"><span data-stu-id="e74fb-154">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="e74fb-155">Quando l'utente seleziona una voce nel menu, la barra della lingua chiama ITfLangBarItemButton::OnMenuSelect con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="e74fb-155">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="e74fb-156">ITfLangBarItemButton::OnClickis non viene usato.</span><span class="sxs-lookup"><span data-stu-id="e74fb-156">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="e74fb-157">Implementazione di un pulsante di menu</span><span class="sxs-lookup"><span data-stu-id="e74fb-157">Implementing a Menu Button</span></span>

<span data-ttu-id="e74fb-158">Quando l'utente fa clic su un pulsante di menu, la barra della lingua chiama [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="e74fb-158">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="e74fb-159">L'elemento aggiunge elementi al menu usando [l'interfaccia ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passata a InitMenu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-159">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="e74fb-160">Per aggiungere un sottomenu al menu, chiamare [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) con TF \_ LBMENUF \_ SUBMENU.</span><span class="sxs-lookup"><span data-stu-id="e74fb-160">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="e74fb-161">Al termine, viene restituito un nuovo oggetto **ITfMenu** che rappresenta il sottomenu nel parametro *ppMenu* di AddMenuItem.</span><span class="sxs-lookup"><span data-stu-id="e74fb-161">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="e74fb-162">Questo nuovo oggetto menu viene usato per aggiungere voci al sottomenu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-162">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="e74fb-163">Quando l'utente seleziona una voce nel menu, la barra della lingua chiama [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="e74fb-163">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="e74fb-164">Aggiunta di elementi alla barra della lingua</span><span class="sxs-lookup"><span data-stu-id="e74fb-164">Adding Items to the Language Bar</span></span>

<span data-ttu-id="e74fb-165">Un servizio di testo deve aggiungere gli elementi alla barra della lingua quando viene chiamato il relativo metodo [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) e rimuoverli quando viene chiamato il relativo [metodo ITfTextInputProcessor::D eactivate.](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate)</span><span class="sxs-lookup"><span data-stu-id="e74fb-165">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="e74fb-166">Per aggiungere un elemento alla barra della lingua, il servizio di testo ottiene [un'interfaccia ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) chiamando ITfThreadMgr::QueryInterface con IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="e74fb-166">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="e74fb-167">Il servizio di testo chiama quindi [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) con il puntatore all'oggetto elemento della barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="e74fb-167">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="e74fb-168">Il servizio di testo deve rimuovere l'elemento quando è disattivato.</span><span class="sxs-lookup"><span data-stu-id="e74fb-168">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="e74fb-169">Il servizio di testo usa la stessa **interfaccia ITfLangBarItemMgr** usata per aggiungere gli elementi o ottiene un'altra istanza dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="e74fb-169">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="e74fb-170">Il servizio di testo chiama quindi [ITfLangBarItemMgr::RemoveItem con](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) il puntatore a interfaccia dell'elemento da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="e74fb-170">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="e74fb-171">Estensione degli elementi della barra della lingua di sistema</span><span class="sxs-lookup"><span data-stu-id="e74fb-171">Extending System Language Bar Items</span></span>

<span data-ttu-id="e74fb-172">TSF offre la possibilità di aggiungere voci di menu ai menu della barra della lingua esistenti.</span><span class="sxs-lookup"><span data-stu-id="e74fb-172">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="e74fb-173">In questo modo un servizio di testo può aggiungere voci al menu di un altro servizio di testo senza dover aggiungere un pulsante separato alla barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="e74fb-173">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="e74fb-174">Ciò consente anche di organizzare le voci di menu in gruppi logici.</span><span class="sxs-lookup"><span data-stu-id="e74fb-174">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="e74fb-175">Ad esempio, un servizio di testo che fornisce funzionalità aggiuntive al servizio di riconoscimento vocale standard può aggiungere elementi al menu del servizio di testo vocale invece di aggiungere il proprio pulsante di menu di primo livello.</span><span class="sxs-lookup"><span data-stu-id="e74fb-175">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="e74fb-176">Un servizio di testo fornisce un'estensione del menu della barra del linguaggio implementando un oggetto che supporta [l'interfaccia ITfSystemLangBarItemSink.](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink)</span><span class="sxs-lookup"><span data-stu-id="e74fb-176">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="e74fb-177">Questa interfaccia funziona esattamente come [l'interfaccia ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) per un pulsante di menu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-177">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="e74fb-178">Quando viene visualizzato il menu, il servizio di testo esteso chiama [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="e74fb-178">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="e74fb-179">L'estensione aggiunge elementi al menu usando [l'interfaccia ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passata **a InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="e74fb-179">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="e74fb-180">Quando l'utente seleziona un elemento aggiunto dall'estensione, il servizio di testo esteso chiama [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="e74fb-180">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="e74fb-181">Per installare un'estensione del menu della barra della lingua, il servizio di testo completa i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="e74fb-181">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="e74fb-182">Ottenere **l'interfaccia ITfLangBarItem** per l'elemento da estendere chiamando [ITfLangBarItemMgr::GetItem con](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) il **GUID** per l'elemento da estendere.</span><span class="sxs-lookup"><span data-stu-id="e74fb-182">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="e74fb-183">Ottenere **l'interfaccia ITfSource** per l'elemento da estendere chiamando ITfLangBarItem::QueryInterface con IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="e74fb-183">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="e74fb-184">Chiamare [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfSystemLangBarItemSink e il puntatore **all'oggetto ITfSystemLangBarItemSink.**</span><span class="sxs-lookup"><span data-stu-id="e74fb-184">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="e74fb-185">Se ITfSource::AdviseSink ha esito negativo, il servizio di testo non supporta le estensioni di menu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-185">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="e74fb-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="e74fb-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="e74fb-187">Supporto delle estensioni di menu della barra del linguaggio</span><span class="sxs-lookup"><span data-stu-id="e74fb-187">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="e74fb-188">Un servizio di testo può consentire ad altri servizi di testo di aggiungere elementi ai menu della barra della lingua, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="e74fb-188">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="e74fb-189">Servizio di testo che deve pubblicare il RELATIVO GUID in modo che l'elemento possa essere ottenuto chiamando [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="e74fb-189">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="e74fb-190">Per supportare le estensioni di menu, il servizio di testo deve supportare [l'interfaccia ITfSource.](/windows/desktop/api/msctf/nn-msctf-itfsource)</span><span class="sxs-lookup"><span data-stu-id="e74fb-190">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="e74fb-191">La procedura seguente abilita il supporto per una o più estensioni di menu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-191">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="e74fb-192">Quando viene chiamato [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID ITfSystemLangBarItemSink, il servizio di testo deve archiviare \_ **l'interfaccia ITfSystemLangBarItemSink** e restituire un valore di cookie che identificherà l'estensione.</span><span class="sxs-lookup"><span data-stu-id="e74fb-192">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="e74fb-193">Quando [viene chiamato ITfLangBarItemButton::InitMenu,](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) il servizio di testo chiama il metodo [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="e74fb-193">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="e74fb-194">Il servizio di testo deve implementare un modo per identificare le voci di menu aggiunte dall'estensione anziché le voci aggiunte dal servizio di testo stesso.</span><span class="sxs-lookup"><span data-stu-id="e74fb-194">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="e74fb-195">Quando [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) viene chiamato con un identificatore di voce di menu appartenente a un'estensione, il servizio di testo chiama il metodo **ITfSystemLangBarItemSink::OnMenuSelect** delle estensioni.</span><span class="sxs-lookup"><span data-stu-id="e74fb-195">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="e74fb-196">Quando [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) viene chiamato con il cookie appropriato, il servizio di testo rimuove l'estensione di menu.</span><span class="sxs-lookup"><span data-stu-id="e74fb-196">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e74fb-197">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="e74fb-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e74fb-198">Come configurare le Framework servizi di testo</span><span class="sxs-lookup"><span data-stu-id="e74fb-198">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="e74fb-199">Barra della lingua (applicazioni)</span><span class="sxs-lookup"><span data-stu-id="e74fb-199">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
