---
title: Barra della lingua (servizi di testo)
description: Barra della lingua
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Framework servizi di testo (TSF), barra della lingua
- TSF (Framework dei servizi di testo), barra della lingua
- Servizi di testo, barra della lingua
- barra della lingua
- Framework servizi di testo (TSF), pulsanti
- TSF (Framework di servizi di testo), pulsanti
- Servizi di testo, pulsanti
- Framework servizi di testo (TSF), menu
- TSF (Framework di servizi di testo), menu
- Servizi di testo, menu
- stili pulsante
- pulsanti di menu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c41d64a488406f6eefcff5fef6c11093af00bc5b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "104400171"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="33d3d-115">Barra della lingua (servizi di testo)</span><span class="sxs-lookup"><span data-stu-id="33d3d-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="33d3d-116">Implementazione dell'oggetto barra della lingua</span><span class="sxs-lookup"><span data-stu-id="33d3d-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="33d3d-117">Per supportare l'aggiunta di un elemento alla barra della lingua, un servizio di testo deve implementare un oggetto che supporta l'interfaccia [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) e uno degli elementi di controllo [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="33d3d-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="33d3d-118">Quando l'elemento viene installato, la barra della lingua installa un sink [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) chiamando l'elemento [ITfSource:: adviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="33d3d-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="33d3d-119">L'elemento utilizza l'interfaccia **ITfLangBarItemSink** per notificare alla barra della lingua le modifiche, ad esempio quando l'elemento è nascosto, visualizzato, abilitato o disabilitato.</span><span class="sxs-lookup"><span data-stu-id="33d3d-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="33d3d-120">È possibile installare quattro tipi di elementi della barra della lingua e ognuna delle interfacce richieste viene creata da **ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="33d3d-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="33d3d-121">Di seguito sono riportati i possibili elementi di controllo **ITfLangBarItem** .</span><span class="sxs-lookup"><span data-stu-id="33d3d-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|               |                                                                                                                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="33d3d-122">Pulsante</span><span class="sxs-lookup"><span data-stu-id="33d3d-122">Button</span></span>        | <span data-ttu-id="33d3d-123">Un pulsante della barra della lingua funziona come un pulsante di comando, un controllo o un menu sulla barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="33d3d-123">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="33d3d-124">L'oggetto deve supportare l'interfaccia ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="33d3d-124">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="33d3d-125">Palloncino</span><span class="sxs-lookup"><span data-stu-id="33d3d-125">Balloon</span></span>       | <span data-ttu-id="33d3d-126">Un fumetto della barra della lingua funge da notifica popup sulla barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="33d3d-126">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="33d3d-127">L'oggetto deve supportare l'interfaccia ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="33d3d-127">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="33d3d-128">Bitmap</span><span class="sxs-lookup"><span data-stu-id="33d3d-128">Bitmap</span></span>        | <span data-ttu-id="33d3d-129">Una bitmap della barra della lingua funziona come elemento statico sulla barra della lingua che visualizza una bitmap.</span><span class="sxs-lookup"><span data-stu-id="33d3d-129">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="33d3d-130">L'oggetto deve supportare l'interfaccia ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="33d3d-130">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="33d3d-131">Pulsante bitmap</span><span class="sxs-lookup"><span data-stu-id="33d3d-131">Bitmap Button</span></span> | <span data-ttu-id="33d3d-132">Un pulsante bitmap della barra del linguaggio funziona come un elemento Button sulla barra della lingua che visualizza testo e una bitmap.</span><span class="sxs-lookup"><span data-stu-id="33d3d-132">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="33d3d-133">L'oggetto deve supportare l'interfaccia ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="33d3d-133">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="33d3d-134">Stili dei pulsanti</span><span class="sxs-lookup"><span data-stu-id="33d3d-134">Button Styles</span></span>

<span data-ttu-id="33d3d-135">Un elemento Button può funzionare come uno dei seguenti.</span><span class="sxs-lookup"><span data-stu-id="33d3d-135">A button element can function as any of the following.</span></span> <span data-ttu-id="33d3d-136">La funzione dell'elemento del pulsante è determinata dai flag impostati nel membro **dwStyle** della struttura [tf \_ LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) nel metodo [ITfLangBarItem:: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="33d3d-136">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|               |                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="33d3d-137">Pulsante</span><span class="sxs-lookup"><span data-stu-id="33d3d-137">Button</span></span>        | <span data-ttu-id="33d3d-138">Il pulsante funziona come un pulsante di comando standard.</span><span class="sxs-lookup"><span data-stu-id="33d3d-138">The button functions as a standard command button.</span></span> <span data-ttu-id="33d3d-139">Questo stile di pulsante è identificato dallo stile del pulsante BTN di TF \_ LBI \_ Style \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="33d3d-139">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="33d3d-140">ITfLangBarItemButton:: OnClick viene chiamato quando si fa clic sull'elemento.</span><span class="sxs-lookup"><span data-stu-id="33d3d-140">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="33d3d-141">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect non vengono usati.</span><span class="sxs-lookup"><span data-stu-id="33d3d-141">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="33d3d-142">Interruttore</span><span class="sxs-lookup"><span data-stu-id="33d3d-142">Toggle Button</span></span> | <span data-ttu-id="33d3d-143">Il pulsante funziona come un controllo interruttore in grado di gestire uno stato selezionato, in modo analogo a una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="33d3d-143">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="33d3d-144">Questo stile di pulsante è identificato dallo \_ stile di \_ \_ \_ attivazione/disimpostazione BTN di LBI Style.</span><span class="sxs-lookup"><span data-stu-id="33d3d-144">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="33d3d-145">ITfLangBarItemButton:: OnClick viene chiamato quando si fa clic sull'elemento.</span><span class="sxs-lookup"><span data-stu-id="33d3d-145">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="33d3d-146">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect non vengono usati.</span><span class="sxs-lookup"><span data-stu-id="33d3d-146">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="33d3d-147">Menu</span><span class="sxs-lookup"><span data-stu-id="33d3d-147">Menu</span></span>          | <span data-ttu-id="33d3d-148">Il pulsante funziona come menu a discesa.</span><span class="sxs-lookup"><span data-stu-id="33d3d-148">The button functions as a drop-down menu.</span></span> <span data-ttu-id="33d3d-149">Questo stile di pulsante è identificato dallo \_ stile del \_ menu BTN di LBI di tipo TF \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="33d3d-149">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="33d3d-150">ITfLangBarItemButton:: InitMenu viene chiamato quando si fa clic sul pulsante.</span><span class="sxs-lookup"><span data-stu-id="33d3d-150">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="33d3d-151">Quando l'utente seleziona un elemento nel menu, la barra della lingua chiama ITfLangBarItemButton:: OnMenuSelect con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="33d3d-151">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="33d3d-152">ITfLangBarItemButton:: OnClick non utilizzato.</span><span class="sxs-lookup"><span data-stu-id="33d3d-152">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="33d3d-153">Implementazione di un pulsante di menu</span><span class="sxs-lookup"><span data-stu-id="33d3d-153">Implementing a Menu Button</span></span>

<span data-ttu-id="33d3d-154">Quando l'utente fa clic su un pulsante di menu, la barra della lingua chiama [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="33d3d-154">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="33d3d-155">L'elemento aggiunge elementi al menu usando l'interfaccia [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passata a InitMenu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-155">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="33d3d-156">Per aggiungere un sottomenu al menu, chiamare [ITfMenu:: AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) con il \_ sottomenu TF LBMENUF \_ .</span><span class="sxs-lookup"><span data-stu-id="33d3d-156">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="33d3d-157">Al termine, viene restituito un nuovo oggetto **ITfMenu** che rappresenta il sottomenu nel parametro *ppMenu* di AddMenuItem.</span><span class="sxs-lookup"><span data-stu-id="33d3d-157">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="33d3d-158">Questo nuovo oggetto menu viene usato per aggiungere elementi al sottomenu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-158">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="33d3d-159">Quando l'utente seleziona un elemento nel menu, la barra della lingua chiama [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="33d3d-159">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="33d3d-160">Aggiunta di elementi alla barra della lingua</span><span class="sxs-lookup"><span data-stu-id="33d3d-160">Adding Items to the Language Bar</span></span>

<span data-ttu-id="33d3d-161">Un servizio di testo deve aggiungere i relativi elementi alla barra della lingua quando viene chiamato il metodo [ITfTextInputProcessor:: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) e rimuoverli quando viene chiamato il relativo [ITfTextInputProcessor::D ttiva](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) .</span><span class="sxs-lookup"><span data-stu-id="33d3d-161">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="33d3d-162">Per aggiungere un elemento alla barra della lingua, il servizio di testo ottiene un'interfaccia [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) chiamando ITfThreadMgr:: QUERYINTERFACE con IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="33d3d-162">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="33d3d-163">Il servizio di testo chiama quindi [ITfLangBarItemMgr:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) con il puntatore all'oggetto elemento della barra della lingua.</span><span class="sxs-lookup"><span data-stu-id="33d3d-163">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="33d3d-164">Il servizio di testo deve rimuovere l'elemento quando è disattivato.</span><span class="sxs-lookup"><span data-stu-id="33d3d-164">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="33d3d-165">Il servizio di testo utilizza la stessa interfaccia **ITfLangBarItemMgr** utilizzata per aggiungere gli elementi o ottenere un'altra istanza dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="33d3d-165">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="33d3d-166">Il servizio di testo chiama quindi [ITfLangBarItemMgr:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) con il puntatore di interfaccia dell'elemento da rimuovere.</span><span class="sxs-lookup"><span data-stu-id="33d3d-166">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="33d3d-167">Estensione degli elementi della barra della lingua di sistema</span><span class="sxs-lookup"><span data-stu-id="33d3d-167">Extending System Language Bar Items</span></span>

<span data-ttu-id="33d3d-168">TSF offre la possibilità di aggiungere voci di menu ai menu della barra delle lingue esistente.</span><span class="sxs-lookup"><span data-stu-id="33d3d-168">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="33d3d-169">Questo consente a un servizio di testo di aggiungere elementi al menu di un altro servizio di testo senza dover aggiungere un pulsante separato alla barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="33d3d-169">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="33d3d-170">Consente inoltre di organizzare le voci di menu in gruppi logici.</span><span class="sxs-lookup"><span data-stu-id="33d3d-170">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="33d3d-171">Ad esempio, un servizio di testo che fornisce funzionalità aggiuntive al servizio testo vocale standard può aggiungere elementi al menu del servizio testo vocale anziché aggiungere il proprio pulsante di menu di primo livello.</span><span class="sxs-lookup"><span data-stu-id="33d3d-171">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="33d3d-172">Un servizio di testo fornisce un'estensione del menu della barra delle lingue implementando un oggetto che supporta l'interfaccia [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="33d3d-172">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="33d3d-173">Questa interfaccia funziona esattamente come l'interfaccia [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) per un pulsante di menu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-173">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="33d3d-174">Quando viene visualizzato il menu, il servizio di testo esteso chiama [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="33d3d-174">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="33d3d-175">L'estensione aggiunge elementi al menu usando l'interfaccia [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passata a **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="33d3d-175">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="33d3d-176">Quando l'utente seleziona un elemento aggiunto dall'estensione, il servizio di testo esteso chiama [ITfSystemLangBarItemSink:: OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) con l'identificatore della voce di menu selezionata.</span><span class="sxs-lookup"><span data-stu-id="33d3d-176">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="33d3d-177">Per installare un'estensione del menu della barra delle lingue, il servizio di testo completa i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="33d3d-177">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="33d3d-178">Ottenere l'interfaccia **ITfLangBarItem** per l'elemento da estendere chiamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) con il **GUID** per l'elemento da estendere.</span><span class="sxs-lookup"><span data-stu-id="33d3d-178">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="33d3d-179">Ottenere l'interfaccia **ITfSource** per l'elemento da estendere chiamando ITfLangBarItem:: QUERYINTERFACE con IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="33d3d-179">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="33d3d-180">Chiamare [ITfSource:: adviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfSystemLangBarItemSink e il puntatore all'oggetto **ITfSystemLangBarItemSink** .</span><span class="sxs-lookup"><span data-stu-id="33d3d-180">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="33d3d-181">Se ITfSource:: AdviseSink ha esito negativo, il servizio di testo non supporta le estensioni di menu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-181">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="33d3d-182">[ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource:: adviseSink**</span><span class="sxs-lookup"><span data-stu-id="33d3d-182">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="33d3d-183">Supporto delle estensioni del menu della barra Lingue</span><span class="sxs-lookup"><span data-stu-id="33d3d-183">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="33d3d-184">Un servizio di testo può consentire ad altri servizi di testo di aggiungere elementi ai menu della barra della lingua, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="33d3d-184">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="33d3d-185">Il servizio di testo che deve pubblicare il GUID in modo che l'elemento possa essere ottenuto chiamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="33d3d-185">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="33d3d-186">Per supportare le estensioni di menu, il servizio di testo deve supportare l'interfaccia [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="33d3d-186">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="33d3d-187">La procedura seguente consente di abilitare il supporto per una o più estensioni di menu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-187">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="33d3d-188">Quando viene chiamato [ITfSource:: adviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfSystemLangBarItemSink, il servizio di testo deve archiviare l'interfaccia **ITfSystemLangBarItemSink** e restituire un valore del cookie che identificherà l'estensione.</span><span class="sxs-lookup"><span data-stu-id="33d3d-188">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="33d3d-189">Quando viene chiamato [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) , il servizio di testo chiama il metodo [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="33d3d-189">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="33d3d-190">Il servizio di testo deve implementare un modo per identificare le voci di menu aggiunte dall'estensione anziché gli elementi aggiunti dal servizio di testo stesso.</span><span class="sxs-lookup"><span data-stu-id="33d3d-190">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="33d3d-191">Quando [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) viene chiamato con un identificatore di voce di menu che appartiene a un'estensione, il servizio di testo chiama il metodo **ITfSystemLangBarItemSink:: OnMenuSelect** delle estensioni.</span><span class="sxs-lookup"><span data-stu-id="33d3d-191">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="33d3d-192">Quando [ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) viene chiamato con il cookie appropriato, il servizio di testo rimuove l'estensione di menu.</span><span class="sxs-lookup"><span data-stu-id="33d3d-192">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="33d3d-193">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="33d3d-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="33d3d-194">Come configurare il Framework dei servizi di testo</span><span class="sxs-lookup"><span data-stu-id="33d3d-194">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="33d3d-195">Barra della lingua (applicazioni)</span><span class="sxs-lookup"><span data-stu-id="33d3d-195">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
