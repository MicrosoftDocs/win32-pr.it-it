---
title: Oggetti incorporati (Framework di servizi di testo)
description: Il Framework di servizi di testo consente a un servizio di testo di incorporare oggetti in un flusso di testo dell'applicazione.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- Framework servizi di testo (TSF), oggetti incorporati
- TSF (Framework di servizi di testo), oggetti incorporati
- Applicazioni abilitate per TSF, oggetti incorporati
- oggetti incorporati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39e4f819e6f42cc4e8d2ed81e47c79efe5ff7407
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "104555997"
---
# <a name="embedded-objects-text-services-framework"></a><span data-ttu-id="6fab2-107">Oggetti incorporati (Framework di servizi di testo)</span><span class="sxs-lookup"><span data-stu-id="6fab2-107">Embedded Objects (Text Services Framework)</span></span>

<span data-ttu-id="6fab2-108">Il Framework di servizi di testo consente a un servizio di testo di incorporare oggetti in un flusso di testo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6fab2-108">Text Services Framework enables a text service to embed objects in an application text stream.</span></span> <span data-ttu-id="6fab2-109">Gli oggetti incorporati vengono inseriti nel flusso di testo usando il valore di [TS \_ char \_ Embedded](ts-char--constants.md).</span><span class="sxs-lookup"><span data-stu-id="6fab2-109">Embedded objects are inserted into the text stream using the value [TS\_CHAR\_EMBEDDED](ts-char--constants.md).</span></span> <span data-ttu-id="6fab2-110">Questo valore viene risolto nel carattere di sostituzione dell'oggetto Unicode U + FFFC, usando la notazione esadecimale.</span><span class="sxs-lookup"><span data-stu-id="6fab2-110">This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation.</span></span> <span data-ttu-id="6fab2-111">Nella figura seguente, ad esempio, viene illustrato il rendering di un oggetto incorporato che rappresenta l'esempio *di ideogrammi giapponese*, in combinazione con la sequenza di caratteri Unicode che rappresentano la traduzione in inglese di "Sun".</span><span class="sxs-lookup"><span data-stu-id="6fab2-111">For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph *hi*, in combination with the sequence of Unicode characters that represent the English translation of "Sun."</span></span>

![codifica dei caratteri di un oggetto incorporato](images/emb-obj.gif)

<span data-ttu-id="6fab2-113">La prima riga della figura contiene il testo tradotto, composto dalla parola "Sun" seguito dal carattere giapponese per Sun, *Hi*.</span><span class="sxs-lookup"><span data-stu-id="6fab2-113">The top row of the figure contains the translated text, consisting of the word "Sun" followed by the Japanese character for sun, *hi*.</span></span> <span data-ttu-id="6fab2-114">La riga centrale della figura mostra il carattere Unicode.</span><span class="sxs-lookup"><span data-stu-id="6fab2-114">The center row of the figure shows the Unicode character.</span></span> <span data-ttu-id="6fab2-115">Nel caso di U + FFFC, questo è il carattere di sostituzione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="6fab2-115">In the case of U+fffc, this is the object replacement character.</span></span> <span data-ttu-id="6fab2-116">La riga inferiore della figura mostra il valore esadecimale di ogni carattere.</span><span class="sxs-lookup"><span data-stu-id="6fab2-116">The bottom row of the figure shows the hexadecimal value of each character.</span></span>

## <a name="supporting-embedded-objects-in-an-application"></a><span data-ttu-id="6fab2-117">Supporto di oggetti incorporati in un'applicazione</span><span class="sxs-lookup"><span data-stu-id="6fab2-117">Supporting Embedded Objects in an Application</span></span>

<span data-ttu-id="6fab2-118">Gestione TSF inserisce un oggetto incorporato nel flusso di testo chiamando [ITextStoreACP:: InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) per un'applicazione basata su ACP o [ITextStoreAnchor:: InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) per un'applicazione basata su ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="6fab2-118">The TSF manager inserts an embedded object into the text stream by calling [ITextStoreACP::InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) for an ACP-based application, or [ITextStoreAnchor::InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) for an anchor-based application.</span></span> <span data-ttu-id="6fab2-119">Quando si inserisce un oggetto incorporato, l'applicazione deve inserire il **valore \_ \_ incorporato char di Servizi terminal** nella posizione del carattere (o nella posizione di ancoraggio) in cui l'oggetto è incorporato e archiviare il IDataObject associato all'oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="6fab2-119">When an embedded object is inserted, the application should place the **TS\_CHAR\_EMBEDDED** value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object.</span></span> <span data-ttu-id="6fab2-120">Quando viene chiamato [ITextStoreACP:: GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) o [ITextStoreAnchor:: GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) e un oggetto incorporato è contenuto all'interno del testo ottenuto, il valore **\_ \_ incorporato di TS char** indica la presenza e la posizione dell'oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="6fab2-120">When [ITextStoreACP::GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) or [ITextStoreAnchor::GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) is called and an embedded object is contained within the text obtained, the **TS\_CHAR\_EMBEDDED** value indicates the presence and location of the embedded object.</span></span> <span data-ttu-id="6fab2-121">Per ottenere l'oggetto incorporato, chiamare [ITextStoreACP:: Getembedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) con la posizione del carattere dell'oggetto incorporato oppure [ITextStoreAnchor:: getembedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) con la posizione di ancoraggio dell'oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="6fab2-121">To obtain the embedded object, call [ITextStoreACP::GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) with the character position of the embedded object, or [ITextStoreAnchor::GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) with the anchor location of the embedded object.</span></span>

<span data-ttu-id="6fab2-122">L'applicazione in genere non riconosce il contenuto dell'oggetto incorporato.</span><span class="sxs-lookup"><span data-stu-id="6fab2-122">The application does not normally recognize the embedded object contents.</span></span> <span data-ttu-id="6fab2-123">L'applicazione può tentare di ottenere informazioni di visualizzazione dall'oggetto stesso.</span><span class="sxs-lookup"><span data-stu-id="6fab2-123">The application can attempt to obtain display information from the object itself.</span></span> <span data-ttu-id="6fab2-124">Se l'oggetto incorporato è in grado di fornire dati in un formato riconosciuto dall'applicazione, ad esempio CF \_ UNICODETEXT o la \_ bitmap CF, l'applicazione può visualizzare le informazioni grafiche fornite dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="6fab2-124">If the embedded object can supply data in a format that the application recognizes, such as CF\_UNICODETEXT or CF\_BITMAP, the application can display graphic information supplied by the object.</span></span>

## <a name="inserting-embedded-objects"></a><span data-ttu-id="6fab2-125">Inserimento di oggetti incorporati</span><span class="sxs-lookup"><span data-stu-id="6fab2-125">Inserting Embedded Objects</span></span>

<span data-ttu-id="6fab2-126">Un servizio di testo inserisce un oggetto incorporato in un contesto chiamando [ITfRange:: InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) o [ITfInsertAtSelection:: InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span><span class="sxs-lookup"><span data-stu-id="6fab2-126">A text service inserts an embedded object into a context by calling [ITfRange::InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) or [ITfInsertAtSelection::InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span></span> <span data-ttu-id="6fab2-127">Il servizio di testo deve fornire il IDataObject incorporato.</span><span class="sxs-lookup"><span data-stu-id="6fab2-127">The text service must supply the embedded IDataObject.</span></span>

 

 
