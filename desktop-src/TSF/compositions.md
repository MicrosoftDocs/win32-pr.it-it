---
title: Composizioni
description: Una composizione è uno stato di input temporaneo che consente a un servizio di testo di specificare sia per l'applicazione sia per l'utente che il testo di input è ancora in uno stato di modifica.
ms.assetid: 3d9da4f2-ceb9-4abc-8979-d3756d948a57
keywords:
- Framework servizi di testo (TSF), composizioni
- TSF (Framework di servizi di testo), composizioni
- Servizi di testo, composizioni
- Applicazioni abilitate per TSF, composizioni
- compositions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0b03f3e991f76ee7c6dca3830267796576c7b842
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399499"
---
# <a name="compositions"></a><span data-ttu-id="b68a5-108">Composizioni</span><span class="sxs-lookup"><span data-stu-id="b68a5-108">Compositions</span></span>

<span data-ttu-id="b68a5-109">Una composizione è uno stato di input temporaneo che consente a un servizio di testo di specificare sia per l'applicazione sia per l'utente che il testo di input è ancora in uno stato di modifica.</span><span class="sxs-lookup"><span data-stu-id="b68a5-109">A composition is a temporary input state that enables a text service to specify both to the application and the user that the input text is still in a state of change.</span></span> <span data-ttu-id="b68a5-110">Un'applicazione può e deve ottenere informazioni sugli attributi di visualizzazione sulla composizione e utilizzare queste informazioni per visualizzare lo stato di composizione all'utente.</span><span class="sxs-lookup"><span data-stu-id="b68a5-110">An application can and should obtain display attribute information about the composition and use this information to display the composition state to the user.</span></span>

<span data-ttu-id="b68a5-111">Un esempio di utilizzo di una composizione è durante l'input vocale.</span><span class="sxs-lookup"><span data-stu-id="b68a5-111">One example of the use of a composition is during speech input.</span></span> <span data-ttu-id="b68a5-112">Mentre l'utente sta parlando, il servizio di testo vocale crea una composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-112">While the user is speaking, the speech text service creates a composition.</span></span> <span data-ttu-id="b68a5-113">Questa composizione rimarrà intatta fino al completamento dell'intero input vocale.</span><span class="sxs-lookup"><span data-stu-id="b68a5-113">This composition will remain intact until the entire speech input is complete.</span></span> <span data-ttu-id="b68a5-114">Al termine della sessione, il servizio di testo vocale termina la composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-114">When the session ends, the speech text service terminates the composition.</span></span>

<span data-ttu-id="b68a5-115">Un'applicazione utilizza la presenza e l'assenza di una composizione per determinare la modalità di visualizzazione del testo e il tipo di elaborazione da eseguire sul testo.</span><span class="sxs-lookup"><span data-stu-id="b68a5-115">An application uses the presence and absence of a composition to determine how to display text and what, if any, processing should be performed on the text.</span></span> <span data-ttu-id="b68a5-116">Se, ad esempio, l'utente usa il motore vocale per inserire il testo, l'applicazione non deve eseguire alcun controllo ortografico o grammaticale su qualsiasi testo di composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-116">For example, if the user is using the speech engine to input text, the application should not perform any spelling or grammar checking on any composition text.</span></span> <span data-ttu-id="b68a5-117">Il testo viene considerato incompleto fino a quando non viene terminata la composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-117">The text is considered incomplete until the composition is terminated.</span></span>

## <a name="text-services"></a><span data-ttu-id="b68a5-118">Servizi di testo</span><span class="sxs-lookup"><span data-stu-id="b68a5-118">Text Services</span></span>

<span data-ttu-id="b68a5-119">Un servizio di testo crea una composizione chiamando [ITfContextComposition:: StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span><span class="sxs-lookup"><span data-stu-id="b68a5-119">A text service creates a composition by calling [ITfContextComposition::StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span></span> <span data-ttu-id="b68a5-120">Il servizio di testo può implementare facoltativamente un oggetto [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) che riceve le notifiche degli eventi di composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-120">The text service can optionally implement an [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) object that receives composition event notifications.</span></span> <span data-ttu-id="b68a5-121">StartComposition restituisce un oggetto [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) a cui il servizio di testo mantiene un riferimento e utilizza per modificare e terminare la composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-121">StartComposition returns an [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) object that the text service keeps a reference to and uses to modify and terminate the composition.</span></span> <span data-ttu-id="b68a5-122">Il servizio di testo termina la composizione chiamando [ITfComposition:: EndComposition](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="b68a5-122">The text service terminates the composition by calling [ITfComposition::EndComposition](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="b68a5-123">Se un servizio di testo crea composizioni, deve supportare anche gli attributi di visualizzazione per consentire a un'applicazione di visualizzare il testo che fa parte di una composizione in modo diverso rispetto al testo standard.</span><span class="sxs-lookup"><span data-stu-id="b68a5-123">If a text service is going to create compositions, it should also support display attributes to enable an application to display text that is part of a composition differently than standard text.</span></span> <span data-ttu-id="b68a5-124">Per ulteriori informazioni, vedere [fornire attributi di visualizzazione](providing-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="b68a5-124">For more information, see [Providing Display Attributes](providing-display-attributes.md).</span></span>

## <a name="applications"></a><span data-ttu-id="b68a5-125">Applicazioni</span><span class="sxs-lookup"><span data-stu-id="b68a5-125">Applications</span></span>

<span data-ttu-id="b68a5-126">Un'applicazione può monitorare la creazione, la modifica e la chiusura di composizioni installando un sink [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) .</span><span class="sxs-lookup"><span data-stu-id="b68a5-126">An application can monitor the creation, change and termination of compositions by installing an [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) sink.</span></span> <span data-ttu-id="b68a5-127">Quando viene avviata una composizione, viene chiamato [ITfContextOwnerCompositionSink:: OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) .</span><span class="sxs-lookup"><span data-stu-id="b68a5-127">When a composition is started, [ITfContextOwnerCompositionSink::OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) is called.</span></span> <span data-ttu-id="b68a5-128">Analogamente, quando una composizione viene modificata o terminata, [ITfContextOwnerCompositionSink:: OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) e [ITfContextOwnerCompositionSink:: OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) verranno chiamati rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="b68a5-128">Likewise, when a composition is changed or terminated, [ITfContextOwnerCompositionSink::OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) and [ITfContextOwnerCompositionSink::OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) will be called, respectively.</span></span>

<span data-ttu-id="b68a5-129">Di seguito è riportata una procedura tipica per aggiornare un documento utilizzando una composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-129">The following is a typical procedure to update a document using a composition.</span></span>

1.  <span data-ttu-id="b68a5-130">[ITextStoreACP:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) o [ITextStoreAnchor:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) vengono in genere utilizzati per inserire il testo iniziale nella composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-130">[ITextStoreACP::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) or [ITextStoreAnchor::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) are typically used to insert the initial text into the composition.</span></span>
2.  <span data-ttu-id="b68a5-131">La composizione viene avviata con una chiamata a [ITfContextComposition:: StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), usando l'intervallo di testo restituito da **InsertTextAtSelection**.</span><span class="sxs-lookup"><span data-stu-id="b68a5-131">The composition is started with a call to [ITfContextComposition::StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), using the range of text returned by **InsertTextAtSelection**.</span></span>
3.  <span data-ttu-id="b68a5-132">Quando riceve nuovo input, ad esempio voce vocale o voce da tastiera, l'applicazione aggiorna la composizione con [ITextStoreACP:: SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) o [ITextStoreAnchor:: SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span><span class="sxs-lookup"><span data-stu-id="b68a5-132">When it receives new input such as speech or keyboard entry, the application updates the composition with [ITextStoreACP::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) or [ITextStoreAnchor::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span></span>
4.  <span data-ttu-id="b68a5-133">Quando l'applicazione determina che è il momento di terminare la composizione, viene chiamato [ITfComposition:: EndComposition](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="b68a5-133">When the application determines that it is time to end the composition, it calls [ITfComposition::EndComposition](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="b68a5-134">L'applicazione deve usare gli attributi di visualizzazione forniti dal servizio di testo per modificare la visualizzazione del testo in qualsiasi momento e non solo quando è attiva una composizione.</span><span class="sxs-lookup"><span data-stu-id="b68a5-134">The application should use the display attributes provided by the text service to modify the display of text at all times and not just when a composition is active.</span></span> <span data-ttu-id="b68a5-135">Per ulteriori informazioni, vedere [utilizzo degli attributi di visualizzazione](using-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="b68a5-135">For more information, see [Using Display Attributes](using-display-attributes.md).</span></span>

<span data-ttu-id="b68a5-136">Se necessario, un'applicazione può terminare una composizione chiamando [ITfContextOwnerCompositionServices:: TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span><span class="sxs-lookup"><span data-stu-id="b68a5-136">If necessary, an application can terminate a composition by calling [ITfContextOwnerCompositionServices::TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span></span>

 

 