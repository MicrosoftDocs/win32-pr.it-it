---
title: Registrazione di un dispositivo ospitato con l'host del dispositivo
description: La registrazione di un dispositivo ospitato significa fornire all'host del dispositivo la descrizione del dispositivo e il relativo oggetto controllo dispositivo.
ms.assetid: 1d85b412-9b1b-415d-8664-8d96a6644793
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4a607af4f6ada359a9ee32e98e416d8271fd502
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104221352"
---
# <a name="registering-a-hosted-device-with-the-device-host"></a><span data-ttu-id="a377f-103">Registrazione di un dispositivo ospitato con l'host del dispositivo</span><span class="sxs-lookup"><span data-stu-id="a377f-103">Registering a Hosted Device With the Device Host</span></span>

<span data-ttu-id="a377f-104">La registrazione di un dispositivo ospitato significa fornire all'host del dispositivo la descrizione del dispositivo e il relativo oggetto controllo dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-104">Registering a hosted device means providing the device host with the device description and its device control object.</span></span> <span data-ttu-id="a377f-105">L'host del dispositivo crea quindi una descrizione del dispositivo UPnP completa, la pubblica e annuncia il dispositivo sulla rete usando il protocollo di individuazione UPnP.</span><span class="sxs-lookup"><span data-stu-id="a377f-105">The device host then constructs a complete UPnP device description, publishes it, and announces the device on the network using the UPnP discovery protocol.</span></span> <span data-ttu-id="a377f-106">Una volta pubblicato, un dispositivo è disponibile per i punti di controllo.</span><span class="sxs-lookup"><span data-stu-id="a377f-106">Once a device is published, it is available to control points.</span></span>

<span data-ttu-id="a377f-107">I dispositivi vengono registrati in due modi:</span><span class="sxs-lookup"><span data-stu-id="a377f-107">Devices are registered in two ways:</span></span>

-   <span data-ttu-id="a377f-108">Un'applicazione crea un'istanza dell'oggetto controllo del dispositivo e passa un puntatore all'host del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-108">An application creates an instance of the device control object and passes a pointer to it to the device host.</span></span>
-   <span data-ttu-id="a377f-109">L'applicazione passa il ProgID per un oggetto controllo dispositivo registrato all'host del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-109">The application passes the ProgID for a registered device control object to the device host.</span></span> <span data-ttu-id="a377f-110">L'host del dispositivo ne crea un'istanza quando l'host del dispositivo riceve la prima richiesta per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-110">The device host instantiates it when the device host receives the first request for the device.</span></span>

<span data-ttu-id="a377f-111">Indipendentemente dal metodo usato, l'host del dispositivo pubblica e annuncia il dispositivo non appena viene registrato.</span><span class="sxs-lookup"><span data-stu-id="a377f-111">Regardless of which method is used, the device host publishes and announces the device as soon as it is registered.</span></span> <span data-ttu-id="a377f-112">La differenza tra i due approcci è quella di eseguire il caricamento del codice del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-112">The difference between the two approaches has to do with when the device code is loaded.</span></span> <span data-ttu-id="a377f-113">Quando l'applicazione passa un puntatore all'oggetto controllo del dispositivo, il codice del dispositivo viene caricato e in esecuzione al momento della registrazione.</span><span class="sxs-lookup"><span data-stu-id="a377f-113">When the application passes in a pointer to the device control object, the device code is loaded and running at the time of registration.</span></span> <span data-ttu-id="a377f-114">Quando l'applicazione passa un ProgID, il codice del dispositivo viene caricato solo quando viene richiamata un'azione, viene eseguita una query su una proprietà o viene ricevuta una richiesta di sottoscrizione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="a377f-114">When the application passes a ProgID, the device code is only loaded when an action is invoked, a property is queried, or an event subscription request arrives.</span></span> <span data-ttu-id="a377f-115">Il secondo approccio è leggermente più efficiente.</span><span class="sxs-lookup"><span data-stu-id="a377f-115">The second approach is slightly more efficient.</span></span> <span data-ttu-id="a377f-116">Tuttavia, non è adatto per i dispositivi che devono essere in esecuzione prima che vengano ricevute richieste di controllo o di sottoscrizione di eventi, perché l'uso di questo approccio, gli oggetti di controllo del dispositivo vengono creati solo quando sono necessari.</span><span class="sxs-lookup"><span data-stu-id="a377f-116">However, it is not suitable for devices that must be running before any control or event subscription requests arrive, because using this approach, device control objects are only created when they are needed.</span></span> <span data-ttu-id="a377f-117">Il secondo metodo può inoltre creare problemi di prestazioni quando riceve la prima richiesta per un tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-117">This second method can also create performance issues when it receives the first request for a device type.</span></span>

<span data-ttu-id="a377f-118">Per assicurarsi che un dispositivo venga annunciato automaticamente dall'host del dispositivo sulla rete all'avvio del computer, richiamare [**IUPnPRegistrar:: RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span><span class="sxs-lookup"><span data-stu-id="a377f-118">If you want to ensure that a device is announced by the device host on the network automatically when the computer is started, invoke [**IUPnPRegistrar::RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span></span> <span data-ttu-id="a377f-119">**RegisterDevice** garantisce che il codice del dispositivo venga caricato solo quando viene ricevuta una richiesta di sottoscrizione a un controllo o a un evento.</span><span class="sxs-lookup"><span data-stu-id="a377f-119">**RegisterDevice** ensures that your device code is only loaded when a control or event subscription request is received.</span></span>

<span data-ttu-id="a377f-120">Se i dispositivi sono temporanei o con bridging, richiamare [**IUPnPRegistrar:: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice)e il dispositivo non viene nuovamente annunciato quando il computer viene riavviato.</span><span class="sxs-lookup"><span data-stu-id="a377f-120">If your devices are transient or bridged, invoke [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), and the device is not automatically re-advertised when the computer is restarted.</span></span>

## <a name="discovery-announcement-lifetime"></a><span data-ttu-id="a377f-121">Durata degli annunci di individuazione</span><span class="sxs-lookup"><span data-stu-id="a377f-121">Discovery Announcement Lifetime</span></span>

<span data-ttu-id="a377f-122">Ogni dispositivo registrato con l'host del dispositivo è associato a una durata, specificata dal dispositivo durante la registrazione.</span><span class="sxs-lookup"><span data-stu-id="a377f-122">Each device registered with the device host is associated with a lifetime, which is specified by the device upon registration.</span></span> <span data-ttu-id="a377f-123">La durata del dispositivo è il periodo di tempo per cui gli annunci di individuazione del dispositivo sono validi.</span><span class="sxs-lookup"><span data-stu-id="a377f-123">The lifetime of the device is the period of time for which the device's discovery announcements are valid.</span></span> <span data-ttu-id="a377f-124">La durata viene passata al punto di controllo come intestazione nell'annuncio iniziale di individuazione.</span><span class="sxs-lookup"><span data-stu-id="a377f-124">The lifetime is passed to the control point as a header in the initial discovery announcement.</span></span> <span data-ttu-id="a377f-125">L'host del dispositivo aggiorna automaticamente l'annuncio prima della data di scadenza.</span><span class="sxs-lookup"><span data-stu-id="a377f-125">The device host automatically refreshes the announcement prior to the expiration time.</span></span> <span data-ttu-id="a377f-126">I valori della durata dell'annuncio di individuazione devono essere di 15 minuti o più (il valore predefinito è 30 minuti).</span><span class="sxs-lookup"><span data-stu-id="a377f-126">The values of the discovery announcement lifetime should be 15 minutes or more (the default is 30 minutes).</span></span>

## <a name="device-identifiers-created-at-registration"></a><span data-ttu-id="a377f-127">Identificatori di dispositivo creati alla registrazione</span><span class="sxs-lookup"><span data-stu-id="a377f-127">Device Identifiers Created at Registration</span></span>

<span data-ttu-id="a377f-128">Quando si crea un modello di descrizione del dispositivo, lo sviluppatore del dispositivo deve fornire il percorso della risorsa per la descrizione del servizio e le icone associate.</span><span class="sxs-lookup"><span data-stu-id="a377f-128">When creating a device description template, the device developer must provide the resource path to the service description and associated icons.</span></span> <span data-ttu-id="a377f-129">Il percorso della risorsa è determinato dall'applicazione del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-129">The resource path is determined by the device application.</span></span>

<span data-ttu-id="a377f-130">Poiché lo stesso dispositivo può essere registrato più volte nello stesso computer, il UDN specificato nel modello di descrizione del dispositivo non è sufficiente per identificare in modo univoco un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-130">Since the same device can be registered multiple times on the same computer, the UDN specified in the device description template is not sufficient to uniquely identify a device.</span></span> <span data-ttu-id="a377f-131">Pertanto, quando un dispositivo viene registrato, l'host del dispositivo crea un identificatore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-131">Therefore, when a device is registered, the device host creates a device identifier.</span></span> <span data-ttu-id="a377f-132">Questo identificatore di dispositivo, in associazione a UDN nel modello di descrizione del dispositivo, può essere usato per identificare in modo univoco un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-132">This device identifier, in association with the UDN in the device description template, can be used to uniquely identify a device.</span></span>

<span data-ttu-id="a377f-133">Questo identificatore viene usato anche quando viene temporaneamente annullata la registrazione del dispositivo e quindi la nuova registrazione.</span><span class="sxs-lookup"><span data-stu-id="a377f-133">This identifier is also used when the device is temporarily unregistered and then re-registered.</span></span> <span data-ttu-id="a377f-134">Quando viene annullata la registrazione temporanea di un dispositivo, l'host del dispositivo non elimina il UDN.</span><span class="sxs-lookup"><span data-stu-id="a377f-134">When a device is unregistered temporarily, the device host does not delete the UDN.</span></span> <span data-ttu-id="a377f-135">I motivi per cui non si eliminano i UDN includono:</span><span class="sxs-lookup"><span data-stu-id="a377f-135">Reasons for not deleting the UDN include:</span></span>

-   <span data-ttu-id="a377f-136">È in corso l'aggiornamento del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-136">The device is being upgraded.</span></span>
-   <span data-ttu-id="a377f-137">Si stanno modificando le proprietà del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-137">You are changing the properties of the device.</span></span>
-   <span data-ttu-id="a377f-138">Un servizio è temporaneamente non disponibile.</span><span class="sxs-lookup"><span data-stu-id="a377f-138">A service is temporarily unavailable.</span></span>
-   <span data-ttu-id="a377f-139">Si sta aggiungendo un nuovo servizio a un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="a377f-139">You are adding a new service to a device.</span></span>
-   <span data-ttu-id="a377f-140">Si sta aggiornando la DLL.</span><span class="sxs-lookup"><span data-stu-id="a377f-140">You are updating the DLL.</span></span>
-   <span data-ttu-id="a377f-141">Il dispositivo è in modalità standby.</span><span class="sxs-lookup"><span data-stu-id="a377f-141">The device is in stand-by mode.</span></span>

<span data-ttu-id="a377f-142">Per ulteriori informazioni sulla registrazione, vedere le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a377f-142">Refer to the following sections for further information on registration:</span></span>

-   [<span data-ttu-id="a377f-143">Come registrare un dispositivo con l'host del dispositivo</span><span class="sxs-lookup"><span data-stu-id="a377f-143">How to Register a Device with the Device Host</span></span>](how-to-register-a-device-with-the-device-host.md)
-   [<span data-ttu-id="a377f-144">Annullamento della registrazione di un dispositivo</span><span class="sxs-lookup"><span data-stu-id="a377f-144">Unregistering a Device</span></span>](unregistering-a-device.md)
-   [<span data-ttu-id="a377f-145">**IUPnPRegistrar::UnregisterDevice**</span><span class="sxs-lookup"><span data-stu-id="a377f-145">**IUPnPRegistrar::UnregisterDevice**</span></span>](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-unregisterdevice)
-   [<span data-ttu-id="a377f-146">**IUPnPReregistrar**</span><span class="sxs-lookup"><span data-stu-id="a377f-146">**IUPnPReregistrar**</span></span>](/windows/desktop/api/Upnphost/nn-upnphost-iupnpreregistrar)

 

 




