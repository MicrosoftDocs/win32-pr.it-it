---
description: L'infrastruttura peer utilizza gli eventi per notificare alle applicazioni le modifiche apportate all'interno di una rete peer, ad esempio un nodo che viene aggiunto o rimosso da un grafo.
ms.assetid: a056da1c-b8f9-4dad-8df9-df24c6b359b7
title: Infrastruttura di eventi peer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6347ad6a7dd0cf2fae4a0aa623bfda48ab0aa9f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106312244"
---
# <a name="peer-events-infrastructure"></a><span data-ttu-id="d31e9-103">Infrastruttura di eventi peer</span><span class="sxs-lookup"><span data-stu-id="d31e9-103">Peer Events Infrastructure</span></span>

<span data-ttu-id="d31e9-104">L'infrastruttura peer utilizza gli eventi per notificare alle applicazioni le modifiche apportate all'interno di una rete peer, ad esempio un nodo che viene aggiunto o rimosso da un grafo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-104">The Peer Infrastructure uses events to notify applications of changes that have occurred within a peer network, for example, a node that is added or removed from a graph.</span></span> <span data-ttu-id="d31e9-105">Le infrastrutture di peering e di raggruppamento dei peer utilizzano l'infrastruttura degli eventi peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-105">The Peer Graphing and Peer Grouping Infrastructures use the peer events infrastructure.</span></span>

## <a name="receiving-peer-event-notification"></a><span data-ttu-id="d31e9-106">Ricezione della notifica degli eventi peer</span><span class="sxs-lookup"><span data-stu-id="d31e9-106">Receiving Peer Event Notification</span></span>

<span data-ttu-id="d31e9-107">Un peer può registrarsi per ricevere una notifica quando viene modificato un attributo di un grafico o di un gruppo oppure si verifica un evento peer specifico.</span><span class="sxs-lookup"><span data-stu-id="d31e9-107">A peer can register to receive notification when an attribute of a graph or group changes, or a specific peer event occurs.</span></span> <span data-ttu-id="d31e9-108">Un'applicazione peer chiama la funzione [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) o [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) e passa un handle di evento all'infrastruttura peer, creata in precedenza da una chiamata a [**CreateEvent**](graphing-reference-links.md).</span><span class="sxs-lookup"><span data-stu-id="d31e9-108">A peer application calls the [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) or [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) function, and passes an event handle to the Peer Infrastructure, which is created previously by a call to [**CreateEvent**](graphing-reference-links.md).</span></span> <span data-ttu-id="d31e9-109">L'infrastruttura peer utilizza l'handle per segnalare a un'applicazione che si è verificato un evento peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-109">The Peer Infrastructure uses the handle to signal an application that a peer event has occurred.</span></span>

<span data-ttu-id="d31e9-110">L'applicazione passa inoltre una serie di strutture di registrazione eventi del [**\_ grafo \_ \_ peer**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) o di un [**\_ gruppo peer \_ \_**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) che indicano all'infrastruttura peer gli eventi peer specifici per cui l'applicazione richiede la notifica.</span><span class="sxs-lookup"><span data-stu-id="d31e9-110">The application also passes a series of [**PEER\_GRAPH\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) or [**PEER\_GROUP\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) structures that indicate to the Peer Infrastructure the specific peer events for which the application is requesting notification.</span></span> <span data-ttu-id="d31e9-111">L'applicazione deve inoltre specificare esattamente il numero di strutture da passare.</span><span class="sxs-lookup"><span data-stu-id="d31e9-111">The application must also specify exactly how many structures are being passed.</span></span>

## <a name="peer-graphing-events"></a><span data-ttu-id="d31e9-112">Eventi di grafica peer</span><span class="sxs-lookup"><span data-stu-id="d31e9-112">Peer Graphing Events</span></span>

<span data-ttu-id="d31e9-113">Un'applicazione di Graphing peer può eseguire la registrazione per ricevere la notifica per 9 eventi del grafo peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-113">A Peer Graphing application can register to receive notification for 9 peer graph events.</span></span> <span data-ttu-id="d31e9-114">Ogni nome di evento è preceduto da **un \_ \_ evento \_ del grafo del peer**, ad esempio **lo stato del grafo del peer è \_ \_ stato \_ modificato**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-114">Each event name is prefaced with **PEER\_GRAPH\_EVENT\_**, for example, **PEER\_GRAPH\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="d31e9-115">Se non specificato diversamente, le informazioni su una modifica vengono recuperate tramite [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="d31e9-115">Unless otherwise noted, information about a change is retrieved by using [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span></span>

-   <span data-ttu-id="d31e9-116">**Peer \_ \_Lo stato dell'evento Graph \_ \_ modificato** indica che lo stato di un grafico è stato modificato, ad esempio un nodo è stato sincronizzato con un grafo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-116">**PEER\_GRAPH\_EVENT\_STATUS\_CHANGED** indicates that the status of a graph is changed, for example, a node has synchronized with a graph.</span></span>
-   <span data-ttu-id="d31e9-117">**Peer \_ La \_ Proprietà evento Graph \_ \_ modificata** indica che una proprietà di un grafico o un gruppo è stata modificata, ad esempio, il nome descrittivo di un grafico è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-117">**PEER\_GRAPH\_EVENT\_PROPERTY\_CHANGED** indicates that a property of a graph or group is changed, for example, the friendly name of a graph has changed.</span></span>
    > [!Note]  
    > <span data-ttu-id="d31e9-118">Per ottenere le informazioni modificate, l'applicazione deve chiamare [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) .</span><span class="sxs-lookup"><span data-stu-id="d31e9-118">The application must call [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) to obtain the changed information.</span></span>

     

-   <span data-ttu-id="d31e9-119">**Peer \_ Il \_ record dell'evento Graph \_ \_ modificato** indica che un record è stato modificato. ad esempio, un record viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-119">**PEER\_GRAPH\_EVENT\_RECORD\_CHANGED** indicates that a record is changed, for example, a record is deleted.</span></span>
-   <span data-ttu-id="d31e9-120">**Peer \_ La \_ \_ \_ connessione diretta agli eventi Graph** indica che è stata modificata una connessione diretta, ad esempio un nodo è connesso.</span><span class="sxs-lookup"><span data-stu-id="d31e9-120">**PEER\_GRAPH\_EVENT\_DIRECT\_CONNECTION** indicates that a direct connection is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="d31e9-121">**Peer \_ La \_ \_ \_ connessione adiacente a un evento Graph** indica che è stata modificata una connessione a un nodo adiacente, ad esempio un nodo è connesso.</span><span class="sxs-lookup"><span data-stu-id="d31e9-121">**PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** indicates that a connection to a neighbor node is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="d31e9-122">**Peer \_ \_ \_ \_ I dati in ingresso dell'evento Graph** indicano che i dati sono stati ricevuti da una connessione diretta o vicina.</span><span class="sxs-lookup"><span data-stu-id="d31e9-122">**PEER\_GRAPH\_EVENT\_INCOMING\_DATA** indicates that data has been received from a direct or neighbor connection.</span></span>
-   <span data-ttu-id="d31e9-123">**Peer \_ \_Connessione evento \_ grafico \_ richiesta** indica che l'infrastruttura di Graphing richiede una nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="d31e9-123">**PEER\_GRAPH\_EVENT\_CONNECTION\_REQUIRED** indicates that the Graphing Infrastructure requires a new connection.</span></span>
    > [!Note]  
    > <span data-ttu-id="d31e9-124">Una chiamata a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) si connette a un nuovo nodo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-124">A call to [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) connects to a new node.</span></span> <span data-ttu-id="d31e9-125">Una chiamata a [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) non restituisce dati.</span><span class="sxs-lookup"><span data-stu-id="d31e9-125">A call to [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) does not return data.</span></span>

     

-   <span data-ttu-id="d31e9-126">**Peer \_ Il \_ nodo evento Graph \_ \_ modificato** indica che le informazioni sulla presenza del nodo sono state modificate, ad esempio un indirizzo IP è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-126">**PEER\_GRAPH\_EVENT\_NODE\_CHANGED** indicates that node presence information is changed, for example, an IP address has changed.</span></span>
-   <span data-ttu-id="d31e9-127">**Peer \_ \_Evento grafico \_ sincronizzato** indica che un tipo di record specifico è sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-127">**PEER\_GRAPH\_EVENT\_SYNCHRONIZED** indicates that a specific record type is synchronized.</span></span>

<span data-ttu-id="d31e9-128">Dopo che un'applicazione riceve la notifica che si è verificato un evento peer, l'applicazione chiama [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata)e passa l'handle di evento peer restituito da [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="d31e9-128">After an application receives notification that a peer event has occurred, the application calls [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span> <span data-ttu-id="d31e9-129">L'infrastruttura peer restituisce un puntatore a una struttura di [**\_ dati dell' \_ evento \_ del grafo peer**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) che contiene i dati richiesti.</span><span class="sxs-lookup"><span data-stu-id="d31e9-129">The Peer Infrastructure returns a pointer to a [**PEER\_GRAPH\_EVENT\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) structure that contains the requested data.</span></span> <span data-ttu-id="d31e9-130">Questa funzione deve essere chiamata fino a quando non viene restituito **\_ \_ alcun \_ \_ dato di evento peer S** .</span><span class="sxs-lookup"><span data-stu-id="d31e9-130">This function should be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span>

<span data-ttu-id="d31e9-131">Quando un'applicazione non richiede una notifica degli eventi peer, l'applicazione chiama [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent)e passa l'handle di evento peer restituito da [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) quando l'applicazione è registrata.</span><span class="sxs-lookup"><span data-stu-id="d31e9-131">After an application does not require a peer event notification, the application calls either [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) when the application registered.</span></span>

## <a name="handling-graph-connection-referrals"></a><span data-ttu-id="d31e9-132">Gestione dei riferimenti di connessione al grafo</span><span class="sxs-lookup"><span data-stu-id="d31e9-132">Handling Graph Connection Referrals</span></span>

<span data-ttu-id="d31e9-133">Quando viene chiamato [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) , il peer connesso riceve una notifica di esito positivo o negativo tramite l'evento di **\_ \_ \_ \_ connessione adiacente all'evento del grafo peer** asincrono.</span><span class="sxs-lookup"><span data-stu-id="d31e9-133">When [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) is called, the connecting peer is notified of success or failure through the asynchronous **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event.</span></span> <span data-ttu-id="d31e9-134">Se la connessione non è riuscita a causa di problemi di rete specifici, ad esempio un firewall configurato in modo errato, viene generato l'evento di **\_ \_ \_ \_ connessione adiacente all'evento del grafo del peer** , con lo stato della connessione impostato su **\_ connessione peer \_ non riuscita**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-134">If the connection failed due to a specific networking issues (such as a misconfigured firewall), the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event is raised, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span>

<span data-ttu-id="d31e9-135">Tuttavia, quando un peer riceve un riferimento quando tenta di connettersi a un nodo occupato, viene generata **la \_ \_ \_ \_ connessione adiacente all'evento del grafo del peer** sul peer connesso, con lo stato della connessione impostato su **\_ connessione peer \_ non riuscito**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-135">However, when a peer receives a referral when it attempts to connect to a busy node, the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** is raised on the connecting peer, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="d31e9-136">Il peer di connessione può essere fatto riferimento a un altro nodo che a sua volta è occupato e può inviare un riferimento e lo stesso evento e lo stesso stato vengono generati sul peer di connessione.</span><span class="sxs-lookup"><span data-stu-id="d31e9-136">The connecting peer may be referred to another node which itself is busy and may send a referral, and the same event and status are raised on the connecting peer.</span></span> <span data-ttu-id="d31e9-137">Questa catena di riferimenti che generano stato degli eventi di **\_ connessione peer \_ non riuscita** può continuare fino a quando non viene esaurito il numero massimo di tentativi di connessione.</span><span class="sxs-lookup"><span data-stu-id="d31e9-137">This chain of referrals that result in **PEER\_CONNECTION\_FAILED** event statuses can continue until the maximum number of connection attempts has been exhausted.</span></span> <span data-ttu-id="d31e9-138">Il peer non dispone di un meccanismo per determinare la differenza tra un tentativo di connessione completo e il riferimento alla connessione.</span><span class="sxs-lookup"><span data-stu-id="d31e9-138">The peer does not have a mechanism to determine the difference between a full connection attempt and the connection referral.</span></span>

<span data-ttu-id="d31e9-139">Per risolvere questo problema, gli sviluppatori devono considerare l'utilizzo degli eventi di modifica dello stato del grafo peer per determinare se il tentativo di connessione riuscito.</span><span class="sxs-lookup"><span data-stu-id="d31e9-139">To address this issue, developers should consider using the peer graph status change events to determine if the connection attempt suceeded.</span></span> <span data-ttu-id="d31e9-140">Se l'evento non viene ricevuto entro un periodo di tempo specifico, l'applicazione può presupporre che il peer di connessione venga sottoposta a riferimento e che l'applicazione peer debba prendere in considerazione il tentativo di connessione a un errore.</span><span class="sxs-lookup"><span data-stu-id="d31e9-140">If the event is not received within a specific amount of time, the application can assume that the connecting peer is being referred and that the peer application should consider the connection attempt a failure.</span></span>

## <a name="peer-grouping-events"></a><span data-ttu-id="d31e9-141">Eventi di raggruppamento peer</span><span class="sxs-lookup"><span data-stu-id="d31e9-141">Peer Grouping Events</span></span>

<span data-ttu-id="d31e9-142">Un'applicazione di raggruppamento peer può registrarsi per ricevere notifiche per 8 eventi peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-142">A Peer Grouping application can register to receive notification for 8 peer events.</span></span> <span data-ttu-id="d31e9-143">Ogni nome di evento è preceduto da **un \_ \_ \_ evento di gruppo peer**. ad esempio, **lo stato dell'evento del gruppo peer è \_ \_ \_ stato \_ modificato**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-143">Each event name is prefaced with **PEER\_GROUP\_EVENT\_**; for example, **PEER\_GROUP\_EVENT\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="d31e9-144">Se non specificato diversamente, le informazioni su una modifica vengono recuperate tramite [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="d31e9-144">Unless otherwise noted, information about a change is retrieved by using [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span>

-   <span data-ttu-id="d31e9-145">**Peer \_ \_Stato evento \_ gruppo \_ modificato** indica che lo stato del gruppo è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-145">**PEER\_GROUP\_EVENT\_STATUS\_CHANGED** indicates that the group status has changed.</span></span> <span data-ttu-id="d31e9-146">Esistono due valori di stato possibili: **stato del gruppo peer in \_ \_ \_ ascolto**, che indica che il gruppo non dispone di connessioni ed è in attesa di nuovi membri e **\_ lo stato del gruppo peer \_ dispone di \_ connessioni**, che indica che il gruppo dispone di almeno una connessione.</span><span class="sxs-lookup"><span data-stu-id="d31e9-146">There are two status values possible: **PEER\_GROUP\_STATUS\_LISTENING**, which indicates that the group has no connections and is waiting for new members; and **PEER\_GROUP\_STATUS\_HAS CONNECTIONS**, which indicates that the group has at least one connection.</span></span> <span data-ttu-id="d31e9-147">Questo valore di stato può essere ottenuto chiamando [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) dopo la generazione di questo evento.</span><span class="sxs-lookup"><span data-stu-id="d31e9-147">This status value can be obtained by calling [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) after this event is raised.</span></span>
-   <span data-ttu-id="d31e9-148">**Peer \_ \_Proprietà evento \_ gruppo \_ modificata** indica che le proprietà del gruppo sono state modificate o aggiornate dall'autore del gruppo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-148">**PEER\_GROUP\_EVENT\_PROPERTY\_CHANGED** indicates that the group properties have been changed or updated by the group creator.</span></span>
-   <span data-ttu-id="d31e9-149">**Peer \_ Il record degli eventi di gruppo è stato \_ \_ \_ modificato** indica che è stata eseguita un'operazione di record.</span><span class="sxs-lookup"><span data-stu-id="d31e9-149">**PEER\_GROUP\_EVENT\_RECORD\_CHANGED** indicates that a record operation has been performed.</span></span> <span data-ttu-id="d31e9-150">Questo evento viene generato quando un peer che partecipa al gruppo pubblica, aggiorna o Elimina un record.</span><span class="sxs-lookup"><span data-stu-id="d31e9-150">This event is raised when a peer participating in the group publishes, updates, or deletes a record.</span></span> <span data-ttu-id="d31e9-151">Questo evento, ad esempio, viene generato quando un'applicazione di chat invia un messaggio di chat.</span><span class="sxs-lookup"><span data-stu-id="d31e9-151">For example, this event is raised when a chat application sends a chat message.</span></span>
-   <span data-ttu-id="d31e9-152">**Peer \_ Il \_ membro evento gruppo \_ \_ modificato** indica che lo stato di un membro all'interno del gruppo è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-152">**PEER\_GROUP\_EVENT\_MEMBER\_CHANGED** indicates that a member's status within the group has changed.</span></span> <span data-ttu-id="d31e9-153">Le modifiche dello stato includono:</span><span class="sxs-lookup"><span data-stu-id="d31e9-153">Status changes include:</span></span>
    -   <span data-ttu-id="d31e9-154">**Peer \_ MEMBRO \_ connesso**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-154">**PEER\_MEMBER\_CONNECTED**.</span></span> <span data-ttu-id="d31e9-155">Un peer si è connesso al gruppo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-155">A peer has connected to the group.</span></span>
    -   <span data-ttu-id="d31e9-156">**Peer \_ MEMBRO \_ disconnesso**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-156">**PEER\_MEMBER\_DISCONNECTED**.</span></span> <span data-ttu-id="d31e9-157">Un peer è stato disconnesso dal gruppo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-157">A peer has disconnected from the group.</span></span>
    -   <span data-ttu-id="d31e9-158">**Peer \_ MEMBRO \_ aggiunto**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-158">**PEER\_MEMBER\_JOINED**.</span></span> <span data-ttu-id="d31e9-159">Sono state pubblicate nuove informazioni di appartenenza per un peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-159">New membership information has been published for a peer.</span></span>
    -   <span data-ttu-id="d31e9-160">**Peer \_ MEMBRO \_ aggiornato**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-160">**PEER\_MEMBER\_UPDATED**.</span></span> <span data-ttu-id="d31e9-161">Un peer è stato aggiornato con nuove informazioni, ad esempio un nuovo indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="d31e9-161">A peer has updated with new information, such as a new IP address.</span></span>
-   <span data-ttu-id="d31e9-162">**Peer \_ \_ \_ \_ connessione adiacente all'evento di gruppo**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-162">**PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span> <span data-ttu-id="d31e9-163">I peer che parteciperanno alle connessioni adiacenti all'interno del gruppo devono registrarsi per questo evento.</span><span class="sxs-lookup"><span data-stu-id="d31e9-163">Peers who will participate in neighbor connections within the group must register for this event.</span></span> <span data-ttu-id="d31e9-164">Si noti che la registrazione per questo evento non consente al peer di ricevere dati. la registrazione per questo evento garantisce la notifica solo quando viene ricevuta una richiesta di connessione vicina.</span><span class="sxs-lookup"><span data-stu-id="d31e9-164">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a neighbor connection is received.</span></span>
-   <span data-ttu-id="d31e9-165">**Peer \_ \_ \_ \_ connessione diretta agli eventi di gruppo**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-165">**PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION**.</span></span> <span data-ttu-id="d31e9-166">I peer che parteciperanno alle connessioni dirette all'interno del gruppo devono registrarsi per questo evento.</span><span class="sxs-lookup"><span data-stu-id="d31e9-166">Peers who will participate in direct connections within the group must register for this event.</span></span> <span data-ttu-id="d31e9-167">Si noti che la registrazione per questo evento non consente al peer di ricevere dati. la registrazione per questo evento garantisce la notifica solo quando viene ricevuta una richiesta di connessione diretta.</span><span class="sxs-lookup"><span data-stu-id="d31e9-167">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a direct connection is received.</span></span>
-   <span data-ttu-id="d31e9-168">**Peer \_ RAGGRUPPAre \_ \_ \_ i dati in ingresso dell'evento**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-168">**PEER\_GROUP\_EVENT\_INCOMING\_DATA**.</span></span> <span data-ttu-id="d31e9-169">Per questo evento, i peer che riceveranno dati tramite un router adiacente o una connessione diretta devono registrarsi.</span><span class="sxs-lookup"><span data-stu-id="d31e9-169">Peers who will receive data over a neighbor or direct connection must register for this event.</span></span> <span data-ttu-id="d31e9-170">Quando viene generato questo evento, i dati opachi trasmessi dall'altro peer partecipante possono essere ottenuti chiamando [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="d31e9-170">When this event is raised, the opaque data transmitted by the other participating peer can be obtained by calling [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="d31e9-171">Si noti che per ricevere questo evento, è necessario che il peer sia stato registrato in precedenza per la connessione **\_ \_ \_ diretta \_ eventi del gruppo peer** o per l' **\_ evento del gruppo \_ \_ \_ peer**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-171">Note that to receive this event, the peer must have previously registered for **PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION** or **PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span>
-   <span data-ttu-id="d31e9-172">**Peer \_ \_connessione evento \_ gruppo \_ non riuscita**.</span><span class="sxs-lookup"><span data-stu-id="d31e9-172">**PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="d31e9-173">Connessione non riuscita per qualche motivo.</span><span class="sxs-lookup"><span data-stu-id="d31e9-173">A connection failed for some reason.</span></span> <span data-ttu-id="d31e9-174">Non vengono forniti dati quando viene generato questo evento e [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) non deve essere chiamato.</span><span class="sxs-lookup"><span data-stu-id="d31e9-174">No data is provided when this event is raised, and [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) should not be called.</span></span>

<span data-ttu-id="d31e9-175">Dopo che un'applicazione riceve la notifica che si è verificato un evento peer (esclusa la **\_ connessione all'evento del gruppo peer \_ \_ \_ non riuscita**), l'applicazione chiama [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata)e passa l'handle dell'evento peer restituito da [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span><span class="sxs-lookup"><span data-stu-id="d31e9-175">After an application receives notification that a peer event has occurred (excluding **PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**), the application calls [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata), and passes the peer event handle returned by [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span> <span data-ttu-id="d31e9-176">L'infrastruttura peer restituisce un puntatore a una struttura di [**\_ dati degli \_ eventi \_ del gruppo peer**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1) che contiene i dati richiesti.</span><span class="sxs-lookup"><span data-stu-id="d31e9-176">The Peer Infrastructure returns a pointer to a [**PEER\_GROUP\_EVENT\_DATA**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1) structure that contains the requested data.</span></span> <span data-ttu-id="d31e9-177">Questa funzione deve essere chiamata fino a quando non viene restituito **\_ \_ alcun \_ \_ dato di evento peer S** .</span><span class="sxs-lookup"><span data-stu-id="d31e9-177">This function must be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span> <span data-ttu-id="d31e9-178">Quando un'applicazione non richiede più la notifica per un evento peer, è necessario effettuare una chiamata a [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), passando l'handle di evento peer restituito da **PeerGroupRegisterEvent** quando l'applicazione è registrata per l'evento specifico.</span><span class="sxs-lookup"><span data-stu-id="d31e9-178">When an application no longer requires notification for a peer event, a call must be made to [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), passing the peer event handle returned by **PeerGroupRegisterEvent** when the application registered for the particular event.</span></span>

## <a name="example-of-registering-for-peer-graphing-events"></a><span data-ttu-id="d31e9-179">Esempio di registrazione per gli eventi di Graphing peer</span><span class="sxs-lookup"><span data-stu-id="d31e9-179">Example of Registering for Peer Graphing Events</span></span>

<span data-ttu-id="d31e9-180">Nell'esempio di codice riportato di seguito viene illustrato come eseguire la registrazione con gli eventi di grafica peer.</span><span class="sxs-lookup"><span data-stu-id="d31e9-180">The following code sample shows you how to register with the Peer Graphing events.</span></span>


```C++
//-----------------------------------------------------------------------------
// Function: RegisterForEvents
//
// Purpose:  Registers the EventCallback function so it can be called for only
//           the events that are specified.
//
// Returns:  HRESULT
//
HRESULT RegisterForEvents()
{
    HPEEREVENT  g_hPeerEvent = NULL;        // The one PeerEvent handle
    HANDLE      g_hEvent = NULL;            // Handle signaled by Graphing when we have an event
    HRESULT hr = S_OK;
    PEER_GRAPH_EVENT_REGISTRATION regs[] = {
        { PEER_GRAPH_EVENT_RECORD_CHANGED, 0 },
        { PEER_GRAPH_EVENT_NODE_CHANGED,   0 },
        { PEER_GRAPH_EVENT_STATUS_CHANGED, 0 },
        { PEER_GRAPH_EVENT_DIRECT_CONNECTION, 0 },
        { PEER_GRAPH_EVENT_INCOMING_DATA, 0 },
    };

    g_hEvent = CreateEvent(NULL, FALSE, FALSE, NULL);
    if (g_hEvent == NULL)
    {
        wprintf(L"CreateEvent call failed.\n");
        hr = E_OUTOFMEMORY;
    }
    else
    {
        hr = PeerGraphRegisterEvent(g_hGraph, g_hEvent, celems(regs), regs,  &g_hPeerEvent);
        if (FAILED(hr))
        {
           wprintf(L"PeerGraphRegisterEvent call failed.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    if (SUCCEEDED(hr))
    {
        if (!RegisterWaitForSingleObject(&g_hWait, g_hEvent, EventCallback, NULL, INFINITE, WT_EXECUTEDEFAULT))
        {
            hr = HRESULT_FROM_WIN32(GetLastError());
            wprintf(L"Could not set up event callback.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    return hr;
}
```



 

 



