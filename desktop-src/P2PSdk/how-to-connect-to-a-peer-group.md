---
description: Questo argomento illustra il modo in cui un'applicazione si connette a un gruppo peer usando le API di raggruppamento peer.
ms.assetid: 56fa28d8-3b3a-4cd5-8448-c8c4ce8d0b2c
title: Come connettersi a un gruppo peer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d5bb3f41342573742e634a6e7ebce283188f3ffd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106312268"
---
# <a name="how-to-connect-to-a-peer-group"></a><span data-ttu-id="b16df-103">Come connettersi a un gruppo peer</span><span class="sxs-lookup"><span data-stu-id="b16df-103">How to Connect to a Peer Group</span></span>

<span data-ttu-id="b16df-104">Questo argomento illustra il modo in cui un'applicazione si connette a un gruppo peer usando le API di raggruppamento peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-104">This topic discusses how an application connects to a peer group using the Peer Grouping APIs.</span></span>

## <a name="joining-a-peer-group"></a><span data-ttu-id="b16df-105">Aggiunta a un gruppo peer</span><span class="sxs-lookup"><span data-stu-id="b16df-105">Joining a Peer Group</span></span>

<span data-ttu-id="b16df-106">Per partecipare a un gruppo peer, chiamare [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), passando il nome dell'identità del peer e l'invito (e un nome di Cloud PNRP facoltativo, se il nome del cloud nell'invito è ambiguo).</span><span class="sxs-lookup"><span data-stu-id="b16df-106">To join a peer group, call [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), passing in the identity name of the peer and the invitation (and an optional PNRP cloud name, if the cloud name in the invitation is ambiguous).</span></span>

<span data-ttu-id="b16df-107">In caso di esito positivo, [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) restituisce un handle al gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-107">If successful, [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) returns a handle to the peer group.</span></span>

<span data-ttu-id="b16df-108">Se il peer è stato aggiunto in precedenza al gruppo peer e l'handle è stato chiuso, il gruppo peer deve essere riaperto chiamando [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) e passando il nome del gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-108">If the peer has previously joined the peer group and then closed the handle, the peer group should be reopened by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) and passing in the name of the peer group.</span></span> <span data-ttu-id="b16df-109">Questa chiamata restituisce un nuovo handle del gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-109">This call returns a new peer group handle.</span></span>

<span data-ttu-id="b16df-110">Una volta che il gruppo peer è stato aggiunto correttamente, il peer può connettersi direttamente al gruppo peer e iniziare a interagire chiamando [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span><span class="sxs-lookup"><span data-stu-id="b16df-110">Once the peer group is successfully joined, the peer may connect directly to the peer group and begin interacting by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span></span> <span data-ttu-id="b16df-111">Dopo la connessione, il peer viene considerato "online".</span><span class="sxs-lookup"><span data-stu-id="b16df-111">After connecting, the peer is considered to be "online".</span></span>

<span data-ttu-id="b16df-112">Se un'applicazione non è in grado di interagire con il gruppo al momento, può rimanere "offline".</span><span class="sxs-lookup"><span data-stu-id="b16df-112">If an application will not interact with the group at the time, it can remain "offline".</span></span> <span data-ttu-id="b16df-113">Se si sceglie di partecipare direttamente al gruppo peer in un'istanza successiva, una chiamata successiva a [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) lo porta online.</span><span class="sxs-lookup"><span data-stu-id="b16df-113">If it chooses to participate directly in the peer group at a later instance, a subsequent call to [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) will bring it online.</span></span> <span data-ttu-id="b16df-114">Dopo che un peer è stato aggiunto al gruppo peer, deve connettersi almeno una volta prima che sia in grado di pubblicare i record nel gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-114">After a peer has joined the peer group, it must connect at least once before it will be able to publish records to the peer group.</span></span>

## <a name="opening-a-peer-group-without-connecting-offline"></a><span data-ttu-id="b16df-115">Apertura di un gruppo peer senza connessione (offline)</span><span class="sxs-lookup"><span data-stu-id="b16df-115">Opening a Peer Group Without Connecting (Offline)</span></span>

<span data-ttu-id="b16df-116">Spesso può essere necessario che un'applicazione si connetta a un gruppo peer, ma non la partecipi direttamente, riceve e pubblica gli aggiornamenti dei record, ma non invia o riceve messaggi di dati.</span><span class="sxs-lookup"><span data-stu-id="b16df-116">Often, you may wish to have an application connect to a peer group but not directly participate it, receiving and publishing record updates but not sending or receiving data messages.</span></span> <span data-ttu-id="b16df-117">Un'applicazione è in questo stato "offline" immediatamente dopo la chiamata a [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin)o [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) .</span><span class="sxs-lookup"><span data-stu-id="b16df-117">An application is in this "offline" state immediately after [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), or [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) have been called.</span></span>

<span data-ttu-id="b16df-118">Un'applicazione offline può essere spostata online in qualsiasi momento chiamando [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span><span class="sxs-lookup"><span data-stu-id="b16df-118">An offline application can go online at any time by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span></span> <span data-ttu-id="b16df-119">Una volta stabilita la connessione, un gruppo peer non può passare alla modalità offline finché tutte le altre applicazioni associate a questa identità e che condividono questo gruppo non avranno anche connessioni chiuse.</span><span class="sxs-lookup"><span data-stu-id="b16df-119">Once connected, a peer group cannot go offline until all other applications associated with this identity and sharing this group have closed connections to it as well.</span></span>

<span data-ttu-id="b16df-120">Un gruppo peer è una risorsa condivisa con lo stesso gruppo peer disponibile per più applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b16df-120">A peer group is a shared resource, with the same peer group available to multiple applications.</span></span> <span data-ttu-id="b16df-121">Se più di un'applicazione per la stessa identità e l'utente di Windows utilizza lo stesso gruppo peer, condividono anche lo stesso database e le stesse connessioni sottostanti (Neighbor e Direct).</span><span class="sxs-lookup"><span data-stu-id="b16df-121">If more than one application for the same identity and Windows user is using the same peer group, they also share the same underlying database and connections (neighbor and direct).</span></span> <span data-ttu-id="b16df-122">Se una di queste applicazioni chiama [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect), tutte le altre applicazioni per questa identità/utente che partecipano al gruppo si connetteranno anche al gruppo.</span><span class="sxs-lookup"><span data-stu-id="b16df-122">If any one of these applications calls [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect), all of the other applications for this identity/user participating in the group also connect to the group.</span></span> <span data-ttu-id="b16df-123">Se un record viene aggiunto da un'applicazione mentre il gruppo è offline, è possibile visualizzarne anche altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b16df-123">If a record is added by one application while the group is offline, other applications are also be able to see it.</span></span> <span data-ttu-id="b16df-124">Di conseguenza, un'applicazione deve essere pronta per essere portata online in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="b16df-124">As a result, an application must be ready to go online at any time.</span></span>

## <a name="connecting-to-a-peer-group-online"></a><span data-ttu-id="b16df-125">Connessione a un gruppo peer (online)</span><span class="sxs-lookup"><span data-stu-id="b16df-125">Connecting to a Peer Group (Online)</span></span>

<span data-ttu-id="b16df-126">Per iniziare a partecipare a un gruppo, chiamare [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) dopo la creazione, l'aggiunta o l'apertura del gruppo.</span><span class="sxs-lookup"><span data-stu-id="b16df-126">To begin participating in a group, call [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) after creating, joining, or opening the group.</span></span> <span data-ttu-id="b16df-127">In questo stato, le connessioni dirette possono essere aperte con altri peer che partecipano allo stesso gruppo chiamando [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection).</span><span class="sxs-lookup"><span data-stu-id="b16df-127">In this state, direct connections can be opened with other peers participating in the same group by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection).</span></span>

<span data-ttu-id="b16df-128">Per rilevare se un tentativo di connessione non è riuscito, effettuare la registrazione per l' \_ \_ evento di \_ connessione evento \_ non riuscita di un gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="b16df-128">To detect if a connection attempt has failed, register for the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event.</span></span> <span data-ttu-id="b16df-129">Questo evento viene generato se l'infrastruttura di raggruppamento non riesce a trovare un altro membro a cui connettersi o se la connessione non riesce prima che il database del gruppo venga sincronizzato e non è possibile stabilire un'altra connessione.</span><span class="sxs-lookup"><span data-stu-id="b16df-129">This event is raised if the grouping infrastructure cannot find another member to connect to, or if the connection fails before the group database is synchronized and another connection cannot be established.</span></span>

<span data-ttu-id="b16df-130">Anche se più applicazioni eseguite sul peer e che partecipano allo stesso gruppo con la stessa identità peer possono essere offline, una chiamata a [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) da parte di una qualsiasi delle applicazioni determina la modalità online per tutte le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b16df-130">Although multiple applications executing on the peer and participating in the same group with the same peer identity may be offline, a call to [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) by any one of the applications results in all of the applications becoming online.</span></span>

<span data-ttu-id="b16df-131">Inoltre, se un'applicazione nel peer è connessa al gruppo, tutte le altre applicazioni che chiamano [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) o [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) sono immediatamente connesse.</span><span class="sxs-lookup"><span data-stu-id="b16df-131">Also, if one application on the peer has connected to the group, any other applications that call [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) or [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) are immediately connected as well.</span></span> <span data-ttu-id="b16df-132">Se un'applicazione chiama [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), l'handle viene chiuso solo per tale applicazione.</span><span class="sxs-lookup"><span data-stu-id="b16df-132">If an application calls [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), the handle is closed for only that application.</span></span> <span data-ttu-id="b16df-133">Quindi, una chiamata successiva a **PeerGroupOpen** da parte dell'applicazione restituisce un nuovo handle di gruppo e l'applicazione viene portata online immediatamente se le altre applicazioni che partecipano allo stesso gruppo sono ancora connesse.</span><span class="sxs-lookup"><span data-stu-id="b16df-133">Thus, a subsequent call to **PeerGroupOpen** by the application returns a new group handle, and the application is brought online immediately if any other applications participating in the same group are still connected.</span></span>

## <a name="sending-and-receiving-data"></a><span data-ttu-id="b16df-134">Invio e ricezione di dati</span><span class="sxs-lookup"><span data-stu-id="b16df-134">Sending and Receiving Data</span></span>

<span data-ttu-id="b16df-135">Per inviare e ricevere dati tra nodi membro specifici del gruppo, è necessario stabilire connessioni dirette con i membri con cui si intende interagire.</span><span class="sxs-lookup"><span data-stu-id="b16df-135">To send and receive data between specific member nodes in the group, direct connections must be established with those members you intend to interact with.</span></span> <span data-ttu-id="b16df-136">Stabilire una connessione diretta è una chiamata asincrona a [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection), passando l'handle per un gruppo connesso e l'identità del peer all'interno del gruppo a cui ci si vuole connettere.</span><span class="sxs-lookup"><span data-stu-id="b16df-136">Establishing a direct connection is an asynchronous call to [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection), passing in the handle for a connected group as well as the identity of the peer within the group you wish to connect to.</span></span> <span data-ttu-id="b16df-137">Questo metodo restituirà un ID connessione.</span><span class="sxs-lookup"><span data-stu-id="b16df-137">This method will return a connection ID.</span></span> <span data-ttu-id="b16df-138">Se la chiamata ha esito positivo, \_ \_ viene generato un evento di connessione diretta a un evento del gruppo peer \_ \_ sul peer, convalidando l'ID connessione.</span><span class="sxs-lookup"><span data-stu-id="b16df-138">If the call is successful, a PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION event is raised on the peer, validating the connection ID.</span></span>

<span data-ttu-id="b16df-139">Per ricevere connessioni dirette da altri peer online, effettuare la registrazione per l' \_ evento di connessione diretta a eventi del gruppo peer \_ \_ \_ con una chiamata a [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span><span class="sxs-lookup"><span data-stu-id="b16df-139">To receive direct connections from other online peers, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION event with a call to [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span>

<span data-ttu-id="b16df-140">Una volta stabilita una connessione diretta, l'applicazione può iniziare a inviare dati con chiamate a [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata), passando l'ID connessione valido.</span><span class="sxs-lookup"><span data-stu-id="b16df-140">Once a direct connection has been successfully established, the application can begin sending data with calls to [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata), passing the valid connection ID.</span></span> <span data-ttu-id="b16df-141">L'ordinamento delle trasmissioni di dati multipart è gestito da **PeerGroupSendData**.</span><span class="sxs-lookup"><span data-stu-id="b16df-141">The ordering of multipart data transmissions is handled by **PeerGroupSendData**.</span></span> <span data-ttu-id="b16df-142">Tuttavia, le applicazioni devono implementare uno stack di protocolli appropriato per la gestione dei dati opachi restituiti da questa chiamata API.</span><span class="sxs-lookup"><span data-stu-id="b16df-142">However, applications should implement a proper protocol stack for handling the opaque data returned by this API call.</span></span>

<span data-ttu-id="b16df-143">Per ricevere dati tramite una connessione diretta, l'applicazione deve registrarsi per l' \_ \_ evento di \_ dati in ingresso evento del gruppo peer \_ con [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span><span class="sxs-lookup"><span data-stu-id="b16df-143">To receive data over a direct connection, the application must register for the PEER\_GROUP\_EVENT\_INCOMING\_DATA event with [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span> <span data-ttu-id="b16df-144">Il gestore eventi è responsabile dell'acquisizione e dell'ordinamento dei dati opachi e della relativa passata all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b16df-144">The event handler is responsible for obtaining and ordering the opaque data, and passing it to the application.</span></span> <span data-ttu-id="b16df-145">Questi dati vengono ottenuti nel gestore eventi chiamando [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) con l'handle per gli eventi registrati.</span><span class="sxs-lookup"><span data-stu-id="b16df-145">This data is obtained within the event handler by calling [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) with the handle to the registered events.</span></span>

<span data-ttu-id="b16df-146">Una connessione diretta viene chiusa chiamando [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) e passando l'ID connessione ottenuto da una precedente chiamata a [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) o ricevuta nei dati dell'evento per la \_ \_ connessione diretta del gruppo di eventi peer \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="b16df-146">A direct connection is closed by calling [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and passing in the connection ID obtained by a previous call to [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) or received in the event data for PEER\_EVENT\_GROUP\_DIRECT\_CONNECTION.</span></span>

 

 



