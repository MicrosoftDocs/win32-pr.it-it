---
description: Il raggruppamento peer-to-peer è una tecnologia che consente a uno sviluppatore di creare una rete peer sicura in modo rapido ed efficace.
ms.assetid: ee72f60b-1e5b-4b69-bda0-2ae80734c144
title: Come lavorare con i gruppi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7bebf958d0c3fdee6ad0dc400d495c54ec2e6fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104529125"
---
# <a name="how-to-work-with-groups"></a><span data-ttu-id="0e01c-103">Come lavorare con i gruppi</span><span class="sxs-lookup"><span data-stu-id="0e01c-103">How to Work With Groups</span></span>

<span data-ttu-id="0e01c-104">Il raggruppamento peer-to-peer è una tecnologia che consente a uno sviluppatore di creare una rete peer sicura in modo rapido ed efficace.</span><span class="sxs-lookup"><span data-stu-id="0e01c-104">Peer-to-peer Grouping is a technology that allows a developer to create a secure peer network quickly and effectively.</span></span> <span data-ttu-id="0e01c-105">Nell'elenco seguente sono riportate le considerazioni principali per la creazione di un'applicazione di raggruppamento peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-105">The following list identifies the major considerations in creating a peer grouping application.</span></span>

-   [<span data-ttu-id="0e01c-106">Ottenere un'identità peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-106">Obtaining a Peer Identity</span></span>](#obtaining-a-peer-identity)
-   [<span data-ttu-id="0e01c-107">Avvio di un gruppo peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-107">Starting Up a Peer Group</span></span>](#starting-up-the-peer-grouping-infrastructure)
-   [<span data-ttu-id="0e01c-108">Registrazione per gli eventi di raggruppamento</span><span class="sxs-lookup"><span data-stu-id="0e01c-108">Registering for Grouping Events</span></span>](#registering-for-peer-grouping-events)
-   [<span data-ttu-id="0e01c-109">Connessione a un gruppo</span><span class="sxs-lookup"><span data-stu-id="0e01c-109">Connecting to a Group</span></span>](#obtaining-a-group-handle)
-   [<span data-ttu-id="0e01c-110">Creazione di ruoli amministratore e membro</span><span class="sxs-lookup"><span data-stu-id="0e01c-110">Creating Administrator and Member Roles</span></span>](#creating-administrator-and-member-roles)
-   [<span data-ttu-id="0e01c-111">Ricerca di un peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-111">Finding a Peer</span></span>](#finding-a-peer)
-   [<span data-ttu-id="0e01c-112">Connessione diretta a un peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-112">Connecting Directly to a Peer</span></span>](#connecting-directly-to-a-peer)
-   [<span data-ttu-id="0e01c-113">Chiusura e arresto di un gruppo</span><span class="sxs-lookup"><span data-stu-id="0e01c-113">Closing and Shutting Down a Group</span></span>](#closing-and-shutting-down-a-peer-group)

## <a name="obtaining-a-peer-identity"></a><span data-ttu-id="0e01c-114">Ottenere un'identità peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-114">Obtaining a Peer Identity</span></span>

<span data-ttu-id="0e01c-115">Prima di creare o connettersi a un gruppo, un peer deve ottenere un'identità peer, ovvero un nome usato per identificare in modo univoco un peer per un gruppo.</span><span class="sxs-lookup"><span data-stu-id="0e01c-115">Before creating or connecting to a group, a peer must obtain a peer identity, which is a name used to uniquely identify a peer to a group.</span></span> <span data-ttu-id="0e01c-116">Per ottenere un elenco enumerato di tutte le identità peer definite nel peer, chiamare [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), che restituisce un handle per l'enumerazione.</span><span class="sxs-lookup"><span data-stu-id="0e01c-116">To obtain an enumerated list of all peer identities defined on the peer, call [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), which returns a handle to the enumeration.</span></span> <span data-ttu-id="0e01c-117">Per ottenere le identità peer, chiamare [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) con l'handle dell'enumerazione e il numero di membri da recuperare.</span><span class="sxs-lookup"><span data-stu-id="0e01c-117">To obtain the peer identities, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enumeration handle and the number of members to retrieve.</span></span> <span data-ttu-id="0e01c-118">Continuare a chiamare **PeerGetNextItem** fino a quando il parametro *pcount* non restituisce un valore inferiore al numero di identità peer richieste.</span><span class="sxs-lookup"><span data-stu-id="0e01c-118">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of peer identities requested.</span></span>

<span data-ttu-id="0e01c-119">Se non esiste un'identità peer per il peer, è possibile crearla chiamando [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span><span class="sxs-lookup"><span data-stu-id="0e01c-119">If a peer identity for the peer does not exist, it can be created by calling [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span></span> <span data-ttu-id="0e01c-120">Dopo aver creato un'identità peer, il peer genera un BLOB XML di identità che contiene la chiave pubblica assegnata</span><span class="sxs-lookup"><span data-stu-id="0e01c-120">After creating a peer identity, the peer generates an identity XML blob that contains the public key assigned to it</span></span>

<span data-ttu-id="0e01c-121">Le informazioni sull'identità peer vengono ottenute chiamando [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span><span class="sxs-lookup"><span data-stu-id="0e01c-121">The peer identity information is obtained by calling [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span></span> <span data-ttu-id="0e01c-122">Queste informazioni sull'identità del peer vengono usate dall'autore del gruppo o da un amministratore per emettere le credenziali necessarie per partecipare al gruppo, come un BLOB XML di invito.</span><span class="sxs-lookup"><span data-stu-id="0e01c-122">This peer identity information is used by the group creator or an administrator to issue the credentials needed to join the group, as an invitation XML blob.</span></span>

<span data-ttu-id="0e01c-123">Per ulteriori informazioni sulle identità peer, consultare la documentazione dell' [API di Identity Manager](identity-manager-api.md)</span><span class="sxs-lookup"><span data-stu-id="0e01c-123">For more information on peer identities, please refer to the [Identity Manager API](identity-manager-api.md) documentation</span></span>

## <a name="starting-up-the-peer-grouping-infrastructure"></a><span data-ttu-id="0e01c-124">Avvio dell'infrastruttura di raggruppamento dei peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-124">Starting Up the Peer Grouping Infrastructure</span></span>

<span data-ttu-id="0e01c-125">Prima che qualsiasi funzione nell'API di raggruppamento peer venga chiamata da un'applicazione, è necessario chiamare [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) .</span><span class="sxs-lookup"><span data-stu-id="0e01c-125">Before any function in the Peer Grouping API is called by an application, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) must be called.</span></span> <span data-ttu-id="0e01c-126">Questa funzione Inizializza l'infrastruttura di raggruppamento peer per l'applicazione e imposta la versione supportata.</span><span class="sxs-lookup"><span data-stu-id="0e01c-126">This function initializes the Peer Grouping Infrastructure for the application and sets the supported version.</span></span>

## <a name="obtaining-a-group-handle"></a><span data-ttu-id="0e01c-127">Ottenere un handle di gruppo</span><span class="sxs-lookup"><span data-stu-id="0e01c-127">Obtaining a Group Handle</span></span>

<span data-ttu-id="0e01c-128">Per connettersi a un gruppo e iniziare a partecipare, è necessario ottenere un handle per un gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-128">To connect to a group and begin participating, a handle to a peer group must be obtained.</span></span> <span data-ttu-id="0e01c-129">Nell'elenco seguente vengono identificati i tre modi per connettersi a un gruppo peer:</span><span class="sxs-lookup"><span data-stu-id="0e01c-129">The following list identifies the three ways to connect to a peer group:</span></span>

-   <span data-ttu-id="0e01c-130">Creazione di un gruppo peer chiamando [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), che Inizializza un nuovo gruppo peer e restituisce un handle valido con il peer come proprietario e amministratore esclusivo.</span><span class="sxs-lookup"><span data-stu-id="0e01c-130">Creating a peer group by calling [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), which initializes a new peer group and returns a valid handle with the peer as the owner and sole administrator.</span></span>
-   <span data-ttu-id="0e01c-131">Unione di un gruppo peer chiamando [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span><span class="sxs-lookup"><span data-stu-id="0e01c-131">Joining a peer group by calling [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span></span> <span data-ttu-id="0e01c-132">Per partecipare a un gruppo peer, un peer deve ricevere un invito da un amministratore del gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-132">To join a peer group, a peer must receive an invitation from a peer group administrator.</span></span> <span data-ttu-id="0e01c-133">Per ottenere un invito, inviare il BLOB XML delle informazioni di identità all'amministratore che crea un invito e lo invia all'utente tramite un meccanismo esterno, ad esempio posta elettronica o FTP.</span><span class="sxs-lookup"><span data-stu-id="0e01c-133">To obtain an invitation, send the identity information XML blob to the administrator who creates an invitation and sends it to you by an external mechanism, such as email or FTP.</span></span> <span data-ttu-id="0e01c-134">L'invito e l'identità del peer vengono passati a **PeerGroupJoin**, che restituisce un handle valido al gruppo.</span><span class="sxs-lookup"><span data-stu-id="0e01c-134">The invitation and peer identity are passed to **PeerGroupJoin**, which returns a valid handle to the group.</span></span>
-   <span data-ttu-id="0e01c-135">Apertura di un gruppo peer a cui è stato aggiunto un peer precedentemente chiamando [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span><span class="sxs-lookup"><span data-stu-id="0e01c-135">Opening a peer group that a peer has joined previously by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span></span> <span data-ttu-id="0e01c-136">In questa situazione, non è necessario ottenere un invito.</span><span class="sxs-lookup"><span data-stu-id="0e01c-136">In this situation, obtaining an invitation is not necessary.</span></span>

<span data-ttu-id="0e01c-137">Dopo aver ottenuto un handle di gruppo peer valido da una delle funzioni sopra riportate, è possibile connettersi a un gruppo peer chiamando [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) con il nuovo handle.</span><span class="sxs-lookup"><span data-stu-id="0e01c-137">After you obtain a valid peer group handle from one of the above functions, you can connect to a peer group by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) with the new handle.</span></span>

> [!Note]  
> <span data-ttu-id="0e01c-138">Se la connessione a un gruppo peer ha esito negativo \_ , \_ si verifica l'evento di connessione all'evento di gruppo peer \_ \_ non riuscita.</span><span class="sxs-lookup"><span data-stu-id="0e01c-138">If the connection to a peer group fails, the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event occurs.</span></span> <span data-ttu-id="0e01c-139">Il gestore può tentare di ristabilire la connessione al gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-139">The handler can attempt to reestablish the connection to the peer group.</span></span>

 

## <a name="registering-for-peer-grouping-events"></a><span data-ttu-id="0e01c-140">Registrazione per eventi di raggruppamento peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-140">Registering for Peer Grouping Events</span></span>

<span data-ttu-id="0e01c-141">Prima che un peer partecipi a un gruppo peer, è necessario che il peer si registri per gli eventi del gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-141">Before a peer participates in a peer group, the peer must register for peer group events.</span></span> <span data-ttu-id="0e01c-142">Per eseguire la registrazione per eventi peer specifici, chiamare [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)e passare uno o più tipi di evento peer definiti nel tipo di \_ evento del gruppo peer \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-142">To register for specific peer events, call [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent), and pass in one or more of the peer event types defined in PEER\_GROUP\_EVENT\_TYPE.</span></span> <span data-ttu-id="0e01c-143">È necessario registrarsi per ogni evento peer applicabile all'applicazione; per ricevere i dati tramite una connessione diretta, ad esempio, effettuare la registrazione per gli eventi di connessione diretta degli eventi del \_ gruppo peer \_ \_ \_ e \_ dei gruppi peer \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-143">You must register for each peer event that applies to your application; for example, to receive data over a direct connection, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION and PEER\_GROUP\_EVENT\_INCOMING\_DATA events.</span></span> <span data-ttu-id="0e01c-144">Ogni chiamata accetta un handle di evento e restituisce un handle **HPEEREVENT** per l'evento peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-144">Each call takes an event handle and returns an **HPEEREVENT** handle for that peer event.</span></span>

<span data-ttu-id="0e01c-145">I gestori eventi possono ottenere i dati associati a un evento peer passando l'handle agli eventi peer registrati a [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="0e01c-145">Event handlers can obtain the data associated with a peer event by passing the handle to registered peer events to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="0e01c-146">Questi dati dell'evento peer vengono restituiti come \_ Unione di dati degli eventi del gruppo peer \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-146">This peer event data is returned as a PEER\_GROUP\_EVENT\_DATA union.</span></span> <span data-ttu-id="0e01c-147">Se la coda degli eventi peer è vuota, questa funzione restituisce il PEER \_ S \_ senza \_ dati dell'evento \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-147">If the peer event queue is empty, this function returns PEER\_S\_NO\_EVENT\_DATA.</span></span>

<span data-ttu-id="0e01c-148">È possibile annullare la registrazione per gli eventi del peer chiamando [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) e specificando l'handle per l'evento peer di cui si vuole annullare la registrazione.</span><span class="sxs-lookup"><span data-stu-id="0e01c-148">You can unregister for peer events by calling [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) and providing the handle for the peer event you want to unregister.</span></span> <span data-ttu-id="0e01c-149">Dopo la chiamata della funzione, gli eventi peer associati all'handle non vengono più registrati.</span><span class="sxs-lookup"><span data-stu-id="0e01c-149">After the function is called, the peer events associated with the handle are no longer registered.</span></span>

## <a name="creating-administrator-and-member-roles"></a><span data-ttu-id="0e01c-150">Creazione di ruoli amministratore e membro</span><span class="sxs-lookup"><span data-stu-id="0e01c-150">Creating Administrator and Member Roles</span></span>

<span data-ttu-id="0e01c-151">Il peer che crea il gruppo peer è noto come autore del gruppo peer e ha il ruolo di amministratore per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0e01c-151">The peer who creates the peer group is known as the peer group creator, and has the administrator role by default.</span></span> <span data-ttu-id="0e01c-152">Solo l'autore del gruppo peer può impostare le proprietà del gruppo.</span><span class="sxs-lookup"><span data-stu-id="0e01c-152">Only the peer group creator can set the group properties.</span></span>

<span data-ttu-id="0e01c-153">I peer invitati al gruppo peer possono essere un amministratore o un membro.</span><span class="sxs-lookup"><span data-stu-id="0e01c-153">Peers invited to the peer group can be either an administrator or a member.</span></span> <span data-ttu-id="0e01c-154">Se viene assegnato un ruolo di amministratore dall'amministratore che emette l'invito, può invitare nuovi membri al gruppo peer e assegnare allo stesso modo il ruolo di amministratore ad altri membri.</span><span class="sxs-lookup"><span data-stu-id="0e01c-154">If they are assigned an administrator role by the administrator issuing the invitation, they can invite new members to the peer group, and likewise assign the administrator role to other members.</span></span>

<span data-ttu-id="0e01c-155">I ruoli dei membri del gruppo peer sono impostati negli inviti che l'amministratore assegna a un membro.</span><span class="sxs-lookup"><span data-stu-id="0e01c-155">The roles of peer group members are set in the invitations the administrator gives to a member.</span></span> <span data-ttu-id="0e01c-156">Per aggiungere altri amministratori, impostare il valore del parametro *proletari* di [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) su amministratore del \_ ruolo del gruppo peer \_ quando si \_ Crea un invito.</span><span class="sxs-lookup"><span data-stu-id="0e01c-156">To add more administrators, set the value of the *pRoles* parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_ADMIN when creating an invitation.</span></span>

<span data-ttu-id="0e01c-157">I membri possono partecipare a un gruppo peer, ma non possono invitare e autorizzare nuovi membri, impostare proprietà dei gruppi o aggiornare o eliminare i record di gruppo che non vengono creati in modo specifico.</span><span class="sxs-lookup"><span data-stu-id="0e01c-157">Members can participate in a peer group, but cannot invite and authorize new members, set group properties, or update or delete group records that they do not specifically create.</span></span> <span data-ttu-id="0e01c-158">Per assegnare lo stato dei membri a un peer partecipante, impostare il valore del parametro **proletari** di [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) su \_ membro del ruolo del gruppo peer \_ \_ quando si crea un invito per quel peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-158">To assign member status to a participating peer, set the value of the **pRoles** parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_MEMBER when you create an invitation for that peer.</span></span>

<span data-ttu-id="0e01c-159">Per modificare il ruolo di un membro, è necessario che le nuove credenziali contenenti il nuovo ruolo vengano rilasciate a tale membro.</span><span class="sxs-lookup"><span data-stu-id="0e01c-159">To change the role of a member, new credentials containing the new role must be issued to that member.</span></span> <span data-ttu-id="0e01c-160">A tale scopo, ottenere la struttura delle [**\_ \_ informazioni sulle credenziali peer**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) per questo membro dalla \_ struttura del membro peer restituita da [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span><span class="sxs-lookup"><span data-stu-id="0e01c-160">To accomplish this, obtain the [**PEER\_CREDENTIAL\_INFO**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) structure for this member from the PEER\_MEMBER structure returned by [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span></span> <span data-ttu-id="0e01c-161">Modificare il campo **proletari** nelle **\_ \_ informazioni sulle credenziali peer** nel nuovo ruolo e passare la struttura a [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span><span class="sxs-lookup"><span data-stu-id="0e01c-161">Change the **pRoles** field in **PEER\_CREDENTIAL\_INFO** to the new role, and pass the structure to [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span></span>

<span data-ttu-id="0e01c-162">Le nuove credenziali non verranno applicate al peer fino a quando non si connetteranno al gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-162">The new credentials will not go into effect for the peer until they connect to the peer group.</span></span> <span data-ttu-id="0e01c-163">Se sono attualmente connesse, è necessario chiudere il gruppo e riconnettersi per ottenere le credenziali aggiornate.</span><span class="sxs-lookup"><span data-stu-id="0e01c-163">If they are currently connected, they must close the group and reconnect to obtain the updated credentials.</span></span>

## <a name="finding-a-peer"></a><span data-ttu-id="0e01c-164">Ricerca di un peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-164">Finding a Peer</span></span>

<span data-ttu-id="0e01c-165">Per ottenere un elenco enumerato di tutti i peer che partecipano al gruppo peer, chiamare [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) con l'handle di gruppo, che restituisce un handle per l'enumerazione.</span><span class="sxs-lookup"><span data-stu-id="0e01c-165">To obtain an enumerated list of all peers participating in the peer group, call [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) with the group handle, which returns a handle to the enumeration.</span></span> <span data-ttu-id="0e01c-166">Per ottenere i membri, chiamare [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) con l'handle enum e il numero di membri da recuperare.</span><span class="sxs-lookup"><span data-stu-id="0e01c-166">To obtain the members, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enum handle and the number of members to retrieve.</span></span> <span data-ttu-id="0e01c-167">Continuare a chiamare **PeerGetNextItem** fino a quando il parametro *pcount* non restituisce un valore inferiore al numero di membri richiesti.</span><span class="sxs-lookup"><span data-stu-id="0e01c-167">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of members requested.</span></span> <span data-ttu-id="0e01c-168">Si noti che non è possibile restituire l'elenco completo dei membri disponibili.</span><span class="sxs-lookup"><span data-stu-id="0e01c-168">Note that the complete list of available members may not be returned.</span></span>

<span data-ttu-id="0e01c-169">Ogni membro è rappresentato come struttura [**del \_ membro peer**](/windows/desktop/api/P2P/ns-p2p-peer_member) , che contiene l'identità del peer, gli ID del nodo e gli indirizzi IP per i peer attivi.</span><span class="sxs-lookup"><span data-stu-id="0e01c-169">Each member is represented as a [**PEER\_MEMBER**](/windows/desktop/api/P2P/ns-p2p-peer_member) structure, which contains the identity of the peer, node IDs, and IP addresses for active peers.</span></span>

<span data-ttu-id="0e01c-170">Al termine, chiudere l'enumerazione e rilasciare la memoria associata chiamando [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="0e01c-170">When finished, close the enumeration and release the associated memory by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

## <a name="connecting-directly-to-a-peer"></a><span data-ttu-id="0e01c-171">Connessione diretta a un peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-171">Connecting Directly to a Peer</span></span>

<span data-ttu-id="0e01c-172">Quando un peer è connesso a un gruppo peer, vengono avviati scambi diretti uno-a-uno con altri membri connessi chiamando [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) e specificando l'identità dell'altro peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-172">When a peer is connected to a peer group, direct one-to-one exchanges with other connected members are initiated by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) and supplying the identity of the other peer.</span></span> <span data-ttu-id="0e01c-173">Questa chiamata è asincrona e restituisce un ID di connessione a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="0e01c-173">This call is asynchronous, and returns a 64-bit connection ID.</span></span> <span data-ttu-id="0e01c-174">Se la chiamata ha esito positivo, si riceve l'evento \_ \_ \_ \_ peer di evento peer di connessione diretta evento \_ per indicare che la connessione ha avuto esito positivo.</span><span class="sxs-lookup"><span data-stu-id="0e01c-174">If the call is successful, you receive the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION\_EVENT peer event to indicate that the connection is successful.</span></span> <span data-ttu-id="0e01c-175">Se la connessione ha esito positivo, l'ID connessione è valido e può essere utilizzato per inviare e ricevere dati tramite la connessione diretta.</span><span class="sxs-lookup"><span data-stu-id="0e01c-175">If the connection is successful, the connection ID is valid and can be used to send and receive data through the direct connection.</span></span>

<span data-ttu-id="0e01c-176">Per essere in grado di ricevere connessioni dirette, è necessario che anche l'altro peer sia stato registrato in precedenza per l' \_ \_ \_ evento peer di connessione diretta all'evento del gruppo peer \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-176">To be able to receive direct connections, the other peer must also have previously registered for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION peer event.</span></span>

<span data-ttu-id="0e01c-177">Per inviare dati a un peer, chiamare [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) con un ID connessione valido.</span><span class="sxs-lookup"><span data-stu-id="0e01c-177">To send data to a peer, call [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) with a valid connection ID.</span></span> <span data-ttu-id="0e01c-178">Per ricevere i dati, l'altro peer deve essere registrato per l' \_ \_ \_ \_ evento peer dei dati in ingresso dell'evento di gruppo peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-178">To receive data, the other peer must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span> <span data-ttu-id="0e01c-179">Analogamente, se il peer di invio desidera ricevere i dati a sua volta, è necessario registrarlo anche per l' \_ \_ \_ evento peer di dati in ingresso dell'evento di gruppo peer \_ .</span><span class="sxs-lookup"><span data-stu-id="0e01c-179">Likewise, if the sending peer wants to receive data in turn, it also must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span>

<span data-ttu-id="0e01c-180">Per ricevere il set totale di connessioni dirette attualmente attive con altri peer in un gruppo, chiamare [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) per aprire l'enumerazione e scorrere l'elenco delle connessioni usando [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span><span class="sxs-lookup"><span data-stu-id="0e01c-180">To receive the total set of currently active direct connections with other peers in a group, call [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) to open the enumeration and iterate through the list of connections by using [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span></span>

<span data-ttu-id="0e01c-181">Per chiudere una connessione diretta, chiamare [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) e passare l'ID connessione.</span><span class="sxs-lookup"><span data-stu-id="0e01c-181">To close a direct connection, call [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and pass in the connection ID.</span></span>

## <a name="closing-and-shutting-down-a-peer-group"></a><span data-ttu-id="0e01c-182">Chiusura e arresto di un gruppo peer</span><span class="sxs-lookup"><span data-stu-id="0e01c-182">Closing and Shutting Down a Peer Group</span></span>

<span data-ttu-id="0e01c-183">Per chiudere una connessione a un gruppo peer, chiamare [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), che invalida l'handle di gruppo, ma non arresta l'infrastruttura di raggruppamento peer.</span><span class="sxs-lookup"><span data-stu-id="0e01c-183">To close a connection to a peer group, call [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), which invalidates the group handle, but does not shut down the Peer Grouping Infrastructure.</span></span> <span data-ttu-id="0e01c-184">I dati del gruppo peer-to-peer vengono eliminati chiamando [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span><span class="sxs-lookup"><span data-stu-id="0e01c-184">Peer-to-peer group data is deleted by calling [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span></span>

<span data-ttu-id="0e01c-185">Quando l'applicazione ha terminato l'utilizzo dell'infrastruttura di raggruppamento dei peer, deve chiamare [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span><span class="sxs-lookup"><span data-stu-id="0e01c-185">When the application is finished using the Peer Grouping Infrastructure, it must call [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span></span>

 

 



