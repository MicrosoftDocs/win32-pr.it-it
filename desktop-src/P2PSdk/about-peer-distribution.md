---
description: L'API di distribuzione peer, che supporta la funzionalità Branch Cache in Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, offre un set di API della piattaforma che possono aumentare la velocità di risposta di rete delle applicazioni centralizzate quando si accede da uffici remoti e consentono di ridurre l'utilizzo complessivo della rete WAN (Wide Area Network) senza interferire con le tecnologie di sicurezza di rete.
ms.assetid: feb9666e-563a-49f4-ad1c-f166a0faff31
title: Informazioni sulla distribuzione peer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c996aed35ac691284ba61b757d6ff5a88033aad
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/30/2021
ms.locfileid: "113120436"
---
# <a name="about-peer-distribution"></a><span data-ttu-id="b20ab-103">Informazioni sulla distribuzione peer</span><span class="sxs-lookup"><span data-stu-id="b20ab-103">About Peer Distribution</span></span>

<span data-ttu-id="b20ab-104">L'API di distribuzione peer, che supporta la funzionalità Branch Cache in Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, offre un set di API della piattaforma che possono aumentare la velocità di risposta di rete delle applicazioni centralizzate quando si accede da uffici remoti e consentono di ridurre l'utilizzo complessivo della rete WAN (Wide Area Network) senza interferire con le tecnologie di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="b20ab-104">The Peer Distribution API, which supports the Branch Cache feature in Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 offers a set of platform APIs that can increase network responsiveness of centralized applications when accessed from remote offices and aid in reducing overall wide area network (WAN) utilization without interfering with the network security technologies.</span></span>

<span data-ttu-id="b20ab-105">Il sistema di distribuzione peer offre un set di API della piattaforma utilizzate dagli editori che forniscono contenuti digitali e consumer che lo richiedono.</span><span class="sxs-lookup"><span data-stu-id="b20ab-105">The Peer Distribution system offers a set of platform APIs utilized by both the publishers that provide digital content and consumers that request it.</span></span> <span data-ttu-id="b20ab-106">Per distinguere facilmente questi ruoli, può essere più semplice pensare all'autore in un ruolo del server e al consumer in un ruolo client.</span><span class="sxs-lookup"><span data-stu-id="b20ab-106">To easily differentiate these roles, it may be easier to think of the publisher in a server role and the consumer in a client role.</span></span> <span data-ttu-id="b20ab-107">A parte questo, è importante ricordare che, a parte questi ruoli concettuali, il servizio di distribuzione peer è un vero e proprio sistema peer, come indicato dalla possibilità per qualsiasi nodo di distribuzione peer di pubblicare e utilizzare contenuto digitale.</span><span class="sxs-lookup"><span data-stu-id="b20ab-107">That aside, it is important to remember that aside from these conceptual roles, the Peer Distribution service is a true peer system, as indicated by the ability for any Peer Distribution node to both publish and consume digital content.</span></span> <span data-ttu-id="b20ab-108">Le API della piattaforma di distribuzione peer vengono esposte agli editori e ai consumer da una libreria di importazione Win32 (**PeerDist.Lib**).</span><span class="sxs-lookup"><span data-stu-id="b20ab-108">The Peer Distribution platform APIs are exposed to publishers and consumers by a Win32 import library (**PeerDist.Lib**).</span></span>

<span data-ttu-id="b20ab-109">Il ciclo di vita del contenuto fornito da un editore e recuperato da un consumer con il servizio di distribuzione peer è costituito dalle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b20ab-109">The lifecycle of content supplied by a publisher and retrieved by a consumer with the Peer Distribution service is composed of the following operations:</span></span>



|                         | <span data-ttu-id="b20ab-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="b20ab-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b20ab-111">**Pubblicazione del contenuto**</span><span class="sxs-lookup"><span data-stu-id="b20ab-111">**Content Publication**</span></span> | <span data-ttu-id="b20ab-112">La pubblicazione viene eseguita per produrre una descrizione del contenuto, in breve Informazioni sul **contenuto** o **Informazioni** sul contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-112">Publishing is done to produce a description of content termed **Content Information**, or **Content Info** for short.</span></span> <span data-ttu-id="b20ab-113">Queste informazioni sul contenuto possono quindi essere usate da un'istanza del servizio di distribuzione peer per autenticare e ricompilare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-113">This Content Info can then be used by an instance of the Peer Distribution service to authenticate and rebuild the content.</span></span> <span data-ttu-id="b20ab-114">Quando il contenuto viene pubblicato da un'applicazione nel servizio di distribuzione peer, che concettualmente è un'operazione sul lato server, tale contenuto viene associato all'identità del server di pubblicazione, che si basa sul SID dell'utente associato al token di accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="b20ab-114">When content is published by an application into the Peer Distribution service, which is conceptually a server-side operation, that content becomes associated with the Publisher Identity, which is based on the SID of the user associated with the thread access token.</span></span> <span data-ttu-id="b20ab-115">Questa associazione viene eseguita per limitare l'accesso al contenuto da parte di entità non autorizzate.</span><span class="sxs-lookup"><span data-stu-id="b20ab-115">This binding is done to limit access to content by unauthorized entities.</span></span> <span data-ttu-id="b20ab-116">È tuttavia importante notare che l'accesso alle informazioni sul contenuto equivale all'accesso al contenuto stesso, perché le informazioni sul contenuto possono essere usate per ottenere il contenuto dai peer o da una cache ospitata.</span><span class="sxs-lookup"><span data-stu-id="b20ab-116">However, it is important to note that access to the content information is equivalent to access to the content itself, as the content information can be used to obtain the content from peers or a hosted cache.</span></span><br/> <span data-ttu-id="b20ab-117">È disponibile una nuova versione della struttura dei dati delle informazioni sul contenuto in Windows 8; Tuttavia, la versione precedente è ancora supportata.</span><span class="sxs-lookup"><span data-stu-id="b20ab-117">There is a new version of the content information data structure in Windows 8; however, the previous version is still supported.</span></span> <span data-ttu-id="b20ab-118">Per interagire con i client Windows 7, un amministratore può configurare il servizio di distribuzione peer per l'uso della versione precedente della struttura dei dati di informazioni sul contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-118">To interoperate with Windows 7 clients, an administrator may configure the Peer Distribution service to use the previous version of the content information data structure.</span></span><br/> |
| <span data-ttu-id="b20ab-119">**Recupero del contenuto**</span><span class="sxs-lookup"><span data-stu-id="b20ab-119">**Content Retrieval**</span></span>   | <span data-ttu-id="b20ab-120">Perché un consumer recupeni contenuto dal servizio di distribuzione peer, è necessario fornire l'accesso alle informazioni sul contenuto pubblicate associate a tale contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-120">For a consumer to retrieve content from the Peer Distribution service, access must be provided to the published Content Info associated with that content.</span></span> <span data-ttu-id="b20ab-121">Il servizio di distribuzione peer usato per pubblicare il contenuto può fornire le informazioni sul contenuto associate.</span><span class="sxs-lookup"><span data-stu-id="b20ab-121">The Peer Distribution service used to publish the content can provide the associated Content Info.</span></span> <span data-ttu-id="b20ab-122">Quando il consumer ha le informazioni sul contenuto, è possibile usare altre API di distribuzione peer per richiedere il contenuto dal servizio di distribuzione peer.</span><span class="sxs-lookup"><span data-stu-id="b20ab-122">Once the consumer has the Content Info, other Peer Distribution APIs can be used to request content from the Peer Distribution service.</span></span> <span data-ttu-id="b20ab-123">Il servizio di distribuzione peer tenterà di recuperare il contenuto dalla rete locale.</span><span class="sxs-lookup"><span data-stu-id="b20ab-123">The Peer Distribution service will attempt to retrieve the content from the local network.</span></span> <span data-ttu-id="b20ab-124">Se il contenuto non è disponibile, l'applicazione client è responsabile del recupero del contenuto dal server di origine.</span><span class="sxs-lookup"><span data-stu-id="b20ab-124">If the content is not available, the client application is responsible for retrieving the content from the source server.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b20ab-125">**Rimozione della pubblicazione**</span><span class="sxs-lookup"><span data-stu-id="b20ab-125">**Publication Removal**</span></span> | <span data-ttu-id="b20ab-126">Per le applicazioni che hanno pubblicato contenuto nel servizio di distribuzione peer, è stata fornita la funzione [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) per consentire l'annullamento della pubblicazione del contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-126">For applications that have published content into the Peer Distribution service, the [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) function has been provided to allow content to be unpublished.</span></span> <span data-ttu-id="b20ab-127">Dopo l'annullamento della pubblicazione del contenuto, il servizio di distribuzione peer locale non fornirà più le informazioni sul contenuto associate a tale contenuto.</span><span class="sxs-lookup"><span data-stu-id="b20ab-127">Once content has been unpublished, the local Peer Distribution service will no longer provide the content info associated with that content.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="asynchronous-completions"></a><span data-ttu-id="b20ab-128">Completamenti asincroni</span><span class="sxs-lookup"><span data-stu-id="b20ab-128">Asynchronous Completions</span></span>

<span data-ttu-id="b20ab-129">L'API di distribuzione peer supporta un modello API asincrono e di conseguenza le API di distribuzione peer consentono l'uso di porte di completamento I/O o eventi come meccanismi di segnalazione per l'elaborazione dei completamenti asincroni delle operazioni di distribuzione peer.</span><span class="sxs-lookup"><span data-stu-id="b20ab-129">The Peer Distribution API supports an asynchronous API model, and as a result Peer Distribution APIs allow for the use of either I/O Completion Ports or Events as the signaling mechanisms for processing asynchronous Peer Distribution operation completions.</span></span> <span data-ttu-id="b20ab-130">Per entrambi i meccanismi, la distribuzione peer usa una [**struttura OVERLAPPED.**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped)</span><span class="sxs-lookup"><span data-stu-id="b20ab-130">For either mechanism, Peer Distribution uses an [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure.</span></span> <span data-ttu-id="b20ab-131">In generale, la distribuzione peer assume la proprietà di una struttura **OVERLAPPED** ed eventuali parametri out passati dal client alle funzioni API asincrone.</span><span class="sxs-lookup"><span data-stu-id="b20ab-131">In general, Peer Distribution takes the ownership of an **OVERLAPPED** structure and any out parameters that the Client passes to asynchronous API functions.</span></span> <span data-ttu-id="b20ab-132">Il client non deve accedere a queste risorse fino al completamento della funzione asincrona specifica.</span><span class="sxs-lookup"><span data-stu-id="b20ab-132">The Client must not access these resources until the particular asynchronous function completes.</span></span> <span data-ttu-id="b20ab-133">Non appena le funzioni asincrone vengono completate, il servizio di distribuzione peer non richiederà più l'accesso a queste risorse e potrebbe essere riutilizzato in base alle esigenze dell'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="b20ab-133">As soon as the asynchronous functions completes, the Peer Distribution service will no longer require access to these resources and they may be reused as the calling application sees fit.</span></span>

<span data-ttu-id="b20ab-134">Non sarà presente alcun completamento asincrono se la funzione restituisce codice di errore diverso da **ERROR \_ IO \_ PENDING.**</span><span class="sxs-lookup"><span data-stu-id="b20ab-134">There will not be any asynchronous completion if the function returns any error code other than **ERROR\_IO\_PENDING**.</span></span> <span data-ttu-id="b20ab-135">La restituzione di un valore diverso da **ERROR \_ IO \_ PENDING** indica che la chiamata non è riuscita in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="b20ab-135">The return of a value other than **ERROR\_IO\_PENDING** means that the call has failed synchronously.</span></span> <span data-ttu-id="b20ab-136">Se l'API di distribuzione peer restituisce **ERROR \_ IO \_ PENDING**, il chiamante deve attendere il completamento asincrono.</span><span class="sxs-lookup"><span data-stu-id="b20ab-136">If the Peer Distribution API returns **ERROR\_IO\_PENDING**, the caller must wait for asynchronous completion.</span></span>

<span data-ttu-id="b20ab-137">Il codice di errore del completamento asincrono può essere recuperato in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="b20ab-137">The error code of the asynchronous completion can be retrieved in one of two ways:</span></span>

<span data-ttu-id="b20ab-138">**Completamento basato sulla porta di completamento I/O**</span><span class="sxs-lookup"><span data-stu-id="b20ab-138">**I/O Completion Port Based Completion**</span></span>

<span data-ttu-id="b20ab-139">L'utente richiama il meccanismo di porta di completamento I/O fornendo un handle di porta di completamento e una chiave di completamento alle funzioni API seguenti:</span><span class="sxs-lookup"><span data-stu-id="b20ab-139">User invokes the I/O completion port mechanism by providing a completion port handle and completion key to the following API functions:</span></span>

<dl>

[<span data-ttu-id="b20ab-140">**PeerDistRegisterForStatusChangeNotification**</span><span class="sxs-lookup"><span data-stu-id="b20ab-140">**PeerDistRegisterForStatusChangeNotification**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistregisterforstatuschangenotification)  
[<span data-ttu-id="b20ab-141">**PeerDistServerPublishStream**</span><span class="sxs-lookup"><span data-stu-id="b20ab-141">**PeerDistServerPublishStream**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverpublishstream)  
[<span data-ttu-id="b20ab-142">**PeerDistServerOpenContentInformation**</span><span class="sxs-lookup"><span data-stu-id="b20ab-142">**PeerDistServerOpenContentInformation**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserveropencontentinformation)  
[<span data-ttu-id="b20ab-143">**PeerDistClientOpenContent**</span><span class="sxs-lookup"><span data-stu-id="b20ab-143">**PeerDistClientOpenContent**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistclientopencontent)  
</dl>

<span data-ttu-id="b20ab-144">L'utente crea una porta di completamento chiamando [**CreateIoCompletionPort.**](/windows/desktop/FileIO/createiocompletionport)</span><span class="sxs-lookup"><span data-stu-id="b20ab-144">The User creates a completion port by calling [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span></span> <span data-ttu-id="b20ab-145">Questo handle di porta di completamento può essere usato contemporaneamente per altre operazioni di I/O asincrone e per operazioni specifiche della distribuzione peer.</span><span class="sxs-lookup"><span data-stu-id="b20ab-145">This completion port handle can be simultaneously used for other asynchronous I/O operations as well as Peer Distribution specific operations.</span></span>

<span data-ttu-id="b20ab-146">Il chiamante deve usare [**la funzione GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) per gestire il completamento asincrono.</span><span class="sxs-lookup"><span data-stu-id="b20ab-146">The caller should use [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to manage asynchronous completion.</span></span> <span data-ttu-id="b20ab-147">Se l'operazione asincrona non riesce, la funzione **GetQueuedCompletionStatus** restituirà **FALSE** e [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) restituirà il codice di errore appropriato.</span><span class="sxs-lookup"><span data-stu-id="b20ab-147">If the asynchronous operation fails the **GetQueuedCompletionStatus** function will return **FALSE** and [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) will return the appropriate error code.</span></span> <span data-ttu-id="b20ab-148">Il chiamante deve ignorare tutti i campi della struttura [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) se il codice di errore è diverso da **ERROR \_ SUCCESS.**</span><span class="sxs-lookup"><span data-stu-id="b20ab-148">The caller should ignore all the fields of the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="b20ab-149">L'operazione asincrona ha esito positivo **se la funzione GetQueuedCompletionStatus** restituisce **TRUE.**</span><span class="sxs-lookup"><span data-stu-id="b20ab-149">The asynchronous operation succeeds if the **GetQueuedCompletionStatus** function returns **TRUE**.</span></span>

<span data-ttu-id="b20ab-150">Per altre informazioni, vedere [Porte di completamento I/O.](/windows/desktop/FileIO/i-o-completion-ports)</span><span class="sxs-lookup"><span data-stu-id="b20ab-150">For more information see [I/O Completion Ports](/windows/desktop/FileIO/i-o-completion-ports).</span></span>

<span data-ttu-id="b20ab-151">**Completamento basato su eventi**</span><span class="sxs-lookup"><span data-stu-id="b20ab-151">**Event Based Completion**</span></span>

<span data-ttu-id="b20ab-152">Se il chiamante imposta un handle di evento valido per il campo *hEvent* della struttura [**OVERLAPPED,**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) la distribuzione peer lo usa per segnalare che l'operazione di I/O asincrona associata è stata completata.</span><span class="sxs-lookup"><span data-stu-id="b20ab-152">If the caller sets a valid Event handle to the *hEvent* field of [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure, Peer Distribution uses it to signal that the associated asynchronous I/O operation has completed.</span></span>

<span data-ttu-id="b20ab-153">Un chiamante del thread può gestire le operazioni sovrapposte specificando un handle per l'oggetto evento di reimpostazione manuale della struttura [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) in una delle funzioni di attesa.</span><span class="sxs-lookup"><span data-stu-id="b20ab-153">A thread caller can manage overlapped operations by specifying a handle to the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure's manual-reset event object in one of the wait functions.</span></span> <span data-ttu-id="b20ab-154">Dopo la segnalazione dell'evento, il chiamante deve [**chiamare PeerGetOverlappedResult passando**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) la struttura **OVERLAPPED** appropriata.</span><span class="sxs-lookup"><span data-stu-id="b20ab-154">After the Event is signaled the caller must call [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passing in the appropriate **OVERLAPPED** structure.</span></span> <span data-ttu-id="b20ab-155">**PeerGetOverlappedResult** restituirà **FALSE** e il chiamante deve chiamare [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) per recuperare il codice di errore.</span><span class="sxs-lookup"><span data-stu-id="b20ab-155">**PeerGetOverlappedResult** will return **FALSE** and the caller must call [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) in order to retrieve the error code.</span></span> <span data-ttu-id="b20ab-156">Il chiamante deve ignorare tutti i campi della struttura **OVERLAPPED** se il codice di errore è diverso **da ERROR \_ SUCCESS.**</span><span class="sxs-lookup"><span data-stu-id="b20ab-156">The caller should ignore all the fields of the **OVERLAPPED** structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="b20ab-157">L'operazione asincrona ha esito positivo se la **funzione PeerGetOverlappedResult** restituisce **TRUE.**</span><span class="sxs-lookup"><span data-stu-id="b20ab-157">The asynchronous operation succeeds if the **PeerGetOverlappedResult** function returns **TRUE**.</span></span>

<span data-ttu-id="b20ab-158">Se il chiamante fornisce una porta di completamento insieme a un evento, l'evento verrà usato come meccanismo di completamento.</span><span class="sxs-lookup"><span data-stu-id="b20ab-158">If the caller provides a completion port along with an event, the event will be used as the completion mechanism.</span></span>

<span data-ttu-id="b20ab-159">**Windows 7:** Usare la [**funzione GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) anziché [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span><span class="sxs-lookup"><span data-stu-id="b20ab-159">**Windows 7:** Use the [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) function instead of [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b20ab-160">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b20ab-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b20ab-161">Informazioni di riferimento sulle API di distribuzione peer</span><span class="sxs-lookup"><span data-stu-id="b20ab-161">Peer Distribution API Reference</span></span>](peer-distribution-api-reference.md)
</dt> </dl>

 

