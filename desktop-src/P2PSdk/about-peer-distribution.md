---
description: L'API di distribuzione peer, che supporta la funzionalità cache di Branch in Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, offre un set di API della piattaforma che può aumentare la velocità di risposta della rete delle applicazioni centralizzate quando si accede da uffici remoti e contribuire a ridurre l'utilizzo di Wide Area Network (WAN) globale senza interferire con le tecnologie di sicurezza di rete
ms.assetid: feb9666e-563a-49f4-ad1c-f166a0faff31
title: Informazioni sulla distribuzione peer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b5b9a99a65ea2cfda6dc8ad9accd4d881529e87
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103881825"
---
# <a name="about-peer-distribution"></a><span data-ttu-id="4c62c-103">Informazioni sulla distribuzione peer</span><span class="sxs-lookup"><span data-stu-id="4c62c-103">About Peer Distribution</span></span>

<span data-ttu-id="4c62c-104">L'API di distribuzione peer, che supporta la funzionalità cache di Branch in Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, offre un set di API della piattaforma che può aumentare la velocità di risposta della rete delle applicazioni centralizzate quando si accede da uffici remoti e contribuire a ridurre l'utilizzo di Wide Area Network (WAN) globale senza interferire con le tecnologie di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="4c62c-104">The Peer Distribution API, which supports the Branch Cache feature in Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 offers a set of platform APIs that can increase network responsiveness of centralized applications when accessed from remote offices and aid in reducing overall wide area network (WAN) utilization without interfering with the network security technologies.</span></span>

<span data-ttu-id="4c62c-105">Il sistema di distribuzione peer offre un set di API della piattaforma usate dagli editori che forniscono contenuti digitali e consumer che lo richiedono.</span><span class="sxs-lookup"><span data-stu-id="4c62c-105">The Peer Distribution system offers a set of platform APIs utilized by both the publishers that provide digital content and consumers that request it.</span></span> <span data-ttu-id="4c62c-106">Per distinguere facilmente questi ruoli, potrebbe essere più facile pensare al server di pubblicazione in un ruolo del server e al consumer in un ruolo client.</span><span class="sxs-lookup"><span data-stu-id="4c62c-106">To easily differentiate these roles, it may be easier to think of the publisher in a server role and the consumer in a client role.</span></span> <span data-ttu-id="4c62c-107">A parte questo, è importante ricordare che, a parte questi ruoli concettuali, il servizio di distribuzione peer è un vero e proprio sistema peer, come indicato dalla possibilità per qualsiasi nodo di distribuzione peer di pubblicare e utilizzare contenuti digitali.</span><span class="sxs-lookup"><span data-stu-id="4c62c-107">That aside, it is important to remember that aside from these conceptual roles, the Peer Distribution service is a true peer system, as indicated by the ability for any Peer Distribution node to both publish and consume digital content.</span></span> <span data-ttu-id="4c62c-108">Le API della piattaforma di distribuzione peer sono esposte a autori e consumer da una libreria di importazione Win32 (**PeerDist. lib**).</span><span class="sxs-lookup"><span data-stu-id="4c62c-108">The Peer Distribution platform APIs are exposed to publishers and consumers by a Win32 import library (**PeerDist.Lib**).</span></span>

<span data-ttu-id="4c62c-109">Il ciclo di vita del contenuto fornito da un server di pubblicazione e recuperato da un consumer con il servizio di distribuzione peer è costituito dalle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="4c62c-109">The lifecycle of content supplied by a publisher and retrieved by a consumer with the Peer Distribution service is composed of the following operations:</span></span>



|                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4c62c-110">**Pubblicazione del contenuto**</span><span class="sxs-lookup"><span data-stu-id="4c62c-110">**Content Publication**</span></span> | <span data-ttu-id="4c62c-111">La pubblicazione viene eseguita per produrre una descrizione delle **informazioni sul** contenuto **, o informazioni sul contenuto,** per breve.</span><span class="sxs-lookup"><span data-stu-id="4c62c-111">Publishing is done to produce a description of content termed **Content Information**, or **Content Info** for short.</span></span> <span data-ttu-id="4c62c-112">Queste informazioni sul contenuto possono quindi essere utilizzate da un'istanza del servizio di distribuzione peer per autenticare e ricompilare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="4c62c-112">This Content Info can then be used by an instance of the Peer Distribution service to authenticate and rebuild the content.</span></span> <span data-ttu-id="4c62c-113">Quando il contenuto viene pubblicato da un'applicazione nel servizio di distribuzione peer, che è concettualmente un'operazione lato server, il contenuto viene associato all'identità del server di pubblicazione, che è basata sul SID dell'utente associato al token di accesso al thread.</span><span class="sxs-lookup"><span data-stu-id="4c62c-113">When content is published by an application into the Peer Distribution service, which is conceptually a server-side operation, that content becomes associated with the Publisher Identity, which is based on the SID of the user associated with the thread access token.</span></span> <span data-ttu-id="4c62c-114">Questa associazione viene eseguita per limitare l'accesso al contenuto da entità non autorizzate.</span><span class="sxs-lookup"><span data-stu-id="4c62c-114">This binding is done to limit access to content by unauthorized entities.</span></span> <span data-ttu-id="4c62c-115">Tuttavia, è importante notare che l'accesso alle informazioni sul contenuto è equivalente all'accesso al contenuto stesso, in quanto le informazioni sul contenuto possono essere utilizzate per ottenere il contenuto dai peer o da una cache ospitata.</span><span class="sxs-lookup"><span data-stu-id="4c62c-115">However, it is important to note that access to the content information is equivalent to access to the content itself, as the content information can be used to obtain the content from peers or a hosted cache.</span></span><br/> <span data-ttu-id="4c62c-116">È disponibile una nuova versione della struttura dei dati delle informazioni sul contenuto in Windows 8. Tuttavia, la versione precedente è ancora supportata.</span><span class="sxs-lookup"><span data-stu-id="4c62c-116">There is a new version of the content information data structure in Windows 8; however, the previous version is still supported.</span></span> <span data-ttu-id="4c62c-117">Per interagire con i client Windows 7, un amministratore può configurare il servizio di distribuzione peer per utilizzare la versione precedente della struttura dei dati delle informazioni sul contenuto.</span><span class="sxs-lookup"><span data-stu-id="4c62c-117">To interoperate with Windows 7 clients, an administrator may configure the Peer Distribution service to use the previous version of the content information data structure.</span></span><br/> |
| <span data-ttu-id="4c62c-118">**Recupero del contenuto**</span><span class="sxs-lookup"><span data-stu-id="4c62c-118">**Content Retrieval**</span></span>   | <span data-ttu-id="4c62c-119">Affinché un consumer recuperi il contenuto dal servizio di distribuzione peer, è necessario fornire l'accesso alle informazioni sul contenuto pubblicate associate a tale contenuto.</span><span class="sxs-lookup"><span data-stu-id="4c62c-119">For a consumer to retrieve content from the Peer Distribution service, access must be provided to the published Content Info associated with that content.</span></span> <span data-ttu-id="4c62c-120">Il servizio di distribuzione peer utilizzato per pubblicare il contenuto può fornire le informazioni sul contenuto associate.</span><span class="sxs-lookup"><span data-stu-id="4c62c-120">The Peer Distribution service used to publish the content can provide the associated Content Info.</span></span> <span data-ttu-id="4c62c-121">Quando il consumer ha le informazioni sul contenuto, è possibile usare altre API di distribuzione peer per richiedere contenuto dal servizio di distribuzione peer.</span><span class="sxs-lookup"><span data-stu-id="4c62c-121">Once the consumer has the Content Info, other Peer Distribution APIs can be used to request content from the Peer Distribution service.</span></span> <span data-ttu-id="4c62c-122">Il servizio di distribuzione peer tenterà di recuperare il contenuto dalla rete locale.</span><span class="sxs-lookup"><span data-stu-id="4c62c-122">The Peer Distribution service will attempt to retrieve the content from the local network.</span></span> <span data-ttu-id="4c62c-123">Se il contenuto non è disponibile, l'applicazione client è responsabile del recupero del contenuto dal server di origine.</span><span class="sxs-lookup"><span data-stu-id="4c62c-123">If the content is not available, the client application is responsible for retrieving the content from the source server.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="4c62c-124">**Rimozione della pubblicazione**</span><span class="sxs-lookup"><span data-stu-id="4c62c-124">**Publication Removal**</span></span> | <span data-ttu-id="4c62c-125">Per le applicazioni che hanno pubblicato contenuto nel servizio di distribuzione peer, è stata fornita la funzione [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) per consentire il contenuto non pubblicato.</span><span class="sxs-lookup"><span data-stu-id="4c62c-125">For applications that have published content into the Peer Distribution service, the [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) function has been provided to allow content to be unpublished.</span></span> <span data-ttu-id="4c62c-126">Una volta che il contenuto non è stato pubblicato, il servizio di distribuzione peer locale non fornirà più le informazioni sul contenuto associate a tale contenuto.</span><span class="sxs-lookup"><span data-stu-id="4c62c-126">Once content has been unpublished, the local Peer Distribution service will no longer provide the content info associated with that content.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="asynchronous-completions"></a><span data-ttu-id="4c62c-127">Completamenti asincroni</span><span class="sxs-lookup"><span data-stu-id="4c62c-127">Asynchronous Completions</span></span>

<span data-ttu-id="4c62c-128">L'API di distribuzione peer supporta un modello API asincrono e, di conseguenza, le API di distribuzione peer consentono l'uso di porte o eventi di completamento di I/O come meccanismi di segnalazione per l'elaborazione dei completamenti di operazioni di distribuzione di peer asincroni.</span><span class="sxs-lookup"><span data-stu-id="4c62c-128">The Peer Distribution API supports an asynchronous API model, and as a result Peer Distribution APIs allow for the use of either I/O Completion Ports or Events as the signaling mechanisms for processing asynchronous Peer Distribution operation completions.</span></span> <span data-ttu-id="4c62c-129">Per uno dei due meccanismi, la distribuzione peer utilizza una struttura [**sovrapposta**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) .</span><span class="sxs-lookup"><span data-stu-id="4c62c-129">For either mechanism, Peer Distribution uses an [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure.</span></span> <span data-ttu-id="4c62c-130">In generale, la distribuzione peer acquisisce la proprietà di una struttura **sovrapposta** e di tutti i parametri out che il client passa alle funzioni API asincrone.</span><span class="sxs-lookup"><span data-stu-id="4c62c-130">In general, Peer Distribution takes the ownership of an **OVERLAPPED** structure and any out parameters that the Client passes to asynchronous API functions.</span></span> <span data-ttu-id="4c62c-131">Il client non deve accedere a queste risorse finché la funzione asincrona specifica non viene completata.</span><span class="sxs-lookup"><span data-stu-id="4c62c-131">The Client must not access these resources until the particular asynchronous function completes.</span></span> <span data-ttu-id="4c62c-132">Non appena le funzioni asincrone vengono completate, il servizio di distribuzione peer non richiede più l'accesso a queste risorse e può essere riutilizzato perché l'applicazione chiamante si adatta.</span><span class="sxs-lookup"><span data-stu-id="4c62c-132">As soon as the asynchronous functions completes, the Peer Distribution service will no longer require access to these resources and they may be reused as the calling application sees fit.</span></span>

<span data-ttu-id="4c62c-133">Non vi sarà alcun completamento asincrono se la funzione restituisce un codice di errore diverso da i/o di **errore \_ \_ in sospeso**.</span><span class="sxs-lookup"><span data-stu-id="4c62c-133">There will not be any asynchronous completion if the function returns any error code other than **ERROR\_IO\_PENDING**.</span></span> <span data-ttu-id="4c62c-134">La restituzione di un valore diverso da **Error \_ io \_ Pending** significa che la chiamata non è riuscita in modo sincrono.</span><span class="sxs-lookup"><span data-stu-id="4c62c-134">The return of a value other than **ERROR\_IO\_PENDING** means that the call has failed synchronously.</span></span> <span data-ttu-id="4c62c-135">Se l'API di distribuzione peer restituisce un errore di i/o **\_ \_ in sospeso**, il chiamante deve attendere il completamento asincrono.</span><span class="sxs-lookup"><span data-stu-id="4c62c-135">If the Peer Distribution API returns **ERROR\_IO\_PENDING**, the caller must wait for asynchronous completion.</span></span>

<span data-ttu-id="4c62c-136">Il codice di errore del completamento asincrono può essere recuperato in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="4c62c-136">The error code of the asynchronous completion can be retrieved in one of two ways:</span></span>

<span data-ttu-id="4c62c-137">**Completamento basato sulla porta di completamento I/O**</span><span class="sxs-lookup"><span data-stu-id="4c62c-137">**I/O Completion Port Based Completion**</span></span>

<span data-ttu-id="4c62c-138">L'utente richiama il meccanismo della porta di completamento I/O fornendo un handle della porta di completamento e una chiave di completamento per le funzioni API seguenti:</span><span class="sxs-lookup"><span data-stu-id="4c62c-138">User invokes the I/O completion port mechanism by providing a completion port handle and completion key to the following API functions:</span></span>

<dl>

[<span data-ttu-id="4c62c-139">**PeerDistRegisterForStatusChangeNotification**</span><span class="sxs-lookup"><span data-stu-id="4c62c-139">**PeerDistRegisterForStatusChangeNotification**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistregisterforstatuschangenotification)  
[<span data-ttu-id="4c62c-140">**PeerDistServerPublishStream**</span><span class="sxs-lookup"><span data-stu-id="4c62c-140">**PeerDistServerPublishStream**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverpublishstream)  
[<span data-ttu-id="4c62c-141">**PeerDistServerOpenContentInformation**</span><span class="sxs-lookup"><span data-stu-id="4c62c-141">**PeerDistServerOpenContentInformation**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserveropencontentinformation)  
[<span data-ttu-id="4c62c-142">**PeerDistClientOpenContent**</span><span class="sxs-lookup"><span data-stu-id="4c62c-142">**PeerDistClientOpenContent**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistclientopencontent)  
</dl>

<span data-ttu-id="4c62c-143">L'utente crea una porta di completamento chiamando [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span><span class="sxs-lookup"><span data-stu-id="4c62c-143">The User creates a completion port by calling [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span></span> <span data-ttu-id="4c62c-144">Questo handle della porta di completamento può essere utilizzato contemporaneamente per altre operazioni di I/O asincrone, nonché per operazioni specifiche di distribuzione peer.</span><span class="sxs-lookup"><span data-stu-id="4c62c-144">This completion port handle can be simultaneously used for other asynchronous I/O operations as well as Peer Distribution specific operations.</span></span>

<span data-ttu-id="4c62c-145">Il chiamante deve utilizzare la funzione [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) per gestire il completamento asincrono.</span><span class="sxs-lookup"><span data-stu-id="4c62c-145">The caller should use [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to manage asynchronous completion.</span></span> <span data-ttu-id="4c62c-146">Se l'operazione asincrona ha esito negativo, la funzione **GetQueuedCompletionStatus** restituirà **false** e [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) restituirà il codice di errore appropriato.</span><span class="sxs-lookup"><span data-stu-id="4c62c-146">If the asynchronous operation fails the **GetQueuedCompletionStatus** function will return **FALSE** and [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) will return the appropriate error code.</span></span> <span data-ttu-id="4c62c-147">Il chiamante deve ignorare tutti i campi della struttura [**sovrapposta**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) se il codice di errore è diverso da **Error \_ Success**.</span><span class="sxs-lookup"><span data-stu-id="4c62c-147">The caller should ignore all the fields of the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="4c62c-148">L'operazione asincrona ha esito positivo se la funzione **GetQueuedCompletionStatus** restituisce **true**.</span><span class="sxs-lookup"><span data-stu-id="4c62c-148">The asynchronous operation succeeds if the **GetQueuedCompletionStatus** function returns **TRUE**.</span></span>

<span data-ttu-id="4c62c-149">Per ulteriori informazioni, vedere [porte di completamento I/O](/windows/desktop/FileIO/i-o-completion-ports).</span><span class="sxs-lookup"><span data-stu-id="4c62c-149">For more information see [I/O Completion Ports](/windows/desktop/FileIO/i-o-completion-ports).</span></span>

<span data-ttu-id="4c62c-150">**Completamento basato su eventi**</span><span class="sxs-lookup"><span data-stu-id="4c62c-150">**Event Based Completion**</span></span>

<span data-ttu-id="4c62c-151">Se il chiamante imposta un handle di evento valido per il campo *hEvent* della struttura [**sovrapposta**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) , la distribuzione peer la utilizza per segnalare che l'operazione di i/O asincrona associata è stata completata.</span><span class="sxs-lookup"><span data-stu-id="4c62c-151">If the caller sets a valid Event handle to the *hEvent* field of [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure, Peer Distribution uses it to signal that the associated asynchronous I/O operation has completed.</span></span>

<span data-ttu-id="4c62c-152">Un chiamante del thread può gestire le operazioni sovrapposte specificando un handle per l'oggetto evento di reimpostazione manuale della struttura [**sovrapposta**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) in una delle funzioni di attesa.</span><span class="sxs-lookup"><span data-stu-id="4c62c-152">A thread caller can manage overlapped operations by specifying a handle to the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure's manual-reset event object in one of the wait functions.</span></span> <span data-ttu-id="4c62c-153">Dopo che l'evento viene segnalato, il chiamante deve chiamare [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passando la struttura **sovrapposta** appropriata.</span><span class="sxs-lookup"><span data-stu-id="4c62c-153">After the Event is signaled the caller must call [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passing in the appropriate **OVERLAPPED** structure.</span></span> <span data-ttu-id="4c62c-154">**PeerGetOverlappedResult** restituirà **false** e il chiamante deve chiamare [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) per recuperare il codice di errore.</span><span class="sxs-lookup"><span data-stu-id="4c62c-154">**PeerGetOverlappedResult** will return **FALSE** and the caller must call [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) in order to retrieve the error code.</span></span> <span data-ttu-id="4c62c-155">Il chiamante deve ignorare tutti i campi della struttura **sovrapposta** se il codice di errore è diverso da **Error \_ Success**.</span><span class="sxs-lookup"><span data-stu-id="4c62c-155">The caller should ignore all the fields of the **OVERLAPPED** structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="4c62c-156">L'operazione asincrona ha esito positivo se la funzione **PeerGetOverlappedResult** restituisce **true**.</span><span class="sxs-lookup"><span data-stu-id="4c62c-156">The asynchronous operation succeeds if the **PeerGetOverlappedResult** function returns **TRUE**.</span></span>

<span data-ttu-id="4c62c-157">Se il chiamante fornisce una porta di completamento insieme a un evento, l'evento verrà usato come meccanismo di completamento.</span><span class="sxs-lookup"><span data-stu-id="4c62c-157">If the caller provides a completion port along with an event, the event will be used as the completion mechanism.</span></span>

<span data-ttu-id="4c62c-158">**Windows 7:** Usare la funzione [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) anziché [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span><span class="sxs-lookup"><span data-stu-id="4c62c-158">**Windows 7:** Use the [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) function instead of [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4c62c-159">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="4c62c-159">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4c62c-160">Riferimento all'API di distribuzione peer</span><span class="sxs-lookup"><span data-stu-id="4c62c-160">Peer Distribution API Reference</span></span>](peer-distribution-api-reference.md)
</dt> </dl>

 

