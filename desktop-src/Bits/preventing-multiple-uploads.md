---
title: Prevenzione di più caricamenti
description: Quando si carica un file, BITS crea un ID di sessione che identifica la sessione di caricamento sia nel client BITS che nel server BITS.
ms.assetid: 97283f8e-d2fa-4383-9b92-a05f46680443
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae59bb1d605af7e4dd53b0c1d66618b6816e7886
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104044163"
---
# <a name="preventing-multiple-uploads"></a><span data-ttu-id="712f1-103">Prevenzione di più caricamenti</span><span class="sxs-lookup"><span data-stu-id="712f1-103">Preventing Multiple Uploads</span></span>

<span data-ttu-id="712f1-104">Quando si carica un file, BITS crea un ID di sessione che identifica la sessione di caricamento sia nel client BITS che nel server BITS.</span><span class="sxs-lookup"><span data-stu-id="712f1-104">When you upload a file, BITS creates a session ID that identifies the upload session to both the BITS client and BITS server.</span></span> <span data-ttu-id="712f1-105">Se la connessione tra il client BITS e il server viene interruppe mentre è in corso il caricamento di un file in bit, il client userà l'ID sessione per tentare di riprendere il caricamento.</span><span class="sxs-lookup"><span data-stu-id="712f1-105">If the connection between the BITS client and server is broken while BITS is uploading a file, the client will use the session ID to try to resume the upload.</span></span>

<span data-ttu-id="712f1-106">Se il client BITS si connette allo stesso server di prima, il server riconoscerà l'ID sessione e il caricamento riprenderà dal punto di interruzione.</span><span class="sxs-lookup"><span data-stu-id="712f1-106">If the BITS client connects to the same server as before, the server will recognize the session ID and the upload will resume from the point of interruption.</span></span> <span data-ttu-id="712f1-107">Tuttavia, se il client si connette a un server diverso, il client deve avviare il caricamento dall'inizio perché il nuovo server non dispone del contesto della sessione o dei dati caricati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="712f1-107">However, if the client connects to a different server, the client must start the upload from the beginning because the new server does not have the session context or the previously uploaded data.</span></span> <span data-ttu-id="712f1-108">BITS può connettersi a un server diverso quando il server BITS è ospitato in una Web farm e la proprietà di estensione IIS BITS, [BITSHostId](bits-iis-extension-properties.md), non è impostata.</span><span class="sxs-lookup"><span data-stu-id="712f1-108">BITS may connect to a different server when the BITS server is hosted on a web farm and the BITS IIS extension property, [BITSHostId](bits-iis-extension-properties.md), is not set.</span></span> <span data-ttu-id="712f1-109">La proprietà BITSHostId impedisce i riavvii forzando il client BITS a connettersi all'indirizzo univoco del server precedente anziché all'indirizzo del server condiviso.</span><span class="sxs-lookup"><span data-stu-id="712f1-109">The BITSHostId property prevents restarts by forcing the BITS client to connect to the previous server's unique address instead of the shared server address.</span></span>

<span data-ttu-id="712f1-110">Il server BITS tenterà di inviare il file di caricamento solo una volta all'applicazione server, ma è possibile che il file venga inviato più di una volta.</span><span class="sxs-lookup"><span data-stu-id="712f1-110">The BITS server will attempt to send the upload file only once to the server application, but it is possible that the file may be sent more than one time.</span></span> <span data-ttu-id="712f1-111">Questa situazione può verificarsi, ad esempio, se il server BITS invia il file all'applicazione server e quindi viene terminato durante l'attesa della risposta dall'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="712f1-111">This can occur, for example, if the BITS server sends the file to the server application and then terminates while waiting for the reply from the server application.</span></span> <span data-ttu-id="712f1-112">Il client BITS riceverà un codice di errore dal livello HTTP e ritenterà il caricamento dopo un ritardo.</span><span class="sxs-lookup"><span data-stu-id="712f1-112">The BITS client will receive an error code from the HTTP layer, and retry the upload after a delay.</span></span> <span data-ttu-id="712f1-113">Se il server rimane offline per un periodo di tempo maggiore del timeout di [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) , il client invierà di nuovo la richiesta all'indirizzo del server condiviso. un altro server BITS riceverà il file e lo recapiterà nuovamente all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="712f1-113">If the server stays offline for longer than the [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) timeout, then the client will eventually send the request to the shared server address again; a different BITS server will receive the file and deliver it again to the server application.</span></span>

<span data-ttu-id="712f1-114">Un caso simile può verificarsi anche con un unico server front-end.</span><span class="sxs-lookup"><span data-stu-id="712f1-114">A similar case can occur even with a single front-end server.</span></span> <span data-ttu-id="712f1-115">Ad esempio, quando il client ha caricato l'intero file nel server, il blocco finale fa in modo che il server inoltri il file all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="712f1-115">For example, when the client has uploaded the entire file to the server, the final block causes the server to forward the file to the server application.</span></span> <span data-ttu-id="712f1-116">Se il server BITS o l'applicazione server termina dopo l'elaborazione del file ma prima che il riconoscimento venga inviato al client, il client riceverà un codice di errore e riproverà in seguito.</span><span class="sxs-lookup"><span data-stu-id="712f1-116">If the BITS server or the server application terminate after the file is processed but before the acknowledgment is sent to the client, then the client will receive an error code and retry later.</span></span> <span data-ttu-id="712f1-117">Quando il client ritenta, il server BITS vedrà che il blocco finale è stato caricato e il file verrà nuovamente inviato all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="712f1-117">When the client retries, the BITS server will see that the final block has been uploaded, and it will again forward the file to the server application.</span></span> <span data-ttu-id="712f1-118">Se la ricezione più volte del file di caricamento è un problema per l'applicazione server, è necessario considerare l'inclusione di un identificatore di transazione nei dati.</span><span class="sxs-lookup"><span data-stu-id="712f1-118">If receiving the upload file multiple times is an issue for your server application, you should consider including a transaction identifier in the data.</span></span>

 

 




