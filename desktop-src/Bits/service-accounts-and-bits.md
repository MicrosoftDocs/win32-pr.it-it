---
title: Account del servizio e BITS
description: È possibile utilizzare BITS per trasferire file da un servizio. Il servizio deve usare l'account di sistema LocalSystem, LocalService o NetworkService. Questi account sono sempre connessi; di conseguenza, i processi inviati da un servizio usando questi account vengono sempre eseguiti.
ms.assetid: 43fb58d6-3a99-488f-ab43-dbb4a794fc2f
keywords:
- BITS degli account del servizio
- trasferimento di bit del processo, proprietà, account del servizio
- BIT proxy, account del servizio
- credenziali per il trasferimento di bit di processo
ms.topic: article
ms.date: 10/04/2018
ms.openlocfilehash: 475a623e6b105d3ef2bdc6586db613c010fe8923
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104117918"
---
# <a name="service-accounts-and-bits"></a><span data-ttu-id="b0078-109">Account del servizio e BITS</span><span class="sxs-lookup"><span data-stu-id="b0078-109">Service Accounts and BITS</span></span>

<span data-ttu-id="b0078-110">È possibile utilizzare BITS per trasferire file da un servizio.</span><span class="sxs-lookup"><span data-stu-id="b0078-110">You can use BITS to transfer files from a service.</span></span> <span data-ttu-id="b0078-111">Il servizio deve usare l'account di sistema LocalSystem, LocalService o NetworkService.</span><span class="sxs-lookup"><span data-stu-id="b0078-111">The service must use the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="b0078-112">Questi account sono sempre connessi; di conseguenza, i processi inviati da un servizio usando questi account vengono sempre eseguiti.</span><span class="sxs-lookup"><span data-stu-id="b0078-112">These accounts are always logged on; therefore, jobs submitted by a service using these accounts always run.</span></span>

<span data-ttu-id="b0078-113">Se un servizio in esecuzione con un account di sistema rappresenta l'utente prima di chiamare BITS, BITS risponde come per qualsiasi account utente (ad esempio, l'utente deve essere connesso al computer per consentire il trasferimento).</span><span class="sxs-lookup"><span data-stu-id="b0078-113">If a service running under a system account impersonates the user before calling BITS, BITS responds as it would for any user account (for example, the user needs to be logged on to the computer for the transfer to occur).</span></span> <span data-ttu-id="b0078-114">Il servizio deve inoltre utilizzare il mascheramento dinamico con i puntatori dell'interfaccia BITS quando si rappresenta l'utente.</span><span class="sxs-lookup"><span data-stu-id="b0078-114">The service should also use dynamic cloaking with the BITS interface pointers when impersonating the user.</span></span> <span data-ttu-id="b0078-115">Il cloaking non viene ereditato, pertanto è necessario chiamare la funzione [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) su ogni puntatore di interfaccia ricevuto da bit (ad esempio, il puntatore del processo restituito dalla chiamata al metodo [**IBackgroundCopyManager:: CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) ); non è sufficiente impostare il cloaking sul puntatore dell'interfaccia del gestore.</span><span class="sxs-lookup"><span data-stu-id="b0078-115">Cloaking is not inherited, therefore you must call the [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) function on each interface pointer that you receive from BITS (for example, the job pointer returned from calling the [**IBackgroundCopyManager::CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) method); it is not enough to set cloaking on the manager interface pointer.</span></span> <span data-ttu-id="b0078-116">È anche possibile chiamare la funzione [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) per il processo anziché chiamare la funzione **CoSetProxyBlanket** su ogni puntatore di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="b0078-116">You can also call the [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function for the process instead of calling the **CoSetProxyBlanket** function on each interface pointer.</span></span>

<span data-ttu-id="b0078-117">Tuttavia, se il servizio non rappresenta l'utente, si applicano i comportamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="b0078-117">However, if the service does not impersonate the user, the following behaviors apply:</span></span>

- <span data-ttu-id="b0078-118">I processi creati dall'account del servizio appartengono a tale account.</span><span class="sxs-lookup"><span data-stu-id="b0078-118">Jobs created by the service account are owned by that account.</span></span> <span data-ttu-id="b0078-119">Poiché gli account di sistema sono sempre connessi, BITS trasferisce i file finché il computer è in esecuzione ed è presente una connessione di rete.</span><span class="sxs-lookup"><span data-stu-id="b0078-119">Because system accounts are always logged on, BITS transfers the files as long as the computer is running and there is a network connection.</span></span>
- <span data-ttu-id="b0078-120">Gli account di sistema non devono utilizzare lettere di unità di rete mappate perché le lettere di unità sono specifiche di una sessione e il mapping può andare perduto dopo il riavvio del computer.</span><span class="sxs-lookup"><span data-stu-id="b0078-120">System accounts should not use mapped network drive letters because the drive letters are specific to a session and the mapping may be lost after a computer restart.</span></span>
- <span data-ttu-id="b0078-121">In assenza di un [token Helper](helper-tokens-for-bits-transfer-jobs.md), l'autenticazione di rete usa le credenziali del computer per gli account LocalSystem e NetworkService e le credenziali anonime per l'account LocalService.</span><span class="sxs-lookup"><span data-stu-id="b0078-121">In the absence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), network authentication uses computer credentials for LocalSystem and NetworkService accounts and anonymous credentials for the LocalService account.</span></span> <span data-ttu-id="b0078-122">BITS restituisce "accesso negato" se l'elenco di controllo di accesso (ACL) per il file di origine limita l'accesso a un account utente.</span><span class="sxs-lookup"><span data-stu-id="b0078-122">BITS returns "access denied" if the access control list (ACL) for the source file limits access to a user account.</span></span>
- <span data-ttu-id="b0078-123">Per informazioni dettagliate sul funzionamento dell'autenticazione in presenza di un [token Helper](helper-tokens-for-bits-transfer-jobs.md), vedere [Authentication](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="b0078-123">For details on how authentication works in the presence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), see [Authentication](authentication.md).</span></span>
- <span data-ttu-id="b0078-124">Le impostazioni proxy di Microsoft Internet Explorer vengono archiviate per utente e non sono impostate per gli account di sistema.</span><span class="sxs-lookup"><span data-stu-id="b0078-124">Microsoft Internet Explorer proxy settings are stored per-user and are not set for system accounts.</span></span> <span data-ttu-id="b0078-125">Valutare la possibilità di configurare un token helper nei processi BITS oppure di impostare in modo esplicito le impostazioni proxy corrette chiamando [**Metodo ibackgroundcopyjob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) con la **sostituzione dell'utilizzo del \_ proxy del processo \_ \_ \_ BG**.</span><span class="sxs-lookup"><span data-stu-id="b0078-125">Consider configuring a helper token on your BITS jobs, or explicitly setting the correct proxy settings by calling [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) with **BG\_JOB\_PROXY\_USAGE\_OVERRIDE**.</span></span> <span data-ttu-id="b0078-126">In alternativa, è possibile utilizzare le opzioni **/util/SetIEProxy** di BitsAdmin.exe per impostare le impostazioni proxy di Internet Explorer per l'account di sistema LocalSystem, LocalService o NetworkService.</span><span class="sxs-lookup"><span data-stu-id="b0078-126">Alternatively, you can use the **/Util /SetIEProxy** switches of BitsAdmin.exe to set Internet Explorer proxy settings for the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="b0078-127">Per informazioni dettagliate, vedere [lo strumento Bitsadmin](bitsadmin-tool.md).</span><span class="sxs-lookup"><span data-stu-id="b0078-127">For details, see [BitsAdmin Tool](bitsadmin-tool.md).</span></span>

<span data-ttu-id="b0078-128">Si noti che BITS non riconosce le impostazioni proxy impostate utilizzando il file di Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="b0078-128">Note that BITS does not recognize the proxy settings that are set using the Proxycfg.exe file.</span></span>