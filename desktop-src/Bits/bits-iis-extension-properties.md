---
title: Proprietà dell'estensione di IIS per BITS
description: Servizio trasferimento intelligente in background (BITS) utilizza un ISAPI per estendere IIS per supportare i processi di caricamento.
ms.assetid: 08a40cc1-ec6d-4b65-971a-15c7b06df148
keywords:
- BITS proprietà estensione IIS BITS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c09412f6aa0be1ab76e6e45ea0920e1caf1054d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104516971"
---
# <a name="bits-iis-extension-properties"></a><span data-ttu-id="68a2a-104">Proprietà dell'estensione di IIS per BITS</span><span class="sxs-lookup"><span data-stu-id="68a2a-104">BITS IIS Extension Properties</span></span>

<span data-ttu-id="68a2a-105">Servizio trasferimento intelligente in background (BITS) utilizza un ISAPI per estendere IIS per supportare i [**processi di caricamento**](/windows/win32/api/bits/ne-bits-bg_job_type).</span><span class="sxs-lookup"><span data-stu-id="68a2a-105">Background Intelligent Transfer Service (BITS) uses an ISAPI to extend IIS to support [**upload jobs**](/windows/win32/api/bits/ne-bits-bg_job_type).</span></span> <span data-ttu-id="68a2a-106">Nella tabella seguente sono elencate le proprietà aggiunte da BITS alla metabase IIS per il componente directory virtuale.</span><span class="sxs-lookup"><span data-stu-id="68a2a-106">The following table lists the properties that BITS adds to the IIS metabase for the virtual directory component.</span></span> <span data-ttu-id="68a2a-107">BITS usa queste proprietà per determinare come caricare i file.</span><span class="sxs-lookup"><span data-stu-id="68a2a-107">BITS uses these properties to determine how to upload the files.</span></span> <span data-ttu-id="68a2a-108">Le proprietà dell'estensione IIS BITS sono ereditabili, ad eccezione di **BITSUploadEnabled**.</span><span class="sxs-lookup"><span data-stu-id="68a2a-108">The BITS IIS extension properties are inheritable, except for **BITSUploadEnabled**.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="68a2a-109">Proprietà</span><span class="sxs-lookup"><span data-stu-id="68a2a-109">Property</span></span></th>
<th><span data-ttu-id="68a2a-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="68a2a-110">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="68a2a-111"><strong>BITSUploadEnabled</strong> Tipo di dati: <strong>Boolean</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-111"><strong>BITSUploadEnabled</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-112">Indica se i caricamenti BITS sono abilitati nella directory virtuale.</span><span class="sxs-lookup"><span data-stu-id="68a2a-112">Indicates whether BITS uploads are enabled on the virtual directory.</span></span> <span data-ttu-id="68a2a-113">Se l'impostazione non è presente o è 0, i caricamenti BITS sono disabilitati.</span><span class="sxs-lookup"><span data-stu-id="68a2a-113">If the setting is not present or is 0, BITS uploads are disabled.</span></span><br/> <span data-ttu-id="68a2a-114">Questa proprietà è di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="68a2a-114">This is a read-only property.</span></span> <span data-ttu-id="68a2a-115">Per impostare questa proprietà, chiamare il metodo <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> o <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> dell'interfaccia <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-115">To set this property, call the <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> or <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> method of the <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> interface.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-116"><strong>BITSSessionTimeout</strong> Tipo di dati: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-116"><strong>BITSSessionTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-117">Numero di secondi durante i quali la connessione viene mantenuta se non è stato eseguito il caricamento del file. il timer viene reimpostato quando viene eseguito lo stato di avanzamento.</span><span class="sxs-lookup"><span data-stu-id="68a2a-117">Number of seconds the connection is maintained if no progress is made uploading the file; the timer is reset when progress is made.</span></span> <span data-ttu-id="68a2a-118">BITS chiude la connessione se viene raggiunto il timeout e pulisce i dati associati alla sessione.</span><span class="sxs-lookup"><span data-stu-id="68a2a-118">BITS closes the connection if the time-out is reached and cleans up data associated with the session.</span></span><br/> <span data-ttu-id="68a2a-119">L'impostazione di un timeout di sessione breve può costituire un problema per i processi di caricamento-risposta, perché la risposta viene scaricata solo quando l'utente è connesso e connesso alla rete.</span><span class="sxs-lookup"><span data-stu-id="68a2a-119">Setting a short session time-out can be an issue for upload-reply jobs because the reply is only downloaded when the user is logged on and connected to the network.</span></span> <span data-ttu-id="68a2a-120">È possibile che la sessione si timeout prima che la risposta venga scaricata, nel qual caso la sessione viene annullata e il file di risposta viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-120">It is possible for the session to time out before the reply is downloaded, in which case the session is canceled and the reply file is deleted.</span></span><br/> <span data-ttu-id="68a2a-121">Si noti che BITS Annulla il processo se viene raggiunto il valore <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> criteri di gruppo (il valore predefinito è 90 giorni), indipendentemente da questa impostazione.</span><span class="sxs-lookup"><span data-stu-id="68a2a-121">Note that BITS cancels the job if the <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> Group Policy value (default is 90 days) is reached, regardless of this setting.</span></span><br/> <span data-ttu-id="68a2a-122">Il valore predefinito è 1.209.600 (14 giorni).</span><span class="sxs-lookup"><span data-stu-id="68a2a-122">Default value is 1,209,600 (14 days).</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-123"><strong>BITSMaximumUploadSize</strong> Tipo di dati: <strong>String</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-123"><strong>BITSMaximumUploadSize</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-124">Numero massimo di byte che è possibile caricare per processo.</span><span class="sxs-lookup"><span data-stu-id="68a2a-124">Maximum number of bytes that can be uploaded per job.</span></span> <span data-ttu-id="68a2a-125">Specificare il numero massimo di byte come stringa decimale. il valore della stringa deve essere minore o uguale a &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="68a2a-125">Specify the maximum number of bytes as a decimal string; the string value must be less than or equal to &quot;1844674407370955&quot;.</span></span> <span data-ttu-id="68a2a-126">Una stringa vuota equivale a specificare &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="68a2a-126">An empty string is the same as specifying &quot;1844674407370955&quot;.</span></span><br/> <span data-ttu-id="68a2a-127">Il valore predefinito è una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="68a2a-127">Default value is an empty string.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="68a2a-128">In IIS 7, il limite di caricamento predefinito è pari a 30 milioni byte.</span><span class="sxs-lookup"><span data-stu-id="68a2a-128">In IIS 7, the default upload limit is 30 million bytes.</span></span> <span data-ttu-id="68a2a-129">Il valore della proprietà <strong>BITSMaximumUploadSize</strong> non può superare il limite di IIS.</span><span class="sxs-lookup"><span data-stu-id="68a2a-129">The value of the <strong>BITSMaximumUploadSize</strong> property cannot exceed the IIS limit.</span></span> <span data-ttu-id="68a2a-130">Per informazioni dettagliate e informazioni sulla modifica del valore predefinito di IIS, vedere <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span><span class="sxs-lookup"><span data-stu-id="68a2a-130">For details and information on changing the IIS default, see <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-131"><strong>BITSServerNotificationType</strong> Tipo di dati: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-131"><strong>BITSServerNotificationType</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-132">Specifica come inviare il file di caricamento all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="68a2a-132">Specifies how to send the upload file to the server application.</span></span> <span data-ttu-id="68a2a-133">I valori possibili sono: 0, 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="68a2a-133">The possible values are: 0, 1, and 2.</span></span><br/> <span data-ttu-id="68a2a-134">Il valore 0 indica che il file non viene inviato all'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="68a2a-134">A value of 0 means the file is not sent to the server application.</span></span> <span data-ttu-id="68a2a-135">BITS inserisce il file di caricamento nella directory specificata nel nome remoto (il nome remoto specificato quando è stato <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">aggiunto il file</a> al processo) senza notificare l'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="68a2a-135">BITS puts the upload file in the directory specified in the remote name (the remote name specified when you <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">added the file</a> to the job) without notifying the server application.</span></span> <span data-ttu-id="68a2a-136">Se il file attualmente esiste nella directory di destinazione, viene sostituito con il file di caricamento.</span><span class="sxs-lookup"><span data-stu-id="68a2a-136">If the file currently exists in the destination directory, it is replaced with the upload file.</span></span><br/> <span data-ttu-id="68a2a-137">Il valore 1 indica che BITS passa il percorso del file di caricamento all'applicazione server specificata nella proprietà <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-137">A value of 1 means BITS passes the location of the upload file to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="68a2a-138">Se necessario, l'applicazione server elabora il file e genera un file di risposta.</span><span class="sxs-lookup"><span data-stu-id="68a2a-138">The server application processes the file and generates a reply file, if needed.</span></span> <span data-ttu-id="68a2a-139">Per impostazione predefinita, BITS rimuove i file di caricamento e di risposta dal server dopo aver ricevuto la risposta dall'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="68a2a-139">By default, BITS removes the upload and reply files from the server after it receives the response from the server application.</span></span> <span data-ttu-id="68a2a-140">Per fare in modo che BITS copi il file di caricamento nel percorso specificato dal nome del file remoto nel processo, includere l'intestazione <a href="/windows/win32/bits/notification-protocol-for-server-applications">bits-copy-file-to-Destination</a> nella risposta.</span><span class="sxs-lookup"><span data-stu-id="68a2a-140">To have BITS copy the upload file to the location specified by the remote file name in the job, include the <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-To-Destination</a> header in your response.</span></span> <span data-ttu-id="68a2a-141">Se non si include l'intestazione e si desidera salvare i file di caricamento e di risposta, è necessario copiare i file di caricamento e di risposta in un nuovo percorso prima di rispondere.</span><span class="sxs-lookup"><span data-stu-id="68a2a-141">If you do not include the header and you want to save the upload and reply files, you must copy the upload and reply files to a new location before responding.</span></span><br/> <span data-ttu-id="68a2a-142">Il valore 2 indica che BITS passa il file di caricamento nel corpo della richiesta all'applicazione server specificata nella proprietà <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-142">A value of 2 means BITS passes the upload file in the body of the request to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="68a2a-143">L'applicazione server elabora il file e restituisce la risposta nel corpo della risposta, se necessario.</span><span class="sxs-lookup"><span data-stu-id="68a2a-143">The server application processes the file and passes back the reply in the body of the response, if needed.</span></span><br/> <span data-ttu-id="68a2a-144">Per informazioni dettagliate sulle intestazioni di richiesta e risposta, vedere <a href="/windows/win32/bits/notification-protocol-for-server-applications">protocollo di notifica per le applicazioni server</a>.</span><span class="sxs-lookup"><span data-stu-id="68a2a-144">For details on the request and response headers, see <a href="/windows/win32/bits/notification-protocol-for-server-applications">Notification Protocol for Server Applications</a>.</span></span><br/> <span data-ttu-id="68a2a-145">L'applicazione server deve fornire una risposta entro cinque minuti.</span><span class="sxs-lookup"><span data-stu-id="68a2a-145">The server application must provide a response within five minutes.</span></span> <span data-ttu-id="68a2a-146">Se l'applicazione server non risponde entro cinque minuti, il processo entra nello stato di errore temporaneo.</span><span class="sxs-lookup"><span data-stu-id="68a2a-146">If the server application does not reply within five minutes, the job enters the transient error state.</span></span> <span data-ttu-id="68a2a-147">Quando il <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>ritardo tra tentativi</strong></a> scade, il server BITS invierà un'altra notifica all'applicazione server (l'applicazione server deve essere scritta per gestire le notifiche duplicate). <strong>BITS 1,5:</strong> Il timeout della notifica è di 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="68a2a-147">When the <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>retry delay</strong></a> expires, the BITS server will send another notification to the server application (the server application should be written to handle duplicate notifications).<strong>BITS 1.5:</strong> The notification time-out is 30 seconds.</span></span><br/> <br/> <span data-ttu-id="68a2a-148">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="68a2a-148">Default value is 0.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-149"><strong>BITSServerNotificationURL</strong> Tipo di dati: <strong>String</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-149"><strong>BITSServerNotificationURL</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-150">facoltativo.</span><span class="sxs-lookup"><span data-stu-id="68a2a-150">Optional.</span></span> <span data-ttu-id="68a2a-151">Contiene l'URL dell'applicazione server a cui BITS inserisce il file di caricamento.</span><span class="sxs-lookup"><span data-stu-id="68a2a-151">Contains the URL of the server application to which BITS posts the upload file.</span></span> <span data-ttu-id="68a2a-152">È necessario specificare un URL se il valore della proprietà <strong>BITSServerNotificationType</strong> è 1 o 2.</span><span class="sxs-lookup"><span data-stu-id="68a2a-152">You must specify a URL if the value of the <strong>BITSServerNotificationType</strong> property is 1 or 2.</span></span> <span data-ttu-id="68a2a-153">L'URL è limitato a 2.200 caratteri, escluso il carattere di terminazione null.</span><span class="sxs-lookup"><span data-stu-id="68a2a-153">The URL is limited to 2,200 characters, not including the null terminator.</span></span> <span data-ttu-id="68a2a-154">L'URL deve essere un URL HTTP; BITS non supporta gli URL di notifica HTTPS.</span><span class="sxs-lookup"><span data-stu-id="68a2a-154">The URL must be an HTTP URL; BITS does not support HTTPS notification URLs.</span></span><br/> <span data-ttu-id="68a2a-155">Se l'URL non è disponibile al momento del caricamento, BITS tenterà di eseguire il caricamento fino a quando l'URL di notifica non esiste o fino alla scadenza del periodo di ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="68a2a-155">If the URL is not available at the time of upload, BITS will retry the upload until the notification URL exists or until the retry period expires.</span></span><br/> <span data-ttu-id="68a2a-156">Si noti che se il nome remoto specificato nel processo contiene una stringa di query, la stringa di query viene aggiunta all'URL specificato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-156">Note that if the remote name specified in the job contains a query string, the query string is appended to the URL that you specify.</span></span> <span data-ttu-id="68a2a-157">Se, ad esempio, il nome remoto contiene https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 e si specifica l'impostazione di <strong>BITSServerNotificationURL</strong> come https://otherserver/myvdir2/bag.asp , l'URL a cui i post BITS è https://otherserver/myvdir2/bag.asp?ACCOUNT=86433 .</span><span class="sxs-lookup"><span data-stu-id="68a2a-157">For example, if the remote name contains https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 and you specify the <strong>BITSServerNotificationURL</strong> setting as https://otherserver/myvdir2/bag.asp, the URL to which BITS posts is https://otherserver/myvdir2/bag.asp?ACCOUNT=86433.</span></span><br/> <span data-ttu-id="68a2a-158">Se l'URL originale è https://myserver/myvdir/file.txt e l'URL di notifica è myasp. asp, BITS USA http//MyServer/MyVDir/myasp. asp come URL di notifica.</span><span class="sxs-lookup"><span data-stu-id="68a2a-158">If the original URL is https://myserver/myvdir/file.txt and the notification URL is myasp.asp, BITS uses http//myserver/myvdir/myasp.asp as the notification URL.</span></span><br/> <span data-ttu-id="68a2a-159">Se la parte relativa al percorso e al nome file dell'URL contiene caratteri Unicode non comuni alla tabella codici nel client e nel server, la conversione dell'URL avrà esito negativo nel server e il processo BITS verrà inserito nello stato di errore.</span><span class="sxs-lookup"><span data-stu-id="68a2a-159">If the path and file name portion of the URL contains Unicode characters not in common to the code page on both the client and server, the URL translation will fail on the server and the BITS job will be placed in the error state.</span></span> <span data-ttu-id="68a2a-160">Se la parte relativa al server dell'URL contiene caratteri Unicode, è necessario codificare la parte del server usando <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">i nomi di dominio internazionali</a> (IDN).</span><span class="sxs-lookup"><span data-stu-id="68a2a-160">If the server portion of the URL contains Unicode characters, you must encode the server portion using <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">Internationalized Domain Names</a> (IDN).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-161"><strong>BITSHostId</strong> Tipo di dati: <strong>String</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-161"><strong>BITSHostId</strong>Data Type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-162">Impostare questa proprietà se l'installazione del server è un Web farm che non utilizza l'archiviazione condivisa.</span><span class="sxs-lookup"><span data-stu-id="68a2a-162">Set this property if the server installation is a web farm that does not use shared storage.</span></span><br/> <span data-ttu-id="68a2a-163">Specificare il nome del server o l'indirizzo IP del server a cui riconnettersi dopo che il processo di caricamento è stato interrotto.</span><span class="sxs-lookup"><span data-stu-id="68a2a-163">Specify the server name or IP address of the server to reconnect to after the upload process is interrupted.</span></span> <span data-ttu-id="68a2a-164">In genere, si specifica il nome del server che si sta configurando.</span><span class="sxs-lookup"><span data-stu-id="68a2a-164">Typically, you specify the name of the server you are configuring.</span></span> <span data-ttu-id="68a2a-165">L'URL è limitato a 300 caratteri, escluso il carattere di terminazione null.</span><span class="sxs-lookup"><span data-stu-id="68a2a-165">The URL is limited to 300 characters, not including the null terminator.</span></span><br/> <span data-ttu-id="68a2a-166">Se non si specifica questa proprietà e il processo di caricamento viene interrotto, è possibile che BITS riprenda il processo in un altro server della farm.</span><span class="sxs-lookup"><span data-stu-id="68a2a-166">If you do not specify this property and the upload process is interrupted, it is possible that BITS will resume the job on another server in the farm.</span></span> <span data-ttu-id="68a2a-167">Tuttavia, il server precedente contiene ancora il file di caricamento parziale da prima dell'interruzione.</span><span class="sxs-lookup"><span data-stu-id="68a2a-167">However, the previous server still contains the partial upload file from before the interruption.</span></span> <span data-ttu-id="68a2a-168">BITS rimuove il file parziale dopo la scadenza del <strong>BITSSessionTimeout</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-168">BITS removes the partial file after the <strong>BITSSessionTimeout</strong> expires.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="68a2a-169">Non utilizzare la proprietà <strong>BITSHostId</strong> se SSL viene utilizzato in un Web farm che utilizza bilanciamento carico di rete (NLB) o nomi DNS con più indirizzi IP, a meno che non si includa il nome del cluster e i nomi dei singoli server nel certificato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-169">Do not use the <strong>BITSHostId</strong> property if SSL is used in a web farm that uses Network Load Balancing (NLB) or DNS names with multiple IP addresses, unless you include the cluster name and individual server names in the certificate.</span></span> <span data-ttu-id="68a2a-170">Se il nome del server specificato in <strong>BITSHostId</strong> non corrisponde al nome comune nel certificato, il processo avrà esito negativo. Al contrario, per NLB, impostare il parametro <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">affinity</a> su <strong>Single</strong> per garantire che il client comunichi con lo stesso server in futuro.</span><span class="sxs-lookup"><span data-stu-id="68a2a-170">(If the server name specified in <strong>BITSHostId</strong> does not match the common name on the certificate, the job will fail.) Instead, for NLB, set the <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> parameter to <strong>Single</strong> to ensure that the client communicates with the same server in the future.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-171"><strong>BITSHostIdFallbackTimeout</strong> Tipo di dati: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-171"><strong>BITSHostIdFallbackTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-172">Numero di secondi durante i quali il client BITS tenta di riconnettersi al nome del server <strong>BITSHostId</strong> prima di ripristinare il nome host specificato nel nome file remoto del processo.</span><span class="sxs-lookup"><span data-stu-id="68a2a-172">Number of seconds the BITS client tries to reconnect to the <strong>BITSHostId</strong> server name before reverting to the host name specified in the remote file name of the job.</span></span> <span data-ttu-id="68a2a-173">Il timer inizia quando BITS non è in grado di connettersi al server <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-173">The timer begins when BITS is unable to connect to the <strong>BITSHostId</strong> server.</span></span> <span data-ttu-id="68a2a-174">Il timer viene reimpostato quando il client si connette correttamente al server.</span><span class="sxs-lookup"><span data-stu-id="68a2a-174">The timer is reset when the client successfully connects to the server.</span></span><br/> <span data-ttu-id="68a2a-175">Si noti che il valore di timeout nessun stato del processo (vedere <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>Metodo ibackgroundcopyjob:: SetNoProgressTimeout</strong></a>) deve essere più lungo del valore di timeout.</span><span class="sxs-lookup"><span data-stu-id="68a2a-175">Note that the no progress timeout value of the job (see <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob::SetNoProgressTimeout</strong></a>) should be longer than this timeout value.</span></span> <span data-ttu-id="68a2a-176">In caso contrario, il processo avrà esito negativo prima della scadenza del valore di timeout di fallback.</span><span class="sxs-lookup"><span data-stu-id="68a2a-176">If not, the job will fail before fallback timeout value expires.</span></span><br/> <span data-ttu-id="68a2a-177">Impostare questa proprietà solo se si imposta la proprietà <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-177">Set this property only if you set the <strong>BITSHostId</strong> property.</span></span><br/> <span data-ttu-id="68a2a-178">Il valore predefinito è 86.400 (1 giorno).</span><span class="sxs-lookup"><span data-stu-id="68a2a-178">Default value is 86,400 (1 day).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-179"><strong>BITSAllowOverwrites</strong> Tipo di dati: <strong>Integer</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-179"><strong>BITSAllowOverwrites</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-180">Indica se un file di caricamento può sovrascrivere un file esistente con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="68a2a-180">Indicates whether an upload file can overwrite an existing file with the same name.</span></span> <span data-ttu-id="68a2a-181">Il file di caricamento sovrascrive il file esistente se <strong>BITSAllowOverwrites</strong> è 1.</span><span class="sxs-lookup"><span data-stu-id="68a2a-181">The upload file overwrites the existing file if <strong>BITSAllowOverwrites</strong> is 1.</span></span><br/> <span data-ttu-id="68a2a-182">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="68a2a-182">Default value is 0.</span></span><br/> <span data-ttu-id="68a2a-183"><strong>IIS 6,0:</strong> È possibile impostare questa proprietà solo da uno script, non è possibile impostarla utilizzando la pagina delle proprietà dell'estensione BITS nell'interfaccia utente di IIS.</span><span class="sxs-lookup"><span data-stu-id="68a2a-183"><strong>IIS 6.0:</strong> You can set this property only from a script, you cannot set it using the BITS extension properties page in the IIS user interface.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-184"><strong>BITSCleanupUseDefault</strong> Tipo di dati: <strong>Boolean</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-184"><strong>BITSCleanupUseDefault</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-185">Indica se l'attività di pulizia utilizza le pianificazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="68a2a-185">Indicates whether the cleanup task uses the default schedules.</span></span> <span data-ttu-id="68a2a-186">Per impostazione predefinita, l'attività di pulizia viene eseguita ogni 12 ore.</span><span class="sxs-lookup"><span data-stu-id="68a2a-186">By default, the cleanup task is run every 12 hours.</span></span><br/> <span data-ttu-id="68a2a-187">Impostare su 1 per utilizzare la pianificazione predefinita. in caso contrario, 0 per specificare una pianificazione.</span><span class="sxs-lookup"><span data-stu-id="68a2a-187">Set to 1 to use the default schedule; otherwise, 0 to specify a schedule.</span></span><br/> <span data-ttu-id="68a2a-188">Per specificare una pianificazione, usare le proprietà <strong>BITSCleanupCount</strong> e <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-188">To specify a schedule, use the <strong>BITSCleanupCount</strong> and <strong>BITSCleanupUnits</strong> properties.</span></span><br/> <span data-ttu-id="68a2a-189">L'attività di pulizia pulisce la directory virtuale eliminando i processi che non sono stati modificati entro il periodo di timeout della sessione (vedere <strong>BITSSessionTimeout</strong>).</span><span class="sxs-lookup"><span data-stu-id="68a2a-189">The cleanup task cleans up the virtual directory by deleting jobs that have not been modified within the session time-out period (see <strong>BITSSessionTimeout</strong>).</span></span><br/> <span data-ttu-id="68a2a-190">Il valore predefinito è 1. utilizzare la pianificazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="68a2a-190">The default is 1 use the default schedule.</span></span><br/> <span data-ttu-id="68a2a-191"><strong>IIS 6,0:</strong> Non supportato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-191"><strong>IIS 6.0:</strong> Not supported.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-192"><strong>BITSCleanupCount</strong> Tipo di dati: <strong>Integer</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-192"><strong>BITSCleanupCount</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-193">Specifica l'intervallo di attesa tra l'esecuzione dell'attività di pulizia.</span><span class="sxs-lookup"><span data-stu-id="68a2a-193">Specifies the interval to wait between running the cleanup task.</span></span> <span data-ttu-id="68a2a-194">L'intervallo che è possibile specificare dipende dalle unità.</span><span class="sxs-lookup"><span data-stu-id="68a2a-194">The interval that you can specify depends on the units.</span></span> <span data-ttu-id="68a2a-195">Per i valori di intervallo possibili, vedere la proprietà <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-195">For possible interval values, see the <strong>BITSCleanupUnits</strong> property.</span></span><br/> <span data-ttu-id="68a2a-196">Questa proprietà viene ignorata se <strong>BITSCleanupUseDefault</strong> è 0.</span><span class="sxs-lookup"><span data-stu-id="68a2a-196">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="68a2a-197"><strong>IIS 6,0:</strong> Non supportato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-197"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-198"><strong>BITSCleanupUnits</strong> Tipo di dati: <strong>Integer</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-198"><strong>BITSCleanupUnits</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-199">Specifica le unità per l'intervallo di pulizia specificato nella proprietà <strong>BITSCleanupCount</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-199">Specifies the units for the cleanup interval specified in the <strong>BITSCleanupCount</strong> property.</span></span> <span data-ttu-id="68a2a-200">Questa proprietà viene ignorata se <strong>BITSCleanupUseDefault</strong> è 0.</span><span class="sxs-lookup"><span data-stu-id="68a2a-200">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="68a2a-201">I valori possibili sono:</span><span class="sxs-lookup"><span data-stu-id="68a2a-201">The possible values are:</span></span><dl> <span data-ttu-id="68a2a-202">0: le unità sono in minuti.</span><span class="sxs-lookup"><span data-stu-id="68a2a-202">0: The units are minutes.</span></span> <span data-ttu-id="68a2a-203">I valori possibili sono compresi tra 1 e 60.</span><span class="sxs-lookup"><span data-stu-id="68a2a-203">Possible values are 1 to 60.</span></span><br />
<span data-ttu-id="68a2a-204">1: le unità sono ore.</span><span class="sxs-lookup"><span data-stu-id="68a2a-204">1: The units are hours.</span></span> <span data-ttu-id="68a2a-205">Questo è il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="68a2a-205">This is the default.</span></span> <span data-ttu-id="68a2a-206">I valori possibili sono compresi tra 1 e 24.</span><span class="sxs-lookup"><span data-stu-id="68a2a-206">Possible values are 1 to 24.</span></span><br />
<span data-ttu-id="68a2a-207">2: le unità sono giorni.</span><span class="sxs-lookup"><span data-stu-id="68a2a-207">2: The units are days.</span></span> <span data-ttu-id="68a2a-208">I valori possibili sono compresi tra 1 e 360.</span><span class="sxs-lookup"><span data-stu-id="68a2a-208">Possible values are 1 to 360.</span></span><br />
</dl> <br/> <span data-ttu-id="68a2a-209"><strong>IIS 6,0:</strong> Non supportato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-209"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="68a2a-210"><strong>BITSNumberOfSessionsLimit</strong> Tipo di dati: <strong>Integer</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-210"><strong>BITSNumberOfSessionsLimit</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-211">Limita il numero di sessioni di caricamento che possono esistere simultaneamente per un utente.</span><span class="sxs-lookup"><span data-stu-id="68a2a-211">Limits the number of upload sessions that can exist concurrently for a user.</span></span> <span data-ttu-id="68a2a-212">Se il numero di sessioni per un utente è superiore a questo limite, quando viene eseguita l'attività di pulizia eliminerà le sessioni più recenti finché il numero di sessioni per l'utente non è inferiore al limite.</span><span class="sxs-lookup"><span data-stu-id="68a2a-212">If the number of sessions for a user is more than this limit, when the cleanup task runs it will delete the most recent sessions until the number of sessions for the user is below the limit.</span></span><br/> <span data-ttu-id="68a2a-213">Il valore predefinito è 50 sessioni.</span><span class="sxs-lookup"><span data-stu-id="68a2a-213">The default is 50 sessions.</span></span><br/> <span data-ttu-id="68a2a-214"><strong>IIS 6,0:</strong> Non supportato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-214"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="68a2a-215"><strong>BITSSessionLimitEnable</strong> Tipo di dati: <strong>Boolean</strong></span><span class="sxs-lookup"><span data-stu-id="68a2a-215"><strong>BITSSessionLimitEnable</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="68a2a-216">Indica se BITS limita il numero di sessioni di caricamento per utente.</span><span class="sxs-lookup"><span data-stu-id="68a2a-216">Indicates whether BITS limits the number of upload sessions per user.</span></span> <span data-ttu-id="68a2a-217">Se l'impostazione non è presente o è 0, il limite è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-217">If the setting is not present or is 0, the limit is disabled.</span></span><br/> <span data-ttu-id="68a2a-218">Per specificare il limite, impostare la proprietà <strong>BITSNumberOfSessionsLimit</strong> .</span><span class="sxs-lookup"><span data-stu-id="68a2a-218">To specify the limit, set the <strong>BITSNumberOfSessionsLimit</strong> property.</span></span><br/> <span data-ttu-id="68a2a-219">Il valore predefinito è 1.</span><span class="sxs-lookup"><span data-stu-id="68a2a-219">The default is 1.</span></span><br/> <span data-ttu-id="68a2a-220"><strong>IIS 6,0:</strong> Non supportato.</span><span class="sxs-lookup"><span data-stu-id="68a2a-220"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="68a2a-221">Nell'esempio seguente viene illustrato come impostare le proprietà dell'estensione IIS BITS utilizzando Windows script host.</span><span class="sxs-lookup"><span data-stu-id="68a2a-221">The following example shows how to set the BITS IIS extension properties using Windows Script Host.</span></span> <span data-ttu-id="68a2a-222">Se la directory virtuale punta a una condivisione remota, impostare anche le proprietà IIS **UNCUserName** e **UNCPassword** .</span><span class="sxs-lookup"><span data-stu-id="68a2a-222">If the virtual directory points to a remote share, also set the **UNCUserName** and **UNCPassword** IIS properties.</span></span>


```JScript
if (WScript.Arguments.length < 2)
{
    WScript.Echo("Usage: bitsvdir virtual_directory local_directory");
    WScript.Quit(1);
}

VirtualDirectoryName = WScript.Arguments(0);
LocalDirectoryName = WScript.Arguments(1);

ServerObj = GetObject("IIS://LocalHost/W3SVC/1/ROOT");
VirtualDir = ServerObj.Create("IIsWebVirtualDir", VirtualDirectoryName );

VirtualDir.Path = LocalDirectoryName;
VirtualDir.AppIsolated = 0;
VirtualDir.AccessScript = true;
VirtualDir.AccessRead = false;
VirtualDir.AccessWrite = false;
VirtualDir.SetInfo();

// Set BITS specific IIS configuration settings
VirtualDir.EnableBITSUploads();
VirtualDir.BITSMaximumUploadSize = "4294967296";
VirtualDir.SetInfo();

WScript.Echo( "Created virtual directory " + VirtualDirectoryName + 
              " with a local directory of " + LocalDirectoryName );
WScript.Quit( 0 );
```



 

