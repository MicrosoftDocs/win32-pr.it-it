---
description: 'Le applicazioni possono eseguire la registrazione per ricevere notifiche degli eventi del dispositivo hardware di acquisizione immagini Windows (WIA) chiamando uno dei seguenti metodi di interfaccia IWiaDevMgr o IWiaDevMgr2: IWiaDevMgr:: RegisterEventCallbackCLSID o IWiaDevMgr2:: RegisterEventCallbackCLSIDIWiaDevMgr:: RegisterEventCallbackInterface o IWiaDevMgr2:: RegisterEventCallbackInterfaceIWiaDevMgr:: RegisterEventCallbackProgram o IWiaDevMgr2:: RegisterEventCallbackProgram'
ms.assetid: 0c142083-835f-4bbd-ab32-eb6130f99c59
title: Registrazione degli eventi WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9fc36540a64211428579bc13b84902490ea103
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103966716"
---
# <a name="registering-wia-events"></a><span data-ttu-id="9a6f1-103">Registrazione degli eventi WIA</span><span class="sxs-lookup"><span data-stu-id="9a6f1-103">Registering WIA Events</span></span>

<span data-ttu-id="9a6f1-104">Le applicazioni possono eseguire la registrazione per ricevere notifiche relative agli eventi del dispositivo hardware di acquisizione immagini Windows (WIA) chiamando uno dei seguenti metodi di interfaccia [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) o [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) :</span><span class="sxs-lookup"><span data-stu-id="9a6f1-104">Applications can register to be notified of Windows Image Acquisition (WIA) hardware device events by calling one of the following [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface methods:</span></span>

-   <span data-ttu-id="9a6f1-105">[**IWiaDevMgr:: RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) o [ **IWiaDevMgr2:: RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span><span class="sxs-lookup"><span data-stu-id="9a6f1-105">[**IWiaDevMgr::RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) or [**IWiaDevMgr2::RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span></span>
-   <span data-ttu-id="9a6f1-106">[**IWiaDevMgr:: RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) o [ **IWiaDevMgr2:: RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span><span class="sxs-lookup"><span data-stu-id="9a6f1-106">[**IWiaDevMgr::RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) or [**IWiaDevMgr2::RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span></span>
-   <span data-ttu-id="9a6f1-107">[**IWiaDevMgr:: RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) o [ **IWiaDevMgr2:: RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span><span class="sxs-lookup"><span data-stu-id="9a6f1-107">[**IWiaDevMgr::RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) or [**IWiaDevMgr2::RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span></span>

<span data-ttu-id="9a6f1-108">Tutti questi metodi accettano parametri che specificano l'evento e il dispositivo hardware per cui l'applicazione deve ricevere una notifica.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-108">All of these methods take parameters that specify the event and the hardware device for which the application is to be notified.</span></span> <span data-ttu-id="9a6f1-109">Le applicazioni si registrano per ricevere un evento per tutti i dispositivi WIA passando un valore **null** per il parametro che specifica il dispositivo hardware.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-109">Applications register to receive an event for all WIA devices by passing a **NULL** value for the parameter that specifies the hardware device.</span></span>

<span data-ttu-id="9a6f1-110">Il metodo **RegisterEventCallbackInterface** registra un'applicazione per ricevere un evento del dispositivo hardware WIA se l'applicazione è in esecuzione nel momento in cui si verifica l'evento.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-110">The **RegisterEventCallbackInterface** method registers an application to receive a WIA hardware device event if the application is running at the time the event occurs.</span></span> <span data-ttu-id="9a6f1-111">Quando si verifica l'evento per cui è registrata l'applicazione, WIA chiama il metodo [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) dell'oggetto fornito dall'applicazione per trasmettere le informazioni sull'evento.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-111">When the event for which the application is registered occurs, WIA calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of the application-provided object to transmit the event information.</span></span>

<span data-ttu-id="9a6f1-112">Il metodo **RegisterEventCallbackCLSID** registra un'applicazione che è un componente Component Object Model registrato (com) per ricevere un evento del dispositivo hardware WIA anche se l'applicazione non è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-112">The **RegisterEventCallbackCLSID** method registers an application that is a registered Component Object Model (COM) component to receive a WIA hardware device event even if the application is not running.</span></span> <span data-ttu-id="9a6f1-113">Oltre ai parametri indicati in precedenza, questo metodo accetta un parametro, *pClsID*, che specifica l'ID della classe dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-113">In addition to the parameters mentioned previously, this method takes a parameter, *pClsID*, that specifies the class ID of the application.</span></span> <span data-ttu-id="9a6f1-114">Quando si verifica l'evento specificato, il sistema WIA utilizza la funzione [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) e l'ID di classe specificato da *pClsID* per creare una nuova istanza dell'applicazione e chiama il metodo [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) dell'applicazione per trasmettere le informazioni sull'evento.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-114">When the specified event occurs, the WIA system uses the [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and the class ID specified by *pClsID* to create a new instance of the application, and calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of that application to transmit the event information.</span></span>

<span data-ttu-id="9a6f1-115">Il metodo **RegisterEventCallbackProgram** registra un'applicazione per ricevere un evento del dispositivo hardware WIA anche se l'applicazione non è in esecuzione quando si verifica l'evento.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-115">The **RegisterEventCallbackProgram** method registers an application to receive a WIA hardware device event even if the application is not running when the event occurs.</span></span> <span data-ttu-id="9a6f1-116">L'applicazione non deve essere un componente COM registrato.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-116">The application need not be a registered COM component.</span></span> <span data-ttu-id="9a6f1-117">WIA avvia l'applicazione con un'istruzione della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-117">WIA launches the application with a command line statement.</span></span> <span data-ttu-id="9a6f1-118">**RegisterEventCallbackProgram** accetta un parametro, *bstrCommandline*, che specifica il percorso completo e il nome file dell'applicazione eseguibile.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-118">**RegisterEventCallbackProgram** takes a parameter, *bstrCommandline*, that specifies the full path and filename of the executable application.</span></span> <span data-ttu-id="9a6f1-119">**RegisterEventCallbackProgram** esiste per compatibilità con le applicazioni che non sono state scritte per WIA e che devono essere evitate.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-119">**RegisterEventCallbackProgram** exists for backward compatibility with applications that were not written for WIA, and should be avoided.</span></span> <span data-ttu-id="9a6f1-120">In alternativa, utilizzare **RegisterEventCallbackInterface** o **RegisterEventCallbackCLSID** .</span><span class="sxs-lookup"><span data-stu-id="9a6f1-120">Use **RegisterEventCallbackInterface** or **RegisterEventCallbackCLSID** instead.</span></span>

<span data-ttu-id="9a6f1-121">Per determinare quali gestori sono registrati per gli eventi in un dispositivo WIA specifico, un'applicazione chiama un metodo [**IWiaItem:: EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) o [**IWiaItem2:: EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) di un elemento radice.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-121">To determine which handlers are registered for events on a specific WIA device, an application calls a [**IWiaItem::EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) or [**IWiaItem2::EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) method of a root item.</span></span> <span data-ttu-id="9a6f1-122">Questo metodo crea un oggetto di enumerazione per le informazioni di registrazione.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-122">This method creates an enumeration object for the registration information.</span></span> <span data-ttu-id="9a6f1-123">L'applicazione può quindi usare l'interfaccia [**IEnumWIA \_ dev \_ Caps**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) dell'oggetto per enumerare le informazioni sui gestori registrati per ricevere gli eventi per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-123">The application can then use the [**IEnumWIA\_DEV\_CAPS**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) interface of that object to enumerate information about the handlers registered to receive events for that device.</span></span>

<span data-ttu-id="9a6f1-124">Se si verifica un evento per il quale un'applicazione in esecuzione viene registrata tramite **RegisterEventCallbackInterface** e **RegisterEventCallbackCLSID** o **RegisterEventCallbackProgram**, WIA invia una notifica all'applicazione in esecuzione e non tenta di avviare una nuova istanza dell'applicazione perché la registrazione degli eventi tramite **RegisterEventCallbackInterface** ha la precedenza su **RegisterEventCallbackCLSID** e **RegisterEventCallbackProgram**.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-124">If an event occurs for which a running application is registered through **RegisterEventCallbackInterface** and either **RegisterEventCallbackCLSID** or **RegisterEventCallbackProgram**, WIA notifies the running application and does not attempt to launch a new instance of the application because event registration through **RegisterEventCallbackInterface** takes precedence over both **RegisterEventCallbackCLSID** and **RegisterEventCallbackProgram**.</span></span>

> [!Note]  
> <span data-ttu-id="9a6f1-125">In un'applicazione multithread, non esiste alcuna garanzia che il thread in cui verrà restituito il callback di notifica degli eventi sia lo stesso thread che ha registrato il callback.</span><span class="sxs-lookup"><span data-stu-id="9a6f1-125">In a multi-threaded application, there is no guarantee that the thread that the event notification callback will return on is the same thread that registered the callback.</span></span>

 

 

 
