---
description: Le applicazioni vedono i dispositivi Windows Image Acquisition (WIA) come albero gerarchico di oggetti IWiaItem o IWiaItem2 con l'elemento radice che rappresenta il dispositivo stesso.
ms.assetid: ae4ded93-09be-4caa-ad6e-1a9071fdb4b6
title: Minidriver WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5aadaf55cfe2e8102d4e0e02cf9787b9696e327
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526412"
---
# <a name="wia-minidriver"></a><span data-ttu-id="0e7ff-103">Minidriver WIA</span><span class="sxs-lookup"><span data-stu-id="0e7ff-103">WIA Minidriver</span></span>

<span data-ttu-id="0e7ff-104">Le applicazioni vedono i dispositivi Windows Image Acquisition (WIA) come albero gerarchico di oggetti [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) o [**IWiaItem2**](-wia-iwiaitem2.md) con l'elemento radice che rappresenta il dispositivo stesso.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-104">Applications see Windows Image Acquisition (WIA) devices as a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects with the root item representing the device itself.</span></span> <span data-ttu-id="0e7ff-105">I dispositivi WIA possono essere utilizzati simultaneamente da più di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-105">WIA devices may be used concurrently by more than one application.</span></span> <span data-ttu-id="0e7ff-106">È pertanto necessario che la visualizzazione di un oggetto **IWiaItem** o **IWiaItem2** sia indipendente dalle viste di un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-106">It is therefore necessary that each application's view of an **IWiaItem** or **IWiaItem2** object be independent of another application's views.</span></span> <span data-ttu-id="0e7ff-107">Questa operazione viene eseguita con due oggetti Item diversi.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-107">This is accomplished by having two different item objects.</span></span> <span data-ttu-id="0e7ff-108">Il driver crea la struttura ad albero degli elementi del driver degli oggetti dell' [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , detti anche elementi driver, usando i metodi dei servizi del driver WIA.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-108">The driver creates the driver item tree of [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects, also called driver items, using the WIA driver services methods.</span></span> <span data-ttu-id="0e7ff-109">Si tratta di oggetti globali utilizzati dal driver per rappresentare gli elementi interni di ogni driver.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-109">These are global objects that the driver uses to represent each driver's internal items.</span></span> <span data-ttu-id="0e7ff-110">Quando un'applicazione crea un oggetto **IWiaItem** o **IWiaItem2** (detto anche elemento applicazione), questo oggetto viene collegato all' [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) corrispondente del driver nell'albero degli elementi del driver.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-110">When an application creates an **IWiaItem** or **IWiaItem2** object (also called an application item), this object is linked to the driver's corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) in the driver item tree.</span></span> <span data-ttu-id="0e7ff-111">Un conteggio dei riferimenti viene mantenuto nell'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) soggetto alle regole seguenti:</span><span class="sxs-lookup"><span data-stu-id="0e7ff-111">A reference count is maintained on the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object subject to the following rules:</span></span>

-   <span data-ttu-id="0e7ff-112">Quando un driver aggiunge un oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) all'albero degli elementi del driver, il conteggio dei riferimenti dell'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene incrementato.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-112">When a driver adds an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object to the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is incremented.</span></span> <span data-ttu-id="0e7ff-113">Questa operazione viene in genere eseguita durante [IWiaMiniDrv::D rvinitializewia](https://msdn.microsoft.com/library/ms794097.aspx) o quando \_ \_ viene elaborato un comando WIA cmd Synchronize.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-113">This typically takes place during [IWiaMiniDrv::drvInitializeWia](https://msdn.microsoft.com/library/ms794097.aspx) or when a WIA\_CMD\_SYNCHRONIZE command is processed.</span></span>
-   <span data-ttu-id="0e7ff-114">Quando un driver rimuove un oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) dall'albero degli elementi del driver, il conteggio dei riferimenti dell'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene decrementato e l'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene contrassegnato in modo da non poter accedere di nuovo al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-114">When a driver removes an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object from the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is marked so that it can't access the device again.</span></span> <span data-ttu-id="0e7ff-115">Questo problema si verifica in genere quando un dispositivo è disconnesso o viene eliminato un elemento.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-115">This typically takes place when a device is disconnected or an item is deleted.</span></span> <span data-ttu-id="0e7ff-116">Le applicazioni sono ancora in grado di leggere le proprietà da un oggetto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) o [**IWiaItem2**](-wia-iwiaitem2.md) anche quando l'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) corrispondente è stato rimosso dalla struttura ad albero degli elementi del driver.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-116">Applications are still able to read properties from an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object even when the corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object has been removed from the driver item tree.</span></span>
-   <span data-ttu-id="0e7ff-117">Quando viene creato un oggetto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) o [**IWiaItem2**](-wia-iwiaitem2.md) , questo viene collegato a un oggetto di [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) corrispondente.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-117">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is created it is linked to a corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object.</span></span> <span data-ttu-id="0e7ff-118">Il conteggio dei riferimenti dell'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene incrementato.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-118">The reference count of the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is incremented.</span></span>
-   <span data-ttu-id="0e7ff-119">Quando viene rilasciato un oggetto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) o [**IWiaItem2**](-wia-iwiaitem2.md) , il collegamento all'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) corrispondente viene interrotto e il conteggio dei riferimenti dell'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene decrementato.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-119">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is released, the link to its corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is severed and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented.</span></span>
-   <span data-ttu-id="0e7ff-120">Se il conteggio dei riferimenti di un oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) va a zero, l'oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-120">If an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count goes to zero, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is deleted.</span></span> <span data-ttu-id="0e7ff-121">Si applica a tutti gli oggetti dell' [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , incluso l'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-121">This applies to all [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects including the root item.</span></span> <span data-ttu-id="0e7ff-122">Il conteggio dei riferimenti di un oggetto [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) va a zero solo quando nessun elemento dell'applicazione vi fa riferimento e non è più collegato all'albero degli elementi del driver.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-122">An [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count only goes to zero when no application items reference it and it is no longer linked to the driver item tree.</span></span>

<span data-ttu-id="0e7ff-123">Utilizzando questo schema di conteggio dei riferimenti, molti oggetti [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) o [**IWiaItem2**](-wia-iwiaitem2.md) possono collegarsi a un' [interfaccia IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) senza interferenze.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-123">Using this reference counting scheme, many [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects may link to one [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) without interference.</span></span> <span data-ttu-id="0e7ff-124">Poiché ogni **IWiaItem** o **IWiaItem2** contiene la propria archiviazione delle proprietà, un'applicazione può continuare a leggere le proprietà degli elementi anche dopo l'eliminazione di un elemento, ma non verrà eseguita alcuna operazione che richiede l'accesso al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-124">Because each **IWiaItem** or **IWiaItem2** contains its own property storage, an application can continue to read item properties even after an item has been deleted, but no operation that requires access to the device will succeed.</span></span> <span data-ttu-id="0e7ff-125">Poiché le proprietà degli elementi vengono archiviate nell'oggetto **IWiaItem** o **IWiaItem2** , il driver deve impostare le proprietà dell'oggetto **IWiaItem** o **IWiaItem2** sul dispositivo prima del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="0e7ff-125">Because item properties are stored in the **IWiaItem** or **IWiaItem2** object, the driver must set the **IWiaItem** or **IWiaItem2** object's properties to the device before a data transfer.</span></span>

 

 



