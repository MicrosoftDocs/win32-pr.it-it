---
description: L'interfaccia IWiaImageFilter è un'interfaccia di estensione implementata dagli sviluppatori di filtri per l'elaborazione di immagini e chiamata da Windows Image Acquisition (WIA) 2,0.
ms.assetid: 2abe913b-bb2b-486d-a3f4-d5932433fc82
title: Interfaccia IWiaImageFilter (WIA. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- IWiaImageFilter
api_type:
- COM
api_location:
- Wia.h
ms.openlocfilehash: 8d859b79d15db627bb09cb60f758791a8b5860f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103881885"
---
# <a name="iwiaimagefilter-interface"></a><span data-ttu-id="58f03-103">Interfaccia IWiaImageFilter</span><span class="sxs-lookup"><span data-stu-id="58f03-103">IWiaImageFilter interface</span></span>

<span data-ttu-id="58f03-104">L'interfaccia **IWiaImageFilter** è un'interfaccia di estensione implementata dagli sviluppatori di filtri per l'elaborazione di immagini e chiamata da Windows Image Acquisition (WIA) 2,0.</span><span class="sxs-lookup"><span data-stu-id="58f03-104">The **IWiaImageFilter** interface is an extension interface implemented by image processing filter developers and called by Windows Image Acquisition (WIA) 2.0.</span></span>

## <a name="members"></a><span data-ttu-id="58f03-105">Membri</span><span class="sxs-lookup"><span data-stu-id="58f03-105">Members</span></span>

<span data-ttu-id="58f03-106">L'interfaccia **IWiaImageFilter** eredita dall'interfaccia [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="58f03-106">The **IWiaImageFilter** interface inherits from the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="58f03-107">**IWiaImageFilter** dispone anche di questi tipi di membri:</span><span class="sxs-lookup"><span data-stu-id="58f03-107">**IWiaImageFilter** also has these types of members:</span></span>

-   [<span data-ttu-id="58f03-108">Metodi</span><span class="sxs-lookup"><span data-stu-id="58f03-108">Methods</span></span>](#methods)

### <a name="methods"></a><span data-ttu-id="58f03-109">Metodi</span><span class="sxs-lookup"><span data-stu-id="58f03-109">Methods</span></span>

<span data-ttu-id="58f03-110">L'interfaccia **IWiaImageFilter** dispone di questi metodi.</span><span class="sxs-lookup"><span data-stu-id="58f03-110">The **IWiaImageFilter** interface has these methods.</span></span>



| <span data-ttu-id="58f03-111">Metodo</span><span class="sxs-lookup"><span data-stu-id="58f03-111">Method</span></span>                                                                | <span data-ttu-id="58f03-112">Descrizione</span><span class="sxs-lookup"><span data-stu-id="58f03-112">Description</span></span>                                                                                             |
|:----------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="58f03-113">**ApplyProperties**</span><span class="sxs-lookup"><span data-stu-id="58f03-113">**ApplyProperties**</span></span>](-wia-iwiaimagefilter-applyproperties.md)       | <span data-ttu-id="58f03-114">Consente al filtro di elaborazione delle immagini di scrivere di nuovo le proprietà sul driver (e sul dispositivo).</span><span class="sxs-lookup"><span data-stu-id="58f03-114">Enables the image processing filter to write properties back to the driver (and device).</span></span><br/>     |
| [<span data-ttu-id="58f03-115">**FilterPreviewImage**</span><span class="sxs-lookup"><span data-stu-id="58f03-115">**FilterPreviewImage**</span></span>](-wia-iwiaimagefilter-filterpreviewimage.md) | <span data-ttu-id="58f03-116">Filtra l'immagine di anteprima.</span><span class="sxs-lookup"><span data-stu-id="58f03-116">Filters the preview image.</span></span><br/>                                                                   |
| [<span data-ttu-id="58f03-117">**InitializeFilter**</span><span class="sxs-lookup"><span data-stu-id="58f03-117">**InitializeFilter**</span></span>](-wia-iwiaimagefilter-initializefilter.md)     | <span data-ttu-id="58f03-118">Inizializza il filtro.</span><span class="sxs-lookup"><span data-stu-id="58f03-118">Initializes the filter.</span></span> <span data-ttu-id="58f03-119">Chiamato da WIA 2,0 prima del download di ogni immagine.</span><span class="sxs-lookup"><span data-stu-id="58f03-119">Called by WIA 2.0 before each image download.</span></span> <br/>                       |
| [<span data-ttu-id="58f03-120">**SetNewCallback**</span><span class="sxs-lookup"><span data-stu-id="58f03-120">**SetNewCallback**</span></span>](-wia-iwiaimagefilter-setnewcallback.md)         | <span data-ttu-id="58f03-121">Imposta un nuovo callback dell'applicazione per il filtro di elaborazione dell'immagine da utilizzare per l'invio delle chiamate.</span><span class="sxs-lookup"><span data-stu-id="58f03-121">Sets a new application callback for the image processing filter to use for forwarding calls.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="58f03-122">Commenti</span><span class="sxs-lookup"><span data-stu-id="58f03-122">Remarks</span></span>

<span data-ttu-id="58f03-123">Gli sviluppatori del filtro per l'elaborazione delle immagini devono implementare questa interfaccia e l'interfaccia [**IWiaTransferCallback**](-wia-iwiatransfercallback.md) .</span><span class="sxs-lookup"><span data-stu-id="58f03-123">Image processing filter developers should implement this interface and the [**IWiaTransferCallback**](-wia-iwiatransfercallback.md) interface.</span></span>

<span data-ttu-id="58f03-124">WIA 2,0 chiama i metodi di filtro.</span><span class="sxs-lookup"><span data-stu-id="58f03-124">WIA 2.0 calls filter methods.</span></span> <span data-ttu-id="58f03-125">Non vengono mai chiamati direttamente da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="58f03-125">They are never called directly from an application.</span></span>

<span data-ttu-id="58f03-126">Microsoft fornisce il componente di anteprima WIA 2,0, che memorizza nella cache l'immagine di anteprima originale non filtrata acquisita dallo scanner.</span><span class="sxs-lookup"><span data-stu-id="58f03-126">Microsoft supplies the WIA 2.0 Preview Component, which caches the original, unfiltered preview image that is acquired from the scanner.</span></span> <span data-ttu-id="58f03-127">Un'applicazione utilizza [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) per creare co-creazione di un'istanza del componente WIA 2,0 Preview (CLSID \_ WiaPreview), che carica il filtro utilizzando [**IWiaItem2:: GetExtension**](-wia-iwiaitem2-getextension.md).</span><span class="sxs-lookup"><span data-stu-id="58f03-127">An application uses [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to co-create an instance of the WIA 2.0 Preview Component (CLSID\_WiaPreview), which loads the filter using [**IWiaItem2::GetExtension**](-wia-iwiaitem2-getextension.md).</span></span> <span data-ttu-id="58f03-128">Il filtro viene chiamato automaticamente quando l'applicazione chiama [**IWiaTransfer::D ownload**](-wia-iwiatransfer-download.md).</span><span class="sxs-lookup"><span data-stu-id="58f03-128">The filter is called automatically when the application calls [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md).</span></span>

<span data-ttu-id="58f03-129">Il filtro di elaborazione delle immagini viene sempre eseguito quando viene eseguita l'analisi di un'immagine.</span><span class="sxs-lookup"><span data-stu-id="58f03-129">The image processing filter is always executed when an image is scanned.</span></span> <span data-ttu-id="58f03-130">Un'applicazione non può acquisire un'immagine dallo scanner senza che sia stato applicato per primo il filtro per la creazione di immagini.</span><span class="sxs-lookup"><span data-stu-id="58f03-130">An application cannot acquire an image from the scanner without having the imaging filter applied first.</span></span>

<span data-ttu-id="58f03-131">Un filtro deve implementare una luminosità e un contrasto minimo.</span><span class="sxs-lookup"><span data-stu-id="58f03-131">A filter must implement brightness and contrast at a minimum.</span></span> <span data-ttu-id="58f03-132">L'interfaccia utente comune, che fornisce controlli di luminosità e contrasto all'utente, può visualizzare anteprime accurate per l'utente.</span><span class="sxs-lookup"><span data-stu-id="58f03-132">The common UI, which provides brightness and contrast controls to the user, can display accurate previews to the user.</span></span>

<span data-ttu-id="58f03-133">Un filtro di elaborazione immagini non deve mai modificare il membro *lMessage* della struttura [**WiaTransferParams**](-wia-wiatransferparams.md) .</span><span class="sxs-lookup"><span data-stu-id="58f03-133">An image processing filter should never modify the *lMessage* member of the [**WiaTransferParams**](-wia-wiatransferparams.md) structure.</span></span>

<span data-ttu-id="58f03-134">Per leggere le proprietà obbligatorie, il filtro di elaborazione delle immagini deve chiamare [**IWiaPropertyStorage:: GetPropertyStream**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiapropertystorage-getpropertystream) sull'interfaccia [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) ottenuta dall'elemento chiamando [IWiaImageFilter:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="58f03-134">To read the required properties the image processing filter should call [**IWiaPropertyStorage::GetPropertyStream**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiapropertystorage-getpropertystream) on the [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface that it gets from the item by calling [IWiaImageFilter::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span> <span data-ttu-id="58f03-135">Il filtro può quindi creare un'istanza di [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) in questo flusso per leggere le proprietà degli elementi.</span><span class="sxs-lookup"><span data-stu-id="58f03-135">The filter can then instantiate an [IPropertyStorage](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) instance on this stream to read the items properties.</span></span> <span data-ttu-id="58f03-136">Il filtro di elaborazione delle immagini non deve chiamare direttamente [IWiaPropertyStorage:: ReadMultiple](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) perché questo metodo effettua una chiamata all'oggetto del driver `drvReadItemProperties` , ma il servizio WIA 2,0 ha già bloccato il driver nella chiamata, in `drvAcquireItemData` modo che la chiamata venga interrotta e avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="58f03-136">The image processing filter should not call [IWiaPropertyStorage::ReadMultiple](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) directly because this method calls into the driver's `drvReadItemProperties`, but the WIA 2.0 service has already locked the driver in the `drvAcquireItemData` call so this call will timeout and fail.</span></span>

<span data-ttu-id="58f03-137">Le proprietà a cui è interessato il filtro possono ad esempio essere le impostazioni di luminosità e contrasto.</span><span class="sxs-lookup"><span data-stu-id="58f03-137">The properties that the filter is interested in could for example be the brightness and contrast settings.</span></span> <span data-ttu-id="58f03-138">Il filtro deve in genere anche leggere il formato dell'immagine, nonché la proprietà di anteprima, [**WIA \_ DPS \_ Preview**](-wia-wiaitempropscannerdevice.md), di *pWiaItem2*.</span><span class="sxs-lookup"><span data-stu-id="58f03-138">The filter typically also needs to read the image format as well as the preview property, [**WIA\_DPS\_PREVIEW**](-wia-wiaitempropscannerdevice.md), from *pWiaItem2*.</span></span> <span data-ttu-id="58f03-139">Queste proprietà vengono tutte utilizzate nel processo di filtraggio.</span><span class="sxs-lookup"><span data-stu-id="58f03-139">These properties are all used in the filtering process.</span></span>

<span data-ttu-id="58f03-140">I componenti WIA 2,0 scrivono sempre i dati non filtrati nel filtro di elaborazione delle immagini.</span><span class="sxs-lookup"><span data-stu-id="58f03-140">The WIA 2.0 components always writes unfiltered data into the image processing filter.</span></span> <span data-ttu-id="58f03-141">L'algoritmo di elaborazione delle immagini implementato dal flusso del filtro può filtrare i dati più di una volta e non è necessario preoccuparsi di produrre gli stessi risultati che filtrano i dati una sola volta.</span><span class="sxs-lookup"><span data-stu-id="58f03-141">The image processing algorithm implemented by the filter's stream can filter the data more than once and does not have to be concerned with producing the same results as filtering the data once.</span></span>

<span data-ttu-id="58f03-142">Il filtro deve prestare attenzione alla proprietà [**di \_ \_ Anteprima WIA DPS**](-wia-wiaitempropscannerdevice.md) , soprattutto se alcune attività correlate al filtro vengono gestite nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="58f03-142">The filter must pay attention to the [**WIA\_DPS\_PREVIEW**](-wia-wiaitempropscannerdevice.md) property, especially if some filter related tasks are handled in hardware.</span></span> <span data-ttu-id="58f03-143">Un determinato driver, ad esempio, può modificare la luminosità della lampada nell'hardware dello scanner, a seconda del modo in cui l'applicazione ha impostato la luminosità in un elemento WIA 2,0.</span><span class="sxs-lookup"><span data-stu-id="58f03-143">For example, a certain driver can change the brightness of the lamp in the scanner hardware depending on how the application has set the brightness into a WIA 2.0 item.</span></span> <span data-ttu-id="58f03-144">Durante l'analisi finale (quando l'applicazione chiama [**IWiaTransfer::D ownload**](-wia-iwiatransfer-download.md)), il driver in genere modifica la lampada fisica dello scanner.</span><span class="sxs-lookup"><span data-stu-id="58f03-144">During the final scan (when the application calls [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md)) the driver would typically modify the physical lamp of the scanner.</span></span> <span data-ttu-id="58f03-145">In questo caso il filtro di elaborazione delle immagini potrebbe non dover eseguire alcuna elaborazione della luminosità.</span><span class="sxs-lookup"><span data-stu-id="58f03-145">In this case the image processing filter may not have to perform any brightness processing at all.</span></span> <span data-ttu-id="58f03-146">Durante un'analisi di anteprima, tuttavia, il driver non deve modificare la luminosità della lampada, ma deve essere eseguita esclusivamente nel filtro di elaborazione delle immagini.</span><span class="sxs-lookup"><span data-stu-id="58f03-146">During a preview scan, however, the driver should not modify the brightness of the lamp—instead this should be taken care of solely in the image processing filter.</span></span> <span data-ttu-id="58f03-147">È importante che il componente di anteprima WIA 2,0 e il filtro di elaborazione immagini restituiscano immagini accurate in base alle proprietà impostate nell'elemento.</span><span class="sxs-lookup"><span data-stu-id="58f03-147">It is important that the WIA 2.0 Preview Component and the image processing filter return accurate images based on the properties set into the item.</span></span>

<span data-ttu-id="58f03-148">Un filtro di elaborazione immagini deve supportare tutti i formati di immagine supportati dal driver.</span><span class="sxs-lookup"><span data-stu-id="58f03-148">An image processing filter must support all image formats that the driver supports.</span></span>

<span data-ttu-id="58f03-149">Al filtro di elaborazione delle immagini viene sempre assegnata un'immagine corrispondente all'area di selezione impostata nell'elemento per il quale si sta acquisendo l'immagine.</span><span class="sxs-lookup"><span data-stu-id="58f03-149">The image processing filter is always given an image corresponding to the selection area set into the item for which we are acquiring the image.</span></span> <span data-ttu-id="58f03-150">Si noti, tuttavia, che l'immagine potrebbe essere stata ruotata dal driver in caso di supporto della proprietà di [**\_ \_ rotazione degli indirizzi IP WIA**](-wia-wiaitempropscanneritem.md) .</span><span class="sxs-lookup"><span data-stu-id="58f03-150">Note, however, that the image may have been rotated by the driver in case it supports the [**WIA\_IPS\_ROTATION**](-wia-wiaitempropscanneritem.md) property.</span></span>

<span data-ttu-id="58f03-151">Il filtro di elaborazione delle immagini viene creato tramite [**IWiaItem2:: GetExtension**](-wia-iwiaitem2-getextension.md), in genere non dall'applicazione, ma dai componenti WIA 2,0 quando un'applicazione chiama [**IWiaPreview:: GetNewPreview**](-wia-iwiapreview-getnewpreview.md) o [**IWiaTransfer::D ownload**](-wia-iwiatransfer-download.md).</span><span class="sxs-lookup"><span data-stu-id="58f03-151">The image processing filter is created through [**IWiaItem2::GetExtension**](-wia-iwiaitem2-getextension.md), typically not by the application but by WIA 2.0 components when an application calls [**IWiaPreview::GetNewPreview**](-wia-iwiapreview-getnewpreview.md) or [**IWiaTransfer::Download**](-wia-iwiatransfer-download.md).</span></span>

<span data-ttu-id="58f03-152">L'interfaccia **IWiaImageFilter** , come tutte le interfacce Component Object Model (com), eredita i metodi di interfaccia [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="58f03-152">The **IWiaImageFilter** interface, like all Component Object Model (COM) interfaces, inherits the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface methods.</span></span>



| <span data-ttu-id="58f03-153">Metodi IUnknown</span><span class="sxs-lookup"><span data-stu-id="58f03-153">IUnknown Methods</span></span>                                        | <span data-ttu-id="58f03-154">Descrizione</span><span class="sxs-lookup"><span data-stu-id="58f03-154">Description</span></span>                               |
|---------------------------------------------------------|-------------------------------------------|
| <span data-ttu-id="58f03-155">[IUnknown:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))</span><span class="sxs-lookup"><span data-stu-id="58f03-155">[IUnknown::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))</span></span> | <span data-ttu-id="58f03-156">Restituisce puntatori alle interfacce supportate.</span><span class="sxs-lookup"><span data-stu-id="58f03-156">Returns pointers to supported interfaces.</span></span> |
| [<span data-ttu-id="58f03-157">IUnknown:: AddRef</span><span class="sxs-lookup"><span data-stu-id="58f03-157">IUnknown::AddRef</span></span>](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)                 | <span data-ttu-id="58f03-158">Incrementa il conteggio dei riferimenti.</span><span class="sxs-lookup"><span data-stu-id="58f03-158">Increments reference count.</span></span>               |
| [<span data-ttu-id="58f03-159">IUnknown:: Release</span><span class="sxs-lookup"><span data-stu-id="58f03-159">IUnknown::Release</span></span>](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)               | <span data-ttu-id="58f03-160">Riduce il conteggio dei riferimenti.</span><span class="sxs-lookup"><span data-stu-id="58f03-160">Decrements reference count.</span></span>               |



 

## <a name="requirements"></a><span data-ttu-id="58f03-161">Requisiti</span><span class="sxs-lookup"><span data-stu-id="58f03-161">Requirements</span></span>



| <span data-ttu-id="58f03-162">Requisito</span><span class="sxs-lookup"><span data-stu-id="58f03-162">Requirement</span></span> | <span data-ttu-id="58f03-163">Valore</span><span class="sxs-lookup"><span data-stu-id="58f03-163">Value</span></span> |
|-------------------------------------|------------------------------------------------------------------------------------|
| <span data-ttu-id="58f03-164">Client minimo supportato</span><span class="sxs-lookup"><span data-stu-id="58f03-164">Minimum supported client</span></span><br/> | <span data-ttu-id="58f03-165">\[Solo app desktop di Windows Vista\]</span><span class="sxs-lookup"><span data-stu-id="58f03-165">Windows Vista \[desktop apps only\]</span></span><br/>                                     |
| <span data-ttu-id="58f03-166">Server minimo supportato</span><span class="sxs-lookup"><span data-stu-id="58f03-166">Minimum supported server</span></span><br/> | <span data-ttu-id="58f03-167">\[Solo app desktop Windows Server 2008\]</span><span class="sxs-lookup"><span data-stu-id="58f03-167">Windows Server 2008 \[desktop apps only\]</span></span><br/>                               |
| <span data-ttu-id="58f03-168">Intestazione</span><span class="sxs-lookup"><span data-stu-id="58f03-168">Header</span></span><br/>                   | <dl> <span data-ttu-id="58f03-169"><dt>WIA. h</dt></span><span class="sxs-lookup"><span data-stu-id="58f03-169"><dt>Wia.h</dt></span></span> </dl>   |
| <span data-ttu-id="58f03-170">IDL</span><span class="sxs-lookup"><span data-stu-id="58f03-170">IDL</span></span><br/>                      | <dl> <span data-ttu-id="58f03-171"><dt>WIA. idl</dt></span><span class="sxs-lookup"><span data-stu-id="58f03-171"><dt>Wia.idl</dt></span></span> </dl> |



 

 
