---
description: Quando si verifica un errore, la maggior parte delle funzioni di sistema restituisce un codice di errore, in genere 0, NULL o &\# 8211; 1.
ms.assetid: fd5b0d6e-78cf-4f51-b61d-d32576cd485a
title: Codice Last-Error
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80bf0fe2f544fc3d87690be81b0d09767745ef95
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103965973"
---
# <a name="last-error-code"></a><span data-ttu-id="371eb-103">Codice Last-Error</span><span class="sxs-lookup"><span data-stu-id="371eb-103">Last-Error Code</span></span>

<span data-ttu-id="371eb-104">Quando si verifica un errore, la maggior parte delle funzioni di sistema restituisce un codice di errore, in genere 0, **null** o-1.</span><span class="sxs-lookup"><span data-stu-id="371eb-104">When an error occurs, most system functions return an error code, usually 0, **NULL**, or –1.</span></span> <span data-ttu-id="371eb-105">Molte funzioni di sistema impostano inoltre un codice di errore aggiuntivo denominato *ultimo codice di errore*.</span><span class="sxs-lookup"><span data-stu-id="371eb-105">Many system functions also set an additional error code called the *last-error code*.</span></span> <span data-ttu-id="371eb-106">Questo codice di errore viene mantenuto separatamente per ogni thread in esecuzione. un errore in un thread non sovrascrive il codice dell'ultimo errore in un altro thread.</span><span class="sxs-lookup"><span data-stu-id="371eb-106">This error code is maintained separately for each running thread; an error in one thread does not overwrite the last-error code in another thread.</span></span> <span data-ttu-id="371eb-107">Qualsiasi funzione può chiamare la funzione [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) o [**SetLastErrorEx**](/windows/desktop/api/Winuser/nf-winuser-setlasterrorex) per impostare il codice dell'ultimo errore per il thread corrente.</span><span class="sxs-lookup"><span data-stu-id="371eb-107">Any function can call the [**SetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror) or [**SetLastErrorEx**](/windows/desktop/api/Winuser/nf-winuser-setlasterrorex) function to set the last-error code for the current thread.</span></span> <span data-ttu-id="371eb-108">Queste funzioni sono destinate principalmente alle librerie di collegamento dinamico (DLL), in modo che possano fornire informazioni all'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="371eb-108">These functions are intended primarily for dynamic-link libraries (DLL), so they can provide information to the calling application.</span></span> <span data-ttu-id="371eb-109">Si noti che alcune funzioni chiamano **SetLastError** o **SetLastErrorEx** con 0 quando hanno esito positivo, cancellando il codice di errore impostato dalla funzione non riuscita più di recente, mentre altri no.</span><span class="sxs-lookup"><span data-stu-id="371eb-109">Note that some functions call **SetLastError** or **SetLastErrorEx** with 0 when they succeed, wiping out the error code set by the most recently failed function, while others do not.</span></span>

<span data-ttu-id="371eb-110">Un'applicazione può recuperare il codice dell'ultimo errore utilizzando la funzione [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) ; il codice di errore può indicare altre informazioni su ciò che si è verificato in realtà perché la funzione ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="371eb-110">An application can retrieve the last-error code by using the [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) function; the error code may tell more about what actually occurred to make the function fail.</span></span> <span data-ttu-id="371eb-111">La documentazione per le funzioni di sistema indicherà le condizioni in base alle quali la funzione imposta il codice dell'ultimo errore.</span><span class="sxs-lookup"><span data-stu-id="371eb-111">The documentation for system functions will indicate the conditions under which the function sets the last-error code.</span></span>

<span data-ttu-id="371eb-112">Il sistema definisce un set di codici di errore che possono essere impostati come ultimi codici di errore o restituiti da queste funzioni.</span><span class="sxs-lookup"><span data-stu-id="371eb-112">The system defines a set of error codes that can be set as last-error codes or be returned by these functions.</span></span> <span data-ttu-id="371eb-113">I codici di errore sono valori a 32 bit (il bit 31 è il bit più significativo).</span><span class="sxs-lookup"><span data-stu-id="371eb-113">Error codes are 32-bit values (bit 31 is the most significant bit).</span></span> <span data-ttu-id="371eb-114">Il bit 29 è riservato ai codici di errore definiti dall'applicazione; Questo bit non è impostato per nessun codice di errore di sistema.</span><span class="sxs-lookup"><span data-stu-id="371eb-114">Bit 29 is reserved for application-defined error codes; no system error code has this bit set.</span></span> <span data-ttu-id="371eb-115">Se si definiscono i codici di errore per l'applicazione, impostare questo bit per indicare che il codice di errore è stato definito da un'applicazione e per assicurarsi che i codici di errore non siano in conflitto con i codici di errore definiti dal sistema.</span><span class="sxs-lookup"><span data-stu-id="371eb-115">If you define error codes for your application, set this bit to indicate that the error code has been defined by an application and to ensure that the error codes do not conflict with any system-defined error codes.</span></span> <span data-ttu-id="371eb-116">Per ulteriori informazioni, vedere WinError. h e [codici di errore di sistema](system-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="371eb-116">For more information, see WinError.h and [System Error Codes](system-error-codes.md).</span></span>

 

 
