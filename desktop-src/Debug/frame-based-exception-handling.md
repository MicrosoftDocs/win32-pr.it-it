---
description: Un gestore di eccezioni basato su frame consente di gestire la possibilità che un'eccezione possa verificarsi in una determinata sequenza di codice. Un gestore di eccezioni basato su frame è costituito dagli elementi seguenti.
ms.assetid: 07aac772-f917-48b7-91a9-3b5d4cb43600
title: Gestione delle eccezioni basata su frame
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12b268b5d02de83bca22a1d3311905b05be1f748
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104483508"
---
# <a name="frame-based-exception-handling"></a><span data-ttu-id="5aacf-104">Gestione delle eccezioni basata su frame</span><span class="sxs-lookup"><span data-stu-id="5aacf-104">Frame-based Exception Handling</span></span>

<span data-ttu-id="5aacf-105">Un *gestore di eccezioni basato su frame* consente di gestire la possibilità che un'eccezione possa verificarsi in una determinata sequenza di codice.</span><span class="sxs-lookup"><span data-stu-id="5aacf-105">A *frame-based exception handler* allows you to deal with the possibility that an exception may occur in a certain sequence of code.</span></span> <span data-ttu-id="5aacf-106">Un gestore di eccezioni basato su frame è costituito dagli elementi seguenti.</span><span class="sxs-lookup"><span data-stu-id="5aacf-106">A frame-based exception handler consists of the following elements.</span></span>

-   <span data-ttu-id="5aacf-107">Corpo sorvegliato del codice</span><span class="sxs-lookup"><span data-stu-id="5aacf-107">A guarded body of code</span></span>
-   <span data-ttu-id="5aacf-108">Espressione di filtro</span><span class="sxs-lookup"><span data-stu-id="5aacf-108">A filter expression</span></span>
-   <span data-ttu-id="5aacf-109">Un blocco del gestore di eccezioni</span><span class="sxs-lookup"><span data-stu-id="5aacf-109">An exception-handler block</span></span>

<span data-ttu-id="5aacf-110">I gestori di eccezioni basati su frame sono dichiarati nella sintassi specifica del linguaggio.</span><span class="sxs-lookup"><span data-stu-id="5aacf-110">Frame-based exception handlers are declared in language-specific syntax.</span></span> <span data-ttu-id="5aacf-111">Nel compilatore Microsoft C/C++ Optimizing, ad esempio, vengono implementate usando **\_ \_ try** e **\_ \_ except**.</span><span class="sxs-lookup"><span data-stu-id="5aacf-111">For example, in the Microsoft C/C++ Optimizing Compiler, they are implemented using **\_\_try** and **\_\_except**.</span></span> <span data-ttu-id="5aacf-112">Per ulteriori informazioni, vedere [sintassi del gestore](handler-syntax.md).</span><span class="sxs-lookup"><span data-stu-id="5aacf-112">For more information, see [Handler Syntax](handler-syntax.md).</span></span>

<span data-ttu-id="5aacf-113">Il *corpo sorvegliato del codice* è un set di una o più istruzioni per le quali l'espressione di filtro e il blocco del gestore di eccezioni forniscono la protezione per la gestione delle eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-113">The *guarded body of code* is a set of one or more statements for which the filter expression and the exception-handler block provide exception-handling protection.</span></span> <span data-ttu-id="5aacf-114">Il corpo sorvegliato può essere un blocco di codice, un set di blocchi annidati o un'intera routine o funzione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-114">The guarded body can be a block of code, a set of nested blocks, or an entire procedure or function.</span></span> <span data-ttu-id="5aacf-115">Utilizzando il compilatore di ottimizzazione Microsoft C/C++, un corpo sorvegliato è racchiuso tra parentesi graffe ( {} ) che seguono la parola chiave **\_ \_ try** .</span><span class="sxs-lookup"><span data-stu-id="5aacf-115">Using the Microsoft C/C++ Optimizing Compiler, a guarded body is enclosed by braces ({}) following the **\_\_try** keyword.</span></span>

<span data-ttu-id="5aacf-116">L' *espressione di filtro* di un gestore di eccezioni basato su frame è un'espressione valutata dal sistema quando si verifica un'eccezione all'interno del corpo sorvegliato.</span><span class="sxs-lookup"><span data-stu-id="5aacf-116">The *filter expression* of a frame-based exception handler is an expression that is evaluated by the system when an exception occurs within the guarded body.</span></span> <span data-ttu-id="5aacf-117">Questa valutazione comporta una delle azioni seguenti da parte del sistema.</span><span class="sxs-lookup"><span data-stu-id="5aacf-117">This evaluation results in one of the following actions by the system.</span></span>

-   <span data-ttu-id="5aacf-118">Il sistema arresta la ricerca di un gestore di eccezioni, ripristina lo stato del computer e continua l'esecuzione del thread nel momento in cui si è verificata l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-118">The system stops its search for an exception handler, restores the machine state, and continues thread execution at the point at which the exception occurred.</span></span>
-   <span data-ttu-id="5aacf-119">Il sistema continua la ricerca di un gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-119">The system continues its search for an exception handler.</span></span>
-   <span data-ttu-id="5aacf-120">Il sistema trasferisce il controllo al gestore di eccezioni e l'esecuzione del thread continua in sequenza nei stack frame in cui viene trovato il gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-120">The system transfers control to the exception handler, and thread execution continues sequentially in the stack frame in which the exception handler is found.</span></span> <span data-ttu-id="5aacf-121">Se il gestore non si trova nel stack frame in cui si è verificata l'eccezione, il sistema rimuove lo stack, lasciando l'stack frame corrente e gli altri stack frame fino a quando non torna al stack frame del gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-121">If the handler is not in the stack frame in which the exception occurred, the system unwinds the stack, leaving the current stack frame and any other stack frames until it is back to the exception handler's stack frame.</span></span> <span data-ttu-id="5aacf-122">Prima dell'esecuzione di un gestore di eccezioni, i gestori di terminazione vengono eseguiti per tutti i corpi di codice sorvegliati che terminano come risultato del trasferimento del controllo al gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-122">Before an exception handler is executed, termination handlers are executed for any guarded bodies of code that terminated as a result of the transfer of control to the exception handler.</span></span> <span data-ttu-id="5aacf-123">Per ulteriori informazioni sui gestori di terminazione, vedere la sezione relativa alla [gestione della terminazione](termination-handling.md).</span><span class="sxs-lookup"><span data-stu-id="5aacf-123">For more information about termination handlers, refer to [Termination Handling](termination-handling.md).</span></span>

<span data-ttu-id="5aacf-124">L'espressione di filtro può essere un'espressione semplice oppure può richiamare una *funzione di filtro* che tenta di gestire l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-124">The filter expression can be a simple expression, or it can invoke a *filter function* that attempts to handle the exception.</span></span> <span data-ttu-id="5aacf-125">È possibile chiamare le funzioni [**GetExceptionCode**](getexceptioncode.md) e [**GetExceptionInformation**](getexceptioninformation.md) dall'interno di un'espressione di filtro per ottenere informazioni sull'eccezione da filtrare.</span><span class="sxs-lookup"><span data-stu-id="5aacf-125">You can call the [**GetExceptionCode**](getexceptioncode.md) and [**GetExceptionInformation**](getexceptioninformation.md) functions from within a filter expression to get information about the exception being filtered.</span></span> <span data-ttu-id="5aacf-126">**GetExceptionCode** restituisce un codice che identifica il tipo di eccezione e **GetExceptionInformation** restituisce un puntatore a una struttura [**di \_ puntatori di eccezione**](/windows/desktop/api/WinNT/ns-winnt-exception_pointers) che contiene i puntatori alle strutture di [**\_ record**](/windows/desktop/api/WinNT/ns-winnt-exception_record) di [**contesto**](/windows/desktop/api/WinNT/ns-winnt-arm64_nt_context) e di eccezione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-126">**GetExceptionCode** returns a code that identifies the type of exception, and **GetExceptionInformation** returns a pointer to an [**EXCEPTION\_POINTERS**](/windows/desktop/api/WinNT/ns-winnt-exception_pointers) structure that contains pointers to [**CONTEXT**](/windows/desktop/api/WinNT/ns-winnt-arm64_nt_context) and [**EXCEPTION\_RECORD**](/windows/desktop/api/WinNT/ns-winnt-exception_record) structures.</span></span>

<span data-ttu-id="5aacf-127">Queste funzioni non possono essere chiamate dall'interno di una funzione di filtro, ma i valori restituiti possono essere passati come parametri a una funzione di filtro.</span><span class="sxs-lookup"><span data-stu-id="5aacf-127">These functions cannot be called from within a filter function, but their return values can be passed as parameters to a filter function.</span></span> <span data-ttu-id="5aacf-128">[**GetExceptionCode**](getexceptioncode.md) può essere usato all'interno del blocco del gestore di eccezioni, ma [**GetExceptionInformation**](getexceptioninformation.md) non può perché le informazioni a cui fa riferimento sono in genere nello stack e vengono distrutte quando il controllo viene trasferito a un gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-128">[**GetExceptionCode**](getexceptioncode.md) can be used within the exception-handler block, but [**GetExceptionInformation**](getexceptioninformation.md) cannot because the information it points to is typically on the stack and is destroyed when control is transferred to an exception handler.</span></span> <span data-ttu-id="5aacf-129">Tuttavia, un'applicazione può copiare le informazioni nell'archiviazione sicura per renderla disponibile al gestore di eccezioni.</span><span class="sxs-lookup"><span data-stu-id="5aacf-129">However, an application can copy the information to safe storage to make it available to the exception handler.</span></span>

<span data-ttu-id="5aacf-130">Il vantaggio di una funzione di filtro è che può gestire un'eccezione e restituire un valore che determina la continuazione dell'esecuzione del sistema dal punto in cui si è verificata l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-130">The advantage of a filter function is that it can handle an exception and return a value that causes the system to continue execution from the point at which the exception occurred.</span></span> <span data-ttu-id="5aacf-131">Con un blocco del gestore di eccezioni, l'esecuzione continua in sequenza dal gestore di eccezioni anziché dal punto dell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5aacf-131">With an exception-handler block, in contrast, execution continues sequentially from the exception handler rather than from the point of the exception.</span></span>

<span data-ttu-id="5aacf-132">La gestione di un'eccezione può essere semplice quanto si noti un errore e impostare un flag che verrà esaminato in seguito, stampando un messaggio di avviso o di errore o eseguendo un'altra azione limitata.</span><span class="sxs-lookup"><span data-stu-id="5aacf-132">Handling an exception may be as simple as noting an error and setting a flag that will be examined later, printing a warning or error message, or taking some other limited action.</span></span> <span data-ttu-id="5aacf-133">Se è possibile continuare l'esecuzione, potrebbe essere necessario modificare lo stato del computer modificando il record di contesto.</span><span class="sxs-lookup"><span data-stu-id="5aacf-133">If execution can be continued, it may also be necessary to change the machine state by modifying the context record.</span></span> <span data-ttu-id="5aacf-134">Per un esempio di funzione di filtro che gestisce un'eccezione di errore di pagina, vedere [utilizzo delle funzioni di memoria virtuale](../memory/using-the-memory-management-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5aacf-134">For an example of a filter function that handles a page fault exception, see [Using the Virtual Memory Functions](../memory/using-the-memory-management-functions.md).</span></span>

<span data-ttu-id="5aacf-135">La funzione [**UnhandledExceptionFilter**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-unhandledexceptionfilter) può essere utilizzata come funzione di filtro in un'espressione di filtro.</span><span class="sxs-lookup"><span data-stu-id="5aacf-135">The [**UnhandledExceptionFilter**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-unhandledexceptionfilter) function can be used as a filter function in a filter expression.</span></span> <span data-ttu-id="5aacf-136">Restituisce \_ \_ il gestore di esecuzione dell'eccezione, a meno che non sia in corso il debug del processo. in tal caso, viene restituita l'eccezione \_ \_ ricerca continua.</span><span class="sxs-lookup"><span data-stu-id="5aacf-136">It returns EXCEPTION\_EXECUTE\_HANDLER unless the process is being debugged, in which case it returns EXCEPTION\_CONTINUE\_SEARCH.</span></span>

 

 
