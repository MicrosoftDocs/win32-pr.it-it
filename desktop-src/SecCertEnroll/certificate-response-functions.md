---
description: Implementa l'interfaccia metodo IX509Enrollment.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Funzioni di risposta del certificato
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314726"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="6c864-103">Funzioni di risposta del certificato</span><span class="sxs-lookup"><span data-stu-id="6c864-103">Certificate Response Functions</span></span>

<span data-ttu-id="6c864-104">CertEnroll.dll implementa l'interfaccia [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) per inviare una richiesta di certificato client e installare la risposta da un' [*autorità di certificazione*](/windows/desktop/SecGloss/c-gly) (CA).</span><span class="sxs-lookup"><span data-stu-id="6c864-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="6c864-105">Il processo di registrazione può supportare i tre scenari seguenti:</span><span class="sxs-lookup"><span data-stu-id="6c864-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="6c864-106">Registrazione fuori banda</span><span class="sxs-lookup"><span data-stu-id="6c864-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="6c864-107">Chiamare qualsiasi metodo di inizializzazione implementato dall'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6c864-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6c864-108">Chiamare il metodo [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) per recuperare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="6c864-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="6c864-109">Inviare la richiesta fuori banda (manualmente o tramite un altro processo).</span><span class="sxs-lookup"><span data-stu-id="6c864-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="6c864-110">Ricevere la risposta da un'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="6c864-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="6c864-111">Chiamare il metodo [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6c864-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="6c864-112">Registrazione automatica</span><span class="sxs-lookup"><span data-stu-id="6c864-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="6c864-113">Chiamare qualsiasi metodo di inizializzazione implementato dall'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6c864-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6c864-114">Chiamare il metodo di [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) .</span><span class="sxs-lookup"><span data-stu-id="6c864-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="6c864-115">Registrazione ritardata</span><span class="sxs-lookup"><span data-stu-id="6c864-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="6c864-116">Chiamare qualsiasi metodo di inizializzazione implementato dall'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6c864-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6c864-117">Chiamare il metodo [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) per recuperare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="6c864-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="6c864-118">Archiviare la richiesta fino a quando non si è pronti per l'invio.</span><span class="sxs-lookup"><span data-stu-id="6c864-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="6c864-119">Quando si è pronti per la registrazione, chiamare il metodo [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) per reinizializzare l'oggetto di registrazione.</span><span class="sxs-lookup"><span data-stu-id="6c864-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="6c864-120">Chiamare il metodo [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) quando la CA restituisce un certificato.</span><span class="sxs-lookup"><span data-stu-id="6c864-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="6c864-121">Durante il processo di registrazione, è possibile chiamare la proprietà [**status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) nell'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) per recuperare un valore di enumerazione [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) che indica se la registrazione ha avuto esito positivo, è in sospeso, è stata ignorata, ha generato un errore o è stata negata.</span><span class="sxs-lookup"><span data-stu-id="6c864-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="6c864-122">Ognuna delle sezioni seguenti identifica una funzione esportata da Xenroll.dll per installare una risposta del certificato da un'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="6c864-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="6c864-123">In ogni sezione viene inoltre illustrato come utilizzare CertEnroll.dll per sostituire la funzione o indicare che non esiste alcun mapping tra le due librerie:</span><span class="sxs-lookup"><span data-stu-id="6c864-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="6c864-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="6c864-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="6c864-125">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="6c864-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6c864-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="6c864-127">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6c864-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="6c864-128">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="6c864-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="6c864-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="6c864-130">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6c864-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="6c864-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6c864-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="6c864-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="6c864-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="6c864-133">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="6c864-134">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="6c864-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="6c864-135">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="6c864-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="6c864-136">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6c864-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="6c864-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="6c864-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="6c864-138">La funzione [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) in Xenroll.dll installa una risposta [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) da un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="6c864-139">La libreria CertEnroll.dll non implementa direttamente le funzionalità per installare una \# risposta del certificato PKCS 7 da un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="6c864-140">È tuttavia possibile creare una funzione personalizzata per leggere i dati del file in una matrice di byte e chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare la risposta.</span><span class="sxs-lookup"><span data-stu-id="6c864-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="6c864-141">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione di un certificato senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-142">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-143">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="6c864-144">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="6c864-145">La funzione [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) in Xenroll.dll installa una \# risposta del certificato PKCS 7 o CMC da un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="6c864-146">La libreria CertEnroll.dll non implementa direttamente le funzionalità per installare una risposta del certificato da un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="6c864-147">È tuttavia possibile creare una funzione personalizzata per leggere i dati dei file in una matrice di byte e chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare la \# risposta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="6c864-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="6c864-148">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione di un certificato senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-149">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-150">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="6c864-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6c864-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="6c864-152">La funzione [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) in Xenroll.dll installa una \# risposta PKCS 7 contenuta in una matrice di byte.</span><span class="sxs-lookup"><span data-stu-id="6c864-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="6c864-153">Per installare un messaggio PKCS 7, è possibile chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) \# .</span><span class="sxs-lookup"><span data-stu-id="6c864-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="6c864-154">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione della \# risposta PKCS 7 senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-155">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-156">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="6c864-157">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6c864-157">acceptResponseBlob</span></span>

<span data-ttu-id="6c864-158">La funzione [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) in Xenroll.dll installa una \# risposta del certificato PKCS 7 o CMC contenuta in una matrice di byte.</span><span class="sxs-lookup"><span data-stu-id="6c864-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="6c864-159">È possibile chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare una \# risposta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="6c864-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6c864-160">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione della risposta senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-161">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-162">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="6c864-163">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="6c864-164">La funzione [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) in Xenroll.dll Recupera il certificato client da un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="6c864-165">La libreria CertEnroll.dll non implementa direttamente le funzionalità per recuperare un certificato da una risposta della CA salvata in un file.</span><span class="sxs-lookup"><span data-stu-id="6c864-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="6c864-166">È tuttavia possibile creare una funzione personalizzata per leggere i dati dei file in una matrice di byte e chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare la \# risposta PKCS 7 o CMC e chiamare la proprietà [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) per recuperare il certificato.</span><span class="sxs-lookup"><span data-stu-id="6c864-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="6c864-167">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione di un certificato senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-168">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-169">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="6c864-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="6c864-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="6c864-171">La funzione [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) in Xenroll.dll Recupera il certificato client da una \# risposta PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="6c864-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="6c864-172">È possibile chiamare la proprietà [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) sull'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) per recuperare un certificato dopo aver chiamato il metodo di [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6c864-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="6c864-173">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6c864-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="6c864-174">La funzione [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) in Xenroll.dll recupera un certificato client da una \# risposta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="6c864-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="6c864-175">È possibile chiamare la proprietà [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) sull'oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) per recuperare un certificato dopo aver chiamato il metodo di [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6c864-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="6c864-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6c864-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="6c864-177">La funzione [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) in Xenroll.dll installa una \# risposta PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="6c864-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="6c864-178">È possibile chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare una \# risposta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="6c864-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6c864-179">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione della risposta senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-180">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-181">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="6c864-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="6c864-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="6c864-183">La funzione [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) in Xenroll.dll installa una \# risposta PKCS 7 e restituisce il numero di certificati installati.</span><span class="sxs-lookup"><span data-stu-id="6c864-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="6c864-184">È possibile chiamare [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) per installare una \# risposta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="6c864-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6c864-185">Se si specifica il valore **AllowNoOutstandingRequest** dell'enumerazione [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) per il primo parametro di [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), non è necessario un certificato fittizio, in modo da consentire l'installazione della risposta senza prima chiamare [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6c864-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6c864-186">Tuttavia, se si installa un certificato usando uno script Web, deve esistere un certificato fittizio nell'archivio richieste.</span><span class="sxs-lookup"><span data-stu-id="6c864-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6c864-187">È pertanto necessario specificare **AllowNone** per il primo parametro.</span><span class="sxs-lookup"><span data-stu-id="6c864-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="6c864-188">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="6c864-188">SPCFileNameWStr</span></span>

<span data-ttu-id="6c864-189">La funzione [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) in Xenroll.dll specifica o Recupera il nome del file in cui salvare la risposta al certificato.</span><span class="sxs-lookup"><span data-stu-id="6c864-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="6c864-190">La libreria CertEnroll.dll non implementa la funzionalità che consente di copiare un certificato in un file specifico.</span><span class="sxs-lookup"><span data-stu-id="6c864-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="6c864-191">Il processo di registrazione installa automaticamente la catena di certificati in file negli archivi appropriati.</span><span class="sxs-lookup"><span data-stu-id="6c864-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="6c864-192">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="6c864-192">WriteCertToCSP</span></span>

<span data-ttu-id="6c864-193">La funzione [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) in Xenroll.dll specifica o recupera un valore booleano che indica se un certificato deve essere scritto in un [*provider del servizio di crittografia*](/windows/desktop/SecGloss/c-gly) (CSP).</span><span class="sxs-lookup"><span data-stu-id="6c864-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="6c864-194">In genere, se questa funzione viene chiamata, il provider è una [*Smart Card*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="6c864-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="6c864-195">In CertEnroll.dll, quando un client chiama il metodo di [**registrazione**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) per inviare una richiesta per un certificato smart card e viene emesso un certificato, [**registra**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) installa automaticamente il certificato nella smart card, presupponendo che la scheda sia installata nel lettore.</span><span class="sxs-lookup"><span data-stu-id="6c864-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="6c864-196">Anche il metodo [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) scrive automaticamente il certificato nella smart card.</span><span class="sxs-lookup"><span data-stu-id="6c864-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="6c864-197">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="6c864-197">WriteCertToUserDS</span></span>

<span data-ttu-id="6c864-198">La funzione [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) in Xenroll.dll specifica o recupera un valore booleano che indica se un certificato deve essere salvato nell'archivio Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6c864-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="6c864-199">La libreria CertEnroll.dll non implementa la funzionalità che consente di specificare un archivio in cui copiare un certificato.</span><span class="sxs-lookup"><span data-stu-id="6c864-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6c864-200">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="6c864-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6c864-201">Mapping Xenroll.dll CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="6c864-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="6c864-202">**Metodo IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="6c864-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
