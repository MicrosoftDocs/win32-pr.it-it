---
description: Crea una richiesta PKCS \# 10 personalizzata, la invia a un'autorità di certificazione (CA) autonoma e installa il certificato emesso nell'archivio certificati.
ms.assetid: dcb69d7e-457e-457b-9eea-15676ed710aa
title: enrollCustomPKCS10
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86ad95f483d4bc82136865e94a70ad46e90e1c24
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308120"
---
# <a name="enrollcustompkcs10"></a><span data-ttu-id="31c8a-103">enrollCustomPKCS10</span><span class="sxs-lookup"><span data-stu-id="31c8a-103">enrollCustomPKCS10</span></span>

<span data-ttu-id="31c8a-104">L'esempio enrollCustomPKCS10 crea una richiesta PKCS \# 10 personalizzata, la invia a un'autorità di certificazione (CA) autonoma e installa il certificato emesso nell'archivio certificati.</span><span class="sxs-lookup"><span data-stu-id="31c8a-104">The enrollCustomPKCS10 sample creates a custom PKCS \#10 request, submits it to a stand-alone certification authority (CA), and installs the issued certificate in the certificate store.</span></span> <span data-ttu-id="31c8a-105">Una CA autonoma non richiede Active Directory e non usa i modelli.</span><span class="sxs-lookup"><span data-stu-id="31c8a-105">A stand-alone CA does not require Active Directory and does not use templates.</span></span>

## <a name="location"></a><span data-ttu-id="31c8a-106">Location</span><span class="sxs-lookup"><span data-stu-id="31c8a-106">Location</span></span>

<span data-ttu-id="31c8a-107">Quando si installa il Software Development Kit (SDK) di Microsoft Windows, l'esempio viene installato per impostazione predefinita nella cartella *% ProgramFiles%* \\ Microsoft SDK \\ Windows \\ v 7.0 \\ Samples \\ Security \\ X509 certificate \\ VC \\ enrollCustomPKCS10</span><span class="sxs-lookup"><span data-stu-id="31c8a-107">When you install the Microsoft Windows Software Development Kit (SDK), the sample is installed, by default, in the *%ProgramFiles%*\\Microsoft SDKs\\Windows\\v7.0\\Samples\\Security\\X509 Certificate Enrollment\\VC\\enrollCustomPKCS10 folder.</span></span>

## <a name="discussion"></a><span data-ttu-id="31c8a-108">Discussione</span><span class="sxs-lookup"><span data-stu-id="31c8a-108">Discussion</span></span>

<span data-ttu-id="31c8a-109">Esempio enrollCustomPKCS10:</span><span class="sxs-lookup"><span data-stu-id="31c8a-109">The enrollCustomPKCS10 sample:</span></span>

1.  <span data-ttu-id="31c8a-110">Elabora gli argomenti della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="31c8a-110">Processes the command line arguments.</span></span> <span data-ttu-id="31c8a-111">La riga di comando deve contenere il nome del soggetto del certificato X. 500, il nome del messaggio di posta elettronica (RFC822) e un identificatore di oggetto (EKU) di utilizzo chiavi avanzato.</span><span class="sxs-lookup"><span data-stu-id="31c8a-111">The command line should contain the X.500 certificate subject name, the email (RFC822) name, and an Enhanced Key Usage (EKU) object identifier (OID).</span></span> <span data-ttu-id="31c8a-112">Ad esempio, è possibile specificare gli argomenti seguenti per la registrazione *user1@example.com* :</span><span class="sxs-lookup"><span data-stu-id="31c8a-112">For example, you can specify the following arguments to enroll *user1@example.com*:</span></span>
    -   <span data-ttu-id="31c8a-113">Nome soggetto: "*CN = User1, DC = example, DC = com*"</span><span class="sxs-lookup"><span data-stu-id="31c8a-113">Subject name: "*CN=user1,DC=example,DC=com*"</span></span>
    -   <span data-ttu-id="31c8a-114">Nome RFC822: *user1@example.com*</span><span class="sxs-lookup"><span data-stu-id="31c8a-114">RFC822 name: *user1@example.com*</span></span>
    -   <span data-ttu-id="31c8a-115">IDENTIFICATORE EKU di autenticazione client: 1.3.6.1.5.5.7.3.2</span><span class="sxs-lookup"><span data-stu-id="31c8a-115">Client authentication EKU OID: 1.3.6.1.5.5.7.3.2</span></span>
2.  <span data-ttu-id="31c8a-116">Crea un oggetto [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) e lo inizializza per l'utente finale specificando il valore **ContextUser** dell'enumerazione [**X509CertificateEnrollmentContext**](/windows/desktop/api/CertEnroll/ne-certenroll-x509certificateenrollmentcontext) .</span><span class="sxs-lookup"><span data-stu-id="31c8a-116">Creates an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and initializes it for the end user by specifying the **ContextUser** value of the [**X509CertificateEnrollmentContext**](/windows/desktop/api/CertEnroll/ne-certenroll-x509certificateenrollmentcontext) enumeration.</span></span>
3.  <span data-ttu-id="31c8a-117">Crea un oggetto [**IX500DistinguishedName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix500distinguishedname) , usa l'oggetto per codificare il nome del soggetto in una matrice di byte e aggiunge la matrice all' \# oggetto della richiesta PKCS 10.</span><span class="sxs-lookup"><span data-stu-id="31c8a-117">Creates an [**IX500DistinguishedName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix500distinguishedname) object, uses the object to encode the subject name to a byte array, and adds the array to the PKCS \#10 request object.</span></span>
4.  <span data-ttu-id="31c8a-118">Crea un oggetto [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) , lo inizializza usando l'identificatore di oggetto EKU (OID) specificato nella riga di comando, crea una raccolta [**IObjectIds**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectids) , aggiunge il nuovo oggetto **IObjectId** (EKU) alla raccolta, usa la raccolta per inizializzare un oggetto [**IX509ExtensionEnhancedKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage) e aggiunge questo oggetto alla richiesta.</span><span class="sxs-lookup"><span data-stu-id="31c8a-118">Creates an [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) object, initializes it by using the EKU object identifier (OID) specified on the command line, creates an [**IObjectIds**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectids) collection, adds the new **IObjectId** (EKU) object to the collection, uses the collection to initialize an [**IX509ExtensionEnhancedKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage) object and adds this object to the request.</span></span>
5.  <span data-ttu-id="31c8a-119">Crea un oggetto [**IAlternativeName**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativename) , lo inizializza usando il nome RFC822 specificato nella riga di comando, crea una raccolta [**IAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativenames) , aggiunge il nuovo oggetto **IAlternativeName** (RFC822 Name) alla raccolta, crea un oggetto [**IX509ExtensionAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames) e aggiunge questo oggetto alla richiesta.</span><span class="sxs-lookup"><span data-stu-id="31c8a-119">Creates an [**IAlternativeName**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativename) object, initializes it by using the RFC822 name specified on the command line, Creates an [**IAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativenames) collection, adds the new **IAlternativeName** (RFC822 name ) object to the collection, creates an [**IX509ExtensionAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames) object and adds this object to the request.</span></span>
6.  <span data-ttu-id="31c8a-120">Crea un oggetto [**metodo IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) , lo inizializza usando l'oggetto [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) e recupera una stringa che contiene una richiesta con codifica Base64.</span><span class="sxs-lookup"><span data-stu-id="31c8a-120">Creates an [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object, initializes it by using the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object, and retrieves a string that contains a base64-encoded request.</span></span>
7.  <span data-ttu-id="31c8a-121">Crea un oggetto [**ICertConfig**](/windows/desktop/api/certcli/nn-certcli-icertconfig) e lo usa per recuperare una stringa che contiene la configurazione della CA.</span><span class="sxs-lookup"><span data-stu-id="31c8a-121">Creates an [**ICertConfig**](/windows/desktop/api/certcli/nn-certcli-icertconfig) object and uses it to retrieve a string that contains the CA configuration.</span></span>
8.  <span data-ttu-id="31c8a-122">Crea un oggetto CryptoAPI [**ICertRequest2**](/windows/desktop/api/certcli/nn-certcli-icertrequest2) e lo usa più le stringhe che contengono la configurazione della CA e la richiesta di certificato per inviare la richiesta all'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="31c8a-122">Creates a CryptoAPI [**ICertRequest2**](/windows/desktop/api/certcli/nn-certcli-icertrequest2) object and uses it plus the strings that contain the CA configuration and the certificate request to submit the request to the CA.</span></span>
9.  <span data-ttu-id="31c8a-123">Controlla lo stato dell'invio e, se la registrazione ha esito positivo, installa il certificato nell'archivio certificati.</span><span class="sxs-lookup"><span data-stu-id="31c8a-123">Checks the submission status and, if enrollment is successful, installs the certificate to the certificate store.</span></span>

## <a name="related-topics"></a><span data-ttu-id="31c8a-124">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="31c8a-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="31c8a-125">\#Richiesta PKCS 10</span><span class="sxs-lookup"><span data-stu-id="31c8a-125">PKCS \#10 Request</span></span>](pkcs--10-request.md)
</dt> <dt>

[<span data-ttu-id="31c8a-126">Uso degli esempi inclusi</span><span class="sxs-lookup"><span data-stu-id="31c8a-126">Using the Included Samples</span></span>](using-the-included-samples.md)
</dt> </dl>

 

 
