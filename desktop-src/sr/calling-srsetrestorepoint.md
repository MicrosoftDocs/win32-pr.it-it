---
title: Chiamata di SRSetRestorePoint
description: Un'applicazione può creare un punto di ripristino prima di causare una modifica significativa del sistema, ad esempio l'installazione, la disinstallazione o l'aggiornamento delle funzionalità.
ms.assetid: 77981e75-8c3f-4ecc-82f4-e88d68df661a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b877c4fe73bcedad363bb4c9cc770a9638550dbd
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103712982"
---
# <a name="calling-srsetrestorepoint"></a><span data-ttu-id="8bb48-103">Chiamata di SRSetRestorePoint</span><span class="sxs-lookup"><span data-stu-id="8bb48-103">Calling SRSetRestorePoint</span></span>

<span data-ttu-id="8bb48-104">Un'applicazione può creare un punto di ripristino prima di causare una modifica significativa del sistema, ad esempio l'installazione, la disinstallazione o l'aggiornamento delle funzionalità.</span><span class="sxs-lookup"><span data-stu-id="8bb48-104">An application can create a restore point before it causes a significant system change, such as an install, uninstall, or feature update.</span></span>

<span data-ttu-id="8bb48-105">I programmi di installazione devono creare un punto di ripristino subito prima dell'installazione chiamando la funzione [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) con il membro **dwEventType** del set di strutture [**RESTOREPOINTINFO**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-restorepointinfoa) per iniziare la \_ modifica del sistema \_ .</span><span class="sxs-lookup"><span data-stu-id="8bb48-105">Installers should create a restore point just prior to installation by calling the [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) function with the **dwEventType** member of the [**RESTOREPOINTINFO**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-restorepointinfoa) structure set to BEGIN\_SYSTEM\_CHANGE.</span></span> <span data-ttu-id="8bb48-106">Per notificare a ripristino configurazione di sistema che l'installazione è stata completata, chiamare **SRSetRestorePoint** con **DWEVENTTYPE** impostato su Termina \_ modifica del sistema \_ .</span><span class="sxs-lookup"><span data-stu-id="8bb48-106">To notify System Restore that the installation has been completed, call **SRSetRestorePoint** with **dwEventType** set to END\_SYSTEM\_CHANGE.</span></span>

<span data-ttu-id="8bb48-107">Se l'utente annulla l'installazione dell'applicazione, il programma di installazione potrebbe rimuovere il punto di ripristino creato al momento dell'avvio dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="8bb48-107">If the user cancels the application installation, the installer may remove the restore point it created when the installation began.</span></span> <span data-ttu-id="8bb48-108">La rimozione del punto di ripristino è facoltativa e può impedire all'utente di eseguire il recupero da modifiche non intenzionali apportate dal programma di installazione durante l'annullamento.</span><span class="sxs-lookup"><span data-stu-id="8bb48-108">Removing the restore point is optional and can prevent the user from recovering from unintentional changes made by the installer during the cancellation.</span></span> <span data-ttu-id="8bb48-109">Se il programma di installazione prevede la rimozione di un punto di ripristino, può chiamare la funzione [**SRRemoveRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srremoverestorepoint) oppure chiamare [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) con **DWRESTOREPOINTTYPE** impostato su operazione annullata \_ , **DwEventType** impostato su Termina \_ \_ modifica del sistema e **llSequenceNumber** impostato sul valore restituito dalla chiamata iniziale a **SRSetRestorePoint**.</span><span class="sxs-lookup"><span data-stu-id="8bb48-109">If the installer is to remove a restore point, it can call the [**SRRemoveRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srremoverestorepoint) function, or call [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) with **dwRestorePointType** set to CANCELLED\_OPERATION, **dwEventType** set to END\_SYSTEM\_CHANGE, and **llSequenceNumber** set to the value returned by the initial call to **SRSetRestorePoint**.</span></span>

<span data-ttu-id="8bb48-110">**Windows 8:  **</span><span class="sxs-lookup"><span data-stu-id="8bb48-110">**Windows 8:  **</span></span>

<span data-ttu-id="8bb48-111">Una nuova chiave del registro di sistema consente agli sviluppatori di applicazioni di modificare la frequenza di creazione di punti di ripristino.</span><span class="sxs-lookup"><span data-stu-id="8bb48-111">A new registry key enables application developers to change the frequency of restore-point creation.</span></span>

<span data-ttu-id="8bb48-112">Le applicazioni devono creare questa chiave per utilizzarla perché non sarà preesistente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="8bb48-112">Applications should create this key to use it because it will not preexist in the system.</span></span> <span data-ttu-id="8bb48-113">Per impostazione predefinita, verranno applicati gli elementi seguenti se la chiave non esiste.</span><span class="sxs-lookup"><span data-stu-id="8bb48-113">The following will apply by default if the key does not exist.</span></span> <span data-ttu-id="8bb48-114">Se un'applicazione chiama la funzione **SRSetRestorePoint** per creare un punto di ripristino, Windows ignora la creazione di questo nuovo punto di ripristino se sono stati creati punti di ripristino nelle ultime 24 ore.</span><span class="sxs-lookup"><span data-stu-id="8bb48-114">If an application calls the **SRSetRestorePoint** function to create a restore point, Windows skips creating this new restore point if any restore points have been created in the last 24 hours.</span></span> <span data-ttu-id="8bb48-115">Ripristino configurazione di sistema imposta il membro **IISequenceNumber** della struttura [**STATEMGRSTATUS**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-statemgrstatus) sul numero di sequenza del punto di ripristino creato in precedenza nel giorno e imposta il valore del membro **nStatus** su **errore \_ riuscito**.</span><span class="sxs-lookup"><span data-stu-id="8bb48-115">System Restore sets the **IISequenceNumber** member of the [**STATEMGRSTATUS**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-statemgrstatus) structure to the sequence number for the restore point created previously in the day and sets the value of the **nStatus** member to **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="8bb48-116">La funzione **SRSetRestorePoint** restituisce **true**.</span><span class="sxs-lookup"><span data-stu-id="8bb48-116">The **SRSetRestorePoint** function returns **TRUE**.</span></span>

<span data-ttu-id="8bb48-117">Gli sviluppatori possono scrivere applicazioni che creano il valore **DWORD** **SystemRestorePointCreationFrequency** nella chiave del registro di sistema **HKLM \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**.</span><span class="sxs-lookup"><span data-stu-id="8bb48-117">Developers can write applications that create the **DWORD** value **SystemRestorePointCreationFrequency** under the registry key **HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore**.</span></span> <span data-ttu-id="8bb48-118">Il valore di questa chiave del registro di sistema può modificare la frequenza di creazione del punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="8bb48-118">The value of this registry key can change the frequency of restore point creation.</span></span> <span data-ttu-id="8bb48-119">Il valore di questa chiave del registro di sistema può modificare la frequenza di creazione del punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="8bb48-119">The value of this registry key can change the frequency of restore point creation.</span></span>

<span data-ttu-id="8bb48-120">Se l'applicazione chiama **SRSetRestorePoint** per creare un punto di ripristino e il valore della chiave del registro di sistema è 0, ripristino configurazione di sistema non ignora la creazione del nuovo punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="8bb48-120">If the application calls **SRSetRestorePoint** to create a restore point, and the registry key value is 0, system restore does not skip creating the new restore point.</span></span>

<span data-ttu-id="8bb48-121">Se l'applicazione chiama **SRSetRestorePoint** per creare un punto di ripristino e il valore della chiave del registro di sistema è Integer N, ripristino configurazione di sistema ignora la creazione di un nuovo punto di ripristino se sono stati creati punti di ripristino nei precedenti N minuti.</span><span class="sxs-lookup"><span data-stu-id="8bb48-121">If the application calls **SRSetRestorePoint** to create a restore point, and the registry key value is the integer N, system restore skips creating a new restore point if any restore points were created in the previous N minutes.</span></span>

<span data-ttu-id="8bb48-122">**Windows 8:  **</span><span class="sxs-lookup"><span data-stu-id="8bb48-122">**Windows 8:  **</span></span>

<span data-ttu-id="8bb48-123">Ripristino configurazione di sistema in esecuzione in Windows 8 monitora i file del volume di avvio rilevanti solo per il ripristino del sistema.</span><span class="sxs-lookup"><span data-stu-id="8bb48-123">System Restore running on Windows 8 monitors files in the boot volume that are relevant for system restore only.</span></span> <span data-ttu-id="8bb48-124">Gli snapshot del volume di avvio creato da ripristino configurazione di sistema in esecuzione in Windows 8 possono essere eliminati se lo snapshot viene successivamente esposto da una versione precedente di Windows.</span><span class="sxs-lookup"><span data-stu-id="8bb48-124">Snapshots of the boot volume created by System Restore running on Windows 8 may be deleted if the snapshot is subsequently exposed by an earlier version of Windows.</span></span> <span data-ttu-id="8bb48-125">Si noti che anche se è presente un solo volume di sistema, esiste un volume di avvio per ogni sistema operativo in un sistema a più avvii.</span><span class="sxs-lookup"><span data-stu-id="8bb48-125">Note that although there is only one system volume, there is one boot volume for each operating system in a multi-boot system.</span></span>

<span data-ttu-id="8bb48-126">Gli sviluppatori possono scrivere applicazioni che creano il valore **DWORD** **ScopeSnapshots** nella chiave del registro di sistema **HKLM \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**.</span><span class="sxs-lookup"><span data-stu-id="8bb48-126">Developers can write applications that create the **DWORD** value **ScopeSnapshots** under the registry key **HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore**.</span></span> <span data-ttu-id="8bb48-127">Se il valore della chiave del registro di sistema è 0, ripristino configurazione di sistema crea snapshot del volume di avvio nello stesso modo delle versioni precedenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="8bb48-127">If this registry key value is 0, System Restore creates snapshots of the boot volume in the same way as in earlier versions of Windows.</span></span> <span data-ttu-id="8bb48-128">Se questo valore viene eliminato, ripristino configurazione di sistema in esecuzione in Windows 8 riprende la creazione di snapshot che monitorano i file del volume di avvio rilevanti solo per il ripristino del sistema.</span><span class="sxs-lookup"><span data-stu-id="8bb48-128">If this value is deleted, System Restore running on Windows 8 resumes creating snapshots that monitor files in the boot volume that are relevant for system restore only.</span></span>

<span data-ttu-id="8bb48-129">Per un esempio, vedere [uso di ripristino configurazione di sistema](using-system-restore.md).</span><span class="sxs-lookup"><span data-stu-id="8bb48-129">For an example, see [Using System Restore](using-system-restore.md).</span></span>

 

 




