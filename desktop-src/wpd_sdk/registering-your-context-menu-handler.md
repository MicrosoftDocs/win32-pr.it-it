---
description: Registrazione del gestore del menu di scelta rapida
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Registrazione del gestore del menu di scelta rapida
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106314441"
---
# <a name="registering-your-context-menu-handler"></a><span data-ttu-id="bcba3-103">Registrazione del gestore del menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="bcba3-103">Registering Your Context Menu Handler</span></span>

<span data-ttu-id="bcba3-104">Affinché il gestore del menu di scelta rapida venga riconosciuto dallo spazio dei nomi WPD, è necessario registrarlo correttamente nel registro di sistema di Windows.</span><span class="sxs-lookup"><span data-stu-id="bcba3-104">In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry.</span></span> <span data-ttu-id="bcba3-105">Le voci di registrazione per un gestore di menu di scelta rapida WPD sono simili a quelle della shell, ma sono registrate come tipi di file speciali.</span><span class="sxs-lookup"><span data-stu-id="bcba3-105">The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types.</span></span> <span data-ttu-id="bcba3-106">I gestori dei menu di scelta rapida WPD vengono registrati in base al tipo di contenuto che rappresentano.</span><span class="sxs-lookup"><span data-stu-id="bcba3-106">WPD context menu handlers are registered according to the content type they represent.</span></span> <span data-ttu-id="bcba3-107">Di seguito è riportato un esempio di albero di registrazione per un gestore menu di scelta rapida WPD:</span><span class="sxs-lookup"><span data-stu-id="bcba3-107">Below is a sample registration tree for a WPD context menu handler:</span></span>


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



<span data-ttu-id="bcba3-108">Nell'esempio precedente viene registrato il Visualizzatore di immagini della shell con lo spazio dei nomi WPD.</span><span class="sxs-lookup"><span data-stu-id="bcba3-108">The above example registers the shell image viewer with the WPD namespace.</span></span> <span data-ttu-id="bcba3-109">Quando un utente fa clic con il pulsante destro del mouse o fa doppio clic sul contenuto di un dispositivo tramite la shell di Windows Vista, richiama questo gestore del menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="bcba3-109">When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler.</span></span> <span data-ttu-id="bcba3-110">Lo spazio dei nomi WPD usa il \_ \_ tipo di contenuto WPD per determinare quali gestori di menu di scelta rapida caricare.</span><span class="sxs-lookup"><span data-stu-id="bcba3-110">The WPD namespace uses WPD\_CONTENT\_TYPE to determine which context menu handlers to load.</span></span> <span data-ttu-id="bcba3-111">Se il tipo di contenuto WPD \_ \_ è uguale al tipo di contenuto WPD non \_ \_ \_ specificato, il tipo di contenuto WPD è un \_ \_ \_ \_ file generico o \_ \_ un tipo di contenuto WPD \_ , lo spazio dei nomi WPD tenterà di trovare la migliore corrispondenza in base all'estensione del file selezionato.</span><span class="sxs-lookup"><span data-stu-id="bcba3-111">If WPD\_CONTENT\_TYPE is equal to WPD\_CONTENT\_TYPE\_UNSPECIFIED, WPD\_CONTENT\_TYPE\_GENERIC\_FILE or WPD\_CONTENT\_TYPE\_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file.</span></span> <span data-ttu-id="bcba3-112">Se né l'estensione di file né il tipo di contenuto forniscono una classificazione utile, lo spazio dei nomi WPD caricherà i gestori del menu di scelta rapida sotto la chiave del registro di sistema **WPDContextMenu. Generic** .</span><span class="sxs-lookup"><span data-stu-id="bcba3-112">If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the **WPDContextMenu.Generic** registry key.</span></span> <span data-ttu-id="bcba3-113">Nella tabella seguente sono elencate tutte le classi di file disponibili per un gestore di menu di scelta rapida e i tipi di contenuto e le estensioni di file che rappresentano:</span><span class="sxs-lookup"><span data-stu-id="bcba3-113">The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</span></span>



| <span data-ttu-id="bcba3-114">Chiave del Registro di sistema</span><span class="sxs-lookup"><span data-stu-id="bcba3-114">Registry Key</span></span>                           | <span data-ttu-id="bcba3-115">Tipo di contenuto WPD</span><span class="sxs-lookup"><span data-stu-id="bcba3-115">WPD Content Type</span></span>                                                                                               | <span data-ttu-id="bcba3-116">Estensione nome del file</span><span class="sxs-lookup"><span data-stu-id="bcba3-116">File Extension</span></span>                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bcba3-117">**WPDContextMenu. Device**</span><span class="sxs-lookup"><span data-stu-id="bcba3-117">**WPDContextMenu.Device**</span></span>              | <span data-ttu-id="bcba3-118">La registrazione in questa chiave Abilita il gestore del menu di scelta rapida a livello di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="bcba3-118">Registering under this key enables your context menu handler at the device level.</span></span> <span data-ttu-id="bcba3-119">(Fare clic con il pulsante destro del mouse su un dispositivo).</span><span class="sxs-lookup"><span data-stu-id="bcba3-119">(Right-click on a device.)</span></span>   | <span data-ttu-id="bcba3-120">(N/D)</span><span class="sxs-lookup"><span data-stu-id="bcba3-120">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="bcba3-121">**WPDContextMenu. storage**</span><span class="sxs-lookup"><span data-stu-id="bcba3-121">**WPDContextMenu.Storage**</span></span>             | <span data-ttu-id="bcba3-122">La registrazione in questa chiave Abilita il gestore del menu di scelta rapida a livello di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="bcba3-122">Registering under this key enables your context menu handler at the storage level.</span></span> <span data-ttu-id="bcba3-123">Fare clic con il pulsante destro del mouse su una risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="bcba3-123">(Right-click on a storage.)</span></span> | <span data-ttu-id="bcba3-124">(N/D)</span><span class="sxs-lookup"><span data-stu-id="bcba3-124">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="bcba3-125">**WPDContextMenu. Folder**</span><span class="sxs-lookup"><span data-stu-id="bcba3-125">**WPDContextMenu.Folder**</span></span>              | <span data-ttu-id="bcba3-126">\_cartella del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-126">WPD\_CONTENT\_TYPE\_FOLDER</span></span>                                                                                     | <span data-ttu-id="bcba3-127">(N/D)</span><span class="sxs-lookup"><span data-stu-id="bcba3-127">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="bcba3-128">**WPDContextMenu. image**</span><span class="sxs-lookup"><span data-stu-id="bcba3-128">**WPDContextMenu.Image**</span></span>               | <span data-ttu-id="bcba3-129">\_immagine del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-129">WPD\_CONTENT\_TYPE\_IMAGE</span></span>                                                                                      | <span data-ttu-id="bcba3-130">bmp</span><span class="sxs-lookup"><span data-stu-id="bcba3-130">.bmp</span></span> <br/> <span data-ttu-id="bcba3-131">gif</span><span class="sxs-lookup"><span data-stu-id="bcba3-131">.gif</span></span> <br/> <span data-ttu-id="bcba3-132">png</span><span class="sxs-lookup"><span data-stu-id="bcba3-132">.png</span></span> <br/> <span data-ttu-id="bcba3-133">jpg</span><span class="sxs-lookup"><span data-stu-id="bcba3-133">.jpg</span></span> <br/> <span data-ttu-id="bcba3-134">jpe</span><span class="sxs-lookup"><span data-stu-id="bcba3-134">.jpe</span></span> <br/> <span data-ttu-id="bcba3-135">jpeg</span><span class="sxs-lookup"><span data-stu-id="bcba3-135">.jpeg</span></span> <br/>   |
| <span data-ttu-id="bcba3-136">**WPDContextMenu. audio**</span><span class="sxs-lookup"><span data-stu-id="bcba3-136">**WPDContextMenu.Audio**</span></span>               | <span data-ttu-id="bcba3-137">\_audio del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-137">WPD\_CONTENT\_TYPE\_AUDIO</span></span>                                                                                      | <span data-ttu-id="bcba3-138">.aiff</span><span class="sxs-lookup"><span data-stu-id="bcba3-138">.aiff</span></span> <br/> <span data-ttu-id="bcba3-139">mp3</span><span class="sxs-lookup"><span data-stu-id="bcba3-139">.mp3</span></span> <br/> <span data-ttu-id="bcba3-140">.wav</span><span class="sxs-lookup"><span data-stu-id="bcba3-140">.wav</span></span> <br/> <span data-ttu-id="bcba3-141">wma</span><span class="sxs-lookup"><span data-stu-id="bcba3-141">.wma</span></span> <br/>                                     |
| <span data-ttu-id="bcba3-142">**WPDContextMenu. video**</span><span class="sxs-lookup"><span data-stu-id="bcba3-142">**WPDContextMenu.Video**</span></span>               | <span data-ttu-id="bcba3-143">\_video del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-143">WPD\_CONTENT\_TYPE\_VIDEO</span></span>                                                                                      | <span data-ttu-id="bcba3-144">.asf</span><span class="sxs-lookup"><span data-stu-id="bcba3-144">.asf</span></span><br/> <span data-ttu-id="bcba3-145">.avi</span><span class="sxs-lookup"><span data-stu-id="bcba3-145">.avi</span></span> <br/> <span data-ttu-id="bcba3-146">DVR-MS</span><span class="sxs-lookup"><span data-stu-id="bcba3-146">.dvr-ms</span></span> <br/> <span data-ttu-id="bcba3-147">. MPEG</span><span class="sxs-lookup"><span data-stu-id="bcba3-147">.mpeg</span></span> <br/> <span data-ttu-id="bcba3-148">mpg</span><span class="sxs-lookup"><span data-stu-id="bcba3-148">.mpg</span></span> <br/> <span data-ttu-id="bcba3-149">wmv</span><span class="sxs-lookup"><span data-stu-id="bcba3-149">.wmv</span></span> <br/> |
| <span data-ttu-id="bcba3-150">**WPDContextMenu. playlist**</span><span class="sxs-lookup"><span data-stu-id="bcba3-150">**WPDContextMenu.Playlist**</span></span><br/> | <span data-ttu-id="bcba3-151">\_playlist del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-151">WPD\_CONTENT\_TYPE\_PLAYLIST</span></span>                                                                                   | <span data-ttu-id="bcba3-152">. WPL</span><span class="sxs-lookup"><span data-stu-id="bcba3-152">.wpl</span></span> <br/> <span data-ttu-id="bcba3-153">.m3u</span><span class="sxs-lookup"><span data-stu-id="bcba3-153">.m3u</span></span> <br/> <span data-ttu-id="bcba3-154">. MPL</span><span class="sxs-lookup"><span data-stu-id="bcba3-154">.mpl</span></span> <br/> <span data-ttu-id="bcba3-155">.asx</span><span class="sxs-lookup"><span data-stu-id="bcba3-155">.asx</span></span> <br/> <span data-ttu-id="bcba3-156">. pls</span><span class="sxs-lookup"><span data-stu-id="bcba3-156">.pls</span></span> <br/>                     |
| <span data-ttu-id="bcba3-157">**WPDContextMenu.Document**</span><span class="sxs-lookup"><span data-stu-id="bcba3-157">**WPDContextMenu.Document**</span></span>            | <span data-ttu-id="bcba3-158">\_documento del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-158">WPD\_CONTENT\_TYPE\_DOCUMENT</span></span>                                                                                   | <span data-ttu-id="bcba3-159">doc</span><span class="sxs-lookup"><span data-stu-id="bcba3-159">.doc</span></span> <br/> <span data-ttu-id="bcba3-160">.txt</span><span class="sxs-lookup"><span data-stu-id="bcba3-160">.txt</span></span> <br/> <span data-ttu-id="bcba3-161">.rtf</span><span class="sxs-lookup"><span data-stu-id="bcba3-161">.rtf</span></span> <br/> <span data-ttu-id="bcba3-162">xls</span><span class="sxs-lookup"><span data-stu-id="bcba3-162">.xls</span></span> <br/> <span data-ttu-id="bcba3-163">ppt</span><span class="sxs-lookup"><span data-stu-id="bcba3-163">.ppt</span></span> <br/>                     |
| <span data-ttu-id="bcba3-164">**WPDContextMenu. Contact**</span><span class="sxs-lookup"><span data-stu-id="bcba3-164">**WPDContextMenu.Contact**</span></span><br/>  | <span data-ttu-id="bcba3-165">\_ \_ contatto tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-165">WPD\_CONTENT\_TYPE\_CONTACT</span></span>                                                                                    | <span data-ttu-id="bcba3-166">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-166">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-167">**WPDContextMenu.Email**</span><span class="sxs-lookup"><span data-stu-id="bcba3-167">**WPDContextMenu.Email**</span></span>               | <span data-ttu-id="bcba3-168">\_indirizzo di \_ \_ posta elettronica del tipo di contenuto WPD</span><span class="sxs-lookup"><span data-stu-id="bcba3-168">WPD\_CONTENT\_TYPE\_EMAIL</span></span>                                                                                      | <span data-ttu-id="bcba3-169">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-169">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-170">**WPDContextMenu. appuntamento**</span><span class="sxs-lookup"><span data-stu-id="bcba3-170">**WPDContextMenu.Appointment**</span></span>         | <span data-ttu-id="bcba3-171">\_ \_ appuntamento tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-171">WPD\_CONTENT\_TYPE\_APPOINTMENT</span></span>                                                                                | <span data-ttu-id="bcba3-172">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-172">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-173">**WPDContextMenu. Task**</span><span class="sxs-lookup"><span data-stu-id="bcba3-173">**WPDContextMenu.Task**</span></span>                | <span data-ttu-id="bcba3-174">\_ \_ attività tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-174">WPD\_CONTENT\_TYPE\_TASK</span></span>                                                                                       | <span data-ttu-id="bcba3-175">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-175">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-176">**WPDContextMenu. memo**</span><span class="sxs-lookup"><span data-stu-id="bcba3-176">**WPDContextMenu.Memo**</span></span>                | <span data-ttu-id="bcba3-177">\_Memo del \_ tipo di contenuto WPD \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-177">WPD\_CONTENT\_TYPE\_MEMO</span></span>                                                                                       | <span data-ttu-id="bcba3-178">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-178">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-179">**WPDContextMenu.ImageAlbum**</span><span class="sxs-lookup"><span data-stu-id="bcba3-179">**WPDContextMenu.ImageAlbum**</span></span>          | <span data-ttu-id="bcba3-180">\_album di \_ Immagini del tipo di contenuto WPD \_ \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-180">WPD\_CONTENT\_TYPE\_IMAGE\_ALBUM</span></span>                                                                               | <span data-ttu-id="bcba3-181">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-181">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-182">**WPDContextMenu.AudioAlbum**</span><span class="sxs-lookup"><span data-stu-id="bcba3-182">**WPDContextMenu.AudioAlbum**</span></span>          | <span data-ttu-id="bcba3-183">\_ \_ album audio del tipo di contenuto WPD \_ \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-183">WPD\_CONTENT\_TYPE\_AUDIO\_ALBUM</span></span>                                                                               | <span data-ttu-id="bcba3-184">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-184">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-185">**WPDContextMenu.VideoAlbum**</span><span class="sxs-lookup"><span data-stu-id="bcba3-185">**WPDContextMenu.VideoAlbum**</span></span>          | <span data-ttu-id="bcba3-186">\_ \_ album video del tipo di contenuto WPD \_ \_</span><span class="sxs-lookup"><span data-stu-id="bcba3-186">WPD\_CONTENT\_TYPE\_VIDEO\_ALBUM</span></span>                                                                               | <span data-ttu-id="bcba3-187">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-187">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-188">**WPDContextMenu.MixedAlbum**</span><span class="sxs-lookup"><span data-stu-id="bcba3-188">**WPDContextMenu.MixedAlbum**</span></span>          | <span data-ttu-id="bcba3-189">\_album di \_ contenuto \_ misto \_ tipo \_ di contenuto WPD</span><span class="sxs-lookup"><span data-stu-id="bcba3-189">WPD\_CONTENT\_TYPE\_MIXED\_CONTENT\_ALBUM</span></span>                                                                      | <span data-ttu-id="bcba3-190">nessuno</span><span class="sxs-lookup"><span data-stu-id="bcba3-190">None</span></span>                                                                                                     |
| <span data-ttu-id="bcba3-191">**WPDContextMenu. Generic**</span><span class="sxs-lookup"><span data-stu-id="bcba3-191">**WPDContextMenu.Generic**</span></span>             | <span data-ttu-id="bcba3-192">tipo di contenuto WPD non \_ \_ \_ specificato</span><span class="sxs-lookup"><span data-stu-id="bcba3-192">WPD\_CONTENT\_TYPE\_UNSPECIFIED</span></span>                                                                                | <span data-ttu-id="bcba3-193">Tutte le altre estensioni di file</span><span class="sxs-lookup"><span data-stu-id="bcba3-193">All other file extensions</span></span>                                                                                |



 

 

 




