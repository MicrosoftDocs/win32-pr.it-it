---
description: Supporto delle estensioni MTP
ms.assetid: 9e5f3da6-346a-4eca-bc85-2755c569986d
title: Supporto delle estensioni MTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 898df3f1347af2ccc42a796b480156b6603b13ec
ms.sourcegitcommit: 0f7a8198bacd5493ab1e78a9583c7a3578794765
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/25/2021
ms.locfileid: "110423731"
---
# <a name="supporting-mtp-extensions"></a><span data-ttu-id="94f5f-103">Supporto delle estensioni MTP</span><span class="sxs-lookup"><span data-stu-id="94f5f-103">Supporting MTP Extensions</span></span>

## <a name="media-transfer-protocol"></a><span data-ttu-id="94f5f-104">Media Transfer Protocol</span><span class="sxs-lookup"><span data-stu-id="94f5f-104">Media Transfer Protocol</span></span>

<span data-ttu-id="94f5f-105">Il protocollo MTP (Media Transfer Protocol) è un'estensione del protocollo PTP (Picture Transfer Protocol).</span><span class="sxs-lookup"><span data-stu-id="94f5f-105">Media Transfer Protocol (MTP) is an extension to the Picture Transfer Protocol (PTP).</span></span> <span data-ttu-id="94f5f-106">Di conseguenza, tutta la semantica del protocollo PTP è valida in MTP.</span><span class="sxs-lookup"><span data-stu-id="94f5f-106">As a result, all PTP protocol semantics are valid in MTP.</span></span>

<span data-ttu-id="94f5f-107">MTP comunica usando comandi e risposte tra due parti, l'iniziatore e il risponditore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-107">MTP communicates by using commands and responses between two parties, the initiator and the responder.</span></span> <span data-ttu-id="94f5f-108">I ruoli dei dispositivi coinvolti sono molto chiaramente definiti.</span><span class="sxs-lookup"><span data-stu-id="94f5f-108">The roles of the involved devices are very clearly defined.</span></span> <span data-ttu-id="94f5f-109">Il PC è in genere l'iniziatore e il dispositivo è sempre il risponditore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-109">The PC typically is the initiator, and the device is always the responder.</span></span> <span data-ttu-id="94f5f-110">Un dispositivo non PC può anche essere un iniziatore (ad esempio, un mazzo di auto o una scatola Microsoft X).</span><span class="sxs-lookup"><span data-stu-id="94f5f-110">A non-PC device could also be an initiator (for example, a car deck or a Microsoft X-box).</span></span> <span data-ttu-id="94f5f-111">Un dispositivo non può mai assumere entrambi i ruoli contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="94f5f-111">A device can never assume both roles at the same time.</span></span>

<span data-ttu-id="94f5f-112">L'iniziatore avvia la comunicazione inviando un comando al risponditore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-112">The initiator starts communication by sending a command to the responder.</span></span> <span data-ttu-id="94f5f-113">Il risponditore elabora il comando e restituisce una risposta appropriata.</span><span class="sxs-lookup"><span data-stu-id="94f5f-113">The responder processes the command and sends back an appropriate response.</span></span> <span data-ttu-id="94f5f-114">Al comando potrebbe essere associata una fase dati.</span><span class="sxs-lookup"><span data-stu-id="94f5f-114">There might be a data phase associated with the command.</span></span> <span data-ttu-id="94f5f-115">In questo caso, la direzione del flusso di dati deve essere nota in anticipo e accettata sia dall'iniziatore che dal risponditore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-115">If this is the case, the direction of data flow must be known beforehand and accepted by both the initiator and the responder.</span></span> <span data-ttu-id="94f5f-116">Tenere presente che non esiste un'intestazione descrittiva che indica i flussi di dati per i nuovi comandi.</span><span class="sxs-lookup"><span data-stu-id="94f5f-116">Be aware that there is not a descriptive header that indicates data flows for new commands.</span></span>

<span data-ttu-id="94f5f-117">Il risponditore può avviare la comunicazione indipendentemente dall'iniziatore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-117">The responder can start communication independent of the initiator.</span></span> <span data-ttu-id="94f5f-118">Ad esempio, il risponditore può inviare eventi all'iniziatore.</span><span class="sxs-lookup"><span data-stu-id="94f5f-118">For example, the responder can send events to the initiator.</span></span> <span data-ttu-id="94f5f-119">Tuttavia, non è possibile inviare dati insieme all'evento .</span><span class="sxs-lookup"><span data-stu-id="94f5f-119">However, no data can be sent together with the event.</span></span> <span data-ttu-id="94f5f-120">Se sono presenti dati che devono essere letti come parte dell'evento, l'iniziatore deve inviare un comando MTP e il dispositivo può quindi inviare dati in risposta al comando.</span><span class="sxs-lookup"><span data-stu-id="94f5f-120">If there is any data that needs to be read as part of the event, the initiator must send an MTP command, and the device can then send data in response to the command.</span></span>

<span data-ttu-id="94f5f-121">Per una descrizione completa di MTP, vedere la specifica [MTP](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span><span class="sxs-lookup"><span data-stu-id="94f5f-121">For a complete description of MTP, refer to the [MTP specification](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span></span>

## <a name="sending-mtp-commands"></a><span data-ttu-id="94f5f-122">Invio di comandi MTP</span><span class="sxs-lookup"><span data-stu-id="94f5f-122">Sending MTP Commands</span></span>

<span data-ttu-id="94f5f-123">Le applicazioni possono inviare comandi MTP a un dispositivo richiamando il [**metodo IPortableDevice::SendCommand.**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand)</span><span class="sxs-lookup"><span data-stu-id="94f5f-123">Applications can send MTP commands to a device by invoking the [**IPortableDevice::SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) method.</span></span> <span data-ttu-id="94f5f-124">Il comando inviato dipende dal fatto che sia presente una fase dati e dal fatto che tutti i dati che accompagnano vengono letti o scritti nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="94f5f-124">The command that is sent depends on whether there is a data phase, and, on whether any accompanying data is read from or written to the device.</span></span> <span data-ttu-id="94f5f-125">Nella tabella seguente vengono descritti i tre possibili comandi di estensione MTP.</span><span class="sxs-lookup"><span data-stu-id="94f5f-125">The following table describes the three possible MTP extension commands.</span></span>

<span data-ttu-id="94f5f-126">Tenere presente che questi comandi sono specifici di MTP. e sono pertanto implementati solo dal driver di classe MTP WPD.</span><span class="sxs-lookup"><span data-stu-id="94f5f-126">Be aware that these commands are specific to MTP; and are therefore, only implemented by the WPD MTP class driver.</span></span>



| <span data-ttu-id="94f5f-127">Comando</span><span class="sxs-lookup"><span data-stu-id="94f5f-127">Command</span></span>  | <span data-ttu-id="94f5f-128">Descrizione</span><span class="sxs-lookup"><span data-stu-id="94f5f-128">Description</span></span>  |
|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="94f5f-129">**TRASFERIMENTO DEI DATI \_ DI FINE DEL COMANDO \_ WPD MTP \_ EXT \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="94f5f-129">**WPD\_COMMAND\_MTP\_EXT\_END\_DATA\_TRANSFER**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-end-data-transfer)                                      | <span data-ttu-id="94f5f-130">Emetta un comando MTP che segnala la conclusione di un'operazione di lettura o scrittura dei dati.</span><span class="sxs-lookup"><span data-stu-id="94f5f-130">Issues an MTP command that signals the conclusion of a data read or write operation.</span></span>              |
| [<span data-ttu-id="94f5f-131">**COMANDO WPD \_ \_ MTP \_ EXT \_ EXECUTE COMMAND WITHOUT DATA \_ \_ \_ \_ PHASE**</span><span class="sxs-lookup"><span data-stu-id="94f5f-131">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITHOUT\_DATA\_PHASE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-without-data-phase)  | <span data-ttu-id="94f5f-132">Consente di eseguire un comando MTP senza una fase dati corrispondente.</span><span class="sxs-lookup"><span data-stu-id="94f5f-132">Issues an MTP command without a corresponding data phase.</span></span>                                         |
| [<span data-ttu-id="94f5f-133">**COMANDO WPD \_ \_ MTP \_ EXT \_ EXECUTE CON DATI DA \_ \_ \_ \_ \_ SCRIVERE**</span><span class="sxs-lookup"><span data-stu-id="94f5f-133">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_WRITE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-write) | <span data-ttu-id="94f5f-134">Viene eseguito un comando MTP seguito dai dati che accompagnano, che verranno scritti nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="94f5f-134">Issues an MTP command that is followed by accompanying data, which will be written to the device.</span></span> |
| [<span data-ttu-id="94f5f-135">**COMANDO WPD \_ \_ MTP \_ EXT \_ EXECUTE CON DATI DA \_ \_ \_ \_ \_ LEGGERE**</span><span class="sxs-lookup"><span data-stu-id="94f5f-135">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_READ**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-read)   | <span data-ttu-id="94f5f-136">Consente di eseguire un comando MTP seguito dai dati correlati, che vengono letti dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="94f5f-136">Issues an MTP command that is followed by accompanying data, which is read from the device.</span></span>       |
| [<span data-ttu-id="94f5f-137">**COMANDO WPD \_ \_ MTP \_ EXT \_ LETTURA \_ DATI**</span><span class="sxs-lookup"><span data-stu-id="94f5f-137">**WPD\_COMMAND\_MTP\_EXT\_READ\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-read-data)                                                       | <span data-ttu-id="94f5f-138">Invia un comando MTP che invia i dati dal dispositivo al PC.</span><span class="sxs-lookup"><span data-stu-id="94f5f-138">Issues an MTP command that sends data from the device to the PC.</span></span>                                  |
| [<span data-ttu-id="94f5f-139">**WPD \_ COMMAND \_ MTP \_ EXT \_ WRITE \_ DATA**</span><span class="sxs-lookup"><span data-stu-id="94f5f-139">**WPD\_COMMAND\_MTP\_EXT\_WRITE\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-write-data)                                                     | <span data-ttu-id="94f5f-140">Invia un comando MTP che invia dati al dispositivo dal PC.</span><span class="sxs-lookup"><span data-stu-id="94f5f-140">Issues an MTP command that sends data to the device from the PC.</span></span>                                  |



 

<span data-ttu-id="94f5f-141">Indipendentemente dalla fase, è necessario specificare **WPD \_ PROPERTY \_ MTP \_ EXT \_ OPERATION \_ CODE** e **WPD \_ PROPERTY \_ MTP \_ EXT OPERATION \_ \_ PARAMS.**</span><span class="sxs-lookup"><span data-stu-id="94f5f-141">Regardless of the phase, **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_CODE** and **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_PARAMS** must be specified.</span></span>

<span data-ttu-id="94f5f-142">Se il driver MTP è stato in grado di inviare il comando al dispositivo, i valori restituiti conterranno sempre **WPD \_ PROPERTY \_ MTP \_ EXT \_ RESPONSE \_ CODE**.</span><span class="sxs-lookup"><span data-stu-id="94f5f-142">If the MTP driver was able to send the command to the device, the return values will always contain **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_CODE**.</span></span> <span data-ttu-id="94f5f-143">Se il codice di risposta indica l'esito positivo e se la semantica del comando consente i parametri di risposta, saranno disponibili anche **WPD \_ PROPERTY \_ MTP \_ EXT \_ RESPONSE \_ PARAMS.**</span><span class="sxs-lookup"><span data-stu-id="94f5f-143">If the response code indicates success and if the semantics of the command allow for response parameters, **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_PARAMS** will also be available.</span></span>

## <a name="related-topics"></a><span data-ttu-id="94f5f-144">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="94f5f-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="94f5f-145">**Guida per programmatori**</span><span class="sxs-lookup"><span data-stu-id="94f5f-145">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 
