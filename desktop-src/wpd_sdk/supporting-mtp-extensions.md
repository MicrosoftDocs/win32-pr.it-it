---
description: Supporto delle estensioni MTP
ms.assetid: 9e5f3da6-346a-4eca-bc85-2755c569986d
title: Supporto delle estensioni MTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f26a6a5a585167984ec944528bb74a6746e42ac4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103884169"
---
# <a name="supporting-mtp-extensions"></a><span data-ttu-id="31d4e-103">Supporto delle estensioni MTP</span><span class="sxs-lookup"><span data-stu-id="31d4e-103">Supporting MTP Extensions</span></span>

## <a name="media-transfer-protocol"></a><span data-ttu-id="31d4e-104">Protocollo di trasferimento multimediale</span><span class="sxs-lookup"><span data-stu-id="31d4e-104">Media Transfer Protocol</span></span>

<span data-ttu-id="31d4e-105">Il protocollo MTP (Media Transfer Protocol) è un'estensione del protocollo PTP (Picture Transfer Protocol).</span><span class="sxs-lookup"><span data-stu-id="31d4e-105">Media Transfer Protocol (MTP) is an extension to the Picture Transfer Protocol (PTP).</span></span> <span data-ttu-id="31d4e-106">Di conseguenza, tutte le semantiche del protocollo PTP sono valide in MTP.</span><span class="sxs-lookup"><span data-stu-id="31d4e-106">As a result, all PTP protocol semantics are valid in MTP.</span></span>

<span data-ttu-id="31d4e-107">MTP comunica con i comandi e le risposte tra due parti, l'iniziatore e il risponditore.</span><span class="sxs-lookup"><span data-stu-id="31d4e-107">MTP communicates by using commands and responses between two parties, the initiator and the responder.</span></span> <span data-ttu-id="31d4e-108">I ruoli dei dispositivi interessati sono ben definiti.</span><span class="sxs-lookup"><span data-stu-id="31d4e-108">The roles of the involved devices are very clearly defined.</span></span> <span data-ttu-id="31d4e-109">Il PC è in genere l'initiator e il dispositivo è sempre il risponditore.</span><span class="sxs-lookup"><span data-stu-id="31d4e-109">The PC typically is the initiator, and the device is always the responder.</span></span> <span data-ttu-id="31d4e-110">Un dispositivo non PC può anche essere un iniziatore (ad esempio, un car deck o un Microsoft X-box).</span><span class="sxs-lookup"><span data-stu-id="31d4e-110">A non-PC device could also be an initiator (for example, a car deck or a Microsoft X-box).</span></span> <span data-ttu-id="31d4e-111">Un dispositivo non può mai assumere entrambi i ruoli nello stesso momento.</span><span class="sxs-lookup"><span data-stu-id="31d4e-111">A device can never assume both roles at the same time.</span></span>

<span data-ttu-id="31d4e-112">L'initiator avvia la comunicazione inviando un comando al risponditore.</span><span class="sxs-lookup"><span data-stu-id="31d4e-112">The initiator starts communication by sending a command to the responder.</span></span> <span data-ttu-id="31d4e-113">Il risponditore elabora il comando e restituisce una risposta appropriata.</span><span class="sxs-lookup"><span data-stu-id="31d4e-113">The responder processes the command and sends back an appropriate response.</span></span> <span data-ttu-id="31d4e-114">Potrebbe essere presente una fase di dati associata al comando.</span><span class="sxs-lookup"><span data-stu-id="31d4e-114">There might be a data phase associated with the command.</span></span> <span data-ttu-id="31d4e-115">In tal caso, la direzione del flusso di dati deve essere nota in anticipo e accettata sia dall'initiator che dal risponditore.</span><span class="sxs-lookup"><span data-stu-id="31d4e-115">If this is the case, the direction of data flow must be known beforehand and accepted by both the initiator and the responder.</span></span> <span data-ttu-id="31d4e-116">Tenere presente che non è presente un'intestazione descrittiva che indica i flussi di dati per i nuovi comandi.</span><span class="sxs-lookup"><span data-stu-id="31d4e-116">Be aware that there is not a descriptive header that indicates data flows for new commands.</span></span>

<span data-ttu-id="31d4e-117">Il risponditore può avviare la comunicazione indipendentemente dall'initiator.</span><span class="sxs-lookup"><span data-stu-id="31d4e-117">The responder can start communication independent of the initiator.</span></span> <span data-ttu-id="31d4e-118">Ad esempio, il risponditore può inviare eventi all'initiator.</span><span class="sxs-lookup"><span data-stu-id="31d4e-118">For example, the responder can send events to the initiator.</span></span> <span data-ttu-id="31d4e-119">Tuttavia, non è possibile inviare dati insieme all'evento.</span><span class="sxs-lookup"><span data-stu-id="31d4e-119">However, no data can be sent together with the event.</span></span> <span data-ttu-id="31d4e-120">Se sono presenti dati che devono essere letti come parte dell'evento, l'iniziatore deve inviare un comando MTP e il dispositivo può inviare i dati in risposta al comando.</span><span class="sxs-lookup"><span data-stu-id="31d4e-120">If there is any data that needs to be read as part of the event, the initiator must send an MTP command, and the device can then send data in response to the command.</span></span>

<span data-ttu-id="31d4e-121">Per una descrizione completa di MTP, vedere la [specifica MTP](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span><span class="sxs-lookup"><span data-stu-id="31d4e-121">For a complete description of MTP, refer to the [MTP specification](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span></span>

## <a name="sending-mtp-commands"></a><span data-ttu-id="31d4e-122">Invio di comandi MTP</span><span class="sxs-lookup"><span data-stu-id="31d4e-122">Sending MTP Commands</span></span>

<span data-ttu-id="31d4e-123">Le applicazioni possono inviare comandi MTP a un dispositivo richiamando il metodo [**IPortableDevice:: SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) .</span><span class="sxs-lookup"><span data-stu-id="31d4e-123">Applications can send MTP commands to a device by invoking the [**IPortableDevice::SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) method.</span></span> <span data-ttu-id="31d4e-124">Il comando inviato dipende dalla presenza o meno di una fase di dati e dall'eventuale lettura o scrittura di dati associati nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31d4e-124">The command that is sent depends on whether there is a data phase, and, on whether any accompanying data is read from or written to the device.</span></span> <span data-ttu-id="31d4e-125">Nella tabella seguente vengono descritti i tre possibili comandi dell'estensione MTP.</span><span class="sxs-lookup"><span data-stu-id="31d4e-125">The following table describes the three possible MTP extension commands.</span></span>

<span data-ttu-id="31d4e-126">Tenere presente che questi comandi sono specifici per MTP; e sono pertanto implementati solo dal driver della classe MTP WPD.</span><span class="sxs-lookup"><span data-stu-id="31d4e-126">Be aware that these commands are specific to MTP; and are therefore, only implemented by the WPD MTP class driver.</span></span>



|                                                                                                                                      |                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| <span data-ttu-id="31d4e-127">Comando</span><span class="sxs-lookup"><span data-stu-id="31d4e-127">Command</span></span>                                                                                                                              | <span data-ttu-id="31d4e-128">Descrizione</span><span class="sxs-lookup"><span data-stu-id="31d4e-128">Description</span></span>                                                                                       |
| [<span data-ttu-id="31d4e-129">**\_comando WPD \_ MTP \_ ext \_ End \_ data \_ Transfer**</span><span class="sxs-lookup"><span data-stu-id="31d4e-129">**WPD\_COMMAND\_MTP\_EXT\_END\_DATA\_TRANSFER**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-end-data-transfer)                                      | <span data-ttu-id="31d4e-130">Rilascia un comando MTP che segnala la conclusione di un'operazione di lettura o scrittura dei dati.</span><span class="sxs-lookup"><span data-stu-id="31d4e-130">Issues an MTP command that signals the conclusion of a data read or write operation.</span></span>              |
| [<span data-ttu-id="31d4e-131">**\_comando WPD \_ comando \_ MTP \_ ext \_ Execute \_ senza \_ \_ fase dati**</span><span class="sxs-lookup"><span data-stu-id="31d4e-131">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITHOUT\_DATA\_PHASE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-without-data-phase)  | <span data-ttu-id="31d4e-132">Rilascia un comando MTP senza una fase di dati corrispondente.</span><span class="sxs-lookup"><span data-stu-id="31d4e-132">Issues an MTP command without a corresponding data phase.</span></span>                                         |
| [<span data-ttu-id="31d4e-133">**comando \_ WPD \_ MTP \_ ext \_ Execute \_ \_ con \_ dati \_ da \_ scrivere**</span><span class="sxs-lookup"><span data-stu-id="31d4e-133">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_WRITE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-write) | <span data-ttu-id="31d4e-134">Rilascia un comando MTP seguito da dati associati, che verranno scritti nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31d4e-134">Issues an MTP command that is followed by accompanying data, which will be written to the device.</span></span> |
| [<span data-ttu-id="31d4e-135">**comando \_ WPD \_ MTP \_ ext \_ Execute \_ \_ con \_ dati \_ da \_ leggere**</span><span class="sxs-lookup"><span data-stu-id="31d4e-135">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_READ**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-read)   | <span data-ttu-id="31d4e-136">Rilascia un comando MTP seguito da dati associati, che vengono letti dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31d4e-136">Issues an MTP command that is followed by accompanying data, which is read from the device.</span></span>       |
| [<span data-ttu-id="31d4e-137">**\_comando WPD \_ MTP \_ ext \_ Read \_ Data**</span><span class="sxs-lookup"><span data-stu-id="31d4e-137">**WPD\_COMMAND\_MTP\_EXT\_READ\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-read-data)                                                       | <span data-ttu-id="31d4e-138">Rilascia un comando MTP che invia i dati dal dispositivo al PC.</span><span class="sxs-lookup"><span data-stu-id="31d4e-138">Issues an MTP command that sends data from the device to the PC.</span></span>                                  |
| [<span data-ttu-id="31d4e-139">**\_comando WPD \_ MTP \_ ext \_ scrivere \_ dati**</span><span class="sxs-lookup"><span data-stu-id="31d4e-139">**WPD\_COMMAND\_MTP\_EXT\_WRITE\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-write-data)                                                     | <span data-ttu-id="31d4e-140">Rilascia un comando MTP che invia i dati al dispositivo dal PC.</span><span class="sxs-lookup"><span data-stu-id="31d4e-140">Issues an MTP command that sends data to the device from the PC.</span></span>                                  |



 

<span data-ttu-id="31d4e-141">Indipendentemente dalla fase, è necessario specificare la **Proprietà WPD del \_ \_ \_ \_ \_ codice operativo MTP EXT** e la **\_ Proprietà WPD \_ MTP \_ ext \_ Operation \_ params** .</span><span class="sxs-lookup"><span data-stu-id="31d4e-141">Regardless of the phase, **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_CODE** and **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_PARAMS** must be specified.</span></span>

<span data-ttu-id="31d4e-142">Se il driver MTP è stato in grado di inviare il comando al dispositivo, i valori restituiti conterranno sempre il **\_ \_ codice di \_ \_ risposta \_ MTP EXT della proprietà WPD**.</span><span class="sxs-lookup"><span data-stu-id="31d4e-142">If the MTP driver was able to send the command to the device, the return values will always contain **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_CODE**.</span></span> <span data-ttu-id="31d4e-143">Se il codice di risposta indica l'esito positivo e se la semantica del comando consente i parametri di risposta, saranno disponibili anche i **\_ param della proprietà WPD MTP della \_ \_ \_ risposta \_** .</span><span class="sxs-lookup"><span data-stu-id="31d4e-143">If the response code indicates success and if the semantics of the command allow for response parameters, **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_PARAMS** will also be available.</span></span>

## <a name="related-topics"></a><span data-ttu-id="31d4e-144">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="31d4e-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="31d4e-145">**Guida per programmatori**</span><span class="sxs-lookup"><span data-stu-id="31d4e-145">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 
