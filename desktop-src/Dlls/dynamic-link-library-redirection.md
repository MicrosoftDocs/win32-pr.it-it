---
description: Le applicazioni possono dipendere da una versione specifica di una DLL condivisa e iniziare a non riuscire se un'altra applicazione viene installata con una versione più recente o precedente della stessa DLL.
ms.assetid: 3b426b6c-1ad5-43b9-81ea-5e6d3c6588c8
title: Reindirizzamento libreria Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b575d566231058cca13c10a067a3c2e20078073
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106308922"
---
# <a name="dynamic-link-library-redirection"></a><span data-ttu-id="562a0-103">Reindirizzamento libreria Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="562a0-103">Dynamic-Link Library Redirection</span></span>

<span data-ttu-id="562a0-104">Le applicazioni possono dipendere da una versione specifica di una DLL condivisa e iniziare a non riuscire se un'altra applicazione viene installata con una versione più recente o precedente della stessa DLL.</span><span class="sxs-lookup"><span data-stu-id="562a0-104">Applications can depend on a specific version of a shared DLL and start to fail if another application is installed with a newer or older version of the same DLL.</span></span> <span data-ttu-id="562a0-105">Esistono due modi per assicurarsi che l'applicazione usi la DLL corretta: reindirizzamento DLL e componenti affiancati.</span><span class="sxs-lookup"><span data-stu-id="562a0-105">There are two ways to ensure that your application uses the correct DLL: DLL redirection and side-by-side components.</span></span> <span data-ttu-id="562a0-106">Gli sviluppatori e gli amministratori devono utilizzare il reindirizzamento DLL per le applicazioni esistenti, perché non richiede alcuna modifica all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="562a0-106">Developers and administrators should use DLL redirection for existing applications, because it does not require any changes to the application.</span></span> <span data-ttu-id="562a0-107">Se si crea una nuova applicazione o si aggiorna un'applicazione e si vuole isolare l'applicazione da potenziali problemi, creare un [componente affiancato](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="562a0-107">If you are creating a new application or updating an application and want to isolate your application from potential problems, create a [side-by-side component](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="562a0-108">Per abilitare il reindirizzamento DLL a livello di computer, è necessario creare una nuova chiave del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="562a0-108">To enable DLL redirection machine-wide, you must create a new registry key.</span></span> <span data-ttu-id="562a0-109">Creare una nuova chiave DWORD denominata **DevOverrideEnable** in **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image opzioni di esecuzione file** e impostarla su 1.</span><span class="sxs-lookup"><span data-stu-id="562a0-109">Create a new DWORD key called **DevOverrideEnable** at **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** and set it to 1.</span></span> <span data-ttu-id="562a0-110">Al termine di questa operazione, è necessario riavviare il computer per visualizzare gli effetti.</span><span class="sxs-lookup"><span data-stu-id="562a0-110">After this, you must restart your computer to see the effects.</span></span>

<span data-ttu-id="562a0-111">Per usare il reindirizzamento DLL, creare un *file di reindirizzamento* per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="562a0-111">To use DLL redirection, create a *redirection file* for your application.</span></span> <span data-ttu-id="562a0-112">Il nome del file di reindirizzamento deve essere il seguente: *\_ nome dell'app*. local.</span><span class="sxs-lookup"><span data-stu-id="562a0-112">The redirection file must be named as follows: *App\_name*.local.</span></span> <span data-ttu-id="562a0-113">Se ad esempio il nome dell'applicazione è Editor.exe, il file di reindirizzamento deve essere denominato Editor.exe. local.</span><span class="sxs-lookup"><span data-stu-id="562a0-113">For example, if the application name is Editor.exe, the redirection file should be named Editor.exe.local.</span></span> <span data-ttu-id="562a0-114">È necessario installare il file. local nella directory dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="562a0-114">You must install the .local file in the application directory.</span></span> <span data-ttu-id="562a0-115">È necessario installare anche le dll nella directory dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="562a0-115">You must also install the DLLs in the application directory.</span></span>

<span data-ttu-id="562a0-116">Il contenuto di un file di reindirizzamento viene ignorato, ma la sua presenza fa in modo che Windows verifichi prima di tutto la directory dell'applicazione ogni volta che viene caricata una DLL, indipendentemente dal percorso specificato per [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="562a0-116">The contents of a redirection file are ignored, but its presence causes Windows to check the application directory first whenever it loads a DLL, regardless of the path specified to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="562a0-117">Se la DLL non viene trovata nella directory dell'applicazione, queste funzioni usano il consueto ordine di ricerca.</span><span class="sxs-lookup"><span data-stu-id="562a0-117">If the DLL is not found in the application directory, then these functions use their usual search order.</span></span> <span data-ttu-id="562a0-118">Ad esempio, se l'applicazione c: \\ myapp \\myapp.exe chiama **LoadLibrary** usando il percorso seguente:</span><span class="sxs-lookup"><span data-stu-id="562a0-118">For example, if the application c:\\myapp\\myapp.exe calls **LoadLibrary** using the following path:</span></span>

<span data-ttu-id="562a0-119">c: \\ Programmi file \\ comuni del \\ sistema \\mydll.dll</span><span class="sxs-lookup"><span data-stu-id="562a0-119">c:\\program files\\common files\\system\\mydll.dll</span></span>

<span data-ttu-id="562a0-120">Se sono presenti sia c: \\ myapp \\myapp.exe. local che c: \\ MyApp \\mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carica ilmydll.dll c: \\ MyApp \\ .</span><span class="sxs-lookup"><span data-stu-id="562a0-120">And, if both c:\\myapp\\myapp.exe.local and c:\\myapp\\mydll.dll exist, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\mydll.dll.</span></span> <span data-ttu-id="562a0-121">In caso contrario, **LoadLibrary** carica i file comuni del sistema di file c: \\ Program \\ \\ \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="562a0-121">Otherwise, **LoadLibrary** loads c:\\program files\\common files\\system\\mydll.dll.</span></span>

<span data-ttu-id="562a0-122">In alternativa, se esiste una directory denominata c: \\ myapp \\myapp.exe. local e contiene mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carica c: \\ MyApp \\myapp.exe. local \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="562a0-122">Alternatively, if a directory named c:\\myapp\\myapp.exe.local exists and contains mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\myapp.exe.local\\mydll.dll.</span></span>

<span data-ttu-id="562a0-123">Se l'applicazione dispone di un manifesto, i file. local verranno ignorati.</span><span class="sxs-lookup"><span data-stu-id="562a0-123">If the application has a manifest, then any .local files are ignored.</span></span>

<span data-ttu-id="562a0-124">Se si usa il reindirizzamento DLL e l'applicazione non ha accesso a tutte le unità e directory nell'ordine di ricerca, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) interrompe la ricerca non appena l'accesso viene negato.</span><span class="sxs-lookup"><span data-stu-id="562a0-124">If you are using DLL redirection and the application does not have access to all drives and directories in the search order, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) stops searching as soon as access is denied.</span></span> <span data-ttu-id="562a0-125">Se non si usa il reindirizzamento DLL, **LoadLibrary** ignora le directory a cui non può accedere e quindi continua la ricerca.</span><span class="sxs-lookup"><span data-stu-id="562a0-125">(If you are not using DLL redirection, **LoadLibrary** skips directories that it cannot access and then continues searching.)</span></span>

<span data-ttu-id="562a0-126">È consigliabile installare le DLL dell'applicazione nella stessa directory che contiene l'applicazione, anche se non si usa il reindirizzamento DLL.</span><span class="sxs-lookup"><span data-stu-id="562a0-126">It is good practice to install application DLLs in the same directory that contains the application, even if you are not using DLL redirection.</span></span> <span data-ttu-id="562a0-127">In questo modo si garantisce che l'installazione dell'applicazione non sovrascriva le altre copie della DLL e provochi l'esito negativo di altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="562a0-127">This ensures that installing the application does not overwrite other copies of the DLL and cause other applications to fail.</span></span> <span data-ttu-id="562a0-128">Inoltre, se si segue questa procedura consigliata, le altre applicazioni non sovrascrivono la copia della DLL e impediscono l'esecuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="562a0-128">Also, if you follow this good practice, other applications do not overwrite your copy of the DLL and cause your application to fail.</span></span>

 

 
