---
description: Per creare una libreria di Dynamic-Link (DLL), è necessario creare uno o più file di codice sorgente ed eventualmente un file del linker per l'esportazione delle funzioni.
ms.assetid: b66ea0e8-84c3-40be-bf02-765b9dd61f9f
title: Creazione della libreria di Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c12d296b1494cfcedcdfa823eb1a3dd4d408427a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753778"
---
# <a name="dynamic-link-library-creation"></a><span data-ttu-id="2a2fe-103">Creazione della libreria di Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="2a2fe-103">Dynamic-Link Library Creation</span></span>

<span data-ttu-id="2a2fe-104">Per creare una libreria di Dynamic-Link (DLL), è necessario creare uno o più file di codice sorgente ed eventualmente un file del linker per l'esportazione delle funzioni.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-104">To create a Dynamic-Link Library (DLL), you must create one or more source code files, and possibly a linker file for exporting the functions.</span></span> <span data-ttu-id="2a2fe-105">Se si prevede di consentire alle applicazioni che utilizzano la DLL di utilizzare il collegamento dinamico in fase di caricamento, è necessario creare anche una libreria di importazione.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-105">If you plan to allow applications that use your DLL to use load-time dynamic linking, you must also create an import library.</span></span>

## <a name="creating-source-files"></a><span data-ttu-id="2a2fe-106">Creazione di file di origine</span><span class="sxs-lookup"><span data-stu-id="2a2fe-106">Creating Source Files</span></span>

<span data-ttu-id="2a2fe-107">I file di origine per una DLL contengono funzioni e dati esportati, funzioni e dati interni e una [funzione del punto di ingresso](dynamic-link-library-entry-point-function.md) facoltativa per la dll.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-107">The source files for a DLL contain exported functions and data, internal functions and data, and an optional [entry-point function](dynamic-link-library-entry-point-function.md) for the DLL.</span></span> <span data-ttu-id="2a2fe-108">È possibile utilizzare qualsiasi strumento di sviluppo che supporta la creazione di DLL basate su Windows.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-108">You may use any development tools that support the creation of Windows-based DLLs.</span></span>

<span data-ttu-id="2a2fe-109">Se la DLL può essere usata da un'applicazione multithreading, è consigliabile rendere la DLL "thread-safe".</span><span class="sxs-lookup"><span data-stu-id="2a2fe-109">If your DLL may be used by a multithreaded application, you should make your DLL "thread-safe".</span></span> <span data-ttu-id="2a2fe-110">Per evitare il danneggiamento dei dati, è necessario sincronizzare l'accesso a tutti i dati globali della DLL.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-110">You must synchronize access to all of the DLL's global data to avoid data corruption.</span></span> <span data-ttu-id="2a2fe-111">È inoltre necessario assicurarsi di collegare solo le librerie thread-safe.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-111">You must also ensure that you link only with libraries that are thread-safe as well.</span></span> <span data-ttu-id="2a2fe-112">Ad esempio, Microsoft Visual C++ contiene più versioni della libreria di runtime del linguaggio C, una non thread-safe e due.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-112">For example, Microsoft Visual C++ contains multiple versions of the C Run-time Library, one that is not thread-safe and two that are.</span></span>

## <a name="exporting-functions"></a><span data-ttu-id="2a2fe-113">Esportazione di funzioni</span><span class="sxs-lookup"><span data-stu-id="2a2fe-113">Exporting Functions</span></span>

<span data-ttu-id="2a2fe-114">Il modo in cui si specificano le funzioni in una DLL da esportare dipende dagli strumenti utilizzati per lo sviluppo.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-114">How you specify which functions in a DLL should be exported depends on the tools that you are using for development.</span></span> <span data-ttu-id="2a2fe-115">Alcuni compilatori consentono di esportare una funzione direttamente nel codice sorgente usando un modificatore nella dichiarazione di funzione.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-115">Some compilers allow you to export a function directly in the source code by using a modifier in the function declaration.</span></span> <span data-ttu-id="2a2fe-116">In altri casi, è necessario specificare le esportazioni in un file passato al linker.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-116">Other times, you must specify exports in a file that you pass to the linker.</span></span>

<span data-ttu-id="2a2fe-117">Ad esempio, usando Visual C++, esistono due modi possibili per esportare le funzioni DLL: con il modificatore [**\_ \_ declspec (dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) o con un file di definizione moduli (con estensione def).</span><span class="sxs-lookup"><span data-stu-id="2a2fe-117">For example, using Visual C++, there are two possible ways to export DLL functions: with the [**\_\_declspec(dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) modifier or with a module-definition (.def) file.</span></span> <span data-ttu-id="2a2fe-118">Se si usa il modificatore **\_ \_ declspec (dllexport)** , non è necessario usare un file def.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-118">If you use the **\_\_declspec(dllexport)** modifier, it is not necessary to use a .def file.</span></span> <span data-ttu-id="2a2fe-119">Per ulteriori informazioni, vedere [esportazione da una dll](/cpp/build/exporting-from-a-dll?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="2a2fe-119">For more information, see [Exporting from a DLL](/cpp/build/exporting-from-a-dll?view=vs-2019).</span></span>

## <a name="creating-an-import-library"></a><span data-ttu-id="2a2fe-120">Creazione di una libreria di importazione</span><span class="sxs-lookup"><span data-stu-id="2a2fe-120">Creating an Import Library</span></span>

<span data-ttu-id="2a2fe-121">Un file della libreria di importazione (lib) contiene informazioni necessarie al linker per risolvere i riferimenti esterni alle funzioni DLL esportate, in modo che il sistema possa individuare la DLL specificata e le funzioni DLL esportate in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-121">An import library (.lib) file contains information the linker needs to resolve external references to exported DLL functions, so the system can locate the specified DLL and exported DLL functions at run time.</span></span> <span data-ttu-id="2a2fe-122">Quando si compila la DLL, è possibile creare una libreria di importazione per la DLL.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-122">You can create an import library for your DLL when you build your DLL.</span></span>

<span data-ttu-id="2a2fe-123">Per ulteriori informazioni, vedere [compilazione di una libreria di importazione e di un file di esportazione](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="2a2fe-123">For more information, see [Building an Import Library and Export File](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span></span>

## <a name="using-an-import-library"></a><span data-ttu-id="2a2fe-124">Utilizzo di una libreria di importazione</span><span class="sxs-lookup"><span data-stu-id="2a2fe-124">Using an Import Library</span></span>

<span data-ttu-id="2a2fe-125">Per chiamare la funzione [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , ad esempio, è necessario collegare il codice alla libreria di importazione User32. lib.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-125">For example, to call the [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) function, you must link your code with the import library User32.lib.</span></span> <span data-ttu-id="2a2fe-126">Il motivo è che **CreateWindow** risiede in una DLL di sistema denominata User32.dll e User32. lib è la libreria di importazione usata per risolvere le chiamate alle funzioni esportate in User32.dll nel codice.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-126">The reason is that **CreateWindow** resides in a system DLL named User32.dll, and User32.lib is the import library used to resolve the calls to exported functions in User32.dll in your code.</span></span> <span data-ttu-id="2a2fe-127">Il linker crea una tabella che contiene l'indirizzo di ogni chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-127">The linker creates a table that contains the address of each function call.</span></span> <span data-ttu-id="2a2fe-128">Le chiamate alle funzioni in una DLL verranno corrette quando viene caricata la DLL.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-128">Calls to functions in a DLL will be fixed up when the DLL is loaded.</span></span> <span data-ttu-id="2a2fe-129">Durante l'inizializzazione del processo, il sistema carica User32.dll perché il processo dipende dalle funzioni esportate in tale DLL e aggiorna le voci nella tabella dell'indirizzo della funzione.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-129">While the system is initializing the process, it loads User32.dll because the process depends on exported functions in that DLL, and it updates the entries in the function address table.</span></span> <span data-ttu-id="2a2fe-130">Tutte le chiamate a **CreateWindow** richiamano la funzione esportata da User32.dll.</span><span class="sxs-lookup"><span data-stu-id="2a2fe-130">All calls to **CreateWindow** invoke the function exported from User32.dll.</span></span>

<span data-ttu-id="2a2fe-131">Per informazioni, vedere [collegamento implicito a una dll](/previous-versions/d14wsce5(v=vs.140)).</span><span class="sxs-lookup"><span data-stu-id="2a2fe-131">For information, see [Linking Implicitly with a DLL](/previous-versions/d14wsce5(v=vs.140)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2a2fe-132">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="2a2fe-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2a2fe-133">Creazione di una libreria a collegamento dinamico semplice</span><span class="sxs-lookup"><span data-stu-id="2a2fe-133">Creating a Simple Dynamic-link Library</span></span>](creating-a-simple-dynamic-link-library.md)
</dt> <dt>

[<span data-ttu-id="2a2fe-134">Dll (Visual C++)</span><span class="sxs-lookup"><span data-stu-id="2a2fe-134">DLLs (Visual C++)</span></span>](/cpp/build/dlls-in-visual-cpp?view=vs-2019)
</dt> </dl>

 

 
