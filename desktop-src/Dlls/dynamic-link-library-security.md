---
description: Quando un'applicazione carica dinamicamente una libreria a collegamento dinamico senza specificare un nome di percorso completo, Windows tenta di individuare la DLL eseguendo una ricerca in un set di directory ben definito in un ordine specifico, come descritto in Dynamic-Link ordine di ricerca della libreria. Se un utente malintenzionato ottiene il controllo di una delle directory nel percorso di ricerca della DLL, può inserire una copia dannosa della DLL in tale directory. Questa operazione viene a volte definita attacco di precaricamento DLL o attacco binary planting.
ms.assetid: 9493F299-789D-4CBC-9822-96EEAE39B494
title: Sicurezza della libreria Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4016139762461784702ac0190c1ee65d8bc6e72d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317818"
---
# <a name="dynamic-link-library-security"></a><span data-ttu-id="db0f7-105">Sicurezza della libreria Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="db0f7-105">Dynamic-Link Library Security</span></span>

<span data-ttu-id="db0f7-106">Quando un'applicazione carica dinamicamente una libreria a collegamento dinamico senza specificare un nome di percorso completo, Windows tenta di individuare la DLL eseguendo una ricerca in un set di directory ben definito in un ordine specifico, come descritto in [ordine di ricerca nella libreria a collegamento dinamico](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="db0f7-106">When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span> <span data-ttu-id="db0f7-107">Se un utente malintenzionato ottiene il controllo di una delle directory nel percorso di ricerca della DLL, può inserire una copia dannosa della DLL in tale directory.</span><span class="sxs-lookup"><span data-stu-id="db0f7-107">If an attacker gains control of one of the directories on the DLL search path, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="db0f7-108">Questa operazione viene a volte definita *attacco di precaricamento dll* o *attacco Binary planting*.</span><span class="sxs-lookup"><span data-stu-id="db0f7-108">This is sometimes called a *DLL preloading attack* or a *binary planting attack*.</span></span> <span data-ttu-id="db0f7-109">Se il sistema non trova una copia legittima della DLL prima di eseguire ricerche nella directory compromessa, carica la DLL dannosa.</span><span class="sxs-lookup"><span data-stu-id="db0f7-109">If the system does not find a legitimate copy of the DLL before it searches the compromised directory, it loads the malicious DLL.</span></span> <span data-ttu-id="db0f7-110">Se l'applicazione è in esecuzione con privilegi di amministratore, l'utente malintenzionato potrebbe avere esito positivo nell'elevazione dei privilegi locali.</span><span class="sxs-lookup"><span data-stu-id="db0f7-110">If the application is running with administrator privileges, the attacker may succeed in local privilege elevation.</span></span>

<span data-ttu-id="db0f7-111">Si supponga, ad esempio, che un'applicazione sia progettata per caricare una DLL dalla directory corrente dell'utente e abbia esito negativo correttamente se la DLL non viene trovata.</span><span class="sxs-lookup"><span data-stu-id="db0f7-111">For example, suppose an application is designed to load a DLL from the user's current directory and fail gracefully if the DLL is not found.</span></span> <span data-ttu-id="db0f7-112">L'applicazione chiama [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) solo con il nome della dll, che determina la ricerca della dll da parte del sistema.</span><span class="sxs-lookup"><span data-stu-id="db0f7-112">The application calls [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) with just the name of the DLL, which causes the system to search for the DLL.</span></span> <span data-ttu-id="db0f7-113">Supponendo che la modalità di ricerca DLL sicura sia abilitata e che l'applicazione non usi un ordine di ricerca alternativo, il sistema cerca le directory nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="db0f7-113">Assuming safe DLL search mode is enabled and the application is not using an alternate search order, the system searches directories in the following order:</span></span>

1.  <span data-ttu-id="db0f7-114">Directory da cui è stata caricata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="db0f7-114">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="db0f7-115">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="db0f7-115">The system directory.</span></span>
3.  <span data-ttu-id="db0f7-116">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="db0f7-116">The 16-bit system directory.</span></span>
4.  <span data-ttu-id="db0f7-117">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="db0f7-117">The Windows directory.</span></span>
5.  <span data-ttu-id="db0f7-118">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="db0f7-118">The current directory.</span></span>
6.  <span data-ttu-id="db0f7-119">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="db0f7-119">The directories that are listed in the PATH environment variable.</span></span>

<span data-ttu-id="db0f7-120">Continuando l'esempio, un utente malintenzionato con conoscenza dell'applicazione acquisisce il controllo della directory corrente e inserisce una copia dannosa della DLL in tale directory.</span><span class="sxs-lookup"><span data-stu-id="db0f7-120">Continuing the example, an attacker with knowledge of the application gains control of the current directory and places a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="db0f7-121">Quando l'applicazione emette la chiamata a **LoadLibrary** , il sistema cerca la dll, individua la copia dannosa della dll nella directory corrente e la carica.</span><span class="sxs-lookup"><span data-stu-id="db0f7-121">When the application issues the **LoadLibrary** call, the system searches for the DLL, finds the malicious copy of the DLL in the current directory, and loads it.</span></span> <span data-ttu-id="db0f7-122">La copia dannosa della DLL viene quindi eseguita all'interno dell'applicazione e ottiene i privilegi dell'utente.</span><span class="sxs-lookup"><span data-stu-id="db0f7-122">The malicious copy of the DLL then runs within the application and gains the privileges of the user.</span></span>

<span data-ttu-id="db0f7-123">Gli sviluppatori possono contribuire a proteggere le proprie applicazioni dagli attacchi di precaricamento DLL attenendosi alle seguenti linee guida:</span><span class="sxs-lookup"><span data-stu-id="db0f7-123">Developers can help safeguard their applications against DLL preloading attacks by following these guidelines:</span></span>

-   <span data-ttu-id="db0f7-124">Laddove possibile, specificare un percorso completo quando si utilizzano le funzioni [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)o [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="db0f7-124">Wherever possible, specify a fully qualified path when using the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), or [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) functions.</span></span>
-   <span data-ttu-id="db0f7-125">Usare i flag di ricerca di LOAD \_ Library \_ con la funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) oppure usare questi flag con la funzione [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) per stabilire un ordine di ricerca dll per un processo e quindi usare le funzioni [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) per modificare l'elenco.</span><span class="sxs-lookup"><span data-stu-id="db0f7-125">Use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="db0f7-126">Per ulteriori informazioni, vedere l' [ordine di ricerca della libreria a collegamento dinamico](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="db0f7-126">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>

    <span data-ttu-id="db0f7-127">**Windows 7, Windows server 2008 R2, Windows Vista e Windows server 2008:** Questi flag e funzioni sono disponibili nei sistemi in cui è installato [KB2533623](https://support.microsoft.com/kb/2533623) .</span><span class="sxs-lookup"><span data-stu-id="db0f7-127">**Windows 7, Windows Server 2008 R2, Windows Vista and Windows Server 2008:** These flags and functions are available on systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed.</span></span>

-   <span data-ttu-id="db0f7-128">Nei sistemi in cui è installato [KB2533623](https://support.microsoft.com/kb/2533623) usare i \_ flag di ricerca di Load Library \_ con la funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) oppure usare questi flag con la funzione [**SETDEFAULTDLLDIRECTORIES**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) per stabilire un ordine di ricerca dll per un processo e quindi usare le funzioni [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) per modificare l'elenco.</span><span class="sxs-lookup"><span data-stu-id="db0f7-128">On systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed, use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="db0f7-129">Per ulteriori informazioni, vedere l' [ordine di ricerca della libreria a collegamento dinamico](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="db0f7-129">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="db0f7-130">Si consiglia di usare il [Reindirizzamento dll](dynamic-link-library-redirection.md) o un [manifesto](/windows/desktop/SbsCs/manifests) per assicurarsi che l'applicazione usi la DLL corretta.</span><span class="sxs-lookup"><span data-stu-id="db0f7-130">Consider using [DLL redirection](dynamic-link-library-redirection.md) or a [manifest](/windows/desktop/SbsCs/manifests) to ensure that your application uses the correct DLL.</span></span>
-   <span data-ttu-id="db0f7-131">Quando si usa l'ordine di ricerca standard, verificare che la modalità di ricerca DLL sicura sia abilitata.</span><span class="sxs-lookup"><span data-stu-id="db0f7-131">When using the standard search order, make sure that safe DLL search mode is enabled.</span></span> <span data-ttu-id="db0f7-132">In questo modo la directory corrente dell'utente viene posizionata in un secondo momento nell'ordine di ricerca, aumentando la probabilità che Windows trovi una copia legittima della DLL prima di una copia dannosa.</span><span class="sxs-lookup"><span data-stu-id="db0f7-132">This places the user's current directory later in the search order, increasing the chances that Windows will find a legitimate copy of the DLL before a malicious copy.</span></span> <span data-ttu-id="db0f7-133">La modalità di ricerca delle dll sicure è abilitata per impostazione predefinita a partire da Windows XP con Service Pack 2 (SP2) ed è controllata dal valore del registro di **\_ sistema HKEY LOCAL \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager** \\ **SafeDllSearchMode** .</span><span class="sxs-lookup"><span data-stu-id="db0f7-133">Safe DLL search mode is enabled by default starting with Windows XP with Service Pack 2 (SP2) and is controlled by the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value.</span></span> <span data-ttu-id="db0f7-134">Per ulteriori informazioni, vedere l' [ordine di ricerca della libreria a collegamento dinamico](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="db0f7-134">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="db0f7-135">Provare a rimuovere la directory corrente dal percorso di ricerca standard chiamando [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) con una stringa vuota ("").</span><span class="sxs-lookup"><span data-stu-id="db0f7-135">Consider removing the current directory from the standard search path by calling [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) with an empty string ("").</span></span> <span data-ttu-id="db0f7-136">Questa operazione deve essere eseguita una volta all'inizio dell'inizializzazione del processo, non prima e dopo le chiamate a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span><span class="sxs-lookup"><span data-stu-id="db0f7-136">This should be done once early in process initialization, not before and after calls to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span></span> <span data-ttu-id="db0f7-137">Tenere presente che **SetDllDirectory** influiscono sull'intero processo e che più thread che chiamano **SetDllDirectory** con valori diversi possono causare un comportamento non definito.</span><span class="sxs-lookup"><span data-stu-id="db0f7-137">Be aware that **SetDllDirectory** affects the entire process and that multiple threads calling **SetDllDirectory** with different values can cause undefined behavior.</span></span> <span data-ttu-id="db0f7-138">Se l'applicazione carica dll di terze parti, eseguire un test con attenzione per identificare eventuali incompatibilità.</span><span class="sxs-lookup"><span data-stu-id="db0f7-138">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="db0f7-139">Non usare la funzione [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) per recuperare un percorso di una dll per una chiamata [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) successiva, a meno che non sia abilitata la modalità di ricerca processo sicura.</span><span class="sxs-lookup"><span data-stu-id="db0f7-139">Do not use the [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) function to retrieve a path to a DLL for a subsequent [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call unless safe process search mode is enabled.</span></span> <span data-ttu-id="db0f7-140">Quando la modalità di ricerca del processo sicuro non è abilitata, la funzione **SearchPath** utilizza un ordine di ricerca diverso da **LoadLibrary** ed è probabile che prima venga cercata la DLL specificata nella directory corrente dell'utente.</span><span class="sxs-lookup"><span data-stu-id="db0f7-140">When safe process search mode is not enabled, the **SearchPath** function uses a different search order than **LoadLibrary** and is likely to first search the user's current directory for the specified DLL.</span></span> <span data-ttu-id="db0f7-141">Per abilitare la modalità di ricerca del processo sicuro per la funzione **SearchPath** , usare la funzione [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) con il percorso di ricerca di base \_ \_ \_ enable \_ Safe \_ SEARCHMODE.</span><span class="sxs-lookup"><span data-stu-id="db0f7-141">To enable safe process search mode for the **SearchPath** function, use the [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) function with BASE\_SEARCH\_PATH\_ENABLE\_SAFE\_SEARCHMODE.</span></span> <span data-ttu-id="db0f7-142">In questo modo la directory corrente viene spostata alla fine dell'elenco di ricerca di **SearchPath** per la durata del processo.</span><span class="sxs-lookup"><span data-stu-id="db0f7-142">This moves the current directory to the end of the **SearchPath** search list for the life of the process.</span></span> <span data-ttu-id="db0f7-143">Si noti che la directory corrente non viene rimossa dal percorso di ricerca, pertanto se il sistema non trova una copia legittima della DLL prima che raggiunga la directory corrente, l'applicazione è ancora vulnerabile.</span><span class="sxs-lookup"><span data-stu-id="db0f7-143">Note that the current directory is not removed from the search path, so if the system does not find a legitimate copy of the DLL before it reaches the current directory, the application is still vulnerable.</span></span> <span data-ttu-id="db0f7-144">Come per [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), la chiamata di **SetSearchPathMode** deve essere eseguita all'inizio dell'inizializzazione del processo e influire sull'intero processo.</span><span class="sxs-lookup"><span data-stu-id="db0f7-144">As with [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), calling **SetSearchPathMode** should be done early in process initialization and it affects the entire process.</span></span> <span data-ttu-id="db0f7-145">Se l'applicazione carica dll di terze parti, eseguire un test con attenzione per identificare eventuali incompatibilità.</span><span class="sxs-lookup"><span data-stu-id="db0f7-145">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="db0f7-146">Non creare presupposti sulla versione del sistema operativo in base a una chiamata [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) che cerca una dll.</span><span class="sxs-lookup"><span data-stu-id="db0f7-146">Do not make assumptions about the operating system version based on a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call that searches for a DLL.</span></span> <span data-ttu-id="db0f7-147">Se l'applicazione è in esecuzione in un ambiente in cui la DLL non è presente, ma una copia dannosa della DLL si trova nel percorso di ricerca, è possibile che venga caricata la copia dannosa della DLL.</span><span class="sxs-lookup"><span data-stu-id="db0f7-147">If the application is running in an environment where the DLL is legitimately not present but a malicious copy of the DLL is in the search path, the malicious copy of the DLL may be loaded.</span></span> <span data-ttu-id="db0f7-148">Usare invece le tecniche consigliate descritte in [recupero della versione del sistema](/windows/desktop/SysInfo/getting-the-system-version).</span><span class="sxs-lookup"><span data-stu-id="db0f7-148">Instead, use the recommended techniques described in [Getting the System Version](/windows/desktop/SysInfo/getting-the-system-version).</span></span>

<span data-ttu-id="db0f7-149">Lo strumento di monitoraggio del processo può essere usato per identificare le operazioni di caricamento DLL che potrebbero essere vulnerabili.</span><span class="sxs-lookup"><span data-stu-id="db0f7-149">The Process Monitor tool can be used to help identify DLL load operations that might be vulnerable.</span></span> <span data-ttu-id="db0f7-150">Lo strumento di monitoraggio del processo può essere scaricato da <https://technet.microsoft.com/sysinternals/bb896645.aspx> .</span><span class="sxs-lookup"><span data-stu-id="db0f7-150">The Process Monitor tool can be downloaded from <https://technet.microsoft.com/sysinternals/bb896645.aspx>.</span></span>

<span data-ttu-id="db0f7-151">Nella procedura seguente viene descritto come utilizzare Process Monitor per esaminare le operazioni di caricamento delle DLL nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="db0f7-151">The following procedure describes how to use Process Monitor to examine DLL load operations in your application.</span></span>

<span data-ttu-id="db0f7-152">**Per utilizzare Process Monitor per esaminare le operazioni di caricamento delle DLL nell'applicazione**</span><span class="sxs-lookup"><span data-stu-id="db0f7-152">**To use Process Monitor to examine DLL load operations in your application**</span></span>

1.  <span data-ttu-id="db0f7-153">Avviare il monitoraggio del processo.</span><span class="sxs-lookup"><span data-stu-id="db0f7-153">Start Process Monitor.</span></span>
2.  <span data-ttu-id="db0f7-154">In elaborazione monitoraggio includere i filtri seguenti:</span><span class="sxs-lookup"><span data-stu-id="db0f7-154">In Process Monitor, include the following filters:</span></span>
    -   <span data-ttu-id="db0f7-155">L'operazione è CreateFile</span><span class="sxs-lookup"><span data-stu-id="db0f7-155">Operation is CreateFile</span></span>
    -   <span data-ttu-id="db0f7-156">L'operazione è LoadImage</span><span class="sxs-lookup"><span data-stu-id="db0f7-156">Operation is LoadImage</span></span>
    -   <span data-ttu-id="db0f7-157">Il percorso contiene. cpl</span><span class="sxs-lookup"><span data-stu-id="db0f7-157">Path contains .cpl</span></span>
    -   <span data-ttu-id="db0f7-158">Il percorso contiene. dll</span><span class="sxs-lookup"><span data-stu-id="db0f7-158">Path contains .dll</span></span>
    -   <span data-ttu-id="db0f7-159">Il percorso contiene. drv</span><span class="sxs-lookup"><span data-stu-id="db0f7-159">Path contains .drv</span></span>
    -   <span data-ttu-id="db0f7-160">Il percorso contiene. exe</span><span class="sxs-lookup"><span data-stu-id="db0f7-160">Path contains .exe</span></span>
    -   <span data-ttu-id="db0f7-161">Il percorso contiene. ocx</span><span class="sxs-lookup"><span data-stu-id="db0f7-161">Path contains .ocx</span></span>
    -   <span data-ttu-id="db0f7-162">Il percorso contiene. SCR</span><span class="sxs-lookup"><span data-stu-id="db0f7-162">Path contains .scr</span></span>
    -   <span data-ttu-id="db0f7-163">Il percorso contiene. sys</span><span class="sxs-lookup"><span data-stu-id="db0f7-163">Path contains .sys</span></span>
3.  <span data-ttu-id="db0f7-164">Escludere i filtri seguenti:</span><span class="sxs-lookup"><span data-stu-id="db0f7-164">Exclude the following filters:</span></span>
    -   <span data-ttu-id="db0f7-165">Il nome del processo è procmon.exe</span><span class="sxs-lookup"><span data-stu-id="db0f7-165">Process Name is procmon.exe</span></span>
    -   <span data-ttu-id="db0f7-166">Il nome del processo è Procmon64.exe</span><span class="sxs-lookup"><span data-stu-id="db0f7-166">Process Name is Procmon64.exe</span></span>
    -   <span data-ttu-id="db0f7-167">Il nome del processo è System</span><span class="sxs-lookup"><span data-stu-id="db0f7-167">Process Name is System</span></span>
    -   <span data-ttu-id="db0f7-168">L'operazione inizia con IRP \_ MJ\_</span><span class="sxs-lookup"><span data-stu-id="db0f7-168">Operation begins with IRP\_MJ\_</span></span>
    -   <span data-ttu-id="db0f7-169">L'operazione inizia con FASTIO\_</span><span class="sxs-lookup"><span data-stu-id="db0f7-169">Operation begins with FASTIO\_</span></span>
    -   <span data-ttu-id="db0f7-170">Il risultato è SUCCESS</span><span class="sxs-lookup"><span data-stu-id="db0f7-170">Result is SUCCESS</span></span>
    -   <span data-ttu-id="db0f7-171">Il percorso termina con pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="db0f7-171">Path ends with pagefile.sys</span></span>
4.  <span data-ttu-id="db0f7-172">Tentare di avviare l'applicazione con la directory corrente impostata su una directory specifica.</span><span class="sxs-lookup"><span data-stu-id="db0f7-172">Attempt to start your application with the current directory set to a specific directory.</span></span> <span data-ttu-id="db0f7-173">Ad esempio, fare doppio clic su un file con un'estensione il cui gestore file è assegnato all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="db0f7-173">For example, double-click a file with an extension whose file handler is assigned to your application.</span></span>
5.  <span data-ttu-id="db0f7-174">Controllare l'output di Process Monitor per individuare i percorsi sospetti, ad esempio una chiamata alla directory corrente per caricare una DLL.</span><span class="sxs-lookup"><span data-stu-id="db0f7-174">Check Process Monitor output for paths that look suspicious, such as a call to the current directory to load a DLL.</span></span> <span data-ttu-id="db0f7-175">Questo tipo di chiamata potrebbe indicare una vulnerabilità nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="db0f7-175">This kind of call might indicate a vulnerability in your application.</span></span>

 

 
