---
description: Le applicazioni possono controllare la posizione da cui viene caricata una DLL specificando un percorso completo o un altro meccanismo, ad esempio un manifesto. Se questi metodi non vengono usati, il sistema cerca la DLL in fase di caricamento, come descritto in questo argomento.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Ordine di ricerca della libreria Dynamic-Link
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/04/2021
ms.locfileid: "104520330"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="986a5-104">Ordine di ricerca della libreria Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="986a5-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="986a5-105">Un sistema può contenere più versioni della stessa libreria di collegamento dinamico (DLL).</span><span class="sxs-lookup"><span data-stu-id="986a5-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="986a5-106">Le applicazioni possono controllare la posizione da cui viene caricata una DLL specificando un percorso completo o un altro meccanismo, ad esempio un manifesto.</span><span class="sxs-lookup"><span data-stu-id="986a5-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="986a5-107">Se questi metodi non vengono usati, il sistema cerca la DLL in fase di caricamento, come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="986a5-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="986a5-108">Fattori che influiscono sulla ricerca</span><span class="sxs-lookup"><span data-stu-id="986a5-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="986a5-109">Ordine di ricerca per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="986a5-110">Ordine di ricerca standard per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="986a5-111">Ordine di ricerca alternativo per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="986a5-112">Ordine di ricerca per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="986a5-113">Ordine di ricerca standard per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="986a5-114">Ordine di ricerca alternativo per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="986a5-115">Ordine di ricerca usando i flag di **\_ \_ ricerca della libreria di caricamento**</span><span class="sxs-lookup"><span data-stu-id="986a5-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="986a5-116">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="986a5-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="986a5-117">Fattori che influiscono sulla ricerca</span><span class="sxs-lookup"><span data-stu-id="986a5-117">Factors That Affect Searching</span></span>

<span data-ttu-id="986a5-118">I seguenti fattori influiscono sull'eventuale ricerca di una DLL da parte del sistema:</span><span class="sxs-lookup"><span data-stu-id="986a5-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="986a5-119">Se una DLL con lo stesso nome di modulo è già caricata in memoria, il sistema controlla solo il reindirizzamento e un manifesto prima della risoluzione nella DLL caricata, indipendentemente dalla directory in cui si trova.</span><span class="sxs-lookup"><span data-stu-id="986a5-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="986a5-120">Il sistema non esegue la ricerca della DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="986a5-121">Se la DLL è nell'elenco di dll note per la versione di Windows in cui è in esecuzione l'applicazione, il sistema utilizza la copia della DLL nota (e le DLL dipendenti della DLL, se presenti) invece di cercare la DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="986a5-122">Per un elenco di dll note nel sistema corrente, vedere la chiave del registro di sistema seguente: **HKEY \_ Local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLL**.</span><span class="sxs-lookup"><span data-stu-id="986a5-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="986a5-123">Se una DLL presenta dipendenze, il sistema cerca le DLL dipendenti come se fossero state caricate solo con i nomi dei moduli.</span><span class="sxs-lookup"><span data-stu-id="986a5-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="986a5-124">Questo vale anche se la prima DLL è stata caricata specificando un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="986a5-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="986a5-125">Ordine di ricerca per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-125">Search Order for UWP apps</span></span>

<span data-ttu-id="986a5-126">Quando un'app UWP per Windows 10 (o un'app dello Store per Windows 8. x) carica un modulo in pacchetto chiamando la funzione [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) , la dll deve trovarsi nel grafico delle dipendenze del pacchetto del processo.</span><span class="sxs-lookup"><span data-stu-id="986a5-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="986a5-127">Per ulteriori informazioni, vedere **LoadPackagedLibrary**.</span><span class="sxs-lookup"><span data-stu-id="986a5-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="986a5-128">Quando un'app UWP carica un modulo con altri mezzi e non specifica un percorso completo, il sistema cerca la DLL e le relative dipendenze in fase di caricamento, come descritto in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="986a5-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="986a5-129">Prima che il sistema esegua la ricerca di una DLL, verifica quanto segue:</span><span class="sxs-lookup"><span data-stu-id="986a5-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="986a5-130">Se una DLL con lo stesso nome di modulo è già caricata in memoria, il sistema usa la DLL caricata, indipendentemente dalla directory in cui si trova.</span><span class="sxs-lookup"><span data-stu-id="986a5-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="986a5-131">Il sistema non esegue la ricerca della DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="986a5-132">Se la DLL è nell'elenco di dll note per la versione di Windows in cui è in esecuzione l'applicazione, il sistema usa la copia della DLL nota (e le DLL dipendenti della DLL, se presenti).</span><span class="sxs-lookup"><span data-stu-id="986a5-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="986a5-133">Il sistema non esegue la ricerca della DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-133">The system does not search for the DLL.</span></span> <span data-ttu-id="986a5-134">Per un elenco di dll note nel sistema corrente, vedere la chiave del registro di sistema seguente: **HKEY \_ Local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLL**.</span><span class="sxs-lookup"><span data-stu-id="986a5-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="986a5-135">Se il sistema deve cercare un modulo o le relative dipendenze, USA sempre l'ordine di ricerca per le app UWP anche se una dipendenza non è il codice dell'app UWP.</span><span class="sxs-lookup"><span data-stu-id="986a5-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="986a5-136">Ordine di ricerca standard per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="986a5-137">Se il modulo non è già caricato o nell'elenco di dll note, il sistema esegue la ricerca in questi percorsi nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="986a5-138">Grafico delle dipendenze del pacchetto del processo.</span><span class="sxs-lookup"><span data-stu-id="986a5-138">The package dependency graph of the process.</span></span> <span data-ttu-id="986a5-139">Si tratta del pacchetto dell'applicazione più tutte le dipendenze specificate come `<PackageDependency>` nella `<Dependencies>` sezione del manifesto del pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986a5-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="986a5-140">Le dipendenze vengono ricercate nell'ordine in cui sono visualizzate nel manifesto.</span><span class="sxs-lookup"><span data-stu-id="986a5-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="986a5-141">La directory da cui è stato caricato il processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="986a5-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="986a5-142">Directory di sistema (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="986a5-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="986a5-143">Se una DLL presenta dipendenze, il sistema cerca le DLL dipendenti come se fossero state caricate solo con i nomi dei moduli.</span><span class="sxs-lookup"><span data-stu-id="986a5-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="986a5-144">Questo vale anche se la prima DLL è stata caricata specificando un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="986a5-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="986a5-145">Ordine di ricerca alternativo per le app UWP</span><span class="sxs-lookup"><span data-stu-id="986a5-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="986a5-146">Se un modulo modifica l'ordine di ricerca standard chiamando la funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con **Load \_ con \_ il \_ \_ percorso di ricerca modificato**, il sistema cerca nella directory in cui è stato caricato il modulo specificato anziché nella directory del processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="986a5-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="986a5-147">Il sistema esegue la ricerca di questi percorsi nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="986a5-148">Grafico delle dipendenze del pacchetto del processo.</span><span class="sxs-lookup"><span data-stu-id="986a5-148">The package dependency graph of the process.</span></span> <span data-ttu-id="986a5-149">Si tratta del pacchetto dell'applicazione più tutte le dipendenze specificate come `<PackageDependency>` nella `<Dependencies>` sezione del manifesto del pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986a5-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="986a5-150">Le dipendenze vengono ricercate nell'ordine in cui sono visualizzate nel manifesto.</span><span class="sxs-lookup"><span data-stu-id="986a5-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="986a5-151">Directory da cui è stato caricato il modulo specificato.</span><span class="sxs-lookup"><span data-stu-id="986a5-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="986a5-152">Directory di sistema (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="986a5-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="986a5-153">Ordine di ricerca per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="986a5-154">Le applicazioni desktop possono controllare la posizione da cui viene caricata una DLL specificando un percorso completo, usando il [Reindirizzamento della dll](dynamic-link-library-redirection.md)o usando un [manifesto](/windows/desktop/SbsCs/manifests).</span><span class="sxs-lookup"><span data-stu-id="986a5-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="986a5-155">Se nessuno di questi metodi viene usato, il sistema cerca la DLL in fase di caricamento, come descritto in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="986a5-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="986a5-156">Prima che il sistema esegua la ricerca di una DLL, verifica quanto segue:</span><span class="sxs-lookup"><span data-stu-id="986a5-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="986a5-157">Se una DLL con lo stesso nome di modulo è già caricata in memoria, il sistema usa la DLL caricata, indipendentemente dalla directory in cui si trova.</span><span class="sxs-lookup"><span data-stu-id="986a5-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="986a5-158">Il sistema non esegue la ricerca della DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="986a5-159">Se la DLL è nell'elenco di dll note per la versione di Windows in cui è in esecuzione l'applicazione, il sistema usa la copia della DLL nota (e le DLL dipendenti della DLL, se presenti).</span><span class="sxs-lookup"><span data-stu-id="986a5-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="986a5-160">Il sistema non esegue la ricerca della DLL.</span><span class="sxs-lookup"><span data-stu-id="986a5-160">The system does not search for the DLL.</span></span> <span data-ttu-id="986a5-161">Per un elenco di dll note nel sistema corrente, vedere la chiave del registro di sistema seguente: **HKEY \_ Local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLL**.</span><span class="sxs-lookup"><span data-stu-id="986a5-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="986a5-162">Se una DLL presenta dipendenze, il sistema cerca le DLL dipendenti come se fossero state caricate solo con i nomi dei moduli.</span><span class="sxs-lookup"><span data-stu-id="986a5-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="986a5-163">Questo vale anche se la prima DLL è stata caricata specificando un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="986a5-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="986a5-164">Se un utente malintenzionato ottiene il controllo di una delle directory in cui viene eseguita la ricerca, può inserire una copia dannosa della DLL in tale directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="986a5-165">Per informazioni su come prevenire tali attacchi, vedere [sicurezza della libreria a collegamento dinamico](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="986a5-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="986a5-166">Ordine di ricerca standard per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="986a5-167">L'ordine di ricerca DLL standard utilizzato dal sistema dipende dall'abilitazione o disabilitazione della modalità di ricerca DLL sicura.</span><span class="sxs-lookup"><span data-stu-id="986a5-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="986a5-168">La modalità di ricerca DLL sicura inserisce la directory corrente dell'utente in un secondo momento nell'ordine di ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="986a5-169">La modalità di ricerca delle DLL sicure è abilitata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="986a5-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="986a5-170">Per disabilitare questa funzionalità, creare il valore del registro di **\_ sistema HKEY LOCAL \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager** \\ **SafeDllSearchMode** e impostarlo su 0.</span><span class="sxs-lookup"><span data-stu-id="986a5-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="986a5-171">La chiamata della funzione [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) Disabilita **SafeDllSearchMode** mentre la directory specificata si trova nel percorso di ricerca e modifica l'ordine di ricerca come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="986a5-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="986a5-172">Se **SafeDllSearchMode** è abilitata, l'ordine di ricerca è il seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="986a5-173">Directory da cui è stata caricata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986a5-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="986a5-174">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="986a5-174">The system directory.</span></span> <span data-ttu-id="986a5-175">Usare la funzione [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="986a5-176">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="986a5-176">The 16-bit system directory.</span></span> <span data-ttu-id="986a5-177">Non esiste alcuna funzione che ottenga il percorso di questa directory, ma ne viene eseguita la ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="986a5-178">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="986a5-178">The Windows directory.</span></span> <span data-ttu-id="986a5-179">Usare la funzione [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="986a5-180">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="986a5-180">The current directory.</span></span>
6.  <span data-ttu-id="986a5-181">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="986a5-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="986a5-182">Si noti che questo non include il percorso per applicazione specificato dalla chiave del registro di sistema **percorsi app** .</span><span class="sxs-lookup"><span data-stu-id="986a5-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="986a5-183">La chiave dei **percorsi dell'app** non viene usata per il calcolo del percorso di ricerca della dll.</span><span class="sxs-lookup"><span data-stu-id="986a5-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="986a5-184">Se **SafeDllSearchMode** è disabilitato, l'ordine di ricerca sarà il seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="986a5-185">Directory da cui è stata caricata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986a5-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="986a5-186">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="986a5-186">The current directory.</span></span>
3.  <span data-ttu-id="986a5-187">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="986a5-187">The system directory.</span></span> <span data-ttu-id="986a5-188">Usare la funzione [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="986a5-189">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="986a5-189">The 16-bit system directory.</span></span> <span data-ttu-id="986a5-190">Non esiste alcuna funzione che ottenga il percorso di questa directory, ma ne viene eseguita la ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="986a5-191">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="986a5-191">The Windows directory.</span></span> <span data-ttu-id="986a5-192">Usare la funzione [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="986a5-193">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="986a5-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="986a5-194">Si noti che questo non include il percorso per applicazione specificato dalla chiave del registro di sistema **percorsi app** .</span><span class="sxs-lookup"><span data-stu-id="986a5-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="986a5-195">La chiave dei **percorsi dell'app** non viene usata per il calcolo del percorso di ricerca della dll.</span><span class="sxs-lookup"><span data-stu-id="986a5-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="986a5-196">Ordine di ricerca alternativo per le applicazioni desktop</span><span class="sxs-lookup"><span data-stu-id="986a5-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="986a5-197">È possibile modificare l'ordine di ricerca standard utilizzato dal sistema chiamando la funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con **Load \_ con \_ percorso di \_ ricerca \_ modificato**.</span><span class="sxs-lookup"><span data-stu-id="986a5-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="986a5-198">È anche possibile modificare l'ordine di ricerca standard chiamando la funzione [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="986a5-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="986a5-199">Anche l'ordine di ricerca standard del processo sarà influenzato dalla chiamata della funzione [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) nel processo padre prima dell'avvio del processo corrente.</span><span class="sxs-lookup"><span data-stu-id="986a5-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="986a5-200">Se si specifica una strategia di ricerca alternativa, il comportamento continua fino a quando non sono stati individuati tutti i moduli eseguibili associati.</span><span class="sxs-lookup"><span data-stu-id="986a5-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="986a5-201">Dopo che il sistema ha avviato l'elaborazione delle routine di inizializzazione della DLL, il sistema ripristina la strategia di ricerca standard.</span><span class="sxs-lookup"><span data-stu-id="986a5-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="986a5-202">La funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) supporta un ordine di ricerca alternativo se la chiamata specifica **Load \_ con \_ \_ \_ percorso di ricerca modificato** e il parametro *lpFileName* specifica un percorso assoluto.</span><span class="sxs-lookup"><span data-stu-id="986a5-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="986a5-203">Si noti che la strategia di ricerca standard e la strategia di ricerca alternativa specificata da [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con **Load \_ con \_ \_ \_ percorso di ricerca modificato** sono diverse in un solo modo: la ricerca standard inizia nella directory dell'applicazione chiamante e la ricerca alternativa inizia nella directory del modulo eseguibile che **LoadLibraryEx** sta caricando.</span><span class="sxs-lookup"><span data-stu-id="986a5-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="986a5-204">Se **SafeDllSearchMode** è abilitato, l'ordine di ricerca alternativo è il seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="986a5-205">Directory specificata da *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="986a5-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="986a5-206">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="986a5-206">The system directory.</span></span> <span data-ttu-id="986a5-207">Usare la funzione [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="986a5-208">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="986a5-208">The 16-bit system directory.</span></span> <span data-ttu-id="986a5-209">Non esiste alcuna funzione che ottenga il percorso di questa directory, ma ne viene eseguita la ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="986a5-210">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="986a5-210">The Windows directory.</span></span> <span data-ttu-id="986a5-211">Usare la funzione [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="986a5-212">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="986a5-212">The current directory.</span></span>
6.  <span data-ttu-id="986a5-213">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="986a5-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="986a5-214">Si noti che questo non include il percorso per applicazione specificato dalla chiave del registro di sistema **percorsi app** .</span><span class="sxs-lookup"><span data-stu-id="986a5-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="986a5-215">La chiave dei **percorsi dell'app** non viene usata per il calcolo del percorso di ricerca della dll.</span><span class="sxs-lookup"><span data-stu-id="986a5-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="986a5-216">Se **SafeDllSearchMode** è disabilitato, l'ordine di ricerca alternativo è il seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="986a5-217">Directory specificata da *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="986a5-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="986a5-218">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="986a5-218">The current directory.</span></span>
3.  <span data-ttu-id="986a5-219">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="986a5-219">The system directory.</span></span> <span data-ttu-id="986a5-220">Usare la funzione [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="986a5-221">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="986a5-221">The 16-bit system directory.</span></span> <span data-ttu-id="986a5-222">Non esiste alcuna funzione che ottenga il percorso di questa directory, ma ne viene eseguita la ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="986a5-223">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="986a5-223">The Windows directory.</span></span> <span data-ttu-id="986a5-224">Usare la funzione [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="986a5-225">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="986a5-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="986a5-226">Si noti che questo non include il percorso per applicazione specificato dalla chiave del registro di sistema **percorsi app** .</span><span class="sxs-lookup"><span data-stu-id="986a5-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="986a5-227">La chiave dei **percorsi dell'app** non viene usata per il calcolo del percorso di ricerca della dll.</span><span class="sxs-lookup"><span data-stu-id="986a5-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="986a5-228">La funzione [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) supporta un ordine di ricerca alternativo se il parametro *lpPathName* specifica un percorso.</span><span class="sxs-lookup"><span data-stu-id="986a5-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="986a5-229">L'ordine di ricerca alternativo è il seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="986a5-230">Directory da cui è stata caricata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986a5-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="986a5-231">Directory specificata dal parametro *lpPathName* di [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span><span class="sxs-lookup"><span data-stu-id="986a5-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="986a5-232">Directory di sistema.</span><span class="sxs-lookup"><span data-stu-id="986a5-232">The system directory.</span></span> <span data-ttu-id="986a5-233">Usare la funzione [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="986a5-234">Il nome di questa directory è system32.</span><span class="sxs-lookup"><span data-stu-id="986a5-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="986a5-235">Directory di sistema a 16 bit.</span><span class="sxs-lookup"><span data-stu-id="986a5-235">The 16-bit system directory.</span></span> <span data-ttu-id="986a5-236">Non esiste alcuna funzione che ottenga il percorso di questa directory, ma ne viene eseguita la ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="986a5-237">Il nome di questa directory è System.</span><span class="sxs-lookup"><span data-stu-id="986a5-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="986a5-238">Directory di Windows.</span><span class="sxs-lookup"><span data-stu-id="986a5-238">The Windows directory.</span></span> <span data-ttu-id="986a5-239">Usare la funzione [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) per ottenere il percorso di questa directory.</span><span class="sxs-lookup"><span data-stu-id="986a5-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="986a5-240">Directory elencate nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="986a5-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="986a5-241">Si noti che questo non include il percorso per applicazione specificato dalla chiave del registro di sistema **percorsi app** .</span><span class="sxs-lookup"><span data-stu-id="986a5-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="986a5-242">La chiave dei **percorsi dell'app** non viene usata per il calcolo del percorso di ricerca della dll.</span><span class="sxs-lookup"><span data-stu-id="986a5-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="986a5-243">Se il parametro *lpPathName* è una stringa vuota, la chiamata rimuove la directory corrente dall'ordine di ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="986a5-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) Disabilita in modo efficace la modalità di ricerca dll sicura mentre la directory specificata si trova nel percorso di ricerca.</span><span class="sxs-lookup"><span data-stu-id="986a5-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="986a5-245">Per ripristinare la modalità di ricerca DLL sicura in base al valore del registro di sistema **SafeDllSearchMode** e ripristinare la directory corrente nell'ordine di ricerca, chiamare **SetDllDirectory** con *lpPathName* come null.</span><span class="sxs-lookup"><span data-stu-id="986a5-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="986a5-246">Ordine di ricerca usando i flag di **\_ \_ ricerca della libreria di caricamento**</span><span class="sxs-lookup"><span data-stu-id="986a5-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="986a5-247">Un'applicazione può specificare un ordine di ricerca usando uno o più flag di **\_ \_ ricerca della libreria di caricamento** con la funzione [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) .</span><span class="sxs-lookup"><span data-stu-id="986a5-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="986a5-248">Un'applicazione può anche usare i flag di **\_ \_ ricerca della libreria di caricamento** con la funzione [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) per stabilire un ordine di ricerca dll per un processo.</span><span class="sxs-lookup"><span data-stu-id="986a5-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="986a5-249">L'applicazione può specificare directory aggiuntive per l'ordine di ricerca DLL di processo usando le funzioni [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="986a5-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="986a5-250">Le directory di cui viene eseguita la ricerca dipendono dai flag specificati con [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="986a5-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="986a5-251">Se viene utilizzato più di un flag, viene eseguita la ricerca nelle directory corrispondenti nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="986a5-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="986a5-252">Directory che contiene la DLL (carica directory di **caricamento della DLL di \_ \_ ricerca della \_ \_ \_ libreria**).</span><span class="sxs-lookup"><span data-stu-id="986a5-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="986a5-253">Questa directory viene cercata solo per le dipendenze della DLL da caricare.</span><span class="sxs-lookup"><span data-stu-id="986a5-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="986a5-254">Directory dell'applicazione (**caricare la directory \_ \_ \_ dell' \_ applicazione di ricerca**).</span><span class="sxs-lookup"><span data-stu-id="986a5-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="986a5-255">Percorsi aggiunti in modo esplicito con la funzione [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) (**Load \_ Library \_ Search \_ User \_ directory**) o la funzione [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="986a5-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="986a5-256">Se è stato aggiunto più di un percorso, l'ordine in cui vengono cercati i percorsi non è specificato.</span><span class="sxs-lookup"><span data-stu-id="986a5-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="986a5-257">La directory di sistema **( \_ carica \_ ricerca libreria \_ system32**).</span><span class="sxs-lookup"><span data-stu-id="986a5-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="986a5-258">Se l'applicazione non chiama [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con alcun flag **di \_ \_ ricerca della libreria di caricamento** o stabilisce un ordine di ricerca dll per il processo, il sistema cerca le dll usando l'ordine di ricerca standard o l'ordine di ricerca alternativo.</span><span class="sxs-lookup"><span data-stu-id="986a5-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="986a5-259">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="986a5-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="986a5-260">**AddDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="986a5-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="986a5-261">Registrazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="986a5-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="986a5-262">Reindirizzamento libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="986a5-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="986a5-263">Sicurezza della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="986a5-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="986a5-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="986a5-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="986a5-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="986a5-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="986a5-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="986a5-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="986a5-267">**SetDefaultDllDirectories**</span><span class="sxs-lookup"><span data-stu-id="986a5-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="986a5-268">**SetDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="986a5-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="986a5-269">Componenti affiancati</span><span class="sxs-lookup"><span data-stu-id="986a5-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 