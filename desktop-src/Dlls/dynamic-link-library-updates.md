---
description: A volte è necessario sostituire una DLL con una versione più recente.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Aggiornamenti della libreria di Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a10f76103ddebc723466fb7e32a216c0c039691d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104049653"
---
# <a name="dynamic-link-library-updates"></a><span data-ttu-id="24659-103">Aggiornamenti della libreria di Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="24659-103">Dynamic-Link Library Updates</span></span>

<span data-ttu-id="24659-104">A volte è necessario sostituire una DLL con una versione più recente.</span><span class="sxs-lookup"><span data-stu-id="24659-104">It is sometimes necessary to replace a DLL with a newer version.</span></span> <span data-ttu-id="24659-105">Prima di sostituire una DLL, eseguire un controllo della versione per assicurarsi di sostituire una versione precedente con una versione più recente.</span><span class="sxs-lookup"><span data-stu-id="24659-105">Before replacing a DLL, perform a version check to ensure that you are replacing an older version with a newer version.</span></span> <span data-ttu-id="24659-106">È possibile sostituire una DLL in uso.</span><span class="sxs-lookup"><span data-stu-id="24659-106">It is possible to replace a DLL that is in use.</span></span> <span data-ttu-id="24659-107">Il metodo utilizzato per sostituire le dll in uso dipende dal sistema operativo in uso.</span><span class="sxs-lookup"><span data-stu-id="24659-107">The method you use to replace DLLs that are in use depends on the operating system you are using.</span></span> <span data-ttu-id="24659-108">In Windows XP e versioni successive, le applicazioni devono utilizzare [applicazioni isolate e assembly affiancati](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="24659-108">On Windows XP and later, applications should use [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="24659-109">Non è necessario riavviare il computer se si eseguono i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="24659-109">It is not necessary to restart the computer if you perform the following steps:</span></span>

1.  <span data-ttu-id="24659-110">Utilizzare la funzione [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) per rinominare la dll che viene sostituita.</span><span class="sxs-lookup"><span data-stu-id="24659-110">Use the [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) function to rename the DLL being replaced.</span></span> <span data-ttu-id="24659-111">Non specificare la \_ copia MOVEFILE \_ consentita e assicurarsi che il file rinominato si trovi nello stesso volume che contiene il file originale.</span><span class="sxs-lookup"><span data-stu-id="24659-111">Do not specify MOVEFILE\_COPY\_ALLOWED, and make sure the renamed file is on the same volume that contains the original file.</span></span> <span data-ttu-id="24659-112">È anche possibile rinominare semplicemente il file nella stessa directory assegnando un'estensione diversa.</span><span class="sxs-lookup"><span data-stu-id="24659-112">You could also simply rename the file in the same directory by giving it a different extension.</span></span>
2.  <span data-ttu-id="24659-113">Copiare la nuova DLL nella directory che contiene la DLL rinominata.</span><span class="sxs-lookup"><span data-stu-id="24659-113">Copy the new DLL to the directory that contains the renamed DLL.</span></span> <span data-ttu-id="24659-114">Tutte le applicazioni utilizzeranno ora la nuova DLL.</span><span class="sxs-lookup"><span data-stu-id="24659-114">All applications will now use the new DLL.</span></span>
3.  <span data-ttu-id="24659-115">Usare [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) con \_ ritardo MOVEFILE \_ fino \_ al riavvio per eliminare la dll rinominata.</span><span class="sxs-lookup"><span data-stu-id="24659-115">Use [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) with MOVEFILE\_DELAY\_UNTIL\_REBOOT to delete the renamed DLL.</span></span>

<span data-ttu-id="24659-116">Prima di eseguire questa sostituzione, le applicazioni utilizzeranno la DLL originale fino a quando non verrà scaricata.</span><span class="sxs-lookup"><span data-stu-id="24659-116">Before you make this replacement, applications will use the original DLL until it is unloaded.</span></span> <span data-ttu-id="24659-117">Dopo aver effettuato la sostituzione, le applicazioni utilizzeranno la nuova DLL.</span><span class="sxs-lookup"><span data-stu-id="24659-117">After you make the replacement, applications will use the new DLL.</span></span> <span data-ttu-id="24659-118">Quando si scrive una DLL, è necessario assicurarsi che sia preparata per questa situazione, soprattutto se la DLL mantiene le informazioni sullo stato globale o comunica con altri servizi.</span><span class="sxs-lookup"><span data-stu-id="24659-118">When you write a DLL, you must be careful to ensure that it is prepared for this situation, especially if the DLL maintains global state information or communicates with other services.</span></span> <span data-ttu-id="24659-119">Se la DLL non è preparata per una modifica nelle informazioni sullo stato globale o nei protocolli di comunicazione, l'aggiornamento della DLL richiede il riavvio del computer per assicurarsi che tutte le applicazioni utilizzino la stessa versione della DLL.</span><span class="sxs-lookup"><span data-stu-id="24659-119">If the DLL is not prepared for a change in global state information or communication protocols, updating the DLL will require you to restart the computer to ensure that all applications are using the same version of the DLL.</span></span>

 

 
