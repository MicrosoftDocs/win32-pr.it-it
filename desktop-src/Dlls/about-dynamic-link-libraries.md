---
description: Il collegamento dinamico consente a un modulo di includere solo le informazioni necessarie per individuare una funzione DLL esportata in fase di caricamento o di esecuzione.
ms.assetid: df2a8e4c-7ad0-46ea-9643-1528a9ea1503
title: Informazioni sulle librerie Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bdb24048e17e9164aaf39d0ab337aea33576c95
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103880018"
---
# <a name="about-dynamic-link-libraries"></a><span data-ttu-id="ddc70-103">Informazioni sulle librerie Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="ddc70-103">About Dynamic-Link Libraries</span></span>

<span data-ttu-id="ddc70-104">Il collegamento dinamico consente a un modulo di includere solo le informazioni necessarie per individuare una funzione DLL esportata in fase di caricamento o di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="ddc70-104">Dynamic linking allows a module to include only the information needed to locate an exported DLL function at load time or run time.</span></span> <span data-ttu-id="ddc70-105">Il collegamento dinamico differisce dal collegamento statico più familiare, in cui il linker copia il codice di una funzione di libreria in ogni modulo che lo chiama.</span><span class="sxs-lookup"><span data-stu-id="ddc70-105">Dynamic linking differs from the more familiar static linking, in which the linker copies a library function's code into each module that calls it.</span></span>

## <a name="types-of-dynamic-linking"></a><span data-ttu-id="ddc70-106">Tipi di collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-106">Types of Dynamic Linking</span></span>

<span data-ttu-id="ddc70-107">Esistono due metodi per chiamare una funzione in una DLL:</span><span class="sxs-lookup"><span data-stu-id="ddc70-107">There are two methods for calling a function in a DLL:</span></span>

-   <span data-ttu-id="ddc70-108">Nel *collegamento dinamico in fase di caricamento*, un modulo effettua chiamate esplicite alle funzioni DLL esportate come se fossero funzioni locali.</span><span class="sxs-lookup"><span data-stu-id="ddc70-108">In *load-time dynamic linking*, a module makes explicit calls to exported DLL functions as if they were local functions.</span></span> <span data-ttu-id="ddc70-109">A tale scopo, è necessario collegare il modulo alla libreria di importazione per la DLL che contiene le funzioni.</span><span class="sxs-lookup"><span data-stu-id="ddc70-109">This requires you to link the module with the import library for the DLL that contains the functions.</span></span> <span data-ttu-id="ddc70-110">Una libreria di importazione fornisce al sistema le informazioni necessarie per caricare la DLL e individuare le funzioni DLL esportate quando viene caricata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ddc70-110">An import library supplies the system with the information needed to load the DLL and locate the exported DLL functions when the application is loaded.</span></span>
-   <span data-ttu-id="ddc70-111">Nel *collegamento dinamico* in fase di esecuzione, un modulo usa la funzione [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) per caricare la dll in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="ddc70-111">In *run-time dynamic linking*, a module uses the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function to load the DLL at run time.</span></span> <span data-ttu-id="ddc70-112">Al termine del caricamento della DLL, il modulo chiama la funzione [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) per ottenere gli indirizzi delle funzioni DLL esportate.</span><span class="sxs-lookup"><span data-stu-id="ddc70-112">After the DLL is loaded, the module calls the [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) function to get the addresses of the exported DLL functions.</span></span> <span data-ttu-id="ddc70-113">Il modulo chiama le funzioni DLL esportate usando i puntatori a funzione restituiti da **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="ddc70-113">The module calls the exported DLL functions using the function pointers returned by **GetProcAddress**.</span></span> <span data-ttu-id="ddc70-114">In questo modo si elimina la necessità di una libreria di importazione.</span><span class="sxs-lookup"><span data-stu-id="ddc70-114">This eliminates the need for an import library.</span></span>

## <a name="dlls-and-memory-management"></a><span data-ttu-id="ddc70-115">Dll e gestione della memoria</span><span class="sxs-lookup"><span data-stu-id="ddc70-115">DLLs and Memory Management</span></span>

<span data-ttu-id="ddc70-116">Ogni processo che carica la DLL ne esegue il mapping allo spazio degli indirizzi virtuali.</span><span class="sxs-lookup"><span data-stu-id="ddc70-116">Every process that loads the DLL maps it into its virtual address space.</span></span> <span data-ttu-id="ddc70-117">Dopo che il processo ha caricato il file DLL nel relativo indirizzo virtuale, può chiamare le funzioni DLL esportate.</span><span class="sxs-lookup"><span data-stu-id="ddc70-117">After the process loads the DLL into its virtual address, it can call the exported DLL functions.</span></span>

<span data-ttu-id="ddc70-118">Il sistema mantiene un conteggio dei riferimenti per processo per ogni DLL.</span><span class="sxs-lookup"><span data-stu-id="ddc70-118">The system maintains a per-process reference count for each DLL.</span></span> <span data-ttu-id="ddc70-119">Quando un thread carica la DLL, il conteggio dei riferimenti viene incrementato di uno.</span><span class="sxs-lookup"><span data-stu-id="ddc70-119">When a thread loads the DLL, the reference count is incremented by one.</span></span> <span data-ttu-id="ddc70-120">Al termine del processo o quando il conteggio dei riferimenti diventa zero (solo collegamento dinamico in fase di esecuzione), la DLL viene scaricata dallo spazio degli indirizzi virtuali del processo.</span><span class="sxs-lookup"><span data-stu-id="ddc70-120">When the process terminates, or when the reference count becomes zero (run-time dynamic linking only), the DLL is unloaded from the virtual address space of the process.</span></span>

<span data-ttu-id="ddc70-121">Analogamente a qualsiasi altra funzione, una funzione DLL esportata viene eseguita nel contesto del thread che lo chiama.</span><span class="sxs-lookup"><span data-stu-id="ddc70-121">Like any other function, an exported DLL function runs in the context of the thread that calls it.</span></span> <span data-ttu-id="ddc70-122">Pertanto, si applicano le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ddc70-122">Therefore, the following conditions apply:</span></span>

-   <span data-ttu-id="ddc70-123">I thread del processo che hanno chiamato la DLL possono usare gli handle aperti da una funzione di DLL.</span><span class="sxs-lookup"><span data-stu-id="ddc70-123">The threads of the process that called the DLL can use handles opened by a DLL function.</span></span> <span data-ttu-id="ddc70-124">Analogamente, nella funzione DLL è possibile utilizzare gli handle aperti da qualsiasi thread del processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="ddc70-124">Similarly, handles opened by any thread of the calling process can be used in the DLL function.</span></span>
-   <span data-ttu-id="ddc70-125">La DLL usa lo stack del thread chiamante e lo spazio degli indirizzi virtuali del processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="ddc70-125">The DLL uses the stack of the calling thread and the virtual address space of the calling process.</span></span>
-   <span data-ttu-id="ddc70-126">La DLL alloca memoria dallo spazio degli indirizzi virtuali del processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="ddc70-126">The DLL allocates memory from the virtual address space of the calling process.</span></span>

<span data-ttu-id="ddc70-127">Per ulteriori informazioni sulle dll, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ddc70-127">For more information about DLLs, see the following topics:</span></span>

-   [<span data-ttu-id="ddc70-128">Vantaggi del collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-128">Advantages of Dynamic Linking</span></span>](advantages-of-dynamic-linking.md)
-   [<span data-ttu-id="ddc70-129">Creazione della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-129">Dynamic-Link Library Creation</span></span>](dynamic-link-library-creation.md)
-   [<span data-ttu-id="ddc70-130">Funzione Entry-Point libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-130">Dynamic-Link Library Entry-Point Function</span></span>](dynamic-link-library-entry-point-function.md)
-   [<span data-ttu-id="ddc70-131">Collegamento dinamico in fase di caricamento</span><span class="sxs-lookup"><span data-stu-id="ddc70-131">Load-Time Dynamic Linking</span></span>](load-time-dynamic-linking.md)
-   [<span data-ttu-id="ddc70-132">Collegamento dinamico in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="ddc70-132">Run-Time Dynamic Linking</span></span>](run-time-dynamic-linking.md)
-   [<span data-ttu-id="ddc70-133">Ordine di ricerca della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-133">Dynamic-Link Library Search Order</span></span>](dynamic-link-library-search-order.md)
-   [<span data-ttu-id="ddc70-134">Dati della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-134">Dynamic-Link Library Data</span></span>](dynamic-link-library-data.md)
-   [<span data-ttu-id="ddc70-135">Reindirizzamento libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-135">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
-   [<span data-ttu-id="ddc70-136">Aggiornamenti della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-136">Dynamic-Link Library Updates</span></span>](dynamic-link-library-updates.md)
-   [<span data-ttu-id="ddc70-137">Sicurezza della libreria a collegamento dinamico</span><span class="sxs-lookup"><span data-stu-id="ddc70-137">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
-   [<span data-ttu-id="ddc70-138">AppInit dll e avvio protetto</span><span class="sxs-lookup"><span data-stu-id="ddc70-138">AppInit DLLs and Secure Boot</span></span>](secure-boot-and-appinit-dlls.md)

 

 
