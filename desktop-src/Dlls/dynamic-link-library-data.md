---
description: Una libreria di Dynamic-Link (DLL) può contenere dati globali o dati locali.
ms.assetid: b1f6811e-c413-4124-9ccb-ea59b7a8a7ff
title: Dati della libreria Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83280d3bfc449061c44f9e8bfd9b47833e7eca19
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317822"
---
# <a name="dynamic-link-library-data"></a><span data-ttu-id="4db56-103">Dati della libreria Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="4db56-103">Dynamic-Link Library Data</span></span>

<span data-ttu-id="4db56-104">Una libreria di Dynamic-Link (DLL) può contenere dati globali o dati locali.</span><span class="sxs-lookup"><span data-stu-id="4db56-104">A Dynamic-Link Library (DLL) can contain global data or local data.</span></span>

## <a name="variable-scope"></a><span data-ttu-id="4db56-105">Ambito della variabile</span><span class="sxs-lookup"><span data-stu-id="4db56-105">Variable Scope</span></span>

<span data-ttu-id="4db56-106">Le variabili dichiarate come globali in un file di codice sorgente DLL vengono considerate come variabili globali dal compilatore e dal linker, ma ogni processo che carica una determinata DLL ottiene la propria copia delle variabili globali di tale DLL.</span><span class="sxs-lookup"><span data-stu-id="4db56-106">Variables that are declared as global in a DLL source code file are treated as global variables by the compiler and linker, but each process that loads a given DLL gets its own copy of that DLL's global variables.</span></span> <span data-ttu-id="4db56-107">L'ambito delle variabili statiche è limitato al blocco in cui vengono dichiarate le variabili statiche.</span><span class="sxs-lookup"><span data-stu-id="4db56-107">The scope of static variables is limited to the block in which the static variables are declared.</span></span> <span data-ttu-id="4db56-108">Di conseguenza, ogni processo ha una propria istanza delle variabili globali e statiche della DLL per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4db56-108">As a result, each process has its own instance of the DLL global and static variables by default.</span></span>

> [!Note]  
> <span data-ttu-id="4db56-109">È possibile che gli strumenti di sviluppo consentano di eseguire l'override del comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="4db56-109">Your development tools may allow you to override the default behavior.</span></span> <span data-ttu-id="4db56-110">Ad esempio, il compilatore Visual C++ supporta la **\# sezione pragma** e il linker supporta l'opzione/section.</span><span class="sxs-lookup"><span data-stu-id="4db56-110">For example, the Visual C++ compiler supports **\#pragma section** and the linker supports the /SECTION option.</span></span> <span data-ttu-id="4db56-111">Per ulteriori informazioni, vedere la documentazione inclusa con gli strumenti di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="4db56-111">For more information, see the documentation included with your development tools.</span></span>

 

## <a name="dynamic-memory-allocation"></a><span data-ttu-id="4db56-112">Allocazione memoria dinamica</span><span class="sxs-lookup"><span data-stu-id="4db56-112">Dynamic Memory Allocation</span></span>

<span data-ttu-id="4db56-113">Quando una DLL alloca memoria utilizzando una delle funzioni di allocazione della memoria ([**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc)e [**VirtualAlloc**](/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc)), la memoria viene allocata nello spazio degli indirizzi virtuali del processo chiamante ed è accessibile solo ai thread di tale processo.</span><span class="sxs-lookup"><span data-stu-id="4db56-113">When a DLL allocates memory using any of the memory allocation functions ([**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc), and [**VirtualAlloc**](/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc)), the memory is allocated in the virtual address space of the calling process and is accessible only to the threads of that process.</span></span>

<span data-ttu-id="4db56-114">Una DLL può usare il mapping dei file per allocare memoria che può essere condivisa tra i processi.</span><span class="sxs-lookup"><span data-stu-id="4db56-114">A DLL can use file mapping to allocate memory that can be shared among processes.</span></span> <span data-ttu-id="4db56-115">Per informazioni generali su come usare il mapping dei file per creare una memoria condivisa denominata, vedere [mapping di file](/windows/desktop/Memory/file-mapping).</span><span class="sxs-lookup"><span data-stu-id="4db56-115">For a general discussion of how to use file mapping to create named shared memory, see [File Mapping](/windows/desktop/Memory/file-mapping).</span></span> <span data-ttu-id="4db56-116">Per un esempio in cui viene utilizzata la funzione [**DllMain**](dllmain.md) per configurare la memoria condivisa utilizzando il mapping dei file, vedere [utilizzo della memoria condivisa in una libreria di Dynamic-Link](using-shared-memory-in-a-dynamic-link-library.md).</span><span class="sxs-lookup"><span data-stu-id="4db56-116">For an example that uses the [**DllMain**](dllmain.md) function to set up shared memory using file mapping, see [Using Shared Memory in a Dynamic-Link Library](using-shared-memory-in-a-dynamic-link-library.md).</span></span>

## <a name="thread-local-storage"></a><span data-ttu-id="4db56-117">archiviazione thread-local</span><span class="sxs-lookup"><span data-stu-id="4db56-117">Thread Local Storage</span></span>

<span data-ttu-id="4db56-118">Le funzioni di archiviazione locale di thread (TLS) consentono a una DLL di allocare un indice per l'archiviazione e il recupero di un valore diverso per ogni thread di un processo multithread.</span><span class="sxs-lookup"><span data-stu-id="4db56-118">The thread local storage (TLS) functions enable a DLL to allocate an index for storing and retrieving a different value for each thread of a multithreaded process.</span></span> <span data-ttu-id="4db56-119">Ad esempio, un'applicazione del foglio di calcolo può creare una nuova istanza dello stesso thread ogni volta che l'utente apre un nuovo foglio di calcolo.</span><span class="sxs-lookup"><span data-stu-id="4db56-119">For example, a spreadsheet application can create a new instance of the same thread each time the user opens a new spreadsheet.</span></span> <span data-ttu-id="4db56-120">Una DLL che fornisce le funzioni per varie operazioni di fogli di calcolo può utilizzare TLS per salvare informazioni sullo stato corrente di ogni foglio di calcolo (riga, colonna e così via).</span><span class="sxs-lookup"><span data-stu-id="4db56-120">A DLL providing the functions for various spreadsheet operations can use TLS to save information about the current state of each spreadsheet (row, column, and so on).</span></span> <span data-ttu-id="4db56-121">Per informazioni generali sull'archiviazione thread-local, vedere [archiviazione locale di thread](/windows/desktop/ProcThread/thread-local-storage).</span><span class="sxs-lookup"><span data-stu-id="4db56-121">For a general discussion of thread local storage, see [Thread Local Storage](/windows/desktop/ProcThread/thread-local-storage).</span></span> <span data-ttu-id="4db56-122">Per un esempio in cui viene utilizzata la funzione [**DllMain**](dllmain.md) per configurare l'archiviazione thread-local, vedere [utilizzo dell'archiviazione locale di thread in una libreria di Dynamic-Link](using-thread-local-storage-in-a-dynamic-link-library.md).</span><span class="sxs-lookup"><span data-stu-id="4db56-122">For an example that uses the [**DllMain**](dllmain.md) function to set up thread local storage, see [Using Thread Local Storage in a Dynamic-Link Library](using-thread-local-storage-in-a-dynamic-link-library.md).</span></span>

<span data-ttu-id="4db56-123">**Windows Server 2003 e Windows XP:** Il compilatore Visual C++ supporta una sintassi che consente di dichiarare variabili locali del thread: **\_ declspec (thread)**.</span><span class="sxs-lookup"><span data-stu-id="4db56-123">**Windows Server 2003 and Windows XP:** The Visual C++ compiler supports a syntax that enables you to declare thread-local variables: **\_declspec(thread)**.</span></span> <span data-ttu-id="4db56-124">Se si utilizza questa sintassi in una DLL, non sarà possibile caricare la DLL in modo esplicito utilizzando [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) nelle versioni di Windows precedenti a Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="4db56-124">If you use this syntax in a DLL, you will not be able to load the DLL explicitly using [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) on versions of Windows prior to Windows Vista.</span></span> <span data-ttu-id="4db56-125">Se la DLL viene caricata in modo esplicito, è necessario usare le funzioni di archiviazione locale di thread invece di **\_ declspec (thread)**.</span><span class="sxs-lookup"><span data-stu-id="4db56-125">If your DLL will be loaded explicitly, you must use the thread local storage functions instead of **\_declspec(thread)**.</span></span>

 

 
