---
title: Raccolte di tipi di carattere personalizzati (Windows 7/8)
description: DirectWrite consente di accedere alla raccolta dei tipi di carattere del sistema tramite il metodo GetSystemFontCollection di IDWriteFactory archiviata nei.
ms.assetid: ec892904-6778-4fbd-93b4-62d0db5b82ea
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39aa764330f27b72051ef682c6ce5f1176c42c7d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103728682"
---
# <a name="custom-font-collections-windows-78"></a><span data-ttu-id="47bbc-103">Raccolte di tipi di carattere personalizzati (Windows 7/8)</span><span class="sxs-lookup"><span data-stu-id="47bbc-103">Custom Font Collections (Windows 7/8)</span></span>

<span data-ttu-id="47bbc-104">[DirectWrite](direct-write-portal.md) consente di accedere alla raccolta dei tipi di carattere del sistema tramite il metodo [**IDWriteFactory archiviata nei:: GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) .</span><span class="sxs-lookup"><span data-stu-id="47bbc-104">[DirectWrite](direct-write-portal.md) provides access to the system font collection by using the [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) method.</span></span> <span data-ttu-id="47bbc-105">Si tratta della raccolta di tipi di carattere utilizzata più di frequente.</span><span class="sxs-lookup"><span data-stu-id="47bbc-105">This is the font collection that is most frequently used.</span></span> <span data-ttu-id="47bbc-106">Tuttavia, alcune applicazioni devono usare i tipi di carattere non installati nel sistema, ad esempio i file del tipo di carattere o i file dei tipi di carattere incorporati nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47bbc-106">However some applications have to use fonts that are not installed on the system, such as from included font files or font files embedded in the application.</span></span>

<span data-ttu-id="47bbc-107">Se i tipi di carattere desiderati non sono inclusi nella raccolta di tipi di carattere del sistema, è possibile creare una raccolta di tipi di carattere personalizzata derivata da [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span><span class="sxs-lookup"><span data-stu-id="47bbc-107">If the fonts that you want are not in the system font collection, you can create a custom font collection derived from [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span></span>

<span data-ttu-id="47bbc-108">Questa panoramica è costituita dalle parti seguenti:</span><span class="sxs-lookup"><span data-stu-id="47bbc-108">This overview consists of the following parts:</span></span>

-   [<span data-ttu-id="47bbc-109">Registrazione e annullamento della registrazione di un caricatore della raccolta dei tipi di carattere</span><span class="sxs-lookup"><span data-stu-id="47bbc-109">Registering and unregistering a Font Collection Loader</span></span>](#registering-and-unregistering-a-font-collection-loader)
-   [<span data-ttu-id="47bbc-110">IDWriteFontCollectionLoader</span><span class="sxs-lookup"><span data-stu-id="47bbc-110">IDWriteFontCollectionLoader</span></span>](#idwritefontcollectionloader)
-   [<span data-ttu-id="47bbc-111">IDWriteFontFileEnumerator</span><span class="sxs-lookup"><span data-stu-id="47bbc-111">IDWriteFontFileEnumerator</span></span>](#idwritefontfileenumerator)
-   [<span data-ttu-id="47bbc-112">CreateCustomFontFileReference</span><span class="sxs-lookup"><span data-stu-id="47bbc-112">CreateCustomFontFileReference</span></span>](#createcustomfontfilereference)
-   [<span data-ttu-id="47bbc-113">IDWriteFontFileLoader</span><span class="sxs-lookup"><span data-stu-id="47bbc-113">IDWriteFontFileLoader</span></span>](#idwritefontfileloader)
-   [<span data-ttu-id="47bbc-114">IDWriteFontFileStream</span><span class="sxs-lookup"><span data-stu-id="47bbc-114">IDWriteFontFileStream</span></span>](#idwritefontfilestream)

## <a name="registering-and-unregistering-a-font-collection-loader"></a><span data-ttu-id="47bbc-115">Registrazione e annullamento della registrazione di un caricatore della raccolta dei tipi di carattere</span><span class="sxs-lookup"><span data-stu-id="47bbc-115">Registering and unregistering a Font Collection Loader</span></span>

<span data-ttu-id="47bbc-116">Per registrare un caricatore della raccolta di tipi di carattere, usare il metodo [**IDWriteFactory archiviata nei:: RegisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) e passargli un'interfaccia [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) implementata dall'applicazione come oggetto singleton.</span><span class="sxs-lookup"><span data-stu-id="47bbc-116">You register a font collection loader by using the [**IDWriteFactory::RegisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) method and passing it an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented by the application as a singleton object.</span></span> <span data-ttu-id="47bbc-117">Questo oggetto caricherà i tipi di carattere quando viene richiesta la raccolta personalizzata.</span><span class="sxs-lookup"><span data-stu-id="47bbc-117">This object will load the fonts when the custom collection is requested.</span></span> <span data-ttu-id="47bbc-118">La raccolta di tipi di carattere del sistema e le raccolte di tipi di carattere personalizzati vengono memorizzate nella cache, quindi i tipi di carattere vengono caricati una sola</span><span class="sxs-lookup"><span data-stu-id="47bbc-118">Both the system font collection and custom font collections are cached, so the fonts are only loaded one time.</span></span>

<span data-ttu-id="47bbc-119">Il caricatore della raccolta dei tipi di carattere deve essere scaricato alla fine usando [**IDWriteFactory archiviata nei:: UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader).</span><span class="sxs-lookup"><span data-stu-id="47bbc-119">The font collection loader must be unloaded eventually by using the [**IDWriteFactory::UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader).</span></span>

> [!Note]  
> <span data-ttu-id="47bbc-120">La registrazione del caricatore della raccolta dei tipi di carattere aggiunge al conteggio dei riferimenti. non chiamare [**UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) dall'interno del distruttore o non verrà mai annullata la registrazione dell'oggetto caricatore della raccolta.</span><span class="sxs-lookup"><span data-stu-id="47bbc-120">Registering the font collection loader adds to the reference count; do not call [**UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) from within the destructor or the collection loader object will never be unregistered.</span></span>

 

## <a name="idwritefontcollectionloader"></a><span data-ttu-id="47bbc-121">IDWriteFontCollectionLoader</span><span class="sxs-lookup"><span data-stu-id="47bbc-121">IDWriteFontCollectionLoader</span></span>

<span data-ttu-id="47bbc-122">Per creare un oggetto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) , usare [**IDWriteFactory archiviata nei:: CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) e passargli una chiave definita dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47bbc-122">You create an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object by using the [**IDWriteFactory::CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) and passing it an application-defined key.</span></span> <span data-ttu-id="47bbc-123">La chiave è un puntatore void e il tipo di dati, il formato e il significato sono definiti dall'applicazione e sono opachi per il sistema di tipi di carattere.</span><span class="sxs-lookup"><span data-stu-id="47bbc-123">The key is a void pointer and the data type, format, and meaning are defined by the application and are opaque to the font system.</span></span>

<span data-ttu-id="47bbc-124">Mentre la chiave può essere qualsiasi, [DirectWrite](direct-write-portal.md) richiede che ogni chiave sia:</span><span class="sxs-lookup"><span data-stu-id="47bbc-124">Whereas the key can be anything, [DirectWrite](direct-write-portal.md) requires that each key is both:</span></span>

-   <span data-ttu-id="47bbc-125">Univoco per una singola raccolta di tipi di carattere nell'ambito del caricatore.</span><span class="sxs-lookup"><span data-stu-id="47bbc-125">Unique to a single font collection within the scope of the loader.</span></span>
-   <span data-ttu-id="47bbc-126">Valido fino a quando non viene annullata la registrazione del caricatore tramite la factory.</span><span class="sxs-lookup"><span data-stu-id="47bbc-126">Valid until the loader is unregistered using the factory.</span></span>

<span data-ttu-id="47bbc-127">Quando viene chiamato il metodo [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) , [DirectWrite](direct-write-portal.md) richiama un'interfaccia [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) implementata come oggetto Singleton dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47bbc-127">When the [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) method is called, [DirectWrite](direct-write-portal.md) calls back to an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented as a singleton object by the application.</span></span> <span data-ttu-id="47bbc-128">Il metodo di callback [**IDWriteFontCollectionLoader:: CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) viene usato da DirectWrite per recuperare un oggetto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) implementato dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47bbc-128">The [**IDWriteFontCollectionLoader::CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) callback method is used by DirectWrite to retrieve an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object implemented by the application.</span></span> <span data-ttu-id="47bbc-129">L'oggetto [**IDWriteFactory archiviata nei**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) utilizzato per creare la raccolta viene passato a questo metodo e deve essere utilizzato dall'enumeratore del file del tipo di carattere per creare gli oggetti [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) da includere nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="47bbc-129">The [**IDWriteFactory**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) object that is being used to create the collection is passed to this method and should be used by the font file enumerator to create the [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) objects to be included in the collection.</span></span>

<span data-ttu-id="47bbc-130">La chiave passata a questo metodo identifica la raccolta di tipi di carattere ed è la stessa chiave passata a [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection).</span><span class="sxs-lookup"><span data-stu-id="47bbc-130">The key passed to this method identifies the font collection and is the same key passed to [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection).</span></span>

## <a name="idwritefontfileenumerator"></a><span data-ttu-id="47bbc-131">IDWriteFontFileEnumerator</span><span class="sxs-lookup"><span data-stu-id="47bbc-131">IDWriteFontFileEnumerator</span></span>

<span data-ttu-id="47bbc-132">L'oggetto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) definito dall'applicazione creato dal metodo [**CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) viene usato per enumerare i file del tipo di carattere in una raccolta, creando un oggetto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) per ogni file.</span><span class="sxs-lookup"><span data-stu-id="47bbc-132">The application-defined [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object that was created by the [**CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) method is used to enumerate the font files in a collection, creating an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object for each file.</span></span> <span data-ttu-id="47bbc-133">Il metodo [**IDWriteFontFileEnumerator:: MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) modifica la posizione nel file del tipo di carattere successivo.</span><span class="sxs-lookup"><span data-stu-id="47bbc-133">The [**IDWriteFontFileEnumerator::MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) method changes the position to the next font file.</span></span> <span data-ttu-id="47bbc-134">Se è presente un file nella posizione, il *hasCurrentFile* verrà impostato su **true**.</span><span class="sxs-lookup"><span data-stu-id="47bbc-134">If there is a file at the position, it will set the *hasCurrentFile* to **TRUE**.</span></span> <span data-ttu-id="47bbc-135">In caso contrario, verrà impostato su **false** e il metodo restituirà **S \_ OK**.</span><span class="sxs-lookup"><span data-stu-id="47bbc-135">Otherwise it will be set to **FALSE** and the method will return **S\_OK**.</span></span>

> [!Note]  
> <span data-ttu-id="47bbc-136">L'enumeratore del file del tipo di carattere deve iniziare a posizionarsi prima del primo elemento ed essere avanzato in corrispondenza della prima chiamata a [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext).</span><span class="sxs-lookup"><span data-stu-id="47bbc-136">The font file enumerator must start positioned before the first element and advanced at the first call to [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext).</span></span>

 

<span data-ttu-id="47bbc-137">Un oggetto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) viene restituito dal metodo [**IDWriteFontFileEnumerator:: GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) .</span><span class="sxs-lookup"><span data-stu-id="47bbc-137">An [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object is output by the [**IDWriteFontFileEnumerator::GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) method.</span></span> <span data-ttu-id="47bbc-138">Se non è presente alcun file del tipo di carattere nella posizione corrente, perché [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) non è ancora stato chiamato o hasCurrentFile è stato impostato su **false**, **GetCurrentFontFile** restituirà **E avrà \_ esito negativo**.</span><span class="sxs-lookup"><span data-stu-id="47bbc-138">If there is no font file at the current position, because [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) has not yet been called or hasCurrentFile was set to **FALSE**, then **GetCurrentFontFile** will return **E\_FAIL**.</span></span>

## <a name="createcustomfontfilereference"></a><span data-ttu-id="47bbc-139">CreateCustomFontFileReference</span><span class="sxs-lookup"><span data-stu-id="47bbc-139">CreateCustomFontFileReference</span></span>

<span data-ttu-id="47bbc-140">È possibile creare l'oggetto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) restituito da [**GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) chiamando [**IDWriteFactory archiviata nei:: CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference).</span><span class="sxs-lookup"><span data-stu-id="47bbc-140">The [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object output by [**GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) can be created by calling [**IDWriteFactory::CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference).</span></span> <span data-ttu-id="47bbc-141">La chiave di riferimento del file del tipo di carattere identifica un riferimento a un file del tipo di carattere specifico e deve essere univoco all'interno del caricatore di file del tipo di carattere che caricherà</span><span class="sxs-lookup"><span data-stu-id="47bbc-141">The font file reference key identifies a specific font file reference and must be unique within the font file loader that will load the file.</span></span>

## <a name="idwritefontfileloader"></a><span data-ttu-id="47bbc-142">IDWriteFontFileLoader</span><span class="sxs-lookup"><span data-stu-id="47bbc-142">IDWriteFontFileLoader</span></span>

<span data-ttu-id="47bbc-143">Il metodo [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) accetta un oggetto [**IDWriteFontFileLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) implementato dall'applicazione utilizzata per caricare il tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="47bbc-143">The [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) method takes an [**IDWriteFontFileLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) object implemented by the application that is used to load the font.</span></span> <span data-ttu-id="47bbc-144">Al metodo di callback [**IDWriteFontFileLoader:: CreateStreamFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) viene passata la chiave e viene restituito un oggetto [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) .</span><span class="sxs-lookup"><span data-stu-id="47bbc-144">The [**IDWriteFontFileLoader::CreateStreamFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) callback method is passed the key and outputs an [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object.</span></span>

## <a name="idwritefontfilestream"></a><span data-ttu-id="47bbc-145">IDWriteFontFileStream</span><span class="sxs-lookup"><span data-stu-id="47bbc-145">IDWriteFontFileStream</span></span>

<span data-ttu-id="47bbc-146">L'oggetto [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) implementato dall'applicazione fornisce i dati del file del tipo di carattere per un riferimento al file del tipo di carattere da un caricatore di file del tipo di carattere</span><span class="sxs-lookup"><span data-stu-id="47bbc-146">The application-implemented [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object provides the font file data for a font file reference from a custom font file loader.</span></span> <span data-ttu-id="47bbc-147">Insieme alla dimensione del file e all'ora dell'ultima scrittura, fornisce un metodo ([**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)) per il recupero dei frammenti di file che devono essere compilati in un oggetto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) .</span><span class="sxs-lookup"><span data-stu-id="47bbc-147">Together with the file size and last write time, it provides a method ([**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)) for retrieving file fragments that are to be compiled into an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object.</span></span>

> [!Note]  
> <span data-ttu-id="47bbc-148">Le implementazioni [**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) devono restituire un errore se il frammento richiesto non rientra nei limiti del file.</span><span class="sxs-lookup"><span data-stu-id="47bbc-148">[**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) implementations should return an error if the requested fragment is outside the file bounds.</span></span>

 

<span data-ttu-id="47bbc-149">Un [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) può ottenere il contenuto del file del tipo di carattere da qualsiasi posizione, ad esempio l'unità disco rigido locale o le risorse incorporate.</span><span class="sxs-lookup"><span data-stu-id="47bbc-149">An [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) can get the font file contents from anywhere, such as the local hard disk drive, or embedded resources.</span></span>

 

 