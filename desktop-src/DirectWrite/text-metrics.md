---
title: Metrica testo
description: Per supportare il layout, la selezione dei tipi di carattere personalizzati e altre operazioni con utilizzo intensivo di metriche, a partire da Windows 8, DirectWrite include una serie di nuove API per esprimere tutte le informazioni sui tipi di carattere che potrebbero essere necessari per sviluppare app di testo RTF.
ms.assetid: 9df8c675-6f4d-4de7-916e-7dc51f5f04aa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 73647ae4521b23afb399a4c66c8b25cdc46ba1b5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300371"
---
# <a name="text-metrics"></a><span data-ttu-id="1ce00-103">Metrica testo</span><span class="sxs-lookup"><span data-stu-id="1ce00-103">Text Metrics</span></span>

<span data-ttu-id="1ce00-104">Per supportare il layout, la selezione dei tipi di carattere personalizzati e altre operazioni con utilizzo intensivo di metriche, a partire da Windows 8, [DirectWrite](direct-write-portal.md) include una serie di nuove API per esprimere tutte le informazioni sui tipi di carattere che potrebbero essere necessari per sviluppare app di testo RTF.</span><span class="sxs-lookup"><span data-stu-id="1ce00-104">In order to assist your layout, custom font selection, and other metric intensive operations, starting in Windows 8, [DirectWrite](direct-write-portal.md) has a number of new APIs to express all the info about fonts that you might require to develop rich text apps.</span></span>

## <a name="panose"></a><span data-ttu-id="1ce00-105">PANOSE</span><span class="sxs-lookup"><span data-stu-id="1ce00-105">PANOSE</span></span>

<span data-ttu-id="1ce00-106">PANOse è un sistema di classificazione visiva per l'identificazione dei caratteri tipografici.</span><span class="sxs-lookup"><span data-stu-id="1ce00-106">PANOSE is a visual classification system for identifying typefaces.</span></span> <span data-ttu-id="1ce00-107">La classificazione PANOa contiene informazioni sulla famiglia, lo stile Serif, il peso, la proporzione, il contrasto, il tratto, lo stile ARM, l'altezza X e così via. Queste informazioni descrivono lo stile di visualizzazione del tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1ce00-107">The PANOSE classification contains info on the family, serif style, weight, proportion, contrast, stroke, arm style, X-height, etc. This info describes the visual style of the font.</span></span> <span data-ttu-id="1ce00-108">Queste informazioni sono importanti perché i tipi di carattere con valori di PANOse simili hanno un aspetto simile.</span><span class="sxs-lookup"><span data-stu-id="1ce00-108">This info is important because fonts with similar PANOSE values look similar.</span></span> <span data-ttu-id="1ce00-109">Questa operazione è molto utile in situazioni in cui un tipo di carattere non è disponibile e l'app deve eseguire il fallback a un tipo di carattere disponibile.</span><span class="sxs-lookup"><span data-stu-id="1ce00-109">This is very useful in situations where a font isn’t available and the app needs to fall back to a font that’s available.</span></span> <span data-ttu-id="1ce00-110">Il confronto tra i valori di PANOse per i tipi di carattere consente di scegliere un tipo di carattere simile visivamente al tipo di carattere originale.</span><span class="sxs-lookup"><span data-stu-id="1ce00-110">Comparing PANOSE values for fonts allows you to choose a font that’s similar visually to the original font.</span></span>

<span data-ttu-id="1ce00-111">Per accedere alle informazioni relative a PANOl per un tipo di carattere, usare il metodo [**Getpanose**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getpanose) sulle interfacce [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) e [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) .</span><span class="sxs-lookup"><span data-stu-id="1ce00-111">In order to access the PANOSE info for a font, use the [**GetPanose**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getpanose) method on the [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) and [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) interfaces.</span></span> <span data-ttu-id="1ce00-112">Questo metodo restituisce un'enumerazione [**DWrite \_ Panose**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_panose) che contiene tutte le informazioni PANOSE per il tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1ce00-112">This method returns a [**DWRITE\_PANOSE**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_panose) enumeration that contains all of the PANOSE info for that font.</span></span>

## <a name="additional-metrics"></a><span data-ttu-id="1ce00-113">Metriche aggiuntive</span><span class="sxs-lookup"><span data-stu-id="1ce00-113">Additional Metrics</span></span>

<span data-ttu-id="1ce00-114">A partire da Windows 8, l'API di [DirectWrite](direct-write-portal.md) supporta anche una serie di nuove metriche per poter esprimere informazioni utili sui tipi di carattere per l'app.</span><span class="sxs-lookup"><span data-stu-id="1ce00-114">Starting in Windows 8, the [DirectWrite](direct-write-portal.md) API also supports a number of new metrics in order to express useful info about the fonts to your app.</span></span> <span data-ttu-id="1ce00-115">Queste nuove metriche includono queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="1ce00-115">These new metrics include this info.</span></span>

-   <span data-ttu-id="1ce00-116">Metriche del rettangolo di delimitazione dei glifi a sinistra, a destra, in alto e in basso.</span><span class="sxs-lookup"><span data-stu-id="1ce00-116">Left, Right, Top, and Bottom glyph bounding box metrics.</span></span>
-   <span data-ttu-id="1ce00-117">Posizionamento X e Y per gli elementi apice e pedice.</span><span class="sxs-lookup"><span data-stu-id="1ce00-117">X and Y positioning for superscript and subscript elements.</span></span>
-   <span data-ttu-id="1ce00-118">Informazioni sul ridimensionamento X e Y per gli elementi apice e pedice.</span><span class="sxs-lookup"><span data-stu-id="1ce00-118">X and Y scaling info for superscript and subscript elements.</span></span>
-   <span data-ttu-id="1ce00-119">Indica se il tipo di carattere è costituito da metriche tipografiche.</span><span class="sxs-lookup"><span data-stu-id="1ce00-119">Whether or not the font has typographic metrics.</span></span>

<span data-ttu-id="1ce00-120">Queste informazioni sono tutte disponibili tramite il nuovo metodo [**GetMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getmetrics) sulle interfacce [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) e [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) .</span><span class="sxs-lookup"><span data-stu-id="1ce00-120">This info is all available through the new [**GetMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getmetrics) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces.</span></span> <span data-ttu-id="1ce00-121">Questo metodo restituisce una [**struttura \_ \_ METRICS1 del tipo di carattere DWrite**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_font_metrics1) contenente tutte queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="1ce00-121">This method returns a [**DWRITE\_FONT\_METRICS1**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_font_metrics1) structure that contains all this info.</span></span>

## <a name="caret-metrics"></a><span data-ttu-id="1ce00-122">Metriche del cursore</span><span class="sxs-lookup"><span data-stu-id="1ce00-122">Caret Metrics</span></span>

<span data-ttu-id="1ce00-123">Per creare app di modifica del testo è necessario accedere alle informazioni su come creare il cursore che sposta il testo.</span><span class="sxs-lookup"><span data-stu-id="1ce00-123">To create text editing apps you need access to info about how to draw the caret that navigates through the text.</span></span> <span data-ttu-id="1ce00-124">A partire da Windows 8, [DirectWrite](direct-write-portal.md) fornisce il metodo [**GetCaretMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getcaretmetrics) sulle interfacce [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) e [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) per questo scenario.</span><span class="sxs-lookup"><span data-stu-id="1ce00-124">Starting in Windows 8, [DirectWrite](direct-write-portal.md) provides the [**GetCaretMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getcaretmetrics) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces for this scenario.</span></span> <span data-ttu-id="1ce00-125">**GetCaretMetrics** restituisce un' [**enumerazione \_ \_ metrica del cursore DWrite**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_caret_metrics) che contiene informazioni sulla pendenza e sull'offset per il punto di inserimento lungo la linea di base.</span><span class="sxs-lookup"><span data-stu-id="1ce00-125">**GetCaretMetrics** returns a [**DWRITE\_CARET\_METRICS**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_caret_metrics) enumeration which contains info about the slope and offset for the caret along the baseline.</span></span>

<span data-ttu-id="1ce00-126">Queste informazioni sono particolarmente utili se si desidera essere in grado di applicare la pendenza del punto di inserimento in modo appropriato con il testo in corsivo.</span><span class="sxs-lookup"><span data-stu-id="1ce00-126">This info is specifically helpful if you want to be able to have their caret slope appropriately with italic text.</span></span>

## <a name="monospaced-discoverability"></a><span data-ttu-id="1ce00-127">Individuabilità a spaziatura fissa</span><span class="sxs-lookup"><span data-stu-id="1ce00-127">Monospaced Discoverability</span></span>

<span data-ttu-id="1ce00-128">Le app che consentono agli utenti di scrivere codice del computer spesso usano caratteri a spaziatura fissa al posto di tipi di carattere più tradizionali.</span><span class="sxs-lookup"><span data-stu-id="1ce00-128">Apps that allow your users to write computer code often use monospaced fonts in place of more traditional fonts.</span></span> <span data-ttu-id="1ce00-129">Quindi, è possibile avere maggiore controllo sulla selezione dei tipi di carattere nelle app correlate allo sviluppo, [DirectWrite](direct-write-portal.md) esprime se un tipo di carattere è a spaziatura fissa tramite l'API.</span><span class="sxs-lookup"><span data-stu-id="1ce00-129">So you can have more control over font selection in apps related to development, [DirectWrite](direct-write-portal.md) expresses whether or not a font is monospaced through the API.</span></span> <span data-ttu-id="1ce00-130">Il metodo [**IsMonospacedFont**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-ismonospacedfont) sull'interfaccia [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) restituisce un valore booleano che indica se il tipo di carattere è a spaziatura fissa.</span><span class="sxs-lookup"><span data-stu-id="1ce00-130">The [**IsMonospacedFont**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-ismonospacedfont) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) interface returns a Boolean that indicates whether or not the font is monospaced.</span></span>

## <a name="font-name-matching"></a><span data-ttu-id="1ce00-131">Corrispondenza dei nomi dei tipi di carattere</span><span class="sxs-lookup"><span data-stu-id="1ce00-131">Font Name Matching</span></span>

<span data-ttu-id="1ce00-132">Per le app con testo RTF, ad esempio i lettori PDF, è necessario poter associare i tipi di carattere ai tipi di carattere del sistema e accedere ai nomi completi dei tipi di carattere in più formati.</span><span class="sxs-lookup"><span data-stu-id="1ce00-132">Rich text apps like PDF readers need to be able to match fonts in their content to fonts on the system, need access to the full names of fonts in multiple formats.</span></span> <span data-ttu-id="1ce00-133">Per una migliore corrispondenza dei tipi di carattere, [DirectWrite](direct-write-portal.md) contiene un'enumerazione che esprime informazioni di denominazione complete su un tipo di carattere in molti formati.</span><span class="sxs-lookup"><span data-stu-id="1ce00-133">So you can better match fonts, [DirectWrite](direct-write-portal.md) contains an enumeration that expresses full naming info about a font in many formats.</span></span>

<span data-ttu-id="1ce00-134">usare l'enumerazione [**DWrite \_ Informational \_ String \_ ID**](/windows/win32/api/dwrite/ne-dwrite-dwrite_informational_string_id) per ottenere il nome completo, il nome del post-script e il nome CID del post-script di qualsiasi tipo di carattere nel sistema.</span><span class="sxs-lookup"><span data-stu-id="1ce00-134">you use the [**DWRITE\_INFORMATIONAL\_STRING\_ID**](/windows/win32/api/dwrite/ne-dwrite-dwrite_informational_string_id) enumeration to get the full name, PostScript name, and PostScript CID name of any font on the system.</span></span> <span data-ttu-id="1ce00-135">Queste informazioni sono utili quando è necessario trovare la corrispondenza dei tipi di carattere nell'app con i tipi di carattere appropriati nel sistema locale.</span><span class="sxs-lookup"><span data-stu-id="1ce00-135">This info is valuable when you need to match fonts in your app to appropriate fonts on the local system.</span></span>

## <a name="glyph-advances"></a><span data-ttu-id="1ce00-136">Avanzamenti glifo</span><span class="sxs-lookup"><span data-stu-id="1ce00-136">Glyph Advances</span></span>

<span data-ttu-id="1ce00-137">Il metodo **GetGlyphAdvances** sulle interfacce [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) e [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) acquisisce il numero di glifi e gli indici necessari per anticipare le informazioni e quindi restituisce i progressi per i glifi in questione.</span><span class="sxs-lookup"><span data-stu-id="1ce00-137">The **GetGlyphAdvances** method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces takes in the glyph count and indices that you need advances info about and then returns the advances for the glyphs in question.</span></span>

## <a name="unicode-ranges"></a><span data-ttu-id="1ce00-138">Intervalli Unicode</span><span class="sxs-lookup"><span data-stu-id="1ce00-138">Unicode Ranges</span></span>

<span data-ttu-id="1ce00-139">Le app che vogliono gestire la propria selezione dei tipi di carattere devono accedere agli intervalli Unicode supportati dal tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1ce00-139">Apps that want to handle their own font selection need access to the Unicode ranges that are supported by the font.</span></span> <span data-ttu-id="1ce00-140">In questo modo, se un punto di riferimento Unicode non è supportato dal tipo di carattere, l'app può scegliere un tipo di carattere appropriato che contenga tale glifo.</span><span class="sxs-lookup"><span data-stu-id="1ce00-140">This way, if a Unicode codepoint isn’t supported by the font, the app can choose an appropriate font that contains that glyph.</span></span> <span data-ttu-id="1ce00-141">Senza queste informazioni, l'app può usare un tipo di carattere che non contiene tutti i glifi necessari per visualizzare le informazioni presenti.</span><span class="sxs-lookup"><span data-stu-id="1ce00-141">Without this info, the app may use a font that doesn’t contain all the glyphs that are necessary to display the info present.</span></span>

<span data-ttu-id="1ce00-142">Il metodo [**GetUnicodeRanges**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getunicoderanges) sulle interfacce [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) e [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) accetta il numero massimo di intervalli passati dal client e restituisce gli intervalli effettivi supportati dal tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="1ce00-142">The [**GetUnicodeRanges**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getunicoderanges) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces takes in the maximum number of ranges passed in from the client, and returns the actual ranges supported by the font.</span></span>

## <a name="eudc-font-collection"></a><span data-ttu-id="1ce00-143">Raccolta di tipi di carattere EUDC</span><span class="sxs-lookup"><span data-stu-id="1ce00-143">EUDC Font Collection</span></span>

<span data-ttu-id="1ce00-144">Usare il metodo [**GetEudcFontCollection**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefactory1-geteudcfontcollection) sull'interfaccia [**IDWriteFactory1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefactory1) per accedere alla raccolta di tipi di carattere EUDC.</span><span class="sxs-lookup"><span data-stu-id="1ce00-144">Use the [**GetEudcFontCollection**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefactory1-geteudcfontcollection) method on the [**IDWriteFactory1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefactory1) interface access the EUDC font collection.</span></span> <span data-ttu-id="1ce00-145">Questo metodo funziona allo stesso modo di [**GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection), ma restituisce invece un puntatore a una raccolta di tipi di carattere EUDC.</span><span class="sxs-lookup"><span data-stu-id="1ce00-145">This method works in the same way as [**GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection), but instead returns a pointer to an EUDC font collection.</span></span>

 

 