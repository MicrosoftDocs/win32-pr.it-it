---
description: Per aprire un file di log per la lettura, chiamare PdhOpenQuery e specificare un percorso per il file di log.
ms.assetid: 1d8f8662-df1f-4f84-8b65-c152f79cc5c6
title: Utilizzo dei file di log
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ba2032b90036f8f58c07d8c7e80e7e7ac2b2701c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106312073"
---
# <a name="working-with-log-files"></a><span data-ttu-id="d2077-103">Utilizzo dei file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-103">Working with Log Files</span></span>

<span data-ttu-id="d2077-104">Per aprire un file di log per la lettura, chiamare [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) e specificare un percorso per il file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-104">To open a log file for reading, call [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) and specify a path to the log file.</span></span> <span data-ttu-id="d2077-105">Per aprire un file di log per la scrittura, è necessario chiamare [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span><span class="sxs-lookup"><span data-stu-id="d2077-105">To open a log file for writing, you must call [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span></span> <span data-ttu-id="d2077-106">Per chiudere un file di log, chiamare [**PdhCloseQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhclosequery) o [**PdhCloseLog**](/windows/desktop/api/Pdh/nf-pdh-pdhcloselog) a seconda della funzione utilizzata per aprire il file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-106">To close a log file, call either [**PdhCloseQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhclosequery) or [**PdhCloseLog**](/windows/desktop/api/Pdh/nf-pdh-pdhcloselog) depending on which function you used to open the log file.</span></span>

## <a name="reading-from-a-log-file"></a><span data-ttu-id="d2077-107">Lettura da un file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-107">Reading from a log file</span></span>

<span data-ttu-id="d2077-108">La lettura dei dati sulle prestazioni da un file di log equivale alla lettura dei dati da un'origine in tempo reale: si apre una query, si aggiungono contatori alla query e si chiama [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) per raccogliere un campione dal file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-108">Reading performance data from a log file is the same as reading data from a real time source—you open a query, add counters to the query and call [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) to collect a sample from the log file.</span></span> <span data-ttu-id="d2077-109">**PdhCollectQueryData** restituisce PDH \_ non \_ più \_ dati quando si raggiunge la fine del file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-109">**PdhCollectQueryData** returns PDH\_NO\_MORE\_DATA when you reach the end of the log file.</span></span>

<span data-ttu-id="d2077-110">Ogni esempio nel file di log contiene un timestamp per il momento in cui è stato originariamente raccolto e scritto nel file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-110">Each sample in the log file contains a time stamp for when it was originally collected and written to the log file.</span></span> <span data-ttu-id="d2077-111">Per recuperare il timestamp del primo e dell'ultimo esempio nel file di log, chiamare la funzione [**PdhGetDataSourceTimeRange**](/windows/desktop/api/Pdh/nf-pdh-pdhgetdatasourcetimerangea) .</span><span class="sxs-lookup"><span data-stu-id="d2077-111">To retrieve the time stamp for the first and last sample in the log file, call the [**PdhGetDataSourceTimeRange**](/windows/desktop/api/Pdh/nf-pdh-pdhgetdatasourcetimerangea) function.</span></span> <span data-ttu-id="d2077-112">Se si desidera limitare gli esempi letti dal log a un intervallo di tempo specifico, vedere [impostazione di un intervallo di tempo per una query](setting-a-time-range-for-a-query.md).</span><span class="sxs-lookup"><span data-stu-id="d2077-112">If you want to limit the samples that you read from the log to a specific time range, see [Setting a Time Range for a Query](setting-a-time-range-for-a-query.md).</span></span>

<span data-ttu-id="d2077-113">Se non si sa quali oggetti e contatori delle prestazioni sono presenti nel file di log, è possibile chiamare [**PdhEnumObjects**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) per determinare l'elenco di oggetti.</span><span class="sxs-lookup"><span data-stu-id="d2077-113">If you do not know which performance objects and counters exist in the log file, you can call [**PdhEnumObjects**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) to determine the list of objects.</span></span> <span data-ttu-id="d2077-114">Dato un oggetto, è possibile chiamare [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) o [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha) per recuperare un elenco delle istanze e dei contatori dell'oggetto contenuti nel file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-114">Given an object, you can call either [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) or [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha) to retrieve a list of the object's instances and counters contained in the log file.</span></span>

<span data-ttu-id="d2077-115">Se si chiama [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa), utilizzare gli elenchi di istanze e contatori per creare un percorso per ogni possibile combinazione di istanza e contatore.</span><span class="sxs-lookup"><span data-stu-id="d2077-115">If you call [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa), use the instance and counter lists to create a path for each possible combination of instance and counter.</span></span> <span data-ttu-id="d2077-116">Quando si chiama [**chiamata PdhAddCounter**](/windows/desktop/api/Pdh/nf-pdh-pdhaddcountera) per aggiungere il contatore alla query, la funzione avrà esito negativo se il file di log non contiene la combinazione specificata.</span><span class="sxs-lookup"><span data-stu-id="d2077-116">When you call [**PdhAddCounter**](/windows/desktop/api/Pdh/nf-pdh-pdhaddcountera) to add the counter to the query, the function will fail if the log file does not contain the given combination.</span></span>

<span data-ttu-id="d2077-117">Se si utilizza [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha), è possibile creare un percorso che contenga un carattere jolly per il nome dell'istanza e il contatore, ad esempio \\ oggetto ( \* ) \\ \* .</span><span class="sxs-lookup"><span data-stu-id="d2077-117">If you use [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha), you can create a path that contains a wildcard for the instance name and counter, for example, \\object(\*)\\\*.</span></span> <span data-ttu-id="d2077-118">La funzione restituisce \_ un percorso non valido PDH \_ se l'oggetto non contiene un'istanza.</span><span class="sxs-lookup"><span data-stu-id="d2077-118">The function returns PDH\_INVALID\_PATH if the object does not contain an instance.</span></span> <span data-ttu-id="d2077-119">In questo caso, chiamare **PdhExpandWildCardPath** usando un carattere jolly solo per il contatore, ad esempio \\ Object \\ \* .</span><span class="sxs-lookup"><span data-stu-id="d2077-119">In this case, call **PdhExpandWildCardPath** using a wildcard for counter only, for example, \\object\\\*.</span></span>

<span data-ttu-id="d2077-120">I sistemi operativi più recenti possono leggere i file di log generati in sistemi operativi meno recenti; Tuttavia, i file di log creati in Windows Vista e nei sistemi operativi successivi non possono essere letti nei sistemi operativi precedenti.</span><span class="sxs-lookup"><span data-stu-id="d2077-120">Newer operating systems can read log files that were generated on older operating systems; however, log files that were created on Windows Vista and later operating systems cannot be read on earlier operating systems.</span></span>

<span data-ttu-id="d2077-121">Per un esempio in cui vengono letti i dati da un file di log, vedere [lettura dei dati sulle prestazioni da un file di log](reading-performance-data-from-a-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="d2077-121">For an example that reads data from a log file, see [Reading Performance Data from a Log File](reading-performance-data-from-a-log-file.md).</span></span>

## <a name="reading-from-multiple-log-files"></a><span data-ttu-id="d2077-122">Lettura da più file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-122">Reading from multiple log files</span></span>

<span data-ttu-id="d2077-123">Se è necessario creare una query che legga da diversi file di log, chiamare [**PdhBindInputDataSource**](/windows/desktop/api/Pdh/nf-pdh-pdhbindinputdatasourcea) per associare i file di log insieme.</span><span class="sxs-lookup"><span data-stu-id="d2077-123">If you need to create a query that reads from several log files, call the [**PdhBindInputDataSource**](/windows/desktop/api/Pdh/nf-pdh-pdhbindinputdatasourcea) to bind the log files together.</span></span> <span data-ttu-id="d2077-124">È quindi necessario usare funzioni PDH che terminano con "H", ad esempio [**PdhOpenQueryH**](/windows/desktop/api/Pdh/nf-pdh-pdhopenqueryh).</span><span class="sxs-lookup"><span data-stu-id="d2077-124">You then need to use PDH functions that end in 'H', for example, [**PdhOpenQueryH**](/windows/desktop/api/Pdh/nf-pdh-pdhopenqueryh).</span></span>

## <a name="writing-to-a-log-file"></a><span data-ttu-id="d2077-125">Scrittura in un file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-125">Writing to a log file</span></span>

<span data-ttu-id="d2077-126">Prima di scrivere in un file di log, chiamare [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) per creare una query e specificare l'origine dei dati sulle prestazioni, ovvero i dati in tempo reale o un file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-126">Before writing to a log file, call [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) to create a query and specify the source of the performance data, either real time data or a log file.</span></span> <span data-ttu-id="d2077-127">Aggiungere quindi i contatori su cui si desidera eseguire la query.</span><span class="sxs-lookup"><span data-stu-id="d2077-127">Then, add the counters that you want to query.</span></span>

<span data-ttu-id="d2077-128">Per aprire il file di destinazione, chiamare [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span><span class="sxs-lookup"><span data-stu-id="d2077-128">To open the destination file, call [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span></span> <span data-ttu-id="d2077-129">Specificare la query quando si apre il file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-129">Specify the query when you open the log file.</span></span> <span data-ttu-id="d2077-130">Per raccogliere i dati sulle prestazioni e scriverli nel file di log, chiamare [**PdhUpdateLog**](/windows/desktop/api/Pdh/nf-pdh-pdhupdateloga).</span><span class="sxs-lookup"><span data-stu-id="d2077-130">To collect the performance data and write it to the log file, call [**PdhUpdateLog**](/windows/desktop/api/Pdh/nf-pdh-pdhupdateloga).</span></span>

<span data-ttu-id="d2077-131">Se i dati del contatore vengono scritti in un file di log delimitato da virgole (CSV) o delimitati da tabulazioni (TSV) e il percorso contiene un'istanza con caratteri jolly, il percorso viene espanso e solo le istanze esistenti nel momento in cui il percorso è espanso vengono incluse nel file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-131">If the counter data is being written to comma-delimited (.csv) or tab-delimited (.tsv) log file and the path contains a wildcard instance, the path is expanded and only those instances that exist at the time the path is expanded are included in the log file.</span></span> <span data-ttu-id="d2077-132">Tuttavia, per i file binari (. grandi) o i file di log SQL, il carattere jolly non viene espanso in modo che il file di log contenga le istanze create durante la registrazione.</span><span class="sxs-lookup"><span data-stu-id="d2077-132">However, for binary (.blg) or SQL log files, the wildcard is not expanded so that the log file contains instances that are created during logging.</span></span>

<span data-ttu-id="d2077-133">Per un esempio in cui vengono scritti i dati in un file di log, vedere [scrittura di dati sulle prestazioni in un file di log](writing-performance-data-to-a-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="d2077-133">For an example that writes data to a log file, see [Writing Performance Data to a Log File](writing-performance-data-to-a-log-file.md).</span></span>

## <a name="compressing-a-log-file"></a><span data-ttu-id="d2077-134">Compressione di un file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-134">Compressing a log file</span></span>

<span data-ttu-id="d2077-135">È possibile utilizzare la funzione [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) per comprimere un file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-135">You can use the [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) function to compress a log file.</span></span> <span data-ttu-id="d2077-136">Ad esempio, leggere dieci record da un file di log, chiamare **PdhComputeCounterStatistics** per calcolare il valore medio e quindi scrivere il valore medio in un file di log di output.</span><span class="sxs-lookup"><span data-stu-id="d2077-136">For example, read ten records from a log file, call **PdhComputeCounterStatistics** to compute the mean value and then write the mean value to an output log file.</span></span>

<span data-ttu-id="d2077-137">Nell'argomento seguente vengono fornite informazioni aggiuntive sull'utilizzo di un file di log.</span><span class="sxs-lookup"><span data-stu-id="d2077-137">The following topic provides additional information on using a log file.</span></span>

-   [<span data-ttu-id="d2077-138">Recupero delle dimensioni di un file di log</span><span class="sxs-lookup"><span data-stu-id="d2077-138">Getting the Size of a Log File</span></span>](getting-the-size-of-a-log-file.md)

 

 



