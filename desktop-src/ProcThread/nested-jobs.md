---
description: Un'applicazione può utilizzare processi annidati per gestire subset di processi. I processi annidati consentono anche a un'applicazione che usa processi di ospitare altre applicazioni che usano anche i processi.
ms.assetid: FA22493B-CD29-49A7-BDAC-349FA96B8C9E
title: Processi annidati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: abf105c70ec8e83b395fcce56c6274d4838358bc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104557834"
---
# <a name="nested-jobs"></a><span data-ttu-id="6ebce-104">Processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-104">Nested Jobs</span></span>

<span data-ttu-id="6ebce-105">Un'applicazione può utilizzare processi annidati per gestire subset di processi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-105">An application can use nested jobs to manage subsets of processes.</span></span> <span data-ttu-id="6ebce-106">I processi annidati consentono anche a un'applicazione che usa processi di ospitare altre applicazioni che usano anche i processi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-106">Nested jobs also enable an application that uses jobs to host other applications that also use jobs.</span></span>

<span data-ttu-id="6ebce-107">**Windows 7, Windows server 2008 R2, Windows XP con SP3, Windows server 2008, Windows Vista e Windows server 2003:** Un processo può essere associato a un singolo processo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-107">**Windows 7, Windows Server 2008 R2, Windows XP with SP3, Windows Server 2008, Windows Vista and Windows Server 2003:** A process can be associated with only a single job.</span></span> <span data-ttu-id="6ebce-108">I processi annidati sono stati introdotti in Windows 8 e Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="6ebce-108">Nested jobs were introduced in Windows 8 and Windows Server 2012.</span></span>

<span data-ttu-id="6ebce-109">Questo argomento fornisce una panoramica dell'annidamento dei processi e del comportamento dei processi annidati:</span><span class="sxs-lookup"><span data-stu-id="6ebce-109">This topic provides an overview of job nesting and behavior of nested jobs:</span></span>

-   [<span data-ttu-id="6ebce-110">Gerarchie di processi annidate</span><span class="sxs-lookup"><span data-stu-id="6ebce-110">Nested Job Hierarchies</span></span>](#nested-job-hierarchies)
-   [<span data-ttu-id="6ebce-111">Creazione di una gerarchia di processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-111">Creating a Nested Job Hierarchy</span></span>](#creating-a-nested-job-hierarchy)
-   [<span data-ttu-id="6ebce-112">Limiti e notifiche dei processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-112">Job Limits and Notifications for Nested Jobs</span></span>](#job-limits-and-notifications-for-nested-jobs)
-   [<span data-ttu-id="6ebce-113">Contabilità delle risorse per i processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-113">Resource Accounting for Nested Jobs</span></span>](#resource-accounting-for-nested-jobs)
-   [<span data-ttu-id="6ebce-114">Terminazione dei processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-114">Termination of Nested Jobs</span></span>](#termination-of-nested-jobs)

<span data-ttu-id="6ebce-115">Per informazioni generali sui processi e sugli oggetti processo, vedere [oggetti processo](job-objects.md).</span><span class="sxs-lookup"><span data-stu-id="6ebce-115">For general information about jobs and job objects, see [Job Objects](job-objects.md).</span></span>

## <a name="nested-job-hierarchies"></a><span data-ttu-id="6ebce-116">Gerarchie di processi annidate</span><span class="sxs-lookup"><span data-stu-id="6ebce-116">Nested Job Hierarchies</span></span>

<span data-ttu-id="6ebce-117">I processi annidati hanno una relazione padre-figlio in cui ogni processo figlio contiene un subset dei processi nel processo padre.</span><span class="sxs-lookup"><span data-stu-id="6ebce-117">Nested jobs have a parent-child relationship in which each child job contains a subset of the processes in its parent job.</span></span> <span data-ttu-id="6ebce-118">Se un processo che si trova già in un processo viene aggiunto a un altro processo, i processi sono annidati per impostazione predefinita se il sistema può formare una gerarchia di processi valida e nessuno dei due imposta i limiti dell'interfaccia utente ([**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) con **JobObjectBasicUIRestrictions**).</span><span class="sxs-lookup"><span data-stu-id="6ebce-118">If a process that is already in a job is added to another job, the jobs are nested by default if the system can form a valid job hierarchy and neither job sets UI limits ([**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) with **JobObjectBasicUIRestrictions**).</span></span>

<span data-ttu-id="6ebce-119">Nella figura 1 viene illustrata una gerarchia di processi che contiene una struttura ad albero di processi con etichetta P0-P7.</span><span class="sxs-lookup"><span data-stu-id="6ebce-119">Figure 1 shows a job hierarchy that contains a tree of processes labeled P0 through P7.</span></span> <span data-ttu-id="6ebce-120">Il processo 1 è il processo *padre* del processo 2 e il processo 4 ed è un *predecessore* del processo 3.</span><span class="sxs-lookup"><span data-stu-id="6ebce-120">Job 1 is the *parent job* of Job 2 and Job 4, and it is an *ancestor* of Job 3.</span></span> <span data-ttu-id="6ebce-121">Il processo 2 è l' *elemento padre diretto* del processo 3. Il processo 3 è l' *elemento figlio immediato* del processo 2.</span><span class="sxs-lookup"><span data-stu-id="6ebce-121">Job 2 is the *immediate parent* of Job 3; Job 3 is the *immediate child* of Job 2.</span></span> <span data-ttu-id="6ebce-122">I processi 1, 2 e 3 formano una *catena* di processi in cui i processi 1 e 2 sono la catena di processi *padre* del processo 3.</span><span class="sxs-lookup"><span data-stu-id="6ebce-122">Jobs 1, 2, and 3 form a *job chain* in which Jobs 1 and 2 are the *parent job chain* of Job 3.</span></span> <span data-ttu-id="6ebce-123">Il processo finale in una catena di processi è il *processo immediato* dei processi in tale processo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-123">The end job in a job chain is the *immediate job* of the processes in that job.</span></span> <span data-ttu-id="6ebce-124">Nella figura 1, il processo 3 è il processo immediato dei processi P2, P3 e P4.</span><span class="sxs-lookup"><span data-stu-id="6ebce-124">In Figure 1, Job 3 is the immediate job of processes P2, P3, and P4.</span></span>

![Figura 1.](images/nested-jobs-a.png)

<span data-ttu-id="6ebce-127">I processi annidati possono essere usati anche per gestire i gruppi di processi peer.</span><span class="sxs-lookup"><span data-stu-id="6ebce-127">Nested jobs can also be used to manage groups of peer processes.</span></span> <span data-ttu-id="6ebce-128">Nella gerarchia dei processi illustrata nella figura 2, il processo 1 è il processo padre del processo 2.</span><span class="sxs-lookup"><span data-stu-id="6ebce-128">In the job hierarchy shown in Figure 2, Job 1 is the parent job of Job 2.</span></span> <span data-ttu-id="6ebce-129">Si noti che una gerarchia di processi potrebbe contenere solo parte di un albero di processi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-129">Note that a job hierarchy might contain only part of a process tree.</span></span> <span data-ttu-id="6ebce-130">Nella figura 2, P0 non si trova nella gerarchia, ma i processi figlio da P1 a P5 sono.</span><span class="sxs-lookup"><span data-stu-id="6ebce-130">In Figure 2, P0 is not in the hierarchy, but its child processes P1 through P5 are.</span></span>

![Figura 2.](images/nested-jobs-b.png)

## <a name="creating-a-nested-job-hierarchy"></a><span data-ttu-id="6ebce-133">Creazione di una gerarchia di processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-133">Creating a Nested Job Hierarchy</span></span>

<span data-ttu-id="6ebce-134">I processi in una gerarchia di processi sono associati in modo esplicito a un oggetto processo tramite la funzione [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) o associati in modo implicito durante la creazione del processo, come per i processi autonomi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-134">Processes in a job hierarchy are either explicitly associated with a job object using the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function or implicitly associated during process creation, same as for standalone jobs.</span></span> <span data-ttu-id="6ebce-135">L'ordine in cui vengono creati i processi e vengono assegnati i processi determina se è possibile creare una gerarchia.</span><span class="sxs-lookup"><span data-stu-id="6ebce-135">The order in which jobs are created and processes are assigned determines whether a hierarchy can be created.</span></span>

<span data-ttu-id="6ebce-136">Per compilare una gerarchia di processi utilizzando un'associazione esplicita, tutti gli oggetti processo devono essere creati utilizzando [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta), quindi [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) deve essere chiamato più volte per ogni processo per associare il processo a ogni processo a cui deve appartenere.</span><span class="sxs-lookup"><span data-stu-id="6ebce-136">To build a job hierarchy using explicit association, all job objects must be created using [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta), then [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) must be called multiple times for each process to associate the process with each job it should belong to.</span></span> <span data-ttu-id="6ebce-137">Per assicurarsi che la gerarchia processi sia valida, assegnare prima tutti i processi al processo alla radice della gerarchia, quindi assegnare un subset di processi all'oggetto processo figlio immediato e così via.</span><span class="sxs-lookup"><span data-stu-id="6ebce-137">To ensure that the job hierarchy is valid, first assign all processes to the job at the root of the hierarchy, then assign a subset of processes to the immediate child job object, and so on.</span></span> <span data-ttu-id="6ebce-138">Se i processi vengono assegnati ai processi in questo ordine, un processo figlio disporrà sempre di un subset di processi nel processo padre durante la creazione della gerarchia, necessaria per l'annidamento.</span><span class="sxs-lookup"><span data-stu-id="6ebce-138">If processes are assigned to jobs in this order, a child job will always have a subset of processes in its parent job while the hierarchy is being created, which is required for nesting.</span></span> <span data-ttu-id="6ebce-139">Se i processi vengono assegnati ai processi in ordine casuale, a un certo punto un processo figlio avrà processi non inclusi nel processo padre.</span><span class="sxs-lookup"><span data-stu-id="6ebce-139">If processes are assigned to jobs in random order, at some point a child job will have processes that are not in its parent job.</span></span> <span data-ttu-id="6ebce-140">Questa operazione non è consentita dall'annidamento e causerà l'esito negativo di **AssignProcessToJobObject** .</span><span class="sxs-lookup"><span data-stu-id="6ebce-140">This is not allowed by nesting and it will cause **AssignProcessToJobObject** to fail.</span></span>

<span data-ttu-id="6ebce-141">Quando i processi sono associati in modo implicito a un processo durante la creazione del processo, un processo figlio viene associato a ogni processo nella catena di processi del processo padre.</span><span class="sxs-lookup"><span data-stu-id="6ebce-141">When processes are implicitly associated with a job during process creation, a child process is associated with every job in the job chain of its parent process.</span></span> <span data-ttu-id="6ebce-142">Se l'oggetto processo immediato consente la separazione, il processo figlio si interrompe dall'oggetto processo immediato e da ogni processo nella catena di processi padre, spostandolo fino a raggiungere un processo che non consente la separazione.</span><span class="sxs-lookup"><span data-stu-id="6ebce-142">If the immediate job object allows breakaway, the child process breaks away from the immediate job object and from each job in the parent job chain, moving up the hierarchy until it reaches a job that does not permit breakaway.</span></span> <span data-ttu-id="6ebce-143">Se l'oggetto processo immediato non consente la fuga, il processo figlio non si interrompe neanche se i processi nella catena di processi padre lo consentono.</span><span class="sxs-lookup"><span data-stu-id="6ebce-143">If the immediate job object does not allow breakaway, the child process does not break away even if jobs in its parent job chain allow it.</span></span>

## <a name="job-limits-and-notifications-for-nested-jobs"></a><span data-ttu-id="6ebce-144">Limiti e notifiche dei processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-144">Job Limits and Notifications for Nested Jobs</span></span>

<span data-ttu-id="6ebce-145">Per determinati limiti di risorse, il limite impostato per i processi in una catena di processi padre determina il *limite effettivo* applicato per un processo figlio.</span><span class="sxs-lookup"><span data-stu-id="6ebce-145">For certain resource limits, the limit set for jobs in a parent job chain determine the *effective limit* that is enforced for a child job.</span></span> <span data-ttu-id="6ebce-146">Il limite effettivo per il processo figlio può essere più restrittivo rispetto al limite del padre, ma non può essere meno restrittivo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-146">The effective limit for child job can be more restrictive than the limit of its parent, but it cannot be less restrictive.</span></span> <span data-ttu-id="6ebce-147">Se, ad esempio, la classe di priorità di un processo figlio è al di sopra della classe di priorità normale \_ \_ \_ e la classe di priorità del processo padre è la classe di priorità normale \_ \_ , il limite effettivo per i processi nel processo figlio è la \_ classe di priorità normale \_ .</span><span class="sxs-lookup"><span data-stu-id="6ebce-147">For example, if a child job's priority class is ABOVE\_NORMAL\_PRIORITY\_CLASS and its parent job's priority class is NORMAL\_PRIORITY\_CLASS, the effective limit for processes in the child job is NORMAL\_PRIORITY\_CLASS.</span></span> <span data-ttu-id="6ebce-148">Tuttavia, se la classe di priorità del processo figlio è inferiore alla \_ \_ classe di priorità normale \_ , il limite effettivo per i processi nel processo figlio è inferiore alla \_ classe di priorità normale \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="6ebce-148">However, if the child job's priority class is BELOW\_NORMAL\_PRIORITY\_CLASS, the effective limit for processes in the child job is BELOW\_NORMAL\_PRIORITY\_CLASS.</span></span> <span data-ttu-id="6ebce-149">I limiti effettivi vengono applicati per la classe di priorità, l'affinità, l'addebito del commit, il limite di tempo di esecuzione per processo, il limite della classe di pianificazione e working set minimo e massimo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-149">Effective limits are enforced for priority class, affinity, commit charge, per-process execution time limit, scheduling class limit, and working set minimum and maximum.</span></span> <span data-ttu-id="6ebce-150">Per ulteriori informazioni sui limiti di risorse specifici, vedere [ **SetInformationJobObject.**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject)</span><span class="sxs-lookup"><span data-stu-id="6ebce-150">For more information about specific resource limits, see [**SetInformationJobObject.**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject)</span></span>

<span data-ttu-id="6ebce-151">Quando si verificano determinati eventi, ad esempio la creazione di nuovi processi o la violazione del limite di risorse, viene inviato un messaggio alla porta di completamento I/O associata a un processo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-151">When certain events occur, such as new process creation or resource limit violation, a message is sent to the I/O completion port associated with a job.</span></span> <span data-ttu-id="6ebce-152">Un processo può inoltre registrarsi per ricevere notifiche quando vengono superati determinati limiti.</span><span class="sxs-lookup"><span data-stu-id="6ebce-152">A job can also register to receive notifications when certain limits are exceeded.</span></span> <span data-ttu-id="6ebce-153">Per un processo non annidato, il messaggio viene inviato alla porta di completamento I/O associata al processo.</span><span class="sxs-lookup"><span data-stu-id="6ebce-153">For a non-nested job, the message is sent to the I/O completion port associated with the job.</span></span> <span data-ttu-id="6ebce-154">Per un processo annidato, il messaggio viene inviato a tutte le porte di completamento I/O associate a qualsiasi processo nella catena di processi padre del processo che ha attivato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="6ebce-154">For a nested job, the message is sent to every I/O completion port associated with any job in the parent job chain of the job that triggered the message.</span></span> <span data-ttu-id="6ebce-155">Un processo figlio non deve necessariamente disporre di una porta di completamento di I/O associata per i messaggi da esso inviati alle porte di completamento I/O dei processi padre più in alto nella catena di processi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-155">A child job does not need to have an associated I/O completion port for messages it triggers to be sent to the I/O completion ports of parent jobs higher in the job chain.</span></span> <span data-ttu-id="6ebce-156">Per ulteriori informazioni su messaggi specifici, vedere la pagina relativa alla [**\_ \_ \_ porta di completamento associata JOBOBJECT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span><span class="sxs-lookup"><span data-stu-id="6ebce-156">For more information about specific messages, see [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span></span>

## <a name="resource-accounting-for-nested-jobs"></a><span data-ttu-id="6ebce-157">Contabilità delle risorse per i processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-157">Resource Accounting for Nested Jobs</span></span>

<span data-ttu-id="6ebce-158">Le informazioni sull'accounting delle risorse per un processo annidato descrivono l'utilizzo di ogni processo associato a tale processo, inclusi i processi nei processi figlio.</span><span class="sxs-lookup"><span data-stu-id="6ebce-158">Resource accounting information for a nested job describes the usage of every process associated with that job, including processes in child jobs.</span></span> <span data-ttu-id="6ebce-159">Ogni processo in una catena di processi rappresenta quindi le risorse aggregate utilizzate dai rispettivi processi e i processi di ogni processo figlio sotto di esso nella catena di processi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-159">Each job in a job chain therefore represents the aggregated resources used by its own processes and the processes of every child job below it in the job chain.</span></span>

## <a name="termination-of-nested-jobs"></a><span data-ttu-id="6ebce-160">Terminazione dei processi annidati</span><span class="sxs-lookup"><span data-stu-id="6ebce-160">Termination of Nested Jobs</span></span>

<span data-ttu-id="6ebce-161">Quando un processo in una gerarchia di processi viene terminato, il sistema termina i processi del processo e di tutti i relativi processi figlio, a partire dal processo figlio nella parte inferiore della gerarchia.</span><span class="sxs-lookup"><span data-stu-id="6ebce-161">When a job in a job hierarchy is terminated, the system terminates processes in that job and all of its child jobs, starting with the child job at the bottom of the hierarchy.</span></span> <span data-ttu-id="6ebce-162">Le risorse in attesa utilizzate da ogni processo terminato vengono addebitate al processo padre.</span><span class="sxs-lookup"><span data-stu-id="6ebce-162">Outstanding resources used by each terminated process are charged to the parent job.</span></span>

<span data-ttu-id="6ebce-163">L'handle di processo deve avere l' \_ oggetto processo \_ Termina accesso a destra, come per i processi autonomi.</span><span class="sxs-lookup"><span data-stu-id="6ebce-163">The job handle must have the JOB\_OBJECT\_TERMINATE access right, same as for standalone jobs.</span></span>

 

 
