---
description: Un processo figlio può ereditare diverse proprietà e risorse dal processo padre.
ms.assetid: c530e723-2d40-4022-a259-dfc650604e44
title: Ereditarietà (processi e thread)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4713fe398360b510fab3c66f5cf74dc07b642dac
ms.sourcegitcommit: 3d718d8f69d3f86eaecf94c5705d761c5a9ef4a1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/20/2020
ms.locfileid: "106300659"
---
# <a name="inheritance"></a><span data-ttu-id="ca6af-103">Ereditarietà</span><span class="sxs-lookup"><span data-stu-id="ca6af-103">Inheritance</span></span>

<span data-ttu-id="ca6af-104">Un processo figlio può ereditare diverse proprietà e risorse dal processo padre.</span><span class="sxs-lookup"><span data-stu-id="ca6af-104">A child process can inherit several properties and resources from its parent process.</span></span> <span data-ttu-id="ca6af-105">È anche possibile impedire a un processo figlio di ereditare le proprietà dal processo padre.</span><span class="sxs-lookup"><span data-stu-id="ca6af-105">You can also prevent a child process from inheriting properties from its parent process.</span></span> <span data-ttu-id="ca6af-106">È possibile ereditare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="ca6af-106">The following can be inherited:</span></span>

-   <span data-ttu-id="ca6af-107">Handle aperti restituiti dalla funzione [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-107">Open handles returned by the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="ca6af-108">Sono inclusi gli handle per i file, i buffer di input della console, i buffer dello schermo della console, le named pipe, i dispositivi di comunicazione seriale e mailslot.</span><span class="sxs-lookup"><span data-stu-id="ca6af-108">This includes handles to files, console input buffers, console screen buffers, named pipes, serial communication devices, and mailslots.</span></span>
-   <span data-ttu-id="ca6af-109">Apre gli handle per elaborare, thread, mutex, Event, Semaphore, named pipe, Anonymous-pipe e oggetti di mapping di file.</span><span class="sxs-lookup"><span data-stu-id="ca6af-109">Open handles to process, thread, mutex, event, semaphore, named-pipe, anonymous-pipe, and file-mapping objects.</span></span> <span data-ttu-id="ca6af-110">Tali funzioni vengono restituite rispettivamente dalle funzioni [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**CreateSemaphore**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**CreateNamedPipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [**non**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe)e [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-110">These are returned by the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**CreateSemaphore**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**CreateNamedPipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [**CreatePipe**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe), and [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) functions, respectively.</span></span>
-   <span data-ttu-id="ca6af-111">Variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="ca6af-111">Environment variables.</span></span>
-   <span data-ttu-id="ca6af-112">La directory corrente.</span><span class="sxs-lookup"><span data-stu-id="ca6af-112">The current directory.</span></span>
-   <span data-ttu-id="ca6af-113">La console, a meno che il processo non venga scollegato o venga creata una nuova console.</span><span class="sxs-lookup"><span data-stu-id="ca6af-113">The console, unless the process is detached or a new console is created.</span></span> <span data-ttu-id="ca6af-114">Un processo della console figlio può anche ereditare gli handle standard del padre, nonché l'accesso al buffer di input e al buffer dello schermo attivo.</span><span class="sxs-lookup"><span data-stu-id="ca6af-114">A child console process can also inherit the parent's standard handles, as well as access to the input buffer and the active screen buffer.</span></span>
-   <span data-ttu-id="ca6af-115">Modalità di errore, impostata dalla funzione [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-115">The error mode, as set by the [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) function.</span></span>
-   <span data-ttu-id="ca6af-116">Maschera di affinità del processore.</span><span class="sxs-lookup"><span data-stu-id="ca6af-116">The processor affinity mask.</span></span>
-   <span data-ttu-id="ca6af-117">Associazione a un processo.</span><span class="sxs-lookup"><span data-stu-id="ca6af-117">The association with a job.</span></span>

<span data-ttu-id="ca6af-118">Il processo figlio non eredita quanto segue:</span><span class="sxs-lookup"><span data-stu-id="ca6af-118">The child process does not inherit the following:</span></span>

-   <span data-ttu-id="ca6af-119">Classe priority.</span><span class="sxs-lookup"><span data-stu-id="ca6af-119">Priority class.</span></span>
-   <span data-ttu-id="ca6af-120">Handle restituiti da [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate)e [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc).</span><span class="sxs-lookup"><span data-stu-id="ca6af-120">Handles returned by [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate), and [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc).</span></span>
-   <span data-ttu-id="ca6af-121">Pseudo-handle, come negli handle restituiti dalla funzione [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) o [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-121">Pseudo handles, as in the handles returned by the [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) or [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) function.</span></span> <span data-ttu-id="ca6af-122">Questi handle sono validi solo per il processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="ca6af-122">These handles are valid only for the calling process.</span></span>
-   <span data-ttu-id="ca6af-123">Handle del modulo DLL restituiti dalla funzione [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-123">DLL module handles returned by the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function.</span></span>
-   <span data-ttu-id="ca6af-124">Handle GDI o utente, ad esempio **HBITMAP** o **HMENU**.</span><span class="sxs-lookup"><span data-stu-id="ca6af-124">GDI or USER handles, such as **HBITMAP** or **HMENU**.</span></span>

## <a name="inheriting-handles"></a><span data-ttu-id="ca6af-125">Handle di ereditarietà</span><span class="sxs-lookup"><span data-stu-id="ca6af-125">Inheriting Handles</span></span>

<span data-ttu-id="ca6af-126">Un processo figlio può ereditare alcuni degli handle del padre, ma non ereditarne altri.</span><span class="sxs-lookup"><span data-stu-id="ca6af-126">A child process can inherit some of its parent's handles, but not inherit others.</span></span> <span data-ttu-id="ca6af-127">Per far sì che un handle venga ereditato, è necessario eseguire due operazioni:</span><span class="sxs-lookup"><span data-stu-id="ca6af-127">To cause a handle to be inherited, you must do two things:</span></span>

-   <span data-ttu-id="ca6af-128">Consente di specificare che l'handle deve essere ereditato quando si crea, si apre o si duplica l'handle.</span><span class="sxs-lookup"><span data-stu-id="ca6af-128">Specify that the handle is to be inherited when you create, open, or duplicate the handle.</span></span> <span data-ttu-id="ca6af-129">Per questo scopo, le funzioni di creazione usano in genere il membro **bInheritHandle** di una struttura di [**\_ attributi di sicurezza**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-129">Creation functions typically use the **bInheritHandle** member of a [**SECURITY\_ATTRIBUTES**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) structure for this purpose.</span></span> <span data-ttu-id="ca6af-130">[**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) usa il parametro *bInheritHandles* .</span><span class="sxs-lookup"><span data-stu-id="ca6af-130">[**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) uses the *bInheritHandles* parameter.</span></span>
-   <span data-ttu-id="ca6af-131">Consente di specificare che gli handle ereditabili devono essere ereditati impostando il parametro *bInheritHandles* su true quando si chiama la funzione [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-131">Specify that inheritable handles are to be inherited by setting the *bInheritHandles* parameter to TRUE when calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="ca6af-132">Inoltre, per ereditare l'input standard, l'output standard e gli handle di errore standard, il membro **dwFlags** della struttura [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) deve includere STARTF \_ USESTDHANDLES.</span><span class="sxs-lookup"><span data-stu-id="ca6af-132">Additionally, to inherit the standard input, standard output, and standard error handles, the **dwFlags** member of the [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) structure must include STARTF\_USESTDHANDLES.</span></span>

<span data-ttu-id="ca6af-133">Per specificare un elenco degli handle che devono essere ereditati da un processo figlio specifico, chiamare la funzione [**UpdateProcThreadAttribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) con il flag *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* .</span><span class="sxs-lookup"><span data-stu-id="ca6af-133">To specify a list of the handles that should be inherited by a specific child process, call the [**UpdateProcThreadAttribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) function with the *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* flag.</span></span>

<span data-ttu-id="ca6af-134">Un handle ereditato fa riferimento allo stesso oggetto nel processo figlio come nel processo padre.</span><span class="sxs-lookup"><span data-stu-id="ca6af-134">An inherited handle refers to the same object in the child process as it does in the parent process.</span></span> <span data-ttu-id="ca6af-135">Ha anche lo stesso valore e i privilegi di accesso.</span><span class="sxs-lookup"><span data-stu-id="ca6af-135">It also has the same value and access privileges.</span></span> <span data-ttu-id="ca6af-136">Pertanto, quando un processo modifica lo stato dell'oggetto, la modifica ha effetto su entrambi i processi.</span><span class="sxs-lookup"><span data-stu-id="ca6af-136">Therefore, when one process changes the state of the object, the change affects both processes.</span></span> <span data-ttu-id="ca6af-137">Per utilizzare un handle, è necessario che il processo figlio recuperi il valore dell'handle e "conosca" l'oggetto a cui fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="ca6af-137">To use a handle, the child process must retrieve the handle value and "know" the object to which it refers.</span></span> <span data-ttu-id="ca6af-138">In genere, il processo padre comunica queste informazioni al processo figlio tramite la riga di comando, il blocco dell'ambiente o una forma di [comunicazione interprocesso](/windows/desktop/ipc/interprocess-communications).</span><span class="sxs-lookup"><span data-stu-id="ca6af-138">Usually, the parent process communicates this information to the child process through its command line, environment block, or some form of [interprocess communication](/windows/desktop/ipc/interprocess-communications).</span></span>

<span data-ttu-id="ca6af-139">Utilizzare la funzione [**SetHandleInformation**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) per controllare se un handle esistente è ereditabile o meno.</span><span class="sxs-lookup"><span data-stu-id="ca6af-139">Use the [**SetHandleInformation**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) function to control if an existing handle is inheritable or not.</span></span>

## <a name="inheriting-environment-variables"></a><span data-ttu-id="ca6af-140">Ereditarietà delle variabili di ambiente</span><span class="sxs-lookup"><span data-stu-id="ca6af-140">Inheriting Environment Variables</span></span>

<span data-ttu-id="ca6af-141">Per impostazione predefinita, un processo figlio eredita le variabili di ambiente del processo padre.</span><span class="sxs-lookup"><span data-stu-id="ca6af-141">A child process inherits the environment variables of its parent process by default.</span></span> <span data-ttu-id="ca6af-142">Tuttavia, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) consente al processo padre di specificare un blocco diverso di variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="ca6af-142">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different block of environment variables.</span></span> <span data-ttu-id="ca6af-143">Per altre informazioni, vedere [variabili di ambiente](environment-variables.md).</span><span class="sxs-lookup"><span data-stu-id="ca6af-143">For more information, see [Environment Variables](environment-variables.md).</span></span>

## <a name="inheriting-the-current-directory"></a><span data-ttu-id="ca6af-144">Eredità della directory corrente</span><span class="sxs-lookup"><span data-stu-id="ca6af-144">Inheriting the Current Directory</span></span>

<span data-ttu-id="ca6af-145">La funzione [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) recupera la directory corrente del processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="ca6af-145">The [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) function retrieves the current directory of the calling process.</span></span> <span data-ttu-id="ca6af-146">Per impostazione predefinita, un processo figlio eredita la directory corrente del processo padre.</span><span class="sxs-lookup"><span data-stu-id="ca6af-146">A child process inherits the current directory of its parent process by default.</span></span> <span data-ttu-id="ca6af-147">Tuttavia, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) consente al processo padre di specificare una directory corrente diversa per il processo figlio.</span><span class="sxs-lookup"><span data-stu-id="ca6af-147">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different current directory for the child process.</span></span> <span data-ttu-id="ca6af-148">Per modificare la directory corrente del processo chiamante, usare la funzione [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) .</span><span class="sxs-lookup"><span data-stu-id="ca6af-148">To change the current directory of the calling process, use the [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) function.</span></span>
