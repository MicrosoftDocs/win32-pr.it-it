---
description: Per evitare race condition e deadlock, è necessario sincronizzare l'accesso da più thread a risorse condivise. La sincronizzazione è necessaria anche per garantire che il codice interdipendente venga eseguito nella sequenza corretta.
ms.assetid: 74af0502-dae1-438c-8e4b-7663093b3fe3
title: Sincronizzazione dell'esecuzione di più thread
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6a1b3dd51d666d507771476792e679f7980fab8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311955"
---
# <a name="synchronizing-execution-of-multiple-threads"></a><span data-ttu-id="21bb4-104">Sincronizzazione dell'esecuzione di più thread</span><span class="sxs-lookup"><span data-stu-id="21bb4-104">Synchronizing Execution of Multiple Threads</span></span>

<span data-ttu-id="21bb4-105">Per evitare race condition e deadlock, è necessario sincronizzare l'accesso da più thread a risorse condivise.</span><span class="sxs-lookup"><span data-stu-id="21bb4-105">To avoid race conditions and deadlocks, it is necessary to synchronize access by multiple threads to shared resources.</span></span> <span data-ttu-id="21bb4-106">La sincronizzazione è necessaria anche per garantire che il codice interdipendente venga eseguito nella sequenza corretta.</span><span class="sxs-lookup"><span data-stu-id="21bb4-106">Synchronization is also necessary to ensure that interdependent code is executed in the proper sequence.</span></span>

<span data-ttu-id="21bb4-107">Sono disponibili diversi oggetti i cui handle possono essere utilizzati per sincronizzare più thread.</span><span class="sxs-lookup"><span data-stu-id="21bb4-107">There are a number of objects whose handles can be used to synchronize multiple threads.</span></span> <span data-ttu-id="21bb4-108">Questi oggetti includono:</span><span class="sxs-lookup"><span data-stu-id="21bb4-108">These objects include:</span></span>

-   <span data-ttu-id="21bb4-109">Buffer di input della console</span><span class="sxs-lookup"><span data-stu-id="21bb4-109">Console input buffers</span></span>
-   <span data-ttu-id="21bb4-110">Eventi</span><span class="sxs-lookup"><span data-stu-id="21bb4-110">Events</span></span>
-   <span data-ttu-id="21bb4-111">Mutex</span><span class="sxs-lookup"><span data-stu-id="21bb4-111">Mutexes</span></span>
-   <span data-ttu-id="21bb4-112">Processi</span><span class="sxs-lookup"><span data-stu-id="21bb4-112">Processes</span></span>
-   <span data-ttu-id="21bb4-113">Semafori</span><span class="sxs-lookup"><span data-stu-id="21bb4-113">Semaphores</span></span>
-   <span data-ttu-id="21bb4-114">Thread</span><span class="sxs-lookup"><span data-stu-id="21bb4-114">Threads</span></span>
-   <span data-ttu-id="21bb4-115">Timer</span><span class="sxs-lookup"><span data-stu-id="21bb4-115">Timers</span></span>

<span data-ttu-id="21bb4-116">Lo stato di ognuno di questi oggetti è segnalato o non segnalato.</span><span class="sxs-lookup"><span data-stu-id="21bb4-116">The state of each of these objects is either signaled or not signaled.</span></span> <span data-ttu-id="21bb4-117">Quando si specifica un handle per uno di questi oggetti in una chiamata a una delle [funzioni Wait](../sync/wait-functions.md), l'esecuzione del thread chiamante viene bloccata fino a quando non viene segnalato lo stato dell'oggetto specificato.</span><span class="sxs-lookup"><span data-stu-id="21bb4-117">When you specify a handle to any of these objects in a call to one of the [wait functions](../sync/wait-functions.md), the execution of the calling thread is blocked until the state of the specified object becomes signaled.</span></span>

<span data-ttu-id="21bb4-118">Alcuni di questi oggetti sono utili per bloccare un thread fino a quando non si verifica un evento.</span><span class="sxs-lookup"><span data-stu-id="21bb4-118">Some of these objects are useful in blocking a thread until some event occurs.</span></span> <span data-ttu-id="21bb4-119">Ad esempio, un handle del buffer di input della console viene segnalato quando è presente un input non letto, ad esempio una sequenza di tasti o un clic del pulsante del mouse.</span><span class="sxs-lookup"><span data-stu-id="21bb4-119">For example, a console input buffer handle is signaled when there is unread input, such as a keystroke or mouse button click.</span></span> <span data-ttu-id="21bb4-120">Gli handle di processo e di thread vengono segnalati al termine del processo o del thread.</span><span class="sxs-lookup"><span data-stu-id="21bb4-120">Process and thread handles are signaled when the process or thread terminates.</span></span> <span data-ttu-id="21bb4-121">Questo consente a un processo, ad esempio, di creare un processo figlio e quindi di bloccare la propria esecuzione fino a quando il nuovo processo non viene terminato.</span><span class="sxs-lookup"><span data-stu-id="21bb4-121">This allows a process, for example, to create a child process and then block its own execution until the new process has terminated.</span></span>

<span data-ttu-id="21bb4-122">Altri oggetti sono utili per proteggere le risorse condivise dall'accesso simultaneo.</span><span class="sxs-lookup"><span data-stu-id="21bb4-122">Other objects are useful in protecting shared resources from simultaneous access.</span></span> <span data-ttu-id="21bb4-123">Ad esempio, più thread possono avere un handle per un oggetto mutex.</span><span class="sxs-lookup"><span data-stu-id="21bb4-123">For example, multiple threads can each have a handle to a mutex object.</span></span> <span data-ttu-id="21bb4-124">Prima di accedere a una risorsa condivisa, i thread devono chiamare una delle [funzioni di attesa](../sync/wait-functions.md) per attendere che lo stato del mutex venga segnalato.</span><span class="sxs-lookup"><span data-stu-id="21bb4-124">Before accessing a shared resource, the threads must call one of the [wait functions](../sync/wait-functions.md) to wait for the state of the mutex to be signaled.</span></span> <span data-ttu-id="21bb4-125">Quando il mutex viene segnalato, viene rilasciato un solo thread in attesa per accedere alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="21bb4-125">When the mutex becomes signaled, only one waiting thread is released to access the resource.</span></span> <span data-ttu-id="21bb4-126">Lo stato del mutex viene immediatamente reimpostato su non segnalato, in modo che tutti gli altri thread in attesa rimangano bloccati.</span><span class="sxs-lookup"><span data-stu-id="21bb4-126">The state of the mutex is immediately reset to not signaled so any other waiting threads remain blocked.</span></span> <span data-ttu-id="21bb4-127">Quando il thread è terminato con la risorsa, deve impostare lo stato del mutex su segnalato per consentire ad altri thread di accedere alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="21bb4-127">When the thread is finished with the resource, it must set the state of the mutex to signaled to allow other threads to access the resource.</span></span>

<span data-ttu-id="21bb4-128">Per i thread di un singolo processo, gli oggetti della sezione critica forniscono un mezzo di sincronizzazione più efficiente rispetto a mutex.</span><span class="sxs-lookup"><span data-stu-id="21bb4-128">For the threads of a single process, critical-section objects provide a more efficient means of synchronization than mutexes.</span></span> <span data-ttu-id="21bb4-129">Una sezione critica viene utilizzata come un mutex per abilitare un thread alla volta per l'utilizzo della risorsa protetta.</span><span class="sxs-lookup"><span data-stu-id="21bb4-129">A critical section is used like a mutex to enable one thread at a time to use the protected resource.</span></span> <span data-ttu-id="21bb4-130">Un thread può usare la funzione [**EnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-entercriticalsection) per richiedere la proprietà di una sezione critica.</span><span class="sxs-lookup"><span data-stu-id="21bb4-130">A thread can use the [**EnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-entercriticalsection) function to request ownership of a critical section.</span></span> <span data-ttu-id="21bb4-131">Se è già di proprietà di un altro thread, il thread richiedente è bloccato.</span><span class="sxs-lookup"><span data-stu-id="21bb4-131">If it is already owned by another thread, the requesting thread is blocked.</span></span> <span data-ttu-id="21bb4-132">Un thread può usare la funzione [**TryEnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-tryentercriticalsection) per richiedere la proprietà di una sezione critica, senza bloccarsi in caso di errore per ottenere la sezione critica.</span><span class="sxs-lookup"><span data-stu-id="21bb4-132">A thread can use the [**TryEnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-tryentercriticalsection) function to request ownership of a critical section, without blocking upon failure to obtain the critical section.</span></span> <span data-ttu-id="21bb4-133">Dopo la ricezione della proprietà, il thread è libero di usare la risorsa protetta.</span><span class="sxs-lookup"><span data-stu-id="21bb4-133">After it receives ownership, the thread is free to use the protected resource.</span></span> <span data-ttu-id="21bb4-134">L'esecuzione degli altri thread del processo non è interessata, a meno che non tenti di entrare nella stessa sezione critica.</span><span class="sxs-lookup"><span data-stu-id="21bb4-134">The execution of the other threads of the process is not affected unless they attempt to enter the same critical section.</span></span>

<span data-ttu-id="21bb4-135">La funzione [**WaitForInputIdle**](/windows/desktop/api/Winuser/nf-winuser-waitforinputidle) rende un thread in attesa finché un processo specificato non viene inizializzato e in attesa dell'input dell'utente senza input in sospeso.</span><span class="sxs-lookup"><span data-stu-id="21bb4-135">The [**WaitForInputIdle**](/windows/desktop/api/Winuser/nf-winuser-waitforinputidle) function makes a thread wait until a specified process is initialized and waiting for user input with no input pending.</span></span> <span data-ttu-id="21bb4-136">La chiamata di **WaitForInputIdle** può essere utile per la sincronizzazione dei processi padre e figlio, perché [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) restituisce senza attendere il completamento dell'inizializzazione da parte del processo figlio.</span><span class="sxs-lookup"><span data-stu-id="21bb4-136">Calling **WaitForInputIdle** can be useful for synchronizing parent and child processes, because [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) returns without waiting for the child process to complete its initialization.</span></span>

<span data-ttu-id="21bb4-137">Per ulteriori informazioni, vedere [sincronizzazione](../sync/synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="21bb4-137">For more information, see [Synchronization](../sync/synchronization.md).</span></span>

 

 
