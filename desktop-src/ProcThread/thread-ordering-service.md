---
description: Il servizio di ordinamento dei thread controlla l'esecuzione di uno o più thread client. Garantisce che ogni thread client venga eseguito una sola volta durante il periodo specificato e in ordine relativo.
ms.assetid: 5c37873a-ced4-447e-a6e1-55cfa8ab24b4
title: Servizio di ordinamento thread
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72b3cd12b26124b47d506585425388a4542a70df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311952"
---
# <a name="thread-ordering-service"></a><span data-ttu-id="2127b-104">Servizio di ordinamento thread</span><span class="sxs-lookup"><span data-stu-id="2127b-104">Thread Ordering Service</span></span>

<span data-ttu-id="2127b-105">Il *servizio di ordinamento dei thread* controlla l'esecuzione di uno o più thread client.</span><span class="sxs-lookup"><span data-stu-id="2127b-105">The *thread ordering service* controls the execution of one or more client threads.</span></span> <span data-ttu-id="2127b-106">Garantisce che ogni thread client venga eseguito una sola volta durante il periodo specificato e in ordine relativo.</span><span class="sxs-lookup"><span data-stu-id="2127b-106">It ensures that each client thread runs once during the specified period and in relative order.</span></span>

<span data-ttu-id="2127b-107">**Windows Server 2003 e Windows XP:** Il servizio di ordinamento dei thread è disponibile a partire da Windows Vista e Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="2127b-107">**Windows Server 2003 and Windows XP:** The thread ordering service is available starting with Windows Vista and Windows Server 2008.</span></span>

<span data-ttu-id="2127b-108">Il servizio di ordinamento dei thread è disattivato per impostazione predefinita e deve essere avviato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="2127b-108">The thread ordering service is off by default and must be started by the user.</span></span> <span data-ttu-id="2127b-109">Mentre il servizio di ordinamento dei thread è in esecuzione, viene attivato ogni 5 secondi per verificare se è presente una nuova richiesta, anche se il sistema è inattivo.</span><span class="sxs-lookup"><span data-stu-id="2127b-109">While the thread ordering service is running, it is activated every 5 seconds to check whether there is a new request, even if the system is idle.</span></span> <span data-ttu-id="2127b-110">In questo modo si impedisce che il sistema venga sospeso per più di 5 secondi, causando un maggiore consumo di energia.</span><span class="sxs-lookup"><span data-stu-id="2127b-110">This prevents the system from sleeping for longer than 5 seconds, causing the system to consume more power.</span></span> <span data-ttu-id="2127b-111">Se l'efficienza energetica è cruciale per l'applicazione, è preferibile non usare il servizio di ordinamento dei thread e consentire invece all'utilità di pianificazione di sistema di gestire l'esecuzione dei thread.</span><span class="sxs-lookup"><span data-stu-id="2127b-111">If energy efficiency is critical to the application, it is better not to use the thread ordering service and instead allow the system scheduler to manage execution of threads.</span></span>

<span data-ttu-id="2127b-112">Ogni thread del client appartiene a un *gruppo di ordini di thread*.</span><span class="sxs-lookup"><span data-stu-id="2127b-112">Each client thread belongs to a *thread ordering group*.</span></span> <span data-ttu-id="2127b-113">Il *thread padre* crea uno o più gruppi di ordinamento dei thread chiamando la funzione [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="2127b-113">The *parent thread* creates one or more thread ordering groups by calling the [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) function.</span></span> <span data-ttu-id="2127b-114">Il thread padre usa questa funzione per specificare il periodo per il gruppo di ordinamento dei thread e un intervallo di timeout.</span><span class="sxs-lookup"><span data-stu-id="2127b-114">The parent thread uses this function to specify the period for the thread ordering group and a time-out interval.</span></span>

<span data-ttu-id="2127b-115">Thread client aggiuntivi chiamano la funzione [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) per partecipare a un gruppo di ordinamento thread esistente.</span><span class="sxs-lookup"><span data-stu-id="2127b-115">Additional client threads call the [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) function to join an existing thread ordering group.</span></span> <span data-ttu-id="2127b-116">Questi thread indicano se devono essere un predecessore o un successore al thread padre nell'ordine di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2127b-116">These threads indicate whether they are to be a predecessor or successor to the parent thread in the execution order.</span></span> <span data-ttu-id="2127b-117">Ogni thread del client dovrebbe completare una determinata quantità di elaborazione ogni periodo.</span><span class="sxs-lookup"><span data-stu-id="2127b-117">Each client thread is expected to complete a certain amount of processing each period.</span></span> <span data-ttu-id="2127b-118">Tutti i thread all'interno del gruppo devono completare l'esecuzione entro il periodo più l'intervallo di timeout.</span><span class="sxs-lookup"><span data-stu-id="2127b-118">All threads within the group should complete their execution within the period plus the time-out interval.</span></span>

<span data-ttu-id="2127b-119">I thread di un gruppo di ordinamento dei thread racchiudono il codice di elaborazione all'interno di un ciclo controllato dalla funzione [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="2127b-119">The threads of a thread ordering group enclose their processing code within a loop that is controlled by the [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) function.</span></span> <span data-ttu-id="2127b-120">In primo luogo, i thread precedenti vengono eseguiti uno alla volta nell'ordine in cui sono stati aggiunti al gruppo, mentre i thread padre e successore sono bloccati nelle chiamate a **AvRtWaitOnThreadOrderingGroup**.</span><span class="sxs-lookup"><span data-stu-id="2127b-120">First, the predecessor threads are executed one at a time in the order that they joined the group, while the parent and successor threads are blocked on their calls to **AvRtWaitOnThreadOrderingGroup**.</span></span> <span data-ttu-id="2127b-121">Quando ogni thread precedente termina con l'elaborazione, il controllo dell'esecuzione torna all'inizio del ciclo di elaborazione e il thread chiama di nuovo **AvRtWaitOnThreadOrderingGroup** per bloccarsi fino al successivo turno.</span><span class="sxs-lookup"><span data-stu-id="2127b-121">When each predecessor thread is finished with its processing, control of execution returns to the top of its processing loop and the thread calls **AvRtWaitOnThreadOrderingGroup** again to block until its next turn.</span></span> <span data-ttu-id="2127b-122">Dopo che tutti i thread precedenti hanno chiamato questa funzione, il servizio di ordinamento dei thread può pianificare il thread padre.</span><span class="sxs-lookup"><span data-stu-id="2127b-122">After all predecessor threads have called this function, the thread ordering service can schedule the parent thread.</span></span> <span data-ttu-id="2127b-123">Infine, quando il thread padre termina l'elaborazione e chiama di nuovo **AvRtWaitOnThreadOrderingGroup** , il servizio di ordinamento dei thread può pianificare i thread successivi uno alla volta nell'ordine in cui sono stati aggiunti al gruppo.</span><span class="sxs-lookup"><span data-stu-id="2127b-123">Finally, when the parent thread finishes its processing and calls **AvRtWaitOnThreadOrderingGroup** again, the thread ordering service can schedule the successor threads one at a time in the order that they joined the group.</span></span> <span data-ttu-id="2127b-124">Se tutti i thread completano l'esecuzione prima del termine di un periodo, tutti i thread restano in attesa fino a quando il resto del periodo non scade prima che venga eseguita di nuovo.</span><span class="sxs-lookup"><span data-stu-id="2127b-124">If all threads complete their execution before a period ends, all threads wait until the remainder of the period elapses before any are executed again.</span></span>

<span data-ttu-id="2127b-125">Quando il client non deve più essere eseguito come parte del gruppo di ordinamento dei thread, chiama la funzione [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) per rimuovere se stessa dal gruppo.</span><span class="sxs-lookup"><span data-stu-id="2127b-125">When the client need no longer run as part of the thread ordering group, it calls the [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) function to remove itself from the group.</span></span> <span data-ttu-id="2127b-126">Si noti che il thread padre non deve rimuovere se stesso da un gruppo di ordinamento dei thread.</span><span class="sxs-lookup"><span data-stu-id="2127b-126">Note that the parent thread should not remove itself from a thread ordering group.</span></span> <span data-ttu-id="2127b-127">Se un thread non completa l'esecuzione prima della scadenza del periodo più l'intervallo di timeout, viene eliminato dal gruppo.</span><span class="sxs-lookup"><span data-stu-id="2127b-127">If a thread does not complete its execution before the period plus the time-out interval elapses, then it is deleted from the group.</span></span>

<span data-ttu-id="2127b-128">Il thread padre chiama la funzione [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) per eliminare il gruppo di ordinamento dei thread.</span><span class="sxs-lookup"><span data-stu-id="2127b-128">The parent thread calls the [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) function to delete the thread ordering group.</span></span> <span data-ttu-id="2127b-129">Anche il gruppo di ordinamento dei thread viene eliminato definitivamente se il thread padre non completa l'esecuzione prima del periodo più lungo dell'intervallo di timeout.</span><span class="sxs-lookup"><span data-stu-id="2127b-129">The thread ordering group is also destroyed if the parent thread does not complete its execution before the period plus the time-out interval elapses.</span></span> <span data-ttu-id="2127b-130">Quando il gruppo di ordinamento dei thread viene eliminato definitivamente, le chiamate a [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) dai thread di tale gruppo hanno esito negativo o si verifica il timeout.</span><span class="sxs-lookup"><span data-stu-id="2127b-130">When the thread ordering group is destroyed, any calls to [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) from threads of that group fail or time out.</span></span>

 

 



