---
description: "La terminazione di un thread presenta i risultati seguenti: le risorse di proprietà del thread, ad esempio Windows e Hook, vengono liberate. Il codice di uscita del thread è impostato. L'oggetto thread viene segnalato. Se il thread è l'unico thread attivo nel processo, il processo viene terminato. Per ulteriori informazioni, vedere terminazione di un processo."
ms.assetid: 633e5d0c-e9d8-4f9a-9411-17cbe9e2e6e4
title: "  Terminazione di un thread"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ada421356666316072aabff8281787cc140ad114
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106311953"
---
# <a name="terminating-a-thread"></a><span data-ttu-id="3bd23-104">  Terminazione di un thread</span><span class="sxs-lookup"><span data-stu-id="3bd23-104">Terminating a Thread</span></span>

<span data-ttu-id="3bd23-105">La chiusura di un thread presenta i risultati seguenti:</span><span class="sxs-lookup"><span data-stu-id="3bd23-105">Terminating a thread has the following results:</span></span>

-   <span data-ttu-id="3bd23-106">Tutte le risorse di proprietà del thread, ad esempio Windows e Hook, vengono liberate.</span><span class="sxs-lookup"><span data-stu-id="3bd23-106">Any resources owned by the thread, such as windows and hooks, are freed.</span></span>
-   <span data-ttu-id="3bd23-107">Il codice di uscita del thread è impostato.</span><span class="sxs-lookup"><span data-stu-id="3bd23-107">The thread exit code is set.</span></span>
-   <span data-ttu-id="3bd23-108">L'oggetto thread viene segnalato.</span><span class="sxs-lookup"><span data-stu-id="3bd23-108">The thread object is signaled.</span></span>
-   <span data-ttu-id="3bd23-109">Se il thread è l'unico thread attivo nel processo, il processo viene terminato.</span><span class="sxs-lookup"><span data-stu-id="3bd23-109">If the thread is the only active thread in the process, the process is terminated.</span></span> <span data-ttu-id="3bd23-110">Per ulteriori informazioni, vedere [terminazione di un processo](terminating-a-process.md).</span><span class="sxs-lookup"><span data-stu-id="3bd23-110">For more information, see [Terminating a Process](terminating-a-process.md).</span></span>

<span data-ttu-id="3bd23-111">La funzione [**GetExitCodeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodethread) restituisce lo stato di terminazione di un thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-111">The [**GetExitCodeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodethread) function returns the termination status of a thread.</span></span> <span data-ttu-id="3bd23-112">Mentre un thread è in esecuzione, lo stato di chiusura è ancora \_ attivo.</span><span class="sxs-lookup"><span data-stu-id="3bd23-112">While a thread is executing, its termination status is STILL\_ACTIVE.</span></span> <span data-ttu-id="3bd23-113">Quando un thread termina, lo stato di chiusura passa da ancora \_ attivo al codice di uscita del thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-113">When a thread terminates, its termination status changes from STILL\_ACTIVE to the exit code of the thread.</span></span>

<span data-ttu-id="3bd23-114">Quando un thread termina, lo stato dell'oggetto thread passa a segnalato, rilasciando tutti gli altri thread in attesa che il thread venga terminato.</span><span class="sxs-lookup"><span data-stu-id="3bd23-114">When a thread terminates, the state of the thread object changes to signaled, releasing any other threads that had been waiting for the thread to terminate.</span></span> <span data-ttu-id="3bd23-115">Per ulteriori informazioni sulla sincronizzazione, vedere [sincronizzazione dell'esecuzione di più thread](synchronizing-execution-of-multiple-threads.md).</span><span class="sxs-lookup"><span data-stu-id="3bd23-115">For more about synchronization, see [Synchronizing Execution of Multiple Threads](synchronizing-execution-of-multiple-threads.md).</span></span>

<span data-ttu-id="3bd23-116">Quando un thread termina, il relativo oggetto thread non viene liberato fino a quando non vengono chiusi tutti gli handle aperti per il thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-116">When a thread terminates, its thread object is not freed until all open handles to the thread are closed.</span></span>

## <a name="how-threads-are-terminated"></a><span data-ttu-id="3bd23-117">Come vengono terminati i thread</span><span class="sxs-lookup"><span data-stu-id="3bd23-117">How Threads are Terminated</span></span>

<span data-ttu-id="3bd23-118">Un thread viene eseguito fino a quando non si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3bd23-118">A thread executes until one of the following events occurs:</span></span>

-   <span data-ttu-id="3bd23-119">Il thread chiama la funzione [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) .</span><span class="sxs-lookup"><span data-stu-id="3bd23-119">The thread calls the [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) function.</span></span>
-   <span data-ttu-id="3bd23-120">Qualsiasi thread del processo chiama la funzione [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) .</span><span class="sxs-lookup"><span data-stu-id="3bd23-120">Any thread of the process calls the [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) function.</span></span>
-   <span data-ttu-id="3bd23-121">La funzione thread restituisce.</span><span class="sxs-lookup"><span data-stu-id="3bd23-121">The thread function returns.</span></span>
-   <span data-ttu-id="3bd23-122">Qualsiasi thread chiama la funzione [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) con un handle per il thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-122">Any thread calls the [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) function with a handle to the thread.</span></span>
-   <span data-ttu-id="3bd23-123">Qualsiasi thread chiama la funzione [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) con un handle per il processo.</span><span class="sxs-lookup"><span data-stu-id="3bd23-123">Any thread calls the [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) function with a handle to the process.</span></span>

<span data-ttu-id="3bd23-124">Il codice di uscita per un thread è il valore specificato nella chiamata a [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread)o [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess)oppure il valore restituito dalla funzione thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-124">The exit code for a thread is either the value specified in the call to [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread), or [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess), or the value returned by the thread function.</span></span>

<span data-ttu-id="3bd23-125">Se un thread viene terminato da [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), il sistema chiama la funzione del punto di ingresso di ogni DLL collegata con un valore che indica che il thread viene scollegato dalla dll (a meno che non si chiami la funzione [**DisableThreadLibraryCalls**](/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls) ).</span><span class="sxs-lookup"><span data-stu-id="3bd23-125">If a thread is terminated by [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), the system calls the entry-point function of each attached DLL with a value indicating that the thread is detaching from the DLL (unless you call the [**DisableThreadLibraryCalls**](/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls) function).</span></span> <span data-ttu-id="3bd23-126">Se un thread viene terminato da [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), le funzioni del punto di ingresso della dll vengono richiamate una volta per indicare che il processo è scollegato.</span><span class="sxs-lookup"><span data-stu-id="3bd23-126">If a thread is terminated by [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), the DLL entry-point functions are invoked once, to indicate that the process is detaching.</span></span> <span data-ttu-id="3bd23-127">Le dll non ricevono notifiche quando un thread viene terminato da [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) o [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span><span class="sxs-lookup"><span data-stu-id="3bd23-127">DLLs are not notified when a thread is terminated by [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) or [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span></span> <span data-ttu-id="3bd23-128">Per altre informazioni sulle dll, vedere [librerie a collegamento dinamico](../dlls/dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="3bd23-128">For more information about DLLs, see [Dynamic-Link Libraries](../dlls/dynamic-link-libraries.md).</span></span>

<span data-ttu-id="3bd23-129">Le funzioni [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) e [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) devono essere utilizzate solo in casi estremi, poiché non consentono la pulizia dei thread, non inviano notifiche a DLL collegate e non liberano lo stack iniziale.</span><span class="sxs-lookup"><span data-stu-id="3bd23-129">The [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) and [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) functions should be used only in extreme circumstances, since they do not allow threads to clean up, do not notify attached DLLs, and do not free the initial stack.</span></span> <span data-ttu-id="3bd23-130">Inoltre, gli handle per gli oggetti di proprietà del thread non vengono chiusi fino al termine del processo.</span><span class="sxs-lookup"><span data-stu-id="3bd23-130">In addition, handles to objects owned by the thread are not closed until the process terminates.</span></span> <span data-ttu-id="3bd23-131">I passaggi seguenti offrono una soluzione migliore:</span><span class="sxs-lookup"><span data-stu-id="3bd23-131">The following steps provide a better solution:</span></span>

-   <span data-ttu-id="3bd23-132">Creare un oggetto evento usando la funzione [**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa) .</span><span class="sxs-lookup"><span data-stu-id="3bd23-132">Create an event object using the [**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa) function.</span></span>
-   <span data-ttu-id="3bd23-133">Creare i thread.</span><span class="sxs-lookup"><span data-stu-id="3bd23-133">Create the threads.</span></span>
-   <span data-ttu-id="3bd23-134">Ogni thread monitora lo stato dell'evento chiamando la funzione [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) .</span><span class="sxs-lookup"><span data-stu-id="3bd23-134">Each thread monitors the event state by calling the [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) function.</span></span> <span data-ttu-id="3bd23-135">Usare un intervallo di timeout di attesa pari a zero.</span><span class="sxs-lookup"><span data-stu-id="3bd23-135">Use a wait time-out interval of zero.</span></span>
-   <span data-ttu-id="3bd23-136">Ogni thread termina la propria esecuzione quando l'evento è impostato sullo stato segnalato ([**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) restituisce l' \_ oggetto Wait \_ 0).</span><span class="sxs-lookup"><span data-stu-id="3bd23-136">Each thread terminates its own execution when the event is set to the signaled state ([**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) returns WAIT\_OBJECT\_0).</span></span>

 

 
