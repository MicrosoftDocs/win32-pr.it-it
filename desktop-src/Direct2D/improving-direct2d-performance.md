---
title: Miglioramento delle prestazioni delle app Direct2D
description: Vengono descritte le tecniche per migliorare le prestazioni di Direct2D.
ms.assetid: e6b02925-4e75-42b0-b0c4-00f1ddb85e46
keywords:
- Direct2D, prestazioni
- Direct2D, bitmap
- Direct2D, utilizzo risorse
- Direct2D, metodo Flush
- Direct2D, contenuto statico
- prestazioni per Direct2D
- bitmap per Direct2D
- Direct2D, interoperatività GDI
- Direct2D, interoperabilità
- interoperabilità, Direct2D
- Graphics Device Interface (GDI)
- GDI (Graphics Device Interface)
- interoperabilità, Graphics Device Interface (GDI)
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: 5a413b96e00514b64b3cf1b1ee451a84a9e9ff09
ms.sourcegitcommit: 6eb53540b8d882fd035d428567d7d1c5ec17042c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/12/2020
ms.locfileid: "104474588"
---
# <a name="improving-the-performance-of-direct2d-apps"></a><span data-ttu-id="b4589-116">Miglioramento delle prestazioni delle app Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-116">Improving the performance of Direct2D apps</span></span>

<span data-ttu-id="b4589-117">Sebbene l'hardware [Direct2D](./direct2d-portal.md) sia accelerato ed è destinato a prestazioni elevate, è necessario utilizzare correttamente le funzionalità per ottimizzare la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="b4589-117">Although [Direct2D](./direct2d-portal.md) is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="b4589-118">Le tecniche illustrate di seguito derivano dallo studio di scenari comuni e potrebbero non essere applicabili a tutti gli scenari di app.</span><span class="sxs-lookup"><span data-stu-id="b4589-118">The techniques we show here are derived from studying common scenarios and might not apply to all app scenarios.</span></span> <span data-ttu-id="b4589-119">Pertanto, una conoscenza attenta del comportamento delle app e degli obiettivi di prestazioni può aiutare a ottenere i risultati desiderati.</span><span class="sxs-lookup"><span data-stu-id="b4589-119">Therefore, careful understanding of app behavior and performance goals can help achieve the results that you want.</span></span>

-   [<span data-ttu-id="b4589-120">Utilizzo delle risorse</span><span class="sxs-lookup"><span data-stu-id="b4589-120">Resource usage</span></span>](#resource-usage)
    -   [<span data-ttu-id="b4589-121">Riutilizza risorse</span><span class="sxs-lookup"><span data-stu-id="b4589-121">Reuse resources</span></span>](#reuse-resources)
-   [<span data-ttu-id="b4589-122">Limita l'uso dello scaricamento</span><span class="sxs-lookup"><span data-stu-id="b4589-122">Restrict the use of flush</span></span>](#restrict-the-use-of-flush)
-   [<span data-ttu-id="b4589-123">Bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-123">Bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="b4589-124">Crea bitmap di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="b4589-124">Create large bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="b4589-125">Creare un Atlante di bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-125">Create an atlas of bitmaps</span></span>](#create-an-atlas-of-bitmaps)
    -   [<span data-ttu-id="b4589-126">Crea bitmap condivise</span><span class="sxs-lookup"><span data-stu-id="b4589-126">Create shared bitmaps</span></span>](#create-shared-bitmaps)
    -   [<span data-ttu-id="b4589-127">Copia di bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-127">Copying bitmaps</span></span>](#copying-bitmaps)
-   [<span data-ttu-id="b4589-128">Usa la bitmap affiancata su trattino</span><span class="sxs-lookup"><span data-stu-id="b4589-128">Use tiled bitmap over dashing</span></span>](#use-tiled-bitmap-over-dashing)
-   [<span data-ttu-id="b4589-129">Linee guida generali per il rendering di contenuto statico complesso</span><span class="sxs-lookup"><span data-stu-id="b4589-129">General guidelines for rendering complex static content</span></span>](#general-guidelines-for-rendering-complex-static-content)
    -   [<span data-ttu-id="b4589-130">Memorizzazione nella cache completa della scena utilizzando una bitmap a colori</span><span class="sxs-lookup"><span data-stu-id="b4589-130">Full scene caching using a color bitmap</span></span>](#full-scene-caching-using-a-color-bitmap)
    -   [<span data-ttu-id="b4589-131">Per la memorizzazione nella cache primitiva con una bitmap a8 e il metodo FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="b4589-131">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>](#per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method)
-   [<span data-ttu-id="b4589-132">Caching per primitive con le realizzazioni di geometria</span><span class="sxs-lookup"><span data-stu-id="b4589-132">Per-primitive caching using geometry realizations</span></span>](#per-primitive-caching-using-geometry-realizations)
-   [<span data-ttu-id="b4589-133">Rendering Geometry</span><span class="sxs-lookup"><span data-stu-id="b4589-133">Geometry rendering</span></span>](#geometry-rendering)
    -   [<span data-ttu-id="b4589-134">Usa una primitiva di estrazione specifica sulla geometria di tipo</span><span class="sxs-lookup"><span data-stu-id="b4589-134">Use specific draw primitive over draw geometry</span></span>](#use-specific-draw-primitive-over-draw-geometry)
    -   [<span data-ttu-id="b4589-135">Rendering della geometria statica</span><span class="sxs-lookup"><span data-stu-id="b4589-135">Rendering static geometry</span></span>](#rendering-static-geometry)
    -   [<span data-ttu-id="b4589-136">Usare un contesto di dispositivo multithread</span><span class="sxs-lookup"><span data-stu-id="b4589-136">Use a multithreaded device context</span></span>](#use-a-multithreaded-device-context)
-   [<span data-ttu-id="b4589-137">Disegno di testo con Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-137">Drawing text with Direct2D</span></span>](#use-a-multithreaded-device-context)
    -   [<span data-ttu-id="b4589-138">Confronto tra DrawTextLayout e DrawText</span><span class="sxs-lookup"><span data-stu-id="b4589-138">DrawTextLayout Vs. DrawText</span></span>](#drawtextlayout-vs-drawtext)
    -   [<span data-ttu-id="b4589-139">Scelta della modalità di rendering del testo corretta</span><span class="sxs-lookup"><span data-stu-id="b4589-139">Choosing the right text rendering mode</span></span>](#choosing-the-right-text-rendering-mode)
    -   [<span data-ttu-id="b4589-140">Memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="b4589-140">Caching</span></span>](#full-scene-caching-using-a-color-bitmap)
-   [<span data-ttu-id="b4589-141">Ritaglio di una forma arbitraria</span><span class="sxs-lookup"><span data-stu-id="b4589-141">Clipping an arbitrary shape</span></span>](#clipping-an-arbitrary-shape)
    -   [<span data-ttu-id="b4589-142">PushLayer in Windows 8</span><span class="sxs-lookup"><span data-stu-id="b4589-142">PushLayer in Windows 8</span></span>](#pushlayer-in-windows-8)
    -   [<span data-ttu-id="b4589-143">Clip allineate asse</span><span class="sxs-lookup"><span data-stu-id="b4589-143">Axis-aligned clips</span></span>](#axis-aligned-clips)
-   [<span data-ttu-id="b4589-144">Interoperabilità DXGI: evitare cambi frequenti</span><span class="sxs-lookup"><span data-stu-id="b4589-144">DXGI interoperability: avoid frequent switches</span></span>](#dxgi-interoperability-avoid-frequent-switches)
-   [<span data-ttu-id="b4589-145">Conosce il formato pixel</span><span class="sxs-lookup"><span data-stu-id="b4589-145">Know Your Pixel Format</span></span>](#know-your-pixel-format)
-   [<span data-ttu-id="b4589-146">Complessità della scena</span><span class="sxs-lookup"><span data-stu-id="b4589-146">Scene Complexity</span></span>](#scene-complexity)
    -   [<span data-ttu-id="b4589-147">Comprendere la complessità della scena</span><span class="sxs-lookup"><span data-stu-id="b4589-147">Understand Scene Complexity</span></span>](#understand-scene-complexity)
-   [<span data-ttu-id="b4589-148">Miglioramento delle prestazioni per le app di stampa Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-148">Improving performance for Direct2D printing apps</span></span>](#improving-performance-for-direct2d-printing-apps)
    -   [<span data-ttu-id="b4589-149">Impostare i valori di proprietà corretti quando si crea il controllo di stampa D2D</span><span class="sxs-lookup"><span data-stu-id="b4589-149">Set the right property values when you create the D2D print control</span></span>](#set-the-right-property-values-when-you-create-the-d2d-print-control)
    -   [<span data-ttu-id="b4589-150">Evitare di usare determinati modelli di disegno Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-150">Avoid using certain Direct2D drawing patterns</span></span>](#avoid-using-certain-direct2d-drawing-patterns)
    -   [<span data-ttu-id="b4589-151">Creare testo in modo diretto e normale</span><span class="sxs-lookup"><span data-stu-id="b4589-151">Draw text in a direct and plain way</span></span>](#draw-text-in-a-direct-and-plain-way)
    -   [<span data-ttu-id="b4589-152">Estrai le bitmap originali quando possibile</span><span class="sxs-lookup"><span data-stu-id="b4589-152">Draw the original bitmaps when possible</span></span>](#draw-the-original-bitmaps-when-possible)
-   [<span data-ttu-id="b4589-153">Conclusione</span><span class="sxs-lookup"><span data-stu-id="b4589-153">Conclusion</span></span>](#conclusion)

## <a name="resource-usage"></a><span data-ttu-id="b4589-154">Utilizzo delle risorse</span><span class="sxs-lookup"><span data-stu-id="b4589-154">Resource usage</span></span>

<span data-ttu-id="b4589-155">Una risorsa è un'allocazione di un certo tipo, sia nella memoria video che nel sistema.</span><span class="sxs-lookup"><span data-stu-id="b4589-155">A resource is an allocation of some kind, either in video or system memory.</span></span> <span data-ttu-id="b4589-156">Bitmap e pennelli sono esempi di risorse.</span><span class="sxs-lookup"><span data-stu-id="b4589-156">Bitmaps and brushes are examples of resources.</span></span>

<span data-ttu-id="b4589-157">In Direct2D è possibile creare risorse in software e hardware.</span><span class="sxs-lookup"><span data-stu-id="b4589-157">In Direct2D, resources can be created both in software and hardware.</span></span> <span data-ttu-id="b4589-158">La creazione e l'eliminazione di risorse nell'hardware sono operazioni costose perché richiedono un sovraccarico per la comunicazione con la scheda video.</span><span class="sxs-lookup"><span data-stu-id="b4589-158">Resource creation and deletion on hardware are expensive operations because they require lots of overhead for communicating with the video card.</span></span> <span data-ttu-id="b4589-159">Vediamo come Direct2D esegue il rendering del contenuto in una destinazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-159">Let's see how Direct2D renders content to a target.</span></span>

<span data-ttu-id="b4589-160">In Direct2D tutti i comandi di rendering sono racchiusi tra una chiamata a [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) e una chiamata a [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span><span class="sxs-lookup"><span data-stu-id="b4589-160">In Direct2D, all the rendering commands are enclosed between a call to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and a call to [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span> <span data-ttu-id="b4589-161">Queste chiamate vengono effettuate a una destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-161">These calls are made to a render target.</span></span> <span data-ttu-id="b4589-162">Prima di chiamare le operazioni di rendering, è necessario chiamare il metodo **BeginDraw** .</span><span class="sxs-lookup"><span data-stu-id="b4589-162">You must call the **BeginDraw** method before you call rendering operations .</span></span> <span data-ttu-id="b4589-163">Dopo aver chiamato **BeginDraw** , un contesto crea in genere un batch di comandi di rendering, ma ritarda l'elaborazione di questi comandi fino a quando non viene soddisfatta una di queste istruzioni:</span><span class="sxs-lookup"><span data-stu-id="b4589-163">After you call **BeginDraw** , a context typically builds up a batch of rendering commands, but delays processing of these commands until one of these statements is true:</span></span>

-   <span data-ttu-id="b4589-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) si è verificato.</span><span class="sxs-lookup"><span data-stu-id="b4589-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) occurred.</span></span> <span data-ttu-id="b4589-165">Quando viene chiamato **EndDraw** , il completamento di tutte le operazioni di disegno in batch e restituisce lo stato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-165">When **EndDraw** is called, it causes any batched drawing operations to complete and returns the status of the operation.</span></span>
-   <span data-ttu-id="b4589-166">Viene eseguita una chiamata esplicita a [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): il metodo **Flush** causa l'elaborazione del batch e l'esecuzione di tutti i comandi in sospeso.</span><span class="sxs-lookup"><span data-stu-id="b4589-166">You make an explicit call to [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): The **Flush** method causes the batch to be processed and all pending commands to be issued.</span></span>
-   <span data-ttu-id="b4589-167">Il buffer che contiene i comandi di rendering è pieno.</span><span class="sxs-lookup"><span data-stu-id="b4589-167">The buffer holding the rendering commands is full.</span></span> <span data-ttu-id="b4589-168">Se il buffer si riempie prima dell'evasione delle due condizioni precedenti, i comandi di rendering vengono scaricati.</span><span class="sxs-lookup"><span data-stu-id="b4589-168">If this buffer becomes full before the previous two conditions are fulfilled, the rendering commands are flushed out.</span></span>

<span data-ttu-id="b4589-169">Fino a quando le primitive non vengono scaricate, Direct2D mantiene i riferimenti interni a risorse corrispondenti, come bitmap e pennelli.</span><span class="sxs-lookup"><span data-stu-id="b4589-169">Until the primitives are flushed, Direct2D keeps internal references to corresponding resources like bitmaps and brushes.</span></span>

### <a name="reuse-resources"></a><span data-ttu-id="b4589-170">Riutilizza risorse</span><span class="sxs-lookup"><span data-stu-id="b4589-170">Reuse resources</span></span>

<span data-ttu-id="b4589-171">Come già indicato, la creazione e l'eliminazione di risorse sono costose sull'hardware.</span><span class="sxs-lookup"><span data-stu-id="b4589-171">As already mentioned, resource creation and deletion is expensive on hardware.</span></span> <span data-ttu-id="b4589-172">Quindi, riutilizzare le risorse quando possibile.</span><span class="sxs-lookup"><span data-stu-id="b4589-172">So reuse resources when possible.</span></span> <span data-ttu-id="b4589-173">Eseguire l'esempio di creazione di bitmap nello sviluppo di giochi.</span><span class="sxs-lookup"><span data-stu-id="b4589-173">Take the example of bitmap creation in game development.</span></span> <span data-ttu-id="b4589-174">In genere, le bitmap che compongono una scena in un gioco vengono create contemporaneamente con tutte le diverse varianti necessarie per il rendering frame-frame successivo.</span><span class="sxs-lookup"><span data-stu-id="b4589-174">Usually, bitmaps that make up a scene in a game are all created at the same time with all the different variations that are required for later frame-to-frame rendering.</span></span> <span data-ttu-id="b4589-175">Al momento del rendering e del nuovo rendering della scena effettiva, le bitmap vengono riutilizzate anziché ricreate.</span><span class="sxs-lookup"><span data-stu-id="b4589-175">At the time of actual scene rendering and re-rendering, these bitmaps are reused instead of re-created.</span></span>

> [!Note]  
> <span data-ttu-id="b4589-176">Non è possibile riutilizzare le risorse per l'operazione di ridimensionamento della finestra.</span><span class="sxs-lookup"><span data-stu-id="b4589-176">You can't reuse resources for the window resize operation.</span></span> <span data-ttu-id="b4589-177">Quando una finestra viene ridimensionata, è necessario ricreare alcune risorse dipendenti dalla scala, ad esempio destinazioni di rendering compatibili ed eventualmente alcune risorse di livello, perché il contenuto della finestra deve essere ridisegnato.</span><span class="sxs-lookup"><span data-stu-id="b4589-177">When a window is resized, some scale-dependent resources such as compatible render targets and possibly some layer resources must be re-created because the window content has to be redrawn.</span></span> <span data-ttu-id="b4589-178">Questo può essere importante per mantenere la qualità complessiva della scena di cui è stato eseguito il rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-178">This can be important for maintaining the overall quality of the rendered scene.</span></span>

 

## <a name="restrict-the-use-of-flush"></a><span data-ttu-id="b4589-179">Limita l'uso dello scaricamento</span><span class="sxs-lookup"><span data-stu-id="b4589-179">Restrict the use of flush</span></span>

<span data-ttu-id="b4589-180">Poiché il metodo [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) causa l'elaborazione dei comandi per il rendering in batch, è consigliabile non usarlo.</span><span class="sxs-lookup"><span data-stu-id="b4589-180">Because the [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) method causes the batched rendering commands to be processed, we recommend that you don't use it.</span></span> <span data-ttu-id="b4589-181">Per gli scenari più comuni, lasciare la gestione delle risorse a Direct2D.</span><span class="sxs-lookup"><span data-stu-id="b4589-181">For most common scenarios, leave resource management to Direct2D.</span></span>

## <a name="bitmaps"></a><span data-ttu-id="b4589-182">Bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-182">Bitmaps</span></span>

<span data-ttu-id="b4589-183">Come indicato in precedenza, la creazione e l'eliminazione di risorse sono operazioni molto costose nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="b4589-183">As mentioned earlier, resource creation and deletion are very expensive operations in hardware.</span></span> <span data-ttu-id="b4589-184">Una bitmap è un tipo di risorsa usata spesso.</span><span class="sxs-lookup"><span data-stu-id="b4589-184">A bitmap is a kind of resource that is used often.</span></span> <span data-ttu-id="b4589-185">La creazione di bitmap nella scheda video è dispendiosa.</span><span class="sxs-lookup"><span data-stu-id="b4589-185">Creating bitmaps on the video card is expensive.</span></span> <span data-ttu-id="b4589-186">Il riutilizzo consente di velocizzare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-186">Reusing them can help make the application faster.</span></span>

### <a name="create-large-bitmaps"></a><span data-ttu-id="b4589-187">Crea bitmap di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="b4589-187">Create large bitmaps</span></span>

<span data-ttu-id="b4589-188">Le schede video in genere hanno una dimensione minima di allocazione della memoria.</span><span class="sxs-lookup"><span data-stu-id="b4589-188">Video cards typically have a minimum memory allocation size.</span></span> <span data-ttu-id="b4589-189">Se viene richiesta un'allocazione di dimensioni minori, viene allocata una risorsa di questa dimensione minima e la memoria in eccedenza viene sprecata e non è disponibile per altri elementi.</span><span class="sxs-lookup"><span data-stu-id="b4589-189">If an allocation is requested that is smaller than this, a resource of this minimum size is allocated and the surplus memory is wasted and unavailable for other things.</span></span> <span data-ttu-id="b4589-190">Se sono necessarie molte piccole bitmap, una tecnica migliore consiste nell'allocazione di una bitmap di grandi dimensioni e nell'archiviazione di tutti i contenuti bitmap di dimensioni ridotte in questa bitmap di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-190">If you need many small bitmaps, a better technique is to allocate one large bitmap and store all the small bitmap contents in this large bitmap.</span></span> <span data-ttu-id="b4589-191">Quindi, le sottoaree della bitmap più grande possono essere lette laddove sono necessarie le bitmap più piccole.</span><span class="sxs-lookup"><span data-stu-id="b4589-191">Then subareas of the larger bitmap can be read where the smaller bitmaps are needed.</span></span> <span data-ttu-id="b4589-192">Spesso è necessario includere spaziatura interna (pixel neri trasparenti) tra le piccole bitmap per evitare qualsiasi interazione tra le immagini più piccole durante le operazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-192">Often, you should include padding (transparent black pixels) in between the small bitmaps to avoid any interaction between the smaller images during operations.</span></span> <span data-ttu-id="b4589-193">Si tratta anche di un *Atlante*, che offre il vantaggio di ridurre il sovraccarico della creazione di bitmap e lo spreco di memoria di piccole allocazioni bitmap.</span><span class="sxs-lookup"><span data-stu-id="b4589-193">This is also known as an *atlas*, and it has the benefit of reducing bitmap creation overhead and the memory waste of small bitmap allocations.</span></span> <span data-ttu-id="b4589-194">Si consiglia di ridurre la maggior parte delle bitmap ad almeno 64 KB e di limitare il numero di bitmap inferiori a 4 KB.</span><span class="sxs-lookup"><span data-stu-id="b4589-194">We recommend that you keep most bitmaps to at least 64 KB and limit the number of bitmaps that are smaller than 4 KB.</span></span>

### <a name="create-an-atlas-of-bitmaps"></a><span data-ttu-id="b4589-195">Creare un Atlante di bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-195">Create an atlas of bitmaps</span></span>

<span data-ttu-id="b4589-196">Esistono alcuni scenari comuni per i quali un Atlante bitmap può essere utilizzato molto bene.</span><span class="sxs-lookup"><span data-stu-id="b4589-196">There are some common scenarios for which a bitmap atlas can serve very well.</span></span> <span data-ttu-id="b4589-197">Le bitmap piccole possono essere archiviate all'interno di una bitmap di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-197">Small bitmaps can be stored inside a large bitmap.</span></span> <span data-ttu-id="b4589-198">Queste piccole bitmap possono essere estratte dalla bitmap più grande quando sono necessarie specificando il rettangolo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-198">These small bitmaps can be pulled out of the larger bitmap when you need them by specifying the destination rectangle.</span></span> <span data-ttu-id="b4589-199">Ad esempio, un'applicazione deve creare più icone.</span><span class="sxs-lookup"><span data-stu-id="b4589-199">For example, an application has to draw multiple icons.</span></span> <span data-ttu-id="b4589-200">Tutte le bitmap associate alle icone possono essere caricate in una bitmap di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-200">All the bitmaps associated with the icons can be loaded into a large bitmap up front.</span></span> <span data-ttu-id="b4589-201">E in fase di rendering, possono essere recuperati dalla bitmap di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-201">And at rendering time, they can be retrieved from the large bitmap.</span></span>

> [!Note]  
> <span data-ttu-id="b4589-202">Una bitmap Direct2D creata nella memoria video è limitata alla dimensione massima della bitmap supportata dall'adapter in cui è archiviata.</span><span class="sxs-lookup"><span data-stu-id="b4589-202">A Direct2D bitmap created in video memory is limited to the maximum bitmap size supported by the adapter on which it is stored.</span></span> <span data-ttu-id="b4589-203">La creazione di una bitmap di dimensioni superiori potrebbe causare un errore.</span><span class="sxs-lookup"><span data-stu-id="b4589-203">Creating a bitmap larger than that might result in an error.</span></span>

 

> [!Note]  
> <span data-ttu-id="b4589-204">A partire da Windows 8, Direct2D include un [effetto Atlas](atlas.md) che rende più semplice questo processo.</span><span class="sxs-lookup"><span data-stu-id="b4589-204">Starting in Windows 8, Direct2D includes an [Atlas effect](atlas.md) that can make this process easier.</span></span>

 

### <a name="create-shared-bitmaps"></a><span data-ttu-id="b4589-205">Crea bitmap condivise</span><span class="sxs-lookup"><span data-stu-id="b4589-205">Create shared bitmaps</span></span>

<span data-ttu-id="b4589-206">La creazione di bitmap condivise consente ai chiamanti avanzati di creare oggetti bitmap Direct2D supportati direttamente da un oggetto esistente, già compatibili con la destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-206">Creating shared bitmaps enables advanced callers to create Direct2D bitmap objects that are backed directly by an existing object, already compatible with the render target.</span></span> <span data-ttu-id="b4589-207">In questo modo si evita la creazione di più superfici e contribuisce a ridurre il sovraccarico delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-207">This avoids creating multiple surfaces and helps in reducing performance overhead.</span></span>

> [!Note]  
> <span data-ttu-id="b4589-208">Le bitmap condivise sono in genere limitate a destinazioni software o a destinazioni interoperabili con DXGI.</span><span class="sxs-lookup"><span data-stu-id="b4589-208">Shared bitmaps are usually limited to software targets or to targets interoperable with DXGI.</span></span> <span data-ttu-id="b4589-209">Usare i metodi [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))e [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) per creare bitmap condivise.</span><span class="sxs-lookup"><span data-stu-id="b4589-209">Use the [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) methods to create shared bitmaps.</span></span>

 

### <a name="copying-bitmaps"></a><span data-ttu-id="b4589-210">Copia di bitmap</span><span class="sxs-lookup"><span data-stu-id="b4589-210">Copying bitmaps</span></span>

<span data-ttu-id="b4589-211">La creazione di una superficie DXGI è un'operazione costosa, quindi riutilizzare le superfici esistenti quando possibile.</span><span class="sxs-lookup"><span data-stu-id="b4589-211">Creating a DXGI surface is an expensive operation so reuse existing surfaces when you can.</span></span> <span data-ttu-id="b4589-212">Anche nel software, se una bitmap è prevalentemente nel formato desiderato, ad eccezione di una piccola parte, è preferibile aggiornare tale porzione anziché generare l'intera bitmap e ricreare tutti gli elementi.</span><span class="sxs-lookup"><span data-stu-id="b4589-212">Even in software, if a bitmap is mostly in the form you want except for a small portion, it is better to update that portion than to throw the whole bitmap away and re-create everything.</span></span> <span data-ttu-id="b4589-213">Sebbene sia possibile usare [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) per ottenere gli stessi risultati, il rendering è in genere un'operazione molto più costosa rispetto alla copia.</span><span class="sxs-lookup"><span data-stu-id="b4589-213">Although you can use [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) to achieve the same results, rendering is generally a much more expensive operation than copying.</span></span> <span data-ttu-id="b4589-214">Questo perché, per migliorare la località della cache, l'hardware non archivia effettivamente una bitmap nello stesso ordine di memoria in cui viene indirizzata la bitmap.</span><span class="sxs-lookup"><span data-stu-id="b4589-214">This is because, to improve cache locality, the hardware doesn't actually store a bitmap in the same memory order that the bitmap is addressed.</span></span> <span data-ttu-id="b4589-215">Al contrario, la bitmap potrebbe essere swizzled.</span><span class="sxs-lookup"><span data-stu-id="b4589-215">Instead, the bitmap might be swizzled.</span></span> <span data-ttu-id="b4589-216">Il swizzling è nascosto dalla CPU dal driver (lento e usato solo sulle parti di fascia inferiore) o dal gestore della memoria sulla GPU.</span><span class="sxs-lookup"><span data-stu-id="b4589-216">The swizzling is hidden from the CPU either by the driver (which is slow and used only on lower-end parts), or by the memory manager on the GPU.</span></span> <span data-ttu-id="b4589-217">A causa dei vincoli sul modo in cui i dati vengono scritti in una destinazione di rendering durante il rendering, le destinazioni di rendering non sono in genere swizzled o swizzled in modo che sia meno ottimale di quanto possa essere raggiunto se si è certi che non è mai necessario eseguire il rendering sulla superficie.</span><span class="sxs-lookup"><span data-stu-id="b4589-217">Because of constraints on how data is written into a render target when rendering, render targets are typically either not swizzled, or swizzled in a way that is less optimal than can be achieved if you know that you never have to render to the surface.</span></span> <span data-ttu-id="b4589-218">Pertanto, [](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap) \* vengono forniti i metodi CopyFrom per la copia di rettangoli da un'origine alla bitmap Direct2D.</span><span class="sxs-lookup"><span data-stu-id="b4589-218">Therefore, the [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap)\* methods are provided for copying rectangles from a source to the Direct2D bitmap.</span></span>

<span data-ttu-id="b4589-219">CopyFrom può essere utilizzato in uno dei tre formati seguenti:</span><span class="sxs-lookup"><span data-stu-id="b4589-219">CopyFrom can be used in any of its three forms:</span></span>

-   [<span data-ttu-id="b4589-220">**CopyFromBitmap**</span><span class="sxs-lookup"><span data-stu-id="b4589-220">**CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="b4589-221">**CopyFromRenderTarget**</span><span class="sxs-lookup"><span data-stu-id="b4589-221">**CopyFromRenderTarget**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfromrendertarget)
-   [<span data-ttu-id="b4589-222">**CopyFromMemory**</span><span class="sxs-lookup"><span data-stu-id="b4589-222">**CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)

## <a name="use-tiled-bitmap-over-dashing"></a><span data-ttu-id="b4589-223">Usa la bitmap affiancata su trattino</span><span class="sxs-lookup"><span data-stu-id="b4589-223">Use tiled bitmap over dashing</span></span>

<span data-ttu-id="b4589-224">Il rendering di una linea tratteggiata è un'operazione molto costosa a causa dell'elevata qualità e accuratezza dell'algoritmo sottostante.</span><span class="sxs-lookup"><span data-stu-id="b4589-224">Rendering a dashed line is a very expensive operation because of the high quality and accuracy of the underlying algorithm.</span></span> <span data-ttu-id="b4589-225">Per la maggior parte dei casi che non coinvolgono geometrie rettilinee, lo stesso effetto può essere generato più velocemente usando bitmap affiancate.</span><span class="sxs-lookup"><span data-stu-id="b4589-225">For most of the cases not involving rectilinear geometries, the same effect can be generated faster by using tiled bitmaps.</span></span>

## <a name="general-guidelines-for-rendering-complex-static-content"></a><span data-ttu-id="b4589-226">Linee guida generali per il rendering di contenuto statico complesso</span><span class="sxs-lookup"><span data-stu-id="b4589-226">General guidelines for rendering complex static content</span></span>

<span data-ttu-id="b4589-227">Memorizza nella cache il contenuto se si esegue il rendering dello stesso frame di contenuto sul frame, soprattutto quando la scena è complessa.</span><span class="sxs-lookup"><span data-stu-id="b4589-227">Cache content if you render the same content frame over frame, especially when the scene is complex.</span></span>

<span data-ttu-id="b4589-228">Sono disponibili tre tecniche di Caching che è possibile usare:</span><span class="sxs-lookup"><span data-stu-id="b4589-228">There are three caching techniques that you can use:</span></span>

-   <span data-ttu-id="b4589-229">Memorizzazione nella cache completa della scena utilizzando una bitmap a colori.</span><span class="sxs-lookup"><span data-stu-id="b4589-229">Full scene caching using a color bitmap.</span></span>
-   <span data-ttu-id="b4589-230">Per la memorizzazione nella cache primitiva con una bitmap a8 e il metodo [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) .</span><span class="sxs-lookup"><span data-stu-id="b4589-230">Per primitive caching using an A8 bitmap and the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) method.</span></span>
-   <span data-ttu-id="b4589-231">Caching per primitive con le realizzazioni di geometria.</span><span class="sxs-lookup"><span data-stu-id="b4589-231">Per-primitive caching using geometry realizations.</span></span>

<span data-ttu-id="b4589-232">Esaminiamo ognuna di queste informazioni in modo più dettagliato.</span><span class="sxs-lookup"><span data-stu-id="b4589-232">Let's look at each of these in more detail.</span></span>

### <a name="full-scene-caching-using-a-color-bitmap"></a><span data-ttu-id="b4589-233">Memorizzazione nella cache completa della scena utilizzando una bitmap a colori</span><span class="sxs-lookup"><span data-stu-id="b4589-233">Full scene caching using a color bitmap</span></span>

<span data-ttu-id="b4589-234">Quando si esegue il rendering di contenuto statico, in scenari come l'animazione, creare un'altra bitmap a colori completi anziché scrivere direttamente nella bitmap dello schermo.</span><span class="sxs-lookup"><span data-stu-id="b4589-234">When you render static content, in scenarios like animation, create another full color bitmap instead of writing directly to the screen bitmap.</span></span> <span data-ttu-id="b4589-235">Salvare la destinazione corrente, impostare la destinazione sulla bitmap intermedia ed eseguire il rendering del contenuto statico.</span><span class="sxs-lookup"><span data-stu-id="b4589-235">Save the current target, set target to the intermediate bitmap, and render the static content.</span></span> <span data-ttu-id="b4589-236">Tornare quindi alla bitmap della schermata originale e creare la bitmap intermedia.</span><span class="sxs-lookup"><span data-stu-id="b4589-236">Then, switch back to the original screen bitmap and draw the intermediate bitmap on it.</span></span>

<span data-ttu-id="b4589-237">Ecco un esempio:</span><span class="sxs-lookup"><span data-stu-id="b4589-237">Here's an example:</span></span>


```C++
// Create a bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_B8G8R8A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &sceneBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render static content to the sceneBitmap.
m_d2dContext->SetTarget(sceneBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Render sceneBitmap to oldTarget.
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->DrawBitmap(sceneBitmap.Get());
```



<span data-ttu-id="b4589-238">Questo esempio USA bitmap intermedie per la memorizzazione nella cache e passa la bitmap a cui punta il contesto di dispositivo durante il rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-238">This example uses intermediate bitmaps for caching and switches the bitmap that the device context points to when it renders.</span></span> <span data-ttu-id="b4589-239">In questo modo si evita la necessità di creare una destinazione di rendering compatibile per lo stesso scopo.</span><span class="sxs-lookup"><span data-stu-id="b4589-239">This avoids the need to create a compatible render target for the same purpose.</span></span>

### <a name="per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method"></a><span data-ttu-id="b4589-240">Per la memorizzazione nella cache primitiva con una bitmap a8 e il metodo FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="b4589-240">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>

<span data-ttu-id="b4589-241">Quando la scena completa non è statica, ma è costituita da elementi come la geometria o il testo statici, è possibile usare una tecnica per la memorizzazione nella cache primitiva.</span><span class="sxs-lookup"><span data-stu-id="b4589-241">When the full scene is not static, but consists of elements like geometry or text that are static, you can use a per primitive caching technique.</span></span> <span data-ttu-id="b4589-242">Questa tecnica conserva le caratteristiche di anti-aliasing della primitiva che viene memorizzata nella cache e funziona con la modifica dei tipi di pennello.</span><span class="sxs-lookup"><span data-stu-id="b4589-242">This technique preserves the antialiasing characteristics of the primitive being cached and works with changing brush types.</span></span> <span data-ttu-id="b4589-243">Usa una bitmap a8 dove a8 è un tipo di formato pixel che rappresenta un canale alfa con 8 bit.</span><span class="sxs-lookup"><span data-stu-id="b4589-243">It uses an A8 bitmap where A8 is a kind of pixel format which represents an alpha channel with 8 bits.</span></span> <span data-ttu-id="b4589-244">Le bitmap a8 sono utili per disegnare geometria/testo come maschera.</span><span class="sxs-lookup"><span data-stu-id="b4589-244">A8 bitmaps are useful for drawing geometry/text as a mask.</span></span> <span data-ttu-id="b4589-245">Quando è necessario modificare l'opacità del contenuto statico, anziché modificare il contenuto stesso, è possibile tradurre, ruotare, inclinare o ridimensionare l'opacità della maschera.</span><span class="sxs-lookup"><span data-stu-id="b4589-245">When you must manipulate the opacity of static content , instead of manipulating the content itself, you can translate, rotate, skew, or scale the opacity of the mask.</span></span>

<span data-ttu-id="b4589-246">Ecco un esempio:</span><span class="sxs-lookup"><span data-stu-id="b4589-246">Here's an example:</span></span>


```C++
// Create an opacity bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render to the opacityBitmap.
m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Call the FillOpacityMask method
// Note: for this call to work correctly the anti alias mode must be D2D1_ANTIALIAS_MODE_ALIASED. 
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->FillOpacityMask(
    opacityBitmap.Get(),
    m_contentBrush().Get(),
    D2D1_OPACITY_MASK_CONTENT_GRAPHICS);
```



## <a name="per-primitive-caching-using-geometry-realizations"></a><span data-ttu-id="b4589-247">Caching per primitive con le realizzazioni di geometria</span><span class="sxs-lookup"><span data-stu-id="b4589-247">Per-primitive caching using geometry realizations</span></span>

<span data-ttu-id="b4589-248">Un'altra tecnica di memorizzazione nella cache per primitiva, denominata realizzazioni di geometria, offre una maggiore flessibilità nella gestione della geometria.</span><span class="sxs-lookup"><span data-stu-id="b4589-248">Another per-primitive caching technique, called geometry realizations, provides greater flexibility when dealing with geometry.</span></span> <span data-ttu-id="b4589-249">Quando si desidera creare ripetutamente le geometrie con alias o con alias, è più veloce convertirle in realizzazioni di geometria e creare ripetutamente le realizzazioni rispetto a quelle per creare ripetutamente le geometrie.</span><span class="sxs-lookup"><span data-stu-id="b4589-249">When you want to repeatedly draw aliased or anti-aliased geometries, it is faster to convert them to geometry realizations and repeatedly draw the realizations than it is to repeatedly draw the geometries themselves.</span></span> <span data-ttu-id="b4589-250">Anche le realizzazioni di geometria utilizzano in genere meno memoria rispetto alle maschere di opacità (soprattutto per geometrie di grandi dimensioni) e sono meno sensibili alle modifiche della scala.</span><span class="sxs-lookup"><span data-stu-id="b4589-250">Geometry realizations also generally consume less memory than opacity masks (especially for large geometries), and they are less sensitive to changes in scale.</span></span> <span data-ttu-id="b4589-251">Per altre informazioni, vedere [Cenni preliminari sulle realizzazioni di geometria](geometry-realizations-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b4589-251">For more information, see [Geometry Realizations Overview](geometry-realizations-overview.md).</span></span>

<span data-ttu-id="b4589-252">Ecco un esempio:</span><span class="sxs-lookup"><span data-stu-id="b4589-252">Here's an example:</span></span>


```C++
    // Compute a flattening tolerance based on the scales at which the realization will be used.
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(...);

    ComPtr<ID2D1GeometryRealization> geometryRealization;

    // Create realization of the filled interior of the geometry.
    m_d2dDeviceContext1->CreateFilledGeometryRealization(
        geometry.Get(),
        flatteningTolerance,
        &geometryRealization
        );

    // In your app's rendering code, draw the geometry realization with a brush.
    m_d2dDeviceContext1->BeginDraw();
    m_d2dDeviceContext1->DrawGeometryRealization(
        geometryRealization.Get(),
        m_brush.Get()
        );
    m_d2dDeviceContext1->EndDraw();
```



## <a name="geometry-rendering"></a><span data-ttu-id="b4589-253">Rendering Geometry</span><span class="sxs-lookup"><span data-stu-id="b4589-253">Geometry rendering</span></span>

### <a name="use-specific-draw-primitive-over-draw-geometry"></a><span data-ttu-id="b4589-254">Usa una primitiva di estrazione specifica sulla geometria di tipo</span><span class="sxs-lookup"><span data-stu-id="b4589-254">Use specific draw primitive over draw geometry</span></span>

<span data-ttu-id="b4589-255">Usare chiamate *primitive* di estrazione più specifiche come [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) su chiamate [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) generiche.</span><span class="sxs-lookup"><span data-stu-id="b4589-255">Use more specific draw *primitive* calls like [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) over generic [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) calls.</span></span> <span data-ttu-id="b4589-256">Questo è dovuto al fatto che, con **DrawRectangle**, la geometria è già nota, quindi il rendering è più veloce.</span><span class="sxs-lookup"><span data-stu-id="b4589-256">This is because with **DrawRectangle**, the geometry is already known so rendering is faster.</span></span>

### <a name="rendering-static-geometry"></a><span data-ttu-id="b4589-257">Rendering della geometria statica</span><span class="sxs-lookup"><span data-stu-id="b4589-257">Rendering static geometry</span></span>

<span data-ttu-id="b4589-258">Negli scenari in cui la geometria è statica, usare le tecniche di memorizzazione nella cache per primitive descritte in precedenza.</span><span class="sxs-lookup"><span data-stu-id="b4589-258">In scenarios where the geometry is static, use the per-primitive caching techniques explained above.</span></span> <span data-ttu-id="b4589-259">Le maschere di opacità e le realizzazioni di geometria possono migliorare significativamente la velocità di rendering delle scene che contengono la geometria statica.</span><span class="sxs-lookup"><span data-stu-id="b4589-259">Opacity masks and geometry realizations can greatly improve the rendering speed of scenes that contain static geometry..</span></span>

### <a name="use-a-multithreaded-device-context"></a><span data-ttu-id="b4589-260">Usare un contesto di dispositivo multithread</span><span class="sxs-lookup"><span data-stu-id="b4589-260">Use a multithreaded device context</span></span>

<span data-ttu-id="b4589-261">Le applicazioni che prevedono di eseguire il rendering di quantità significative di contenuto geometrico complesso devono considerare la possibilità di specificare le [**Opzioni del contesto di dispositivo d2d1 Abilita il flag di \_ \_ \_ \_ \_ \_ \_ ottimizzazione**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) multithread quando si crea un contesto di dispositivo [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="b4589-261">Applications that expect to render significant amounts of complex geometric content should consider specifying the [**D2D1\_DEVICE\_CONTEXT\_OPTIONS\_ENABLE\_MULTI\_THREADED\_OPTIMIZATIONS**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) flag when creating a [Direct2D](./direct2d-portal.md) device context.</span></span> <span data-ttu-id="b4589-262">Quando si specifica questo flag, Direct2D distribuisce il rendering in tutti i core logici presenti nel sistema, che possono ridurre significativamente il tempo di rendering complessivo.</span><span class="sxs-lookup"><span data-stu-id="b4589-262">When this flag is specified, Direct2D will distribute rendering across all of the logical cores present on the system, which can significantly decrease overall rendering time.</span></span>

<span data-ttu-id="b4589-263">Note:</span><span class="sxs-lookup"><span data-stu-id="b4589-263">Notes:</span></span>

-   <span data-ttu-id="b4589-264">A partire da Windows 8.1, questo flag influiscono solo sul rendering della geometria del percorso.</span><span class="sxs-lookup"><span data-stu-id="b4589-264">As of Windows 8.1, this flag only affects path geometry rendering.</span></span> <span data-ttu-id="b4589-265">Non ha alcun effetto sulle scene contenenti solo altri tipi primitivi, ad esempio testo, bitmap o realizzazioni di geometria.</span><span class="sxs-lookup"><span data-stu-id="b4589-265">It has no impact on scenes containing only other primitive types (such as text, bitmaps, or geometry realizations).</span></span>
-   <span data-ttu-id="b4589-266">Questo flag non ha alcun effetto anche quando viene eseguito il rendering nel software, ad esempio quando viene eseguito il rendering con un dispositivo Direct3D WARP.</span><span class="sxs-lookup"><span data-stu-id="b4589-266">This flag also has no impact when rendering in software (i.e. when rendering with a WARP Direct3D device).</span></span> <span data-ttu-id="b4589-267">Per controllare il multithreading del software, i chiamanti devono usare D3D11 \_ Create \_ Device per impedire l' \_ \_ \_ ottimizzazione del threading interno \_ quando si crea il dispositivo Direct3D Warp.</span><span class="sxs-lookup"><span data-stu-id="b4589-267">To control software multithreading, callers should use the D3D11\_CREATE\_DEVICE\_PREVENT\_INTERNAL\_THREADING\_OPTIMIZATIONS flag when creating the WARP Direct3D device.</span></span>
-   <span data-ttu-id="b4589-268">La specifica di questo flag può aumentare la working set di picco durante il rendering e può anche aumentare la contesa di thread nelle applicazioni che già sfruttano l'elaborazione multithreading.</span><span class="sxs-lookup"><span data-stu-id="b4589-268">Specifying this flag can increase peak working set during rendering and can also increase thread contention in applications that already take advantage of multithreaded processing.</span></span>

## <a name="drawing-text-with-direct2d"></a><span data-ttu-id="b4589-269">Disegno di testo con Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-269">Drawing text with Direct2D</span></span>

<span data-ttu-id="b4589-270">La funzionalità di rendering del testo Direct2D è disponibile in due parti.</span><span class="sxs-lookup"><span data-stu-id="b4589-270">Direct2D text rendering functionality is offered in two parts.</span></span> <span data-ttu-id="b4589-271">La prima parte, esposta come metodo [**ID2D1RenderTarget::D rawtext**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) e [**ID2D1RenderTarget::D rawtextlayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) , consente a un chiamante di passare una stringa e i parametri di formattazione oppure un oggetto di layout di testo DWrite per più formati.</span><span class="sxs-lookup"><span data-stu-id="b4589-271">The first part, exposed as the [**ID2D1RenderTarget::DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**ID2D1RenderTarget::DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) method, enables a caller to pass either a string and formatting parameters or a DWrite text layout object for multiple formats.</span></span> <span data-ttu-id="b4589-272">Questo deve essere adatto per la maggior parte dei chiamanti.</span><span class="sxs-lookup"><span data-stu-id="b4589-272">This should be suitable for most callers.</span></span> <span data-ttu-id="b4589-273">Il secondo modo per eseguire il rendering del testo, esposto come metodo [**ID2D1RenderTarget::D rawglyphrun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) , fornisce la rasterizzazione per i clienti che conoscono già la posizione dei glifi di cui si vuole eseguire il rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-273">The second way to render text, exposed as the [**ID2D1RenderTarget::DrawGlyphRun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) method, provides rasterization for customers who already know the position of the glyphs they want to render.</span></span> <span data-ttu-id="b4589-274">Le due regole generali seguenti consentono di migliorare le prestazioni del testo durante il disegno in Direct2D.</span><span class="sxs-lookup"><span data-stu-id="b4589-274">The following two general rules can help improve text performance when drawing in Direct2D.</span></span>

### <a name="drawtextlayout-vs-drawtext"></a><span data-ttu-id="b4589-275">Confronto tra DrawTextLayout e DrawText</span><span class="sxs-lookup"><span data-stu-id="b4589-275">DrawTextLayout Vs. DrawText</span></span>

<span data-ttu-id="b4589-276">Sia [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) che [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) consentono a un'applicazione di eseguire facilmente il rendering del testo formattato dall'API [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) .</span><span class="sxs-lookup"><span data-stu-id="b4589-276">Both [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) enable an application to easily render text that is formatted by the [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) API.</span></span> <span data-ttu-id="b4589-277">**DrawTextLayout** disegna un oggetto [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) esistente in [**renderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget)e **DrawText** costruisce un layout DirectWrite per il chiamante, in base ai parametri passati.</span><span class="sxs-lookup"><span data-stu-id="b4589-277">**DrawTextLayout** draws an existing [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) object to the [**RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), and **DrawText** constructs a DirectWrite layout for the caller, based on the parameters that are passed in.</span></span> <span data-ttu-id="b4589-278">Se è necessario eseguire il rendering dello stesso testo più volte, utilizzare **DrawTextLayout** invece di **DrawText**, perché **DrawText** crea un layout ogni volta che viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="b4589-278">If the same text has to be rendered multiple times, use **DrawTextLayout** instead of **DrawText**, because **DrawText** creates a layout every time that it is called.</span></span>

### <a name="choosing-the-right-text-rendering-mode"></a><span data-ttu-id="b4589-279">Scelta della modalità di rendering del testo corretta</span><span class="sxs-lookup"><span data-stu-id="b4589-279">Choosing the right text rendering mode</span></span>

<span data-ttu-id="b4589-280">Impostare la modalità antialias del testo su [**d2d1 \_ Text \_ antialias \_ mode \_**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="b4589-280">Set the text antialias mode to [**D2D1\_TEXT\_ANTIALIAS\_MODE\_GRAYSCALE**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitly.</span></span> <span data-ttu-id="b4589-281">La qualità del rendering del testo in scala di grigi è paragonabile a ClearType ma è molto più veloce.</span><span class="sxs-lookup"><span data-stu-id="b4589-281">The quality of rendering grayscale text is comparable to ClearType but is much faster.</span></span>

### <a name="caching"></a><span data-ttu-id="b4589-282">Memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="b4589-282">Caching</span></span>

<span data-ttu-id="b4589-283">Usare la scena completa o la memorizzazione nella cache di bitmap primitive, come per il disegno di altre primitive.</span><span class="sxs-lookup"><span data-stu-id="b4589-283">Use full scene or per primitive bitmap caching like with drawing other primitives.</span></span>

## <a name="clipping-an-arbitrary-shape"></a><span data-ttu-id="b4589-284">Ritaglio di una forma arbitraria</span><span class="sxs-lookup"><span data-stu-id="b4589-284">Clipping an arbitrary shape</span></span>

<span data-ttu-id="b4589-285">La figura seguente mostra il risultato dell'applicazione di una clip a un'immagine.</span><span class="sxs-lookup"><span data-stu-id="b4589-285">The figure here shows the result of applying a clip to an image.</span></span>

![immagine che mostra un esempio di immagine prima e dopo un clip.](images/clip.png)

<span data-ttu-id="b4589-287">È possibile ottenere questo risultato usando i livelli con una maschera di geometria o il metodo [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) con un pennello di opacità.</span><span class="sxs-lookup"><span data-stu-id="b4589-287">You can get this result by using layers with a geometry mask or the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method with an opacity brush.</span></span>

<span data-ttu-id="b4589-288">Di seguito è riportato un esempio che usa un livello:</span><span class="sxs-lookup"><span data-stu-id="b4589-288">Here's an example that uses a layer:</span></span>


```C++
// Call PushLayer() and pass in the clipping geometry.
m_d2dContext->PushLayer(
    D2D1::LayerParameters(
        boundsRect,
        geometricMask));
```



<span data-ttu-id="b4589-289">Di seguito è riportato un esempio che usa il metodo [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) :</span><span class="sxs-lookup"><span data-stu-id="b4589-289">Here's an example that uses the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method:</span></span>


```C++
// Create an opacity bitmap and render content.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Create an opacity brush from the opacity bitmap.
m_d2dContext->CreateBitmapBrush(opacityBitmap.Get(),
    D2D1::BitmapBrushProperties(),
    D2D1::BrushProperties(),
    &bitmapBrush);

// Call the FillGeometry method and pass in the clip geometry and the opacity brush
m_d2dContext->FillGeometry( 
    clipGeometry.Get(),
    brush.Get(),
    opacityBrush.Get()); 
```



<span data-ttu-id="b4589-290">In questo esempio di codice, quando si chiama il metodo PushLayer, non si passa un livello creato dall'app.</span><span class="sxs-lookup"><span data-stu-id="b4589-290">In this code example, when you call the PushLayer method, you don't pass in an app created layer.</span></span> <span data-ttu-id="b4589-291">Direct2D crea automaticamente un livello.</span><span class="sxs-lookup"><span data-stu-id="b4589-291">Direct2D creates a layer for you.</span></span> <span data-ttu-id="b4589-292">Direct2D è in grado di gestire l'allocazione e l'eliminazione di questa risorsa senza alcun intervento da parte dell'app.</span><span class="sxs-lookup"><span data-stu-id="b4589-292">Direct2D is able to manage the allocation and destruction of this resource without any involvement from the app.</span></span> <span data-ttu-id="b4589-293">Questo consente a Direct2D di riutilizzare i livelli internamente e di applicare le ottimizzazioni di gestione delle risorse.</span><span class="sxs-lookup"><span data-stu-id="b4589-293">This allows Direct2D to reuse layers internally and apply resource management optimizations.</span></span>

<span data-ttu-id="b4589-294">In Windows 8 sono state apportate numerose ottimizzazioni all'utilizzo dei livelli ed è consigliabile provare a usare le API di livello anziché [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) quando possibile.</span><span class="sxs-lookup"><span data-stu-id="b4589-294">In Windows 8 many optimizations have been made to the usage of layers and we recommend you try using layer APIs instead of [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) whenever possible.</span></span>

### <a name="pushlayer-in-windows-8"></a><span data-ttu-id="b4589-295">PushLayer in Windows 8</span><span class="sxs-lookup"><span data-stu-id="b4589-295">PushLayer in Windows 8</span></span>

<span data-ttu-id="b4589-296">L'interfaccia [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) è derivata dall'interfaccia [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) ed è fondamentale per visualizzare il contenuto Direct2D in Windows 8. per ulteriori informazioni su questa interfaccia, vedere [dispositivi e contesti di dispositivo](devices-and-device-contexts.md).</span><span class="sxs-lookup"><span data-stu-id="b4589-296">The [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) interface is derived from the [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) interface and is key to displaying Direct2D content in Windows 8, for more information about this interface see [Devices and Device Contexts](devices-and-device-contexts.md).</span></span> <span data-ttu-id="b4589-297">Con l'interfaccia del contesto di dispositivo, è possibile ignorare la chiamata al metodo [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) e quindi passare null al metodo [**ID2D1DeviceContext::P ushlayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) .</span><span class="sxs-lookup"><span data-stu-id="b4589-297">With the device context interface, you can skip calling the [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) method and then pass NULL to the [**ID2D1DeviceContext::PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) method.</span></span> <span data-ttu-id="b4589-298">Direct2D gestisce automaticamente la risorsa livello e può condividere le risorse tra i livelli e i grafici degli effetti.</span><span class="sxs-lookup"><span data-stu-id="b4589-298">Direct2D automatically manages the layer resource and can share resources between layers and effect graphs.</span></span>

### <a name="axis-aligned-clips"></a><span data-ttu-id="b4589-299">Clip allineate asse</span><span class="sxs-lookup"><span data-stu-id="b4589-299">Axis-aligned clips</span></span>

<span data-ttu-id="b4589-300">Se l'area da ritagliare è allineata all'asse della superficie di disegno, anziché arbitraria.</span><span class="sxs-lookup"><span data-stu-id="b4589-300">If the region to be clipped is aligned to the axis of the drawing surface, instead of arbitrary.</span></span> <span data-ttu-id="b4589-301">Questo caso è adatto per l'utilizzo di un rettangolo di ritaglio anziché di un livello.</span><span class="sxs-lookup"><span data-stu-id="b4589-301">This case is suited for using a clip rectangle instead of a layer.</span></span> <span data-ttu-id="b4589-302">Il miglioramento delle prestazioni è maggiore per la geometria con alias rispetto alla geometria con alias.</span><span class="sxs-lookup"><span data-stu-id="b4589-302">The performance gain is more for aliased geometry than antialiased geometry.</span></span> <span data-ttu-id="b4589-303">Per altre informazioni sulle clip allineate asse, vedere l'argomento [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) .</span><span class="sxs-lookup"><span data-stu-id="b4589-303">For more info on axis aligned clips, see the [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) topic.</span></span>

## <a name="dxgi-interoperability-avoid-frequent-switches"></a><span data-ttu-id="b4589-304">Interoperabilità DXGI: evitare cambi frequenti</span><span class="sxs-lookup"><span data-stu-id="b4589-304">DXGI interoperability: avoid frequent switches</span></span>

<span data-ttu-id="b4589-305">Direct2D può interagire senza interruzioni con le superfici Direct3D.</span><span class="sxs-lookup"><span data-stu-id="b4589-305">Direct2D can interoperate seamlessly with Direct3D surfaces.</span></span> <span data-ttu-id="b4589-306">Questa operazione è molto utile per la creazione di applicazioni che eseguono il rendering di una combinazione di contenuto 2D e 3D.</span><span class="sxs-lookup"><span data-stu-id="b4589-306">This is very useful for creating applications that render a mixture of 2D and 3D content.</span></span> <span data-ttu-id="b4589-307">Tuttavia, ogni passaggio tra il disegno del contenuto Direct2D e Direct3D influiscono sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-307">But each switch between drawing Direct2D and Direct3D content affects performance.</span></span>

<span data-ttu-id="b4589-308">Quando si esegue il rendering in una superficie DXGI, Direct2D Salva lo stato dei dispositivi Direct3D durante il rendering e il ripristino quando il rendering viene completato.</span><span class="sxs-lookup"><span data-stu-id="b4589-308">When rendering to a DXGI surface, Direct2D saves the state of the Direct3D devices while rendering and restores it when rendering is completed.</span></span> <span data-ttu-id="b4589-309">Ogni volta che viene completato un batch di rendering Direct2D, il costo di questo salvataggio e ripristino e il costo di scaricamento di tutte le operazioni 2D vengono pagati, ma il dispositivo Direct3D non viene scaricato.</span><span class="sxs-lookup"><span data-stu-id="b4589-309">Every time that a batch of Direct2D rendering is completed, the cost of this save and restore and the cost of flushing all the 2D operations are paid, and yet, the Direct3D device is not flushed.</span></span> <span data-ttu-id="b4589-310">Pertanto, per aumentare le prestazioni, limitare il numero di commutazioni di rendering tra Direct2D e Direct3D.</span><span class="sxs-lookup"><span data-stu-id="b4589-310">Therefore, to increase performance, limit the number of rendering switches between Direct2D and Direct3D.</span></span>

## <a name="know-your-pixel-format"></a><span data-ttu-id="b4589-311">Conosce il formato pixel</span><span class="sxs-lookup"><span data-stu-id="b4589-311">Know Your Pixel Format</span></span>

<span data-ttu-id="b4589-312">Quando si crea una destinazione di rendering, è possibile usare la struttura del [**\_ \_ formato pixel d2d1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) per specificare il formato pixel e la modalità Alpha usati dalla destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-312">When you create a render target, you can use the [**D2D1\_PIXEL\_FORMAT**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) structure specify the pixel format and alpha mode used by the render target.</span></span> <span data-ttu-id="b4589-313">Un canale alfa fa parte del formato pixel che specifica il valore di code coverage o le informazioni sull'opacità.</span><span class="sxs-lookup"><span data-stu-id="b4589-313">An alpha channel is part of the pixel format that specifies the coverage value or opacity information.</span></span> <span data-ttu-id="b4589-314">Se una destinazione di rendering non usa il canale alfa, è necessario crearla usando la [**modalità d2d1 \_ Alpha \_ \_ Ignore**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) la modalità Alpha.</span><span class="sxs-lookup"><span data-stu-id="b4589-314">If a render target does not use the alpha channel, it should be created by using the [**D2D1\_ALPHA\_MODE\_IGNORE**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) alpha mode.</span></span> <span data-ttu-id="b4589-315">In questo modo viene risparmiato il tempo impiegato per il rendering di un canale alfa non necessario.</span><span class="sxs-lookup"><span data-stu-id="b4589-315">This spares the time that is spent on rendering an alpha channel that is not needed.</span></span>

<span data-ttu-id="b4589-316">Per ulteriori informazioni sui formati pixel e sulle modalità Alpha, vedere [formati pixel supportati e modalità Alpha](supported-pixel-formats-and-alpha-modes.md).</span><span class="sxs-lookup"><span data-stu-id="b4589-316">For more information about pixel formats and alpha modes, see [Supported Pixel Formats and Alpha Modes](supported-pixel-formats-and-alpha-modes.md).</span></span>

## <a name="scene-complexity"></a><span data-ttu-id="b4589-317">Complessità della scena</span><span class="sxs-lookup"><span data-stu-id="b4589-317">Scene Complexity</span></span>

<span data-ttu-id="b4589-318">Quando si analizzano le aree sensibili delle prestazioni in una scena che verrà sottoposta a rendering, sapere se la scena è associata a una velocità di riempimento o un limite di vertici può fornire informazioni utili.</span><span class="sxs-lookup"><span data-stu-id="b4589-318">When you analyze performance hot spots in a scene that will be rendered, knowing whether the scene is fill-rate bound or vertex bound can provide useful information.</span></span>

-   <span data-ttu-id="b4589-319">Velocità di riempimento: la velocità di riempimento si riferisce al numero di pixel per cui una scheda grafica può eseguire il rendering e scrivere nella memoria video al secondo.</span><span class="sxs-lookup"><span data-stu-id="b4589-319">Fill Rate: Fill rate refers to the number of pixels that a graphics card can render and write to video memory per second.</span></span>
-   <span data-ttu-id="b4589-320">Limite di vertici: una scena è associata ai vertici quando contiene molti Geometry complessi.</span><span class="sxs-lookup"><span data-stu-id="b4589-320">Vertex Bound: A scene is vertex bound when it contains lots of complex geometry.</span></span>

### <a name="understand-scene-complexity"></a><span data-ttu-id="b4589-321">Comprendere la complessità della scena</span><span class="sxs-lookup"><span data-stu-id="b4589-321">Understand Scene Complexity</span></span>

<span data-ttu-id="b4589-322">È possibile analizzare la complessità della scena modificando la dimensione della destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-322">You can analyze your scene complexity by altering the size of the render target.</span></span> <span data-ttu-id="b4589-323">Se il miglioramento delle prestazioni è visibile per una riduzione proporzionale della destinazione di rendering, l'applicazione è associata a una velocità di riempimento.</span><span class="sxs-lookup"><span data-stu-id="b4589-323">If performance gains are visible for a proportional reduction in size of the render target, then the application is fill-rate bound.</span></span> <span data-ttu-id="b4589-324">In caso contrario, la complessità della scena rappresenta il collo di bottiglia delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-324">Otherwise, the scene complexity is the performance bottleneck.</span></span>

<span data-ttu-id="b4589-325">Quando una scena è associata a una velocità di riempimento, la riduzione delle dimensioni della destinazione di rendering può migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-325">When a scene is fill-rate bound, reducing the size of the render target can improve the performance.</span></span> <span data-ttu-id="b4589-326">Questo perché il numero di pixel di cui eseguire il rendering viene ridotto proporzionalmente alle dimensioni della destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="b4589-326">This is because the number of pixels to be rendered will be reduced proportionally with the size of the render target.</span></span>

<span data-ttu-id="b4589-327">Quando una scena è associata al vertice, ridurre la complessità della geometria.</span><span class="sxs-lookup"><span data-stu-id="b4589-327">When a scene is vertex bound, reduce the complexity of the geometry.</span></span> <span data-ttu-id="b4589-328">Tuttavia, tenere presente che questa operazione viene eseguita a scapito della qualità dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="b4589-328">But remember that this is done at the expense of image quality.</span></span> <span data-ttu-id="b4589-329">Pertanto, è necessario prendere una decisione di compromesso attenta tra la qualità desiderata e le prestazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="b4589-329">Therefore, a careful tradeoff decision should be made between the desired quality and the performance that is required.</span></span>

## <a name="improving-performance-for-direct2d-printing-apps"></a><span data-ttu-id="b4589-330">Miglioramento delle prestazioni per le app di stampa Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-330">Improving performance for Direct2D printing apps</span></span>

<span data-ttu-id="b4589-331">[Direct2D](./direct2d-portal.md) offre compatibilità con la stampa.</span><span class="sxs-lookup"><span data-stu-id="b4589-331">[Direct2D](./direct2d-portal.md) offers compatibility with printing.</span></span> <span data-ttu-id="b4589-332">È possibile inviare gli stessi comandi di disegno Direct2D (sotto forma di elenchi di comandi Direct2D) al controllo di stampa Direct2D per la stampa, se non si conoscono i dispositivi da disegnare o il modo in cui il disegno viene convertito in stampa.</span><span class="sxs-lookup"><span data-stu-id="b4589-332">You can send the same Direct2D drawing commands (in the form of Direct2D command lists) to the Direct2D print control for printing, if you don't know what devices you are drawing to, or how the drawing is translated to printing.</span></span>

<span data-ttu-id="b4589-333">È possibile ottimizzare ulteriormente l'utilizzo del controllo di stampa [Direct2D](./direct2d-portal.md) e dei comandi di disegno Direct2D per fornire risultati di stampa con prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="b4589-333">You can further fine-tune their usage of the [Direct2D](./direct2d-portal.md) print control and your Direct2D drawing commands to deliver printing results with better performance.</span></span>

<span data-ttu-id="b4589-334">Il controllo di stampa [Direct2D](./direct2d-portal.md) genera messaggi di debug quando rileva un modello di codice Direct2D che comporta una riduzione della qualità di stampa o delle prestazioni (ad esempio, i modelli di codice elencati più avanti in questo argomento) per ricordare dove è possibile evitare problemi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-334">The [Direct2D](./direct2d-portal.md) print control outputs debug messages when it sees a Direct2D code pattern that leads to lower printing quality or performance (like, code patterns listed later in this topic) to remind you where you can avoid performance problems.</span></span> <span data-ttu-id="b4589-335">Per visualizzare i messaggi di debug, è necessario abilitare il [livello di debug Direct2D](direct2ddebuglayer-portal.md) nel codice.</span><span class="sxs-lookup"><span data-stu-id="b4589-335">To see those debug messages, you need to enable [Direct2D Debug Layer](direct2ddebuglayer-portal.md) in your code.</span></span> <span data-ttu-id="b4589-336">Per istruzioni su come abilitare l'output del messaggio di debug, vedere [messaggi di debug](direct2ddebuglayer-debugmessages.md) .</span><span class="sxs-lookup"><span data-stu-id="b4589-336">See [Debug Messages](direct2ddebuglayer-debugmessages.md) for instructions to enable debug message output.</span></span>

### <a name="set-the-right-property-values-when-you-create-the-d2d-print-control"></a><span data-ttu-id="b4589-337">Impostare i valori di proprietà corretti quando si crea il controllo di stampa D2D</span><span class="sxs-lookup"><span data-stu-id="b4589-337">Set the right property values when you create the D2D print control</span></span>

<span data-ttu-id="b4589-338">Sono disponibili tre proprietà che è possibile impostare quando si crea il controllo di stampa [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="b4589-338">There are three properties that you can set when you create the [Direct2D](./direct2d-portal.md) print control.</span></span> <span data-ttu-id="b4589-339">Due di queste proprietà influiscano sul modo in cui il controllo di stampa Direct2D gestisce determinati comandi Direct2D e a loro volta influisca sulle prestazioni complessive.</span><span class="sxs-lookup"><span data-stu-id="b4589-339">Two of these properties impact how the Direct2D print control handles certain Direct2D commands and in turn impact the overall performance.</span></span>

-   <span data-ttu-id="b4589-340">Modalità subset del tipo di carattere: il controllo di stampa [Direct2D](./direct2d-portal.md) imposta le risorse dei tipi di carattere utilizzate in ogni pagina prima di inviare la pagina da stampare.</span><span class="sxs-lookup"><span data-stu-id="b4589-340">Font Subset Mode: The [Direct2D](./direct2d-portal.md) print control subsets font resources used in each page before it sends the page to be printed.</span></span> <span data-ttu-id="b4589-341">Questa modalità riduce le dimensioni delle risorse della pagina necessarie per la stampa.</span><span class="sxs-lookup"><span data-stu-id="b4589-341">This mode reduces the size of page resources needed to print.</span></span> <span data-ttu-id="b4589-342">A seconda dell'utilizzo dei tipi di carattere nella pagina, è possibile scegliere diverse modalità di subset dei tipi di carattere per ottenere prestazioni ottimali.</span><span class="sxs-lookup"><span data-stu-id="b4589-342">Depending on font usage on the page, you can choose different font subset modes for the best performance.</span></span>
    -   <span data-ttu-id="b4589-343">[**D2d1 \_ La \_ \_ \_ modalità \_ predefinita del subset di caratteri di stampa**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) fornisce le migliori prestazioni di stampa nella maggior parte dei casi.</span><span class="sxs-lookup"><span data-stu-id="b4589-343">[**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_DEFAULT**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) provides the best printing performance in most cases.</span></span> <span data-ttu-id="b4589-344">Se impostata su questa modalità, il controllo di stampa [Direct2D](./direct2d-portal.md) utilizza una strategia euristica per decidere quando sottoporre a subset i tipi di carattere.</span><span class="sxs-lookup"><span data-stu-id="b4589-344">When set to this mode, the [Direct2D](./direct2d-portal.md) print control uses a heuristic strategy to decide when to subset fonts.</span></span>
    -   <span data-ttu-id="b4589-345">Per i processi di stampa brevi con 1 o 2 pagine, è consigliabile [**d2d1 \_ Print \_ Font \_ \_ mode subset Mode \_ EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , dove il controllo di stampa [Direct2D](./direct2d-portal.md) subset e incorpora le risorse dei tipi di carattere in ogni pagina, quindi Elimina il subset del tipo di carattere dopo la stampa della pagina.</span><span class="sxs-lookup"><span data-stu-id="b4589-345">For short print jobs with 1 or 2 pages, we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , where the [Direct2D](./direct2d-portal.md) print control subsets and embeds font resources in each page, then discards that font subset after the page prints.</span></span> <span data-ttu-id="b4589-346">Questa opzione assicura che ogni pagina possa essere stampata immediatamente dopo la generazione, ma aumenta leggermente le dimensioni delle risorse della pagina necessarie per la stampa (con subset di caratteri di grandi dimensioni).</span><span class="sxs-lookup"><span data-stu-id="b4589-346">This option makes sure each page can be printed immediately after it is generated but slightly increases size of page resources needed for printing (with usually large font subsets).</span></span>
    -   <span data-ttu-id="b4589-347">Per i processi di stampa con molte pagine di testi e piccole dimensioni dei tipi di carattere, ad esempio 100 pagine di testo che usano un solo tipo di carattere, è consigliabile usare la [](./direct2d-portal.md) modalità di subset dei [**tipi di carattere di stampa d2d1, in cui il controllo di stampa Direct2D non esegue il subset delle risorse del \_ \_ \_ \_ \_**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode)tipo di carattere, bensì Invia le risorse del tipo di carattere originali insieme alla pagina che usa per prima cosa il tipo di carattere e riutilizza le risorse del tipo di carattere per le pagine successive senza inviarle nuovamente.</span><span class="sxs-lookup"><span data-stu-id="b4589-347">For print jobs with many pages of texts and small font sizes (like 100 pages of text that uses a single font), we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_NONE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), where the [Direct2D](./direct2d-portal.md) print control doesn't subset font resources at all; instead, it sends out the original font resources along with the page that first uses the font, and re-uses the font resources for later pages without resending them.</span></span>
-   <span data-ttu-id="b4589-348">DPI di rasterizzazione: quando il controllo di stampa [Direct2D](./direct2d-portal.md) deve rasterizzare i comandi Direct2D durante la conversione DIRECT2D-XPS, usa questo valore dpi per la rasterizzazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-348">Rasterization DPI: When the [Direct2D](./direct2d-portal.md) print control needs to rasterize Direct2D commands during Direct2D-XPS conversion, it uses this DPI for rasterization.</span></span> <span data-ttu-id="b4589-349">In altre parole, se la pagina non contiene contenuto rasterizzato, l'impostazione di qualsiasi valore DPI non modificherà le prestazioni e la qualità.</span><span class="sxs-lookup"><span data-stu-id="b4589-349">In other words, if the page doesn't have any rasterized contents, setting any DPI won't change performance and quality.</span></span> <span data-ttu-id="b4589-350">A seconda dell'utilizzo della rasterizzazione nella pagina, è possibile scegliere diversi dpi di rasterizzazione per il migliore equilibrio tra fedeltà e prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-350">Depending on rasterization usage on the page, you can choose different rasterization DPIs for the best balance between fidelity and performance.</span></span>
    -   <span data-ttu-id="b4589-351">150 è il valore predefinito se non si specifica un valore quando si crea il controllo di stampa [Direct2D](./direct2d-portal.md) , che rappresenta il migliore equilibrio tra la qualità della stampa e le prestazioni di stampa nella maggior parte dei casi.</span><span class="sxs-lookup"><span data-stu-id="b4589-351">150 is the default value if you don't specify a value when you create the [Direct2D](./direct2d-portal.md) print control, which is the best balance of printing quality and printing performance in most cases.</span></span>
    -   <span data-ttu-id="b4589-352">I valori DPI più elevati in genere comportano una migliore qualità di stampa, come in altri dettagli conservati, ma con prestazioni ridotte a causa delle bitmap più grandi generate.</span><span class="sxs-lookup"><span data-stu-id="b4589-352">Higher DPI values usually result in better printing quality (as in more details preserved) but lower performance due to the larger bitmaps it generates.</span></span> <span data-ttu-id="b4589-353">Non è consigliabile alcun valore DPI maggiore di 300 poiché questo non introdurrà informazioni aggiuntive visivamente percepibili dagli occhi umani.</span><span class="sxs-lookup"><span data-stu-id="b4589-353">We don't recommend any DPI value greater than 300 since that won't introduce extra information visually perceivable by human eyes.</span></span>
    -   <span data-ttu-id="b4589-354">I valori DPI inferiori possono comportare prestazioni migliori ma possono produrre anche una qualità inferiore.</span><span class="sxs-lookup"><span data-stu-id="b4589-354">Lower DPI may mean better performance but may also produce lower quality.</span></span>

### <a name="avoid-using-certain-direct2d-drawing-patterns"></a><span data-ttu-id="b4589-355">Evitare di usare determinati modelli di disegno Direct2D</span><span class="sxs-lookup"><span data-stu-id="b4589-355">Avoid using certain Direct2D drawing patterns</span></span>

<span data-ttu-id="b4589-356">Esistono differenze tra gli elementi che [Direct2D](./direct2d-portal.md) possono rappresentare visivamente e ciò che il sottosistema di stampa può gestire e trasportare lungo l'intera pipeline di stampa.</span><span class="sxs-lookup"><span data-stu-id="b4589-356">There are differences between what [Direct2D](./direct2d-portal.md) can represent visually and what the print subsystem can maintain and transport along the whole print pipeline.</span></span> <span data-ttu-id="b4589-357">Il controllo di stampa Direct2D colma tali gap approssimando o rasterizzando le primitive Direct2D che il sottosistema di stampa non supporta in modo nativo.</span><span class="sxs-lookup"><span data-stu-id="b4589-357">The Direct2D print control bridges those gaps by either approximating or rasterizing Direct2D primitives that the print subsystem doesn't natively support.</span></span> <span data-ttu-id="b4589-358">Questa approssimazione in genere comporta una riduzione della fedeltà di stampa, una riduzione delle prestazioni di stampa o entrambi.</span><span class="sxs-lookup"><span data-stu-id="b4589-358">Such approximation usually results in lower printing fidelity, lower printing performance, or both.</span></span> <span data-ttu-id="b4589-359">Pertanto, anche se un cliente può usare gli stessi schemi di disegno per il rendering dello schermo e di stampa, non è ideale in tutti i casi.</span><span class="sxs-lookup"><span data-stu-id="b4589-359">Therefore, even though a customer can use the same drawing patterns for both screen and print rendering, it is not ideal in all cases.</span></span> <span data-ttu-id="b4589-360">È preferibile non usare tali primitive e modelli Direct2D il più possibile per il percorso di stampa oppure per eseguire la rasterizzazione in cui si ha il controllo completo della qualità e delle dimensioni delle immagini rasterizzate.</span><span class="sxs-lookup"><span data-stu-id="b4589-360">It's best not to use such Direct2D primitives and patterns as much as possible for the print path, or to do you own rasterization where you have full control of the quality and the size of the rasterized images.</span></span>

<span data-ttu-id="b4589-361">Di seguito è riportato un elenco di casi in cui le prestazioni e la qualità di stampa non saranno ideali e potrebbe essere necessario valutare la possibilità di variare il percorso del codice per ottenere prestazioni di stampa ottimali.</span><span class="sxs-lookup"><span data-stu-id="b4589-361">The here is a list of cases where the print performance and quality won't be ideal and the you might want to consider varying the code path for optimal print performance.</span></span>

-   <span data-ttu-id="b4589-362">Evitare di usare la modalità di Blend primitiva diversa da [**d2d1 \_ primitive \_ Blend \_ SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span><span class="sxs-lookup"><span data-stu-id="b4589-362">Avoid using primitive blend mode other than [**D2D1\_PRIMITIVE\_BLEND\_SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span></span>
-   <span data-ttu-id="b4589-363">Evitare di usare le modalità di composizione durante il disegno di un'immagine diversa dall' [**\_ \_ \_ origine \_ in modalità composita d2d1**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) e dalla **\_ \_ destinazione della modalità \_ \_ composita d2d1**.</span><span class="sxs-lookup"><span data-stu-id="b4589-363">Avoid using Composition Modes when drawing an image other than [**D2D1\_COMPOSITE\_MODE\_SOURCE\_OVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) and **D2D1\_COMPOSITE\_MODE\_DESTINATION\_OVER**.</span></span>
-   <span data-ttu-id="b4589-364">Evitare di disegnare un file di metadati GDI.</span><span class="sxs-lookup"><span data-stu-id="b4589-364">Avoid drawing a GDI Meta File.</span></span>
-   <span data-ttu-id="b4589-365">Evitare di eseguire il push di una risorsa di livello che copia lo sfondo dell'origine (chiamando [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) con il passaggio di [**d2d1 \_ Layer \_ OPTIONS1 \_ Inizializza \_ dallo \_ sfondo**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) allo struct **\_ \_ PARAMETERS1 layer** ).</span><span class="sxs-lookup"><span data-stu-id="b4589-365">Avoid pushing a layer resource that copies the source background (calling [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) with passing [**D2D1\_LAYER\_OPTIONS1\_INITIALIZE\_FROM\_BACKGROUND**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) to the **D2D1\_LAYER\_PARAMETERS1** struct).</span></span>
-   <span data-ttu-id="b4589-366">Evitare di creare un pennello bitmap o un pennello immagine con il \_ morsetto della modalità di estensione d2d1 \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="b4589-366">Avoid creating Bitmap Brush or Image Brush with D2D1\_EXTEND\_MODE\_CLAMP.</span></span> <span data-ttu-id="b4589-367">Si consiglia di usare il \_ mirror della modalità di estensione d2d1 \_ \_ se non si è interessati ai pixel al di fuori dell'immagine associata (ad esempio, l'immagine collegata al pennello è nota come più grande dell'area di destinazione riempita).</span><span class="sxs-lookup"><span data-stu-id="b4589-367">We recommend you use D2D1\_EXTEND\_MODE\_MIRROR if don't care about pixels outside of the image bound at all (like, the image attached to the brush is known to be larger than the filled target region).</span></span>
-   <span data-ttu-id="b4589-368">Evitare di disegnare bitmap con [trasformazioni prospettiche](3d-perspective-transform.md).</span><span class="sxs-lookup"><span data-stu-id="b4589-368">Avoid drawing Bitmaps with [Perspective Transforms](3d-perspective-transform.md).</span></span>

### <a name="draw-text-in-a-direct-and-plain-way"></a><span data-ttu-id="b4589-369">Creare testo in modo diretto e normale</span><span class="sxs-lookup"><span data-stu-id="b4589-369">Draw text in a direct and plain way</span></span>

<span data-ttu-id="b4589-370">Direct2D presenta diverse ottimizzazioni quando si esegue il rendering dei testi da visualizzare per ottenere prestazioni migliori e/o qualità visiva migliore.</span><span class="sxs-lookup"><span data-stu-id="b4589-370">Direct2D has several optimizations when rendering texts to display for better performance and/or better visual quality.</span></span> <span data-ttu-id="b4589-371">Tuttavia, non tutte le ottimizzazioni migliorano le prestazioni e la qualità della stampa, perché la stampa su carta è in genere in un valore DPI molto più elevato e la stampa non deve contenere scenari come l'animazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-371">But not all optimizations improve the printing performance and quality since the printing on paper is usually in a much higher DPI, and printing does not need to accommodate scenarios like animation.</span></span> <span data-ttu-id="b4589-372">È quindi consigliabile creare direttamente il testo o i glifi originali ed evitare le ottimizzazioni seguenti quando si crea l'elenco dei comandi per la stampa.</span><span class="sxs-lookup"><span data-stu-id="b4589-372">So, we recommend you draw the original text or glyphs directly and avoid any of the following optimizations when creating the command list for printing.</span></span>

-   <span data-ttu-id="b4589-373">Evitare di disegnare testo con il metodo [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) .</span><span class="sxs-lookup"><span data-stu-id="b4589-373">Avoid drawing text with the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) method.</span></span>
-   <span data-ttu-id="b4589-374">Evitare di disegnare testo in modalità alias.</span><span class="sxs-lookup"><span data-stu-id="b4589-374">Avoid drawing text in Aliased Mode.</span></span>

### <a name="draw-the-original-bitmaps-when-possible"></a><span data-ttu-id="b4589-375">Estrai le bitmap originali quando possibile</span><span class="sxs-lookup"><span data-stu-id="b4589-375">Draw the original bitmaps when possible</span></span>

<span data-ttu-id="b4589-376">Se la bitmap di destinazione è JPEG, PNG, TIFF e JPEG-XR, è possibile creare una bitmap WIC da un file su disco o da un flusso in memoria, quindi creare una bitmap [Direct2D](./direct2d-portal.md) dalla bitmap WIC usando [**ID2D1DeviceContext:: CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))e infine passare direttamente tale bitmap Direct2D al controllo di stampa Direct2D senza ulteriori modifiche.</span><span class="sxs-lookup"><span data-stu-id="b4589-376">If the target bitmap is a JPEG, PNG, TIFF, or JPEG-XR, you can create a WIC bitmap either from a disk file or from an in-memory stream, then create a [Direct2D](./direct2d-portal.md) bitmap from that WIC bitmap using [**ID2D1DeviceContext::CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and finally directly pass that Direct2D bitmap to the Direct2D print control without further manipulation.</span></span> <span data-ttu-id="b4589-377">In questo modo, il controllo di stampa Direct2D è in grado di riutilizzare il flusso bitmap, che in genere consente di migliorare le prestazioni di stampa (ignorando la codifica e la decodifica di bitmap ridondanti) e una migliore qualità di stampa (quando i metadati, ad esempio i profili dei colori, nella bitmap verranno conservati).</span><span class="sxs-lookup"><span data-stu-id="b4589-377">By doing so, the Direct2D print control is able to reuse the bitmap stream, which usually leads to better printing performance (by skipping redundant bitmap encoding and decoding), and better printing quality (when metadata, such as color profiles, in the bitmap will be preserved).</span></span>

<span data-ttu-id="b4589-378">Il disegno della bitmap originale offre i vantaggi seguenti per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-378">Drawing the original bitmap provides the following benefit for applications.</span></span>

-   <span data-ttu-id="b4589-379">In generale, la stampa [Direct2D](./direct2d-portal.md) conserva le informazioni originali, senza perdita o rumore, fino alla fine della pipeline, soprattutto quando le app non conoscono o non vogliono conoscere i dettagli della pipeline di stampa, ad esempio la stampante in cui viene eseguita la stampa, il valore dpi è la stampante di destinazione e così via.</span><span class="sxs-lookup"><span data-stu-id="b4589-379">In general, [Direct2D](./direct2d-portal.md) print preserves the original information (without loss or noise) until late in the pipeline, especially when apps don't know (or do not want to know) the details of the print pipeline (like which printer it is printing to, what DPI is the target printer, and so on).</span></span>
-   <span data-ttu-id="b4589-380">In molti casi, ritardare la rasterizzazione delle bitmap significa migliorare le prestazioni (ad esempio quando si stampa una foto 96dpi in una stampante 600dpi).</span><span class="sxs-lookup"><span data-stu-id="b4589-380">In many cases, delaying bitmap rasterization means better performance (like when printing an 96dpi photo to a 600dpi printer).</span></span>
-   <span data-ttu-id="b4589-381">In alcuni casi, il passaggio delle immagini originali è l'unico modo per rispettare la fedeltà elevata, ad esempio i profili colori incorporati.</span><span class="sxs-lookup"><span data-stu-id="b4589-381">In certain cases, passing the original images is the only way to honor high fidelity (like embedded color profiles).</span></span>

<span data-ttu-id="b4589-382">Tuttavia, non è possibile optare per questa ottimizzazione perché:</span><span class="sxs-lookup"><span data-stu-id="b4589-382">However, an you can't opt in such optimization because:</span></span>

-   <span data-ttu-id="b4589-383">Eseguendo una query sulle informazioni sulla stampante e la rasterizzazione preliminare, è possibile rasterizzare il contenuto con il controllo completo sull'aspetto finale del documento.</span><span class="sxs-lookup"><span data-stu-id="b4589-383">By querying printer info and early rasterization, you can rasterize contents themselves with full control of the final appearance on paper.</span></span>
-   <span data-ttu-id="b4589-384">In alcuni casi, la rasterizzazione anticipata potrebbe effettivamente migliorare le prestazioni end-to-end di un'app, ad esempio la stampa di portafogli, le foto delle dimensioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-384">In certain cases, early rasterization might actually improves an app’s end-to-end performance (like printing wallets-size photos).</span></span>
-   <span data-ttu-id="b4589-385">In alcuni casi, per passare le bitmap originali è necessario modificare in modo significativo l'architettura del codice esistente, ad esempio il caricamento ritardato delle immagini e i percorsi di aggiornamento delle risorse presenti in alcune applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b4589-385">In certain cases, passing the original bitmaps require significant change of existing code architecture (like image delay loading and resource update paths found in certain applications).</span></span>

## <a name="conclusion"></a><span data-ttu-id="b4589-386">Conclusione</span><span class="sxs-lookup"><span data-stu-id="b4589-386">Conclusion</span></span>

<span data-ttu-id="b4589-387">Sebbene l'hardware Direct2D sia accelerato ed è destinato a prestazioni elevate, è necessario utilizzare correttamente le funzionalità per ottimizzare la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="b4589-387">Although Direct2D is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="b4589-388">Le tecniche esaminate di seguito derivano dallo studio di scenari comuni e potrebbero non essere applicabili a tutti gli scenari di applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4589-388">The techniques we looked at here are derived from studying common scenarios and might not apply to all application scenarios.</span></span>

 

 
