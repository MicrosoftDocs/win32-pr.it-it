---
title: Accesso ai servizi Voce (interfaccia del server Microsoft Agent)
description: Informazioni sull'accesso ai servizi voce con l'interfaccia del server Microsoft Agent. Microsoft Agent è deprecato a livello di Windows 7.
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1f87bf5cf88141344d5328592c9e823c7365c5d5
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262703"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a><span data-ttu-id="f8e17-104">Accesso ai servizi Voce (interfaccia del server Microsoft Agent)</span><span class="sxs-lookup"><span data-stu-id="f8e17-104">Accessing Speech Services (Microsoft Agent Server Interface)</span></span>

<span data-ttu-id="f8e17-105">\[Microsoft Agent è deprecato a livello di Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="f8e17-105">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="f8e17-106">Anche se i servizi di Microsoft Agent includono il supporto per l'input vocale, è necessario installare un motore di riconoscimento vocale compatibile per accedere ai servizi di input vocale di Agent.</span><span class="sxs-lookup"><span data-stu-id="f8e17-106">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="f8e17-107">Analogamente, se si vogliono usare i servizi voce di Microsoft Agent per supportare l'output vocale sintetizzato per un carattere, è necessario installare un motore di sintesi vocale compatibile per il carattere.</span><span class="sxs-lookup"><span data-stu-id="f8e17-107">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span> <span data-ttu-id="f8e17-108">Poiché i servizi voce di Microsoft Agent sono basati su Microsoft Speech API (SAPI), è possibile usare qualsiasi motore compatibile che supporti le interfacce vocali necessarie.</span><span class="sxs-lookup"><span data-stu-id="f8e17-108">Because Microsoft Agent's speech services are based on the Microsoft Speech API (SAPI), you can use any engines that compatibly support the required speech interfaces.</span></span>

<span data-ttu-id="f8e17-109">Per abilitare il supporto dell'input vocale nell'applicazione, definire un [**oggetto Command**](https://www.bing.com/search?q=**Command**) e impostarne [**la proprietà**](https://www.bing.com/search?q=**Voice**) Voice.</span><span class="sxs-lookup"><span data-stu-id="f8e17-109">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="f8e17-110">Microsoft Agent carica automaticamente i servizi voce, in modo che quando l'utente preme il tasto di ascolto o si chiama [**Listen**](https://www.bing.com/search?q=**Listen**), verrà caricato il motore di riconoscimento vocale.</span><span class="sxs-lookup"><span data-stu-id="f8e17-110">Microsoft Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="f8e17-111">Per impostazione predefinita, l'ID lingua del carattere determinerà il motore caricato.</span><span class="sxs-lookup"><span data-stu-id="f8e17-111">By default the character's language ID will determine which engine is loaded.</span></span> <span data-ttu-id="f8e17-112">Agent tenta di caricare il primo motore restituito da SAPI come corrispondente a questo linguaggio.</span><span class="sxs-lookup"><span data-stu-id="f8e17-112">Agent attempts to load the first engine that SAPI returns as matching this language.</span></span> <span data-ttu-id="f8e17-113">Usare **IAgentCharacterEx::SetSRModeID** se si vuole caricare un motore specifico.</span><span class="sxs-lookup"><span data-stu-id="f8e17-113">Use **IAgentCharacterEx::SetSRModeID** if you want to load a specific engine.</span></span>

<span data-ttu-id="f8e17-114">Per abilitare l'output della sintesi vocale, usare il [**metodo Speak.**](https://www.bing.com/search?q=**Speak**)</span><span class="sxs-lookup"><span data-stu-id="f8e17-114">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="f8e17-115">Microsoft Agent tenterà automaticamente di caricare un motore che corrisponde all'ID lingua del carattere.</span><span class="sxs-lookup"><span data-stu-id="f8e17-115">Microsoft Agent will automatically attempt to load an engine that matches the character's language ID.</span></span> <span data-ttu-id="f8e17-116">Se la definizione del carattere include un ID della modalità del motore TTS specifico e tale motore è disponibile e corrisponde all'ID lingua del carattere, Agent carica tale motore per il carattere.</span><span class="sxs-lookup"><span data-stu-id="f8e17-116">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's language ID, Agent loads that engine for the character.</span></span> <span data-ttu-id="f8e17-117">In caso contrario, Agent carica il primo motore TTS restituito da SAPI come corrispondente all'impostazione della lingua del carattere.</span><span class="sxs-lookup"><span data-stu-id="f8e17-117">If not, Agent loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="f8e17-118">È anche possibile usare **IAgentCharacterEx::SetTTSModeID** per caricare un motore specifico.</span><span class="sxs-lookup"><span data-stu-id="f8e17-118">You can also use **IAgentCharacterEx::SetTTSModeID** to load a specific engine.</span></span>

<span data-ttu-id="f8e17-119">In genere, Microsoft Agent carica un motore di riconoscimento vocale quando viene avviata la modalità di ascolto e carica un motore di sintesi vocale quando [**si chiama Speak**](https://www.bing.com/search?q=**Speak**) per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="f8e17-119">Typically, Microsoft Agent loads a speech recognition engine when the Listening mode is initiated and loads a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="f8e17-120">Tuttavia, se si vuole precaricare il motore di riconoscimento vocale, è possibile eseguire una query delle proprietà correlate alle interfacce vocali.</span><span class="sxs-lookup"><span data-stu-id="f8e17-120">However, if you want to preload the speech engine, you can do this by querying the properties related to the speech interfaces.</span></span> <span data-ttu-id="f8e17-121">Ad esempio, la chiamata **di IAgentCharacterEx::GetSRModeID** o **IAgentCharacterEx::GetTTSModeID** tenterà di caricare tale tipo di motore.</span><span class="sxs-lookup"><span data-stu-id="f8e17-121">For example, calling **IAgentCharacterEx::GetSRModeID** or **IAgentCharacterEx::GetTTSModeID** will attempt to load that type of engine.</span></span>

 

 




