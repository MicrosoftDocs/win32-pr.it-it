---
title: Accesso a servizi vocali (interfaccia server Microsoft Agent)
description: Accesso ai servizi di riconoscimento vocale
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fda1369fa83c5e8ffaf7f08317f69a2a569620f3
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "106300895"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a><span data-ttu-id="5099d-103">Accesso a servizi vocali (interfaccia server Microsoft Agent)</span><span class="sxs-lookup"><span data-stu-id="5099d-103">Accessing Speech Services (Microsoft Agent Server Interface)</span></span>

<span data-ttu-id="5099d-104">\[Microsoft Agent è stato deprecato a partire da Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="5099d-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="5099d-105">Sebbene i servizi di Microsoft Agent includano il supporto per l'input vocale, è necessario installare un motore di riconoscimento vocale per i comandi e i controlli compatibili per accedere ai servizi di input vocale dell'agente.</span><span class="sxs-lookup"><span data-stu-id="5099d-105">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="5099d-106">Analogamente, se si desidera utilizzare i servizi di riconoscimento vocale di Microsoft Agent per supportare l'output vocale sintetizzato per un carattere, è necessario installare un motore di sintesi vocale (TTS) compatibile per il carattere.</span><span class="sxs-lookup"><span data-stu-id="5099d-106">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span> <span data-ttu-id="5099d-107">Poiché i servizi di sintesi vocale di Microsoft Agent sono basati su Microsoft Speech API (SAPI), è possibile usare qualsiasi motore che supporta compatibilmente le interfacce vocali richieste.</span><span class="sxs-lookup"><span data-stu-id="5099d-107">Because Microsoft Agent's speech services are based on the Microsoft Speech API (SAPI), you can use any engines that compatibly support the required speech interfaces.</span></span>

<span data-ttu-id="5099d-108">Per abilitare il supporto dell'input vocale nell'applicazione, definire un oggetto [**Command**](https://www.bing.com/search?q=**Command**) e impostare la relativa proprietà [**Voice**](https://www.bing.com/search?q=**Voice**) .</span><span class="sxs-lookup"><span data-stu-id="5099d-108">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="5099d-109">Microsoft Agent caricherà automaticamente i servizi di riconoscimento vocale, in modo che quando l'utente preme il tasto ascolto o si chiama [**Listen**](https://www.bing.com/search?q=**Listen**), il motore di riconoscimento vocale verrà caricato.</span><span class="sxs-lookup"><span data-stu-id="5099d-109">Microsoft Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="5099d-110">Per impostazione predefinita, l'ID lingua del carattere determinerà il motore caricato.</span><span class="sxs-lookup"><span data-stu-id="5099d-110">By default the character's language ID will determine which engine is loaded.</span></span> <span data-ttu-id="5099d-111">Agent tenta di caricare il primo motore restituito da SAPI come corrispondente a questa lingua.</span><span class="sxs-lookup"><span data-stu-id="5099d-111">Agent attempts to load the first engine that SAPI returns as matching this language.</span></span> <span data-ttu-id="5099d-112">Usare [**IAgentCharacterEx:: SetSRModeID**](IAgentCharacterEx::SetSRModeID) se si vuole caricare un motore specifico.</span><span class="sxs-lookup"><span data-stu-id="5099d-112">Use [**IAgentCharacterEx::SetSRModeID**](IAgentCharacterEx::SetSRModeID) if you want to load a specific engine.</span></span>

<span data-ttu-id="5099d-113">Per abilitare l'output di sintesi vocale, usare il metodo [**Speak**](https://www.bing.com/search?q=**Speak**) .</span><span class="sxs-lookup"><span data-stu-id="5099d-113">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="5099d-114">Microsoft Agent tenterà automaticamente di caricare un motore che corrisponde all'ID lingua del carattere.</span><span class="sxs-lookup"><span data-stu-id="5099d-114">Microsoft Agent will automatically attempt to load an engine that matches the character's language ID.</span></span> <span data-ttu-id="5099d-115">Se la definizione del carattere include un ID specifico della modalità del motore TTS e tale motore è disponibile e corrisponde all'ID lingua del carattere, Agent carica tale motore per il carattere.</span><span class="sxs-lookup"><span data-stu-id="5099d-115">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's language ID, Agent loads that engine for the character.</span></span> <span data-ttu-id="5099d-116">In caso contrario, Agent carica il primo motore TTS che SAPI restituisce come corrispondente all'impostazione della lingua del carattere.</span><span class="sxs-lookup"><span data-stu-id="5099d-116">If not, Agent loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="5099d-117">È anche possibile usare [**IAgentCharacterEx:: SetTTSModeID**](IAgentCharacterEx::SetTTSModeID) per caricare un motore specifico.</span><span class="sxs-lookup"><span data-stu-id="5099d-117">You can also use [**IAgentCharacterEx::SetTTSModeID**](IAgentCharacterEx::SetTTSModeID) to load a specific engine.</span></span>

<span data-ttu-id="5099d-118">In genere, Microsoft Agent carica un motore di riconoscimento vocale quando viene avviata la modalità di ascolto e carica un motore di sintesi vocale quando viene [**chiamato per la prima volta.**](https://www.bing.com/search?q=**Speak**)</span><span class="sxs-lookup"><span data-stu-id="5099d-118">Typically, Microsoft Agent loads a speech recognition engine when the Listening mode is initiated and loads a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="5099d-119">Tuttavia, se si desidera precaricare il motore di riconoscimento vocale, è possibile eseguire una query sulle proprietà correlate alle interfacce vocali.</span><span class="sxs-lookup"><span data-stu-id="5099d-119">However, if you want to preload the speech engine, you can do this by querying the properties related to the speech interfaces.</span></span> <span data-ttu-id="5099d-120">Ad esempio, la chiamata di [**IAgentCharacterEx:: GetSRModeID**](IAgentCharacterEx::GetSRModeID) o [**IAgentCharacterEx:: GetTTSModeID**](IAgentCharacterEx::GetTTSModeID) tenterà di caricare tale tipo di motore.</span><span class="sxs-lookup"><span data-stu-id="5099d-120">For example, calling [**IAgentCharacterEx::GetSRModeID**](IAgentCharacterEx::GetSRModeID) or [**IAgentCharacterEx::GetTTSModeID**](IAgentCharacterEx::GetTTSModeID) will attempt to load that type of engine.</span></span>

 

 




