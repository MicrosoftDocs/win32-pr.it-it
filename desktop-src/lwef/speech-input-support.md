---
title: Supporto per input vocale
description: Supporto per input vocale
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "106299794"
---
# <a name="speech-input-support"></a><span data-ttu-id="33f40-103">Supporto per input vocale</span><span class="sxs-lookup"><span data-stu-id="33f40-103">Speech Input Support</span></span>

<span data-ttu-id="33f40-104">\[Microsoft Agent è stato deprecato a partire da Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="33f40-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="33f40-105">Oltre a supportare l'interazione con il mouse e la tastiera, Microsoft Agent include il supporto diretto per l'input vocale.</span><span class="sxs-lookup"><span data-stu-id="33f40-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="33f40-106">Poiché il supporto per l'input vocale di Microsoft Agent è basato su Microsoft SAPI (Speech Application Programming Interface), è possibile usare l'agente Microsoft con i motori di comando e controllo di riconoscimento vocale che includono il supporto di SAPI-required.</span><span class="sxs-lookup"><span data-stu-id="33f40-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="33f40-107">Per ulteriori informazioni sui requisiti del motore vocale, vedere [requisiti del supporto del motore vocale](requirements-for-speech-recognition-engines.md).</span><span class="sxs-lookup"><span data-stu-id="33f40-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="33f40-108">Microsoft fornisce un motore di riconoscimento vocale con comando e controllo che è possibile utilizzare con Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="33f40-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="33f40-109">Per ulteriori informazioni, vedere [selezione del motore di riconoscimento vocale](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="33f40-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="33f40-110">L'utente può avviare l'input vocale tenendo premuto il tasto di scelta rapida per l'ascolto push-to-Talk.</span><span class="sxs-lookup"><span data-stu-id="33f40-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="33f40-111">In questa modalità di ascolto, se il motore di riconoscimento vocale riceve l'inizio dell'input vocale, il canale audio rimane aperto fino a quando non rileva la fine dell'espressione.</span><span class="sxs-lookup"><span data-stu-id="33f40-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="33f40-112">Tuttavia, quando non riceve l'input, non blocca l'output audio.</span><span class="sxs-lookup"><span data-stu-id="33f40-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="33f40-113">Ciò consente all'utente di emettere più comandi vocali tenendo premuto il tasto e il carattere può rispondere quando l'utente non parla.</span><span class="sxs-lookup"><span data-stu-id="33f40-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="33f40-114">La modalità di ascolto scade quando l'utente rilascia il tasto di attesa.</span><span class="sxs-lookup"><span data-stu-id="33f40-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="33f40-115">L'utente può regolare il timeout per questa modalità usando le opzioni per i caratteri avanzati.</span><span class="sxs-lookup"><span data-stu-id="33f40-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="33f40-116">Non è possibile impostare questo timeout dal codice dell'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="33f40-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="33f40-117">Se un carattere tenta di parlare mentre l'utente sta parlando, l'output udibile del carattere ha esito negativo, anche se il testo può comunque essere visualizzato nella relativa bolla di Word.</span><span class="sxs-lookup"><span data-stu-id="33f40-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="33f40-118">Se il carattere dispone del canale audio mentre viene premuto il tasto ascolto, il server trasferisce automaticamente il controllo all'utente dopo l'elaborazione del testo nel metodo [**Speak**](speak-method.md) .</span><span class="sxs-lookup"><span data-stu-id="33f40-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="33f40-119">Viene riprodotto un tono MIDI facoltativo per fare in modo che l'utente inizi a pronunciare.</span><span class="sxs-lookup"><span data-stu-id="33f40-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="33f40-120">Ciò consente all'utente di fornire l'input anche se l'applicazione che guida il carattere non è riuscita a fornire pause logiche nell'output.</span><span class="sxs-lookup"><span data-stu-id="33f40-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="33f40-121">È anche possibile usare il metodo [**Listen**](listen-method.md) per avviare l'input vocale.</span><span class="sxs-lookup"><span data-stu-id="33f40-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="33f40-122">La chiamata a questo metodo attiva il riconoscimento vocale per un periodo di tempo predefinito.</span><span class="sxs-lookup"><span data-stu-id="33f40-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="33f40-123">Se non è presente alcun input durante questo intervallo, Microsoft Agent disattiva automaticamente il motore di riconoscimento vocale e libera il canale audio.</span><span class="sxs-lookup"><span data-stu-id="33f40-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="33f40-124">In questo modo si evita il blocco dell'input o dell'output dal dispositivo audio e si riduce al minimo l'overhead del processore usato dal riconoscimento vocale quando è acceso.</span><span class="sxs-lookup"><span data-stu-id="33f40-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="33f40-125">È anche possibile usare il metodo **Listen** per disattivare l'input vocale.</span><span class="sxs-lookup"><span data-stu-id="33f40-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="33f40-126">Tuttavia, tenere presente che, poiché il motore di riconoscimento vocale opera in modo asincrono, l'effetto potrebbe non essere immediato.</span><span class="sxs-lookup"><span data-stu-id="33f40-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="33f40-127">Di conseguenza, è possibile ricevere un evento di [**comando**](command-event.md) anche dopo che il codice ha chiamato **Listen** per disattivare l'input vocale.</span><span class="sxs-lookup"><span data-stu-id="33f40-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="33f40-128">Per supportare l'input vocale, si definisce una *grammatica*, un set di parole per cui il motore di riconoscimento vocale è in ascolto e la corrispondenza come impostazione **vocale** per un [**comando**](/windows/desktop/lwef/the-command-object) nella raccolta di [**comandi**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="33f40-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="33f40-129">È possibile includere parole opzionali e alternative e sequenze ripetute nella grammatica.</span><span class="sxs-lookup"><span data-stu-id="33f40-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="33f40-130">Si noti che Agent non Abilita il tasto di scelta rapida in ascolto fino a quando uno dei client non ha caricato correttamente un motore vocale o ha creato una **voce** per uno degli oggetti **Command** .</span><span class="sxs-lookup"><span data-stu-id="33f40-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="33f40-131">Indica se l'utente preme la scelta rapida in ascolto o se l'applicazione client chiama il metodo [**Listen**](listen-method.md) per avviare l'input vocale, il motore di riconoscimento vocale tenta di trovare la corrispondenza con l'input di un enunciato alla grammatica per i comandi definiti e passa le informazioni al server.</span><span class="sxs-lookup"><span data-stu-id="33f40-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="33f40-132">Il server invia quindi una notifica all'applicazione client utilizzando l'evento di [**comando**](command-event.md) ([**IAgentNotifySink:: Command**](iagentnotifysink--command.md)); passaggio all'oggetto [**userinput**](/windows/desktop/lwef/iagentuserinput) che include l'ID del comando della corrispondenza migliore e due corrispondenze alternative (se presenti), un punteggio di confidenza e il testo corrispondente per ogni corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="33f40-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="33f40-133">Il server invia anche una notifica all'applicazione client quando corrisponde all'input vocale a uno dei comandi forniti.</span><span class="sxs-lookup"><span data-stu-id="33f40-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="33f40-134">Mentre l'ID del comando è **null**, si ottengono comunque il Punteggio di confidenza e il testo corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="33f40-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="33f40-135">In modalità di ascolto, il server riproduce automaticamente l'animazione assegnata allo stato di **ascolto** del carattere.</span><span class="sxs-lookup"><span data-stu-id="33f40-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="33f40-136">Quindi, quando viene effettivamente rilevato un enunciato, il server riproduce l'animazione dello stato di **udito** del carattere.</span><span class="sxs-lookup"><span data-stu-id="33f40-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="33f40-137">Il server manterrà il carattere in uno stato attento fino alla fine dell'espressione.</span><span class="sxs-lookup"><span data-stu-id="33f40-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="33f40-138">Questo fornisce il feedback sociale appropriato per l'input da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="33f40-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="33f40-139">Se l'utente disabilita l'input vocale nelle opzioni per caratteri avanzati, verrà disabilitato anche il tasto di scelta rapida in ascolto.</span><span class="sxs-lookup"><span data-stu-id="33f40-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="33f40-140">Analogamente, se si tenta di chiamare il metodo [**Listen**](listen-method.md) quando l'input vocale è disabilitato, il metodo avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="33f40-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 