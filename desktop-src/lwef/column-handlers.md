---
title: Creazione di gestori di colonne
description: Nella visualizzazione dettagli di Esplora risorse di Windows vengono normalmente visualizzate diverse colonne standard.
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- gestori colonne
- Register, gestori colonne
- GetColumnInfo
- GetItemData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104555476"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="54829-107">Creazione di gestori di colonne</span><span class="sxs-lookup"><span data-stu-id="54829-107">Creating Column Handlers</span></span>

<span data-ttu-id="54829-108">\[Questa funzionalità è supportata solo in Windows XP o versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="54829-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="54829-109">\]</span><span class="sxs-lookup"><span data-stu-id="54829-109">\]</span></span>

<span data-ttu-id="54829-110">Nella visualizzazione dettagli di Esplora risorse di Windows vengono normalmente visualizzate diverse colonne standard.</span><span class="sxs-lookup"><span data-stu-id="54829-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="54829-111">Ogni colonna elenca le informazioni, ad esempio le dimensioni o il tipo di file, per ogni file nella cartella corrente.</span><span class="sxs-lookup"><span data-stu-id="54829-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="54829-112">Implementando e registrando un gestore colonne, è possibile rendere disponibili colonne personalizzate per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54829-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="54829-113">Le procedure generali per l'implementazione e la registrazione di un gestore di estensione della shell sono descritte in [creazione di gestori di estensioni della shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="54829-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="54829-114">Questo documento è incentrato sugli aspetti dell'implementazione specifici dei gestori di colonne.</span><span class="sxs-lookup"><span data-stu-id="54829-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="54829-115">Vengono illustrati gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="54829-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="54829-116">Funzionamento del gestore colonne</span><span class="sxs-lookup"><span data-stu-id="54829-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="54829-117">Registrazione di gestori di colonne</span><span class="sxs-lookup"><span data-stu-id="54829-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="54829-118">Implementazione di gestori di colonne</span><span class="sxs-lookup"><span data-stu-id="54829-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="54829-119">Metodo Initialize</span><span class="sxs-lookup"><span data-stu-id="54829-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="54829-120">Metodo GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="54829-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="54829-121">Metodo GetItemData</span><span class="sxs-lookup"><span data-stu-id="54829-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="54829-122">Funzionamento del gestore colonne</span><span class="sxs-lookup"><span data-stu-id="54829-122">How Column Handlers Work</span></span>

<span data-ttu-id="54829-123">Nella figura seguente viene illustrato Esplora risorse in visualizzazione dettagli.</span><span class="sxs-lookup"><span data-stu-id="54829-123">The following illustration shows Windows Explorer in Details view.</span></span>

![Screenshot di Esplora risorse in visualizzazione dettagli](images/columnproviderhandler1.jpg)

<span data-ttu-id="54829-125">Con Windows 2000, la cartella può supportare anche un numero di colonne che, per impostazione predefinita, non vengono visualizzate.</span><span class="sxs-lookup"><span data-stu-id="54829-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="54829-126">L'utente può visualizzare colonne aggiuntive facendo clic con il pulsante destro del mouse su una delle intestazioni di colonna e selezionando il comando **altro** nel menu.</span><span class="sxs-lookup"><span data-stu-id="54829-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="54829-127">Viene visualizzata una finestra di dialogo in cui sono elencate le colonne disponibili per la cartella e si consente all'utente di selezionare le colonne da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="54829-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="54829-128">Nella figura seguente è illustrata questa finestra di dialogo per l'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="54829-128">The following illustration shows this dialog box for the preceding example.</span></span>

![Screenshot di Esplora risorse con la finestra di dialogo Seleziona dettagli visualizzata](images/columnproviderhandler2.jpg)

<span data-ttu-id="54829-130">Creando un gestore colonne, è possibile creare colonne personalizzate e aggiungerle a tale elenco.</span><span class="sxs-lookup"><span data-stu-id="54829-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="54829-131">Ad esempio, una raccolta di file che contengono musica può usare un gestore colonne per visualizzare le colonne che elencano l'artista e la parte contenuta da ogni file.</span><span class="sxs-lookup"><span data-stu-id="54829-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="54829-132">Un gestore colonne è un oggetto globale che viene chiamato ogni volta che Esplora risorse Visualizza la visualizzazione dettagli.</span><span class="sxs-lookup"><span data-stu-id="54829-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="54829-133">I gestori di colonne, tuttavia, vengono in genere utilizzati per visualizzare colonne personalizzate solo per i membri di un determinato [tipo di file](/windows/desktop/shell/fa-file-types).</span><span class="sxs-lookup"><span data-stu-id="54829-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="54829-134">Prima di visualizzare la visualizzazione dettagli, Esplora risorse esegue una query su tutti i gestori di colonne registrate per le relative caratteristiche di colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="54829-135">Se l'utente ha selezionato una delle colonne del gestore, Esplora risorse esegue una query sul gestore per i dati associati.</span><span class="sxs-lookup"><span data-stu-id="54829-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="54829-136">Quando un gestore di colonne riceve una richiesta di dati, lo fornisce se il file è un membro del tipo supportato.</span><span class="sxs-lookup"><span data-stu-id="54829-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="54829-137">In caso contrario, la richiesta viene ignorata restituendo S \_ false.</span><span class="sxs-lookup"><span data-stu-id="54829-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="54829-138">Registrazione di gestori di colonne</span><span class="sxs-lookup"><span data-stu-id="54829-138">Registering Column Handlers</span></span>

<span data-ttu-id="54829-139">I gestori di colonna vengono registrati nella sottochiave seguente.</span><span class="sxs-lookup"><span data-stu-id="54829-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="54829-140">Creare una sottochiave di **ColumnHandlers** denominata con il formato stringa del GUID dell'identificatore di classe del gestore (CLSID).</span><span class="sxs-lookup"><span data-stu-id="54829-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="54829-141">Per informazioni generali su come registrare i gestori di estensioni della shell, vedere [creazione di gestori di estensioni della shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="54829-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="54829-142">Nell'esempio seguente viene illustrato come registrare un gestore colonne.</span><span class="sxs-lookup"><span data-stu-id="54829-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="54829-143">Implementazione di gestori di colonne</span><span class="sxs-lookup"><span data-stu-id="54829-143">Implementing Column Handlers</span></span>

<span data-ttu-id="54829-144">Come tutti i gestori di estensioni della shell, i gestori di colonne sono oggetti COM (Component Object Model in-process) implementati come dll.</span><span class="sxs-lookup"><span data-stu-id="54829-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="54829-145">Esportano l'interfaccia [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) oltre a [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="54829-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="54829-146">Esplora risorse chiama i tre metodi esportati da [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) per richiedere le informazioni necessarie per visualizzare la colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="54829-147">La procedura utilizzata da Esplora risorse è la seguente:</span><span class="sxs-lookup"><span data-stu-id="54829-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="54829-148">Chiamare [**IColumnProvider:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) per specificare la cartella che sta per essere visualizzata.</span><span class="sxs-lookup"><span data-stu-id="54829-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="54829-149">Chiamare [**IColumnProvider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) per recuperare l'identificatore e le caratteristiche della colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="54829-150">Se la colonna è stata selezionata dall'utente, chiamare [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) per ogni file nella cartella per recuperare i dati che appartengono alla voce di colonna del file.</span><span class="sxs-lookup"><span data-stu-id="54829-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="54829-151">Metodo Initialize</span><span class="sxs-lookup"><span data-stu-id="54829-151">The Initialize Method</span></span>

<span data-ttu-id="54829-152">Esplora risorse chiama [**IColumnProvider:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) per inizializzare il gestore colonne.</span><span class="sxs-lookup"><span data-stu-id="54829-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="54829-153">Il metodo ha tre parametri, ma è attualmente in uso solo *wszFolder* .</span><span class="sxs-lookup"><span data-stu-id="54829-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="54829-154">Viene impostato sulla cartella la cui visualizzazione dettagli sta per essere visualizzata.</span><span class="sxs-lookup"><span data-stu-id="54829-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="54829-155">Archiviare il nome della cartella per utilizzarlo in un secondo momento e inizializzare l'oggetto gestore in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="54829-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="54829-156">Metodo GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="54829-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="54829-157">In Esplora risorse viene chiamato [**IColumnProvider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) per richiedere l'identificatore e le caratteristiche della colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="54829-158">Viene passato un indice per la colonna nel parametro *dwIndex* .</span><span class="sxs-lookup"><span data-stu-id="54829-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="54829-159">Questo indice è un valore arbitrario utilizzato per enumerare colonne.</span><span class="sxs-lookup"><span data-stu-id="54829-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="54829-160">Esplora risorse passa inoltre un puntatore a una struttura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) .</span><span class="sxs-lookup"><span data-stu-id="54829-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="54829-161">Questa struttura viene utilizzata per restituire l'identificatore e le caratteristiche della colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="54829-162">**IColumnProvider:: GetColumnInfo** deve assegnare i valori appropriati ai membri della struttura e restituire.</span><span class="sxs-lookup"><span data-stu-id="54829-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="54829-163">Le colonne sono identificate dall'ID del set di proprietà OLE (FMTID) e da un ID di proprietà associato (PID).</span><span class="sxs-lookup"><span data-stu-id="54829-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="54829-164">Il primo membro della struttura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) , **SCID**, è un puntatore a una struttura [**SHCOLUMNID**](/windows/desktop/shell/objects) utilizzata per identificare la colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="54829-165">Il membro **fmtid** include il fmtid della colonna e il relativo membro **PID** include il PID della colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="54829-166">Ad esempio, una coppia FMTID/PID standard comunemente utilizzata per identificare le colonne è il PID autore del set di proprietà informazioni di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="54829-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="54829-167">Se possibile, il gestore deve usare FMTIDs e PID esistenti per identificare la colonna supportata.</span><span class="sxs-lookup"><span data-stu-id="54829-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="54829-168">Se si utilizza una struttura [**SHCOLUMNID**](/windows/desktop/shell/objects) personalizzata, nella colonna verranno visualizzati i dati solo per i file supportati dal gestore.</span><span class="sxs-lookup"><span data-stu-id="54829-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="54829-169">Se la cartella contiene altri file, le relative voci saranno vuote.</span><span class="sxs-lookup"><span data-stu-id="54829-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="54829-170">Se una cartella contiene file di più di un tipo di file, l'utilizzo di valori FMTID/PID standard potrebbe consentire di unire i dati di tipi diversi nella stessa colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="54829-171">Impostare il membro **VT** sul tipo [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant)   dei dati che si desidera visualizzare nella colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="54829-172">Il tipo usato più di frequente è VT \_ LPSTR, in quanto la maggior parte delle colonne Visualizza i dati come stringhe di caratteri.</span><span class="sxs-lookup"><span data-stu-id="54829-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="54829-173">Gli altri membri della struttura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) vengono utilizzati per definire le caratteristiche della colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="54829-174">Assegnare i valori nel modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="54829-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="54829-175">Metodo GetItemData</span><span class="sxs-lookup"><span data-stu-id="54829-175">The GetItemData Method</span></span>

<span data-ttu-id="54829-176">Se è stata selezionata la colonna del gestore colonne, Esplora risorse chiama [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) per ogni file presente nella cartella da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="54829-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="54829-177">Il parametro *pscid* è un puntatore a una struttura [**SHCOLUMNID**](/windows/desktop/shell/objects) che identifica la colonna.</span><span class="sxs-lookup"><span data-stu-id="54829-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="54829-178">Il parametro *PSCD* punta a una struttura [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) che identifica il file specifico.</span><span class="sxs-lookup"><span data-stu-id="54829-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="54829-179">Il parametro *pvarData* restituisce i dati che devono essere visualizzati nella colonna del gestore per il file specificato da *PSCD*.</span><span class="sxs-lookup"><span data-stu-id="54829-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="54829-180">Se il file è supportato dal gestore colonne, assegnare il valore dei dati a *pvarData* e restituire S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="54829-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="54829-181">Se il file non è supportato dal gestore di colonne, restituire S \_ false senza assegnare un valore a *pvarData*.</span><span class="sxs-lookup"><span data-stu-id="54829-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="54829-182">Molte cartelle contengono un numero di file non supportati da alcun gestore di colonna specifico.</span><span class="sxs-lookup"><span data-stu-id="54829-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="54829-183">Per migliorare l'efficienza, [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) deve prima verificare il membro **pwszExt** della struttura a cui punta *PSCD*.</span><span class="sxs-lookup"><span data-stu-id="54829-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="54829-184">Questo membro include l'estensione del nome file.</span><span class="sxs-lookup"><span data-stu-id="54829-184">This member holds the file name extension.</span></span> <span data-ttu-id="54829-185">Se l'estensione indica che il file non è un membro di un tipo di file supportato dal gestore, evitare l'elaborazione non necessaria restituendo immediatamente S \_ false.</span><span class="sxs-lookup"><span data-stu-id="54829-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 