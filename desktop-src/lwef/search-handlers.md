---
title: Creazione di gestori di ricerca
description: La Shell supporta diverse utilità di ricerca che consentono agli utenti di individuare gli oggetti dello spazio dei nomi, ad esempio file o stampanti. È possibile creare un motore di ricerca personalizzato e renderlo disponibile agli utenti implementando e registrando un gestore di ricerca.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- gestori di ricerca
- Register, Cerca gestori
- gestori di ricerca statici
- Register, gestori di ricerca statici
- gestori di ricerca dinamici
- registri, gestori di ricerca dinamici
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337342"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="28d9c-110">Creazione di gestori di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-110">Creating Search Handlers</span></span>

<span data-ttu-id="28d9c-111">\[Questa funzionalità è supportata solo in Windows XP o versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="28d9c-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="28d9c-112">Usare invece Windows Search.\]</span><span class="sxs-lookup"><span data-stu-id="28d9c-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="28d9c-113">La Shell supporta diverse utilità di ricerca che consentono agli utenti di individuare gli oggetti dello spazio dei nomi, ad esempio file o stampanti.</span><span class="sxs-lookup"><span data-stu-id="28d9c-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="28d9c-114">È possibile creare un motore di ricerca personalizzato e renderlo disponibile agli utenti implementando e registrando un *gestore di ricerca*.</span><span class="sxs-lookup"><span data-stu-id="28d9c-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="28d9c-115">Le procedure generali per l'implementazione e la registrazione di un gestore di estensione della shell sono descritte in [creazione di gestori di estensioni della shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="28d9c-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="28d9c-116">Questo documento è incentrato sugli aspetti dell'implementazione specifici dei gestori di ricerca.</span><span class="sxs-lookup"><span data-stu-id="28d9c-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="28d9c-117">Funzionamento del gestore di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="28d9c-118">Registrazione di gestori di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="28d9c-119">Registrazione di un gestore di ricerca statico</span><span class="sxs-lookup"><span data-stu-id="28d9c-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="28d9c-120">Registrazione di un gestore di ricerca dinamico</span><span class="sxs-lookup"><span data-stu-id="28d9c-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="28d9c-121">Implementazione di gestori di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="28d9c-122">Funzionamento del gestore di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-122">How Search Handlers Work</span></span>

<span data-ttu-id="28d9c-123">Gli utenti hanno due modi per selezionare un motore di ricerca.</span><span class="sxs-lookup"><span data-stu-id="28d9c-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="28d9c-124">Il primo consiste nel menu Start.</span><span class="sxs-lookup"><span data-stu-id="28d9c-124">The first way is from the Start menu.</span></span> <span data-ttu-id="28d9c-125">Con i sistemi precedenti a Windows 2000, selezionare il comando **trova** nel menu **Start** per visualizzare un sottomenu dei motori di ricerca disponibili.</span><span class="sxs-lookup"><span data-stu-id="28d9c-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="28d9c-126">Con Windows 2000 e versioni successive, **il comando di ricerca del** menu **St** Art è stato rinominato search.</span><span class="sxs-lookup"><span data-stu-id="28d9c-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="28d9c-127">Nella figura seguente viene illustrato il pulsante **Cerca** in un sistema Windows XP.</span><span class="sxs-lookup"><span data-stu-id="28d9c-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![sottomenu di ricerca del menu Start](images/searchhandler1.jpg)

<span data-ttu-id="28d9c-129">Gli utenti possono anche avviare una ricerca da Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="28d9c-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="28d9c-130">Nei sistemi precedenti a Windows 2000, fare clic sul comando **trova** nel menu **strumenti** per visualizzare essenzialmente lo stesso menu associato al menu **Start** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="28d9c-131">Tuttavia, Esplora risorse di Windows 2000 gestisce i motori di ricerca in modo molto diverso.</span><span class="sxs-lookup"><span data-stu-id="28d9c-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="28d9c-132">Anziché gestire i motori di ricerca come sottomenu del menu **strumenti** , è ora disponibile un pulsante **Cerca** sulla barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="28d9c-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="28d9c-133">Fare clic su questo pulsante per aprire il riquadro di **ricerca** della barra di Explorer.</span><span class="sxs-lookup"><span data-stu-id="28d9c-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="28d9c-134">La figura seguente mostra il riquadro **di ricerca di file e cartelle** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![riquadro di ricerca della barra di Esplora risorse](images/searchhandler2.jpg)

<span data-ttu-id="28d9c-136">Esistono diverse differenze nel modo in cui Windows 2000 e i sistemi precedenti gestiscono i gestori di ricerca che interessano l'implementazione e la registrazione.</span><span class="sxs-lookup"><span data-stu-id="28d9c-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="28d9c-137">Pre-Windows 2000</span><span class="sxs-lookup"><span data-stu-id="28d9c-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="28d9c-138">Windows 2000 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="28d9c-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="28d9c-139">I gestori di ricerca sono implementati come un tipo di [gestore di menu di scelta rapida](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="28d9c-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="28d9c-140">I gestori di ricerca possono essere implementati come gestori di menu di scelta rapida o come documenti DHTML (Dynamic HTML).</span><span class="sxs-lookup"><span data-stu-id="28d9c-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="28d9c-141">I gestori di ricerca possono essere statici o dinamici.</span><span class="sxs-lookup"><span data-stu-id="28d9c-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="28d9c-142">I gestori statici vengono caricati solo quando vengono selezionati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="28d9c-143">I gestori dinamici vengono caricati dalla shell all'avvio e non vengono terminati fino alla chiusura della shell.</span><span class="sxs-lookup"><span data-stu-id="28d9c-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="28d9c-144">I gestori implementati come gestori di menu di scelta rapida possono essere statici o dinamici.</span><span class="sxs-lookup"><span data-stu-id="28d9c-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="28d9c-145">I gestori implementati come documenti DHTML devono essere statici.</span><span class="sxs-lookup"><span data-stu-id="28d9c-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="28d9c-146">I gestori di ricerca vengono visualizzati nel sottomenu **trova** del menu **Start** e nel sottomenu **trova** del menu  **strumenti** di Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="28d9c-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="28d9c-147">I gestori di ricerca vengono visualizzati solo nel sottomenu di **ricerca** del menu **Start** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="28d9c-148">Per rendere disponibile un riquadro di ricerca personalizzato tramite la barra dei menu di Esplora risorse, è necessario implementarlo come [oggetto banda](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="28d9c-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="28d9c-149">Viene quindi elencato nel sottomenu **barra di Explorer** del menu  **visualizzazione** di Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="28d9c-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="28d9c-150">Registrazione di gestori di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-150">Registering Search Handlers</span></span>

<span data-ttu-id="28d9c-151">I gestori di ricerca sono registrati nella sottochiave **FindExtensions** dei tipi di file.</span><span class="sxs-lookup"><span data-stu-id="28d9c-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="28d9c-152">Da questo punto, la procedura di registrazione dipende dal fatto che il gestore sia statico o dinamico.</span><span class="sxs-lookup"><span data-stu-id="28d9c-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="28d9c-153">Per informazioni generali su come registrare i gestori di estensioni della shell, vedere [creazione di gestori di estensioni della shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="28d9c-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="28d9c-154">Registrazione di un gestore di ricerca statico</span><span class="sxs-lookup"><span data-stu-id="28d9c-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="28d9c-155">I gestori di ricerca statici vengono caricati solo quando vengono avviati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="28d9c-156">Questo approccio funziona meglio per le DLL di piccole dimensioni che possono essere caricate rapidamente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="28d9c-157">Se si utilizza DHTML per implementare il gestore, è necessario che sia statico.</span><span class="sxs-lookup"><span data-stu-id="28d9c-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="28d9c-158">Per registrare un gestore di estensioni statiche, creare una sottochiave denominata per il gestore sotto la sottochiave **statica** della sottochiave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="28d9c-159">Il nome non viene utilizzato dal sistema, ma non deve essere identico ad altri nomi di gestori di ricerca nella sottochiave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="28d9c-160">Gestori di ricerca basati sul menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="28d9c-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="28d9c-161">Se il gestore viene implementato come [gestore di menu di scelta rapida](/windows/desktop/shell/context-menu-handlers), impostare il valore predefinito della sottochiave del nome del gestore sul GUID dell'identificatore di classe (CLSID) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="28d9c-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="28d9c-162">Nella sottochiave nome del gestore creare una sottochiave denominata **0**   (zero) e impostarne il valore predefinito sulla stringa che verrà visualizzata nel sottomenu **Cerca** o **trova** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="28d9c-163">È possibile abilitare le scelte rapide da tastiera nel modo consueto, facendo precedere il carattere di collegamento con una e commerciale (&).</span><span class="sxs-lookup"><span data-stu-id="28d9c-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="28d9c-164">È possibile avere un'icona piccola facoltativa visualizzata a destra del testo del menu creando una sottochiave **DefaultIcon** nella sottochiave **0** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="28d9c-165">Impostare il valore predefinito su una stringa contenente il percorso del file contenente l'icona, seguito da una virgola, seguita dall'indice in base zero dell'icona.</span><span class="sxs-lookup"><span data-stu-id="28d9c-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="28d9c-166">Nell'esempio seguente viene registrato il gestore di ricerca **MySearchEngine** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="28d9c-167">Il testo del menu è "motore di ricerca personale", con M specificato come tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="28d9c-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="28d9c-168">L'icona si trova in C: \\ MyDir \\MySearch.dll con indice 2.</span><span class="sxs-lookup"><span data-stu-id="28d9c-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="28d9c-169">Gestori di ricerca basati su DHTML</span><span class="sxs-lookup"><span data-stu-id="28d9c-169">DHTML-based search handlers</span></span>

<span data-ttu-id="28d9c-170">Con Windows 2000, è anche possibile implementare un gestore di ricerca come documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="28d9c-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="28d9c-171">Il nome è elencato nel sottomenu di **ricerca** del menu **Start** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="28d9c-172">Quando l'utente le seleziona, avvia Esplora risorse con la barra di Explorer aperta nel documento di ricerca.</span><span class="sxs-lookup"><span data-stu-id="28d9c-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="28d9c-173">È anche possibile specificare un documento DHTML da visualizzare a destra della barra di Explorer.</span><span class="sxs-lookup"><span data-stu-id="28d9c-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="28d9c-174">Non è possibile avviare un gestore diverso dal riquadro di ricerca predefinito.</span><span class="sxs-lookup"><span data-stu-id="28d9c-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="28d9c-175">I motori di ricerca possono essere avviati direttamente da Esplora risorse, ma solo se sono implementati come [oggetti band](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="28d9c-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="28d9c-176">Per registrare un gestore di ricerca basato su DHTML, impostare la sottochiave del nome del gestore sul formato stringa di CLSID \_ ShellSearchExt (attualmente {169A0691-8DF9-11D1-A1C4-00C04FD75D13}) e creare le sottochiavi seguenti.</span><span class="sxs-lookup"><span data-stu-id="28d9c-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="28d9c-177">Creare una sottochiave **0**(zero) nella sottochiave del nome del gestore e impostarne il valore predefinito sul testo del menu.</span><span class="sxs-lookup"><span data-stu-id="28d9c-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="28d9c-178">Per visualizzare un'icona accanto al testo del menu, creare una sottochiave **DefaultIcon** in **0** e impostarne il valore predefinito sul percorso e sull'indice dell'icona.</span><span class="sxs-lookup"><span data-stu-id="28d9c-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="28d9c-179">Creare una sottochiave **SearchGUID** inferiore a **0**.</span><span class="sxs-lookup"><span data-stu-id="28d9c-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="28d9c-180">Assegnare un GUID al documento DHTML e impostare il valore predefinito di **SearchGUID** sul formato stringa corrispondente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="28d9c-181">Non è necessario registrare questo GUID nel **\_ \_ \\ CLSID radice delle classi HKEY**.</span><span class="sxs-lookup"><span data-stu-id="28d9c-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="28d9c-182">Creare una sottochiave **URL** in **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="28d9c-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="28d9c-183">Impostare il valore predefinito sul percorso del documento HTML che verrà visualizzato nella barra di Explorer.</span><span class="sxs-lookup"><span data-stu-id="28d9c-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="28d9c-184">Creare una sottochiave **UrlNavNew** in **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="28d9c-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="28d9c-185">Impostare il valore predefinito sul percorso del documento HTML che verrà visualizzato a destra della barra di Explorer.</span><span class="sxs-lookup"><span data-stu-id="28d9c-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="28d9c-186">Nell'esempio seguente viene registrato il gestore di ricerca **MySearchEngine** implementato come documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="28d9c-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="28d9c-187">Il testo del menu è "motore di ricerca personale", con M specificato come tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="28d9c-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="28d9c-188">L'icona si trova in C: \\ MyDir \\MySearch.dll con indice 2.</span><span class="sxs-lookup"><span data-stu-id="28d9c-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="28d9c-189">Il documento DHTML della barra di Explorer è C: \\ MyDir \\MySearch.htm e il documento che verrà visualizzato a destra della barra di Explorer è c: \\ mydir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="28d9c-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="28d9c-190">Registrazione di un gestore di ricerca dinamico</span><span class="sxs-lookup"><span data-stu-id="28d9c-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="28d9c-191">Se il gestore viene implementato come [gestore di menu di scelta rapida](/windows/desktop/shell/context-menu-handlers), è possibile registrarlo anche come gestore dinamico.</span><span class="sxs-lookup"><span data-stu-id="28d9c-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="28d9c-192">In tal caso, verrà caricato con la shell e verrà terminato solo quando la shell viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="28d9c-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="28d9c-193">I gestori di ricerca dinamici rispondono molto più rapidamente rispetto ai gestori statici quando vengono avviati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="28d9c-194">Questo approccio funziona meglio se la DLL del gestore potrebbe richiedere molto tempo per il caricamento o se è probabile che venga chiamata di frequente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="28d9c-195">I gestori di ricerca dinamici sono registrati nella sottochiave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="28d9c-196">Creare una sottochiave di **FindExtensions** denominata per il gestore e impostarne il valore predefinito sul GUID del gestore CLSID.</span><span class="sxs-lookup"><span data-stu-id="28d9c-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="28d9c-197">Le icone dei menu non sono supportate per i gestori di ricerca dinamici.</span><span class="sxs-lookup"><span data-stu-id="28d9c-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="28d9c-198">Nell'esempio seguente viene registrato MySearchEngine come gestore di ricerca dinamico.</span><span class="sxs-lookup"><span data-stu-id="28d9c-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="28d9c-199">A differenza dei gestori di ricerca statici, non è necessario specificare il testo del menu nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="28d9c-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="28d9c-200">Quando il gestore viene caricato, la shell chiamerà il metodo [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) del gestore per aggiungere elementi al sottomenu **trova** o **Cerca** .</span><span class="sxs-lookup"><span data-stu-id="28d9c-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="28d9c-201">Implementazione di gestori di ricerca</span><span class="sxs-lookup"><span data-stu-id="28d9c-201">Implementing Search Handlers</span></span>

<span data-ttu-id="28d9c-202">I gestori di ricerca possono essere implementati come gestori di menu di scelta rapida per tutte le versioni di Windows.</span><span class="sxs-lookup"><span data-stu-id="28d9c-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="28d9c-203">Per Windows 2000, possono essere implementati anche come documenti DHTML.</span><span class="sxs-lookup"><span data-stu-id="28d9c-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="28d9c-204">Per informazioni generali su come implementare i gestori dei menu di scelta rapida, vedere [creazione di gestori di menu](/windows/desktop/shell/context-menu-handlers)di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="28d9c-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="28d9c-205">I gestori di ricerca sono diversi dai gestori dei menu di scelta rapida standard in pochi modi.</span><span class="sxs-lookup"><span data-stu-id="28d9c-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="28d9c-206">Per i gestori di menu statici, il sottomenu **trova** o **Cerca** viene creato dalle informazioni nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="28d9c-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="28d9c-207">Non è necessario che il gestore aggiunga una voce di menu, come farebbe un normale gestore di menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="28d9c-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="28d9c-208">La shell gestisce i gestori dei menu statici nel modo seguente.</span><span class="sxs-lookup"><span data-stu-id="28d9c-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="28d9c-209">Quando l'utente avvia la voce di menu del gestore, la Shell carica la DLL del gestore e chiama [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) per notificare al gestore di avviare il motore di ricerca.</span><span class="sxs-lookup"><span data-stu-id="28d9c-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="28d9c-210">I metodi [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) e [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) non vengono chiamati.</span><span class="sxs-lookup"><span data-stu-id="28d9c-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="28d9c-211">Quando viene chiamato [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) , il membro **LpVerb** della struttura [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) passata in identifica il comando.</span><span class="sxs-lookup"><span data-stu-id="28d9c-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="28d9c-212">La parola di ordine inferiore di **lpVerb** è impostata sull'equivalente numerico del nome della sottochiave del comando.</span><span class="sxs-lookup"><span data-stu-id="28d9c-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="28d9c-213">Poiché questa sottochiave è in genere denominata **0**, **lpVerb** è in genere impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="28d9c-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="28d9c-214">Il gestore deve quindi avviare il motore di ricerca.</span><span class="sxs-lookup"><span data-stu-id="28d9c-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="28d9c-215">I gestori di ricerca dinamici sono implementati in modo molto simile ai normali gestori dei menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="28d9c-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="28d9c-216">L'eccezione principale è che quando viene chiamato [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) , gli argomenti *pidlFolder* e *lpdobj* sono impostati su **null**.</span><span class="sxs-lookup"><span data-stu-id="28d9c-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="28d9c-217">I gestori di ricerca basati su DHTML vengono implementati come un normale documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="28d9c-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="28d9c-218">Possono includere qualsiasi tecnologia HTML, DHTML o di scripting supportata da Windows Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="28d9c-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 