---
title: Creazione di un gestore pulitura disco
description: Un assioma collaudato nel mondo dei computer è che, a prescindere dalle dimensioni della capacità di archiviazione del computer, la compilazione verrà compilata.
ms.assetid: f85e0db7-fbdb-452e-90c8-672f716b5692
keywords:
- gestori pulitura disco
- Pulizia disco
- DataDrivenCleaner
- Register, gestori pulitura dischi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30584439ae2c38ae8a9b7106dae96f69eea5df37
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/08/2020
ms.locfileid: "106300584"
---
# <a name="creating-a-disk-cleanup-handler"></a><span data-ttu-id="53862-107">Creazione di un gestore pulitura disco</span><span class="sxs-lookup"><span data-stu-id="53862-107">Creating a Disk Cleanup Handler</span></span>

<span data-ttu-id="53862-108">Un assioma collaudato nel mondo dei computer è che, a prescindere dalle dimensioni della capacità di archiviazione del computer, la compilazione verrà compilata.</span><span class="sxs-lookup"><span data-stu-id="53862-108">One axiom proven time and again in the world of computers is that regardless of the size of your computer's storage capacity, you will eventually fill it up.</span></span> <span data-ttu-id="53862-109">Anche se le dimensioni medie del disco rigido di un computer sono aumentate notevolmente nel tempo, le applicazioni sono aumentate di conseguenza, lasciando agli utenti la possibilità di creare più spazio disponibile su disco rigido.</span><span class="sxs-lookup"><span data-stu-id="53862-109">While the average size of a computer's hard disk has increased dramatically over time, applications have also grown accordingly, leaving users looking for ways to create more free hard disk space.</span></span> <span data-ttu-id="53862-110">Lo spazio disponibile viene ridotto anche dai numerosi file temporanei creati dalle applicazioni per motivi di backup o prestazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-110">Available space is also reduced by the many temporary files that applications create for backup or performance reasons.</span></span> <span data-ttu-id="53862-111">Quando lo spazio su disco diventa basso, diventa necessario ridurre la quantità di spazio utilizzata dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-111">When disk space becomes low, it becomes necessary to reduce the amount of space used by applications.</span></span> <span data-ttu-id="53862-112">Lo spazio su disco può essere liberato utilizzando diversi mezzi, inclusi i seguenti:</span><span class="sxs-lookup"><span data-stu-id="53862-112">Disk space can be freed using a variety of means, including the following:</span></span>

-   <span data-ttu-id="53862-113">Eliminazione di file.</span><span class="sxs-lookup"><span data-stu-id="53862-113">Deleting files.</span></span>
-   <span data-ttu-id="53862-114">Compressione di file.</span><span class="sxs-lookup"><span data-stu-id="53862-114">Compressing files.</span></span>
-   <span data-ttu-id="53862-115">Trasferimento di file in un supporto di backup.</span><span class="sxs-lookup"><span data-stu-id="53862-115">Moving files to a backup medium.</span></span>
-   <span data-ttu-id="53862-116">Trasferimento di file in un server remoto.</span><span class="sxs-lookup"><span data-stu-id="53862-116">Transferring files to a remote server.</span></span>

<span data-ttu-id="53862-117">I file che sono candidati validi per la pulizia includono:</span><span class="sxs-lookup"><span data-stu-id="53862-117">Files that are good candidates for cleanup include:</span></span>

-   <span data-ttu-id="53862-118">File che l'utente non dovrà mai più utilizzare.</span><span class="sxs-lookup"><span data-stu-id="53862-118">Files that the user will never need again.</span></span>
-   <span data-ttu-id="53862-119">File temporanei che esistono solo per motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-119">Temporary files that exist only for performance reasons.</span></span>
-   <span data-ttu-id="53862-120">File che possono essere ripristinati, se necessario, da un CD di installazione.</span><span class="sxs-lookup"><span data-stu-id="53862-120">Files that can be restored, if needed, from an installation CD.</span></span>
-   <span data-ttu-id="53862-121">File di dati che potrebbero essere stati sostituiti da versioni più recenti, ad esempio file di backup obsoleti.</span><span class="sxs-lookup"><span data-stu-id="53862-121">Data files that have possibly been superseded by newer versions, such as old backup files.</span></span>
-   <span data-ttu-id="53862-122">File meno recenti che non sono stati utilizzati da molto tempo.</span><span class="sxs-lookup"><span data-stu-id="53862-122">Older files that have not been used in a long time.</span></span>

<span data-ttu-id="53862-123">L'eliminazione è particolarmente appropriata per i file che non saranno mai necessari all'utente, ad esempio file temporaneamente memorizzati nella cache per motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-123">Deletion is particularly appropriate for files that the user will never need again for example, files that are temporarily cached for performance reasons.</span></span> <span data-ttu-id="53862-124">L'eliminazione è appropriata anche per i file facilmente ripristinabili, ad esempio i file di grafica che possono essere ricaricati da un CD di installazione.</span><span class="sxs-lookup"><span data-stu-id="53862-124">Deletion is also appropriate for files that are easily restored, such as graphics files that can be reloaded from an installation CD.</span></span> <span data-ttu-id="53862-125">I file che l'utente potrebbe richiedere in un secondo momento o che sarebbero difficili da ricostruire sono candidati migliori per la compressione o il backup.</span><span class="sxs-lookup"><span data-stu-id="53862-125">Files that the user might need later or that would be difficult to reconstruct are better candidates for compression or backup.</span></span>

<span data-ttu-id="53862-126">Se un utente deve pulire manualmente il file system non è una soluzione valida.</span><span class="sxs-lookup"><span data-stu-id="53862-126">Expecting a user to manually clean the file system is not a good solution.</span></span> <span data-ttu-id="53862-127">L'utente potrebbe non sapere dove si trovano molti file o come riconoscere quelli che possono essere rimossi in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="53862-127">The user may not know where many of the files are located or how to recognize which ones can be safely removed.</span></span> <span data-ttu-id="53862-128">Inoltre, esiste il rischio che l'utente possa eliminare i file essenziali.</span><span class="sxs-lookup"><span data-stu-id="53862-128">In addition, there's the risk that the user might delete essential files.</span></span>

<span data-ttu-id="53862-129">In questo argomento vengono descritti i facet seguenti dell'utilità Pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-129">The following facets of the Disk Cleanup utility are discussed in this topic.</span></span>

-   [<span data-ttu-id="53862-130">Utilità pulizia dischi di Windows</span><span class="sxs-lookup"><span data-stu-id="53862-130">The Windows Disk Cleanup Utility</span></span>](#the-windows-disk-cleanup-utility)
-   [<span data-ttu-id="53862-131">Nozioni fondamentali sull'implementazione</span><span class="sxs-lookup"><span data-stu-id="53862-131">Implementation Basics</span></span>](#implementation-basics)
    -   [<span data-ttu-id="53862-132">Initialize/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="53862-132">Initialize/InitializeEx</span></span>](#initializeinitializeex)
    -   [<span data-ttu-id="53862-133">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="53862-133">GetSpaceUsed</span></span>](#getspaceused)
    -   [<span data-ttu-id="53862-134">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="53862-134">ShowProperties</span></span>](#showproperties)
    -   [<span data-ttu-id="53862-135">Ripulisci</span><span class="sxs-lookup"><span data-stu-id="53862-135">Purge</span></span>](#purge)
    -   [<span data-ttu-id="53862-136">Disattivare</span><span class="sxs-lookup"><span data-stu-id="53862-136">Deactivate</span></span>](#deactivate)
-   [<span data-ttu-id="53862-137">Registrazione di un gestore pulitura disco</span><span class="sxs-lookup"><span data-stu-id="53862-137">Registering a Disk Cleanup Handler</span></span>](#registering-a-disk-cleanup-handler)
    -   [<span data-ttu-id="53862-138">Registrazione del CLSID di un gestore</span><span class="sxs-lookup"><span data-stu-id="53862-138">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
    -   [<span data-ttu-id="53862-139">Registrazione di un gestore con Gestione pulitura disco: generale</span><span class="sxs-lookup"><span data-stu-id="53862-139">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
    -   [<span data-ttu-id="53862-140">Registrazione di un gestore con Gestione pulitura disco: sistemi Windows 2000 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="53862-140">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
    -   [<span data-ttu-id="53862-141">Utilizzo dell'oggetto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="53862-141">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
    -   [<span data-ttu-id="53862-142">Registrazione di esempio di un gestore di pulitura del disco</span><span class="sxs-lookup"><span data-stu-id="53862-142">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

## <a name="the-windows-disk-cleanup-utility"></a><span data-ttu-id="53862-143">Utilità pulizia dischi di Windows</span><span class="sxs-lookup"><span data-stu-id="53862-143">The Windows Disk Cleanup Utility</span></span>

<span data-ttu-id="53862-144">A partire da Windows 98, il sistema operativo Windows include la pulizia dei dischi, un'utilità che rende molto più semplice per l'utente gestire lo spazio disponibile su disco rigido.</span><span class="sxs-lookup"><span data-stu-id="53862-144">Starting on Windows 98, the Windows operating system includes Disk Cleanup, a utility that makes it much easier for the user to manage available hard disk space.</span></span> <span data-ttu-id="53862-145">L'utilità Pulitura disco è progettata per liberare lo spazio su disco possibile e ridurre il rischio che l'utente elimini accidentalmente i file essenziali.</span><span class="sxs-lookup"><span data-stu-id="53862-145">The Disk Cleanup utility is designed to free up as much disk space as possible and decrease the risk that the user will delete essential files accidentally.</span></span>

<span data-ttu-id="53862-146">È possibile avviare la pulizia del disco in tre modi.</span><span class="sxs-lookup"><span data-stu-id="53862-146">Disk cleanup can be initiated in three ways.</span></span>

-   <span data-ttu-id="53862-147">L'utente può avviare la pulizia del disco facendo clic sul pulsante **Start**; puntare a **tutti i programmi**, **Accessori** e **strumenti di sistema**; e quindi fare clic su **Pulitura disco**.</span><span class="sxs-lookup"><span data-stu-id="53862-147">The user can initiate disk cleanup by clicking **Start**; pointing to **All Programs**, **Accessories**, and **System Tools**; and then clicking **Disk Cleanup**.</span></span>
-   <span data-ttu-id="53862-148">Il sistema notifica all'utente una finestra di messaggio in cui lo spazio su disco inutilizzato ha raggiunto la modalità critica.</span><span class="sxs-lookup"><span data-stu-id="53862-148">The system notifies the user with a message box that unused disk space has reached critical mode.</span></span> <span data-ttu-id="53862-149">La soglia della modalità critica per un'unità di dimensioni superiori a 2,25 gigabyte (GB) è 200 megabyte (MB).</span><span class="sxs-lookup"><span data-stu-id="53862-149">The critical mode threshold for a drive larger than 2.25 gigabytes (GB) is 200 megabytes (MB).</span></span> <span data-ttu-id="53862-150">Gli avvisi successivi sono assegnati a 80, 50 e 1 MB.</span><span class="sxs-lookup"><span data-stu-id="53862-150">Subsequent warnings are given at 80, 50, and 1 MB.</span></span> <span data-ttu-id="53862-151">L'utente ha la possibilità di liberare spazio su disco manualmente o di avviare l'utilità di pulitura del disco.</span><span class="sxs-lookup"><span data-stu-id="53862-151">The user is given the option of freeing disk space manually or starting the Disk Cleanup utility.</span></span>
-   <span data-ttu-id="53862-152">L'utente può avere la creazione guidata attività pianificata di Windows (nota come manutenzione guidata nei sistemi meno recenti) eseguire automaticamente l'utilità di pulitura del disco in orari pianificati.</span><span class="sxs-lookup"><span data-stu-id="53862-152">The user can have the Windows Scheduled Task Wizard (known as the Maintenance Wizard on older systems) run the Disk Cleanup utility automatically at scheduled times.</span></span>

<span data-ttu-id="53862-153">La sfida di base inerente alla pulizia dei dischi è liberare il maggior spazio su disco possibile senza eliminare i file essenziali.</span><span class="sxs-lookup"><span data-stu-id="53862-153">The basic challenge inherent in disk cleanup is to free as much disk space as possible without deleting essential files.</span></span> <span data-ttu-id="53862-154">Poiché non esiste un modo standard per contrassegnare i file per la pulizia, nessuna singola applicazione può rilevare e pulire in modo affidabile tutti i file non essenziali.</span><span class="sxs-lookup"><span data-stu-id="53862-154">Because there is no standard way to mark files for cleanup, no single application can reliably detect and clean all unessential files.</span></span> <span data-ttu-id="53862-155">L'utilità pulizia dischi risolve questo problema suddividendo l'operazione di pulizia tra un singolo *gestore pulizia dischi* e una raccolta di *gestori di pulitura disco*.</span><span class="sxs-lookup"><span data-stu-id="53862-155">The Disk Cleanup utility addresses this problem by splitting the cleanup operation between a single *disk cleanup manager* and a collection of *disk cleanup handlers*.</span></span>

<span data-ttu-id="53862-156">Quando viene eseguita l'utilità Pulitura disco, l'utente Visualizza la finestra di dialogo seguente.</span><span class="sxs-lookup"><span data-stu-id="53862-156">When the Disk Cleanup utility is run, the user sees the following dialog box.</span></span> <span data-ttu-id="53862-157">Se nel computer è presente più di una partizione disco o disco, all'utente viene prima richiesta la scelta di un'unità prima che venga visualizzata la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="53862-157">(If more than one disk or disk partition exists on the computer, the user is first asked to choose a drive before this dialog is displayed.)</span></span>

![screenshot della finestra di dialogo Pulisci](images/cleanup1.png)

<span data-ttu-id="53862-159">Gestione pulizia dischi fa parte del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="53862-159">The disk cleanup manager is part of the operating system.</span></span> <span data-ttu-id="53862-160">Viene visualizzata la finestra di dialogo illustrata nella figura precedente, viene gestito l'input dell'utente e viene gestita l'operazione di pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-160">It displays the dialog box shown in the preceding illustration, handles user input, and manages the cleanup operation.</span></span> <span data-ttu-id="53862-161">La selezione e la pulizia effettive dei file non necessari vengono eseguite dai singoli gestori di pulitura del disco visualizzati nella casella di riepilogo di gestione pulizia dischi.</span><span class="sxs-lookup"><span data-stu-id="53862-161">The actual selection and cleanup of unneeded files is done by the individual disk cleanup handlers shown in the disk cleanup manager's list box.</span></span> <span data-ttu-id="53862-162">L'utente ha la possibilità di abilitare o disabilitare i singoli gestori selezionando o deselezionando la casella di controllo nell'interfaccia utente di gestione pulizia dischi.</span><span class="sxs-lookup"><span data-stu-id="53862-162">The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.</span></span>

<span data-ttu-id="53862-163">Ogni gestore è responsabile di un set di file ben definito.</span><span class="sxs-lookup"><span data-stu-id="53862-163">Each handler is responsible for a well defined set of files.</span></span> <span data-ttu-id="53862-164">Il gestore selezionato nell'illustrazione, ad esempio, è responsabile della pulizia dei file di programma scaricati.</span><span class="sxs-lookup"><span data-stu-id="53862-164">For example, the selected handler in the illustration is responsible for cleaning up downloaded program files.</span></span> <span data-ttu-id="53862-165">Il gestore selezionato nell'illustrazione fornisce anche un pulsante **Visualizza file** .</span><span class="sxs-lookup"><span data-stu-id="53862-165">The handler selected in the illustration also provides a **View Files** button.</span></span> <span data-ttu-id="53862-166">Facendo clic sul pulsante, l'utente può richiedere al gestore di visualizzare un'interfaccia utente in genere una finestra di Esplora risorse che consente all'utente di specificare i file o le classi di file da pulire.</span><span class="sxs-lookup"><span data-stu-id="53862-166">By clicking the button, the user can request that the handler display a UI typically a Windows Explorer window that allows the user to specify which files or classes of files to clean.</span></span>

<span data-ttu-id="53862-167">Sebbene Windows sia dotato di un numero di gestori di pulitura del disco, non è progettato per gestire i file prodotti da altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-167">Although Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.</span></span> <span data-ttu-id="53862-168">Il gestore pulitura disco è invece progettato per essere flessibile ed estendibile, consentendo a tutti gli sviluppatori di implementare e registrare il proprio gestore pulitura dischi.</span><span class="sxs-lookup"><span data-stu-id="53862-168">Instead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.</span></span> <span data-ttu-id="53862-169">Tutti gli sviluppatori possono estendere i servizi di pulizia dischi disponibili implementando e registrando un gestore pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-169">Any developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.</span></span>

<span data-ttu-id="53862-170">Tutte le applicazioni che producono file temporanei possono e devono implementare e registrare un gestore pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-170">All applications that produce temporary files can and should implement and register a disk cleanup handler.</span></span> <span data-ttu-id="53862-171">In questo modo si offre agli utenti un modo pratico e affidabile per gestire i file temporanei dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="53862-171">Doing so gives users a convenient and reliable way to manage the application's temporary files.</span></span> <span data-ttu-id="53862-172">Quando si implementa il gestore, è possibile decidere quali file sono interessati e determinare il modo in cui viene eseguita la pulizia effettiva.</span><span class="sxs-lookup"><span data-stu-id="53862-172">When you implement the handler, you can decide which files are affected and determine how the actual cleanup happens.</span></span>

## <a name="implementation-basics"></a><span data-ttu-id="53862-173">Nozioni fondamentali sull'implementazione</span><span class="sxs-lookup"><span data-stu-id="53862-173">Implementation Basics</span></span>

<span data-ttu-id="53862-174">I gestori di pulitura sono oggetti del server Component Object Model (COM) in-process.</span><span class="sxs-lookup"><span data-stu-id="53862-174">Cleanup handlers are in-process server Component Object Model (COM) objects.</span></span> <span data-ttu-id="53862-175">Windows fornisce un oggetto gestore esistente denominato DataDrivenCleaner per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="53862-175">Windows provides an existing handler object called the DataDrivenCleaner for your use.</span></span> <span data-ttu-id="53862-176">È anche possibile scegliere di implementare un gestore per maggiore flessibilità.</span><span class="sxs-lookup"><span data-stu-id="53862-176">You can also opt to implement a handler yourself for more flexibility.</span></span> <span data-ttu-id="53862-177">Questi oggetti consentono quindi di specificare come selezionare i file, liberare spazio su disco e, nel caso di un gestore implementato, visualizzare l'interfaccia utente facoltativa per un controllo più granulare.</span><span class="sxs-lookup"><span data-stu-id="53862-177">These objects then allow you to specify how to select files, free disk space, and, in the case of an implemented handler, display the optional UI for more granular control.</span></span> <span data-ttu-id="53862-178">In questa sezione viene illustrata l'implementazione di un gestore personalizzato.</span><span class="sxs-lookup"><span data-stu-id="53862-178">This section addresses the matter of implementing your own handler.</span></span> <span data-ttu-id="53862-179">Per informazioni dettagliate sull'uso dell'oggetto DataDrivenCleaner, vedere [using the DataDrivenCleaner Object](#using-the-datadrivencleaner-object).</span><span class="sxs-lookup"><span data-stu-id="53862-179">For details concerning the use of the DataDrivenCleaner object, see [Using the DataDrivenCleaner Object](#using-the-datadrivencleaner-object).</span></span>

<span data-ttu-id="53862-180">Un gestore pulitura dischi deve eseguire queste cinque attività di base.</span><span class="sxs-lookup"><span data-stu-id="53862-180">A disk cleanup handler should perform these five basic tasks.</span></span>

-   <span data-ttu-id="53862-181">Inizializzare l'oggetto gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-181">Initialize the handler object.</span></span>
-   <span data-ttu-id="53862-182">Eseguire la scansione del disco per determinare la quantità di spazio su disco che è possibile liberare.</span><span class="sxs-lookup"><span data-stu-id="53862-182">Scan the disk to determine how much disk space can be freed.</span></span>
-   <span data-ttu-id="53862-183">Consente di visualizzare l'interfaccia utente per ottenere i commenti e i suggerimenti degli utenti sui file da pulire.</span><span class="sxs-lookup"><span data-stu-id="53862-183">Display the UI to obtain user feedback about which files to clean.</span></span> <span data-ttu-id="53862-184">Facoltativa</span><span class="sxs-lookup"><span data-stu-id="53862-184">(Optional)</span></span>
-   <span data-ttu-id="53862-185">Eseguire la pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-185">Do the cleanup.</span></span>
-   <span data-ttu-id="53862-186">Spegni.</span><span class="sxs-lookup"><span data-stu-id="53862-186">Shut down.</span></span>

<span data-ttu-id="53862-187">Per consentire a gestione pulizia dischi di gestire queste attività, è necessario che un gestore esporti [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) per Windows 98 o [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) per Windows Millennium Edition (Windows Me), Windows 2000 e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="53862-187">To allow the disk cleanup manager to manage these tasks, a handler must export either [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) for Windows 98 or [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) for Windows Millennium Edition (Windows Me), Windows 2000, and Windows XP.</span></span> <span data-ttu-id="53862-188">Poiché **IEmptyVolumeCache2** eredita da **IEmptyVolumeCache**, aggiungendo solo il metodo aggiuntivo **InitializeEx**, è necessario un lavoro aggiuntivo relativamente piccolo per implementare entrambi.</span><span class="sxs-lookup"><span data-stu-id="53862-188">Because **IEmptyVolumeCache2** inherits from **IEmptyVolumeCache**, adding only the additional method **InitializeEx**, relatively little extra work is required to implement both.</span></span> <span data-ttu-id="53862-189">A meno che il gestore non sia destinato solo a uno di questi sistemi operativi, deve esportare entrambe le interfacce.</span><span class="sxs-lookup"><span data-stu-id="53862-189">Unless your handler is intended for only one of these operating systems, it should export both interfaces.</span></span>

<span data-ttu-id="53862-190">Per esportare queste interfacce, è necessario implementare questi metodi corrispondenti alle cinque attività di base.</span><span class="sxs-lookup"><span data-stu-id="53862-190">To export these interfaces, you must implement these methods corresponding to the five basic tasks.</span></span>

-   [<span data-ttu-id="53862-191">Initialize/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="53862-191">Initialize/InitializeEx</span></span>](#initializeinitializeex)
-   [<span data-ttu-id="53862-192">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="53862-192">GetSpaceUsed</span></span>](#getspaceused)
-   [<span data-ttu-id="53862-193">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="53862-193">ShowProperties</span></span>](#showproperties)
-   [<span data-ttu-id="53862-194">Ripulisci</span><span class="sxs-lookup"><span data-stu-id="53862-194">Purge</span></span>](#purge)
-   [<span data-ttu-id="53862-195">Disattivare</span><span class="sxs-lookup"><span data-stu-id="53862-195">Deactivate</span></span>](#deactivate)

### <a name="initializeinitializeex"></a><span data-ttu-id="53862-196">Initialize/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="53862-196">Initialize/InitializeEx</span></span>

<span data-ttu-id="53862-197">I due metodi di inizializzazione, che sono molto simili, vengono chiamati quando viene eseguita l'utilità di pulitura del disco.</span><span class="sxs-lookup"><span data-stu-id="53862-197">The two initialization methods, which are quite similar, are called when the Disk Cleanup utility is run.</span></span> <span data-ttu-id="53862-198">Gestione pulizia disco di Windows 98 chiama il metodo [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) di un gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-198">The Windows 98 disk cleanup manager calls a handler's [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) method.</span></span> <span data-ttu-id="53862-199">Windows Millennium Edition (Windows Me), Windows 2000 o Windows XP Disk Cleanup Manager, tuttavia, tenta prima di tutto di chiamare [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) e USA **IEmptyVolumeCache:: Initialize** solo se [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) non è esposto dal gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-199">The Windows Millennium Edition (Windows Me), Windows 2000, or Windows XP disk cleanup manager, however, first tries calling [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) and only uses **IEmptyVolumeCache::Initialize** if [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) is not exposed by the handler.</span></span> <span data-ttu-id="53862-200">Gestione pulizia dischi passa informazioni al metodo, ad esempio la chiave del registro di sistema del gestore e il volume del disco da pulire.</span><span class="sxs-lookup"><span data-stu-id="53862-200">The disk cleanup manager passes information to the method, such as the handler's registry key and the disk volume that is to be cleaned.</span></span>

<span data-ttu-id="53862-201">Entrambi i metodi possono restituire varie stringhe di visualizzazione e impostare uno o più flag.</span><span class="sxs-lookup"><span data-stu-id="53862-201">Either method can return various display strings and set one or more flags.</span></span> <span data-ttu-id="53862-202">La differenza principale tra i due metodi è il modo in cui viene gestito il testo visualizzato in Gestione pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-202">The primary difference between the two methods is how the text displayed in the disk cleanup manager is handled.</span></span> <span data-ttu-id="53862-203">Le tre stringhe seguenti sono interessate.</span><span class="sxs-lookup"><span data-stu-id="53862-203">The following three strings are affected.</span></span>



| <span data-ttu-id="53862-204">string</span><span class="sxs-lookup"><span data-stu-id="53862-204">String</span></span>       | <span data-ttu-id="53862-205">Scopo</span><span class="sxs-lookup"><span data-stu-id="53862-205">Purpose</span></span>                                                                            | <span data-ttu-id="53862-206">Inizializzare</span><span class="sxs-lookup"><span data-stu-id="53862-206">Initialize</span></span>                                                                           | <span data-ttu-id="53862-207">InitializeEx</span><span class="sxs-lookup"><span data-stu-id="53862-207">InitializeEx</span></span>                                                                                     |
|--------------|------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="53862-208">Nome visualizzato</span><span class="sxs-lookup"><span data-stu-id="53862-208">Display Name</span></span> | <span data-ttu-id="53862-209">Nome del gestore visualizzato nella casella di riepilogo di gestione pulizia dischi.</span><span class="sxs-lookup"><span data-stu-id="53862-209">The handler's name displayed in the disk cleanup manager's list box.</span></span>               | <span data-ttu-id="53862-210">Se *ppwszDisplayName* è **null**, il valore predefinito viene recuperato dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-210">If *ppwszDisplayName* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="53862-211">È necessario specificare una stringa localizzata correttamente in *ppwszDisplayName* . non viene usato alcun valore del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-211">A properly localized string must be specified in *ppwszDisplayName* no registry values are used.</span></span> |
| <span data-ttu-id="53862-212">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53862-212">Description</span></span>  | <span data-ttu-id="53862-213">Testo descrittivo visualizzato sotto la casella di riepilogo quando viene selezionato il nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-213">Descriptive text displayed below the list box when the handler's name is selected.</span></span> | <span data-ttu-id="53862-214">Se *ppwszDescription* è **null**, il valore predefinito viene recuperato dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-214">If *ppwszDescription* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="53862-215">È necessario specificare una stringa localizzata correttamente in *ppwszDescription* . non viene usato alcun valore del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-215">A properly localized string must be specified in *ppwszDescription* no registry values are used.</span></span> |
| <span data-ttu-id="53862-216">Testo pulsante</span><span class="sxs-lookup"><span data-stu-id="53862-216">Button Text</span></span>  | <span data-ttu-id="53862-217">Testo per il pulsante facoltativo che consente agli utenti di visualizzare l'interfaccia utente del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-217">Text for the optional button that allows users to display the handler's UI.</span></span>        | <span data-ttu-id="53862-218">Nessun parametro disponibile.</span><span class="sxs-lookup"><span data-stu-id="53862-218">No parameter available.</span></span> <span data-ttu-id="53862-219">Deve essere specificato nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-219">Must be specified in the registry.</span></span>                           | <span data-ttu-id="53862-220">È necessario specificare una stringa localizzata correttamente in *ppwszBtnText* . non viene usato alcun valore del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-220">A properly localized string must be specified in *ppwszBtnText* no registry values are used.</span></span>     |



 

<span data-ttu-id="53862-221">Il parametro *pdwFlags* trovato in entrambi i metodi di inizializzazione riconosce lo stesso set di flag.</span><span class="sxs-lookup"><span data-stu-id="53862-221">The *pdwFlags* parameter found in both initialization methods recognizes the same set of flags.</span></span> <span data-ttu-id="53862-222">Due di questi flag vengono passati al metodo da Gestione pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-222">Two of these flags are passed to the method by the disk cleanup manager.</span></span>

-   <span data-ttu-id="53862-223">**\_SETTINGSMODE EVCF**</span><span class="sxs-lookup"><span data-stu-id="53862-223">**EVCF\_SETTINGSMODE**</span></span>

    <span data-ttu-id="53862-224">Se il gestore pulitura disco viene eseguito in base a una pianificazione, imposta il flag **\_ SETTINGSMODE di EVCF** .</span><span class="sxs-lookup"><span data-stu-id="53862-224">If the disk cleanup manager is being run on a schedule, it sets the **EVCF\_SETTINGSMODE** flag.</span></span> <span data-ttu-id="53862-225">Se questo flag è impostato, Gestione pulitura disco non chiama i metodi [GetSpaceUsed](#getspaceused), [Purge](#purge)o [showProperties](#showproperties) .</span><span class="sxs-lookup"><span data-stu-id="53862-225">If this flag is set, the disk cleanup manager does not call the [GetSpaceUsed](#getspaceused), [Purge](#purge), or [ShowProperties](#showproperties) methods.</span></span> <span data-ttu-id="53862-226">Il metodo [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) o [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) del gestore deve gestire tutte le attività normalmente eseguite da [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) ed [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span><span class="sxs-lookup"><span data-stu-id="53862-226">The handler's [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) method must handle all of the tasks normally performed by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) and [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span></span> <span data-ttu-id="53862-227">Poiché non è possibile inviare commenti e suggerimenti degli utenti, è necessario toccare solo i file estremamente sicuri da pulire.</span><span class="sxs-lookup"><span data-stu-id="53862-227">Because there is no opportunity for user feedback, only those files that are extremely safe to clean up should be touched.</span></span> <span data-ttu-id="53862-228">È consigliabile ignorare il parametro *pcwszVolume* del metodo di inizializzazione e pulire i file non necessari indipendentemente dall'unità in cui si trovano.</span><span class="sxs-lookup"><span data-stu-id="53862-228">You should ignore the initialization method's *pcwszVolume* parameter and clean unneeded files regardless of what drive they are on.</span></span>

-   <span data-ttu-id="53862-229">**\_OUTOFDISKSPACE EVCF**</span><span class="sxs-lookup"><span data-stu-id="53862-229">**EVCF\_OUTOFDISKSPACE**</span></span>

    <span data-ttu-id="53862-230">Se viene impostato il flag **EVCF \_ OUTOFDISKSPACE** , l'unità disco dell'utente è insufficiente.</span><span class="sxs-lookup"><span data-stu-id="53862-230">If the **EVCF\_OUTOFDISKSPACE** flag is set, the user's disk drive is critically short of space.</span></span> <span data-ttu-id="53862-231">Il gestore deve essere aggressivo per eliminare i file, anche se comporta una perdita di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="53862-231">The handler should be aggressive about deleting files, even if it results in a performance loss.</span></span> <span data-ttu-id="53862-232">Tuttavia, il gestore non deve ovviamente eliminare i file che potrebbero causare un errore dell'applicazione o la perdita dei dati da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="53862-232">However, the handler obviously should not delete files that would cause an application to fail or the user to lose data.</span></span>

<span data-ttu-id="53862-233">I flag rimanenti vengono impostati dal gestore pulitura disco e restituiti al gestore pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-233">The remaining flags are set by the disk cleanup handler and returned to the disk cleanup manager.</span></span> <span data-ttu-id="53862-234">Per ulteriori informazioni, vedere le pagine di riferimento del metodo per [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) e [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="53862-234">For more information, see the method reference pages for [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) and [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span>

-   <span data-ttu-id="53862-235">\_DONTSHOWIFZERO EVCF</span><span class="sxs-lookup"><span data-stu-id="53862-235">EVCF\_DONTSHOWIFZERO</span></span>

    <span data-ttu-id="53862-236">Visualizza il gestore nella casella di riepilogo di gestione pulizia dischi solo se il valore restituito da [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indica che il gestore può liberare spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="53862-236">Display the handler in the disk cleanup manager's list box only if the value returned by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indicates that the handler can free some disk space.</span></span>

-   <span data-ttu-id="53862-237">\_ENABLEBYDEFAULT EVCF</span><span class="sxs-lookup"><span data-stu-id="53862-237">EVCF\_ENABLEBYDEFAULT</span></span>

    <span data-ttu-id="53862-238">Specifica che il gestore è abilitato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="53862-238">Specifies that the handler is enabled by default.</span></span> <span data-ttu-id="53862-239">Viene eseguito ogni volta che viene eseguita una pulizia del disco, a meno che l'utente non lo Disabilita deselezionando la relativa casella di controllo nell'elenco dei gestori di Gestione pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-239">It will run every time a disk cleanup takes place unless the user disables it by clearing its check box in the disk cleanup manager's list of handlers.</span></span>

-   <span data-ttu-id="53862-240">EVCF \_ ENABLEBYDEFAULT \_ auto</span><span class="sxs-lookup"><span data-stu-id="53862-240">EVCF\_ENABLEBYDEFAULT\_AUTO</span></span>

    <span data-ttu-id="53862-241">Specifica che il gestore viene abilitato automaticamente per l'esecuzione durante le pulizie pianificate.</span><span class="sxs-lookup"><span data-stu-id="53862-241">Specifies that the handler is automatically enabled to run during scheduled cleanups.</span></span>

-   <span data-ttu-id="53862-242">\_HASSETTINGS EVCF</span><span class="sxs-lookup"><span data-stu-id="53862-242">EVCF\_HASSETTINGS</span></span>

    <span data-ttu-id="53862-243">Impostare questo flag se il gestore dispone di un'interfaccia utente da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="53862-243">Set this flag if your handler has a UI to display.</span></span> <span data-ttu-id="53862-244">In risposta, Gestione pulitura disco Visualizza un pulsante quando tale gestore è selezionato nella casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="53862-244">In response, the disk cleanup manager displays a button when that handler is selected in the list box.</span></span> <span data-ttu-id="53862-245">Se si fa clic su tale pulsante, il gestore pulitura disco chiama [**showProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span><span class="sxs-lookup"><span data-stu-id="53862-245">If that button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span></span>

-   <span data-ttu-id="53862-246">\_REMOVEFROMLIST EVCF</span><span class="sxs-lookup"><span data-stu-id="53862-246">EVCF\_REMOVEFROMLIST</span></span>

    <span data-ttu-id="53862-247">Eliminare il nome del gestore dall'elenco dei gestori disponibili dopo che il gestore è stato eseguito una sola volta.</span><span class="sxs-lookup"><span data-stu-id="53862-247">Delete the handler's name from the list of available handlers after the handler has been run once.</span></span> <span data-ttu-id="53862-248">Vengono eliminate anche le informazioni del registro di sistema del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-248">The handler's registry information is also deleted.</span></span>

### <a name="getspaceused"></a><span data-ttu-id="53862-249">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="53862-249">GetSpaceUsed</span></span>

<span data-ttu-id="53862-250">Il gestore pulitura disco chiama questo metodo per determinare la quantità di spazio che un gestore pulitura dischi può potenzialmente liberare.</span><span class="sxs-lookup"><span data-stu-id="53862-250">The disk cleanup manager calls this method to determine how much space a disk cleanup handler can potentially free.</span></span> <span data-ttu-id="53862-251">Il gestore pulitura disco Visualizza quindi il valore a destra del nome del gestore nella casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="53862-251">The disk cleanup manager then displays that value to the right of the handler's name in the list box.</span></span> <span data-ttu-id="53862-252">Questa operazione viene eseguita su tutti i gestori registrati con Gestione pulitura disco quando viene avviato il gestore e prima che venga visualizzata l'interfaccia utente principale del Manager.</span><span class="sxs-lookup"><span data-stu-id="53862-252">This operation is performed on all of the handlers registered with the disk cleanup manager when the manager is launched and before the manager's main UI is displayed.</span></span> <span data-ttu-id="53862-253">Quando viene chiamato [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) , il gestore deve eseguire la scansione dei file di cui è responsabile, determinare quali sono i candidati per la pulizia e restituire la quantità di spazio su disco che può liberare.</span><span class="sxs-lookup"><span data-stu-id="53862-253">When [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) is called, the handler should scan the files that it is responsible for, determine which of them are cleanup candidates, and return the amount of disk space that it can free.</span></span>

<span data-ttu-id="53862-254">Poiché l'analisi può essere un processo lungo, Gestione pulitura dischi usa il parametro *picB* del metodo per passare un puntatore a un'interfaccia [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) .</span><span class="sxs-lookup"><span data-stu-id="53862-254">Because scanning can be a lengthy process, the disk cleanup manager uses this method's *picb* parameter to pass a pointer to an [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="53862-255">Il gestore utilizza l'interfaccia periodicamente durante l'analisi per chiamare [**IEmptyVolumeCacheCallBack:: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), che svolge due finalità.</span><span class="sxs-lookup"><span data-stu-id="53862-255">The handler uses the interface periodically during the scan to call [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), which serves two purposes.</span></span>

-   <span data-ttu-id="53862-256">Consente a gestione pulizia disco di aggiornare un indicatore di stato, indicando all'utente la modalità di avanzamento dell'analisi.</span><span class="sxs-lookup"><span data-stu-id="53862-256">Allows the disk cleanup manager to update a progress bar, informing the user how the scan is progressing.</span></span>
-   <span data-ttu-id="53862-257">Notifica al gestore di arrestare l'analisi nel caso in cui venga fatto clic sul pulsante **Annulla** della finestra di stato.</span><span class="sxs-lookup"><span data-stu-id="53862-257">Notifies the handler to stop the scan in the event that the progress window's **Cancel** button is clicked.</span></span> <span data-ttu-id="53862-258">Questo evento Button non viene comunicato direttamente al gestore; al contrario, la gestione pulizia disco restituisce E \_ Abort la volta successiva che [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) chiama [**IEmptyVolumeCacheCallBack:: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="53862-258">That button event is not communicated directly to the handler; instead, the disk cleanup manager returns E\_ABORT the next time [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) calls [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="showproperties"></a><span data-ttu-id="53862-259">ShowProperties</span><span class="sxs-lookup"><span data-stu-id="53862-259">ShowProperties</span></span>

<span data-ttu-id="53862-260">Prima di avviare la pulizia, il gestore può visualizzare un'interfaccia utente in genere sotto forma di finestra di Esplora risorse che consente all'utente di visualizzare un elenco di file o classi di file selezionati per la pulizia da parte del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-260">Before starting cleanup, the handler can display a UI typically in the form of a Windows Explorer window that allows the user to see a list of files or classes of files selected for cleanup by the handler.</span></span> <span data-ttu-id="53862-261">Se il gestore imposta il flag **EVCF \_ HASSETTINGS** quando viene chiamato [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) o [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) , l'utente può richiedere l'interfaccia utente facendo clic sul pulsante visualizzato a tale scopo in Gestione pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-261">If the handler sets the **EVCF\_HASSETTINGS** flag when [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is called, the user can request the UI by clicking the button displayed for that purpose in the disk cleanup manager.</span></span> <span data-ttu-id="53862-262">Il testo del pulsante varia dal gestore al gestore, ma "Visualizza file", "Visualizza pagine" e "Opzioni" sono etichette comuni.</span><span class="sxs-lookup"><span data-stu-id="53862-262">The button text varies from handler to handler, but "View Files," "View Pages," and "Options" are common labels.</span></span>

<span data-ttu-id="53862-263">Quando si fa clic sul pulsante, Gestione pulitura disco chiama [**showProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) per richiedere al gestore di visualizzare l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53862-263">When the button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) to prompt the handler to display the UI.</span></span> <span data-ttu-id="53862-264">L'interfaccia utente deve essere creata come figlio della finestra il cui handle viene passato nel parametro *HWND* del metodo **showProperties** .</span><span class="sxs-lookup"><span data-stu-id="53862-264">The UI should be created as a child of the window whose handle is passed in the **ShowProperties** method's *hwnd* parameter.</span></span>

### <a name="purge"></a><span data-ttu-id="53862-265">Ripulisci</span><span class="sxs-lookup"><span data-stu-id="53862-265">Purge</span></span>

<span data-ttu-id="53862-266">Il gestore pulitura disco chiama il metodo di [**ripulitura**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) del gestore per impostare la pulizia in movimento.</span><span class="sxs-lookup"><span data-stu-id="53862-266">The disk cleanup manager calls the handler's [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) method to set the cleanup in motion.</span></span> <span data-ttu-id="53862-267">Il parametro *picB* del metodo è un puntatore all'interfaccia [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) di Gestione pulitura disco.</span><span class="sxs-lookup"><span data-stu-id="53862-267">The method's *picb* parameter is a pointer to the disk cleanup manager's [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="53862-268">Come per il metodo [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) , è necessario che il gestore usi periodicamente l'interfaccia di callback per segnalare lo stato di avanzamento ed eseguire una query su Gestione pulitura disco se l'utente ha fatto clic su **Annulla**.</span><span class="sxs-lookup"><span data-stu-id="53862-268">As with the [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) method, the handler should use the callback interface periodically to report its progress and query the disk cleanup manager whether the user has clicked **Cancel**.</span></span> <span data-ttu-id="53862-269">Si noti tuttavia che il metodo **Purge** deve chiamare [**IEmptyVolumeCacheCallBack::P Urgeprogress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), non [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="53862-269">However, note that the **Purge** method must call [**IEmptyVolumeCacheCallBack::PurgeProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), not [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="deactivate"></a><span data-ttu-id="53862-270">Disattivare</span><span class="sxs-lookup"><span data-stu-id="53862-270">Deactivate</span></span>

<span data-ttu-id="53862-271">Il metodo [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) viene chiamato quando Gestione pulitura disco sta preparando l'arresto.</span><span class="sxs-lookup"><span data-stu-id="53862-271">The [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) method is called when the disk cleanup manager is preparing to shut down.</span></span> <span data-ttu-id="53862-272">Il gestore deve eseguire tutte le attività di pulizia necessarie e restituire.</span><span class="sxs-lookup"><span data-stu-id="53862-272">The handler should perform any needed cleanup tasks and return.</span></span> <span data-ttu-id="53862-273">Se non si desidera che il gestore venga nuovamente eseguito, impostare il flag **EVCF \_ REMOVEFROMLIST** nel parametro *pdwFlags* del metodo di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="53862-273">If you don't want the handler to be run again, set the **EVCF\_REMOVEFROMLIST** flag in the initialization method's *pdwFlags* parameter.</span></span> <span data-ttu-id="53862-274">Se questo flag è impostato, Gestione pulitura disco rimuove il gestore dall'elenco ed Elimina le voci del registro di sistema del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-274">If this flag is set, the disk cleanup manager removes the handler from its list and deletes the handler's registry entries.</span></span> <span data-ttu-id="53862-275">Per eseguire nuovamente il gestore, è necessario aggiungere nuovamente le voci del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-275">You must re-add the registry entries to run the handler again.</span></span> <span data-ttu-id="53862-276">Questo flag viene in genere usato per i gestori che vengono eseguiti una sola volta.</span><span class="sxs-lookup"><span data-stu-id="53862-276">This flag is typically used for handlers that are run only once.</span></span>

## <a name="registering-a-disk-cleanup-handler"></a><span data-ttu-id="53862-277">Registrazione di un gestore pulitura disco</span><span class="sxs-lookup"><span data-stu-id="53862-277">Registering a Disk Cleanup Handler</span></span>

<span data-ttu-id="53862-278">Per aggiungere un gestore all'elenco di Gestione pulitura disco, è necessario aggiungere alcune chiavi e valori al registro di sistema di Windows.</span><span class="sxs-lookup"><span data-stu-id="53862-278">To add a handler to the disk cleanup manager's list, certain keys and values must be added to the Windows registry.</span></span>

-   [<span data-ttu-id="53862-279">Registrazione del CLSID di un gestore</span><span class="sxs-lookup"><span data-stu-id="53862-279">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
-   [<span data-ttu-id="53862-280">Registrazione di un gestore con Gestione pulitura disco: generale</span><span class="sxs-lookup"><span data-stu-id="53862-280">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
-   [<span data-ttu-id="53862-281">Registrazione di un gestore con Gestione pulitura disco: sistemi Windows 2000 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="53862-281">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
-   [<span data-ttu-id="53862-282">Utilizzo dell'oggetto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="53862-282">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
-   [<span data-ttu-id="53862-283">Registrazione di esempio di un gestore di pulitura del disco</span><span class="sxs-lookup"><span data-stu-id="53862-283">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

### <a name="registering-a-handlers-clsid"></a><span data-ttu-id="53862-284">Registrazione del CLSID di un gestore</span><span class="sxs-lookup"><span data-stu-id="53862-284">Registering a Handler's CLSID</span></span>

<span data-ttu-id="53862-285">Come per tutti gli oggetti COM, il GUID e la DLL dell'oggetto gestore devono essere registrati nella chiave **CLSID** della **\_ \_ radice delle classi HKEY**.</span><span class="sxs-lookup"><span data-stu-id="53862-285">As with all COM objects, the handler object's GUID and DLL must be registered under the **CLSID** key in **HKEY\_CLASSES\_ROOT**.</span></span> <span data-ttu-id="53862-286">È anche possibile registrare un'icona visualizzata accanto al nome del gestore nella casella di riepilogo di Gestione pulitura disco, ma questo è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="53862-286">You can also register an icon that is displayed next to the handler's name in the disk cleanup manager's list box, but this is optional.</span></span> <span data-ttu-id="53862-287">Nell'esempio seguente vengono illustrate le chiavi, i valori e i dati necessari.</span><span class="sxs-lookup"><span data-stu-id="53862-287">The following example shows the keys, values, and data involved.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      Handler's GUID
         DefaultIcon
            (Default) = Handler's Icon Path, Icon Index
         InprocServer32
            (Default) = Handler's DLL path
            ThreadingModel = Apartment
```

### <a name="registering-a-handler-with-the-disk-cleanup-manager-general"></a><span data-ttu-id="53862-288">Registrazione di un gestore con Gestione pulitura disco: generale</span><span class="sxs-lookup"><span data-stu-id="53862-288">Registering a Handler with the Disk Cleanup Manager: General</span></span>

<span data-ttu-id="53862-289">Per completare la registrazione, un gestore deve aggiungere una chiave che contiene le proprie specifiche, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="53862-289">To complete the registration, a handler must add a key holding its specifics as shown here.</span></span> <span data-ttu-id="53862-290">Nella parte restante di questa sezione viene illustrato il contenuto di questa chiave.</span><span class="sxs-lookup"><span data-stu-id="53862-290">The remainder of this section discusses the contents of this key.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Handler's Key
```

<span data-ttu-id="53862-291">In generale, il nome della chiave che contiene i particolari di un gestore è denominato per il tipo di file che gestisce, ad esempio **i file di programma scaricati**, ma questo non è un requisito.</span><span class="sxs-lookup"><span data-stu-id="53862-291">In general, the name of the key holding a handler's particulars is named for the type of file that it handles, such as **Downloaded Program Files**, but this is not a requirement.</span></span> <span data-ttu-id="53862-292">La tabella seguente illustra in dettaglio i possibili valori trovati in questa chiave.</span><span class="sxs-lookup"><span data-stu-id="53862-292">The following table details the possible values found under this key.</span></span>

> [!Note]  
> <span data-ttu-id="53862-293">Solo il valore predefinito che specifica l'identificatore di classe (CLSID) del gestore è obbligatorio tutti gli altri valori sono facoltativi.</span><span class="sxs-lookup"><span data-stu-id="53862-293">Only the Default value specifying the handler's class identifier (CLSID) is required all other values are optional.</span></span>

 



<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="53862-294">Valore</span><span class="sxs-lookup"><span data-stu-id="53862-294">Value</span></span></th>
<th><span data-ttu-id="53862-295">Type</span><span class="sxs-lookup"><span data-stu-id="53862-295">Type</span></span></th>
<th><span data-ttu-id="53862-296">Significato</span><span class="sxs-lookup"><span data-stu-id="53862-296">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="53862-297">Predefinito</span><span class="sxs-lookup"><span data-stu-id="53862-297">Default</span></span></td>
<td><span data-ttu-id="53862-298">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-298">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-299">Il CLSID del gestore è registrato nel <strong>HKEY_CLASSES_ROOT</strong> \ <strong>CLSID</strong>.</span><span class="sxs-lookup"><span data-stu-id="53862-299">The handler's CLSID as registered under <strong>HKEY_CLASSES_ROOT</strong>\<strong>CLSID</strong>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-300">AdvancedButtonText</span><span class="sxs-lookup"><span data-stu-id="53862-300">AdvancedButtonText</span></span></td>
<td><span data-ttu-id="53862-301">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-301">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-302">Testo per il pulsante facoltativo su cui gli utenti possono fare clic per visualizzare l'interfaccia utente del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-302">Text for the optional button that users can click to display the handler's UI.</span></span> <span data-ttu-id="53862-303">Il carattere & può essere inserito prima di un carattere per assegnare una scelta rapida da tastiera per il pulsante.</span><span class="sxs-lookup"><span data-stu-id="53862-303">The & character can be placed before a character to assign a keyboard shortcut for the button.</span></span> <span data-ttu-id="53862-304">Il valore AdvancedButtonText viene ignorato dai gestori che espongono <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="53862-304">The AdvancedButtonText value is ignored by handlers exposing <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-305">CleanupString</span><span class="sxs-lookup"><span data-stu-id="53862-305">CleanupString</span></span></td>
<td><span data-ttu-id="53862-306">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-306">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-307">Riga di comando che specifica un file eseguibile e i parametri facoltativi della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="53862-307">Command line specifying an executable file and optional command line parameters.</span></span> <span data-ttu-id="53862-308">Questa riga di comando viene eseguita al completamento della pulizia del disco.</span><span class="sxs-lookup"><span data-stu-id="53862-308">This command line is run at the completion of the disk cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-309">CSIDL</span><span class="sxs-lookup"><span data-stu-id="53862-309">CSIDL</span></span></td>
<td><span data-ttu-id="53862-310">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="53862-310">REG_DWORD</span></span></td>
<td><span data-ttu-id="53862-311">Identificatore indipendente dal sistema per una cartella speciale da includere nella ricerca di file.</span><span class="sxs-lookup"><span data-stu-id="53862-311">A system-independent identifier for a special folder to include in the file search.</span></span> <span data-ttu-id="53862-312">Questo valore deve essere immesso come valore numerico per instance, 0X0000001C anziché CSIDL_LOCAL_APPDATA.</span><span class="sxs-lookup"><span data-stu-id="53862-312">This value must be entered as a numerical value for instance, 0x0000001c rather than CSIDL_LOCAL_APPDATA.</span></span> <span data-ttu-id="53862-313">Per un elenco di valori possibili, vedere <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="53862-313">For a list of possible values, see <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span></span> <span data-ttu-id="53862-314">È possibile utilizzare solo un singolo valore.</span><span class="sxs-lookup"><span data-stu-id="53862-314">Only a single value can be used.</span></span><br/> <span data-ttu-id="53862-315">Se viene specificato il valore della cartella, il percorso indicato dal valore CSIDL viene anteposto a tali informazioni per comporre un percorso di ricerca.</span><span class="sxs-lookup"><span data-stu-id="53862-315">If the Folder value is specified, the location indicated by the CSIDL value is prepended to that information to compose a search path.</span></span> <span data-ttu-id="53862-316">Si consideri, ad esempio, lo scenario seguente.</span><span class="sxs-lookup"><span data-stu-id="53862-316">For instance, consider the following scenario.</span></span><br/>
<ul>
<li><span data-ttu-id="53862-317">Il valore CSIDL è specificato come 0x0000000D (CSIDL_MYMUSIC)</span><span class="sxs-lookup"><span data-stu-id="53862-317">The CSIDL value is specified as 0x0000000d (CSIDL_MYMUSIC)</span></span></li>
<li><span data-ttu-id="53862-318">La cartella Music si trova in C:\Documents and Settings \<em>username</em>\My Music</span><span class="sxs-lookup"><span data-stu-id="53862-318">Your My Music folder is located at C:\Documents and Settings\<em>username</em>\My Music</span></span></li>
<li><span data-ttu-id="53862-319">Il valore della cartella contiene &quot; Jazz\Singers&quot;</span><span class="sxs-lookup"><span data-stu-id="53862-319">The Folder value contains &quot;Jazz\Singers&quot;</span></span></li>
</ul>
<span data-ttu-id="53862-320">Il risultato di tale scenario è che il gestore pulitura dischi esegue la ricerca nella cartella C:\Documents and Settings \<em>username</em>\My Music\Jazz\Singers</span><span class="sxs-lookup"><span data-stu-id="53862-320">The result of that scenario is that the disk cleanup handler searches the C:\Documents and Settings\<em>username</em>\My Music\Jazz\Singers folder.</span></span> <span data-ttu-id="53862-321">Si noti che la barra che precede il valore della cartella viene aggiunta se non è presente.</span><span class="sxs-lookup"><span data-stu-id="53862-321">Note that the slash preceding the Folder value is added if it is not present.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-322">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53862-322">Description</span></span></td>
<td><span data-ttu-id="53862-323">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-323">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-324">Testo descrittivo visualizzato sotto la casella di riepilogo di Gestione pulitura disco quando viene selezionato il nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-324">Descriptive text displayed below the disk cleanup manager's list box when the handler's name is selected.</span></span> <span data-ttu-id="53862-325">Qui è possibile illustrare il funzionamento del gestore, i file con cui si riferisce e qualsiasi altra informazione elucidatory all'utente.</span><span class="sxs-lookup"><span data-stu-id="53862-325">Here you can explain what the handler does, what files it concerns itself with, and any other information elucidatory to the user.</span></span> <span data-ttu-id="53862-326">Se <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a> non è esposto dal gestore, è possibile eseguire l'override di questo testo tramite il metodo <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> del gestore specificando una stringa alternativa nel parametro <em>ppwszDescription</em> quando viene chiamato il metodo.</span><span class="sxs-lookup"><span data-stu-id="53862-326">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDescription</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-327">Visualizza</span><span class="sxs-lookup"><span data-stu-id="53862-327">Display</span></span></td>
<td><span data-ttu-id="53862-328">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-328">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-329">Nome del gestore da visualizzare nella casella di riepilogo di gestione pulizia dischi.</span><span class="sxs-lookup"><span data-stu-id="53862-329">The handler's name to be displayed in the disk cleanup manager's list box.</span></span> <span data-ttu-id="53862-330">Se <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a> non è esposto dal gestore, è possibile eseguire l'override di questo testo tramite il metodo <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> del gestore specificando una stringa alternativa nel parametro <em>ppwszDisplayName</em> quando viene chiamato il metodo.</span><span class="sxs-lookup"><span data-stu-id="53862-330">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDisplayName</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-331">FileList</span><span class="sxs-lookup"><span data-stu-id="53862-331">FileList</span></span></td>
<td><span data-ttu-id="53862-332">REG_SZ o REG_MULTI_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-332">REG_SZ or REG_MULTI_SZ</span></span></td>
<td><span data-ttu-id="53862-333">Elenco di file ricercati e puliti da questo gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-333">A list of files searched for and cleaned by this handler.</span></span> <span data-ttu-id="53862-334">È possibile specificare caratteri jolly usando?</span><span class="sxs-lookup"><span data-stu-id="53862-334">You can specify wildcards using the ?</span></span> <span data-ttu-id="53862-335">o \* caratteri.</span><span class="sxs-lookup"><span data-stu-id="53862-335">or \* characters.</span></span> <span data-ttu-id="53862-336">Se il valore è di tipo REG_SZ, più estensioni sono separate usando | o: caratteri, senza spazi su entrambi i lati.</span><span class="sxs-lookup"><span data-stu-id="53862-336">If the value is of type REG_SZ, multiple extensions are separated using the | or : characters, with no spaces on either side of them.</span></span><br/> <span data-ttu-id="53862-337">Se il flag DDEVCF_REMOVEDIRS è impostato nel valore dei flag, questi valori possono specificare i nomi di directory e i file.</span><span class="sxs-lookup"><span data-stu-id="53862-337">If the DDEVCF_REMOVEDIRS flag is set in the Flags value, these values can specify directory names as well as files.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-338">Flags</span><span class="sxs-lookup"><span data-stu-id="53862-338">Flags</span></span></td>
<td><span data-ttu-id="53862-339">REG_DWORD o REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="53862-339">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="53862-340">Flag che controllano gli elementi della procedura di ricerca e di pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-340">Flags controlling elements of the search and cleaning procedure.</span></span> <span data-ttu-id="53862-341">Uno o più dei valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="53862-341">One or more of the following values.</span></span>
<ul>
<li><span data-ttu-id="53862-342">DDEVCF_DOSUBDIRS (0x00000001).</span><span class="sxs-lookup"><span data-stu-id="53862-342">DDEVCF_DOSUBDIRS (0x00000001).</span></span> <span data-ttu-id="53862-343">Eseguire ricerche e rimuovere in modo ricorsivo.</span><span class="sxs-lookup"><span data-stu-id="53862-343">Search and remove recursively.</span></span></li>
<li><span data-ttu-id="53862-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span><span class="sxs-lookup"><span data-stu-id="53862-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span></span> <span data-ttu-id="53862-345">Quando il gestore viene eseguito una volta, rimuoverlo dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-345">After the handler is run once, remove it from the registry.</span></span></li>
<li><span data-ttu-id="53862-346">DDEVCF_REMOVEREADONLY (0x00000004).</span><span class="sxs-lookup"><span data-stu-id="53862-346">DDEVCF_REMOVEREADONLY (0x00000004).</span></span> <span data-ttu-id="53862-347">Rimuovere i file che soddisfano i criteri di ricerca anche se sono di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="53862-347">Remove files that meet the search criteria even if they are read-only.</span></span></li>
<li><span data-ttu-id="53862-348">DDEVCF_REMOVESYSTEM (0x00000008).</span><span class="sxs-lookup"><span data-stu-id="53862-348">DDEVCF_REMOVESYSTEM (0x00000008).</span></span> <span data-ttu-id="53862-349">Rimuovere i file che soddisfano i criteri di ricerca anche se sono file di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-349">Remove files that meet the search criteria even if they are system files.</span></span></li>
<li><span data-ttu-id="53862-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span><span class="sxs-lookup"><span data-stu-id="53862-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span></span> <span data-ttu-id="53862-351">Rimuovere i file che soddisfano i criteri di ricerca anche se si tratta di file nascosti.</span><span class="sxs-lookup"><span data-stu-id="53862-351">Remove files that meet the search criteria even if they are hidden files.</span></span></li>
<li><span data-ttu-id="53862-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span><span class="sxs-lookup"><span data-stu-id="53862-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span></span> <span data-ttu-id="53862-353">Non visualizzare questo gestore in Gestione pulitura disco se nessun file corrisponde ai criteri di ricerca.</span><span class="sxs-lookup"><span data-stu-id="53862-353">Do not display this handler in the disk cleanup manager if no files match its search criteria.</span></span></li>
<li><span data-ttu-id="53862-354">DDEVCF_REMOVEDIRS (0x00000040).</span><span class="sxs-lookup"><span data-stu-id="53862-354">DDEVCF_REMOVEDIRS (0x00000040).</span></span> <span data-ttu-id="53862-355">Trovare la corrispondenza con il valore di fileelenchi per le directory e rimuovere le corrispondenze e tutte le relative sottodirectory.</span><span class="sxs-lookup"><span data-stu-id="53862-355">Match the FileList value against directories and remove matches and all of their subdirectories.</span></span></li>
<li><span data-ttu-id="53862-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span><span class="sxs-lookup"><span data-stu-id="53862-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span></span> <span data-ttu-id="53862-357">Eseguire questo gestore solo se lo spazio disponibile su disco è sceso al di sotto del valore critico, determinato da Gestione pulizia dischi che imposta il flag di EVCF_OUTOFDISKSPACE tramite <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> o <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="53862-357">Run this handler only if available disk space has fallen below the critical value, determined by the disk cleanup manager setting the EVCF_OUTOFDISKSPACE flag through <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> or <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></li>
<li><span data-ttu-id="53862-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span><span class="sxs-lookup"><span data-stu-id="53862-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span></span> <span data-ttu-id="53862-359">Rimuovere la directory padre dei file specificati dopo l'esecuzione del pulisci.</span><span class="sxs-lookup"><span data-stu-id="53862-359">Remove the parent directory of the specified files once the cleaner has run.</span></span></li>
<li><span data-ttu-id="53862-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span><span class="sxs-lookup"><span data-stu-id="53862-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span></span> <span data-ttu-id="53862-361">Usare il valore LastAccess, se specificato, per verificare i file da pulire.</span><span class="sxs-lookup"><span data-stu-id="53862-361">Use the LastAccess value, if provided, in ascertaining which files should be cleaned.</span></span> <span data-ttu-id="53862-362">Questo flag viene ignorato quando si usa <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> , viene sempre usato il valore LastAccess fornito.</span><span class="sxs-lookup"><span data-stu-id="53862-362">This flag is ignored when using the <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> any provided LastAccess value is always used.</span></span></li>
</ul></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-363">Cartella</span><span class="sxs-lookup"><span data-stu-id="53862-363">Folder</span></span></td>
<td><span data-ttu-id="53862-364">REG_SZ, REG_MULTI_SZ o REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-364">REG_SZ, REG_MULTI_SZ, or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="53862-365">Cartella o cartelle specifiche in cui cercare gli elementi corrispondenti alle voci nel valore di fileitem.</span><span class="sxs-lookup"><span data-stu-id="53862-365">A specific folder or folders to search for items matching entries in the FileList value.</span></span> <span data-ttu-id="53862-366">È possibile specificare caratteri jolly usando?</span><span class="sxs-lookup"><span data-stu-id="53862-366">You can specify wildcards using the ?</span></span> <span data-ttu-id="53862-367">o \* caratteri.</span><span class="sxs-lookup"><span data-stu-id="53862-367">or \* characters.</span></span> <span data-ttu-id="53862-368">Se il valore è di tipo REG_SZ, più nomi di cartella vengono separati con | carattere senza spazi su entrambi i lati.</span><span class="sxs-lookup"><span data-stu-id="53862-368">If the value is of type REG_SZ, multiple folder names are separated using the | character, without spaces on either side of it.</span></span><br/> <span data-ttu-id="53862-369">Se è presente un valore CSIDL, in questo valore è possibile specificare una sola cartella.</span><span class="sxs-lookup"><span data-stu-id="53862-369">If a CSIDL value is present, only one folder can be specified in this value.</span></span> <span data-ttu-id="53862-370">Il percorso indicato dal valore CSIDL è anteposto al percorso della cartella per comporre un percorso di ricerca.</span><span class="sxs-lookup"><span data-stu-id="53862-370">The location indicated by the CSIDL value is prepended to that folder path to compose a search path.</span></span> <span data-ttu-id="53862-371">Per un esempio, vedere la descrizione del valore CSIDL.</span><span class="sxs-lookup"><span data-stu-id="53862-371">For an example, see the CSIDL value description.</span></span><br/> <span data-ttu-id="53862-372">Se questo valore è assente in Windows Vista Service Pack 1 (SP1) e versioni successive, il gestore pulitura viene ignorato e restituisce S_FALSE all'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="53862-372">If this value is absent on Windows Vista Service Pack 1 (SP1) and later, the cleanup handler is ignored and it returns S_FALSE on initialization.</span></span><br/> <span data-ttu-id="53862-373">Se questo valore è assente nella versione originale di Windows Vista e versioni precedenti, viene utilizzata la cartella radice del volume corrente.</span><span class="sxs-lookup"><span data-stu-id="53862-373">If this value is absent on the original release of Windows Vista and earlier, the root folder of the current volume is used.</span></span> <span data-ttu-id="53862-374">In tal caso, è necessario il flag DDEVCF_DOSUBDIRS per eseguire la ricerca nell'intera unità.</span><span class="sxs-lookup"><span data-stu-id="53862-374">The DDEVCF_DOSUBDIRS flag is needed in that case to search the entire drive.</span></span> <span data-ttu-id="53862-375">Senza di esso, viene eseguita la ricerca solo nella cartella radice.</span><span class="sxs-lookup"><span data-stu-id="53862-375">Without it, only the root folder itself is searched.</span></span><br/> <span data-ttu-id="53862-376">È necessario specificare un'unità o unità.</span><span class="sxs-lookup"><span data-stu-id="53862-376">A drive or drives must be specified.</span></span> <span data-ttu-id="53862-377">Questa operazione può essere fornita tramite il valore CSIDL o tramite una stringa REG_EXPAND_SZ.</span><span class="sxs-lookup"><span data-stu-id="53862-377">This can be provided through the CSIDL value or through a REG_EXPAND_SZ string.</span></span> <span data-ttu-id="53862-378">Escludendo tali opzioni, tuttavia, l'unità in cui eseguire la ricerca deve essere specificata nel nome della cartella.</span><span class="sxs-lookup"><span data-stu-id="53862-378">Barring those options, however, the drive to search must be specified in the folder name.</span></span> <span data-ttu-id="53862-379">Usare?: per eseguire la ricerca nella cartella dell'unità corrente.</span><span class="sxs-lookup"><span data-stu-id="53862-379">Use ?: to search the folder on the current drive.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-380">IconPath</span><span class="sxs-lookup"><span data-stu-id="53862-380">IconPath</span></span></td>
<td><span data-ttu-id="53862-381">REG_SZ o REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-381">REG_SZ or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="53862-382">Percorso della risorsa da cui ottenere un'icona da usare in associazione al gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-382">The path to the resource from which to obtain an icon to use in association with the handler.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-383">LastAccess</span><span class="sxs-lookup"><span data-stu-id="53862-383">LastAccess</span></span></td>
<td><span data-ttu-id="53862-384">REG_DWORD o REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="53862-384">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="53862-385">Il numero di giorni che devono essere trascorsi dopo l'ultimo accesso al file o la creazione di una directory per il file o la directory da considerare per la pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-385">The number of days that must have elapsed since a file was last accessed or a directory was created for that file or directory to be considered for cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-386">Priorità</span><span class="sxs-lookup"><span data-stu-id="53862-386">Priority</span></span></td>
<td><span data-ttu-id="53862-387">REG_DWORD o REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="53862-387">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="53862-388">Determina l'ordine di esecuzione del gestore rispetto ad altri gestori.</span><span class="sxs-lookup"><span data-stu-id="53862-388">Determines the order that the handler is run with respect to other handlers.</span></span> <span data-ttu-id="53862-389">Maggiore è il numero, precedente nel processo eseguito dal gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-389">The higher the number, the earlier in the process that the handler runs.</span></span> <span data-ttu-id="53862-390">Nessun intervallo definito è accettabile.</span><span class="sxs-lookup"><span data-stu-id="53862-390">There is no defined range any number is acceptable.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="53862-391">PropertyBag</span><span class="sxs-lookup"><span data-stu-id="53862-391">PropertyBag</span></span></td>
<td><span data-ttu-id="53862-392">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="53862-392">REG_SZ</span></span></td>
<td><span data-ttu-id="53862-393">CLSID di una risorsa utilizzata per fornire il testo localizzato per il nome visualizzato, la descrizione e il testo del pulsante.</span><span class="sxs-lookup"><span data-stu-id="53862-393">The CLSID of a resource used to provide localized text for the display name, description, and button text.</span></span> <span data-ttu-id="53862-394">Questa risorsa è utile nei casi in cui un gestore non implementa <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> e il gestore viene eseguito in Microsoft Windows NT o Windows XP.</span><span class="sxs-lookup"><span data-stu-id="53862-394">This resource is useful in the situation where a handler does not implement <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> and the handler is being run under Microsoft Windows NT or Windows XP.</span></span><br/> <span data-ttu-id="53862-395">Gestione pulitura disco controlla prima di tutto se la routine di inizializzazione del gestore ha restituito tali stringhe, come avviene quando viene implementato <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="53862-395">The disk cleanup manager first checks whether the handler's initialization routine returned those strings, as would be the case when <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> is implemented.</span></span> <span data-ttu-id="53862-396">In caso contrario, il gestore si rivolge a un contenitore di proprietà denominato in questo valore.</span><span class="sxs-lookup"><span data-stu-id="53862-396">Failing that, the manager next turns to a property bag named in this value.</span></span> <span data-ttu-id="53862-397">Se non è stato specificato alcun valore, viene recuperato il testo dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-397">If none has been provided, it retrieves the text from the registry.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="53862-398">StateFlags</span><span class="sxs-lookup"><span data-stu-id="53862-398">StateFlags</span></span></td>
<td><span data-ttu-id="53862-399">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="53862-399">REG_DWORD</span></span></td>
<td><span data-ttu-id="53862-400">Eseguendo il file eseguibile di gestione pulizia dischi Cleanmgr.exe dalla riga di comando, è possibile dichiarare i <em>profili</em>di pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-400">By running the disk cleanup manager's executable file Cleanmgr.exe from a command line, you can declare cleanup <em>profiles</em>.</span></span> <span data-ttu-id="53862-401">Questi profili sono composti da un subset dei gestori disponibili a cui viene assegnata un'etichetta numerica univoca.</span><span class="sxs-lookup"><span data-stu-id="53862-401">These profiles are composed of a subset of the available handlers and are given a unique numeric label.</span></span> <span data-ttu-id="53862-402">In questo modo è possibile automatizzare l'esecuzione di diversi set di gestori in momenti diversi.</span><span class="sxs-lookup"><span data-stu-id="53862-402">This allows you to automate the running of different sets of handlers at different times.</span></span><br/> <span data-ttu-id="53862-403">La riga di comando &quot;cleanmgr.exe/sageset:<strong>nnnn</strong> &quot; , dove <strong>nnnn</strong> è un'etichetta numerica UNIVOCa, Visualizza un'interfaccia utente che consente di scegliere i gestori da includere nel profilo.</span><span class="sxs-lookup"><span data-stu-id="53862-403">The command line &quot;cleanmgr.exe /sageset:<strong>nnnn</strong>&quot;, where <strong>nnnn</strong> is a unique numeric label, displays a UI allowing you to choose the handlers to be included in that profile.</span></span> <span data-ttu-id="53862-404">Così come per la definizione del profilo, il parametro sageset scrive anche un valore denominato StateFlags<strong>nnnn</strong>, dove <strong>nnnn</strong> è l'etichetta usata nel parametro, a tutte le sottochiavi in <strong>VolumeCaches</strong>.</span><span class="sxs-lookup"><span data-stu-id="53862-404">As well as defining the profile, the sageset parameter also writes a value named StateFlags<strong>nnnn</strong>, where <strong>nnnn</strong> is the label you used in the parameter, to all of the subkeys under <strong>VolumeCaches</strong>.</span></span> <span data-ttu-id="53862-405">Per tali voci sono possibili due valori di dati.</span><span class="sxs-lookup"><span data-stu-id="53862-405">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="53862-406">0: non eseguire questo gestore quando il profilo viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="53862-406">0: Do not run this handler when this profile is run.</span></span></li>
<li><span data-ttu-id="53862-407">2: includere questo gestore quando viene eseguito questo profilo.</span><span class="sxs-lookup"><span data-stu-id="53862-407">2: Include this handler when this profile is run.</span></span></li>
</ul>
<br/> <span data-ttu-id="53862-408">Si supponga, ad esempio, che la riga di comando &quot;cleanmgr.exe/sageset: 1234 &quot; venga eseguita.</span><span class="sxs-lookup"><span data-stu-id="53862-408">For example, suppose that the command line &quot;cleanmgr.exe /sageset:1234&quot; is run.</span></span> <span data-ttu-id="53862-409">Nell'interfaccia utente visualizzata, l'utente sceglie i file di <strong>programma scaricati</strong>, ma non sceglie <strong>i file temporanei di Internet</strong>.</span><span class="sxs-lookup"><span data-stu-id="53862-409">In the UI that is presented, the user chooses <strong>Downloaded Program Files</strong>, but does not choose <strong>Temporary Internet Files</strong>.</span></span> <span data-ttu-id="53862-410">I valori seguenti vengono quindi scritti nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-410">The following values are then written to the registry.</span></span><br/>
<pre data-space="preserve"><code>HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Downloaded Program Files
                        StateFlags1234 = 0x00000002
                     Internet Cache Files
                        StateFlags1234 = 0x00000000</code></pre>
<br/> <span data-ttu-id="53862-411">La riga &quot; di comandocleanmgr.exe/sagerun:<strong>nnnn</strong> &quot; , in cui il valore di <strong>nnnn</strong> corrisponde all'etichetta dichiarata con il parametro sageset, esegue tutti i gestori selezionati in quel profilo.</span><span class="sxs-lookup"><span data-stu-id="53862-411">The command line &quot;cleanmgr.exe /sagerun:<strong>nnnn</strong>&quot;, where the value of <strong>nnnn</strong> matches the label declared with the sageset parameter, runs all of the handlers selected in that profile.</span></span><br/> <span data-ttu-id="53862-412">Un valore StateFlags generico viene scritto nel registro di sistema quando la pulizia del disco viene eseguita normalmente.</span><span class="sxs-lookup"><span data-stu-id="53862-412">A generic StateFlags value is written to the registry when Disk Cleanup is run normally.</span></span> <span data-ttu-id="53862-413">Questo valore archivia semplicemente lo stato (selezionato o non selezionato) del gestore nell'ultima volta in cui è stato presentato come opzione per l'utente.</span><span class="sxs-lookup"><span data-stu-id="53862-413">This value simply stores the state (checked or unchecked) of the handler the last time it was presented as an option to the user.</span></span> <span data-ttu-id="53862-414">Per tali voci sono possibili due valori di dati.</span><span class="sxs-lookup"><span data-stu-id="53862-414">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="53862-415">0: il gestore non è stato selezionato.</span><span class="sxs-lookup"><span data-stu-id="53862-415">0: The handler was not selected.</span></span></li>
<li><span data-ttu-id="53862-416">1: il gestore è stato selezionato.</span><span class="sxs-lookup"><span data-stu-id="53862-416">1: The handler was selected.</span></span></li>
</ul>
<br/></td>
</tr>
</tbody>
</table>



 

### <a name="registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems"></a><span data-ttu-id="53862-417">Registrazione di un gestore con Gestione pulitura disco: sistemi Windows 2000 o versioni successive</span><span class="sxs-lookup"><span data-stu-id="53862-417">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>

<span data-ttu-id="53862-418">La specifica del testo visualizzato nel registro di sistema può rendere difficile la localizzazione del software.</span><span class="sxs-lookup"><span data-stu-id="53862-418">Specifying display text in the registry can make it difficult to localize software.</span></span> <span data-ttu-id="53862-419">Per questo motivo, Windows 2000 e Windows XP supportano l'interfaccia [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) con il metodo di inizializzazione preferito [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="53862-419">For this reason, Windows 2000 and Windows XP support the [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) interface with its preferred initialization method [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span> <span data-ttu-id="53862-420">In Windows 2000 o versioni successive viene sempre eseguito un tentativo di chiamare **IEmptyVolumeCache2:: InitializeEx** prima di [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span><span class="sxs-lookup"><span data-stu-id="53862-420">Under Windows 2000 or later, an attempt is always made to call **IEmptyVolumeCache2::InitializeEx** before [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span></span> <span data-ttu-id="53862-421">Il sistema usa solo **Initialize** per inizializzare un gestore se **IEmptyVolumeCache2** non è esposto.</span><span class="sxs-lookup"><span data-stu-id="53862-421">The system only uses **Initialize** to initialize a handler if **IEmptyVolumeCache2** is not exposed.</span></span>

<span data-ttu-id="53862-422">Per quanto riguarda il registro di sistema, l'unica differenza in Windows 2000 o versioni successive è la possibilità di omettere i valori AdvancedButtonText, display e Description quando [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) viene esposto dal gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-422">In regard to the registry, the only difference under Windows 2000 or later is that you can omit the AdvancedButtonText, Display, and Description values when [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is exposed by the handler.</span></span> <span data-ttu-id="53862-423">Tali valori, che contengono testo localizzato correttamente, vengono forniti al gestore pulitura disco quando chiama **InitializeEx**.</span><span class="sxs-lookup"><span data-stu-id="53862-423">Those values, containing properly localized text, are provided to the disk cleanup manager when it calls **InitializeEx**.</span></span>

### <a name="using-the-datadrivencleaner-object"></a><span data-ttu-id="53862-424">Utilizzo dell'oggetto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="53862-424">Using the DataDrivenCleaner Object</span></span>

<span data-ttu-id="53862-425">Un gestore pulitura disco di base, denominato DataDrivenCleaner, viene fornito dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="53862-425">A basic disk cleanup handler, called the DataDrivenCleaner, is provided by the operating system.</span></span> <span data-ttu-id="53862-426">Per usare questo oggetto come gestore anziché implementare il proprio, usare il CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} come valore predefinito per la sottochiave del gestore in **VolumeCaches** come descritto in registrazione di [un gestore con Gestione pulitura disco: generale](#registering-a-handler-with-the-disk-cleanup-manager-general).</span><span class="sxs-lookup"><span data-stu-id="53862-426">To use this object as a handler rather than implementing your own, use the CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} as the Default value for the handler's subkey under **VolumeCaches** as described in [Registering a Handler with the Disk Cleanup Manager: General](#registering-a-handler-with-the-disk-cleanup-manager-general).</span></span>

<span data-ttu-id="53862-427">DataDrivenCleaner non espone [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), quindi i valori di visualizzazione e descrizione vengono forniti tramite il registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="53862-427">The DataDrivenCleaner does not expose [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), so the Display and Description values are provided through the registry.</span></span> <span data-ttu-id="53862-428">Quando si dichiarano tali stringhe, tenere presente che ciò potrebbe causare problemi di localizzazione.</span><span class="sxs-lookup"><span data-stu-id="53862-428">When declaring those strings, be aware that this could cause localization issues.</span></span> <span data-ttu-id="53862-429">Il testo localizzato può essere fornito tramite il valore PropertyBag.</span><span class="sxs-lookup"><span data-stu-id="53862-429">Localized text can be provided through the PropertyBag value.</span></span> <span data-ttu-id="53862-430">Il valore di AdvancedButtonText viene ignorato poiché non è disponibile alcuna interfaccia utente e pertanto non è disponibile alcun pulsante per visualizzarlo, è disponibile per questo gestore.</span><span class="sxs-lookup"><span data-stu-id="53862-430">The AdvancedButtonText value is ignored since no UI, and thus no button to display it, is available for this handler.</span></span>

### <a name="example-registration-of-a-disk-cleanup-handler"></a><span data-ttu-id="53862-431">Registrazione di esempio di un gestore di pulitura del disco</span><span class="sxs-lookup"><span data-stu-id="53862-431">Example Registration of a Disk Cleanup Handler</span></span>

<span data-ttu-id="53862-432">Di seguito viene illustrata una registrazione di esempio per un gestore di pulitura dischi implementato dall'azienda telefonica.</span><span class="sxs-lookup"><span data-stu-id="53862-432">The following shows an example registration for a disk cleanup handler implemented by The Phone Company.</span></span> <span data-ttu-id="53862-433">Questo gestore implementa sia [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) che [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), quindi fornisce AdvancedButtonText, descrizione e valori di visualizzazione nel caso in cui venga usato in un computer che esegue Windows 98.</span><span class="sxs-lookup"><span data-stu-id="53862-433">This handler implements both [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) and [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), and so provides AdvancedButtonText, Description, and Display values in case it is used on a computer running Windows 98.</span></span> <span data-ttu-id="53862-434">Il gestore combina i valori CSIDL e Folder per cercare i file nella directory C: \\ Program Files \\ The Phone Company \\ Temp e il flag DDEVCF DOSUBDIRS, in \_ modo che venga eseguita la ricerca nelle sottodirectory.</span><span class="sxs-lookup"><span data-stu-id="53862-434">The handler combines the CSIDL and Folder values to search for files in the C:\\Program Files\\The Phone Company\\Temp directory, and the DDEVCF\_DOSUBDIRS flag is set so that its subdirectories are also searched.</span></span> <span data-ttu-id="53862-435">Solo i file con estensione tmp e TPC sono considerati per la pulizia e il \_ flag LASTACCESS privato DDEVCF \_ è impostato in modo da escludere tali file, solo quelli a cui non è stato eseguito l'accesso per 14 giorni o più.</span><span class="sxs-lookup"><span data-stu-id="53862-435">Only those files with .tmp and .tpc extensions are considered for cleanup, and the DDEVCF\_PRIVATE\_LASTACCESS flag is set so that out of those files, only those that have not been accessed for 14 days or more are considered.</span></span> <span data-ttu-id="53862-436">\_Viene inoltre impostato il flag DDEVCF DONTSHOWIFZERO, in modo che il gestore non venga visualizzato nell'elenco a meno che non siano stati trovati candidati di pulizia.</span><span class="sxs-lookup"><span data-stu-id="53862-436">The DDEVCF\_DONTSHOWIFZERO flag is also set so that the handler does not appear on the list unless it has found cleanup candidates.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     The Phone Company Files
                        (Default) = {the CLSID GUID}
                        AdvancedButtonText = &View Files
                        CleanupString = c:\tpc.exe
                        CSIDL = 0x00000026
                        Description = Old temporary files.
                        Display = The Phone Company Files
                        FileList = *.tmp|*.tpc
                        Flags = 0x10000021
                        Folder = \The Phone Company\Temp
                        IconPath = c:\Program Files\The Phone Company\tpc.dll,2
                        LastAccess = 0x0000000e
                        Priority = 200
                        PropertyBag = {Property Bag CLSID GUID}
```

 

