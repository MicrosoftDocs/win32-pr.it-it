---
title: IAgentCommands
description: IAgentCommands
ms.assetid: dfb3b58a-7f24-4366-8f04-93a9e956fdc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a8e29936dbca65ffded5f8a5e5ea5297b28362e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104472862"
---
# <a name="iagentcommandssetvoice"></a><span data-ttu-id="10548-103">IAgentCommands:: sevoice</span><span class="sxs-lookup"><span data-stu-id="10548-103">IAgentCommands::SetVoice</span></span>

<span data-ttu-id="10548-104">\[Microsoft Agent è stato deprecato a partire da Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="10548-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

``` syntax
HRESULT SetVoice(
   BSTR bszVoice  // the Voice setting for Command collection
);
```

<span data-ttu-id="10548-105">Imposta la proprietà del testo [**vocale**](voice-property.md) per un [**comando**](/windows/desktop/lwef/the-command-object).</span><span class="sxs-lookup"><span data-stu-id="10548-105">Sets the [**Voice**](voice-property.md) text property for a [**Command**](/windows/desktop/lwef/the-command-object).</span></span>

-   <span data-ttu-id="10548-106">Restituisce \_ OK per indicare che l'operazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="10548-106">Returns S\_OK to indicate the operation was successful.</span></span>

<dl> <dt>

<span data-ttu-id="10548-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*bszVoice*</span><span class="sxs-lookup"><span data-stu-id="10548-107"><span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*bszVoice*</span></span>
</dt> <dd>

<span data-ttu-id="10548-108">BSTR che specifica il valore per la proprietà del testo [**vocale**](voice-property.md) di una raccolta di [**comandi**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="10548-108">A BSTR that specifies the value for the [**Voice**](voice-property.md) text property of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span>

</dd> </dl>

<span data-ttu-id="10548-109">Una raccolta di [**comandi**](/windows/desktop/lwef/the-commands-collection-object) deve avere la proprietà testo [**vocale**](voice-property.md) impostata per essere accessibile tramite voce.</span><span class="sxs-lookup"><span data-stu-id="10548-109">A [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection must have its [**Voice**](voice-property.md) text property set to be voice-accessible.</span></span> <span data-ttu-id="10548-110">È necessario che la proprietà [**VoiceCaption**](voicecaption-property.md) o [**Caption**](caption-property.md) impostata su venga visualizzata nella finestra comandi vocali e che la relativa proprietà [**Visible**](visible-property.md) sia impostata su **true** per essere visualizzata nel menu di scelta rapida del carattere.</span><span class="sxs-lookup"><span data-stu-id="10548-110">It also must have its [**VoiceCaption**](voicecaption-property.md) or [**Caption**](caption-property.md) property set to appear in the Voice Commands Window and its [**Visible**](visible-property.md) property set to **True** to appear on the character's pop-up menu.</span></span>

<span data-ttu-id="10548-111">L'espressione BSTR fornita può includere caratteri di parentesi quadre ( \[ \] ) per indicare parole facoltative e caratteri barra verticale ( \| ) per indicare stringhe alternative.</span><span class="sxs-lookup"><span data-stu-id="10548-111">The BSTR expression you supply can include square bracket characters (\[ \]) to indicate optional words and vertical bar characters (\|) to indicate alternative strings.</span></span> <span data-ttu-id="10548-112">Le alternative devono essere racchiuse tra parentesi.</span><span class="sxs-lookup"><span data-stu-id="10548-112">Alternates must be enclosed in parentheses.</span></span> <span data-ttu-id="10548-113">Ad esempio, "(Hello \[ There \] \| HI)" indica al motore di riconoscimento vocale di accettare "Hello", "Hello there" o "Hi" per il comando.</span><span class="sxs-lookup"><span data-stu-id="10548-113">For example, "(hello \[there\] \| hi)" tells the speech engine to accept "hello," "hello there," or "hi" for the command.</span></span> <span data-ttu-id="10548-114">Ricordarsi di includere spazi appropriati tra le parole incluse tra parentesi quadre o tra parentesi e altro testo.</span><span class="sxs-lookup"><span data-stu-id="10548-114">Remember to include appropriate spaces between words you include in brackets or parentheses as well as other text.</span></span> <span data-ttu-id="10548-115">Ricordarsi di includere spazi appropriati tra il testo racchiuso tra parentesi quadre o le parentesi e il testo che non è racchiuso tra parentesi quadre.</span><span class="sxs-lookup"><span data-stu-id="10548-115">Remember to include appropriate spaces between the text that's in brackets or parentheses and the text that's not in brackets or parentheses.</span></span>

<span data-ttu-id="10548-116">È possibile usare l'operatore Star ( \* ) per specificare zero o più istanze delle parole incluse nel gruppo o l'operatore più (+) per specificare una o più istanze.</span><span class="sxs-lookup"><span data-stu-id="10548-116">You can use the star (\*) operator to specify zero or more instances of the words included in the group or the plus (+) operator to specify one or more instances.</span></span> <span data-ttu-id="10548-117">Ad esempio, di seguito viene riportata una grammatica che supporta "try this", "try this" e "try this", with Unlimited iteraziones of "Please":</span><span class="sxs-lookup"><span data-stu-id="10548-117">For example, the following results in a grammar that supports "try this", "please try this", and "please please try this", with unlimited iterations of "please":</span></span>

``` syntax
   "please* try this"
```

<span data-ttu-id="10548-118">Il formato di grammatica seguente esclude "try this" perché l'operatore + definisce almeno un'istanza di "Please":</span><span class="sxs-lookup"><span data-stu-id="10548-118">The following grammar format excludes "try this" because the + operator defines at least one instance of "please":</span></span>

``` syntax
   "please+ try this"
```

<span data-ttu-id="10548-119">Gli operatori di ripetizione seguono le normali regole di precedenza e si applicano all'elemento di testo immediatamente precedente.</span><span class="sxs-lookup"><span data-stu-id="10548-119">The repetition operators follow normal rules of precedence and apply to the immediately preceding text item.</span></span> <span data-ttu-id="10548-120">Ad esempio, la grammatica seguente restituisce "New York" e "New York York", ma non "New York New York":</span><span class="sxs-lookup"><span data-stu-id="10548-120">For example, the following grammar results in "New York" and "New York York", but not "New York New York":</span></span>

``` syntax
   "New York+"
```

<span data-ttu-id="10548-121">Pertanto, in genere si desidera utilizzare questi operatori con i caratteri di raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="10548-121">Therefore, you typically want to use these operators with the grouping characters.</span></span> <span data-ttu-id="10548-122">Ad esempio, la grammatica seguente include sia "New York" sia "New York New York":</span><span class="sxs-lookup"><span data-stu-id="10548-122">For example, the following grammar includes both "New York" and "New York New York":</span></span>

``` syntax
   "(New York)+"
```

<span data-ttu-id="10548-123">Gli operatori di ripetizione sono utili quando si desidera comporre una grammatica che includa una sequenza ripetuta, ad esempio un numero di telefono o una specifica di un elenco di elementi:</span><span class="sxs-lookup"><span data-stu-id="10548-123">Repetition operators are useful when you want to compose a grammar that includes a repeated sequence such as a phone number or specification of a list of items:</span></span>

``` syntax
   "call (one|two|three|four|five|six|seven|eight|nine|zero|oh)*"
   "I'd like (cheese|pepperoni|pineapple|canadian bacon|mushrooms|and)+"
```

<span data-ttu-id="10548-124">Sebbene gli operatori possano essere utilizzati anche con le parentesi quadre (un carattere di raggruppamento facoltativo), in questo modo è possibile ridurre l'efficienza dell'elaborazione della grammatica da parte dell'agente.</span><span class="sxs-lookup"><span data-stu-id="10548-124">Although the operators can also be used with square brackets (an optional grouping character), doing so may reduce the efficiency of Agent's processing of the grammar.</span></span>

<span data-ttu-id="10548-125">È anche possibile usare i puntini di sospensione (...) per supportare l' *individuazione* di parole, ovvero indicare al motore di riconoscimento vocale di ignorare le parole pronunciate in questa posizione nella frase (talvolta denominata *Garbage* Word).</span><span class="sxs-lookup"><span data-stu-id="10548-125">You can also use an ellipsis (...) to support *word spotting*, that is, telling the speech recognition engine to ignore words spoken in this position in the phrase (sometimes called *garbage* words).</span></span> <span data-ttu-id="10548-126">Quando si usano i puntini di sospensione, il motore di riconoscimento vocale riconosce solo parole specifiche nella stringa, indipendentemente dal fatto che vengano pronunciate parole o frasi adiacenti.</span><span class="sxs-lookup"><span data-stu-id="10548-126">When you use ellipses, the speech engine recognizes only specific words in the string regardless of when spoken with adjacent words or phrases.</span></span> <span data-ttu-id="10548-127">Se ad esempio si imposta questa proprietà su " \[ ... \] controllare la posta elettronica \[ ... \] "il motore di riconoscimento vocale corrisponde a frasi come" controllare la posta elettronica "o" selezionare la posta elettronica "per questo comando.</span><span class="sxs-lookup"><span data-stu-id="10548-127">For example, if you set this property to "\[...\] check mail \[...\]" the speech recognition engine will match phrases like "please check mail" or "check mail please" to this command.</span></span> <span data-ttu-id="10548-128">I puntini di sospensione possono essere usati in qualsiasi punto all'interno di una stringa.</span><span class="sxs-lookup"><span data-stu-id="10548-128">Ellipses can be used anywhere within a string.</span></span> <span data-ttu-id="10548-129">Tuttavia, prestare attenzione all'uso di questa tecnica poiché le impostazioni vocali con ellissi possono aumentare il rischio di corrispondenze indesiderate.</span><span class="sxs-lookup"><span data-stu-id="10548-129">However, be careful using this technique as voice settings with ellipses may increase the potential of unwanted matches.</span></span>

<span data-ttu-id="10548-130">Quando si definiscono le parole e la grammatica del comando, includere almeno una parola richiesta; ovvero evitare di fornire solo parole facoltative.</span><span class="sxs-lookup"><span data-stu-id="10548-130">When defining the words and grammar for your command, include at least one word that is required; that is, avoid supplying only optional words.</span></span> <span data-ttu-id="10548-131">Assicurarsi inoltre che la parola includa solo parole e lettere pronunciabili.</span><span class="sxs-lookup"><span data-stu-id="10548-131">In addition, make sure that the word includes only pronounceable words and letters.</span></span> <span data-ttu-id="10548-132">Per i numeri, è preferibile scrivere la parola anziché usare una rappresentazione ambigua.</span><span class="sxs-lookup"><span data-stu-id="10548-132">For numbers, it is better to spell out the word rather than use an ambiguous representation.</span></span> <span data-ttu-id="10548-133">Ad esempio, "345" non è un formato di grammatica valido.</span><span class="sxs-lookup"><span data-stu-id="10548-133">For example, "345" is not a good grammar form.</span></span> <span data-ttu-id="10548-134">Analogamente, anziché "IEEE", utilizzare "I triple E".</span><span class="sxs-lookup"><span data-stu-id="10548-134">Similarly, instead of "IEEE", use "I triple E".</span></span> <span data-ttu-id="10548-135">Omettere anche segni di punteggiatura o simboli.</span><span class="sxs-lookup"><span data-stu-id="10548-135">Also, omit any punctuation or symbols.</span></span> <span data-ttu-id="10548-136">Ad esempio, invece di "The \# $1 10 pizza!", usare "The number 1 10 Dollar pizza".</span><span class="sxs-lookup"><span data-stu-id="10548-136">For example, instead of "the \#1 $10 pizza!", use "the number one ten dollar pizza".</span></span> <span data-ttu-id="10548-137">L'inclusione di caratteri o simboli non pronunciabili per un comando può causare la mancata compilazione della grammatica da parte del motore vocale per tutti i comandi.</span><span class="sxs-lookup"><span data-stu-id="10548-137">Including non-pronounceable characters or symbols for one command may cause the speech engine to fail to compile the grammar for all your commands.</span></span> <span data-ttu-id="10548-138">Infine, impostare il parametro Voice come più ragionevolmente possibile da altri comandi vocali definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="10548-138">Finally, make your voice parameter as distinct as reasonably possible from other voice commands you define.</span></span> <span data-ttu-id="10548-139">Maggiore è la somiglianza tra la grammatica vocale per i comandi, più probabile verrà creato un errore di riconoscimento da parte del motore di riconoscimento vocale.</span><span class="sxs-lookup"><span data-stu-id="10548-139">The greater the similarity between the voice grammar for commands, the more likely the speech engine will make a recognition error.</span></span> <span data-ttu-id="10548-140">È anche possibile usare i punteggi di confidenza per distinguere meglio tra due comandi che possono avere una grammatica vocale simile o simile.</span><span class="sxs-lookup"><span data-stu-id="10548-140">You can also use the confidence scores to better distinguish between two commands that may have similar or similar-sounding voice grammar.</span></span>

<span data-ttu-id="10548-141">È possibile includere nelle parole grammaticali sotto forma di "*\\ pronuncia del testo*", dove "testo" è il testo visualizzato e "Pronuncia" è un testo che chiarisce la pronuncia.</span><span class="sxs-lookup"><span data-stu-id="10548-141">You can include in your grammar words in the form of "*text\\pronunciation*", where "text" is the text displayed and "pronunciation" is text that clarifies the pronunciation.</span></span> <span data-ttu-id="10548-142">Ad esempio, la grammatica "1st \\ First" viene riconosciuta quando l'utente dice "First", ma l'evento del [**comando**](/windows/desktop/lwef/the-command-object) restituirà il testo "1st \\ First".</span><span class="sxs-lookup"><span data-stu-id="10548-142">For example, the grammar, "1st\\first", would be recognized when the user says "first," but the [**Command**](/windows/desktop/lwef/the-command-object) event will return the text, "1st\\first".</span></span> <span data-ttu-id="10548-143">È anche possibile usare IPA (alfabeto fonetico internazionale) per specificare una pronuncia iniziando la pronuncia con un carattere di cancelletto (" \# "), quindi il testo che rappresenta la pronuncia IPA.</span><span class="sxs-lookup"><span data-stu-id="10548-143">You can also use IPA (International Phonetic Alphabet) to specify a pronunciation by beginning the pronunciation with a pound-sign character ("\#"), then the text representing the IPA pronunciation.</span></span>

<span data-ttu-id="10548-144">Per i motori di riconoscimento vocale giapponese è possibile definire la grammatica nel formato "*Kana \\ kanji*", riducendo le pronunce alternative e aumentando la precisione.</span><span class="sxs-lookup"><span data-stu-id="10548-144">For Japanese speech recognition engines, you can define grammar in the form "*kana\\kanji*," reducing the alternative pronunciations and increasing the accuracy.</span></span> <span data-ttu-id="10548-145">L'ordine è invertito per compatibilità con le versioni precedenti. Questa operazione è particolarmente importante per la pronuncia dei nomi appropriati in kanji.</span><span class="sxs-lookup"><span data-stu-id="10548-145">(The ordering is reversed for backward compatibility.) This is particularly important for the pronunciation of proper names in Kanji.</span></span> <span data-ttu-id="10548-146">Tuttavia, è possibile passare solo "kanji" senza il kana, nel qual caso il motore deve restare in ascolto di tutte le pronunce accettabili per il kanji.</span><span class="sxs-lookup"><span data-stu-id="10548-146">However, you can just pass in "kanji," without the Kana, in which case the engine should listen for all acceptable pronunciations for the Kanji.</span></span> <span data-ttu-id="10548-147">È anche possibile passare solo Kana.</span><span class="sxs-lookup"><span data-stu-id="10548-147">You can also pass in just Kana.</span></span>

<span data-ttu-id="10548-148">Ad eccezione degli errori che utilizzano i caratteri di raggruppamento o di ripetizione, l'agente Microsoft non riporterà errori nella grammatica, a meno che il motore non segnali l'errore.</span><span class="sxs-lookup"><span data-stu-id="10548-148">Except for errors using the grouping or repetition formatting characters, Microsoft Agent will not report errors in your grammar, unless the engine itself reports the error.</span></span> <span data-ttu-id="10548-149">Se si passa un testo nella grammatica che non riesce a compilare il motore, ma il motore non viene gestito e restituito come errore, Agent non è in grado di segnalare l'errore.</span><span class="sxs-lookup"><span data-stu-id="10548-149">If you pass text in your grammar that the engine fails to compile, but the engine does not handle and return as an error, Agent cannot report the error.</span></span> <span data-ttu-id="10548-150">Pertanto, l'applicazione client deve prestare particolare attenzione alla definizione della grammatica per la proprietà [**Voice**](voice-property.md) .</span><span class="sxs-lookup"><span data-stu-id="10548-150">Therefore, the client application must be careful defining the grammar for the [**Voice**](voice-property.md) property.</span></span>

> [!Note]  
> <span data-ttu-id="10548-151">Le funzionalità di grammatica disponibili possono dipendere dal motore di riconoscimento vocale.</span><span class="sxs-lookup"><span data-stu-id="10548-151">The grammar features available may depend on the speech recognition engine.</span></span> <span data-ttu-id="10548-152">Si consiglia di verificare con il fornitore del motore di determinare quali opzioni di grammatica sono supportate.</span><span class="sxs-lookup"><span data-stu-id="10548-152">You may want to check with the engine's vendor to determine what grammar options are supported.</span></span> <span data-ttu-id="10548-153">Usare [**SRModeID**](srmodeid-property.md) per usare un motore specifico.</span><span class="sxs-lookup"><span data-stu-id="10548-153">Use the [**SRModeID**](srmodeid-property.md) to use a specific engine.</span></span>

 

<span data-ttu-id="10548-154">Il funzionamento di questa proprietà dipende dallo stato di riconoscimento vocale del server di Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="10548-154">The operation of this property depends on the state of Microsoft Agent server's speech recognition state.</span></span> <span data-ttu-id="10548-155">Se, ad esempio, il riconoscimento vocale è disabilitato o non è installato, questa funzione non ha alcun effetto immediato.</span><span class="sxs-lookup"><span data-stu-id="10548-155">For example, if speech recognition is disabled or not installed, this function has no immediate effect.</span></span> <span data-ttu-id="10548-156">Se il riconoscimento vocale è abilitato durante una sessione, tuttavia, il comando diventerà accessibile quando la relativa applicazione client è di input-attivo.</span><span class="sxs-lookup"><span data-stu-id="10548-156">If speech recognition is enabled during a session, however, the command will become accessible when its client application is input-active.</span></span>

## <a name="see-also"></a><span data-ttu-id="10548-157">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="10548-157">See Also</span></span>

<span data-ttu-id="10548-158">[**IAgentCommands:: getvoice**](iagentcommands--getvoice.md), [**IAgentCommands:: Caption**](iagentcommands--setcaption.md), [**IAgentCommands:: sevisible**](iagentcommands--setvisible.md)</span><span class="sxs-lookup"><span data-stu-id="10548-158">[**IAgentCommands::GetVoice**](iagentcommands--getvoice.md), [**IAgentCommands::SetCaption**](iagentcommands--setcaption.md), [**IAgentCommands::SetVisible**](iagentcommands--setvisible.md)</span></span>


 

 