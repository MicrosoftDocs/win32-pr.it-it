---
title: Creazione di riconciliatori di cartelle
description: Un riconciliatore della valigetta fornisce alla valigetta i mezzi per riconciliare le diverse versioni di un documento.
ms.assetid: 86d66291-96ae-40ea-98ef-ef263f25aa82
keywords:
- riconciliatori di cartelle
- riconciliazione
- IReconcilableObject
- IReconcileInitiator
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b925e7055e15f6c7a49408aa28d147fb2eef5a7e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104398868"
---
# <a name="creating-briefcase-reconcilers"></a><span data-ttu-id="e682b-107">Creazione di riconciliatori di cartelle</span><span class="sxs-lookup"><span data-stu-id="e682b-107">Creating Briefcase Reconcilers</span></span>

<span data-ttu-id="e682b-108">Un riconciliatore della valigetta fornisce alla valigetta i mezzi per riconciliare le diverse versioni di un documento.</span><span class="sxs-lookup"><span data-stu-id="e682b-108">A briefcase reconciler gives Briefcase the means to reconcile different versions of a document.</span></span>

-   [<span data-ttu-id="e682b-109">Informazioni sui riconciliatori della cartella</span><span class="sxs-lookup"><span data-stu-id="e682b-109">About Briefcase Reconcilers</span></span>](#about-briefcase-reconcilers)
    -   [<span data-ttu-id="e682b-110">Riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-110">Reconciliation</span></span>](#reconciliation)
    -   [<span data-ttu-id="e682b-111">Creazione di un riconciliatore di valigetta</span><span class="sxs-lookup"><span data-stu-id="e682b-111">Creating a Briefcase Reconciler</span></span>](#creating-a-briefcase-reconciler)
    -   [<span data-ttu-id="e682b-112">Interazione dell'utente nella riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-112">User Interaction in Reconciliation</span></span>](#user-interaction-in-reconciliation)
    -   [<span data-ttu-id="e682b-113">Riconciliazione di oggetti incorporati</span><span class="sxs-lookup"><span data-stu-id="e682b-113">Reconciling Embedded Objects</span></span>](#reconciling-embedded-objects)
    -   [<span data-ttu-id="e682b-114">Residui</span><span class="sxs-lookup"><span data-stu-id="e682b-114">Residues</span></span>](#residues)
-   [<span data-ttu-id="e682b-115">Riferimento al Riconciliatore di cartelle</span><span class="sxs-lookup"><span data-stu-id="e682b-115">Briefcase Reconciler Reference</span></span>](#briefcase-reconciler-reference)
    -   [<span data-ttu-id="e682b-116">Metodi e interfacce del riconciliatore di cartelle</span><span class="sxs-lookup"><span data-stu-id="e682b-116">Briefcase Reconciler Interfaces and Methods</span></span>](#briefcase-reconciler-interfaces-and-methods)

## <a name="about-briefcase-reconcilers"></a><span data-ttu-id="e682b-117">Informazioni sui riconciliatori della cartella</span><span class="sxs-lookup"><span data-stu-id="e682b-117">About Briefcase Reconcilers</span></span>

<span data-ttu-id="e682b-118">Un riconciliatore di cartelle combina diverse versioni di input di un documento per produrre una singola versione di output del documento.</span><span class="sxs-lookup"><span data-stu-id="e682b-118">A briefcase reconciler combines different input versions of a document to produce a single, new output version of the document.</span></span> <span data-ttu-id="e682b-119">Potrebbe essere necessario creare un riconciliatore di valigetta per supportare il tipo di documento.</span><span class="sxs-lookup"><span data-stu-id="e682b-119">You might need to create a briefcase reconciler to support your type of document.</span></span> <span data-ttu-id="e682b-120">Questa panoramica descrive i riconciliatori della valigetta e spiega come crearli.</span><span class="sxs-lookup"><span data-stu-id="e682b-120">This overview describes briefcase reconcilers and explains how to create them.</span></span>

<span data-ttu-id="e682b-121">Vengono trattati i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="e682b-121">The following topics are discussed:</span></span>

-   [<span data-ttu-id="e682b-122">Riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-122">Reconciliation</span></span>](#reconciliation)
-   [<span data-ttu-id="e682b-123">Creazione di un riconciliatore di valigetta</span><span class="sxs-lookup"><span data-stu-id="e682b-123">Creating a Briefcase Reconciler</span></span>](#creating-a-briefcase-reconciler)
-   [<span data-ttu-id="e682b-124">Interazione dell'utente nella riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-124">User Interaction in Reconciliation</span></span>](#user-interaction-in-reconciliation)
-   [<span data-ttu-id="e682b-125">Riconciliazione di oggetti incorporati</span><span class="sxs-lookup"><span data-stu-id="e682b-125">Reconciling Embedded Objects</span></span>](#reconciling-embedded-objects)
-   [<span data-ttu-id="e682b-126">Residui</span><span class="sxs-lookup"><span data-stu-id="e682b-126">Residues</span></span>](#residues)

### <a name="reconciliation"></a><span data-ttu-id="e682b-127">Riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-127">Reconciliation</span></span>

<span data-ttu-id="e682b-128">Un documento è una raccolta di informazioni che possono essere copiate e modificate.</span><span class="sxs-lookup"><span data-stu-id="e682b-128">A document is a collection of information that can be copied and changed.</span></span> <span data-ttu-id="e682b-129">Un documento dispone di versioni diverse se il contenuto di almeno due copie del documento è diverso.</span><span class="sxs-lookup"><span data-stu-id="e682b-129">A document has different versions if the contents of at least two copies of the document are different.</span></span> <span data-ttu-id="e682b-130">La riconciliazione produce una singola versione di un documento da due o più versioni iniziali.</span><span class="sxs-lookup"><span data-stu-id="e682b-130">Reconciliation produces a single version of a document from two or more initial versions.</span></span> <span data-ttu-id="e682b-131">In genere, la versione riconciliata è costituita da una combinazione di informazioni delle versioni iniziali con le informazioni più recenti o più utili mantenute.</span><span class="sxs-lookup"><span data-stu-id="e682b-131">Typically, the reconciled version is a combination of information from the initial versions with the most recent or most useful information preserved.</span></span>

<span data-ttu-id="e682b-132">La riconciliazione viene avviata da sincronia quando determina che due o più copie dello stesso documento sono diverse.</span><span class="sxs-lookup"><span data-stu-id="e682b-132">Reconciliation is initiated by Briefcase when it determines that two or more copies of the same document are different.</span></span> <span data-ttu-id="e682b-133">La valigetta, che funge da iniziatore in questo contesto, individua e avvia il Riconciliatore di valigetta associato al tipo di documento specificato.</span><span class="sxs-lookup"><span data-stu-id="e682b-133">Briefcase, which acts as the initiator in this context, locates and starts the briefcase reconciler associated with the given document type.</span></span> <span data-ttu-id="e682b-134">Il riconciliatore Confronta i documenti e determina le parti dei documenti da mantenere.</span><span class="sxs-lookup"><span data-stu-id="e682b-134">The reconciler compares the documents and determines which portions of the documents to retain.</span></span> <span data-ttu-id="e682b-135">Alcuni riconciliatori potrebbero richiedere l'interazione dell'utente per completare la riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-135">Some reconcilers might require user interaction to complete reconciliation.</span></span> <span data-ttu-id="e682b-136">Altri potrebbero completare la riconciliazione senza interazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e682b-136">Others might complete reconciliation without user interaction.</span></span> <span data-ttu-id="e682b-137">Il riconciliatore può essere contenuto all'interno di un'applicazione o essere un'estensione implementata come DLL.</span><span class="sxs-lookup"><span data-stu-id="e682b-137">The reconciler can be contained within an application or be an extension implemented as a DLL.</span></span>

<span data-ttu-id="e682b-138">Alcuni riconciliatori della valigetta potrebbero creare i residui.</span><span class="sxs-lookup"><span data-stu-id="e682b-138">Some briefcase reconcilers might create residues.</span></span> <span data-ttu-id="e682b-139">Un residuo è un documento, in genere con lo stesso tipo di file del documento iniziale, che contiene informazioni non salvate nella versione unita.</span><span class="sxs-lookup"><span data-stu-id="e682b-139">A residue is a document, usually having the same file type as the initial document, that contains information not saved in the merged version.</span></span> <span data-ttu-id="e682b-140">I residui vengono in genere usati per fornire agli autori un modo rapido per determinare quali informazioni del documento originale non sono nella versione finale unita.</span><span class="sxs-lookup"><span data-stu-id="e682b-140">Residues are typically used to give authors a quick way to determine what information from their original document is not in the final merged version.</span></span> <span data-ttu-id="e682b-141">Se un riconciliatore supporta i residui, viene creato un residuo per ogni versione originale del documento.</span><span class="sxs-lookup"><span data-stu-id="e682b-141">If a reconciler supports residues, it creates one residue for each of the original versions of the document.</span></span> <span data-ttu-id="e682b-142">I residui non vengono creati a meno che non vengano richiesti dall'initiator.</span><span class="sxs-lookup"><span data-stu-id="e682b-142">Residues are not created unless the initiator requests them.</span></span>

<span data-ttu-id="e682b-143">Alcuni riconciliatori di valigetta funzionano con la valigetta per consentire all'utente di terminare la riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-143">Some briefcase reconcilers work with Briefcase to allow the user to terminate reconciliation.</span></span> <span data-ttu-id="e682b-144">Si tratta di una funzionalità importante per un utente che può decidere che la riconciliazione non deve continuare.</span><span class="sxs-lookup"><span data-stu-id="e682b-144">This is an important feature for a user who might decide that the reconciliation should not proceed.</span></span> <span data-ttu-id="e682b-145">Un riconciliatore in genere fornisce un oggetto di terminazione quando la riconciliazione richiede l'interazione dell'utente e potrebbe essere lunga.</span><span class="sxs-lookup"><span data-stu-id="e682b-145">A reconciler typically provides a termination object when the reconciliation requires user interaction and might be lengthy.</span></span> <span data-ttu-id="e682b-146">In alcuni ambienti un riconciliatore potrebbe consentire la riconciliazione parziale, consentendo a un utente di sospendere temporaneamente una riconciliazione e di riprenderla in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="e682b-146">In some environments, a reconciler might allow partial reconciliation, enabling a user to temporarily suspend a reconciliation and resume it later.</span></span> <span data-ttu-id="e682b-147">Tuttavia, la cartella non supporta attualmente la riconciliazione parziale.</span><span class="sxs-lookup"><span data-stu-id="e682b-147">Briefcase does not currently support partial reconciliation, however.</span></span>

### <a name="creating-a-briefcase-reconciler"></a><span data-ttu-id="e682b-148">Creazione di un riconciliatore di valigetta</span><span class="sxs-lookup"><span data-stu-id="e682b-148">Creating a Briefcase Reconciler</span></span>

<span data-ttu-id="e682b-149">Si crea un riconciliatore di valigetta implementando le interfacce di riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-149">You create a briefcase reconciler by implementing the reconciliation interfaces.</span></span> <span data-ttu-id="e682b-150">Come minimo, un riconciliatore implementa l'interfaccia [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) e l'interfaccia [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) o [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) .</span><span class="sxs-lookup"><span data-stu-id="e682b-150">At a minimum, a reconciler implements the [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) interface and the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) or [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface.</span></span> <span data-ttu-id="e682b-151">Come iniziatore, la cartella di sincronizzazione determina quando è necessaria la riconciliazione e chiama il metodo [**IReconcilableObject:: riconcilia**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) per avviare la riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-151">As the initiator, Briefcase determines when reconciliation is needed and calls the [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) method to initiate reconciliation.</span></span>

<span data-ttu-id="e682b-152">Sebbene [**IReconcilableObject:: riconcilia**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) fornisca un ampio set di funzionalità di riconciliazione, nella maggior parte dei casi un riconciliatore di valigetta esegue solo la riconciliazione minima.</span><span class="sxs-lookup"><span data-stu-id="e682b-152">Although [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) provides a wide-ranging set of reconciliation capabilities, a briefcase reconciler carries out only minimal reconciliation in most cases.</span></span> <span data-ttu-id="e682b-153">In particolare, per la cartella non è necessario che il riconciliatore supporti la generazione di residui o per supportare l'oggetto di terminazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-153">In particular, Briefcase does not require the reconciler to support residue generation or to support the termination object.</span></span> <span data-ttu-id="e682b-154">Inoltre, il riconciliatore esegue una singola riconciliazione dall'alto verso il basso e non deve restituire il \_ valore REC e \_ non completato, ovvero non deve tentare la riconciliazione parziale.</span><span class="sxs-lookup"><span data-stu-id="e682b-154">Also, the reconciler carries out a single top-to-bottom reconciliation and must not return the REC\_E\_NOTCOMPLETE value; that is, it should not attempt partial reconciliation.</span></span>

<span data-ttu-id="e682b-155">La cartella fornisce l'interfaccia [**IReconcileInitiator**](ireconcileinitiator.md) .</span><span class="sxs-lookup"><span data-stu-id="e682b-155">Briefcase provides the [**IReconcileInitiator**](ireconcileinitiator.md) interface.</span></span> <span data-ttu-id="e682b-156">Il riconciliatore della valigetta può usare il metodo [**IReconcileInitiator:: SetAbortCallback**](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback) per impostare l'oggetto di terminazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-156">The briefcase reconciler can use the [**IReconcileInitiator::SetAbortCallback**](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback) method to set the termination object.</span></span> <span data-ttu-id="e682b-157">La cartella non usa gli identificatori di versione e non può, pertanto, fornire versioni precedenti di un documento se un riconciliatore le richiede usando i metodi corrispondenti in **IReconcileInitiator**.</span><span class="sxs-lookup"><span data-stu-id="e682b-157">Briefcase does not use version identifiers and cannot, therefore, provide previous versions of a document if a reconciler requests them using the corresponding methods in **IReconcileInitiator**.</span></span>

<span data-ttu-id="e682b-158">La valigetta passa ai moniker di file [**IReconcilableObject:: riconcilia**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) che rappresentano le versioni del documento da riconciliare.</span><span class="sxs-lookup"><span data-stu-id="e682b-158">Briefcase passes to [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) file monikers representing the versions of the document to be reconciled.</span></span> <span data-ttu-id="e682b-159">Il riconciliatore della valigetta Ottiene l'accesso alle versioni usando il metodo [IMoniker:: BindToObject](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject) o [IMoniker:: BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) .</span><span class="sxs-lookup"><span data-stu-id="e682b-159">The briefcase reconciler gains access to the versions by using either the [IMoniker::BindToObject](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject) or [IMoniker::BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) method.</span></span> <span data-ttu-id="e682b-160">Quest'ultimo è in genere più veloce ed è consigliato.</span><span class="sxs-lookup"><span data-stu-id="e682b-160">The latter is generally faster and is recommended.</span></span> <span data-ttu-id="e682b-161">Il riconciliatore deve rilasciare tutti gli oggetti o le archiviazioni a cui è associato.</span><span class="sxs-lookup"><span data-stu-id="e682b-161">The reconciler must release any objects or storage to which it binds.</span></span>

<span data-ttu-id="e682b-162">Quando il riconciliatore della valigetta USA [IMoniker:: BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage), viene associato allo spazio di archiviazione che è l'archiviazione Flat (un flusso) o l'archiviazione strutturata definita da OLE.</span><span class="sxs-lookup"><span data-stu-id="e682b-162">When the briefcase reconciler uses [IMoniker::BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage), it binds to storage that is either flat storage (a stream) or OLE-defined structured storage.</span></span> <span data-ttu-id="e682b-163">Se il riconciliatore prevede l'archiviazione Flat, deve usare IMoniker:: BindToStorage per richiedere l'interfaccia [IStream](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="e682b-163">If the reconciler expects flat storage, it should use IMoniker::BindToStorage to request the [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="e682b-164">Se il riconciliatore prevede l'archiviazione strutturata, deve richiedere l'interfaccia [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="e682b-164">If the reconciler expects structured storage, it should request the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface.</span></span> <span data-ttu-id="e682b-165">In entrambi i casi, deve richiedere l'accesso diretto (non transazionale) di sola lettura all'archiviazione; l'accesso in lettura/scrittura potrebbe non essere disponibile.</span><span class="sxs-lookup"><span data-stu-id="e682b-165">In both cases, it should request read-only direct (nontransacted) access to the storage; read/write access might not be available.</span></span>

<span data-ttu-id="e682b-166">Un riconciliatore di valigetta minimo in genere cerca direttamente nello spazio di archiviazione delle altre versioni e gestisce gli oggetti incorporati in modo molto primitivo, ad esempio unendo due versioni dell'oggetto includendo entrambe le versioni nella versione di output.</span><span class="sxs-lookup"><span data-stu-id="e682b-166">A minimal briefcase reconciler typically looks directly at the storage of the other versions and deals with embedded objects in a very primitive manner, such as merging two versions of the object by including both versions in the output version.</span></span>

<span data-ttu-id="e682b-167">L'initiator individua il Riconciliatore di valigetta appropriato usando un subset della logica implementata dalla funzione [GetClassFile](/windows/win32/api/objbase/nf-objbase-getclassfile) per determinare il tipo di un determinato file e quindi Cerca nel registro di sistema la classe del riconciliatore associata al tipo di file specificato.</span><span class="sxs-lookup"><span data-stu-id="e682b-167">The initiator locates the appropriate briefcase reconciler by using a subset of the logic implemented by the [GetClassFile](/windows/win32/api/objbase/nf-objbase-getclassfile) function to determine the type of a given file and then looks in the registry for the reconciler class associated with the given file type.</span></span> <span data-ttu-id="e682b-168">La valigetta, analogamente ad altri componenti della shell, determina il tipo di file esclusivamente dall'estensione del nome file.</span><span class="sxs-lookup"><span data-stu-id="e682b-168">Briefcase, like other Shell components, determines the type of a file solely by the file name extension.</span></span> <span data-ttu-id="e682b-169">L'estensione di un file deve avere un tipo di file registrato per la cartella per richiamare un riconciliatore per il file.</span><span class="sxs-lookup"><span data-stu-id="e682b-169">A file's extension must have a registered file type for Briefcase to invoke a reconciler for the file.</span></span> <span data-ttu-id="e682b-170">Quando si installa il riconciliatore, è necessario impostare una voce del registro di sistema nel formato seguente.</span><span class="sxs-lookup"><span data-stu-id="e682b-170">You must set a registry entry of the following form when installing your reconciler.</span></span>

```
CLSID
   {the file CLSID}
      Roles
         Reconciler
            (Default) = {the reconciler-classid}
```

<span data-ttu-id="e682b-171">La classe deve essere caricamento rapido, deve essere designato come \_ MULTIPLEUSE e, a meno che non vengano forniti i marshalling per l'interfaccia di riconciliazione, deve essere un server in-process (contenuto in una dll) anziché un server locale (implementato in un file exe).</span><span class="sxs-lookup"><span data-stu-id="e682b-171">The class must be quick loading, must be designated \_MULTIPLEUSE, and, unless marshalers are provided for the reconciliation interface, must be an in-process server (contained in a DLL) rather than a local server (implemented in an .exe file).</span></span>

### <a name="user-interaction-in-reconciliation"></a><span data-ttu-id="e682b-172">Interazione dell'utente nella riconciliazione</span><span class="sxs-lookup"><span data-stu-id="e682b-172">User Interaction in Reconciliation</span></span>

<span data-ttu-id="e682b-173">Un riconciliatore di valigetta deve tentare di eseguire la riconciliazione senza interazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e682b-173">A briefcase reconciler should attempt to carry out reconciliation without user interaction.</span></span> <span data-ttu-id="e682b-174">Maggiore è l'automazione della riconciliazione, migliore sarà la percezione dell'utente del processo.</span><span class="sxs-lookup"><span data-stu-id="e682b-174">The more automated the reconciliation, the better the user's perception of the process.</span></span>

<span data-ttu-id="e682b-175">In alcuni casi, l'intervento dell'utente può essere utile.</span><span class="sxs-lookup"><span data-stu-id="e682b-175">In some cases, user intervention can be valuable.</span></span> <span data-ttu-id="e682b-176">Ad esempio, un sistema di documenti potrebbe richiedere a un utente di rivedere le modifiche prima di accettare la versione unita di un documento o potrebbe richiedere commenti all'utente che spieghi le modifiche apportate.</span><span class="sxs-lookup"><span data-stu-id="e682b-176">For example, a document system might require a user to review changes before accepting the merged version of a document or might require comments from the user explaining the changes that have been made.</span></span> <span data-ttu-id="e682b-177">In questi casi, l'iniziatore, non il riconciliatore della valigetta, è responsabile dell'esecuzione di query sull'utente e delle istruzioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e682b-177">In these cases, the initiator, not the briefcase reconciler, is responsible for querying the user and carrying out the user's instructions.</span></span>

<span data-ttu-id="e682b-178">In altri casi, potrebbe essere necessario l'intervento dell'utente, ad esempio quando due versioni sono state modificate in modi incompatibili.</span><span class="sxs-lookup"><span data-stu-id="e682b-178">In other cases, user intervention might be necessary—for example, when two versions have been edited in incompatible ways.</span></span> <span data-ttu-id="e682b-179">In questi casi, il riconciliatore dell'initiator o della valigetta deve eseguire una query sull'utente per istruzioni su come risolvere il conflitto.</span><span class="sxs-lookup"><span data-stu-id="e682b-179">In such cases, either the initiator or briefcase reconciler must query the user for instructions on how to resolve the conflict.</span></span> <span data-ttu-id="e682b-180">In generale, nessun iniziatore può basarsi sul completamento di una riconciliazione senza prevedere un'interazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e682b-180">In general, no initiator can rely on completing a reconciliation without expecting some user interaction.</span></span> <span data-ttu-id="e682b-181">I riconciliatori, d'altra parte, hanno la possibilità di interagire con l'utente per risolvere i conflitti o richiedere l'Initiator a tale scopo.</span><span class="sxs-lookup"><span data-stu-id="e682b-181">Reconcilers, on the other hand, have the option of interacting with the user to resolve conflicts or requiring the initiator to do so.</span></span>

### <a name="reconciling-embedded-objects"></a><span data-ttu-id="e682b-182">Riconciliazione di oggetti incorporati</span><span class="sxs-lookup"><span data-stu-id="e682b-182">Reconciling Embedded Objects</span></span>

<span data-ttu-id="e682b-183">Quando si riconcilia un documento, il riconciliatore della valigetta può diventare un iniziatore se individua un oggetto incorporato di un tipo che non può riconciliare.</span><span class="sxs-lookup"><span data-stu-id="e682b-183">When reconciling a document, the briefcase reconciler itself can become an initiator if it discovers an embedded object of a type that it cannot reconcile.</span></span> <span data-ttu-id="e682b-184">In questo caso, il riconciliatore deve riconciliare in modo ricorsivo ciascuno degli oggetti incorporati e assumere tutte le responsabilità di un iniziatore.</span><span class="sxs-lookup"><span data-stu-id="e682b-184">In this case, the reconciler needs to recursively reconcile each of the embedded objects and assume all the responsibilities of an initiator.</span></span>

<span data-ttu-id="e682b-185">Per eseguire la ricorsione, il riconciliatore della valigetta carica l'oggetto e le query per l'interfaccia appropriata.</span><span class="sxs-lookup"><span data-stu-id="e682b-185">To carry out the recursion, the briefcase reconciler loads the object and queries for the appropriate interface.</span></span> <span data-ttu-id="e682b-186">Il gestore per l'oggetto deve supportare l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="e682b-186">The handler for the object must support the interface.</span></span> <span data-ttu-id="e682b-187">Se un metodo dell'interfaccia restituisce il valore OLE \_ E \_ non in esecuzione, il riconciliatore deve eseguire l'oggetto in modo da eseguire l'operazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-187">If any method of the interface returns the OLE\_E\_NOTRUNNING value, the reconciler must run the object in order to carry out the operation.</span></span> <span data-ttu-id="e682b-188">Poiché il codice per gli oggetti incorporati non è sempre disponibile, è necessario che un riconciliatore fornisca una soluzione per questa condizione.</span><span class="sxs-lookup"><span data-stu-id="e682b-188">Because code for embedded objects is not always available, a reconciler must provide a solution for this condition.</span></span> <span data-ttu-id="e682b-189">Ad esempio, il riconciliatore potrebbe includere sia le versioni precedenti che quelle nuove dell'oggetto incorporato nella versione riconciliata.</span><span class="sxs-lookup"><span data-stu-id="e682b-189">For example, the reconciler might include both old and new versions of the embedded object in the reconciled version.</span></span> <span data-ttu-id="e682b-190">Il riconciliatore non deve tentare la riconciliazione tra i collegamenti.</span><span class="sxs-lookup"><span data-stu-id="e682b-190">The reconciler must not attempt to reconcile across links.</span></span>

<span data-ttu-id="e682b-191">L'initiator archivia le versioni del documento sottoposte a merge.</span><span class="sxs-lookup"><span data-stu-id="e682b-191">The initiator stores the document versions being merged.</span></span> <span data-ttu-id="e682b-192">In molti casi, l'initiator ha accesso all'archiviazione di ogni versione e salva il risultato della riconciliazione usando un'archiviazione simile.</span><span class="sxs-lookup"><span data-stu-id="e682b-192">In many cases, the initiator has access to the storage of each version and saves the result of reconciliation using similar storage.</span></span> <span data-ttu-id="e682b-193">In alcuni casi, tuttavia, l'Initiator potrebbe avere un oggetto in memoria per il quale non è disponibile una versione permanente.</span><span class="sxs-lookup"><span data-stu-id="e682b-193">Sometimes, however, the initiator might have an in-memory object for which no persistent version is available.</span></span> <span data-ttu-id="e682b-194">Questa situazione può verificarsi quando un documento contenente oggetti incorporati aperti deve essere riconciliato prima di essere salvato.</span><span class="sxs-lookup"><span data-stu-id="e682b-194">This situation can occur when a document containing open embedded objects must be reconciled before being saved.</span></span> <span data-ttu-id="e682b-195">In questi casi, l'iniziatore Salva il risultato della riconciliazione nella versione trovata in memoria.</span><span class="sxs-lookup"><span data-stu-id="e682b-195">In such cases, the initiator saves the result of the reconciliation in the version found in memory.</span></span>

<span data-ttu-id="e682b-196">L'initiator utilizza l'interfaccia [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) per associare (caricare) la versione unita.</span><span class="sxs-lookup"><span data-stu-id="e682b-196">The initiator uses the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface to bind (load) the merged version.</span></span> <span data-ttu-id="e682b-197">L'initiator usa il metodo [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) se è già stata creata una versione iniziale e usa il metodo [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) per la versione iniziale.</span><span class="sxs-lookup"><span data-stu-id="e682b-197">The initiator uses the [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) method if an initial version has already been created and uses the [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) method for the initial version.</span></span> <span data-ttu-id="e682b-198">Quando viene caricata la versione unita, l'iniziatore utilizza [QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per recuperare l'indirizzo dell'interfaccia [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) .</span><span class="sxs-lookup"><span data-stu-id="e682b-198">When the merged version is loaded, the initiator uses [QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to retrieve the address of the [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) interface.</span></span> <span data-ttu-id="e682b-199">Questa interfaccia consente all'initiator di accedere all'archiviazione dei residui esistenti e fornisce un modo per creare spazio di archiviazione per eventuali nuovi residui.</span><span class="sxs-lookup"><span data-stu-id="e682b-199">This interface gives the initiator access to the storage of the existing residues and gives it a way to create storage for any new residues.</span></span> <span data-ttu-id="e682b-200">Quindi l'initiator indirizza l'interfaccia per eseguire la riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-200">Then the initiator directs the interface to carry out the reconciliation.</span></span> <span data-ttu-id="e682b-201">L'iniziatore esegue effettivamente una query per l'interfaccia [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) prima di IPersistStorage.</span><span class="sxs-lookup"><span data-stu-id="e682b-201">The initiator actually queries for the [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface before IPersistStorage.</span></span> <span data-ttu-id="e682b-202">Se il riconciliatore supporta IPersistFile, l'initiator manipola la replica tramite IPersistFile anziché i metodi IPersistStorage.</span><span class="sxs-lookup"><span data-stu-id="e682b-202">If the reconciler supports IPersistFile, the initiator manipulates the replica through the IPersistFile rather than the IPersistStorage methods.</span></span> <span data-ttu-id="e682b-203">Ciò consente la riconciliazione dei file non archiviati come documenti composti.</span><span class="sxs-lookup"><span data-stu-id="e682b-203">This permits reconciliation of files that are not stored as compound documents.</span></span>

<span data-ttu-id="e682b-204">Al termine della riconciliazione, l'initiator può salvare la versione unita utilizzando l'interfaccia [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) o [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) .</span><span class="sxs-lookup"><span data-stu-id="e682b-204">When the reconciliation is complete, the initiator can save the merged version by using the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) or [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface.</span></span> <span data-ttu-id="e682b-205">Durante la riconciliazione, il riconciliatore della valigetta crea i residui in base alle esigenze e scrive i bit persistenti nell'archivio.</span><span class="sxs-lookup"><span data-stu-id="e682b-205">During reconciliation, the briefcase reconciler creates residues as needed and writes their persistent bits to storage.</span></span> <span data-ttu-id="e682b-206">Se la versione unita è un flusso, l'interfaccia [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) passata a [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) contiene un flusso denominato "Contents" con lo stato di archiviazione impostato su STATEBITS \_ flat.</span><span class="sxs-lookup"><span data-stu-id="e682b-206">If the merged version is a stream, the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface passed to [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) contains a stream named "Contents" with its storage state set to STATEBITS\_FLAT.</span></span> <span data-ttu-id="e682b-207">(È possibile impostare i bit di stato usando il metodo [IStorage:: stat](/windows/win32/api/objidl/nf-objidl-istorage-stat) ). Dopo l'Unione, l'initiator salva la versione unita scrivendo i dati in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="e682b-207">(You can set the state bits by using the [IStorage::Stat](/windows/win32/api/objidl/nf-objidl-istorage-stat) method.) After the merge, the initiator saves the merged version by writing the data in an appropriate manner.</span></span> <span data-ttu-id="e682b-208">È necessario assicurarsi che STATEBITS \_ Flat sia impostato in modo appropriato per l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-208">It should ensure that STATEBITS\_FLAT is set as appropriate for the storage.</span></span>

### <a name="residues"></a><span data-ttu-id="e682b-209">Residui</span><span class="sxs-lookup"><span data-stu-id="e682b-209">Residues</span></span>

<span data-ttu-id="e682b-210">L'initiator indica se desidera i residui impostando il parametro *pstgNewResidues* su un indirizzo valido quando si chiama il metodo [**IReconcilableObject:: riconcilia**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) .</span><span class="sxs-lookup"><span data-stu-id="e682b-210">The initiator indicates whether it wants residues by setting the *pstgNewResidues* parameter to a valid address when calling the [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) method.</span></span> <span data-ttu-id="e682b-211">Se il riconciliatore non supporta la creazione di residui, deve restituire immediatamente il valore REC \_ E \_ noresidus, a meno che il parametro *dwFlags* specifichi il **valore \_ NORESIDUESOK di RECONCILEF** .</span><span class="sxs-lookup"><span data-stu-id="e682b-211">If the reconciler does not support the creation of residues, it must return immediately the REC\_E\_NORESIDUES value, unless the *dwFlags* parameter specifies the **RECONCILEF\_NORESIDUESOK** value.</span></span>

<span data-ttu-id="e682b-212">Il riconciliatore della valigetta restituisce i residui all'iniziatore creando nuovi elementi di archiviazione e copiando tali elementi nella matrice a cui punta *pstgNewResidues*.</span><span class="sxs-lookup"><span data-stu-id="e682b-212">The briefcase reconciler returns residues to the initiator by creating new storage elements and copying them to the array pointed to by *pstgNewResidues*.</span></span> <span data-ttu-id="e682b-213">Per i residui di archiviazione strutturata, il riconciliatore copia un'interfaccia [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) e, per i residui di archiviazione Flat, copia un'interfaccia [IStream](/windows/win32/api/objidl/nn-objidl-istream) o IStorage con il \_ flag Flat STATEBITS impostato.</span><span class="sxs-lookup"><span data-stu-id="e682b-213">For structured storage residues, the reconciler copies an [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface, and for flat storage residues, it copies either an [IStream](/windows/win32/api/objidl/nn-objidl-istream) or an IStorage interface with the STATEBITS\_FLAT flag set.</span></span> <span data-ttu-id="e682b-214">Il riconciliatore USA IStorage per creare la risorsa di archiviazione necessaria, usando [IStorage:: CreateStream](/windows/win32/api/objidl/nf-objidl-istorage-createstream) per creare l'archiviazione flat per un residuo che è un flusso e [IStorage:: CreateStorage](/windows/win32/api/objidl/nf-objidl-istorage-createstorage) per creare un archivio strutturato.</span><span class="sxs-lookup"><span data-stu-id="e682b-214">The reconciler uses IStorage to create the necessary storage, using [IStorage::CreateStream](/windows/win32/api/objidl/nf-objidl-istorage-createstream) to create flat storage for a residue that is a stream and [IStorage::CreateStorage](/windows/win32/api/objidl/nf-objidl-istorage-createstorage) to create structured storage.</span></span>

<span data-ttu-id="e682b-215">L'iniziatore prepara *pstgNewResidues* in modo che non contenga elementi nella parte non riservata dello spazio dei nomi [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="e682b-215">The initiator prepares *pstgNewResidues* so that it contains no elements in the nonreserved part of the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) namespace.</span></span> <span data-ttu-id="e682b-216">Il riconciliatore della valigetta posiziona ogni residuo in un elemento il cui nome corrisponde all'ordine della versione iniziale.</span><span class="sxs-lookup"><span data-stu-id="e682b-216">The briefcase reconciler places each residue in an element whose name corresponds to the order of its initial version.</span></span> <span data-ttu-id="e682b-217">Il primo residuo, ad esempio, è contenuto in "1", il secondo in "2" e così via.</span><span class="sxs-lookup"><span data-stu-id="e682b-217">For example, the first residue is contained in "1", the second in "2", and so on.</span></span> <span data-ttu-id="e682b-218">Se l'oggetto riconciliato produce un residuo, questo viene trovato nell'elemento denominato "0".</span><span class="sxs-lookup"><span data-stu-id="e682b-218">If the reconciled object itself produces a residue, it is found in the element named "0".</span></span>

<span data-ttu-id="e682b-219">Il riconciliatore della valigetta eseguirà il commit di ciascuno degli elementi appena creati, assicurando che l'initiator abbia accesso alle informazioni.</span><span class="sxs-lookup"><span data-stu-id="e682b-219">The briefcase reconciler commits each of the newly created elements individually, ensuring that the initiator has access to the information.</span></span> <span data-ttu-id="e682b-220">Il riconciliatore, tuttavia, non esegue il commit di *pstgNewResidues* stesso.</span><span class="sxs-lookup"><span data-stu-id="e682b-220">The reconciler does not, however, commit *pstgNewResidues* itself.</span></span> <span data-ttu-id="e682b-221">L'iniziatore è responsabile di eseguire il commit di questo o di eliminarlo in altro modo.</span><span class="sxs-lookup"><span data-stu-id="e682b-221">The initiator is responsible for committing this or otherwise disposing of it.</span></span>

## <a name="briefcase-reconciler-reference"></a><span data-ttu-id="e682b-222">Riferimento al Riconciliatore di cartelle</span><span class="sxs-lookup"><span data-stu-id="e682b-222">Briefcase Reconciler Reference</span></span>

<span data-ttu-id="e682b-223">Questa sezione contiene informazioni sulle interfacce di riconciliazione.</span><span class="sxs-lookup"><span data-stu-id="e682b-223">This section contains information about the reconciliation interfaces.</span></span> <span data-ttu-id="e682b-224">Quando si gestiscono gli errori, un metodo può restituire solo i valori di errore definiti in modo esplicito come possibili valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="e682b-224">When handling errors, a method can return only those error values that are explicitly defined as possible return values.</span></span> <span data-ttu-id="e682b-225">Inoltre, il metodo deve impostare tutte le variabili i cui indirizzi vengono passati come parametri a **null** prima di restituire l'errore.</span><span class="sxs-lookup"><span data-stu-id="e682b-225">Furthermore, the method must set all variables whose addresses are passed as parameters to **NULL** before returning from the error.</span></span>

### <a name="briefcase-reconciler-interfaces-and-methods"></a><span data-ttu-id="e682b-226">Metodi e interfacce del riconciliatore di cartelle</span><span class="sxs-lookup"><span data-stu-id="e682b-226">Briefcase Reconciler Interfaces and Methods</span></span>

-   [<span data-ttu-id="e682b-227">**IReconcilableObject**</span><span class="sxs-lookup"><span data-stu-id="e682b-227">**IReconcilableObject**</span></span>](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) 
    -   -   [<span data-ttu-id="e682b-228">**IReconcilableObject::GetProgressFeedbackMaxEstimate**</span><span class="sxs-lookup"><span data-stu-id="e682b-228">**IReconcilableObject::GetProgressFeedbackMaxEstimate**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-getprogressfeedbackmaxestimate)
        -   [<span data-ttu-id="e682b-229">**IReconcilableObject:: riconcilia**</span><span class="sxs-lookup"><span data-stu-id="e682b-229">**IReconcilableObject::Reconcile**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile)

-   [<span data-ttu-id="e682b-230">**IReconcileInitiator**</span><span class="sxs-lookup"><span data-stu-id="e682b-230">**IReconcileInitiator**</span></span>](ireconcileinitiator.md) 
    -   -   [<span data-ttu-id="e682b-231">**IReconcileInitiator::SetAbortCallback**</span><span class="sxs-lookup"><span data-stu-id="e682b-231">**IReconcileInitiator::SetAbortCallback**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback)
        -   [<span data-ttu-id="e682b-232">**IReconcileInitiator::SetProgressFeedback**</span><span class="sxs-lookup"><span data-stu-id="e682b-232">**IReconcileInitiator::SetProgressFeedback**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setprogressfeedback)

-   [<span data-ttu-id="e682b-233">**INotifyReplica**</span><span class="sxs-lookup"><span data-stu-id="e682b-233">**INotifyReplica**</span></span>](/windows/desktop/api/reconcil/nn-reconcil-inotifyreplica) 
    -   -   [<span data-ttu-id="e682b-234">**INotifyReplica::YouAreAReplica**</span><span class="sxs-lookup"><span data-stu-id="e682b-234">**INotifyReplica::YouAreAReplica**</span></span>](/windows/desktop/api/reconcil/nf-reconcil-inotifyreplica-youareareplica)

 

 