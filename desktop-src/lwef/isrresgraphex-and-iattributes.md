---
title: ISRResGraphEx e IAttributes
description: ISRResGraphEx e IAttributes
ms.assetid: 6eb37da1-5252-4c41-891c-c19cca6fb7d1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 659d7d4723bfc5145fb8abcc77043031a0e48e8b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104046572"
---
# <a name="isrresgraphex-and-iattributes"></a><span data-ttu-id="7f263-103">ISRResGraphEx e IAttributes</span><span class="sxs-lookup"><span data-stu-id="7f263-103">ISRResGraphEx and IAttributes</span></span>

<span data-ttu-id="7f263-104">\[Microsoft Agent è stato deprecato a partire da Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="7f263-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="7f263-105">Gli oggetti risultati restituiti dal motore devono supportare l'interfaccia ISRResGraphEx e l'interfaccia IAttributes.</span><span class="sxs-lookup"><span data-stu-id="7f263-105">The results objects returned by the engine must support the ISRResGraphEx interface and the IAttributes interface.</span></span> <span data-ttu-id="7f263-106">Il semplice supporto dell'interfaccia ISRResGraphEx è sufficiente per consentire all'editor di suoni di fornire informazioni di Word break, ma non fornisce il supporto necessario per le informazioni sui fonemi.</span><span class="sxs-lookup"><span data-stu-id="7f263-106">Merely supporting the ISRResGraphEx interface is enough to enable the sound editor to provide word break information, but does not provide the necessary support for phoneme information.</span></span>

<span data-ttu-id="7f263-107">L'editor di suoni richiede che i motori supportino anche un attributo DWord speciale, **SRATTR \_ PHONESEG**.</span><span class="sxs-lookup"><span data-stu-id="7f263-107">The sound editor requires that engines also support a special DWord attribute, **SRATTR\_PHONESEG**.</span></span> <span data-ttu-id="7f263-108">L'editor esegue una query sui motori per visualizzare l'interfaccia IAttributes e tenta di impostare **SRATTR \_ PHONESEG** su 1.</span><span class="sxs-lookup"><span data-stu-id="7f263-108">The editor queries the engines to see IAttributes interface and attempts to set the **SRATTR\_PHONESEG** to 1.</span></span> <span data-ttu-id="7f263-109">Se la chiamata ha esito positivo, nell'editor di suoni si presuppone che i risultati del motore supporteranno la raccolta di informazioni relative alla segmentazione dei fonemi dall'oggetto results.</span><span class="sxs-lookup"><span data-stu-id="7f263-109">If that call succeeds, the sound editor assumes that the engine's results will support the gathering of phoneme-segmentation information from results object.</span></span>

`#define    SRATTR_PHONESEG    MAKELONG (1, SRVEN_MICROSOFT)`

<span data-ttu-id="7f263-110">Quando un oggetto Results viene trasmesso all'editor audio, esegue una query sull'oggetto per la relativa implementazione di ISRResGraphEx.</span><span class="sxs-lookup"><span data-stu-id="7f263-110">When a results object is transmitted to the sound editor, it queries that object for its implementation of ISRResGraphEx.</span></span> <span data-ttu-id="7f263-111">ISRResGraphEx contiene una funzione membro, DataGet, con firma del tipo</span><span class="sxs-lookup"><span data-stu-id="7f263-111">ISRResGraphEx contains a member function, DataGet, with type signature</span></span>

`HRESULT  DataGet  (DWord, dwID, GUID gAttrib, SDATA *psData)`

<span data-ttu-id="7f263-112">Dove **dwID** è l'identificatore dell'oggetto Graph, **GATTRIB** è un GUID corrispondente all'attributo ricercato e **psData** è un puntatore a un oggetto SDATA contenente i dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="7f263-112">Where **dwID** is the identifier of the graph object, **gAttrib** is a GUID corresponding to the attribute sought, and **psData** is a pointer to an SDATA object containing the data returned.</span></span> <span data-ttu-id="7f263-113">Il motore è responsabile dell'allocazione dei dati archiviati in **psData** tramite [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span><span class="sxs-lookup"><span data-stu-id="7f263-113">The engine is responsible for allocating the data stored in **psData** through [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span></span> <span data-ttu-id="7f263-114">L'applicazione chiamante (in questo caso l'editor di suoni) è responsabile della liberazione tramite [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) al termine dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="7f263-114">The calling application (in this case the sound editor) is responsible for freeing it through [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) when it is finished.</span></span>

<span data-ttu-id="7f263-115">DataGet è necessario per riconoscere tre GUID predefiniti, elencati nella documentazione di SAPI.</span><span class="sxs-lookup"><span data-stu-id="7f263-115">DataGet is required to recognize three predefined GUIDs, which are listed in the SAPI documentation.</span></span> <span data-ttu-id="7f263-116">Un motore che restituisce un codice di esito positivo alla chiamata a **DWORDSet (SRATTR \_ PHONESEG, 1)** è necessario anche per riconoscere un GUID specifico, **SRGARC \_ PHONEMESEGMENTATION**, quando viene chiamato con un **dwID** che corrisponde a un bordo del grafico.</span><span class="sxs-lookup"><span data-stu-id="7f263-116">An engine which returns a success code to the call to **DWORDSet(SRATTR\_PHONESEG, 1)** is also required to recognize a specific GUID, **SRGARC\_PHONEMESEGMENTATION**, when called with a **dwID** that corresponds to an edge in the graph.</span></span>

`DEFINE_GUID(SRGARC_PHONMESEGMENTATION, 0xd05405b0, 0x1db1, 0x11d2, 0x94, 0x2, 0x0, 0xc0, 0x4f, 0x8e, 0xf4, 0x8f);`

<span data-ttu-id="7f263-117">Quando la chiamata restituisce, **psData** deve puntare a una matrice di una struttura con allineamento DWORD di tipo **PHONESEG**, definita da:</span><span class="sxs-lookup"><span data-stu-id="7f263-117">When the call returns, **psData** should point to an array of DWORD-aligned structure of type **PHONESEG**, defined by:</span></span>

``` syntax
typedef struct tagSRPHONESEG {
   DWORD   dwSize;       // Size of the SRPHONESEG structure + phone data
   QWORD   qwStartTime;  // SAPI timestamp of the start of the seqment
   …QWORD   qwEndTime;    // SAPI timestamp of the end of the seqment
   int      nScore;      // The segment's score
   WCHAR   aPhones[0];   // Array of phone(s) making up the segment
} SRPHONESEG,  *PSRPHONESEG;
```

<span data-ttu-id="7f263-118">dove **qwStartTime** e **qwEndTime** puntano all'inizio e alla fine di ogni fonema che costituisce la parola coperta dal perimetro e **aPhones** è una matrice di caratteri Unicode corrispondente alla rappresentazione IPA del telefono, che è stata prodotta in questo segmento.</span><span class="sxs-lookup"><span data-stu-id="7f263-118">where **qwStartTime** and **qwEndTime** point to the beginning and end of each phoneme making up the word covered by the edge, and **aPhones** is an array of Unicode characters corresponding to the IPA representation of the phone, which were produced in this segment.</span></span> <span data-ttu-id="7f263-119">In alcune lingue sono presenti fonemi digitati con più di un fonema IPA.</span><span class="sxs-lookup"><span data-stu-id="7f263-119">(In some languages, there are phonemes which are spelled with more than one IPA phoneme.</span></span> <span data-ttu-id="7f263-120">In inglese, ad esempio, il suono "Long I" nella parola "Live" è in realtà un dittongo, costituito da due fonemi più semplici concatenati. La matrice **aPhones** deve essere con terminazione zero e riempita alla fine per rendere ogni struttura **SRPHONESEG** nella matrice una lunghezza pari a un multiplo di quattro byte.</span><span class="sxs-lookup"><span data-stu-id="7f263-120">In English, for instance, the "long I" sound in the word "live" is actually a diphthong, made up of two simpler phonemes concatenated together.) The **aPhones** array should be zero terminated and padded at the end to make each **SRPHONESEG** structure in the array an even multiple of four bytes long.</span></span>

<span data-ttu-id="7f263-121">Si supponga, ad esempio, che la parola pronunciata in Arc 4 fosse "made".</span><span class="sxs-lookup"><span data-stu-id="7f263-121">For example, suppose the word spoken on arc 4 was "made".</span></span> <span data-ttu-id="7f263-122">La chiamata a DataGet (4, **SRGARC \_ PHONEMESEGMENTATION**, &SD) potrebbe restituire una matrice di tre segmenti fonema,/m/che esegue da **qwStartTime**= 328434 byte **a qwEndTime**= 330354 byte,/1e/in esecuzione da **qwStartTime**= 330354 byte a **qwEndTime**= 344114 byte e/d/in esecuzione da **qwStartTime**= 344114 byte a **qwEndTime**= 347314 byte.</span><span class="sxs-lookup"><span data-stu-id="7f263-122">Then the call to DataGet(4, **SRGARC\_PHONEMESEGMENTATION**, &sd) might return an array of three phoneme segments, /m/ running from **qwStartTime**=328434 bytes to **qwEndTime**=330354 bytes, /1e/ running from **qwStartTime**=330354 bytes to **qwEndTime**=344114 bytes, and /d/ running from **qwStartTime**=344114 bytes to **qwEndTime**=347314 bytes.</span></span> <span data-ttu-id="7f263-123">Questi vengono presentati come una matrice compressa di tre strutture **SRPHONESEG** di dimensioni rispettivamente 28, 32 e 28 byte.</span><span class="sxs-lookup"><span data-stu-id="7f263-123">These would be presented as a packed array of three **SRPHONESEG** structures of sizes 28, 32, and 28 bytes, respectively.</span></span> <span data-ttu-id="7f263-124">Si noti che è presente una spaziatura interna alla fine della struttura **SRPHONESEG** intermedia, in modo che l'elemento successivo nella matrice inizi a un limite di 4 byte.</span><span class="sxs-lookup"><span data-stu-id="7f263-124">Notice that there is some padding at the end of the middle **SRPHONESEG** structure, so that the next item in the array starts at a 4-byte boundary.</span></span>

<span data-ttu-id="7f263-125">SAPI 4,0 SDK include uno strumento (SRFunc) per il test della conformità con la specifica SAPI 4,0. Incluso in tale strumento è un test di conformità a questo set di interfacce.</span><span class="sxs-lookup"><span data-stu-id="7f263-125">The SAPI 4.0 SDK includes a tool (SRFunc) for testing compliance with the SAPI 4.0 spec. Included in that tool is a test for compliance with this set of interfaces.</span></span> <span data-ttu-id="7f263-126">Il codice sorgente per tale strumento è un buon punto di partenza per comprendere il modo in cui queste interfacce interagiranno con l'editor di suoni e per eseguire il debug delle interfacce durante lo sviluppo.</span><span class="sxs-lookup"><span data-stu-id="7f263-126">The source code for that tool is a good place to start in order to understand how these interfaces will interact with the sound editor, and to debug the interfaces during development.</span></span>

 

 