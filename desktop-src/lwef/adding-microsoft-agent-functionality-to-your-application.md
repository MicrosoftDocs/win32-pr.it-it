---
title: Aggiunta della funzionalità Microsoft Agent all'applicazione
description: Aggiunta della funzionalità Microsoft Agent all'applicazione
ms.assetid: 2b4816dd-11bf-4c17-873e-4bdbb7fa1ccf
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a2972b0251a4114e5d280d8f739d416ebc5dc1c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337078"
---
# <a name="adding-microsoft-agent-functionality-to-your-application"></a><span data-ttu-id="4250b-103">Aggiunta della funzionalità Microsoft Agent all'applicazione</span><span class="sxs-lookup"><span data-stu-id="4250b-103">Adding Microsoft Agent Functionality to Your Application</span></span>

<span data-ttu-id="4250b-104">\[Microsoft Agent è stato deprecato a partire da Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]</span><span class="sxs-lookup"><span data-stu-id="4250b-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="4250b-105">Per accedere alle interfacce del server dell'agente Microsoft, è necessario che Agent sia già installato nel sistema di destinazione.</span><span class="sxs-lookup"><span data-stu-id="4250b-105">To access Microsoft Agent's server interfaces, Agent must already be installed on the target system.</span></span> <span data-ttu-id="4250b-106">Non è supportata l'installazione, ad eccezione del file eseguibile di installazione automatica dell'agente, ad esempio il tentativo di copiare e registrare i file dei componenti dell'agente.</span><span class="sxs-lookup"><span data-stu-id="4250b-106">Installation other than using Agent's self-installing executable file, such as attempting to copy and register Agent component files, is not supported.</span></span> <span data-ttu-id="4250b-107">In questo modo si garantisce un'installazione coerente e completa.</span><span class="sxs-lookup"><span data-stu-id="4250b-107">This ensures consistent and complete installation.</span></span> <span data-ttu-id="4250b-108">Si noti che il file di installazione automatica di Microsoft Agent non viene installato nei sistemi operativi Microsoft Windows 2000 e versioni successive, perché queste versioni del sistema operativo includono già la propria versione di Agent.</span><span class="sxs-lookup"><span data-stu-id="4250b-108">Note that the Microsoft Agent self-installing file will not install on Microsoft Windows 2000 and later operating systems because these versions of the operating system already include their own version of Agent.</span></span>

<span data-ttu-id="4250b-109">Per installare correttamente Agent in un sistema di destinazione con un sistema operativo Microsoft Windows precedente, è necessario verificare anche che il sistema di destinazione disponga di una versione recente di Microsoft Visual C++ Runtime (Msvcrt.dll), Microsoft Registration Tool (Regsvr32.dll) e Microsoft COM DLLs.</span><span class="sxs-lookup"><span data-stu-id="4250b-109">To successfully install Agent on a target system with a prior Microsoft Windows operating system, you must also ensure that the target system has a recent version of the Microsoft Visual C++ runtime (Msvcrt.dll), Microsoft registration tool (Regsvr32.dll), and Microsoft COM dlls.</span></span> <span data-ttu-id="4250b-110">Il modo più semplice per garantire che i componenti necessari si trovino sul sistema di destinazione, è necessario che sia installato Microsoft Internet Explorer 3,02 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="4250b-110">The easiest way to ensure that the necessary components are on the target system is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="4250b-111">In alternativa, è possibile installare i primi due componenti disponibili come parte del Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="4250b-111">Alternatively, you can install the first two components which are available as part of Microsoft Visual C++.</span></span> <span data-ttu-id="4250b-112">Le DLL COM necessarie possono essere installate come parte dell'aggiornamento Microsoft DCOM, disponibile nel sito Web Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4250b-112">The necessary COM dlls can be installed as part of the Microsoft DCOM update, available at the Microsoft website.</span></span> <span data-ttu-id="4250b-113">Per ulteriori informazioni e informazioni sulle licenze per questi componenti, vedere il sito Web Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4250b-113">You can find further information and licensing information for these components at the Microsoft website.</span></span>

<span data-ttu-id="4250b-114">I componenti della lingua dell'agente possono essere installati nello stesso modo.</span><span class="sxs-lookup"><span data-stu-id="4250b-114">Agent's language components can be installed the same way.</span></span> <span data-ttu-id="4250b-115">Analogamente, è possibile utilizzare questa tecnica per installare il formato ACS dei caratteri Microsoft disponibili per la distribuzione dal sito Web Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="4250b-115">Similarly, you can use this technique to install the ACS format of the Microsoft characters available for distribution from the Microsoft Agent website.</span></span> <span data-ttu-id="4250b-116">I file di caratteri vengono installati automaticamente nella \\ sottodirectory chars di Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="4250b-116">The character files automatically install to the Microsoft Agent \\Chars subdirectory.</span></span>

<span data-ttu-id="4250b-117">Poiché i componenti di Microsoft Agent sono progettati come componenti del sistema operativo, Agent potrebbe non essere disinstallato.</span><span class="sxs-lookup"><span data-stu-id="4250b-117">Because Microsoft Agent's components are designed as operating system components, Agent may not be uninstalled.</span></span> <span data-ttu-id="4250b-118">Analogamente, in cui Agent è già installato come parte del sistema operativo Windows, è possibile che il cabinet di installazione automatica dell'agente non venga installato.</span><span class="sxs-lookup"><span data-stu-id="4250b-118">Similarly, where Agent is already installed as part of the Windows operating system, the Agent self-installing cabinet may not install.</span></span>

<span data-ttu-id="4250b-119">Una volta installato, per chiamare le interfacce dell'agente, creare un'istanza del server e richiedere un puntatore a un'interfaccia specifica supportata dal server usando la convenzione COM standard.</span><span class="sxs-lookup"><span data-stu-id="4250b-119">Once installed, to call Agent's interfaces, create an instance of the server and request a pointer to a specific interface that the server supports using the standard COM convention.</span></span> <span data-ttu-id="4250b-120">In particolare, la libreria COM fornisce una funzione API, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), che crea un'istanza dell'oggetto e restituisce un puntatore all'interfaccia richiesta dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="4250b-120">In particular, the COM library provides an API function, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), that creates an instance of the object and returns a pointer to the requested interface of the object.</span></span> <span data-ttu-id="4250b-121">Richiedere un puntatore all'interfaccia [**IAgent**](iagent.md) o [**IAgentEx**](iagentex.md) nella chiamata **CoCreateInstance** o in una chiamata successiva a [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="4250b-121">Request a pointer to the [**IAgent**](iagent.md) or [**IAgentEx**](iagentex.md) interface in your **CoCreateInstance** call or in a subsequent call to [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

<span data-ttu-id="4250b-122">Il codice seguente illustra questo problema in C/C++.</span><span class="sxs-lookup"><span data-stu-id="4250b-122">The following code illustrates this in C/C++.</span></span>


```
hRes = CoCreateInstance(CLSID_AgentServer,
                     NULL,
                     CLSCTX_SERVER,
                     IID_IAgentEx,
                     (LPVOID *)&amp;pAgentEx);
```



<span data-ttu-id="4250b-123">Se il server Microsoft Agent è in esecuzione, questa funzione si connette al server. in caso contrario, viene avviato il server.</span><span class="sxs-lookup"><span data-stu-id="4250b-123">If the Microsoft Agent server is running, this function connects to the server; otherwise, it starts up the server.</span></span>

<span data-ttu-id="4250b-124">Si noti che le interfacce del server di Microsoft Agent includono spesso interfacce estese che includono un suffisso "ex".</span><span class="sxs-lookup"><span data-stu-id="4250b-124">Note that the Microsoft Agent server interfaces often include extended interfaces that include an "Ex" suffix.</span></span> <span data-ttu-id="4250b-125">Queste interfacce sono derivate da e pertanto includono tutte le funzionalità di, le controparti non ex.</span><span class="sxs-lookup"><span data-stu-id="4250b-125">These interfaces are derived from, and therefore include all the functionality of, their non-Ex counterparts.</span></span> <span data-ttu-id="4250b-126">Se si vuole usare una delle funzionalità estese, usare le interfacce ex.</span><span class="sxs-lookup"><span data-stu-id="4250b-126">If you want to use any of the extended features, use the Ex interfaces.</span></span>

<span data-ttu-id="4250b-127">Le funzioni che accettano i puntatori a BSTR allocano memoria usando [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span><span class="sxs-lookup"><span data-stu-id="4250b-127">Functions that take pointers to BSTRs allocate memory using [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="4250b-128">È responsabilità del chiamante liberare questa memoria usando [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span><span class="sxs-lookup"><span data-stu-id="4250b-128">It is the caller's responsibility to free this memory using [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span></span>

 

 