---
title: Sviluppo di componenti aggiuntivi per gestori di protocollo
description: È possibile estendere Microsoft Windows Desktop Search (WDS) per includere nuovi archivi dati implementando un gestore di protocollo personalizzato.
ms.assetid: 2447d95f-5832-453c-8857-3b4f4c158177
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a8688621f7d2fda653d769c0e1dfdadd240f49
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104516786"
---
# <a name="developing-protocol-handler-add-ins"></a><span data-ttu-id="849b2-103">Sviluppo di componenti aggiuntivi per gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="849b2-103">Developing Protocol Handler Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="849b2-104">Windows Desktop Search 2. x è una tecnologia obsoleta originariamente disponibile come componente aggiuntivo per Windows XP e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="849b2-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="849b2-105">Nelle versioni successive usare invece [Windows Search](../search/-search-3x-wds-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="849b2-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="849b2-106">È possibile estendere Microsoft Windows Desktop Search (WDS) per includere nuovi archivi dati implementando un gestore di protocollo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="849b2-106">You can extend Microsoft Windows Desktop Search (WDS) to include new data stores by implementing a custom protocol handler.</span></span>

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="849b2-107">Indicizzazione di archivi dati con gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="849b2-107">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="849b2-108">Un archivio dati è un'origine di contenuto (un sistema di database, una directory, un file system) in cui i dati vengono archiviati e possono essere sottoposti a ricerca per indicizzazione nell'indicizzatore di WDS.</span><span class="sxs-lookup"><span data-stu-id="849b2-108">A data store is a content source (a database system, a directory, a file system) where data is stored and can be crawled by the WDS Indexer.</span></span> <span data-ttu-id="849b2-109">L'archivio può essere gerarchico (ad esempio un database) o basato sul collegamento (ad esempio un sito Web).</span><span class="sxs-lookup"><span data-stu-id="849b2-109">The store can be hierarchical (like a database) or link-based (like a website).</span></span> <span data-ttu-id="849b2-110">Un gestore di protocollo consente alle applicazioni di indicizzazione come WDS di eseguire sistematicamente la ricerca per indicizzazione dei nodi di un archivio dati per estrarre le informazioni rilevanti da includere nell'indice.</span><span class="sxs-lookup"><span data-stu-id="849b2-110">A protocol handler enables indexing applications like WDS to systematically crawl the nodes of a data store to extract relevant information to include in the index.</span></span> <span data-ttu-id="849b2-111">Ogni gestore di protocollo viene utilizzato per indicizzare un tipo specifico di archivio dati.</span><span class="sxs-lookup"><span data-stu-id="849b2-111">Each protocol handler is used to index a specific type of data store.</span></span> <span data-ttu-id="849b2-112">WDS viene fornito con i gestori di protocollo per gli archivi file system e per gli archivi dati Microsoft Outlook e Microsoft Outlook Express (archivi di posta elettronica,. File PST e così via).</span><span class="sxs-lookup"><span data-stu-id="849b2-112">WDS ships with protocol handlers for file system stores and for both Microsoft Outlook and Microsoft Outlook Express data stores (email stores, .PST files, and so on).</span></span> <span data-ttu-id="849b2-113">Quando si indicizza la posta elettronica di Outlook, ad esempio, il gestore di protocollo esegue la ricerca per indicizzazione di tutti i messaggi in tutte le cartelle estraendo informazioni da ogni messaggio e allegato.</span><span class="sxs-lookup"><span data-stu-id="849b2-113">When indexing Outlook email, for example, the protocol handler crawls all messages in all folders extracting information from each message and attachment.</span></span> <span data-ttu-id="849b2-114">Queste informazioni vengono passate all'indicizzatore da includere nel catalogo WDS.</span><span class="sxs-lookup"><span data-stu-id="849b2-114">This information is passed to the Indexer to include in the WDS catalog.</span></span>

<span data-ttu-id="849b2-115">Spesso gli utenti devono cercare altri archivi dati, ad esempio database legacy, archivi di posta elettronica o strutture di dati non supportati da WDS.</span><span class="sxs-lookup"><span data-stu-id="849b2-115">Often users need to search other data stores such as legacy databases, email stores or data structures not supported by WDS.</span></span> <span data-ttu-id="849b2-116">È possibile estendere WDS per eseguire la ricerca per indicizzazione in un nuovo archivio dati utilizzando o implementando un gestore di protocollo specifico per l'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="849b2-116">You can extend WDS to crawl a new data store by using or implementing a protocol handler specifically for that data store.</span></span> <span data-ttu-id="849b2-117">Prima di tutto, è necessario determinare se un gestore di protocollo esiste già per l'archivio dati, ad esempio per l'uso con un'altra applicazione come SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="849b2-117">First, you should first determine if a protocol handler already exists for your data store, perhaps for use with another application like SharePoint Services.</span></span> <span data-ttu-id="849b2-118">In tal caso, è possibile installare il gestore di protocollo nel sistema.</span><span class="sxs-lookup"><span data-stu-id="849b2-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="849b2-119">Se, tuttavia, non esiste un altro gestore di protocollo, è necessario implementarne uno.</span><span class="sxs-lookup"><span data-stu-id="849b2-119">If, however, another protocol handler does not exist, then you need to implement one.</span></span> <span data-ttu-id="849b2-120">I gestori del protocollo WDS utilizzano le stesse specifiche di progettazione dei servizi di SharePoint e spesso possono essere utilizzati in modo interscambiabile.</span><span class="sxs-lookup"><span data-stu-id="849b2-120">WDS protocol handlers use the same design specifications as SharePoint Services, and they can often be used interchangeably.</span></span>

<span data-ttu-id="849b2-121">Inoltre, se l'archivio dati contiene dati o tipi di file diversi da uno dei tipi di file 200 supportati da WDS, è necessario implementare anche un filtro per accedere e indicizzare il contenuto degli elementi nell'archivio.</span><span class="sxs-lookup"><span data-stu-id="849b2-121">Furthermore, if the data store contains data or file types other than one of the 200 file types supported by WDS, you also need to implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="849b2-122">WDS 2. x utilizza il gestore di protocollo e la tecnologia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)utilizzata da SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="849b2-122">WDS 2.x uses the protocol handler and [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology used by SharePoint Services.</span></span> <span data-ttu-id="849b2-123">Se sono già presenti filtri per un archivio specifico e un tipo di file installati nel sistema indicizzato, WDS usa le interfacce esistenti per indicizzare questi dati.</span><span class="sxs-lookup"><span data-stu-id="849b2-123">If you already have filters for a specific store and file type installed on the system being indexed, WDS uses the existing interfaces to index this data.</span></span>

 

## <a name="roadmap-to-adding-new-data-stores"></a><span data-ttu-id="849b2-124">Guida di orientamento per l'aggiunta di nuovi archivi dati</span><span class="sxs-lookup"><span data-stu-id="849b2-124">Roadmap to Adding New Data Stores</span></span>

<span data-ttu-id="849b2-125">Per estendere WDS alla ricerca per indicizzazione di nuovi archivi dati, è possibile creare un gestore di protocollo e uno o più dei seguenti componenti aggiuntivi: gestore menu di scelta rapida, gestore icone e un componente aggiuntivo SearchProtocolOptions.</span><span class="sxs-lookup"><span data-stu-id="849b2-125">To extend WDS to crawl new data stores, you can create a protocol handler and one or more of the following add-ins: context menu handler, icon handler and a SearchProtocolOptions add-in.</span></span>

1.  <span data-ttu-id="849b2-126">Creare e registrare un gestore di protocollo multithreading per l'archivio dati:</span><span class="sxs-lookup"><span data-stu-id="849b2-126">Create and register a multithreaded protocol handler for the data store:</span></span>
    -   <span data-ttu-id="849b2-127">**ISearchProtocol** : questa interfaccia accede a un protocollo ed esegue il mapping di un URL a un IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="849b2-127">**ISearchProtocol** - This interface accesses a protocol and maps a URL to an IUrlAccessor.</span></span>
    -   <span data-ttu-id="849b2-128">**IUrlAccessor** : si tratta dell'interfaccia principale usata per accedere agli elementi dall'origine del contenuto e associare il contenuto al filtro appropriato.</span><span class="sxs-lookup"><span data-stu-id="849b2-128">**IUrlAccessor** - This is the main interface used for accessing items from the content source and binding the content to appropriate filter.</span></span>
    -   <span data-ttu-id="849b2-129">**IProtocolHandlerSite** : questa interfaccia viene usata per richiedere e caricare filtri aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="849b2-129">**IProtocolHandlerSite** - This interface is used to request and load additional filters.</span></span>
    -   <span data-ttu-id="849b2-130">**IFilter** : questa interfaccia restituisce l'URL di ogni elemento in una cartella come proprietà del valore per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="849b2-130">**IFilter** - This interface returns the URL of each item in a folder as value properties for processing.</span></span>

    > [!Note]
    >
    > <span data-ttu-id="849b2-131">La funzionalità minima dei componenti aggiuntivi necessaria per restituire i risultati della ricerca da un archivio dati non gerarchico è un'implementazione delle interfacce ISearchProtocol e IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="849b2-131">The minimum add-in functionality needed to return search results from a non-hierarchical data store is an implementation of ISearchProtocol and IUrlAccessor interfaces.</span></span>

     

2.  <span data-ttu-id="849b2-132">Implementare l'interfaccia ISearchProtocolOptions per includere le opzioni personalizzate del gestore di protocollo, ad esempio le pagine iniziali predefinite:</span><span class="sxs-lookup"><span data-stu-id="849b2-132">Implement the ISearchProtocolOptions interface to include customized protocol handler options, like predefined start page(s):</span></span>
    -   <span data-ttu-id="849b2-133">**ISearchProtocolOptions** : questa interfaccia definisce gli URL predefiniti per il gestore di protocollo da elaborare, determina quali sono i requisiti per un gestore di protocollo e determina se i requisiti sono stati soddisfatti in un determinato sistema.</span><span class="sxs-lookup"><span data-stu-id="849b2-133">**ISearchProtocolOptions** - This interface defines default URLs for the protocol handler to process, determines what the requirements are for a protocol handler, and determines whether the requirements have been met on a given system.</span></span>
3.  <span data-ttu-id="849b2-134">Estendere Shell per includere gli elementi dell'interfaccia utente, ad esempio i menu di scelta rapida e le icone specifiche del file, implementando le interfacce seguenti:</span><span class="sxs-lookup"><span data-stu-id="849b2-134">Extend Shell to include user interface elements, like context menus and file-specific icons, by implementing the following interfaces:</span></span>
    -   <span data-ttu-id="849b2-135">**IShellFolder** : questa interfaccia, che viene usata per gestire le cartelle, è necessaria per fornire le interfacce IContextMenu e IExtractIcon per un URL in un nuovo archivio.</span><span class="sxs-lookup"><span data-stu-id="849b2-135">**IShellFolder** - This interface, which is used to manage folders, is required to provide the IContextMenu and IExtractIcon interfaces for a URL in a new store.</span></span>
    -   <span data-ttu-id="849b2-136">**IPersistFolder** : questa interfaccia è necessaria per indicare a un oggetto cartella della shell di inizializzarsi automaticamente.</span><span class="sxs-lookup"><span data-stu-id="849b2-136">**IPersistFolder** - This interface is required to instruct a Shell folder object to initialize itself.</span></span>
    -   <span data-ttu-id="849b2-137">**IPersist** : questa interfaccia fornisce l'identificatore di classe (CLSID) di un oggetto che può essere archiviato in modo permanente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="849b2-137">**IPersist** - This interface supplies the class identifier (CLSID) of an object that can be stored persistently in the system.</span></span>
    -   <span data-ttu-id="849b2-138">**IContextMenu** : questa interfaccia definisce il menu di scelta rapida per un elemento a cui fa riferimento l'URL.</span><span class="sxs-lookup"><span data-stu-id="849b2-138">**IContextMenu** - This interface defines the right-click context menu for an item pointed to by URL.</span></span>
    -   <span data-ttu-id="849b2-139">**IExtractIcon** : questa interfaccia definisce l'icona da visualizzare per un elemento a cui punta l'URL.</span><span class="sxs-lookup"><span data-stu-id="849b2-139">**IExtractIcon** - This interface defines the icon to display for an item pointed to by URL.</span></span>
4.  <span data-ttu-id="849b2-140">Implementare un meccanismo per notificare all'indicizzatore le modifiche apportate all'archivio dati:</span><span class="sxs-lookup"><span data-stu-id="849b2-140">Implement a mechanism to notify the Indexer of changes to your data store:</span></span>
    -   <span data-ttu-id="849b2-141">**ISearchItemsChangedSink** : questa interfaccia consente al gestore del protocollo di inviare una notifica all'indice delle modifiche apportate all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="849b2-141">**ISearchItemsChangedSink** - This interface enables your protocol handler to notify the Index of changes to your data store.</span></span> <span data-ttu-id="849b2-142">Ciò consente di migliorare le prestazioni assicurando che l'indicizzatore non esegue la ricerca per indici incrementali nell'intero archivio.</span><span class="sxs-lookup"><span data-stu-id="849b2-142">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="849b2-143">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="849b2-143">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="849b2-144">**Riferimento**</span><span class="sxs-lookup"><span data-stu-id="849b2-144">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="849b2-145">Implementazione di un gestore di protocollo per WDS</span><span class="sxs-lookup"><span data-stu-id="849b2-145">Implementing a Protocol Handler for WDS</span></span>](-search-2x-wds-phimplementing.md)
</dt> <dt>

[<span data-ttu-id="849b2-146">Aggiunta di icone, anteprime e menu di scelta rapida con le estensioni della shell</span><span class="sxs-lookup"><span data-stu-id="849b2-146">Adding Icons, Previews, and Context Menus with Shell Extensions</span></span>](-search-2x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="849b2-147">Notifica dell'indice delle modifiche</span><span class="sxs-lookup"><span data-stu-id="849b2-147">Notifying the Index of Changes</span></span>](-search-2x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="849b2-148">Installazione e registrazione di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="849b2-148">Installing and Registering Protocol Handlers</span></span>](-search-2x-wds-ph-install-registration.md)
</dt> </dl>

 

 