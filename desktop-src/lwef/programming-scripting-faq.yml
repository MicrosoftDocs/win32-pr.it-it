### YamlMime:FAQ
metadata:
  title: Domande frequenti sulla programmazione di script
  description: Domande frequenti sulla programmazione di script
  ms.assetid: 84078c5b-7b04-48fa-9d0a-d95393c323eb
  ms.topic: article
  ms.date: 05/31/2018
  ms.openlocfilehash: f3e9604bdc6bcd3871cbd931fb22b16400764dbd
  ms.sourcegitcommit: ecd0ba4732f5264aab9baa2839c11f7fea36318f
  ms.translationtype: MT
  ms.contentlocale: it-IT
  ms.lasthandoff: 07/07/2021
  ms.locfileid: "113483654"
title: Domande frequenti sulla programmazione di script
summary: >
  \[Microsoft Agent è deprecato a Windows 7 e potrebbe non essere disponibile nelle versioni successive di Windows.\]
sections:
- name: Ignorato
  questions:
  - question: >
      Quando si usa Microsoft Visual Basic (o altri strumenti di sviluppo) per lo scripting di Microsoft Agent, non vengono visualizzati tutte le proprietà e gli eventi usati negli esempi. Ricerca per categorie accedervi?
    answer: >
      La maggior parte degli eventi, dei metodi e delle proprietà supportati dal controllo Microsoft Agent viene esposta solo in fase di esecuzione. Per [altre informazioni, vedere Programmazione del controllo di Microsoft Agent.](programming-the-microsoft-agent-control.md)
  - question: >
      Il tag Map (o un altro tag) non sembra funzionare.
    answer: "Alcuni tag includono stringhe tra virgolette. Per alcuni linguaggi di programmazione, ad esempio Microsoft Visual Basic e Visual Basic Scripting Edition, potrebbe essere necessario usare due virgolette per designare il parametro del tag o concatenare un carattere tra virgolette doppie come parte della stringa. Quest'ultimo è illustrato in questo esempio Visual Basic seguente:\n\nAgent1.Characters(\"Genie\"). Pronunciare \"This is \\\\ map=\" + chr(34) + \"Spoken text\" \\_ + chr(34) + \"=\" + chr(34) + \"Balloon text\" + chr(34) + \" \\\\ .\"\n\nPer la programmazione C, C++ e Java, far precedere le barre rovesciate e le virgolette doppie con una barra rovesciata. Ad esempio:\n\nBSTR bszSpeak = SysAllocString(L\"This is \\\\ \\\\ map= \\\\ \"Spoken text \\\\ \"= \\\\ \"Balloon text \\\\ \" \\\\ \\\\ \");\n\npCharacter->Speak(bszSpeak, ......);\n\n> [!Note]  \n> Microsoft Agent non supporta tutti i tag specificati in Microsoft Speech API. Inoltre, il supporto per alcuni parametri può dipendere dal motore di sintesi vocale installato. Per altre informazioni, vedere [Tag di output del riconoscimento vocale di Microsoft Agent.](microsoft-agent-speech-output-tags.md)\n\n \n"
  - question: >
      Sembra che non si otterrà eventi RequestStart e RequestComplete nello script (o nel programma).
    answer: >
      Ciò potrebbe essere causato da uno dei problemi seguenti:


      -   Il linguaggio di programmazione non supporta completamente ActiveX controlli. Controllare la documentazione per assicurarsi che supporti l'interfaccia ActiveX e gli eventi per ActiveX oggetti.

      -   In una pagina Web con script, non è stato possibile installare o caricare un altro controllo. Verificare che tutti gli altri controlli siano installati e caricati correttamente senza Microsoft Agent.

      -   In una pagina Web con script con frame si ha il tag per il controllo Microsoft Agent in una pagina e gli eventi sono stati generati `<OBJECT>` in un'altra pagina. Gli eventi vengono inviati solo alla pagina che ospita il controllo .
  - question: >
      Si usa il controllo Microsoft Agent con altri ActiveX nella pagina Web e sembra che non si otterrà alcun evento.
    answer: >
      Verificare se gli altri controlli sono installati correttamente. Se un altro ActiveX controllo non riesce a registrarsi correttamente, il controllo di Microsoft Agent potrebbe ricevere i relativi eventi.
  - question: >
      Quali linguaggi di programmazione è possibile usare per programmare il controllo Microsoft Agent?
    answer: >
      Microsoft Agent deve essere supportabile da qualsiasi linguaggio che supporti l ActiveX intervalla. Include esempi di codice per Visual Basic, VBScript, JScript, C/C++ e Java.
  - question: >
      È possibile accedere ai parametri restituiti da Microsoft Agent usando JScript?
    answer: >
      Sì, ma attualmente l'unico modo per eseguire questa operazione è usare la `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` sintassi . Anche se questa sintassi è supportata per Microsoft Internet Explorer, altri browser non la supportano, pertanto è possibile evitare di usare JScript per questa parte dello script della pagina.
  - question: >
      Microsoft Agent può essere usato con motori di riconoscimento vocale o sintesi vocale (sintesi vocale o TTS) diversi da quelli forniti da Microsoft?
    answer: >
      Sì, a condizione che il motore supporti le interfacce di Microsoft Speech API (SAPI) 4.0 richieste da Microsoft Agent. Rivolgersi al fornitore del motore. Per informazioni dettagliate complete sulle interfacce SAPI richieste da Microsoft Agent, vedere Requisiti di supporto [del motore di riconoscimento vocale](speech-engine-support-requirements.md).
  - question: >
      La pagina include tag oggetto HTML per Microsoft Agent, il motore TTS Lernout & Hauspie TruVoice e il motore di riconoscimento vocale Microsoft Command and Control, ma non tutti i componenti vengono installati.
    answer: >
      In genere, il problema può essere risolto aggiornando la pagina. Come procedura generale, è consigliabile specificare prima il tag controllo di Microsoft Agent, quindi il `<OBJECT>` motore Lernout & Hauspie TruVoice e quindi il motore di riconoscimento vocale Comando e controllo.
  - question: >
      Dopo aver chiamato il metodo MoveTo, il mio carattere sembra bloccarsi anche se sono state assegnate animazioni Return alle animazioni dello stato Moving.
    answer: >
      Quando si riproduce un'animazione, i servizi di animazione continuano a visualizzare l'ultimo fotogramma fino a quando non viene chiamata un'altra animazione. È pertanto consigliabile riprodurre un'altra animazione dopo aver [**chiamato MoveTo.**](moveto-method.md) Se è stata definita **un'animazione Return** per l'animazione dello stato **Moving,** il server la riprodurrà per prima.
  - question: >
      Quando si esegue una query sulla proprietà Pitch del carattere, viene restituito il valore -1.
    answer: >
      Ciò si verifica se il carattere è stato compilato usando la proprietà pitch predefinita di un motore di riconoscimento vocale. ciò significa che l'altezza non è stata modificata al momento della creazione del carattere.
  - question: >
      Quando il codice tenta di impostare l'ID della modalità TTS per un motore di sintesi vocale, viene visualizzato l'errore seguente: Non è possibile eseguire una chiamata in uscita perché l'applicazione sta inviando una chiamata sincrona di input.
    answer: >
      Per impostare la proprietà TTSModeID, è necessario aver installato Speech.dll. Si tratta in genere di una parte del codice di installazione del motore di riconoscimento vocale. È anche possibile installarlo installando il pannello di controllo dell'oggetto Voce , disponibile nella pagina Download di Microsoft Agent.
  - question: >
      Quando si riprova a caricare un carattere che non è stato caricato, la chiamata ha esito negativo con un errore "Carattere già caricato".
    answer: >
      Il controllo di Microsoft Agent non scarica un oggetto carattere (rilascia il riferimento) quando il caricamento del file di caratteri associato non riesce. Se si vuole riprovare a caricare il carattere, è necessario chiamare in modo esplicito [**Unload**](unload-method.md) prima di chiamare [**Load**](load-method.md) la seconda volta. Se si tenta di eseguire questa operazione da uno script della pagina Web, è anche necessario far precedere la chiamata **Unload** con un'istruzione On Error Resume Next oppure anche la **chiamata Unload** avrà esito negativo. Si noti che JScript non dispone di un'istruzione On Error Resume Next.


      Tuttavia, potrebbe non essere necessario includere codice per ritentare immediatamente il caricamento di un carattere quando il caricamento del file non riesce. Microsoft Internet Explorer e il componente server Microsoft Agent tentano automaticamente di riprovare più volte, quindi le probabilità che il nuovo tentativo comporti un caricamento corretto sono remote. Una strategia migliore consiste nell'attendere (impostare un timer) alcuni secondi prima di riprovare.
  - question: >
      Come è possibile installare Microsoft Agent come parte dell'applicazione o dal server Web?
    answer: >
      È possibile installare Agent dal sito Web Microsoft includendo il *relativo CLSID in un tag object HTML*. Tuttavia, se si vuole includere e installare Agent dal programma di installazione dell'applicazione o dal proprio server, è necessario scaricare il file CAB autoinstallante di Microsoft Agent scaricarlo dalla pagina Download. Durante il download, scegliere l'opzione Salva del browser anziché Esegui. Ogni volta che questo file viene eseguito, installa automaticamente Microsoft Agent nel computer di destinazione. È quindi possibile specificare il file nello script di installazione.


      Non tentare di installare Microsoft Agent copiando i vari . DLL e tentativo di registrarlo manualmente. Non è supportato il tentativo di installare Agent con qualsiasi altro mezzo, quindi l'esecuzione del file CAB auto-installazione non è supportata.


      Il sistema di destinazione deve includere anche versioni recenti di MSVCRT.DLL (VC++ runtime), REGSVR32.EXE (strumento di registrazione incluso in Microsoft VC++) e COM. Il modo migliore per assicurarsi che siano installate le versioni corrette è richiedere l'installazione di Microsoft Internet Explorer 3.02 o versione successiva. Tuttavia, è anche possibile ottenere una licenza per questi requisiti di runtime. Per la versione più recente di COM, accedere all'aggiornamento DCOM dal sito Web Microsoft.


      Microsoft Agent 2.0 non verrà installato in Microsoft Windows 2000 perché questa versione del sistema operativo include già Agent.
  - question: >
      È possibile usare il Visual Basic Installazione guidata per installare Microsoft Agent?
    answer: >
      Anche se è possibile creare un programma di installazione personalizzato usando Visual Basic (VB), non è possibile usare il Visual Basic Installazione guidata a tale scopo. Per installare Agent da VB, è possibile usare il comando Shell, specificando il file CAB auto-installazione di Microsoft Agent.
  - question: >
      Ricerca per categorie installare Microsoft Agent in Windows 2000?
    answer: >
      Microsoft Agent 2.0 non viene installato Windows 2000 perché è già incluso come parte del sistema operativo.
  - question: >
      AgentSvr si arresta in modo anomalo quando viene chiamato Speak con un file WAV.
    answer: >
      Ciò può verificarsi quando il carattere usa TTS per l'output parlato, quindi cambia per usare un file WAV. Il testo non è stato specificato nel primo parametro del metodo Speak.


      Per evitare l'arresto anomalo, includere uno spazio nel primo parametro del metodo Speak, anche se non è disponibile alcun output di testo.
  - question: >
      Anche se è già stato installato il componente della lingua dell'agente (DLL) per una lingua specifica, viene comunque visualizzato un errore che indica che il componente non è presente quando si imposta la lingua del carattere su tale lingua.
    answer: >
      Ciò si verifica in genere quando si dispone di applicazioni agent, ad esempio Microsoft Office 2000, quando si installa il componente del linguaggio di Agent. Chiudere tutte le applicazioni e riprovare. Se il problema persiste, riavviare il computer ed è ora possibile impostare l'ID lingua.
  - question: >
      Quando si usa il simbolo e commerciale "&", il testo intorno al simbolo nei numeri di riferimento del carattere viene troncato.
    answer: >
      Si tratta di un problema noto. È possibile risolvere questo problema usando il tag map. Ad esempio, per visualizzare "A & B" nel fumetto della parola del carattere, usare "A \\ map="and"="&&" B" nell'istruzione \\ Speak.
  - question: >
      L'applicazione consente agli utenti di modificare il carattere predefinito e, quando lo fanno, il programma si arresta in modo anomalo.
    answer: >
      Le cause possono essere due:


      Se si modifica l'ID modalità TTS del carattere predefinito e quindi si consente all'utente di modificare il carattere predefinito tramite ShowDefaultCharacterProperties, AgentSvr si arresta in modo anomalo.


      Questo problema è stato risolto nei sistemi operativi Windows 2000 e Windows XP. Per evitare l'arresto anomalo in altre piattaforme, è consigliabile non consentire all'utente di modificare il carattere predefinito dopo aver modificato l'ID modalità TTS del carattere predefinito oppure non usare il carattere predefinito nell'applicazione o nella pagina Web.


      Se l'applicazione non usa caratteri di Agent forniti da Microsoft, assicurarsi che il carattere personalizzato usi una tavolozza con una tavolozza completa di 256 colori. Per altre informazioni, vedere il documento Progettazione di caratteri per Microsoft Agent.
  - question: >
      La pagina carica il carattere Agent da più frame. Con IE 5 viene visualizzato l'errore di caricamento di Microsoft Agent non riuscito.
    answer: >
      Si tratta di un problema noto con IE 5. È stata apportata una modifica al modo in cui il browser gestisce un determinato evento, causando l'avvio dell'esecuzione dello script HTML prima dell'avvio di AgentSvr. Per far funzionare la pagina con tutte le versioni del browser, è necessario aggiungere questa riga allo script:


      AgentControl.Connected = True


      che crea in modo esplicito una connessione a AgentSvr. Si noti che è necessario eseguire questa operazione solo se la pagina carica Agent da più frame.
  - question: >
      Quando l'applicazione tenta di installare Microsoft Agent in Windows 2000 (o Windows XP), viene visualizzato l'errore Che Agent non è compatibile con Windows 2000 (o Windows XP).
    answer: >
      Una versione precedente del file cab del componente principale dell'agente MSAGENT.exe, se eseguita in Windows 2000 (e Windows XP), blocca l'installazione e visualizza un messaggio di errore non accurato che indica che Agent non è compatibile con la versione del sistema operativo in esecuzione. I componenti principali di Microsoft Agent 2.0 sono infatti inclusi come parte di Windows 2000 (e Windows XP) e sono già installati per impostazione predefinita tramite Windows installazione.


      In questa versione il controllo viene rimosso e il file di installazione non visualizza il messaggio di errore precedente in Windows 2000 (o Windows XP). Si noti che questa è l'unica modifica apportata al file di installazione e che non sono presenti modifiche al codice per i componenti principali di Agent. Pertanto, questo aggiornamento non è interessato se è già installato Agent 2.0 o se il sito Web usa un tag oggetto per attivare il download automatico dei componenti principali di Agent da Microsoft Object Store.


      Se si include il file di installazione del componente principale di Agent con l'applicazione o si pubblica il file di installazione nel server, è possibile scaricare questo aggiornamento. A tale scopo, fare clic qui e selezionare l'opzione "Salva il programma su disco". Per queste circostanze, è necessario disporre di una licenza di distribuzione di Agent valida e corrente.


      In alternativa, è anche possibile risolvere questo problema usando l'opzione invisibile all'utente quando si installa la versione precedente del file MSAGENT.exe di installazione. Il comando della shell è:


      **MSAGENT.exe /q:a**


      Lo stesso vale per i componenti del linguaggio agent rilasciati originariamente nell'ottobre 1998. È stato fatto un controllo che impediva l'installazione dei componenti delle lingue arabo, francese, tedesco, ebraico, italiano, giapponese, coreano, cinese semplificato, spagnolo e cinese tradizionale in Windows 2000 (e Windows XP). Le versioni più recenti di questi file di installazione, insieme alle altre 19 lingue aggiunte nel marzo 2000, non contengono questo controllo e verranno installate correttamente in Windows 2000 (e Windows XP).
  - question: >
      Il mio carattere personalizzato presenta un comportamento imprevisto con il colore di trasparenza Windows 2000 (e Windows XP).
    answer: >
      Si tratta di un problema noto per i caratteri creati con una tavolozza di meno di 256 colori. I problemi relativi a questi caratteri includono il colore di trasparenza visualizzato sullo sfondo, il testo del fumetto trasparente, il bordo del fumetto trasparente o lo sfondo del fumetto trasparente. Si noti che tali caratteri possono causare l'arresto anomalo delle applicazioni quando vengono caricate nella finestra di dialogo selezione caratteri di Agent o nella raccolta Microsoft Office Assistant. I caratteri personalizzati devono usare una tavolozza completa con 256 colori. È possibile usare la tavolozza di esempio fornita per Office Assistant come punto di partenza con una tavolozza di 256 colori completa.
  - question: >
      Il carattere non usa il motore TTS in inglese inglese , anche se il relativo ID lingua è stato impostato su Inglese &h0809.
    answer: >
      Assicurarsi prima di tutto di aver installato tutti i componenti necessari: componenti di base dell'agente, file binari di runtime SAPI e un motore TTS in inglese inglese conforme a SAPI4, ad esempio il motore TTS3000 British English, disponibile per il download nella pagina download dell'agente. Se il tuo personaggio non usa ancora il motore TTS per la lingua inglese inglese, è probabile che sia installato anche un motore TTS per la lingua inglese statunitense. Poiché sia l'inglese inglese che l'inglese americano condividono la stessa lingua primaria (inglese) e l'inglese americano è l'impostazione predefinita, Agent sceglierà il primo motore TTS inglese americano disponibile come restituito da SAPI. Per usare un motore TTS inglese inglese, usare invece la proprietà TTSModeID del carattere. Ad esempio, TTSModeID per la voce inglese inglese TTS3000 è {227A0E41-A92A-11d1-B17B-0020AFED142E}. In Microsoft Visual Basic è possibile usare questo motore impostando TTSModeID di Merlin come indicato di seguito:


      AgentControl.Characters("Merlin"). TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}
  - question: >
      Quando il volume del carattere è impostato su zero usando il tag vocale \Vol=0, non ha effetti o arresta in modo anomalo \, AgentSvr.
    answer: >
      Si tratta di un problema noto. Nei Windows 95, Windows 98 e Windows Me, il volume del carattere non cambia ma rimane al livello impostato in precedenza. Nelle piattaforme Windows NT 4.0, Windows 2000 e Windows XP, agentSvr si arresterà in modo anomalo, anche se non è installato un motore TTS. Poiché l'intervallo del volume del carattere, da 0 (silenzio) a 65535 (volume massimo), è elevato e la differenza tra i livelli successivi è difficilmente individuabile, la soluzione alternativa semplice consiste nell'impostare il volume su 1 anziché su 0 quando si vuole che la voce del carattere sia inaudibile.
  - question: >
      L'animazione Return del carattere personalizzato non viene riprodotta correttamente dopo le animazioni MoveDown, MoveLeft, MoveRight e/o MoveUp.
    answer: Assicurarsi che una semplice animazione parlata sia assegnata allo stato speaking. Ad esempio, è possibile usare un singolo frame costituito dalla posizione neutra del carattere con sovrimpressione della bocche.
