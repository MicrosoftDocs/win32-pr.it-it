---
title: Sviluppo di componenti aggiuntivi IFilter
description: È possibile estendere Microsoft Windows Desktop Search (WDS) con i componenti aggiuntivi di filtro, i componenti che implementano IFilterinterface, per includere nuovi tipi di file.
ms.assetid: 71dd515d-a73e-4e0a-b0da-c8a6209d09fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 79f846cf2101eefc17b1e92fbd7992529a06fb43
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104473027"
---
# <a name="developing-ifilter-add-ins"></a><span data-ttu-id="a94b8-103">Sviluppo di componenti aggiuntivi IFilter</span><span class="sxs-lookup"><span data-stu-id="a94b8-103">Developing IFilter Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="a94b8-104">Windows Desktop Search 2. x è una tecnologia obsoleta originariamente disponibile come componente aggiuntivo per Windows XP e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="a94b8-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="a94b8-105">Nelle versioni successive usare invece [Windows Search](../search/-search-3x-wds-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="a94b8-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="a94b8-106">È possibile estendere Microsoft Windows Desktop Search (WDS) con i componenti aggiuntivi di filtro, i componenti che implementano l'interfaccia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter), per includere nuovi tipi di file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-106">You can extend Microsoft Windows Desktop Search (WDS) with filter add-ins, components that implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface, to include new file types.</span></span> <span data-ttu-id="a94b8-107">I filtri sono responsabili dell'accesso e dell'analisi dei dati nei file e della restituzione di coppie di proprietà e valori, nonché di blocchi di testo per l'indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-107">Filters are responsible for accessing and parsing data in files and for returning pairs of properties and values as well as chunks of text for indexing.</span></span> <span data-ttu-id="a94b8-108">Durante il processo di indicizzazione, WDS chiama il filtro appropriato con l'URL per ogni file o elemento.</span><span class="sxs-lookup"><span data-stu-id="a94b8-108">During the indexing process, WDS calls the appropriate filter with the URL for each file or item.</span></span> <span data-ttu-id="a94b8-109">Il filtro estrae prima i metadati che corrispondono alle proprietà contrassegnate come recuperabili nello schema WDS, ad esempio titolo, dimensioni del file e data dell'Ultima modifica.</span><span class="sxs-lookup"><span data-stu-id="a94b8-109">The filter first extracts metadata that corresponds to properties that are marked retrievable in the WDS schema, such as title, file size, and last modified date.</span></span> <span data-ttu-id="a94b8-110">Quindi suddivide il contenuto dell'elemento in blocchi di testo.</span><span class="sxs-lookup"><span data-stu-id="a94b8-110">Then it breaks the item content into chunks of text.</span></span> <span data-ttu-id="a94b8-111">WDS aggiunge le proprietà e il testo restituiti dal filtro al catalogo.</span><span class="sxs-lookup"><span data-stu-id="a94b8-111">WDS adds the properties and text returned by the filter to the catalog.</span></span> <span data-ttu-id="a94b8-112">WDS può indicizzare qualsiasi tipo di file per il quale è presente un filtro registrato.</span><span class="sxs-lookup"><span data-stu-id="a94b8-112">WDS can index any file type for which it has a registered filter.</span></span>

<span data-ttu-id="a94b8-113">In alcuni casi, non è necessario scrivere un nuovo filtro.</span><span class="sxs-lookup"><span data-stu-id="a94b8-113">In some circumstances, you do not need to write a new filter.</span></span> <span data-ttu-id="a94b8-114">WDS 2. x contiene filtri per più di 200 tipi di elementi (inclusi elementi di testo non crittografato, ad esempio HTML, XML e file di codice sorgente) e utilizza la stessa tecnologia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)di SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="a94b8-114">WDS 2.x contains filters for over 200 types of items (including plaintext items such as HTML, XML, and source code files) and uses the same [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology as SharePoint Services.</span></span> <span data-ttu-id="a94b8-115">Se i filtri sono già installati per i tipi di file, WDS può utilizzare i filtri esistenti per indicizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="a94b8-115">If you already have filters installed for your file types, WDS can use those existing filters to index this data.</span></span> <span data-ttu-id="a94b8-116">WDS include inoltre un filtro generale per i tipi di file basati su testo normale.</span><span class="sxs-lookup"><span data-stu-id="a94b8-116">Furthermore, WDS includes a general filter for file types that are plaintext-based.</span></span> <span data-ttu-id="a94b8-117">Se si dispone di un tipo di file che può essere elaborato da un filtro SharePoint Services esistente o dal filtro testo non crittografato, è possibile aggiungere l'estensione del nome file e il GUID filtro al registro di sistema in modo che WDS possa individuarlo e usarlo (vedere [per registrare un componente aggiuntivo di filtro](#to-register-a-filter-add-in) per ulteriori informazioni).</span><span class="sxs-lookup"><span data-stu-id="a94b8-117">If you have a file type that can be processed by either an existing SharePoint Services filter or the plaintext filter, you can add the file name extension and filter GUID to the Registry so WDS can locate and use it (see [To Register a Filter Add-in](#to-register-a-filter-add-in) for more information).</span></span>

<span data-ttu-id="a94b8-118">Se, tuttavia, si dispone di un formato di file o di dati non crittografato e proprietario, la scrittura di un'implementazione di filtro personalizzata è l'unico modo per garantire che WDS possa indicizzare il formato di file nel catalogo.</span><span class="sxs-lookup"><span data-stu-id="a94b8-118">If, however, you have a non-plaintext and proprietary data or file format, writing a custom filter implementation is the only way to ensure WDS can index the file format in the catalog.</span></span> <span data-ttu-id="a94b8-119">È possibile disporre di un solo componente aggiuntivo di filtro per un tipo di file, pertanto è possibile eseguire l'override di un filtro esistente o di un altro filtro per un tipo di file specifico.</span><span class="sxs-lookup"><span data-stu-id="a94b8-119">You can have only one filter add-in for a file type, so it is possible to override an existing filter or to have another filter override yours for a specific file type.</span></span>

<span data-ttu-id="a94b8-120">Questa sezione contiene i seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-120">This section contains the following topics:</span></span>

-   [<span data-ttu-id="a94b8-121">Interfacce di filtro obbligatorie</span><span class="sxs-lookup"><span data-stu-id="a94b8-121">Required Filter Interfaces</span></span>](#required-filter-interfaces)
    -   [<span data-ttu-id="a94b8-122">Interfaccia IFilter</span><span class="sxs-lookup"><span data-stu-id="a94b8-122">IFilter Interface</span></span>](#ifilter-interface)
    -   [<span data-ttu-id="a94b8-123">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="a94b8-123">IPersistStream</span></span>](#ipersiststream)
    -   [<span data-ttu-id="a94b8-124">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="a94b8-124">IPersistFile</span></span>](#ipersistfile)
    -   [<span data-ttu-id="a94b8-125">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="a94b8-125">IPersistStorage</span></span>](#ipersiststorage)
-   [<span data-ttu-id="a94b8-126">Output delle proprietà con i filtri</span><span class="sxs-lookup"><span data-stu-id="a94b8-126">Outputting Properties with Filters</span></span>](#outputting-properties-with-filters)
    -   [<span data-ttu-id="a94b8-127">Valori delle proprietà</span><span class="sxs-lookup"><span data-stu-id="a94b8-127">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="a94b8-128">Filtra installazione del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="a94b8-128">Filter Add-in Installation</span></span>](#filter-add-in-installation)
    -   [<span data-ttu-id="a94b8-129">CLSID necessari per la registrazione</span><span class="sxs-lookup"><span data-stu-id="a94b8-129">CLSIDs Required for Registration</span></span>](#clsids-required-for-registration)
    -   [<span data-ttu-id="a94b8-130">Modello di registrazione</span><span class="sxs-lookup"><span data-stu-id="a94b8-130">Registration Model</span></span>](#registration-model)
    -   [<span data-ttu-id="a94b8-131">Per registrare un componente aggiuntivo di filtro</span><span class="sxs-lookup"><span data-stu-id="a94b8-131">To Register a Filter Add-in</span></span>](#to-register-a-filter-add-in)
-   [<span data-ttu-id="a94b8-132">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="a94b8-132">Related topics</span></span>](#related-topics)

## <a name="required-filter-interfaces"></a><span data-ttu-id="a94b8-133">Interfacce di filtro obbligatorie</span><span class="sxs-lookup"><span data-stu-id="a94b8-133">Required Filter Interfaces</span></span>

<span data-ttu-id="a94b8-134">Un componente aggiuntivo di filtro deve implementare l'interfaccia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)e una delle interfacce seguenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-134">A filter add-in must implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface and one of the following interfaces:</span></span>

-   <span data-ttu-id="a94b8-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) : per caricare i dati da un flusso.</span><span class="sxs-lookup"><span data-stu-id="a94b8-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) - To load data from a stream.</span></span> <span data-ttu-id="a94b8-136">Questa operazione è più sicura dell'uso dei file perché non viene scritto alcun elemento sul disco.</span><span class="sxs-lookup"><span data-stu-id="a94b8-136">This is more secure than using files because nothing is written to disk.</span></span> <span data-ttu-id="a94b8-137">L'interfaccia IPersistStream è il metodo preferito per la compatibilità con le edizioni di Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a94b8-137">The IPersistStream interface is the preferred method for forward compatibility with Windows Vista.</span></span>
-   <span data-ttu-id="a94b8-138">[Interfaccia IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) : per caricare i dati da un file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-138">[IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) - To load data from a file.</span></span> <span data-ttu-id="a94b8-139">Questa interfaccia non è supportata in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a94b8-139">This interface is not supported in Windows Vista.</span></span>
-   <span data-ttu-id="a94b8-140">[Interfaccia IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) : per caricare dati da un archivio strutturato OLE com.</span><span class="sxs-lookup"><span data-stu-id="a94b8-140">[IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) - To load data from an OLE COM Structured Storage.</span></span>

<span data-ttu-id="a94b8-141">Un componente aggiuntivo di filtro usa queste interfacce per ottenere il contenuto dell'elemento e restituirle in modo iterativo all'indice fino a quando non viene raggiunta la fine del file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-141">A filter add-in uses these interfaces to get the contents of the item and return them iteratively to the index until the end of the file is reached.</span></span> <span data-ttu-id="a94b8-142">Un componente aggiuntivo di filtro dovrebbe essere il più possibile affidabile per gestire i file danneggiati e quelli che non soddisfano i formati di input previsti.</span><span class="sxs-lookup"><span data-stu-id="a94b8-142">A filter add-in should be as robust as possible to handle corrupt files and those that do not meet expected input formats.</span></span>

### <a name="ifilter-interface"></a><span data-ttu-id="a94b8-143">Interfaccia IFilter</span><span class="sxs-lookup"><span data-stu-id="a94b8-143">IFilter Interface</span></span>

<span data-ttu-id="a94b8-144">Si tratta di un'interfaccia necessaria per l'implementazione di un filtro.</span><span class="sxs-lookup"><span data-stu-id="a94b8-144">This is a required interface for a filter implementation.</span></span> <span data-ttu-id="a94b8-145">Per ulteriori informazioni, vedere la Guida di riferimento all'interfaccia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter).</span><span class="sxs-lookup"><span data-stu-id="a94b8-145">For more information, see the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface reference.</span></span>



| <span data-ttu-id="a94b8-146">Metodo</span><span class="sxs-lookup"><span data-stu-id="a94b8-146">Method</span></span>       | <span data-ttu-id="a94b8-147">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a94b8-147">Description</span></span>                                                                            |
|--------------|----------------------------------------------------------------------------------------|
| <span data-ttu-id="a94b8-148">Init ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-148">Init()</span></span>       | <span data-ttu-id="a94b8-149">Inizializza una sessione di filtro.</span><span class="sxs-lookup"><span data-stu-id="a94b8-149">Initializes a filtering session.</span></span>                                                       |
| <span data-ttu-id="a94b8-150">GetChunk ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-150">GetChunk()</span></span>   | <span data-ttu-id="a94b8-151">Posiziona il filtro all'inizio del blocco primo o successivo e restituisce un descrittore.</span><span class="sxs-lookup"><span data-stu-id="a94b8-151">Positions the filter at the beginning of first or next chunk and returns a descriptor.</span></span> |
| <span data-ttu-id="a94b8-152">GetText ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-152">GetText()</span></span>    | <span data-ttu-id="a94b8-153">Recupera il testo dal blocco corrente.</span><span class="sxs-lookup"><span data-stu-id="a94b8-153">Retrieves text from the current chunk.</span></span>                                                 |
| <span data-ttu-id="a94b8-154">GetValue()</span><span class="sxs-lookup"><span data-stu-id="a94b8-154">GetValue()</span></span>   | <span data-ttu-id="a94b8-155">Recupera i valori delle proprietà dal blocco corrente.</span><span class="sxs-lookup"><span data-stu-id="a94b8-155">Retrieves property values from the current chunk.</span></span>                                      |
| <span data-ttu-id="a94b8-156">BindRegion()</span><span class="sxs-lookup"><span data-stu-id="a94b8-156">BindRegion()</span></span> | <span data-ttu-id="a94b8-157">Attualmente riservata per uso interno; non implementare.</span><span class="sxs-lookup"><span data-stu-id="a94b8-157">Currently reserved for internal use; do not implement.</span></span> <span data-ttu-id="a94b8-158">Questo metodo restituisce E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="a94b8-158">This method returns E\_NOTIMPL.</span></span> |



 

### <a name="ipersiststream"></a><span data-ttu-id="a94b8-159">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="a94b8-159">IPersistStream</span></span>

<span data-ttu-id="a94b8-160">Questa interfaccia carica un file da un flusso per un'elaborazione più sicura rispetto all' [interfaccia IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) perché il contesto in cui viene eseguito un filtro [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) non necessita dei diritti per aprire i file sul disco o sulla rete.</span><span class="sxs-lookup"><span data-stu-id="a94b8-160">This interface loads a file from a stream for more secure processing than [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) because the context in which a [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) filter runs does not need the rights to open any files on the disk or over the network.</span></span> <span data-ttu-id="a94b8-161">Dei due metodi per l'accesso a un singolo file, si tratta del metodo preferito per la compatibilità con le edizioni di Windows.</span><span class="sxs-lookup"><span data-stu-id="a94b8-161">Of the two methods for accessing a single file, this is the preferred method for forward compatibility with Windows.</span></span>



| <span data-ttu-id="a94b8-162">Metodo</span><span class="sxs-lookup"><span data-stu-id="a94b8-162">Method</span></span>       | <span data-ttu-id="a94b8-163">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a94b8-163">Description</span></span>                                                                                                                                        |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a94b8-164">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-164">IsDirty()</span></span>    | <span data-ttu-id="a94b8-165">Verifica se è stata apportata una modifica.</span><span class="sxs-lookup"><span data-stu-id="a94b8-165">Checks if there has been a change.</span></span> <span data-ttu-id="a94b8-166">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-166">This method returns E\_NOTIMPL in filters.</span></span>                                                                      |
| <span data-ttu-id="a94b8-167">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-167">InitNew()</span></span>    | <span data-ttu-id="a94b8-168">Crea una nuova risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-168">Creates a new storage.</span></span> <span data-ttu-id="a94b8-169">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-169">This method returns E\_NOTIMPL in filters.</span></span>                                                                                  |
| <span data-ttu-id="a94b8-170">Carica ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-170">Load()</span></span>       | <span data-ttu-id="a94b8-171">Inizializza un oggetto dal flusso in cui è stato salvato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="a94b8-171">Initializes an object from the stream where it was previously saved.</span></span>                                                                               |
| <span data-ttu-id="a94b8-172">Salva ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-172">Save()</span></span>       | <span data-ttu-id="a94b8-173">Salva un oggetto nel flusso specificato e indica se l'oggetto deve reimpostare il relativo flag Dirty.</span><span class="sxs-lookup"><span data-stu-id="a94b8-173">Saves an object into the specified stream and indicates whether the object should reset its dirty flag.</span></span> <span data-ttu-id="a94b8-174">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-174">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="a94b8-175">GetSizeMax ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-175">GetSizeMax()</span></span> | <span data-ttu-id="a94b8-176">Restituisce la dimensione, in byte, del flusso necessario per salvare l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="a94b8-176">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="a94b8-177">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-177">This method returns E\_NOTIMPL in filters.</span></span>                                      |



 

### <a name="ipersistfile"></a><span data-ttu-id="a94b8-178">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="a94b8-178">IPersistFile</span></span>

<span data-ttu-id="a94b8-179">Questa interfaccia carica un file in base al percorso assoluto e non è supportato in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a94b8-179">This interface loads a file by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="a94b8-180">Metodo</span><span class="sxs-lookup"><span data-stu-id="a94b8-180">Method</span></span>          | <span data-ttu-id="a94b8-181">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a94b8-181">Description</span></span>                                                                                                                  |
|-----------------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a94b8-182">GetCurFile ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-182">GetCurFile()</span></span>    | <span data-ttu-id="a94b8-183">Ottiene il nome corrente del file associato all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="a94b8-183">Gets the current name of the file associated with the object.</span></span> <span data-ttu-id="a94b8-184">Restituisce il percorso specificato in Load ().</span><span class="sxs-lookup"><span data-stu-id="a94b8-184">Returns the path specified in Load().</span></span>                          |
| <span data-ttu-id="a94b8-185">Carica ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-185">Load()</span></span>          | <span data-ttu-id="a94b8-186">Apre il file specificato e inizializza un oggetto dal contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-186">Opens the specified file and initializes an object from the file contents.</span></span> <span data-ttu-id="a94b8-187">È possibile ritardare l'apertura del file fino a quando non è necessario.</span><span class="sxs-lookup"><span data-stu-id="a94b8-187">You can delay opening the file until you need it.</span></span> |
| <span data-ttu-id="a94b8-188">GetClassID ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-188">GetClassID()</span></span>    | <span data-ttu-id="a94b8-189">Restituisce l'identificatore di classe (CLSID) per il nuovo tipo di file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-189">Returns the class identifier (CLSID) for the new file type.</span></span> <span data-ttu-id="a94b8-190">Per generare un CLSID univoco, è necessario utilizzare uuidgen.exe.</span><span class="sxs-lookup"><span data-stu-id="a94b8-190">You should use uuidgen.exe to generate a unique CLSID.</span></span>           |
| <span data-ttu-id="a94b8-191">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-191">IsDirty()</span></span>       | <span data-ttu-id="a94b8-192">È necessario restituire solo E \_ NOTIMPL nei filtri</span><span class="sxs-lookup"><span data-stu-id="a94b8-192">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="a94b8-193">Salva ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-193">Save()</span></span>          | <span data-ttu-id="a94b8-194">È necessario restituire solo E \_ NOTIMPL nei filtri</span><span class="sxs-lookup"><span data-stu-id="a94b8-194">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="a94b8-195">SaveCompleted ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-195">SaveCompleted()</span></span> | <span data-ttu-id="a94b8-196">È necessario restituire solo E \_ NOTIMPL nei filtri</span><span class="sxs-lookup"><span data-stu-id="a94b8-196">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |



 

### <a name="ipersiststorage"></a><span data-ttu-id="a94b8-197">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="a94b8-197">IPersistStorage</span></span>

<span data-ttu-id="a94b8-198">Questa interfaccia supporta il modello di archiviazione strutturato, in cui ogni oggetto contenuto dispone di una propria archiviazione annidata all'interno dell'archiviazione del contenitore.</span><span class="sxs-lookup"><span data-stu-id="a94b8-198">This interface supports the structured storage model, in which each contained object has its own storage that is nested within the container's storage.</span></span> <span data-ttu-id="a94b8-199">Analogamente all' [interfaccia IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile), questa interfaccia viene caricata in base al percorso assoluto e non è supportata in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a94b8-199">Like [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile), this interface loads by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="a94b8-200">Metodo</span><span class="sxs-lookup"><span data-stu-id="a94b8-200">Method</span></span>            | <span data-ttu-id="a94b8-201">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a94b8-201">Description</span></span>                                                                                                   |
|-------------------|---------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a94b8-202">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-202">IsDirty()</span></span>         | <span data-ttu-id="a94b8-203">Verifica se è stata apportata una modifica.</span><span class="sxs-lookup"><span data-stu-id="a94b8-203">Checks if there has been a change.</span></span> <span data-ttu-id="a94b8-204">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-204">This method returns E\_NOTIMPL in filters.</span></span>                                 |
| <span data-ttu-id="a94b8-205">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-205">InitNew()</span></span>         | <span data-ttu-id="a94b8-206">Crea una nuova risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-206">Creates a new storage.</span></span> <span data-ttu-id="a94b8-207">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-207">This method returns E\_NOTIMPL in filters.</span></span>                                             |
| <span data-ttu-id="a94b8-208">Carica ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-208">Load()</span></span>            | <span data-ttu-id="a94b8-209">Salva l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-209">Saves the storage.</span></span> <span data-ttu-id="a94b8-210">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-210">This method returns E\_NOTIMPL in filters.</span></span>                                                 |
| <span data-ttu-id="a94b8-211">Salva ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-211">Save()</span></span>            | <span data-ttu-id="a94b8-212">Restituisce la dimensione, in byte, del flusso necessario per salvare l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="a94b8-212">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="a94b8-213">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-213">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="a94b8-214">SaveCompleted ()</span><span class="sxs-lookup"><span data-stu-id="a94b8-214">SaveCompleted()</span></span>   | <span data-ttu-id="a94b8-215">Riservato per utilizzo interno.</span><span class="sxs-lookup"><span data-stu-id="a94b8-215">Reserved for internal use.</span></span> <span data-ttu-id="a94b8-216">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-216">This method returns E\_NOTIMPL in filters.</span></span>                                         |
| <span data-ttu-id="a94b8-217">HandsOffStorage()</span><span class="sxs-lookup"><span data-stu-id="a94b8-217">HandsOffStorage()</span></span> | <span data-ttu-id="a94b8-218">Riservato per utilizzo interno.</span><span class="sxs-lookup"><span data-stu-id="a94b8-218">Reserved for internal use.</span></span> <span data-ttu-id="a94b8-219">Questo metodo restituisce E \_ NOTIMPL nei filtri.</span><span class="sxs-lookup"><span data-stu-id="a94b8-219">This method returns E\_NOTIMPL in filters.</span></span>                                         |



 

## <a name="outputting-properties-with-filters"></a><span data-ttu-id="a94b8-220">Output delle proprietà con i filtri</span><span class="sxs-lookup"><span data-stu-id="a94b8-220">Outputting Properties with Filters</span></span>

<span data-ttu-id="a94b8-221">Lo scopo di un filtro è quello di estrarre il contenuto e le proprietà dei file da includere nell'indice full-text.</span><span class="sxs-lookup"><span data-stu-id="a94b8-221">The purpose of a filter is to extract the content and properties of files for inclusion in the full-text index.</span></span> <span data-ttu-id="a94b8-222">WDS chiama innanzitutto il metodo Load sulle implementazioni IPersistFile, IPersistStream o IPersistStorage e quindi richiama il metodo Init dell'implementazione di IFilter.</span><span class="sxs-lookup"><span data-stu-id="a94b8-222">WDS first calls the Load method on either the IPersistFile, IPersistStream, or IPersistStorage implementations and then invokes the Init method of the IFilter implementation.</span></span> <span data-ttu-id="a94b8-223">**GetChunk** viene chiamato per recuperare i blocchi di dati del valore di testo o di proprietà, quindi **gettext** o **GetValue** viene chiamato il numero di volte necessario per recuperare tutti i valori di testo o di proprietà associati al blocco.</span><span class="sxs-lookup"><span data-stu-id="a94b8-223">**GetChunk** is called to retrieve chunks of text or property value data, and then either **GetText** or **GetValue** is called as many times as needed to retrieve all of the text or property values associated with the chunk.</span></span> <span data-ttu-id="a94b8-224">Questo processo si **ripete fino a quando non viene** segnalato che il documento non contiene più blocchi.</span><span class="sxs-lookup"><span data-stu-id="a94b8-224">This process repeats until **GetChunk** reports that there are no more chunks in the document.</span></span>

<span data-ttu-id="a94b8-225">Il metodo **GetChunk** recupera le informazioni sul primo o successivo blocco logico di informazioni dal file da filtrare e restituisce tali informazioni in una struttura di \_ blocco stat, inclusione di un ID blocco a incremento progressivo costante, informazioni sullo stato relative alla relazione tra il blocco corrente e il blocco precedente, un flag che indica se il blocco contiene testo o un valore, le impostazioni locali del blocco e la specifica della proprietà del blocco.</span><span class="sxs-lookup"><span data-stu-id="a94b8-225">The **GetChunk** method retrieves information about the first or next logical block of information from the file being filtered and returns that information in a STAT\_CHUNK structure, including a monotonically increasing chunk ID, status information about how the current chunk relates to the previous chunk, a flag indicating whether the chunk contains text or a value, the chunk's locale, and the chunk's property specification.</span></span> <span data-ttu-id="a94b8-226">La specifica della proprietà è un [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) costituito da un CLSID e da un identificatore di proprietà Integer o stringa (ad esempio, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span><span class="sxs-lookup"><span data-stu-id="a94b8-226">The property specification is a [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) consisting of a CLSID and either an integer or string property identifier (for example, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span></span> <span data-ttu-id="a94b8-227">Identifica il tipo di proprietà anziché il valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="a94b8-227">It identifies the type of property rather than the property value itself.</span></span>

<span data-ttu-id="a94b8-228">L'identificatore delle impostazioni locali del blocco viene usato per scegliere un Word breaker appropriato ed è molto importante identificarlo correttamente.</span><span class="sxs-lookup"><span data-stu-id="a94b8-228">The chunk locale identifier is used to choose an appropriate word breaker, and it is very important that you correctly identify it.</span></span> <span data-ttu-id="a94b8-229">Se il filtro non è in grado di determinare le impostazioni locali del testo, deve presupporre le impostazioni locali predefinite del sistema, disponibile tramite **GetSystemDefaultLCID**.</span><span class="sxs-lookup"><span data-stu-id="a94b8-229">If the filter cannot determine the locale of the text, it should assume the default system locale, available by using **GetSystemDefaultLCID**.</span></span> <span data-ttu-id="a94b8-230">Se si controlla il formato del file e attualmente non contiene informazioni sulle impostazioni locali, è necessario aggiungere una funzionalità utente per abilitare l'identificazione delle impostazioni locali corretta.</span><span class="sxs-lookup"><span data-stu-id="a94b8-230">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="a94b8-231">L'utilizzo di un Word breaker non corrispondente può causare un'esperienza di query non valida per l'utente.</span><span class="sxs-lookup"><span data-stu-id="a94b8-231">Using a mismatched word breaker can lead to a bad query experience for the user.</span></span>

<span data-ttu-id="a94b8-232">**GetChunk** gestisce solo l'accesso ai blocchi e non restituisce il testo o il valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="a94b8-232">**GetChunk** only manages accessing chunks and does not return the text or property value itself.</span></span> <span data-ttu-id="a94b8-233">Al contrario, le chiamate successive a **gettext** e **GetValue** recuperano il corpo del blocco.</span><span class="sxs-lookup"><span data-stu-id="a94b8-233">Rather, subsequent calls to **GetText** and **GetValue** retrieve the body of the chunk.</span></span> <span data-ttu-id="a94b8-234">**Gettext** restituisce i blocchi di testo, che sono stringhe Unicode, dal blocco di testo del blocco corrente \_ .</span><span class="sxs-lookup"><span data-stu-id="a94b8-234">**GetText** returns text chunks, which are Unicode strings, from the current CHUNK\_TEXT chunk.</span></span> <span data-ttu-id="a94b8-235">Se il blocco corrente è troppo grande, può essere necessaria più di una chiamata al metodo **gettext** .</span><span class="sxs-lookup"><span data-stu-id="a94b8-235">If the current chunk is too large, more than one call to the **GetText** method can be required.</span></span> <span data-ttu-id="a94b8-236">Ogni chiamata al metodo **gettext** Recupera il testo che segue immediatamente il testo dall'ultima chiamata al metodo **gettext** .</span><span class="sxs-lookup"><span data-stu-id="a94b8-236">Each call to the **GetText** method retrieves text that immediately follows the text from the last call to the **GetText** method.</span></span> <span data-ttu-id="a94b8-237">Ad esempio, l'ultimo carattere di una chiamata può trovarsi al centro di una parola e il primo carattere nella chiamata successiva continuerà a essere la parola.</span><span class="sxs-lookup"><span data-stu-id="a94b8-237">For example, the last character from one call can be in the middle of a word, and the first character in the next call would continue that word.</span></span> <span data-ttu-id="a94b8-238">I motori di ricerca devono gestire questa situazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-238">Search engines must handle this situation.</span></span>

<span data-ttu-id="a94b8-239">**GetValue** restituisce i valori delle proprietà per il blocco del valore del blocco corrente \_ nelle strutture PROPVARIANT, che possono avere un'ampia gamma di tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="a94b8-239">**GetValue** returns property values for the current CHUNK\_VALUE chunk in PROPVARIANT structures, which can hold a wide variety of data types.</span></span> <span data-ttu-id="a94b8-240">**GetValue** deve allocare la struttura PROPVARIANT usando CoTaskMemAlloc.</span><span class="sxs-lookup"><span data-stu-id="a94b8-240">**GetValue** must allocate the PROPVARIANT structure itself using CoTaskMemAlloc.</span></span> <span data-ttu-id="a94b8-241">Il chiamante di **GetValue** è responsabile della liberazione della memoria a cui punta PROPVARIANT usando PropVariantClear e della liberazione della struttura con CoTaskMemFree.</span><span class="sxs-lookup"><span data-stu-id="a94b8-241">The caller of **GetValue** is responsible for freeing memory pointed to by the PROPVARIANT using PropVariantClear, and for freeing the structure itself with CoTaskMemFree.</span></span> <span data-ttu-id="a94b8-242">Per ulteriori informazioni su PROPVARIANTs, vedere la Guida di riferimento a [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="a94b8-242">For more information on PROPVARIANTs, see the [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) reference.</span></span>

### <a name="property-values"></a><span data-ttu-id="a94b8-243">Valori della proprietà</span><span class="sxs-lookup"><span data-stu-id="a94b8-243">Property Values</span></span>

<span data-ttu-id="a94b8-244">I filtri devono restituire almeno le proprietà seguenti, che sono le colonne predefinite nella visualizzazione dei risultati di WDS.</span><span class="sxs-lookup"><span data-stu-id="a94b8-244">Filters should output at a minimum the following properties which are the default columns in the WDS results view.</span></span>



| <span data-ttu-id="a94b8-245">GUID</span><span class="sxs-lookup"><span data-stu-id="a94b8-245">GUID</span></span>                                 | <span data-ttu-id="a94b8-246">Campo PROPSPEC</span><span class="sxs-lookup"><span data-stu-id="a94b8-246">PROPSPEC</span></span>      | <span data-ttu-id="a94b8-247">Nome descrittivo</span><span class="sxs-lookup"><span data-stu-id="a94b8-247">Friendly Name</span></span>  | <span data-ttu-id="a94b8-248">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a94b8-248">Description</span></span>                                                                                                                                     |
|--------------------------------------|---------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a94b8-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="a94b8-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="a94b8-250">2</span><span class="sxs-lookup"><span data-stu-id="a94b8-250">2</span></span>             | <span data-ttu-id="a94b8-251">PrimaryTitle</span><span class="sxs-lookup"><span data-stu-id="a94b8-251">PrimaryTitle</span></span>   | <span data-ttu-id="a94b8-252">Titolo visualizzato per questo elemento.</span><span class="sxs-lookup"><span data-stu-id="a94b8-252">Title that displays for this item.</span></span>                                                                                                              |
| <span data-ttu-id="a94b8-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="a94b8-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="a94b8-254">4</span><span class="sxs-lookup"><span data-stu-id="a94b8-254">4</span></span>             | <span data-ttu-id="a94b8-255">PrimaryAuthors</span><span class="sxs-lookup"><span data-stu-id="a94b8-255">PrimaryAuthors</span></span> | <span data-ttu-id="a94b8-256">Persona più associata a questo elemento.</span><span class="sxs-lookup"><span data-stu-id="a94b8-256">Person most associated with this item.</span></span>                                                                                                          |
| <span data-ttu-id="a94b8-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="a94b8-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="a94b8-258">DataPrincipale</span><span class="sxs-lookup"><span data-stu-id="a94b8-258">PrimaryDate</span></span>   | <span data-ttu-id="a94b8-259">DataPrincipale</span><span class="sxs-lookup"><span data-stu-id="a94b8-259">PrimaryDate</span></span>    | <span data-ttu-id="a94b8-260">Data più importante per l'elemento, ad esempio la data di ricezione per la posta elettronica o la modifica dei file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-260">Most important date for item, like date received for email or modified for files.</span></span>                                                               |
| <span data-ttu-id="a94b8-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="a94b8-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="a94b8-262">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="a94b8-262">PerceivedType</span></span> | <span data-ttu-id="a94b8-263">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="a94b8-263">PerceivedType</span></span>  | <span data-ttu-id="a94b8-264">Tipo di file da analizzare.</span><span class="sxs-lookup"><span data-stu-id="a94b8-264">Type of file being parsed.</span></span> <span data-ttu-id="a94b8-265">Deve corrispondere a uno dei tipi di ricerca desktop di Windows elencati nel [tipo percepito](-search-2x-wds-perceivedtype.md)WDS.</span><span class="sxs-lookup"><span data-stu-id="a94b8-265">Must match one of the Windows Desktop Search types listed in WDS [Perceived Type](-search-2x-wds-perceivedtype.md).</span></span> |



 

<span data-ttu-id="a94b8-266">Per gli elementi di testo non crittografato, WDS estrae tutte le proprietà di testo e definite dal sistema, ad esempio le dimensioni del file o l'estensione, per includere nuovi tipi di file in testo normale nell'indice.</span><span class="sxs-lookup"><span data-stu-id="a94b8-266">For plaintext items, WDS extracts all text and system-defined properties such as file size or extension on including new plaintext file types to the index).</span></span> <span data-ttu-id="a94b8-267">Altri tipi di proprietà che possono essere restituiti all'indice includono:</span><span class="sxs-lookup"><span data-stu-id="a94b8-267">Other types of properties that can be returned to the index include:</span></span>

-   <span data-ttu-id="a94b8-268">Per i file: autore, titolo, stato, parole chiave</span><span class="sxs-lookup"><span data-stu-id="a94b8-268">For files: author, title, status, keywords</span></span>
-   <span data-ttu-id="a94b8-269">Per supporti: album, genere, fotocamera, data acquisita</span><span class="sxs-lookup"><span data-stu-id="a94b8-269">For media: album, genre, camera make, date taken</span></span>
-   <span data-ttu-id="a94b8-270">Per le comunicazioni: da, a, CC, importanza</span><span class="sxs-lookup"><span data-stu-id="a94b8-270">For communications: from, to, cc, importance</span></span>
-   <span data-ttu-id="a94b8-271">Per i contatti: titolo del processo, telefono aziendale, società</span><span class="sxs-lookup"><span data-stu-id="a94b8-271">For contacts: job title, business phone, company</span></span>

<span data-ttu-id="a94b8-272">L'elenco sopra riportato raggruppa le proprietà comuni a un tipo percepito specificato. Tuttavia, qualsiasi proprietà può essere utilizzata indipendentemente dal tipo.</span><span class="sxs-lookup"><span data-stu-id="a94b8-272">The list above groups properties common to a specified Perceived Type; however, any property can be used regardless of the type.</span></span> <span data-ttu-id="a94b8-273">Ad esempio, l'azienda può essere usata per il nome del datore di lavoro di un contatto e può anche essere usata per fare riferimento al nome di un client al quale è correlato il file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-273">For example, company could be used for a contact's employer name and could also be used to refer to the name of a client the file relates to.</span></span> <span data-ttu-id="a94b8-274">Molte di queste proprietà vengono usate per visualizzare i risultati della ricerca nella visualizzazione dei risultati di WDS.</span><span class="sxs-lookup"><span data-stu-id="a94b8-274">Many of these properties are used to display search results in the WDS results view.</span></span> <span data-ttu-id="a94b8-275">Ad esempio, la proprietà title di un file viene visualizzata come colonna principale nella visualizzazione dei risultati predefiniti.</span><span class="sxs-lookup"><span data-stu-id="a94b8-275">For example, a file's Title property is shown as the main column in the default results view.</span></span> <span data-ttu-id="a94b8-276">Gli oggetti IFilter devono restituire tutte le proprietà correlate al tipo di elemento analizzato.</span><span class="sxs-lookup"><span data-stu-id="a94b8-276">IFilter objects should output all the properties related to the item type they are parsing.</span></span> <span data-ttu-id="a94b8-277">Non è possibile aggiungere proprietà personalizzate in WDS 2. x.</span><span class="sxs-lookup"><span data-stu-id="a94b8-277">Custom properties cannot be added in WDS 2.x.</span></span> <span data-ttu-id="a94b8-278">Per un elenco completo delle proprietà disponibili, vedere lo [schema di WDS](-search-2x-wds-schematable.md).</span><span class="sxs-lookup"><span data-stu-id="a94b8-278">For a full list of properties available, see the [WDS Schema](-search-2x-wds-schematable.md).</span></span>

## <a name="filter-add-in-installation"></a><span data-ttu-id="a94b8-279">Filtra installazione del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="a94b8-279">Filter Add-in Installation</span></span>

<span data-ttu-id="a94b8-280">L'installazione del filtro comporta la copia della DLL in una posizione appropriata nella directory Program Files e la relativa registrazione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-280">Installing the filter involves copying the DLL to an appropriate location in the Program Files directory and registering it.</span></span> <span data-ttu-id="a94b8-281">I filtri devono implementare la registrazione automatica per l'installazione e attenersi alle linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-281">Filters should implement self-registration for installation and should follow these guidelines:</span></span>

-   <span data-ttu-id="a94b8-282">Il programma di installazione deve usare il programma di installazione EXE o MSI.</span><span class="sxs-lookup"><span data-stu-id="a94b8-282">The installer must use either EXE or MSI installer.</span></span>
-   <span data-ttu-id="a94b8-283">È necessario fornire le note sulla versione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-283">Release notes must be provided.</span></span>
-   <span data-ttu-id="a94b8-284">È necessario creare una voce di installazione **applicazioni** per ogni componente aggiuntivo installato.</span><span class="sxs-lookup"><span data-stu-id="a94b8-284">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="a94b8-285">Il programma di installazione deve assumere tutte le impostazioni del registro di sistema per il tipo di file o l'archivio specifico che il componente aggiuntivo corrente riconosce.</span><span class="sxs-lookup"><span data-stu-id="a94b8-285">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="a94b8-286">Se un componente aggiuntivo precedente viene sovrascritto, il programma di installazione deve inviare una notifica all'utente.</span><span class="sxs-lookup"><span data-stu-id="a94b8-286">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="a94b8-287">Se un componente aggiuntivo più recente ha sovrascritto il componente aggiuntivo precedente, dovrebbe essere possibile ripristinare la funzionalità del componente aggiuntivo precedente e renderlo di nuovo il componente aggiuntivo predefinito per il tipo di file o l'archivio.</span><span class="sxs-lookup"><span data-stu-id="a94b8-287">If a newer add-in has overwritten the previous add-in, there should be the ability to restore the previous add-in's functionality and make it the default add-in for that file type or store again.</span></span>

### <a name="clsids-required-for-registration"></a><span data-ttu-id="a94b8-288">CLSID necessari per la registrazione</span><span class="sxs-lookup"><span data-stu-id="a94b8-288">CLSIDs Required for Registration</span></span>

<span data-ttu-id="a94b8-289">Sono disponibili tre identificatori di classe, o CLSID, associati a ogni filtro.</span><span class="sxs-lookup"><span data-stu-id="a94b8-289">There are three class identifiers, or CLSIDs, associated with every filter.</span></span> <span data-ttu-id="a94b8-290">È necessario generare uno o più di questi (usare uuidgen.exe) per registrare il componente aggiuntivo di filtro.</span><span class="sxs-lookup"><span data-stu-id="a94b8-290">You'll need to generate one or more of these (use uuidgen.exe) to register your filter add-in.</span></span>

-   <span data-ttu-id="a94b8-291">Il primo oggetto identifica il gestore permanente di tutti i filtri, \_ ovvero IID IFilter, che è {89BCB740-6119-101A-BCB7-00DD010655AF}.</span><span class="sxs-lookup"><span data-stu-id="a94b8-291">The first identifies all filters' persistent handler, IID\_IFilter, which is {89BCB740-6119-101A-BCB7-00DD010655AF}.</span></span> <span data-ttu-id="a94b8-292">Questo CLSID è costante per tutti i filtri che implementano IFilter.</span><span class="sxs-lookup"><span data-stu-id="a94b8-292">This CLSID is constant for all filters that implement IFilter.</span></span>
-   <span data-ttu-id="a94b8-293">Il secondo (il valore della \_ chiave IFILTER IID) identifica l'implementazione di IFilter per il tipo di file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-293">The second (the value of the IID\_IFilter key) identifies the IFilter implementation for your file type.</span></span> <span data-ttu-id="a94b8-294">Questa chiave contiene un valore InprocServer32 che specifica il nome della DLL in base al percorso e al modello di Threading.</span><span class="sxs-lookup"><span data-stu-id="a94b8-294">This key contains an InprocServer32 value that specifies the DLL name by path and the threading model.</span></span> <span data-ttu-id="a94b8-295">Se il filtro si trova nel percorso di sistema, ad esempio la directory system32, è sufficiente un nome file.</span><span class="sxs-lookup"><span data-stu-id="a94b8-295">If the filter is in the system path, like the system32 directory, a file name is sufficient.</span></span> <span data-ttu-id="a94b8-296">In caso contrario, questo valore deve avere una specifica del percorso completo.</span><span class="sxs-lookup"><span data-stu-id="a94b8-296">Otherwise, this value should have a full path specification.</span></span>
-   <span data-ttu-id="a94b8-297">Il terzo identifica il tipo di file che il filtro elabora e viene restituito dal metodo GetClassID sull'interfaccia IPersist.</span><span class="sxs-lookup"><span data-stu-id="a94b8-297">The third identifies the file type the filter processes and is returned by the GetClassID method on your IPersist interface.</span></span>

> [!Note]
>
> <span data-ttu-id="a94b8-298">Nelle versioni future dei sistemi operativi Microsoft, l'installazione dei file nella directory system32 potrebbe risultare più complessa, pertanto è consigliabile installarli in programmi e includere un percorso completo del filtro nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="a94b8-298">In future versions of Microsoft operating systems, installing files in the system32 directory may get more difficult, so we recommend you install them under Program Files and include a full path to the filter in the registry.</span></span> <span data-ttu-id="a94b8-299">Per motivi di sicurezza, è inoltre consigliabile specificare un percorso completo della DLL nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="a94b8-299">For security reasons, it is also prudent to specify a full path to your DLL in the registry.</span></span> <span data-ttu-id="a94b8-300">In caso contrario, è possibile caricare una versione "Trojan Horse" della DLL se si trova nel percorso del processo prima della versione.</span><span class="sxs-lookup"><span data-stu-id="a94b8-300">Otherwise, a "Trojan horse" version of your DLL could be loaded if it happens to be in the process path before your version.</span></span>

 

### <a name="registration-model"></a><span data-ttu-id="a94b8-301">Modello di registrazione</span><span class="sxs-lookup"><span data-stu-id="a94b8-301">Registration Model</span></span>

<span data-ttu-id="a94b8-302">Quando WDS è pronto per filtrare un file, Cerca nel registro di sistema sotto l'estensione del file per determinare quale filtro caricare.</span><span class="sxs-lookup"><span data-stu-id="a94b8-302">When WDS is ready to filter a file, it looks in the registry under the file's extension to determine which filter to load.</span></span> <span data-ttu-id="a94b8-303">Segue quindi una serie di collegamenti al registro di sistema per trovare il nome della DLL di filtro, in questo ordine:</span><span class="sxs-lookup"><span data-stu-id="a94b8-303">It then follows a series of registry links to find the name of the filter DLL, in this order:</span></span>

1.  <span data-ttu-id="a94b8-304">Da CLSID disponibili in:</span><span class="sxs-lookup"><span data-stu-id="a94b8-304">From CLSIDs located at:</span></span>

    <span data-ttu-id="a94b8-305">**HKEY \_ \_ software utente \\ corrente \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="a94b8-305">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="a94b8-306">**HKEY \_ \_ software utente \\ corrente \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="a94b8-306">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

2.  <span data-ttu-id="a94b8-307">Dal tipo di contenuto del file:</span><span class="sxs-lookup"><span data-stu-id="a94b8-307">From the file content type at:</span></span>

    <span data-ttu-id="a94b8-308">**\_Tipo di \_ \\ contenuto del \\ \\ database MIME per le classi software \\ del computer \\ locale HKEY**</span><span class="sxs-lookup"><span data-stu-id="a94b8-308">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\MIME\\Database\\Content Type**</span></span>

3.  <span data-ttu-id="a94b8-309">Dall'estensione del nome file (uguale all'API Win32 LoadIFilter) in:</span><span class="sxs-lookup"><span data-stu-id="a94b8-309">From the file name extension (same as Win32 LoadIFilter API) at:</span></span>

    <span data-ttu-id="a94b8-310">**HKEY \_ \_ software utente \\ corrente \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="a94b8-310">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="a94b8-311">**HKEY \_ \_ software utente \\ corrente \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="a94b8-311">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

    <span data-ttu-id="a94b8-312">**\_Classi HKEY \_ radice \\ EXTPERSISTENTHANDLER->CLSID->IID \_ IFilter->CLSID**</span><span class="sxs-lookup"><span data-stu-id="a94b8-312">**HKEY\_CLASSES\_ROOT\\extpersistentHandler->CLSID->IID\_IFilter->CLSID**</span></span>

4.  <span data-ttu-id="a94b8-313">Da impostazione predefinita:</span><span class="sxs-lookup"><span data-stu-id="a94b8-313">From Default at:</span></span>

    <span data-ttu-id="a94b8-314">**HKEY \_ Local \_ Machine \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="a94b8-314">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

### <a name="to-register-a-filter-add-in"></a><span data-ttu-id="a94b8-315">Per registrare un componente aggiuntivo di filtro</span><span class="sxs-lookup"><span data-stu-id="a94b8-315">To Register a Filter Add-in</span></span>

<span data-ttu-id="a94b8-316">Per registrare il componente aggiuntivo del filtro, è necessario inserire un totale di otto voci nel registro di sistema:</span><span class="sxs-lookup"><span data-stu-id="a94b8-316">You need to make a total of eight entries in the registry to register your filter add-in, where:</span></span>

-   <span data-ttu-id="a94b8-317">**. ext** è la nuova estensione del nome di file</span><span class="sxs-lookup"><span data-stu-id="a94b8-317">**.ext** is the new file name extension</span></span>
-   <span data-ttu-id="a94b8-318">Il **GUID \_ 1** può essere qualsiasi nuovo GUID generato per questa estensione</span><span class="sxs-lookup"><span data-stu-id="a94b8-318">**GUID\_1** can be any new GUID generated for this extension</span></span>
-   <span data-ttu-id="a94b8-319">**89BCB740-6119-101A-BCB7-00DD010655AF** è il GUID dell'interfaccia IFilter, che è una costante per tutte le implementazioni di IFilter.</span><span class="sxs-lookup"><span data-stu-id="a94b8-319">**89BCB740-6119-101A-BCB7-00DD010655AF** is the IFilter interface GUID, which is a constant for all IFilter implementations.</span></span>

1.  <span data-ttu-id="a94b8-320">Registrare il gestore permanente per l'estensione del nome file con le chiavi e i valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-320">Register the persistent handler for the file name extension with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\<.ext>\PersistentHandler
       (Default) = {GUID_1}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}
       (Default) = <Persistent Handler Description>
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered
       (Default) = (Value Not Set)
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered\{89BCB740-6119-101A-BCB7-00DD010655AF}
       (Default) = {CLSID of IFilter implementation}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentHandler
       (Default) = {GUID_1}
    ```

2.  <span data-ttu-id="a94b8-321">Registrare l'implementazione di IFilter con le chiavi e i valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-321">Register the IFilter implementation with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}
       (Default) = Extension IFilter Description">
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}\InprocServer32
       (Default) = <DLL Install Path>
       ThreadingModel = Both
    ```

3.  <span data-ttu-id="a94b8-322">Registrare l'implementazione di IFilter con Windows Desktop Search con la chiave e il valore seguenti:</span><span class="sxs-lookup"><span data-stu-id="a94b8-322">Register the IFilter implementation with Windows Desktop Search with the following key and value:</span></span>

    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RSSearch\ContentIndexCommon\Filters\Extension\<.ext>
       (Default) = {CLSID of IFilter implementation}"
    ```

## <a name="related-topics"></a><span data-ttu-id="a94b8-323">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="a94b8-323">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="a94b8-324">**Riferimento**</span><span class="sxs-lookup"><span data-stu-id="a94b8-324">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="a94b8-325">SchemaTable</span><span class="sxs-lookup"><span data-stu-id="a94b8-325">SchemaTable</span></span>](-search-2x-wds-schematable.md)
</dt> <dt>

[<span data-ttu-id="a94b8-326">Tipi percepiti</span><span class="sxs-lookup"><span data-stu-id="a94b8-326">Perceived Types</span></span>](-search-2x-wds-perceivedtype.md)
</dt> <dt>

[<span data-ttu-id="a94b8-327">Sviluppo di gestori di protocollo</span><span class="sxs-lookup"><span data-stu-id="a94b8-327">Developing Protocol Handlers</span></span>](-search-2x-wds-phaddins.md)
</dt> <dt>

<span data-ttu-id="a94b8-328">**Altre risorse**</span><span class="sxs-lookup"><span data-stu-id="a94b8-328">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="a94b8-329">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="a94b8-329">**IFilter**</span></span>](/windows/desktop/api/filter/nn-filter-ifilter)
</dt> </dl>

 

 