---
description: 'Le seguenti considerazioni sulla sicurezza si applicano alle applicazioni che utilizzano WinHTTP: i certificati server vengono verificati solo una volta per sessione.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Considerazioni sulla sicurezza di WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc06725ba03631eb4d5e5c29f8cfa0aae69b5022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484980"
---
# <a name="winhttp-security-considerations"></a><span data-ttu-id="b84fe-103">Considerazioni sulla sicurezza di WinHTTP</span><span class="sxs-lookup"><span data-stu-id="b84fe-103">WinHTTP Security Considerations</span></span>

<span data-ttu-id="b84fe-104">Le seguenti considerazioni sulla sicurezza si applicano alle applicazioni che utilizzano WinHTTP:</span><span class="sxs-lookup"><span data-stu-id="b84fe-104">The following security considerations apply to applications that use WinHTTP:</span></span>

-   <span data-ttu-id="b84fe-105">**I certificati del server vengono verificati solo una volta per sessione.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-105">**Server certificates are only verified once per session.**</span></span> <span data-ttu-id="b84fe-106">Dopo che un certificato è stato verificato, rimane valido per tutta la durata della sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="b84fe-106">After a certificate has been verified, it remains valid for the duration of the current session.</span></span> <span data-ttu-id="b84fe-107">Fino a quando l'impronta digitale del certificato corrisponde, che indica che il certificato non è stato modificato, il certificato continua a essere riconvalidato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-107">As long as the certificate fingerprint matches, which indicates that the certificate has not changed, the certificate continues to be re-validated.</span></span> <span data-ttu-id="b84fe-108">Di conseguenza, tutte le modifiche apportate ai criteri di convalida, tramite il protocollo, il controllo di revoca o i flag di errore del certificato, non diventano effettive dopo la verifica del certificato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-108">As a result, any change in the validation criteria, through the protocol, revocation-check, or certificate-error-ignore flags, does not take effect once the certificate is verified.</span></span> <span data-ttu-id="b84fe-109">Per rendere effettive le modifiche di questo tipo, la sessione corrente deve essere terminata e ne è stata avviata una nuova.</span><span class="sxs-lookup"><span data-stu-id="b84fe-109">To force such a change to take effect immediately, the current session must be ended and a new one started.</span></span> <span data-ttu-id="b84fe-110">Analogamente, la scadenza di un certificato durante il corso di una sessione può essere rilevata solo se l'applicazione stessa controlla periodicamente il server di certificati per recuperare i dati di scadenza.</span><span class="sxs-lookup"><span data-stu-id="b84fe-110">Similarly, expiration of a certificate during the course of a session can only be detected if the application itself checks the certificate server periodically to retrieve expiration data.</span></span>
-   <span data-ttu-id="b84fe-111">**Il proxy automatico prevede il download e l'esecuzione di script.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-111">**Auto-proxy involves downloading and executing scripts.**</span></span> <span data-ttu-id="b84fe-112">Il supporto per l'individuazione automatica dei proxy comporta il rilevamento tramite DHCP o DNS, il download e l'esecuzione di script proxy come gli script Java.</span><span class="sxs-lookup"><span data-stu-id="b84fe-112">The automatic proxy discovery support involves detecting through DHCP or DNS, downloading, and executing proxy scripts such as Java scripts.</span></span> <span data-ttu-id="b84fe-113">Per ottenere un livello di sicurezza superiore, un'applicazione deve evitare il passaggio del flag di esecuzione del PROXY automatico WinHTTP, in modo che l'individuazione del proxy automatico venga avviata out-of-process. **\_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="b84fe-113">To achieve a higher degree of security, an application must avoid passing the **WINHTTP\_AUTOPROXY\_RUN\_INPROCESS** flag, so that the auto-proxy discovery is initiated out-of-process.</span></span> <span data-ttu-id="b84fe-114">Anche in questo caso, WinHTTP tenta per impostazione predefinita di eseguire uno script del proxy automatico in-process se lo script non viene eseguito correttamente out-of-process.</span><span class="sxs-lookup"><span data-stu-id="b84fe-114">Even then, WinHTTP tries by default to run an auto-proxy script in-process if the script fails to run properly out-of-process.</span></span> <span data-ttu-id="b84fe-115">Se si ritiene che questo comportamento di fallback rappresenti un rischio inaccettabile, disabilitare il comportamento di fallback con il flag di **\_ esecuzione del PROXY AutoProxy \_ \_ \_ solo WinHTTP** .</span><span class="sxs-lookup"><span data-stu-id="b84fe-115">If you believe that this fallback behavior poses an unacceptable risk, disable the fallback behavior with the **WINHTTP\_AUTOPROXY\_RUN\_OUTPROCESS\_ONLY** flag.</span></span>
-   <span data-ttu-id="b84fe-116">**Le \_ funzioni di callback dello stato WinHTTP \_ devono restituire tempestivamente.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-116">**WINHTTP\_STATUS\_CALLBACK functions must return promptly.**</span></span> <span data-ttu-id="b84fe-117">Quando si scrive una di queste funzioni di callback, prestare attenzione che non si blocchi.</span><span class="sxs-lookup"><span data-stu-id="b84fe-117">When you write one of these callback functions, be careful that it does not block.</span></span> <span data-ttu-id="b84fe-118">Ad esempio, né il callback né la funzione che chiama devono visualizzare una finestra di dialogo utente o attendere un evento.</span><span class="sxs-lookup"><span data-stu-id="b84fe-118">For example, neither the callback nor any function it calls should display a user dialog or wait for an event.</span></span> <span data-ttu-id="b84fe-119">Se una funzione di [*\_ \_ callback dello stato WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) si blocca, influiscono sulla pianificazione interna di WinHTTP e causa la negazione del servizio da parte di altre richieste all'interno dello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="b84fe-119">If a [*WINHTTP\_STATUS\_CALLBACK*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) function does block, it affects WinHTTP's internal scheduling and causes other requests within the same process to be denied service.</span></span>
-   <span data-ttu-id="b84fe-120">**Le \_ funzioni di callback dello stato WinHTTP \_ devono essere rientranti.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-120">**WINHTTP\_STATUS\_CALLBACK functions must be reentrant.**</span></span> <span data-ttu-id="b84fe-121">Quando si scrive un callback, evitare le variabili statiche o altri costrutti che non sono sicuri in reingresso ed evitare di chiamare altre funzioni che non sono rientranti.</span><span class="sxs-lookup"><span data-stu-id="b84fe-121">When writing a callback, avoid static variables or other constructs that are unsafe under reentrance, and avoid calling other functions that are not reentrant.</span></span>
-   <span data-ttu-id="b84fe-122">**Se l'operazione asincrona è possibile, passare i valori NULL per i parametri OUT.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-122">**If asynchronous operation is possible, pass NULLs for OUT parameters.**</span></span> <span data-ttu-id="b84fe-123">Se è stata abilitata l'operazione asincrona registrando una funzione di callback, passare sempre i valori **null** per tali parametri come *lpdwDataAvailable* per [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable), *lpdwBytesRead* per [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)o *lpdwBytesWritten* per [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata).</span><span class="sxs-lookup"><span data-stu-id="b84fe-123">If you have enabled asynchronous operation by registering a callback function, always pass **NULL** values for such OUT parameters as *lpdwDataAvailable* for [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable), *lpdwBytesRead* for [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata), or *lpdwBytesWritten* for [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata).</span></span> <span data-ttu-id="b84fe-124">In alcune circostanze, il thread chiamante viene terminato prima del completamento dell'operazione e se i parametri OUT non sono **null**, la funzione può terminare con la scrittura in memoria che è già stata liberata.</span><span class="sxs-lookup"><span data-stu-id="b84fe-124">Under some circumstances, the calling thread is terminated before the operation completes, and if the OUT parameters are not **NULL**, the function can end up writing to memory that has already been freed.</span></span>
-   <span data-ttu-id="b84fe-125">**L'autenticazione Passport non è infallibile.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-125">**Passport authentication is not foolproof.**</span></span> <span data-ttu-id="b84fe-126">Qualsiasi schema di autenticazione basato su cookie è vulnerabile agli attacchi.</span><span class="sxs-lookup"><span data-stu-id="b84fe-126">Any cookie-based authentication scheme is vulnerable to attack.</span></span> <span data-ttu-id="b84fe-127">Passport versione 1,4 è basato su cookie e pertanto è soggetto alle vulnerabilità associate ad alcun cookie o schema di autenticazione basata su form.</span><span class="sxs-lookup"><span data-stu-id="b84fe-127">Passport version 1.4 is cookie based, and therefore subject to the vulnerabilities that are associated with any cookie or form-based authentication scheme.</span></span> <span data-ttu-id="b84fe-128">Il supporto Passport è disabilitato per impostazione predefinita in WinHTTP; può essere abilitata usando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span><span class="sxs-lookup"><span data-stu-id="b84fe-128">Passport support is disabled by default in WinHTTP; it can be enabled using [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span></span>
-   <span data-ttu-id="b84fe-129">**L'autenticazione di base deve essere usata solo su una connessione protetta.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-129">**Basic authentication should only be used over a secure connection.**</span></span> <span data-ttu-id="b84fe-130">L'autenticazione di base, che invia il nome utente e la password in testo non crittografato (vedere [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt)), deve essere utilizzata solo per le connessioni SSL o TLS crittografate.</span><span class="sxs-lookup"><span data-stu-id="b84fe-130">Basic authentication, which sends the user name and password in clear text (see [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt)), should be used only over encrypted SSL or TLS connections.</span></span>
-   <span data-ttu-id="b84fe-131">**L'impostazione dei criteri di accesso automatico su "low" può rappresentare un rischio.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-131">**Setting Auto-Logon Policy to "low" can pose a risk.**</span></span> <span data-ttu-id="b84fe-132">Quando i criteri di accesso automatico sono impostati su bassa, è possibile usare le credenziali di accesso di un utente per eseguire l'autenticazione in qualsiasi sito.</span><span class="sxs-lookup"><span data-stu-id="b84fe-132">When the Auto-Logon Policy is set to low, a user's logon credential can be used to authenticate against any site.</span></span> <span data-ttu-id="b84fe-133">Tuttavia, non è consigliabile eseguire l'autenticazione nei siti non attendibili.</span><span class="sxs-lookup"><span data-stu-id="b84fe-133">However, it is not good security practice to authenticate against sites you do not trust.</span></span>
-   <span data-ttu-id="b84fe-134">**Le connessioni SSL 2,0 non vengono usate se non sono abilitate in modo esplicito.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-134">**SSL 2.0 connections are not used unless explicitly enabled.**</span></span> <span data-ttu-id="b84fe-135">I protocolli di sicurezza TLS 1,0 e SSL 3,0 sono considerati più sicuri rispetto a SSL 2,0.</span><span class="sxs-lookup"><span data-stu-id="b84fe-135">The TLS 1.0 and SSL 3.0 security protocols are considered more secure than SSL 2.0.</span></span> <span data-ttu-id="b84fe-136">Per impostazione predefinita, WinHTTP richiede TLS 1,0 o SSL 3,0 quando si negozia una connessione SSL e non SSL 2,0.</span><span class="sxs-lookup"><span data-stu-id="b84fe-136">By default, WinHTTP requests TLS 1.0 or SSL 3.0 when negotiating an SSL connection, not SSL 2.0.</span></span> <span data-ttu-id="b84fe-137">Il supporto SSL 2,0 in WinHTTP può essere abilitato solo chiamando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span><span class="sxs-lookup"><span data-stu-id="b84fe-137">SSL 2.0 support in WinHTTP can only be enabled by calling [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span></span>
-   <span data-ttu-id="b84fe-138">**Certificato: è necessario richiedere esplicitamente il controllo della revoca.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-138">**Certificate-revocation checking must be explicitly requested.**</span></span> <span data-ttu-id="b84fe-139">Per impostazione predefinita, quando si esegue l'autenticazione del certificato, WinHTTP non controlla se il certificato del server è stato revocato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-139">By default, when performing certificate authentication, WinHTTP does not check whether the server's certificate has been revoked.</span></span> <span data-ttu-id="b84fe-140">Certificato: la verifica delle revoche può essere abilitata usando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span><span class="sxs-lookup"><span data-stu-id="b84fe-140">Certificate-revocation checking can be enabled using [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span></span>
-   <span data-ttu-id="b84fe-141">**Le applicazioni devono garantire che una sessione venga mappata a una singola identità.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-141">**Applications must ensure that a session maps to a single identity.**</span></span> <span data-ttu-id="b84fe-142">Una sessione WinHTTP deve eseguire il mapping a una sola identità. ovvero una sessione WinHTTP viene utilizzata per gestire l'attività Internet di un singolo utente autenticato o un gruppo di utenti anonimi.</span><span class="sxs-lookup"><span data-stu-id="b84fe-142">A WinHTTP session should map to one and only one identity; that is, a WinHTTP session is used to manage the Internet activity of a single authenticated user, or a group of anonymous users.</span></span> <span data-ttu-id="b84fe-143">Tuttavia, poiché WinHTTP non impone automaticamente questo mapping, l'applicazione deve eseguire le operazioni necessarie per assicurarsi che sia presente una sola identità.</span><span class="sxs-lookup"><span data-stu-id="b84fe-143">However, because WinHTTP does not enforce this mapping automatically, your application must take steps to ensure that only a single identity is involved.</span></span>
-   <span data-ttu-id="b84fe-144">**Le operazioni su un handle di richiesta WinHTTP devono essere sincronizzate.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-144">**Operations on a WinHTTP request handle should be synchronized.**</span></span> <span data-ttu-id="b84fe-145">Ad esempio, un'applicazione deve evitare di chiudere un handle di richiesta su un thread mentre un altro thread invia o riceve una richiesta.</span><span class="sxs-lookup"><span data-stu-id="b84fe-145">For example, an application should avoid closing a request handle on one thread while another thread is sending or receiving a request.</span></span> <span data-ttu-id="b84fe-146">Per terminare una richiesta asincrona, chiudere l'handle di richiesta durante una notifica di callback.</span><span class="sxs-lookup"><span data-stu-id="b84fe-146">To terminate an asynchronous request, close the request handle during a callback notification.</span></span> <span data-ttu-id="b84fe-147">Per terminare una richiesta sincrona, chiudere l'handle quando viene restituita la chiamata WinHTTP precedente.</span><span class="sxs-lookup"><span data-stu-id="b84fe-147">To terminate a synchronous request, close the handle when the previous WinHTTP call returns.</span></span>
-   <span data-ttu-id="b84fe-148">**I file di traccia contengono informazioni riservate.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-148">**Trace files contain sensitive information.**</span></span> <span data-ttu-id="b84fe-149">I file di traccia sono protetti tramite elenchi di Access-Control (ACL), in modo che sia possibile accedervi solo dall'amministratore locale o dall'account utente che lo ha creato. Evitare di compromettere i file di traccia in base a qualsiasi accesso non autorizzato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-149">Trace files are protected using Access-Control Lists (ACLs) so that one can normally be accessed only by the local administrator or by the user account that created it.Avoid compromising trace files by any unauthorized access.</span></span>
-   <span data-ttu-id="b84fe-150">**Evitare di passare dati sensibili tramite** [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span><span class="sxs-lookup"><span data-stu-id="b84fe-150">**Avoid passing sensitive data through** [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).</span></span> <span data-ttu-id="b84fe-151">Non specificare un nome utente, una password o altre credenziali per **WinHttpSetOption** poiché non si ha alcun controllo sullo schema di autenticazione usato e i dati sensibili potrebbero essere inviati in modo imprevisto in testo non crittografato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-151">Do not supply a user name, password or any other credentials to **WinHttpSetOption** because you have no control over the authentication scheme that is used, and the sensitive data could unexpectedly be sent in clear text.</span></span> <span data-ttu-id="b84fe-152">Usare [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) e **WinHttpSetCredentials** anziché **WinHttpSetOption** per l'impostazione delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="b84fe-152">Use [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) and **WinHttpSetCredentials** instead of **WinHttpSetOption** for setting credentials.</span></span>
-   <span data-ttu-id="b84fe-153">**Il reindirizzamento automatico può rappresentare un rischio per la sicurezza.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-153">**Automatic redirection can pose a security risk.**</span></span> <span data-ttu-id="b84fe-154">Per impostazione predefinita, il reindirizzamento (un messaggio 302) viene seguito automaticamente anche per un POST.</span><span class="sxs-lookup"><span data-stu-id="b84fe-154">By default, redirection (a 302 message) is followed automatically even for a POST.</span></span> <span data-ttu-id="b84fe-155">Per evitare la possibilità di reindirizzamenti non corretti, le applicazioni devono disabilitare il reindirizzamento automatico o il monitoraggio di una nuova direzione nei callback quando si inviano informazioni riservate.</span><span class="sxs-lookup"><span data-stu-id="b84fe-155">To avoid the possibility of spurious redirects, applications should disable auto-redirect or monitor re-direction in callbacks when posting sensitive information.</span></span>
-   <span data-ttu-id="b84fe-156">**Le intestazioni definite dall'utente vengono trasferite senza modifiche nei reindirizzamenti.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-156">**User-defined headers are transferred across redirects unchanged.**</span></span> <span data-ttu-id="b84fe-157">Le intestazioni definite dall'utente, ad esempio i cookie aggiunti con **WinHTTPAddRequestHeaders**, vengono trasferite tra reindirizzamenti senza modifiche, mentre le intestazioni generate da WinHTTP vengono aggiornate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="b84fe-157">User-defined headers, such as cookies added with **WinHTTPAddRequestHeaders**, are transferred across redirects without modification, while headers generated by WinHTTP are automatically updated.</span></span> <span data-ttu-id="b84fe-158">Se il trasferimento di un'intestazione definita dall'utente tra reindirizzamenti costituisce un rischio per la sicurezza, usare il callback di [*\_ \_ callback dello stato WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) con il completamento del **\_ \_ \_ Reindirizzamento dello stato di callback WinHTTP** per modificare l'intestazione in questione ogni volta che si verifica un reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="b84fe-158">If transferring a user-defined header across redirects poses a security risk, use the [*WINHTTP\_STATUS\_CALLBACK*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) callback with the **WINHTTP\_CALLBACK\_STATUS\_REDIRECT** completion to modify the header in question whenever a redirect occurs.</span></span>
-   <span data-ttu-id="b84fe-159">**WinHTTP non è rientrante in modalità sincrona.**</span><span class="sxs-lookup"><span data-stu-id="b84fe-159">**WinHTTP is not reentrant in synchronous mode.**</span></span> <span data-ttu-id="b84fe-160">Poiché WinHTTP non è rientrante in modalità sincrona, non pianificare chiamate di procedure asincrone (APC) in grado di effettuare chiamate a WinHTTP in un thread dell'applicazione che viene eseguito all'interno di una funzione WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="b84fe-160">Because WinHTTP is not reentrant in synchronous mode, do not schedule asynchronous procedure calls (APC) that can call into WinHTTP on an application thread that executes inside a WinHTTP function.</span></span> <span data-ttu-id="b84fe-161">In modalità sincrona, WinHTTP esegue un'"attesa avviso" e se il thread in attesa è annullata per eseguire un APC e successivamente immette nuovamente WinHTTP, lo stato interno di WinHTTP può essere danneggiato.</span><span class="sxs-lookup"><span data-stu-id="b84fe-161">While in synchronous mode, WinHTTP performs an "alertable wait," and if the waiting thread is pre-empted to execute an APC and then later re-enters WinHTTP again, WinHTTP's internal state can be corrupted.</span></span>

 

 
