---
description: 'Le considerazioni sulla sicurezza seguenti si applicano alle applicazioni che usano WinHTTP: i certificati server vengono verificati una sola volta per sessione.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Considerazioni sulla sicurezza winHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b80d813fa5b50cb9c880598d3187c697412d1dab1d7fdd80b4507d17d03eff6a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "119955691"
---
# <a name="winhttp-security-considerations"></a>Considerazioni sulla sicurezza winHTTP

Le considerazioni sulla sicurezza seguenti si applicano alle applicazioni che usano WinHTTP:

-   **I certificati server vengono verificati una sola volta per sessione.** Dopo la verifica, un certificato rimane valido per la durata della sessione corrente. Finché l'impronta digitale del certificato corrisponde, che indica che il certificato non è stato modificato, il certificato continua a essere convalidato nuovamente. Di conseguenza, qualsiasi modifica dei criteri di convalida, tramite il protocollo, il controllo delle revoche o i flag certificate-error-ignore, non ha effetto dopo la verifica del certificato. Per forzare l'applicazione immediata di una modifica di questo tipo, è necessario interrotta la sessione corrente e avviarne una nuova. Analogamente, la scadenza di un certificato nel corso di una sessione può essere rilevata solo se l'applicazione stessa controlla periodicamente il server dei certificati per recuperare i dati di scadenza.
-   **Il proxy automatico comporta il download e l'esecuzione di script.** Il supporto automatico dell'individuazione proxy prevede il rilevamento tramite DHCP o DNS, il download e l'esecuzione di script proxy, ad esempio script Java. Per ottenere un livello di sicurezza superiore, un'applicazione deve evitare di passare il flag **WINHTTP \_ AUTOPROXY \_ RUN \_ INPROCESS,** in modo che l'individuazione del proxy automatico sia avviata out-of-process. Anche in questo caso, WinHTTP prova per impostazione predefinita a eseguire uno script proxy automatico in-process se lo script non viene eseguito correttamente out-of-process. Se si ritiene che questo comportamento di fallback rappresenti un rischio inaccettabile, disabilitare il comportamento di fallback con il flag **WINHTTP \_ AUTOPROXY \_ RUN \_ OUTPROCESS \_ ONLY.**
-   **Le funzioni CALLBACK DI STATO WINHTTP \_ \_ devono restituire prontamente.** Quando si scrive una di queste funzioni di callback, prestare attenzione a non bloccarsi. Ad esempio, né il callback né le funzioni chiamate devono visualizzare una finestra di dialogo utente o attendere un evento. Se una [*funzione CALLBACK DI WINHTTP \_ STATUS \_*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) si blocca, influisce sulla pianificazione interna di WinHTTP e fa sì che altre richieste all'interno dello stesso processo siano negate al servizio.
-   **Le funzioni CALLBACK DI STATO WINHTTP \_ \_ devono essere rientranti.** Quando si scrive un callback, evitare variabili statiche o altri costrutti non sicuri in caso di reentrance ed evitare di chiamare altre funzioni non rientranti.
-   **Se è possibile eseguire un'operazione asincrona, passare i valori NULL per i parametri OUT.** Se è stata abilitata l'operazione asincrona registrando una funzione di callback, passare sempre valori **NULL** per parametri OUT come *lpdwDataAvailable* per [**WinHttpQueryDataAvailable,**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) *lpdwBytesRead* per [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)o *lpdwBytesWritten* per [**WinHttpWriteData.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata) In alcuni casi, il thread chiamante viene terminato prima del completamento dell'operazione e, se i parametri OUT non sono **NULL,** la funzione può terminare la scrittura in memoria già liberata.
-   **L'autenticazione Passport non è infallibile.** Qualsiasi schema di autenticazione basato su cookie è vulnerabile agli attacchi. Passport versione 1.4 è basato su cookie e pertanto è soggetto alle vulnerabilità associate a qualsiasi cookie o schema di autenticazione basato su form. Il supporto passport è disabilitato per impostazione predefinita in WinHTTP. può essere abilitato usando [**WinHttpSetOption.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)
-   **L'autenticazione di base deve essere usata solo su una connessione protetta.** L'autenticazione di base, che invia il nome utente e la password in testo non crittografato (vedere [RFC 2617),](https://www.ietf.org/rfc/rfc2617.txt)deve essere usata solo su connessioni SSL o TLS crittografate.
-   **L'impostazione di Criteri di accesso automatico su "basso" può rappresentare un rischio.** Quando i criteri di accesso automatico sono impostati su basso, è possibile usare le credenziali di accesso di un utente per l'autenticazione in qualsiasi sito. Tuttavia, non è consigliabile eseguire l'autenticazione su siti non attendibili.
-   **Le connessioni SSL 2.0 non vengono usate a meno che non siano abilitate in modo esplicito.** I protocolli di sicurezza TLS 1.0 e SSL 3.0 sono considerati più sicuri rispetto a SSL 2.0. Per impostazione predefinita, WinHTTP richiede TLS 1.0 o SSL 3.0 quando negozia una connessione SSL, non SSL 2.0. Il supporto SSL 2.0 in WinHTTP può essere abilitato solo chiamando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **Il controllo delle revoche di certificati deve essere richiesto in modo esplicito.** Per impostazione predefinita, quando si esegue l'autenticazione del certificato, WinHTTP non verifica se il certificato del server è stato revocato. Il controllo delle revoche di certificati può essere abilitato [**usando WinHttpSetOption.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)
-   **Le applicazioni devono garantire che una sessione sia mappata a una singola identità.** Una sessione WinHTTP deve essere mappata a una sola identità. in altri, una sessione WinHTTP viene usata per gestire l'attività Internet di un singolo utente autenticato o di un gruppo di utenti anonimi. Tuttavia, poiché WinHTTP non applica automaticamente questo mapping, l'applicazione deve adottare misure per garantire che sia coinvolta una sola identità.
-   **Le operazioni su un handle di richiesta WinHTTP devono essere sincronizzate.** Ad esempio, un'applicazione deve evitare di chiudere un handle di richiesta in un thread mentre un altro thread sta inviando o ricevendo una richiesta. Per terminare una richiesta asincrona, chiudere l'handle della richiesta durante una notifica di callback. Per terminare una richiesta sincrona, chiudere l'handle quando viene restituita la chiamata WinHTTP precedente.
-   **I file di traccia contengono informazioni riservate.** I file di traccia vengono protetti tramite Access-Control elenchi di controllo di accesso (ACL) in modo che sia in genere accessibile solo all'amministratore locale o all'account utente che lo ha creato. Evitare di compromettere i file di traccia da qualsiasi accesso non autorizzato.
-   **Evitare di passare dati sensibili tramite** [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption). Non fornire un nome utente, una password o altre credenziali a **WinHttpSetOption** perché non si ha alcun controllo dello schema di autenticazione usato e i dati sensibili potrebbero essere inviati in modo imprevisto in testo non crittografato. Usare [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) e **WinHttpSetCredentials** anziché **WinHttpSetOption** per impostare le credenziali.
-   **Il reindirizzamento automatico può rappresentare un rischio per la sicurezza.** Per impostazione predefinita, il reindirizzamento (un messaggio 302) viene seguito automaticamente anche per un POST. Per evitare la possibilità di reindirizzamenti spuri, le applicazioni devono disabilitare il reindirizzamento automatico o monitorare la ridirezione nei callback quando pubblicano informazioni riservate.
-   **Le intestazioni definite dall'utente vengono trasferite tra reindirizzamenti senza modifiche.** Le intestazioni definite dall'utente, ad esempio i cookie aggiunti con **WinHTTPAddRequestHeaders,** vengono trasferite tra reindirizzamenti senza modifiche, mentre le intestazioni generate da WinHTTP vengono aggiornate automaticamente. Se il trasferimento di un'intestazione definita dall'utente tra reindirizzamenti rappresenta un rischio per la sicurezza, usare il callback CALLBACK DI STATO WINHTTP con il completamento DI REINDIRIZZAMENTO STATO CALLBACK **\_ \_ \_ WINHTTP** per modificare l'intestazione in questione ogni volta che si verifica un reindirizzamento. [*\_ \_*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback)
-   **WinHTTP non è rientrante in modalità sincrona.** Poiché WinHTTP non è rientrante in modalità sincrona, non pianificare chiamate di procedura asincrone (APC) che possono chiamare in WinHTTP in un thread dell'applicazione che viene eseguito all'interno di una funzione WinHTTP. In modalità sincrona, WinHTTP esegue un'"attesa avvisabile" e se il thread in attesa è pre-attivato per eseguire un APC e quindi in un secondo momento immette nuovamente WinHTTP, lo stato interno di WinHTTP può essere danneggiato.

 

 
