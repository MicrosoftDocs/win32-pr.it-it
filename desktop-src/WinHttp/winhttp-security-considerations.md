---
description: 'Le seguenti considerazioni sulla sicurezza si applicano alle applicazioni che utilizzano WinHTTP: i certificati server vengono verificati solo una volta per sessione.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Considerazioni sulla sicurezza di WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc06725ba03631eb4d5e5c29f8cfa0aae69b5022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484980"
---
# <a name="winhttp-security-considerations"></a>Considerazioni sulla sicurezza di WinHTTP

Le seguenti considerazioni sulla sicurezza si applicano alle applicazioni che utilizzano WinHTTP:

-   **I certificati del server vengono verificati solo una volta per sessione.** Dopo che un certificato è stato verificato, rimane valido per tutta la durata della sessione corrente. Fino a quando l'impronta digitale del certificato corrisponde, che indica che il certificato non è stato modificato, il certificato continua a essere riconvalidato. Di conseguenza, tutte le modifiche apportate ai criteri di convalida, tramite il protocollo, il controllo di revoca o i flag di errore del certificato, non diventano effettive dopo la verifica del certificato. Per rendere effettive le modifiche di questo tipo, la sessione corrente deve essere terminata e ne è stata avviata una nuova. Analogamente, la scadenza di un certificato durante il corso di una sessione può essere rilevata solo se l'applicazione stessa controlla periodicamente il server di certificati per recuperare i dati di scadenza.
-   **Il proxy automatico prevede il download e l'esecuzione di script.** Il supporto per l'individuazione automatica dei proxy comporta il rilevamento tramite DHCP o DNS, il download e l'esecuzione di script proxy come gli script Java. Per ottenere un livello di sicurezza superiore, un'applicazione deve evitare il passaggio del flag di esecuzione del PROXY automatico WinHTTP, in modo che l'individuazione del proxy automatico venga avviata out-of-process. **\_ \_ \_** Anche in questo caso, WinHTTP tenta per impostazione predefinita di eseguire uno script del proxy automatico in-process se lo script non viene eseguito correttamente out-of-process. Se si ritiene che questo comportamento di fallback rappresenti un rischio inaccettabile, disabilitare il comportamento di fallback con il flag di **\_ esecuzione del PROXY AutoProxy \_ \_ \_ solo WinHTTP** .
-   **Le \_ funzioni di callback dello stato WinHTTP \_ devono restituire tempestivamente.** Quando si scrive una di queste funzioni di callback, prestare attenzione che non si blocchi. Ad esempio, né il callback né la funzione che chiama devono visualizzare una finestra di dialogo utente o attendere un evento. Se una funzione di [*\_ \_ callback dello stato WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) si blocca, influiscono sulla pianificazione interna di WinHTTP e causa la negazione del servizio da parte di altre richieste all'interno dello stesso processo.
-   **Le \_ funzioni di callback dello stato WinHTTP \_ devono essere rientranti.** Quando si scrive un callback, evitare le variabili statiche o altri costrutti che non sono sicuri in reingresso ed evitare di chiamare altre funzioni che non sono rientranti.
-   **Se l'operazione asincrona è possibile, passare i valori NULL per i parametri OUT.** Se è stata abilitata l'operazione asincrona registrando una funzione di callback, passare sempre i valori **null** per tali parametri come *lpdwDataAvailable* per [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable), *lpdwBytesRead* per [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)o *lpdwBytesWritten* per [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata). In alcune circostanze, il thread chiamante viene terminato prima del completamento dell'operazione e se i parametri OUT non sono **null**, la funzione può terminare con la scrittura in memoria che è già stata liberata.
-   **L'autenticazione Passport non è infallibile.** Qualsiasi schema di autenticazione basato su cookie è vulnerabile agli attacchi. Passport versione 1,4 è basato su cookie e pertanto è soggetto alle vulnerabilità associate ad alcun cookie o schema di autenticazione basata su form. Il supporto Passport è disabilitato per impostazione predefinita in WinHTTP; può essere abilitata usando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **L'autenticazione di base deve essere usata solo su una connessione protetta.** L'autenticazione di base, che invia il nome utente e la password in testo non crittografato (vedere [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt)), deve essere utilizzata solo per le connessioni SSL o TLS crittografate.
-   **L'impostazione dei criteri di accesso automatico su "low" può rappresentare un rischio.** Quando i criteri di accesso automatico sono impostati su bassa, è possibile usare le credenziali di accesso di un utente per eseguire l'autenticazione in qualsiasi sito. Tuttavia, non è consigliabile eseguire l'autenticazione nei siti non attendibili.
-   **Le connessioni SSL 2,0 non vengono usate se non sono abilitate in modo esplicito.** I protocolli di sicurezza TLS 1,0 e SSL 3,0 sono considerati più sicuri rispetto a SSL 2,0. Per impostazione predefinita, WinHTTP richiede TLS 1,0 o SSL 3,0 quando si negozia una connessione SSL e non SSL 2,0. Il supporto SSL 2,0 in WinHTTP può essere abilitato solo chiamando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **Certificato: è necessario richiedere esplicitamente il controllo della revoca.** Per impostazione predefinita, quando si esegue l'autenticazione del certificato, WinHTTP non controlla se il certificato del server è stato revocato. Certificato: la verifica delle revoche può essere abilitata usando [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **Le applicazioni devono garantire che una sessione venga mappata a una singola identità.** Una sessione WinHTTP deve eseguire il mapping a una sola identità. ovvero una sessione WinHTTP viene utilizzata per gestire l'attività Internet di un singolo utente autenticato o un gruppo di utenti anonimi. Tuttavia, poiché WinHTTP non impone automaticamente questo mapping, l'applicazione deve eseguire le operazioni necessarie per assicurarsi che sia presente una sola identità.
-   **Le operazioni su un handle di richiesta WinHTTP devono essere sincronizzate.** Ad esempio, un'applicazione deve evitare di chiudere un handle di richiesta su un thread mentre un altro thread invia o riceve una richiesta. Per terminare una richiesta asincrona, chiudere l'handle di richiesta durante una notifica di callback. Per terminare una richiesta sincrona, chiudere l'handle quando viene restituita la chiamata WinHTTP precedente.
-   **I file di traccia contengono informazioni riservate.** I file di traccia sono protetti tramite elenchi di Access-Control (ACL), in modo che sia possibile accedervi solo dall'amministratore locale o dall'account utente che lo ha creato. Evitare di compromettere i file di traccia in base a qualsiasi accesso non autorizzato.
-   **Evitare di passare dati sensibili tramite** [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption). Non specificare un nome utente, una password o altre credenziali per **WinHttpSetOption** poiché non si ha alcun controllo sullo schema di autenticazione usato e i dati sensibili potrebbero essere inviati in modo imprevisto in testo non crittografato. Usare [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) e **WinHttpSetCredentials** anziché **WinHttpSetOption** per l'impostazione delle credenziali.
-   **Il reindirizzamento automatico può rappresentare un rischio per la sicurezza.** Per impostazione predefinita, il reindirizzamento (un messaggio 302) viene seguito automaticamente anche per un POST. Per evitare la possibilità di reindirizzamenti non corretti, le applicazioni devono disabilitare il reindirizzamento automatico o il monitoraggio di una nuova direzione nei callback quando si inviano informazioni riservate.
-   **Le intestazioni definite dall'utente vengono trasferite senza modifiche nei reindirizzamenti.** Le intestazioni definite dall'utente, ad esempio i cookie aggiunti con **WinHTTPAddRequestHeaders**, vengono trasferite tra reindirizzamenti senza modifiche, mentre le intestazioni generate da WinHTTP vengono aggiornate automaticamente. Se il trasferimento di un'intestazione definita dall'utente tra reindirizzamenti costituisce un rischio per la sicurezza, usare il callback di [*\_ \_ callback dello stato WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) con il completamento del **\_ \_ \_ Reindirizzamento dello stato di callback WinHTTP** per modificare l'intestazione in questione ogni volta che si verifica un reindirizzamento.
-   **WinHTTP non è rientrante in modalità sincrona.** Poiché WinHTTP non è rientrante in modalità sincrona, non pianificare chiamate di procedure asincrone (APC) in grado di effettuare chiamate a WinHTTP in un thread dell'applicazione che viene eseguito all'interno di una funzione WinHTTP. In modalità sincrona, WinHTTP esegue un'"attesa avviso" e se il thread in attesa è annullata per eseguire un APC e successivamente immette nuovamente WinHTTP, lo stato interno di WinHTTP può essere danneggiato.

 

 
