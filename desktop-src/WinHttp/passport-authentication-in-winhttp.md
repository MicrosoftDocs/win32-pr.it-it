---
description: I servizi HTTP di Microsoft Windows (WinHTTP) supportano completamente l'utilizzo da parte del client del protocollo di autenticazione Microsoft Passport. In questo argomento viene fornita una panoramica delle transazioni relative all'autenticazione Passport e alla relativa modalità di gestione.
ms.assetid: 395d7aef-4da0-4664-8328-7d31ce58fedd
title: Autenticazione Passport in WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b8fc00217c7c14fbd4635fab68398d2056c1ea5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484181"
---
# <a name="passport-authentication-in-winhttp"></a><span data-ttu-id="8b307-104">Autenticazione Passport in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="8b307-104">Passport Authentication in WinHTTP</span></span>

<span data-ttu-id="8b307-105">I servizi HTTP di Microsoft Windows (WinHTTP) supportano completamente l'utilizzo da parte del client del protocollo di autenticazione Microsoft Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-105">Microsoft Windows HTTP Services (WinHTTP) fully support the client side use of the Microsoft Passport authentication protocol.</span></span> <span data-ttu-id="8b307-106">In questo argomento viene fornita una panoramica delle transazioni relative all'autenticazione Passport e alla relativa modalità di gestione.</span><span class="sxs-lookup"><span data-stu-id="8b307-106">This topic provides an overview of the transactions involved in Passport authentication and how to handle them.</span></span>

> [!Note]  
> <span data-ttu-id="8b307-107">In WinHTTP 5,1, Passport Authentication è disabilitato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="8b307-107">In WinHTTP 5.1, Passport authentication is disabled by default.</span></span>

 

## <a name="passport-14"></a><span data-ttu-id="8b307-108">Passport 1,4</span><span class="sxs-lookup"><span data-stu-id="8b307-108">Passport 1.4</span></span>

<span data-ttu-id="8b307-109">Passport è un componente di base del Microsoft .NET servizi di blocco predefinito.</span><span class="sxs-lookup"><span data-stu-id="8b307-109">Passport is a core component of the Microsoft .NET building block services.</span></span> <span data-ttu-id="8b307-110">Consente alle aziende di sviluppare e offrire servizi Web distribuiti in un'ampia gamma di applicazioni e consente ai suoi membri di usare un nome di accesso e una password in tutti i siti Web partecipanti.</span><span class="sxs-lookup"><span data-stu-id="8b307-110">It enables businesses to develop and offer distributed Web services across a wide range of applications and enables its members to use one sign-in name and password at all participating Web sites.</span></span>

<span data-ttu-id="8b307-111">WinHTTP fornisce supporto della piattaforma per Microsoft Passport 1,4 implementando il protocollo sul lato client per l'autenticazione Passport 1,4.</span><span class="sxs-lookup"><span data-stu-id="8b307-111">WinHTTP provides platform support for Microsoft Passport 1.4 by implementing the client-side protocol for Passport 1.4 authentication.</span></span> <span data-ttu-id="8b307-112">Consente di liberare le applicazioni dai dettagli sull'interazione con l'infrastruttura Passport e i nomi utente e le password archiviati in Windows XP.</span><span class="sxs-lookup"><span data-stu-id="8b307-112">It frees applications from the details of interacting with the Passport infrastructure and the Stored User Names and Passwords in Windows XP.</span></span> <span data-ttu-id="8b307-113">Questa astrazione rende l'uso di Passport non diverso dal punto di vista dello sviluppatore rispetto all'uso di schemi di autenticazione tradizionali come Basic o digest.</span><span class="sxs-lookup"><span data-stu-id="8b307-113">This abstraction makes using Passport no different from a developer's perspective than using traditional authentication schemes like Basic or Digest.</span></span>

<span data-ttu-id="8b307-114">**Windows XP:** La chiave del registro di sistema **HKCU \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings \\ Passport \\ NumRegistrationRuns** identifica il numero di volte in cui viene visualizzata la procedura guidata autenticazione Passport quando è richiesta l'autenticazione Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-114">**Windows XP:** The **HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Passport\\NumRegistrationRuns** registry key identifies the number of times the Passport Authentication Wizard is displayed when PassPort authentication is required.</span></span> <span data-ttu-id="8b307-115">Se il valore di questa chiave è impostato su un numero maggiore di 5, la procedura guidata non viene visualizzata.</span><span class="sxs-lookup"><span data-stu-id="8b307-115">If the value for this key is set to a number greater than 5, the wizard is not displayed.</span></span>

<span data-ttu-id="8b307-116">Nelle sezioni seguenti vengono descritte le transazioni relative all'autenticazione Passport dal punto di vista di un'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="8b307-116">The following sections describe the transactions involved in Passport authentication from the point of view of a client application.</span></span> <span data-ttu-id="8b307-117">Per lo sviluppo di Passport sul lato server, vedere Cenni preliminari sulla documentazione di Passport SDK.</span><span class="sxs-lookup"><span data-stu-id="8b307-117">For server-side Passport development, see the Passport SDK Documentation Overview.</span></span>

-   [<span data-ttu-id="8b307-118">Richiesta iniziale</span><span class="sxs-lookup"><span data-stu-id="8b307-118">Initial Request</span></span>](#initial-request)
-   [<span data-ttu-id="8b307-119">Server di accesso Passport</span><span class="sxs-lookup"><span data-stu-id="8b307-119">Passport Login Server</span></span>](#passport-login-server)
-   [<span data-ttu-id="8b307-120">Richiesta autenticata</span><span class="sxs-lookup"><span data-stu-id="8b307-120">Authenticated Request</span></span>](#authenticated-request)

### <a name="initial-request"></a><span data-ttu-id="8b307-121">Richiesta iniziale</span><span class="sxs-lookup"><span data-stu-id="8b307-121">Initial Request</span></span>

<span data-ttu-id="8b307-122">Quando un client richiede una risorsa in un server che richiede l'autenticazione Passport, il server controlla la richiesta di presenza di [*ticket*](glossary.md).</span><span class="sxs-lookup"><span data-stu-id="8b307-122">When a client requests a resource on a server that requires Passport authentication, the server checks the request for the presence of [*tickets*](glossary.md).</span></span> <span data-ttu-id="8b307-123">Se viene inviato un *ticket* valido con la richiesta, il server risponde con la risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="8b307-123">If a valid *ticket* is sent with the request, the server responds with the requested resource.</span></span> <span data-ttu-id="8b307-124">Se il *ticket* non esiste nel client, il server risponde con un codice di stato 302.</span><span class="sxs-lookup"><span data-stu-id="8b307-124">If the *ticket* does not exist on the client, the server responds with a 302 status code.</span></span> <span data-ttu-id="8b307-125">La risposta include l'intestazione della richiesta "WWW-Authenticate: Passport 1.4".</span><span class="sxs-lookup"><span data-stu-id="8b307-125">The response includes the challenge header, "WWW-Authenticate: Passport1.4".</span></span> <span data-ttu-id="8b307-126">I client che non usano Passport possono seguire il reindirizzamento al server di accesso Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-126">Clients that are not using Passport can follow the redirection to the Passport login server.</span></span> <span data-ttu-id="8b307-127">I client più avanzati in genere contattano Passport Nexus per determinare la posizione del server di accesso Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-127">More advanced clients typically contact the Passport nexus to determine the location of the Passport login server.</span></span>

> [!Note]  
> <span data-ttu-id="8b307-128">La rete centrale per la Microsoft Passport è Passport *Nexus*, che facilita la sincronizzazione dei siti dei partecipanti al passaporto, per garantire che ogni sito disponga dei dettagli più recenti sulla configurazione di rete e altri problemi.</span><span class="sxs-lookup"><span data-stu-id="8b307-128">Central to the Microsoft Passport network is the Passport *Nexus*, which facilitates synchronization of Passport participant sites to assure that each site has the latest details on network configuration and other issues.</span></span> <span data-ttu-id="8b307-129">Ogni componente Passport (gestione Passport, server di accesso, server di aggiornamento e così via) comunica periodicamente con il Nexus per recuperare le informazioni necessarie per individuare e comunicare correttamente con gli altri componenti nella rete Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-129">Each Passport component (Passport Manager, Login servers, Update servers, and so on) periodically communicates with the Nexus to retrieve the information it needs to locate, and properly communicate with, the other components in the Passport network.</span></span> <span data-ttu-id="8b307-130">Queste informazioni vengono recuperate come documento XML denominato documento di configurazione del componente o CCD.</span><span class="sxs-lookup"><span data-stu-id="8b307-130">This information is retrieved as an XML document called a Component Configuration Document, or CCD.</span></span>

 

<span data-ttu-id="8b307-131">Nell'immagine seguente viene illustrata la richiesta iniziale a un affiliato Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-131">The following image shows the initial request to a Passport affiliate.</span></span>

![Image Mostra la richiesta iniziale a un affiliato Passport.](images/art-passport1.png)

### <a name="passport-login-server"></a><span data-ttu-id="8b307-133">Server di accesso Passport</span><span class="sxs-lookup"><span data-stu-id="8b307-133">Passport Login Server</span></span>

<span data-ttu-id="8b307-134">Un server di accesso Passport gestisce tutte le richieste di [*ticket*](glossary.md) per qualsiasi risorsa in un' *autorità di dominio* Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-134">A Passport login server handles all requests for [*tickets*](glossary.md) for any resource in a Passport *domain authority*.</span></span> <span data-ttu-id="8b307-135">Prima di poter autenticare una richiesta tramite Passport, l'applicazione client deve contattare il server di accesso per ottenere i *ticket* appropriati.</span><span class="sxs-lookup"><span data-stu-id="8b307-135">Before a request can be authenticated using Passport, the client application must contact the login server to obtain the appropriate *tickets*.</span></span>

<span data-ttu-id="8b307-136">Quando un client richiede [*ticket*](glossary.md) da un server di accesso Passport, il server di accesso risponde in genere con un codice di stato 401 per indicare che è necessario fornire le credenziali utente.</span><span class="sxs-lookup"><span data-stu-id="8b307-136">When a client requests [*tickets*](glossary.md) from a Passport login server, the login server typically responds with a 401 status code to indicate that user credentials must be provided.</span></span> <span data-ttu-id="8b307-137">Quando vengono fornite queste credenziali, il server di accesso risponde con i *ticket* necessari per accedere alla risorsa specificata nel server che contiene la risorsa originariamente richiesta.</span><span class="sxs-lookup"><span data-stu-id="8b307-137">When these credentials are provided, the login server responds with the *tickets* required to access the specified resource on the server that contains the originally requested resource.</span></span> <span data-ttu-id="8b307-138">Il server di accesso può anche reindirizzare il client a un altro server che può fornire la risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="8b307-138">The login server can also redirect the client to another server that can provide the requested resource.</span></span>

![Image Mostra una richiesta di ticket client a un server di accesso Passport.](images/art-passport2.png)

### <a name="authenticated-request"></a><span data-ttu-id="8b307-140">Richiesta autenticata</span><span class="sxs-lookup"><span data-stu-id="8b307-140">Authenticated Request</span></span>

<span data-ttu-id="8b307-141">Quando il client dispone di [*ticket*](glossary.md) che corrispondono a un determinato server, i *ticket* sono inclusi in tutte le richieste al server.</span><span class="sxs-lookup"><span data-stu-id="8b307-141">When the client has the [*tickets*](glossary.md) that correspond to a given server, those *tickets* are included with all requests to that server.</span></span> <span data-ttu-id="8b307-142">Se i *ticket* non sono stati modificati dopo che sono stati recuperati dal server di accesso Passport e i *ticket* sono validi per il server di risorse, il server delle risorse invia una risposta che include sia la risorsa richiesta che i cookie che indicano che l'utente è autenticato per richieste future.</span><span class="sxs-lookup"><span data-stu-id="8b307-142">If the *tickets* have not been modified since they were retrieved from the Passport login server, and the *tickets* are valid for the resource server, the resource server sends a response that includes both the requested resource and cookies that indicate that the user is authenticated for future requests.</span></span>

<span data-ttu-id="8b307-143">I cookie aggiuntivi nella risposta hanno lo scopo di velocizzare il processo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-143">The additional cookies in the response are intended to speed the authentication process.</span></span> <span data-ttu-id="8b307-144">Le richieste aggiuntive nella stessa sessione per le risorse nei server della stessa autorità di dominio Passport includono tutte questi cookie aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="8b307-144">Additional requests in the same session for resources on servers in the same Passport Domain Authority all include these additional cookies.</span></span> <span data-ttu-id="8b307-145">Non è necessario che le credenziali vengano inviate nuovamente al server di accesso fino alla scadenza dei cookie.</span><span class="sxs-lookup"><span data-stu-id="8b307-145">Credentials do not need to be sent to the login server again until the cookies expire.</span></span>

![Image Mostra una richiesta autenticata al server di accesso Passport.](images/art-passport3.png)

## <a name="using-passport-in-winhttp"></a><span data-ttu-id="8b307-147">Uso di Passport in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="8b307-147">Using Passport in WinHTTP</span></span>

<span data-ttu-id="8b307-148">L'autenticazione Passport in WinHTTP è molto simile ad altri schemi di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-148">Passport authentication in WinHTTP is very similar to other authentication schemes.</span></span> <span data-ttu-id="8b307-149">Per una panoramica dell'autenticazione in WinHTTP, vedere [autenticazione in WinHTTP](authentication-in-winhttp.md) .</span><span class="sxs-lookup"><span data-stu-id="8b307-149">See [Authentication in WinHTTP](authentication-in-winhttp.md) for an overview of authentication in WinHTTP.</span></span>

<span data-ttu-id="8b307-150">In WinHTTP 5,1, l'autenticazione Passport è disabilitata per impostazione predefinita e deve essere abilitata in modo esplicito con [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) prima dell'uso.</span><span class="sxs-lookup"><span data-stu-id="8b307-150">In WinHTTP 5.1, Passport authentication is disabled by default and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

<span data-ttu-id="8b307-151">WinHTTP gestisce molti dettagli della transazione internamente per l'autenticazione Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-151">WinHTTP handles many of the transaction details internally for Passport authentication.</span></span> <span data-ttu-id="8b307-152">Durante la richiesta iniziale, il server risponde con un codice di stato 302 quando è necessaria l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-152">During the initial request, the server responds with a 302 status code when authentication is necessary.</span></span> <span data-ttu-id="8b307-153">Il codice di stato 302 indica effettivamente un reindirizzamento ed è parte del protocollo Passport per la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="8b307-153">The 302 status code actually indicates a redirection and is part of the Passport protocol for backwards compatibility.</span></span> <span data-ttu-id="8b307-154">WinHTTP nasconde il codice di stato 302 e Contatta Passport Nexus, quindi il server di accesso.</span><span class="sxs-lookup"><span data-stu-id="8b307-154">WinHTTP hides the 302 status code and contacts the Passport nexus, and then the login server.</span></span> <span data-ttu-id="8b307-155">L'applicazione WinHTTP riceve una notifica del codice di stato 401 inviato dal server di accesso per richiedere le credenziali utente.</span><span class="sxs-lookup"><span data-stu-id="8b307-155">The WinHTTP application is notified of the 401 status code sent by the login server to request user credentials.</span></span> <span data-ttu-id="8b307-156">Per l'applicazione, tuttavia, viene visualizzato come se lo stato 401 proviene dal server da cui è stata richiesta la risorsa.</span><span class="sxs-lookup"><span data-stu-id="8b307-156">To the application, however, it appears as if the 401 status originates from the server from which the resource was requested.</span></span> <span data-ttu-id="8b307-157">In questo modo, l'applicazione WinHTTP non è a conoscenza delle interazioni con altri server e può gestire l'autenticazione Passport con lo stesso codice che gestisce altri schemi di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-157">In this way, the WinHTTP application is unaware of interactions with other servers, and it can handle Passport authentication with the same code that handles other authentication schemes.</span></span>

<span data-ttu-id="8b307-158">In genere, un'applicazione WinHTTP risponde a un codice di stato 401 fornendo le credenziali di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-158">Typically, a WinHTTP application responds to a 401 status code by supplying authentication credentials.</span></span> <span data-ttu-id="8b307-159">Quando vengono fornite le credenziali [](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) con WinHttpSetCredentials [**o le credenziali per**](iwinhttprequest-setcredentials.md) l'autenticazione Passport, le credenziali vengono effettivamente inviate al server di accesso, non al server indicato nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="8b307-159">When credentials are supplied with [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) or [**SetCredentials**](iwinhttprequest-setcredentials.md) for passport authentication, the credentials are actually being sent to the login server, not to the server indicated in the request.</span></span>

<span data-ttu-id="8b307-160">Tuttavia, quando si risponde a un codice di stato 407, un'applicazione WinHTTP deve usare [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) per fornire le credenziali proxy, anziché [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials).</span><span class="sxs-lookup"><span data-stu-id="8b307-160">However, when responding to a 407 status code, a WinHTTP application must use [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) to provide proxy credentials, rather than [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials).</span></span> <span data-ttu-id="8b307-161">Poiché **WinHttpSetOption** è un modo meno sicuro per fornire le credenziali, in genere dovrebbe essere evitato.</span><span class="sxs-lookup"><span data-stu-id="8b307-161">Because **WinHttpSetOption** is a less secure way to supply credentials, it should normally be avoided.</span></span>

<span data-ttu-id="8b307-162">Una volta recuperati, [*i ticket*](glossary.md) vengono gestiti internamente e vengono inviati automaticamente ai server applicabili nelle richieste future.</span><span class="sxs-lookup"><span data-stu-id="8b307-162">Once retrieved, [*tickets*](glossary.md) are managed internally and are automatically sent to applicable servers in future requests.</span></span>

> [!Note]  
> <span data-ttu-id="8b307-163">WinHTTP consente di disabilitare il reindirizzamento automatico chiamando la funzione [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) per l' [**opzione WinHTTP Disabilita il flag di \_ \_ \_ funzionalità**](option-flags.md) e SPECIFICAndo il valore [**WinHTTP \_ Disable \_ reindirizzas**](option-flags.md).</span><span class="sxs-lookup"><span data-stu-id="8b307-163">WinHTTP enables you to disable automatic redirection by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function for the [**WINHTTP\_OPTION\_DISABLE\_FEATURE**](option-flags.md) flag and specifying a value of [**WINHTTP\_DISABLE\_REDIRECTS**](option-flags.md).</span></span> <span data-ttu-id="8b307-164">La disabilitazione del reindirizzamento non interferisce con il reindirizzamento che WinHTTP gestisce internamente per le transazioni Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-164">Disabling redirection does not interfere with the redirection that WinHTTP handles internally for Passport transactions.</span></span>

 

<span data-ttu-id="8b307-165">WinHTTP può completare correttamente l'autenticazione Passport anche se un'applicazione Disabilita il reindirizzamento automatico.</span><span class="sxs-lookup"><span data-stu-id="8b307-165">WinHTTP can successfully complete the Passport authentication even if an application disables auto redirection.</span></span> <span data-ttu-id="8b307-166">Tuttavia, al termine dell'autenticazione Passport, un reindirizzamento implicito deve ricorrere dall'URL del server di accesso Passport all'URL originale.</span><span class="sxs-lookup"><span data-stu-id="8b307-166">However, after the Passport authentication is complete, an implicit redirect must occur from the Passport login server URL back to the original URL.</span></span> <span data-ttu-id="8b307-167">Questo reindirizzamento non viene attivato da una risposta HTTP 302, ma è implicito nel protocollo Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-167">This redirect is not triggered by a 302 HTTP response, but is implicit in the Passport protocol.</span></span>

<span data-ttu-id="8b307-168">WinHTTP gestisce questo reindirizzamento implicito in modo specifico.</span><span class="sxs-lookup"><span data-stu-id="8b307-168">WinHTTP handles this implicit redirect specially.</span></span> <span data-ttu-id="8b307-169">Se un'applicazione ha disabilitato il reindirizzamento automatico, WinHTTP richiede che l'applicazione conferisca l'autorizzazione "WinHTTP" per il reindirizzamento automatico in questo caso speciale.</span><span class="sxs-lookup"><span data-stu-id="8b307-169">If an application has disabled automatic redirection, WinHTTP requires that the application give WinHTTP "permission" to redirect automatically in this special case.</span></span>

<span data-ttu-id="8b307-170">Per fare in modo che WinHTTP ritorni all'URL originale dopo l'autenticazione, l'applicazione deve registrare una funzione di callback usando [**WinHttpSetStatusCallback**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback).</span><span class="sxs-lookup"><span data-stu-id="8b307-170">In order to have WinHTTP redirect back to the original URL after authentication, the application must register a callback function using [**WinHttpSetStatusCallback**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback).</span></span> <span data-ttu-id="8b307-171">WinHTTP può quindi inviare una notifica all'applicazione con \_ un \_ callback di reindirizzamento dello stato di callback WinHTTP \_ , che consente all'applicazione di annullare il reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="8b307-171">WinHTTP can then notify the application with a WINHTTP\_CALLBACK\_STATUS\_REDIRECT callback, which allows the application to cancel the redirect.</span></span> <span data-ttu-id="8b307-172">Non è necessario che un'applicazione fornisca alcuna funzionalità nella funzione di callback. la registrazione del callback è sufficiente per consentire a WinHTTP di seguire questo reindirizzamento speciale.</span><span class="sxs-lookup"><span data-stu-id="8b307-172">An application does not need to provide any functionality in the callback function; registration of the callback is sufficient to enable WinHTTP to follow this special-case redirect.</span></span>

<span data-ttu-id="8b307-173">Il \_ \_ \_ messaggio di errore di accesso WinHTTP di errore viene generato se una funzione di callback non è impostata dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-173">The ERROR\_WINHTTP\_LOGIN\_FAILURE message is generated if a callback function is not set by the application.</span></span>

### <a name="passport-cobranding"></a><span data-ttu-id="8b307-174">Personalizzazione del passaporto</span><span class="sxs-lookup"><span data-stu-id="8b307-174">Passport Cobranding</span></span>

<span data-ttu-id="8b307-175">A differenza degli schemi di autenticazione tradizionali supportati da WinHTTP, Passport può essere esteso a una [*nuova personalizzazione*](glossary.md).</span><span class="sxs-lookup"><span data-stu-id="8b307-175">Unlike traditional authentication schemes supported by WinHTTP, Passport can be extensively [*cobranded*](glossary.md).</span></span> <span data-ttu-id="8b307-176">Quando si riceve un codice di stato 401 che indica una richiesta di verifica, un'applicazione può recuperare l'immagine e il testo del *marchio* .</span><span class="sxs-lookup"><span data-stu-id="8b307-176">Upon receiving a 401 status code that indicates a challenge, an application can retrieve the *cobranding* graphic and text.</span></span> <span data-ttu-id="8b307-177">Recuperare un URL per l'immagine di *cobranding* chiamando [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) con il \_ \_ \_ flag URL di personalizzazione dell'opzione WinHTTP \_ .</span><span class="sxs-lookup"><span data-stu-id="8b307-177">Retrieve a URL for the *cobranding* graphic by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_URL flag.</span></span> <span data-ttu-id="8b307-178">Recuperare il testo di *cobranding* chiamando [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) con il flag del testo per l' \_ opzione WinHTTP \_ Passport \_ cobranding \_ .</span><span class="sxs-lookup"><span data-stu-id="8b307-178">Retrieve the *cobranding* text by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_TEXT flag.</span></span> <span data-ttu-id="8b307-179">Questi elementi possono essere utilizzati per personalizzare una finestra di dialogo di raccolta delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="8b307-179">These items can be used to customize a credential-gathering dialog.</span></span>

### <a name="stored-user-names-and-passwords"></a><span data-ttu-id="8b307-180">Gestione nomi utente e password archiviati</span><span class="sxs-lookup"><span data-stu-id="8b307-180">Stored User Names and Passwords</span></span>

<span data-ttu-id="8b307-181">In Windows XP è stato introdotto il concetto di nomi utente e password archiviati.</span><span class="sxs-lookup"><span data-stu-id="8b307-181">Windows XP introduced the concept of Stored User Names and Passwords.</span></span> <span data-ttu-id="8b307-182">Se le credenziali Passport di un utente vengono salvate tramite la **registrazione guidata Passport** o la **finestra di dialogo credenziali** standard, vengono salvate in nomi utente e password archiviati.</span><span class="sxs-lookup"><span data-stu-id="8b307-182">If a user's Passport credentials are saved through the **Passport Registration Wizard** or the standard **Credential Dialog**, it is saved in the Stored User Names and Passwords.</span></span> <span data-ttu-id="8b307-183">Quando si usa WinHTTP in Windows XP o versioni successive, WinHTTP usa automaticamente le credenziali nei nomi utente e nelle password archiviati se le credenziali non sono impostate in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8b307-183">When using WinHTTP on Windows XP or later, WinHTTP automatically uses the credentials in the Stored User Names and Passwords if credentials are not explicitly set.</span></span> <span data-ttu-id="8b307-184">Questa operazione è simile a quella del supporto per le credenziali di accesso predefinite per NTLM/Kerberos.</span><span class="sxs-lookup"><span data-stu-id="8b307-184">This is similar to the support of default logon credentials for NTLM/Kerberos.</span></span> <span data-ttu-id="8b307-185">Tuttavia, l'utilizzo delle credenziali Passport predefinite non è soggetto alle impostazioni dei criteri di accesso automatico.</span><span class="sxs-lookup"><span data-stu-id="8b307-185">However, use of default Passport credentials is not subject to the automatic logon policy settings.</span></span>

### <a name="disabling-passport-authentication"></a><span data-ttu-id="8b307-186">Disabilitazione dell'autenticazione Passport</span><span class="sxs-lookup"><span data-stu-id="8b307-186">Disabling Passport Authentication</span></span>

<span data-ttu-id="8b307-187">Alcune applicazioni potrebbero richiedere la possibilità di disabilitare l'autenticazione Passport.</span><span class="sxs-lookup"><span data-stu-id="8b307-187">Some applications might require the ability to disable Passport authentication.</span></span> <span data-ttu-id="8b307-188">Ad esempio, quando un affiliato Passport risponde con il codice di stato iniziale 302, potrebbe essere preferibile seguire il reindirizzamento indicato ed eseguire il rendering della pagina di autenticazione HTML Passport anziché consentire a WinHTTP di gestire l'autenticazione internamente.</span><span class="sxs-lookup"><span data-stu-id="8b307-188">For example, when a Passport affiliate responds with the initial 302 status code, it might be preferable to follow the indicated redirection and render the HTML Passport authentication page rather than allowing WinHTTP to handle the authentication internally.</span></span> <span data-ttu-id="8b307-189">L'autenticazione Passport è disabilitata in WinHTTP chiamando la funzione [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) con l' \_ opzione WinHTTP \_ Configure \_ Passport \_ AUTH e passando il valore WinHTTP \_ Disable \_ Passport \_ auth.</span><span class="sxs-lookup"><span data-stu-id="8b307-189">Passport authentication is disabled in WinHTTP by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function with the WINHTTP\_OPTION\_CONFIGURE\_PASSPORT\_AUTH option and passing the value WINHTTP\_DISABLE\_PASSPORT\_AUTH.</span></span> <span data-ttu-id="8b307-190">Può essere riabilitata in un secondo momento con WINHTTP \_ enable \_ Passport \_ auth.</span><span class="sxs-lookup"><span data-stu-id="8b307-190">It can later be re-enabled with WINHTTP\_ENABLE\_PASSPORT\_AUTH.</span></span>

<span data-ttu-id="8b307-191">Non è possibile disabilitare l'autenticazione Passport quando si usa l'oggetto [**WinHttpRequest**](winhttprequest.md) .</span><span class="sxs-lookup"><span data-stu-id="8b307-191">Passport authentication cannot be disabled when using the [**WinHttpRequest**](winhttprequest.md) object.</span></span>

<span data-ttu-id="8b307-192">Come indicato in precedenza in questa sezione, l'autenticazione Passport è disabilitata per impostazione predefinita in WinHTTP 5,1 e deve essere abilitata in modo esplicito con [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) prima dell'uso.</span><span class="sxs-lookup"><span data-stu-id="8b307-192">As noted earlier in this section, Passport authentication is disabled by default in WinHTTP 5.1, and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

## <a name="passport-configuration-overrides-used-for-testing"></a><span data-ttu-id="8b307-193">Override della configurazione Passport usati per il test</span><span class="sxs-lookup"><span data-stu-id="8b307-193">Passport Configuration Overrides Used for Testing</span></span>

<span data-ttu-id="8b307-194">WinHTTP si basa sulle informazioni di configurazione scaricate dal server Passport Nexus per supportare l'autenticazione Passport 1,4.</span><span class="sxs-lookup"><span data-stu-id="8b307-194">WinHTTP relies on the configuration information it downloads from the passport nexus server to support Passport 1.4 authentication.</span></span> <span data-ttu-id="8b307-195">Per impostazione predefinita, questo server protetto (SSL) è nexus.passport.com e la risorsa di configurazione è rdr/pprdr. asp, nota come configurazione Passport "Live".</span><span class="sxs-lookup"><span data-stu-id="8b307-195">By default this secure (SSL) server is nexus.passport.com, and the configuration resource is rdr/pprdr.asp, which is known as the "live" passport configuration.</span></span> <span data-ttu-id="8b307-196">Il formato delle informazioni è costituito da un'intestazione HTTP personalizzata "PassportURLs", seguita da coppie attributo-valore delimitate da virgole.</span><span class="sxs-lookup"><span data-stu-id="8b307-196">The format of the information is a custom HTTP header "PassportURLs", followed by comma delimited attribute-value pairs.</span></span>

<span data-ttu-id="8b307-197">"", Ad esempio, https://nexus.passport.com/rdr/pprdr.asp restituisce le informazioni di configurazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="8b307-197">For example, "https://nexus.passport.com/rdr/pprdr.asp" returns the following configuration information:</span></span>

``` syntax
PassportURLs: DARealm=Passport.net,
DALogin=login.passport.com/login2.asp,
DAReg=https://register.passport.com/defaultwiz.asp,
Properties=https://memberservices.passport.com/ppsecure/MSRV_EditProfile.asp,
Privacy=https://www.passport.com/consumer/privacypolicy.asp,
GeneralRedir=https://nexusrdr.passport.com/redir.asp,
Help=https://memberservices.passport.com/UI/MSRV_UI_Help.asp,
ConfigVersion=2
\r\n
```

<span data-ttu-id="8b307-198">Le parti rilevanti per WinHTTP sono DARealm, DALogin e ConfigVersion.</span><span class="sxs-lookup"><span data-stu-id="8b307-198">The parts that are relevant to WinHTTP are DARealm, DALogin, and ConfigVersion.</span></span> <span data-ttu-id="8b307-199">Per motivi di prestazioni, vengono memorizzati nella cache per la durata di una sessione WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="8b307-199">For performance reasons, they are cached for the lifetime of a WinHTTP session.</span></span> <span data-ttu-id="8b307-200">Questi tre valori possono essere sostituiti dalle applicazioni necessarie per lavorare con un'altra infrastruttura Passport diversa dalla configurazione di produzione "attiva" modificando le impostazioni del registro di sistema appropriate in</span><span class="sxs-lookup"><span data-stu-id="8b307-200">These three values can be overridden by applications that are required to work with another passport infrastructure other than the "live" production setup by changing the appropriate registry settings under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
LoginServerRealm (REG_SZ)    For example: abc.net
LoginServerUrl (REG_SZ)      For example: https://private-login.passport.com/login2.asp
ConfigVersion (REG_DWORD)    For example: 10
```

<span data-ttu-id="8b307-201">Se LoginServerUrl è presente nel registro di sistema, WinHTTP non contatta il server Nexus per altri valori di configurazione.</span><span class="sxs-lookup"><span data-stu-id="8b307-201">If LoginServerUrl is present in the registry, WinHTTP does not contact the nexus server for other configuration values.</span></span> <span data-ttu-id="8b307-202">In questo caso, è necessario impostare anche LoginServerRealm e ConfigVersion tramite il registro di sistema per correggere i valori.</span><span class="sxs-lookup"><span data-stu-id="8b307-202">In this case, LoginServerRealm and ConfigVersion should also be set through the registry to correct values.</span></span>

<span data-ttu-id="8b307-203">Un'applicazione può, a scopo di test, essere necessaria per scaricare la configurazione Passport da un server Nexus privato.</span><span class="sxs-lookup"><span data-stu-id="8b307-203">An application may, for testing purposes, be required to download passport configuration from a private nexus server.</span></span> <span data-ttu-id="8b307-204">Questa operazione può essere eseguita eseguendo l'override di due valori del registro di sistema in</span><span class="sxs-lookup"><span data-stu-id="8b307-204">This can be done by overriding two registry values under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
NexusHost (REG_SZ)    e.g. private-nexus.passport.com
NexusObj(REG_SZ)      e.g. config/passport.asp
```

## <a name="related-topics"></a><span data-ttu-id="8b307-205">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8b307-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8b307-206">Autenticazione in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="8b307-206">Authentication in WinHTTP</span></span>](authentication-in-winhttp.md)
</dt> </dl>

 

 



