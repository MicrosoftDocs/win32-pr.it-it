---
description: I servizi HTTP di Microsoft Windows (WinHTTP) utilizzano gli handle per tenere traccia delle impostazioni e delle informazioni necessarie quando si utilizza il protocollo HTTP.
ms.assetid: 0bd82860-1347-40c8-ae77-c4d865c109be
title: Handle HINTERNET in WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf374675ad6f2114dd48e0a3ff1db50cd0dd7f9c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104551704"
---
# <a name="hinternet-handles-in-winhttp"></a><span data-ttu-id="ed968-103">Handle HINTERNET in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="ed968-103">HINTERNET Handles in WinHTTP</span></span>

<span data-ttu-id="ed968-104">I servizi HTTP di Microsoft Windows (WinHTTP) utilizzano gli handle per tenere traccia delle impostazioni e delle informazioni necessarie quando si utilizza il protocollo HTTP.</span><span class="sxs-lookup"><span data-stu-id="ed968-104">Microsoft Windows HTTP Services (WinHTTP) uses handles to keep track of settings and information required when using the HTTP protocol.</span></span> <span data-ttu-id="ed968-105">Ogni handle mantiene le informazioni pertinenti a una sessione HTTP, una connessione a un server HTTP o una risorsa specifica.</span><span class="sxs-lookup"><span data-stu-id="ed968-105">Each handle maintains information pertinent to an HTTP session, a connection with an HTTP server, or a specific resource.</span></span> <span data-ttu-id="ed968-106">In questo argomento vengono descritti i vari tipi di handle, le convenzioni di denominazione per questi handle e la relativa struttura gerarchica.</span><span class="sxs-lookup"><span data-stu-id="ed968-106">This topic describes the various types of handles, the naming conventions for these handles, and their hierarchical structure.</span></span>

-   [<span data-ttu-id="ed968-107">Informazioni sugli handle HINTERNET</span><span class="sxs-lookup"><span data-stu-id="ed968-107">About HINTERNET Handles</span></span>](#about-hinternet-handles)
-   [<span data-ttu-id="ed968-108">Nomi degli handle</span><span class="sxs-lookup"><span data-stu-id="ed968-108">Naming Handles</span></span>](#naming-handles)
-   [<span data-ttu-id="ed968-109">Gestisci gerarchia</span><span class="sxs-lookup"><span data-stu-id="ed968-109">Handle Hierarchy</span></span>](#handle-hierarchy)
-   [<span data-ttu-id="ed968-110">Spiegazione della gerarchia di handle</span><span class="sxs-lookup"><span data-stu-id="ed968-110">Explanation of the Handle Hierarchy</span></span>](#explanation-of-the-handle-hierarchy)

## <a name="about-hinternet-handles"></a><span data-ttu-id="ed968-111">Informazioni sugli handle HINTERNET</span><span class="sxs-lookup"><span data-stu-id="ed968-111">About HINTERNET Handles</span></span>

<span data-ttu-id="ed968-112">Gli handle creati e usati da WinHTTP sono detti handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-112">The handles that are created and used by WinHTTP are called **HINTERNET** handles.</span></span> <span data-ttu-id="ed968-113">Le funzioni WinHTTP restituiscono handle **HINTERNET** che non sono intercambiabili con altri handle, quindi non possono essere usate con funzioni come [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) o [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle).</span><span class="sxs-lookup"><span data-stu-id="ed968-113">The WinHTTP functions return **HINTERNET** handles that are not interchangeable with other handles, so they cannot be used with functions such as [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) or [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle).</span></span> <span data-ttu-id="ed968-114">Analogamente, non è possibile usare altri handle con funzioni WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="ed968-114">Similarly, other handles cannot be used with WinHTTP functions.</span></span> <span data-ttu-id="ed968-115">Un handle restituito da [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , ad esempio, non può essere passato a [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span><span class="sxs-lookup"><span data-stu-id="ed968-115">For example, a handle returned by [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) cannot be passed to [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span></span> <span data-ttu-id="ed968-116">Non è possibile chiudere questi handle **HINTERNET** mentre è in corso una chiamata API che usa l'handle.</span><span class="sxs-lookup"><span data-stu-id="ed968-116">These **HINTERNET** handles cannot be closed while an API call using the handle is in progress.</span></span> <span data-ttu-id="ed968-117">Per evitare un race condition, le applicazioni devono proteggere l'handle e impedirne la chiusura fino a quando è in corso la chiamata all'API.</span><span class="sxs-lookup"><span data-stu-id="ed968-117">To avoid a race condition, applications should protect the handle and prevent it from being closed for as long as the API call is in progress.</span></span>

<span data-ttu-id="ed968-118">Anche le funzioni Microsoft Win32 Internet (WinInet) utilizzano handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-118">Microsoft Win32 Internet (WinInet) functions also use **HINTERNET** handles.</span></span> <span data-ttu-id="ed968-119">Tuttavia, gli handle utilizzati nelle funzioni WinInet non possono essere scambiati con gli handle utilizzati nelle funzioni WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="ed968-119">However, the handles used in WinInet functions cannot be interchanged with the handles used in WinHTTP functions.</span></span> <span data-ttu-id="ed968-120">Per ulteriori informazioni su WinInet, vedere [informazioni su WinInet](/windows/desktop/WinInet/about-wininet).</span><span class="sxs-lookup"><span data-stu-id="ed968-120">For more information about WinInet, see [About WinINet](/windows/desktop/WinInet/about-wininet).</span></span>

<span data-ttu-id="ed968-121">La funzione [**WinHttpCloseHandle**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpclosehandle) chiude gli handle **HINTERNET** di WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="ed968-121">The [**WinHttpCloseHandle**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpclosehandle) function closes WinHTTP **HINTERNET** handles.</span></span>

## <a name="naming-handles"></a><span data-ttu-id="ed968-122">Nomi degli handle</span><span class="sxs-lookup"><span data-stu-id="ed968-122">Naming Handles</span></span>

<span data-ttu-id="ed968-123">Nella documentazione di WinHTTP, le descrizioni delle funzioni nel Application Programming Interface (API) e nel codice di esempio illustrano la creazione e l'uso di diversi tipi di handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-123">Throughout the WinHTTP documentation, descriptions of functions in the application programming interface (API) and sample code show the creation and use of various types of **HINTERNET** handles.</span></span> <span data-ttu-id="ed968-124">Per tenere traccia dei diversi tipi di handle disponibili, la denominazione di questi handle è coerente.</span><span class="sxs-lookup"><span data-stu-id="ed968-124">To keep track of the different types of handles available, the naming of these handles is consistent.</span></span> <span data-ttu-id="ed968-125">Nella tabella seguente vengono illustrati gli identificatori utilizzati dalla convenzione nella documentazione.</span><span class="sxs-lookup"><span data-stu-id="ed968-125">The following table shows the identifiers used by convention in the documentation.</span></span>



| <span data-ttu-id="ed968-126">Tipo di handle</span><span class="sxs-lookup"><span data-stu-id="ed968-126">Handle type</span></span>       | <span data-ttu-id="ed968-127">Handle creazione funzione</span><span class="sxs-lookup"><span data-stu-id="ed968-127">Function creating handle</span></span>                                                                                                          | <span data-ttu-id="ed968-128">Identificatore</span><span class="sxs-lookup"><span data-stu-id="ed968-128">Identifier</span></span> |
|-------------------|-----------------------------------------------------------------------------------------------------------------------------------|------------|
| <span data-ttu-id="ed968-129">Handle generico</span><span class="sxs-lookup"><span data-stu-id="ed968-129">Generic handle</span></span>    | <span data-ttu-id="ed968-130">[**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen), [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect)o [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)</span><span class="sxs-lookup"><span data-stu-id="ed968-130">[**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen), [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect), or [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)</span></span> | <span data-ttu-id="ed968-131">hInternet</span><span class="sxs-lookup"><span data-stu-id="ed968-131">hInternet</span></span>  |
| <span data-ttu-id="ed968-132">Handle di sessione</span><span class="sxs-lookup"><span data-stu-id="ed968-132">Session handle</span></span>    | [<span data-ttu-id="ed968-133">**WinHttpOpen**</span><span class="sxs-lookup"><span data-stu-id="ed968-133">**WinHttpOpen**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen)                                                                                                | <span data-ttu-id="ed968-134">hSession</span><span class="sxs-lookup"><span data-stu-id="ed968-134">hSession</span></span>   |
| <span data-ttu-id="ed968-135">Handle di connessione</span><span class="sxs-lookup"><span data-stu-id="ed968-135">Connection handle</span></span> | [<span data-ttu-id="ed968-136">**WinHttpConnect**</span><span class="sxs-lookup"><span data-stu-id="ed968-136">**WinHttpConnect**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect)                                                                                          | <span data-ttu-id="ed968-137">hConnect</span><span class="sxs-lookup"><span data-stu-id="ed968-137">hConnect</span></span>   |
| <span data-ttu-id="ed968-138">Handle di richiesta</span><span class="sxs-lookup"><span data-stu-id="ed968-138">Request handle</span></span>    | [<span data-ttu-id="ed968-139">**WinHttpOpenRequest**</span><span class="sxs-lookup"><span data-stu-id="ed968-139">**WinHttpOpenRequest**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)                                                                                  | <span data-ttu-id="ed968-140">hRequest</span><span class="sxs-lookup"><span data-stu-id="ed968-140">hRequest</span></span>   |



 

## <a name="handle-hierarchy"></a><span data-ttu-id="ed968-141">Gestisci gerarchia</span><span class="sxs-lookup"><span data-stu-id="ed968-141">Handle Hierarchy</span></span>

<span data-ttu-id="ed968-142">Gli handle **HINTERNET** vengono mantenuti in una gerarchia.</span><span class="sxs-lookup"><span data-stu-id="ed968-142">The **HINTERNET** handles are maintained in a hierarchy.</span></span> <span data-ttu-id="ed968-143">L'handle restituito da [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) è l'handle **HINTERNET** della sessione.</span><span class="sxs-lookup"><span data-stu-id="ed968-143">The handle returned by [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) is the session **HINTERNET** handle.</span></span> <span data-ttu-id="ed968-144">La chiamata a **WinHttpOpen** Inizializza le funzioni WinHTTP e avvia un contesto di sessione che mantiene le informazioni e le impostazioni dell'utente per tutta la durata dell'handle di sessione.</span><span class="sxs-lookup"><span data-stu-id="ed968-144">Calling **WinHttpOpen** initializes the WinHTTP functions and begins a session context that maintains user information and settings throughout the life of the session handle.</span></span> <span data-ttu-id="ed968-145">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) specifica un server http o HTTPS di destinazione e crea un handle **HINTERNET** di connessione.</span><span class="sxs-lookup"><span data-stu-id="ed968-145">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) specifies a target HTTP or HTTPS server and creates a connection **HINTERNET** handle.</span></span> <span data-ttu-id="ed968-146">Per impostazione predefinita, l'handle di connessione eredita le impostazioni per l'handle di sessione.</span><span class="sxs-lookup"><span data-stu-id="ed968-146">By default, the connection handle inherits the settings for the session handle.</span></span> <span data-ttu-id="ed968-147">A ogni risorsa specificata con una chiamata a [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest) viene assegnato un handle **HINTERNET** della richiesta.</span><span class="sxs-lookup"><span data-stu-id="ed968-147">Each resource specified with a call to [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest) is assigned a request **HINTERNET** handle.</span></span>

<span data-ttu-id="ed968-148">Nel diagramma seguente viene illustrata la gerarchia di handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-148">The following diagram illustrates the hierarchy of **HINTERNET** handles.</span></span> <span data-ttu-id="ed968-149">Ogni casella del diagramma rappresenta una funzione WinHTTP che restituisce un handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-149">Each box in the diagram represents a WinHTTP function that returns an **HINTERNET** handle.</span></span>

![funzioni che creano handle](images/art-winhttp2.png)

<span data-ttu-id="ed968-151">Dopo la chiusura di un handle, l'applicazione deve essere preparata a ricevere notifiche di callback sull'handle fino a quando non viene restituito il valore chiuso dell'handle di callback WinHTTP finale per indicare che l'handle è **\_ \_ stato \_ \_** completamente chiuso.</span><span class="sxs-lookup"><span data-stu-id="ed968-151">After closing a handle, the application must be prepared to receive callback notifications on the handle until the final **WINHTTP\_CALLBACK\_STATUS\_HANDLE\_CLOSED** value is returned to indicate that the handle is completely closed.</span></span>

<span data-ttu-id="ed968-152">Un handle di sessione viene definito l'elemento padre di qualsiasi handle di connessione usato per creare; Analogamente, sia l'handle di connessione che il relativo handle della sessione padre sono elementi padre di qualsiasi handle di richiesta che l'handle di connessione viene utilizzato per creare.</span><span class="sxs-lookup"><span data-stu-id="ed968-152">A session handle is termed the parent of any connection handle it used to create; likewise, both the connection handle and its parent session handle are termed parents of any request handle that the connection handle is used to create.</span></span>

<span data-ttu-id="ed968-153">Quando un handle padre viene chiuso, tutti gli elementi figlio in essa inclusi vengono invalidati indirettamente anche se non vengono chiusi e le successive richieste che li utilizzano hanno esito negativo e l'errore non è **\_ valido \_**.</span><span class="sxs-lookup"><span data-stu-id="ed968-153">When a parent handle is closed, any children it has are indirectly invalidated even if not closed themselves, and subsequent requests using them fail with the error **ERROR\_INVALID\_HANDLE**.</span></span> <span data-ttu-id="ed968-154">Non è possibile fare affidamento sulle richieste asincrone in sospeso per il corretto completamento.</span><span class="sxs-lookup"><span data-stu-id="ed968-154">Pending asynchronous requests cannot be relied on to complete correctly.</span></span>

<span data-ttu-id="ed968-155">Il diagramma seguente illustra le funzioni che usano l'handle **HINTERNET** creato da [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest).</span><span class="sxs-lookup"><span data-stu-id="ed968-155">The following diagram shows the functions that use the **HINTERNET** handle created by [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest).</span></span> <span data-ttu-id="ed968-156">Le caselle ombreggiate rappresentano le funzioni WinHTTP che creano handle e le caselle semplici mostrano le funzioni che utilizzano tali handle **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="ed968-156">The shaded boxes represent WinHTTP functions that create handles, and the plain boxes show the functions that use those **HINTERNET** handles.</span></span> <span data-ttu-id="ed968-157">Il diagramma è organizzato anche per indicare l'ordine in cui le funzioni WinHTTP sono normalmente chiamate.</span><span class="sxs-lookup"><span data-stu-id="ed968-157">The diagram is also organized to show the order in which WinHTTP functions are normally called.</span></span>

![funzioni che creano handle](images/art-winhttp2.png)

## <a name="explanation-of-the-handle-hierarchy"></a><span data-ttu-id="ed968-159">Spiegazione della gerarchia di handle</span><span class="sxs-lookup"><span data-stu-id="ed968-159">Explanation of the Handle Hierarchy</span></span>

<span data-ttu-id="ed968-160">Viene innanzitutto creato un handle di sessione con [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen).</span><span class="sxs-lookup"><span data-stu-id="ed968-160">First, a session handle is created with [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen).</span></span> <span data-ttu-id="ed968-161">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) richiede l'handle di sessione come primo parametro e restituisce un handle di connessione per un server specificato.</span><span class="sxs-lookup"><span data-stu-id="ed968-161">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) requires the session handle as its first parameter and returns a connection handle for a specified server.</span></span> <span data-ttu-id="ed968-162">Un handle di richiesta viene creato da [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest), che usa l'handle di connessione creato da [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect).</span><span class="sxs-lookup"><span data-stu-id="ed968-162">A request handle is created by [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest), which uses the connection handle created by [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect).</span></span> <span data-ttu-id="ed968-163">Se l'applicazione sceglie di aggiungere ulteriori intestazioni alla richiesta o se è necessario che l'applicazione imposti le credenziali per l'autenticazione, è possibile chiamare [**WinHttpAddRequestHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpaddrequestheaders) e [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) utilizzando questo handle di richiesta.</span><span class="sxs-lookup"><span data-stu-id="ed968-163">If the application chooses to add additional headers to the request, or if is it necessary for the application to set credentials for authentication, [**WinHttpAddRequestHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpaddrequestheaders) and [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) can be called using this request handle.</span></span> <span data-ttu-id="ed968-164">La richiesta viene inviata da [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest), che usa l'handle della richiesta.</span><span class="sxs-lookup"><span data-stu-id="ed968-164">The request is sent by [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest), which uses the request handle.</span></span> <span data-ttu-id="ed968-165">Dopo l'invio della richiesta, i dati aggiuntivi possono essere inviati al server tramite [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata)o l'applicazione può passare direttamente a [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) per specificare che al server non vengono inviate altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="ed968-165">After sending the request, additional data can be sent to the server using [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), or the application can skip directly to [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) to specify that no more information is sent to the server.</span></span> <span data-ttu-id="ed968-166">A questo punto, a seconda dello scopo dell'applicazione, l'handle della richiesta può essere usato per chiamare [**WinHttpQueryHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryheaders), [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes)o recuperare una risorsa con [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) e [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span><span class="sxs-lookup"><span data-stu-id="ed968-166">At this point, depending on the purpose of the application, the request handle can be used to call [**WinHttpQueryHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryheaders), [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes), or retrieve a resource with [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) and [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span></span>

 

 
