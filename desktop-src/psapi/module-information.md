---
title: Informazioni sul modulo
description: Un modulo è un file eseguibile o una DLL.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399132"
---
# <a name="module-information"></a><span data-ttu-id="1be7f-103">Informazioni sul modulo</span><span class="sxs-lookup"><span data-stu-id="1be7f-103">Module Information</span></span>

<span data-ttu-id="1be7f-104">Un *modulo* è un file eseguibile o una dll.</span><span class="sxs-lookup"><span data-stu-id="1be7f-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="1be7f-105">Ogni processo è costituito da uno o più moduli.</span><span class="sxs-lookup"><span data-stu-id="1be7f-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="1be7f-106">È possibile recuperare l'elenco di handle di modulo per un processo chiamando la funzione [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) .</span><span class="sxs-lookup"><span data-stu-id="1be7f-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="1be7f-107">Questa funzione riempie una matrice di valori **hmodule** con gli handle del modulo per il processo specificato.</span><span class="sxs-lookup"><span data-stu-id="1be7f-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="1be7f-108">Il primo modulo è il file eseguibile.</span><span class="sxs-lookup"><span data-stu-id="1be7f-108">The first module is the executable file.</span></span> <span data-ttu-id="1be7f-109">Tenere presente che questi handle di modulo sono molto probabilmente da un altro processo, pertanto non è possibile utilizzarli con funzioni come [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span><span class="sxs-lookup"><span data-stu-id="1be7f-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="1be7f-110">Tuttavia, è possibile usare le [funzioni PSAPI](psapi-functions.md) per ottenere informazioni su un modulo da un altro processo.</span><span class="sxs-lookup"><span data-stu-id="1be7f-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="1be7f-111">Nella procedura seguente viene descritto come ottenere informazioni sui moduli da un altro processo.</span><span class="sxs-lookup"><span data-stu-id="1be7f-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="1be7f-112">**Per ottenere informazioni sui moduli da un altro processo**</span><span class="sxs-lookup"><span data-stu-id="1be7f-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="1be7f-113">Chiamare la funzione [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) .</span><span class="sxs-lookup"><span data-stu-id="1be7f-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="1be7f-114">Questa funzione accetta un handle di processo e un handle del modulo come input e compila un buffer con il nome di base di un modulo, ad esempio Kernel32.dll.</span><span class="sxs-lookup"><span data-stu-id="1be7f-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="1be7f-115">Una funzione correlata, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), accetta gli stessi parametri di input, ma restituisce il percorso completo del modulo (ad esempio, C: \\ Windows \\ system32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="1be7f-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="1be7f-116">Chiamare la funzione [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) .</span><span class="sxs-lookup"><span data-stu-id="1be7f-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="1be7f-117">Questa funzione accetta un handle di processo e un handle di modulo e riempie una struttura [**ModuleInfo**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) con l'indirizzo di carico del modulo, la dimensione dello spazio degli indirizzi lineare occupata e un puntatore al relativo punto di ingresso.</span><span class="sxs-lookup"><span data-stu-id="1be7f-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="1be7f-118">Se un'applicazione richiede informazioni sul modulo per il processo corrente, deve usare la funzione [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) anziché le funzioni del modulo PSAPI.</span><span class="sxs-lookup"><span data-stu-id="1be7f-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="1be7f-119">Questo consente di migliorare le prestazioni delle applicazioni in due modi: la funzione **GetModuleFileName** è più efficiente delle funzioni del modulo PSAPI e un'applicazione può evitare il caricamento psapi.dll se non usa funzioni PSAPI.</span><span class="sxs-lookup"><span data-stu-id="1be7f-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="1be7f-120">Le funzioni [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) e [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) sono progettate principalmente per l'uso da parte di debugger e applicazioni simili che devono estrarre informazioni sui moduli da un altro processo.</span><span class="sxs-lookup"><span data-stu-id="1be7f-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="1be7f-121">Se l'elenco dei moduli nel processo di destinazione è danneggiato o non è stato ancora inizializzato o se l'elenco dei moduli cambia durante la chiamata di funzione in seguito al caricamento o allo scaricamento delle dll, queste funzioni potrebbero non riuscire o restituire informazioni non corrette.</span><span class="sxs-lookup"><span data-stu-id="1be7f-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 