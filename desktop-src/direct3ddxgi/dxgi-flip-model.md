---
description: In Windows 8 è stato aggiunto il supporto per il modello Flip Presentation e le statistiche presenti associate in DXGI 1,2.
ms.assetid: E132DAF5-80B7-4C52-A760-3779CC140CE7
title: Modello DXGI Flip
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49ee82febd13a3b57a06d93fd01eb8d230d6b78a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "103876633"
---
# <a name="dxgi-flip-model"></a><span data-ttu-id="4e4f7-103">Modello DXGI Flip</span><span class="sxs-lookup"><span data-stu-id="4e4f7-103">DXGI flip model</span></span>

<span data-ttu-id="4e4f7-104">In Windows 8 è stato aggiunto il supporto per il modello Flip Presentation e le statistiche presenti associate in DXGI 1,2.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-104">Windows 8 adds support for flip presentation model and its associated present statistics in DXGI 1.2.</span></span> <span data-ttu-id="4e4f7-105">Il modello DXGI Flip Presentation di Windows 8 è simile alla presentazione di Windows 7 [Direct3D 9Ex Flip Mode](../direct3darticles/direct3d-9ex-improvements.md).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-105">Windows 8’s DXGI flip presentation model is similar to Windows 7’s [Direct3D 9EX Flip Mode Presentation](../direct3darticles/direct3d-9ex-improvements.md).</span></span> <span data-ttu-id="4e4f7-106">Le app di presentazione basate sulla frequenza dei video o dei frame, ad esempio i giochi, possono trarre vantaggio dalla maggior parte usando il modello Flip Presentation.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-106">Video or frame rate-based presentation apps such as games can benefit most by using flip presentation model.</span></span> <span data-ttu-id="4e4f7-107">Le app che usano il modello DXGI Flip Presentation riducono il carico delle risorse di sistema e aumentano le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-107">Apps that use DXGI flip presentation model reduce the system resource load and increase performance.</span></span> <span data-ttu-id="4e4f7-108">Le app possono anche usare i miglioramenti attuali delle statistiche con il modello Flip Presentation per controllare meglio la frequenza di presentazione fornendo i meccanismi di correzione e feedback in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-108">Apps can also use present statistics enhancements with flip presentation model to better control the rate of presentation by providing real-time feedback and correction mechanisms.</span></span>

-   [<span data-ttu-id="4e4f7-109">Confronto tra il modello DXGI Flip e il modello BitBlt</span><span class="sxs-lookup"><span data-stu-id="4e4f7-109">Comparing the DXGI flip model and the BitBlt model</span></span>](#comparing-the-dxgi-flip-model-and-the-bitblt-model)
-   [<span data-ttu-id="4e4f7-110">Come usare DXGI flip model</span><span class="sxs-lookup"><span data-stu-id="4e4f7-110">How to use DXGI flip model</span></span>](#how-to-use-dxgi-flip-model)
-   [<span data-ttu-id="4e4f7-111">Sincronizzazione dei frame delle app DXGI flip model</span><span class="sxs-lookup"><span data-stu-id="4e4f7-111">Frame synchronization of DXGI flip model apps</span></span>](#frame-synchronization-of-dxgi-flip-model-apps)
-   [<span data-ttu-id="4e4f7-112">Prevenzione, rilevamento e ripristino da problemi</span><span class="sxs-lookup"><span data-stu-id="4e4f7-112">Avoiding, detecting, and recovering from glitches</span></span>](#avoiding-detecting-and-recovering-from-glitches)
-   [<span data-ttu-id="4e4f7-113">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="4e4f7-113">Related topics</span></span>](#related-topics)

## <a name="comparing-the-dxgi-flip-model-and-the-bitblt-model"></a><span data-ttu-id="4e4f7-114">Confronto tra il modello DXGI Flip e il modello BitBlt</span><span class="sxs-lookup"><span data-stu-id="4e4f7-114">Comparing the DXGI flip model and the BitBlt model</span></span>

<span data-ttu-id="4e4f7-115">Il runtime usa i modelli di trasferimento a blocchi di bit (BitBlt) e flip Presentation per presentare contenuti grafici nei monitor di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-115">The runtime uses the bit-block transfer (bitblt) and flip presentation models to present graphics content on display monitors.</span></span> <span data-ttu-id="4e4f7-116">La differenza principale tra i modelli BitBlt e flip Presentation è il modo in cui il contenuto del buffer di back-buffer arriva a Windows 8 DWM per la composizione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-116">The biggest difference between bitblt and flip presentation models is how back-buffer contents get to the Windows 8 DWM for composition.</span></span> <span data-ttu-id="4e4f7-117">Nel modello BitBlt, il contenuto del buffer nascosto viene copiato nell'area di reindirizzamento a ogni chiamata a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-117">In the bitblt model, contents of the back buffer are copied into the redirection surface on each call to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="4e4f7-118">Nel modello flip tutti i buffer back sono condivisi con la Gestione finestre desktop (DWM).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-118">In the flip model, all back buffers are shared with the Desktop Window Manager (DWM).</span></span> <span data-ttu-id="4e4f7-119">Di conseguenza, DWM può comporre direttamente da questi buffer di back senza altre operazioni di copia.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-119">Therefore, the DWM can compose straight from those back buffers without any additional copy operations.</span></span> <span data-ttu-id="4e4f7-120">In generale, il modello Flip è più efficiente.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-120">In general, the flip model is more efficient.</span></span> <span data-ttu-id="4e4f7-121">Il modello Flip fornisce anche altre funzionalità, ad esempio le statistiche attuali avanzate.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-121">The flip model also provides more features, such as enhanced present statistics.</span></span>

<span data-ttu-id="4e4f7-122">Se si dispone di componenti legacy che utilizzano Windows Graphics Device Interface (GDI) per scrivere direttamente in un [**HWND**](../winprog/windows-data-types.md) , utilizzare il modello BitBlt.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-122">If you have legacy components that use Windows Graphics Device Interface (GDI) to write to an [**HWND**](../winprog/windows-data-types.md) directly, use the bitblt model.</span></span>

<span data-ttu-id="4e4f7-123">I miglioramenti delle prestazioni del modello DXGI flip sono significativi quando l'app è in modalità finestra.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-123">Performance improvements of DXGI flip model are significant when the app is in windowed mode.</span></span> <span data-ttu-id="4e4f7-124">La sequenza in questa tabella e l'illustrazione confrontano gli utilizzi della larghezza di banda della memoria e le letture del sistema e le scritture delle app finestra che scelgono Capovolgi modello rispetto al modello BitBlt.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-124">The sequence in this table and the illustration compare memory bandwidth usages and system reads and writes of windowed apps that choose flip model versus the bitblt model.</span></span>



| <span data-ttu-id="4e4f7-125">Passaggio</span><span class="sxs-lookup"><span data-stu-id="4e4f7-125">Step</span></span> | <span data-ttu-id="4e4f7-126">Modello BitBlt presente in DWM</span><span class="sxs-lookup"><span data-stu-id="4e4f7-126">BitBlt model present to DWM</span></span>                                                                               | <span data-ttu-id="4e4f7-127">Modello DXGI Flip presente in DWM</span><span class="sxs-lookup"><span data-stu-id="4e4f7-127">DXGI flip model present to DWM</span></span>                                   |
|------|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="4e4f7-128">1.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-128">1.</span></span>   | <span data-ttu-id="4e4f7-129">L'app Aggiorna il frame (scrittura)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-129">The app updates its frame (Write)</span></span><br/>                                                              | <span data-ttu-id="4e4f7-130">L'app Aggiorna il frame (scrittura)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-130">The app updates its frame (Write)</span></span><br/>                     |
| <span data-ttu-id="4e4f7-131">2.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-131">2.</span></span>   | <span data-ttu-id="4e4f7-132">Il runtime Direct3D copia il contenuto della superficie in una superficie di reindirizzamento di DWM (lettura, scrittura)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-132">Direct3D runtime copies surface contents to a DWM redirection surface (Read, Write)</span></span><br/>            | <span data-ttu-id="4e4f7-133">Il runtime Direct3D passa l'area dell'app a DWM</span><span class="sxs-lookup"><span data-stu-id="4e4f7-133">Direct3D runtime passes the app surface to DWM</span></span><br/>        |
| <span data-ttu-id="4e4f7-134">3.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-134">3.</span></span>   | <span data-ttu-id="4e4f7-135">Al termine della copia della superficie condivisa, DWM esegue il rendering dell'area dell'app sullo schermo (lettura, scrittura)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-135">After the shared surface copy completes, DWM renders the app surface onto screen (Read, Write)</span></span><br/> | <span data-ttu-id="4e4f7-136">DWM esegue il rendering dell'area dell'app sullo schermo (lettura, scrittura)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-136">DWM renders the app surface onto screen (Read, Write)</span></span><br/> |



 

![illustrazione di un confronto tra il modello BLT e il modello Flip](images/blt-flip-mode-present.png)

<span data-ttu-id="4e4f7-138">Il modello Flip riduce l'utilizzo della memoria di sistema riducendo il numero di letture e scritture da parte del runtime Direct3D per la composizione del frame finestra di DWM.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-138">Flip model reduces system memory usage by reducing the number of reads and writes by the Direct3D runtime for the windowed frame composition by DWM.</span></span>

## <a name="how-to-use-dxgi-flip-model"></a><span data-ttu-id="4e4f7-139">Come usare DXGI flip model</span><span class="sxs-lookup"><span data-stu-id="4e4f7-139">How to use DXGI flip model</span></span>

<span data-ttu-id="4e4f7-140">Per le app Direct3D 11,1 destinate a Windows 8 viene usato Capovolgi modello creando la catena di scambio con il valore di enumerazione [**\_ \_ \_ \_ sequenziale di DXGI swap effect Flip**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) impostato nel membro **SwapEffect** della struttura [**DXGI della catena di \_ scambio \_ \_ DESC1**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) .</span><span class="sxs-lookup"><span data-stu-id="4e4f7-140">Direct3D 11.1 apps that target Windows 8 use flip model by creating the swap chain with the [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) enumeration value set in the **SwapEffect** member of the [**DXGI\_SWAP\_CHAIN\_DESC1**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) structure.</span></span> <span data-ttu-id="4e4f7-141">Quando si imposta **SwapEffect** su **DXGI \_ swap \_ Effect \_ Flip \_ sequenziale**, impostare anche questi membri **della \_ catena di scambio DXGI \_ \_ DESC1** sui valori indicati:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-141">When you set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, also set these members of **DXGI\_SWAP\_CHAIN\_DESC1** to the indicated values:</span></span>

-   <span data-ttu-id="4e4f7-142">**BufferCount** a un valore compreso tra 2 e 16 per evitare una riduzione delle prestazioni in seguito all'attesa del rilascio del buffer di presentazione precedente in DWM.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-142">**BufferCount** to a value between 2 and 16 to prevent a performance penalty as a result of waiting on DWM to release the previous presentation buffer.</span></span>
-   <span data-ttu-id="4e4f7-143">**Format** to DXGI \_ Format \_ R16G16B16A16 \_ float, DXGI \_ Format \_ B8G8R8A8 \_ UNORM o DXGI \_ Format \_ \_ R8G8B8A8 UNORM</span><span class="sxs-lookup"><span data-stu-id="4e4f7-143">**Format** to DXGI\_FORMAT\_R16G16B16A16\_FLOAT, DXGI\_FORMAT\_B8G8R8A8\_UNORM, or DXGI\_FORMAT\_R8G8B8A8\_UNORM</span></span>
-   <span data-ttu-id="4e4f7-144">**Conteggio** del membro della [**struttura \_ \_ desc di esempio DXGI**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) che il membro **SampleDesc** specifica a uno e il membro di **qualità** di **DXGI \_ Sample \_ desc** su zero perché non è supportato l'anti-aliasing di più campioni (MSAA)</span><span class="sxs-lookup"><span data-stu-id="4e4f7-144">**Count** member of the [**DXGI\_SAMPLE\_DESC**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) structure that the **SampleDesc** member specifies to one and the **Quality** member of **DXGI\_SAMPLE\_DESC** to zero because multiple sample antialiasing (MSAA) is not supported</span></span>

<span data-ttu-id="4e4f7-145">Se si usa [**DXGI \_ swap \_ Effect \_ Flip \_ sequenziale**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) in Windows 7 o in un sistema operativo precedente, la creazione del dispositivo ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-145">If you use [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) on Windows 7 or earlier operating system, device creation fails.</span></span> <span data-ttu-id="4e4f7-146">Quando si usa Capovolgi modello, è possibile usare le statistiche presenti a schermo intero in modalità finestra.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-146">When you use flip model, you can use full-screen present statistics in windowed mode.</span></span> <span data-ttu-id="4e4f7-147">Il comportamento a schermo intero non è interessato.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-147">Full-screen behavior is not affected.</span></span> <span data-ttu-id="4e4f7-148">Se si passa **null** al parametro *pFullscreenDesc* di [**IDXGIFactory2:: CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) per una catena di scambio a finestra e si imposta **SwapEffect** su DXGI Inverti **effetto di \_ scambio \_ \_ \_ sequenziale**, il runtime crea un buffer indietro aggiuntivo e ruota a seconda di quale handle appartiene al buffer che diventa il buffer anteriore al momento della presentazione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-148">If you pass **NULL** to the *pFullscreenDesc* parameter of [**IDXGIFactory2::CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) for a windowed swap chain and set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, the runtime creates one extra back buffer and rotates whichever handle belongs to the buffer that becomes the front buffer at presentation time.</span></span>

<span data-ttu-id="4e4f7-149">Quando si usa Capovolgi modello, prendere in considerazione i suggerimenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-149">When you use flip model, consider these tips:</span></span>

-   <span data-ttu-id="4e4f7-150">Usare una catena di scambio di tipo flip per [**HWND**](../winprog/windows-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-150">Use one flip model swap chain per [**HWND**](../winprog/windows-data-types.md).</span></span> <span data-ttu-id="4e4f7-151">Non indirizzare più catene di scambio del modello Flip allo stesso **HWND**.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-151">Do not target multiple flip model swap chains to the same **HWND**.</span></span>
-   <span data-ttu-id="4e4f7-152">Non usare la catena di scambio flip model con la funzione [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) o [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) di GDI.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-152">Do not use flip model swap chain with GDI's [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) or [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) function.</span></span> <span data-ttu-id="4e4f7-153">Alcune app Direct3D usano le funzioni **ScrollWindow** e **ScrollWindowEx** di GDI per aggiornare il contenuto della finestra dopo che si è verificato un evento di scorrimento utente.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-153">Some Direct3D apps use GDI's **ScrollWindow** and **ScrollWindowEx** functions to update window contents after a user scroll event occurs.</span></span> <span data-ttu-id="4e4f7-154">**ScrollWindow** e **ScrollWindowEx** eseguono BitBlts del contenuto della finestra sullo schermo quando l'utente scorre una finestra.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-154">**ScrollWindow** and **ScrollWindowEx** perform bitblts of window contents on screen as the user scrolls a window.</span></span> <span data-ttu-id="4e4f7-155">Queste funzioni richiedono anche aggiornamenti del modello BitBlt per il contenuto GDI e Direct3D.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-155">These functions also require bitblt model updates for GDI and Direct3D content.</span></span> <span data-ttu-id="4e4f7-156">Per le app che usano una delle due funzioni non verrà necessariamente visualizzato lo scorrimento del contenuto della finestra visibile sullo schermo quando l'app è in modalità finestra.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-156">Apps that use either function will not necessarily display visible window contents scrolling on screen when the app is in windowed mode.</span></span> <span data-ttu-id="4e4f7-157">Si consiglia di non utilizzare le funzioni **ScrollWindow** e **ScrollWindowEx** di GDI e di ricreare i contenuti GDI e Direct3D sullo schermo in risposta allo scorrimento.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-157">We recommend that you not use GDI's **ScrollWindow** and **ScrollWindowEx** functions, and instead redraw GDI and Direct3D contents on screen in response to scrolling.</span></span>
-   <span data-ttu-id="4e4f7-158">Usare Capovolgi modello in un [**HWND**](../winprog/windows-data-types.md) non indirizzato anche ad altre API, tra cui il modello di presentazione DXGI BitBlt, altre versioni di Direct3D o GDI.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-158">Use flip model in an [**HWND**](../winprog/windows-data-types.md) that is not also targeted by other APIs, including DXGI bitblt presentation model, other versions of Direct3D, or GDI.</span></span> <span data-ttu-id="4e4f7-159">Poiché il modello BitBlt gestisce una copia aggiuntiva dell'area, è possibile aggiungere GDI e altri contenuti Direct3D allo stesso **HWND** tramite aggiornamenti a fasi da Direct3D e GDI.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-159">Because bitblt model maintains an additional copy of the surface, you can add GDI and other Direct3D contents to the same **HWND** through piecemeal updates from Direct3D and GDI.</span></span> <span data-ttu-id="4e4f7-160">Quando si usa il modello Flip, solo il contenuto Direct3D nelle catene di scambio flip model che il runtime passa a DWM è visibile.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-160">When you use the flip model, only Direct3D content in flip model swap chains that the runtime passes to DWM are visible.</span></span> <span data-ttu-id="4e4f7-161">Il runtime ignora tutti gli altri aggiornamenti del contenuto Direct3D o GDI del modello BitBlt.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-161">The runtime ignores all other bitblt model Direct3D or GDI content updates.</span></span>

## <a name="frame-synchronization-of-dxgi-flip-model-apps"></a><span data-ttu-id="4e4f7-162">Sincronizzazione dei frame delle app DXGI flip model</span><span class="sxs-lookup"><span data-stu-id="4e4f7-162">Frame synchronization of DXGI flip model apps</span></span>

<span data-ttu-id="4e4f7-163">Le statistiche attuali sono informazioni sugli intervalli di frame usati dalle app multimediali per sincronizzare i flussi video e audio e per eseguire il ripristino da problemi di riproduzione video.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-163">Present statistics are frame-timing information that media apps use to synchronize video and audio streams and recover from video playback glitches.</span></span> <span data-ttu-id="4e4f7-164">Le app possono usare le informazioni relative alla temporizzazione dei frame nelle statistiche attuali per modificare la frequenza di presentazione dei fotogrammi video per una presentazione più uniforme.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-164">Apps can use the frame-timing information in present statistics to adjust the presentation rate of their video frames for smoother presentation.</span></span> <span data-ttu-id="4e4f7-165">Per ottenere le informazioni sulle statistiche presenti, chiamare il metodo [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) per ottenere la struttura delle [**\_ \_ statistiche di frame DXGI**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="4e4f7-165">To obtain present statistics information, call the [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) method to obtain the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="4e4f7-166">**DXGI \_ Le \_ statistiche dei frame** contengono statistiche sulle chiamate a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) .</span><span class="sxs-lookup"><span data-stu-id="4e4f7-166">**DXGI\_FRAME\_STATISTICS** contains statistics about [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls.</span></span> <span data-ttu-id="4e4f7-167">Una catena di scambio Flip Model fornisce le informazioni statistiche presenti nelle modalità finestra e a schermo intero.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-167">A flip model swap chain provides present statistics information in both windowed and full-screen modes.</span></span> <span data-ttu-id="4e4f7-168">Per le catene di scambio del modello BitBlt in modalità finestra, tutti i valori delle **\_ \_ statistiche del frame di DXGI** sono pari a zero.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-168">For bitblt model swap chains in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

<span data-ttu-id="4e4f7-169">Per le statistiche di tipo flip model, [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) restituisce **DXGI \_ Error \_ frame \_ Statistics \_ disgiunte** nelle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-169">For flip model present statistics, [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) returns **DXGI\_ERROR\_FRAME\_STATISTICS\_DISJOINT** in these situations:</span></span>

-   <span data-ttu-id="4e4f7-170">Prima chiamata a [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), che indica l'inizio di una sequenza</span><span class="sxs-lookup"><span data-stu-id="4e4f7-170">First call to [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), which indicates the beginning of a sequence</span></span>
-   <span data-ttu-id="4e4f7-171">Modifica della modalità: in modalità finestra a o da schermo intero o a schermo intero a transizioni a schermo intero</span><span class="sxs-lookup"><span data-stu-id="4e4f7-171">Mode change: either windowed mode to or from full screen or full screen to full screen transitions</span></span>

<span data-ttu-id="4e4f7-172">I valori nei membri **PresentRefreshCount**, **SyncRefreshCount** e **SyncQPCTime** di [**DXGI \_ frame \_ Statistics**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) hanno le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-172">The values in **PresentRefreshCount**, **SyncRefreshCount**, and **SyncQPCTime** members of [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) have the following characteristics:</span></span>

-   <span data-ttu-id="4e4f7-173">**PresentRefreshCount** è uguale a **SyncRefreshCount** quando l'app presenta ogni vsync.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-173">**PresentRefreshCount** is equal to **SyncRefreshCount** when the app presents on every vsync.</span></span>
-   <span data-ttu-id="4e4f7-174">**SyncRefreshCount** viene ottenuto nell'intervallo vsync quando è stato inviato il presente, **SyncQPCTime** è approssimativamente il tempo associato all'intervallo vsync.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-174">**SyncRefreshCount** is obtained on the vsync interval when the present was submitted, **SyncQPCTime** is approximately the time associated with the vsync interval.</span></span>

<span data-ttu-id="4e4f7-175">Il metodo [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) restituisce l'ultimo conteggio presente, ovvero l'ID attuale dell'ultima chiamata di [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) eseguita da un dispositivo di visualizzazione associato alla catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-175">The [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) method returns the last present count, that is, the present ID of the last successful [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) call made by a display device that is associated with the swap chain.</span></span> <span data-ttu-id="4e4f7-176">Questo ID attuale è il valore del membro **PresentCount** della struttura [**DXGI \_ frame \_ Statistics**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="4e4f7-176">This present ID is the value of the **PresentCount** member of the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="4e4f7-177">Per le catene di scambio del modello BitBlt, in modalità finestra, tutti i valori delle **\_ \_ statistiche del frame di DXGI** sono pari a zero.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-177">For bitblt model swap chains, while in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

## <a name="avoiding-detecting-and-recovering-from-glitches"></a><span data-ttu-id="4e4f7-178">Prevenzione, rilevamento e ripristino da problemi</span><span class="sxs-lookup"><span data-stu-id="4e4f7-178">Avoiding, detecting, and recovering from glitches</span></span>

<span data-ttu-id="4e4f7-179">Eseguire questi passaggi per evitare, rilevare e ripristinare le anomalie nella presentazione del frame:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-179">Perform these steps to avoid, detect, and recover from glitches in frame presentation:</span></span>

1.  <span data-ttu-id="4e4f7-180">Queue [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) chiama, ovvero Call **IDXGISwapChain1::P resent1** più volte, che ne determina la raccolta in una coda.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-180">Queue [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls (that is, call **IDXGISwapChain1::Present1** multiple times, which causes them to collect in a queue).</span></span>
2.  <span data-ttu-id="4e4f7-181">Creare una struttura present-Queue per archiviare tutti i [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)present ID (restituito da [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) e i valori associati, calcolati/previsti **PresentRefreshCount** .</span><span class="sxs-lookup"><span data-stu-id="4e4f7-181">Create a present-queue structure to store all successfully submitted [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)'s present ID (returned by [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) and associated, calculated/expected **PresentRefreshCount** values.</span></span>
3.  <span data-ttu-id="4e4f7-182">Per rilevare un problema:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-182">To detect a glitch:</span></span>

    -   <span data-ttu-id="4e4f7-183">Chiamare [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-183">Call [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span></span>
    -   <span data-ttu-id="4e4f7-184">Per questo frame, ottenere l'ID attuale (**PresentCount**) e il numero di VSync in cui il sistema operativo ha presentato l'ultima immagine al monitor (**PresentRefreshCount**).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-184">For this frame, get the present ID (**PresentCount**) and vsync count where the operating system presented the last image to the monitor (**PresentRefreshCount**).</span></span>
    -   <span data-ttu-id="4e4f7-185">Recuperare il **PresentRefreshCount** previsto associato all'ID presente e archiviato in precedenza nella struttura della coda corrente.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-185">Retrieve the expected **PresentRefreshCount** that is associated with the present ID and that you previously stored in the present-queue structure.</span></span>
    -   <span data-ttu-id="4e4f7-186">Se il valore di **PresentRefreshCount** effettivo è successivo al valore previsto di **PresentRefreshCount**, si è verificato un problema.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-186">If the actual **PresentRefreshCount** is later than the expected **PresentRefreshCount**, a glitch has occurred.</span></span>

4.  <span data-ttu-id="4e4f7-187">Per risolvere il problema:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-187">To recover from the glitch:</span></span>

    -   <span data-ttu-id="4e4f7-188">Calcolare il numero di frame da ignorare per il ripristino dal problema.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-188">Calculate the number of frames to skip to recover from the glitch.</span></span> <span data-ttu-id="4e4f7-189">Se, ad esempio, il passaggio 3 indica che il numero di vsync previsto (**PresentRefreshCount**) per un ID presente (**PresentCount**) è 5 e il conteggio vsync effettivo per l'ID attuale è 8, il numero di frame da ignorare per il recupero dal glitch è 3 fotogrammi.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-189">For example, if step 3 reveals that the expected vsync count (**PresentRefreshCount**) for a present ID (**PresentCount**) is 5 and the actual vsync count for the present ID is 8, the number of frames to skip to recover from the glitch is 3 frames.</span></span>
    -   <span data-ttu-id="4e4f7-190">Passare 0 al parametro *SyncInterval* in questo numero di chiamate a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) per eliminare e ignorare questo numero di frame.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-190">Pass 0 to the *SyncInterval* parameter in this number of calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) to discard and skip this number of frames.</span></span>

        > [!Note]  
        > <span data-ttu-id="4e4f7-191">Se il problema è costituito da un numero elevato di frame, chiamare [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) con il parametro *Flags* impostato su [**DXGI \_ present \_ Restart**](dxgi-present.md) per eliminare e ignorare tutti i rilasci in coda in attesa.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-191">If the glitch consists of a large number of frames, call [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) with the *Flags* parameter set to [**DXGI\_PRESENT\_RESTART**](dxgi-present.md) to discard and skip all outstanding queued presents.</span></span>

         

<span data-ttu-id="4e4f7-192">Di seguito è riportato uno scenario di esempio di ripristino da glitch nella presentazione frame:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-192">Here is an example scenario of recovering from glitches in frame presentation:</span></span>

![illustrazione di un esempio di scenario di ripristino da glitch nella presentazione di frame](images/frame-sync-glitch-recover.png)

<span data-ttu-id="4e4f7-194">Nello scenario di esempio si prevede che il frame a venga visualizzato sullo schermo in un numero di vsync pari a 1.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-194">In the example scenario, you expect frame A to go on screen on a vsync count of 1.</span></span> <span data-ttu-id="4e4f7-195">Ma si rileva effettivamente il numero di vsync che frame A viene visualizzato sullo schermo come 4.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-195">But you actually detect the vsync count that frame A appears on screen as 4.</span></span> <span data-ttu-id="4e4f7-196">Pertanto, si determina che si è verificato un problema.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-196">Therefore, you determine that a glitch occurred.</span></span> <span data-ttu-id="4e4f7-197">È quindi possibile rimuovere 3 frame, ovvero è possibile passare 0 al parametro *SyncInterval* in 3 chiamate a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="4e4f7-197">You can then discard 3 frames, that is, you can pass 0 to the *SyncInterval* parameter in 3 calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="4e4f7-198">Nello scenario di esempio precedente, per risolvere il problema, è necessario un totale di 8 **IDXGISwapChain1::P resent1** chiamate.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-198">In the preceding example scenario, to recover from the glitch, you need a total of 8 **IDXGISwapChain1::Present1** calls.</span></span> <span data-ttu-id="4e4f7-199">Il nono frame viene quindi visualizzato in base al numero di vsync previsto.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-199">The 9th frame is then visible as per the vsync count that you expect.</span></span>

<span data-ttu-id="4e4f7-200">Ecco una riga temporale degli eventi di presentazione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-200">Here's a time line of presentation events.</span></span> <span data-ttu-id="4e4f7-201">Ogni linea verticale rappresenta un vsync.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-201">Each vertical line represents a vsync.</span></span> <span data-ttu-id="4e4f7-202">La direzione orizzontale è Time, che aumenta a destra.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-202">The horizontal direction is time, which increases to the right.</span></span> <span data-ttu-id="4e4f7-203">È possibile usare la figura per immaginare come possono verificarsi le anomalie.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-203">You can use the figure to imagine how glitches can occur.</span></span>

![illustrazione di una linea temporale degli eventi di presentazione](images/present-timeline.png)

<span data-ttu-id="4e4f7-205">La figura illustra questa sequenza:</span><span class="sxs-lookup"><span data-stu-id="4e4f7-205">The figure illustrates this sequence:</span></span>

1.  <span data-ttu-id="4e4f7-206">L'app viene riattivata in vsync, esegue il rendering di Blue, chiama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e quindi torna alla modalità sospensione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-206">The app wakes up on vsync, renders blue, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
2.  <span data-ttu-id="4e4f7-207">L'unità di elaborazione grafica (GPU) viene riattivata da inattiva, esegue il rendering in blu e quindi torna alla modalità sospensione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-207">The graphics processing unit (GPU) wakes up from idle, performs the render to blue, and then goes back to sleep.</span></span>
3.  <span data-ttu-id="4e4f7-208">DWM si riattiva alla successiva vsync, compone il blu nel buffer nascosto, chiama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e quindi torna alla modalità di sospensione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-208">The DWM wakes up at the next vsync, composes blue into its back buffer, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
4.  <span data-ttu-id="4e4f7-209">L'app viene riattivata, il rendering verde, chiama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e quindi torna alla modalità sospensione.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-209">The app wakes up, renders green, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
    > [!Note]  
    > <span data-ttu-id="4e4f7-210">L'app viene eseguita contemporaneamente mentre la GPU esegue la composizione del blu.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-210">The app concurrently executes while the GPU performs the compose of blue.</span></span>

     

5.  <span data-ttu-id="4e4f7-211">Il rendering della GPU viene quindi visualizzato in verde per l'app.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-211">Next, the GPU renders green for the app.</span></span>
6.  <span data-ttu-id="4e4f7-212">Infine, il convertitore da digitale a analogico (DAC) Mostra i risultati della composizione di DWM sul monitor nella vsync successiva.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-212">Finally, the digital to analog converter (DAC) shows results of the DWM composition on the monitor on the next vsync.</span></span>

<span data-ttu-id="4e4f7-213">Dalla sequenza temporale è possibile immaginare la latenza delle statistiche presenti e il modo in cui possono verificarsi le anomalie.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-213">From the time line, you can imagine the latency of present statistics and how glitches can occur.</span></span> <span data-ttu-id="4e4f7-214">Ad esempio, per visualizzare un glitch di DWM per il colore verde visualizzato sullo schermo, si supponga di ampliare la casella verde/rosso in modo che il lato destro della casella verde/rossa corrisponda al lato destro della casella viola/rosso.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-214">For example, to show a DWM glitch for the green color appearing on screen, imagine widening the green/red box so that the right side of the green/red box matches up to the right side of the purple/red box.</span></span> <span data-ttu-id="4e4f7-215">In questo scenario, l'applicazione livello dati Mostra due fotogrammi di blu e quindi il frame verde.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-215">In this scenario, the DAC shows two frames of blue and then the green frame.</span></span> <span data-ttu-id="4e4f7-216">È possibile notare che questo problema si è verificato leggendo le statistiche presenti.</span><span class="sxs-lookup"><span data-stu-id="4e4f7-216">You can see that this glitch occurred from reading present statistics.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4e4f7-217">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="4e4f7-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4e4f7-218">Miglioramento della presentazione con il modello Flip, i rettangoli Dirty e le aree a scorrimento</span><span class="sxs-lookup"><span data-stu-id="4e4f7-218">Enhancing presentation with the flip model, dirty rectangles, and scrolled areas</span></span>](dxgi-1-2-presentation-improvements.md)
</dt> </dl>

 

 
