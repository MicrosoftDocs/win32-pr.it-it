---
title: Panoramica dell'API del server HTTP
description: Questo argomento identifica una sequenza tipica di operazioni che usano l'API del server HTTP.
ms.assetid: 1245fd98-8370-4f1b-8c86-de9be5e678bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c99af3e4914c5496c2adea10b3ac658f75f3018
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "106299644"
---
# <a name="http-server-api-overview"></a><span data-ttu-id="2a4fd-103">Panoramica dell'API del server HTTP</span><span class="sxs-lookup"><span data-stu-id="2a4fd-103">HTTP Server API Overview</span></span>

<span data-ttu-id="2a4fd-104">L'elenco seguente identifica una sequenza tipica di operazioni che usano l'API del server HTTP:</span><span class="sxs-lookup"><span data-stu-id="2a4fd-104">The following list identifies a typical sequence of operations that use the HTTP Server API:</span></span>

-   <span data-ttu-id="2a4fd-105">Inizializzare l'API del server HTTP utilizzando la funzione [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-105">Initialize the HTTP Server API by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function.</span></span>
-   <span data-ttu-id="2a4fd-106">Creare una coda di richieste usando la funzione [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-106">Create a request queue by using the [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) function.</span></span>
-   <span data-ttu-id="2a4fd-107">Registrare uno o più URL utilizzando la funzione [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-107">Register one or more URLs by using the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span>
-   <span data-ttu-id="2a4fd-108">Ricevere le richieste in ingresso indirizzate agli URL registrati tramite la funzione [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) e inviare risposte http per queste richieste usando la funzione [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-108">Receive incoming requests directed to registered URLs by using the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function, and send HTTP responses for these requests by using the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span>
-   <span data-ttu-id="2a4fd-109">Opzionale Quando si invia una risposta, inviare un corpo di entità aggiuntivo utilizzando la funzione [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-109">(Optional) When sending a response, send an additional entity body by using the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>
-   <span data-ttu-id="2a4fd-110">Eseguire operazioni di pulizia usando le funzioni [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) e [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-110">Perform clean-up operations by using the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) and [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) functions.</span></span>

<span data-ttu-id="2a4fd-111">Nelle operazioni che usano gli URL, si noti che si tratta dell'URL elaborato contenuto nel membro **CookedUrl** della struttura della [**\_ richiesta HTTP \_ V1**](/windows/desktop/api/Http/ns-http-http_request_v1) da usare.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-111">In operations that use URLs, note that it is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure that should be used.</span></span> <span data-ttu-id="2a4fd-112">Non l'URL non elaborato nel membro **pRawUrl** , che è esclusivamente a scopo di rilevamento e statistica.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-112">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="2a4fd-113">Ogni applicazione crea una propria coda di richieste.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-113">Each application creates its own request queue.</span></span> <span data-ttu-id="2a4fd-114">Un'applicazione ottiene l'handle della coda di richieste da [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="2a4fd-114">An application obtains its request queue handle from [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="2a4fd-115">Passa questo handle alla funzione [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) per aggiungere un URL alla coda di richieste.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-115">It passes this handle to the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function to add a URL to the request queue.</span></span> <span data-ttu-id="2a4fd-116">L'applicazione riceve la notifica di una richiesta in ingresso e la Recupera dalla coda delle richieste chiamando la funzione [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) con l'handle della coda di richieste.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-116">The application receives notification of an incoming request, and retrieves it from the request queue by calling the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function with the request queue handle.</span></span> <span data-ttu-id="2a4fd-117">Questa funzione può essere utilizzata per ricevere le intestazioni della richiesta o sia le intestazioni che il corpo dell'entità.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-117">You can use this function to receive either the request headers or both the headers and entity body.</span></span> <span data-ttu-id="2a4fd-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) restituisce anche un identificatore di richiesta (RequestId) per la richiesta ricevuta che è univoca per l'handle della richiesta.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) also returns a request identifier (RequestId) for the received request that is unique to the request handle.</span></span>

> [!Note]  
> <span data-ttu-id="2a4fd-119">È responsabilità dell'applicazione esaminare tutte le intestazioni di richiesta rilevanti, incluse le intestazioni content-negotiation se vengono usate, e le richieste con esito negativo in base al contenuto dell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-119">It is the application's responsibility to examine all relevant request headers, including content-negotiation headers if they are being used, and fail requests as appropriate based on header content.</span></span> <span data-ttu-id="2a4fd-120">L'API server HTTP garantisce che ogni riga di intestazione sia terminata correttamente e non contenga caratteri non validi.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-120">The HTTP Server API ensures only that each header line is properly terminated, and does not contain illegal characters.</span></span>

 

<span data-ttu-id="2a4fd-121">Usare la funzione [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) con l'handle della coda di richieste per recuperare le parti successive del corpo dell'entità di una richiesta, se presenti.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-121">Use the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function with the request queue handle to retrieve subsequent portions of a request's entity body, if any.</span></span>

> [!Note]  
> <span data-ttu-id="2a4fd-122">L'API del server HTTP decodifica i messaggi in blocchi sul lato di ricezione, ma non esegue la codifica chunked sul lato di trasmissione.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-122">The HTTP Server API decodes chunked messages on the receive side, but does not perform chunked encoding on the send side.</span></span> <span data-ttu-id="2a4fd-123">Se è richiesta la suddivisione in blocchi sul lato di trasmissione, l'applicazione deve implementarla.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-123">If chunking is required on the send side, the application must implement it.</span></span> <span data-ttu-id="2a4fd-124">Per ulteriori informazioni sulla codifica chunked, vedere [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span><span class="sxs-lookup"><span data-stu-id="2a4fd-124">For more information about chunked encoding, see [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span></span>

 

<span data-ttu-id="2a4fd-125">Usare la funzione [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) con le applicazioni che forniscono URL usando uno schema sicuro ("**https**") per recuperare facoltativamente le informazioni sul certificato del client.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-125">Use the [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) function with applications that serve URLs by using a secure scheme ("**https**") to optionally retrieve the client's certificate information.</span></span>

<span data-ttu-id="2a4fd-126">Le risposte vengono inviate con la funzione [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-126">Responses are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span> <span data-ttu-id="2a4fd-127">Questa funzione usa il RequestId dal Request to Send corrispondente della risposta.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-127">This function uses the RequestId from the corresponding request to send the response.</span></span> <span data-ttu-id="2a4fd-128">È possibile inviare una risposta in diverse chiamate API nel tempo chiamando la funzione [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) con RequestId dalla richiesta originariamente ricevuta.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-128">A response can be sent in several API calls over time by calling the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function with the RequestId from the originally received request.</span></span>

> [!Note]  
> <span data-ttu-id="2a4fd-129">Per impostazione predefinita, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) USA "Microsoft-HTTPAPI/1.0" come intestazione "Server:".</span><span class="sxs-lookup"><span data-stu-id="2a4fd-129">By default, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) uses "Microsoft-HTTPAPI/1.0" as the "Server:" header.</span></span> <span data-ttu-id="2a4fd-130">Se un'applicazione specifica un'intestazione del server in una risposta, il valore viene inserito come prima parte dell'intestazione del server, seguito da uno spazio e quindi da "Microsoft-HTTPAPI/1.0".</span><span class="sxs-lookup"><span data-stu-id="2a4fd-130">If an application specifies a server header in a response, that value is placed as the first part of the server header, followed by a space and then "Microsoft-HTTPAPI/1.0".</span></span>

 

<span data-ttu-id="2a4fd-131">In generale, l'API server HTTP nasconde i dettagli relativi alla gestione delle connessioni e alla loro creazione e teardown dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2a4fd-131">In general, the HTTP Server API hides details of connection management and their establishment and teardown from applications.</span></span> <span data-ttu-id="2a4fd-132">Tuttavia, un'applicazione può facoltativamente rilevare la chiusura di una connessione chiamando [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span><span class="sxs-lookup"><span data-stu-id="2a4fd-132">However, an application can optionally detect termination of a connection by calling [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span></span>

<span data-ttu-id="2a4fd-133">Le applicazioni devono eseguire la pulizia attenendosi alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="2a4fd-133">Applications must clean-up by using the following steps:</span></span>

-   <span data-ttu-id="2a4fd-134">Quando l'applicazione non è in ascolto o risponde a un URL, l'URL viene rimosso tramite la funzione [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-134">When the application is not listening or responding to a URL, the URL is removed by using the [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) function.</span></span>
-   <span data-ttu-id="2a4fd-135">Al termine dell'applicazione con la coda di richieste, chiudere l'handle della coda di richieste usando la funzione [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-135">When the application is finished using the request queue, close the request queue handle by using the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function.</span></span>
-   <span data-ttu-id="2a4fd-136">Al termine dell'applicazione con l'API del server HTTP, chiamare la funzione [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="2a4fd-136">When the application is finished using the HTTP Server API, call the [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) function.</span></span>

 

 