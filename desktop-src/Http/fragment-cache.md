---
title: Cache frammenti
description: L'API server HTTP fornisce agli utenti la funzionalità per archiviare i frammenti di dati in una cache da utilizzare per la creazione rapida di risposte HTTP.
ms.assetid: 0f9a768e-723c-4c7b-a746-6b817441409c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3979fb03c4f8898644329fd27eafb7007adbcc9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103955258"
---
# <a name="fragment-cache"></a><span data-ttu-id="ae1f9-103">Cache frammenti</span><span class="sxs-lookup"><span data-stu-id="ae1f9-103">Fragment Cache</span></span>

<span data-ttu-id="ae1f9-104">L'API server HTTP fornisce agli utenti la funzionalità per archiviare i frammenti di dati in una cache da utilizzare per la creazione rapida di risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-104">The HTTP Server API provides functionality for users to store data fragments in a cache for use in rapidly forming HTTP responses.</span></span>

<span data-ttu-id="ae1f9-105">I frammenti possono essere aggiunti alla cache chiamando la funzione [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) .</span><span class="sxs-lookup"><span data-stu-id="ae1f9-105">Fragments can be added to the cache by calling the [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) function.</span></span> <span data-ttu-id="ae1f9-106">Un frammento viene identificato da un URL contenuto nel parametro *pUrlPrefix* .</span><span class="sxs-lookup"><span data-stu-id="ae1f9-106">A Fragment is identified by a URL contained in the *pUrlPrefix* parameter.</span></span> <span data-ttu-id="ae1f9-107">Una chiamata a questa funzione con l'URL di un frammento esistente sovrascrive il frammento esistente.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-107">A call to this function with the URL of an existing fragment overwrites the existing fragment.</span></span>

<span data-ttu-id="ae1f9-108">Un frammento può essere eliminato o sovrascritto dal proprietario della coda di richieste che ha inizialmente aggiunto il frammento.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-108">A fragment can be deleted or overwritten by the owner of the request queue that initially added the fragment.</span></span> <span data-ttu-id="ae1f9-109">La funzione [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) chiamata con un URLPrefix Elimina tutti i frammenti all'interno di tale prefisso, nonché i discendenti gerarchici di tale URLPrefix.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-109">The [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) function called with a UrlPrefix deletes all fragments within that prefix as well as the hierarchical descendants of that UrlPrefix.</span></span> <span data-ttu-id="ae1f9-110">La funzione [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) legge nell'intero frammento o in un intervallo di byte specificato all'interno del frammento.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-110">The [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) function reads in the entire fragment or a specified byte range within the fragment.</span></span>

> [!Note]  
> <span data-ttu-id="ae1f9-111">L'aggiunta di un frammento alla cache non garantisce che sia disponibile per le chiamate future per inviare una risposta.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-111">Adding a fragment to the cache does not guarantee that it is available for future calls to send a response.</span></span> <span data-ttu-id="ae1f9-112">Le voci della cache dei frammenti possono non essere più disponibili in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-112">Fragment cache entries can become unavailable at any time.</span></span> <span data-ttu-id="ae1f9-113">Una chiamata che utilizza un frammento non disponibile ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-113">A call that uses a fragment that is not available fails.</span></span> <span data-ttu-id="ae1f9-114">Le applicazioni che usano la cache dei frammenti devono essere pronte a gestire questo errore.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-114">Applications that use the fragment cache must be prepared to handle this failure.</span></span>

 

## <a name="sending-a-response-with-a-fragment"></a><span data-ttu-id="ae1f9-115">Invio di una risposta con un frammento</span><span class="sxs-lookup"><span data-stu-id="ae1f9-115">Sending a Response With a Fragment</span></span>

<span data-ttu-id="ae1f9-116">I frammenti possono essere usati per formare tutte o parti di un corpo dell'entità di risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-116">Fragments can be used to form all or portions of an HTTP responses entity body.</span></span> <span data-ttu-id="ae1f9-117">È possibile inviare una risposta e il corpo dell'entità in una chiamata alla funzione [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) specificando una matrice di strutture di [**\_ \_ blocco di dati http**](/windows/desktop/api/Http/ns-http-http_data_chunk) nella struttura della [**\_ risposta http**](http-response.md) .</span><span class="sxs-lookup"><span data-stu-id="ae1f9-117">You can send a response and entity body in one call to the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function by specifying an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures in the [**HTTP\_RESPONSE**](http-response.md) structure.</span></span>

<span data-ttu-id="ae1f9-118">Un blocco di [**\_ dati \_ http**](/windows/desktop/api/Http/ns-http-http_data_chunk) può specificare un blocco di memoria, un handle per un file già aperto o una voce della cache del frammento.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-118">An [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) can specify a block of memory, a handle to an already opened file or a fragment cache entry.</span></span> <span data-ttu-id="ae1f9-119">Questi corrispondono ai tipi **di \_ \_ blocchi di dati http** : **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle** e **HttpDataChunkFromFragmentCache**, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-119">These correspond to the **HTTP\_DATA\_CHUNK** types: **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle**, and **HttpDataChunkFromFragmentCache**, respectively.</span></span> <span data-ttu-id="ae1f9-120">Le risposte complete nella cache HTTP possono essere utilizzate anche come frammenti nella struttura della [**\_ risposta http**](http-response.md) , sebbene questa procedura non sia consigliata.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-120">Full responses in the HTTP cache can also be used as fragments in the [**HTTP\_RESPONSE**](http-response.md) structure, although this practice is not recommended.</span></span>

<span data-ttu-id="ae1f9-121">La struttura della [**\_ risposta http**](http-response.md) contiene un puntatore a una matrice di strutture di [**\_ \_ blocchi di dati http**](/windows/desktop/api/Http/ns-http-http_data_chunk) che comprendono il corpo dell'entità della risposta.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-121">The [**HTTP\_RESPONSE**](http-response.md) structure contains a pointer to an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures that comprise the entity body of the response.</span></span> <span data-ttu-id="ae1f9-122">La struttura della **\_ risposta http** contiene anche un conteggio delle corrispondenze che specifica la dimensione della matrice di strutture dei **\_ \_ blocchi di dati http** .</span><span class="sxs-lookup"><span data-stu-id="ae1f9-122">The **HTTP\_RESPONSE** structure also contains a matching count which specifies the dimension of the array of **HTTP\_DATA\_CHUNK** structures.</span></span> <span data-ttu-id="ae1f9-123">Il valore HttpDataChunkFromFragmentCache nella struttura **dei \_ \_ blocchi di dati http** specifica il tipo di cache del frammento del blocco di dati.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-123">The HttpDataChunkFromFragmentCache value in the **HTTP\_DATA\_CHUNK** structure specifies the fragment cache type of the data chunk.</span></span> <span data-ttu-id="ae1f9-124">La **struttura \_ dei \_ blocchi di dati http** specifica anche il nome del frammento.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-124">The **HTTP\_DATA\_CHUNK** structure also specifies the fragment name.</span></span>

<span data-ttu-id="ae1f9-125">Una risposta che contiene un frammento memorizzato nella cache ha esito negativo e \_ \_ non \_ viene trovato un percorso di errore se le voci della cache dei frammenti non sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-125">A response that contains a cached fragment fails with an ERROR\_PATH\_NOT\_FOUND if any of the fragment cache entries are not available.</span></span> <span data-ttu-id="ae1f9-126">Poiché non è garantito che le voci della cache dei frammenti siano disponibili, le applicazioni devono essere preparate per la gestione di questo caso.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-126">Since the fragment cache entries are not guaranteed to be available, applications must be prepared to handle this case.</span></span> <span data-ttu-id="ae1f9-127">Un modo per gestire questo caso consiste nel tentare di aggiungere nuovamente la voce della cache del frammento e di inviare nuovamente la risposta.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-127">One way to handle this case is to attempt to re-add the fragment cache entry and resend the response.</span></span> <span data-ttu-id="ae1f9-128">Se si verificano ripetuti errori, l'applicazione può usare blocchi di dati archiviati in buffer di memoria anziché voci della cache di frammenti.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-128">If repeated failures occur, the application can use data chunks stored in memory buffers instead of fragment cache entries.</span></span>

<span data-ttu-id="ae1f9-129">È inoltre possibile specificare voci della cache di frammenti nella funzione [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="ae1f9-129">Fragment cache entries can also be specified in the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span> <span data-ttu-id="ae1f9-130">Il frammento viene aggiunto al corpo dell'entità nella [**struttura \_ dei \_ blocchi di dati http**](/windows/desktop/api/Http/ns-http-http_data_chunk) come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-130">The fragment is added to the entity body in the [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structure as described above.</span></span> <span data-ttu-id="ae1f9-131">Anche in questo caso, l'invio può avere esito negativo se una delle voci della cache di frammenti specificata non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="ae1f9-131">Again, the send can fail if any of the specified fragment cache entries are not available.</span></span>

 

 




