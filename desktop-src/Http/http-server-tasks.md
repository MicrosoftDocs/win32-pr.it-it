---
title: Attività server HTTP
description: In genere, le attività del server HTTP vengono eseguite in un ordine specifico. ovvero, è necessario completare un'attività e l'output ottenuto prima dell'inizio dell'attività successiva.
ms.assetid: 08f8e7e9-23b9-403f-b00c-8912919d65b1
keywords:
- Attività server HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22455dbda21aca32b26f586eed6e51cef7509af2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103714584"
---
# <a name="http-server-tasks"></a><span data-ttu-id="7535a-104">Attività server HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-104">HTTP Server Tasks</span></span>

<span data-ttu-id="7535a-105">In genere, le attività del server HTTP vengono eseguite in un ordine specifico. ovvero, è necessario completare un'attività e l'output ottenuto prima dell'inizio dell'attività successiva.</span><span class="sxs-lookup"><span data-stu-id="7535a-105">Typically, HTTP server tasks are performed in a specific order; that is, one task must be completed and the output obtained before the next task begins.</span></span>

<span data-ttu-id="7535a-106">Viene creata una pagina attività per presentare il codice di esempio sulle attività specifiche eseguite da un'applicazione server HTTP.</span><span class="sxs-lookup"><span data-stu-id="7535a-106">A task page is created to present sample code about specific tasks that an HTTP Server application performs.</span></span> <span data-ttu-id="7535a-107">Una pagina attività è collegata al file di estensione C dell'esempio HTTP Server.</span><span class="sxs-lookup"><span data-stu-id="7535a-107">A task page links to the C extension file of the HTTP server sample.</span></span> <span data-ttu-id="7535a-108">Quando si installa PSDK nell'unità C: \\ di un computer locale, l'applicazione di esempio server completa viene installata in c: \\ programmi \\ Microsoft SDK \\ Samples \\ netds \\ http \\ Server.</span><span class="sxs-lookup"><span data-stu-id="7535a-108">When you install the PSDK on drive C:\\ of a local computer, the complete server sample application is installed at C:\\Program Files\\Microsoft SDK\\Samples\\netds\\http\\server.</span></span>

<span data-ttu-id="7535a-109">L'elenco seguente identifica le attività del server HTTP:</span><span class="sxs-lookup"><span data-stu-id="7535a-109">The following list identifies the HTTP Server tasks:</span></span>

-   [<span data-ttu-id="7535a-110">Inizializzare il servizio HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-110">Initialize the HTTP Service</span></span>](#initialize-the-http-service)
-   [<span data-ttu-id="7535a-111">Registrare gli URL per l'ascolto</span><span class="sxs-lookup"><span data-stu-id="7535a-111">Register the URLs to Listen On</span></span>](#register-the-urls-to-listen-on)
-   [<span data-ttu-id="7535a-112">Chiamare la routine per ricevere una richiesta</span><span class="sxs-lookup"><span data-stu-id="7535a-112">Call the Routine to Receive a Request</span></span>](#call-the-routine-to-receive-a-request)
-   [<span data-ttu-id="7535a-113">Ricevi la richiesta</span><span class="sxs-lookup"><span data-stu-id="7535a-113">Receive the Request</span></span>](#receive-the-request)
-   [<span data-ttu-id="7535a-114">Gestire la richiesta HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-114">Handle the HTTP Request</span></span>](#handle-the-http-request)
-   [<span data-ttu-id="7535a-115">Invia la risposta HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-115">Send the HTTP Response</span></span>](#send-the-http-response)
-   [<span data-ttu-id="7535a-116">Invia la risposta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="7535a-116">Send the HTTP POST Response</span></span>](#send-the-http-post-response)
-   [<span data-ttu-id="7535a-117">Pulire l'API del server HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-117">Clean Up the HTTP Server API</span></span>](#clean-up-the-http-server-api)

## <a name="initialize-the-http-service"></a><span data-ttu-id="7535a-118">Inizializzare il servizio HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-118">Initialize the HTTP Service</span></span>

<span data-ttu-id="7535a-119">Il servizio HTTP viene inizializzato tramite la funzione [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) e l'handle per la coda di richieste viene creato usando [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="7535a-119">The HTTP service is initialized by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function, and the handle to the request queue is created by using [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="7535a-120">Il server deve essere inizializzato prima di poter chiamare altre funzioni server.</span><span class="sxs-lookup"><span data-stu-id="7535a-120">The server must be initialized before any other server functions can be called.</span></span> <span data-ttu-id="7535a-121">È necessario creare la coda di richieste prima che il servizio possa registrare gli URL per l'ascolto delle richieste HTTP in ingresso.</span><span class="sxs-lookup"><span data-stu-id="7535a-121">The request queue must be created before the service can register URLs to listen for incoming HTTP requests.</span></span>

<span data-ttu-id="7535a-122">Per ulteriori informazioni e un esempio di codice, vedere [Initialize the http Service](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-122">For more information and a code example, see [Initialize the HTTP Service](http-server-sample-application.md).</span></span>

## <a name="register-the-urls-to-listen-on"></a><span data-ttu-id="7535a-123">Registrare gli URL per l'ascolto</span><span class="sxs-lookup"><span data-stu-id="7535a-123">Register the URLs to Listen On</span></span>

<span data-ttu-id="7535a-124">Per l'ascolto delle richieste in ingresso da parte dell'API server HTTP, URL specifici vengono registrati con l'API chiamando la funzione [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="7535a-124">For the HTTP Server API to listen for incoming requests, specific URLs are registered with the API by calling the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="7535a-125">Le richieste in ingresso che corrispondono a questi URL vengono indirizzate alla coda di richieste specificata in questa chiamata.</span><span class="sxs-lookup"><span data-stu-id="7535a-125">Incoming requests that match these URLs are routed to the request queue specified in this call.</span></span>

<span data-ttu-id="7535a-126">Per ulteriori informazioni e un esempio di codice, vedere la pagina relativa alla [registrazione degli URL per l'ascolto](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-126">For more information and a code example, see [Register the URLs to Listen On](http-server-sample-application.md).</span></span>

## <a name="call-the-routine-to-receive-a-request"></a><span data-ttu-id="7535a-127">Chiamare la routine per ricevere una richiesta</span><span class="sxs-lookup"><span data-stu-id="7535a-127">Call the Routine to Receive a Request</span></span>

<span data-ttu-id="7535a-128">La funzione DoReceiveRequest alloca il buffer della richiesta, Inizializza l'ID della richiesta e avvia il ciclo per ricevere le richieste.</span><span class="sxs-lookup"><span data-stu-id="7535a-128">The DoReceiveRequest function allocates the request buffer, initializes the request ID, and starts the loop to receive requests.</span></span>

<span data-ttu-id="7535a-129">Per ulteriori informazioni e un esempio di codice, vedere [chiamare la routine per ricevere una richiesta](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-129">For more information and a code example, see [Call the Routine to Receive a Request](http-server-sample-application.md).</span></span>

## <a name="receive-the-request"></a><span data-ttu-id="7535a-130">Ricevi la richiesta</span><span class="sxs-lookup"><span data-stu-id="7535a-130">Receive the Request</span></span>

<span data-ttu-id="7535a-131">L'API server HTTP fornisce una struttura di richiesta per archiviare la richiesta in ingresso analizzata.</span><span class="sxs-lookup"><span data-stu-id="7535a-131">The HTTP Server API supplies a request structure to store the parsed incoming request.</span></span> <span data-ttu-id="7535a-132">Questa struttura viene allocata dall'applicazione e inizializzata quando viene ricevuta una richiesta in ingresso.</span><span class="sxs-lookup"><span data-stu-id="7535a-132">This structure is allocated by the application, and initialized when an incoming request is received.</span></span> <span data-ttu-id="7535a-133">L'applicazione chiama la funzione [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) per ricevere la richiesta.</span><span class="sxs-lookup"><span data-stu-id="7535a-133">The application calls the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function to receive the request.</span></span> <span data-ttu-id="7535a-134">Se il buffer di richiesta è troppo piccolo per ricevere la richiesta, l'applicazione può aumentare le dimensioni del buffer e chiamare di nuovo **HttpReceiveHttpRequest** per ricevere l'intera richiesta.</span><span class="sxs-lookup"><span data-stu-id="7535a-134">If the request buffer is too small to receive the request, the application can increase the buffer size and call **HttpReceiveHttpRequest** again to receive the entire request.</span></span>

<span data-ttu-id="7535a-135">Per ulteriori informazioni e un esempio di codice, vedere [ricezione di una richiesta](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-135">For more information and a code example, see [Receive a Request](http-server-sample-application.md).</span></span>

## <a name="handle-the-http-request"></a><span data-ttu-id="7535a-136">Gestire la richiesta HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-136">Handle the HTTP Request</span></span>

<span data-ttu-id="7535a-137">Nell'applicazione di esempio viene illustrato come gestire i verbi HTTP GET e POST Request.</span><span class="sxs-lookup"><span data-stu-id="7535a-137">The sample application shows how to handle the HTTP GET and POST request verbs.</span></span> <span data-ttu-id="7535a-138">L'applicazione invia un errore 503 (**non \_ implementato**) se i verbi sono presenti nella richiesta che l'applicazione non gestisce.</span><span class="sxs-lookup"><span data-stu-id="7535a-138">The application sends a 503 (**NOT\_IMPLEMENTED**) error if verbs are present in the request that the application does not handle.</span></span>

<span data-ttu-id="7535a-139">Si noti che l'URL da utilizzare per la gestione delle richieste è l'URL elaborato contenuto nel membro **CookedUrl** della struttura della [**\_ richiesta HTTP \_ V1**](/windows/desktop/api/Http/ns-http-http_request_v1) .</span><span class="sxs-lookup"><span data-stu-id="7535a-139">Note that the URL to be used in handling requests is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure.</span></span> <span data-ttu-id="7535a-140">Non l'URL non elaborato nel membro **pRawUrl** , che è esclusivamente a scopo di rilevamento e statistica.</span><span class="sxs-lookup"><span data-stu-id="7535a-140">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="7535a-141">Per ulteriori informazioni e un esempio di codice, vedere [gestire la richiesta http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-141">For more information and a code example, see [Handle the HTTP Request](http-server-sample-application.md).</span></span>

## <a name="send-the-http-response"></a><span data-ttu-id="7535a-142">Invia la risposta HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-142">Send the HTTP Response</span></span>

<span data-ttu-id="7535a-143">La struttura della risposta viene allocata e inizializzata con il codice di stato e una frase di motivo nella macro di risposta http di INIZIALIZZAzione \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7535a-143">The response structure is allocated and initialized with the status code and a reason phrase in the INITIALIZE\_HTTP\_RESPONSE macro.</span></span> <span data-ttu-id="7535a-144">Un'intestazione HTTP nota viene aggiunta nella struttura della risposta nella macro dell' \_ intestazione nota Add \_ e il corpo dell'entità viene aggiunto alla risposta da un blocco di dati dalla memoria.</span><span class="sxs-lookup"><span data-stu-id="7535a-144">A known HTTP header is added into the response structure in the ADD\_KNOWN\_HEADER macro, and the entity body is added to the response from a data block from memory.</span></span> <span data-ttu-id="7535a-145">La funzione [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) viene chiamata per inviare la risposta.</span><span class="sxs-lookup"><span data-stu-id="7535a-145">The [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function is called to send the response.</span></span> <span data-ttu-id="7535a-146">In questo esempio, l'applicazione invia una semplice risposta 200 OK alla richiesta GET.</span><span class="sxs-lookup"><span data-stu-id="7535a-146">In this example, the application sends a simple 200 OK response to the GET request.</span></span>

<span data-ttu-id="7535a-147">Per ulteriori informazioni e un esempio di codice, vedere [inviare una risposta http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-147">For more information and a code example, see [Send an HTTP Response](http-server-sample-application.md).</span></span>

## <a name="send-the-http-post-response"></a><span data-ttu-id="7535a-148">Invia la risposta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="7535a-148">Send the HTTP POST Response</span></span>

<span data-ttu-id="7535a-149">Per la richiesta POST è necessaria una maggiore elaborazione rispetto alla richiesta GET.</span><span class="sxs-lookup"><span data-stu-id="7535a-149">The POST request requires more processing than the GET request.</span></span> <span data-ttu-id="7535a-150">Il corpo dell'entità della richiesta viene ricevuto chiamando la funzione [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) .</span><span class="sxs-lookup"><span data-stu-id="7535a-150">The request entity body is received by calling the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function.</span></span> <span data-ttu-id="7535a-151">L'applicazione invia la risposta e il corpo dell'entità della risposta in chiamate separate all'API del server HTTP.</span><span class="sxs-lookup"><span data-stu-id="7535a-151">The application sends the response and the response entity body in separate calls to the HTTP Server API.</span></span> <span data-ttu-id="7535a-152">Le intestazioni della risposta vengono inviate con [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span><span class="sxs-lookup"><span data-stu-id="7535a-152">The response headers are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span></span> <span data-ttu-id="7535a-153">Il corpo dell'entità viene inviato in un blocco di dati da un handle di file con la funzione [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="7535a-153">The entity body is sent in a data block from a file handle with the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>

<span data-ttu-id="7535a-154">Per altre informazioni e un esempio di codice, vedere [inviare una risposta HTTP post](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-154">For more information and a code example, see [Send an HTTP POST Response](http-server-sample-application.md).</span></span>

## <a name="clean-up-the-http-server-api"></a><span data-ttu-id="7535a-155">Pulire l'API del server HTTP</span><span class="sxs-lookup"><span data-stu-id="7535a-155">Clean Up the HTTP Server API</span></span>

<span data-ttu-id="7535a-156">Le operazioni di pulizia per l'API del server HTTP includono:</span><span class="sxs-lookup"><span data-stu-id="7535a-156">The cleanup operations for the HTTP Server API include:</span></span>

-   <span data-ttu-id="7535a-157">Rimozione di tutti gli URL registrati.</span><span class="sxs-lookup"><span data-stu-id="7535a-157">Removing all registered URLs.</span></span>
-   <span data-ttu-id="7535a-158">Chiusura dell'handle per la coda delle richieste.</span><span class="sxs-lookup"><span data-stu-id="7535a-158">Closing the handle to the request queue.</span></span>
-   <span data-ttu-id="7535a-159">Terminazione delle risorse create dall'API del server HTTP.</span><span class="sxs-lookup"><span data-stu-id="7535a-159">Terminating the resources created by the HTTP Server API.</span></span>

<span data-ttu-id="7535a-160">L'applicazione chiama la funzione [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) per annullare la registrazione degli URL registrati dalla funzione [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) iniziale.</span><span class="sxs-lookup"><span data-stu-id="7535a-160">The application calls the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) function to deregister URLs registered by the initial [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="7535a-161">L'applicazione chiama anche [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) per ogni chiamata a [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) con le impostazioni dei flag corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="7535a-161">The application also calls [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) for each call to [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) with matching flag settings.</span></span> <span data-ttu-id="7535a-162">Questa chiamata termina tutte le risorse create dalla chiamata a **HttpInitialize**.</span><span class="sxs-lookup"><span data-stu-id="7535a-162">This call terminates all resources created by the call to **HttpInitialize**.</span></span>

<span data-ttu-id="7535a-163">Per altre informazioni e un esempio di codice, vedere [Cleanup the HTTP Server API](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="7535a-163">For more information and a code example, see [Cleanup the HTTP Server API](http-server-sample-application.md).</span></span>

 

 




