---
title: Serializzazione del tipo
description: Il compilatore MIDL genera fino a tre funzioni per ogni tipo a cui viene applicato l'attributo \ Encode \ o \ Decode \.
ms.assetid: 948f1dd7-c8b0-4fa0-88d8-9d122de52ba1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4674617bc98c92dbc684a29d1a3c91ac6a7429e1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118054"
---
# <a name="type-serialization"></a><span data-ttu-id="f3a46-103">Serializzazione del tipo</span><span class="sxs-lookup"><span data-stu-id="f3a46-103">Type Serialization</span></span>

<span data-ttu-id="f3a46-104">Il compilatore MIDL genera fino a tre funzioni per ogni tipo a cui \[ [](/windows/desktop/Midl/encode) \] viene applicato l'attributo Encode o \[ [Decode](/windows/desktop/Midl/decode) \] .</span><span class="sxs-lookup"><span data-stu-id="f3a46-104">The MIDL compiler generates up to three functions for each type to which the \[ [encode](/windows/desktop/Midl/encode)\] or \[ [decode](/windows/desktop/Midl/decode)\] attribute is applied.</span></span> <span data-ttu-id="f3a46-105">Ad esempio, per un tipo definito dall'utente denominato *MyType*, il compilatore genera il codice per le \_ funzioni MyType Encode, MyType \_ Decode e MyType \_ AlignSize.</span><span class="sxs-lookup"><span data-stu-id="f3a46-105">For example, for a user-defined type named *MyType*, the compiler generates code for the MyType\_Encode, MyType\_Decode, and MyType\_AlignSize functions.</span></span> <span data-ttu-id="f3a46-106">Per queste funzioni, il compilatore scrive i prototipi in Stub. h e il codice sorgente nello stub \_ c.c.</span><span class="sxs-lookup"><span data-stu-id="f3a46-106">For these functions, the compiler writes prototypes to Stub.h and source code to Stub\_c.c.</span></span> <span data-ttu-id="f3a46-107">In genere, è possibile codificare un oggetto *MyType* con \_ la codifica MyType e decodificare un oggetto dal buffer usando la \_ decodifica MyType.</span><span class="sxs-lookup"><span data-stu-id="f3a46-107">Generally, you can encode a *MyType* object with MyType\_Encode and decode an object from the buffer using MyType\_Decode.</span></span> <span data-ttu-id="f3a46-108">MyType \_ AlignSize viene usato se è necessario ottenere informazioni sulla dimensione del buffer di marshalling prima di allocarlo.</span><span class="sxs-lookup"><span data-stu-id="f3a46-108">MyType\_AlignSize is used if you need to know the size of the marshaling buffer before allocating it.</span></span>

<span data-ttu-id="f3a46-109">La funzione di codifica seguente viene generata dal compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="f3a46-109">The following encoding function is generated by the MIDL compiler.</span></span> <span data-ttu-id="f3a46-110">Questa funzione serializza i dati per l'oggetto a cui fa riferimento pObject e il buffer viene ottenuto in base al metodo specificato nell'handle.</span><span class="sxs-lookup"><span data-stu-id="f3a46-110">This function serializes the data for the object pointed to by pObject, and the buffer is obtained according to the method specified in the handle.</span></span> <span data-ttu-id="f3a46-111">Dopo aver scritto i dati serializzati nel buffer, è possibile controllare il buffer.</span><span class="sxs-lookup"><span data-stu-id="f3a46-111">After writing the serialized data to the buffer, you control the buffer.</span></span> <span data-ttu-id="f3a46-112">Si noti che l'handle eredita lo stato dalle chiamate precedenti e che i buffer devono essere allineati a 8.</span><span class="sxs-lookup"><span data-stu-id="f3a46-112">Note that the handle inherits the status from the previous calls, and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="f3a46-113">Per un handle implicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-113">For an implicit handle:</span></span>

``` syntax
void MyType_Encode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-114">Per un handle esplicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-114">For an explicit handle:</span></span>

``` syntax
void MyType_Encode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-115">La funzione seguente deserializza i dati dalla risorsa di archiviazione dell'applicazione nell'oggetto a cui punta pObject.</span><span class="sxs-lookup"><span data-stu-id="f3a46-115">The following function deserializes the data from the application's storage into the object pointed to by pObject.</span></span> <span data-ttu-id="f3a46-116">Si fornisce un buffer di cui è stato effettuato il marshalling in base al metodo specificato nell'handle.</span><span class="sxs-lookup"><span data-stu-id="f3a46-116">You supply a marshaled buffer according to the method specified in the handle.</span></span> <span data-ttu-id="f3a46-117">Si noti che l'handle può ereditare lo stato dalle chiamate precedenti e che i buffer devono essere allineati a 8.</span><span class="sxs-lookup"><span data-stu-id="f3a46-117">Note that the handle can inherit the status from the previous calls and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="f3a46-118">Per un handle implicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-118">For an implicit handle:</span></span>

``` syntax
void MyType_Decode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-119">Per un handle esplicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-119">For an explicit handle:</span></span>

``` syntax
void MyType_Decode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-120">La funzione seguente restituisce una dimensione, in byte, che include l'istanza del tipo più tutti i byte di riempimento necessari per allineare i dati.</span><span class="sxs-lookup"><span data-stu-id="f3a46-120">The following function returns a size, in bytes, that includes the type instance plus any padding bytes needed to align the data.</span></span> <span data-ttu-id="f3a46-121">In questo modo è possibile serializzare un set di istanze dello stesso tipo o di tipi diversi in un buffer garantendo al contempo che i dati per ogni oggetto siano allineati in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="f3a46-121">This enables serializing a set of instances of the same or different types into a buffer while ensuring that the data for each object is appropriately aligned.</span></span> <span data-ttu-id="f3a46-122">MyType \_ AlignSize presuppone che l'istanza a cui fa riferimento pObject venga sottoposta a marshalling in un buffer a partire dall'offset allineato a 8.</span><span class="sxs-lookup"><span data-stu-id="f3a46-122">MyType\_AlignSize assumes that the instance pointed to by pObject will be marshaled into a buffer beginning at the offset aligned at 8.</span></span>

<span data-ttu-id="f3a46-123">Per un handle implicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-123">For an implicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-124">Per un handle esplicito:</span><span class="sxs-lookup"><span data-stu-id="f3a46-124">For an explicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="f3a46-125">Si noti che entrambe le procedure remote con handle di binding impliciti e tipi serializzati con handle di serializzazione implicite utilizzano la stessa variabile di handle globale.</span><span class="sxs-lookup"><span data-stu-id="f3a46-125">Note that both remote procedures with implicit binding handles and serialized types with implicit serialization handles use the same global handle variable.</span></span> <span data-ttu-id="f3a46-126">Pertanto, è consigliabile non combinare la serializzazione dei tipi e le procedure remote in un'interfaccia con handle impliciti.</span><span class="sxs-lookup"><span data-stu-id="f3a46-126">Therefore, it is advisable not to mix type serialization and remote procedures in an interface with implicit handles.</span></span> <span data-ttu-id="f3a46-127">Per informazioni dettagliate, vedere [handle impliciti e espliciti](implicit-versus-explicit-handles.md).</span><span class="sxs-lookup"><span data-stu-id="f3a46-127">For details, see [Implicit Versus Explicit Handles](implicit-versus-explicit-handles.md).</span></span>

 

 