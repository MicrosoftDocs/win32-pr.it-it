---
title: Raccomandazioni sulla distribuzione RPC su HTTP
description: In questa sezione vengono documentate le procedure consigliate e le configurazioni di distribuzione consigliate per ottenere la massima sicurezza e prestazioni quando si utilizza RPC su HTTP.
ms.assetid: 83938a7d-77d0-45e8-b0a3-7b32ef768d83
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8871686d1fc8b87bcd6fb7ac4314b1977252f23a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104045171"
---
# <a name="rpc-over-http-deployment-recommendations"></a><span data-ttu-id="c2aaf-103">Raccomandazioni sulla distribuzione RPC su HTTP</span><span class="sxs-lookup"><span data-stu-id="c2aaf-103">RPC over HTTP Deployment Recommendations</span></span>

<span data-ttu-id="c2aaf-104">In questa sezione vengono documentate le procedure consigliate e le configurazioni di distribuzione consigliate per ottenere la massima sicurezza e prestazioni quando si utilizza RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-104">This section documents best practices and recommended deployment configurations for achieving maximum security and performance when using RPC over HTTP.</span></span> <span data-ttu-id="c2aaf-105">Le varie configurazioni trovate in questo documento si applicano a organizzazioni diverse in base a vari requisiti di dimensioni, budget e sicurezza.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-105">The various configurations found herein apply do different organizations based on various size, budget, and security requirements.</span></span> <span data-ttu-id="c2aaf-106">Ogni configurazione fornisce anche considerazioni sulla distribuzione utili per determinare quale sia la soluzione migliore per uno scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-106">Each configuration also provides deployment considerations useful in determining which is best for a given scenario.</span></span>

<span data-ttu-id="c2aaf-107">Per informazioni sugli scenari RPC con volume elevato su HTTP, vedere [Microsoft RPC Load Balancing](rpc-load-balancing.md).</span><span class="sxs-lookup"><span data-stu-id="c2aaf-107">For information regarding high volume RPC over HTTP scenarios, please see [Microsoft RPC Load Balancing](rpc-load-balancing.md).</span></span>

<span data-ttu-id="c2aaf-108">Le indicazioni seguenti si applicano a tutte le configurazioni:</span><span class="sxs-lookup"><span data-stu-id="c2aaf-108">The following recommendations apply to all configurations:</span></span>

-   <span data-ttu-id="c2aaf-109">Usare le versioni di Windows che supportano RPC su HTTP V2.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-109">Use versions of Windows that support RPC over HTTP v2.</span></span>
-   <span data-ttu-id="c2aaf-110">Inserire IIS nel computer che esegue il proxy RPC in modalità IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-110">Put IIS on the machine that runs the RPC Proxy in IIS 6.0 mode.</span></span>
-   <span data-ttu-id="c2aaf-111">Non consentire l'accesso anonimo alla directory virtuale del proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-111">Disallow anonymous access to the RPC Proxy virtual directory.</span></span>
-   <span data-ttu-id="c2aaf-112">Non abilitare mai la chiave del registro di sistema AllowAnonymous.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-112">Never enable the AllowAnonymous registry key.</span></span>
-   <span data-ttu-id="c2aaf-113">Fare in modo che i client RPC over HTTP usino **CertificateSubjectField** (vedere [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) per altre informazioni) per verificare che il proxy RPC a cui si è connessi sia il proxy RPC che si prevede.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-113">Make your RPC over HTTP clients use the **CertificateSubjectField** (see [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) for more information) to verify that the RPC Proxy you connected to is the RPC Proxy you expect.</span></span>
-   <span data-ttu-id="c2aaf-114">Configurare la chiave del registro di sistema **ValidPorts** in modo che contenga solo i computer a cui si connetteranno i client RPC su http.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-114">Configure the **ValidPorts** registry key to contain only machines to which the RPC over HTTP clients will connect.</span></span>
-   <span data-ttu-id="c2aaf-115">Non usare caratteri jolly nella chiave **ValidPorts** . Questa operazione consente di risparmiare tempo, ma un computer completamente imprevisto può adattarsi anche al carattere jolly.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-115">Do not use wildcards in the **ValidPorts** key; doing so can save time, but a completely unexpected machine may fit the wildcard as well.</span></span>
-   <span data-ttu-id="c2aaf-116">Usare SSL su client RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-116">Use SSL on RPC over HTTP clients.</span></span> <span data-ttu-id="c2aaf-117">Se vengono seguite le linee guida stabilite in queste sezioni, il client RPC su HTTP non sarà in grado di connettersi senza usare SSL.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-117">If the guidelines set forth in these sections are followed, the RPC over HTTP client will not be able to connect without using SSL.</span></span>
-   <span data-ttu-id="c2aaf-118">Configurare RPC su client HTTP per utilizzare la crittografia RPC oltre a usare SSL.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-118">Configure RPC over HTTP clients to use RPC Encryption in addition to using SSL.</span></span> <span data-ttu-id="c2aaf-119">Se il client RPC su HTTP non è in grado di raggiungere il KDC, può utilizzare solo Negotiate e NTLM.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-119">If the RPC over HTTP client cannot reach the KDC, it can use only Negotiate and NTLM.</span></span>
-   <span data-ttu-id="c2aaf-120">Configurare i computer client per l'uso di NTLMv2.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-120">Configure client machines to use NTLMv2.</span></span> <span data-ttu-id="c2aaf-121">Impostare la chiave del registro di sistema **LMCompatibilityLevel** su 2 o una versione successiva.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-121">Set the **LMCompatibilityLevel** registry key to 2 or higher.</span></span> <span data-ttu-id="c2aaf-122">Per ulteriori informazioni sulla chiave **LMCompatibilityLevel** , vedere **MSDN.Microsoft.com** .</span><span class="sxs-lookup"><span data-stu-id="c2aaf-122">See **msdn.microsoft.com** for more information on the **LMCompatibilityLevel** key.</span></span>
-   <span data-ttu-id="c2aaf-123">Eseguire una Web farm di computer proxy RPC con la configurazione illustrata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-123">Run a web farm of RPC Proxy machines with the configuration outlined above.</span></span>
-   <span data-ttu-id="c2aaf-124">Distribuire un firewall tra Internet e il proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-124">Deploy a firewall between the Internet and the RPC Proxy.</span></span>
-   <span data-ttu-id="c2aaf-125">Per ottenere prestazioni ottimali, configurare IIS in modo da inviare una breve risposta ai codici di errore non riusciti.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-125">For optimal performance, configure IIS to send a short response for non-success error codes.</span></span> <span data-ttu-id="c2aaf-126">Poiché il consumer della risposta IIS è un processo automatizzato, non sono necessarie spiegazioni semplici da inviare al client; verranno semplicemente ignorati dal client RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-126">Because the consumer of the IIS response is an automated process, there is no need for user friendly explanations to be sent to the client; they will simply be ignored by the RPC over HTTP client.</span></span>

<span data-ttu-id="c2aaf-127">Gli obiettivi di base del proxy RPC dal punto di vista della sicurezza, delle prestazioni e della gestibilità sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="c2aaf-127">The basic goals of the RPC Proxy from a security, performance and manageability perspective are the following:</span></span>

-   <span data-ttu-id="c2aaf-128">Fornire un singolo punto di ingresso per il traffico RPC su HTTP nella rete del server.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-128">Provide a single point of entry for RPC over HTTP traffic into the server network.</span></span> <span data-ttu-id="c2aaf-129">La presenza di un singolo punto di ingresso per il traffico RPC su HTTP in una rete server presenta due vantaggi principali.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-129">Having a single point of entry for RPC over HTTP traffic into a server network has two main benefits.</span></span> <span data-ttu-id="c2aaf-130">Innanzitutto, poiché il proxy RPC si trova in Internet, la maggior parte delle organizzazioni isola tali computer in una rete speciale denominata rete perimetrale non attendibile che è separata dalla normale rete aziendale.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-130">First, since the RPC Proxy is facing the Internet, most organizations isolate such machines in a special network called an untrusted perimeter network which is separate from the normal organizational network.</span></span> <span data-ttu-id="c2aaf-131">I server in una rete perimetrale non attendibile vengono gestiti, configurati e monitorati in modo molto accurato per poter resistere ad attacchi provenienti da Internet.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-131">Servers in an untrusted perimeter network are very carefully managed, configured and monitored to be able to withstand attacks from the Internet.</span></span> <span data-ttu-id="c2aaf-132">Il minor numero di computer in una rete perimetrale non attendibile, più semplice è la configurazione, la gestione, il monitoraggio e la protezione.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-132">The fewer machines in an untrusted perimeter network, the easier it is to configure, manage, monitor and keep them secure.</span></span> <span data-ttu-id="c2aaf-133">In secondo luogo, poiché una singola Web farm con proxy RPC installati può servire un numero qualsiasi di server RPC su HTTP che risiedono nella rete aziendale, è molto utile separare il proxy RPC dal server RPC su HTTP e fare in modo che il proxy RPC risieda in una rete perimetrale non attendibile.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-133">Second, since a single Web Farm with RPC Proxies installed can service any number of RPC over HTTP Servers residing on the corporate network, it makes a lot of sense to separate the RPC Proxy from the RPC over HTTP Server and have the RPC Proxy reside in an untrusted perimeter network.</span></span> <span data-ttu-id="c2aaf-134">Se il proxy RPC si trovava nello stesso computer del server RPC su HTTP, le organizzazioni verrebbero forzate a inserire tutti i server back-end in una rete perimetrale non attendibile, il che renderebbe molto più difficile tenere protetta la rete perimetrale non attendibile.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-134">If the RPC Proxy was on the same machine as the RPC over HTTP Server, organizations would be forced to put all of their back end servers into an untrusted perimeter network, which would make it much harder to keep the untrusted perimeter network secure.</span></span> <span data-ttu-id="c2aaf-135">La separazione del ruolo del proxy RPC e del server RPC su HTTP consente alle organizzazioni di tenere il numero di computer in una rete perimetrale non attendibile gestibile e quindi più sicuro.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-135">Separating the role of the RPC Proxy and the RPC over HTTP server helps organizations keep the number of machines in an untrusted perimeter network manageable and therefore, more secure.</span></span>
-   <span data-ttu-id="c2aaf-136">Fungere da fusibile di sicurezza per la rete del server.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-136">Serve as a safety fuse for the server network.</span></span> <span data-ttu-id="c2aaf-137">Il proxy RPC è progettato come un fusibile utilizzabile per la rete del server. Se si verifica un errore nel proxy RPC, è sufficiente che protegga il server RPC reale su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-137">The RPC Proxy is designed as an expendable fuse for the server network – if something goes wrong on the RPC Proxy, it simply goes out and thus protects the real RPC over HTTP server.</span></span> <span data-ttu-id="c2aaf-138">Se le procedure consigliate descritte in questa sezione sono state seguite finora, il traffico RPC su HTTP viene crittografato con la crittografia RPC, oltre a SSL.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-138">If the outlined best practices outlined in this section have been followed thus far, the RPC over HTTP traffic is encrypted with RPC encryption in addition to SSL.</span></span> <span data-ttu-id="c2aaf-139">La crittografia RPC stessa è tra il client e il server, non tra il client e il proxy.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-139">The RPC Encryption itself is between the client and the server, not between the client and the proxy.</span></span> <span data-ttu-id="c2aaf-140">Ciò significa che il proxy non riconosce e non è in grado di decrittografare il traffico RPC ricevuto.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-140">This means the proxy does not understand and cannot decrypt the RPC traffic it receives.</span></span> <span data-ttu-id="c2aaf-141">Riconosce solo alcune sequenze di controllo inviate dal client che gestiscono lo stabilimento di connessione, il controllo di flusso e altri dettagli di tunneling.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-141">It only understands some control sequences sent to it by the client dealing with connection establishment, flow control and other tunneling details.</span></span> <span data-ttu-id="c2aaf-142">Non ha accesso ai dati inviati dal client RPC su HTTP al server.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-142">It has no access to the data the RPC over HTTP client sends to the server.</span></span> <span data-ttu-id="c2aaf-143">Inoltre, il client RPC su HTTP deve autenticarsi in modo indipendente sia per il proxy RPC che per il server RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-143">Furthermore, the RPC over HTTP client must independently authenticate to both the RPC Proxy and the RPC over HTTP server.</span></span> <span data-ttu-id="c2aaf-144">In questo modo viene fornita una difesa approfondita.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-144">This provides defense in depth.</span></span> <span data-ttu-id="c2aaf-145">Se il computer proxy RPC viene compromesso, a causa di un errore di configurazione o di una violazione della sicurezza di qualche tipo, i dati che passano attraverso di essi sono ancora protetti da manomissioni.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-145">If the RPC Proxy machine becomes compromised, due to some configuration error or a security breach of some sort, the data that pass through it are still secure from tampering.</span></span> <span data-ttu-id="c2aaf-146">Un utente malintenzionato che ottiene il controllo del proxy RPC può interrompere il traffico, ma non leggerlo o manometterlo.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-146">An attacker that would gain control of the RPC Proxy can at most interrupt the traffic, but not read it or tamper with it.</span></span> <span data-ttu-id="c2aaf-147">Si tratta del punto in cui entra in gioco il ruolo fuse del proxy RPC, che è spendibile senza che venga compromessa la sicurezza del traffico RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-147">This is where the fuse role of the RPC Proxy comes into play – it is expendable without the security of the RPC over HTTP traffic being compromised.</span></span>
-   <span data-ttu-id="c2aaf-148">Distribuire alcune operazioni di controllo e decrittografia degli accessi tra più computer che eseguono proxy RPC in una Web farm.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-148">Distribute some of the access checks and decryption work among multiple machines running RPC Proxy in a Web Farm.</span></span> <span data-ttu-id="c2aaf-149">Funzionando correttamente in una Web farm, il proxy RPC consente alle organizzazioni di eseguire l'offload della decrittografia SSL e di alcuni controlli di accesso, liberando così una maggiore capacità sul server back-end per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-149">By functioning well in a Web Farm, the RPC Proxy enables organizations to offload SSL decryption and some of the access checks, thus freeing more capacity on the back end server for processing.</span></span> <span data-ttu-id="c2aaf-150">L'utilizzo di una Web farm di computer proxy RPC consente inoltre a un'organizzazione di aumentare la propria capacità di resistere agli attacchi Denial of Service (DoS) aumentando la capacità dei server front-end.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-150">Using a Web Farm of RPC Proxy machines also enables an organization to increase its ability to withstand Denial of Service (DoS) attacks by increasing the capacity on its front end servers.</span></span>

<span data-ttu-id="c2aaf-151">All'interno delle linee guida stabilite finora, le organizzazioni hanno ancora scelte.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-151">Within the guidelines set forth thus far, organizations still have choices.</span></span> <span data-ttu-id="c2aaf-152">Ogni organizzazione ha scelte e compromessi tra gli inconvenienti degli utenti, la sicurezza e i costi:</span><span class="sxs-lookup"><span data-stu-id="c2aaf-152">Each organization has choices and compromises between user inconvenience, security and cost:</span></span>

-   <span data-ttu-id="c2aaf-153">**Utilizzare l'autenticazione di base o l'autenticazione integrata di Windows per eseguire l'autenticazione al proxy RPC?**</span><span class="sxs-lookup"><span data-stu-id="c2aaf-153">**Use Basic Authentication or Windows Integrated Authentication to authenticate to the RPC Proxy?**</span></span> <span data-ttu-id="c2aaf-154">RPC su HTTP supporta attualmente solo NTLM, non supporta Kerberos.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-154">RPC over HTTP currently supports only NTLM – it doesn't support Kerberos.</span></span> <span data-ttu-id="c2aaf-155">Inoltre, se è presente un proxy HTTP o un firewall tra il client RPC su HTTP e il proxy RPC che inserisce il pragma *via* nell'intestazione HTTP, l'autenticazione NTLM non funzionerà.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-155">Also, if there is an HTTP Proxy or a firewall between the RPC over HTTP client and the RPC Proxy which inserts the *via* pragma in the HTTP header, NTLM authentication will not work.</span></span> <span data-ttu-id="c2aaf-156">In caso contrario, le organizzazioni possono scegliere tra l'autenticazione di base e NTLM.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-156">When that is not the case, organizations can choose between Basic and NTLM authentication.</span></span> <span data-ttu-id="c2aaf-157">Il vantaggio dell'autenticazione di base è che è più veloce e più semplice e pertanto offre meno opportunità di attacchi Denial of Service.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-157">The advantage of Basic authentication is that it is faster and simpler, and therefore offers less opportunity for denial of service attacks.</span></span> <span data-ttu-id="c2aaf-158">Ma NTLM è più sicuro.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-158">But NTLM is more secure.</span></span> <span data-ttu-id="c2aaf-159">A seconda delle priorità di un'organizzazione, può scegliere di base, NTLM o consentire agli utenti di scegliere tra i due.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-159">Depending on an organization's priorities, it can choose Basic, NTLM, or allow its users to choose between the two.</span></span> <span data-ttu-id="c2aaf-160">Se si sceglie solo uno, è preferibile disattivare l'altro dalla directory virtuale del proxy RPC per ridurre il rischio di attacco.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-160">If only one is chosen, it is best to turn off the other from the RPC Proxy virtual directory to reduce risk of attack.</span></span>
-   <span data-ttu-id="c2aaf-161">**Utilizzare lo stesso set di credenziali per il proxy RPC e il server RPC su HTTP oppure utilizzare credenziali diverse per ciascuno di essi?**</span><span class="sxs-lookup"><span data-stu-id="c2aaf-161">**Use the same set of credentials for both the RPC Proxy and the RPC over HTTP Server, or use different credentials for each?**</span></span> <span data-ttu-id="c2aaf-162">Il compromesso per questa decisione è la convenienza e la sicurezza dell'utente.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-162">The tradeoff for this decision is between user's convenience and security.</span></span> <span data-ttu-id="c2aaf-163">Pochi utenti vogliono immettere più credenziali.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-163">Few users like to enter multiple credentials.</span></span> <span data-ttu-id="c2aaf-164">Tuttavia, se si verifica una violazione della sicurezza in una rete perimetrale non attendibile, la presenza di set di credenziali separati per il proxy RPC e il server RPC su HTTP forniscono protezione aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-164">However, if a security breach occurs in an untrusted perimeter network, having separate sets of credentials for the RPC Proxy and the RPC over HTTP Server provides additional protection.</span></span> <span data-ttu-id="c2aaf-165">Si noti che se vengono utilizzate credenziali separate e un set di credenziali è costituito dalle credenziali di dominio dell'utente, è consigliabile utilizzare le credenziali di dominio dell'utente per il server RPC su HTTP e non per il proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="c2aaf-165">Note that if separate credentials are used, and one set of credentials is the user's domain credentials, it is advisable to use the user's domain credentials for the RPC over HTTP Server and not for the RPC Proxy.</span></span>

 

 




