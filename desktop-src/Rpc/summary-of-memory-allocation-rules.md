---
title: Riepilogo delle regole di allocazione della memoria
description: Nella tabella seguente sono riepilogate le regole principali relative all'allocazione di memoria.
ms.assetid: 0c1f8398-75e6-45ec-a9f9-9dcdbe21c24d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f9403bb5057b2004d966c0634bc101a3282fe92
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118118"
---
# <a name="summary-of-memory-allocation-rules"></a><span data-ttu-id="1aebc-103">Riepilogo delle regole di allocazione della memoria</span><span class="sxs-lookup"><span data-stu-id="1aebc-103">Summary of Memory Allocation Rules</span></span>

<span data-ttu-id="1aebc-104">Nella tabella seguente sono riepilogate le regole principali relative all'allocazione di memoria.</span><span class="sxs-lookup"><span data-stu-id="1aebc-104">The following table summarizes key rules regarding memory allocation.</span></span>



| <span data-ttu-id="1aebc-105">Elemento MIDL</span><span class="sxs-lookup"><span data-stu-id="1aebc-105">MIDL element</span></span>                                                                                                                                           | <span data-ttu-id="1aebc-106">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1aebc-106">Description</span></span>                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1aebc-107">\[Puntatori [ref](/windows/desktop/Midl/ref) di primo livello \]</span><span class="sxs-lookup"><span data-stu-id="1aebc-107">Top-level \[ [ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                | <span data-ttu-id="1aebc-108">Deve essere puntatori non null.</span><span class="sxs-lookup"><span data-stu-id="1aebc-108">Must be non-null pointers.</span></span>                                                                                                                                            |
| <span data-ttu-id="1aebc-109">Valore restituito dalla funzione</span><span class="sxs-lookup"><span data-stu-id="1aebc-109">Function return value</span></span>                                                                                                                                  | <span data-ttu-id="1aebc-110">La nuova memoria viene sempre allocata per i valori restituiti del puntatore.</span><span class="sxs-lookup"><span data-stu-id="1aebc-110">New memory is always allocated for pointer return values.</span></span>                                                                                                             |
| <span data-ttu-id="1aebc-111">\[[Unique](/windows/desktop/Midl/unique), [out](/windows/desktop/Midl/out-idl) \] o \[ [ptr](/windows/desktop/Midl/ptr), \] puntatore out</span><span class="sxs-lookup"><span data-stu-id="1aebc-111">\[ [unique](/windows/desktop/Midl/unique), [out](/windows/desktop/Midl/out-idl)\] or \[ [ptr](/windows/desktop/Midl/ptr), out\] pointer</span></span>                                                                   | <span data-ttu-id="1aebc-112">Non consentito da MIDL.</span><span class="sxs-lookup"><span data-stu-id="1aebc-112">Not allowed by MIDL.</span></span>                                                                                                                                                  |
| <span data-ttu-id="1aebc-113">Valore univoco non di primo livello \[ [](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] o \[ [ptr](/windows/desktop/Midl/ptr), in, \] puntatore out che cambia da null a non null</span><span class="sxs-lookup"><span data-stu-id="1aebc-113">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] or \[[ptr](/windows/desktop/Midl/ptr), in, out\] pointer that changes from null to non-null</span></span> | <span data-ttu-id="1aebc-114">Gli stub client allocano la nuova memoria sul client alla restituzione.</span><span class="sxs-lookup"><span data-stu-id="1aebc-114">Client stubs allocate new memory on client on return.</span></span>                                                                                                                 |
| <span data-ttu-id="1aebc-115">Puntatore non di primo livello \[ [univoco](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] che cambia da non null a null</span><span class="sxs-lookup"><span data-stu-id="1aebc-115">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                 | <span data-ttu-id="1aebc-116">La memoria è orfana sul client; l'applicazione client è responsabile della liberazione della memoria e della prevenzione delle perdite.</span><span class="sxs-lookup"><span data-stu-id="1aebc-116">Memory is orphaned on client; client application is responsible for freeing memory and preventing leaks.</span></span>                                                              |
| <span data-ttu-id="1aebc-117">Puntatore non di primo livello \[ [](/windows/desktop/Midl/ptr), [in](/windows/desktop/Midl/in), puntatore [out](/windows/desktop/Midl/out-idl) \] che cambia da non null a null</span><span class="sxs-lookup"><span data-stu-id="1aebc-117">Non-top-level \[[ptr](/windows/desktop/Midl/ptr), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                       | <span data-ttu-id="1aebc-118">La memoria sarà orfana sul client se non è associato a un alias; in questo caso l'applicazione client è responsabile della liberazione e della prevenzione delle perdite di memoria.</span><span class="sxs-lookup"><span data-stu-id="1aebc-118">Memory will be orphaned on client if not aliased; client application is responsible for freeing and preventing memory leaks in this case.</span></span>                             |
| <span data-ttu-id="1aebc-119">\[[riferimento](/windows/desktop/Midl/ref) \] puntatori</span><span class="sxs-lookup"><span data-stu-id="1aebc-119">\[[ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                           | <span data-ttu-id="1aebc-120">Il livello applicazione client in genere alloca.</span><span class="sxs-lookup"><span data-stu-id="1aebc-120">Client-application layer usually allocates.</span></span>                                                                                                                           |
| <span data-ttu-id="1aebc-121">Non null \[ [in](/windows/desktop/Midl/in), puntatore [out](/windows/desktop/Midl/out-idl) \]</span><span class="sxs-lookup"><span data-stu-id="1aebc-121">Non-null \[[in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer</span></span>                                                                                                | <span data-ttu-id="1aebc-122">Gli stub tentano di scrivere nella risorsa di archiviazione esistente nel client.</span><span class="sxs-lookup"><span data-stu-id="1aebc-122">Stubs attempt to write into existing storage on client.</span></span> <span data-ttu-id="1aebc-123">Se la **\[ stringa \]** e le dimensioni aumentano oltre le dimensioni allocate nel client, si verificherà un errore di GP al ritorno.</span><span class="sxs-lookup"><span data-stu-id="1aebc-123">If **\[string\]** and size increases beyond size allocated on the client, it will cause a GP-fault on return.</span></span> |



 

<span data-ttu-id="1aebc-124">Nella tabella seguente sono riepilogati gli effetti degli attributi IDL e ACF chiave sulla gestione della memoria.</span><span class="sxs-lookup"><span data-stu-id="1aebc-124">The following table summarizes the effects of key IDL and ACF attributes on memory management.</span></span>



| <span data-ttu-id="1aebc-125">Funzionalità MIDL</span><span class="sxs-lookup"><span data-stu-id="1aebc-125">MIDL feature</span></span>                                                                   | <span data-ttu-id="1aebc-126">Problemi relativi al client</span><span class="sxs-lookup"><span data-stu-id="1aebc-126">Client issues</span></span>                                                                                                                                  | <span data-ttu-id="1aebc-127">Problemi del server</span><span class="sxs-lookup"><span data-stu-id="1aebc-127">Server issues</span></span>                                                                                                                 |
|--------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1aebc-128">\[[alloca](/windows/desktop/Midl/allocate)( \_ nodo singolo) \] , \[ alloca (tutti i \_ nodi)\]</span><span class="sxs-lookup"><span data-stu-id="1aebc-128">\[ [allocate](/windows/desktop/Midl/allocate)(single\_node)\], \[allocate(all\_nodes)\]</span></span>         | <span data-ttu-id="1aebc-129">Determina se vengono effettuate una o più chiamate alle funzioni di memoria.</span><span class="sxs-lookup"><span data-stu-id="1aebc-129">Determines whether one or many calls are made to the memory functions.</span></span>                                                                         | <span data-ttu-id="1aebc-130">Come per il client, ad eccezione della memoria privata, spesso è possibile usare per allocare ( \_ nodo singolo) \[ \] \[ i dati in uscita e in \] .</span><span class="sxs-lookup"><span data-stu-id="1aebc-130">Same as client, except private memory can often be used for allocate (single\_node) \[in\] and \[in,out\] data.</span></span>               |
| <span data-ttu-id="1aebc-131">\[alloca (gratuito) \] o \[ alloca (non \_ disponibile)\]</span><span class="sxs-lookup"><span data-stu-id="1aebc-131">\[allocate(free)\] or \[allocate(dont\_free)\]</span></span>                                 | <span data-ttu-id="1aebc-132">(Nessuna; influisca sul server).</span><span class="sxs-lookup"><span data-stu-id="1aebc-132">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="1aebc-133">Determina se la memoria nel server viene liberata dopo ogni chiamata di procedura remota.</span><span class="sxs-lookup"><span data-stu-id="1aebc-133">Determines whether memory on the server is freed after each remote procedure call.</span></span>                                            |
| <span data-ttu-id="1aebc-134">attributi di matrice \[ [Max \_ è](/windows/desktop/Midl/max-is) \] e \[ [dimensioni \_ ](/windows/desktop/Midl/size-is)\]</span><span class="sxs-lookup"><span data-stu-id="1aebc-134">array attributes \[ [max\_is](/windows/desktop/Midl/max-is)\] and \[ [size\_is](/windows/desktop/Midl/size-is)\]</span></span> | <span data-ttu-id="1aebc-135">(Nessuna; influisca sul server).</span><span class="sxs-lookup"><span data-stu-id="1aebc-135">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="1aebc-136">Determina la dimensione della memoria da allocare.</span><span class="sxs-lookup"><span data-stu-id="1aebc-136">Determines size of memory to be allocated.</span></span>                                                                                    |
| <span data-ttu-id="1aebc-137">\[[ \_ conteggio byte](/windows/desktop/Midl/byte-count)\]</span><span class="sxs-lookup"><span data-stu-id="1aebc-137">\[ [byte\_count](/windows/desktop/Midl/byte-count)\]</span></span>                                            | <span data-ttu-id="1aebc-138">Il client deve allocare il buffer; non allocata o liberata dagli stub client.</span><span class="sxs-lookup"><span data-stu-id="1aebc-138">Client must allocate buffer; not allocated or freed by client stubs.</span></span>                                                                           | <span data-ttu-id="1aebc-139">L'attributo del parametro ACF determina la dimensione del buffer allocato nel server.</span><span class="sxs-lookup"><span data-stu-id="1aebc-139">ACF parameter attribute determines size of buffer allocated on server.</span></span>                                                        |
| <span data-ttu-id="1aebc-140">\[[Abilita \_ allocazione](/windows/desktop/Midl/enable-allocate)\]</span><span class="sxs-lookup"><span data-stu-id="1aebc-140">\[ [enable\_allocate](/windows/desktop/Midl/enable-allocate)\]</span></span>                                  | <span data-ttu-id="1aebc-141">In genere, None.</span><span class="sxs-lookup"><span data-stu-id="1aebc-141">Usually, none.</span></span> <span data-ttu-id="1aebc-142">Tuttavia, il client potrebbe usare un ambiente di gestione della memoria diverso.</span><span class="sxs-lookup"><span data-stu-id="1aebc-142">However, the client may be using a different memory management environment.</span></span>                                                     | <span data-ttu-id="1aebc-143">Il server utilizza un ambiente di gestione della memoria diverso.</span><span class="sxs-lookup"><span data-stu-id="1aebc-143">Server uses a different memory management environment.</span></span> <span data-ttu-id="1aebc-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) deve essere utilizzato per le allocazioni.</span><span class="sxs-lookup"><span data-stu-id="1aebc-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) should be used for allocations.</span></span> |
| <span data-ttu-id="1aebc-145">\[[in](/windows/desktop/Midl/in) \] attributo</span><span class="sxs-lookup"><span data-stu-id="1aebc-145">\[ [in](/windows/desktop/Midl/in)\]attribute</span></span>                                                    | <span data-ttu-id="1aebc-146">Applicazione client responsabile dell'allocazione della memoria per i dati.</span><span class="sxs-lookup"><span data-stu-id="1aebc-146">Client application responsible for allocating memory for data.</span></span>                                                                                 | <span data-ttu-id="1aebc-147">Allocato nel server da stub.</span><span class="sxs-lookup"><span data-stu-id="1aebc-147">Allocated on server by stubs.</span></span>                                                                                                 |
| <span data-ttu-id="1aebc-148">\[in [uscita](/windows/desktop/Midl/out-idl) \] attributo</span><span class="sxs-lookup"><span data-stu-id="1aebc-148">\[ [out](/windows/desktop/Midl/out-idl)\] attribute</span></span>                                             | <span data-ttu-id="1aebc-149">Allocata nel client da stub.</span><span class="sxs-lookup"><span data-stu-id="1aebc-149">Allocated on client by stubs.</span></span>                                                                                                                  | <span data-ttu-id="1aebc-150">\[in [uscita](/windows/desktop/Midl/out-idl) \] -solo il puntatore deve essere un \[ [](/windows/desktop/Midl/ref) \] puntatore Ref, allocato nel server da stub.</span><span class="sxs-lookup"><span data-stu-id="1aebc-150">\[[out](/windows/desktop/Midl/out-idl)\]-only pointer must be \[[ref](/windows/desktop/Midl/ref)\] pointer; allocated on server by stubs.</span></span>                       |
| <span data-ttu-id="1aebc-151">\[[riferimento](/windows/desktop/Midl/ref) \] attributo</span><span class="sxs-lookup"><span data-stu-id="1aebc-151">\[ [ref](/windows/desktop/Midl/ref)\] attribute</span></span>                                                 | <span data-ttu-id="1aebc-152">La memoria a cui fa riferimento il puntatore deve essere allocata dall'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="1aebc-152">Memory referenced by pointer must be allocated by client application.</span></span>                                                                          | <span data-ttu-id="1aebc-153">Puntatori di riferimento di primo livello e di primo livello gestiti da stub.</span><span class="sxs-lookup"><span data-stu-id="1aebc-153">Top-level and first-level reference pointers managed by stubs.</span></span>                                                                |
| <span data-ttu-id="1aebc-154">\[[univoco](/windows/desktop/Midl/unique) \] attributo</span><span class="sxs-lookup"><span data-stu-id="1aebc-154">\[ [unique](/windows/desktop/Midl/unique)\] attribute</span></span>                                           | <span data-ttu-id="1aebc-155">La memoria orfana può causare un valore diverso da null. da null a non null fa sì che lo stub client chiami l' [ \_ utente MIDL \_ allocate](/windows/desktop/Midl/midl-user-allocate-1).</span><span class="sxs-lookup"><span data-stu-id="1aebc-155">Non-null to null can result in orphaned memory; null to non-null causes client stub to call [midl\_user\_allocate](/windows/desktop/Midl/midl-user-allocate-1).</span></span> | <span data-ttu-id="1aebc-156">(Influiscono sul client).</span><span class="sxs-lookup"><span data-stu-id="1aebc-156">(Affects client.)</span></span>                                                                                                             |
| <span data-ttu-id="1aebc-157">\[[ptr](/windows/desktop/Midl/ptr) \] attributo</span><span class="sxs-lookup"><span data-stu-id="1aebc-157">\[ [ptr](/windows/desktop/Midl/ptr)\] attribute</span></span>                                                 | <span data-ttu-id="1aebc-158">(Vedere \[ [univoco](/windows/desktop/Midl/unique) \] ).</span><span class="sxs-lookup"><span data-stu-id="1aebc-158">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                                              | <span data-ttu-id="1aebc-159">(Vedere \[ [univoco](/windows/desktop/Midl/unique) \] ).</span><span class="sxs-lookup"><span data-stu-id="1aebc-159">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                             |



 

 

 