---
title: Specifica di endpoint
description: Specifica di endpoint noti e dinamici in RPC (Remote Procedure Call).
ms.assetid: fc39b527-11e6-45a7-b3b5-8bcf469633d8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 373fb2818dd14670f5a939aa524c81fcdb05e20b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300176"
---
# <a name="specifying-endpoints"></a><span data-ttu-id="da84a-103">Specifica di endpoint</span><span class="sxs-lookup"><span data-stu-id="da84a-103">Specifying Endpoints</span></span>

<span data-ttu-id="da84a-104">Un endpoint è un indirizzo specifico della rete di un processo server per le chiamate a procedure remote.</span><span class="sxs-lookup"><span data-stu-id="da84a-104">An endpoint is a network-specific address of a server process for remote procedure calls.</span></span> <span data-ttu-id="da84a-105">Il nome effettivo dell'endpoint dipende dalla sequenza di protocollo utilizzata.</span><span class="sxs-lookup"><span data-stu-id="da84a-105">The actual name of the endpoint depends on the protocol sequence used.</span></span> <span data-ttu-id="da84a-106">Ad esempio, TCP, UDP e HTTP utilizzano le porte.</span><span class="sxs-lookup"><span data-stu-id="da84a-106">For example, TCP, UDP, and HTTP use ports.</span></span> <span data-ttu-id="da84a-107">Named Pipes usa un nome named pipe.</span><span class="sxs-lookup"><span data-stu-id="da84a-107">Named pipes uses a named pipe name.</span></span> <span data-ttu-id="da84a-108">Le applicazioni client/server possono utilizzare un endpoint noto o un endpoint dinamico.</span><span class="sxs-lookup"><span data-stu-id="da84a-108">Client/server applications can use a well-known endpoint or a dynamic endpoint.</span></span> <span data-ttu-id="da84a-109">In questa sezione vengono presentate le tecniche utilizzate dai programmi server per specificare endpoint noti e dinamici.</span><span class="sxs-lookup"><span data-stu-id="da84a-109">This section presents the techniques that server programs use to specify well-known and dynamic endpoints.</span></span> <span data-ttu-id="da84a-110">Le informazioni sono illustrate negli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="da84a-110">The information is discussed in the following topics:</span></span>

-   [<span data-ttu-id="da84a-111">Specifica di endpoint noti</span><span class="sxs-lookup"><span data-stu-id="da84a-111">Specifying Well-known Endpoints</span></span>](#specifying-well-known-endpoints)
-   [<span data-ttu-id="da84a-112">Specifica di endpoint dinamici</span><span class="sxs-lookup"><span data-stu-id="da84a-112">Specifying Dynamic Endpoints</span></span>](#specifying-dynamic-endpoints)

## <a name="specifying-well-known-endpoints"></a><span data-ttu-id="da84a-113">Specifica di endpoint noti</span><span class="sxs-lookup"><span data-stu-id="da84a-113">Specifying Well-known Endpoints</span></span>

<span data-ttu-id="da84a-114">Quando il server utilizza un endpoint noto, può includere i dati dell'endpoint come parte della relativa voce del database di servizio del nome.</span><span class="sxs-lookup"><span data-stu-id="da84a-114">When your server uses a well-known endpoint, it can include the endpoint data as part of its name service database entry.</span></span> <span data-ttu-id="da84a-115">In tal caso, l'handle di binding del client contiene un indirizzo server completo che include l'endpoint noto quando il client importa l'handle di associazione dalla voce del server.</span><span class="sxs-lookup"><span data-stu-id="da84a-115">If it does, the client's binding handle contains a complete server address that includes the well-known endpoint when the client imports the binding handle from the server entry.</span></span>

<span data-ttu-id="da84a-116">Il programma server può inoltre specificare endpoint noti nello stesso momento in cui vengono specificate le sequenze del protocollo.</span><span class="sxs-lookup"><span data-stu-id="da84a-116">Your server program can also specify well-known endpoints at the same time it specifies protocol sequences.</span></span> <span data-ttu-id="da84a-117">Richiamare la funzione [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) o [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) .</span><span class="sxs-lookup"><span data-stu-id="da84a-117">Invoke either the [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) or [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) function.</span></span> <span data-ttu-id="da84a-118">La differenza tra i due è che la seconda funzione presenta un parametro aggiuntivo che il server può utilizzare per controllare l'allocazione dinamica delle porte.</span><span class="sxs-lookup"><span data-stu-id="da84a-118">The difference between the two is that the latter function has an extra parameter your server can use to control dynamic port allocation.</span></span>

<span data-ttu-id="da84a-119">Se il programma server specifica le informazioni sull'endpoint in questo modo, deve chiamare anche la funzione [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) per registrare l'endpoint nella mappa dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="da84a-119">If your server program specifies its endpoint information in this way, it should also call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function to register the endpoint in the endpoint map.</span></span> <span data-ttu-id="da84a-120">Anche se l'endpoint è sempre lo stesso, il client può usare la mappa dell'endpoint per trovare il server.</span><span class="sxs-lookup"><span data-stu-id="da84a-120">Even though the endpoint is always the same, the client may use the endpoint map to find the server.</span></span>

<span data-ttu-id="da84a-121">Analogamente alle sequenze di protocollo, un'applicazione può specificare informazioni sugli endpoint nel file IDL.</span><span class="sxs-lookup"><span data-stu-id="da84a-121">Like protocol sequences, an application can specify endpoint information in its IDL file.</span></span> <span data-ttu-id="da84a-122">In tal caso, è necessario registrare contemporaneamente sia le sequenze di protocollo sia gli endpoint richiamando la funzione [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) o [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) .</span><span class="sxs-lookup"><span data-stu-id="da84a-122">When it does, it should register both the protocol sequences and endpoints at the same time by invoking the [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) or [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function.</span></span> <span data-ttu-id="da84a-123">In questo caso, il client può accedere alle informazioni sull'endpoint tramite la specifica dell'interfaccia nel file IDL.</span><span class="sxs-lookup"><span data-stu-id="da84a-123">In this case, the client has access to the endpoint information through the interface specification in the IDL file.</span></span> <span data-ttu-id="da84a-124">Pertanto, non è necessario chiamare la funzione [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) .</span><span class="sxs-lookup"><span data-stu-id="da84a-124">Therefore, it is not necessary to call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function.</span></span>

## <a name="specifying-dynamic-endpoints"></a><span data-ttu-id="da84a-125">Specifica di endpoint dinamici</span><span class="sxs-lookup"><span data-stu-id="da84a-125">Specifying Dynamic Endpoints</span></span>

<span data-ttu-id="da84a-126">Un endpoint dinamico è un endpoint assegnato dal computer host del server all'avvio dell'esecuzione del server.</span><span class="sxs-lookup"><span data-stu-id="da84a-126">A dynamic endpoint is an endpoint that the server host computer assigns when the server begins execution.</span></span> <span data-ttu-id="da84a-127">La maggior parte delle applicazioni server utilizza endpoint dinamici per evitare conflitti con altri programmi rispetto al numero limitato di porte disponibili nel computer host server.</span><span class="sxs-lookup"><span data-stu-id="da84a-127">Most server applications use dynamic endpoints to avoid conflict with other programs over the limited number of ports that are available on the server host computer system.</span></span> <span data-ttu-id="da84a-128">Tuttavia, i programmi che usano named pipe o la sequenza di protocollo [**ncalrpc**](/windows/desktop/Midl/ncalrpc) hanno uno spazio dei nomi di endpoint molto grande.</span><span class="sxs-lookup"><span data-stu-id="da84a-128">However, programs using named pipes or the [**ncalrpc**](/windows/desktop/Midl/ncalrpc) protocol sequence have a very large endpoint name space.</span></span> <span data-ttu-id="da84a-129">Traggono meno vantaggio dagli endpoint dinamici rispetto ai programmi che usano altri trasporti.</span><span class="sxs-lookup"><span data-stu-id="da84a-129">They benefit less from dynamic endpoints than programs using other transports.</span></span>

<span data-ttu-id="da84a-130">I programmi server registrano endpoint dinamici in un database di mapping degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="da84a-130">Server programs register dynamic endpoints in an endpoint map database.</span></span> <span data-ttu-id="da84a-131">Se si desidera che il server utilizzi un endpoint disponibile, chiamare [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) o [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span><span class="sxs-lookup"><span data-stu-id="da84a-131">If you want the server to use any available endpoint, call [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) or [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span></span> <span data-ttu-id="da84a-132">In questo modo viene impostata la libreria di runtime RPC per l'utilizzo di una o più sequenze di protocollo valide con endpoint dinamici.</span><span class="sxs-lookup"><span data-stu-id="da84a-132">This sets the RPC run-time library to use all or one valid protocol sequence(s) with dynamic endpoints.</span></span> <span data-ttu-id="da84a-133">Il server deve quindi chiamare [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) per ottenere un set di handle di binding validi.</span><span class="sxs-lookup"><span data-stu-id="da84a-133">The server should then call [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) to obtain a set of valid binding handles.</span></span> <span data-ttu-id="da84a-134">Il server passa il set di handle di associazione o vettore di associazione alla funzione [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) per registrare tutti gli endpoint appropriati nella mappa dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="da84a-134">The server passes the set of binding handles, or binding vector, to the function [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) to register all suitable endpoints in the endpoint map.</span></span> <span data-ttu-id="da84a-135">Per ogni chiamata eseguita dal server a **RpcEpRegister**, dovrebbe essere presente una chiamata corrispondente a [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) per rilasciare la memoria utilizzata dal vettore di associazione.</span><span class="sxs-lookup"><span data-stu-id="da84a-135">For each call your server makes to **RpcEpRegister**, there should be a corresponding call to [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) to release the memory that the binding vector uses.</span></span>

<span data-ttu-id="da84a-136">Si noti che i programmi server possono usare la funzione [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) anziché [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span><span class="sxs-lookup"><span data-stu-id="da84a-136">Note that server programs can use the [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) function rather than [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span></span> <span data-ttu-id="da84a-137">I programmi usano in genere **RpcEpRegisterNoReplace** quando più copie di un programma server devono essere eseguite in un sistema host server.</span><span class="sxs-lookup"><span data-stu-id="da84a-137">Programs typically use **RpcEpRegisterNoReplace** when multiple copies of a server program must run on a server host system.</span></span>

<span data-ttu-id="da84a-138">Entrambe le funzioni [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) e [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) aggiungono le interfacce del server e gli handle di associazione al database di mapping degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="da84a-138">Both the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) and [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) functions add the server's interfaces and binding handles to the endpoint mapper database.</span></span> <span data-ttu-id="da84a-139">Quando il client effettua una chiamata di procedura remota utilizzando un handle parzialmente associato, la libreria di runtime del client richiede al mapper dell'endpoint del computer server per l'endpoint di un'istanza del server compatibile.</span><span class="sxs-lookup"><span data-stu-id="da84a-139">When the client makes a remote procedure call using a partially bound handle, the client's run-time library asks the server computer's endpoint mapper for the endpoint of a compatible server instance.</span></span> <span data-ttu-id="da84a-140">La libreria client fornisce l'UUID dell'interfaccia, la sequenza di protocollo e, se presente, l'UUID dell'oggetto nell'handle di associazione client.</span><span class="sxs-lookup"><span data-stu-id="da84a-140">The client library supplies the interface UUID, protocol sequence, and, if present, the object UUID in the client binding handle.</span></span> <span data-ttu-id="da84a-141">Il mapper di endpoint cerca una voce di database corrispondente alle informazioni del client.</span><span class="sxs-lookup"><span data-stu-id="da84a-141">The endpoint mapper looks for a database entry that matches the client's information.</span></span> <span data-ttu-id="da84a-142">L'UUID dell'interfaccia client/server, la versione principale dell'interfaccia e la sequenza del protocollo devono corrispondere esattamente.</span><span class="sxs-lookup"><span data-stu-id="da84a-142">The client/server interface UUID, the interface major version, and protocol sequence must all match exactly.</span></span> <span data-ttu-id="da84a-143">Inoltre, la versione secondaria dell'interfaccia del server deve essere maggiore o uguale alla versione secondaria del client.</span><span class="sxs-lookup"><span data-stu-id="da84a-143">In addition, the server's interface minor version must be greater than or equal to the client's minor version.</span></span>

<span data-ttu-id="da84a-144">Se tutti i test hanno esito positivo, il mapper dell'endpoint restituisce l'endpoint valido e la libreria di runtime del client aggiorna l'endpoint nell'handle di associazione.</span><span class="sxs-lookup"><span data-stu-id="da84a-144">If all tests are successful, the endpoint mapper returns the valid endpoint and the client run-time library updates the endpoint in the binding handle.</span></span>

<span data-ttu-id="da84a-145">Gli endpoint dinamici vengono eliminati automaticamente dal database di mapping degli endpoint quando il processo del server smette di funzionare.</span><span class="sxs-lookup"><span data-stu-id="da84a-145">Dynamic endpoints are automatically purged from the endpoint mapper database when the server process stops running.</span></span> <span data-ttu-id="da84a-146">È possibile rimuovere l'endpoint dal database di mapping degli endpoint prima che il programma server venga chiuso utilizzando la funzione [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) oppure è possibile consentire la pulizia automatica per gestire la rimozione dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="da84a-146">You can either remove the endpoint from the endpoint mapper database before the server program exits using the [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) function, or you can allow automatic cleanup to manage removal of the endpoint.</span></span>

 

 