---
title: Gestione degli errori (RPC)
description: In RPC sincrono, un client esegue una chiamata remota che restituisce un codice di esito positivo o negativo.
ms.assetid: 7dfc9f84-ce3c-49f3-8f72-b212095133fd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 017892b94438cc73f88cbfe60c03c088bf3ebcc9
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/10/2020
ms.locfileid: "104047768"
---
# <a name="error-handling-rpc"></a><span data-ttu-id="50d80-103">Gestione degli errori (RPC)</span><span class="sxs-lookup"><span data-stu-id="50d80-103">Error Handling (RPC)</span></span>

<span data-ttu-id="50d80-104">In RPC sincrono, un client esegue una chiamata remota che restituisce un codice di esito positivo o negativo.</span><span class="sxs-lookup"><span data-stu-id="50d80-104">In synchronous RPC, a client makes a remote call that returns with either a success or failure code.</span></span> <span data-ttu-id="50d80-105">Il RPC asincrono offre più possibilità di errore di una chiamata e questi errori vengono gestiti in modo diverso, a seconda di dove e quando si verificano.</span><span class="sxs-lookup"><span data-stu-id="50d80-105">Asynchronous RPC provides more opportunities for a call to fail, and these failures are handled differently, depending on where and when they occur.</span></span> <span data-ttu-id="50d80-106">Nella tabella seguente vengono descritte le modalità con cui una chiamata può avere esito negativo e il modo in cui viene gestita.</span><span class="sxs-lookup"><span data-stu-id="50d80-106">The following table describes the ways in which a call can fail, and how it is handled.</span></span>

## <a name="client-side-cleanup"></a><span data-ttu-id="50d80-107">Pulizia lato client</span><span class="sxs-lookup"><span data-stu-id="50d80-107">Client-side Cleanup</span></span>



| <span data-ttu-id="50d80-108">Sintomo errore</span><span class="sxs-lookup"><span data-stu-id="50d80-108">Failure symptom</span></span>                                                                                                                                  | <span data-ttu-id="50d80-109">Pulizia</span><span class="sxs-lookup"><span data-stu-id="50d80-109">Cleanup</span></span>                                                                                                                         |
|--------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="50d80-110">Il client rileva un'eccezione quando chiama la procedura remota.</span><span class="sxs-lookup"><span data-stu-id="50d80-110">Client catches an exception when it calls the remote procedure.</span></span>                                                                                  | <span data-ttu-id="50d80-111">Non sono necessarie chiamate API RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-111">No RPC API calls are necessary.</span></span> <span data-ttu-id="50d80-112">È stato eliminato tutto lo stato RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-112">All RPC state has been cleaned up.</span></span>                                                              |
| <span data-ttu-id="50d80-113">Il client riceve una notifica di completamento chiamata, ma quando chiama [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall), riceve un codice di errore.</span><span class="sxs-lookup"><span data-stu-id="50d80-113">Client receives a call complete notification, but when it calls [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall), it receives an error code.</span></span> | <span data-ttu-id="50d80-114">Non sono necessarie chiamate API RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-114">No RPC API calls are necessary.</span></span> <span data-ttu-id="50d80-115">È stato eliminato tutto lo stato RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-115">All RPC state has been cleaned up.</span></span>                                                              |
| <span data-ttu-id="50d80-116">Il client genera un annullamento non interrotto o interrotto.</span><span class="sxs-lookup"><span data-stu-id="50d80-116">Client issues non-abortive or abortive cancel.</span></span>                                                                                                   | <span data-ttu-id="50d80-117">Il client deve attendere la notifica e chiamare [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) all'arrivo della notifica.</span><span class="sxs-lookup"><span data-stu-id="50d80-117">Client must wait for notification, and call [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) when the notification arrives.</span></span> |



 

<span data-ttu-id="50d80-118">In pulizia lato server, un concetto chiave è il punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="50d80-118">In server side cleanup, a key concept is the hand-off point.</span></span> <span data-ttu-id="50d80-119">Durante l'elaborazione lato server di una chiamata asincrona, alcune elaborazioni vengono in genere eseguite sul thread che ha ricevuto la chiamata (noto anche come *thread Dispatcher*) e, facoltativamente, il thread Dispatcher inserisce uno stato sufficiente in un blocco di memoria e segnala a un altro thread (noto anche come *thread di lavoro*) di continuare l'elaborazione per la chiamata.</span><span class="sxs-lookup"><span data-stu-id="50d80-119">During the server side processing of an asynchronous call, some processing is usually performed on the thread that received the call (also known as the *dispatcher thread*), and then, optionally, the dispatcher thread puts enough state into a memory block and signals another thread (also known as *worker thread*) to continue processing for the call.</span></span> <span data-ttu-id="50d80-120">Momento in cui il thread del dispatcher segnala correttamente che il thread di lavoro è denominato *punto di consegna*.</span><span class="sxs-lookup"><span data-stu-id="50d80-120">The moment at which the dispatcher thread successfully signals that the worker thread is called the *hand-off point*.</span></span>

## <a name="server-side-cleanup"></a><span data-ttu-id="50d80-121">Pulizia lato server</span><span class="sxs-lookup"><span data-stu-id="50d80-121">Server Side Cleanup</span></span>



| <span data-ttu-id="50d80-122">Errore rilevato</span><span class="sxs-lookup"><span data-stu-id="50d80-122">Error encountered</span></span>      | <span data-ttu-id="50d80-123">Pulizia</span><span class="sxs-lookup"><span data-stu-id="50d80-123">Cleanup</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="50d80-124">Prima di passare al punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="50d80-124">Before hand-off point.</span></span> | <span data-ttu-id="50d80-125">Genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="50d80-125">Throw exception.</span></span> <span data-ttu-id="50d80-126">Non è necessaria alcuna chiamata a [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) .</span><span class="sxs-lookup"><span data-stu-id="50d80-126">No call to [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) is necessary.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="50d80-127">Dopo il punto di consegna.</span><span class="sxs-lookup"><span data-stu-id="50d80-127">After hand-off point.</span></span>  | <span data-ttu-id="50d80-128">Chiamare [**RpcAsyncAbortCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasyncabortcall) o, se l'errore non è irreversibile e i risultati possono comunque essere restituiti al client, [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall).</span><span class="sxs-lookup"><span data-stu-id="50d80-128">Call [**RpcAsyncAbortCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasyncabortcall) or, if the error is not fatal and results can still be returned to the client, [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall).</span></span> <span data-ttu-id="50d80-129">Se la chiamata alla funzione **RpcAsyncCompleteCall** ha esito negativo, il runtime RPC libera i parametri.</span><span class="sxs-lookup"><span data-stu-id="50d80-129">If the **RpcAsyncCompleteCall** function call fails, the RPC runtime frees the parameters.</span></span> <span data-ttu-id="50d80-130">L'utente non deve accedere a tali parametri.</span><span class="sxs-lookup"><span data-stu-id="50d80-130">The user must not access those parameters.</span></span> <span data-ttu-id="50d80-131">Il thread Dispatcher non deve eseguire alcuna elaborazione sostanziale che può avere esito negativo dopo il punto di partenza, perché non è più in grado di interrompere in modo sicuro la chiamata.</span><span class="sxs-lookup"><span data-stu-id="50d80-131">The dispatcher thread must not perform any substantial processing that may fail after the hand off point, because it no longer can safely abort the call.</span></span> <span data-ttu-id="50d80-132">In particolare, non deve generare un'eccezione dopo la consegna del punto o il server potrebbe arrestarsi in modo anomalo.</span><span class="sxs-lookup"><span data-stu-id="50d80-132">Specifically, it must not throw an exception after the hand off point, or the server may crash.</span></span> |



 

## <a name="special-error-handling-cases-for-pipes"></a><span data-ttu-id="50d80-133">Casi speciali di gestione degli errori per le pipe</span><span class="sxs-lookup"><span data-stu-id="50d80-133">Special Error Handling Cases for Pipes</span></span>

<span data-ttu-id="50d80-134">Quando si usano le pipe, esistono casi speciali per la gestione degli errori.</span><span class="sxs-lookup"><span data-stu-id="50d80-134">There are special cases for error handling when using pipes.</span></span> <span data-ttu-id="50d80-135">Nell'elenco seguente viene illustrata l'origine dell'errore e viene illustrato come gestire l'errore.</span><span class="sxs-lookup"><span data-stu-id="50d80-135">The following list explains the source of the failure, and how to handle the error.</span></span>



| <span data-ttu-id="50d80-136">Origine dell'errore</span><span class="sxs-lookup"><span data-stu-id="50d80-136">Source of failure</span></span>                                                                                                 | <span data-ttu-id="50d80-137">Modalità di gestione</span><span class="sxs-lookup"><span data-stu-id="50d80-137">How handled</span></span>                                                                                                |
|-------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="50d80-138">Il client chiama push e la chiamata ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="50d80-138">Client calls push and the call fails.</span></span>                                                                             | <span data-ttu-id="50d80-139">Non sono necessarie chiamate API RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-139">No RPC API calls are necessary.</span></span> <span data-ttu-id="50d80-140">È stato eliminato tutto lo stato RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-140">All RPC state has been cleaned up.</span></span>                                         |
| <span data-ttu-id="50d80-141">Il client chiama [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) prima che il [**in**](/windows/desktop/Midl/in) Pipes venga svuotato.</span><span class="sxs-lookup"><span data-stu-id="50d80-141">Client calls [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) before the [**in**](/windows/desktop/Midl/in) pipes are drained.</span></span> | <span data-ttu-id="50d80-142">La chiamata ha esito negativo con il codice di errore di riempimento pipe appropriato.</span><span class="sxs-lookup"><span data-stu-id="50d80-142">Call fails with the appropriate pipe-filling error code.</span></span>                                                   |
| <span data-ttu-id="50d80-143">Il client chiama pull e la chiamata ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="50d80-143">Client calls pull and the call fails.</span></span>                                                                             | <span data-ttu-id="50d80-144">Non sono necessarie chiamate API RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-144">No RPC API calls are necessary.</span></span> <span data-ttu-id="50d80-145">È stato eliminato tutto lo stato RPC.</span><span class="sxs-lookup"><span data-stu-id="50d80-145">All RPC state has been cleaned up.</span></span>                                         |
| <span data-ttu-id="50d80-146">Il client o il server chiama push o pull nell'ordine errato.</span><span class="sxs-lookup"><span data-stu-id="50d80-146">Either client or server calls push or pull in the wrong order.</span></span>                                                    | <span data-ttu-id="50d80-147">Run-Time restituisce lo stato di errore di riempimento della pipe.</span><span class="sxs-lookup"><span data-stu-id="50d80-147">Run-time returns pipe-filling error status.</span></span>                                                                |
| <span data-ttu-id="50d80-148">Il server chiama push o pull e la chiamata ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="50d80-148">Server calls push or pull and the call fails.</span></span>                                                                     | <span data-ttu-id="50d80-149">Push restituisce un codice di errore.</span><span class="sxs-lookup"><span data-stu-id="50d80-149">Push returns a failure code.</span></span> <span data-ttu-id="50d80-150">Non è necessaria alcuna chiamata a [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) .</span><span class="sxs-lookup"><span data-stu-id="50d80-150">No call to [**RpcAsyncCompleteCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasynccompletecall) is necessary.</span></span> |
| <span data-ttu-id="50d80-151">Il server chiama **RpcAsyncCompleteCall** prima che le pipe siano state svuotate.</span><span class="sxs-lookup"><span data-stu-id="50d80-151">Server calls **RpcAsyncCompleteCall** before the pipes have been drained.</span></span>                                         | <span data-ttu-id="50d80-152">La chiamata pipe restituisce uno stato di errore di riempimento della pipe.</span><span class="sxs-lookup"><span data-stu-id="50d80-152">The pipe call returns a pipe filling error status.</span></span>                                                         |
| <span data-ttu-id="50d80-153">Dopo l'invio, un'operazione di ricezione ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="50d80-153">After the dispatch, a receive operation fails.</span></span>                                                                    | <span data-ttu-id="50d80-154">La volta successiva che il server chiama pull per ricevere i dati della pipe, viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="50d80-154">The next time the server calls pull to receive pipe data, an error is returned.</span></span>                            |



 

 

 
