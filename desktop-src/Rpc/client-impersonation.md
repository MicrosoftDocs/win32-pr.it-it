---
title: Rappresentazione client (RPC)
description: La rappresentazione è utile in un ambiente di elaborazione distribuita quando i server devono passare richieste client ad altri processi del server o al sistema operativo.
ms.assetid: 49d833d8-c61c-4746-91cf-c0753847cd3d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d03ad3b4d9e2984708e8b274ab9bc57c3235808b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118235"
---
# <a name="client-impersonation"></a><span data-ttu-id="22ef5-103">Rappresentazione client</span><span class="sxs-lookup"><span data-stu-id="22ef5-103">Client Impersonation</span></span>

<span data-ttu-id="22ef5-104">La rappresentazione è utile in un ambiente di elaborazione distribuita quando i server devono passare richieste client ad altri processi del server o al sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="22ef5-104">Impersonation is useful in a distributed computing environment when servers must pass client requests to other server processes or to the operating system.</span></span> <span data-ttu-id="22ef5-105">In questo caso, un server rappresenta il contesto di sicurezza del client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-105">In this case, a server impersonates the client's security context.</span></span> <span data-ttu-id="22ef5-106">Gli altri processi server possono quindi gestire la richiesta come se venisse eseguita dal client originale.</span><span class="sxs-lookup"><span data-stu-id="22ef5-106">Other server processes can then handle the request as if the original client made it.</span></span>

![il server rappresenta un client chiamante quando si effettuano chiamate successive per conto dell'utente](images/impr.png)

<span data-ttu-id="22ef5-108">Un client, ad esempio, effettua una richiesta al server A. Se il server A deve eseguire una query sul server B per completare la richiesta, il server A rappresenta il contesto di sicurezza del client ed effettua la richiesta al server B per conto del client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-108">For example, a client makes a request to Server A. If Server A must query Server B to complete the request, Server A impersonates the client security context and makes the request to Server B on behalf of the client.</span></span> <span data-ttu-id="22ef5-109">Il server B usa il contesto di sicurezza del client originale, anziché l'identità di sicurezza per il server A, per determinare se completare l'attività.</span><span class="sxs-lookup"><span data-stu-id="22ef5-109">Server B uses the original client's security context, instead of the security identity for Server A, to determine whether to complete the task.</span></span>

<span data-ttu-id="22ef5-110">Il server chiama [**RpcImpersonateClient**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcimpersonateclient) per sovrascrivere la sicurezza per il thread del server con il contesto di sicurezza del client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-110">The server calls [**RpcImpersonateClient**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcimpersonateclient) to overwrite the security for the server thread with the client security context.</span></span> <span data-ttu-id="22ef5-111">Al termine dell'attività, il server chiama [**RpcRevertToSelf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcreverttoself) o [**RpcRevertToSelfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcreverttoselfex) per ripristinare il contesto di sicurezza definito per il thread del server.</span><span class="sxs-lookup"><span data-stu-id="22ef5-111">After the task is completed, the server calls [**RpcRevertToSelf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcreverttoself) or [**RpcRevertToSelfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcreverttoselfex) to restore the security context defined for the server thread.</span></span>

<span data-ttu-id="22ef5-112">Quando si esegue l'associazione, il client può specificare informazioni di qualità del servizio sulla sicurezza, che specifica come il server può rappresentare il client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-112">When binding, the client can specify quality-of-service information about security which specifies how the server can impersonate the client.</span></span> <span data-ttu-id="22ef5-113">Una delle impostazioni, ad esempio, consente al client di specificare che il server non può rappresentare l'utente.</span><span class="sxs-lookup"><span data-stu-id="22ef5-113">For example, one of the settings lets the client specify that the server is not allowed to impersonate it.</span></span> <span data-ttu-id="22ef5-114">Per ulteriori informazioni, vedere la pagina relativa alla [qualità del servizio](quality-of-service.md).</span><span class="sxs-lookup"><span data-stu-id="22ef5-114">For more information, see [Quality of Service](quality-of-service.md).</span></span>

<span data-ttu-id="22ef5-115">La possibilità di chiamare altri server durante la rappresentazione del client originale viene chiamata *delega*.</span><span class="sxs-lookup"><span data-stu-id="22ef5-115">The capability to call other servers while impersonating the original client is called *delegation*.</span></span> <span data-ttu-id="22ef5-116">Quando si usa la delega, un server che rappresenta un client può chiamare un altro server e può effettuare chiamate di rete con le credenziali del client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-116">When delegation is used, a server impersonating a client can call another server, and can make network calls with the credentials of the client.</span></span> <span data-ttu-id="22ef5-117">Ovvero dal punto di vista del secondo server, le richieste provenienti dal primo server non sono distinguibili dalle richieste provenienti dal client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-117">That is, from the perspective of the second server, requests coming from the first server are indistinguishable from requests coming from the client.</span></span> <span data-ttu-id="22ef5-118">Non tutti i provider di sicurezza supportano la delega.</span><span class="sxs-lookup"><span data-stu-id="22ef5-118">Not all security providers support delegation.</span></span> <span data-ttu-id="22ef5-119">Microsoft fornisce un solo provider di sicurezza che supporta la delega: Kerberos.</span><span class="sxs-lookup"><span data-stu-id="22ef5-119">Microsoft ships only one security provider that supports delegation: Kerberos.</span></span>

<span data-ttu-id="22ef5-120">La delega può essere una funzionalità pericolosa a causa dei privilegi che il client assegna al server durante una chiamata di procedura remota.</span><span class="sxs-lookup"><span data-stu-id="22ef5-120">Delegation can be a dangerous capability due to the privileges the client gives the server during a remote procedure call.</span></span> <span data-ttu-id="22ef5-121">Questo è il motivo per cui Kerberos consente le chiamate con il livello di rappresentazione della delega solo se è richiesta l'autenticazione reciproca.</span><span class="sxs-lookup"><span data-stu-id="22ef5-121">This is why Kerberos allows calls with the impersonation level of delegation only if mutual authentication is requested.</span></span> <span data-ttu-id="22ef5-122">Gli amministratori di dominio possono limitare i computer a cui vengono effettuate chiamate con livello di rappresentazione della delega per impedire ai client non sospetti di effettuare chiamate a server che potrebbero usare le credenziali.</span><span class="sxs-lookup"><span data-stu-id="22ef5-122">Domain administrators can limit the computers to which calls with delegation impersonation level are made to prevent unsuspecting clients from making calls to servers that could abuse their credentials.</span></span>

<span data-ttu-id="22ef5-123">Un'eccezione alla regola di delega esiste: chiama usando [**ncalrpc**](/windows/desktop/Midl/ncalrpc).</span><span class="sxs-lookup"><span data-stu-id="22ef5-123">One exception to the delegation rule exists: calls using [**ncalrpc**](/windows/desktop/Midl/ncalrpc).</span></span> <span data-ttu-id="22ef5-124">Quando queste chiamate vengono effettuate, il server ottiene i diritti di delega, anche se viene specificato un livello di rappresentazione di Impersonate.</span><span class="sxs-lookup"><span data-stu-id="22ef5-124">When these calls are made the server gets delegation rights, even if an impersonation level of impersonate is specified.</span></span> <span data-ttu-id="22ef5-125">Ovvero, un server può chiamare altri server per conto del client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-125">That is, a server can call other servers on behalf of the client.</span></span> <span data-ttu-id="22ef5-126">Funziona solo per una chiamata remota.</span><span class="sxs-lookup"><span data-stu-id="22ef5-126">This works for one remote call only.</span></span> <span data-ttu-id="22ef5-127">Se, ad esempio, il client A chiama il server locale LB usando **ncalrpc** local server lb, può rappresentare e chiamare il server remoto RB.</span><span class="sxs-lookup"><span data-stu-id="22ef5-127">For example, if client A calls local server LB using **ncalrpc** local server LB can impersonate and call remote server RB.</span></span> <span data-ttu-id="22ef5-128">RB potrà agire per conto del client A, ma solo sul computer remoto su cui è in esecuzione RB.</span><span class="sxs-lookup"><span data-stu-id="22ef5-128">RB will be able to act on behalf of client A, but only on the remote computer that RB is running on.</span></span> <span data-ttu-id="22ef5-129">Non è possibile effettuare un'altra chiamata di rete al computer remoto C, a meno che LB non abbia specificato un livello di rappresentazione delegata quando si chiama RB.</span><span class="sxs-lookup"><span data-stu-id="22ef5-129">It cannot make another network call to remote computer C unless LB specified an impersonation level of delegate when it called RB.</span></span>

> [!Note]  
> <span data-ttu-id="22ef5-130">Il termine *rappresentazione* rappresenta due significati sovrapposti.</span><span class="sxs-lookup"><span data-stu-id="22ef5-130">The term *impersonation* represents two overlapping meanings.</span></span> <span data-ttu-id="22ef5-131">Il primo significato della rappresentazione è il processo generale di agire per conto di un client.</span><span class="sxs-lookup"><span data-stu-id="22ef5-131">The first meaning of impersonation is the general process of acting on behalf of a client.</span></span> <span data-ttu-id="22ef5-132">Il secondo significato è il livello di rappresentazione specifico definito rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="22ef5-132">The second meaning is the specific impersonation level called impersonation.</span></span> <span data-ttu-id="22ef5-133">Il contesto del testo indica in genere il significato.</span><span class="sxs-lookup"><span data-stu-id="22ef5-133">The context of the text generally clarifies the meaning.</span></span>

 

 

 