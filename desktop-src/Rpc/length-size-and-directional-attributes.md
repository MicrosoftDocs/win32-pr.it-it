---
title: Attributi di lunghezza, dimensioni e direzionali
description: Per passare le matrici tra il client e il server, gli attributi relativi alle dimensioni \ Max \_ sono \ e \ size \_ è \ determinare il numero di elementi della matrice allocati dallo stub del server.
ms.assetid: 2c95cf47-6fc0-4ccd-bb4f-acf356596e56
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98ffbf1ac75ad82a89e258ab595590fce2190b9e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103729306"
---
# <a name="length-size-and-directional-attributes"></a><span data-ttu-id="25d5b-103">Attributi di lunghezza, dimensioni e direzionali</span><span class="sxs-lookup"><span data-stu-id="25d5b-103">Length, Size, and Directional Attributes</span></span>

<span data-ttu-id="25d5b-104">Nel passaggio di matrici tra il client e il server, gli attributi relativi alle dimensioni \[ [**Max \_ è**](/windows/desktop/Midl/max-is) \] e \[ [**size \_**](/windows/desktop/Midl/size-is) \] determinano il numero di elementi di matrice allocati dallo stub del server.</span><span class="sxs-lookup"><span data-stu-id="25d5b-104">In passing arrays between the client and the server, the size-related attributes \[[**max\_is**](/windows/desktop/Midl/max-is)\] and \[[**size\_is**](/windows/desktop/Midl/size-is)\] determine how many array elements the server stub allocates.</span></span> <span data-ttu-id="25d5b-105">La lunghezza degli attributi correlati alla lunghezza \[ [**\_ è**](/windows/desktop/Midl/length-is) \] , \[ [**First \_ è**](/windows/desktop/Midl/first-is) \] e \[ [**Last \_ è**](/windows/desktop/Midl/last-is) \] determinare il numero di elementi trasmessi sia al server che al client.</span><span class="sxs-lookup"><span data-stu-id="25d5b-105">The length-related attributes \[[**length\_is**](/windows/desktop/Midl/length-is)\], \[[**first\_is**](/windows/desktop/Midl/first-is)\], and \[[**last\_is**](/windows/desktop/Midl/last-is)\] determine how many elements are transmitted to both the server and the client.</span></span>

<span data-ttu-id="25d5b-106">È possibile applicare attributi direzionali diversi ai parametri.</span><span class="sxs-lookup"><span data-stu-id="25d5b-106">Different directional attributes can be applied to parameters.</span></span> <span data-ttu-id="25d5b-107">Tuttavia, alcune combinazioni di attributi direzionali possono causare errori.</span><span class="sxs-lookup"><span data-stu-id="25d5b-107">However, some combinations of directional attributes can cause errors.</span></span> <span data-ttu-id="25d5b-108">Si supponga, ad esempio, di scrivere un'interfaccia che specifichi una routine con due parametri, una matrice e la lunghezza trasmessa della matrice.</span><span class="sxs-lookup"><span data-stu-id="25d5b-108">As an example, suppose you are writing an interface that specifies a procedure with two parameters, an array, and the transmitted length of the array.</span></span> <span data-ttu-id="25d5b-109">Il termine *dir \_ attr* si riferisce all'attributo direzionale applicato al parametro come:</span><span class="sxs-lookup"><span data-stu-id="25d5b-109">The term *dir\_attr* refers to the directional attribute applied to the parameter as:</span></span>

``` syntax
Proc1(
    [dir_attr] short *plength;
    [dir_attr, length_is(pLength)] short array[MAX_SIZE]);
```

<span data-ttu-id="25d5b-110">Il comportamento del compilatore MIDL per ogni combinazione di attributi direzionali è descritto nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="25d5b-110">The MIDL compiler behavior for each combination of directional attributes is described in the following table.</span></span>



| <span data-ttu-id="25d5b-111">Array</span><span class="sxs-lookup"><span data-stu-id="25d5b-111">Array</span></span>                                          | <span data-ttu-id="25d5b-112">Parametro length</span><span class="sxs-lookup"><span data-stu-id="25d5b-112">Length parameter</span></span>                               | <span data-ttu-id="25d5b-113">Azioni Stub durante la chiamata dal client al server</span><span class="sxs-lookup"><span data-stu-id="25d5b-113">Stub actions during call from client to server</span></span>                                                                                                                                                                                                                          | <span data-ttu-id="25d5b-114">Azioni Stub al ritorno da server a client</span><span class="sxs-lookup"><span data-stu-id="25d5b-114">Stub actions on return from server to client</span></span>                                                                                                                                                                         |
|------------------------------------------------|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="25d5b-115">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-115">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-116">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-116">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-117">Trasmettere la lunghezza e il numero di elementi indicati dal parametro.</span><span class="sxs-lookup"><span data-stu-id="25d5b-117">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="25d5b-118">Nessun dato trasmesso.</span><span class="sxs-lookup"><span data-stu-id="25d5b-118">No data transmitted.</span></span>                                                                                                                                                                                                 |
| <span data-ttu-id="25d5b-119">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-119">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-120">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-120">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-121">Non valido; Errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-121">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                                                                         | <span data-ttu-id="25d5b-122">Non valido; Errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-122">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="25d5b-123">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-123">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-124">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-124">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-125">Trasmettere la lunghezza e il numero di elementi indicati dal parametro length.</span><span class="sxs-lookup"><span data-stu-id="25d5b-125">Transmit the length and the number of elements indicated by the length parameter.</span></span>                                                                                                                                                                                       | <span data-ttu-id="25d5b-126">Trasmettere solo la lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-126">Transmit the length only.</span></span>                                                                                                                                                                                            |
| <span data-ttu-id="25d5b-127">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-127">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-128">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-128">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-129">Trasmettere la lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-129">Transmit the length.</span></span><br/> <span data-ttu-id="25d5b-130">Se le dimensioni della matrice sono fisse, allocare le dimensioni della matrice sul server, ma non trasmettere alcun elemento.</span><span class="sxs-lookup"><span data-stu-id="25d5b-130">If array size is fixed, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="25d5b-131">Se la dimensione della matrice non è associata, non valida: errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-131">If array size is not bound, not legal: MIDL compiler error.</span></span><br/>                                                              | <span data-ttu-id="25d5b-132">Trasmette il numero di elementi indicato dalla lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-132">Transmit the number of elements indicated by the length.</span></span><br/> <span data-ttu-id="25d5b-133">Si noti che la lunghezza può essere modificata e può avere un valore diverso dal valore del client.</span><span class="sxs-lookup"><span data-stu-id="25d5b-133">Note that the length can be changed and can have a different value from the value on the client.</span></span> <span data-ttu-id="25d5b-134">Non trasmettere la lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-134">Do not transmit the length.</span></span><br/>          |
| <span data-ttu-id="25d5b-135">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-135">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-136">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-136">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-137">Allocare spazio per il parametro length sul server ma non trasmettere il parametro.</span><span class="sxs-lookup"><span data-stu-id="25d5b-137">Allocate space for the length parameter on the server but do not transmit the parameter.</span></span> <span data-ttu-id="25d5b-138">Se le dimensioni della matrice sono fisse, allocare le dimensioni della matrice sul server, ma non trasmettere alcun elemento.</span><span class="sxs-lookup"><span data-stu-id="25d5b-138">If the array size is fixed, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="25d5b-139">Se la dimensione della matrice non è fissa, non valida: errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-139">If array size is not fixed, not legal: MIDL compiler error.</span></span><br/> | <span data-ttu-id="25d5b-140">Trasmettere la lunghezza e il numero di elementi indicati dalla lunghezza impostata dall'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="25d5b-140">Transmit the length and the number of elements indicated by the length as set by the server application.</span></span>                                                                                                             |
| <span data-ttu-id="25d5b-141">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-141">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-142">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-142">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-143">Trasmettere il parametro length.</span><span class="sxs-lookup"><span data-stu-id="25d5b-143">Transmit the length parameter.</span></span> <span data-ttu-id="25d5b-144">Se la dimensione della matrice è associata, allocare la dimensione della matrice sul server, ma non trasmettere alcun elemento.</span><span class="sxs-lookup"><span data-stu-id="25d5b-144">If the array size is bound, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="25d5b-145">Se la dimensione della matrice non è associata, non valida: errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-145">If array size is not bound, not legal: MIDL compiler error.</span></span><br/>                                                           | <span data-ttu-id="25d5b-146">Trasmettere la lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-146">Transmit the length.</span></span> <span data-ttu-id="25d5b-147">Trasmette il numero di elementi di matrice indicati dalla lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-147">Transmit the number of array elements indicated by the length.</span></span><br/>                                                                                                                       |
| <span data-ttu-id="25d5b-148">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-148">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-149">\[[**in**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-149">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="25d5b-150">Trasmettere la lunghezza e il numero di elementi indicati dal parametro.</span><span class="sxs-lookup"><span data-stu-id="25d5b-150">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="25d5b-151">Non trasmettere la lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-151">Do not transmit the length.</span></span> <span data-ttu-id="25d5b-152">Trasmette il numero di elementi indicato dalla lunghezza.</span><span class="sxs-lookup"><span data-stu-id="25d5b-152">Transmit the number of elements indicated by the length.</span></span><br/> <span data-ttu-id="25d5b-153">Si noti che la lunghezza può essere modificata e può avere un valore diverso rispetto al valore originale nel client.</span><span class="sxs-lookup"><span data-stu-id="25d5b-153">Note that the length can be changed and can have a different value from the original value on the client.</span></span><br/> |
| <span data-ttu-id="25d5b-154">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-154">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-155">\[[**out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-155">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="25d5b-156">Non valido; Errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-156">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                                                                         | <span data-ttu-id="25d5b-157">Non valido; Errore del compilatore MIDL.</span><span class="sxs-lookup"><span data-stu-id="25d5b-157">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="25d5b-158">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-158">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-159">\[[**in**](/windows/desktop/Midl/in) [ **uscita**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="25d5b-159">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="25d5b-160">Trasmettere la lunghezza e il numero di elementi indicati dal parametro.</span><span class="sxs-lookup"><span data-stu-id="25d5b-160">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="25d5b-161">Trasmettere la lunghezza e il numero di elementi indicati dal parametro.</span><span class="sxs-lookup"><span data-stu-id="25d5b-161">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                           |



 

<span data-ttu-id="25d5b-162">In generale, non è consigliabile modificare i parametri length o size sul lato server.</span><span class="sxs-lookup"><span data-stu-id="25d5b-162">In general, you should not modify the length or size parameters on the server side.</span></span> <span data-ttu-id="25d5b-163">Se si modifica il parametro length, è possibile che la memoria sia orfana.</span><span class="sxs-lookup"><span data-stu-id="25d5b-163">If you change the length parameter, you can orphan memory.</span></span> <span data-ttu-id="25d5b-164">Per ulteriori informazioni, vedere [orfano di memoria](memory-orphaning.md).</span><span class="sxs-lookup"><span data-stu-id="25d5b-164">For more information, see [Memory Orphaning](memory-orphaning.md).</span></span>

 

