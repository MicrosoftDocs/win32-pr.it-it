---
title: Sicurezza RPC su HTTP
description: In RPC su HTTP sono disponibili tre tipi di sicurezza, oltre alla sicurezza RPC standard, il che comporta il traffico RPC su HTTP protetto una sola volta da RPC, quindi doppiamente protetto dal meccanismo di tunneling fornito da RPC su HTTP.
ms.assetid: 3a44c72b-b74c-433a-8826-1f76ca019f40
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 527cf5ff74120c41606d83a248e355a6ea46d9d5
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/12/2021
ms.locfileid: "104234453"
---
# <a name="rpc-over-http-security"></a><span data-ttu-id="2a42a-103">Sicurezza RPC su HTTP</span><span class="sxs-lookup"><span data-stu-id="2a42a-103">RPC over HTTP Security</span></span>

<span data-ttu-id="2a42a-104">In RPC su HTTP sono disponibili tre tipi di sicurezza, oltre alla sicurezza RPC standard, il che comporta il traffico RPC su HTTP protetto una sola volta da RPC, quindi doppiamente protetto dal meccanismo di tunneling fornito da RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="2a42a-104">RPC over HTTP provides three types of security in addition to standard RPC security, which results in RPC over HTTP traffic being protected once by RPC, and then doubly protected by the tunneling mechanism provided by RPC over HTTP.</span></span> <span data-ttu-id="2a42a-105">Per una descrizione dei meccanismi di sicurezza RPC standard, vedere [sicurezza](security.md).</span><span class="sxs-lookup"><span data-stu-id="2a42a-105">For a description of standard RPC security mechanisms, see [Security](security.md).</span></span> <span data-ttu-id="2a42a-106">Il meccanismo di tunneling RPC su HTTP consente di aggiungere alla sicurezza RPC normale nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="2a42a-106">The RPC over HTTP tunneling mechanism adds to normal RPC security in the following manner:</span></span>

-   <span data-ttu-id="2a42a-107">Fornisce sicurezza attraverso IIS (disponibile solo per RPC su HTTP v2).</span><span class="sxs-lookup"><span data-stu-id="2a42a-107">Provides security through the IIS (available for RPC over HTTP v2 only).</span></span>
-   <span data-ttu-id="2a42a-108">Fornisce la crittografia SSL e la verifica del proxy RPC (autenticazione reciproca).</span><span class="sxs-lookup"><span data-stu-id="2a42a-108">Provides SSL encryption and RPC Proxy verification (mutual authentication).</span></span> <span data-ttu-id="2a42a-109">Disponibile anche in RPC solo su HTTP V2.</span><span class="sxs-lookup"><span data-stu-id="2a42a-109">Also available in RPC over HTTP v2 only.</span></span>
-   <span data-ttu-id="2a42a-110">Fornisce restrizioni sul livello del proxy RPC che stabilisce quali computer della rete server sono autorizzati a ricevere chiamate RPC su chiamate HTTP.</span><span class="sxs-lookup"><span data-stu-id="2a42a-110">Provides restrictions on the RPC Proxy level dictating which machines on the server network are allowed to receive RPC over HTTP calls.</span></span>

<span data-ttu-id="2a42a-111">Ognuna di queste tre funzionalità di sicurezza è descritta in modo più dettagliato nelle sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="2a42a-111">Each of these three security features is described in more detail in following sections.</span></span>

## <a name="iis-authentication"></a><span data-ttu-id="2a42a-112">Autenticazione IIS</span><span class="sxs-lookup"><span data-stu-id="2a42a-112">IIS Authentication</span></span>

<span data-ttu-id="2a42a-113">RPC su HTTP può sfruttare il normale meccanismo di autenticazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="2a42a-113">RPC over HTTP can leverage the normal authentication mechanism of IIS.</span></span> <span data-ttu-id="2a42a-114">La directory virtuale per il proxy RPC può essere configurata utilizzando il nodo RPC nel sito Web predefinito nello snap-in MMC IIS:</span><span class="sxs-lookup"><span data-stu-id="2a42a-114">The virtual directory for RPC Proxy can be configured using the Rpc node under the Default Web Site in the IIS MMC snap-in:</span></span>

![Screenshot che mostra il nodo RPC nel sito Web predefinito nello snap-in MMC di IIS.](images/rpc-http-1.png)

<span data-ttu-id="2a42a-116">IIS può essere configurato per disabilitare l'accesso anonimo e richiedere l'autenticazione alla directory virtuale per il proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-116">IIS can be configured to disable anonymous access and require authentication to the virtual directory for the RPC Proxy.</span></span> <span data-ttu-id="2a42a-117">A tale scopo, fare clic con il pulsante destro del mouse sul nodo RPC e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="2a42a-117">To do this, right click the Rpc node and select **Properties**.</span></span> <span data-ttu-id="2a42a-118">Selezionare la scheda **sicurezza directory** e fare clic sul pulsante **modifica** nel gruppo **controllo autenticazione e accesso** , come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="2a42a-118">Select the **Directory Security** tab and click the **Edit** button in the **Authentication and Access Control** group, as illustrated here:</span></span>

![Screenshot che mostra la finestra di dialogo Proprietà RPC.](images/rpc-http-2.png)

<span data-ttu-id="2a42a-120">Sebbene sia possibile utilizzare RPC su HTTP anche quando la directory virtuale del proxy RPC consente l'accesso anonimo, Microsoft consiglia vivamente di disabilitare l'accesso anonimo alla directory virtuale per motivi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="2a42a-120">Although you can use RPC over HTTP even when the RPC Proxy virtual directory allows anonymous access, Microsoft strongly recommends disabling anonymous access to that virtual directory for security reasons.</span></span> <span data-ttu-id="2a42a-121">Per RPC su HTTP è invece abilitata l'autenticazione di base, l'autenticazione integrata di Windows o entrambi.</span><span class="sxs-lookup"><span data-stu-id="2a42a-121">Rather, for RPC over HTTP enable Basic Authentication, Windows Integrated Authentication or both.</span></span> <span data-ttu-id="2a42a-122">Tenere presente che solo RPC su HTTP V2 è in grado di eseguire l'autenticazione con il proxy RPC che richiede l'autenticazione di base o integrata di Windows. RPC su HTTP V1 non sarà in grado di connettersi se non **consentire l'accesso anonimo** è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="2a42a-122">Remember that only RPC over HTTP v2 is able to authenticate against RPC Proxy requiring Basic or Windows-integrated authentication; RPC over HTTP v1 will not be able to connect if **Disallow Anonymous Access** is disabled.</span></span> <span data-ttu-id="2a42a-123">Poiché RPC su HTTP V2 è l'implementazione più sicura e affidabile, l'uso di una versione di Windows che lo supporta consente di migliorare la sicurezza delle installazioni.</span><span class="sxs-lookup"><span data-stu-id="2a42a-123">Since RPC over HTTP v2 is the more secure and robust implementation, using a version of Windows that supports it will improve the security of your installations.</span></span>

> [!Note]  
> <span data-ttu-id="2a42a-124">Per impostazione predefinita, la directory virtuale del proxy RPC è contrassegnata per consentire l'accesso anonimo.</span><span class="sxs-lookup"><span data-stu-id="2a42a-124">By default, the RPC proxy virtual directory is marked to allow anonymous access.</span></span> <span data-ttu-id="2a42a-125">Tuttavia, il proxy RPC per RPC su HTTP V2 rifiuta le richieste non autenticate per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="2a42a-125">However, the RPC proxy for RPC over HTTP v2 rejects requests that are not authenticated by default.</span></span>

 

## <a name="traffic-encryption"></a><span data-ttu-id="2a42a-126">Crittografia del traffico</span><span class="sxs-lookup"><span data-stu-id="2a42a-126">Traffic Encryption</span></span>

<span data-ttu-id="2a42a-127">RPC su HTTP può crittografare il traffico tra il client RPC su HTTP e il proxy RPC con SSL.</span><span class="sxs-lookup"><span data-stu-id="2a42a-127">RPC over HTTP can encrypt traffic between the RPC over HTTP client and the RPC proxy with SSL.</span></span> <span data-ttu-id="2a42a-128">Il traffico tra il proxy RPC e il server RPC su HTTP viene crittografato utilizzando i normali meccanismi di sicurezza RPC e non utilizza SSL (anche se viene scelto SSL tra il client e il proxy RPC).</span><span class="sxs-lookup"><span data-stu-id="2a42a-128">The traffic between the RPC proxy and RPC over HTTP server is encrypted using normal RPC security mechanisms and does not use SSL (even if SSL between the client and the RPC proxy is chosen).</span></span> <span data-ttu-id="2a42a-129">Questo è dovuto al fatto che la parte del traffico viene spostata all'interno della rete di un'organizzazione e dietro a un firewall.</span><span class="sxs-lookup"><span data-stu-id="2a42a-129">This is because that portion of the traffic travels within an organization's network and behind a firewall.</span></span>

<span data-ttu-id="2a42a-130">Il traffico tra il client RPC su HTTP e il proxy RPC, che in genere si sposta su Internet, può essere crittografato con SSL oltre al meccanismo di crittografia scelto per RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-130">Traffic between the RPC over HTTP client and the RPC proxy, which generally travels over the Internet, can be encrypted with SSL in addition to which encryption mechanism was chosen for RPC.</span></span> <span data-ttu-id="2a42a-131">In questo caso, il traffico sulla parte Internet della route diventa doppiamente crittografato.</span><span class="sxs-lookup"><span data-stu-id="2a42a-131">In this case, traffic on the Internet portion of the route becomes doubly encrypted.</span></span> <span data-ttu-id="2a42a-132">La crittografia del traffico tramite il proxy RPC fornisce una difesa secondaria, nel caso in cui il proxy RPC o altri computer nella rete perimetrale siano compromessi.</span><span class="sxs-lookup"><span data-stu-id="2a42a-132">Encrypting traffic through the RPC proxy provides a secondary defense, in case the RPC proxy or other machines in the perimeter network are compromised.</span></span> <span data-ttu-id="2a42a-133">Poiché il proxy RPC non è in grado di decrittografare il livello di crittografia secondario, il proxy RPC non ha accesso ai dati inviati.</span><span class="sxs-lookup"><span data-stu-id="2a42a-133">Since the RPC proxy cannot decrypt the secondary encryption layer, the RPC proxy does not have access to the data being sent.</span></span> <span data-ttu-id="2a42a-134">Per ulteriori informazioni, vedere la pagina relativa ai [consigli sulla distribuzione RPC su http](rpc-over-http-deployment-recommendations.md) .</span><span class="sxs-lookup"><span data-stu-id="2a42a-134">See [RPC over HTTP Deployment Recommendations](rpc-over-http-deployment-recommendations.md) for more information.</span></span> <span data-ttu-id="2a42a-135">La crittografia SSL è disponibile solo con RPC su HTTP V2.</span><span class="sxs-lookup"><span data-stu-id="2a42a-135">SSL encryption is available only with RPC over HTTP v2.</span></span>

## <a name="restricting-rpc-over-http-calls-to-certain-computers"></a><span data-ttu-id="2a42a-136">Limitazione delle chiamate RPC su HTTP a determinati computer</span><span class="sxs-lookup"><span data-stu-id="2a42a-136">Restricting RPC over HTTP Calls to Certain Computers</span></span>

<span data-ttu-id="2a42a-137">La configurazione della sicurezza di IIS è basata sugli intervalli di porte e computer consentiti.</span><span class="sxs-lookup"><span data-stu-id="2a42a-137">The IIS security configuration is based on allowed computer and port ranges.</span></span> <span data-ttu-id="2a42a-138">La possibilità di usare RPC su HTTP viene controllata da due voci del registro di sistema nel computer che esegue IIS e il proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-138">The capability to use RPC over HTTP is controlled by two registry entries on the computer running IIS and the RPC proxy.</span></span> <span data-ttu-id="2a42a-139">La prima voce è un flag che consente di disabilitare la funzionalità del proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-139">The first entry is a flag that toggles RPC proxy functionality.</span></span> <span data-ttu-id="2a42a-140">Il secondo è un elenco facoltativo dei computer a cui il proxy può eseguire l'inoltro delle chiamate RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-140">The second is an optional list of computers to which the proxy can forward RPC calls.</span></span>

<span data-ttu-id="2a42a-141">Per impostazione predefinita, un client che contatta il proxy RPC per eseguire il tunneling di chiamate RPC su HTTP non è in grado di accedere ai processi del server RPC ad eccezione dei processi del server RPC su HTTP in esecuzione nello stesso computer del proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-141">By default, a client that contacts the RPC proxy to tunnel RPC over HTTP calls cannot access any RPC server processes except the RPC over HTTP server processes running on the same machine as the RPC proxy.</span></span> <span data-ttu-id="2a42a-142">Se il flag ENABLED non è definito o è impostato su un valore pari a zero, il proxy RPC viene disabilitato da IIS.</span><span class="sxs-lookup"><span data-stu-id="2a42a-142">If the ENABLED flag is not defined or set to a zero value, IIS disables the RPC proxy.</span></span> <span data-ttu-id="2a42a-143">Se il flag ENABLED viene definito e impostato su un valore diverso da zero, un client può connettersi a RPC su server HTTP nel computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="2a42a-143">If the ENABLED flag is defined and set to a nonzero value, a client can connect to RPC over HTTP servers on the computer running IIS.</span></span> <span data-ttu-id="2a42a-144">Per consentire al client di effettuare il tunneling a un processo server RPC su HTTP in un altro computer, è necessario aggiungere una voce del registro di sistema all'elenco dei server RPC su HTTP del computer IIS.</span><span class="sxs-lookup"><span data-stu-id="2a42a-144">To enable the client to tunnel to an RPC over HTTP server process on another computer, you must add a registry entry to the IIS computer's list of RPC over HTTP servers.</span></span>

<span data-ttu-id="2a42a-145">I server RPC non accettano RPC su chiamate HTTP, a meno che non abbia richiesto in modo specifico la chiamata RPC per l'ascolto su RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="2a42a-145">RPC servers cannot accept RPC over HTTP calls unless they specifically requested RPC to listen on RPC over HTTP.</span></span>

<span data-ttu-id="2a42a-146">Nell'esempio seguente viene illustrato come configurare il registro di sistema per consentire ai client di connettersi ai server su Internet:</span><span class="sxs-lookup"><span data-stu-id="2a42a-146">The following example demonstrates how to configure the registry to allow clients to connect to servers across the Internet:</span></span>

```
HKEY_LOCAL_MACHINE\
   Software\Microsoft\Rpc\RpcProxy\Enabled:REG_DWORD
   Software\Microsoft\Rpc\RpcProxy\ValidPorts:REG_SZ
```

<span data-ttu-id="2a42a-147">La voce **ValidPorts** è una \_ voce reg SZ contenente un elenco di computer a cui il proxy RPC IIS è autorizzato a eseguire l'inoltro delle chiamate RPC e le porte da utilizzare per connettersi ai server RPC.</span><span class="sxs-lookup"><span data-stu-id="2a42a-147">The **ValidPorts** entry is a REG\_SZ entry containing a list of computers to which the IIS RPC proxy is allowed to forward RPC calls, and the ports it should use to connect to the RPC servers.</span></span> <span data-ttu-id="2a42a-148">La \_ voce reg SZ assume il formato seguente: Rosco: 593; Rosco: 2000-8000; dati \* : 4000-8000.</span><span class="sxs-lookup"><span data-stu-id="2a42a-148">The REG\_SZ entry takes the following form: Rosco:593;Rosco:2000-8000;Data\*:4000-8000.</span></span>

<span data-ttu-id="2a42a-149">In questo esempio, IIS è in grado di eseguire la trasmissione RPC su chiamate HTTP al server "Rosco" sulle porte 593 e 2000 a 8000.</span><span class="sxs-lookup"><span data-stu-id="2a42a-149">In this example, IIS can forward RPC over HTTP calls to the server "Rosco" on ports 593 and 2000 through 8000.</span></span> <span data-ttu-id="2a42a-150">Può anche inviare chiamate a qualsiasi server il cui nome inizia con "data".</span><span class="sxs-lookup"><span data-stu-id="2a42a-150">It can also send calls to any server whose name begins with "Data".</span></span> <span data-ttu-id="2a42a-151">Si connetterà sulle porte da 4000 a 8000.</span><span class="sxs-lookup"><span data-stu-id="2a42a-151">It will connect on ports 4000 through 8000.</span></span> <span data-ttu-id="2a42a-152">Inoltre, prima di eseguire l'inoltro del traffico a una determinata porta sul server RPC su HTTP, il proxy RPC esegue uno speciale scambio di pacchetti con il servizio RPC in ascolto su tale porta per verificare che sia pronto ad accettare le richieste tramite HTTP.</span><span class="sxs-lookup"><span data-stu-id="2a42a-152">In addition, before forwarding traffic to a given port on the RPC over HTTP server, the RPC proxy performs a special packet exchange with the RPC service listening on that port to verify it is willing to accept requests over HTTP.</span></span>

<span data-ttu-id="2a42a-153">Per un esempio basato su queste impostazioni di esempio, se un servizio RPC è in ascolto sulla porta 4500 sul server "Data1", ma non ha chiamato una delle funzioni [ \* *RpcServerUseProtseq \** _](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) con _ \* ncacn \_ http \* \*, rifiuterà la richiesta.</span><span class="sxs-lookup"><span data-stu-id="2a42a-153">For an example based on these example settings, if an RPC service listens on port 4500 on server "Data1" but has not called one of the [\**RpcServerUseProtseq\** _](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) functions with _\*ncacn\_http\*\*, it will reject the request.</span></span> <span data-ttu-id="2a42a-154">Questo comportamento fornisce protezione aggiuntiva per i server che restano in attesa su una porta aperta a causa di un errore di configurazione. a meno che il server non abbia richiesto in modo specifico di restare in ascolto su RPC su HTTP, non riceverà chiamate provenienti dall'esterno del firewall.</span><span class="sxs-lookup"><span data-stu-id="2a42a-154">This behavior provides additional protection for servers that listen on an opened port due to configuration error; unless the server specifically requested to listen on RPC over HTTP, it will not receive calls originating from outside the firewall.</span></span>

<span data-ttu-id="2a42a-155">Le voci nella chiave **ValidPorts** devono corrispondere esattamente a quelle del server RPC su http richiesto dal client (senza distinzione tra maiuscole e minuscole).</span><span class="sxs-lookup"><span data-stu-id="2a42a-155">Entries in the **ValidPorts** key must be an exact match of the RPC over HTTP server asked for by the client (it is not case-sensitive).</span></span> <span data-ttu-id="2a42a-156">Per semplificare l'elaborazione, il proxy RPC non esegue la canonizzazione del nome fornito dal client RPC su HTTP.</span><span class="sxs-lookup"><span data-stu-id="2a42a-156">To streamline processing, the RPC proxy does not perform canonicalization of the name provided by the RPC over HTTP client.</span></span> <span data-ttu-id="2a42a-157">Pertanto, se il client richiede rosco.microsoft.com e in **ValidPorts** contengono solo Rosco, il proxy RPC non corrisponderà ai nomi, anche se entrambi i nomi possono fare riferimento allo stesso computer.</span><span class="sxs-lookup"><span data-stu-id="2a42a-157">Therefore, if the client asks for rosco.microsoft.com, and in **ValidPorts** contain Rosco only, the RPC proxy will not match the names, even though both names may refer to the same machine.</span></span> <span data-ttu-id="2a42a-158">Inoltre, se l'indirizzo IP di Rosco è 66.77.88.99 e il client richiede 66.77.88.99 ma la chiave **ValidPorts** contiene solo Rosco, il proxy RPC rifiuterà la connessione.</span><span class="sxs-lookup"><span data-stu-id="2a42a-158">Additionally, if the IP address of Rosco is 66.77.88.99, and the client asks for 66.77.88.99 but the **ValidPorts** key contains Rosco only, the RPC proxy will refuse the connection.</span></span> <span data-ttu-id="2a42a-159">Se un client può richiedere il server RPC su HTTP in base al nome o all'indirizzo IP, inserire entrambi nella chiave **ValidPorts** .</span><span class="sxs-lookup"><span data-stu-id="2a42a-159">If a client may ask for the RPC over HTTP server by name, or by IP address, insert both in the **ValidPorts** key.</span></span>

> [!Note]  
> <span data-ttu-id="2a42a-160">Sebbene RPC sia abilitato per IPv6, il proxy RPC non supporta gli indirizzi IPv6 nella chiave **ValidPorts** .</span><span class="sxs-lookup"><span data-stu-id="2a42a-160">Although RPC is IPv6 enabled, the RPC proxy does not support IPv6 addresses in the **ValidPorts** key.</span></span> <span data-ttu-id="2a42a-161">Se si utilizza IPv6 per connettere il proxy RPC e il server RPC su HTTP, è possibile utilizzare solo nomi DNS.</span><span class="sxs-lookup"><span data-stu-id="2a42a-161">If IPv6 is used to connect the RPC proxy and the RPC over HTTP server, only DNS names can be used.</span></span>

 

<span data-ttu-id="2a42a-162">IIS legge le voci del registro di sistema **Enabled** e **ValidPorts** all'avvio.</span><span class="sxs-lookup"><span data-stu-id="2a42a-162">IIS reads the **Enabled** and **ValidPorts** registry entries on startup.</span></span> <span data-ttu-id="2a42a-163">Inoltre, RPC su HTTP rilegge il contenuto della chiave **ValidPorts** approssimativamente ogni 5 minuti.</span><span class="sxs-lookup"><span data-stu-id="2a42a-163">In addition, RPC over HTTP rereads the contents of the **ValidPorts** key approximately every 5 minutes.</span></span> <span data-ttu-id="2a42a-164">Se la voce **ValidPorts** viene modificata, le modifiche verranno implementate entro 5 minuti.</span><span class="sxs-lookup"><span data-stu-id="2a42a-164">If the **ValidPorts** entry is changed, the changes are implemented within 5 minutes.</span></span>

<span data-ttu-id="2a42a-165">**RPC su http V1:** Il servizio WEB deve essere arrestato e riavviato utilizzando Internet Service Manager per i nuovi valori nelle voci del registro di sistema da implementare.</span><span class="sxs-lookup"><span data-stu-id="2a42a-165">**RPC over HTTP v1:** The WEB service must be stopped and restarted using the Internet Service Manager for new values in the registry entries to be implemented.</span></span>

 

 




