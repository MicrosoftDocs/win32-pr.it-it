---
title: Generazione di informazioni sugli errori
description: Se un server o un'applicazione rileva un errore irreversibile durante la chiamata tramite RPC, è necessario indicare al runtime RPC che si è verificato un errore e, idealmente, aggiungere informazioni sull'errore per facilitare la risoluzione dei problemi.
ms.assetid: 6658c387-94df-4d85-9749-53858f9e0f5f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b06a13e932034e6840479443e0b78f4c322c0b3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106298143"
---
# <a name="generating-error-information"></a><span data-ttu-id="e6e92-103">Generazione di informazioni sugli errori</span><span class="sxs-lookup"><span data-stu-id="e6e92-103">Generating Error Information</span></span>

<span data-ttu-id="e6e92-104">Se un server o un'applicazione rileva un errore irreversibile durante la chiamata tramite RPC, è necessario indicare al runtime RPC che si è verificato un errore e, idealmente, aggiungere informazioni sull'errore per facilitare la risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="e6e92-104">If a server or application encounters a fatal error while being called through RPC, it should indicate to the RPC run time that it has encountered a failure, and ideally, should add information about the failure to facilitate troubleshooting.</span></span>

## <a name="indicating-fatal-errors-to-the-rpc-run-time"></a><span data-ttu-id="e6e92-105">Segnalazione di errori irreversibili al runtime RPC</span><span class="sxs-lookup"><span data-stu-id="e6e92-105">Indicating Fatal Errors to the RPC Run Time</span></span>

<span data-ttu-id="e6e92-106">Per indicare un errore nel runtime RPC, chiamare la funzione [**RpcRaiseException**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcraiseexception) mentre sul thread RPC è stata chiamata l'eccezione o [**RpcAsyncAbortCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasyncabortcall) se l'elaborazione della chiamata in modo asincrono in un altro thread.</span><span class="sxs-lookup"><span data-stu-id="e6e92-106">To indicate a failure to the RPC run time, call the [**RpcRaiseException**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcraiseexception) function while on the RPC thread the exception was called on, or [**RpcAsyncAbortCall**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcasyncabortcall) if processing the call asynchronously on another thread.</span></span> <span data-ttu-id="e6e92-107">La restituzione di un codice di errore dalla routine del server, ad esempio la routine del Manager, non è sufficiente, in base alla specifica RPC, il valore restituito della funzione non presenta una semantica di errore nel server, indipendentemente dalle impostazioni del file IDL/ACF.</span><span class="sxs-lookup"><span data-stu-id="e6e92-107">Returning an error code from the server routine, such as the manager routine, is not sufficient—according to the RPC specification, the return value of the function has no error semantics on the server, regardless of the idl/acf file settings.</span></span>

<span data-ttu-id="e6e92-108">Quando si verifica un errore irreversibile nel componente, eseguire tutte le operazioni di pulizia ritenute necessarie, quindi chiamare la funzione [**RpcRaiseException**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcraiseexception) con il codice di errore.</span><span class="sxs-lookup"><span data-stu-id="e6e92-108">When a fatal error occurs in your component, perform any cleanup deemed necessary and then call the [**RpcRaiseException**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcraiseexception) function with the error code.</span></span> <span data-ttu-id="e6e92-109">L'unica differenza tra **RpcRaiseException** e la restituzione di un codice di errore è quando viene chiamato il **RpcRaiseException** , i parametri out non vengono sottoposti a marshalling.</span><span class="sxs-lookup"><span data-stu-id="e6e92-109">The only difference between **RpcRaiseException** and returning an error code is when the **RpcRaiseException** is called, the out parameters are not marshaled.</span></span> <span data-ttu-id="e6e92-110">Si tratta in genere di un vantaggio, perché evitare parametri non inizializzati non è necessario.</span><span class="sxs-lookup"><span data-stu-id="e6e92-110">This is usually an advantage, since avoiding uninitialized out parameters becomes unnecessary.</span></span>

## <a name="generating-additional-extended-error-information"></a><span data-ttu-id="e6e92-111">Generazione di informazioni aggiuntive sugli errori estesi</span><span class="sxs-lookup"><span data-stu-id="e6e92-111">Generating Additional Extended Error Information</span></span>

<span data-ttu-id="e6e92-112">Proprio come il tempo di esecuzione RPC compila una catena di record di errore, il server o l'applicazione può aggiungere i propri record alla catena.</span><span class="sxs-lookup"><span data-stu-id="e6e92-112">Just as the RPC run time builds a chain of error records, your server or application can add its own records to the chain.</span></span> <span data-ttu-id="e6e92-113">Questo approccio spesso facilita il processo di risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="e6e92-113">This approach often helps in the troubleshooting process.</span></span> <span data-ttu-id="e6e92-114">Ad esempio, un server può tentare di aprire un file specifico e ricevere un errore di file non trovato.</span><span class="sxs-lookup"><span data-stu-id="e6e92-114">For example, a server may attempt to open a given file and receive a file not found error.</span></span> <span data-ttu-id="e6e92-115">La semplice restituzione dell'errore 2 non è utile per determinare il file mancante.</span><span class="sxs-lookup"><span data-stu-id="e6e92-115">Simply returning error 2 would not be helpful in determining which file is missing.</span></span>

<span data-ttu-id="e6e92-116">Al contrario, il server può chiamare la funzione [**RpcErrorAddRecord**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerroraddrecord) e specificare un parametro di stringa, ANSI o Unicode, nel record di errore che indica il percorso completo del file che stava cercando.</span><span class="sxs-lookup"><span data-stu-id="e6e92-116">Instead, your server could call the [**RpcErrorAddRecord**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerroraddrecord) function and provide a string parameter, either ANSI or Unicode, in the error record indicating the full path of the file it was looking for.</span></span> <span data-ttu-id="e6e92-117">Quando tutte queste informazioni vengono visualizzate nella schermata utente in un computer remoto, la risoluzione dei problemi diventa semplice; un semplice controllo della presenza del file può essere eseguito, soprattutto perché il nome del computer in questione è già fornito dal tempo di esecuzione RPC.</span><span class="sxs-lookup"><span data-stu-id="e6e92-117">When all this information appears on the user screen on a remote computer, troubleshooting becomes trivial; a simple check of whether the file exists can be done, especially since the name of the computer in question is already provided by the RPC run time.</span></span>

<span data-ttu-id="e6e92-118">La chiamata di funzione [**RpcErrorAddRecord**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerroraddrecord) potrebbe avere esito negativo se non è disponibile memoria sufficiente, anche se richiede solo pochi byte di spazio dell'heap.</span><span class="sxs-lookup"><span data-stu-id="e6e92-118">The [**RpcErrorAddRecord**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerroraddrecord) function call may fail if enough memory is not available, even though it requires only a few bytes of heap space.</span></span> <span data-ttu-id="e6e92-119">Inoltre, i record aggiunti da **RpcErrorAddRecord** si accumulano in un thread specifico.</span><span class="sxs-lookup"><span data-stu-id="e6e92-119">Also, records added by **RpcErrorAddRecord** accumulate in a given thread.</span></span> <span data-ttu-id="e6e92-120">Il runtime di in genere pulisce tali record prima di chiamare la routine del server, ma se le informazioni estese sugli errori vengono utilizzate all'esterno di RPC, è necessario pulire l'errore esteso accumulato nel thread chiamando [**RpcErrorClearInformation**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerrorclearinformation).</span><span class="sxs-lookup"><span data-stu-id="e6e92-120">The runtime normally cleans those records up before it calls your server routine, but if extended error information is used outside RPC, take care of cleaning up the accumulated extended error in the thread by calling [**RpcErrorClearInformation**](/windows/desktop/api/Rpcasync/nf-rpcasync-rpcerrorclearinformation).</span></span>

 

 




