---
title: Buffer Stub-Allocated
description: Anziché forzare una chiamata distinta per ogni nodo dell'albero o del grafo, è possibile indirizzare gli stub per calcolare le dimensioni dei dati e allocare e liberare memoria effettuando una singola chiamata a MIDL \_ User \_ allocate o MIDL \_ User \_ free.
ms.assetid: 9911649d-00e8-47d8-b512-7d9b185d1e09
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 956acf6452c1a4e7d04afcd1da263439436e3bad
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047088"
---
# <a name="stub-allocated-buffers"></a><span data-ttu-id="2895b-103">Buffer Stub-Allocated</span><span class="sxs-lookup"><span data-stu-id="2895b-103">Stub-Allocated Buffers</span></span>

<span data-ttu-id="2895b-104">Anziché forzare una chiamata distinta per ogni nodo dell'albero o del grafo, è possibile indirizzare gli stub per calcolare le dimensioni dei dati e allocare e liberare memoria effettuando una singola chiamata a [MIDL \_ User \_ allocate](/windows/desktop/Midl/midl-user-allocate-1) o [MIDL \_ User \_ Free](/windows/desktop/Midl/midl-user-free-1).</span><span class="sxs-lookup"><span data-stu-id="2895b-104">Rather than forcing a distinct call for each node of the tree or graph, you can direct the stubs to compute the size of the data and to allocate and free memory by making a single call to [midl\_user\_allocate](/windows/desktop/Midl/midl-user-allocate-1) or [midl\_user\_free](/windows/desktop/Midl/midl-user-free-1).</span></span> <span data-ttu-id="2895b-105">L'attributo ACF **\[ allocate (tutti i \_ nodi) \]** indica agli stub di allocare o liberare tutti i nodi in una singola chiamata all'utente fornito: funzioni di gestione della memoria.</span><span class="sxs-lookup"><span data-stu-id="2895b-105">The ACF attribute **\[allocate(all\_nodes)\]** directs the stubs to allocate or free all nodes in a single call to the user supplied–memory management functions.</span></span>

<span data-ttu-id="2895b-106">Ad esempio, un'applicazione RPC può utilizzare la struttura dei dati dell'albero binario seguente:</span><span class="sxs-lookup"><span data-stu-id="2895b-106">For example, an RPC application might use the following binary tree data structure:</span></span>

``` syntax
/* IDL file fragment */
typedef struct _TREE_TYPE 
{
    short sNumber;
    struct _TREE_TYPE * pLeft;
    struct _TREE_TYPE * pRight;
} TREE_TYPE;

typedef TREE_TYPE * P_TREE_TYPE;
```

<span data-ttu-id="2895b-107">L'attributo ACF **\[ allocate (tutti i \_ nodi) \]** applicato a questo tipo di dati viene visualizzato nella Dichiarazione **typedef** in ACF come:</span><span class="sxs-lookup"><span data-stu-id="2895b-107">The ACF attribute **\[allocate(all\_nodes)\]** applied to this data type appears in the **typedef** declaration in the ACF as:</span></span>

``` syntax
/* ACF file fragment */
typedef [allocate(all_nodes)] P_TREE_TYPE;
```

<span data-ttu-id="2895b-108">L'attributo **\[ allocate \]** può essere applicato solo ai tipi di puntatore.</span><span class="sxs-lookup"><span data-stu-id="2895b-108">The **\[allocate\]** attribute can only be applied to pointer types.</span></span> <span data-ttu-id="2895b-109">L'attributo **\[ \] allocate** ACF è un'estensione Microsoft per DCE IDL e, di conseguenza, non è disponibile se si compila con l'opzione MIDL **/OSF** .</span><span class="sxs-lookup"><span data-stu-id="2895b-109">The **\[allocate\]** ACF attribute is a Microsoft extension to DCE IDL and, as such, is not available if you compile with the MIDL **/osf** switch.</span></span> <span data-ttu-id="2895b-110">Quando **\[ allocate (tutti i \_ nodi) \]** viene applicato a un tipo di puntatore, gli stub generati dal compilatore MIDL attraversano la struttura dei dati specificata per determinare le dimensioni di allocazione.</span><span class="sxs-lookup"><span data-stu-id="2895b-110">When **\[allocate(all\_nodes)\]** is applied to a pointer type, the stubs generated by the MIDL compiler traverse the specified data structure to determine the allocation size.</span></span> <span data-ttu-id="2895b-111">Gli stub effettuano quindi una singola chiamata per allocare l'intera quantità di memoria necessaria per il grafico o l'albero.</span><span class="sxs-lookup"><span data-stu-id="2895b-111">The stubs then make a single call to allocate the entire amount of memory needed by the graph or tree.</span></span> <span data-ttu-id="2895b-112">Un'applicazione client può liberare memoria in modo molto più efficiente effettuando una singola chiamata a **MIDL \_ User \_ Free**.</span><span class="sxs-lookup"><span data-stu-id="2895b-112">A client application can free memory much more efficiently by making a single call to **midl\_user\_free**.</span></span> <span data-ttu-id="2895b-113">Tuttavia, le prestazioni dello stub server vengono in genere aumentate quando si usa l'allocazione di memoria nodo per nodo perché gli stub del server possono spesso usare la memoria privata che non richiede allocazioni.</span><span class="sxs-lookup"><span data-stu-id="2895b-113">However, server-stub performance is generally increased when using node-by-node memory allocation because the server stubs can often use private memory that requires no allocations.</span></span>

<span data-ttu-id="2895b-114">Per ulteriori informazioni, vedere allocazione [e deallocazione di nodi per nodo](node-by-node-allocation-and-deallocation.md).</span><span class="sxs-lookup"><span data-stu-id="2895b-114">For additional information, see [Node-by-Node Allocation and Deallocation](node-by-node-allocation-and-deallocation.md).</span></span>

 

 