---
title: Client multithreading e handle di contesto
description: Quando si dispone di un client multithreading in cui più thread utilizzano la stessa istanza dell'handle di contesto, per impostazione predefinita l'accesso all'istanza dell'handle di contesto viene serializzato nel server.
ms.assetid: 192be467-b1e0-422b-878a-738cb7d72b5b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67c621d75d8cc48ca1f71719066f455e0efce39f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047057"
---
# <a name="multithreaded-clients-and-context-handles"></a><span data-ttu-id="abcc9-103">Client multithreading e handle di contesto</span><span class="sxs-lookup"><span data-stu-id="abcc9-103">Multithreaded Clients and Context Handles</span></span>

<span data-ttu-id="abcc9-104">Quando si dispone di un client multithreading in cui più thread utilizzano la stessa istanza dell'handle di contesto, per impostazione predefinita l'accesso all'istanza dell'handle di contesto viene serializzato nel server.</span><span class="sxs-lookup"><span data-stu-id="abcc9-104">When you have a multithreaded client where multiple threads are using the same context handle instance, access to the context handle instance is serialized at the server by default.</span></span> <span data-ttu-id="abcc9-105">In questo modo si evita che Server Manager debba proteggersi da un altro thread dello stesso client che modifica il contesto o il contesto che si sta esaurendo durante l'invio di una chiamata.</span><span class="sxs-lookup"><span data-stu-id="abcc9-105">This saves the server manager from having to guard against another thread from the same client changing the context or the context running down while a call is dispatched.</span></span> <span data-ttu-id="abcc9-106">In alcuni casi, tuttavia, la serializzazione può avere un effetto sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="abcc9-106">However, in certain cases serialization may impact performance.</span></span>

<span data-ttu-id="abcc9-107">Tenere presente quanto segue: due thread client richiamano una chiamata di procedura remota che non modifica lo stato del contesto (ad esempio, la chiamata ottiene semplicemente alcuni valori da esso).</span><span class="sxs-lookup"><span data-stu-id="abcc9-107">Consider the following: two client threads invoke a remote procedure call that does not change the state of the context (for example, the call simply obtains some values from it).</span></span> <span data-ttu-id="abcc9-108">Tali chiamate non devono essere serializzate.</span><span class="sxs-lookup"><span data-stu-id="abcc9-108">Such calls do not need to be serialized.</span></span>

<span data-ttu-id="abcc9-109">Per tali situazioni, Windows XP offre un modello di serializzazione in modalità mista, in cui ogni metodo può essere dichiarato per avere accesso esclusivo o condiviso a un handle di contesto.</span><span class="sxs-lookup"><span data-stu-id="abcc9-109">For such situations, Windows XP offers a mixed mode serialization model, where each method may be declared to have exclusive or shared access to a context handle.</span></span> <span data-ttu-id="abcc9-110">Per informazioni dettagliate, vedere Gestione del contesto [ \_ \_ serializzazione](/windows/desktop/Midl/context-handle-serialize) e [gestione del contesto \_ \_ noserialize](/windows/desktop/Midl/context-handle-noserialize) .</span><span class="sxs-lookup"><span data-stu-id="abcc9-110">See [context\_handle\_serialize](/windows/desktop/Midl/context-handle-serialize) and [context\_handle\_noserialize](/windows/desktop/Midl/context-handle-noserialize) for details.</span></span>

<span data-ttu-id="abcc9-111">Nelle versioni di Windows precedenti a Windows XP, l'unico mezzo per consentire l'accesso simultaneo a un handle di contesto consiste nel chiamare la funzione [**RpcSsDontSerializeContext**](/previous-versions/aa378473(v=vs.80)) per consentire l'invio di più chiamate in un singolo handle di contesto.</span><span class="sxs-lookup"><span data-stu-id="abcc9-111">In versions of Windows prior to Windows XP, the only means of allowing concurrent access to a context handle is to call the [**RpcSsDontSerializeContext**](/previous-versions/aa378473(v=vs.80)) function to allow multiple calls to be dispatched on a single context handle.</span></span> <span data-ttu-id="abcc9-112">La chiamata della funzione **RpcSsDontSerializeContext** non disabilita completamente la serializzazione. Quando si verifica un errore di esecuzione del contesto, la routine di esecuzione del contesto viene eseguita solo quando tutte le richieste client in attesa sono state completate.</span><span class="sxs-lookup"><span data-stu-id="abcc9-112">Calling the **RpcSsDontSerializeContext** function does not disable serialization entirely; when a context run-down occurs, the context run-down routine runs only when all outstanding client requests have completed.</span></span> <span data-ttu-id="abcc9-113">Una chiamata a **RpcScDontSerializeContext** influiscono sull'intero processo e non è ripristinabile.</span><span class="sxs-lookup"><span data-stu-id="abcc9-113">A call to **RpcScDontSerializeContext** affects the entire process, and is not revertible.</span></span> <span data-ttu-id="abcc9-114">Non è consigliabile usare **RpcScDontSerializeContext** in Windows XP e versioni successive. rende il codice server molto complesso quando si gestiscono in modo affidabile con Race condition inerenti a ambienti completamente non serializzati.</span><span class="sxs-lookup"><span data-stu-id="abcc9-114">Using **RpcScDontSerializeContext** in Windows XP and later versions is not recommended; it makes server code very complicated when dealing reliably with race conditions inherent in completely non-serialized environments.</span></span>

 

 