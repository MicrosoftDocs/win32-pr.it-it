---
title: Teoria del controllo delle versioni per RPC e COM
description: Teoria del controllo delle versioni per RPC (Remote Procedure Call) e COM.
ms.assetid: c4df0a7b-e1be-481d-9149-317ffc9179b9
keywords:
- RPC, procedure consigliate, controllo delle versioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e03b23c91bf69fbc3c4f72366b80812fd54330d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118227"
---
# <a name="the-versioning-theory-for-rpc-and-com"></a><span data-ttu-id="2f1b8-104">Teoria del controllo delle versioni per RPC e COM</span><span class="sxs-lookup"><span data-stu-id="2f1b8-104">The Versioning Theory for RPC and COM</span></span>

<span data-ttu-id="2f1b8-105">Solo due metodi completamente infallibili supportano nuove funzionalità senza rischiare problemi di compatibilità con i fili:</span><span class="sxs-lookup"><span data-stu-id="2f1b8-105">Only two completely foolproof methods support new functionality without risk of wire compatibility problems:</span></span>

-   <span data-ttu-id="2f1b8-106">Modificare la versione dell'interfaccia in base alle regole; in questo modo si impedisce che i nuovi client comunicano con un server precedente e possano o meno impedire a un vecchio client di comunicare con il nuovo server.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-106">Change the interface version according to the rules; this prevents new clients from communicating with an old server, and may or may not prevent an old client from communicating with the new server.</span></span> <span data-ttu-id="2f1b8-107">Questa operazione viene chiarita più avanti in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-107">This is clarified later in this section.</span></span>
-   <span data-ttu-id="2f1b8-108">Introduce un'interfaccia diversa che riguarda la nuova funzionalità.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-108">Introduce a different interface dealing with the new functionality.</span></span>

<span data-ttu-id="2f1b8-109">Un'interfaccia RPC standard è identificata da una combinazione di numero di versione e GUID; un'interfaccia COM è identificata dal relativo GUID.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-109">A standard RPC interface is identified by a GUID and version number combination; a COM interface is identified by its GUID.</span></span> <span data-ttu-id="2f1b8-110">La versione è costituita dalle parti principali e secondarie.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-110">The version consists of major and minor parts.</span></span> <span data-ttu-id="2f1b8-111">Per le interfacce standard con lo stesso GUID e numeri di versione diversi, una connessione è possibile solo quando la versione principale è la stessa e il client non è superiore alla versione secondaria del server.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-111">For standard interfaces with the same GUID and different version numbers, a connection is possible only when the major version is the same, and the client is not higher than the minor version of the server.</span></span>

<span data-ttu-id="2f1b8-112">Una conseguenza è che la modifica del GUID dell'interfaccia RPC interrompe la compatibilità di rete, mentre la modifica del nome dell'interfaccia non lo è.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-112">A consequence is that changing the RPC interface GUID breaks wire compatibility, while changing the interface name does not.</span></span>

<span data-ttu-id="2f1b8-113">In RPC standard, un percorso per gli aggiornamenti e le estensioni è ben definito e richiede fondamentalmente che i nuovi metodi vengano aggiunti alla fine dell'interfaccia e i nuovi tipi vengano utilizzati solo nei nuovi metodi.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-113">In standard RPC, a path for upgrades and extensions is well defined, and basically requires that new methods only be added at the end of the interface, and new types be used only in the new methods.</span></span> <span data-ttu-id="2f1b8-114">Se tali aggiunte sono necessarie, è necessario aumentare la versione secondaria.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-114">If such additions are needed, the minor version must be increased.</span></span> <span data-ttu-id="2f1b8-115">Eventuali altre modifiche richiedono una modifica nella versione principale, poiché il software client e server non sarebbero compatibili in rete.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-115">Any other change requires a change in the major version, because the client and server software would be incompatible on the wire.</span></span> <span data-ttu-id="2f1b8-116">L'adesione a queste regole garantisce che ogni volta che si verifica una connessione tra un nuovo client e un server precedente o viceversa, entrambi i lati sono completamente compatibili.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-116">Adhering to these rules assures whenever there is a connection between a new client and old server, or vice-versa, both sides are fully compatible.</span></span>

<span data-ttu-id="2f1b8-117">Per un'interfaccia COM, non è possibile usare l'attributo Version.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-117">For a COM interface, the version attribute cannot be used.</span></span> <span data-ttu-id="2f1b8-118">La creazione di nuove interfacce e l'ereditarietà delle interfacce precedenti è un equivalente della modifica della versione in RPC.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-118">Creating new interfaces and inheriting from the old interfaces is an equivalent of manipulating the version in RPC.</span></span> <span data-ttu-id="2f1b8-119">In genere, l'approccio migliore in COM consiste nel creare una nuova interfaccia per la funzionalità espansa.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-119">Typically, the best approach in COM is to create a new interface for the expanded functionality.</span></span> <span data-ttu-id="2f1b8-120">Un equivalente della versione secondaria è la nuova interfaccia che eredita da quella precedente.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-120">An equivalent of the minor version is the new interface inheriting from the old one.</span></span> <span data-ttu-id="2f1b8-121">Per modificare metodi obsoleti o tipi di dati obsoleti è necessaria un'interfaccia COM completamente nuova, ovvero un'interfaccia che non eredita da quella precedente.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-121">Changing old methods or old data types requires an entirely new COM interface—an interface that does not inherit from the old one.</span></span>

<span data-ttu-id="2f1b8-122">Per COM, la funzione [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) è un metodo stabilito per verificare se un server supporta un'interfaccia; di conseguenza, le situazioni in cui un client può comunicare con una versione precedente o una nuova di un'interfaccia può essere risolta facilmente.</span><span class="sxs-lookup"><span data-stu-id="2f1b8-122">For COM, the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) function is an established method of checking whether a server supports an interface; hence, the situations where a client can talk to an old or a new version of an interface can be easily resolved.</span></span>

 

 