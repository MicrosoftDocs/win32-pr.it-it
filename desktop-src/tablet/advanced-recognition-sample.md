---
description: Nell'esempio Advanced Recognition sono illustrate le funzionalità avanzate del Application Programming Interface di automazione dei Tablet PC Microsoft (API) utilizzato per il riconoscimento della grafia.
ms.assetid: 4c9b9f31-c317-43fd-8404-35295b41d093
title: Esempio di riconoscimento avanzato
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e23a078ded9c6967f8e45780f8cb3a739b246f6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103749119"
---
# <a name="advanced-recognition-sample"></a><span data-ttu-id="473db-103">Esempio di riconoscimento avanzato</span><span class="sxs-lookup"><span data-stu-id="473db-103">Advanced Recognition Sample</span></span>

<span data-ttu-id="473db-104">Nell'esempio Advanced Recognition sono illustrate le funzionalità avanzate del Application Programming Interface di automazione dei Tablet PC Microsoft (API) utilizzato per il riconoscimento della grafia.</span><span class="sxs-lookup"><span data-stu-id="473db-104">The advanced recognition sample demonstrates advanced features of the Microsoft Tablet PC Automation application programming interface (API) used for handwriting recognition.</span></span>

<span data-ttu-id="473db-105">Esso comprende le seguenti funzionalità:</span><span class="sxs-lookup"><span data-stu-id="473db-105">It includes the following features:</span></span>

-   <span data-ttu-id="473db-106">Enumerazione del riconoscimento installato</span><span class="sxs-lookup"><span data-stu-id="473db-106">Enumerating the installed recognizer</span></span>
-   <span data-ttu-id="473db-107">Creazione di un contesto di riconoscimento con una lingua specifica</span><span class="sxs-lookup"><span data-stu-id="473db-107">Creating a recognizer context with a specific language</span></span>
-   <span data-ttu-id="473db-108">Utilizzo dell'oggetto Recognizer</span><span class="sxs-lookup"><span data-stu-id="473db-108">Using the recognizer object</span></span>
-   <span data-ttu-id="473db-109">Impostazione del controllo di riconoscimento e degli elenchi di parole</span><span class="sxs-lookup"><span data-stu-id="473db-109">Setting recognition factoid and word lists</span></span>
-   <span data-ttu-id="473db-110">Uso delle guide per migliorare la qualità del riconoscimento</span><span class="sxs-lookup"><span data-stu-id="473db-110">Using guides to improve the recognition quality</span></span>
-   <span data-ttu-id="473db-111">Riconoscimento in background dinamico</span><span class="sxs-lookup"><span data-stu-id="473db-111">Dynamic background recognition</span></span>
-   <span data-ttu-id="473db-112">Riconoscimento movimenti</span><span class="sxs-lookup"><span data-stu-id="473db-112">Gesture recognition</span></span>

<span data-ttu-id="473db-113">Le interfacce utilizzate sono: [**IInkRecognizer**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognizer), **IInkRecoContext**, [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult), **IInkRecognitionGuide**, **IInkWordList**, [**IInkGesture**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkgesture), **IInkCollector**, **IInkDisp**, **IInkRenderer**, **IInkDrawingAttributes**, **IInkStrokes** e **IInkStroke**.</span><span class="sxs-lookup"><span data-stu-id="473db-113">The interfaces used are: [**IInkRecognizer**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognizer), **IInkRecoContext**, [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult), **IInkRecognitionGuide**, **IInkWordList**, [**IInkGesture**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkgesture), **IInkCollector**, **IInkDisp**, **IInkRenderer**, **IInkDrawingAttributes**, **IInkStrokes**, and **IInkStroke**.</span></span>

## <a name="ink-and-project-headers"></a><span data-ttu-id="473db-114">Intestazioni input penna e progetto</span><span class="sxs-lookup"><span data-stu-id="473db-114">Ink and Project Headers</span></span>

<span data-ttu-id="473db-115">Includere innanzitutto le intestazioni per le interfacce di automazione dei Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="473db-115">First, include the headers for Tablet PC Automation interfaces.</span></span> <span data-ttu-id="473db-116">Queste vengono installate con Tablet PC Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="473db-116">These are installed with the Tablet PC Platform SDK.</span></span> <span data-ttu-id="473db-117">Il file TpcError. h contiene le definizioni dei codici di errore dell'API Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="473db-117">The TpcError.h file contains the Tablet PC API Error Code definitions.</span></span>


```C++
#include <msinkaut.h>
#include <msinkaut_i.c>
#include <TpcError.h>
```



<span data-ttu-id="473db-118">Il file EventSinks. h definisce le interfacce **IInkEventsImpl** e **IInkRecognitionEventsImpl** e imposta gli eventi [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md), [**Stroke**](inkcollector-stroke.md)e [**gesture**](inkcollector-gesture.md) .</span><span class="sxs-lookup"><span data-stu-id="473db-118">The EventSinks.h file defines the **IInkEventsImpl** and **IInkRecognitionEventsImpl** interfaces, and sets up the [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md), [**Stroke**](inkcollector-stroke.md), and [**Gesture**](inkcollector-gesture.md) events.</span></span>


```C++
#include "EventSinks.h"
```



<span data-ttu-id="473db-119">Il file ChildWnds. h contiene le definizioni delle classi **CInkInputWnd** e **CRecoOutputWnd**, derivate dal CWindowImpl di ATL e utilizzate per la creazione delle finestre figlio dell'esempio.</span><span class="sxs-lookup"><span data-stu-id="473db-119">The ChildWnds.h file contains the definitions of the classes **CInkInputWnd** and **CRecoOutputWnd**, which are derived from the ATL's CWindowImpl and used for creating the sample's child windows.</span></span>


```C++
#include "ChildWnds.h"
```



<span data-ttu-id="473db-120">Il file AdvReco. h dichiara la classe **CAdvRecoApp** , che è la classe della finestra dell'applicazione per questo esempio.</span><span class="sxs-lookup"><span data-stu-id="473db-120">The AdvReco.h file declares the **CAdvRecoApp** class, which is the application window class for this sample.</span></span>


```C++
#include "AdvReco.h"
```



## <a name="initializing-the-application-window"></a><span data-ttu-id="473db-121">Inizializzazione della finestra dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="473db-121">Initializing the Application Window</span></span>

<span data-ttu-id="473db-122">Tramite il metodo della finestra viene `Run` impostato l'oggetto **CAdvRecoApp** , vengono caricati il menu e l'icona per la finestra, viene creato un oggetto [**InkRecognizerContext**](inkrecognizercontext-class.md) per il riconoscimento predefinito e viene avviato il ciclo di messaggi della finestra.</span><span class="sxs-lookup"><span data-stu-id="473db-122">The window's `Run` method sets up the **CAdvRecoApp** object, loads the menu and icon for the window, creates an [**InkRecognizerContext**](inkrecognizercontext-class.md) object for the default recognizer, and starts the window's message loop.</span></span>

<span data-ttu-id="473db-123">Il metodo **OnCreate** della finestra gestisce l'evento di **\_ creazione WM** e crea le finestre figlio.</span><span class="sxs-lookup"><span data-stu-id="473db-123">The window's **OnCreate** method handles the **WM\_CREATE** event and creates the child windows.</span></span> <span data-ttu-id="473db-124">Un oggetto [**InkCollector**](inkcollector-class.md) si connette all'origine eventi dell'agente di raccolta input penna e Abilita input penna nella finestra di input.</span><span class="sxs-lookup"><span data-stu-id="473db-124">An [**InkCollector**](inkcollector-class.md) object connects to the ink collector's event source, and enables ink input on the input window.</span></span> <span data-ttu-id="473db-125">Viene quindi creato un oggetto [**InkRecognizerGuide**](inkrecognizerguide-class.md) e viene utilizzata la proprietà [**renderer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_renderer) dell'agente di raccolta input penna per convertire i rettangoli della casella della Guida di riconoscimento nello spazio di input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-125">Then it creates an [**InkRecognizerGuide**](inkrecognizerguide-class.md) object and uses the ink collector's [**Renderer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_renderer) property to convert the recognition guide box rectangles to ink space.</span></span> <span data-ttu-id="473db-126">Infine, il metodo **OnCreate** crea un oggetto [**InkWord**](inkwordlist-class.md) .</span><span class="sxs-lookup"><span data-stu-id="473db-126">Finally, the **OnCreate** method creates an [**InkWordList**](inkwordlist-class.md) object.</span></span>

## <a name="handling-ink-collector-events"></a><span data-ttu-id="473db-127">Gestione degli eventi dell'agente di raccolta input penna</span><span class="sxs-lookup"><span data-stu-id="473db-127">Handling Ink Collector Events</span></span>

<span data-ttu-id="473db-128">Il metodo **OnStroke** della finestra gestisce l'evento [**Stroke**](inkcollector-stroke.md) dell'agente di raccolta input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-128">The window's **OnStroke** method handles the ink collector's [**Stroke**](inkcollector-stroke.md) event.</span></span> <span data-ttu-id="473db-129">Il nuovo oggetto [**IInkStrokeDisp**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkstrokedisp) viene aggiunto al [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) della proprietà [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) dell'agente di raccolta input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-129">The new [**IInkStrokeDisp**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkstrokedisp) object is added to the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector's [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) property.</span></span>

<span data-ttu-id="473db-130">Il metodo **Ongesto** della finestra gestisce l'evento del [**movimento**](inkcollector-gesture.md) dell'agente di raccolta input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-130">The window's **OnGesture** method handles the ink collector's [**Gesture**](inkcollector-gesture.md) event.</span></span> <span data-ttu-id="473db-131">Il metodo **OnGesture** identifica il movimento, usando prima il movimento di confidenza più elevato e controlla se la finestra supporta questo particolare movimento.</span><span class="sxs-lookup"><span data-stu-id="473db-131">The **OnGesture** method identifies the gesture, using the highest confidence gesture first, and checks if the window supports this particular gesture.</span></span> <span data-ttu-id="473db-132">Se il movimento è supportato, il rettangolo di delimitazione del movimento viene invalidato, perché il movimento viene rimosso dalla raccolta Strokes.</span><span class="sxs-lookup"><span data-stu-id="473db-132">If the gesture is supported, the gesture's bounding box is invalidated, as the gesture is removed from the strokes collection.</span></span> <span data-ttu-id="473db-133">Se il movimento non è supportato, l'evento di **movimento** viene annullato, causando la generazione di un evento [**Stroke**](inkcollector-stroke.md) da parte dell'agente di raccolta input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-133">If the gesture is not supported, the **Gesture** event is canceled, which causes the ink collector to raise a [**Stroke**](inkcollector-stroke.md) event.</span></span> <span data-ttu-id="473db-134">Infine, la finestra risultati viene aggiornata.</span><span class="sxs-lookup"><span data-stu-id="473db-134">Finally, the results window is updated.</span></span>

## <a name="handling-recognizer-context-events"></a><span data-ttu-id="473db-135">Gestione degli eventi di contesto del riconoscimento</span><span class="sxs-lookup"><span data-stu-id="473db-135">Handling Recognizer Context Events</span></span>

<span data-ttu-id="473db-136">Il metodo **OnRecognitionWithAlternates** della finestra gestisce l'evento [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md) del contesto del riconoscitore.</span><span class="sxs-lookup"><span data-stu-id="473db-136">The window's **OnRecognitionWithAlternates** method handles the recognizer context's [**RecognitionWithAlternates**](inkrecognizercontext-recognitionwithalternates.md) event.</span></span> <span data-ttu-id="473db-137">Il metodo **OnRecognitionWithAlternates** Visualizza i risultati del riconoscimento nella finestra risultati.</span><span class="sxs-lookup"><span data-stu-id="473db-137">The **OnRecognitionWithAlternates** method displays the recognition results in the results window.</span></span>

## <a name="handling-menu-commands"></a><span data-ttu-id="473db-138">Gestione dei comandi di menu</span><span class="sxs-lookup"><span data-stu-id="473db-138">Handling Menu Commands</span></span>

<span data-ttu-id="473db-139">Il metodo **Onrecognizer** della finestra gestisce i comandi nel menu Recognizer.</span><span class="sxs-lookup"><span data-stu-id="473db-139">The window's **OnRecognizer** method handles the commands on the Recognizer menu.</span></span> <span data-ttu-id="473db-140">Se è stato selezionato il comando **predefinito** , per recuperare il riconoscimento predefinito viene usato il metodo [**GetDefaultRecognizer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizers-getdefaultrecognizer) di [dagli oggetti InkRecognizer](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)) . in caso contrario, viene recuperato il riconoscimento selezionato.</span><span class="sxs-lookup"><span data-stu-id="473db-140">If the **Default** command was selected, the [**GetDefaultRecognizer**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizers-getdefaultrecognizer) method of the [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)) is used to retrieve the default recognizer; otherwise, the selected recognizer is retrieved.</span></span> <span data-ttu-id="473db-141">Viene quindi creato e utilizzato un contesto di riconoscimento e vengono aggiornati i menu e la barra di stato.</span><span class="sxs-lookup"><span data-stu-id="473db-141">Then, a recognizer context is created and used, and menu and status bar are updated.</span></span>

<span data-ttu-id="473db-142">Il metodo **OnFactoidWordlist** della finestra gestisce il comando **use WordList** **nel menu del controllo dell'oggetto** .</span><span class="sxs-lookup"><span data-stu-id="473db-142">The window's **OnFactoidWordlist** method handles the **Use Wordlist** command on the **Factoid** menu.</span></span> <span data-ttu-id="473db-143">La proprietà [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) del contesto di riconoscimento è impostata su **null** per reimpostare il contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-143">The recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property is set to **NULL** to reset the recognizer context.</span></span> <span data-ttu-id="473db-144">Se l'opzione **use WordList** è disattivata, la proprietà [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) del contesto del riconoscitore viene impostata su **null**. in caso contrario, la proprietà **WordList** del contesto del riconoscitore viene impostata sull'oggetto [**InkWord**](inkwordlist-class.md) creato nel metodo **OnCreate** .</span><span class="sxs-lookup"><span data-stu-id="473db-144">If the **Use Wordlist** option is turned off, the recognizer context's [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) property is set to **NULL**; otherwise, the recognizer context's **WordList** property is set to the [**InkWordList**](inkwordlist-class.md) that was created in the **OnCreate** method.</span></span> <span data-ttu-id="473db-145">Infine, il [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) dell'agente di raccolta input penna viene ricollegato al contesto del riconoscimento, viene chiamato il metodo [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) del contesto di riconoscimento e il menu viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="473db-145">Finally, the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector is reattached to the recognizer context, the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method is called, and the menu is updated.</span></span>

<span data-ttu-id="473db-146">Il metodo **OnFactoid** della finestra gestisce i comandi del controllo dell'oggetto **nel menu del controllo dell'oggetto** .</span><span class="sxs-lookup"><span data-stu-id="473db-146">The window's **OnFactoid** method handles the factoid commands on the **Factoid** menu.</span></span> <span data-ttu-id="473db-147">Prima imposta la proprietà [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) del contesto del riconoscitore su **null**, imposta [**la proprietà del**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) controllo del contesto del riconoscitore sul controllo del controllo selezionato e riassegna il [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) dell'agente di raccolta input penna al contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-147">It first sets the recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property to **NULL**, sets the recognizer context's [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) property to the selected factoid, and reassigns the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector to the recognizer context.</span></span> <span data-ttu-id="473db-148">Se l' [oggetto del controllo del controllo](factoid-constants.md) è supportato dal contesto del riconoscimento, viene chiamato il metodo [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) del contesto del riconoscitore; in caso contrario, viene visualizzato un messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="473db-148">If the [Factoid](factoid-constants.md) object is supported by the recognizer context, the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method is called; otherwise, an error message is displayed.</span></span> <span data-ttu-id="473db-149">Infine, il menu e la barra di stato vengono aggiornati.</span><span class="sxs-lookup"><span data-stu-id="473db-149">Finally, the menu and status bar are updated.</span></span>

<span data-ttu-id="473db-150">Il metodo **OnGuide** della finestra gestisce i comandi nel menu della **Guida** .</span><span class="sxs-lookup"><span data-stu-id="473db-150">The window's **OnGuide** method handles the commands on the **Guide** menu.</span></span> <span data-ttu-id="473db-151">Se il contesto di riconoscimento supporta le opzioni della guida, il metodo **OnGuide** imposta la proprietà [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) del contesto del riconoscitore su **null**, imposta la proprietà [**guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) del contesto di riconoscimento sull'impostazione della guida selezionata, riassegna [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) dell'agente di raccolta input penna al contesto del riconoscimento e chiama il metodo [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) del contesto di riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-151">If the recognizer context supports the guide options, the **OnGuide** method sets the recognizer context's [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property to **NULL**, sets the recognizer context's [**Guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) property to the selected guide setting, reassigns the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector to the recognizer context, and calls the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method.</span></span> <span data-ttu-id="473db-152">In caso contrario, viene visualizzato un messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="473db-152">Otherwise, an error message is displayed.</span></span> <span data-ttu-id="473db-153">Infine, la finestra di input, il menu e la barra di stato vengono aggiornati.</span><span class="sxs-lookup"><span data-stu-id="473db-153">Finally, the input window, menu, and status bar are updated.</span></span>

<span data-ttu-id="473db-154">Il metodo **Onmode** della finestra gestisce i comandi nel menu **modalità** .</span><span class="sxs-lookup"><span data-stu-id="473db-154">The window's **OnMode** method handles the commands on the **Mode** menu.</span></span> <span data-ttu-id="473db-155">Viene disabilitato l'agente di raccolta input penna, viene aggiornata la proprietà [**CollectionMode**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectionmode) dell'agente di raccolta input penna, viene aggiornato il menu e vengono visualizzati o nascosti gli elenchi di movimenti.</span><span class="sxs-lookup"><span data-stu-id="473db-155">It disables the ink collector, updates the ink collector's [**CollectionMode**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_collectionmode) property, updates the menu, and shows or hides the gesture lists.</span></span> <span data-ttu-id="473db-156">Infine, l'agente di raccolta input penna è abilitato.</span><span class="sxs-lookup"><span data-stu-id="473db-156">Finally, the ink collector is enabled.</span></span>

<span data-ttu-id="473db-157">Il metodo **Onrecognize** della finestra gestisce il comando **Recognize** nel menu di input penna.</span><span class="sxs-lookup"><span data-stu-id="473db-157">The window's **OnRecognize** method handles the **Recognize** command on the Ink menu.</span></span> <span data-ttu-id="473db-158">Chiama il metodo [**EndInkInput**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-endinkinput) del contesto del riconoscitore per evitare che l'input penna venga aggiunto al contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-158">It calls the recognizer context's [**EndInkInput**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-endinkinput) method to keep ink from being added to the recognizer context.</span></span> <span data-ttu-id="473db-159">Questo è talvolta necessario, in quanto non tutti i riconoscitori supportano il riconoscimento parziale.</span><span class="sxs-lookup"><span data-stu-id="473db-159">This is sometimes necessary, as not all recognizers support partial recognition.</span></span> <span data-ttu-id="473db-160">Chiama quindi il metodo [**Recognize**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-recognize) del contesto di riconoscimento e passa i risultati al metodo **OnRecognitionWithAlternates** della finestra.</span><span class="sxs-lookup"><span data-stu-id="473db-160">Then it calls the recognizer context's [**Recognize**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-recognize) method, and passes the results to the window's **OnRecognitionWithAlternates** method.</span></span> <span data-ttu-id="473db-161">Infine, il [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) dell'agente di raccolta input penna viene riassegnato al contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-161">Finally, the [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) of the ink collector is reassigned to the recognizer context.</span></span>

<span data-ttu-id="473db-162">Il metodo **OnClear** della finestra gestisce il comando **Clear** nel menu di **input penna** .</span><span class="sxs-lookup"><span data-stu-id="473db-162">The window's **OnClear** method handles the **Clear** command on the **Ink** menu.</span></span> <span data-ttu-id="473db-163">Elimina i tratti dalla proprietà [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) dell'agente di raccolta input penna, rilascia l'insieme di tratti obsoleti e ne crea uno nuovo per la proprietà **Ink** dell'agente di raccolta input penna e collega la nuova raccolta Strokes al contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-163">It deletes the strokes from the ink collector's [**Ink**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkcollector-get_ink) property, releases the old strokes collection and creates a new one for the ink collector's **Ink** property, and attaches the new strokes collection to the recognizer context.</span></span>

<span data-ttu-id="473db-164">Il metodo **OnExit** della finestra gestisce il comando **Exit** nel menu **Ink** e genera l' \_ evento di chiusura WM.</span><span class="sxs-lookup"><span data-stu-id="473db-164">The window's **OnExit** method handles the **Exit** command on the **Ink** menu, and raises the WM\_CLOSE event.</span></span>

## <a name="helper-methods"></a><span data-ttu-id="473db-165">Metodi helper</span><span class="sxs-lookup"><span data-stu-id="473db-165">Helper Methods</span></span>

<span data-ttu-id="473db-166">Il metodo **LoadMenu** della finestra viene chiamato dal metodo **Run** della finestra e aggiunge l'elenco dei riconoscitori supportati e l'elenco di factoids supportati nel menu.</span><span class="sxs-lookup"><span data-stu-id="473db-166">The window's **LoadMenu** method is called from the window's **Run** method, and adds the list of supported recognizers and the list of supported factoids to the menu.</span></span> <span data-ttu-id="473db-167">Viene innanzitutto recuperato il [dagli oggetti InkRecognizer](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="473db-167">First, it retrieves the [InkRecognizers](/previous-versions/windows/desktop/legacy/ms702438(v=vs.85)).</span></span> <span data-ttu-id="473db-168">Scorre quindi i riconoscitori disponibili e seleziona solo quelli che dispongono di un elenco di lingue nella proprietà **Languages** , che aggiunge al menu **Recognizer** .</span><span class="sxs-lookup"><span data-stu-id="473db-168">Then it iterates through the available recognizers and only selects ones that have a list of languages in the **Languages** property, which it adds to the **Recognizer** menu.</span></span> <span data-ttu-id="473db-169">Infine, **il menu del controllo dell'oggetto** viene popolato con l'elenco di factoids definito come costante globale.</span><span class="sxs-lookup"><span data-stu-id="473db-169">Finally, it populates the **Factoid** menu with the list of factoids defined as a global constant.</span></span>

<span data-ttu-id="473db-170">Il metodo **UseRecognizer** della finestra viene chiamato dal metodo **onrecognizer** della finestra quando l'utente seleziona un nuovo riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-170">The window's **UseRecognizer** method is called from the window's **OnRecognizer** method when the user selects a new recognizer.</span></span> <span data-ttu-id="473db-171">Viene creato un contesto di riconoscimento, viene scollegato il contesto precedente dal sink di evento Recognizer, viene cancellato e rilasciato il contesto precedente e il nuovo contesto viene collegato al sink di evento Recognizer.</span><span class="sxs-lookup"><span data-stu-id="473db-171">It creates a recognizer context, detaches the old context from the recognizer event sink, clears and releases the old context, and attaches the new context to the recognizer event sink.</span></span>

<span data-ttu-id="473db-172">Quindi, il metodo **UseRecognizer** controlla la proprietà [**capabilities**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_capabilities) del riconoscitore, che restituisce un valore [**InkRecognizerCapabilities**](/windows/desktop/api/msinkaut/ne-msinkaut-inkrecognizercapabilities) .</span><span class="sxs-lookup"><span data-stu-id="473db-172">Then, the **UseRecognizer** method checks the recognizer's [**Capabilities**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_capabilities) property, which returns an [**InkRecognizerCapabilities**](/windows/desktop/api/msinkaut/ne-msinkaut-inkrecognizercapabilities) value.</span></span> <span data-ttu-id="473db-173">Se il riconoscimento supporta l'input rigato, il comando **linee** nel menu **Guida** è abilitato.</span><span class="sxs-lookup"><span data-stu-id="473db-173">If the recognizer supports lined input, the **Lines** command on the **Guide** menu is enabled.</span></span> <span data-ttu-id="473db-174">Se il riconoscimento supporta l'input boxed, il comando **Boxes** è abilitato.</span><span class="sxs-lookup"><span data-stu-id="473db-174">If the recognizer supports boxed input, the **Boxes** command is enabled.</span></span> <span data-ttu-id="473db-175">Se il riconoscimento non supporta l'input libero, il comando **None** è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="473db-175">If the recognizer does not support free input, the **None** command is disabled.</span></span> <span data-ttu-id="473db-176">Se la selezione della Guida corrente non è supportata, viene aggiornata sia la proprietà [**guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) del contesto di riconoscimento che il menu.</span><span class="sxs-lookup"><span data-stu-id="473db-176">If the current guide selection is not supported, both the [**Guide**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_guide) property of the recognizer context and the menu are updated.</span></span>

<span data-ttu-id="473db-177">Quindi, il metodo **UseRecognizer** tenta di impostare [**le proprietà dell'**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) oggetto [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) e del controllo del contesto del contesto del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="473db-177">Then, the **UseRecognizer** method attempts to set the [**WordList**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_wordlist) and [**Factoid**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-get_factoid) properties of the recognizer context.</span></span> <span data-ttu-id="473db-178">Se una delle due impostazioni non è supportata dal riconoscimento, viene usato il valore predefinito e il menu viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="473db-178">If either setting is not supported by the recognizer, then the default value is used and the menu is updated.</span></span>

<span data-ttu-id="473db-179">Infine, il metodo **UseRecognizer** connette la proprietà [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) dell'oggetto [**InkDisp**](inkdisp-class.md) dell'agente di raccolta input penna al contesto del riconoscimento, imposta il tipo di carattere della finestra di output su uno supportato dalla lingua del riconoscimento, Reimposta la finestra di output e aggiorna i risultati del riconoscimento chiamando il metodo [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) del contesto del riconoscitore.</span><span class="sxs-lookup"><span data-stu-id="473db-179">Finally, the **UseRecognizer** method attaches the [**Strokes**](/windows/desktop/api/msinkaut15/nf-msinkaut15-iinkdivisionresult-get_strokes) property of the ink collector's [**InkDisp**](inkdisp-class.md) object to the recognizer context, changes the output window's font to one supported by the language of the recognizer, resets the output window, and updates the recognition results by calling the recognizer context's [**BackgroundRecognizeWithAlternates**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizercontext-backgroundrecognizewithalternates) method.</span></span>

<span data-ttu-id="473db-180">Il metodo **Getgesturename** della finestra viene chiamato dal metodo **ongesto** della finestra.</span><span class="sxs-lookup"><span data-stu-id="473db-180">The window's **GetGestureName** method is called from the window's **OnGesture** method.</span></span> <span data-ttu-id="473db-181">Viene eseguita la ricerca del movimento e viene restituito un indice al nome del movimento, che viene archiviato in una tabella di stringhe nel file AdvReco. RC.</span><span class="sxs-lookup"><span data-stu-id="473db-181">It searches for the gesture and returns an index to the gesture's name, which is stored in a string table in the AdvReco.rc file.</span></span>

 

 
