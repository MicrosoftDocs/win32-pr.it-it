---
description: Per supportare l'input penna nelle applicazioni, esistono due oggetti, che possono essere incorporati e supportati da qualsiasi contenitore OLE, l'oggetto input penna (tInk) e l'oggetto sketch Ink (sInk).
ms.assetid: 0202e91c-c7a0-4e7b-a1c6-a2f58c11c0be
title: Utilizzo dell'oggetto Text Ink
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 082323f7e67e76f7ae39c6b592a86f2be0945a86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307948"
---
# <a name="working-with-the-text-ink-object"></a><span data-ttu-id="d3648-103">Utilizzo dell'oggetto Text Ink</span><span class="sxs-lookup"><span data-stu-id="d3648-103">Working with the Text Ink Object</span></span>

<span data-ttu-id="d3648-104">Per supportare l'input penna nelle applicazioni, esistono due oggetti, che possono essere incorporati e supportati da qualsiasi contenitore OLE, l'oggetto input penna (tInk) e l'oggetto sketch Ink (sInk).</span><span class="sxs-lookup"><span data-stu-id="d3648-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container, the text ink object (tInk) and the sketch ink object (sInk).</span></span>

<span data-ttu-id="d3648-105">L'oggetto Ink di testo è un oggetto OLE che rappresenta l'input penna che dovrebbe formare parole.</span><span class="sxs-lookup"><span data-stu-id="d3648-105">The text ink object is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="d3648-106">Un oggetto input penna di testo consente di convertire l'input penna a mano in testo scegliendo da un elenco di alternative.</span><span class="sxs-lookup"><span data-stu-id="d3648-106">A text ink object enables the handwritten ink to be converted to text by choosing from a list of alternates.</span></span> <span data-ttu-id="d3648-107">Il colore e le dimensioni dell'oggetto input penna possono essere impostati a livello di codice e possono essere basati sugli attributi del testo intorno all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="d3648-107">The color and size of the text ink object can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="d3648-108">L'oggetto input penna è destinato a contenere una singola parola.</span><span class="sxs-lookup"><span data-stu-id="d3648-108">The text ink object is intended to contain a single word.</span></span>

<span data-ttu-id="d3648-109">L'oggetto input penna di testo supporta il set standard di interfacce OLE necessarie per l'incorporamento e il supporto degli Appunti.</span><span class="sxs-lookup"><span data-stu-id="d3648-109">The text ink object supports the standard set of OLE interfaces required for embedding and clipboard support.</span></span> <span data-ttu-id="d3648-110">L'interfaccia [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) legge e scrive in un flusso in formato ISF (Ink Serialized Format).</span><span class="sxs-lookup"><span data-stu-id="d3648-110">The [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface reads from and writes to a stream in ink serialized format (ISF).</span></span> <span data-ttu-id="d3648-111">L'oggetto input penna testo fornisce l'interfaccia [**IInkLineInfo**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) per accedere alle proprietà di visualizzazione e all'elenco dei risultati del riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="d3648-111">The text ink object provides the [**IInkLineInfo**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) interface to access its display properties, and recognition result list.</span></span>

<span data-ttu-id="d3648-112">È possibile utilizzare l'oggetto input penna per l'interoperabilità tra le applicazioni inserendolo nello slot oggetto OLE negli Appunti, incorporando il testo in formato RTF o rendendolo permanente in un flusso ISF.</span><span class="sxs-lookup"><span data-stu-id="d3648-112">The text ink object can be used for interoperability between applications either by placing it in the OLE object slot on the Clipboard, by embedding it in RTF, or by persisting it in an ISF stream.</span></span>

<span data-ttu-id="d3648-113">Un oggetto input penna di testo può essere generato nei modi seguenti.</span><span class="sxs-lookup"><span data-stu-id="d3648-113">A text ink object can be generated in the following ways.</span></span>

-   <span data-ttu-id="d3648-114">Il controllo [InkEdit](inkedit-control-reference.md) utilizza l'oggetto input penna di testo.</span><span class="sxs-lookup"><span data-stu-id="d3648-114">The [InkEdit](inkedit-control-reference.md) control makes use of the text ink object.</span></span> <span data-ttu-id="d3648-115">La funzionalità del controllo InkEdit è un set avanzato di funzionalità di controllo RichEdit standard.</span><span class="sxs-lookup"><span data-stu-id="d3648-115">The InkEdit control's functionality is a super-set of the standard RichEdit control functionality.</span></span> <span data-ttu-id="d3648-116">L'input penna viene inserito nel flusso RTF del controllo InkEdit come oggetto Ink di testo.</span><span class="sxs-lookup"><span data-stu-id="d3648-116">Ink is inserted into the InkEdit control's RTF stream as a text ink object.</span></span>
-   <span data-ttu-id="d3648-117">Quando un'applicazione copia un [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) o un oggetto [InkEdit](inkedit-control-reference.md) negli Appunti e il formato di [**Enumerazione InkClipboardFormats**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) è impostato, lo slot degli appunti degli oggetti OLE contiene un oggetto OLE input penna.</span><span class="sxs-lookup"><span data-stu-id="d3648-117">When an application copies an [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) or an [InkEdit](inkedit-control-reference.md) object onto the Clipboard and the [**InkClipboardFormats Enumeration**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) format is set, the OLE object Clipboard slot contains a text ink OLE object.</span></span>
-   <span data-ttu-id="d3648-118">Il pannello input penna di Tablet PC può generare oggetti di testo.</span><span class="sxs-lookup"><span data-stu-id="d3648-118">Tablet PC Input Panel can generate text ink objects.</span></span>

<span data-ttu-id="d3648-119">Ad esempio, l'applicazione può riconoscere la grafia e aggiungere il risultato del riconoscimento ai tratti.</span><span class="sxs-lookup"><span data-stu-id="d3648-119">For example, your application can recognize handwriting and add the recognition result to the strokes.</span></span> <span data-ttu-id="d3648-120">Quindi, se si copiano e si incollano i tratti in Microsoft Word come oggetto input penna, le alternative per tale parola sono disponibili in Word 2003 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="d3648-120">Then, if you copy and paste the strokes to Microsoft Word as a text ink object, alternates for that word is available in Word 2003 and later versions.</span></span>

<span data-ttu-id="d3648-121">Per contenere correttamente oggetti input penna, un'applicazione deve implementare il supporto del contenitore OLE per gli oggetti incorporati.</span><span class="sxs-lookup"><span data-stu-id="d3648-121">In order to successfully contain text ink objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="d3648-122">Quindi, per fare in modo che il contenitore supporti completamente l'input penna del testo, è necessario istituire:</span><span class="sxs-lookup"><span data-stu-id="d3648-122">Then, to make the container fully support text ink, you must institute:</span></span>

-   <span data-ttu-id="d3648-123">Modifiche all'applicazione per trova e Sostituisci.</span><span class="sxs-lookup"><span data-stu-id="d3648-123">Modifications to the application for Find and Replace.</span></span> <span data-ttu-id="d3648-124">Anziché ignorare gli oggetti incorporati nella ricerca, è necessario interrogare questi oggetti per il tipo.</span><span class="sxs-lookup"><span data-stu-id="d3648-124">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="d3648-125">Se si tratta di un oggetto input penna, è necessario crearne un'istanza e sottoporre a query il testo corrispondente.</span><span class="sxs-lookup"><span data-stu-id="d3648-125">If they are a text ink object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="d3648-126">Modifiche al comportamento di selezione.</span><span class="sxs-lookup"><span data-stu-id="d3648-126">Modifications to selection behavior.</span></span> <span data-ttu-id="d3648-127">La selezione di oggetti input penna di testo non deve mai essere visualizzata con handle di ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="d3648-127">Selection of text ink objects should never appear with sizing handles.</span></span> <span data-ttu-id="d3648-128">Devono essere selezionati nello stesso modo in cui il testo è selezionato nel documento.</span><span class="sxs-lookup"><span data-stu-id="d3648-128">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="d3648-129">Il codice di selezione per gli oggetti deve rilevare se il tipo è input penna e visualizzare la selezione in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="d3648-129">Selection code for objects must detect if the type is text ink and display the selection appropriately.</span></span>
-   <span data-ttu-id="d3648-130">Uso delle proprietà di ambiente.</span><span class="sxs-lookup"><span data-stu-id="d3648-130">Use of ambient properties.</span></span> <span data-ttu-id="d3648-131">Le proprietà di ambiente, ad esempio la dimensione del carattere, il colore e la formattazione in grassetto, devono essere trasmesse all'oggetto Ink di testo.</span><span class="sxs-lookup"><span data-stu-id="d3648-131">Ambient properties such as font size, color, and bold formatting need to be transmitted to the text ink object.</span></span> <span data-ttu-id="d3648-132">L'applicazione di queste proprietà modifica la larghezza dell'input penna a mano, quindi è necessario un aggiornamento delle dimensioni chiamando il metodo [**IInkLineInfo:: GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) o [**IOleObject:: GetExtent**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="d3648-132">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**IInkLineInfo::GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [**IOleObject::GetExtent**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="d3648-133">Contenuto della sezione</span><span class="sxs-lookup"><span data-stu-id="d3648-133">In This Section</span></span>

-   [<span data-ttu-id="d3648-134">Conversione di un oggetto input penna in input penna</span><span class="sxs-lookup"><span data-stu-id="d3648-134">Converting a Text Ink Object to Ink</span></span>](converting-a-text-ink-object-to-ink.md)
-   [<span data-ttu-id="d3648-135">API Text Ink</span><span class="sxs-lookup"><span data-stu-id="d3648-135">Text Ink APIs</span></span>](text-ink-apis.md)
-   [<span data-ttu-id="d3648-136">Oggetti sInk e tInk</span><span class="sxs-lookup"><span data-stu-id="d3648-136">sInk and tInk Objects</span></span>](sink-and-tink-objects.md)

 

 
