---
description: Per supportare l'input penna nelle applicazioni, esistono due oggetti, che possono essere incorporati e supportati da qualsiasi contenitore OLE.
ms.assetid: fbd7bdf0-63b4-48d1-be91-eabbbb3f1618
title: Oggetti sInk e tInk
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ef7ed1c06d256fe8eda9fad4bf15afa19fcb833
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106319146"
---
# <a name="sink-and-tink-objects"></a><span data-ttu-id="db76f-103">Oggetti sInk e tInk</span><span class="sxs-lookup"><span data-stu-id="db76f-103">sInk and tInk Objects</span></span>

<span data-ttu-id="db76f-104">Per supportare l'input penna nelle applicazioni, esistono due oggetti, che possono essere incorporati e supportati da qualsiasi contenitore OLE.</span><span class="sxs-lookup"><span data-stu-id="db76f-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container.</span></span> <span data-ttu-id="db76f-105">Vengono generati chiamando il metodo **Ink. ClipboardCopy (Rectangle, InkClipboardFormats, InkClipboardModes)** o il metodo **Ink. ClipboardCopy (Strokes, InkClipboardFormats, InkClipboardModes)** e sono:</span><span class="sxs-lookup"><span data-stu-id="db76f-105">They are produced by calling either the **Ink.ClipboardCopy Method (Rectangle, InkClipboardFormats, InkClipboardModes)** or the **Ink.ClipboardCopy Method (Strokes, InkClipboardFormats, InkClipboardModes)** method and are:</span></span>

-   <span data-ttu-id="db76f-106">Oggetto input penna del testo (tInk).</span><span class="sxs-lookup"><span data-stu-id="db76f-106">Text ink object (tInk).</span></span> <span data-ttu-id="db76f-107">Si tratta di un oggetto OLE che rappresenta l'input penna che dovrebbe formare parole.</span><span class="sxs-lookup"><span data-stu-id="db76f-107">This is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="db76f-108">Un oggetto tInk consente la conversione dell'input penna manoscritto in testo, come il testo restituito da un riconoscimento o la scelta effettuata da un elenco di alternative di riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="db76f-108">A tInk object allows the handwritten ink to be converted to text, either as the text returned by a recognizer or the choice taken from a list of recognition alternates.</span></span> <span data-ttu-id="db76f-109">Il colore e le dimensioni dell'input penna possono essere impostati a livello di codice e possono essere basati sugli attributi del testo intorno all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="db76f-109">The color and size of the ink can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="db76f-110">L'oggetto tInk è destinato a contenere una singola parola. L'oggetto tInk è un piccolo oggetto leggero che può eseguire semplici operazioni come il rendering (dato un handle a un contesto di dispositivo (HDC) e un RECT) e la persistenza (dato un flusso).</span><span class="sxs-lookup"><span data-stu-id="db76f-110">The tInk object is intended to contain a single word.The tInk object is a small, lightweight object that can perform simple operations like rendering (given a handle to a device context (HDC) and a RECT), and persisting itself (given a stream).</span></span> <span data-ttu-id="db76f-111">L'uso di un oggetto tInk consente un'esperienza utente trasparente quando si lavora in un'applicazione che usa l'input della grafia e del testo.</span><span class="sxs-lookup"><span data-stu-id="db76f-111">Using a tInk object allows a seamless user experience when working in an application that uses input of both handwriting and text.</span></span>
-   <span data-ttu-id="db76f-112">Oggetto sketch Ink (sInk).</span><span class="sxs-lookup"><span data-stu-id="db76f-112">Sketch ink object (sInk).</span></span> <span data-ttu-id="db76f-113">Si tratta di un oggetto OLE che rappresenta l'input penna che non si prevede di creare parole.</span><span class="sxs-lookup"><span data-stu-id="db76f-113">This is an OLE object representing ink that is not expected to form words.</span></span> <span data-ttu-id="db76f-114">Un oggetto sInk viene interpretato come un disegno.</span><span class="sxs-lookup"><span data-stu-id="db76f-114">A sInk object is interpreted as a drawing.</span></span> <span data-ttu-id="db76f-115">Un oggetto sInk è utile anche per rappresentare più parole.</span><span class="sxs-lookup"><span data-stu-id="db76f-115">A sInk object is also useful for representing multiple words.</span></span>

<span data-ttu-id="db76f-116">Questi oggetti possono essere utilizzati per l'interoperabilità tra le applicazioni, inserendoli nello slot oggetto OLE negli Appunti o incorporando tali oggetti in formato RTF (Rich Text Format).</span><span class="sxs-lookup"><span data-stu-id="db76f-116">These objects can be used for interoperability between applications, either by placing them in the OLE object slot on the Clipboard or by embedding them in Rich Text Format (RTF).</span></span>

<span data-ttu-id="db76f-117">È possibile usare gli oggetti tInk e sInk nei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="db76f-117">You can use tInk and sInk objects in the following ways:</span></span>

-   <span data-ttu-id="db76f-118">Entrambi gli oggetti tInk e sInk sono supportati in Microsoft Word 2002.</span><span class="sxs-lookup"><span data-stu-id="db76f-118">Both tInk and sInk objects are supported in Microsoft Word 2002.</span></span> <span data-ttu-id="db76f-119">Gli utenti possono inserire input penna in un documento di Word usando i pannelli di input di testo di scrittura e disegno forniti in Word 2002.</span><span class="sxs-lookup"><span data-stu-id="db76f-119">Users can insert ink into a Word document by using the writing and drawing text input panels provided in Word 2002.</span></span> <span data-ttu-id="db76f-120">Questo input penna viene incorporato nel file di Word come oggetto OLE con il CLSID dell'oggetto sInk o tInk.</span><span class="sxs-lookup"><span data-stu-id="db76f-120">This ink is embedded into the Word file as an OLE object with the CLSID of either the sInk or tInk object.</span></span>
-   <span data-ttu-id="db76f-121">Il controllo [InkEdit](/previous-versions/ms552265(v=vs.100)) di Tablet PC usa l'oggetto Tink.</span><span class="sxs-lookup"><span data-stu-id="db76f-121">The Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) control makes use of the tInk object.</span></span> <span data-ttu-id="db76f-122">Il controllo InkEdit è una sottoclasse del controllo [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) standard.</span><span class="sxs-lookup"><span data-stu-id="db76f-122">The InkEdit control is a subclass of the standard [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) control.</span></span> <span data-ttu-id="db76f-123">L'input penna viene inserito nel flusso RTF del controllo InkEdit come oggetto tInk.</span><span class="sxs-lookup"><span data-stu-id="db76f-123">Ink is inserted into the InkEdit control's RTF stream as a tInk object.</span></span>
-   <span data-ttu-id="db76f-124">Quando un'applicazione sposta un oggetto [input penna](/previous-versions/aa515768(v=msdn.10)) selezionato negli Appunti, lo slot degli appunti degli oggetti OLE contiene un oggetto OLE TInk o sink.</span><span class="sxs-lookup"><span data-stu-id="db76f-124">When an application moves a selected [Ink](/previous-versions/aa515768(v=msdn.10)) object onto the Clipboard, the OLE object Clipboard slot contains a tInk or sInk OLE object.</span></span>

<span data-ttu-id="db76f-125">Ad esempio, l'applicazione può riconoscere la grafia e contrassegnare un oggetto [input penna](/previous-versions/aa515768(v=msdn.10)) come oggetto Tink.</span><span class="sxs-lookup"><span data-stu-id="db76f-125">For example, your application can recognize handwriting and mark any [Ink](/previous-versions/aa515768(v=msdn.10)) object as a tInk object.</span></span> <span data-ttu-id="db76f-126">Quindi, se si seleziona una parola in input penna e la si copia e incolla in Word, le alternative per tale parola vengono visualizzate in Word 2002.</span><span class="sxs-lookup"><span data-stu-id="db76f-126">Then, if you select a word in ink and copy and paste it to Word, alternates for that word are shown in Word 2002.</span></span>

> [!Note]  
> <span data-ttu-id="db76f-127">Il supporto per gli Appunti della piattaforma Tablet PC seleziona automaticamente il flag EMF (Enhanced Metafile) quando si inserisce un oggetto sInk o tInk negli Appunti come oggetto OLE.</span><span class="sxs-lookup"><span data-stu-id="db76f-127">The Tablet PC Platform's Clipboard support automatically selects the Enhanced Metafile (EMF) flag for you when you place a sInk or tInk object on the Clipboard as an OLE object.</span></span> <span data-ttu-id="db76f-128">L'oggetto stesso viene archiviato negli Appunti negli slot di incorporamento dell'origine e del descrittore dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="db76f-128">The object itself is stored on the Clipboard in the embed source and object descriptor slots.</span></span>

 

<span data-ttu-id="db76f-129">Come altro esempio, usando l'oggetto sInk, è possibile disegnare uno schizzo di input penna in un'applicazione, copiare e incollare lo sketch in Word 2002, quindi modificare il disegno usando il pannello di input di Tablet PC in Word.</span><span class="sxs-lookup"><span data-stu-id="db76f-129">As another example, by using the sInk object, you can draw an ink sketch in an application, copy and paste the sketch to Word 2002, and then edit the drawing by using Tablet PC Input Panel in Word.</span></span>

<span data-ttu-id="db76f-130">Per contenere correttamente gli oggetti tInk, un'applicazione deve implementare il supporto del contenitore OLE per gli oggetti incorporati.</span><span class="sxs-lookup"><span data-stu-id="db76f-130">In order to successfully contain tInk objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="db76f-131">Quindi, per fare in modo che il contenitore supporti completamente tInk, è necessario istituire:</span><span class="sxs-lookup"><span data-stu-id="db76f-131">Then, to make the container fully support tInk, you must institute:</span></span>

-   <span data-ttu-id="db76f-132">Modifiche al codice per trova e Sostituisci.</span><span class="sxs-lookup"><span data-stu-id="db76f-132">Modifications to the code for Find and Replace.</span></span> <span data-ttu-id="db76f-133">Anziché ignorare gli oggetti incorporati nella ricerca, è necessario interrogare questi oggetti per il tipo.</span><span class="sxs-lookup"><span data-stu-id="db76f-133">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="db76f-134">Se sono un oggetto tInk, è necessario crearne un'istanza ed eseguire una query per ottenere il testo corrispondente.</span><span class="sxs-lookup"><span data-stu-id="db76f-134">If they are a tInk object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="db76f-135">Modifiche al comportamento di selezione.</span><span class="sxs-lookup"><span data-stu-id="db76f-135">Modifications to selection behavior.</span></span> <span data-ttu-id="db76f-136">La selezione degli oggetti tInk non dovrebbe mai essere visualizzata con handle di ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="db76f-136">Selection of tInk objects should never appear with sizing handles.</span></span> <span data-ttu-id="db76f-137">Devono essere selezionati nello stesso modo in cui il testo è selezionato nel documento.</span><span class="sxs-lookup"><span data-stu-id="db76f-137">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="db76f-138">Il codice di selezione per gli oggetti deve rilevare se il tipo è tInk e visualizzare la selezione in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="db76f-138">Selection code for objects must detect if the type is tInk and display the selection appropriately.</span></span>
-   <span data-ttu-id="db76f-139">Uso delle proprietà di ambiente.</span><span class="sxs-lookup"><span data-stu-id="db76f-139">Use of ambient properties.</span></span> <span data-ttu-id="db76f-140">Le proprietà di ambiente, ad esempio la dimensione del carattere, il colore e la formattazione in grassetto, devono essere trasmesse all'oggetto tInk.</span><span class="sxs-lookup"><span data-stu-id="db76f-140">Ambient properties such as font size, color, and bold formatting need to be transmitted to the tInk object.</span></span> <span data-ttu-id="db76f-141">L'applicazione di queste proprietà modifica la larghezza dell'input penna a mano, quindi è necessario un aggiornamento delle dimensioni chiamando il [**Metodo GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) o il metodo [IOleObject:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="db76f-141">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**GetInkExtent Method**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>
-   <span data-ttu-id="db76f-142">Eseguire l'override dell'elaborazione del metodo [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) predefinito.</span><span class="sxs-lookup"><span data-stu-id="db76f-142">Override the default [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) method processing.</span></span> <span data-ttu-id="db76f-143">Questo consente la conversione in testo per passare un batch di oggetti tInk al riconoscimento, che può quindi suddividere le parole in segmenti di riconoscimento.</span><span class="sxs-lookup"><span data-stu-id="db76f-143">This allows conversion to text to pass a batch of tInk objects to the recognizer, which can then break the words into recognition segments.</span></span>

<span data-ttu-id="db76f-144">Per altre informazioni su come suddividere le parole in segmenti di riconoscimento, vedere [segmenti di riconoscimento](recognition-segments.md).</span><span class="sxs-lookup"><span data-stu-id="db76f-144">For more information about breaking words into recognition segments, see [Recognition Segments](recognition-segments.md).</span></span>

 

 
