---
description: La versione di Windows Vista include un nuovo oggetto programmabilità per il pannello input penna di Tablet PC che offre una nuova gamma di possibilità di utilizzo e di interazione tra un'applicazione e il pannello di input.
ms.assetid: 539f41d3-5fb8-4e20-99ba-0d5af1f0cc54
title: TextInputPanel per utenti di PenInputPanel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14ed213db49427d997f0ea1dda414cf1a6a0c2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349076"
---
# <a name="textinputpanel-for-users-of-peninputpanel"></a>TextInputPanel per utenti di PenInputPanel

La versione di Windows Vista include un nuovo oggetto programmabilità per il pannello input penna di Tablet PC che offre una nuova gamma di possibilità di utilizzo e di interazione tra un'applicazione e il pannello di input. Per la prima volta, gli sviluppatori di applicazioni possono posizionare l'icona del pannello di input In-Place per allinearla con una casella di testo o posizionarla nell'angolo di una superficie del cliente Inking per consentire l'accesso a una modalità di input alternativa. Gli sviluppatori hanno lo stesso controllo sul posizionamento dopo che l'icona del pannello di input è stata espansa nel pannello di input In-Place. In questo modo è possibile assicurarsi che il pannello di input In-Place non si sovrappongano mai con gli elementi chiave dell'interfaccia utente nel layout di un'applicazione o anche per rifluire l'interfaccia utente di un'applicazione per rendere disponibile spazio per il pannello di input In-Place e quindi posizionarlo nello spazio riservato. Il nuovo modello di programmabilità include il supporto per più del semplice posizionamento, tuttavia gli sviluppatori possono anche personalizzare l'area di input, la modalità di correzione e molte altre proprietà del pannello di input per personalizzare l'esperienza di immissione di testo in un'applicazione. Infine, per la prima volta è possibile che un'applicazione riceva l'input penna dell'utente, oltre al testo riconosciuto, associato a inserimenti di testo dal pannello di input. Questo consente nuovi scenari di applicazione, tra cui l'input penna nei log di rilevamento delle modifiche e consente agli utenti di modificare o visualizzare l'input penna nell'applicazione. Queste nuove funzionalità di programmabilità sono il risultato diretto dei commenti e suggerimenti ricevuti da Microsoft sul pannello di input e rappresentano il primo passo verso un'integrazione più stretta delle applicazioni e del pannello di input.

Per fornire questo modello di programmabilità del pannello di input arricchito, il meccanismo esistente per interagire a livello di codice con il pannello di input, l'oggetto [**PenInputPanel**](peninputpanel-class.md) , viene deprecato e sostituito dal nuovo oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) . Oltre a fornire nuove funzionalità di programmabilità, l'oggetto **TextInputPanel** fornisce anche quasi tutte le funzionalità a livello di codice dell'oggetto **PenInputPanel** . L'oggetto **TextInputPanel** è incluso sia in Windows Vista che in Windows Vista Software Developer Kit. L'oggetto **TextInputPanel** è compatibile solo con il pannello di input di Windows Vista e non può essere utilizzato con Windows XP Service Pack 2 o con un pannello di input precedente. L'applicazione precedentemente scritta per l'utilizzo dell'oggetto **PenInputPanel** continuerà a funzionare con il pannello di input di Windows Vista. Tuttavia, quando si scrivono nuove applicazioni tablet, gli sviluppatori sono vivamente invitati a usare il nuovo oggetto **TextInputPanel** anziché l'oggetto **PenInputPanel** deprecato.

Ognuna delle opzioni di programmabilità dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) può essere applicata in base ai singoli campi di testo. Questa operazione viene eseguita connettendo un'istanza dell'oggetto **TextInputPanel** usando la proprietà [**AttachedEditWindow**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow) . La proprietà deve essere impostata sull'handle della finestra per il campo di testo.

> [!Note]  
> : Molte delle proprietà e dei metodi descritti di seguito si applicano quando il pannello di input si trova nella modalità di interazione sul posto e non quando il pannello di input è in modalità di interazione mobile o ancorata. La modalità di interazione sul posto è il comportamento del pannello di input in cui lo stato attivo in un campo modificabile fa sì che l'icona del pannello di input appaia accanto al campo e toccando l'icona del pannello di input si espande il pannello di input. I metodi e le proprietà che si applicano solo quando il pannello di input si trova nella modalità di interazione sul posto contengono tutti ' inplace ' nel nome del metodo o della proprietà.

 

## <a name="control-of-input-panel-icon-and-input-panel-visibility"></a>Controllo dell'icona del pannello di input e della visibilità del pannello di input

Il primo aspetto del pannello di input di cui gli sviluppatori di applicazioni hanno maggiore controllo in Windows Vista è la visibilità. Utilizzando l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è possibile controllare la visibilità del pannello di input In-Place in tre modi. Con una combinazione di proprietà e metodi, un'applicazione può determinare se il pannello di input In-Place Visualizza, quando viene visualizzato il pannello di input In-Place e se viene visualizzato per primo come icona del pannello di input o viene visualizzato immediatamente espanso. Combinando queste tecniche per controllare la visibilità con le tecniche per il controllo del posizionamento illustrato nella sezione successiva, gli sviluppatori di applicazioni possono creare punti di avvio personalizzati e flussi di lavoro personalizzati usando il In-Place pannello di input in un'applicazione.

> [!Note]  
> Le proprietà e i metodi descritti in questa sezione si applicano solo quando il pannello di input è in modalità di interazione In-Place.

 

Per prima cosa, è possibile impedire che il pannello di input In-Place e l'icona del pannello di input vengano visualizzati impostando la proprietà [**oggetto InPlaceVisibleOnFocus**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) su **false**. Se è impostato su **true** , il valore predefinito del sistema viene visualizzato quando possibile, purché non sia stato disabilitato dall'utente o criteri di gruppo. Questa opzione è utile per le applicazioni che includono soluzioni di immissione di testo personalizzate come alternativa al pannello di input.

In secondo luogo, impostando la proprietà [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) uno sviluppatore può specificare quale stato sul posto, come specificato dall'enumerazione [**InPlaceState**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) , viene visualizzato il pannello di input In-Place quando lo stato attivo viene inserito in un campo di testo. Il valore predefinito del sistema è che il pannello di input In-Place venga visualizzato nello stato del passaggio del mouse, a meno che il pannello di input non sia già visibile nello stato espanso, nel qual caso il pannello di input rimane espanso. Se si imposta la proprietà **DefaultInPlaceState** su **InPlaceState \_ espanso** , il pannello di input In-Place sarà sempre espanso, invece dell'icona del pannello di input visualizzato per primo e quindi richiede all'utente di toccare l'icona del pannello di input prima che il pannello di input venga espanso. Le altre due opzioni sono **InPlaceState \_ auto**, ovvero il comportamento predefinito del sistema e **InPlaceState \_ HoverTarget** , che determina sempre la visualizzazione dell'icona del pannello di input. La possibilità di specificare che il pannello di input In-Place visualizzato sempre espanso è nuovo con l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) e non è possibile usare l'oggetto [**PenInputPanel**](peninputpanel-class.md) . La figura seguente mostra l'icona del pannello di input In-Place e gli stati espansi del pannello.

![icona del pannello input sul posto e stati espansi](images/8ce866b6-9a45-499f-a3d1-95a1d34d6402.jpg)

Oltre a poter controllare lo stato sul posto, è anche possibile che uno sviluppatore determini lo stato sul posto in un determinato momento ottenendo la proprietà [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) . **CurrentInPlaceState** è uguale a [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) quando il pannello di input non è visibile, tranne quando **DefaultInPlaceState** è **InPlaceState \_ auto** , nel qual caso il **CurrentInPlaceState** diventa **InPlaceState \_** HoverTarget. Gli [](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  eventi [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged) di InPlaceVisibilityChanging possono essere usati per tenere traccia dello stato di visibilità del pannello di input In-Place.

Infine, uno sviluppatore può forzare il pannello di input In-Place per nascondere o mostrare usando il metodo [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) . Se lo sviluppatore ha precedentemente impostato la proprietà [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) , il pannello di input viene visualizzato nello stato specificato quando viene forzata la visualizzazione. Un'applicazione può nascondere o mostrare il In-Place Pannello input quando lo stato attivo è attualmente nella finestra a cui è collegato l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) e quando l'utente non dispone di un pannello di input aperto in un'altra modalità di interazione, ad esempio ancorato o mobile. La possibilità di forzare il pannello di input In-Place per nascondere o mostrare è anche una novità con l'oggetto **TextInputPanel** e non è possibile usare l'oggetto [**PenInputPanel**](peninputpanel-class.md) .

Queste opzioni consentono agli sviluppatori di applicazioni di controllare con precisione quando viene visualizzato il pannello di input In-Place e in quale stato. Personalizzando lo stato sul posto predefinito e controllando la visibilità sul posto indipendentemente dalle modifiche dello stato attivo, uno sviluppatore di applicazioni può creare un flusso di lavoro personalizzato quando il pannello di input risponde alle impostazioni dell'applicazione o all'input dell'utente in un'applicazione.

## <a name="absolute-positioning-of-input-panel-icon-and-input-panel"></a>Posizionamento assoluto dell'icona del pannello di input e del pannello di input

Probabilmente la nuova funzionalità più interessante presente nell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il posizionamento assoluto del pannello di input In-Place. Grazie a questa nuova funzionalità, lo sviluppatore di applicazioni può garantire che il pannello di input In-Place non si sovrappongano a uno o più elementi visivi chiave nel layout di un'applicazione. Utilizzando l'oggetto [**PenInputPanel**](peninputpanel-class.md) è possibile posizionare il pannello di input In-Place in relazione a un campo di testo in base a un offset. Tuttavia, il pannello di input si adatterà comunque a mantenere lo schermo. Per la prima volta in vista, un'applicazione può posizionare il In-Place pannello di input in una posizione assoluta usando le coordinate dello schermo. Inoltre, la responsabilità di mantenere il pannello di input sullo schermo viene lasciata allo sviluppatore di applicazioni, quindi rimuovendo la possibilità che il pannello di input venga automaticamente riposizionato in modo casuale.

> [!Note]  
> Le proprietà e i metodi descritti in questa sezione si applicano solo quando il pannello di input è in modalità di interazione In-Place.

 

I due metodi principali necessari per posizionare in modo assoluto il In-Place pannello di input sono [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) e [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition). Il primo viene usato per specificare il percorso del pannello di input In-Place e il secondo viene usato per specificare il percorso dell'icona del pannello di input per il pannello In-Place input. Se un'applicazione sceglie di impostare solo il percorso dell'icona del pannello di input e non il percorso del pannello di input In-Place, il pannello di input In-Place viene visualizzato nella posizione predefinita determinata dal sistema. Analogamente, se un'applicazione riposiziona il pannello di input In-Place ma non l'icona del pannello di input, l'icona del pannello di input viene visualizzata nella posizione predefinita. Il percorso è specificato nelle coordinate dello schermo. Il punto effettivo posizionato è l'angolo superiore sinistro dell'icona del pannello di input o del pannello di input senza il pettine di correzione espanso. Quando il pettine di correzione è espanso, il punto posizionato non cambia. (Vedere la figura 2 di seguito) Non sono previsti limiti per la posizione in cui il pannello di input In-Place e l'icona del pannello di input In-Place possono essere posizionati ed è responsabilità delle applicazioni chiamare questi metodi per mantenerli sullo schermo. Entrambi i metodi sono sincroni, ovvero il posizionamento viene eseguito prima della restituzione del metodo. Nel caso in cui il pannello di input sia già aperto nella modalità di interazione mobile o ancorata, un tentativo di posizionare il pannello di input In-Place o l'icona del pannello di input In-Place non riesce. Inoltre, i metodi hanno esito negativo se la finestra collegata all'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) non ha attualmente lo stato attivo.

Una chiamata a [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) o [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) non determina automaticamente la visualizzazione dell'icona del pannello di input o del pannello di input In-Place, ma imposta semplicemente la posizione per la volta successiva che viene visualizzata. La chiamata a [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) può essere usata per forzare la visualizzazione immediata.

![misurazioni del pannello input sul posto](images/0c67a77a-5d2f-489f-9357-b8a168d024d3.jpg)

Quando si posiziona il In-Place pannello di input che calcola se lo schermo verrà disattivato, può risultare un po' difficile. Per semplificare questo processo, sono disponibili diverse proprietà dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) che possono essere usate per semplificare questo processo. Insieme è possibile utilizzare queste proprietà ed evento per determinare le dimensioni esatte del pannello di input In-Place in tutti gli Stati:

-   [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle): questa proprietà fornisce il rettangolo di delimitazione per il pannello di input In-Place quando viene visualizzata l'area di input più grande per la lingua di input corrente. Se il riquadro di scrittura o il riquadro dei caratteri è determinato dall'area di input più grande, viene inclusa l'altezza del pulsante Inserisci. Non include l'altezza del pettine di correzione. Quando il pannello di input In-Place auto cresce [](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging),  /  viene attivata la coppia di eventi InPlaceSizeChanging [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged) e il valore di questa proprietà viene aggiornato in modo da includere l'area di scrittura aggiuntiva o la riga di scrittura.
-   [**PopUpCorrectionHeight**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight): questa proprietà specifica l'altezza del pettine di correzione post-inserimento quando è posizionato sopra il pannello di input. Per ottenere l'altezza massima del pannello In-Place input con il pettine di correzione post-inserimento, aggiungere l'altezza di [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) a **PopUpCorrectionHeight**.

Come alternativa più semplice per impostare la posizione assoluta del pannello di input In-Place e dell'icona del pannello di input, un'applicazione può solo specificare se il pannello di input di In-Place predefinito viene visualizzato al di sopra o al di sotto di un campo di immissione di testo. In questo modo è possibile evitare la sovrapposizione di elementi nel layout dell'applicazione in modo più controllato. A tale scopo, l'applicazione imposta [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) su **InPlaceDirection \_ Bottom** o **InPlaceDirection \_ Top**. La proprietà è una preferenza perché il pannello di input In-Place sostituisce le preferenze impostate dall'applicazione quando necessario per la conservazione del pannello di input sullo schermo. Il valore predefinito di sistema è quello di posizionare il pannello di input In-Place sotto un campo di testo, se possibile, e in caso contrario posizionarlo sopra. Impostando **PreferredInPlaceDirection** su **InPlaceDirection \_** , viene ripristinato automaticamente il valore predefinito di sistema.

Insieme, le proprietà, i metodi e gli eventi dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) offrono agli sviluppatori il controllo necessario sul pannello di input In-Place per poter posizionare in modo intelligente il pannello di input e l'icona del pannello di input In-Place nel layout dell'applicazione in modo che non interrompano il flusso di layout e in alcuni casi possano apparire integrati. Questo nuovo livello di controllo è una grande vittoria per la progettazione di applicazioni per tablet.

## <a name="access-to-the-three-input-panel-areas-writing-pad-character-pad-and-keyboard"></a>Accesso alle tre aree del pannello di input: scrittura di riempimento, riempimento di caratteri e tastiera

Il pannello di input presenta tre aree di input, il riquadro di scrittura, il riquadro dei caratteri e la tastiera. Utilizzando l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) , un'applicazione può specificare l'area di input predefinita visualizzata all'utente quando viene aperto il pannello di input. Il motivo principale per cui un'applicazione è eseguire questa operazione consiste nell'associare l'area di input al tipo di input di un campo specifico. Ad esempio, il riquadro di scrittura è probabilmente ideale per compilare un campo di commenti, ma la tastiera può essere più comoda per l'immissione di un numero di serie del prodotto che contiene sia numeri che lettere. Per specificare l'area di input predefinita, un'applicazione imposta la proprietà [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) su una delle tre aree di input in base a quanto definito dall'enumerazione [**PanelInputArea**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) . Nella figura seguente sono illustrate le tre aree di input.

![scrittura, carattere e pannello di input da tastiera](images/3f1e3d03-88b9-478c-b12d-00d341bc8d5c.jpg)

L'area di input predefinita del sistema è il riquadro di scrittura per l'inglese, il francese, il tedesco, spagnolo, italiano, portoghese, olandese e tutte le altre lingue di input latine. Per le lingue di input asiatiche orientali, tra cui giapponese, cinese e coreano, l'area di input predefinita è il riquadro dei caratteri. Tuttavia, quando l'utente modifica l'area di input, sostituisce l'area di input predefinita per la lingua di input corrente e viene archiviata come nuova impostazione predefinita per la lingua di input. La tastiera è l'area di input predefinita per i campi password, indipendentemente dalla lingua di input, a meno che la sicurezza della password non sia stata disabilitata dall'utente o da criteri di gruppo. In tutti i casi, l'impostazione predefinita dell'area del pannello di input sostituisce l'impostazione predefinita del sistema, a meno che il campo corrente non sia un campo della password o il riconoscimento della grafia per la lingua di input corrente non supporta l'area di input selezionata a livello di codice. Se si imposta la proprietà [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) su InPlaceDirection, le impostazioni predefinite del sistema vengono ripristinate **\_ automaticamente** .

Indipendentemente dal fatto che l'area del pannello di input predefinita sia stata impostata a livello di codice o meno, l'utente ha la possibilità di modificare l'area del pannello di input corrente dopo che il pannello di input è aperto. Dopo che l'utente ha modificato l'area di input corrente, la selezione dell'utente viene mantenute fino alla chiusura del pannello di input o alla modifica della selezione da parte dell'utente. Dopo che il pannello di input è stato chiuso e riaperto, l'area di input predefinita viene impostata nuovamente a livello di codice.

Poiché l'area del pannello di input corrente può essere diversa dall'area del pannello di input predefinita, un'applicazione può eseguire una query sulla proprietà [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) per determinare quale area di input è attualmente visibile. Se il pannello input non è attualmente visibile, l'area di input corrente è uguale all'area di input predefinita. La proprietà **CurrentInputArea** non è mai uguale a **PanelInputArea \_ auto**. Se il valore di [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) è uguale a **PanelInputArea \_ auto**, **CurrentInputArea** è uguale all'ultima area di input visualizzata o al sistema per la lingua di input corrente se il pannello di input non è mai stato visualizzato.

La differenza principale tra il supporto dell'area di input trovata nell'oggetto [**PenInputPanel**](peninputpanel-class.md) e quella dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il fatto che l'applicazione ha ora la possibilità di impostare l'area di input predefinita sul riquadro dei caratteri, oltre al riquadro di scrittura e alla tastiera.

Utilizzando le proprietà precedenti, un'applicazione può controllare l'area di input del pannello di input visualizzata in campi diversi e ottimizzare l'esperienza di input di testo dell'utente. Inoltre, l'applicazione può mantenere la consapevolezza dell'area di input corrente e prendere decisioni condizionali in base all'area di input più adatta all'attività dell'utente corrente.

## <a name="detailed-information-about-input-panels-interaction-mode"></a>Informazioni dettagliate sulla modalità di interazione del pannello di input

Oltre a essere in grado di rilevare l'area di input corrente del pannello di input, è anche possibile rilevare la modalità di interazione corrente: sul posto, ancorato o mobile. Potrebbe essere importante che l'applicazione conosca la modalità di interazione corrente per comprendere il modo in cui l'utente interagisce con l'applicazione o perché alcuni metodi e proprietà dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) si applicano solo alla modalità di interazione In-Place. Nell'applicazione, ad esempio, i riflussi degli elementi dell'interfaccia utente esistenti e quindi posiziona il In-Place Pannello input su un'area vuota nelle interfacce utente devono verificare che la modalità di interazione corrente sia attiva prima di apportare modifiche.

![modalità pannello di input ancorato, a virgola mobile e in-pace](images/98c8e96b-99b2-477a-9843-33b1fae7e75b.jpg)

La proprietà [**CurrentInteractionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode) dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) archivia la modalità di interazione corrente come scelto dall'utente. Le modalità possibili sono definite dall'enumerazione [**InteractionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) come:

**InteractionMode \_ Inplace**: nel pannello di input della modalità di interazione In-Place viene visualizzato accanto al campo immissione testo che attualmente ha lo stato attivo. Per impostazione predefinita, l'icona del pannello di input In-Place viene visualizzata quando un punto di inserimento viene inserito in un campo di immissione di testo. Toccando l'icona del pannello di input si espande il pannello di input. Il pannello di input In-Place è visibile solo quando un punto di inserimento si trova in un campo modificabile.

InteractionMode \_ mobile: la modalità di interazione a virgola mobile è simile alla modalità di interazione inplace, ad eccezione del fatto che non è associata a un punto di inserimento. Il pannello di input mobile viene aperto toccando la scheda Pannello di input che viene visualizzata per impostazione predefinita sul bordo sinistro dello schermo. Sia il pannello di input mobile che la scheda Pannello di input possono essere trascinati e riposizionati dall'utente. Nel posizionamento in modalità a virgola mobile e il controllo del pannello di input viene lasciato interamente all'utente.

InteractionMode \_ DockedTop: nel pannello di input Docked-Top modalità di interazione viene visualizzato nella parte superiore dello schermo e il desktop attivo viene ridimensionato, quindi il pannello di input non si sovrappone ad altri elementi Windows o dell'interfaccia utente. Non è possibile trascinare o spostare il pannello di input in modalità ancorata.

InteractionMode \_ DockedBottom: la modalità di interazione Docked-Bottom è identica alla modalità Docked-Top ad eccezione del pannello di input nella parte inferiore della schermata.

Quando il pannello input non è visibile, la modalità di interazione corrente è sul posto.

La pubblicazione del modello di interazione corrente è un altro modo in cui l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) fornisce ulteriori informazioni sullo stato del pannello di input rispetto a quello disponibile in una versione precedente.

## <a name="detailed-information-about-input-panels-correction-mode"></a>Informazioni dettagliate sulla modalità di correzione del pannello di input

Aspetto finale del pannello di input che l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) fornisce informazioni dettagliate su e il controllo di è la modalità di correzione. Conoscere la modalità di correzione consente alle applicazioni di determinare le dimensioni correnti del pannello di input. Il controllo del modo in cui la correzione post-inserimento si espande in un'applicazione è un modo per personalizzare l'esperienza di correzione in un'applicazione.

Sono disponibili due modalità di base in cui è possibile visualizzare il pettine di correzione: pre-inserimento e post-inserimento. Il pettine di correzione pre-inserimento viene usato per correggere il testo prima di inserirlo in un'applicazione. Viene attivato toccando il testo in sospeso visualizzato sotto la linea di base nel riquadro di scrittura mentre l'utente inchiostri. Il pettine di correzione post-inserimento viene usato per correggere il testo dopo che è stato inserito in un'applicazione. Viene attivato inserendo il punto di inserimento in o selezionando il testo inserito in precedenza. Oltre le due modalità di base, sono disponibili diverse varianti per la visualizzazione del pettine di correzione post-inserimento. Per prima cosa può essere visualizzato al di sopra o al di sotto del pannello di input e il secondo può comparire compresso o espanso. Nello stato compresso il pettine di correzione post-inserimento Mostra solo un elenco di alternative. Nello stato espanso include sia le alternative sia un'area per riscrivere la parola.

![Pannello di input del pettine di correzione, pre e post-inserimento](images/6cc627de-fc15-4721-9f6a-7e1517d9e650.jpg)

La proprietà [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) consente a un'applicazione di determinare la configurazione corrente del pettine di correzione. I valori possibili di questa proprietà in base a quanto definito dalle enumerazioni [**CorrectionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode) sono: **suo voltonon**, **preinsertation**, **PostInsertionCollapsed** e **PostInsertionExpanded**. Se non è visibile alcun pannello di input o di correzione, **CurrentCorrectionMode** è **suo voltonon**.

Per impostazione predefinita, il sistema Visualizza il pettine di correzione post-inserimento espanso quando il seleziona testo correggibile e lo mostra compresso quando il punto di inserimento viene inserito in un testo correggibile. Un'applicazione può specificare il punto in cui il pettine di correzione post-inserimento deve sempre mostrare espanso impostando la proprietà [**ExpandPostInsertionCorrection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) su **true**. Il valore predefinito di sistema è **false**. Quando la proprietà **ExpandPostInsertionCorrection** viene utilizzata insieme all'interfaccia [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) , uno sviluppatore di applicazioni può aggiungere in modo economico il supporto per la correzione alle applicazioni che non lo otterrebbero automaticamente.

Il rilevamento e il controllo dello stato di correzione del pannello input è una delle numerose nuove funzionalità dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) che rendono possibile un pannello di input più rigoroso e l'integrazione dell'applicazione.

## <a name="event-notification-before-and-after-the-event-occurs"></a>Notifica degli eventi prima e dopo il verificarsi dell'evento

Un altro aspetto della programmabilità del pannello di input notevolmente migliorato nell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il modello di eventi. A questo punto, anziché generare solo gli eventi che segnalano una modifica nello stato del pannello di input dopo che la modifica si è verificata, vengono inviati eventi distinti prima e dopo la modifica. Gli eventi che segnalano l'inizio di un evento contengono verbi di tipo TENS, ad esempio ' Changing ' o ' Inserting ', mentre gli eventi che indicano la conclusione di un evento contengono verbi di tipo "Changed" o "inserted".

Questo modello di eventi consente a un'applicazione di reagire a una modifica prima o quando si verifica. Il pannello di input non è stato in grado di procedere con una modifica o dopo una modifica fino a quando non sono stati completati i gestori eventi per tutti gli eventi. Questi eventi sono sincroni e in questo modo un'applicazione può ritardare una modifica fino a quando non termina la reazione. Tuttavia, il momento in cui un gestore eventi esegue il pannello di input diventa inaccessibile per l'utente e può sembrare bloccato, pertanto è importante che il gestore eventi venga eseguito correttamente. Tuttavia, non è possibile per un'applicazione impedire o annullare un evento. Tutti i parametri di evento sono di sola lettura. Di seguito è riportata una descrizione delle sei coppie di eventi dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) :

-   [**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging)  /  [**InPlaceStateChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged): notifica che lo stato sul posto sta per essere appena passato dal passaggio del mouse a espanso o viceversa. I parametri sono il nuovo e il vecchio stato sul posto. Coincidenza con una modifica nel valore della proprietà [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) .
-   [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged): indica quando la dimensione del pannello di input In-Place sta per essere modificata o è cambiata a causa del ridimensionamento dell'utente, della crescita automatica o di una modifica dell'area di input. I parametri sono il rettangolo di delimitazione nuovo e quello precedente. Coincidenza con una modifica nel valore della proprietà [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) .
-   [**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging)  /  [**InputAreaChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged): segnala quando l'area di input del pannello di input sta per essere modificata o è cambiata da all'altra delle tre aree di input possibili: riempimento, riempimento o tastiera. I parametri sono l'area di input nuova e precedente. Coincide con una modifica nel valore della proprietà [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea)
-   [**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging)  /  [**CorrectionModeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged): notifica che la modalità di correzione sta per essere modificata o è cambiata. Le modalità di correzione possibili sono: non visibile, pre-inserimento, post-inserimento compresso e post-inserimento espanso. I parametri sono la modalità di correzione nuova e precedente. Coincide con una modifica nel valore della proprietà [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) .
-   [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged): indica quando la visibilità del pannello di input In-Place sta per essere modificata o è cambiata. I parametri sono la visibilità nuova e precedente. Una nuova visibilità di **false** significa che il pannello di input In-Place non è aperto, ma non impedisce che il pannello di input sia visibile nella modalità di interazione mobile o ancorata.
-   [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)  /  [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted): indica quando il testo sta per essere inserito o è stato inserito dal pannello di input. Il parametro è una matrice di oggetti [**InkDisp**](inkdisp-class.md) , ognuno dei quali contiene una riga dell'input penna e un testo che compongono l'inserimento. Ulteriori informazioni su questo evento sono presenti nella sezione successiva.

Questi eventi forniscono alle applicazioni informazioni essenziali sulle modifiche nel Pannello input e consentono loro di rispondere di conseguenza. Anche in questo caso, la modifica nel modello di eventi del pannello di input rappresenta un passaggio per una migliore interazione tra le applicazioni e il pannello di input.

## <a name="support-for-collecting-the-ink-and-text-entered-in-input-panel"></a>Supporto per la raccolta dell'input penna e del testo immesso nel pannello di input

Infine, ma non meno, una nuova funzionalità molto potente dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è la possibilità di ottenere l'oggetto Ink per il testo immesso tramite il pannello di input fuori dal pannello di input nel momento in cui il testo viene inserito in un'applicazione. Si tratta di una funzionalità spesso richiesta a scopo di rilevamento delle modifiche e mantenimento dei record. Consente inoltre alle applicazioni di utilizzare l'input penna nell'interfaccia utente come elemento statico o con una superficie di Inking personalizzata.

Per ricevere l'oggetto [**InkDisp**](inkdisp-class.md) per il testo immesso tramite il pannello di input, è necessario registrare un'applicazione per ricevere gli eventi [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) o [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted) generati dall'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) . L'evento **TextInserting** viene generato immediatamente prima dell'inserimento del testo dal pannello di input in un'applicazione e il testo non viene inserito fino al completamento di tutti i gestori eventi. L'evento **TextInserted** viene generato immediatamente dopo l'inserimento del test. L'unico parametro per l'evento **TextInserting** e **TextInserted** è costituito da una matrice di oggetti **InkDisp** che include un oggetto **InkDisp** per ogni riga di testo inserita dal pannello di input. Nota: il pannello di input è inattivo mentre sono in esecuzione i gestori eventi e può sembrare appeso all'utente, pertanto è importante rendere il peso di questi gestori eventi e assicurarsi che vengano eseguiti rapidamente. Inoltre, un'applicazione non deve creare un gestore per questo evento, a meno che non disponga di un utilizzo specifico delle informazioni poiché a tale scopo è associato un costo delle prestazioni. Il pannello di input esegue il marshalling solo dei dati di input penna se è presente un'applicazione che richiede i dati. in caso contrario, il pannello di input può ignorare questa operazione costosa. I parametri di entrambi gli eventi **TextInserting** e **TextInserted** sono di sola lettura, pertanto non è possibile che le applicazioni modifichino il testo inserito prima che venga inserito nell'applicazione.

Le possibilità per le applicazioni che possono essere eseguite con questa nuova funzionalità sono ampie e non possono essere più semplici da usare. Il testo riconosciuto e l'input penna immesso tramite il pannello di input per essere raccolti dalle applicazioni è semplicemente un altro modo in cui la storia degli sviluppatori del pannello di input è stata migliorata in Windows Vista.

## <a name="conclusion"></a>Conclusione

In generale, la storia di programmabilità per il pannello input penna di Tablet PC è stata notevolmente migliorata con l'introduzione dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) in Windows Vista. Utilizzando l'oggetto **TextInputPanel** , gli sviluppatori di applicazioni dispongono di un maggiore controllo e altre informazioni sul pannello input di stato nella versione precedente. Di conseguenza, gli sviluppatori di applicazioni che compilano nuove applicazioni per Tablet PC o che aggiornano le applicazioni esistenti si consiglia vivamente di utilizzare l'oggetto **TextInputPanel** anziché l'oggetto [**PenInputPanel**](peninputpanel-class.md) deprecato. Inoltre, il supporto per nuove funzionalità, ad esempio il posizionamento assoluto del pannello di input e l'icona del pannello di input, e la possibilità per l'applicazione di ricevere sia il testo del riconoscimento che l'input penna immesso tramite il pannello di input abilitano la nuova funzionalità e gli scenari dell'applicazione. L'inclusione di queste funzionalità e altre sono in risposta diretta al feedback degli sviluppatori e contrassegnano i primi passaggi per l'integrazione completa del pannello di input con le applicazioni Tablet PC. Infine, l'espansione della funzionalità dell'applicazione Tablet PC è una grande vittoria sia per gli sviluppatori di applicazioni che per la piattaforma Tablet PC.

 

 



