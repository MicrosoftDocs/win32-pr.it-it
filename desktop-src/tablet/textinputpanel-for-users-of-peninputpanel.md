---
description: La versione di Windows Vista include un nuovo oggetto programmabilità per il Pannello input penna di Tablet PC che offre una nuova gamma di possibilità per l'uso e l'interazione di un'applicazione con il Pannello input penna.
ms.assetid: 539f41d3-5fb8-4e20-99ba-0d5af1f0cc54
title: TextInputPanel per gli utenti di PenInputPanel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fd75fddb929dfd9e0e783aefc0d3f57743d23d5c35f23c845a9745660512f52
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/11/2021
ms.locfileid: "119222176"
---
# <a name="textinputpanel-for-users-of-peninputpanel"></a>TextInputPanel per gli utenti di PenInputPanel

La versione di Windows Vista include un nuovo oggetto programmabilità per il Pannello input penna di Tablet PC che offre una nuova gamma di possibilità per l'uso e l'interazione di un'applicazione con il Pannello input penna. Per la prima volta gli sviluppatori di applicazioni possono posizionare l'icona del pannello di input di In-Place per allinearla a una casella di testo o posizionarla nell'angolo di una superficie di input penna del cliente per offrire l'accesso a una modalità di input alternativa. Gli sviluppatori hanno lo stesso controllo sul posizionamento quando l'icona del pannello di input viene espansa nel pannello In-Place input. In questo modo è possibile garantire che il Pannello input In-Place non si sovrapponga mai agli elementi chiave dell'interfaccia utente nel layout di un'applicazione o persino a ridisposizione dell'interfaccia utente di un'applicazione per fare spazio al Pannello input In-Place e quindi posizionarlo nello spazio riservato. Il nuovo modello di programmabilità include il supporto per più del semplice posizionamento, ma gli sviluppatori possono anche personalizzare l'area di input, la modalità di correzione e molte altre proprietà del Pannello input per personalizzare l'esperienza di immissione del testo in un'applicazione. Infine, per la prima volta è possibile che un'applicazione riceva l'input penna dell'utente, oltre al testo riconosciuto, associato agli inserimenti di testo dal Pannello di input. Ciò consente nuovi scenari di applicazione, tra cui l'input penna nei log di rilevamento delle modifiche e consente agli utenti di modificare o visualizzare l'input penna nell'applicazione. Queste nuove funzionalità di programmabilità sono il risultato diretto dei commenti e suggerimenti ricevuti da Microsoft sulla storia degli sviluppatori del Pannello input penna e rappresentano il primo passo verso una maggiore integrazione delle applicazioni e del Pannello input penna.

Per fornire questo modello di programmabilità del Pannello di input arricchito, il meccanismo esistente per l'interazione a livello di codice con il pannello di input, l'oggetto [**PenInputPanel**](peninputpanel-class.md) viene deprecato e sostituito dal nuovo [**oggetto TextInputPanel.**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) Oltre a fornire nuove funzionalità di programmabilità, **l'oggetto TextInputPanel** fornisce anche quasi tutte le funzionalità a livello di codice dell'oggetto **PenInputPanel.** **L'oggetto TextInputPanel** è incluso in Windows Vista e Windows Software Developer Kit di Vista. **L'oggetto TextInputPanel** è compatibile solo con il pannello di input di Windows Vista e non può essere usato con il Pannello di input di Windows XP Service Pack 2 o versione precedente. L'applicazione scritta in precedenza per usare l'oggetto **PenInputPanel** continuerà a funzionare con il pannello di input di Windows Vista, tuttavia quando si scrivono nuove applicazioni Tablet gli sviluppatori sono fortemente invitati a usare il nuovo oggetto **TextInputPanel** anziché l'oggetto **PenInputPanel deprecato.**

Ognuna delle opzioni di programmabilità [**dell'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) può essere applicata in base al campo di testo. Questa operazione viene eseguita associando un'istanza **dell'oggetto TextInputPanel** usando la [**proprietà AttachedEditWindow.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow) La proprietà deve essere impostata sull'handle della finestra per il campo di testo.

> [!Note]  
> : diverse delle proprietà e dei metodi descritti di seguito si applicano quando il Pannello input penna è in modalità di interazione sul posto e non quando il Pannello input è in modalità di interazione mobile o ancorata. La modalità di interazione sul posto è il comportamento del Pannello input penna in cui l'inserimento dello stato attivo in un campo modificabile determina la visualizzazione dell'icona del pannello di input accanto al campo e il tocco sull'icona del pannello di input fa sì che il Pannello input penna si espandono. I metodi e le proprietà che si applicano solo quando il Pannello input penna è in modalità di interazione sul posto contengono tutti "InPlace" nel nome del metodo o della proprietà.

 

## <a name="control-of-input-panel-icon-and-input-panel-visibility"></a>Controllo dell'icona del pannello di input e della visibilità del pannello di input

Il primo aspetto del Pannello input penna su cui gli sviluppatori di applicazioni hanno maggiore controllo in Windows Vista è la visibilità. Usando [**l'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è possibile controllare la visibilità In-Place pannello di input in tre modi. Con una combinazione di proprietà e metodi un'applicazione può determinare se viene visualizzato il Pannello input In-Place, quando viene visualizzato il Pannello input In-Place e se viene visualizzato per primo come icona del pannello di input o se viene visualizzato immediatamente espanso. Combinando queste tecniche per il controllo della visibilità con le tecniche per il controllo del posizionamento illustrate nella sezione successiva, gli sviluppatori di applicazioni possono creare punti di avvio personalizzati e flussi di lavoro personalizzati usando il pannello di input di In-Place in un'applicazione.

> [!Note]  
> Le proprietà e i metodi descritti in questa sezione si applicano solo quando il Pannello di input è in In-Place modalità di interazione.

 

Prima di tutto, è possibile impedire la visualizzazione del pannello di input In-Place e dell'icona del pannello di input impostando la proprietà [**InPlaceVisibleOnFocus**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) su **false.** Impostandola su **true,** viene ripristinata l'impostazione predefinita del sistema, se possibile, purché non sia stata disabilitata dall'utente o Criteri di gruppo. Questa opzione è utile per le applicazioni che includono soluzioni di immissione di testo personalizzate in alternativa al Pannello input penna.

In secondo luogo, impostando la [**proprietà DefaultInPlaceState,**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) uno sviluppatore può specificare lo stato sul posto, come specificato dall'enumerazione [**InPlaceState,**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) il pannello di input In-Place viene visualizzato in quando lo stato attivo viene posizionato in un campo di testo. L'impostazione predefinita del sistema è che il pannello In-Place input venga visualizzato nello stato al passaggio del mouse, a meno che il Pannello input non sia già visibile nello stato espanso, nel qual caso il Pannello input penna rimane espanso. Se si imposta la proprietà **DefaultInPlaceState** su **InPlaceState \_ Expanded,** il Pannello di input di In-Place viene sempre visualizzato espanso, anziché visualizzare prima l'icona del pannello di input e quindi richiedere all'utente di toccare l'icona del pannello di input prima dell'espansione del Pannello input. Le altre due opzioni sono **InPlaceState \_ Auto**, che è il comportamento predefinito del sistema e **\_ HoverTarget inPlaceState,** che fa sempre sì che venga visualizzata l'icona del pannello di input. La possibilità di specificare che il pannello di input In-Place sempre espanso è una novità dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) e non è possibile usare [**l'oggetto PenInputPanel.**](peninputpanel-class.md) La figura seguente mostra l'icona In-Place pannello input penna e gli stati espansi del pannello.

![Icona del pannello di input sul posto e stati espansi](images/8ce866b6-9a45-499f-a3d1-95a1d34d6402.jpg)

Oltre a poter controllare lo stato sul posto, uno sviluppatore può anche determinare lo stato sul posto in un determinato momento ottenendo la [**proprietà CurrentInPlaceState.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) **CurrentInPlaceState** è uguale a [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) quando il Pannello di input non è visibile, tranne quando **DefaultInPlaceState** è **InPlaceState \_ Auto,** nel qual caso **CurrentInPlaceState** diventa **InPlaceState \_ HoverTarget.** Gli [**eventi InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged) possono essere usati per tenere traccia In-Place stato di visibilità del pannello di input.

Infine, uno sviluppatore può forzare In-Place pannello di input per nascondere o visualizzare usando il [**metodo SetInPlaceVisibility.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) Se lo sviluppatore ha impostato in precedenza la [**proprietà DefaultInPlaceState,**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) il Pannello di input viene visualizzato nello stato specificato quando viene forzato a visualizzare. Un'applicazione può nascondere o visualizzare il pannello di input In-Place solo quando lo stato attivo è attualmente nella finestra a cui è collegato l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) e quando l'utente non ha il Pannello di input aperto in un'altra modalità di interazione, ad esempio ancorata o mobile. La possibilità di forzare In-Place di input per nascondere o mostrare è una novità anche con l'oggetto **TextInputPanel** e non è possibile usare [**l'oggetto PenInputPanel.**](peninputpanel-class.md)

Queste opzioni consentono agli sviluppatori di applicazioni di controllare con granularità fine quando In-Place pannello input e in quale stato. Personalizzando lo stato sul posto predefinito e controllando la visibilità sul posto indipendentemente dalle modifiche dello stato attivo, uno sviluppatore di applicazioni può creare un flusso di lavoro personalizzato quando il Pannello input risponde alle impostazioni dell'applicazione o all'input dell'utente in un'applicazione.

## <a name="absolute-positioning-of-input-panel-icon-and-input-panel"></a>Posizionamento assoluto dell'icona del pannello di input e del pannello di input

La nuova funzionalità più interessante disponibile [**nell'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il posizionamento assoluto del pannello di input In-Place input. Con questa nuova funzionalità, uno sviluppatore di applicazioni può garantire che il pannello di input In-Place non si sovrapponga a uno o più elementi visivi chiave in un layout dell'applicazione. Usando [**l'oggetto PenInputPanel**](peninputpanel-class.md) è stato possibile posizionare il pannello di input In-Place rispetto a un campo di testo in base a un offset, ma il Pannello di input si adattava ancora per rimanere sullo schermo. Per la prima volta in Vista, un'applicazione può posizionare il pannello In-Place input in una posizione assoluta usando le coordinate dello schermo. Inoltre, la responsabilità di mantenere il Pannello input penna sullo schermo viene lasciata allo sviluppatore dell'applicazione, rimuovendo quindi la possibilità che il Pannello input penna si riposiziona automaticamente e apparentemente in modo casuale.

> [!Note]  
> Le proprietà e i metodi descritti in questa sezione si applicano solo quando il Pannello di input è in In-Place modalità di interazione.

 

I due metodi principali necessari per posizionare in modo assoluto il pannello In-Place input sono [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) [**e SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition). Il primo viene usato per specificare la posizione del Pannello input In-Place e il secondo viene usato per specificare la posizione dell'icona del pannello di input per il pannello di input In-Place input. Se un'applicazione sceglie di impostare solo il percorso dell'icona del pannello di input e non il percorso del Pannello input In-Place, il Pannello input In-Place viene visualizzato nella posizione predefinita determinata dal sistema. Analogamente, se un'applicazione riposiziona il pannello In-Place input ma non l'icona del pannello di input, l'icona del pannello di input viene visualizzata nella posizione predefinita. La posizione è specificata nelle coordinate dello schermo. Il punto effettivamente posizionato è l'angolo superiore sinistro dell'icona del pannello di input o del pannello di input senza riquadro di correzione espanso. Quando il pettine di correzione viene espanso, il punto posizionato non cambia. (Vedere la figura 2 di seguito) Non esistono restrizioni sulla posizione in cui possono essere presenti il Pannello di input di In-Place e l'icona del pannello di input di In-Place ed è responsabilità delle applicazioni che chiamano questi metodi per mantenerli sullo schermo. Entrambi i metodi sono sincroni, vale a dire che il posizionamento viene eseguito prima che il metodo venga restituito. Nel caso in cui il Pannello input sia già aperto nella modalità di interazione mobile o ancorata, un tentativo di posizionare il Pannello input In-Place o l'icona del pannello di input In-Place non riesce. Inoltre, i metodi hanno esito negativo se la finestra associata [**all'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) non ha attualmente lo stato attivo.

Una chiamata a [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) o [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) non determina automaticamente la visualizzazione del pannello di input o dell'icona del pannello di input di In-Place, ma imposta semplicemente la posizione per la successiva visualizzazione. La [**chiamata a SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) può essere usata per forzare la visualizzazione immediata.

![misurazioni del pannello di input sul posto](images/0c67a77a-5d2f-489f-9357-b8a168d024d3.jpg)

Quando si posiziona il In-Place di input per calcolare se verrà spento, può essere un po' difficile. Per semplificare questo processo, esistono diverse proprietà [**dell'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) che possono essere usate per semplificare questo processo. Insieme, queste proprietà ed evento possono essere usati per determinare le dimensioni esatte del pannello In-Place input in tutti i relativi stati:

-   [**InPlaceBoundingRectangle:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle)questa proprietà fornisce il rettangolo di delimitazione per il pannello di input In-Place quando viene visualizzata l'area di input più grande per la lingua di input corrente. Se l'area di input più grande è determinata dal pad di scrittura o dal carattere, viene inclusa l'altezza del pulsante Inserisci. Non include l'altezza del pettine di correzione. Quando l'In-Place pannello di input aumenta automaticamente, viene attivato l'evento [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged) e il valore di questa proprietà viene aggiornato per includere l'area di scrittura aggiuntiva o la riga di scrittura.
-   [**PopUpCorrectionHeight:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight)questa proprietà specifica l'altezza del pettine di correzione post-inserimento quando è posizionato sopra il Pannello di input. Per ottenere l'altezza completa del pannello di input In-Place con il riquadro di correzione post-inserimento visualizzato, aggiungere l'altezza di [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) a **PopUpCorrectionHeight**.

Come alternativa più semplice all'impostazione della posizione assoluta del Pannello di input di In-Place e dell'icona del pannello di input, un'applicazione può semplicemente specificare se il pannello di input di In-Place viene visualizzato per impostazione predefinita sopra o sotto un campo di immissione testo. In questo modo è possibile evitare elementi sovrapposti nel layout dell'applicazione in modo più controllato. A tale scopo, l'applicazione imposta [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) **su InPlaceDirection \_ Bottom** o **InPlaceDirection \_ Top.** La proprietà è una preferenza perché il pannello In-Place input sostituisce la preferenza impostata dall'applicazione quando necessario per mantenere il Pannello input sullo schermo. L'impostazione predefinita del sistema è posizionare In-Place pannello input penna sotto un campo di testo quando possibile e in caso contrario posizionarlo sopra. L'impostazione **di PreferredInPlaceDirection** **su InPlaceDirection \_ Auto** ripristina il valore predefinito del sistema.

Insieme le proprietà, i metodi e gli eventi dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) offrono agli sviluppatori il controllo necessario sul pannello di input di In-Place per poter posizionare in modo intelligente il pannello di input di In-Place e l'icona del pannello di input in un layout dell'applicazione in modo che non interrompano il flusso di layout e in alcuni casi possano apparire integrati. Questo nuovo livello di controllo è una grande novità per la progettazione di applicazioni Tablet.

## <a name="access-to-the-three-input-panel-areas-writing-pad-character-pad-and-keyboard"></a>Accesso alle tre aree del pannello di input: riquadro scrittura, riquadro caratteri e tastiera

Il Pannello di input include tre aree di input, il riquadro scrittura, il riquadro caratteri e la tastiera. Usando [**l'oggetto TextInputPanel,**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) un'applicazione può specificare l'area di input predefinita visualizzata all'utente all'apertura del Pannello di input. Il motivo principale per cui un'applicazione può eseguire questa operazione è associare l'area di input al tipo di input di un campo specifico. Ad esempio, il riquadro scrittura è probabilmente più adatto per compilare un campo di commenti, ma la tastiera può risultare più comoda per l'immissione di un numero di serie del prodotto che contiene sia numeri che lettere. Per specificare l'area di input predefinita, un'applicazione imposta la proprietà [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) su una delle tre aree di input definite [**dall'enumerazione PanelInputArea.**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) La figura seguente mostra le tre aree di input.

![scrittura, carattere e pannello di input della tastiera](images/3f1e3d03-88b9-478c-b12d-00d341bc8d5c.jpg)

L'area di input predefinita del sistema è l'area di scrittura per l'inglese, il francese, il tedesco, lo spagnolo, l'italiano, il portoghese, l'olandese e tutte le altre lingue di input latini. Per le lingue di input dell'Asia orientale, inclusi il giapponese, il cinese e il coreano, l'area di input predefinita è il carattere di riempimento. Tuttavia, quando l'utente modifica l'area di input, esegue l'override dell'area di input predefinita per la lingua di input corrente e viene archiviata come nuova impostazione predefinita per tale lingua di input. Tastiera è l'area di input predefinita per i campi password, indipendentemente dalla lingua di input, a meno che la sicurezza delle password non sia stata disabilitata dall'utente o dai criteri di gruppo. In tutti i casi l'impostazione dell'area del pannello di input predefinita a livello di codice esegue l'override dell'impostazione predefinita del sistema, a meno che il campo corrente non sia un campo password o il riconoscimento della grafia per la lingua di input corrente non supporti l'area di input selezionata a livello di codice. [**L'impostazione della proprietà DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) **su InPlaceDirection \_ Auto** ripristina le impostazioni predefinite del sistema.

Indipendentemente dal fatto che l'area del pannello di input predefinita sia stata impostata o meno a livello di codice, l'utente ha la possibilità di modificare l'area corrente del pannello di input dopo l'apertura del Pannello input. Dopo che l'utente ha modificato l'area di input corrente, la selezione dell'utente viene mantenuta fino alla chiusura del Pannello input o alla modifica della selezione da parte dell'utente. Dopo la chiusura e la riapertura del Pannello di input, viene nuovamente visualizzata l'area di input predefinita impostata a livello di codice.

Poiché l'area del pannello di input corrente può essere diversa dall'area del pannello di input predefinita, un'applicazione può eseguire una query sulla proprietà [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) per determinare quale area di input è attualmente visibile. Se il Pannello di input non è attualmente visibile, l'area di input corrente è uguale all'area di input predefinita. La **proprietà CurrentInputArea** non è mai uguale a **PanelInputArea \_ Auto.** Se [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) è uguale a **PanelInputArea \_ Auto,** **CurrentInputArea** è uguale all'ultima area di input visualizzata o all'impostazione predefinita di sistema per la lingua di input corrente se il pannello di input non è mai stato visualizzato.

La differenza principale tra il supporto dell'area di input disponibile nell'oggetto [**PenInputPanel**](peninputpanel-class.md) e quello dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il fatto che l'applicazione ha ora la possibilità di impostare l'area di input predefinita sul riempimento dei caratteri, oltre al blocco di scrittura e alla tastiera.

Usando le proprietà precedenti, un'applicazione può controllare l'area di input del pannello di input visualizzata in campi diversi e ottimizzare l'esperienza di input di testo dell'utente. Inoltre, l'applicazione può mantenere la consapevolezza dell'area di input corrente e prendere decisioni condizionali in base all'area di input più adatta all'attività dell'utente corrente.

## <a name="detailed-information-about-input-panels-interaction-mode"></a>Informazioni dettagliate sulla modalità di interazione del pannello input

Oltre a essere in grado di rilevare l'area di input corrente del pannello di input, è anche possibile rilevare la modalità di interazione corrente: Sul posto, Ancorata o Mobile. Può essere importante per l'applicazione conoscere la modalità di interazione corrente per comprendere in che modo l'utente interagisce con l'applicazione o perché alcuni metodi e proprietà dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) si applicano solo alla modalità di interazione In-Place. Ad esempio, nell'applicazione il riflusso degli elementi dell'interfaccia utente esistenti e quindi posiziona il pannello di input di In-Place su un'area vuota nelle relative interfacce utente deve verificare che la modalità di interazione corrente sia attiva prima di apportare modifiche.

![modalità del pannello di input ancorata, mobile e in-pace](images/98c8e96b-99b2-477a-9843-33b1fae7e75b.jpg)

La [**proprietà CurrentInteractionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode) [**dell'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) archivia la modalità di interazione corrente scelta dall'utente. Le modalità possibili sono definite [**dall'enumerazione InteractionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) come:

**InteractionMode \_ InPlace:** nel pannello di In-Place modalità interazione utente viene visualizzato accanto al campo di immissione testo che attualmente ha lo stato attivo. Per impostazione predefinita, l'In-Place del pannello di input viene visualizzata quando viene inserito un punto di inserimento in un campo di immissione di testo. Se si tocca l'icona del pannello di input, il pannello di input viene espanso. Il In-Place input è visibile solo quando un punto di inserimento si trova in un campo modificabile.

InteractionMode Floating: la modalità di interazione Mobile è simile alla modalità di interazione InPlace, ad eccezione del fatto che non è \_ associata a un punto di inserimento. Il pannello di input mobile viene aperto toccando la scheda Pannello di input visualizzata per impostazione predefinita sul bordo sinistro dello schermo. Sia il pannello di input mobile che la scheda Pannello di input possono essere trascinati e riposizionati dall'utente. Nella modalità mobile il posizionamento e il controllo del pannello di input vengono lasciati interamente all'utente.

InteractionMode DockedTop: nel pannello di input della modalità di interazione Docked-Top viene visualizzato nella parte superiore dello schermo e il desktop attivo viene ridimensionato in modo che il Pannello di input non si sovrapponga ad altre finestre o elementi dell'interfaccia \_ utente. Nella modalità ancorata il Pannello di input non può essere trascinato o spostato.

InteractionMode DockedBottom: la modalità Docked-Bottom interazione utente è la stessa della modalità Docked-Top, ad eccezione del pannello di input visualizzato nella parte \_ inferiore dello schermo.

Quando il pannello di input non è visibile, la modalità di interazione corrente è Sul posto.

La pubblicazione del modello di interazione corrente è un altro modo in cui l'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) fornisce altre informazioni sullo stato del pannello di input rispetto a quanto è stato disponibile in qualsiasi versione precedente.

## <a name="detailed-information-about-input-panels-correction-mode"></a>Informazioni dettagliate sulla modalità di correzione del Pannello input penna

L'aspetto finale del pannello di input su cui [**l'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) fornisce informazioni dettagliate e il controllo è la modalità di correzione. Conoscere la modalità di correzione consente alle applicazioni di determinare le dimensioni correnti del pannello di input. Il controllo della modalità di espansione della correzione post-inserimento in un'applicazione è un modo per personalizzare l'esperienza di correzione in un'applicazione.

Esistono due modalità di base in cui può essere visualizzato il pettine di correzione: pre-inserimento e post-inserimento. Il pettine di correzione pre-inserimento viene usato per correggere il testo prima di inserirlo in un'applicazione. L'attivazione viene attivata toccando il testo in sospeso visualizzato sotto la linea di base nel blocco scrittura come inks dell'utente. Il pettine di correzione post-inserimento viene usato per correggere il testo dopo l'inserimento in un'applicazione. Viene attivato posizionando il punto di inserimento in o selezionando il testo inserito in precedenza. Oltre alle due modalità di base, esistono diverse varianti di come può apparire il pettine di correzione post-inserimento. Prima di tutto può essere visualizzato sopra o sotto il Pannello di input e in secondo luogo può apparire compresso o espanso. Nello stato compresso il pettine di correzione post-inserimento mostra solo un elenco di alternative. Nello stato espanso include le alternative e un'area per riscrivere la parola.

![riquadro di input di correzione, pre e post-inserimento](images/6cc627de-fc15-4721-9f6a-7e1517d9e650.jpg)

La [**proprietà CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) consente a un'applicazione di determinare la configurazione corrente del pettine di correzione. I valori possibili di questa proprietà definiti dalle enumerazioni [**CorrectionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode) sono: **NotVisible**, **PreInsertion**, **PostInsertionCollapsed** e **PostInsertionExpanded**. Quando non è visibile alcun pannello di input o comb di correzione, **CurrentCorrectionMode** è **NotVisible.**

Per impostazione predefinita, il sistema mostra il pettine di correzione post-inserimento espanso quando seleziona il testo correggibile e lo mostra compresso quando il punto di inserimento viene inserito in testo corretto. Un'applicazione può specificare dove deve essere sempre espansa la comb di correzione post-inserimento impostando la [**proprietà ExpandPostInsertionCorrection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) su **true.** Il valore predefinito del sistema **è false.** Quando la **proprietà ExpandPostInsertionCorrection** viene usata in combinazione con l'interfaccia [**IHandWrittenTextInsertion,**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) uno sviluppatore di applicazioni può aggiungere economicamente il supporto per la correzione alle applicazioni che non la ottengono automaticamente.

Il rilevamento e il controllo dello stato di correzione del pannello di input è una delle numerose nuove funzionalità dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) che rendono possibile un'integrazione più stretta del pannello di input e dell'applicazione.

## <a name="event-notification-before-and-after-the-event-occurs"></a>Notifica degli eventi prima e dopo il verificarsi dell'evento

Un altro aspetto della programmabilità del pannello di input notevolmente migliorato [**nell'oggetto TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è il modello di eventi. Ora invece di generare solo eventi che segnalano una modifica nello stato del pannello di input dopo che la modifica si è verificata, vengono inviati eventi separati prima e dopo la modifica. Gli eventi che segnalano l'inizio di un evento contengono verbi di tempo presenti, ad esempio 'Changing' o 'Inserting', mentre gli eventi che segnalano la conclusione di un evento contengono verbi passati, ad esempio 'Changed' o 'Inserted'.

Questo modello di eventi consente a un'applicazione di reagire a una modifica prima o quando si verifica. Il pannello di input non può procedere con una modifica o riprendere dopo la modifica fino al completamento dei gestori eventi per tutti gli eventi. Questi eventi sono sincroni e in questo modo un'applicazione può ritardare una modifica fino al termine della reazione. Tuttavia, il momento in cui un gestore eventi esegue il pannello di input diventa inaccessibile all'utente e può sembrare bloccato, pertanto è importante che il gestore eventi funzioni bene. Tuttavia, un'applicazione non può impedire o annullare un evento. Tutti i parametri dell'evento sono di sola lettura. Di seguito è riportata una descrizione delle sei coppie di eventi dell'oggetto [**TextInputPanel:**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)

-   [**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging)  /  [**InPlaceStateChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged)notifica che lo stato sul posto sta per essere o è appena cambiato dal passaggio del mouse all'espansione o viceversa. I parametri sono lo stato sul posto nuovo e quello precedente. Oggetto con una modifica nel valore della [**proprietà CurrentInPlaceState.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate)
-   [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged)indica quando le dimensioni del pannello di input In-Place sono in via di modifica o sono state modificate a causa di un ridimensionamento dell'utente, una crescita automatica o una modifica dell'area di input. I parametri sono il rettangolo di delimitazione nuovo e quello precedente. Oggetto con una modifica nel valore della [**proprietà InPlaceBoundingRectangle.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle)
-   [**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging)  /  [**InputAreaChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged)segnala quando l'area di input del pannello di input sta per cambiare o è stata modificata da all'altra delle tre possibili aree di input: riquadro di scrittura, riquadro caratteri o tastiera. I parametri sono l'area di input nuova e quella precedente. Coincide con una modifica del valore della [**proprietà CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea)
-   [**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging)  /  [**CorrectionModeChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged)notifica che la modalità di correzione sta per cambiare o è stata modificata. Le modalità di correzione possibili sono: non visibile, pre-inserimento, post-inserimento compresso e post-inserimento espanso. I parametri sono la modalità di correzione nuova e precedente. Coincide con una modifica nel valore della [**proprietà CurrentCorrectionMode.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode)
-   [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged)indica quando la visibilità In-Place pannello input penna sta per cambiare o è stata modificata. I parametri sono la visibilità nuova e precedente. Una nuova visibilità di **false** indica che In-Place di input non è aperto, ma non preclude che il pannello di input sia visibile nella modalità di interazione Mobile o Ancorato.
-   [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)  /  [**TextInserted:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted)indica quando il testo sta per essere inserito o è stato inserito dal Pannello di input. Parameter è una matrice di [**oggetti InkDisp,**](inkdisp-class.md) ognuno dei quali contiene una riga dell'input penna e del testo che costituiscono l'inserimento. Altre informazioni su questo evento nella sezione successiva.

Questi eventi forniscono alle applicazioni informazioni essenziali sulle modifiche nel pannello di input e consentono loro di reagire di conseguenza. Anche in questo caso la modifica nel modello di eventi pannello di input rappresenta un passaggio verso una migliore interazione tra le applicazioni e il pannello di input.

## <a name="support-for-collecting-the-ink-and-text-entered-in-input-panel"></a>Supporto per la raccolta dell'input penna e del testo immesso nel pannello input penna

Infine, ma certamente non meno importante, una nuova funzionalità molto potente dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) è la possibilità di ottenere l'oggetto input penna per il testo immesso tramite il pannello di input dal pannello di input al momento dell'inserimento del testo in un'applicazione. Si tratta di una funzionalità spesso richiesta ai fini del rilevamento delle modifiche e del mantenimento dei record. Consente inoltre alle applicazioni di usare l'input penna nell'interfaccia utente come elemento statico o con una superficie di input penna personalizzata.

Per ricevere l'oggetto [**InkDisp**](inkdisp-class.md) per il testo immesso tramite il pannello di input, un'applicazione deve registrarsi per ricevere gli eventi [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) o [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted) generati dall'oggetto [**TextInputPanel.**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) **L'evento TextInserting** viene generato immediatamente prima che il testo venga inserito dal pannello di input in un'applicazione e il testo non viene inserito fino al completamento di tutti i gestori eventi. **L'evento TextInserted** viene generato immediatamente dopo l'inserimento del test. L'unico parametro per l'evento **TextInserting** e **TextInserted** è una matrice di oggetti **InkDisp** che include un oggetto **InkDisp** per ogni riga di testo inserita dal pannello di input. Nota: il pannello di input è inattivo durante l'esecuzione dei gestori eventi e può sembrare bloccato all'utente, pertanto è importante rendere questi gestori eventi leggeri e assicurarsi che vengano eseguiti rapidamente. Inoltre, un'applicazione non deve creare un gestore per questo evento a meno che non abbia un uso specifico per le informazioni, poiché tale operazione ha un costo in termini di prestazioni. Il pannello di input penna effettua il marshalling dei dati input penna solo se un'applicazione richiede i dati. In caso contrario, il Pannello input penna può ignorare questa operazione disserta. I parametri di entrambi gli eventi **TextInserting** e **TextInserted** sono di sola lettura, pertanto non è possibile per le applicazioni modificare il testo inserito prima che venga inserito nell'applicazione.

Le possibilità per le applicazioni di usare questa nuova funzionalità sono ampie e non possono essere più semplici da usare. Consentire alle applicazioni di raccogliere il testo riconosciuto e l'input penna immesso tramite il pannello di input è un altro modo per migliorare la storia dello sviluppatore del pannello di input in Windows Vista.

## <a name="conclusion"></a>Conclusione

In generale, la storia di programmabilità per il pannello di input di Tablet PC è notevolmente migliorata con l'introduzione dell'oggetto [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) in Windows Vista. Usando **l'oggetto TextInputPanel,** gli sviluppatori di applicazioni hanno un maggiore controllo e altre informazioni sul pannello di input dello stato nella versione precedente. Di conseguenza, gli sviluppatori di applicazioni che compilano nuove applicazioni Per Tablet PC o aggiornano applicazioni esistenti sono fortemente invitati a usare l'oggetto **TextInputPanel** anziché l'oggetto [**PenInputPanel**](peninputpanel-class.md) ora deprecato. Inoltre, il supporto per le nuove funzionalità, ad esempio il posizionamento assoluto del pannello di input e l'icona del pannello di input e la possibilità per l'applicazione di ricevere testo del riconoscitore e input penna immessi tramite il pannello di input penna, abilitano nuove funzionalità e scenari dell'applicazione. L'inclusione di queste funzionalità e di altre funzionalità è in risposta diretta ai commenti e suggerimenti degli sviluppatori e contrassegna i primi passaggi per la completa integrazione del Pannello input penna con le applicazioni Tablet PC. In definitiva, l'espansione della funzionalità dell'applicazione Tablet PC è una grande sfida sia per gli sviluppatori di applicazioni che per la piattaforma Tablet PC.

 

 



