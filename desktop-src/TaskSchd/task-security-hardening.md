---
title: Protezione avanzata delle attività
description: L'uso della funzionalità di protezione avanzata delle attività consentirà ai proprietari delle attività di eseguire le attività con i privilegi minimi necessari.
ms.assetid: ba03add5-aa05-4bef-baec-684ca17363bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ab70679d605a9ad56c6d26116245ae17d41a7a1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104221449"
---
# <a name="task-security-hardening"></a><span data-ttu-id="f2f13-103">Protezione avanzata delle attività</span><span class="sxs-lookup"><span data-stu-id="f2f13-103">Task Security Hardening</span></span>

<span data-ttu-id="f2f13-104">L'uso della funzionalità di protezione avanzata delle attività consentirà ai proprietari delle attività di eseguire le attività con i privilegi minimi necessari.</span><span class="sxs-lookup"><span data-stu-id="f2f13-104">Using the tasks security hardening feature will allow task owners to run their tasks with minimum required privileges.</span></span> <span data-ttu-id="f2f13-105">Si noti che questa funzionalità è abilitata per impostazione predefinita e i proprietari delle attività possono apportare ulteriori modifiche utilizzando il tipo di identificatore di sicurezza del token del processo attività e la matrice dei privilegi necessari per l'attività.</span><span class="sxs-lookup"><span data-stu-id="f2f13-105">Note that this feature is enabled by default and task owners can make further adjustments by using the task process token security identifier type and task required privileges array.</span></span>

## <a name="task-process-token-sid-type-and-task-required-privileges-array"></a><span data-ttu-id="f2f13-106">Tipo di SID del token del processo attività e matrice di privilegi necessari per l'attività</span><span class="sxs-lookup"><span data-stu-id="f2f13-106">Task Process Token SID Type and Task Required Privileges Array</span></span>

<span data-ttu-id="f2f13-107">Se si specifica **ProcessTokenSidType** a livello di definizione di attività, i proprietari delle attività possono richiedere l'esecuzione di un processo di attività con il tipo di SID "None" o con il tipo di SID "senza restrizioni".</span><span class="sxs-lookup"><span data-stu-id="f2f13-107">Specifying **ProcessTokenSidType** at the task definition level allows task owners to request a task process to run with the "none" SID type or the "unrestricted" SID type.</span></span> <span data-ttu-id="f2f13-108">Se il campo è presente nella definizione di attività, la convalida garantisce che l'ID utente dell'attività contenga il nome o la stringa SID corrispondente per uno di questi account di servizio predefiniti del sistema operativo: "servizio di rete" o "servizio locale".</span><span class="sxs-lookup"><span data-stu-id="f2f13-108">If the field is present in task definition, validation ensures that task UserId contains the name or the corresponding SID string for one of those operating system built-in service accounts: "NETWORK SERVICE" or "LOCAL SERVICE".</span></span>

<span data-ttu-id="f2f13-109">Il tipo di SID "None" indica che l'attività viene eseguita in un processo che non contiene un SID del token di processo. non verrà apportata alcuna modifica all'elenco dei gruppi di token di processo.</span><span class="sxs-lookup"><span data-stu-id="f2f13-109">The SID type "none" means that the task runs in a process that does not contain a process token SID (no changes will be made to the process token groups list).</span></span> <span data-ttu-id="f2f13-110">Il SID dell'account dell'entità attività (LocalService/NetworkService) in questo caso ha accesso completo al token di processo.</span><span class="sxs-lookup"><span data-stu-id="f2f13-110">The task principal account SID (LocalService/NetworkService) in that case has full access to the process token.</span></span>

<span data-ttu-id="f2f13-111">Il tipo di SID "senza restrizioni" indica che un SID attività sarà derivato dal percorso completo dell'attività e verrà aggiunto all'elenco dei gruppi di token di processo.</span><span class="sxs-lookup"><span data-stu-id="f2f13-111">The "unrestricted" SID type means that a task SID will be derived from the full task path and will be added to the process token groups list.</span></span> <span data-ttu-id="f2f13-112">Ad esempio, \\ Microsoft \\ Windows \\ RAC \\ RacTask, che viene eseguito nell'account del servizio locale, il SID dell'attività deriva dal nome Microsoft-Windows-RAC-RacTask dove "-" sostituisce " \\ " perché " \\ " è un carattere di nome utente non valido.</span><span class="sxs-lookup"><span data-stu-id="f2f13-112">For example, the \\Microsoft\\Windows\\RAC\\RACTask which runs in the Local Service account, the task SID is derived from the name Microsoft-Windows-RAC-RACTask where a "-" is substituted for a "\\" since "\\" is an invalid user name character.</span></span> <span data-ttu-id="f2f13-113">Il nome del gruppo noto per il SID attività sarà "NT TASK \\ <modified full task path> " (DomainName \\ username Format).</span><span class="sxs-lookup"><span data-stu-id="f2f13-113">The well known group name for the task SID would be "NT TASK\\<modified full task path>" (domainname\\username format).</span></span> <span data-ttu-id="f2f13-114">Verrà modificato anche l'elenco di controllo di accesso discrezionale (DACL) predefinito del token di processo per consentire il controllo completo solo per il SID dell'attività e il SID di sistema locale e il controllo di lettura al SID dell'account dell'entità attività.</span><span class="sxs-lookup"><span data-stu-id="f2f13-114">The process token default discretionary access control list (DACL) will also be modified to allow full control for the task SID and local system SID only and read control to the task principal account SID.</span></span> <span data-ttu-id="f2f13-115">"schtasks.exe/showsid/TN <full task path> " indicherà il SID dell'attività corrispondente all'attività.</span><span class="sxs-lookup"><span data-stu-id="f2f13-115">"schtasks.exe /showsid /tn <full task path>" will show the task SID that is corresponding to the task.</span></span>

<span data-ttu-id="f2f13-116">Quando viene avviata un'azione dell'attività non COM, il motore di pianificazione registra l'account dell'entità attività, ottiene il token di processo ed esegue una query sull'elenco di privilegi di cui dispone il token, quindi lo confronta con l'elenco dei privilegi specificato in RequiredPrivileges.</span><span class="sxs-lookup"><span data-stu-id="f2f13-116">When a non-COM task action starts up, the scheduling engine logs on the task principal account, gets the process token and queries the list of privileges that the token has and then compares that with the privileges list specified in RequiredPrivileges.</span></span> <span data-ttu-id="f2f13-117">Se nel secondo caso non è specificato alcun privilegio, questo viene contrassegnato come privilegio SE \_ \_ rimosso.</span><span class="sxs-lookup"><span data-stu-id="f2f13-117">If a privilege is not specified in the latter, then that is marked as SE\_PRIVILEGE\_REMOVED.</span></span> <span data-ttu-id="f2f13-118">L'azione eseguibile verrà quindi avviata con l'handle del token risultante tramite l'API CreateProcessAsUser ha.</span><span class="sxs-lookup"><span data-stu-id="f2f13-118">The executable action will then be started with the resulting token handle by using the CreateProcessAsUser API.</span></span>

<span data-ttu-id="f2f13-119">Quando viene avviata, un'azione dell'attività COM deve essere attivata dal processo taskhost.exe.</span><span class="sxs-lookup"><span data-stu-id="f2f13-119">When a COM task action starts up, it must be activated by the taskhost.exe process.</span></span> <span data-ttu-id="f2f13-120">Il motore di pianificazione esegue una query sul blocco di contesto di ogni taskhost.exe in esecuzione con lo stesso account dell'attività iniziale.</span><span class="sxs-lookup"><span data-stu-id="f2f13-120">The scheduling engine queries the context block of each running taskhost.exe with the same account as the starting task.</span></span> <span data-ttu-id="f2f13-121">Se viene rilevato che un processo host è stato avviato con un superset dei privilegi necessari per l'attività di avvio, l'attività viene ospitata in tale processo.</span><span class="sxs-lookup"><span data-stu-id="f2f13-121">If it finds that a host process was started with a superset of privileges that the starting task needs, then that task gets hosted in that process.</span></span> <span data-ttu-id="f2f13-122">Se questo processo non viene trovato, combina le informazioni di protezione avanzata di tutte le attività in esecuzione in TaskHost sotto l'account dell'entità attività con la maschera RequiredPrivileges specificata e quindi avvia una nuova istanza di taskhost.exe.</span><span class="sxs-lookup"><span data-stu-id="f2f13-122">If it does not find such a process, it combines the hardening info of all the tasks that are running in the taskhosts under the task principal account with the specified RequiredPrivileges mask and then starts up a new instance of taskhost.exe.</span></span>

<span data-ttu-id="f2f13-123">Se RequiredPrivileges non è presente nella definizione di attività, per il processo attività verranno utilizzati i privilegi predefiniti dell'account dell'entità attività senza SeImpersonatePrivilege.</span><span class="sxs-lookup"><span data-stu-id="f2f13-123">If RequiredPrivileges is not present in the task definition, the default privileges of task principal account without the SeImpersonatePrivilege will be used for task process.</span></span> <span data-ttu-id="f2f13-124">Se **ProcessTokenSidType** non è presente nella definizione di attività, viene usato "Unrestricted" come valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="f2f13-124">If **ProcessTokenSidType** is not present in the task definition, "unrestricted" is used as the default.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f2f13-125">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="f2f13-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f2f13-126">Informazioni di registrazione delle attività</span><span class="sxs-lookup"><span data-stu-id="f2f13-126">Task Registration Information</span></span>](task-registration-information.md)
</dt> <dt>

[<span data-ttu-id="f2f13-127">Informazioni sul Utilità di pianificazione</span><span class="sxs-lookup"><span data-stu-id="f2f13-127">About The Task Scheduler</span></span>](about-the-task-scheduler.md)
</dt> <dt>

[<span data-ttu-id="f2f13-128">Contesti di sicurezza per le attività</span><span class="sxs-lookup"><span data-stu-id="f2f13-128">Security Contexts for Tasks</span></span>](security-contexts-for-running-tasks.md)
</dt> </dl>

 

 




