---
description: I contesti di attivazione sono strutture di dati in memoria contenenti informazioni che il sistema può utilizzare per reindirizzare un'applicazione in modo da caricare una particolare versione della DLL, un'istanza dell'oggetto COM o una versione della finestra personalizzata.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Contesti di attivazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104345331"
---
# <a name="activation-contexts"></a><span data-ttu-id="f94fe-103">Contesti di attivazione</span><span class="sxs-lookup"><span data-stu-id="f94fe-103">Activation Contexts</span></span>

<span data-ttu-id="f94fe-104">I [*contesti di attivazione*](a-sbscs-gly.md) sono strutture di dati in memoria contenenti informazioni che il sistema può utilizzare per reindirizzare un'applicazione in modo da caricare una particolare versione della dll, un'istanza dell'oggetto com o una versione della finestra personalizzata.</span><span class="sxs-lookup"><span data-stu-id="f94fe-104">[*Activation contexts*](a-sbscs-gly.md) are data structures in memory containing information that the system can use to redirect an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="f94fe-105">Una sezione del contesto di attivazione può contenere informazioni di reindirizzamento DLL utilizzate dal caricatore della DLL. un'altra sezione può contenere informazioni sul server COM.</span><span class="sxs-lookup"><span data-stu-id="f94fe-105">One section of the activation context may contain DLL redirection information which is used by the DLL loader; another section may contain COM server information.</span></span> <span data-ttu-id="f94fe-106">Le funzioni del contesto di attivazione utilizzano, creano, attivano e disattivano i contesti di attivazione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-106">The activation context functions use, create, activate, and deactivate activation contexts.</span></span> <span data-ttu-id="f94fe-107">Le funzioni di attivazione possono reindirizzare l'associazione di un'applicazione a oggetti con nome di versione che specificano versioni di DLL specifiche, classi di finestra, server COM, librerie dei tipi e interfacce.</span><span class="sxs-lookup"><span data-stu-id="f94fe-107">The activation functions can redirect the binding of an application to version-named objects that specify particular DLL versions, window classes, COM servers, type libraries, and interfaces.</span></span> <span data-ttu-id="f94fe-108">Per ulteriori informazioni sulle funzioni e sulle strutture del contesto di attivazione, vedere il [riferimento al contesto di attivazione](activation-context-reference.md).</span><span class="sxs-lookup"><span data-stu-id="f94fe-108">For more information about the activation context functions and structures, see the [Activation Context Reference](activation-context-reference.md).</span></span>

<span data-ttu-id="f94fe-109">A partire da Windows XP, le funzioni del contesto di attivazione consentono a Windows di usare le informazioni nei [manifesti](manifests.md) per creare oggetti denominati dalla versione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-109">Beginning with Windows XP, activation context functions enable Windows to use information in [manifests](manifests.md) to create version-named objects.</span></span> <span data-ttu-id="f94fe-110">Se un'applicazione crea un processo chiamando [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows verifica l'esistenza di un [manifesto dell'applicazione](application-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="f94fe-110">If an application creates a process by calling [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows checks for the existence of an [application manifest](application-manifests.md).</span></span> <span data-ttu-id="f94fe-111">Se esiste un manifesto, Windows utilizza le informazioni nel manifesto per popolare il contesto di attivazione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-111">If a manifest exists, Windows uses the information in the manifest to populate the activation context.</span></span> <span data-ttu-id="f94fe-112">Poiché i manifesti descrivono la dipendenza di un'applicazione da versioni di [assembly affiancate](about-side-by-side-assemblies-.md) , gli oggetti specificati senza versioni nel manifesto vengono mappati a oggetti con nome di versione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-112">Because manifests describe an application's dependence on [side-by-side assembly](about-side-by-side-assemblies-.md) versions, objects specified without versions in the manifest are mapped to version-named objects.</span></span> <span data-ttu-id="f94fe-113">È ad esempio possibile che il manifesto descriva le dll, i file, le classi finestra, i server COM, le librerie dei tipi e le interfacce.</span><span class="sxs-lookup"><span data-stu-id="f94fe-113">For example, the manifest may describe DLLs, files, window classes, COM servers, type libraries, and interfaces.</span></span>

<span data-ttu-id="f94fe-114">Quando viene creato un oggetto globale all'interno del contesto di attivazione, il sistema fornisce automaticamente all'oggetto un nome specifico della versione consultando il manifesto.</span><span class="sxs-lookup"><span data-stu-id="f94fe-114">When a global object is created within the activation context, the system automatically gives the object a version-specific name by consulting the manifest.</span></span> <span data-ttu-id="f94fe-115">Quando l'applicazione viene eseguita e richiede un oggetto denominato, ottiene l'oggetto denominato della versione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-115">When the application executes and requests a named object, it gets the version-named object.</span></span> <span data-ttu-id="f94fe-116">In questo modo è possibile eseguire contemporaneamente più versioni di un modulo di codice sul sistema senza interferire tra loro.</span><span class="sxs-lookup"><span data-stu-id="f94fe-116">This enables multiple versions of a code module to run on the system at the same time without interfering with each other.</span></span> <span data-ttu-id="f94fe-117">La shell di [Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) , ad esempio, usa un manifesto per descrivere una dipendenza dalla versione 6,0 di Comctl32 e per creare versioni di classi di finestra.</span><span class="sxs-lookup"><span data-stu-id="f94fe-117">For example, [Windows Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) uses a manifest to describe a dependence on version 6.0 of COMCTL32 and to create versions of window classes.</span></span>

<span data-ttu-id="f94fe-118">Se un'applicazione crea una risorsa chiamando [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), il processo specifica un nome di classe per tale funzione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-118">If an application creates a resource by calling [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), the process specifies a class name to that function.</span></span> <span data-ttu-id="f94fe-119">La chiamata a [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) ottiene il contesto di attivazione corrente e verifica se esiste un mapping per il nome della classe specificato.</span><span class="sxs-lookup"><span data-stu-id="f94fe-119">The call to [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) gets the current activation context and checks to see if a mapping exists for the given class name.</span></span> <span data-ttu-id="f94fe-120">Se esiste un mapping, utilizzerà tale versione del processo chiamante per risolvere il mapping e fornire il nome della classe specifica della versione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-120">If a mapping exists, it will use that version of the calling process to resolve the mapping and provide the version-specific class name.</span></span> <span data-ttu-id="f94fe-121">Windows crea una finestra con la routine della finestra, gli stili e altri attributi associati al nome e alla versione della classe.</span><span class="sxs-lookup"><span data-stu-id="f94fe-121">Windows creates a window with the window procedure, styles, and other attributes associated with that class name and version.</span></span>

<span data-ttu-id="f94fe-122">Il contesto di attivazione è gestito dal sistema nella maggior parte dei casi.</span><span class="sxs-lookup"><span data-stu-id="f94fe-122">The activation context is managed by the system in most cases.</span></span> <span data-ttu-id="f94fe-123">Gli sviluppatori di applicazioni e i provider di assembly non devono in genere effettuare chiamate allo stack.</span><span class="sxs-lookup"><span data-stu-id="f94fe-123">Application developers and assembly providers do not commonly need to make calls to the stack.</span></span> <span data-ttu-id="f94fe-124">Le applicazioni possono gestire un contesto di attivazione chiamando direttamente il contesto di attivazione.</span><span class="sxs-lookup"><span data-stu-id="f94fe-124">Applications can manage an activation context by directly calling the activation context.</span></span> <span data-ttu-id="f94fe-125">Per altre informazioni, vedere [uso dell'API del contesto di attivazione](using-the-activation-context-api.md).</span><span class="sxs-lookup"><span data-stu-id="f94fe-125">For more information, see [Using the Activation Context API](using-the-activation-context-api.md).</span></span>

 

 
