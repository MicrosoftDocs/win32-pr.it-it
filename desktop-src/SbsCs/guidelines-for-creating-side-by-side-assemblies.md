---
description: Le linee guida seguenti illustrano come creare assembly affiancati COM o Win32.
ms.assetid: e10fe92c-bce8-420e-a84c-2748e929eb1b
title: Linee guida per la creazione di assembly affiancati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af8e8fd2bd31a65477b44d3afcf2156d5160a72a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104128830"
---
# <a name="guidelines-for-creating-side-by-side-assemblies"></a><span data-ttu-id="bf708-103">Linee guida per la creazione di assembly affiancati</span><span class="sxs-lookup"><span data-stu-id="bf708-103">Guidelines for Creating Side-by-side Assemblies</span></span>

<span data-ttu-id="bf708-104">Le linee guida seguenti illustrano come creare assembly affiancati COM o Win32.</span><span class="sxs-lookup"><span data-stu-id="bf708-104">The following guidelines discuss how to author your own COM or Win32 side-by-side assemblies.</span></span> <span data-ttu-id="bf708-105">Se la funzionalità necessaria è fornita da uno degli assembly affiancati di [Microsoft supportati](supported-microsoft-side-by-side-assemblies.md), potrebbe non essere necessario creare assembly side-by-side.</span><span class="sxs-lookup"><span data-stu-id="bf708-105">You may not need to create your own side-by-side assemblies if the functionality needed is provided by one of the [supported Microsoft side-by-side assemblies](supported-microsoft-side-by-side-assemblies.md).</span></span> <span data-ttu-id="bf708-106">In questo caso, utilizzare gli assembly forniti da Microsoft e seguire le procedure per l'utilizzo di assembly affiancati in [utilizzando applicazioni isolate e assembly affiancati](using-isolated-applications-and-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="bf708-106">In this case, use the assemblies provided by Microsoft and follow the procedures for using side-by-side assemblies in [Using Isolated Applications and Side-by-side Assemblies](using-isolated-applications-and-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="bf708-107">Per prima cosa, valutare se il componente rende un candidato adatto per un assembly affiancato.</span><span class="sxs-lookup"><span data-stu-id="bf708-107">First, consider whether your component makes a suitable candidate for a side-by-side assembly.</span></span> <span data-ttu-id="bf708-108">Per ulteriori informazioni, vedere [se si desidera fornire un componente condiviso come assembly side-by-side.](should-you-provide-a-shared-component-as-a-side-by-side-assembly.md)</span><span class="sxs-lookup"><span data-stu-id="bf708-108">For more information, see [Should you provide a shared component as a side-by-side assembly?](should-you-provide-a-shared-component-as-a-side-by-side-assembly.md)</span></span>

<span data-ttu-id="bf708-109">Per creare un assembly affiancato, attenersi alle seguenti linee guida:</span><span class="sxs-lookup"><span data-stu-id="bf708-109">To create a side-by-side assembly, follow these guidelines:</span></span>

-   <span data-ttu-id="bf708-110">Decidere quali risorse includere nell'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-110">Decide which resources to include in the assembly.</span></span> <span data-ttu-id="bf708-111">Tenere presente che un assembly è costituito da uno o più file che vengono sempre forniti insieme alle applicazioni e ai clienti.</span><span class="sxs-lookup"><span data-stu-id="bf708-111">Keep in mind that an assembly consists of one or more files that are always provided to applications and customers together.</span></span> <span data-ttu-id="bf708-112">L'assembly funge da unità di base utilizzata per la denominazione, l'associazione, il controllo delle versioni, la distribuzione e la [configurazione predefinita](default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="bf708-112">The assembly serves as the fundamental unit used for naming, binding, versioning, deployment, and [default configuration](default-configuration.md).</span></span> <span data-ttu-id="bf708-113">Come regola generale, quando si è certi che due risorse appartengano nello stesso assembly, è consigliabile crearle per passare a assembly distinti.</span><span class="sxs-lookup"><span data-stu-id="bf708-113">As a general rule, when uncertain about whether two resources belong in the same assembly, it is recommended that they be authored to go into separate assemblies.</span></span> <span data-ttu-id="bf708-114">In genere, un assembly affiancato è costituito da una singola DLL.</span><span class="sxs-lookup"><span data-stu-id="bf708-114">Typically, a side-by-side assembly consists of a single DLL.</span></span>
-   <span data-ttu-id="bf708-115">Creazione di un [manifesto](manifests.md) dell'assembly per l'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-115">Create an assembly [manifest](manifests.md) for the assembly.</span></span> <span data-ttu-id="bf708-116">Il manifesto deve descrivere l'oggetto COM o le librerie dei tipi nell'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-116">The manifest should describe the COM object or type libraries in the assembly.</span></span> <span data-ttu-id="bf708-117">Per ulteriori informazioni su ciò che deve essere creato in un manifesto dell'assembly, vedere [manifesti dell'assembly](assembly-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="bf708-117">For more information about what should be authored into an assembly manifest, see [assembly manifests](assembly-manifests.md).</span></span>
-   <span data-ttu-id="bf708-118">Valutare l'utilizzo di oggetti quando nel sistema viene eseguita più di una versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-118">Evaluate the usage of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="bf708-119">Determinare se versioni diverse dell'assembly richiedono strutture di dati separate, ad esempio file mappati alla memoria, named pipe, messaggi e classi di Windows registrate, memoria condivisa, semafori, mutex e driver hardware.</span><span class="sxs-lookup"><span data-stu-id="bf708-119">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="bf708-120">Tutte le strutture di dati utilizzate nelle versioni degli assembly devono essere versioni compatibili con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="bf708-120">Any data structures used across assembly versions must be backward-compatible versions.</span></span> <span data-ttu-id="bf708-121">Decidere quali strutture di dati possono essere usate tra le versioni e quali strutture di dati devono essere private di una versione.</span><span class="sxs-lookup"><span data-stu-id="bf708-121">Decide which data structures can be used across versions and which data structures must be private to a version.</span></span> <span data-ttu-id="bf708-122">Determinare se le strutture di dati condivise richiedono oggetti di sincronizzazione distinti, ad esempio semafori e mutex.</span><span class="sxs-lookup"><span data-stu-id="bf708-122">Determine whether shared data structures require separate synchronization objects such as semaphores and mutexes.</span></span>
-   <span data-ttu-id="bf708-123">Creare la DLL per lavorare correttamente come assembly affiancato rispettando le linee guida per la [creazione di una dll per un assembly affiancato](authoring-a-dll-for-a-side-by-side-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="bf708-123">Author your DLL to work well as a side-by-side assembly by adhering to the guidelines in [Authoring a DLL for a Side-by-Side Assembly](authoring-a-dll-for-a-side-by-side-assembly.md).</span></span>
-   <span data-ttu-id="bf708-124">Creazione di un set di file di intestazione e funzioni helper per fornire un modo semplice per la versione delle chiavi del registro di sistema contenenti lo stato dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-124">Author a set of header files and helper functions to provide an easy way to version registry keys containing the assembly state.</span></span> <span data-ttu-id="bf708-125">Gli assembly salvano in genere le impostazioni dello stato nelle chiavi del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="bf708-125">Assemblies commonly save their state settings in registry keys.</span></span> <span data-ttu-id="bf708-126">Le impostazioni del registro di sistema devono essere scritte in base a una singola versione per isolare più versioni di assembly che possono essere eseguite contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="bf708-126">Registry settings must be written on an individual version basis to isolate multiple assembly versions that may be run at the same time.</span></span> <span data-ttu-id="bf708-127">Progettare l'assembly affiancato e la DLL per archiviare e gestire correttamente lo stato dell'assembly durante gli scenari di condivisione side-by-side.</span><span class="sxs-lookup"><span data-stu-id="bf708-127">Design your side-by-side assembly and DLL to correctly store and handle the state of the assembly during side-by-side sharing scenarios.</span></span> <span data-ttu-id="bf708-128">Seguire le linee guida [per la creazione dell'archiviazione dello stato per gli assembly affiancati](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="bf708-128">Follow the guidelines in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>
-   <span data-ttu-id="bf708-129">Gli sviluppatori di applicazioni che utilizzano [assembly privati](/windows/desktop/Msi/private-assemblies) devono proteggere la directory dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bf708-129">Developers of applications that use [private assemblies](/windows/desktop/Msi/private-assemblies) should secure the application directory.</span></span> <span data-ttu-id="bf708-130">Se l'applicazione viene installata usando il [Windows Installer](../msi/windows-installer-portal.md), la directory dell'applicazione può essere protetta tramite la tabella LockPermissions.</span><span class="sxs-lookup"><span data-stu-id="bf708-130">If the application is installed using the [Windows Installer](../msi/windows-installer-portal.md), then the application directory can be secured by using the LockPermissions table.</span></span> <span data-ttu-id="bf708-131">In genere, al sistema viene assegnato l'accesso in lettura, scrittura ed esecuzione agli assembly privati. a tutti gli altri processi viene assegnato solo l'accesso in lettura e esecuzione.</span><span class="sxs-lookup"><span data-stu-id="bf708-131">Typically, the system is given read, write, and execute access to private assemblies; all other processes are given only execute and read access.</span></span>
-   <span data-ttu-id="bf708-132">Testare l'assembly usando gli scenari con la condivisione side-by-side per assicurarsi che sia un assembly side-by-side valido.</span><span class="sxs-lookup"><span data-stu-id="bf708-132">Test the assembly using scenarios with side-by-side sharing to ensure that it is a valid side-by-side assembly.</span></span> <span data-ttu-id="bf708-133">La corretta installazione dell'assembly non è sufficiente per garantire che funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="bf708-133">Successful installation of the assembly is not sufficient to guarantee that it will work as expected.</span></span>
-   <span data-ttu-id="bf708-134">Adottare un metodo per la numerazione degli aggiornamenti per l'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-134">Adopt a method for numbering updates for your assembly.</span></span> <span data-ttu-id="bf708-135">Ogni assembly è associato a un numero di versione in quattro parti.</span><span class="sxs-lookup"><span data-stu-id="bf708-135">Each assembly is associated with a four-part version number.</span></span> <span data-ttu-id="bf708-136">Da sinistra a destra, le parti principale, secondaria, di build e di revisione sono separate da punti.</span><span class="sxs-lookup"><span data-stu-id="bf708-136">Left-to-right, the major, minor, build, and revision parts are separated by periods.</span></span> <span data-ttu-id="bf708-137">Modificare il numero principale o secondario di un assembly per una versione incompatibile con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="bf708-137">Change the major or minor number of an assembly for a version that is incompatible with earlier versions.</span></span> <span data-ttu-id="bf708-138">Modificare solo le parti di compilazione e revisione per le modifiche compatibili con le versioni precedenti nell'assembly.</span><span class="sxs-lookup"><span data-stu-id="bf708-138">Change only the build and revision parts for backward-compatible changes to the assembly.</span></span> <span data-ttu-id="bf708-139">Uno sviluppatore può ad esempio adottare un metodo di numerazione in cui tutte le 1.0.0. \* i numeri di versione si riferiscono alle versioni di aggiornamento per l'assembly versione 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="bf708-139">For example, a developer might adopt a numbering method in which all 1.0.0.\* version numbers refer to update versions to assembly version 1.0.0.0.</span></span>

 

 
