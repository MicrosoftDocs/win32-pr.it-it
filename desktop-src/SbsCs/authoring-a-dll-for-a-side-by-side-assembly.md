---
description: Quando si creano assembly affiancati, seguire le linee guida per la creazione di assembly affiancati.
ms.assetid: e5fc3bae-0646-4418-a8f7-369856f03cd5
title: Creazione di dll per assembly affiancati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa15f3876c60ce55be00d60d8f417eb0c2cbf6ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104232051"
---
# <a name="authoring-dlls-for-side-by-side-assemblies"></a><span data-ttu-id="d1943-103">Creazione di dll per assembly affiancati</span><span class="sxs-lookup"><span data-stu-id="d1943-103">Authoring DLLs for Side-by-side Assemblies</span></span>

<span data-ttu-id="d1943-104">Quando si creano assembly affiancati, seguire le [linee guida per la creazione di assembly affiancati](guidelines-for-creating-side-by-side-assemblies.md) e creare eventuali dll usate nell'assembly in base alle linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="d1943-104">When creating your own side-by-side assemblies, follow the [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md) and author any DLLs used in the assembly according to the following guidelines:</span></span>

-   <span data-ttu-id="d1943-105">Le dll devono essere progettate in modo da consentire l'esecuzione di più versioni contemporaneamente e nello stesso processo senza interferire tra loro.</span><span class="sxs-lookup"><span data-stu-id="d1943-105">Your DLLs should be designed so that multiple versions can run at the same time and in the same process without interfering with each other.</span></span> <span data-ttu-id="d1943-106">Molte applicazioni, ad esempio, ospitano più plug-in, ognuno dei quali richiede una versione diversa di un componente.</span><span class="sxs-lookup"><span data-stu-id="d1943-106">For example, many applications host multiple plug-ins that each require a different version of one component.</span></span> <span data-ttu-id="d1943-107">Lo sviluppatore deve progettare e testare l'assembly affiancato per assicurarsi che più versioni del componente funzionino correttamente quando vengono eseguite contemporaneamente nello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="d1943-107">The developer the side-by-side assembly needs to design and test to ensure that multiple versions of the component work correctly when run at the same time in the same process.</span></span>

-   <span data-ttu-id="d1943-108">Se si prevede di fornire il componente come componente condiviso nei sistemi precedenti a Windows XP, è necessario continuare a installare il componente in questi sistemi come componente condiviso a istanza singola.</span><span class="sxs-lookup"><span data-stu-id="d1943-108">If you plan to provide your component as a shared component on systems earlier than Windows XP, you need to continue to install the component on these systems as a single-instance shared component.</span></span> <span data-ttu-id="d1943-109">In questo caso, è necessario assicurarsi che il componente sia compatibile con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="d1943-109">In this case, you need to ensure your component is backward compatible.</span></span>

-   <span data-ttu-id="d1943-110">Valutare l'uso di oggetti quando più di una versione dell'assembly viene eseguita nel sistema.</span><span class="sxs-lookup"><span data-stu-id="d1943-110">Evaluate the use of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="d1943-111">Determinare se versioni diverse dell'assembly richiedono strutture di dati separate, ad esempio file mappati alla memoria, named pipe, messaggi e classi di Windows registrate, memoria condivisa, semafori, mutex e driver hardware.</span><span class="sxs-lookup"><span data-stu-id="d1943-111">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="d1943-112">Tutte le strutture di dati utilizzate nelle versioni degli assembly devono essere compatibili con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="d1943-112">Any data structures used across assembly versions must be backward-compatible.</span></span> <span data-ttu-id="d1943-113">Decidere quali strutture di dati possono essere usate tra le versioni e quali strutture di dati devono essere private di una versione.</span><span class="sxs-lookup"><span data-stu-id="d1943-113">Decide which data structures can be used across versions, and which data structures must be private to a version.</span></span> <span data-ttu-id="d1943-114">Determinare se le strutture di dati condivise richiedono oggetti di sincronizzazione distinti, ad esempio semafori e mutex.</span><span class="sxs-lookup"><span data-stu-id="d1943-114">Determine whether shared data structures require separate synchronization objects, such as semaphores and mutexes.</span></span>

-   <span data-ttu-id="d1943-115">Alcuni oggetti, come le classi e gli atomi della finestra, sono denominati in modo univoco per ogni processo.</span><span class="sxs-lookup"><span data-stu-id="d1943-115">Some objects, such as window classes and Atoms, are uniquely named for each process.</span></span> <span data-ttu-id="d1943-116">Per ogni assembly che utilizza il manifesto è necessario che siano presenti oggetti quali le classi finestra.</span><span class="sxs-lookup"><span data-stu-id="d1943-116">Objects such as window classes should be versioned for each assembly using the manifest.</span></span> <span data-ttu-id="d1943-117">Per gli oggetti, ad esempio gli atomi, usare gli identificatori specifici della versione, a meno che non si preveda di condividere diverse versioni.</span><span class="sxs-lookup"><span data-stu-id="d1943-117">For objects such as Atoms, use version-specific identifiers unless you plan to share across versions.</span></span> <span data-ttu-id="d1943-118">Se si usano identificatori specifici della versione, usare il numero di versione in quattro parti.</span><span class="sxs-lookup"><span data-stu-id="d1943-118">If you use version-specific identifiers, use the four-part versioning number.</span></span>

-   <span data-ttu-id="d1943-119">Non includere codice di registrazione automatica in qualsiasi DLL.</span><span class="sxs-lookup"><span data-stu-id="d1943-119">Include no self-registering code in any DLL.</span></span> <span data-ttu-id="d1943-120">Una DLL in un assembly side-by-side non può eseguire la registrazione automatica.</span><span class="sxs-lookup"><span data-stu-id="d1943-120">A DLL in a side-by-side assembly cannot be self-registering.</span></span>

-   <span data-ttu-id="d1943-121">Definire tutti i nomi specifici della versione nella DLL con le \# istruzioni define.</span><span class="sxs-lookup"><span data-stu-id="d1943-121">Define all version-specific names in your DLL with \#define statements.</span></span> <span data-ttu-id="d1943-122">In questo modo è possibile modificare tutte le chiavi del registro di sistema da una posizione.</span><span class="sxs-lookup"><span data-stu-id="d1943-122">This enables all registry keys to be changed from one location.</span></span> <span data-ttu-id="d1943-123">Quando si rilascia una nuova versione dell'assembly, è sufficiente modificare questa \# istruzione define.</span><span class="sxs-lookup"><span data-stu-id="d1943-123">When you release a new version of your assembly, you only need to change this \#define statement.</span></span> <span data-ttu-id="d1943-124">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="d1943-124">For example:</span></span>

    `#define MyRegistryKey "MyAssembly1.0.0.0"`

-   <span data-ttu-id="d1943-125">Archiviare i dati non permanenti nella directory Temp.</span><span class="sxs-lookup"><span data-stu-id="d1943-125">Store any nonpersistent data in the Temp directory.</span></span>

-   <span data-ttu-id="d1943-126">Non inserire i dati utente in percorsi globali.</span><span class="sxs-lookup"><span data-stu-id="d1943-126">Do not put user data into global locations.</span></span> <span data-ttu-id="d1943-127">Mantieni i dati dell'applicazione separati dai dati utente.</span><span class="sxs-lookup"><span data-stu-id="d1943-127">Keep application data separate from user data.</span></span>

-   <span data-ttu-id="d1943-128">Assegnare a tutti i file condivisi una versione del file che dipende dal nome dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d1943-128">Assign all shared files a file version that depends upon the application's name.</span></span>

-   <span data-ttu-id="d1943-129">Assegnare tutti i messaggi e le strutture di dati usati nei processi di una versione per impedire la condivisione involontaria tra processi.</span><span class="sxs-lookup"><span data-stu-id="d1943-129">Assign all messages and data structures used across processes a version to prevent unintentional cross-process sharing.</span></span>

-   <span data-ttu-id="d1943-130">La DLL non deve dipendere dalla condivisione tra versioni che potrebbero non esistere, ad esempio sezioni di memoria condivisa non condivise tra versioni diverse dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="d1943-130">Your DLL should not depend upon sharing across versions that may not exist, such as shared memory sections that are not shared across different versions of your assembly.</span></span>

-   <span data-ttu-id="d1943-131">Se si aggiungono nuove funzionalità che non seguono il contratto di compatibilità dell'interfaccia binaria della DLL originale, è necessario assegnare un nuovo nome CLSID, ProgId e file.</span><span class="sxs-lookup"><span data-stu-id="d1943-131">If you add new functionality that does not follow the binary interface compatibility contract of the original DLL, you must assign a new CLSID, ProgId, and file name.</span></span> <span data-ttu-id="d1943-132">Le versioni future dell'assembly affiancato sono quindi necessarie per usare il CLSID, il ProgId e il nome del file.</span><span class="sxs-lookup"><span data-stu-id="d1943-132">Future versions of your side-by-side assembly is then required to use this CLSID, ProgId, and file name.</span></span> <span data-ttu-id="d1943-133">In questo modo si evita un conflitto quando una versione della DLL non affiancata viene registrata su una versione affiancata.</span><span class="sxs-lookup"><span data-stu-id="d1943-133">This prevents a conflict when a version of the DLL that is not side-by-side is registered over a side-by-side version.</span></span>

-   <span data-ttu-id="d1943-134">Se si riutilizza lo stesso CLSID o ProgId, testare per verificare che l'assembly sia compatibile con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="d1943-134">If you reuse the same CLSID or ProgId, test to ensure that the assembly is backward compatible.</span></span>

-   <span data-ttu-id="d1943-135">Inizializzare e impostare le impostazioni predefinite per l'assembly nel codice dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="d1943-135">Initialize and set the default settings for the assembly in the assembly code.</span></span> <span data-ttu-id="d1943-136">Non salvare le impostazioni predefinite nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="d1943-136">Do not save the defaults settings in the registry.</span></span>

-   <span data-ttu-id="d1943-137">Assegnare le versioni a tutte le strutture di dati.</span><span class="sxs-lookup"><span data-stu-id="d1943-137">Assign versions to all data structures.</span></span>

-   <span data-ttu-id="d1943-138">La DLL deve archiviare lo stato dell'assembly affiancato come descritto in [creazione dell'archiviazione dello stato per gli assembly affiancati](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="d1943-138">Your DLL should store the state of the side-by-side assembly as described in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>

 

 



