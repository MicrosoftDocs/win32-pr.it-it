---
description: I contesti di attivazione sono visibili nell'intero processo.
ms.assetid: 6eda00d5-9dac-4267-bf61-b481814201f8
title: Thread, procedure asincrone e messaggi della finestra
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e615eb9795ba32bcf4bd227a4933e890e9b89055
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103878973"
---
# <a name="using-threads-asynchronous-procedures-and-window-messages"></a><span data-ttu-id="693a6-103">Utilizzo di thread, procedure asincrone e messaggi della finestra</span><span class="sxs-lookup"><span data-stu-id="693a6-103">Using Threads, Asynchronous Procedures, and Window Messages</span></span>

<span data-ttu-id="693a6-104">I contesti di attivazione sono visibili nell'intero processo.</span><span class="sxs-lookup"><span data-stu-id="693a6-104">Activation contexts are visible throughout the entire process.</span></span> <span data-ttu-id="693a6-105">Gli stack del contesto di attivazione sono tuttavia per thread e due thread nello stesso processo possono avere stack di attivazione diversi.</span><span class="sxs-lookup"><span data-stu-id="693a6-105">The activation context stacks are however per-thread, and two threads in the same process can have different activation stacks.</span></span> <span data-ttu-id="693a6-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) inserisce automaticamente il contesto di attivazione corrente all'inizio dello stack di attivazione del nuovo thread.</span><span class="sxs-lookup"><span data-stu-id="693a6-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) automatically puts the current activation context at the top of the new thread's activation stack.</span></span> <span data-ttu-id="693a6-107">Questo può facilitare l'aggiornamento del codice esistente per l'uso di componenti affiancati perché il nuovo thread può essere eseguito immediatamente nel contesto di attivazione corrente.</span><span class="sxs-lookup"><span data-stu-id="693a6-107">This can facilitate upgrading existing code to use side-by-side components because the new thread can run immediately in the current activation context.</span></span>

<span data-ttu-id="693a6-108">Le chiamate di procedure asincrone, i callback della porta di completamento e qualsiasi altro callback su altri thread ottengono automaticamente il contesto di attivazione dell'origine.</span><span class="sxs-lookup"><span data-stu-id="693a6-108">Asynchronous procedure calls, completion port callbacks, and any other callbacks on other threads automatically get the activation context of the source.</span></span> <span data-ttu-id="693a6-109">Quando viene chiamato il callback, lo stack di attivazione viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="693a6-109">When the callback is called, the activation stack is cleaned up.</span></span> <span data-ttu-id="693a6-110">Ciò significa che l'applicazione può utilizzare chiamate di procedure asincrone e callback senza attivare in modo esplicito i contesti perché la gestione del contesto verrà eseguita dall'infrastruttura side-by-side sottostante.</span><span class="sxs-lookup"><span data-stu-id="693a6-110">This means that your application can use asynchronous procedure calls and callbacks without explicitly activating any contexts because context management will be done by the underlying side-by-side infrastructure.</span></span> <span data-ttu-id="693a6-111">Per rendere attivi altri contesti durante un callback o un nuovo thread, l'applicazione può eseguire la propria gestione del contesto.</span><span class="sxs-lookup"><span data-stu-id="693a6-111">To make other contexts active during a callback or new thread, your application can do its own context management.</span></span> <span data-ttu-id="693a6-112">In questo caso il programma deve usare la sequenza appropriata di funzioni attive del contesto di attivazione e disattivare le funzioni.</span><span class="sxs-lookup"><span data-stu-id="693a6-112">In this case your program must use the proper sequence of activation context activate functions and deactivate functions.</span></span>

<span data-ttu-id="693a6-113">I contesti di attivazione sono indipendenti dal thread.</span><span class="sxs-lookup"><span data-stu-id="693a6-113">Activation contexts are thread-neutral.</span></span> <span data-ttu-id="693a6-114">L'attivazione di un contesto cambia solo lo stack del thread corrente e non è possibile attivare un contesto tra i thread.</span><span class="sxs-lookup"><span data-stu-id="693a6-114">Activating a context only changes the current thread's stack, and you cannot activate a context across threads.</span></span> <span data-ttu-id="693a6-115">Il thread A non può forzare un contesto sul thread B. Anche le funzioni dell'API del contesto di attivazione sono compatibili con il Threading.</span><span class="sxs-lookup"><span data-stu-id="693a6-115">Thread A cannot force a context onto thread B. The functions of the activation context API are also threading-aware.</span></span>

<span data-ttu-id="693a6-116">Quando si utilizza [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) o [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) per inviare un messaggio della finestra a un'altra routine della finestra nel processo, il contesto di attivazione corrente viene attivato prima che il messaggio venga passato alla procedura di destinazione.</span><span class="sxs-lookup"><span data-stu-id="693a6-116">When you use [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) or [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) to send a window message to another window procedure in your process, the current activation context is activated before the message is passed on to the target procedure.</span></span> <span data-ttu-id="693a6-117">Il contesto di attivazione corrente viene inserito insieme al messaggio.</span><span class="sxs-lookup"><span data-stu-id="693a6-117">The current activation context goes along with the message.</span></span> <span data-ttu-id="693a6-118">In questo modo si garantisce che i messaggi che fanno riferimento a oggetti COM, nomi DLL o altre risorse affiancate mantengano le informazioni di contesto corrette.</span><span class="sxs-lookup"><span data-stu-id="693a6-118">This ensures that messages that refer to COM objects, DLL names, or other side-by-side resources retain their correct context information.</span></span>

 

 
