---
description: Il reindirizzamento DLL/COM è una strategia di isolamento delle applicazioni utilizzata dagli amministratori aziendali in Windows XP.
ms.assetid: 5bbb0bee-d457-4dfa-93a0-82537fe11f2d
title: Reindirizzamento DLL/COM in Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e356c7b4cc6e5616a03eba60439c7478d65e626a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103883913"
---
# <a name="dllcom-redirection-on-windows"></a><span data-ttu-id="8e2a0-103">Reindirizzamento DLL/COM in Windows</span><span class="sxs-lookup"><span data-stu-id="8e2a0-103">DLL/COM Redirection on Windows</span></span>

<span data-ttu-id="8e2a0-104">Il reindirizzamento DLL/COM è una strategia di isolamento delle applicazioni utilizzata dagli amministratori aziendali in Windows XP.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-104">DLL/COM redirection is an application isolation strategy employed by corporate administrators on Windows XP.</span></span>

<span data-ttu-id="8e2a0-105">\* \* Windows Server 2008, Windows Vista, Windows Server 2003 e Windows XP con SP2: \* \* l'uso di strategie di reindirizzamento DLL/COM non è consigliato perché le applicazioni isolate che usano manifesti e [assembly affiancati](about-side-by-side-assemblies-.md) possono essere più facili da aggiornare e servire.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-105">\*\*Windows Server 2008, Windows Vista, Windows Server 2003 and Windows XP with SP2:  \*\* The use of DLL/COM redirection strategies is not recommended because isolated applications that use manifests and [side-by-side assemblies](about-side-by-side-assemblies-.md) can be easier to update and service.</span></span> <span data-ttu-id="8e2a0-106">La presenza di un file. local viene ignorata se è presente un manifesto.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-106">The presence of a .local file is ignored if a manifest is present.</span></span> <span data-ttu-id="8e2a0-107">La strategia di reindirizzamento DLL/COM con i file. local funziona se l'applicazione non dispone di un manifesto.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-107">The DLL/COM Redirection strategy using .local files works if the application does not have a manifest.</span></span>

<span data-ttu-id="8e2a0-108">Il reindirizzamento DLL/COM associa un'applicazione a una versione locale di un componente.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-108">DLL/COM redirection binds an application to a local version of a component.</span></span> <span data-ttu-id="8e2a0-109">I file del componente locale possono essere mantenuti separati dalla versione del sistema del componente in un percorso privato per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-109">The local component's files can be kept separate from the system's version of the component in a location that is private to the application.</span></span> <span data-ttu-id="8e2a0-110">La versione del sistema del componente è registrata a livello globale e disponibile per tutte le altre applicazioni che vi associano.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-110">The system's version of the component is globally registered and available to any other applications that bind to it.</span></span> <span data-ttu-id="8e2a0-111">La versione locale del componente è riservata all'utilizzo esclusivo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-111">The local version of the component is reserved for the exclusive use of the application.</span></span> <span data-ttu-id="8e2a0-112">Se necessario, i file componente utilizzati dall'applicazione possono essere caricati in memoria contemporaneamente ai file componente del sistema.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-112">If necessary, the component files used by the application can be loaded into memory at the same time as the system's component files.</span></span>

<span data-ttu-id="8e2a0-113">Il reindirizzamento DLL/COM viene attivato installando un file speciale insieme a una copia del file del componente locale nella stessa directory del file eseguibile dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-113">DLL/COM redirection is activated by installing a special file along with a copy of the local component file into the same directory as the application's executable file.</span></span> <span data-ttu-id="8e2a0-114">Il file speciale è un file vuoto denominato dopo il nome file dell'eseguibile dell'applicazione e aggiunto con. local.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-114">The special file is an empty file named after the application executable's file name and appended with .local.</span></span> <span data-ttu-id="8e2a0-115">Ad esempio, per attivare il reindirizzamento DLL/COM per un'applicazione denominata MyApp, la versione locale del componente e un file vuoto denominato Myapp.exe. local devono essere copiati nella cartella contenente Myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-115">For example, to activate DLL/COM redirection for an application named Myapp, the local version of the component and an empty file named Myapp.exe.local must be copied into the folder containing Myapp.exe.</span></span> <span data-ttu-id="8e2a0-116">In questo modo l'applicazione viene associata alla versione locale del componente, anziché alla versione globalmente condivisa del componente.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-116">This binds the application to the local version of the component rather than the globally shared version of the component.</span></span>

<span data-ttu-id="8e2a0-117">Quando un'applicazione carica un file di componente, ad esempio un file DLL o ocx, Windows ne esegue prima la ricerca nella cartella in cui è installato il file eseguibile e locale dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-117">When an application loads a component file, such as a DLL or .ocx file, Windows first searches for it in the folder where the application's .local and executable file is installed.</span></span> <span data-ttu-id="8e2a0-118">Se trovato, l'applicazione usa il file del componente indipendentemente da qualsiasi percorso di ricerca della directory definito nell'applicazione o nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-118">If found, the application uses that component file regardless of any directory search path defined in the application or the registry.</span></span> <span data-ttu-id="8e2a0-119">Se non viene trovato, viene usato il file del componente nel percorso di ricerca definito.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-119">If not found, the component file in the defined search path is used.</span></span>

<span data-ttu-id="8e2a0-120">Per installare l'applicazione con reindirizzamento DLL/COM, è necessario che l'utilità di installazione esegua le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e2a0-120">The installation utility must do the following to install the application with DLL/COM redirection:</span></span>

-   <span data-ttu-id="8e2a0-121">Un file locale vuoto deve essere copiato nella stessa cartella del file eseguibile dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-121">An empty .local file must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="8e2a0-122">Tutti i componenti, i file DLL e ocx utilizzati dall'applicazione devono essere copiati nella stessa cartella del file eseguibile dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-122">All of the components, DLL, and .ocx files used by the application must be copied into the same folder as the application's executable file.</span></span>
-   <span data-ttu-id="8e2a0-123">I componenti COM isolati devono essere registrati con Windows in modo che diverse versioni dell'assembly non siano in conflitto tra loro durante il caricamento in memoria nello stesso momento.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-123">Isolated COM components must be registered with Windows so that different versions of the assembly will not conflict with each other when loaded into memory at the same time.</span></span> <span data-ttu-id="8e2a0-124">Per il processo di registrazione è necessario che, mentre l'implementazione del componente possa variare tra le versioni, alcuni metadati COM, ad esempio CLSID, ProgID, libreria dei tipi e modello di threading, non possono.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-124">The registration process requires that, while the implementation of the component can change between versions, certain COM metadata such as CLSID, ProgID, Type Library, and Threading Model cannot.</span></span>
-   <span data-ttu-id="8e2a0-125">Se l'applicazione viene installata usando il Windows Installer, la directory dell'applicazione può essere protetta tramite la tabella LockPermissions.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-125">If the application is installed using the Windows Installer, then the application directory can be secured by using the LockPermissions table.</span></span> <span data-ttu-id="8e2a0-126">In genere, al sistema viene assegnato l'accesso in lettura, scrittura ed esecuzione; a tutti gli altri processi viene assegnato solo l'accesso in lettura e esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8e2a0-126">Typically, the system is given read, write, and execute access; all other processes are given only execute and read access.</span></span>

 

 



