---
description: Ricerca di file di assembly
ms.assetid: 6e6c1104-5cde-4c07-9ee2-d87062675dac
title: Ricerca di file di assembly
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d7be73b162ea41fd9eeb0a042a1fc2e202b8115
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104233295"
---
# <a name="searching-for-assembly-files"></a><span data-ttu-id="f1995-103">Ricerca di file di assembly</span><span class="sxs-lookup"><span data-stu-id="f1995-103">Searching for Assembly Files</span></span>

<span data-ttu-id="f1995-104">I contesti di attivazione possono aiutare il caricatore a trovare i file di assembly.</span><span class="sxs-lookup"><span data-stu-id="f1995-104">Activation contexts can help the loader find assembly files.</span></span> <span data-ttu-id="f1995-105">Quando il caricatore cerca un file da caricare in base al nome, cerca innanzitutto i file con il nome specificato a cui fanno riferimento gli assembly membri del contesto di attivazione attualmente attivo.</span><span class="sxs-lookup"><span data-stu-id="f1995-105">When the loader searches for a file to load by name, it first searches for files with the specified name that are referenced by assemblies that are members of the currently active activation context.</span></span> <span data-ttu-id="f1995-106">Una chiamata a [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) individua anche questi file per primi.</span><span class="sxs-lookup"><span data-stu-id="f1995-106">A call to [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) also locates these files first.</span></span> <span data-ttu-id="f1995-107">I file con il nome specificato e il contesto di attivazione corrente vengono trovati e caricati prima dei file con il nome nella directory locale o nella variabile di ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="f1995-107">Files having the specified name and the current activation context are found and loaded before files with the name in the local directory or in the PATH environment variable.</span></span> <span data-ttu-id="f1995-108">Ciò significa che quando si creano manifesti è necessario elencare tutti i file che si prevede di usare con **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)o le importazioni statiche.</span><span class="sxs-lookup"><span data-stu-id="f1995-108">This means that when you create manifests you need to list all files you plan to use with **SearchPath**, [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), or static imports.</span></span>

<span data-ttu-id="f1995-109">Si noti che questi file non vengono individuati automaticamente quando si usa [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) o altre funzioni che non eseguono la ricerca di file.</span><span class="sxs-lookup"><span data-stu-id="f1995-109">Note that these files are not automatically located when using [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or other functions that do not search for files.</span></span> <span data-ttu-id="f1995-110">Per usare questi file con **CreateFile**, usare prima [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) per trovare il percorso del file isolato, quindi usare **CreateFile** sul percorso restituito.</span><span class="sxs-lookup"><span data-stu-id="f1995-110">To use these files with **CreateFile**, use [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) first to find the path to the isolated file, and then use **CreateFile** on the returned path.</span></span>

<span data-ttu-id="f1995-111">Questo metodo di ricerca di file consente di rendere separate le applicazioni isolate in quanto più file con lo stesso nome possono quindi differire solo per la loro associazione con assembly con numeri di versione diversi.</span><span class="sxs-lookup"><span data-stu-id="f1995-111">This method of file searching helps to keep isolated applications separate because multiple files with the same name can then differ only by their association with assemblies of different version numbers.</span></span> <span data-ttu-id="f1995-112">Il sistema operativo è in grado di trovare il file corretto da utilizzare durante le operazioni sui file.</span><span class="sxs-lookup"><span data-stu-id="f1995-112">The operating system can find the correct file to use during file operations.</span></span>

<span data-ttu-id="f1995-113">Se una DLL viene caricata in questo modo utilizzando [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), il punto di ingresso della dll (DllMain) viene chiamato mentre il contesto di attivazione originale viene mantenuto attivo, tranne nel caso in cui la dll contenga un manifesto a un determinato ID di risorsa ( \_ ID di risorsa del manifesto ISOLATIONAWARE \_ \_ o 2)</span><span class="sxs-lookup"><span data-stu-id="f1995-113">If a DLL is loaded in this manner using [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), that DLL's entry point (DllMain) is called while the original activation context is kept active, except if the DLL itself contains a manifest at a certain resource ID (ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID, or 2)</span></span>

 

 
