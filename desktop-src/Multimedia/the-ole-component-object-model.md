---
title: OLE Component Object Model
description: OLE Component Object Model
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/20/2020
ms.locfileid: "103963554"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="c5527-103">OLE Component Object Model</span><span class="sxs-lookup"><span data-stu-id="c5527-103">The OLE Component Object Model</span></span>

<span data-ttu-id="c5527-104">Gli oggetti utilizzati dalla libreria AVIFile fanno tutti parte dell'Component Object Model OLE.</span><span class="sxs-lookup"><span data-stu-id="c5527-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="c5527-105">Principalmente, ciò significa che condividono determinati metodi che ne semplificano l'utilizzo e i valori restituiti sono comuni alla maggior parte dei metodi dell'interfaccia OLE.</span><span class="sxs-lookup"><span data-stu-id="c5527-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="c5527-106">Il Component Object Model OLE dei gestori di file e flussi utilizza l'interfaccia OLE **IClassFactory** per creare istanze della relativa classe di oggetti.</span><span class="sxs-lookup"><span data-stu-id="c5527-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="c5527-107">Come oggetti componente, implementano l'interfaccia [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , che è costituita dai metodi [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)e [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="c5527-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="c5527-108">L'interfaccia **IUnknown** consente a un'applicazione di ottenere puntatori ad altre interfacce supportate dallo stesso oggetto.</span><span class="sxs-lookup"><span data-stu-id="c5527-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="c5527-109">È possibile determinare se un oggetto supporta un'interfaccia specifica utilizzando il metodo **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="c5527-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="c5527-110">Se un oggetto supporta un'interfaccia specificata, **QueryInterface** restituisce un puntatore a tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="c5527-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="c5527-111">È possibile incrementare e decrementare il conteggio dei riferimenti associato a un oggetto usando i metodi [**AddRef**](/previous-versions//dd757100(v=vs.85)) e [**Release**](/previous-versions//dd757102(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="c5527-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="c5527-112">Il conteggio dei riferimenti consente a più client di accedere a un oggetto.</span><span class="sxs-lookup"><span data-stu-id="c5527-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="c5527-113">Quando un oggetto viene utilizzato dalla prima applicazione, il relativo conteggio dei riferimenti viene impostato su 1.</span><span class="sxs-lookup"><span data-stu-id="c5527-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="c5527-114">Le applicazioni utilizzeranno successivamente il metodo **AddRef** per incrementare il conteggio per consentire all'oggetto di tenere traccia del numero di volte in cui si accede.</span><span class="sxs-lookup"><span data-stu-id="c5527-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="c5527-115">Quando un'applicazione viene eseguita utilizzando un oggetto, viene chiamato il metodo di **rilascio** per decrementare il conteggio dei riferimenti.</span><span class="sxs-lookup"><span data-stu-id="c5527-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="c5527-116">Quando il conteggio dei riferimenti è pari a zero, l'oggetto non è più necessario e la **versione** libera tutte le risorse utilizzate ed Elimina definitivamente l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c5527-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="c5527-117">Poiché un oggetto usa le risorse interne trasparenti per l'applicazione, l'oggetto è responsabile della loro liberazione.</span><span class="sxs-lookup"><span data-stu-id="c5527-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="c5527-118">Un gestore di file, ad esempio, potrebbe dover chiudere i file aperti del disco e liberare memoria del buffer al momento del rilascio.</span><span class="sxs-lookup"><span data-stu-id="c5527-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="c5527-119">La maggior parte dei metodi dell'interfaccia OLE restituiscono handle di risultati definiti utilizzando il tipo di dati **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="c5527-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="c5527-120">Questo tipo di dati è costituito da un codice di gravità, da informazioni contestuali, da un codice di struttura e da un codice di stato.</span><span class="sxs-lookup"><span data-stu-id="c5527-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="c5527-121">Un handle di risultato restituito che indica l'esito positivo ha il valore zero.</span><span class="sxs-lookup"><span data-stu-id="c5527-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="c5527-122">Un valore diverso da zero indica un errore e il membro del codice di stato dell'handle del risultato restituito fornisce una base per un'interpretazione aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="c5527-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="c5527-123">Per ulteriori informazioni sugli handle dei risultati restituiti OLE, vedere la Guida *di riferimento per programmatori OLE*.</span><span class="sxs-lookup"><span data-stu-id="c5527-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 