---
title: Acquisizione di flussi da un dispositivo MCI
description: Acquisizione di flussi da un dispositivo MCI
ms.assetid: 44cbf375-f97e-426a-a703-dfb1b1933138
keywords:
- MCI (Media Control Interface), acquisizione di flussi
- Messaggio WM_CAP_SET_MCI_DEVICE
- capSetMCIDeviceName (macro)
- Messaggio WM_CAP_GET_MCI_DEVICE
- capGetMCIDeviceName (macro)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab8cf358a87a812024328abf7fc1aae0509a126f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104515976"
---
# <a name="streaming-capture-from-an-mci-device"></a><span data-ttu-id="00dce-108">Acquisizione di flussi da un dispositivo MCI</span><span class="sxs-lookup"><span data-stu-id="00dce-108">Streaming Capture from an MCI Device</span></span>

<span data-ttu-id="00dce-109">I dispositivi MCI potenziano l'operazione di acquisizione in acquisizione in tempo reale e acquisizione frame.</span><span class="sxs-lookup"><span data-stu-id="00dce-109">MCI devices augment the capture operation in real-time capture and step-frame capture.</span></span> <span data-ttu-id="00dce-110">È possibile specificare il dispositivo MCI, ad esempio videodisco o videoregistratore (VCR), che funge da origine video per l'operazione di acquisizione usando il [**\_ dispositivo WM Cap \_ set \_ MCI \_**](wm-cap-set-mci-device.md) (o la macro [**capSetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) ) e specificando il nome del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="00dce-110">You can specify the MCI device, such as a videodisc or video-cassette recorder (VCR), acting as the video source for your capture operation by using the [**WM\_CAP\_SET\_MCI\_DEVICE**](wm-cap-set-mci-device.md) message (or the [**capSetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) macro) and specifying the name of the device.</span></span> <span data-ttu-id="00dce-111">È anche possibile recuperare il nome del dispositivo attualmente impostato usando il messaggio [**WM \_ Cap \_ get \_ MCI \_ Device**](wm-cap-get-mci-device.md) (o la macro [**capGetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) ).</span><span class="sxs-lookup"><span data-stu-id="00dce-111">You can also retrieve the device name currently set by using the [**WM\_CAP\_GET\_MCI\_DEVICE**](wm-cap-get-mci-device.md) message (or the [**capGetMCIDeviceName**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) macro).</span></span>

<span data-ttu-id="00dce-112">Nell'acquisizione in tempo reale la finestra di acquisizione sincronizza l'operazione di acquisizione e compensa i ritardi associati al posizionamento dell'origine video MCI e l'inizializzazione delle risorse, ad esempio i buffer di acquisizione, necessarie per l'acquisizione dei dati.</span><span class="sxs-lookup"><span data-stu-id="00dce-112">In real-time capture, the capture window synchronizes the capture operation and compensates for delays associated with positioning the MCI video source and initializing the resources (such as capture buffers) required for capturing data.</span></span> <span data-ttu-id="00dce-113">La finestra di acquisizione prevede l'installazione di un dispositivo video MCI valido nel sistema per l'acquisizione dei dati in questo modo.</span><span class="sxs-lookup"><span data-stu-id="00dce-113">The capture window expects a valid MCI video device to be installed in the system for capturing data this way.</span></span>

<span data-ttu-id="00dce-114">Le specifiche per il controllo di un dispositivo MCI sono archiviate nei membri della struttura [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="00dce-114">Specifications for controlling an MCI device are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="00dce-115">Le origini video compatibili con MCI includono VCR e Laserdisc.</span><span class="sxs-lookup"><span data-stu-id="00dce-115">MCI-compatible video sources include VCRs and laserdiscs.</span></span> <span data-ttu-id="00dce-116">Se il membro **fMCIControl** della struttura è impostato su **true**, la finestra di acquisizione coordina l'operazione MCI.</span><span class="sxs-lookup"><span data-stu-id="00dce-116">If the **fMCIControl** member of this structure is set to **TRUE**, the capture window coordinates MCI operation.</span></span> <span data-ttu-id="00dce-117">La finestra di acquisizione usa i parametri specificati nei membri **dwMCIStartTime** e **dwMCIStopTime** per ottenere le posizioni di avvio e arresto, in millisecondi, della sequenza.</span><span class="sxs-lookup"><span data-stu-id="00dce-117">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members to obtain the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="00dce-118">Se il valore di **fMCIControl** è **false**, l'origine video non viene considerata come un dispositivo MCI e il contenuto di **dwMCIStartTime** e **dwMCIStopTime** viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="00dce-118">If the value of **fMCIControl** is **FALSE**, the video source is not treated as an MCI device and the contents of **dwMCIStartTime** and **dwMCIStopTime** are ignored.</span></span>

<span data-ttu-id="00dce-119">È possibile utilizzare Media Player per verificare rapidamente che un dispositivo video MCI sia connesso correttamente al sistema.</span><span class="sxs-lookup"><span data-stu-id="00dce-119">You can use Media Player to quickly verify that an MCI video device is properly connected to the system.</span></span> <span data-ttu-id="00dce-120">La riproduzione di un dispositivo con Media Player verifica che la configurazione di MCI per il dispositivo sia corretta.</span><span class="sxs-lookup"><span data-stu-id="00dce-120">Playing a device with Media Player verifies that the MCI configuration for the device is correct.</span></span> <span data-ttu-id="00dce-121">Se viene visualizzata un'immagine sullo schermo video, l'origine video è connessa correttamente all'hardware di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="00dce-121">If an image appears on the video display, the video source is connected properly to the capture hardware.</span></span>

<span data-ttu-id="00dce-122">In Step-Frame Capture la finestra di acquisizione sincronizza l'operazione di acquisizione e compensa i ritardi associati al posizionamento dell'origine video MCI e l'inizializzazione delle risorse necessarie per l'acquisizione dei dati.</span><span class="sxs-lookup"><span data-stu-id="00dce-122">In step-frame capture, the capture window synchronizes the capture operation and compensates for the delays associated with positioning the MCI video source and initializing the resources required for capturing data.</span></span> <span data-ttu-id="00dce-123">Inoltre, la finestra di acquisizione garantisce che non vengano eliminati frame; scorre i frame video singolarmente, assicurando che il frame venga acquisito e archiviato prima di acquisire il frame successivo nel flusso video.</span><span class="sxs-lookup"><span data-stu-id="00dce-123">In addition, the capture window ensures that no frames are dropped; it steps through the video frames individually, ensuring that the frame is captured and stored before capturing the next frame in the video stream.</span></span>

<span data-ttu-id="00dce-124">Le specifiche per il controllo dell'acquisizione di frame Step sono archiviate nei membri della struttura [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) .</span><span class="sxs-lookup"><span data-stu-id="00dce-124">Specifications for controlling step-frame capture are stored in the members of the [**CAPTUREPARMS**](/windows/win32/api/vfw/ns-vfw-captureparms) structure.</span></span> <span data-ttu-id="00dce-125">L'acquisizione con frame Step USA i membri seguenti oltre ai membri usati per l'acquisizione in tempo reale: **fStepMCIDevice**, **fStepCaptureAt2x** e **wStepCaptureAverageFrames**.</span><span class="sxs-lookup"><span data-stu-id="00dce-125">Step-frame capture uses the following members in addition to the members used for real-time capture: **fStepMCIDevice**, **fStepCaptureAt2x**, and **wStepCaptureAverageFrames**.</span></span> <span data-ttu-id="00dce-126">Se il membro **fStepMCIDevice** è impostato su **true**, la finestra di acquisizione coordina il passaggio Frame Capture.</span><span class="sxs-lookup"><span data-stu-id="00dce-126">If the **fStepMCIDevice** member is set to **TRUE**, the capture window coordinates step-frame capture.</span></span> <span data-ttu-id="00dce-127">La finestra di acquisizione usa i parametri specificati nei membri **dwMCIStartTime** e **dwMCIStopTime** per le posizioni di avvio e arresto, in millisecondi, della sequenza.</span><span class="sxs-lookup"><span data-stu-id="00dce-127">The capture window uses the parameters specified in the **dwMCIStartTime** and **dwMCIStopTime** members for the starting and stopping positions, in milliseconds, of the sequence.</span></span> <span data-ttu-id="00dce-128">La finestra di acquisizione USA **fStepCaptureAt2x** per determinare se l'hardware di acquisizione deve acquisire i fotogrammi video con una doppia risoluzione normale e USA **wStepCaptureAverageFrames** per specificare il numero di volte in cui viene campionato ogni frame nell'operazione di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="00dce-128">The capture window uses **fStepCaptureAt2x** to determine if the capture hardware should capture video frames at twice the normal resolution and uses **wStepCaptureAverageFrames** to specify the number of times each frame in the capture operation is sampled.</span></span>

<span data-ttu-id="00dce-129">Se **fStepMCIDevice** è **false**, viene utilizzata l'acquisizione in tempo reale al posto di Step-Frame Capture e il contenuto di **fStepCaptureAt2x** e **wStepCaptureAverageFrames** vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="00dce-129">If **fStepMCIDevice** is **FALSE**, real-time capture is used instead of step-frame capture and the contents of **fStepCaptureAt2x**, and **wStepCaptureAverageFrames** are ignored.</span></span>

<span data-ttu-id="00dce-130">Se viene specificata un'acquisizione con frame Step e **fStepCaptureAt2x** è impostato su **true**, l'hardware di acquisizione acquisisce il doppio della risoluzione specificata.</span><span class="sxs-lookup"><span data-stu-id="00dce-130">If a step-frame capture is specified and **fStepCaptureAt2x** is set to **TRUE**, the capture hardware captures at twice the specified resolution.</span></span> <span data-ttu-id="00dce-131">(Le risoluzioni dell'altezza e della larghezza sono raddoppiate). Il software esegue l'interpolazione dei pixel nell'immagine di risoluzione superiore per produrre l'immagine in corrispondenza della risoluzione specificata.</span><span class="sxs-lookup"><span data-stu-id="00dce-131">(The resolutions of both the height and width are doubled.) The software interpolates the pixels in the higher resolution image to produce the image at the specified resolution.</span></span> <span data-ttu-id="00dce-132">Questa forma di media può migliorare la definizione perimetrale delle immagini in un frame.</span><span class="sxs-lookup"><span data-stu-id="00dce-132">This form of averaging can improve the edge definition of images in a frame.</span></span> <span data-ttu-id="00dce-133">È possibile abilitare questa opzione se l'hardware non supporta la decimazione basata su hardware e si sta acquisendo in formato RGB.</span><span class="sxs-lookup"><span data-stu-id="00dce-133">You can enable this option if the hardware does not support hardware-based decimation and you are capturing in the RGB format.</span></span>

> [!Note]  
> <span data-ttu-id="00dce-134">Se l'hardware supporta la decimazione basata su hardware, può acquisire campioni a una velocità superiore rispetto a quanto specificato e usare questi esempi aggiuntivi per ottenere le definizioni dei colori più coerenti con l'immagine originale.</span><span class="sxs-lookup"><span data-stu-id="00dce-134">If your hardware supports hardware-based decimation, it can capture samples at a higher rate than specified and use these additional samples to obtain color definitions that are more consistent with the original image.</span></span> <span data-ttu-id="00dce-135">Gli esempi aggiuntivi vengono eliminati dopo essere stati usati e l'hardware passa gli esempi al driver di acquisizione alla velocità specificata.</span><span class="sxs-lookup"><span data-stu-id="00dce-135">The additional samples are discarded after they are used, and the hardware passes samples to the capture driver at the specified rate.</span></span>

 

<span data-ttu-id="00dce-136">Se viene specificata un'acquisizione con frame Step, il membro **wStepCaptureAverageFrames** specifica il numero di volte in cui un frame viene campionato durante la creazione di un frame basato sull'esempio medio.</span><span class="sxs-lookup"><span data-stu-id="00dce-136">If a step-frame capture is specified, the **wStepCaptureAverageFrames** member specifies the number of times a frame is sampled when creating a frame based on the average sample.</span></span> <span data-ttu-id="00dce-137">Questa tecnica di media riduzione riduce il rumore di digitalizzazione casuale visualizzato in un frame.</span><span class="sxs-lookup"><span data-stu-id="00dce-137">This averaging technique reduces the random digitization noise appearing in a frame.</span></span> <span data-ttu-id="00dce-138">Un valore tipico per il numero di medie è 5.</span><span class="sxs-lookup"><span data-stu-id="00dce-138">A typical value for the number of averages is 5.</span></span>

<span data-ttu-id="00dce-139">Per ulteriori informazioni su MCI, vedere [MCI](mci.md).</span><span class="sxs-lookup"><span data-stu-id="00dce-139">For more information about MCI, see [MCI](mci.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="00dce-140">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="00dce-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="00dce-141">Variazioni di acquisizione</span><span class="sxs-lookup"><span data-stu-id="00dce-141">Capture Variations</span></span>](capture-variations.md)
</dt> </dl>

 

 




