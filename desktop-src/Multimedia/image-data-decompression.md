---
title: Decompressione Image-Data
description: Decompressione Image-Data
ms.assetid: 4bff02be-dac8-41f4-a3af-2da6a2693ffe
keywords:
- Gestione compressione video (VCM), decompressione immagini-dati
- VCM (Gestione compressione video), decompressione immagini-dati
- Funzioni ICDecompressEx
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 25614f157436056f7f24c340f6cc6f4dbc62d9ae
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337119"
---
# <a name="image-data-decompression"></a><span data-ttu-id="122d8-106">Decompressione Image-Data</span><span class="sxs-lookup"><span data-stu-id="122d8-106">Image-Data Decompression</span></span>

<span data-ttu-id="122d8-107">L'applicazione usa una serie di funzioni [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) per controllare il decompressore.</span><span class="sxs-lookup"><span data-stu-id="122d8-107">Your application uses a series of [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions to control the decompressor.</span></span> <span data-ttu-id="122d8-108">Le funzioni consentono di eseguire le attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="122d8-108">The functions can help you perform the following tasks:</span></span>

-   <span data-ttu-id="122d8-109">Selezionare un decompressore.</span><span class="sxs-lookup"><span data-stu-id="122d8-109">Select a decompressor.</span></span>
-   <span data-ttu-id="122d8-110">Preparare il decompressore.</span><span class="sxs-lookup"><span data-stu-id="122d8-110">Prepare the decompressor.</span></span>
-   <span data-ttu-id="122d8-111">Decomprimere i dati.</span><span class="sxs-lookup"><span data-stu-id="122d8-111">Decompress the data.</span></span>
-   <span data-ttu-id="122d8-112">Decompressione finale.</span><span class="sxs-lookup"><span data-stu-id="122d8-112">End decompression.</span></span>

<span data-ttu-id="122d8-113">L'applicazione gestisce la decompressione in modo analogo al modo in cui gestisce la compressione, con la differenza che il formato di input è un formato compresso e il formato di output è visualizzabile.</span><span class="sxs-lookup"><span data-stu-id="122d8-113">Your application handles decompression similarly to the way it handles compression, except that the input format is a compressed format and the output format is a displayable format.</span></span> <span data-ttu-id="122d8-114">Il formato di input per la decompressione viene in genere ottenuto dall'intestazione del flusso.</span><span class="sxs-lookup"><span data-stu-id="122d8-114">The input format for decompression is usually obtained from the stream header.</span></span> <span data-ttu-id="122d8-115">Dopo aver determinato il formato di input, l'applicazione può usare le funzioni [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) o [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) per trovare un decompressore in grado di gestirlo.</span><span class="sxs-lookup"><span data-stu-id="122d8-115">After determining the input format, your application can use the [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) or [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) functions to find a decompressor that can handle it.</span></span>

<span data-ttu-id="122d8-116">Le funzioni e le macro [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) sono un superset del gruppo di funzioni [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) e forniscono altre funzionalità.</span><span class="sxs-lookup"><span data-stu-id="122d8-116">The [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions and macros are a superset of the [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) function group and provide more capabilities.</span></span> <span data-ttu-id="122d8-117">La funzionalità di **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend)e [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) sostituisce quella delle funzioni **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend)e [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) .</span><span class="sxs-lookup"><span data-stu-id="122d8-117">The functionality of **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend), and [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) replaces that of the **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend), and [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) functions.</span></span> <span data-ttu-id="122d8-118">Usare le funzioni e le macro **ICDecompressEx** al posto degli equivalenti di **ICDecompress** .</span><span class="sxs-lookup"><span data-stu-id="122d8-118">Use the **ICDecompressEx** functions and macros in place of the **ICDecompress** equivalents.</span></span>

## <a name="decompressor-and-decompression-format-selection"></a><span data-ttu-id="122d8-119">Selezione del formato decompressore e decompressione</span><span class="sxs-lookup"><span data-stu-id="122d8-119">Decompressor and Decompression Format Selection</span></span>

<span data-ttu-id="122d8-120">Se si desidera decomprimere i dati e l'applicazione richiede un formato di output specifico, è possibile utilizzare la funzione [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) per eseguire una query sul decompressore per determinare se supporta i formati di input e di output.</span><span class="sxs-lookup"><span data-stu-id="122d8-120">If you want to decompress data and your application requires a specific output format, you can use the [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) function to query the decompressor to determine if it supports the input and output formats.</span></span>

<span data-ttu-id="122d8-121">Se il formato di output non è importante nell'applicazione, è necessario trovare solo un decompressore in grado di gestire il formato di input.</span><span class="sxs-lookup"><span data-stu-id="122d8-121">If the output format is not important in your application, you need only find a decompressor that can handle the input format.</span></span> <span data-ttu-id="122d8-122">Per determinare se un decompressore è in grado di gestire il formato di input, utilizzare [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) e specificare **null** per il parametro *lpbiDst* .</span><span class="sxs-lookup"><span data-stu-id="122d8-122">To determine if a decompressor can handle the input format, use [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) and specify **NULL** for the *lpbiDst* parameter.</span></span> <span data-ttu-id="122d8-123">L'applicazione è in grado di determinare le dimensioni del buffer necessarie per i dati che specificano il formato di decompressione inviando il messaggio [**MCI \_ Decompress \_ get \_ Format**](icm-decompress-get-format.md) (oppure usare la macro [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) ).</span><span class="sxs-lookup"><span data-stu-id="122d8-123">Your application can determine the buffer size needed for the data specifying the decompression format by sending the [**ICM\_DECOMPRESS\_GET\_FORMAT**](icm-decompress-get-format.md) message (or use the [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) macro).</span></span> <span data-ttu-id="122d8-124">Per recuperare i dati di formato, è anche possibile inviare il **\_ \_ \_ formato di Decomprimi di ICM** (o la macro [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) ).</span><span class="sxs-lookup"><span data-stu-id="122d8-124">You can also send **ICM\_DECOMPRESS\_GET\_FORMAT** (or the [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) macro) to retrieve the format data.</span></span> <span data-ttu-id="122d8-125">Il decompressore restituisce il formato suggerito in una struttura [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) .</span><span class="sxs-lookup"><span data-stu-id="122d8-125">The decompressor returns its suggested format in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure.</span></span> <span data-ttu-id="122d8-126">Questo formato in genere conserva la maggior parte delle informazioni durante la decompressione.</span><span class="sxs-lookup"><span data-stu-id="122d8-126">This format typically preserves the most information during decompression.</span></span> <span data-ttu-id="122d8-127">L'applicazione deve verificare che il decompressore venga restituito correttamente prima di decomprimere le informazioni.</span><span class="sxs-lookup"><span data-stu-id="122d8-127">Your application should ensure that the decompressor returns successfully before it decompresses the information.</span></span>

<span data-ttu-id="122d8-128">Poiché l'applicazione alloca la memoria necessaria per la decompressione, deve determinare la quantità massima di memoria che può essere richiesta dal decompressore per il formato di output.</span><span class="sxs-lookup"><span data-stu-id="122d8-128">Because your application allocates the memory required for decompression, it needs to determine the maximum memory the decompressor can require for the output format.</span></span> <span data-ttu-id="122d8-129">Il messaggio **MCI \_ Decompress \_ get \_ Format** ottiene il numero di byte utilizzati dal decompressore per il formato predefinito.</span><span class="sxs-lookup"><span data-stu-id="122d8-129">The **ICM\_DECOMPRESS\_GET\_FORMAT** message obtains the number of bytes the decompressor uses for the default format.</span></span>

<span data-ttu-id="122d8-130">Se l'applicazione definisce il proprio formato usando [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), è necessario ottenere anche una tavolozza per la bitmap. **ICDecompressExQuery** non fornisce le definizioni della tavolozza.</span><span class="sxs-lookup"><span data-stu-id="122d8-130">If your application defines its own format by using [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), it must also obtain a palette for the bitmap; **ICDecompressExQuery** does not provide palette definitions.</span></span> <span data-ttu-id="122d8-131">(La maggior parte delle applicazioni usa formati standard e non è necessario ottenere una tavolozza). L'applicazione può ottenere la tavolozza inviando il messaggio [**MCI \_ Decompress \_ get \_ palette**](icm-decompress-get-palette.md) (oppure usare la macro [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) ).</span><span class="sxs-lookup"><span data-stu-id="122d8-131">(Most applications use standard formats and do not need to obtain a palette.) Your application can obtain the palette by sending the [**ICM\_DECOMPRESS\_GET\_PALETTE**](icm-decompress-get-palette.md) message (or use the [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) macro).</span></span>

## <a name="decompressor-initialization"></a><span data-ttu-id="122d8-132">Inizializzazione del decompressore</span><span class="sxs-lookup"><span data-stu-id="122d8-132">Decompressor Initialization</span></span>

<span data-ttu-id="122d8-133">Quando l'applicazione seleziona un decompressore in grado di gestire i formati di input e di output necessari, è possibile inizializzare il decompressore usando la funzione [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) .</span><span class="sxs-lookup"><span data-stu-id="122d8-133">After your application selects a decompressor that can handle the input and output formats it needs, you can initialize the decompressor by using the [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) function.</span></span> <span data-ttu-id="122d8-134">Questa funzione richiede l'handle di decompressione e i formati di input e output.</span><span class="sxs-lookup"><span data-stu-id="122d8-134">This function requires the decompressor handle and the input and output formats.</span></span>

## <a name="data-decompression"></a><span data-ttu-id="122d8-135">Decompressione dei dati</span><span class="sxs-lookup"><span data-stu-id="122d8-135">Data Decompression</span></span>

<span data-ttu-id="122d8-136">Per decomprimere un frame, è possibile usare la funzione [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) .</span><span class="sxs-lookup"><span data-stu-id="122d8-136">You can use the [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) function to decompress a frame.</span></span> <span data-ttu-id="122d8-137">L'applicazione deve usare questa funzione ripetutamente fino a quando non vengono decompressi tutti i frame di una sequenza.</span><span class="sxs-lookup"><span data-stu-id="122d8-137">Your application must use this function repeatedly until all the frames in a sequence are decompressed.</span></span>

<span data-ttu-id="122d8-138">Se il flusso video è in ritardo rispetto ad altri componenti, ad esempio audio, durante la riproduzione, l'applicazione può specificare il flag **ICDECOMPRESS \_ sbrigati** per velocizzare la decompressione.</span><span class="sxs-lookup"><span data-stu-id="122d8-138">If your video stream lags behind other components (such as audio) during playback, your application can specify the **ICDECOMPRESS\_HURRYUP** flag to speed decompression.</span></span> <span data-ttu-id="122d8-139">A tale scopo, un decompressore potrebbe estrarre solo le informazioni necessarie per decomprimere il frame successivo e non decomprimere completamente il frame corrente.</span><span class="sxs-lookup"><span data-stu-id="122d8-139">To do this, a decompressor might extract only the information it needs to decompress the next frame and not fully decompress the current frame.</span></span> <span data-ttu-id="122d8-140">Pertanto, l'applicazione non deve tentare di creare i dati decompressi quando utilizza questo flag.</span><span class="sxs-lookup"><span data-stu-id="122d8-140">Therefore, your application should not try to draw the decompressed data when it uses this flag.</span></span>

<span data-ttu-id="122d8-141">Dopo che l'applicazione ha decompresso i dati, può inviare il messaggio di [**\_ \_ fine DECOMPRESSEX ICM**](icm-decompressex-end.md) (oppure usare la macro [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) ) per notificare al decompressore che è terminato.</span><span class="sxs-lookup"><span data-stu-id="122d8-141">After your application has decompressed the data, it can send the [**ICM\_DECOMPRESSEX\_END**](icm-decompressex-end.md) message (or use the [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) macro) to notify the decompressor that it has finished.</span></span> <span data-ttu-id="122d8-142">Se si vuole riavviare la decompressione dopo l'uso di questa funzione, l'applicazione deve reinizializzare il decompressore usando [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span><span class="sxs-lookup"><span data-stu-id="122d8-142">If you want to restart decompression after using this function, your application must reinitialize the decompressor by using [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span></span>

## <a name="related-topics"></a><span data-ttu-id="122d8-143">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="122d8-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="122d8-144">Servizi VCM</span><span class="sxs-lookup"><span data-stu-id="122d8-144">VCM Services</span></span>](vcm-services.md)
</dt> </dl>

 

 