---
title: Federazione
description: La federazione consente la delega dell'autorità di autorizzazione ad altri membri di una relazione.
ms.assetid: 574496df-95dc-45f7-8c42-e646aec12e69
keywords:
- Servizi Web federativi per Windows
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a02744c9c0a5358da35f4c31c20633c420fee9
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/12/2021
ms.locfileid: "104550121"
---
# <a name="federation"></a><span data-ttu-id="cd575-106">Federazione</span><span class="sxs-lookup"><span data-stu-id="cd575-106">Federation</span></span>

<span data-ttu-id="cd575-107">La federazione consente la delega dell'autorità di autorizzazione ad altri membri di una relazione.</span><span class="sxs-lookup"><span data-stu-id="cd575-107">Federation allows the delegation of authorization authority to other members of an interprise.</span></span> <span data-ttu-id="cd575-108">Si consideri, ad esempio, il problema aziendale seguente: l'azienda di produzione di auto parts Contoso Ltd desidera consentire ai dipendenti autorizzati del cliente Fabrikam Inc di accedere in modo sicuro al servizio Web per l'ordine delle parti di contoso.</span><span class="sxs-lookup"><span data-stu-id="cd575-108">For example, consider the following business problem: The auto parts manufacturing company Contoso Ltd would like to allow authorized employees of its customer Fabrikam Inc to securely access Contoso's parts order Web Service.</span></span> <span data-ttu-id="cd575-109">Una soluzione di sicurezza per questo scenario è che Contoso può configurare un meccanismo di attendibilità con Fabrikam per delegare la decisione di autorizzazione di accesso a Fabrikam.</span><span class="sxs-lookup"><span data-stu-id="cd575-109">One security solution for this scenario is for Contoso to set up a trust mechanism with Fabrikam to delegate the access authorization decision to Fabrikam.</span></span> <span data-ttu-id="cd575-110">Questo processo potrebbe funzionare come segue:</span><span class="sxs-lookup"><span data-stu-id="cd575-110">This process could work as follows:</span></span>

-   <span data-ttu-id="cd575-111">Fabrikam, quando diventa un partner di Contoso, configura un accordo di trust con contoso.</span><span class="sxs-lookup"><span data-stu-id="cd575-111">Fabrikam, when it becomes a partner of Contoso, sets up a trust agreement with Contoso.</span></span> <span data-ttu-id="cd575-112">L'obiettivo di questo passaggio consiste nell'accettare il tipo di token di sicurezza e il contenuto che rappresenterà l'autorizzazione di Fabrikam e sarà accettabile per contoso.</span><span class="sxs-lookup"><span data-stu-id="cd575-112">The goal of this step is to agree on the security token type and content that will represent Fabrikam's authorization and will be acceptable to Contoso.</span></span> <span data-ttu-id="cd575-113">Ad esempio, è possibile che un certificato X. 509 attendibile con nome soggetto "CN = Fabrikam Inc Supplier STS" firmi un token SAML per tale SAML affinché venga accettato dal servizio Web di contoso.</span><span class="sxs-lookup"><span data-stu-id="cd575-113">For example, it may be decided that a trusted X.509 certificate with subject name "CN=Fabrikam Inc Supplier STS" should sign a SAML token for that SAML to be accepted by the Contoso Web Service.</span></span> <span data-ttu-id="cd575-114">Inoltre, è possibile che l'attestazione di sicurezza nel token SAML emesso sia ' https://schemas.contoso.com/claims/lookup ' (per l'autorizzazione per la ricerca della parte) o ' https://schemas.contoso.com/claims/order ' (per l'autorizzazione per l'ordinamento delle parti).</span><span class="sxs-lookup"><span data-stu-id="cd575-114">Further, it may be decided that the security claim in the issued SAML token should be either 'https://schemas.contoso.com/claims/lookup' (for part lookup authorization) or 'https://schemas.contoso.com/claims/order' (for part ordering authorization).</span></span>
-   <span data-ttu-id="cd575-115">Quando un dipendente Fabrikam utilizza l'applicazione di ordinamento delle parti interna, innanzitutto Contatta un servizio token di sicurezza (STS) all'interno di Fabrikam.</span><span class="sxs-lookup"><span data-stu-id="cd575-115">When a Fabrikam employee uses the internal parts ordering application, it first contacts a security token service (STS) inside Fabrikam.</span></span> <span data-ttu-id="cd575-116">Tale dipendente viene autenticato mediante il meccanismo di sicurezza interno di Fabrikam (ad indicare, nome utente/password di dominio Windows), l'autorizzazione per l'ordine delle parti viene verificata e viene emesso un token SAML di breve durata che contiene le attestazioni appropriate e firmato dal certificato X. 509 deciso in precedenza.</span><span class="sxs-lookup"><span data-stu-id="cd575-116">That employee is authenticated using the internal Fabrikam security mechanism (say, Windows domain username/password), his authorization to order parts is verified, and he is issued a short lived SAML token containing the appropriate claims and signed by the X.509 certificate decided above.</span></span> <span data-ttu-id="cd575-117">L'applicazione di ordinamento parti Contatta quindi il servizio Contoso che presenta il token SAML emesso per autenticare ed eseguire l'attività di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="cd575-117">The parts ordering application then contacts the Contoso service presenting the issued SAML token to authenticate and perform the ordering task.</span></span>

<span data-ttu-id="cd575-118">In questo caso, il servizio token di servizio Fabrikam funge da "entità emittente" e il servizio parti di Contoso funge da "relying party".</span><span class="sxs-lookup"><span data-stu-id="cd575-118">Here, the Fabrikam STS acts as the 'issuing party' and the Contoso parts service acts as the 'relying party'.</span></span> ![Diagramma che mostra un'entità emittente e un relying party in una Federazione.](images/stsmodel.png)

## <a name="federation-features"></a><span data-ttu-id="cd575-120">Funzionalità di Federazione</span><span class="sxs-lookup"><span data-stu-id="cd575-120">Federation Features</span></span>

<span data-ttu-id="cd575-121">Di seguito sono riportate le funzionalità di sicurezza supportate per le entità o i ruoli coinvolti in uno scenario di Federazione:</span><span class="sxs-lookup"><span data-stu-id="cd575-121">The following are the supported security features for the parties or roles involved in a federation scenario:</span></span>

-   <span data-ttu-id="cd575-122">Lato client: per ottenere il token di sicurezza dal servizio token di sicurezza, è possibile usare la funzione [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) .</span><span class="sxs-lookup"><span data-stu-id="cd575-122">Client-side: For obtaining the security token from the STS, one may use [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) function.</span></span> <span data-ttu-id="cd575-123">In alternativa, è possibile usare una libreria del provider di token di sicurezza lato client, ad esempio CardSpace o LiveID, e quindi usare l'output per creare un token di sicurezza in locale usando [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken).</span><span class="sxs-lookup"><span data-stu-id="cd575-123">Alternatively, one may use a client side security token provider library such as CardSpace or LiveID, and then use their output to locally create a security token using [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken).</span></span> <span data-ttu-id="cd575-124">In entrambi i casi, una volta che il client dispone di un token di sicurezza, può creare un canale per il servizio specificando l' [**associazione di sicurezza del \_ messaggio del \_ token \_ \_ \_ WS XML**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding) per presentare il token, insieme a un'associazione di sicurezza del trasporto, ad esempio l'associazione di sicurezza del [**trasporto di WS \_ SSL \_ \_ \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) , per proteggere il canale.</span><span class="sxs-lookup"><span data-stu-id="cd575-124">Either way, once the client has the security token, it may then create a channel to the service specifying [**WS\_XML\_TOKEN\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding) to present the token, together with a transport security binding such as [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) to protect the channel.</span></span>
-   <span data-ttu-id="cd575-125">Lato server: in uno scenario di federazione con un servizio token di sicurezza che rilascia token SAML, il server può utilizzare l' [**\_ associazione di \_ \_ sicurezza dei \_ messaggi WS SAML**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding), insieme a un'associazione di sicurezza del trasporto, ad esempio il binding di sicurezza del [**trasporto di WS \_ \_ \_ \_ SSL**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) , per proteggere il canale.</span><span class="sxs-lookup"><span data-stu-id="cd575-125">Server-side: In a federation scenario with a security token service that issues SAML tokens, the server may use the [**WS\_SAML\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding), together with a transport security binding such as [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) to protect the channel.</span></span>
-   <span data-ttu-id="cd575-126">STS-Side: si noti che il servizio token di sicurezza è un'applicazione di servizio Web e può specificare i requisiti di sicurezza per quelli che richiedono un token di sicurezza utilizzando una struttura di [**Descrizione della sicurezza**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) in fase di creazione del listener come qualsiasi altro servizio Web protetto.</span><span class="sxs-lookup"><span data-stu-id="cd575-126">STS-side: Note that the STS is a Web Service application, and it can specify the security requirements for those requesting a security token from it using a [**security description**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) structure at listener creation time just as any other secure Web Service would.</span></span> <span data-ttu-id="cd575-127">Può quindi analizzare i payload dei messaggi di richiesta in ingresso per convalidare le richieste di token e restituire i token emessi come payload del messaggio di risposta.</span><span class="sxs-lookup"><span data-stu-id="cd575-127">It may then parse incoming request message payloads to validate the token requests and send back issued tokens as reply message payloads.</span></span> <span data-ttu-id="cd575-128">Attualmente non è disponibile alcuna funzionalità per semplificare le operazioni di analisi e di emissione.</span><span class="sxs-lookup"><span data-stu-id="cd575-128">Currently, no features are provided to help these parsing and issuing steps.</span></span>

<span data-ttu-id="cd575-129">Si noti che il lato client può gestire il token di sicurezza emesso in modo generico come token di sicurezza XML senza conoscere il tipo di token o eseguire un'elaborazione specifica del tipo di token.</span><span class="sxs-lookup"><span data-stu-id="cd575-129">Note that the client side can handle the issued security token generically as an XML security token without knowing the token type, or doing token type specific processing.</span></span> <span data-ttu-id="cd575-130">Tuttavia, il server deve comprendere il tipo di token di sicurezza specifico per comprenderlo ed elaborarlo.</span><span class="sxs-lookup"><span data-stu-id="cd575-130">However, the server has to understand the specific security token type in order to understand and process it.</span></span> <span data-ttu-id="cd575-131">I passaggi di richiesta e risposta del token di sicurezza utilizzano i costrutti definiti nella specifica WS-Trust.</span><span class="sxs-lookup"><span data-stu-id="cd575-131">The security token request and response steps use the constructs defined in the WS-Trust specification.</span></span>

## <a name="more-complex-federation-scenarios"></a><span data-ttu-id="cd575-132">Scenari federativi più complessi</span><span class="sxs-lookup"><span data-stu-id="cd575-132">More Complex Federation Scenarios</span></span>

<span data-ttu-id="cd575-133">Uno scenario federativo può coinvolgere più STSs che formano una catena di Federazione.</span><span class="sxs-lookup"><span data-stu-id="cd575-133">A federation scenario may involve multiple STSs that form a federation chain.</span></span> <span data-ttu-id="cd575-134">Si consideri l'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="cd575-134">Consider the following example:</span></span>

-   <span data-ttu-id="cd575-135">Il client esegue l'autenticazione al servizio token di sicurezza LiveID usando un nome utente/password LiveID e ottiene un token di sicurezza T1.</span><span class="sxs-lookup"><span data-stu-id="cd575-135">Client authenticates to the LiveID STS using a LiveID username/password, and obtains a security token T1.</span></span>
-   <span data-ttu-id="cd575-136">Il client esegue l'autenticazione a STS1 usando T1 e ottiene un token di sicurezza T2.</span><span class="sxs-lookup"><span data-stu-id="cd575-136">Client authenticates to STS1 using T1 and obtains a security token T2.</span></span>
-   <span data-ttu-id="cd575-137">Il client esegue l'autenticazione a STS2 usando T2 e ottiene un T3 del token di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="cd575-137">Client authenticates to STS2 using T2 and obtains a security token T3.</span></span>
-   <span data-ttu-id="cd575-138">Il client esegue l'autenticazione al servizio di destinazione usando T3.</span><span class="sxs-lookup"><span data-stu-id="cd575-138">Client authenticates to the target service S using T3.</span></span>

<span data-ttu-id="cd575-139">Qui, LiveID STS, STS1, STS2 e S formano la catena di Federazione.</span><span class="sxs-lookup"><span data-stu-id="cd575-139">Here, the LiveID STS, STS1, STS2 and S form the federation chain.</span></span> <span data-ttu-id="cd575-140">Il STSs in una catena di federazione può eseguire vari ruoli per lo scenario di applicazione generale.</span><span class="sxs-lookup"><span data-stu-id="cd575-140">The STSs in a federation chain may perform various roles for the overall application scenario.</span></span> <span data-ttu-id="cd575-141">Esempi di tali ruoli funzionali STS includono provider di identità, Decision Maker di autorizzazione, Anonymizer e Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="cd575-141">Examples of such STS functional roles include identity provider, authorization decision maker, anonymizer, and resource manager.</span></span>

## <a name="sts-request-parameters-and-metadata-exchange"></a><span data-ttu-id="cd575-142">Parametri della richiesta STS e scambio di metadati</span><span class="sxs-lookup"><span data-stu-id="cd575-142">STS Request Parameters and Metadata Exchange</span></span>

<span data-ttu-id="cd575-143">Affinché il client esegua una chiamata [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) corretta, è necessario che conosca i parametri della chiamata (ad esempio il tipo di token e i tipi di attestazione richiesti), i requisiti di descrizione della sicurezza del canale di richiesta per il servizio token di sicurezza e l' [indirizzo dell'endpoint](endpoint-address.md) del servizio token di [**sicurezza**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) .</span><span class="sxs-lookup"><span data-stu-id="cd575-143">For the client to make a successful [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken) call, it needs to know the parameters of that call (such as the required token type and claim types), the [**security description**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) requirements of the request channel to the STS, and the [endpoint address](endpoint-address.md) of the STS.</span></span> <span data-ttu-id="cd575-144">Per determinare queste informazioni, l'applicazione client può utilizzare una delle tecniche seguenti:</span><span class="sxs-lookup"><span data-stu-id="cd575-144">The client application may use any of the following techniques for determining this information:</span></span>

-   <span data-ttu-id="cd575-145">Codificare in modo rigido le informazioni nell'applicazione come parte delle decisioni relative alla fase di progettazione.</span><span class="sxs-lookup"><span data-stu-id="cd575-145">Hard code the information in the application as part of the design time decisions.</span></span>
-   <span data-ttu-id="cd575-146">Leggere queste informazioni da un file di configurazione a livello di applicazione configurato dal deployer dell'applicazione locale.</span><span class="sxs-lookup"><span data-stu-id="cd575-146">Read this information from an application level configuration file set up by the local application deployer.</span></span>
-   <span data-ttu-id="cd575-147">Consente di individuare in modo dinamico queste informazioni in fase di esecuzione utilizzando la funzionalità di [importazione dei metadati](metadata-import.md) con la struttura del [**\_ \_ \_ \_ \_ \_ vincolo di sicurezza del messaggio del token WS emesso**](/windows/desktop/api/WebServices/ns-webservices-ws_issued_token_message_security_binding_constraint) .</span><span class="sxs-lookup"><span data-stu-id="cd575-147">Dynamically discover this information at runtime using the [metadata import](metadata-import.md) feature with the [**WS\_ISSUED\_TOKEN\_MESSAGE\_SECURITY\_BINDING\_CONSTRAINT**](/windows/desktop/api/WebServices/ns-webservices-ws_issued_token_message_security_binding_constraint) structure.</span></span>

<span data-ttu-id="cd575-148">Per illustrare l'uso di MEX dinamico con la Federazione, prendere in considerazione l'esempio di 3 STS sopra riportato.</span><span class="sxs-lookup"><span data-stu-id="cd575-148">To illustrate the use of dynamic MEX with federation, consider the 3 STS example above.</span></span> <span data-ttu-id="cd575-149">Il client eseguirà prima un MEX dinamico con i per ottenere informazioni su T3 (ad esempio, cosa chiedere da STS2), nonché l'indirizzo MEX dinamico STS2 (ad esempio, dove trovare STS2).</span><span class="sxs-lookup"><span data-stu-id="cd575-149">The client will first do a dynamic MEX with S to obtain information about T3 (i.e., what to ask from STS2) as well as the STS2 dynamic MEX address (i.e., where to find STS2).</span></span> <span data-ttu-id="cd575-150">Utilizzerà quindi tali informazioni per eseguire un MEX dinamico con STS2 per individuare informazioni su T2 e STS1 e così via.</span><span class="sxs-lookup"><span data-stu-id="cd575-150">It will then use that information to do a dynamic MEX with STS2 to discover information about T2 and STS1, and so on.</span></span>

<span data-ttu-id="cd575-151">Pertanto, i passaggi dinamici del MEX vengono eseguiti nell'ordine 4, 3, 2, 1 per creare la catena di Federazione e la richiesta di token e i passaggi di presentazione avvengono nell'ordine 1, 2, 3, 4 per la rimozione della catena di Federazione.</span><span class="sxs-lookup"><span data-stu-id="cd575-151">Thus, the dynamic MEX steps take place in the order 4, 3, 2, 1 to build up the federation chain and the token request and presentation steps take place in the order 1, 2, 3, 4 to unwind the federation chain.</span></span>

> [!Note]  
> <span data-ttu-id="cd575-152">Windows 7 e Windows Server 2008 R2: WWSAPI supporta solo [WS-Trust](https://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf) e [WS-SecureConversation](https://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) come definito da [Lightweight Web Services Security Profile (LWSSP)](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e).</span><span class="sxs-lookup"><span data-stu-id="cd575-152">Windows 7 and Windows Server 2008 R2: WWSAPI only supports [Ws-Trust](https://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf) and [Ws-SecureConversation](https://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) as defined by [Lightweight Web Services Security Profile (LWSSP)](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e).</span></span> <span data-ttu-id="cd575-153">Per informazioni dettagliate sull'implementazione di Microsoft, vedere la sezione relativa alla [sintassi dei messaggi](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) di LWSSP.</span><span class="sxs-lookup"><span data-stu-id="cd575-153">For details regarding Microsoft's implementation please see the [MESSAGE Syntax](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) section of LWSSP.</span></span>

 

 

 