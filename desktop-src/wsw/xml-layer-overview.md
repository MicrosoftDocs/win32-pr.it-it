---
title: Panoramica sul livello XML
description: L'API XML in WWSAPI è basata sugli oggetti Reader e writer XML, che consentono la lettura o la scrittura di documenti XML in modo diretto. Il livello XML fornisce all'applicazione l'accesso completo e il controllo sul contenuto dei messaggi.
ms.assetid: 938ca257-fbb8-4569-b791-2148abb1a5a5
keywords:
- Panoramica del livello XML servizi Web per Windows
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d9b5d062754adea7b48bd42a6a501ce17d0e332b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103710708"
---
# <a name="xml-layer-overview"></a>Panoramica sul livello XML

L'API XML in WWSAPI è basata sugli oggetti [Reader](xml-reader.md) e [writer](xml-writer.md) XML, che consentono la lettura o la scrittura di documenti XML in modo diretto. Il livello XML fornisce all'applicazione l'accesso completo e il controllo sul contenuto dei messaggi.

## <a name="encoding"></a>Codifica

L'API XML supporta i documenti codificati come:

-   Testo (UTF-8, UTF-16LE, UTF-16BE)
-   Binary
-   MTOM

## <a name="storage"></a>Archiviazione

L'API XML supporta l'elaborazione di documenti archiviati come:

-   Un buffer in memoria di byte codificati
-   Un flusso
-   Un [buffer XML](xml-buffer.md)

Un [buffer XML](xml-buffer.md) è una rappresentazione in memoria strutturata di un documento XML. Si tratta di una rappresentazione più efficiente rispetto a un documento codificato come byte. Un documento XML archiviato in un buffer XML può essere esplorato, letto o scritto.

## <a name="io"></a>I/O

L'API XML non eseguirà mai l'I/O, a meno che non sia richiesto in modo specifico. Inoltre, tutte le I/O possono essere avviate in modo asincrono. Per informazioni dettagliate sull'elaborazione asincrona con l'API XML, vedere [**WsFillReader**](/windows/desktop/api/WebServices/nf-webservices-wsfillreader) e [**WsFlushWriter**](/windows/desktop/api/WebServices/nf-webservices-wsflushwriter) .

## <a name="processing"></a>Elaborazione in corso

L'API XML presenta tre livelli distinti in cui è possibile elaborare il documento.

Un documento può essere elaborato un [**nodo**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_node) alla volta. Questo consente una gestione più dettagliata del contenuto XML e fornisce la fedeltà completa dei dati dal documento. A questo livello vengono usate le funzioni [**WsReadNode**](/windows/desktop/api/WebServices/nf-webservices-wsreadnode) e [**WsWriteNode**](/windows/desktop/api/WebServices/nf-webservices-wswritenode) e [**WsCopyNode**](/windows/desktop/api/WebServices/nf-webservices-wscopynode) .

Il livello di controllo successivo è costituito da API come [**WsReadStartElement**](/windows/desktop/api/WebServices/nf-webservices-wsreadstartelement), [**WsReadValue**](/windows/desktop/api/WebServices/nf-webservices-wsreadvalue) e [**WsReadEndElement**](/windows/desktop/api/WebServices/nf-webservices-wsreadendelement). Queste API forniscono numerosi tipi di convalida, ignorano gli spazi vuoti e i commenti e normalizzano testo e CDATA per presentare al consumer una visualizzazione più semplice del codice XML.

Il livello massimo di controllo consiste nell'usare l'API di serializzazione. Queste API sono derivate da un mapping tra i tipi di dati C e XML e possono leggere o scrivere una struttura complessa in memoria in XML e viceversa con una singola funzione, ad esempio [**WsWriteElement**](/windows/desktop/api/WebServices/nf-webservices-wswriteelement) e [**WsReadElement**](/windows/desktop/api/WebServices/nf-webservices-wsreadelement).

È possibile utilizzare le API di canonizzazione XML per generare una forma canonica di codice XML che a sua volta può essere utilizzata per la generazione di firme crittografiche sul contenuto XML.

## <a name="creating-a-writer"></a>Creazione di un writer

Per creare e usare un writer per scrivere in un buffer in memoria:

``` syntax
WsCreateWriter              // Create an instance of a WS_XML_WRITER
// Initialize a WS_XML_WRITER_BUFFER_OUTPUT
WsSetOutput                 // Set the encoding and output of the writer along with any other writer properties
// Write Elements
WsGetWriterProperty(..., WS_XML_WRITER_PROPERTY_BYTES, ...)  // Get the generated bytes as a single byte array
// Use the generated bytes
WsFreeWriter                // Free the writer
```

Per creare e usare un writer per scrivere in un flusso:

``` syntax
WsCreateWriter              // Create an instance of a WS_XML_WRITER
// Initialize a WS_XML_WRITER_STREAM_OUTPUT
WsSetOutput                 // Set the encoding and output of the writer along with any other writer properties
// Write Elements
WsFlushWriter               // Force any buffered data to be written
WsFreeWriter                // Free the writer
```

Per creare e utilizzare un writer per scrivere in un [ \_ \_ buffer WS XML](ws-xml-buffer.md):

``` syntax
WsCreateXmlBuffer           // Create the buffer to write to
WsCreateWriter              // Create an instance of a WS_XML_WRITER
WsSetOutputToBuffer         // Set the output buffer along with any other writer properties
// Write Elements
WsFreeWriter                // Free the writer
// The buffer has the generated document
```

In tutti i casi, è possibile includere il [**\_ \_ \_ \_ rientro della proprietà WS XML writer**](/windows/desktop/api/WebServices/ne-webservices-ws_xml_writer_property_id) per formattare il codice XML.

## <a name="writing-elements"></a>Scrittura di elementi

Per scrivere un elemento in un writer:

``` syntax
WsWriteStartElement          // Write a start element
for each attribute
{
// Write an attribute using either
WsWriteStartAttribute    // Write a start attribute
// Write Content
WsWriteEndAttribute      // Write an end attribute
// Or one of the following
WsWriteXmlnsAttribute    // Write an explicit xmlns attribute
}
// Write Elements or Content
WsWriteEndElement
```

È possibile utilizzare anche quanto segue:

``` syntax
WsWriteArray                 // Write an array of primitive values as a series of repeated elements
```

## <a name="writing-content"></a>Scrittura di contenuto

Per scrivere contenuto in un elemento o un attributo, è possibile usare quanto segue:

``` syntax
WsWriteChars                 // Write unicode characters from memory
WsWriteCharsUtf8             // Write UTF-8 encoded characters from memory
WsWriteBytes                 // Write binary data encoded as base64
WsPushBytes                  // Direct the writer to request that bytes be written
WsPullBytes                  // Direct the writer to read the bytes to be written
WsWriteValue                 // Write primitive values such as ints and BOOLs
WsWriteText                  // Write an WS_XML_TEXT
WsWriteQualifiedName         // Write a qualified name
```

Gli elementi seguenti possono essere utilizzati per scrivere in un documento, ma non possono essere utilizzati all'interno di un attributo.

``` syntax
WsWriteNode                  // Write a single WS_XML_NODE
WsCopyNode                   // Copy a single node, or an entire WS_XML_ELEMENT_NODE and children from an WS_XML_READER
```

Per scrivere una sezione CDATA in un documento di testo, è possibile utilizzare quanto segue:

``` syntax
WsWriteStartCData            // Start a CDATA section in a text encoding
// Write Content
WsWriteEndCData              // End a CDATA section in text encoding
```

## <a name="miscellaneous"></a>Varie

``` syntax
WsGetPrefixFromNamespace     // Find a prefix bound to a namespace
```

## <a name="creating-a-reader"></a>Creazione di un lettore

Per creare e usare un Reader per la lettura da un buffer in memoria:

``` syntax
WsCreateReader              // Create an instance of a WS_XML_READER
// Initialize a WS_XML_READER_BUFFER_INPUT
WsSetInput                  // Set the encoding and input of the reader along with any other reader properties
// Read Elements
WsFreeReader                // Free the reader
```

Per creare e usare un Reader per il lettore da un flusso:

``` syntax
WsCreateReader              // Create an instance of a WS_XML_READER
// Initialize a WS_XML_READER_STREAM_INPUT
WsSetInput                  // Set the encoding and input of the reader along with any other reader properties
WsFillReader                // Populate the reader with data from the underlying stream
// Read Elements
WsFreeReader                // Free the reader
```

Per creare e utilizzare un Reader per la lettura da [un \_ \_ buffer WS XML](ws-xml-buffer.md):

``` syntax
WsCreateXmlBuffer           // Create the buffer to write to
WsCreateReader              // Create an instance of a WS_XML_READER
WsSetInputToBuffer          // Set the input buffer along with any other reader properties
// Read Elements
WsFreeReader                // Free the reader
```

## <a name="reading-elements"></a>Lettura di elementi

Per leggere un elemento da un lettore:

``` syntax
WsReadToStartElement         // Skip whitespace and comments to position the reader on a specific element
for each attribute of interest
{
WsFindAttribute          // Try Locate the attribute
if (found)
{
WsReadStartAttribute // Set the reader to read the attribute
// Read Content
WsReadEndAttribute   // Return the reader to the element
}
}
WsReadStartElement           // Advance the reader past the current element
// Read Elements or Content
WsWriteEndElement            // Advance the reader past the corresponding end element
```

È possibile utilizzare anche quanto segue:

``` syntax
WsReadArray                  // Read an array of primitive values as a series of repeated elements
```

## <a name="reading-content"></a>Lettura del contenuto

Per leggere il contenuto da un elemento o un attributo, è possibile usare quanto segue:

``` syntax
WsReadChars                 // Read characters to memory as unicode
WsReadCharsUtf8             // Read characters to memory encoded as UTF-8
WsReadBytes                 // Read binary data encoded as base64
WsReadValue                 // Read primitive values such as ints and BOOLs
WsReadQualifiedName         // Read a qualified name
```

Per esaminare il nodo corrente su cui è posizionato il lettore, è possibile utilizzare il codice seguente:

``` syntax
WsGetReaderNode             // Get the current node
```

## <a name="using-a-buffer"></a>Uso di un buffer

Quando si scrive in [un \_ \_ buffer WS XML](ws-xml-buffer.md) , è possibile usare il codice seguente:

``` syntax
WsGetWriterPosition          // Get the current position of the writer in the document
WsSetWriterPosition          // Set the current position of the writer in the document
WsMoveWriter                 // Move relative to the current position in the document
WsRemoveNode                 // Delete an element or text from a document
```

Quando si esegue la lettura da un [ \_ \_ buffer WS XML](ws-xml-buffer.md) , è possibile usare il codice seguente:

``` syntax
WsGetReaderPosition          // Get the current position of the reader in the document
WsSetReaderPosition          // Set the current position of the reader in the document
WsMoveReader                 // Move relative to the current position in the document
```

Per modificare un [ \_ \_ buffer WS XML](ws-xml-buffer.md), è possibile utilizzare quanto segue:

``` syntax

WsRemoveNode                 // Delete an element or text from a document
```

## <a name="other"></a>Altri

``` syntax
WsGetNamespaceFromPrefix     // Find a namespace bound to a prefix
WsGetXmlAttribute            // Find an "xml:space" or "xml:lang" attribute in scope
```

 

 




