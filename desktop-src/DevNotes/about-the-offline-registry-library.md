---
description: La libreria del registro di sistema offline viene utilizzata per modificare un hive del registro di sistema all'esterno del registro di sistema attivo.
ms.assetid: 61db2804-1b67-473f-8dd7-6be6c6a7184e
title: Informazioni sulla libreria del registro di sistema offline
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7e08b401a4a77f55a54c48ad147bf38c8796472
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104482853"
---
# <a name="about-the-offline-registry-library"></a><span data-ttu-id="c0696-103">Informazioni sulla libreria del registro di sistema offline</span><span class="sxs-lookup"><span data-stu-id="c0696-103">About the Offline Registry Library</span></span>

<span data-ttu-id="c0696-104">La libreria del registro di sistema offline viene utilizzata per modificare un hive del registro di sistema all'esterno del registro di sistema attivo.</span><span class="sxs-lookup"><span data-stu-id="c0696-104">The offline registry library is used to modify a registry hive outside of the active system registry.</span></span>

<span data-ttu-id="c0696-105">La libreria di registro offline è destinata agli scenari di aggiornamento del registro di sistema, come la manutenzione di un'immagine del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="c0696-105">The offline registry library is intended for registry update scenarios such as servicing an operating system image.</span></span> <span data-ttu-id="c0696-106">Le funzioni del registro di sistema offline forniscono le funzionalità seguenti che non sono disponibili con le funzioni standard del registro di sistema:</span><span class="sxs-lookup"><span data-stu-id="c0696-106">The offline registry functions provide the following capabilities that are not available with the standard registry functions:</span></span>

-   <span data-ttu-id="c0696-107">È possibile usare le funzioni del registro di sistema offline per modificare un hive del registro di sistema in qualsiasi formato di registro supportato.</span><span class="sxs-lookup"><span data-stu-id="c0696-107">The offline registry functions can be used to modify a registry hive in any supported registry format.</span></span> <span data-ttu-id="c0696-108">Le funzioni standard del registro di sistema possono apportare modifiche solo a un hive del registro di sistema attivo e le modifiche devono essere compatibili con la versione di Windows in esecuzione nel sistema.</span><span class="sxs-lookup"><span data-stu-id="c0696-108">The standard registry functions can make changes only to an active registry hive and the changes must be compatible with the version of Windows running on the system.</span></span>
-   <span data-ttu-id="c0696-109">La libreria del registro di sistema offline richiede solo l'accesso in lettura per aprire un file hive del registro di sistema e l'accesso in scrittura per salvare il file.</span><span class="sxs-lookup"><span data-stu-id="c0696-109">The offline registry library requires only read access to open a registry hive file and write access to save the file.</span></span> <span data-ttu-id="c0696-110">Non vengono eseguiti altri controlli di accesso sugli oggetti in hive, rendendo possibile la modifica dell'hive con privilegi utente standard.</span><span class="sxs-lookup"><span data-stu-id="c0696-110">No other access checks are performed on objects in the hive, making it possible to modify the hive with standard user privileges.</span></span> <span data-ttu-id="c0696-111">Con le funzioni del registro di sistema standard, il caricamento di un hive nel registro di sistema attivo è un'operazione con privilegi che richiede l'accesso amministrativo.</span><span class="sxs-lookup"><span data-stu-id="c0696-111">With the standard registry functions, loading a hive into the active registry is a privileged operation that requires administrative access.</span></span>

<span data-ttu-id="c0696-112">Le funzioni del registro di sistema offline non devono essere utilizzate come sostituzioni per le funzioni del registro di sistema per i motivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="c0696-112">The offline registry functions should not be used as a substitute for the system registry functions for the following reasons:</span></span>

-   <span data-ttu-id="c0696-113">Non è possibile condividere hive del registro di sistema tra processi usando le funzioni del registro di sistema offline.</span><span class="sxs-lookup"><span data-stu-id="c0696-113">It is impossible to share registry hives between processes using the offline registry functions.</span></span>
-   <span data-ttu-id="c0696-114">Le funzioni del registro di sistema offline utilizzano un semplice blocco che può causare un peggioramento delle prestazioni per le applicazioni multithreading.</span><span class="sxs-lookup"><span data-stu-id="c0696-114">The offline registry functions use simple locking that can lead to serious performance degradation for multithreaded applications.</span></span>
-   <span data-ttu-id="c0696-115">Le modifiche apportate con le funzioni del registro di sistema offline non vengono salvate fino a quando non viene chiamata la funzione [**ORSaveHive**](orsavehive.md) .</span><span class="sxs-lookup"><span data-stu-id="c0696-115">Changes made with the offline registry functions are not saved until the [**ORSaveHive**](orsavehive.md) function is called.</span></span>

<span data-ttu-id="c0696-116">Le applicazioni non devono utilizzare le funzioni del registro di sistema offline per ignorare i requisiti di sicurezza del registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="c0696-116">Applications should not use the offline registry functions to bypass the security requirements of the system registry.</span></span> <span data-ttu-id="c0696-117">Per caricare un hive, un'applicazione in esecuzione senza i privilegi speciali richiesti dalla funzione [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) può usare la funzione [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) .</span><span class="sxs-lookup"><span data-stu-id="c0696-117">To load a hive, an application running without the special privileges required by the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function can use the [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function.</span></span>

<span data-ttu-id="c0696-118">**Windows Server 2003 e Windows XP:** La funzione [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) non è supportata.</span><span class="sxs-lookup"><span data-stu-id="c0696-118">**Windows Server 2003 and Windows XP:** The [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function is not supported.</span></span>

<span data-ttu-id="c0696-119">Un *hive del registro di sistema offline* è un hive del registro di sistema che è stato caricato in memoria usando le funzioni del registro di sistema offline.</span><span class="sxs-lookup"><span data-stu-id="c0696-119">An *offline registry hive* is a registry hive that has been loaded into memory using the offline registry functions.</span></span> <span data-ttu-id="c0696-120">Per creare un hive del registro di sistema offline vuoto, usare la funzione [**ORCreateHive**](orcreatehive.md) .</span><span class="sxs-lookup"><span data-stu-id="c0696-120">To create an empty offline registry hive, use the [**ORCreateHive**](orcreatehive.md) function.</span></span> <span data-ttu-id="c0696-121">Per modificare un hive del registro di sistema esistente, usare la funzione [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) o [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) per salvare un hive dal registro di sistema attivo in un file e quindi usare la funzione [**OROpenHive**](oropenhive.md) per aprire il file.</span><span class="sxs-lookup"><span data-stu-id="c0696-121">To modify an existing registry hive, use the [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) or [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) function to save a hive from the active system registry to a file, and then use the [**OROpenHive**](oropenhive.md) function to open the file.</span></span>

<span data-ttu-id="c0696-122">Le funzioni [**ORCreateHive**](orcreatehive.md) e [**OROpenHive**](oropenhive.md) restituiscono un handle alla chiave radice dell'hive del registro di sistema offline.</span><span class="sxs-lookup"><span data-stu-id="c0696-122">The [**ORCreateHive**](orcreatehive.md) and [**OROpenHive**](oropenhive.md) functions return a handle to the root key of the offline registry hive.</span></span> <span data-ttu-id="c0696-123">Questo handle può essere usato come un handle per qualsiasi altra chiave nell'hive del registro di sistema offline con le eccezioni seguenti: non è possibile usare le funzioni [**ORCreateKey**](orcreatekey.md) e [**OROpenKey**](oropenkey.md) per restituire un handle alla chiave radice. Impossibile utilizzare la funzione [**ORCloseKey**](orclosekey.md) per chiudere la chiave radice. non è possibile usare la funzione [**ORDeleteKey**](ordeletekey.md) per eliminare la chiave radice.</span><span class="sxs-lookup"><span data-stu-id="c0696-123">This handle can be used like a handle to any other key in the offline registry hive with the following exceptions: the [**ORCreateKey**](orcreatekey.md) and [**OROpenKey**](oropenkey.md) functions cannot be used to return a handle to the root key; the [**ORCloseKey**](orclosekey.md) function cannot be used to close the root key; and the [**ORDeleteKey**](ordeletekey.md) function cannot be used to delete the root key.</span></span> <span data-ttu-id="c0696-124">In tutti questi casi, la funzione ha esito negativo con **errore \_ \_ parametro non valido**.</span><span class="sxs-lookup"><span data-stu-id="c0696-124">In all of these cases, the function fails with **ERROR\_INVALID\_PARAMETER**.</span></span>

<span data-ttu-id="c0696-125">Usare la funzione [**ORCreateKey**](orcreatekey.md) per aggiungere chiavi a un hive del registro di sistema offline aperto e la funzione [**ORSetValue**](orsetvalue.md) per impostare i valori delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="c0696-125">Use the [**ORCreateKey**](orcreatekey.md) function to add keys to an open offline registry hive and the [**ORSetValue**](orsetvalue.md) function to set the keys' values.</span></span> <span data-ttu-id="c0696-126">La libreria del registro di sistema offline supporta altre operazioni di base del registro di sistema, ad esempio l'enumerazione, il recupero e l'eliminazione di chiavi e valori, nonché l'impostazione di attributi chiave come il comportamento di sicurezza e virtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="c0696-126">The offline registry library supports other basic registry operations such as enumerating, retrieving, and deleting keys and values, and setting key attributes such as security and virtualization behavior.</span></span> <span data-ttu-id="c0696-127">Per un elenco di funzioni, vedere [funzioni della libreria del registro di sistema offline](offline-registry-library-functions.md).</span><span class="sxs-lookup"><span data-stu-id="c0696-127">For a list of functions, see [Offline Registry Library Functions](offline-registry-library-functions.md).</span></span>

<span data-ttu-id="c0696-128">Per salvare le modifiche apportate a un hive del registro di sistema offline aperto, usare la funzione [**ORSaveHive**](orsavehive.md) per salvare l'hive in un file.</span><span class="sxs-lookup"><span data-stu-id="c0696-128">To save changes made to an open offline registry hive, use the [**ORSaveHive**](orsavehive.md) function to save the hive to a file.</span></span> <span data-ttu-id="c0696-129">(Le modifiche non vengono mantenute a meno che non venga chiamato **ORSaveHive** ). Dopo aver salvato l'hive, usare la funzione [**ORCloseHive**](orclosehive.md) per chiudere l'hive e liberare le risorse associate.</span><span class="sxs-lookup"><span data-stu-id="c0696-129">(The changes do not persist unless **ORSaveHive** is called.) After saving the hive, use the [**ORCloseHive**](orclosehive.md) function to close the hive and free resources associated with it.</span></span>

<span data-ttu-id="c0696-130">Un hive del registro di sistema offline viene convalidato solo quando viene aperto tramite la funzione [**OROpenHive**](oropenhive.md) .</span><span class="sxs-lookup"><span data-stu-id="c0696-130">An offline registry hive is validated only when it is opened using the [**OROpenHive**](oropenhive.md) function.</span></span> <span data-ttu-id="c0696-131">Se l'hive è danneggiato, l'operazione ha esito negativo. non viene effettuato alcun tentativo di ripristino dell'hive.</span><span class="sxs-lookup"><span data-stu-id="c0696-131">If the hive is corrupt, the operation simply fails; no attempt is made to repair the hive.</span></span> <span data-ttu-id="c0696-132">I controlli di accesso sugli oggetti nell'hive non vengono eseguiti fino a quando l'hive non viene caricato in un registro attivo con la funzione [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) .</span><span class="sxs-lookup"><span data-stu-id="c0696-132">Access checks on objects in the hive are not performed until the hive is loaded into an active registry with the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function.</span></span>

<span data-ttu-id="c0696-133">Le funzioni del registro di sistema offline non supportano le [chiavi predefinite](../sysinfo/predefined-keys.md).</span><span class="sxs-lookup"><span data-stu-id="c0696-133">The offline registry functions do not support the [predefined keys](../sysinfo/predefined-keys.md).</span></span>

<span data-ttu-id="c0696-134">Tutte le stringhe del nome di chiave e valore passate alle funzioni del registro di sistema offline devono essere Unicode.</span><span class="sxs-lookup"><span data-stu-id="c0696-134">All key and value name strings passed to offline registry functions must be Unicode.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c0696-135">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c0696-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c0696-136">Funzioni della libreria del registro di sistema offline \_</span><span class="sxs-lookup"><span data-stu-id="c0696-136">Offline Registry Library\_Functions</span></span>](offline-registry-library-functions.md)
</dt> </dl>

 

 
