---
title: Procedure consigliate per l'infrastruttura grafica DirectX (DXGI)
description: Questo articolo illustra i problemi di portabilità delle chiavi.
ms.assetid: 2df92ffe-1bfc-d682-2770-20cf0c831c9b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f576368674d05af74e3161d4251301ebc066a489
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399481"
---
# <a name="directx-graphics-infrastructure-dxgi-best-practices"></a><span data-ttu-id="ad4f2-103">Infrastruttura grafica DirectX (DXGI): procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="ad4f2-103">DirectX Graphics Infrastructure (DXGI): Best Practices</span></span>

<span data-ttu-id="ad4f2-104">Microsoft DirectX Graphics Infrastructure (DXGI) è un nuovo sottosistema introdotto con Windows Vista che incapsula alcune delle attività di basso livello richieste da Direct3D 10, 10,1, 11 e 11,1.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-104">Microsoft DirectX Graphics Infrastructure (DXGI) is a new subsystem that was introduced with Windows Vista that encapsulates some of the low-level tasks that are needed by Direct3D 10, 10.1, 11, and 11.1.</span></span> <span data-ttu-id="ad4f2-105">Dal punto di vista di un programmatore Direct3D 9, DXGI include la maggior parte del codice per l'enumerazione, la creazione della catena di scambio e la presentazione che in precedenza era stato compresso nelle API Direct3D 9.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-105">From the perspective of a Direct3D 9 programmer, DXGI encompasses most of the code for enumeration, swap-chain creation, and presentation that previously was packed into the Direct3D 9 APIs.</span></span> <span data-ttu-id="ad4f2-106">Quando si porta un'app in DXGI e Direct3D 10. x e Direct3D 11. x, è necessario prendere in considerazione alcune considerazioni per assicurarsi che il processo venga eseguito senza problemi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-106">When you port an app to DXGI and Direct3D 10.x and Direct3D 11.x, you need to take some considerations into account to ensure that the process runs smoothly.</span></span>

<span data-ttu-id="ad4f2-107">Questo articolo illustra i problemi di portabilità delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-107">This article discusses key porting issues.</span></span>

-   [<span data-ttu-id="ad4f2-108">Problemi a schermo intero</span><span class="sxs-lookup"><span data-stu-id="ad4f2-108">Full-Screen Issues</span></span>](#full-screen-issues)
-   [<span data-ttu-id="ad4f2-109">Più monitoraggi</span><span class="sxs-lookup"><span data-stu-id="ad4f2-109">Multiple Monitors</span></span>](#multiple-monitors)
-   [<span data-ttu-id="ad4f2-110">Stili della finestra e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-110">Window Styles and DXGI</span></span>](#window-styles-and-dxgi)
-   [<span data-ttu-id="ad4f2-111">Multithreading e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-111">Multithreading and DXGI</span></span>](#multithreading-and-dxgi)
-   [<span data-ttu-id="ad4f2-112">Gamma e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-112">Gamma and DXGI</span></span>](#gamma-and-dxgi)
-   [<span data-ttu-id="ad4f2-113">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="ad4f2-113">DXGI 1.1</span></span>](#dxgi-11)
-   [<span data-ttu-id="ad4f2-114">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="ad4f2-114">DXGI 1.2</span></span>](#dxgi-12)

## <a name="full-screen-issues"></a><span data-ttu-id="ad4f2-115">Problemi di Full-Screen</span><span class="sxs-lookup"><span data-stu-id="ad4f2-115">Full-Screen Issues</span></span>

<span data-ttu-id="ad4f2-116">Nel porting da Direct3D 9 a DXGI e a Direct3D 10. x o Direct3D 11. x, spesso i problemi associati al passaggio dalla finestra alla modalità a schermo intero possono causare problemi per gli sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-116">In porting from Direct3D 9 to DXGI and to Direct3D 10.x or Direct3D 11.x, issues associated with moving from windowing to full-screen mode often may cause headaches for developers.</span></span> <span data-ttu-id="ad4f2-117">I principali problemi si verificano perché le applicazioni Direct3D 9, a differenza delle applicazioni DXGI, richiedono un approccio pratico per tenere traccia degli stili e degli Stati delle finestre.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-117">The main problems arise because Direct3D 9 applications, unlike DXGI applications, require a more hands-on approach to tracking window styles and window states.</span></span> <span data-ttu-id="ad4f2-118">Quando il codice per la modifica della modalità viene trasferito per l'esecuzione su DXGI, causa spesso un comportamento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-118">When the mode-changing code is ported to run on DXGI, it often causes unexpected behavior.</span></span>

<span data-ttu-id="ad4f2-119">Spesso, le applicazioni Direct3D 9 gestivano la transizione in modalità a schermo intero impostando la risoluzione del buffer anteriore, forzando il dispositivo in modalità esclusiva a schermo intero e quindi impostando le risoluzioni del buffer indietro per la corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-119">Often, Direct3D 9 applications handled the transition into full-screen mode by setting the resolution of the front buffer, forcing the device into full-screen exclusive mode, and then setting the back buffer resolutions to match.</span></span> <span data-ttu-id="ad4f2-120">Un percorso separato è stato usato per le modifiche alle dimensioni della finestra perché doveva essere gestito dal processo della finestra ogni volta che l'applicazione riceve un \_ messaggio di dimensioni WM.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-120">A separate path was used for changes to window size because they had to be managed from the window process whenever the application received a WM\_SIZE message.</span></span>

<span data-ttu-id="ad4f2-121">DXGI tenta di semplificare questo approccio combinando i due casi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-121">DXGI attempts to simplify this approach by combining the two cases.</span></span> <span data-ttu-id="ad4f2-122">Ad esempio, quando il bordo della finestra viene trascinato in modalità finestra, l'applicazione riceve un \_ messaggio di dimensioni WM.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-122">For example, when the window border is dragged in windowed mode, the application receives a WM\_SIZE message.</span></span> <span data-ttu-id="ad4f2-123">DXGI intercetta questo messaggio e ridimensiona automaticamente il buffer anteriore.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-123">DXGI intercepts this message and automatically resizes the front buffer.</span></span> <span data-ttu-id="ad4f2-124">A tale scopo, è necessario chiamare [**IDXGISwapChain:: ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) per ridimensionare il buffer nascosto in base alle dimensioni passate come parametri in \_ dimensioni WM.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-124">All that the application needs to do is call [**IDXGISwapChain::ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) to resize the back buffer to the size that was passed as parameters in WM\_SIZE.</span></span> <span data-ttu-id="ad4f2-125">Analogamente, quando l'applicazione deve passare dalla modalità a schermo intero a quella a finestra, l'applicazione può semplicemente chiamare [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="ad4f2-125">Similarly, when the application needs to switch between full-screen and windowed mode, the application can simply call [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="ad4f2-126">DXGI ridimensiona il buffer anteriore in modo che corrisponda alla modalità a schermo intero appena selezionato e invia un \_ messaggio di dimensioni WM all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-126">DXGI resizes the front buffer to match the newly selected full-screen mode, and it sends a WM\_SIZE message to the application.</span></span> <span data-ttu-id="ad4f2-127">L'applicazione chiama di nuovo **ResizeBuffers**, proprio come se il bordo della finestra fosse stato trascinato.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-127">The application again calls **ResizeBuffers**, just as it would if the window border was dragged.</span></span>

<span data-ttu-id="ad4f2-128">La metodologia della spiegazione precedente segue un percorso molto particolare.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-128">The methodology of the preceding explanation follows a very particular path.</span></span> <span data-ttu-id="ad4f2-129">Per impostazione predefinita, DXGI imposta la risoluzione a schermo intero sulla risoluzione del desktop.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-129">DXGI set the full-screen resolution to the desktop resolution by default.</span></span> <span data-ttu-id="ad4f2-130">Molte applicazioni, tuttavia, passano a una risoluzione a schermo intero preferita.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-130">Many applications, however, switch to a preferred full-screen resolution.</span></span> <span data-ttu-id="ad4f2-131">In tal caso, DXGI fornisce [**IDXGISwapChain:: ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span><span class="sxs-lookup"><span data-stu-id="ad4f2-131">In such a case, DXGI provides [**IDXGISwapChain::ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span></span> <span data-ttu-id="ad4f2-132">Questa operazione deve essere chiamata prima di chiamare [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="ad4f2-132">This should be called before calling [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="ad4f2-133">Sebbene questi metodi possano essere chiamati nell'ordine opposto (**SetFullscreenState** prima, seguito da **ResizeTarget**), in questo modo \_ viene inviato un messaggio di dimensioni WM aggiuntive all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-133">Although these methods can be called in the opposite order (**SetFullscreenState** first, followed by **ResizeTarget**), doing so causes an extra WM\_SIZE message to be sent to the application.</span></span> <span data-ttu-id="ad4f2-134">Questa operazione può anche causare lo sfarfallio, perché DXGI potrebbe essere forzato a eseguire due modifiche in modalità. Dopo aver chiamato **SetFullscreenState**, è consigliabile chiamare di nuovo **ResizeTarget** con il membro **RefreshRate** della [**modalità DXGI \_ \_ desc**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) azzerato. Questa operazione equivale a un'istruzione di nessuna operazione in DXGI, ma può evitare problemi con la frequenza di aggiornamento, che verranno discussi successivamente.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-134">(Doing so can also cause flickering, since DXGI could be forced to perform two mode changes.) After calling **SetFullscreenState**, it is advisable to call **ResizeTarget** again with the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) zeroed out. This amounts to a no-operation instruction in DXGI, but it can avoid issues with the refresh rate, which are discussed next.</span></span>

<span data-ttu-id="ad4f2-135">In modalità schermo intero, il Gestione finestre desktop (DWM) è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-135">When in full-screen mode, the Desktop Window Manager (DWM) is disabled.</span></span> <span data-ttu-id="ad4f2-136">DXGI può eseguire un flip per presentare il contenuto del buffer nascosto anziché eseguire un blit, operazione eseguita in modalità finestra.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-136">DXGI can perform a flip to present the back buffer contents instead of doing a blit, which it would do in windowed mode.</span></span> <span data-ttu-id="ad4f2-137">Questo miglioramento delle prestazioni può essere annullato, tuttavia, se non vengono soddisfatti determinati requisiti.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-137">This performance gain can be undone, however, if certain requirements are not met.</span></span> <span data-ttu-id="ad4f2-138">Per assicurarsi che DXGI faccia un capovolgimento anziché un blit, il buffer anteriore e il buffer nascosto devono essere dimensionati in modo identico.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-138">To ensure that DXGI does a flip instead of a blit, the front buffer and back buffer must be sized identically.</span></span> <span data-ttu-id="ad4f2-139">Se l'applicazione gestisce correttamente i \_ messaggi di dimensioni WM, questo non dovrebbe essere un problema.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-139">If the application correctly handles its WM\_SIZE messages, this should not be a problem.</span></span> <span data-ttu-id="ad4f2-140">Inoltre, i formati devono essere identici.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-140">Also, the formats must be identical.</span></span>

<span data-ttu-id="ad4f2-141">Il problema per la maggior parte delle applicazioni è la frequenza di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-141">The problem for most applications is the refresh rate.</span></span> <span data-ttu-id="ad4f2-142">La frequenza di aggiornamento specificata nella chiamata a [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) deve essere una frequenza di aggiornamento enumerata dall'oggetto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) usato dalla catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-142">The refresh rate that is specified in the call to [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) must be a refresh rate that is enumerated by the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object that the swap chain is using.</span></span> <span data-ttu-id="ad4f2-143">DXGI è in grado di calcolare automaticamente questo valore se l'applicazione Azzera il membro **RefreshRate** di [**DXGI \_ mode \_ desc**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) passato a **ResizeTarget**.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-143">DXGI can automatically calculate this value if the application zeroes out the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) that is passed into **ResizeTarget**.</span></span> <span data-ttu-id="ad4f2-144">È importante non presupporre che alcune frequenze di aggiornamento siano sempre supportate e semplicemente impostare come hardcoded un valore.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-144">It is important not to assume that certain refresh rates will always be supported and to simply hard-code a value.</span></span> <span data-ttu-id="ad4f2-145">Spesso, gli sviluppatori scelgono 60 Hz come frequenza di aggiornamento, non sapendo che la frequenza di aggiornamento enumerata dal monitor è circa 60.000/1.001 Hz dal monitor.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-145">Often, developers choose 60 Hz as the refresh rate, not knowing that the enumerated refresh rate from the monitor is approximately 60,000 / 1,001 Hz from the monitor.</span></span> <span data-ttu-id="ad4f2-146">Se la frequenza di aggiornamento non corrisponde alla frequenza di aggiornamento prevista di 60, DXGI è forzato a eseguire un blit in modalità schermo intero anziché un capovolgimento.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-146">If the refresh rate does not match the expected refresh rate of 60, DXGI is forced to perform a blit in full-screen mode instead of a flip.</span></span>

<span data-ttu-id="ad4f2-147">L'ultimo problema che gli sviluppatori spesso affrontano è come modificare le risoluzioni a schermo intero rimanendo in modalità schermo intero.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-147">The last issue that developers often face is how to change full-screen resolutions while remaining in full-screen mode.</span></span> <span data-ttu-id="ad4f2-148">La chiamata a [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) e [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) a volte riesce, ma la risoluzione a schermo intero rimane la risoluzione del desktop.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-148">Calling [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) and [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) sometimes succeeds, but the full-screen resolution remains the desktop resolution.</span></span> <span data-ttu-id="ad4f2-149">Inoltre, gli sviluppatori possono creare una catena di scambio a schermo intero e fornire una risoluzione specifica, solo per trovare che DXGI utilizza per impostazione predefinita la risoluzione desktop indipendentemente dai numeri passati.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-149">Also, developers may create a full-screen swap chain and give a specific resolution, only to find that DXGI defaults to the desktop resolution regardless of the numbers passed in.</span></span> <span data-ttu-id="ad4f2-150">Se non diversamente indicato, il valore predefinito di DXGI è la risoluzione del desktop per le catene di scambio a schermo intero.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-150">Unless otherwise instructed, DXGI defaults to the desktop resolution for full-screen swap chains.</span></span> <span data-ttu-id="ad4f2-151">Quando si crea una catena di scambio a schermo intero, il membro **Flags** della struttura [**\_ desc della \_ catena \_ di scambio DXGI**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) deve essere impostato sull' [**\_ \_ \_ \_ \_ \_ opzione di modalità Consenti flag catena di scambio DXGI**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) per eseguire l'override del comportamento predefinito di dxgi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-151">When creating a full-screen swap chain, the **Flags** member of the [**DXGI\_SWAP\_CHAIN\_DESC**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) structure must be set to [**DXGI\_SWAP\_CHAIN\_FLAG\_ALLOW\_MODE\_SWITCH**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) to override DXGI's default behavior.</span></span> <span data-ttu-id="ad4f2-152">Questo flag può anche essere passato a **ResizeTarget** per abilitare o disabilitare questa funzionalità in modo dinamico.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-152">This flag also can be passed to **ResizeTarget** to enable or disable this functionality dynamically.</span></span>

## <a name="multiple-monitors"></a><span data-ttu-id="ad4f2-153">Più monitoraggi</span><span class="sxs-lookup"><span data-stu-id="ad4f2-153">Multiple Monitors</span></span>

<span data-ttu-id="ad4f2-154">Quando si usa DXGI con più monitoraggi, è necessario seguire due regole.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-154">When using DXGI with multiple monitors, there are two rules to follow.</span></span>

<span data-ttu-id="ad4f2-155">La prima regola si applica alla creazione di due o più catene di scambio a schermo intero su più monitor.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-155">The first rule applies to the creation of two or more full-screen swap chains on multiple monitors.</span></span> <span data-ttu-id="ad4f2-156">Quando si creano tali catene di scambio, è preferibile creare tutte le catene di scambio come finestra, quindi impostarle a schermo intero.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-156">When creating such swap chains, it is best to create all swap chains as windowed, and then to set them to full-screen.</span></span> <span data-ttu-id="ad4f2-157">Se le catene di scambio vengono create in modalità schermo intero, la creazione di una seconda catena di scambio causa l'invio di una modifica della modalità alla prima catena di scambio, che può causare la terminazione della modalità schermo intero.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-157">If swap chains are created in full-screen mode, the creation of a second swap chain causes a mode change to be sent to the first swap chain, which could cause termination of full-screen mode.</span></span>

<span data-ttu-id="ad4f2-158">La seconda regola si applica agli output.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-158">The second rule applies to outputs.</span></span> <span data-ttu-id="ad4f2-159">Osservare gli output utilizzati durante la creazione di catene di scambio.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-159">Be watchful of outputs used when creating swap chains.</span></span> <span data-ttu-id="ad4f2-160">Con DXGI, l'oggetto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) controlla il monitoraggio usato dalla catena di scambio quando si diventa a schermo intero.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-160">With DXGI, the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object controls which monitor the swap chain uses when becoming full-screen.</span></span> <span data-ttu-id="ad4f2-161">A differenza di DXGI, Direct3D 9 non aveva alcun concetto di output.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-161">Unlike DXGI, Direct3D 9 had no concept of outputs.</span></span>

## <a name="window-styles-and-dxgi"></a><span data-ttu-id="ad4f2-162">Stili della finestra e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-162">Window Styles and DXGI</span></span>

<span data-ttu-id="ad4f2-163">Le applicazioni Direct3D 9 erano molto lavoro da eseguire quando si passa da una modalità a schermo intero a un'altra.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-163">Direct3D 9 applications had a lot of work to do when switching between full-screen and windowed modes.</span></span> <span data-ttu-id="ad4f2-164">Gran parte di questo lavoro ha comportato la modifica degli stili della finestra per aggiungere e rimuovere bordi, per aggiungere barre di scorrimento e così via.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-164">Much of this work involved changing window styles to add and remove borders, to add scrollbars, and so on.</span></span> <span data-ttu-id="ad4f2-165">Quando le applicazioni vengono trasferite in DXGI e Direct3D 10. x o Direct3D 11. x, questo codice viene spesso lasciato sul posto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-165">When applications are ported to DXGI and Direct3D 10.x or Direct3D 11.x, this code often is left in place.</span></span> <span data-ttu-id="ad4f2-166">A seconda delle modifiche apportate, il cambio tra le modalità può causare un comportamento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-166">Depending on the changes being made, switching between modes can cause unexpected behavior.</span></span> <span data-ttu-id="ad4f2-167">Ad esempio, quando si passa alla modalità finestra, l'applicazione potrebbe non avere più una cornice della finestra o un bordo della finestra, anche se dispone di codice che imposta in modo specifico questi stili.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-167">For example, when switching to windowed mode, the application might no longer have a window frame or window border despite having code that specifically sets these styles.</span></span> <span data-ttu-id="ad4f2-168">Questo problema si verifica perché DXGI gestisce ora la maggior parte di questo stile cambiando autonomamente.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-168">This occurs because DXGI now handles much of this style changing on its own.</span></span> <span data-ttu-id="ad4f2-169">L'impostazione manuale degli stili della finestra può interferire con DXGI e questo può causare un comportamento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-169">Manual setting of window styles can interfere with DXGI, and this can cause unexpected behavior.</span></span>

<span data-ttu-id="ad4f2-170">Il comportamento consigliato è quello di eseguire il minor lavoro possibile e di consentire a DXGI di gestire la maggior parte dell'interazione con le finestre.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-170">The recommended behavior is to do as little work as possible, and to let DXGI handle most of the interaction with the windows.</span></span> <span data-ttu-id="ad4f2-171">Tuttavia, se l'applicazione deve gestire il proprio comportamento di windowing, [**IDXGIFactory:: MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) può essere usato per indicare a DXGI di disabilitare alcune della gestione automatica della finestra.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-171">However, if the application needs to handle its own windowing behavior, [**IDXGIFactory::MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) can be used to tell DXGI to disable some of its automatic window handling.</span></span>

## <a name="multithreading-and-dxgi"></a><span data-ttu-id="ad4f2-172">Multithreading e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-172">Multithreading and DXGI</span></span>

<span data-ttu-id="ad4f2-173">Quando si usa DXGI in un'applicazione multithread per garantire che non si verifichino deadlock, è necessario prestare particolare attenzione.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-173">Special care must be taken when using DXGI in a multithreaded application to ensure that deadlocks do not occur.</span></span> <span data-ttu-id="ad4f2-174">A causa dell'interazione di chiusura di DXGI con windowing, occasionalmente invia messaggi della finestra alla finestra dell'applicazione associata.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-174">Because of DXGI's close interaction with windowing, it occasionally sends window messages to the associated application window.</span></span> <span data-ttu-id="ad4f2-175">DXGI richiede che le modifiche apportate alla finestra vengano eseguite prima di continuare, quindi utilizzerà [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), che è una chiamata sincrona.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-175">DXGI needs the windowing changes to occur before it can continue, so it will use [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which is a synchronous call.</span></span> <span data-ttu-id="ad4f2-176">L'applicazione deve elaborare il messaggio della finestra prima della restituzione di **SendMessage** .</span><span class="sxs-lookup"><span data-stu-id="ad4f2-176">The application must process the window message before **SendMessage** returns.</span></span>

<span data-ttu-id="ad4f2-177">In un'applicazione in cui DXGI chiama e il message pump si trovano nello stesso thread (o in un'applicazione a thread singolo), è necessario eseguire alcune operazioni.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-177">In an application where DXGI calls and the message pump are on the same thread (or a single-threaded application), little needs to be done.</span></span> <span data-ttu-id="ad4f2-178">Quando la chiamata DXGI si trova sullo stesso thread del message pump, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) chiama il [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85))della finestra.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-178">When the DXGI call is on the same thread as the message pump, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) calls the window's [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span></span> <span data-ttu-id="ad4f2-179">Questo ignora il message pump e consente di continuare l'esecuzione dopo la chiamata a **SendMessage**.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-179">This bypasses the message pump, and allows execution to continue after the call to **SendMessage**.</span></span> <span data-ttu-id="ad4f2-180">Tenere presente che le chiamate a [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) , ad esempio [**IDXGISwapChain::P**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present)reinviate, vengono considerate chiamate DXGI; DXGI può rinviare il lavoro da [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) o [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) fino a quando non viene chiamato il metodo **present** .</span><span class="sxs-lookup"><span data-stu-id="ad4f2-180">Remember that [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) calls, such as [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present), are also considered DXGI calls; DXGI may defer work from [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) or [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) until **Present** is called.</span></span>

<span data-ttu-id="ad4f2-181">Se la chiamata DXGI e message pump si trovano su thread diversi, è necessario prestare attenzione per evitare deadlock.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-181">If the DXGI call and message pump are on different threads, care must be taken to avoid deadlocks.</span></span> <span data-ttu-id="ad4f2-182">Quando il message pump e SendMessage si trovano su thread diversi, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) aggiunge un messaggio alla coda di messaggi della finestra e attende che la finestra elabori il messaggio.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-182">When the message pump and SendMessage are on different threads, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) adds a message to the window's message queue, and waits for the window to process that message.</span></span> <span data-ttu-id="ad4f2-183">Se la routine della finestra è occupata o non viene chiamata dal message pump, il messaggio potrebbe non essere mai elaborato e DXGI resterà in attesa per un periodo illimitato.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-183">If the window procedure is busy or is not called by the message pump, the message may never get processed and DXGI will wait indefinitely.</span></span>

<span data-ttu-id="ad4f2-184">Se, ad esempio, un'applicazione che dispone di un message pump su un thread e il relativo rendering su un altro, potrebbe voler modificare le modalità.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-184">For example, if an application that has its message pump on one thread and its rendering on another, it may want to change modes.</span></span> <span data-ttu-id="ad4f2-185">Il thread message pump indica al thread di rendering di modificare le modalità e attende il completamento della modifica della modalità.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-185">The message pump thread tells the rendering thread to change modes, and waits until the mode change is complete.</span></span> <span data-ttu-id="ad4f2-186">Tuttavia, il thread di rendering chiama le funzioni DXGI, che a loro volta chiamano [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), che si blocca fino a quando il message pump elabora il messaggio.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-186">However, the rendering thread calls DXGI functions, which in turn call [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which blocks until the message pump processes the message.</span></span> <span data-ttu-id="ad4f2-187">Si verifica un deadlock perché entrambi i thread sono ora bloccati e sono in attesa l'uno sull'altro.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-187">A deadlock occurs because both threads now are blocked, and are waiting on each other.</span></span> <span data-ttu-id="ad4f2-188">Per evitare questo problema, non bloccare mai il message pump.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-188">To avoid this, never block the message pump.</span></span> <span data-ttu-id="ad4f2-189">Se un blocco è inevitabile, tutte le interazioni DXGI devono essere eseguite nello stesso thread del message pump.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-189">If a block is unavoidable, then all DXGI interaction should occur on the same thread as the message pump.</span></span>

## <a name="gamma-and-dxgi"></a><span data-ttu-id="ad4f2-190">Gamma e DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-190">Gamma and DXGI</span></span>

<span data-ttu-id="ad4f2-191">Sebbene la gamma possa essere gestita in modo ottimale in Direct3D 10. x o Direct3D 11. x usando trame SRGB, la rampa gamma può comunque essere utile per gli sviluppatori che desiderano un valore gamma diverso rispetto a 2,2 o che usano un formato di destinazione di rendering che non supporta SRGB.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-191">Although gamma may be best handled in Direct3D 10.x or Direct3D 11.x by using SRGB textures, the gamma ramp still can be useful to developers who want a different gamma value than 2.2 or who are using a render target format that does not support SRGB.</span></span> <span data-ttu-id="ad4f2-192">Quando si imposta la rampa gamma tramite DXGI, tenere presenti due problemi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-192">Be aware of two issues when setting the gamma ramp through DXGI.</span></span> <span data-ttu-id="ad4f2-193">Il primo problema è che i valori della rampa passati in [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) sono valori float, non valori di **parole** .</span><span class="sxs-lookup"><span data-stu-id="ad4f2-193">The first issue is that the ramp values passed into [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) are float values, not **WORD** values.</span></span> <span data-ttu-id="ad4f2-194">Assicurarsi inoltre che il codice trasferito da Direct3D 9 non tenti di eseguire la conversione in valori di **Word** prima di passarli a **SetGammaControl**.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-194">Also, ensure that code ported from Direct3D 9 does not try to convert to **WORD** values before passing these to **SetGammaControl**.</span></span>

<span data-ttu-id="ad4f2-195">Il secondo problema è che, dopo aver modificato la modalità schermo intero, [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) potrebbe non sembrare funzionante, a seconda dell'oggetto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) in uso.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-195">The second issue is that, after changing to full-screen mode, [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) may not appear to work, dependent on the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object being used.</span></span> <span data-ttu-id="ad4f2-196">Quando si passa alla modalità a schermo intero, DXGI crea un nuovo oggetto di output e usa l'oggetto per tutte le operazioni successive nell'output.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-196">When changing to full-screen mode, DXGI creates a new output object, and uses the object for all subsequent operations on the output.</span></span> <span data-ttu-id="ad4f2-197">Se si chiama **SetGammaControl** in un output enumerato prima di un'opzione di modalità a schermo intero, la chiamata non viene indirizzata verso l'output attualmente utilizzato da dxgi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-197">If calling **SetGammaControl** on an output that is enumerated before a full-screen mode switch, the call is not directed toward the output that DXGI is using currently.</span></span> <span data-ttu-id="ad4f2-198">Per evitare questo problema, chiamare [**IDXGISwapChain:: GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) per ottenere l'output corrente, quindi chiamare **SetGammaControl** da questo output per ottenere il comportamento corretto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-198">To avoid this, call [**IDXGISwapChain::GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) to get the current output, and then call **SetGammaControl** off this output to get the correct behavior.</span></span>

<span data-ttu-id="ad4f2-199">Per informazioni sull'uso della correzione gamma, vedere [uso della correzione gamma](/windows/desktop/direct3ddxgi/using-gamma-correction).</span><span class="sxs-lookup"><span data-stu-id="ad4f2-199">For info about using gamma correction, see [Using gamma correction](/windows/desktop/direct3ddxgi/using-gamma-correction).</span></span>

## <a name="dxgi-11"></a><span data-ttu-id="ad4f2-200">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="ad4f2-200">DXGI 1.1</span></span>

<span data-ttu-id="ad4f2-201">Il runtime Direct3D 11 incluso in Windows 7 e installato in Windows Vista (vedere [KB971644](https://support.microsoft.com/kb/971644)) include la versione 1,1 di dxgi.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-201">The Direct3D 11 runtime included in Windows 7 and installed onto Windows Vista (see [KB971644](https://support.microsoft.com/kb/971644)) includes version 1.1 of DXGI.</span></span> <span data-ttu-id="ad4f2-202">Questo aggiornamento aggiunge le definizioni per diversi nuovi formati (in particolare BGRA, la distorsione X2 a 10 bit e la compressione della trama BC6H e BC7 di Direct3D 11), nonché una nuova versione di DXGI Factory e interfacce di adapter ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) per l'enumerazione delle connessioni Desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-202">This update adds definitions for a number of new formats (particularly BGRA, 10-bit X2 bias, and Direct3D 11's BC6H and BC7 texture compression), as well as a new version of the DXGI factory and adapter interfaces ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) for enumerating remote desktop connections.</span></span>

<span data-ttu-id="ad4f2-203">Quando si utilizza Direct3D 11, per impostazione predefinita il runtime utilizzerà DXGI 1,1 quando viene chiamato [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) o [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) con un puntatore [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) null.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-203">When you use Direct3D 11, the runtime will use DXGI 1.1 by default when calling [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) or [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) with a NULL [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) pointer.</span></span> <span data-ttu-id="ad4f2-204">La combinazione di uso di DXGI 1,0 e DXGI 1,1 nello stesso processo non è supportata.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-204">Mixing use of DXGI 1.0 and DXGI 1.1 in the same process is not supported.</span></span> <span data-ttu-id="ad4f2-205">Anche la combinazione di istanze di oggetti DXGI da diverse Factory nello stesso processo non è supportata.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-205">Mixing DXGI object instances from different factories in the same process also is not supported.</span></span> <span data-ttu-id="ad4f2-206">Pertanto, quando si usa DirectX 11, qualsiasi uso esplicito delle interfacce DXGI usa un [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) creato dal punto di ingresso di [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) in "DXGI.DLL" per garantire che l'applicazione usi sempre DXGI 1,1.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-206">Therefore, when you use DirectX 11, any explicit use of the DXGI interfaces uses a [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) created by the [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) entry-point in “DXGI.DLL” to ensure the application is always using DXGI 1.1.</span></span>

## <a name="dxgi-12"></a><span data-ttu-id="ad4f2-207">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="ad4f2-207">DXGI 1.2</span></span>

<span data-ttu-id="ad4f2-208">Il runtime Direct3D 11,1 incluso in Windows 8 include anche la versione 1,2 di DXGI.</span><span class="sxs-lookup"><span data-stu-id="ad4f2-208">The Direct3D 11.1 runtime that is included in Windows 8 also includes version 1.2 of DXGI.</span></span>

<span data-ttu-id="ad4f2-209">DXGI 1,2 Abilita queste funzionalità:</span><span class="sxs-lookup"><span data-stu-id="ad4f2-209">DXGI 1.2 enables these features:</span></span>

-   <span data-ttu-id="ad4f2-210">rendering stereo</span><span class="sxs-lookup"><span data-stu-id="ad4f2-210">stereo rendering</span></span>
-   <span data-ttu-id="ad4f2-211">formati a 16 bit per pixel</span><span class="sxs-lookup"><span data-stu-id="ad4f2-211">16 bit-per-pixel formats</span></span>

    -   <span data-ttu-id="ad4f2-212">DXGI \_ Format \_ B5G6R5 \_ UNORM e DXGI \_ Format \_ B5G5R5A1 \_ UNORM sono ora completamente supportati</span><span class="sxs-lookup"><span data-stu-id="ad4f2-212">DXGI\_FORMAT\_B5G6R5\_UNORM and DXGI\_FORMAT\_B5G5R5A1\_UNORM are now fully supported</span></span>
    -   <span data-ttu-id="ad4f2-213">è stato aggiunto un nuovo formato DXGI \_ \_ B5G5R5A1 \_ UNORM Format</span><span class="sxs-lookup"><span data-stu-id="ad4f2-213">a new DXGI\_FORMAT\_B5G5R5A1\_UNORM format was added</span></span>

-   <span data-ttu-id="ad4f2-214">formati video</span><span class="sxs-lookup"><span data-stu-id="ad4f2-214">video formats</span></span>
-   <span data-ttu-id="ad4f2-215">nuove interfacce DXGI</span><span class="sxs-lookup"><span data-stu-id="ad4f2-215">new DXGI interfaces</span></span>

<span data-ttu-id="ad4f2-216">Per altre informazioni sulle funzionalità di DXGI 1,2, vedere [miglioramenti di DXGI 1,2](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span><span class="sxs-lookup"><span data-stu-id="ad4f2-216">For more info about DXGI 1.2 features, see [DXGI 1.2 Improvements](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span></span>

 

 