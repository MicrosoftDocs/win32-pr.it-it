---
title: Struttura dell'applicazione desktop di esempio
description: Struttura dell'applicazione desktop di esempio
ms.assetid: e042470d-dc78-488c-bcad-2e8d34714d5d
keywords:
- Windows Media Gestione dispositivi, esempi
- Gestione dispositivi, esempi
- applicazioni desktop, esempi
- Windows Media Gestione dispositivi, esempio di applicazione desktop
- Esempio di Gestione dispositivi, applicazione desktop
- esempi, applicazioni desktop
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 34fb377c1bb6ebf943721b55ec6175e65f70ddde
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103711119"
---
# <a name="structure-of-the-sample-desktop-application"></a><span data-ttu-id="c60b8-109">Struttura dell'applicazione desktop di esempio</span><span class="sxs-lookup"><span data-stu-id="c60b8-109">Structure of the Sample Desktop Application</span></span>

<span data-ttu-id="c60b8-110">L'applicazione desktop di esempio è costituita da due parti principali:</span><span class="sxs-lookup"><span data-stu-id="c60b8-110">The sample desktop application consists of two main pieces:</span></span>

-   <span data-ttu-id="c60b8-111">Il progetto wmdapp contiene la maggior parte delle classi che visualizzano l'interfaccia utente, gestiscono il trascinamento e rilascio ed eseguono tutte le funzionalità necessarie del programma.</span><span class="sxs-lookup"><span data-stu-id="c60b8-111">The wmdapp project contains most of the classes that display the user interface, handle dragging and dropping, and perform all the required functionality of the program.</span></span>
-   <span data-ttu-id="c60b8-112">Il progetto proghelp è un'applicazione helper che contiene classi non essenziali per gestire le notifiche di stato e i trasferimenti manuali di file dal desktop all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c60b8-112">The proghelp project is a helper application that contains nonessential classes to handle status notifications and manual file transfers from the desktop to the application.</span></span>

<span data-ttu-id="c60b8-113">Il file eseguibile usa il progetto Helper solo quando l'utente seleziona **Usa interfaccia operazione** nel menu **Opzioni** per gestire il trasferimento manuale dei file al dispositivo e incrementa la barra di stato nel modulo stato download.</span><span class="sxs-lookup"><span data-stu-id="c60b8-113">The executable uses the helper project only when the user selects **Use Operation Interface** on the **Options** menu to handle manual file transfer to the device, and to increment the status bar in the download progress form.</span></span> <span data-ttu-id="c60b8-114">Tutto il resto dell'applicazione viene gestito nel progetto wmdapp.</span><span class="sxs-lookup"><span data-stu-id="c60b8-114">All the rest of the application is handled in the wmdapp project.</span></span>



| <span data-ttu-id="c60b8-115">Classe</span><span class="sxs-lookup"><span data-stu-id="c60b8-115">Class</span></span>                | <span data-ttu-id="c60b8-116">File</span><span class="sxs-lookup"><span data-stu-id="c60b8-116">File</span></span>                    | <span data-ttu-id="c60b8-117">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c60b8-117">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                     |
|----------------------|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c60b8-118">—</span><span class="sxs-lookup"><span data-stu-id="c60b8-118">—</span></span>                    | <span data-ttu-id="c60b8-119">WMDMApp. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-119">wmdmapp.cpp</span></span>             | <span data-ttu-id="c60b8-120">Classe che gestisce la finestra padre dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="c60b8-120">The class that handles the parent window of the user interface.</span></span> <span data-ttu-id="c60b8-121">Il codice in questo file gestisce anche alcuni input utente non gestiti da CDevFiles, ad esempio la creazione di una playlist o un album in un dispositivo, l'eliminazione di file e la registrazione delle scelte di menu.</span><span class="sxs-lookup"><span data-stu-id="c60b8-121">The code in this file also handles some user input not handled by CDevFiles, such as creating a playlist or album on a device, deleting files, and registering menu choices.</span></span>                                                                                                                                                    |
| <span data-ttu-id="c60b8-122">CDevices</span><span class="sxs-lookup"><span data-stu-id="c60b8-122">CDevices</span></span>             | <span data-ttu-id="c60b8-123">Devices. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-123">Devices.cpp</span></span>             | <span data-ttu-id="c60b8-124">Classe che gestisce il riquadro sinistro della finestra principale dell'applicazione, in cui sono elencati i dispositivi disponibili.</span><span class="sxs-lookup"><span data-stu-id="c60b8-124">The class that handles the left-hand pane of the main application window, where the available devices are listed.</span></span> <span data-ttu-id="c60b8-125">Questa classe gestisce il ciclo di messaggistica, che gestisce l'input dell'utente, ad esempio la selezione di un dispositivo e la notifica al riquadro CDevFiles di caricare i file appropriati quando la selezione del dispositivo è cambiata.</span><span class="sxs-lookup"><span data-stu-id="c60b8-125">This class manages the messaging loop, which handles user input such as selecting a device and notifying the CDevFiles pane to load the appropriate files when the device selection has changed.</span></span>                                                                              |
| <span data-ttu-id="c60b8-126">CDevFiles</span><span class="sxs-lookup"><span data-stu-id="c60b8-126">CDevFiles</span></span>            | <span data-ttu-id="c60b8-127">Devfiles. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-127">Devfiles.cpp</span></span>            | <span data-ttu-id="c60b8-128">Classe che gestisce il riquadro destro della finestra principale dell'applicazione, in cui sono elencati i file nel dispositivo selezionato.</span><span class="sxs-lookup"><span data-stu-id="c60b8-128">The class that handles the right-hand pane of the main application window, where the files on the selected device are listed.</span></span> <span data-ttu-id="c60b8-129">Questa classe gestisce il ciclo di messaggistica e gestisce l'input dell'utente, ad esempio il trascinamento di file nel dispositivo e l'eliminazione di file dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c60b8-129">This class manages the messaging loop, and handles user input such as dragging files onto the device and deleting files from the device.</span></span>                                                                                                                          |
| <span data-ttu-id="c60b8-130">CStatus</span><span class="sxs-lookup"><span data-stu-id="c60b8-130">CStatus</span></span>              | <span data-ttu-id="c60b8-131">Stato. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-131">Status.cpp</span></span>              | <span data-ttu-id="c60b8-132">Classe che gestisce la barra di stato inferiore nella finestra principale, in cui è elencato il numero di dispositivi e file, insieme alla quantità di memoria disponibile e usata sul dispositivo selezionato.</span><span class="sxs-lookup"><span data-stu-id="c60b8-132">The class that handles the bottom status bar in the main window, where the number of devices and files is listed, along with the amount of free and used memory on the selected device.</span></span>                                                                                                                                                                                                         |
| <span data-ttu-id="c60b8-133">CWMDM</span><span class="sxs-lookup"><span data-stu-id="c60b8-133">CWMDM</span></span>                | <span data-ttu-id="c60b8-134">Wmdevmgr. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-134">Wmdevmgr.cpp</span></span>            | <span data-ttu-id="c60b8-135">Interfaccia di primo livello per Windows Media Gestione dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c60b8-135">The top-level interface for Windows Media Device Manager.</span></span> <span data-ttu-id="c60b8-136">Questa classe gestisce l'autenticazione, recupera l'interfaccia **IWMDeviceManager** di primo livello e si registra per le notifiche con l'interfaccia **IWMDMNotification** .</span><span class="sxs-lookup"><span data-stu-id="c60b8-136">This class handles authentication, retrieves the top-level **IWMDeviceManager** interface, and registers for notifications with the **IWMDMNotification** interface.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="c60b8-137">CProgress</span><span class="sxs-lookup"><span data-stu-id="c60b8-137">CProgress</span></span>            | <span data-ttu-id="c60b8-138">Progress. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-138">Progress.cpp</span></span>            | <span data-ttu-id="c60b8-139">Classe nel progetto di applicazione principale che consente di creare e gestire la finestra di dialogo che mostra lo stato di avanzamento di un evento.</span><span class="sxs-lookup"><span data-stu-id="c60b8-139">The class in the main application project that creates and manages the dialog box showing the progress of an event.</span></span>                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="c60b8-140">CItemData</span><span class="sxs-lookup"><span data-stu-id="c60b8-140">CItemData</span></span>            | <span data-ttu-id="c60b8-141">ItemData. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-141">ItemData.cpp</span></span>            | <span data-ttu-id="c60b8-142">Classe wrapper che include un puntatore a una risorsa di archiviazione (se rappresenta un file o una cartella nel dispositivo) o un dispositivo (se rappresenta un dispositivo), oltre a un'ampia gamma di informazioni sull'oggetto, tra cui dimensioni e attributi.</span><span class="sxs-lookup"><span data-stu-id="c60b8-142">A wrapper class that holds a pointer to a storage (if representing a file or folder on the device) or a device (if representing a device), as well as a variety of information about the object including size and attributes.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="c60b8-143">CNotificationHandler</span><span class="sxs-lookup"><span data-stu-id="c60b8-143">CNotificationHandler</span></span> | <span data-ttu-id="c60b8-144">NotificationHandler. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-144">Notificationhandler.cpp</span></span> | <span data-ttu-id="c60b8-145">Gestisce le notifiche di arrivo e rimozione dei dispositivi inviando avvisi alla finestra CDevices.</span><span class="sxs-lookup"><span data-stu-id="c60b8-145">Handles device arrival and removal notifications by alerting the CDevices window.</span></span>                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="c60b8-146">CProgressHelper</span><span class="sxs-lookup"><span data-stu-id="c60b8-146">CProgressHelper</span></span>      | <span data-ttu-id="c60b8-147">ProgressHelper. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-147">ProgressHelper.cpp</span></span>      | <span data-ttu-id="c60b8-148">Creato da CDevFiles nelle funzioni locali per ricevere notifiche da Windows Media Gestione dispositivi implementando **IWMDMProgress**.</span><span class="sxs-lookup"><span data-stu-id="c60b8-148">Created by CDevFiles in local functions to receive notifications from Windows Media Device Manager by implementing **IWMDMProgress**.</span></span> <span data-ttu-id="c60b8-149">Viene usato dalla classe CProgress per determinare la quantità di barre nell'indicatore di stato e al termine di un'azione.</span><span class="sxs-lookup"><span data-stu-id="c60b8-149">It is used by the CProgress class to determine the amount of bars in the progress bar, and when an action is finished.</span></span> <span data-ttu-id="c60b8-150">Questa classe è definita come un oggetto COM che espone l'interfaccia SDK **IWMDMProgress** e un'interfaccia personalizzata IWMDMProgressHelper.</span><span class="sxs-lookup"><span data-stu-id="c60b8-150">This class is defined as a COM object that exposes the SDK interface **IWMDMProgress** and a custom interface IWMDMProgressHelper.</span></span> |
| <span data-ttu-id="c60b8-151">COperationHelper</span><span class="sxs-lookup"><span data-stu-id="c60b8-151">COperationHelper</span></span>     | <span data-ttu-id="c60b8-152">Operationhelper. cpp</span><span class="sxs-lookup"><span data-stu-id="c60b8-152">Operationhelper.cpp</span></span>     | <span data-ttu-id="c60b8-153">Questa classe implementa **IWMDMOperation** per gestire il trasferimento manuale dei file.</span><span class="sxs-lookup"><span data-stu-id="c60b8-153">This class implements **IWMDMOperation** to handle manual transfer of files.</span></span> <span data-ttu-id="c60b8-154">È multithread per consentirne l'esecuzione in modo asincrono e viene definito come un oggetto COM che espone un'interfaccia personalizzata, IWMDMOperationHelper, per creare un'istanza e inizializzare la classe.</span><span class="sxs-lookup"><span data-stu-id="c60b8-154">It is multi-threaded to allow it to occur asynchronously, and is defined as a COM object that exposes a custom interface, IWMDMOperationHelper, to instantiate and initialize the class.</span></span> <span data-ttu-id="c60b8-155">Questa classe viene utilizzata solo se l'utente seleziona "utilizza interfaccia operazione" nel menu **Opzioni** .</span><span class="sxs-lookup"><span data-stu-id="c60b8-155">This class is only used if the user selects "Use Operation Interface" in the **Options** menu.</span></span>                            |



 

<span data-ttu-id="c60b8-156">Negli elenchi seguenti vengono illustrati i passaggi di base che si verificano per diverse azioni utente:</span><span class="sxs-lookup"><span data-stu-id="c60b8-156">The following lists outline the basic steps that occur for various user actions:</span></span>

<span data-ttu-id="c60b8-157">**All'avvio**</span><span class="sxs-lookup"><span data-stu-id="c60b8-157">**On startup**</span></span>

<span data-ttu-id="c60b8-158">I passaggi principali seguenti si verificano quando viene avviata l'applicazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="c60b8-158">The following main steps occur when the sample application is started.</span></span>

1.  <span data-ttu-id="c60b8-159">Viene creata un'istanza e viene eseguita l'autenticazione della variabile CWMDM globale e viene eseguita la registrazione per ricevere le notifiche</span><span class="sxs-lookup"><span data-stu-id="c60b8-159">The global CWMDM variable is instantiated and authenticated, and registers to receive notifications</span></span>
2.  <span data-ttu-id="c60b8-160">Viene creata un'istanza di CDevices globale e viene chiamato CDevices:: create per creare e riempire il riquadro dei dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c60b8-160">A global CDevices is instantiated, and CDevices::Create is called to create and fill the devices pane.</span></span>
3.  <span data-ttu-id="c60b8-161">Viene creata un'istanza di CDevFiles globale e viene chiamato CDevFiles:: create per creare il riquadro dei file, che non viene compilato fino a quando l'utente non seleziona un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c60b8-161">A global CDevFiles is instantiated, and CDevFiles::Create is called to create the files pane (which is not filled until the user selects a device).</span></span>
4.  <span data-ttu-id="c60b8-162">Viene creata un'istanza di CStatus globale e viene chiamato CStatus:: create per creare un'istanza della barra di stato.</span><span class="sxs-lookup"><span data-stu-id="c60b8-162">A global CStatus is instantiated, and CStatus::Create is called to instantiate the status bar.</span></span>
5.  <span data-ttu-id="c60b8-163">\_OnViewRefresh enumera tutti i dispositivi e Inizializza e aggiunge tutti i dispositivi (CItemData) a CDevices e aggiorna la barra di stato in modo da visualizzare il numero di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c60b8-163">\_OnViewRefresh enumerates through all devices and initializes and adds all devices (CItemData) to CDevices and updates the status bar to show the number of devices.</span></span>
6.  <span data-ttu-id="c60b8-164">CDevices:: AddItem aggiunge l'elemento al controllo TreeView che rappresenta i dispositivi, con un puntatore a se stesso come TVITEM. lParam.</span><span class="sxs-lookup"><span data-stu-id="c60b8-164">CDevices::AddItem adds the item to the treeview representing the devices, with a pointer to itself as the TVITEM.lparam.</span></span> <span data-ttu-id="c60b8-165">Tutti gli oggetti CDevice (Devices) e CDevFiles (file) vengono archiviati in questo membro del nodo TreeView nella finestra appropriata.</span><span class="sxs-lookup"><span data-stu-id="c60b8-165">All CDevice (devices) and CDevFiles (file) objects are stored in this member of the treeview node in the appropriate window.</span></span>

<span data-ttu-id="c60b8-166">**Quando si seleziona un dispositivo**</span><span class="sxs-lookup"><span data-stu-id="c60b8-166">**On selecting a device**</span></span>

<span data-ttu-id="c60b8-167">I passaggi principali seguenti si verificano quando l'utente seleziona un dispositivo nel riquadro a sinistra della finestra dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c60b8-167">The following main steps occur when the user selects a device in the left-hand pane of the application window.</span></span>

1.  <span data-ttu-id="c60b8-168">La finestra CDevices intrappola un clic e invia un messaggio WM \_ DRM \_ UPDATEDEVICE a se stesso.</span><span class="sxs-lookup"><span data-stu-id="c60b8-168">The CDevices window traps a click and posts a WM\_DRM\_UPDATEDEVICE message, to itself.</span></span>
2.  <span data-ttu-id="c60b8-169">CDevices riceve il proprio messaggio e chiama UpdateSelection, che indica all'oggetto CDevFiles globale di cancellare tutti gli elementi, enumerare tutti gli elementi di primo livello nel dispositivo e chiama CDevFiles:: AddItem per aggiungere ognuno al riquadro file.</span><span class="sxs-lookup"><span data-stu-id="c60b8-169">CDevices receives its own message and calls UpdateSelection, which tells the global CDevFiles object to clear everything, enumerate all the top-level items in the device, and calls CDevFiles::AddItem to add each to the files pane.</span></span>
3.  <span data-ttu-id="c60b8-170">Infine, CDevices chiama CDevFiles:: UpdateStatusBar per aggiornare la barra di stato con le informazioni corrette sul dispositivo e sul file.</span><span class="sxs-lookup"><span data-stu-id="c60b8-170">Finally, CDevices calls CDevFiles::UpdateStatusBar to update the status bar with the correct device and file information.</span></span>

<span data-ttu-id="c60b8-171">**Creazione di una playlist**</span><span class="sxs-lookup"><span data-stu-id="c60b8-171">**On creating a playlist**</span></span>

<span data-ttu-id="c60b8-172">Dopo aver fatto clic su "Crea playlist" nel menu **contenitori** , l'applicazione chiama la funzione locale \_ OnCreatePlaylist, che esegue le azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c60b8-172">After clicking "Create Playlist" on the **Containers** menu, the application calls the local function \_OnCreatePlaylist, which performs the following actions:</span></span>

1.  <span data-ttu-id="c60b8-173">Ottiene il numero di elementi selezionati dalla variabile globale CDevFiles.</span><span class="sxs-lookup"><span data-stu-id="c60b8-173">Get the number of selected items from the global CDevFiles variable.</span></span>
2.  <span data-ttu-id="c60b8-174">Chiamare la funzione locale DlgNamePlaylist per aprire una finestra di dialogo per ottenere un nome per la playlist.</span><span class="sxs-lookup"><span data-stu-id="c60b8-174">Call the local function DlgNamePlaylist to open a dialog box to get a name for the playlist.</span></span>
3.  <span data-ttu-id="c60b8-175">Chiamare il metodo CProgress:: create per creare una finestra di dialogo che mostra lo stato di avanzamento dell'azione e impostare i parametri sulla classe CProgress, ad esempio il testo del titolo, l'intervallo, il valore corrente e così via.</span><span class="sxs-lookup"><span data-stu-id="c60b8-175">Call the CProgress::Create to create a dialog window showing the progress of the action, and set parameters on the CProgress class, such as the title text, range, current value, and so on.</span></span>
4.  <span data-ttu-id="c60b8-176">Scorrere tutti gli elementi selezionati nell'oggetto visualizzazione albero CDevFiles e richiedere l'oggetto CItemData associato a ogni file selezionato nella visualizzazione albero, incrementando la barra della finestra di dialogo di stato con ogni file.</span><span class="sxs-lookup"><span data-stu-id="c60b8-176">Loop through all the selected items in the CDevFiles tree view object, and request the CItemData object associated with each selected file in the tree view, incrementing the progress dialog bar with each file.</span></span> <span data-ttu-id="c60b8-177">I file vengono aggiunti a una matrice di interfacce [**IWMDMStorage**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage) .</span><span class="sxs-lookup"><span data-stu-id="c60b8-177">The files are added to an array of [**IWMDMStorage**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage) interfaces.</span></span>
5.  <span data-ttu-id="c60b8-178">Ottenere un handle per l'elemento attualmente selezionato ed eseguirvi una query per un'interfaccia [**IWMDMStorageControl3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstoragecontrol3) , che verrà usata in un secondo momento per creare la nuova playlist nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c60b8-178">Get a handle to the currently selected item and query it for an [**IWMDMStorageControl3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstoragecontrol3) interface, which will be used later to create the new playlist on the device.</span></span>
6.  <span data-ttu-id="c60b8-179">Eseguire una query sull'oggetto selezionato per [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3)e chiamare [**CreateEmptyMetadataObject**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-createemptymetadataobject) per creare una nuova interfaccia [**IWMDMMetaData**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmmetadata).</span><span class="sxs-lookup"><span data-stu-id="c60b8-179">Query the selected object for [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3), and call [**CreateEmptyMetadataObject**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-createemptymetadataobject) to create a new [**IWMDMMetaData**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmmetadata)interface.</span></span>
7.  <span data-ttu-id="c60b8-180">Aggiungere il \_ codice del formato WMDM FORMATCODE \_ ABSTRACTAUDIOVIDEOPLAYLIST alla nuova interfaccia **IWMDMMetadata** e creare una playlist sul dispositivo chiamando [**IWMDMStorageControl3:: Insert3**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstoragecontrol3-insert3), passando l'interfaccia dei metadati.</span><span class="sxs-lookup"><span data-stu-id="c60b8-180">Add the WMDM\_FORMATCODE\_ABSTRACTAUDIOVIDEOPLAYLIST format code to the new **IWMDMMetadata** interface and create a playlist on the device by calling [**IWMDMStorageControl3::Insert3**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstoragecontrol3-insert3), passing in the metadata interface.</span></span> <span data-ttu-id="c60b8-181">Il metodo recupera un puntatore al nuovo **IWMDMStorage** sul dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c60b8-181">The method retrieves a pointer to the new **IWMDMStorage** on the device.</span></span>
8.  <span data-ttu-id="c60b8-182">Compilare la playlist eseguendo una query sulla nuova risorsa di archiviazione per [**IWMDMStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage4)e chiamando [**IWMDMStorage4:: sereferences**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage4-setreferences), passando la matrice di puntatori **IWMDMStorage** raccolti nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="c60b8-182">Fill the playlist by querying the new storage for [**IWMDMStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage4), and calling [**IWMDMStorage4::SetReferences**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage4-setreferences), passing in the array of **IWMDMStorage** pointers collected in step 4.</span></span>
9.  <span data-ttu-id="c60b8-183">Infine, creare un nuovo oggetto CItemData per memorizzare la nuova playlist nel dispositivo, inizializzarla con la nuova risorsa di archiviazione e chiamare CDevFiles:: AddItem per aggiungerla al riquadro CDevFiles.</span><span class="sxs-lookup"><span data-stu-id="c60b8-183">Finally, create a new CItemData object to hold the new playlist on the device, initialize it with the new storage, and call CDevFiles::AddItem to add it to the CDevFiles pane.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c60b8-184">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c60b8-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c60b8-185">**Applicazione desktop di esempio**</span><span class="sxs-lookup"><span data-stu-id="c60b8-185">**Sample Desktop Application**</span></span>](sample-desktop-application.md)
</dt> </dl>

 

 




