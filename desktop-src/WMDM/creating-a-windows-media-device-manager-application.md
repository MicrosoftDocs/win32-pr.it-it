---
title: Creazione di un'applicazione Windows Media Gestione dispositivi
description: Creazione di un'applicazione Windows Media Gestione dispositivi
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Windows Media Gestione dispositivi, creazione di applicazioni
- Gestione dispositivi, creazione di applicazioni
- Windows Media Gestione dispositivi, Guida alla programmazione
- Gestione dispositivi, Guida alla programmazione
- Guida per programmatori, applicazioni desktop
- Guida per programmatori, Windows Media Gestione dispositivi
- Guida per programmatori, plug-in
- Guida per programmatori, creazione di applicazioni
- Windows Media Gestione dispositivi, applicazioni desktop
- Gestione dispositivi, applicazioni desktop
- Windows Media Gestione dispositivi, plug-in
- Gestione dispositivi, plug-Insp
- plug-in, creazione
- plug-in, Guida alla programmazione
- applicazioni desktop, creazione
- creazione di applicazioni Windows Media Gestione dispositivi, informazioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "106298047"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="cfe42-119">Creazione di un'applicazione Windows Media Gestione dispositivi</span><span class="sxs-lookup"><span data-stu-id="cfe42-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="cfe42-120">In questa sezione viene descritto come utilizzare Windows Media Gestione dispositivi nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="cfe42-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="cfe42-121">Il termine "applicazione" indica un eseguibile, ad esempio un lettore multimediale o un plug-in COM, ad esempio un plug-in di misurazione.</span><span class="sxs-lookup"><span data-stu-id="cfe42-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="cfe42-122">Microsoft include diversi provider di servizi con Windows XP e Windows Media Player 10, tra cui un provider di servizi MTP, un provider di servizi Windows CE (per i dispositivi che eseguono Windows CE e l'uso del protocollo RAPI, ad esempio Pocket PC) e un provider di servizi per i dispositivi di categoria di archiviazione di massa (MSC).</span><span class="sxs-lookup"><span data-stu-id="cfe42-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="cfe42-123">È anche possibile creare un provider di servizi personalizzato per garantire la comunicazione con il proprio dispositivo. Per ulteriori informazioni, vedere [creazione di un provider di servizi](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="cfe42-124">Sono disponibili diversi provider di servizi legacy di terze parti che fanno riferimento a un dispositivo non MTP, non RAPI o non master di un produttore specifico.</span><span class="sxs-lookup"><span data-stu-id="cfe42-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="cfe42-125">Questi provider di servizi sono inclusi nel disco driver fornito con questi dispositivi.</span><span class="sxs-lookup"><span data-stu-id="cfe42-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="cfe42-126">Un'applicazione che utilizza Windows Media Gestione dispositivi deve eseguire i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="cfe42-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="cfe42-127">**Acquisire familiarità con i problemi di privacy relativi allo sviluppo di un'applicazione.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="cfe42-128">Vedere [informativa sulla privacy](privacy-statement.md) per informazioni su alcuni problemi di privacy riguardanti lo sviluppo di un'applicazione Windows Media Gestione dispositivi.</span><span class="sxs-lookup"><span data-stu-id="cfe42-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="cfe42-129">**Includere i file di intestazione e di libreria necessari per l'applicazione.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="cfe42-130">Per informazioni sui file che è necessario includere nel progetto, vedere la [libreria e i file di intestazione necessari per un'applicazione](required-library-and-header-files-for-an-application.md) .</span><span class="sxs-lookup"><span data-stu-id="cfe42-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="cfe42-131">**Autenticare l'applicazione e acquisire l'interfaccia IWMDMDevice radice.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="cfe42-132">La prima attività che un'applicazione deve eseguire per utilizzare Windows Media Gestione dispositivi consiste nell'autenticarsi autonomamente.</span><span class="sxs-lookup"><span data-stu-id="cfe42-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="cfe42-133">Questo processo consente di verificare l'identità dell'applicazione in Windows Media Gestione dispositivi usando un certificato fittizio per la funzionalità limitata di Windows Media Gestione dispositivi o l'uso di un certificato ufficiale per la funzionalità completa.</span><span class="sxs-lookup"><span data-stu-id="cfe42-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="cfe42-134">Per ulteriori informazioni, vedere [autenticazione dell'applicazione](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="cfe42-135">**Enumerare i dispositivi connessi.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="cfe42-136">Il primo passaggio per la comunicazione con i dispositivi consiste nel determinare quali dispositivi sono connessi e accessibili a Windows Media Gestione dispositivi.</span><span class="sxs-lookup"><span data-stu-id="cfe42-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="cfe42-137">Per altre informazioni, vedere [enumerazione dei dispositivi](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="cfe42-138">**Verificare lo stato dei componenti DRM del dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="cfe42-139">Per usare i file protetti da DRM, un dispositivo deve essere compilato in una versione di Windows Media DRM per i dispositivi portatili e i componenti DRM devono essere aggiornati.</span><span class="sxs-lookup"><span data-stu-id="cfe42-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="cfe42-140">Prima di iniziare a gestire i file nel dispositivo, è consigliabile verificare se il dispositivo supporta i file protetti da DRM e se è necessario aggiornare il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfe42-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="cfe42-141">Per ulteriori informazioni, vedere [gestione del contenuto protetto nell'applicazione](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="cfe42-142">**Esplorare un dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-142">**Explore a device.**</span></span> <span data-ttu-id="cfe42-143">Dopo aver trovato il dispositivo desiderato, è possibile esplorare il contenuto del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfe42-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="cfe42-144">Per altre informazioni, vedere [esplorazione di un dispositivo](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="cfe42-145">**Leggere i file dal dispositivo e scrivere i file nel dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="cfe42-146">Quando si è a conoscenza del layout del dispositivo, è possibile iniziare a trasferire i file da e verso il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cfe42-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="cfe42-147">Per altre informazioni, vedere la pagina relativa alla [lettura di file dal dispositivo](reading-files-from-the-device.md) e [alla scrittura di file nel dispositivo](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="cfe42-148">**Creare playlist nel dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-148">**Create playlists on the device.**</span></span> <span data-ttu-id="cfe42-149">Un tipo di file che è possibile scrivere nel dispositivo è un file astratto, ovvero una raccolta di riferimenti ad altri file.</span><span class="sxs-lookup"><span data-stu-id="cfe42-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="cfe42-150">Sebbene la possibilità di scrivere file astratti in un dispositivo dipende dal provider di servizi e dal dispositivo, in genere questa funzionalità è consentita solo per i dispositivi MTP.</span><span class="sxs-lookup"><span data-stu-id="cfe42-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="cfe42-151">Per altre informazioni, vedere [creazione di una playlist nel dispositivo](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="cfe42-152">Oltre a questi passaggi, sono disponibili diverse altre funzionalità che è possibile abilitare nell'applicazione:</span><span class="sxs-lookup"><span data-stu-id="cfe42-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="cfe42-153">**Notifiche.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-153">**Notifications.**</span></span> <span data-ttu-id="cfe42-154">È possibile abilitare l'applicazione per ricevere notifiche quando i dispositivi si connettono o si disconnettono dal computer.</span><span class="sxs-lookup"><span data-stu-id="cfe42-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="cfe42-155">Per ulteriori informazioni, vedere [Abilitazione di notifiche](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="cfe42-156">**Registrazione.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-156">**Logging.**</span></span> <span data-ttu-id="cfe42-157">Windows Media Gestione dispositivi utilizza un oggetto di registrazione che salva una registrazione delle azioni in un file di testo locale.</span><span class="sxs-lookup"><span data-stu-id="cfe42-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="cfe42-158">È possibile aggiungere messaggi a questo log per consentire l'analisi degli errori o delle prestazioni nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="cfe42-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="cfe42-159">Per ulteriori informazioni, vedere [Abilitazione della registrazione](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="cfe42-160">**Misurazione dell'utilizzo del contenuto.**</span><span class="sxs-lookup"><span data-stu-id="cfe42-160">**Metering content usage.**</span></span> <span data-ttu-id="cfe42-161">È possibile recuperare le statistiche di utilizzo del contenuto per le licenze che concedono questo diritto.</span><span class="sxs-lookup"><span data-stu-id="cfe42-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="cfe42-162">Queste statistiche possono quindi essere inviate a un server Web per calcolare i pagamenti di royalties ai proprietari di contenuti.</span><span class="sxs-lookup"><span data-stu-id="cfe42-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="cfe42-163">Per ulteriori informazioni, vedere [misurazione dell'utilizzo del contenuto](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="cfe42-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="cfe42-164">**Una nota cautela**</span><span class="sxs-lookup"><span data-stu-id="cfe42-164">**A note of caution**</span></span>

<span data-ttu-id="cfe42-165">Potrebbe essere necessario che l'applicazione funzioni con un'ampia gamma di dispositivi, inclusi alcuni che non sono stati sviluppati e non hanno mai testato il codice.</span><span class="sxs-lookup"><span data-stu-id="cfe42-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="cfe42-166">Questi dispositivi potrebbero o meno rispondere in modo accurato a query e comandi oppure implementare MTP o altre specifiche.</span><span class="sxs-lookup"><span data-stu-id="cfe42-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="cfe42-167">Assicurarsi di includere funzionalità di controllo degli errori e di fallback affidabili per gestire l'imprevisto.</span><span class="sxs-lookup"><span data-stu-id="cfe42-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="cfe42-168">Programma difensivo.</span><span class="sxs-lookup"><span data-stu-id="cfe42-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cfe42-169">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="cfe42-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cfe42-170">**Guida per programmatori**</span><span class="sxs-lookup"><span data-stu-id="cfe42-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




