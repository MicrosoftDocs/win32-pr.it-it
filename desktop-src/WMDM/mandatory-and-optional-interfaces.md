---
title: Interfacce obbligatorie e facoltative
description: Interfacce obbligatorie e facoltative
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:
- Windows Media Gestione dispositivi, interfacce
- Gestione dispositivi, interfacce
- Guida per programmatori, interfacce
- provider di servizi, interfacce
- creazione di provider di servizi, interfacce
- interfaces
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6aaa28db79fe8bc3cd159219cffb35f5434645ea
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103709448"
---
# <a name="mandatory-and-optional-interfaces"></a>Interfacce obbligatorie e facoltative

Nella tabella seguente vengono descritte le interfacce e i metodi obbligatori e facoltativi che i provider di servizi devono implementare. Tutte le interfacce con uno o più metodi obbligatori devono essere implementate. Un metodo obbligatorio non può restituire WMDM \_ e \_ NotSupported o e \_ NOTIMPL.



| Interfaccia e metodo                                                                                                                  | Opzione di implementazione                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMDServiceProvider::EnumDevices**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider::GetDeviceCount**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount)                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider2:: CreateDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice)                                                         | facoltativo. Questo metodo deve essere implementato per il supporto PnP e per il supporto di Esplora risorse.                                                                                                                                                                    |
| [**IMDSPDevice::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-enumstorage)                                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetDeviceIcon**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon)                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetFormatSupport**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getformatsupport)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice:: GetManufacturer**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer)                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice:: GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getname)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetPowerSource**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getpowersource)                                                                     | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPDevice:: GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getserialnumber)                                                                   | facoltativo. Per il trasferimento di contenuti protetti, Windows Media Gestione dispositivi usa **IMDSPStorageGlobals:: GetSerialNumber**.                                                                                                                              |
| [**IMDSPDevice:: GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getstatus)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice:: GetType**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-gettype)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice:: GetVersion**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getversion)                                                                             | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand)                                                               | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2:: GetCanonicalName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname)                                                               | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetFormatSupport2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice2::GetSpecifyPropertyPages**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages)                                                 | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2:: GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getstorage)                                                                           | facoltativo.                                                                                                                                                                                                                                          |
| [**Interfaccia IMDSPDeviceControl**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol)                                                                            | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPEnumDevice:: Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-clone)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice:: Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-next)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice:: Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-reset)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice:: Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-skip)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage:: Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-clone)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage:: Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-next)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage:: Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-reset)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage:: Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-skip)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject:: Close**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-close)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::D Elimina**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-delete)                                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject:: Move**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-move)                                                                                         | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPObject:: Open**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-open)                                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject:: Read**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-read)                                                                                         | Obbligatorio (se si desidera il supporto di Windows Media Player).                                                                                                                                                                                            |
| [**IMDSPObject:: Rename**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-rename)                                                                                     | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPObject:: Seek**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-seek)                                                                                         | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPObject:: Write**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-write)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**Interfaccia IMDSPObjectInfo**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo)                                                                                  | facoltativo.                                                                                                                                                                                                                                          |
| [**Interfaccia IMDSPRevoked**](/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked)                                                                                        | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPStorage:: CreateStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-createstorage)                                                                     | Obbligatorio solo se *dwAttributes* è WMDM \_ file \_ attr \_ .                                                                                                                                                                                        |
| [**IMDSPStorage::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-enumstorage)                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage:: GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getattributes)                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage:: GETDATE**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getdate)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage:: GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getname)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage:: getrights**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getrights)                                                                             | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPStorage:: GetSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getsize)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetStorageGlobals**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::SendOpaqueCommands**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand)                                                           | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPStorage:: SetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-setattributes)                                                                     | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::CreateStorage2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-createstorage2)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getattributes2)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2:: GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getstorage)                                                                         | facoltativo.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::SetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-setattributes2)                                                                 | facoltativo.                                                                                                                                                                                                                                          |
| [**Interfaccia IMDSPStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3)                                                                                      | facoltativo. Tuttavia, se il parametro di dispositivo *UseMetadataViews* è impostato su 1, questa interfaccia deve essere implementata e **IMDSPStorage3:: GetMetadata** diventa obbligatoria, anche se **IMDSPStorage3:: i metadati** sono ancora facoltativi.                    |
| [**IMDSPStorageGlobals:: GetCapabilities**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities)                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals:: GetDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetRootStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage)                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals:: GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber)                                                   | Obbligatorio solo per PDDRM. In caso contrario, facoltativo.                                                                                                                                                                                                      |
| [**IMDSPStorageGlobals:: GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalBad**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad)                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalFree**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals:: GetTotalSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals:: Initialize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-initialize)                                                             | facoltativo. Questo metodo deve essere implementato se il dispositivo supporta questa funzionalità. Se questo metodo non è implementato, **IMDSPStorageGlobals:: GetCapabilites** deve restituire WMDM \_ STORAGECAP \_ Not \_ Metodo Add inizializzabile oltre agli altri flag. |
| [](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)[**IMDSPObject2** IMDSPDevice3](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)<br/> [**IMDSPStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4)<br/> | Necessaria per supportare la sincronizzazione automatica con Windows Media Player                                                                                                                                                                            |



 

## <a name="related-topics"></a>Argomenti correlati

<dl> <dt>

[**Creazione di un provider di servizi**](creating-a-service-provider.md)
</dt> </dl>

 

 





