---
description: Le applicazioni che utilizzano oggetti CAPICOM devono essere create utilizzando CAPICOM.dll. Per usare gli oggetti CAPICOM, è inoltre necessario che il CAPICOM.dll sia presente e registrato in fase di esecuzione.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Preparazione all'uso di CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106316169"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="72027-104">Preparazione all'uso di CAPICOM</span><span class="sxs-lookup"><span data-stu-id="72027-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="72027-105">\[CAPICOM è un componente solo a 32 bit disponibile per l'uso nei sistemi operativi seguenti: Windows Server 2008, Windows Vista e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="72027-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="72027-106">Usare invece il .NET Framework per implementare le funzionalità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="72027-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="72027-107">Per altre informazioni, vedere [alternative all'uso di CAPICOM](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="72027-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="72027-108">Le applicazioni che utilizzano oggetti CAPICOM devono essere create utilizzando CAPICOM.dll.</span><span class="sxs-lookup"><span data-stu-id="72027-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="72027-109">Per usare gli oggetti CAPICOM, è inoltre necessario che il CAPICOM.dll sia presente e registrato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="72027-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="72027-110">È necessario aggiungere CAPICOM.dll ai riferimenti ai progetti Visual Basic per usare oggetti CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="72027-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="72027-111">CAPICOM è disponibile come file ridistribuibile che può essere scaricato da [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span><span class="sxs-lookup"><span data-stu-id="72027-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="72027-112">Per informazioni sulle versioni di CAPICOM, vedere [versioni di CAPICOM](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="72027-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="72027-113">**Per registrare CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="72027-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="72027-114">Al prompt dei comandi, passare alla directory in cui è archiviato CAPICOM.dll, quindi immettere il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="72027-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="72027-115">**regsvr32 CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="72027-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="72027-116">Limitazioni del codice di esempio</span><span class="sxs-lookup"><span data-stu-id="72027-116">Example Code Limitations</span></span>

<span data-ttu-id="72027-117">Per fornire codice più conciso e leggibile, i principi delle procedure di programmazione valide non sono sempre seguiti in questi esempi.</span><span class="sxs-lookup"><span data-stu-id="72027-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="72027-118">In particolare, vengono visualizzate solo le risposte di errore limitate.</span><span class="sxs-lookup"><span data-stu-id="72027-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="72027-119">Le applicazioni in funzione devono sempre controllare i codici di errore restituiti ed eseguire le azioni appropriate quando viene rilevato un errore.</span><span class="sxs-lookup"><span data-stu-id="72027-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="72027-120">Contenitori chiave, chiavi e certificati necessari in CAPICOM</span><span class="sxs-lookup"><span data-stu-id="72027-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="72027-121">Mentre alcune operazioni con oggetti CAPICOM possono essere eseguite su qualsiasi computer da qualsiasi utente, la creazione di [*firme digitali*](../secgloss/d-gly.md) e il recupero del contenuto di testo non crittografato di un messaggio in busta con oggetti CAPICOM sono operazioni basate sui certificati.</span><span class="sxs-lookup"><span data-stu-id="72027-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="72027-122">L'utente che crea una firma digitale e l'utente che recupera il contenuto crittografato di un messaggio in busta digitale deve disporre di un certificato digitale con una chiave privata associata disponibile.</span><span class="sxs-lookup"><span data-stu-id="72027-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="72027-123">Se non è presente un certificato con una chiave privata associata, l'operazione di crittografia avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="72027-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="72027-124">Gli utenti di applicazioni CAPICOM devono assicurarsi che dispongano del certificato appropriato e della chiave privata disponibile quando le applicazioni sono in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="72027-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="72027-125">Alcuni esempi nelle sezioni seguenti eseguono operazioni che richiedono una coppia di [*chiavi pubblica/privata*](../secgloss/p-gly.md) disponibile per la crittografia e la decrittografia di file, messaggi e firme.</span><span class="sxs-lookup"><span data-stu-id="72027-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="72027-126">Molti di questi programmi verranno compilati ed eseguiti ma avranno esito negativo in fase di esecuzione senza la presenza di [*contenitori*](../secgloss/k-gly.md)di chiavi, chiavi, archivi certificati e [*certificati*](../secgloss/c-gly.md) appropriati in tali archivi.</span><span class="sxs-lookup"><span data-stu-id="72027-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="72027-127">**Per creare un certificato autofirmato**</span><span class="sxs-lookup"><span data-stu-id="72027-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="72027-128">Installare gli strumenti di firma.</span><span class="sxs-lookup"><span data-stu-id="72027-128">Install the signing tools.</span></span> <span data-ttu-id="72027-129">Questi componenti vengono installati come parte di Microsoft Windows Software Development Kit (SDK), Platform Software Development Kit (SDK) o SDK .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="72027-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="72027-130">Dopo aver scaricato Makecert.exe, eseguire il comando seguente al prompt dei comandi, sostituendo nome utente per nome *utente,* nome organizzazione per *OrganizationName* e nome della società per *CompanyName*:</span><span class="sxs-lookup"><span data-stu-id="72027-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="72027-131">**makecert-r-n "CN =**_username_*_, ou =_*_OrganizationName_*_, o =_*_CompanyName_*_"-SS My_*</span><span class="sxs-lookup"><span data-stu-id="72027-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="72027-132">Il certificato può essere inserito nell'archivio personale dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="72027-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="72027-133">Importare il certificato creato nell'archivio radice in modo che sia attendibile.</span><span class="sxs-lookup"><span data-stu-id="72027-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
