---
description: Il timestamp Authenticode è basato su controfirma standard PKCS \# 7. Gli strumenti di firma di Microsoft consentono agli sviluppatori di apporre timestamp contemporaneamente all'applicazione delle firme Authenticode.
ms.assetid: d0bd3e2f-1eee-4f71-9467-974994f720d5
title: Timestamp delle firme Authenticode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0232853441d2c11d331c175ac7e8dfd120b341ff
ms.sourcegitcommit: dc2f43e0f23f4a4ce239118cf9a5180f3ff0dd1d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/30/2021
ms.locfileid: "108327186"
---
# <a name="time-stamping-authenticode-signatures"></a><span data-ttu-id="a0c26-104">Timestamp delle firme Authenticode</span><span class="sxs-lookup"><span data-stu-id="a0c26-104">Time Stamping Authenticode Signatures</span></span>

<span data-ttu-id="a0c26-105">Le firme Microsoft Authenticode forniscono garanzie di autorizzazione e integrità per i dati binari.</span><span class="sxs-lookup"><span data-stu-id="a0c26-105">Microsoft Authenticode signatures provide authorship and integrity guarantees for binary data.</span></span> <span data-ttu-id="a0c26-106">Il timestamp Authenticode si basa sulle controfirma standard PKCS \# 7.</span><span class="sxs-lookup"><span data-stu-id="a0c26-106">Authenticode time stamping is based on standard PKCS \#7 countersignatures.</span></span> <span data-ttu-id="a0c26-107">Gli strumenti di firma di Microsoft consentono agli sviluppatori di apporre timestamp contemporaneamente all'applicazione delle firme Authenticode.</span><span class="sxs-lookup"><span data-stu-id="a0c26-107">Signing tools from Microsoft allow developers to affix time stamps at the same time as they affix Authenticode signatures.</span></span> <span data-ttu-id="a0c26-108">Il timestamp consente la verifica delle firme Authenticode anche dopo la scadenza dei certificati usati per la firma.</span><span class="sxs-lookup"><span data-stu-id="a0c26-108">Time stamping allows Authenticode signatures to be verifiable even after the certificates used for signature have expired.</span></span>

## <a name="a-brief-introduction-to-authenticode"></a><span data-ttu-id="a0c26-109">Breve introduzione a Authenticode</span><span class="sxs-lookup"><span data-stu-id="a0c26-109">A Brief Introduction to Authenticode</span></span>

<span data-ttu-id="a0c26-110">[*Authenticode applica*](../secgloss/a-gly.md) la tecnologia di firma digitale per garantire l'autore e l'integrità dei dati binari, ad esempio software installabile.</span><span class="sxs-lookup"><span data-stu-id="a0c26-110">[*Authenticode*](../secgloss/a-gly.md) applies digital signature technology to guarantee the authorship and integrity of binary data such as installable software.</span></span> <span data-ttu-id="a0c26-111">Un Web browser client o altri componenti di sistema possono usare le firme Authenticode per verificare l'integrità dei dati quando il software viene scaricato o installato.</span><span class="sxs-lookup"><span data-stu-id="a0c26-111">A client web browser, or other system components, can use the Authenticode signatures to verify the integrity of the data when the software is downloaded or installed.</span></span> <span data-ttu-id="a0c26-112">Le firme Authenticode possono essere usate con molti formati software, tra cui cab, exe, ocx e dll.</span><span class="sxs-lookup"><span data-stu-id="a0c26-112">Authenticode signatures can be used with many software formats, including .cab, .exe, .ocx, and .dll.</span></span>

<span data-ttu-id="a0c26-113">Microsoft gestisce un elenco di autorità [*di*](/security/trusted-root/participants-list) certificazione (CA) pubbliche.</span><span class="sxs-lookup"><span data-stu-id="a0c26-113">Microsoft maintains a list of public [*certification authorities*](/security/trusted-root/participants-list) (CAs).</span></span> <span data-ttu-id="a0c26-114">Le autorità di certificazione dei certificati Authenticode attualmente [includono SSL.com](https://www.ssl.com/), [Digicert](https://www.digicert.com/), [Sectigo(Comodo)](https://www.sectigo.com/)e [GlobalSign](https://www.globalsign.com/).</span><span class="sxs-lookup"><span data-stu-id="a0c26-114">Issuers of Authenticode certificates currently include [SSL.com](https://www.ssl.com/), [Digicert](https://www.digicert.com/), [Sectigo(Comodo)](https://www.sectigo.com/), and [GlobalSign](https://www.globalsign.com/).</span></span>

## <a name="about-cryptographic-time-stamping"></a><span data-ttu-id="a0c26-115">Informazioni sull'timestamp crittografico</span><span class="sxs-lookup"><span data-stu-id="a0c26-115">About Cryptographic Time Stamping</span></span>

<span data-ttu-id="a0c26-116">In passato sono stati proposti diversi metodi di timestamp crittografici.</span><span class="sxs-lookup"><span data-stu-id="a0c26-116">In the past, a variety of cryptographic time stamping methods have been proposed.</span></span> <span data-ttu-id="a0c26-117">Vedere, ad esempio, Haber e Stornetta "Come Time-Stamp un documento digitale" nel *Journal of Cryptology* (1991) e Benaloh e de Mare "One-Way Accumulators: A Decentralized Alternative to Digital Signatures" in *Springer-Verlag Lecture Notes in Computer Science* vol. 765 (EUROCRYPT '93).</span><span class="sxs-lookup"><span data-stu-id="a0c26-117">See, for example, Haber and Stornetta "How to Time-Stamp a Digital Document" in the *Journal of Cryptology* (1991) and Benaloh and de Mare "One-Way Accumulators: A Decentralized Alternative to Digital Signatures" in *Springer-Verlag Lecture Notes in Computer Science* vol. 765 (EUROCRYPT '93).</span></span> <span data-ttu-id="a0c26-118">Un astratto esteso di questo articolo è disponibile in [Microsoft Research.](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a)</span><span class="sxs-lookup"><span data-stu-id="a0c26-118">An extended abstract of this article is available from [Microsoft Research](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a).</span></span> <span data-ttu-id="a0c26-119">Queste risorse potrebbero non essere disponibili in alcune lingue, paesi o aree geografiche. Poiché il tempo è una quantità fisica, anziché matematica, questi metodi in genere riguardano come collegare gli oggetti in modo che sia possibile determinarne l'ordine di creazione o come raggruppare in modo efficiente gli oggetti che possono essere tutti descritti come creati contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="a0c26-119">(These resources may not be available in some languages and countries or regions.) Because time is a physical, rather than a mathematical, quantity, these methods generally concern how to link objects so that their order of creation can be determined or how to efficiently group objects that can all be described as having been created concurrently.</span></span>

<span data-ttu-id="a0c26-120">I sistemi che richiedono l'autenticazione del tempo come quantità richiedono sempre una qualche forma di attendibilità.</span><span class="sxs-lookup"><span data-stu-id="a0c26-120">Systems that purport to authenticate time as a quantity always require some form of trust.</span></span> <span data-ttu-id="a0c26-121">In un'impostazione fortemente antagonismo, è possibile usare protocolli complessi per garantire un certo grado di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="a0c26-121">In a strongly adversarial setting, complex protocols can be used to ensure some degree of synchrony.</span></span> <span data-ttu-id="a0c26-122">Tuttavia, questi protocolli richiedono un'interazione estesa tra le parti interessate.</span><span class="sxs-lookup"><span data-stu-id="a0c26-122">However, these protocols require extensive interaction between affected parties.</span></span> <span data-ttu-id="a0c26-123">In pratica, se è richiesta solo la certificazione del tempo da un'origine attendibile, l'origine può fungere semplicemente da notario fornendo un'istruzione firmata (certificazione) che indica che l'oggetto è stato presentato per la firma all'ora indicata.</span><span class="sxs-lookup"><span data-stu-id="a0c26-123">In practice, if one only needs certification of time from a trusted source, the source can simply act as a notary by providing a signed statement (certification) that the object was presented for signature at the indicated time.</span></span>

<span data-ttu-id="a0c26-124">Il metodo di controfirma di timestamp implementato di seguito consente di verificare le firme anche dopo che il certificato di firma è scaduto o è stato revocato.</span><span class="sxs-lookup"><span data-stu-id="a0c26-124">The countersignature method of time stamping implemented below allows for signatures to be verified even after the signing certificate has expired or been revoked.</span></span> <span data-ttu-id="a0c26-125">Il timestamp consente al verificatore di conoscere in modo affidabile l'ora in cui la firma è stata affissa e quindi considera attendibile la firma se era valida in quel momento.</span><span class="sxs-lookup"><span data-stu-id="a0c26-125">The time stamp allows the verifier to reliably know the time that the signature was affixed and thereby trust the signature if it was valid at that time.</span></span> <span data-ttu-id="a0c26-126">L'indicatore di data e ora deve avere un'origine ora affidabile e protetta.</span><span class="sxs-lookup"><span data-stu-id="a0c26-126">The time stamper should have a reliable and protected time source.</span></span>

## <a name="pkcs-7-signed-documents-and-countersignatures"></a><span data-ttu-id="a0c26-127">Documenti e controfirma pkcs \# 7 firmati</span><span class="sxs-lookup"><span data-stu-id="a0c26-127">PKCS \#7 Signed Documents and Countersignatures</span></span>

<span data-ttu-id="a0c26-128">PKCS 7 è un formato standard per i dati crittografici, inclusi i dati firmati, i certificati e gli elenchi \# di [*revoche*](../secgloss/c-gly.md) di certificati (CRL).</span><span class="sxs-lookup"><span data-stu-id="a0c26-128">PKCS \#7 is a standard format for cryptographic data, including signed data, certificates, and [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs).</span></span> <span data-ttu-id="a0c26-129">Il particolare tipo di interesse PKCS 7 nel contesto del timestamp è dato da dati firmati, corrispondenti al tipo di contenuto \# SignedData definito da PKCS \# 7. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-129">The particular PKCS \#7 type of interest in the context of time stamping is signed data, corresponding to the PKCS \#7 defined [**SignedData**](signeddata.md) content type.</span></span>

<span data-ttu-id="a0c26-130">Il pacchetto PKCS 7 è costituito da SignedData che identifica il contenuto effettivo e alcune informazioni su di esso e \# i blocchi di firma SignerInfo. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-130">The PKCS \#7 package consists of [**SignedData**](signeddata.md) that identifies the actual content and certain information about it and SignerInfo signature blocks.</span></span> <span data-ttu-id="a0c26-131">Un SignerInfo può contenere una controfirma, che in modo ricorsivo è un altro SignerInfo.</span><span class="sxs-lookup"><span data-stu-id="a0c26-131">A SignerInfo may itself contain a countersignature, which recursively is another SignerInfo.</span></span> <span data-ttu-id="a0c26-132">In linea di principio, può essere presente una sequenza di tali controfirma.</span><span class="sxs-lookup"><span data-stu-id="a0c26-132">In principle, a sequence of such countersignatures may be present.</span></span> <span data-ttu-id="a0c26-133">La controfirma è un attributo non autenticato rispetto alla firma in SignerInfo. ciò significa che può essere apposta successivamente alla firma originale.</span><span class="sxs-lookup"><span data-stu-id="a0c26-133">The countersignature is an unauthenticated attribute with respect to the signature in the SignerInfo; that is, it may be affixed subsequent to the original signature.</span></span> <span data-ttu-id="a0c26-134">Sotto forma di struttura:</span><span class="sxs-lookup"><span data-stu-id="a0c26-134">In outline form:</span></span>

<span data-ttu-id="a0c26-135">[**SignedData**](signeddata.md) (PKCS \# 7)</span><span class="sxs-lookup"><span data-stu-id="a0c26-135">[**SignedData**](signeddata.md) (PKCS \#7)</span></span>

-   <span data-ttu-id="a0c26-136">Versione (pkcs \# 7, in genere versione 1)</span><span class="sxs-lookup"><span data-stu-id="a0c26-136">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="a0c26-137">DigestAlgorithms (raccolta di tutti gli algoritmi usati dai blocchi di firma SignerInfo, per l'elaborazione ottimizzata)</span><span class="sxs-lookup"><span data-stu-id="a0c26-137">DigestAlgorithms (collection of all algorithms used by SignerInfo signature blocks, for optimized processing)</span></span>
-   <span data-ttu-id="a0c26-138">ContentInfo (contentType è uguale a [**SignedData,**](signeddata.md)oltre al contenuto o al riferimento al contenuto)</span><span class="sxs-lookup"><span data-stu-id="a0c26-138">ContentInfo (contentType equals [**SignedData**](signeddata.md), plus content or reference to content)</span></span>
-   <span data-ttu-id="a0c26-139">CERTIFICATI FACOLTATIVI (raccolta di tutti i certificati usati)</span><span class="sxs-lookup"><span data-stu-id="a0c26-139">OPTIONAL Certificates (collection of all certificates used)</span></span>
-   <span data-ttu-id="a0c26-140">CRL FACOLTATIVI (raccolta di tutti i CRL)</span><span class="sxs-lookup"><span data-stu-id="a0c26-140">OPTIONAL CRLs (collection of all CRLs)</span></span>
-   <span data-ttu-id="a0c26-141">Blocchi di firma SignerInfo (la firma effettiva, composta da uno o più blocchi di firma SignerInfo)</span><span class="sxs-lookup"><span data-stu-id="a0c26-141">SignerInfo signature blocks (the actual signature, composed of one or more SignerInfo signature blocks)</span></span>

<span data-ttu-id="a0c26-142">SignerInfo (blocco di firma)</span><span class="sxs-lookup"><span data-stu-id="a0c26-142">SignerInfo (the signature block)</span></span>

-   <span data-ttu-id="a0c26-143">Versione (pkcs \# 7, in genere versione 1)</span><span class="sxs-lookup"><span data-stu-id="a0c26-143">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="a0c26-144">Certificato (autorità emittente e numero di serie per identificare in modo univoco il certificato del firmatario in [**SignedData)**](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-144">Certificate (issuer and serial number to uniquely identify of signer's certificate in [**SignedData**](signeddata.md))</span></span>
-   <span data-ttu-id="a0c26-145">DigestAlgorithm più DigestEncryptionAlgorithm più digest (hash), più EncryptedDigest (firma effettiva)</span><span class="sxs-lookup"><span data-stu-id="a0c26-145">DigestAlgorithm plus the DigestEncryptionAlgorithm plus the Digest (hash), plus the EncryptedDigest (actual signature)</span></span>
-   <span data-ttu-id="a0c26-146">OPTIONAL AuthenticatedAttributes (ad esempio, firmato da questo firmatario)</span><span class="sxs-lookup"><span data-stu-id="a0c26-146">OPTIONAL AuthenticatedAttributes (for example, signed by this signer)</span></span>
-   <span data-ttu-id="a0c26-147">OPTIONAL UnauthenticatedAttributes (ad esempio, non firmato da questo firmatario)</span><span class="sxs-lookup"><span data-stu-id="a0c26-147">OPTIONAL UnauthenticatedAttributes (for example, not signed by this signer)</span></span>

<span data-ttu-id="a0c26-148">Un esempio di attributo autenticato è l'ora di firma (OID 1.2.840.113549.1.9.5) perché fa parte di ciò che il servizio timestamp firma.</span><span class="sxs-lookup"><span data-stu-id="a0c26-148">An example of an authenticated attribute is the signing time (OID 1.2.840.113549.1.9.5) because it is part of what the time stamp service signs.</span></span> <span data-ttu-id="a0c26-149">Un esempio di attributo non autenticato è la controfirma (OID 1.2.840.113549.1.9.6) perché può essere apposta dopo la firma.</span><span class="sxs-lookup"><span data-stu-id="a0c26-149">An example of an unauthenticated attribute is the countersignature (OID 1.2.840.113549.1.9.6) because it can be affixed after signing.</span></span> <span data-ttu-id="a0c26-150">In questo caso, SignerInfo contiene un SignerInfo (controfirma).</span><span class="sxs-lookup"><span data-stu-id="a0c26-150">In this case, the SignerInfo itself contains a SignerInfo (the Countersignature).</span></span>

> [!Note]  
> <span data-ttu-id="a0c26-151">L'oggetto firmato nella controfirma è la firma originale, ovvero EncryptedDigest dell'oggetto SignerInfo originale.</span><span class="sxs-lookup"><span data-stu-id="a0c26-151">The object that is signed in the countersignature is the original signature (that is, the EncryptedDigest of the original SignerInfo).</span></span>

 

## <a name="signtool-and-the-authenticode-process"></a><span data-ttu-id="a0c26-152">SignTool e processo Authenticode</span><span class="sxs-lookup"><span data-stu-id="a0c26-152">SignTool and the Authenticode Process</span></span>

<span data-ttu-id="a0c26-153">[SignTool è](signtool.md) disponibile per la firma Authenticode e l'applicazione di timestamp ai dati binari.</span><span class="sxs-lookup"><span data-stu-id="a0c26-153">[SignTool](signtool.md) is available for Authenticode signing and time stamping binary data.</span></span> <span data-ttu-id="a0c26-154">Lo strumento viene installato nella cartella Bin del percorso di \\ installazione di Microsoft Windows Software Development Kit (Windows SDK) (SDK).</span><span class="sxs-lookup"><span data-stu-id="a0c26-154">The tool is installed in the \\Bin folder of the Microsoft Windows Software Development Kit (SDK) installation path.</span></span>

<span data-ttu-id="a0c26-155">La firma e l'applicazione di timestamp ai dati binari sono relativamente semplici tramite [SignTool.](signtool.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-155">Signing and time stamping binary data is relatively straightforward using [SignTool](signtool.md).</span></span> <span data-ttu-id="a0c26-156">L'editore deve ottenere un certificato di firma del codice da una CA per la firma di codice commerciale.</span><span class="sxs-lookup"><span data-stu-id="a0c26-156">The publisher must get a code signing certificate from a commercial code signing CA.</span></span> <span data-ttu-id="a0c26-157">Per praticità, Microsoft pubblica e aggiorna un elenco di CA pubbliche, incluse quelle che emettere certificati Authenticode.</span><span class="sxs-lookup"><span data-stu-id="a0c26-157">For convenience, Microsoft publishes and updates a list of public CAs, including those that issue Authenticode certificates.</span></span> <span data-ttu-id="a0c26-158">Quando si è pronti per la pubblicazione, i file oggetto vengono firmati e con timestamp usando i parametri della riga di comando appropriati con lo strumento SignTool.</span><span class="sxs-lookup"><span data-stu-id="a0c26-158">When ready to publish, the object files are signed and time stamped using appropriate command line parameters with the SignTool tool.</span></span> <span data-ttu-id="a0c26-159">Il risultato di qualsiasi operazione SignTool è sempre un formato PKCS \# 7 [**SignedData.**](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-159">The result of any SignTool operation is always a PKCS \#7 format [**SignedData**](signeddata.md).</span></span>

<span data-ttu-id="a0c26-160">SignTool accetta come input i dati binari non elaborati da firmare e con timestamp oppure i dati binari firmati in precedenza da inserire nel timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-160">SignTool accepts as input either raw binary data to be signed and time stamped, or previously signed binary data to be time stamped.</span></span> <span data-ttu-id="a0c26-161">I dati firmati in precedenza possono essere contrassegnati con un timestamp usando il **comando signtool timestamp.**</span><span class="sxs-lookup"><span data-stu-id="a0c26-161">Data that has previously been signed can be time stamped by using the **signtool timestamp** command.</span></span>



| <span data-ttu-id="a0c26-162">Argomento</span><span class="sxs-lookup"><span data-stu-id="a0c26-162">Argument</span></span>             | <span data-ttu-id="a0c26-163">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a0c26-163">Description</span></span>                                                                                                                                                                                                    |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a0c26-164">**/t** *HTTPAddress*</span><span class="sxs-lookup"><span data-stu-id="a0c26-164">**/t** *HTTPAddress*</span></span> | <span data-ttu-id="a0c26-165">Indica che il file deve essere contrassegnato con un timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-165">Indicates that the file is to be time stamped.</span></span> <span data-ttu-id="a0c26-166">È necessario specificare un URL che specifica l'indirizzo di un server di timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-166">A URL that specifies an address of a time stamping server must be provided.</span></span> <span data-ttu-id="a0c26-167">**/t può** essere usato con i **comandi signtool sign e** **signtool timestamp.**</span><span class="sxs-lookup"><span data-stu-id="a0c26-167">**/t** can be used with both **signtool sign** and **signtool timestamp** commands.</span></span> |



 

<span data-ttu-id="a0c26-168">Per altre informazioni sugli strumenti che possono essere utili in questo contesto, vedere [Strumenti di crittografia](cryptography-tools.md) e [SignTool.](signtool.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-168">For more information about tools that may be useful in this context, see [Cryptography Tools](cryptography-tools.md) and [SignTool](signtool.md).</span></span>

## <a name="implementation-details-and-wire-format"></a><span data-ttu-id="a0c26-169">Dettagli di implementazione e formato wire</span><span class="sxs-lookup"><span data-stu-id="a0c26-169">Implementation Details and Wire Format</span></span>

<span data-ttu-id="a0c26-170">[SignTool](signtool.md) si basa sull'implementazione di Windows Authenticode per creare firme e timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-170">[SignTool](signtool.md) relies on the Windows Authenticode implementation to create and time stamp signatures.</span></span> <span data-ttu-id="a0c26-171">[*Authenticode*](../secgloss/a-gly.md) opera su file binari, ad esempio cab, exe, dll o ocx.</span><span class="sxs-lookup"><span data-stu-id="a0c26-171">[*Authenticode*](../secgloss/a-gly.md) operates on binary files, for example .cab, .exe, .dll, or .ocx.</span></span> <span data-ttu-id="a0c26-172">Authenticode crea prima la firma, producendo un \# [**signedData**](signeddata.md)PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="a0c26-172">Authenticode first creates the signature, producing a PKCS \#7 [**SignedData**](signeddata.md).</span></span> <span data-ttu-id="a0c26-173">È questo **SignedData che** deve essere controfirmato, come descritto in PKCS \# 9.</span><span class="sxs-lookup"><span data-stu-id="a0c26-173">It is this **SignedData** that must be countersigned, as described in PKCS \#9.</span></span>

<span data-ttu-id="a0c26-174">Il processo di controfirma si svolge in quattro passaggi:</span><span class="sxs-lookup"><span data-stu-id="a0c26-174">The countersignature process takes place in four steps:</span></span>

1.  <span data-ttu-id="a0c26-175">Copiare la firma ( ovvero encryptedDigest) da SignerInfo di PKCS \# 7 [**SignedData**](signeddata.md).</span><span class="sxs-lookup"><span data-stu-id="a0c26-175">Copy the signature (that is, the encryptedDigest) from the SignerInfo of the PKCS \#7 [**SignedData**](signeddata.md).</span></span>
2.  <span data-ttu-id="a0c26-176">Costruire una richiesta timestamp il cui contenuto è la firma originale.</span><span class="sxs-lookup"><span data-stu-id="a0c26-176">Construct a time stamp request whose content is the original signature.</span></span> <span data-ttu-id="a0c26-177">Inviarlo al server di timestamp [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) codificato come TimeStampRequest.</span><span class="sxs-lookup"><span data-stu-id="a0c26-177">Send this to the time stamp server [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) encoded as a TimeStampRequest.</span></span>
3.  <span data-ttu-id="a0c26-178">Ricevere un timestamp, formattato come secondo PKCS \# 7 [**SignedData,**](signeddata.md)restituito dal server di timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-178">Receive a time stamp, formatted as a second PKCS \#7 [**SignedData**](signeddata.md), returned from the time stamp server.</span></span>
4.  <span data-ttu-id="a0c26-179">Copiare SignerInfo dal timestamp direttamente nell'oggetto SignedData PKCS 7 originale \# come controfirma PKCS 9, ovvero un attributo non autenticato nel [](signeddata.md) \# SignerInfo dell'originale.</span><span class="sxs-lookup"><span data-stu-id="a0c26-179">Copy the SignerInfo from the time stamp directly into the original PKCS \#7 [**SignedData**](signeddata.md), as a PKCS \#9 countersignature (that is, an unauthenticated attribute in the SignerInfo of the original).</span></span>

## <a name="time-stamp-request"></a><span data-ttu-id="a0c26-180">Richiesta timestamp</span><span class="sxs-lookup"><span data-stu-id="a0c26-180">Time Stamp Request</span></span>

<span data-ttu-id="a0c26-181">La richiesta timestamp viene inviata all'interno di un messaggio POST HTTP 1.1.</span><span class="sxs-lookup"><span data-stu-id="a0c26-181">The time stamp request is sent within an HTTP 1.1 POST message.</span></span> <span data-ttu-id="a0c26-182">Nell'intestazione HTTP la direttiva CacheControl è impostata su no-cache e la direttiva Content-Type è impostata su application/octet-stream.</span><span class="sxs-lookup"><span data-stu-id="a0c26-182">In the HTTP header, the CacheControl directive is set to no-cache, and the Content-Type directive is set to application/octet-stream.</span></span> <span data-ttu-id="a0c26-183">Il corpo del messaggio HTTP è una codifica base64 [*della codifica Distinguished Encoding Rules*](../secgloss/d-gly.md) (DER) della richiesta di timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-183">The body of the HTTP message is a base64 encoding of [*Distinguished Encoding Rules*](../secgloss/d-gly.md) (DER) encoding of the time stamp request.</span></span>

<span data-ttu-id="a0c26-184">Sebbene non sia attualmente usata, la direttiva Content-Length deve essere usata anche per costruire il messaggio HTTP perché consente al server di timestamp di individuare la posizione della richiesta all'interno di HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="a0c26-184">Although not currently used, the Content-Length directive should also be used in constructing the HTTP message because it helps the time stamp server locate where the request is within the HTTP POST.</span></span>

<span data-ttu-id="a0c26-185">Possono essere presenti anche altre intestazioni HTTP e devono essere ignorate se non sono comprese dal richiedente o dal server di timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-185">Other HTTP headers may also be present and should be ignored if they are not understood by the requestor or time stamp server.</span></span>

<span data-ttu-id="a0c26-186">La richiesta di timestamp è un messaggio con codifica ASN.1.</span><span class="sxs-lookup"><span data-stu-id="a0c26-186">The time stamp request is an ASN.1 encoded message.</span></span> <span data-ttu-id="a0c26-187">Il formato della richiesta è il seguente.</span><span class="sxs-lookup"><span data-stu-id="a0c26-187">The format of the request is as follows.</span></span>

``` syntax
TimeStampRequest ::= SEQUENCE {
   countersignatureType OBJECT IDENTIFIER,
   attributes Attributes OPTIONAL, 
   content  ContentInfo
}
```

<span data-ttu-id="a0c26-188">CountersignatureType è [](../secgloss/o-gly.md) l'identificatore di oggetto (OID) che identifica l'oggetto come controfirma di timestamp e deve essere l'OID esatto 1.3.6.1.4.1.311.3.2.1.</span><span class="sxs-lookup"><span data-stu-id="a0c26-188">The countersignatureType is the [*object identifier*](../secgloss/o-gly.md) (OID) that identifies this as a time stamp countersignature and should be the exact OID 1.3.6.1.4.1.311.3.2.1.</span></span>

<span data-ttu-id="a0c26-189">Nessun attributo è attualmente incluso nella richiesta di timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-189">No attributes are currently included in the time stamp request.</span></span>

<span data-ttu-id="a0c26-190">Il contenuto è un contentInfo come definito da PKCS \# 7.</span><span class="sxs-lookup"><span data-stu-id="a0c26-190">The content is a ContentInfo as defined by PKCS \#7.</span></span> <span data-ttu-id="a0c26-191">Il contenuto è i dati da firmare.</span><span class="sxs-lookup"><span data-stu-id="a0c26-191">The content is the data to be signed.</span></span> <span data-ttu-id="a0c26-192">Per il timestamp della firma, ContentType deve essere Data e il contenuto deve essere encryptedDigest (firma) dal SignerInfo del contenuto PKCS 7 da impostare come \# timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-192">For signature time stamping, the ContentType should be Data, and the content should be the encryptedDigest (signature) from the SignerInfo of the PKCS \#7 content to be time stamped.</span></span>

## <a name="time-stamp-response"></a><span data-ttu-id="a0c26-193">Risposta timestamp</span><span class="sxs-lookup"><span data-stu-id="a0c26-193">Time Stamp Response</span></span>

<span data-ttu-id="a0c26-194">La risposta del timestamp viene inviata anche all'interno di un messaggio HTTP 1.1.</span><span class="sxs-lookup"><span data-stu-id="a0c26-194">The time stamp response is also sent within an HTTP 1.1 message.</span></span> <span data-ttu-id="a0c26-195">Nell'intestazione HTTP la direttiva Content-Type è impostata anche su application/octet-stream.</span><span class="sxs-lookup"><span data-stu-id="a0c26-195">In the HTTP header, the Content-Type directive is also set to application/octet-stream.</span></span> <span data-ttu-id="a0c26-196">Il corpo del messaggio HTTP è una codifica base64 della codifica DER della risposta del timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-196">The body of the HTTP message is a base64 encoding of DER encoding of the time stamp response.</span></span>

<span data-ttu-id="a0c26-197">La risposta del timestamp è un messaggio firmato PKCS \# 7 firmato dall'indicatore di data e ora.</span><span class="sxs-lookup"><span data-stu-id="a0c26-197">The time stamp response is a PKCS \#7 signed message signed by the time stamper.</span></span> <span data-ttu-id="a0c26-198">L'oggetto ContentInfo del messaggio PKCS \# 7 è identico all'oggetto ContentInfo ricevuto nel timestamp.</span><span class="sxs-lookup"><span data-stu-id="a0c26-198">The ContentInfo of the PKCS \#7 message is identical to the ContentInfo received in the time stamp.</span></span> <span data-ttu-id="a0c26-199">Il contenuto PKCS 7 contiene l'attributo autenticato dell'ora di firma \# (definito in PKCS \# 99, OID 1.2.840.113549.9.5).</span><span class="sxs-lookup"><span data-stu-id="a0c26-199">The PKCS \#7 content contains the signing time authenticated attribute (defined in PKCS \#99, OID 1.2.840.113549.9.5).</span></span>

<span data-ttu-id="a0c26-200">Dopo che Authenticode ha ricevuto il timestamp dal server, lo incorpora nell'oggetto SignedData PKCS 7 originale come \# controfirma. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="a0c26-200">After Authenticode receives the time stamp from the server, Authenticode incorporates the time stamp into the original PKCS \#7 [**SignedData**](signeddata.md) as a countersignature.</span></span> <span data-ttu-id="a0c26-201">A tale scopo, l'oggetto ContentInfo dell'oggetto SignedData PKCS 7 restituito viene eliminato e l'oggetto SignerInfo del timestamp restituito viene copiato come controfirma nel SignerInfo dell'oggetto \# SignedData PKCS  \# 7 **originale.**</span><span class="sxs-lookup"><span data-stu-id="a0c26-201">To accomplish this, the ContentInfo of the returned PKCS \#7 **SignedData** is discarded, and the SignerInfo of the returned time stamp is copied as a countersignature into the SignerInfo of the original PKCS \#7 **SignedData**.</span></span> <span data-ttu-id="a0c26-202">La catena di certificati dell'indicatore di data e ora viene copiata anche in Certificati nell'oggetto SignedData PKCS 7 originale come attributo non autenticato del \# firmatario originale. </span><span class="sxs-lookup"><span data-stu-id="a0c26-202">The certificate chain of the time stamper is also copied into Certificates in the original PKCS \#7 **SignedData** as an unauthenticated attribute of the original signer.</span></span>

<span data-ttu-id="a0c26-203">Per altre informazioni su PKCS e altri argomenti relativi alla sicurezza, vedere la [raccolta contenuto del sito Web RSA](https://www.rsa.com/content_library.aspx).</span><span class="sxs-lookup"><span data-stu-id="a0c26-203">For more information about PKCS and other security subjects, see the [content library of the RSA website](https://www.rsa.com/content_library.aspx).</span></span>

 

 
