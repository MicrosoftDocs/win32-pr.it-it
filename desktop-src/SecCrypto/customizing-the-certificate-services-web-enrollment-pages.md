---
description: Servizi certificati fornisce pagine di registrazione Web che possono essere usate per richiedere i certificati.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Personalizzazione delle pagine di registrazione Web di Servizi certificati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103885073"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a><span data-ttu-id="0f1a3-103">Personalizzazione delle pagine di registrazione Web di Servizi certificati</span><span class="sxs-lookup"><span data-stu-id="0f1a3-103">Customizing Certificate Services Web Enrollment Pages</span></span>

<span data-ttu-id="0f1a3-104">[*Servizi certificati*](../secgloss/c-gly.md) fornisce pagine di registrazione Web che possono essere usate per richiedere i certificati.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-104">[*Certificate Services*](../secgloss/c-gly.md) provides web enrollment pages that can be used to request certificates.</span></span> <span data-ttu-id="0f1a3-105">Un amministratore può personalizzare alcuni elementi che possono essere visualizzati nelle pagine di registrazione Web; è tuttavia necessario acquisire familiarità con le pagine di registrazione Web e gli script Web prima di apportare qualsiasi modifica.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-105">An administrator can customize some of the items that can be viewed in the web enrollment pages; however, you should be familiar with the web enrollment pages and web scripting before making any changes.</span></span> <span data-ttu-id="0f1a3-106">Per ulteriori informazioni sugli script Web, vedere [Scripting](/previous-versions/ms950396(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-106">For more information about web scripting, see [Scripting](/previous-versions/ms950396(v=msdn.10)).</span></span>

<span data-ttu-id="0f1a3-107">I valori predefiniti per i campi del nome distinto per organizzazione, unità organizzativa, località, stato e paese/area geografica sono i valori specificati per l' [*autorità di certificazione*](../secgloss/c-gly.md) (CA) quando è installato Servizi certificati.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-107">The default values for the Distinguished Name fields for Organization, Organizational Unit, Locality, State, and Country/Region are the values specified for the [*certification authority*](../secgloss/c-gly.md) (CA) when Certificate Services is installed.</span></span> <span data-ttu-id="0f1a3-108">Questi valori predefiniti vengono visualizzati nelle pagine Web e possono essere modificati dall'utente durante il processo di registrazione del certificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-108">These default values appear in the webpages and can be changed by the user during the certificate enrollment process.</span></span> <span data-ttu-id="0f1a3-109">Tuttavia, se si desidera che vengano visualizzati altri valori predefiniti nelle pagine Web, è possibile modificare il file file Certdat. Inc (nel percorso \\ *WindowsDirectory* \\ system32 \\ certsrv \\ ); in particolare, è possibile assegnare valori personalizzati alle seguenti variabili fornite per la personalizzazione.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-109">However, if you want other default values to appear in the webpages, you can edit the Certdat.inc file (in the path \\*WindowsDirectory*\\System32\\Certsrv\\); specifically, you can assign custom values to the following variables provided for customization.</span></span>



| <span data-ttu-id="0f1a3-110">Variabile</span><span class="sxs-lookup"><span data-stu-id="0f1a3-110">Variable</span></span>            | <span data-ttu-id="0f1a3-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0f1a3-111">Description</span></span>                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0f1a3-112">sDefaultCompany</span><span class="sxs-lookup"><span data-stu-id="0f1a3-112">sDefaultCompany</span></span>     | <span data-ttu-id="0f1a3-113">Società predefinita (viene visualizzata nella [*richiesta di certificato*](../secgloss/c-gly.md) come campo dell'organizzazione [*X. 509*](../secgloss/x-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-113">Default company (appears in the [*certificate request*](../secgloss/c-gly.md) as the [*X.509*](../secgloss/x-gly.md) Organization field).</span></span> |
| <span data-ttu-id="0f1a3-114">sDefaultOrgUnit</span><span class="sxs-lookup"><span data-stu-id="0f1a3-114">sDefaultOrgUnit</span></span>     | <span data-ttu-id="0f1a3-115">Reparto predefinito (viene visualizzato nella richiesta di certificato come campo dell'unità organizzativa X. 509).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-115">Default department (appears in the certificate request as the X.509 Organizational Unit field).</span></span>                                                                                                                                           |
| <span data-ttu-id="0f1a3-116">sDefaultLocality</span><span class="sxs-lookup"><span data-stu-id="0f1a3-116">sDefaultLocality</span></span>    | <span data-ttu-id="0f1a3-117">Città predefinita (viene visualizzata nella richiesta di certificato come campo del percorso X. 509).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-117">Default city (appears in the certificate request as the X.509 Location field).</span></span>                                                                                                                                                            |
| <span data-ttu-id="0f1a3-118">sDefaultState</span><span class="sxs-lookup"><span data-stu-id="0f1a3-118">sDefaultState</span></span>       | <span data-ttu-id="0f1a3-119">Stato predefinito/provincia (visualizzato nella richiesta certificato come campo stato X. 509).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-119">Default state/province (appears in the certificate request as the X.509 State field).</span></span>                                                                                                                                                     |
| <span data-ttu-id="0f1a3-120">sDefaultCountry</span><span class="sxs-lookup"><span data-stu-id="0f1a3-120">sDefaultCountry</span></span>     | <span data-ttu-id="0f1a3-121">Paese/area geografica predefinito (visualizzato nella richiesta di certificato come campo del paese/area geografica X. 509).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-121">Default country/region (appears in the certificate request as the X.509 Country/Region field).</span></span>                                                                                                                                            |
| <span data-ttu-id="0f1a3-122">nPendingTimeoutDays</span><span class="sxs-lookup"><span data-stu-id="0f1a3-122">nPendingTimeoutDays</span></span> | <span data-ttu-id="0f1a3-123">Numero di giorni in cui l'utente può recuperare un certificato in sospeso dopo che è stato richiesto.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-123">Number of days in which the user can retrieve a pending certificate after it has been requested.</span></span>                                                                                                                                          |



 

<span data-ttu-id="0f1a3-124">Non è necessario modificare altre variabili nel file file Certdat. Inc.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-124">No other variables should be changed in the Certdat.inc file.</span></span>

<span data-ttu-id="0f1a3-125">Nell'esempio seguente viene impostata l'unità organizzativa predefinita su "marketing".</span><span class="sxs-lookup"><span data-stu-id="0f1a3-125">The following example sets the default Organizational Unit to "Marketing".</span></span>


```VB
sDefaultOrgUnit="Marketing"
```



<span data-ttu-id="0f1a3-126">Inoltre, è possibile modificare il file Certrqtp. Inc per aggiungere, modificare o rimuovere i [*modelli*](../secgloss/c-gly.md) o i tipi di certificato disponibili per l'utente.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-126">Additionally, you can edit the Certrqtp.inc file to add, change, or remove [*certificate templates*](../secgloss/c-gly.md) or types available to the user.</span></span> <span data-ttu-id="0f1a3-127">Questi modelli e tipi, nonché le informazioni correlate, sono contenuti in una matrice con dimensione denominata rgAvailReqTypes (*m*, 5).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-127">These templates and types, as well as related information, are contained in a dimensioned array called rgAvailReqTypes(*m*,5).</span></span>

<span data-ttu-id="0f1a3-128">Questa matrice, come tutte Visual Basic matrici di Scripting Edition, è basata su zero e, di conseguenza, la prima dimensione della matrice, *m*, alloca memoria per *m*+ 1 elementi.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-128">This array, like all Visual Basic Scripting Edition arrays, is zero based, and as a result, the array's first dimension, *m*, allocates memory for *m*+1 items.</span></span> <span data-ttu-id="0f1a3-129">Se quindi si personalizzano le pagine Web, è necessario modificare il numero di elementi nella matrice rgAvailReqTypes, impostare la dimensione *m* su un valore inferiore al numero totale di elementi necessari.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-129">Therefore, if in customizing the webpages, you need to modify the number of items in the rgAvailReqTypes array, set the *m* dimension to one less than the total number of items you need.</span></span> <span data-ttu-id="0f1a3-130">Se, ad esempio, si dispone di sette modelli di certificato, modificare la dichiarazione di rgAvailReqTypes come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-130">For example, if you will have seven certificate templates, change the declaration of rgAvailReqTypes as shown in the following example.</span></span>


```VB
Dim rgAvailReqTypes(6,5)
```



<span data-ttu-id="0f1a3-131">La seconda dimensione della matrice, che ha sempre il valore cinque, alloca i sei campi che compongono ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-131">The array's second dimension, which always has the value five, allocates the six fields that compose each item.</span></span> <span data-ttu-id="0f1a3-132">Questi sei campi rappresentano il modello o il tipo di certificato, il nome visualizzato associato a questo modello o tipo e se il modello richiede [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-132">These six fields represent the certificate template or type, the display name associated with this template or type, and whether the template requires [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span></span>

<span data-ttu-id="0f1a3-133">Per semplificare la comprensione dei campi a cui si accede, Certrqtp. Inc fornisce anche le costanti seguenti che è possibile usare per l'impostazione di valori di campo.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-133">To make it easier to understand which of these fields is being accessed, Certrqtp.inc also provides the following constants you can use when setting field values.</span></span>



| <span data-ttu-id="0f1a3-134">Costante</span><span class="sxs-lookup"><span data-stu-id="0f1a3-134">Constant</span></span>                              | <span data-ttu-id="0f1a3-135">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0f1a3-135">Description</span></span>                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0f1a3-136">**\_OID campo**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-136">**FIELD\_OID**</span></span>                        | <span data-ttu-id="0f1a3-137">(Si applica a CA autonome) Indicizzare il primo campo dell'elemento; rappresenta un [*identificatore di oggetto*](../secgloss/o-gly.md) (OID) per un tipo di certificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-137">(Applies to stand-alone CAs) Index to the item's first field; represents an [*object identifier*](../secgloss/o-gly.md) (OID) for a certificate type.</span></span><br/>                                                                                                           |
| <span data-ttu-id="0f1a3-138">**modello di campo \_**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-138">**FIELD\_TEMPLATE**</span></span>                   | <span data-ttu-id="0f1a3-139">(Si applica alle CA globali (Enterprise)) Indicizzare il primo campo dell'elemento; rappresenta un modello di certificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-139">(Applies to enterprise CAs) Index to the item's first field; represents a certificate template.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="0f1a3-140">**\_FriendlyName Field**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-140">**FIELD\_FRIENDLYNAME**</span></span>               | <span data-ttu-id="0f1a3-141">Indice per il secondo campo dell'elemento; rappresenta il nome visualizzato (che l'utente visualizzerà durante la registrazione) dell'elemento nel primo campo.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-141">Index to the item's second field; represents the display name (which the user will see when enrolling) of the item in the first field.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="0f1a3-142">**CAMPO \_ CSPLIST**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-142">**FIELD\_CSPLIST**</span></span>                    | <span data-ttu-id="0f1a3-143">Indice al terzo campo dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-143">Index to the item's third field.</span></span> <span data-ttu-id="0f1a3-144">Elenco di nomi di [*provider del servizio di crittografia*](../secgloss/c-gly.md) consentiti dal modello.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-144">A list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="0f1a3-145">Ogni nome nell'elenco è separato da un punto interrogativo (?).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-145">Each name in the list is separated by a question mark (?).</span></span>                                                    |
| <span data-ttu-id="0f1a3-146">**CAMPO \_ CSPLIST2**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-146">**FIELD\_CSPLIST2**</span></span>                   | <span data-ttu-id="0f1a3-147">Indice al quarto campo dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-147">Index to the item's fourth field.</span></span> <span data-ttu-id="0f1a3-148">Elenco secondario di nomi di [*provider del servizio di crittografia*](../secgloss/c-gly.md) consentiti dal modello.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-148">A secondary list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="0f1a3-149">Ogni nome nell'elenco è separato da un punto interrogativo (?).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-149">Each name in the list is separated by a question mark (?).</span></span> <span data-ttu-id="0f1a3-150">Questo elenco fornisce un valore predefinito diverso.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-150">This list provides a different default.</span></span> |
| <span data-ttu-id="0f1a3-151">**CAMPO \_ esportabile**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-151">**FIELD\_EXPORTABLE**</span></span>                 | <span data-ttu-id="0f1a3-152">Indice del quinto campo dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-152">Index to the item's fifth field.</span></span> <span data-ttu-id="0f1a3-153">Indica se il modello specifica che la chiave deve essere esportabile.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-153">Indicates whether the template specifies that the key should be exportable.</span></span> <span data-ttu-id="0f1a3-154">Se questo campo contiene "true", la chiave può essere esportata.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-154">If this field contains "True", the key is exportable.</span></span> <span data-ttu-id="0f1a3-155">Se questo campo contiene "false", la chiave non è esportabile.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-155">If this field contains "False", the key is not exportable.</span></span>                                                                                                        |
| <span data-ttu-id="0f1a3-156">**il \_ campo \_ richiede \_ funzionalità SMIME**</span><span class="sxs-lookup"><span data-stu-id="0f1a3-156">**FIELD\_NEEDS\_SMIME\_CAPABILITIES**</span></span> | <span data-ttu-id="0f1a3-157">Questa costante non è supportata.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-157">This constant is not supported.</span></span>                                                                                                                                                                                                                                                                                                      |



 

<span data-ttu-id="0f1a3-158">Ad esempio, le espressioni seguenti assegnano l'OID di 1.3.6.1.5.5.7.3.2 al primo campo del primo elemento e assegnano "Web browser certificate" al secondo campo del primo elemento. il valore della matrice di zero indicizza il primo elemento.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-158">For example, the following expressions assign the OID of 1.3.6.1.5.5.7.3.2 to the first item's first field and assign "Web Browser Certificate" to the first item's second field (the array value of zero indexes the first item).</span></span>


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



<span data-ttu-id="0f1a3-159">Il risultato di queste assegnazioni è che l'utente visualizzerà il **certificato del Web browser** durante la registrazione. se l'utente seleziona il **certificato del Web browser**, la [*richiesta di certificato*](../secgloss/c-gly.md) conterrà l'OID 1.3.6.1.5.5.7.3.2.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-159">The result of these assignments is that the user will see the text **Web Browser Certificate** when enrolling, and if the user selects **Web Browser Certificate**, the [*certificate request*](../secgloss/c-gly.md) will contain the OID 1.3.6.1.5.5.7.3.2.</span></span>

<span data-ttu-id="0f1a3-160">Il file Certrqtp. Inc contiene anche le costanti usate per i nomi visualizzati dei modelli o dei tipi di certificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-160">The Certrqtp.inc file also contains constants that are used for the display names of the certificate templates or types.</span></span> <span data-ttu-id="0f1a3-161">Nell'esempio seguente viene illustrato il formato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-161">The following example shows the format.</span></span>


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



<span data-ttu-id="0f1a3-162">Queste costanti sono definite in un blocco nel file Certrqtp. Inc e questo raggruppamento rende più semplice assegnare a ognuno di essi un valore personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-162">These constants are defined in a block in the Certrqtp.inc file, and this grouping makes it easier to assign each of them a custom value.</span></span> <span data-ttu-id="0f1a3-163">Questa operazione è particolarmente utile quando si localizzano i nomi visualizzati per le versioni internazionali delle pagine Web.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-163">This is particularly helpful when you localize the display names for international versions of the webpages.</span></span>

<span data-ttu-id="0f1a3-164">Infine, il file Certrqtp. Inc contiene una variabile che rappresenta il numero di modelli di certificato o tipi nella matrice rgAvailReqTypes.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-164">Finally, the Certrqtp.inc file contains a variable that represents the number of certificate templates or types in the rgAvailReqTypes array.</span></span> <span data-ttu-id="0f1a3-165">Diversamente dalla dimensione *m* della matrice, impostare il valore della variabile nAvailReqTypes sul numero effettivo di modelli o tipi di certificato che l'installazione utilizzerà. il valore non deve essere maggiore di *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-165">In contrast to the *m* dimension of the array, set the value of the nAvailReqTypes variable to the actual number of certificate templates or types that your installation will use; this value must be no larger than *m*+1.</span></span> <span data-ttu-id="0f1a3-166">Sebbene dichiarati nella parte superiore del file Certrqtp. Inc, a nAvailReqTypes viene assegnato un valore dopo che la matrice rgAvailReqTypes è stata popolata, semplificando la visualizzazione del numero di elementi effettivamente utilizzati dalla matrice.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-166">Although declared near the top of the Certrqtp.inc file, nAvailReqTypes is assigned a value after the rgAvailReqTypes array is populated, making it easier to see how many elements are actually used by the array.</span></span> <span data-ttu-id="0f1a3-167">Il valore nAvailReqTypes viene usato in un'iterazione altrove nelle pagine di registrazione Web, pertanto è importante che questa variabile rifletta accuratamente il numero di modelli di certificato o di tipi che si desidera visualizzare all'utente.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-167">The nAvailReqTypes value is used in an iteration elsewhere in the web enrollment pages, so it is important that this variable accurately reflect the number of certificate templates or types that you want to be viewable to the user.</span></span>

<span data-ttu-id="0f1a3-168">Si noti che l'aggiunta di [*modelli di certificato*](../secgloss/c-gly.md) e tipi al file Certrqtp. Inc non garantisce che l'utente possa ottenere un certificato con tali tratti; la CA deve essere autorizzata a emettere un certificato per il tipo o il modello di certificato specificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-168">Note that merely adding [*certificate templates*](../secgloss/c-gly.md) and types to the Certrqtp.inc file does not guarantee that the user will be able to get a certificate with those traits; the CA must be authorized to issue a certificate for the specified certificate template or type.</span></span>

<span data-ttu-id="0f1a3-169">Le installazioni possono creare le proprie applicazioni o pagine Web per richiedere e ricevere un certificato.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-169">Installations can create their own applications or webpages to request and receive a certificate.</span></span> <span data-ttu-id="0f1a3-170">Gli oggetti [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) e [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) consentono ai programmatori o ai creatori di script di compilare applicazioni di [*richiesta di certificati*](../secgloss/c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="0f1a3-170">The [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) and [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) objects allow programmers or scripters to build [*certificate request*](../secgloss/c-gly.md) applications.</span></span>

<span data-ttu-id="0f1a3-171">Per richiedere l'emissione di un certificato su una [*Smart Card*](../secgloss/s-gly.md), è possibile usare il controllo di registrazione delle smart card.</span><span class="sxs-lookup"><span data-stu-id="0f1a3-171">To request a certificate to be issued on a [*smart card*](../secgloss/s-gly.md), you can use the Smart Card Enrollment Control.</span></span> <span data-ttu-id="0f1a3-172">Per informazioni dettagliate e codice di esempio, vedere [**ISCrdEnr**](iscrdenr.md).</span><span class="sxs-lookup"><span data-stu-id="0f1a3-172">For details and example code, see [**ISCrdEnr**](iscrdenr.md).</span></span>

 

 
