---
title: Uso dell'API client di Servizi di distribuzione Windows
description: Negli ambienti in cui non è possibile usare una soluzione standard di servizi di distribuzione Windows (WDS) per installare Windows, l'API del client WDS consente agli sviluppatori di scrivere applicazioni di distribuzione personalizzate.
ms.assetid: abe2a7c7-989a-456e-80df-90d5b816db38
keywords:
- Servizi di distribuzione Windows servizi di distribuzione Windows, utilizzo dell'API client
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 872422a5c84bf1d8ea7c3688b122ba2389c1e968
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104046889"
---
# <a name="using-the-windows-deployment-services-client-api"></a><span data-ttu-id="316de-104">Uso dell'API client di Servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="316de-104">Using the Windows Deployment Services Client API</span></span>

<span data-ttu-id="316de-105">Negli ambienti in cui non è possibile usare una soluzione standard di servizi di distribuzione Windows (WDS) per installare Windows, l'API del client WDS consente agli sviluppatori di scrivere applicazioni di distribuzione personalizzate.</span><span class="sxs-lookup"><span data-stu-id="316de-105">In environments where a standard Windows Deployment Services (WDS) solution cannot be used to install Windows, the API of the WDS client enables developers to write custom deployment applications.</span></span> <span data-ttu-id="316de-106">Le applicazioni possono usare questa API per comunicare con il server WDS per ottenere informazioni sulle immagini di sistema disponibili dal server.</span><span class="sxs-lookup"><span data-stu-id="316de-106">Applications can use this API to communicate with the WDS server to get information about system images available from the server.</span></span> <span data-ttu-id="316de-107">Le applicazioni client WDS personalizzate devono rispettare le linee guida seguenti.</span><span class="sxs-lookup"><span data-stu-id="316de-107">Custom WDS client applications should adhere to the following guidelines.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="316de-108">Installare il ruolo WDS nel server</span><span class="sxs-lookup"><span data-stu-id="316de-108">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="316de-109">Servizi di distribuzione Windows (WDS) è la versione modificata di servizi di installazione remota (RIS), per implementare soluzioni client WDS personalizzate sarà necessario il ruolo server WDS nel server.</span><span class="sxs-lookup"><span data-stu-id="316de-109">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role on the server to implement custom WDS client solutions.</span></span>
-   <span data-ttu-id="316de-110">WDS sostituisce RIS come componente standard a partire da Windows Server 2008 e Windows Server 2003 con Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="316de-110">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="316de-111">È necessario aggiornare il server RIS a WDS in Windows Server 2003 con Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="316de-111">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="316de-112">È possibile installare il ruolo server WDS con [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span><span class="sxs-lookup"><span data-stu-id="316de-112">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="start-windows-pe-20"></a><span data-ttu-id="316de-113">Avviare Windows PE 2,0</span><span class="sxs-lookup"><span data-stu-id="316de-113">Start Windows PE 2.0</span></span>

<span data-ttu-id="316de-114">È necessario avviare Windows PE 2,0, se non è già stato avviato.</span><span class="sxs-lookup"><span data-stu-id="316de-114">Windows PE 2.0 must be started, if not already started.</span></span> <span data-ttu-id="316de-115">Il client WDS e le DLL di supporto vengono caricati solo da setup.exe quando si trova nella fase Microsoft Ambiente preinstallazione di Windows (Windows PE 2,0) dell'elaborazione del programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="316de-115">The WDS client and supporting DLLs are only loaded by setup.exe when it is in the Microsoft Windows Preinstallation Environment (Windows PE 2.0) phase of setup processing.</span></span>

-   <span data-ttu-id="316de-116">Quando un nuovo computer è connesso alla rete, è possibile usare la tecnologia PXE (Preboot Execution Environment) incorporata per scaricare il programma di avvio di rete.</span><span class="sxs-lookup"><span data-stu-id="316de-116">When a new computer is connected to the network, the built-in preboot execution environment (PXE) technology can be used to download the Network Boot Program.</span></span> <span data-ttu-id="316de-117">Per ulteriori informazioni sull'avvio PXE di un computer per l'installazione di Windows, vedere [la guida dettagliata all'aggiornamento di servizi di distribuzione Windows](/previous-versions/windows/it-pro/windows-vista/cc766320(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="316de-117">For more information about PXE-booting a computer to install Windows, see [The Windows Deployment Services Update Step-by-Step Guide](/previous-versions/windows/it-pro/windows-vista/cc766320(v=ws.10)).</span></span>
-   <span data-ttu-id="316de-118">Un'immagine di avvio RAMDISK di Windows PE 2,0 può essere archiviata in. Formato WIM e scaricato come parte del processo di avvio di rete.</span><span class="sxs-lookup"><span data-stu-id="316de-118">A RAMDISK bootable image of Windows PE 2.0 can be stored in the .WIM format and downloaded as part of the network boot process.</span></span> <span data-ttu-id="316de-119">Windows PE può quindi essere caricato ed eseguito direttamente da tale supporto.</span><span class="sxs-lookup"><span data-stu-id="316de-119">Windows PE can then be loaded and run directly from that media.</span></span>

## <a name="open-a-session-with-the-wds-server"></a><span data-ttu-id="316de-120">Aprire una sessione con il server WDS</span><span class="sxs-lookup"><span data-stu-id="316de-120">Open a session with the WDS server</span></span>

<span data-ttu-id="316de-121">Il client WDS deve aprire una sessione con un server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-121">The WDS client must open a session with a WDS server.</span></span>

-   <span data-ttu-id="316de-122">Usare la funzione [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) per aprire una sessione con un server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-122">Use the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function to open a session with a WDS server.</span></span> <span data-ttu-id="316de-123">Questa funzione accetta il nome o l'indirizzo IP del server e riceve l'indirizzo dell'handle per la sessione del client WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-123">This function takes the name or IP address of the server and receives the address of the handle for the WDS client session.</span></span>
-   <span data-ttu-id="316de-124">Se l'apertura della sessione con il server richiede l'autenticazione del client WDS, l'applicazione deve fornire l'indirizzo di una struttura dell' [**\_ \_ interfaccia**](/windows/win32/api/wdsclientapi/ns-wdsclientapi-wds_cli_cred) della riga di comando di WDS contenente le credenziali client quando viene chiamata la funzione [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) .</span><span class="sxs-lookup"><span data-stu-id="316de-124">If opening the session with the server will require authenticating the WDS client, the application should provide the address of a [**WDS\_CLI\_CRED**](/windows/win32/api/wdsclientapi/ns-wdsclientapi-wds_cli_cred) structure containing the client credentials when calling the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function.</span></span> <span data-ttu-id="316de-125">L'applicazione può usare la funzione [**WdsCliAuthorizeSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliauthorizesession) per convertire una sessione anonima in una sessione autenticata.</span><span class="sxs-lookup"><span data-stu-id="316de-125">The application can use the [**WdsCliAuthorizeSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliauthorizesession) function to convert an anonymous session into an authenticated session.</span></span>
-   <span data-ttu-id="316de-126">Quando la sessione aperta con la funzione [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) non è più necessaria, l'applicazione deve usare la funzione [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) per chiudere l'handle e rilasciare le risorse utilizzate dalla sessione.</span><span class="sxs-lookup"><span data-stu-id="316de-126">When the session opened with the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function is no longer needed, the application should use the [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) function to close the handle and release resources held by the session.</span></span>

## <a name="enumerate-system-images-on-the-wds-server"></a><span data-ttu-id="316de-127">Enumerare le immagini di sistema nel server WDS</span><span class="sxs-lookup"><span data-stu-id="316de-127">Enumerate system images on the WDS server</span></span>

<span data-ttu-id="316de-128">Il client WDS può usare l'API per enumerare le immagini di sistema nel server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-128">The WDS client can use the API to enumerate the system images on the WDS server.</span></span>

-   <span data-ttu-id="316de-129">Utilizzare la funzione [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) per ottenere un handle per la prima immagine e per inizializzare l'enumerazione delle immagini nel server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-129">Use the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) function to obtain a handle to the first image and to initialize the enumeration of images on the WDS server.</span></span>
-   <span data-ttu-id="316de-130">Utilizzare la funzione [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) per incrementare l'enumerazione avviata dalla funzione [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) .</span><span class="sxs-lookup"><span data-stu-id="316de-130">Use the [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) function to increment the enumeration started by the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) function.</span></span> <span data-ttu-id="316de-131">La funzione **WdsCliFindNextImage** Ottiene l'handle per l'immagine successiva.</span><span class="sxs-lookup"><span data-stu-id="316de-131">The **WdsCliFindNextImage** function gets the handle for the next image.</span></span>
-   <span data-ttu-id="316de-132">Usare la funzione [**WdsCliGetImageIndex**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageindex) per ottenere l'indice dell'immagine per l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-132">Use the [**WdsCliGetImageIndex**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageindex) function to obtain the image index for the current image.</span></span> <span data-ttu-id="316de-133">Questo valore è valido solo fino a quando le funzioni [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) o [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) non vengono riutilizzate.</span><span class="sxs-lookup"><span data-stu-id="316de-133">This value is valid only until the [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) or [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) functions are used again.</span></span>
-   <span data-ttu-id="316de-134">Usare la funzione [**WdsCliGetEnumerationFlags**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetenumerationflags) per ottenere i flag informativi sul filtro delle immagini.</span><span class="sxs-lookup"><span data-stu-id="316de-134">Use the [**WdsCliGetEnumerationFlags**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetenumerationflags) function to get informational flags about image filtering.</span></span>

## <a name="get-information-about-images"></a><span data-ttu-id="316de-135">Ottenere informazioni sulle immagini</span><span class="sxs-lookup"><span data-stu-id="316de-135">Get information about images</span></span>

<span data-ttu-id="316de-136">Il client WDS può usare l'API per ottenere informazioni sulle immagini in un server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-136">The WDS client can use the API to get information about the images on a WDS server.</span></span> <span data-ttu-id="316de-137">Le funzioni seguenti ottengono informazioni sull'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-137">The following functions get information about the current image.</span></span> <span data-ttu-id="316de-138">Poiché le funzioni [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) e [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) modificano il valore dell'handle dell'immagine corrente, l'applicazione deve archiviare tutte le informazioni ottenute e sarà necessaria in futuro prima di chiamare di nuovo le funzioni **WdsCliFindFirstImage** o **WdsCliFindNextImage** .</span><span class="sxs-lookup"><span data-stu-id="316de-138">Because the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) and [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) functions change the current image handle value, the application should store any information it gets and will need in the future before calling the **WdsCliFindFirstImage** or **WdsCliFindNextImage** functions again.</span></span>

-   <span data-ttu-id="316de-139">Utilizzare la funzione [**WdsCliGetImageArchitecture**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagearchitecture) per ottenere l'architettura del processore dell'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-139">Use the [**WdsCliGetImageArchitecture**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagearchitecture) function to get the processor architecture of the current image.</span></span>
-   <span data-ttu-id="316de-140">Usare la funzione [**WdsCliGetImagePath**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagepath) per ottenere il percorso relativo del file di immagine che contiene l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-140">Use the [**WdsCliGetImagePath**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagepath) function to get the relative path to the image file that contains the current image.</span></span>
-   <span data-ttu-id="316de-141">Usare la funzione [**WdsCliGetImageSize**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagesize) per ottenere le dimensioni dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="316de-141">Use the [**WdsCliGetImageSize**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagesize) function to get the image size.</span></span>
-   <span data-ttu-id="316de-142">Usare la funzione [**WdsCliGetImageVersion**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageversion) per ottenere la versione dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="316de-142">Use the [**WdsCliGetImageVersion**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageversion) function to get the image version.</span></span>
-   <span data-ttu-id="316de-143">Utilizzare la funzione [**WdsCliGetImageLanguage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguage) per ottenere la lingua predefinita dell'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-143">Use the [**WdsCliGetImageLanguage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguage) function to get the default language of the current image.</span></span>
-   <span data-ttu-id="316de-144">Usare la funzione [**WdsCliGetImageLanguages**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguages) per ottenere una matrice di linguaggi supportati dall'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-144">Use the [**WdsCliGetImageLanguages**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguages) function to get an array of languages supported by the current image.</span></span>
-   <span data-ttu-id="316de-145">Usare [**WdsCliGetImageLastModifiedTime**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelastmodifiedtime) restituisce l'ora dell'Ultima modifica per l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-145">Use the [**WdsCliGetImageLastModifiedTime**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelastmodifiedtime) returns the last-modified time for the current image.</span></span>
-   <span data-ttu-id="316de-146">Usare la funzione [**WdsCliGetImageName**](/windows/win32/api/WdsClientApi/nf-wdsclientapi-wdscligetimagename) per ottenere il nome dell'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-146">Use the [**WdsCliGetImageName**](/windows/win32/api/WdsClientApi/nf-wdsclientapi-wdscligetimagename) function to get the name of the current image.</span></span>
-   <span data-ttu-id="316de-147">Usare la funzione [**WdsCliGetImageDescription**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagedescription) per ottenere la descrizione dell'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-147">Use the [**WdsCliGetImageDescription**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagedescription) function to get the description of the current image.</span></span>
-   <span data-ttu-id="316de-148">Usare la funzione [**WdsCliGetImageGroup**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagegroup) per ottenere il nome del gruppo di immagini per l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-148">Use the [**WdsCliGetImageGroup**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagegroup) function to get the image group name for the current image.</span></span>
-   <span data-ttu-id="316de-149">Usare la funzione [**WdsCliGetImageHalName**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagehalname) per ottenere il nome Hal (Hardware Abstraction Layer) per l'immagine corrente.</span><span class="sxs-lookup"><span data-stu-id="316de-149">Use the [**WdsCliGetImageHalName**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagehalname) function to get the Hardware Abstraction Layer (HAL) name for the current image.</span></span>

## <a name="log-wds-client-events"></a><span data-ttu-id="316de-150">Registra eventi client WDS</span><span class="sxs-lookup"><span data-stu-id="316de-150">Log WDS Client Events</span></span>

<span data-ttu-id="316de-151">La funzionalità di registrazione della libreria client WDS consente l'invio degli eventi di avanzamento dell'installazione dal client al server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-151">The logging functionality of the WDS client library enables installation progress events to be sent from the client to the WDS server.</span></span>

-   <span data-ttu-id="316de-152">Utilizzare la funzione [**WdsCliInitializeLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliinitializelog) per inizializzare il log della sessione client di WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-152">Use the [**WdsCliInitializeLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliinitializelog) function to initialize the log for the WDS client session.</span></span>
-   <span data-ttu-id="316de-153">Utilizzare la funzione [**WdsCliLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclilog) per scrivere messaggi di evento nel log del server WDS.</span><span class="sxs-lookup"><span data-stu-id="316de-153">Use the [**WdsCliLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclilog) function to write event messages to the WDS server log.</span></span>
-   <span data-ttu-id="316de-154">In Windows Server 2008, il server di servizi di distribuzione Windows scrive gli eventi client in un registro eventi specifico dell'applicazione, visualizzabile tramite eventvwr.exe e il log di traccia di debug.</span><span class="sxs-lookup"><span data-stu-id="316de-154">On Windows Server 2008, the WDS server writes client events to an application specific event log that is viewable through eventvwr.exe as well as the debug trace log.</span></span> <span data-ttu-id="316de-155">In Windows Server 2003 con la registrazione debug abilitata, il server WDS scriverà gli eventi client nel file di log che si trova in% windir% \\ Tracing \\ WDSServer. log.</span><span class="sxs-lookup"><span data-stu-id="316de-155">On Windows Server 2003 with debug logging enabled, the WDS server will write client events to the log file located at %windir%\\tracing\\wdsserver.log.</span></span> <span data-ttu-id="316de-156">Per acquisire questi eventi, è necessario abilitare la registrazione del client WDS sul server.</span><span class="sxs-lookup"><span data-stu-id="316de-156">WDS Client logging must be enabled on the server to capture these events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="316de-157">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="316de-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="316de-158">Informazioni sull'API di servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="316de-158">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="316de-159">Uso dell'API server di Servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="316de-159">Using the Windows Deployment Services Server API</span></span>](using-the-windows-deployment-services-server-api.md)
</dt> </dl>

 

 