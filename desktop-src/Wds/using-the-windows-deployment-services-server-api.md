---
title: Uso dell'API server di Servizi di distribuzione Windows
description: Negli ambienti in cui non è possibile usare la soluzione standard di servizi di distribuzione Windows (WDS), il server WDS espone un'API che consente agli sviluppatori di scrivere plug-in, detti provider, per gestire le richieste PXE (Preboot Execution Environment).
ms.assetid: 5e25654a-33c6-4c0f-acc3-e938d1f4a4e7
keywords:
- Servizi di distribuzione Windows servizi di distribuzione Windows, utilizzo dell'API server
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3634dffa73eddc9b5db92be6bc807cccbc5248f
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/11/2020
ms.locfileid: "103724258"
---
# <a name="using-the-windows-deployment-services-server-api"></a><span data-ttu-id="45a36-104">Uso dell'API server di Servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="45a36-104">Using the Windows Deployment Services Server API</span></span>

<span data-ttu-id="45a36-105">Negli ambienti in cui non è possibile usare la soluzione standard di servizi di distribuzione Windows (WDS), il server WDS espone un'API che consente agli sviluppatori di scrivere plug-in, detti provider, per gestire le richieste PXE (Preboot Execution Environment).</span><span class="sxs-lookup"><span data-stu-id="45a36-105">In environments where the standard Windows Deployment Services (WDS) solution cannot be used, the WDS server exposes an API that enables developers to write plug-ins, referred to as providers, to handle preboot execution environment (PXE) requests.</span></span> <span data-ttu-id="45a36-106">Gli sviluppatori devono attenersi alle linee guida seguenti per la scrittura di provider PXE per WDS.</span><span class="sxs-lookup"><span data-stu-id="45a36-106">Developers should adhere to the following guidelines when writing PXE providers for WDS.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="45a36-107">Installare il ruolo WDS nel server</span><span class="sxs-lookup"><span data-stu-id="45a36-107">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="45a36-108">Servizi di distribuzione Windows (WDS) è la versione modificata di servizi di installazione remota (RIS), per implementare i provider e il server PXE WDS è necessario il ruolo server WDS.</span><span class="sxs-lookup"><span data-stu-id="45a36-108">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role to implement the WDS PXE server and providers.</span></span>
-   <span data-ttu-id="45a36-109">WDS sostituisce RIS come componente standard a partire da Windows Server 2008 e Windows Server 2003 con Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="45a36-109">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="45a36-110">È necessario aggiornare il server RIS a WDS in Windows Server 2003 con Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="45a36-110">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="45a36-111">È possibile installare il ruolo server WDS con [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span><span class="sxs-lookup"><span data-stu-id="45a36-111">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="register-providers"></a><span data-ttu-id="45a36-112">Registra provider</span><span class="sxs-lookup"><span data-stu-id="45a36-112">Register Providers</span></span>

-   <span data-ttu-id="45a36-113">Registrare la libreria di collegamento dinamico (DLL) del provider durante l'installazione e inserire il provider nell'elenco ordinato di provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-113">Register the provider dynamic-link library (DLL) during its installation and insert the provider into the ordered list of registered providers.</span></span>
    > [!Note]  
    > <span data-ttu-id="45a36-114">Quando si installa un provider nuovo o modificato, sarà necessario riavviare il servizio PXE WDS per rendere effettive le modifiche.</span><span class="sxs-lookup"><span data-stu-id="45a36-114">When you install a new or modified provider, you will need to restart WDS PXE service for the changes to take effect.</span></span>

     

-   <span data-ttu-id="45a36-115">Utilizzare la funzione [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) per registrare il provider e aggiungerlo all'elenco.</span><span class="sxs-lookup"><span data-stu-id="45a36-115">Use the [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) function to register the provider and add it to the list.</span></span> <span data-ttu-id="45a36-116">Utilizzare la funzione [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) per annullare la registrazione di un provider registrato e rimuoverlo dall'elenco.</span><span class="sxs-lookup"><span data-stu-id="45a36-116">Use the [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) function to unregister a registered provider and remove it from the list.</span></span>
-   <span data-ttu-id="45a36-117">Consente di specificare la sequenza del provider nell'elenco ordinato.</span><span class="sxs-lookup"><span data-stu-id="45a36-117">Specify the sequence of the provider in the ordered list.</span></span> <span data-ttu-id="45a36-118">L'indice di un provider nell'elenco non può essere garantito perché un altro provider può essere registrato in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="45a36-118">The index of a provider in the list cannot be guaranteed because another provider may later be registered before it.</span></span> <span data-ttu-id="45a36-119">Per inserire il provider nell'elenco prima o dopo un altro provider registrato, utilizzare innanzitutto la funzione [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) per ottenere l'indice del provider registrato, quindi registrare il nuovo provider specificando un valore di indice maggiore o minore.</span><span class="sxs-lookup"><span data-stu-id="45a36-119">To insert the provider in the list before or after another registered provider, first use the [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) function to get the index of the registered provider and then register the new provider while specifying a larger or smaller index value.</span></span>
-   <span data-ttu-id="45a36-120">L'installazione può archiviare le informazioni di configurazione del provider nella chiave del registro di sistema restituita quando il provider è registrato.</span><span class="sxs-lookup"><span data-stu-id="45a36-120">The installation can store provider configuration information under the registry key returned when the provider is registered.</span></span> <span data-ttu-id="45a36-121">L'indirizzo della chiave del registro di sistema viene ricevuto dal *phProviderKey* di [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span><span class="sxs-lookup"><span data-stu-id="45a36-121">The address of the registry key is received by the *phProviderKey* of [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span></span> <span data-ttu-id="45a36-122">Il provider riceve un handle per la stessa chiave del parametro *hProviderKey* al callback [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-122">The provider receives a handle to this same key as the *hProviderKey* parameter to its [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="45a36-123">Il provider deve archiviare l'indirizzo della chiave.</span><span class="sxs-lookup"><span data-stu-id="45a36-123">The provider should store the address of this key.</span></span>
-   <span data-ttu-id="45a36-124">Installare sempre la libreria di collegamento dinamico (DLL) del provider nella cartella programmi del server.</span><span class="sxs-lookup"><span data-stu-id="45a36-124">Always install the provider dynamic-link library (DLL) in the server's Program Files folder.</span></span>

## <a name="initialize"></a><span data-ttu-id="45a36-125">Inizializzare</span><span class="sxs-lookup"><span data-stu-id="45a36-125">Initialize</span></span>

-   <span data-ttu-id="45a36-126">Includere una DLL che esporta la funzione di callback [*PxeProviderInitialize*](pxeproviderinitialize.md) nel provider.</span><span class="sxs-lookup"><span data-stu-id="45a36-126">Include a DLL that exports the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback function in the provider.</span></span> <span data-ttu-id="45a36-127">Ogni provider richiede un callback *PxeProviderInitialize* .</span><span class="sxs-lookup"><span data-stu-id="45a36-127">Every provider requires a *PxeProviderInitialize* callback.</span></span> <span data-ttu-id="45a36-128">Quando WDS carica un provider, chiama la funzione *PxeProviderInitialize* del provider e passa un handle alla stessa chiave usata per archiviare le informazioni di configurazione durante la registrazione del provider.</span><span class="sxs-lookup"><span data-stu-id="45a36-128">When WDS loads a provider, it calls the provider's *PxeProviderInitialize* function and passes a handle to the same key that is used to store configuration information during provider registration.</span></span>
-   <span data-ttu-id="45a36-129">Quando il callback [*PxeProviderInitialize*](pxeproviderinitialize.md) restituisce e ha esito positivo, il provider deve essere completamente inizializzato e pronto per l'elaborazione delle richieste.</span><span class="sxs-lookup"><span data-stu-id="45a36-129">When the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback returns and is successful, the provider should be fully initialized and ready to process requests.</span></span>
-   <span data-ttu-id="45a36-130">Registrare ogni callback nel provider durante l'elaborazione della funzione [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-130">Register every callback in the provider during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span> <span data-ttu-id="45a36-131">I callback devono essere registrati con la funzione [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) .</span><span class="sxs-lookup"><span data-stu-id="45a36-131">Callbacks should be registered with the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function.</span></span>
-   <span data-ttu-id="45a36-132">Inizializzare tutte le risorse interne del provider nell'elaborazione della relativa funzione [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-132">Initialize all the provider's internal resources within the processing of its [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span>

## <a name="shutdown"></a><span data-ttu-id="45a36-133">Arresta</span><span class="sxs-lookup"><span data-stu-id="45a36-133">Shutdown</span></span>

-   <span data-ttu-id="45a36-134">Implementare il callback [*PxeProviderShutdown*](pxeprovidershutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-134">Implement the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback.</span></span> <span data-ttu-id="45a36-135">Ogni provider deve avere un callback *PxeProviderShutdown*.</span><span class="sxs-lookup"><span data-stu-id="45a36-135">Every provider is required to have a *PxeProviderShutdown* callback.</span></span>
-   <span data-ttu-id="45a36-136">La funzione di callback [*PxeProviderShutdown*](pxeprovidershutdown.md) dovrebbe arrestare completamente il provider e rilasciare tutte le risorse.</span><span class="sxs-lookup"><span data-stu-id="45a36-136">The [*PxeProviderShutdown*](pxeprovidershutdown.md) callback function should fully shut down the provider and release all its resources.</span></span>
-   <span data-ttu-id="45a36-137">Una volta restituito il callback [*PxeProviderShutdown*](pxeprovidershutdown.md) , l'handle *hProvider* passato alla funzione [*PxeProviderInitialize*](pxeproviderinitialize.md) non è più valido e non deve essere usato per chiamare WDS.</span><span class="sxs-lookup"><span data-stu-id="45a36-137">After the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback returns, the *hProvider* handle passed to the [*PxeProviderInitialize*](pxeproviderinitialize.md) function is no longer valid and should not be used to call WDS.</span></span>
-   <span data-ttu-id="45a36-138">Registrare il callback [*PxeProviderShutdown*](pxeprovidershutdown.md) chiamando la funzione [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) con l' **\_ \_ arresto del callback PXE** durante l'elaborazione del callback [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-138">Register the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SHUTDOWN** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="45a36-139">Non chiamare il callback *PxeProviderShutdown* se la funzione *PxeProviderInitialize* ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="45a36-139">Do not call the *PxeProviderShutdown* callback if the *PxeProviderInitialize* function fails.</span></span>

## <a name="handle-request-packet"></a><span data-ttu-id="45a36-140">Gestisci pacchetto di richiesta</span><span class="sxs-lookup"><span data-stu-id="45a36-140">Handle Request Packet</span></span>

<span data-ttu-id="45a36-141">Implementare il callback [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) per il provider.</span><span class="sxs-lookup"><span data-stu-id="45a36-141">Implement the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback for the provider.</span></span> <span data-ttu-id="45a36-142">Ogni provider deve avere un callback *PxeProviderRecvRequest* .</span><span class="sxs-lookup"><span data-stu-id="45a36-142">Every provider is required to have a *PxeProviderRecvRequest* callback.</span></span> <span data-ttu-id="45a36-143">Quando WDS riceve una richiesta, chiama il callback *PxeProviderRecvRequest* per il primo provider nell'elenco dei provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-143">When WDS receives a request, it calls the *PxeProviderRecvRequest* callback for the first provider in the registered provider list.</span></span>

-   <span data-ttu-id="45a36-144">Se il provider elaborerà la richiesta in modo sincrono, la funzione [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) dovrebbe restituire un valore **Error \_ Success**.</span><span class="sxs-lookup"><span data-stu-id="45a36-144">If the provider will process this request synchronously, the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) function should return a value of **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="45a36-145">Se e solo se il provider elaborerà la richiesta in modo asincrono, il callback di *PxeProviderRecvRequest* deve restituire l' **errore \_ io \_ in sospeso** e chiamare la funzione [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) quando la richiesta è stata elaborata.</span><span class="sxs-lookup"><span data-stu-id="45a36-145">If and only if the provider will process this request asynchronously, the *PxeProviderRecvRequest* callback should return **ERROR\_IO\_PENDING** and call the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function when the request has been processed.</span></span>
-   <span data-ttu-id="45a36-146">Il callback [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) e la funzione [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) restituisce l'indirizzo di un'enumerazione dell' **\_ \_ azione di avvio PXE** che descrive l'azione eseguita dal provider per gestire la richiesta.</span><span class="sxs-lookup"><span data-stu-id="45a36-146">The [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback and the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function returns the address of a **PXE\_BOOT\_ACTION** enum that describes the action taken by the provider to handle the request.</span></span>

    <span data-ttu-id="45a36-147">Esistono quattro modi per gestire una richiesta da un provider:</span><span class="sxs-lookup"><span data-stu-id="45a36-147">There are four ways for a provider to handle a request:</span></span>

    -   <span data-ttu-id="45a36-148">Il provider risponde al client con un pacchetto di risposta DHCP standard che contiene un percorso del programma di avvio di rete.</span><span class="sxs-lookup"><span data-stu-id="45a36-148">The provider replies to the client with a standard DHCP response packet that contains a path to the Network Boot Program.</span></span> <span data-ttu-id="45a36-149">La restituzione del valore **\_ \_ avvio di PXE BA** per l'enumerazione significa che il provider ha elaborato correttamente il pacchetto di richiesta e ha completato la richiesta inviando un pacchetto di risposta chiamando le funzioni [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) e [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="45a36-149">Returning the **PXE\_BA\_NBP** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="45a36-150">Il provider risponde al client con un pacchetto di risposta personalizzato che non è conforme a DHCP.</span><span class="sxs-lookup"><span data-stu-id="45a36-150">The provider replies to the client with a custom response packet that does not conform to DHCP.</span></span> <span data-ttu-id="45a36-151">La restituzione del valore **\_ \_ personalizzato PXE BA** per l'enumerazione significa che il provider ha elaborato correttamente il pacchetto di richiesta e ha completato la richiesta inviando un pacchetto di risposta personalizzato chiamando le funzioni [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) e [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="45a36-151">Returning the **PXE\_BA\_CUSTOM** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a custom response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="45a36-152">Il provider determina che la richiesta deve essere ignorata.</span><span class="sxs-lookup"><span data-stu-id="45a36-152">The provider determines the request should be ignored.</span></span> <span data-ttu-id="45a36-153">La restituzione del valore di **\_ \_ Ignore PXE** per l'enumerazione significa che il provider ha rilasciato tutte le risorse associate alla richiesta e la richiesta non viene passata al provider successivo nell'elenco dei provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-153">Returning the **PXE\_BA\_IGNORE** value for the enum means the provider has released all resources associated with the request and the request is not passed to the next provider in the list of registered providers.</span></span> <span data-ttu-id="45a36-154">I provider possono usare questa opzione se rilevano che un pacchetto di richiesta non è valido.</span><span class="sxs-lookup"><span data-stu-id="45a36-154">Providers may use this option if they detect that a request packet is invalid.</span></span>
    -   <span data-ttu-id="45a36-155">Il provider rifiuta di servire la richiesta.</span><span class="sxs-lookup"><span data-stu-id="45a36-155">The provider declines to service the request.</span></span> <span data-ttu-id="45a36-156">La restituzione del valore di **\_ \_ rifiuto BA PXE** per l'enumerazione indica al sistema di passare la richiesta al provider successivo nell'elenco dei provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-156">Returning the **PXE\_BA\_REJECT** value for the enum instructs the system to pass the request to the next provider in the list of registered providers.</span></span> <span data-ttu-id="45a36-157">Se questo è l'ultimo provider nell'elenco, rilascia tutte le risorse associate alla richiesta e la richiesta viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="45a36-157">If this were the last provider in the list, this releases all resources associated with the request and the request is ignored.</span></span>
    -   <span data-ttu-id="45a36-158">Registrare il callback [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) chiamando la funzione [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) con la **\_ richiesta di callback PXE \_ ricezione \_** durante l'elaborazione del callback [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-158">Register the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_RECV\_REQUEST** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="generate-response-packet"></a><span data-ttu-id="45a36-159">Genera pacchetto di risposta</span><span class="sxs-lookup"><span data-stu-id="45a36-159">Generate Response Packet</span></span>

-   <span data-ttu-id="45a36-160">Usare l'API per scrivere i provider per gestire la richiesta DHCP e generare pacchetti di risposta.</span><span class="sxs-lookup"><span data-stu-id="45a36-160">Use the API to write providers to handle DHCP request and generate response packets.</span></span>
-   <span data-ttu-id="45a36-161">La funzione [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) specifica gli attributi utilizzati dal provider per filtrare i pacchetti.</span><span class="sxs-lookup"><span data-stu-id="45a36-161">The [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function specifies the attributes used by the provider to filter packets.</span></span> <span data-ttu-id="45a36-162">Gli attributi del provider possono essere specificati in modo che il provider veda tutti i pacchetti, il provider vede solo i pacchetti DHCP oppure il provider vede solo i pacchetti DHCP che specificano l'opzione identificatore classe fornitore DHCP (60) come "PXEClient".</span><span class="sxs-lookup"><span data-stu-id="45a36-162">The attributes of the provider can be specified so that the provider see all packets, the provider sees only DHCP packets, or the provider sees only DHCP packets that specify the DHCP Vendor Class Identifier option (60) as "PXEClient".</span></span>
-   <span data-ttu-id="45a36-163">La funzione [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) verifica che un pacchetto sia un pacchetto DHCP valido.</span><span class="sxs-lookup"><span data-stu-id="45a36-163">The [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) function checks that a packet is a valid DHCP packet.</span></span> <span data-ttu-id="45a36-164">I provider possono utilizzare la funzione **PxeDhcpIsValid** per verificare se un pacchetto del client è un pacchetto DHCP quando il filtro impostato con la funzione [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) è impostato in modo da ricevere tutti i pacchetti per determinare se un pacchetto specificato è un pacchetto DHCP valido.</span><span class="sxs-lookup"><span data-stu-id="45a36-164">Providers can use the **PxeDhcpIsValid** function to check whether a packet from the client is a DHCP packet when the filter set with the [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function is set to receive all packets to determine if a specified packet is a valid DHCP packet.</span></span>
-   <span data-ttu-id="45a36-165">La funzione [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) Inizializza un pacchetto di risposta come pacchetto di risposta DHCP basato sulle informazioni contenute in un pacchetto ricevuto dal client.</span><span class="sxs-lookup"><span data-stu-id="45a36-165">The [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) function initializes a response packet as a DHCP reply packet that is based on the information in a packet received from the client.</span></span> <span data-ttu-id="45a36-166">La funzione [*PxeProviderInitialize*](pxeproviderinitialize.md) accetta l'indirizzo di un pacchetto DHCP valido ricevuto dal client nel callback [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-166">The [*PxeProviderInitialize*](pxeproviderinitialize.md) function takes the address of a valid DHCP packet received from the client in the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback.</span></span> <span data-ttu-id="45a36-167">La funzione **PxeDhcpInitialize** accetta un puntatore a un pacchetto di risposta allocato con la funzione [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="45a36-167">The **PxeDhcpInitialize** function takes a pointer to a reply packet allocated with the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span>
-   <span data-ttu-id="45a36-168">La funzione [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) recupera un valore di opzione da un pacchetto DHCP.</span><span class="sxs-lookup"><span data-stu-id="45a36-168">The [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) function retrieves an option value from a DHCP packet.</span></span> <span data-ttu-id="45a36-169">La funzione [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) recupera un valore di opzione dal campo informazioni specifiche del fornitore (43) di un pacchetto DHCP.</span><span class="sxs-lookup"><span data-stu-id="45a36-169">The [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) function retrieves an option value from the Vendor Specific Information field (43) of a DHCP packet.</span></span>
-   <span data-ttu-id="45a36-170">Il provider può quindi popolare il pacchetto di risposta con le informazioni e usare la funzione [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) per inviare il pacchetto di risposta al client.</span><span class="sxs-lookup"><span data-stu-id="45a36-170">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span> <span data-ttu-id="45a36-171">La funzione [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) aggiunge un'opzione DHCP al pacchetto di risposta.</span><span class="sxs-lookup"><span data-stu-id="45a36-171">The [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) function appends a DHCP option to the reply packet.</span></span>
-   <span data-ttu-id="45a36-172">Un provider che risponde alle richieste client inviando un pacchetto deve allocare il pacchetto di risposta usando la funzione [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="45a36-172">A provider that replies to client requests by sending a packet must allocate the response packet using the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span> <span data-ttu-id="45a36-173">Il provider può quindi popolare il pacchetto di risposta con le informazioni e usare la funzione [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) per inviare il pacchetto di risposta al client.</span><span class="sxs-lookup"><span data-stu-id="45a36-173">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span>
-   <span data-ttu-id="45a36-174">Quando la memoria allocata non è più necessaria, il provider deve rilasciarla utilizzando la funzione [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) .</span><span class="sxs-lookup"><span data-stu-id="45a36-174">When the allocated memory is no longer needed, the provider should release it using the [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) function.</span></span>

## <a name="enumerate-registered-providers"></a><span data-ttu-id="45a36-175">Enumera provider registrati</span><span class="sxs-lookup"><span data-stu-id="45a36-175">Enumerate Registered Providers</span></span>

-   <span data-ttu-id="45a36-176">Usare l'API per scrivere i provider che enumerano e controllano altri provider registrati nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="45a36-176">Use the API to write providers that enumerate and check other registered providers in the list.</span></span>
-   <span data-ttu-id="45a36-177">La funzione [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) restituisce informazioni sul server PXE.</span><span class="sxs-lookup"><span data-stu-id="45a36-177">The [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) function returns information about the PXE server.</span></span> <span data-ttu-id="45a36-178">La funzione **PxeGetServerInfo** restituisce un valore **bool** che indica se la traccia è abilitata per il server.</span><span class="sxs-lookup"><span data-stu-id="45a36-178">The **PxeGetServerInfo** function returns a **BOOL** that indicates whether tracing is enabled for the server.</span></span> <span data-ttu-id="45a36-179">**True** indica che la traccia è abilitata.</span><span class="sxs-lookup"><span data-stu-id="45a36-179">**TRUE** indicates that tracing is enabled.</span></span>
-   <span data-ttu-id="45a36-180">La funzione [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) avvia un provider enumerationof nell'elenco dei provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-180">The [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) function starts an enumerationof providers in the registered provider list.</span></span> <span data-ttu-id="45a36-181">La funzione **PxeProviderEnumFirst** avvia l'enumerazione e restituisce l'indirizzo dell'handle da usare quando si chiama la funzione [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) .</span><span class="sxs-lookup"><span data-stu-id="45a36-181">The **PxeProviderEnumFirst** function starts the enumeration and returns the address of the handle that should be used when calling the [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) function.</span></span> <span data-ttu-id="45a36-182">La funzione **PxeProviderEnumNext** restituisce una struttura del [**\_ provider PXE**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) che contiene le informazioni sul provider.</span><span class="sxs-lookup"><span data-stu-id="45a36-182">The **PxeProviderEnumNext** function returns a [**PXE\_PROVIDER**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) structure containing the information about the provider.</span></span> <span data-ttu-id="45a36-183">La funzione [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) libera la memoria allocata per la struttura del **\_ provider PXE** tramite la funzione **PxeProviderEnumNext** .</span><span class="sxs-lookup"><span data-stu-id="45a36-183">The [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) function frees the memory that has been allocated for the **PXE\_PROVIDER** structure by the **PxeProviderEnumNext** function.</span></span> <span data-ttu-id="45a36-184">La funzione [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) chiude l'enumerazione dei provider nell'elenco dei provider registrati.</span><span class="sxs-lookup"><span data-stu-id="45a36-184">The [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) function closes the enumeration of providers in the registered providers list.</span></span>

## <a name="handle-service-control-codes"></a><span data-ttu-id="45a36-185">Gestire i codici di controllo del servizio</span><span class="sxs-lookup"><span data-stu-id="45a36-185">Handle Service Control Codes</span></span>

-   <span data-ttu-id="45a36-186">Quando viene ricevuto un messaggio di controllo del servizio, WDS chiama il callback [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-186">When a service control message is received, WDS calls the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback.</span></span>
-   <span data-ttu-id="45a36-187">Il provider può definire una funzione di callback [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) per gestire i messaggi di controllo del servizio.</span><span class="sxs-lookup"><span data-stu-id="45a36-187">The provider can define a [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback function to handle service control messages.</span></span>
-   <span data-ttu-id="45a36-188">Registrare il callback [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) chiamando la funzione [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) con il **\_ \_ \_ controllo del servizio di callback PXE** durante l'elaborazione del callback [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="45a36-188">Register the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SERVICE\_CONTROL** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="add-trace-entries-to-pxe-log"></a><span data-ttu-id="45a36-189">Aggiungere voci di traccia al log PXE</span><span class="sxs-lookup"><span data-stu-id="45a36-189">Add Trace Entries to PXE Log</span></span>

-   <span data-ttu-id="45a36-190">La funzione [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) aggiunge una voce di traccia al log PXE.</span><span class="sxs-lookup"><span data-stu-id="45a36-190">The [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) function adds a trace entry to the PXE log.</span></span> <span data-ttu-id="45a36-191">WDSPXE fornisce la traccia per aiutare gli amministratori nella risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="45a36-191">WDSPXE provides tracing to help administrators in troubleshooting.</span></span> <span data-ttu-id="45a36-192">I provider possono registrare voci di traccia con livelli di gravità diversi.</span><span class="sxs-lookup"><span data-stu-id="45a36-192">Providers can log trace entries of different severity levels.</span></span> <span data-ttu-id="45a36-193">Gli amministratori possono configurare WDSPXE solo per le voci di log per determinati livelli di gravità.</span><span class="sxs-lookup"><span data-stu-id="45a36-193">The administrators can configure WDSPXE to only log entries for certain severity levels.</span></span>

## <a name="related-topics"></a><span data-ttu-id="45a36-194">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="45a36-194">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45a36-195">Informazioni sull'API di servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="45a36-195">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="45a36-196">Uso dell'API client di Servizi di distribuzione Windows</span><span class="sxs-lookup"><span data-stu-id="45a36-196">Using the Windows Deployment Services Client API</span></span>](using-the-windows-deployment-services-client-api.md)
</dt> </dl>

 

 




