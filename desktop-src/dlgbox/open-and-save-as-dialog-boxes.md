---
title: Finestre di dialogo Apri e Salva con nome
description: La finestra di dialogo Apri consente all'utente di specificare l'unità, la directory e il nome di un file o di un set di file da aprire.
ms.assetid: 5676ca9d-daca-40bf-8881-def2ff841c58
keywords:
- Libreria di finestre di dialogo comuni
- finestre di dialogo comuni
- Finestra di dialogo Apri
- Salva con nome - finestra di dialogo
- personalizzazione della finestra di dialogo Apri
- personalizzazione della finestra di dialogo Salva con nome
- finestre di dialogo, Apri
- finestre di dialogo, Salva con nome
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: 605040af3aafe9d7739ebd069a7c0607402940c8
ms.sourcegitcommit: 8e083a10b3a480dec8a8d74dbd5889f49dea15e4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2021
ms.locfileid: "107590828"
---
# <a name="open-and-save-as-dialog-boxes"></a><span data-ttu-id="ced1a-111">Finestre di dialogo Apri e Salva con nome</span><span class="sxs-lookup"><span data-stu-id="ced1a-111">Open and Save As Dialog Boxes</span></span>

> [!NOTE]
> <span data-ttu-id="ced1a-112">La [**funzione GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) è illustrata nell'esempio [file è in uso.](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)</span><span class="sxs-lookup"><span data-stu-id="ced1a-112">The [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function is demonstrated in the [File is in use sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span></span>

<span data-ttu-id="ced1a-113">\[A partire da Windows Vista, le **finestre di** **dialogo** comuni Apri e Salva con nome sono state sostituite dalla finestra di dialogo [Elemento comune](/windows/win32/shell/common-file-dialog).</span><span class="sxs-lookup"><span data-stu-id="ced1a-113">\[Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](/windows/win32/shell/common-file-dialog).</span></span> <span data-ttu-id="ced1a-114">È consigliabile usare l'API Common Item Dialog al posto di queste finestre di dialogo di Common Dialog Box Library.\]</span><span class="sxs-lookup"><span data-stu-id="ced1a-114">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.\]</span></span>

<span data-ttu-id="ced1a-115">La **finestra** di dialogo Apri consente all'utente di specificare l'unità, la directory e il nome di un file o di un set di file da aprire.</span><span class="sxs-lookup"><span data-stu-id="ced1a-115">The **Open** dialog box lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span> <span data-ttu-id="ced1a-116">Per creare e visualizzare una **finestra** di dialogo Apri, inizializzare una struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) e passare la struttura [**alla funzione GetOpenFileName.**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea)</span><span class="sxs-lookup"><span data-stu-id="ced1a-116">You create and display an **Open** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function.</span></span>

<span data-ttu-id="ced1a-117">La **finestra di dialogo** Salva con nome consente all'utente di specificare l'unità, la directory e il nome di un file da salvare.</span><span class="sxs-lookup"><span data-stu-id="ced1a-117">The **Save As** dialog box lets the user specify the drive, directory, and name of a file to save.</span></span> <span data-ttu-id="ced1a-118">Per creare e visualizzare una **finestra di** dialogo Salva con nome, inizializzare una struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) e passare la struttura alla [**funzione GetSaveFileName.**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea)</span><span class="sxs-lookup"><span data-stu-id="ced1a-118">You create and display a **Save As** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) function.</span></span>

<span data-ttu-id="ced1a-119">Le finestre di **dialogo** Apri e **Salva con** nome in stile Esplora risorse offrono funzionalità dell'interfaccia utente simili alle Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-119">Explorer-style **Open** and **Save As** dialog boxes provide user-interface features that are similar to the Windows Explorer.</span></span> <span data-ttu-id="ced1a-120">Tuttavia, il sistema continua a  supportare le finestre di dialogo Apri e **Salva** con nome di tipo precedente per le applicazioni che devono essere coerenti con l'interfaccia utente precedente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-120">However, the system continues to support old-style **Open** and **Save As** dialog boxes for applications that must be consistent with the old-style user interface.</span></span>

<span data-ttu-id="ced1a-121">Oltre alla differenza di aspetto, le finestre di dialogo di tipo Esplora risorse e stile precedente differiscono per l'uso di modelli personalizzati e procedure hook per la personalizzazione delle finestre di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-121">In addition to the difference in appearance, the Explorer-style and old-style dialog boxes differ in their use of custom templates and hook procedures for customizing the dialog boxes.</span></span> <span data-ttu-id="ced1a-122">Tuttavia, le finestre di dialogo stile Esplora risorse e stile precedente hanno lo stesso comportamento per la maggior parte delle operazioni di base, ad esempio la specifica di un filtro di nome file, la convalida dell'input dell'utente e il recupero del nome file specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-122">However, the Explorer-style and old-style dialog boxes have the same behavior for most basic operations, such as specifying a file name filter, validating the user's input, and getting the file name specified by the user.</span></span> <span data-ttu-id="ced1a-123">Per altre informazioni sulle finestre di dialogo in stile Esplora risorse e vecchio stile, vedere Personalizzazione della finestra di dialogo Apri [e salva con nome](#open-and-save-as-dialog-box-customization).</span><span class="sxs-lookup"><span data-stu-id="ced1a-123">For more information about the Explorer-style and old-style dialog boxes, see [Open and Save As Dialog Box Customization](#open-and-save-as-dialog-box-customization).</span></span>

<span data-ttu-id="ced1a-124">La figura seguente mostra una tipica finestra di dialogo **Apri in** stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-124">The following illustration shows a typical Explorer-style **Open** dialog box.</span></span>

![Finestra di dialogo Apri file](images/opendialogboxxp.png)

<span data-ttu-id="ced1a-126">La figura seguente mostra una tipica finestra di dialogo **Salva con** nome in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-126">The following illustration shows a typical Explorer-style **Save As** dialog box.</span></span>

![Finestra di dialogo Salva file](images/saveasdialogboxxp.png)

<span data-ttu-id="ced1a-128">Se l'utente specifica un nome di file e fa clic sul **pulsante OK,** [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) o [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) restituisce **TRUE.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-128">If the user specifies a file name and clicks the **OK** button, [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) returns **TRUE**.</span></span> <span data-ttu-id="ced1a-129">Il buffer a cui punta il **membro lpstrFile** della struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) contiene il percorso completo e il nome file specificati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-129">The buffer pointed to by the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure contains the full path and file name specified by the user.</span></span>

<span data-ttu-id="ced1a-130">Se l'utente annulla  la finestra **di** dialogo Apri o Salva con nome o si verifica un errore, la funzione restituisce **FALSE.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-130">If the user cancels the **Open** or **Save As** dialog box or an error occurs, the function returns **FALSE**.</span></span> <span data-ttu-id="ced1a-131">Per determinare la causa dell'errore, chiamare la [**funzione CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) per recuperare il valore di errore esteso.</span><span class="sxs-lookup"><span data-stu-id="ced1a-131">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span> <span data-ttu-id="ced1a-132">Se il buffer **lpstrFile** è troppo piccolo per ricevere il nome completo, **CommDlgExtendedError** restituisce **FNERR \_ BUFFERTOOSMALL** e i primi 2 byte del buffer a cui punta il membro **lpstrFile** sono impostati su un valore intero che specifica le dimensioni necessarie per ricevere il nome completo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-132">If the **lpstrFile** buffer is too small to receive the full name, **CommDlgExtendedError** returns **FNERR\_BUFFERTOOSMALL** and the first 2 bytes of the buffer pointed to by the **lpstrFile** member are set to an integer value specifying the size required to receive the full name.</span></span>

<span data-ttu-id="ced1a-133">In questa sezione vengono descritti gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="ced1a-133">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="ced1a-134">Nomi di file e directory</span><span class="sxs-lookup"><span data-stu-id="ced1a-134">File Names and Directories</span></span>](#file-names-and-directories)
-   [<span data-ttu-id="ced1a-135">Filtri</span><span class="sxs-lookup"><span data-stu-id="ced1a-135">Filters</span></span>](#filters)
-   [<span data-ttu-id="ced1a-136">Convalida di file e directory</span><span class="sxs-lookup"><span data-stu-id="ced1a-136">File and Directory Validation</span></span>](#file-and-directory-validation)
-   [<span data-ttu-id="ced1a-137">Personalizzazione della finestra di dialogo Apri e salva con nome</span><span class="sxs-lookup"><span data-stu-id="ced1a-137">Open and Save As Dialog Box Customization</span></span>](#open-and-save-as-dialog-box-customization)
-   [<span data-ttu-id="ced1a-138">Procedure hook in stile Explorer</span><span class="sxs-lookup"><span data-stu-id="ced1a-138">Explorer-Style Hook Procedures</span></span>](#explorer-style-hook-procedures)
-   [<span data-ttu-id="ced1a-139">Modelli personalizzati in stile Explorer</span><span class="sxs-lookup"><span data-stu-id="ced1a-139">Explorer-Style Custom Templates</span></span>](#explorer-style-custom-templates)
-   [<span data-ttu-id="ced1a-140">Identificatori di controllo in stile Explorer</span><span class="sxs-lookup"><span data-stu-id="ced1a-140">Explorer-Style Control Identifiers</span></span>](#explorer-style-control-identifiers)
-   [<span data-ttu-id="ced1a-141">Personalizzazione di Old-Style finestre di dialogo</span><span class="sxs-lookup"><span data-stu-id="ced1a-141">Customizing Old-Style Dialog Boxes</span></span>](#customizing-old-style-dialog-boxes)

## <a name="file-names-and-directories"></a><span data-ttu-id="ced1a-142">Nomi di file e directory</span><span class="sxs-lookup"><span data-stu-id="ced1a-142">File Names and Directories</span></span>

<span data-ttu-id="ced1a-143">Le informazioni contenute in questa sezione si  applicano sia alle finestre di dialogo Apri e **Salva con nome** in stile Esplora risorse che a quella precedente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-143">The information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="ced1a-144">Prima di chiamare le funzioni [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) o [**GetSaveFileName,**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) il membro **lpstrFile** della struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) deve puntare al buffer per ricevere il nome del file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-144">Before calling the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions, the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must point to the buffer to receive the file name.</span></span> <span data-ttu-id="ced1a-145">Il **membro nMaxFile** deve specificare le dimensioni, in caratteri, del buffer **lpstrFile.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-145">The **nMaxFile** member must specify the size, in characters, of the **lpstrFile** buffer.</span></span> <span data-ttu-id="ced1a-146">Per una funzione ANSI si tratta del numero di byte, ma per una funzione Unicode si tratta del numero di caratteri.</span><span class="sxs-lookup"><span data-stu-id="ced1a-146">For an ANSI function this is the number of bytes, but for a Unicode function this is the number of characters.</span></span>

<span data-ttu-id="ced1a-147">Se l'utente specifica un nome file e fa clic sul pulsante **OK,** la finestra di dialogo copia l'unità, la directory e il nome file selezionati nel buffer **lpstrFile.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-147">If the user specifies a file name and clicks the **OK** button, the dialog box copies the selected drive, directory, and file name to the **lpstrFile** buffer.</span></span> <span data-ttu-id="ced1a-148">La funzione imposta anche i membri **nFileOffset** e **nFileExtension** rispettivamente per gli offset, in caratteri, dall'inizio del buffer al nome del file e all'estensione del nome file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-148">The function also sets the **nFileOffset** and **nFileExtension** members to the offsets, in characters, from the start of the buffer to the file name and to the file name extension, respectively.</span></span>

<span data-ttu-id="ced1a-149">Per recuperare solo il nome file e l'estensione, impostare il membro **lpstrFileTitle** in modo che punti a un buffer e impostare il membro **nMaxFileTitle** sulla dimensione, in caratteri, del buffer.</span><span class="sxs-lookup"><span data-stu-id="ced1a-149">To retrieve just the file name and extension, set the **lpstrFileTitle** member to point to a buffer and set the **nMaxFileTitle** member to the size, in characters, of the buffer.</span></span> <span data-ttu-id="ced1a-150">In alternativa, è possibile passare il buffer **lpstrFile** in una chiamata alla [**funzione GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) per ottenere il nome visualizzato del file selezionato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-150">Alternatively, you can pass the **lpstrFile** buffer in a call to the [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) function to get the display name of the selected file.</span></span> <span data-ttu-id="ced1a-151">Si noti, tuttavia, che il nome file restituito da **GetFileTitle** include un'estensione solo se questa è la preferenza dell'utente per la visualizzazione dei nomi di file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-151">Note, however, that the file name that **GetFileTitle** returns includes an extension only if that is the user's preference for displaying file names.</span></span>

<span data-ttu-id="ced1a-152">Nella finestra di dialogo viene utilizzata la directory corrente per il processo chiamante come directory iniziale da cui visualizzare file e directory.</span><span class="sxs-lookup"><span data-stu-id="ced1a-152">The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories.</span></span> <span data-ttu-id="ced1a-153">Usare le [**funzioni GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) [**e SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) per ottenere e modificare la directory corrente di un processo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-153">Use the [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) and [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) functions to get and change the current directory of a process.</span></span> <span data-ttu-id="ced1a-154">Per specificare una directory iniziale diversa senza modificare la directory corrente, usare il membro **lpstrInitialDir** per specificare il nome di una directory.</span><span class="sxs-lookup"><span data-stu-id="ced1a-154">To specify a different initial directory without changing your current directory, use the **lpstrInitialDir** member to specify the name of a directory.</span></span> <span data-ttu-id="ced1a-155">La finestra di dialogo modifica automaticamente la directory corrente quando l'utente seleziona un'unità o una directory diversa.</span><span class="sxs-lookup"><span data-stu-id="ced1a-155">The dialog box automatically changes your current directory when the user selects a different drive or directory.</span></span> <span data-ttu-id="ced1a-156">Per impedire alla finestra di dialogo di modificare la directory corrente, impostare il flag **OFN \_ NOCHANGEDIR.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-156">To prevent the dialog box from changing your current directory, set the **OFN\_NOCHANGEDIR** flag.</span></span> <span data-ttu-id="ced1a-157">Questo flag non impedisce all'utente di modificare le directory per trovare un file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-157">This flag does not prevent the user from changing directories to find a file.</span></span>

<span data-ttu-id="ced1a-158">Per specificare un'estensione di file predefinita, usare il **membro lpstrDefExt.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-158">To specify a default file name extension, use the **lpstrDefExt** member.</span></span> <span data-ttu-id="ced1a-159">Se l'utente specifica un nome di file che non ha un'estensione, la finestra di dialogo aggiunge l'estensione predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-159">If the user specifies a file name that does not have an extension, the dialog box adds your default extension.</span></span> <span data-ttu-id="ced1a-160">Se si specifica un'estensione predefinita e l'utente specifica un nome file con un'estensione diversa, nella finestra di dialogo viene impostato il flag **\_ OFN EXTENSIONDIFFERENT.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-160">If you specify a default extension and the user specifies a file name with a different extension, the dialog box sets the **OFN\_EXTENSIONDIFFERENT** flag.</span></span>

<span data-ttu-id="ced1a-161">Per consentire all'utente di selezionare più file da una directory, impostare il flag **OFN \_ ALLOWMULTISELECT.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-161">To let the user select more than one file from a directory, set the **OFN\_ALLOWMULTISELECT** flag.</span></span> <span data-ttu-id="ced1a-162">Per garantire la compatibilità con le applicazioni precedenti, la finestra di dialogo di selezione multipla predefinita usa l'interfaccia utente precedente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-162">For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface.</span></span> <span data-ttu-id="ced1a-163">Per visualizzare una finestra di dialogo di selezione multipla in stile Esplora risorse, è necessario impostare anche il flag **OFN \_ EXPLORER.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-163">To display an Explorer-style multiple selection dialog box, you must also set the **OFN\_EXPLORER** flag.</span></span>

<span data-ttu-id="ced1a-164">Se l'utente seleziona più di un file, il buffer a cui punta il membro **lpstrFile** restituisce il percorso della directory corrente seguito dai nomi dei file selezionati.</span><span class="sxs-lookup"><span data-stu-id="ced1a-164">If the user selects more than one file, the buffer pointed to by the **lpstrFile** member returns the path to the current directory followed by the file names of the selected files.</span></span> <span data-ttu-id="ced1a-165">Il **membro nFileOffset** è l'offset del primo nome file e il **membro nFileExtension** non viene usato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-165">The **nFileOffset** member is the offset to the first file name, and the **nFileExtension** member is not used.</span></span> <span data-ttu-id="ced1a-166">Nella tabella seguente viene descritta la differenza tra le finestre di dialogo in stile Esplora risorse e le finestre di dialogo di stile precedente per la restituzione di più nomi di file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-166">The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple file names.</span></span>



| <span data-ttu-id="ced1a-167">Stile della finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="ced1a-167">Dialog box style</span></span>            | <span data-ttu-id="ced1a-168">Descrizione</span><span class="sxs-lookup"><span data-stu-id="ced1a-168">Description</span></span>                                                                                                                                                                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ced1a-169">Finestre di dialogo in stile Explorer</span><span class="sxs-lookup"><span data-stu-id="ced1a-169">Explorer-style dialog boxes</span></span> | <span data-ttu-id="ced1a-170">Le stringhe di directory e nome file **sono separate da NULL,** con un carattere **NULL aggiuntivo** dopo l'ultimo nome file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-170">The directory and file name strings are **NULL** separated, with an extra **NULL** character after the last file name.</span></span> <span data-ttu-id="ced1a-171">Questo formato consente alle finestre di dialogo di tipo Esplora risorse di restituire nomi di file lunghi che includono spazi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-171">This format enables the Explorer-style dialog boxes to return long file names that include spaces.</span></span> |
| <span data-ttu-id="ced1a-172">Finestre di dialogo di vecchio stile</span><span class="sxs-lookup"><span data-stu-id="ced1a-172">Old-style dialog boxes</span></span>      | <span data-ttu-id="ced1a-173">Le stringhe di directory e nome file sono separate da spazi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-173">The directory and file name strings are separated by spaces.</span></span> <span data-ttu-id="ced1a-174">Per i nomi di file con spazi, la funzione usa nomi di file brevi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-174">For file names with spaces, the function uses short file names.</span></span>                                                                                              |



 

<span data-ttu-id="ced1a-175">È possibile usare la [**funzione FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) per eseguire la conversione tra nomi di file lunghi e brevi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-175">You can use the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) function to convert between long and short file names.</span></span>

<span data-ttu-id="ced1a-176">Se si specifica **OFN \_ ALLOWMULTISELECT** e l'utente seleziona un solo file, la stringa **lpstrFile** non include un separatore tra il percorso e il nome del file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-176">If you specify **OFN\_ALLOWMULTISELECT** and the user selects only one file, the **lpstrFile** string does not have a separator between the path and file name.</span></span>

## <a name="filters"></a><span data-ttu-id="ced1a-177">Filtri</span><span class="sxs-lookup"><span data-stu-id="ced1a-177">Filters</span></span>

<span data-ttu-id="ced1a-178">Le informazioni contenute in questa sezione si  applicano alle finestre di dialogo Apri e **Salva** con nome in stile Esplora risorse e stile precedente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-178">The information in this section applies to both Explorer-style and old style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="ced1a-179">È possibile specificare filtri per i nomi di file che consentono all'utente di limitare i nomi di file visualizzati nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-179">You can provide file name filters to assist the user in limiting the file names that the dialog box displays.</span></span> <span data-ttu-id="ced1a-180">Un filtro di nome file è costituito da una coppia di stringhe con terminazione Null, una descrizione e un modello, una concatenata all'altra.</span><span class="sxs-lookup"><span data-stu-id="ced1a-180">A file name filter consists of a pair of null-terminated strings, a description and a pattern, one concatenated to the other.</span></span> <span data-ttu-id="ced1a-181">Nella finestra di dialogo viene visualizzata la descrizione per consentire all'utente di scegliere il filtro da usare. e usa il modello per selezionare i file da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="ced1a-181">The dialog box displays the description to let the user pick which filter to use; and it uses the pattern to select the files to display.</span></span>

<span data-ttu-id="ced1a-182">Per specificare i filtri, impostare il membro **lpstrFilter** della struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) in modo che punti a un buffer che contiene una matrice di coppie di stringhe di filtro.</span><span class="sxs-lookup"><span data-stu-id="ced1a-182">To specify the filters, set the **lpstrFilter** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to point to a buffer that contains an array of filter string pairs.</span></span> <span data-ttu-id="ced1a-183">L'ultima stringa nella matrice deve essere seguita da un carattere Null aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-183">The last string in the array must be followed by an extra null character.</span></span>

<span data-ttu-id="ced1a-184">Una stringa di criteri può essere una combinazione di caratteri validi per il nome file e l'asterisco ( \* ).</span><span class="sxs-lookup"><span data-stu-id="ced1a-184">A pattern string can be a combination of valid file name characters and the asterisk (\*).</span></span> <span data-ttu-id="ced1a-185">L'asterisco è un carattere jolly che rappresenta qualsiasi combinazione di caratteri validi del nome file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-185">The asterisk is a wildcard that represents any combination of valid file name characters.</span></span> <span data-ttu-id="ced1a-186">Nella finestra di dialogo vengono visualizzati solo i file che corrispondono al modello.</span><span class="sxs-lookup"><span data-stu-id="ced1a-186">The dialog box displays only those files that match the pattern.</span></span> <span data-ttu-id="ced1a-187">Per specificare più criteri per la stessa descrizione, è necessario usare un punto e virgola (;) per separare i modelli.</span><span class="sxs-lookup"><span data-stu-id="ced1a-187">To specify multiple patterns for the same description, you must use a semicolon (;) to separate the patterns.</span></span> <span data-ttu-id="ced1a-188">Si noti che gli spazi nella stringa del criterio possono produrre risultati imprevisti.</span><span class="sxs-lookup"><span data-stu-id="ced1a-188">Note that space characters in the pattern string can produce unexpected results.</span></span>

<span data-ttu-id="ced1a-189">Nel frammento di codice seguente vengono specificati due filtri.</span><span class="sxs-lookup"><span data-stu-id="ced1a-189">The following code fragment specifies two filters.</span></span> <span data-ttu-id="ced1a-190">Il filtro con la descrizione "Source" ha due modelli.</span><span class="sxs-lookup"><span data-stu-id="ced1a-190">The filter with the "Source" description has two patterns.</span></span> <span data-ttu-id="ced1a-191">Se l'utente seleziona questo filtro, nella finestra di dialogo vengono visualizzati solo i file con . C e . Estensioni CXX.</span><span class="sxs-lookup"><span data-stu-id="ced1a-191">If the user selects this filter, the dialog box displays only files that have the .C and .CXX extensions.</span></span> <span data-ttu-id="ced1a-192">Si noti che nel linguaggio di programmazione C una stringa racchiusa tra virgolette doppie ha terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="ced1a-192">Note, in the C programming language, a string enclosed in double quotes is null-terminated.</span></span>


```
OPENFILENAME ofn;       // common dialog box structure

ofn.lpstrFilter = "Source\0*.C;*.CXX\0All\0*.*\0"
ofn.nFilterIndex = 1;
```



<span data-ttu-id="ced1a-193">Il **membro nFilterIndex** della struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) specifica un indice che indica quale filtro viene inizialmente utilizzato dalla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-193">The **nFilterIndex** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure specifies an index that indicates which filter the dialog box initially uses.</span></span> <span data-ttu-id="ced1a-194">Il primo filtro nel buffer include l'indice 1, il secondo 2 e così via.</span><span class="sxs-lookup"><span data-stu-id="ced1a-194">The first filter in the buffer has index 1, the second 2, and so on.</span></span> <span data-ttu-id="ced1a-195">Se l'utente modifica il filtro durante l'uso della finestra di dialogo, il membro **nFilterIndex** viene impostato sull'indice del filtro selezionato al ritorno.</span><span class="sxs-lookup"><span data-stu-id="ced1a-195">If the user changes the filter while using the dialog box, the **nFilterIndex** member is set to the index of the selected filter on return.</span></span>

<span data-ttu-id="ced1a-196">È possibile creare un filtro personalizzato impostando il membro **lpstrCustomFilter** sull'indirizzo di un buffer che contiene un singolo filtro e impostando il membro **nMaxCustFilter** sulla dimensione del buffer, in caratteri o byte.</span><span class="sxs-lookup"><span data-stu-id="ced1a-196">You can create a custom filter by setting the **lpstrCustomFilter** member to the address of a buffer that contains a single filter, and by setting the **nMaxCustFilter** member to the size of the buffer, in characters or bytes.</span></span> <span data-ttu-id="ced1a-197">La finestra di dialogo inserisce sempre il filtro personalizzato all'inizio dell'elenco di filtri e, in caso di restituzione, aggiorna sempre la parte del criterio del filtro con il criterio del filtro selezionato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-197">The dialog box always places the custom filter at the beginning of the list of filters and, on return, always updates the pattern part of the filter with the pattern from the filter selected by the user.</span></span>

<span data-ttu-id="ced1a-198">Per le finestre di dialogo di tipo Esplora risorse, l'estensione predefinita può cambiare se l'utente seleziona un filtro diverso.</span><span class="sxs-lookup"><span data-stu-id="ced1a-198">For Explorer-style dialog boxes, the default extension may change if the user selects a different filter.</span></span> <span data-ttu-id="ced1a-199">Se l'utente seleziona un filtro il cui primo criterio è nel formato \* .*xxx* (ovvero l'estensione non include un carattere jolly), la finestra di dialogo usa *xxx* come estensione predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-199">If the user selects a filter whose first pattern is of the form \*.*xxx* (that is, the extension does not include a wildcard character), the dialog box uses *xxx* as the default extension.</span></span> <span data-ttu-id="ced1a-200">Ciò si verifica solo se è stata specificata un'estensione predefinita nel membro **lpstrDefExt** della [**struttura OPENFILENAME.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="ced1a-200">This occurs only if you specified a default extension in the **lpstrDefExt** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span> <span data-ttu-id="ced1a-201">Ad esempio, se l'utente seleziona "Origine \\ \* 0. C; \* . Filtro CXX \\ 0", l'estensione predefinita viene modificata in "C".</span><span class="sxs-lookup"><span data-stu-id="ced1a-201">For example, if the user selects the "Source\\0\*.C;\*.CXX\\0" filter, the default extension changes to "C".</span></span> <span data-ttu-id="ced1a-202">Tuttavia, se il filtro è stato definito come "Origine \\ \* 0. C \* \\ 0", l'estensione predefinita non cambierebbe perché l'estensione include un carattere jolly.</span><span class="sxs-lookup"><span data-stu-id="ced1a-202">However, if you had defined the filter as "Source\\0\*.C\*\\0", the default extension would not change because the extension includes a wildcard.</span></span>

<span data-ttu-id="ced1a-203">Il [**messaggio di notifica \_ INCLUDEITEM**](cdn-includeitem.md) della rete CDN offre un altro modo per filtrare i nomi visualizzati nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-203">The [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message provides another way to filter the names that the dialog box displays.</span></span> <span data-ttu-id="ced1a-204">Per usare questo messaggio, specificare una routine hook [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) e specificare il flag **OFN \_ ENABLEINCLUDENOTIFY** nella struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) quando si crea la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-204">To use this message, provide an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure and specify the **OFN\_ENABLEINCLUDENOTIFY** flag in the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="ced1a-205">Ogni volta che l'utente apre una cartella, la finestra di dialogo invia una notifica **\_ INCLUDEITEM della rete CDN** alla procedura hook per ogni elemento nella cartella appena aperta.</span><span class="sxs-lookup"><span data-stu-id="ced1a-205">Each time the user opens a folder, the dialog box sends a **CDN\_INCLUDEITEM** notification to your hook procedure for each item in the newly opened folder.</span></span> <span data-ttu-id="ced1a-206">Il valore restituito della routine hook indica se la finestra di dialogo deve visualizzare l'elemento nell'elenco di elementi della cartella.</span><span class="sxs-lookup"><span data-stu-id="ced1a-206">The return value of the hook procedure indicates whether the dialog box should display the item in the folder's item list.</span></span>

## <a name="file-and-directory-validation"></a><span data-ttu-id="ced1a-207">Convalida di file e directory</span><span class="sxs-lookup"><span data-stu-id="ced1a-207">File and Directory Validation</span></span>

<span data-ttu-id="ced1a-208">Ad eccezione di quanto specificato, le informazioni contenute in  questa sezione si applicano sia alle finestre di dialogo Apri e Salva con nome in stile Esplora risorse che alle finestre di dialogo Apri e **Salva** con nome.</span><span class="sxs-lookup"><span data-stu-id="ced1a-208">Except as noted, the information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="ced1a-209">La finestra di dialogo convalida automaticamente i nomi di file digitati dall'utente per garantire che i nomi contengano solo caratteri validi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-209">The dialog box automatically validates file names typed by the user to ensure that the names contain only valid characters.</span></span> <span data-ttu-id="ced1a-210">Per eseguire l'override della convalida dei caratteri del nome file, impostare il flag **\_ OFN NOVALIDATE.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-210">To override the file name character validation, set the **OFN\_NOVALIDATE** flag.</span></span>

<span data-ttu-id="ced1a-211">Per forzare la finestra di dialogo per verificare che l'utente ha specificato il nome di un file esistente, impostare il flag **\_ OFN FILEMUSTEXIST.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-211">To force the dialog box to verify that the user specified the name of an existing file, set the **OFN\_FILEMUSTEXIST** flag.</span></span> <span data-ttu-id="ced1a-212">Per forzare la verifica dell'esistenza del percorso specificato, impostare il flag **\_ OFN PATHMUSTEXIST.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-212">To force verification that the specified path exists, set the **OFN\_PATHMUSTEXIST** flag.</span></span> <span data-ttu-id="ced1a-213">Se si imposta il flag **OFN \_ CREATEPROMPT,** la finestra di dialogo richiede all'utente l'autorizzazione per creare un file inesistente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-213">If you set the **OFN\_CREATEPROMPT** flag, the dialog box prompts the user for permission to create a nonexistent file.</span></span> <span data-ttu-id="ced1a-214">Se questo flag è impostato e l'utente sceglie di creare un nuovo file, la finestra di dialogo viene chiusa e la funzione restituisce il nome specificato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-214">If this flag is set and the user chooses to create a new file, the dialog box closes, and the function returns the specified name.</span></span> <span data-ttu-id="ced1a-215">In caso contrario, la finestra di dialogo rimane aperta.</span><span class="sxs-lookup"><span data-stu-id="ced1a-215">Otherwise, the dialog box remains open.</span></span>

<span data-ttu-id="ced1a-216">Quando si usa la **finestra** di dialogo Salva con nome , è possibile indirizzare la finestra di dialogo per richiedere all'utente l'autorizzazione per sovrascrivere un file esistente impostando il flag **\_ OFN OVERWRITEPROMPT.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-216">When using the **Save As** dialog box, you can direct the dialog box to prompt the user for permission to overwrite an existing file by setting the **OFN\_OVERWRITEPROMPT** flag.</span></span>

<span data-ttu-id="ced1a-217">Per impostazione predefinita, la finestra di dialogo crea un file di test di lunghezza zero per determinare se è possibile creare un nuovo file nella directory selezionata.</span><span class="sxs-lookup"><span data-stu-id="ced1a-217">By default, the dialog box creates a zero-length test file to determine whether a new file can be created in the selected directory.</span></span> <span data-ttu-id="ced1a-218">Per impedire la creazione di questo file di test, impostare il flag **OFN \_ NOTESTFILECREATE.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-218">To prevent the creation of this test file, set the **OFN\_NOTESTFILECREATE** flag.</span></span>

<span data-ttu-id="ced1a-219">Se si abilita una routine hook, la finestra di dialogo invia una notifica alla procedura hook quando si verifica una violazione della condivisione di rete per il nome file specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-219">If you enable a hook procedure, the dialog box notifies your hook procedure when a network sharing violation occurs for the file name specified by the user.</span></span> <span data-ttu-id="ced1a-220">Se si imposta il flag **OFN \_ EXPLORER,** la finestra di dialogo invia il messaggio [**\_ SHAREVIOLATION**](cdn-shareviolation.md) della rete CDN alla procedura hook.</span><span class="sxs-lookup"><span data-stu-id="ced1a-220">If you set the **OFN\_EXPLORER** flag, the dialog box sends the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) message to the hook procedure.</span></span> <span data-ttu-id="ced1a-221">Se non si imposta **OFN \_ EXPLORER,** la finestra di dialogo invia il messaggio registrato [**SHAREVISTRING**](sharevistring.md) alla procedura hook.</span><span class="sxs-lookup"><span data-stu-id="ced1a-221">If you do not set **OFN\_EXPLORER**, the dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to the hook procedure.</span></span> <span data-ttu-id="ced1a-222">Per impedire alla finestra di dialogo di inviare notifiche per violazioni di condivisione, impostare il flag **\_ SHAREAWARE OFN.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-222">To prevent the dialog box from sending any notifications for sharing violations, set the **OFN\_SHAREAWARE** flag.</span></span>

<span data-ttu-id="ced1a-223">Se l'utente seleziona la casella di controllo di sola lettura, la finestra di dialogo imposta il flag **OFN \_ READONLY** al ritorno.</span><span class="sxs-lookup"><span data-stu-id="ced1a-223">If the user selects the read-only check box, the dialog box sets the **OFN\_READONLY** flag on return.</span></span> <span data-ttu-id="ced1a-224">Per nascondere la **casella di controllo Apri** come sola lettura, impostare il flag **\_ OFN HIDEREADONLY.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-224">To hide the **Open As Read Only** check box, set the **OFN\_HIDEREADONLY** flag.</span></span> <span data-ttu-id="ced1a-225">Per impedire alla finestra di dialogo di restituire nomi di file esistenti con l'attributo di sola lettura, impostare il flag **OFN \_ NOREADONLYRETURN.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-225">To prevent the dialog box from returning names of existing files that have the read-only attribute, set the **OFN\_NOREADONLYRETURN** flag.</span></span>

<span data-ttu-id="ced1a-226">Per impedire alla finestra di dialogo di rinviare i file di collegamento, impostare il **valore DIN \_ NODEREFERENCELINKS.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-226">To prevent the dialog box from dereferencing link files, set the **OFN\_NODEREFERENCELINKS** value.</span></span> <span data-ttu-id="ced1a-227">In questo caso, la finestra di dialogo restituisce il nome del file di collegamento anziché il nome del file a cui fa riferimento il file di collegamento.</span><span class="sxs-lookup"><span data-stu-id="ced1a-227">In this case, the dialog box returns the name of the link file rather than the name of the file referenced by the link file.</span></span>

## <a name="open-and-save-as-dialog-box-customization"></a><span data-ttu-id="ced1a-228">Personalizzazione della finestra di dialogo Apri e salva con nome</span><span class="sxs-lookup"><span data-stu-id="ced1a-228">Open and Save As Dialog Box Customization</span></span>

<span data-ttu-id="ced1a-229">È possibile personalizzare una **finestra di** **dialogo** Apri o Salva con nome fornendo una routine hook, un modello personalizzato o entrambi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-229">You can customize an **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="ced1a-230">Tuttavia, le versioni in stile Esplora risorse e le versioni precedenti delle finestre di dialogo differiscono per l'uso di modelli personalizzati e procedure hook.</span><span class="sxs-lookup"><span data-stu-id="ced1a-230">However, the Explorer-style and old-style versions of the dialog boxes differ in their use of custom templates and hook procedures.</span></span>

<span data-ttu-id="ced1a-231">Per informazioni sulla personalizzazione di una finestra di dialogo in stile Esplora risorse, vedere Procedure [hook](#explorer-style-hook-procedures)in stile Esplora risorse [,](#explorer-style-custom-templates)Modelli personalizzati in stile Esplora risorse e Identificatori di controllo in stile Esplora [risorse](#explorer-style-control-identifiers).</span><span class="sxs-lookup"><span data-stu-id="ced1a-231">For information about customizing an Explorer-style dialog box, see [Explorer-Style Hook Procedures](#explorer-style-hook-procedures), [Explorer-Style Custom Templates](#explorer-style-custom-templates), and [Explorer-Style Control Identifiers](#explorer-style-control-identifiers).</span></span> <span data-ttu-id="ced1a-232">Per informazioni sulla personalizzazione di una finestra di dialogo di stile precedente, vedere [Personalizzazione](#customizing-old-style-dialog-boxes)Old-Style finestre di dialogo .</span><span class="sxs-lookup"><span data-stu-id="ced1a-232">For information about customizing an old-style dialog box, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="ced1a-233">Nella tabella seguente sono riepilogate le differenze tra i due stili.</span><span class="sxs-lookup"><span data-stu-id="ced1a-233">The following table summarizes the differences between the two styles.</span></span>



| <span data-ttu-id="ced1a-234">Personalizzazione</span><span class="sxs-lookup"><span data-stu-id="ced1a-234">Customization</span></span>                  | <span data-ttu-id="ced1a-235">Descrizione</span><span class="sxs-lookup"><span data-stu-id="ced1a-235">Description</span></span>                                                                                                                                                                                                                                                                          |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ced1a-236">Procedura hook in stile Esplora risorse</span><span class="sxs-lookup"><span data-stu-id="ced1a-236">Explorer-style Hook procedure</span></span>  | <span data-ttu-id="ced1a-237">La procedura hook riceve i messaggi di notifica inviati dalla finestra di dialogo comune e i messaggi per tutti i controlli aggiuntivi definiti specificando un modello di finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-237">The hook procedure receives notification messages sent from the common dialog box and messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="ced1a-238">La procedura hook non riceve messaggi per i controlli standard della finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-238">The hook procedure does not receive messages for the standard controls of the default dialog box.</span></span> |
| <span data-ttu-id="ced1a-239">Modello personalizzato in stile Esplora risorse</span><span class="sxs-lookup"><span data-stu-id="ced1a-239">Explorer-style Custom template</span></span> | <span data-ttu-id="ced1a-240">Il sistema usa il modello personalizzato per creare una finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-240">The system uses the custom template to create a child dialog box.</span></span> <span data-ttu-id="ced1a-241">Il modello può definire controlli aggiuntivi e può specificare la posizione del cluster di controlli standard.</span><span class="sxs-lookup"><span data-stu-id="ced1a-241">The template can define additional controls, and can specify the location of the cluster of standard controls.</span></span> <span data-ttu-id="ced1a-242">Il modello personalizzato non sostituisce il modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="ced1a-242">The custom template does not replace the default template.</span></span>                                          |
| <span data-ttu-id="ced1a-243">Procedura hook in stile precedente</span><span class="sxs-lookup"><span data-stu-id="ced1a-243">Old-style Hook procedure</span></span>       | <span data-ttu-id="ced1a-244">La routine hook riceve tutti i messaggi inviati alla finestra di dialogo, inclusi i messaggi per i controlli standard e tutti i controlli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="ced1a-244">The hook procedure receives all messages sent to the dialog box, including messages for the standard controls and any custom controls.</span></span> <span data-ttu-id="ced1a-245">La procedura hook riceve anche i messaggi registrati inviati dalla finestra di dialogo comune.</span><span class="sxs-lookup"><span data-stu-id="ced1a-245">The hook procedure also receives registered messages sent from the common dialog box.</span></span>                                                         |
| <span data-ttu-id="ced1a-246">Modello personalizzato di vecchio stile</span><span class="sxs-lookup"><span data-stu-id="ced1a-246">Old-style Custom template</span></span>      | <span data-ttu-id="ced1a-247">Il modello personalizzato sostituisce il modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="ced1a-247">The custom template replaces the default template.</span></span> <span data-ttu-id="ced1a-248">Creare il modello personalizzato modificando il modello predefinito specificato nel file Fileopen.dlg.</span><span class="sxs-lookup"><span data-stu-id="ced1a-248">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span>                                                                                                                                  |



 

<span data-ttu-id="ced1a-249">Il titolo predefinito per entrambe le finestre di dialogo di tipo Esplora risorse e precedente è "**Apri**" o **"Salva con nome".**</span><span class="sxs-lookup"><span data-stu-id="ced1a-249">The default title for both Explorer-style and old-style dialog boxes is either "**Open**" or "**Save As**."</span></span> <span data-ttu-id="ced1a-250">Per modificare il titolo, specificare il nuovo titolo nel membro **lpstrTitle** della [**struttura OPENFILENAME.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="ced1a-250">To change the title, specify the new title in the **lpstrTitle** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="ced1a-251">L'hive del Registro di sistema **HKEY CURRENT \_ \_ USER** di un  utente può contenere valori che personalizzano il contenuto delle finestre di dialogo Apri e **Salva con** nome in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-251">A user's **HKEY\_CURRENT\_USER** registry hive can contain values that customize the contents of the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="ced1a-252">Queste voci del Registro di sistema influiscono solo sulle finestre di dialogo visualizzate per l'utente associato all'hive del Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="ced1a-252">These registry entries affect only the dialog boxes displayed for the user associated with the registry hive.</span></span>

<span data-ttu-id="ced1a-253">Per nascondere le funzionalità  delle finestre di dialogo Apri e **Salva** con nome in stile Esplora risorse, un amministratore può impostare i valori nella tabella seguente in questa sottochiave:</span><span class="sxs-lookup"><span data-stu-id="ced1a-253">To hide features of Explorer-style **Open** and **Save As** dialog boxes, an administrator can set the values in the following table under this subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
```



| <span data-ttu-id="ced1a-254">Nome del valore</span><span class="sxs-lookup"><span data-stu-id="ced1a-254">Value name</span></span>       | <span data-ttu-id="ced1a-255">Valore</span><span class="sxs-lookup"><span data-stu-id="ced1a-255">Value</span></span> | <span data-ttu-id="ced1a-256">Significato</span><span class="sxs-lookup"><span data-stu-id="ced1a-256">Meaning</span></span>                                  |
|------------------|-------|------------------------------------------|
| <span data-ttu-id="ced1a-257">**NoPlacesBar**</span><span class="sxs-lookup"><span data-stu-id="ced1a-257">**NoPlacesBar**</span></span>  | <span data-ttu-id="ced1a-258">1</span><span class="sxs-lookup"><span data-stu-id="ced1a-258">1</span></span>     | <span data-ttu-id="ced1a-259">Nasconde la barra dei luoghi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-259">Hides the places bar.</span></span>                    |
| <span data-ttu-id="ced1a-260">**NoFileMRU**</span><span class="sxs-lookup"><span data-stu-id="ced1a-260">**NoFileMRU**</span></span>    | <span data-ttu-id="ced1a-261">1</span><span class="sxs-lookup"><span data-stu-id="ced1a-261">1</span></span>     | <span data-ttu-id="ced1a-262">Nasconde l'elenco degli elementi usati più di recente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-262">Hides the Most Recently Used (MRU) list.</span></span> |
| <span data-ttu-id="ced1a-263">**NoBackButton**</span><span class="sxs-lookup"><span data-stu-id="ced1a-263">**NoBackButton**</span></span> | <span data-ttu-id="ced1a-264">1</span><span class="sxs-lookup"><span data-stu-id="ced1a-264">1</span></span>     | <span data-ttu-id="ced1a-265">Nasconde il **pulsante** Indietro.</span><span class="sxs-lookup"><span data-stu-id="ced1a-265">Hides the **Back** button.</span></span>               |



 

<span data-ttu-id="ced1a-266">Il contenuto della **barra Posizioni** è determinato dal contenuto della sottochiave seguente:</span><span class="sxs-lookup"><span data-stu-id="ced1a-266">The contents of the **Places** bar are determined by the contents of the following subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
                     Placesbar
```

<span data-ttu-id="ced1a-267">Attualmente, in questa chiave possono essere presenti solo cinque voci e l'indice di valore/nome è in base zero.</span><span class="sxs-lookup"><span data-stu-id="ced1a-267">Currently, there can only be five entries under this key, and the value/name index is zero-based.</span></span> <span data-ttu-id="ced1a-268">I nomi delle voci devono essere Place0, Place1, Place2, Place3 e Place4.</span><span class="sxs-lookup"><span data-stu-id="ced1a-268">The names for the entries should be Place0, Place1, Place2,Place3, and Place4.</span></span> <span data-ttu-id="ced1a-269">I valori delle voci possono essere **REG \_ DWORD,** **REG \_ SZ** o **REG EXPAND \_ \_ SZ** che identificano le posizioni da includere nella barra delle posizioni.</span><span class="sxs-lookup"><span data-stu-id="ced1a-269">The values of the entries can be **REG\_DWORD**, **REG\_SZ**, or **REG\_EXPAND\_SZ** values that identify locations to include in the places bar.</span></span>



| <span data-ttu-id="ced1a-270">Tipo di valore</span><span class="sxs-lookup"><span data-stu-id="ced1a-270">Value type</span></span>                         | <span data-ttu-id="ced1a-271">Significato</span><span class="sxs-lookup"><span data-stu-id="ced1a-271">Meaning</span></span>                                                                                                   |
|------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ced1a-272">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="ced1a-272">**REG\_DWORD**</span></span>                     | <span data-ttu-id="ced1a-273">Valore CSIDL che identifica una cartella.</span><span class="sxs-lookup"><span data-stu-id="ced1a-273">A CSIDL value that identifies a folder.</span></span> <span data-ttu-id="ced1a-274">Per un elenco di valori CSIDL, vedere [**Valori CSIDL**](../shell/csidl.md).</span><span class="sxs-lookup"><span data-stu-id="ced1a-274">For a list of CSIDL values, see [**CSIDL values**](../shell/csidl.md).</span></span> |
| <span data-ttu-id="ced1a-275">**REG \_ SZ** o **REG \_ EXPAND \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="ced1a-275">**REG\_SZ** or **REG\_EXPAND\_SZ**</span></span> | <span data-ttu-id="ced1a-276">Stringa con terminazione Null che specifica un percorso valido.</span><span class="sxs-lookup"><span data-stu-id="ced1a-276">A null-terminated string that specifies a valid path.</span></span>                                                     |



 

## <a name="explorer-style-hook-procedures"></a><span data-ttu-id="ced1a-277">Explorer-Style hook</span><span class="sxs-lookup"><span data-stu-id="ced1a-277">Explorer-Style Hook Procedures</span></span>

<span data-ttu-id="ced1a-278">È possibile personalizzare una finestra  di dialogo **Apri** o Salva con nome in stile Esplora risorse fornendo una routine hook, un modello personalizzato o entrambi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-278">You can customize an Explorer-style **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="ced1a-279">Se si specifica una routine hook per una finestra di dialogo di tipo Esplora risorse, il sistema crea una finestra di dialogo figlio della finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-279">If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box.</span></span> <span data-ttu-id="ced1a-280">La routine hook funge da procedura di dialogo per la finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-280">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="ced1a-281">Questa finestra di dialogo figlio è basata sul modello personalizzato o su un modello predefinito se non ne viene specificata nessuna.</span><span class="sxs-lookup"><span data-stu-id="ced1a-281">This child dialog box is based on the custom template, or on a default template if none is provided.</span></span> <span data-ttu-id="ced1a-282">Per altre informazioni, vedere [Modelli personalizzati in stile Explorer.](#explorer-style-custom-templates)</span><span class="sxs-lookup"><span data-stu-id="ced1a-282">For more information, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

<span data-ttu-id="ced1a-283">Per abilitare una procedura hook  per  una finestra di dialogo Apri o Salva con nome in stile Esplora risorse, usare la struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) quando si crea la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-283">To enable a hook procedure for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="ced1a-284">Impostare i **flag OFN \_ ENABLEHOOK** e **OFN \_ EXPLORER** nel membro **Flags** e specificare l'indirizzo di una procedura hook [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) nel membro **lpfnHook.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-284">Set the **OFN\_ENABLEHOOK** and **OFN\_EXPLORER** flags in the **Flags** member and specify the address of an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="ced1a-285">Se si specifica una routine hook e si omette il flag **OFN \_ EXPLORER,** è necessario usare una routine hook [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) per ottenere l'interfaccia utente di vecchio stile.</span><span class="sxs-lookup"><span data-stu-id="ced1a-285">If you provide a hook procedure and omit the **OFN\_EXPLORER** flag, you must use an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and you will get the old-style user-interface.</span></span> <span data-ttu-id="ced1a-286">Per altre informazioni, vedere [Personalizzazione Old-Style finestre di dialogo .](#customizing-old-style-dialog-boxes)</span><span class="sxs-lookup"><span data-stu-id="ced1a-286">For more information, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="ced1a-287">Una routine hook di tipo Esplora risorse riceve diversi messaggi mentre la finestra di dialogo è aperta.</span><span class="sxs-lookup"><span data-stu-id="ced1a-287">An Explorer-style hook procedure receives a variety of messages while the dialog box is open.</span></span> <span data-ttu-id="ced1a-288">tra cui:</span><span class="sxs-lookup"><span data-stu-id="ced1a-288">These include the following:</span></span>

-   <span data-ttu-id="ced1a-289">Messaggio [**WM \_ INITDIALOG**](wm-initdialog.md) e altri messaggi di finestra di dialogo standard, ad esempio il messaggio di colore del controllo [**WM \_ CTLCOLORDLG.**](wm-ctlcolordlg.md)</span><span class="sxs-lookup"><span data-stu-id="ced1a-289">The [**WM\_INITDIALOG**](wm-initdialog.md) message and other standard dialog box messages such as the [**WM\_CTLCOLORDLG**](wm-ctlcolordlg.md) control color message.</span></span>
-   <span data-ttu-id="ced1a-290">Set di messaggi [**di notifica WM \_ NOTIFY**](../controls/wm-notify.md) che indicano le azioni eseguite dall'utente o da altri eventi della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-290">A set of [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user or other dialog box events.</span></span>
-   <span data-ttu-id="ced1a-291">Messaggi per tutti i controlli aggiuntivi definiti specificando un modello di finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-291">Messages for any additional controls that you defined by specifying a child dialog template.</span></span>

<span data-ttu-id="ced1a-292">È inoltre disponibile un set di messaggi che è possibile inviare a una finestra di dialogo in stile Esplora risorse per ottenere informazioni o per controllare il comportamento e l'aspetto della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-292">In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</span></span>

<span data-ttu-id="ced1a-293">Se si specifica una routine hook per una finestra di dialogo di tipo Esplora risorse, la routine della finestra di dialogo predefinita crea una finestra di dialogo figlio quando la routine della finestra di dialogo predefinita elabora il messaggio [**WM \_ INITDIALOG.**](wm-initdialog.md)</span><span class="sxs-lookup"><span data-stu-id="ced1a-293">If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="ced1a-294">La routine hook funge da routine di dialogo per la finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-294">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="ced1a-295">A questo momento, la routine hook riceve il proprio messaggio **WM \_ INITDIALOG** con il parametro *lParam* impostato sull'indirizzo della struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) usata per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-295">At this time, the hook procedure receives its own **WM\_INITDIALOG** message with the *lParam* parameter set to the address of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure used to initialize the dialog box.</span></span> <span data-ttu-id="ced1a-296">Al termine dell'elaborazione del messaggio **\_ WM INITDIALOG** da parte della finestra di dialogo figlio, la procedura di dialogo predefinita sposta i controlli standard, se necessario, per fare spazio a eventuali controlli aggiuntivi della finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="ced1a-296">After the child dialog finishes processing its own **WM\_INITDIALOG** message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box.</span></span> <span data-ttu-id="ced1a-297">La procedura di dialogo predefinita invia quindi il messaggio di notifica [**\_ INITDONE**](cdn-initdone.md) della rete CDN alla procedura hook.</span><span class="sxs-lookup"><span data-stu-id="ced1a-297">The default dialog procedure then sends the [**CDN\_INITDONE**](cdn-initdone.md) notification message to the hook procedure.</span></span>

<span data-ttu-id="ced1a-298">La procedura hook riceve messaggi [**di \_ notifica WM NOTIFY**](../controls/wm-notify.md) che indicano le azioni eseguite dall'utente nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-298">The hook procedure receives [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user in the dialog box.</span></span> <span data-ttu-id="ced1a-299">È possibile utilizzare alcuni di questi messaggi per controllare il comportamento della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-299">You can use some of these messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="ced1a-300">Ad esempio, la procedura hook riceve il messaggio [**\_ FILEOK**](cdn-fileok.md) della rete CDN quando l'utente sceglie un nome file e fa clic sul **pulsante OK.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-300">For example, the hook procedure receives the [**CDN\_FILEOK**](cdn-fileok.md) message when the user chooses a file name and clicks the **OK** button.</span></span> <span data-ttu-id="ced1a-301">In risposta a questo messaggio, la procedura hook può usare la funzione [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) per rifiutare il nome selezionato e forzare la finestra di dialogo a rimanere aperta.</span><span class="sxs-lookup"><span data-stu-id="ced1a-301">In response to this message, the hook procedure can use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to reject the selected name and force the dialog box to remain open.</span></span>

<span data-ttu-id="ced1a-302">Il *parametro lParam* per ogni [**messaggio WM \_ NOTIFY**](../controls/wm-notify.md) è un puntatore a una struttura [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) [**o OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) che definisce l'azione.</span><span class="sxs-lookup"><span data-stu-id="ced1a-302">The *lParam* parameter for each [**WM\_NOTIFY**](../controls/wm-notify.md) message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) or [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) structure that defines the action.</span></span> <span data-ttu-id="ced1a-303">Il **membro** di codice nell'intestazione di questa struttura contiene uno dei messaggi di notifica seguenti.</span><span class="sxs-lookup"><span data-stu-id="ced1a-303">The **code** member in the header of this structure contains one of the following notification messages.</span></span>



| <span data-ttu-id="ced1a-304">Messaggio</span><span class="sxs-lookup"><span data-stu-id="ced1a-304">Message</span></span>                                           | <span data-ttu-id="ced1a-305">Significato</span><span class="sxs-lookup"><span data-stu-id="ced1a-305">Meaning</span></span>                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ced1a-306">**FILEOK della rete CDN \_**</span><span class="sxs-lookup"><span data-stu-id="ced1a-306">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                 | <span data-ttu-id="ced1a-307">L'utente ha fatto clic **sul pulsante OK.** la finestra di dialogo sta per essere chiusa.</span><span class="sxs-lookup"><span data-stu-id="ced1a-307">The user clicked the **OK** button; the dialog box is about to close.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="ced1a-308">**CARTELLA DELLA RETE \_ CDNMODIFICA**</span><span class="sxs-lookup"><span data-stu-id="ced1a-308">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)     | <span data-ttu-id="ced1a-309">L'utente ha aperto una nuova cartella o una nuova directory.</span><span class="sxs-lookup"><span data-stu-id="ced1a-309">The user opened a new folder or directory.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="ced1a-310">**GUIDA DELLA RETE \_ CDN**</span><span class="sxs-lookup"><span data-stu-id="ced1a-310">**CDN\_HELP**</span></span>](cdn-help.md)                     | <span data-ttu-id="ced1a-311">L'utente ha fatto clic **sul pulsante ?** .</span><span class="sxs-lookup"><span data-stu-id="ced1a-311">The user clicked the **Help** button.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="ced1a-312">**INCLUDEITEM della rete \_ CDN**</span><span class="sxs-lookup"><span data-stu-id="ced1a-312">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)       | <span data-ttu-id="ced1a-313">Determina se un elemento deve essere visualizzato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-313">Determines whether an item should be displayed.</span></span> <span data-ttu-id="ced1a-314">Quando l'utente apre una nuova cartella o directory, il sistema invia questa notifica per ogni elemento nella cartella o nella directory.</span><span class="sxs-lookup"><span data-stu-id="ced1a-314">When the user opens a new folder or directory, the system sends this notification for each item in the folder or directory.</span></span> <span data-ttu-id="ced1a-315">Il sistema invia questa notifica solo se è stato impostato il flag **\_ OFN ENABLEINCLUDENOTIFY.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-315">The system sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set.</span></span>                          |
| [<span data-ttu-id="ced1a-316">**INITDONE della \_ rete CDN**</span><span class="sxs-lookup"><span data-stu-id="ced1a-316">**CDN\_INITDONE**</span></span>](cdn-initdone.md)             | <span data-ttu-id="ced1a-317">Il sistema ha completato l'inizializzazione della finestra di dialogo e la finestra di dialogo ha terminato l'elaborazione del [**messaggio WM \_ INITDIALOG.**](wm-initdialog.md)</span><span class="sxs-lookup"><span data-stu-id="ced1a-317">The system has finished initializing the dialog box, and the dialog box has finished processing the [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="ced1a-318">Inoltre, il sistema ha completato la disposizione dei controlli nella finestra di dialogo comune per fare spazio ai controlli della finestra di dialogo figlio (se presente).</span><span class="sxs-lookup"><span data-stu-id="ced1a-318">Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</span></span> |
| [<span data-ttu-id="ced1a-319">**\_SELCHANGE della rete CDN**</span><span class="sxs-lookup"><span data-stu-id="ced1a-319">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)           | <span data-ttu-id="ced1a-320">L'utente ha selezionato un nuovo file o una nuova cartella dall'elenco di file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-320">The user selected a new file or folder from the file list.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="ced1a-321">**CONDIVISIONE DELLA RETE CDN \_**</span><span class="sxs-lookup"><span data-stu-id="ced1a-321">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md) | <span data-ttu-id="ced1a-322">Nella finestra di dialogo comune è stata rilevata una violazione di condivisione nel file che sta per essere restituito.</span><span class="sxs-lookup"><span data-stu-id="ced1a-322">The common dialog box encountered a sharing violation on the file about to be returned.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="ced1a-323">**TYPECHANGE della rete \_ CDN**</span><span class="sxs-lookup"><span data-stu-id="ced1a-323">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)         | <span data-ttu-id="ced1a-324">L'utente ha selezionato un nuovo tipo di file dall'elenco dei tipi di file.</span><span class="sxs-lookup"><span data-stu-id="ced1a-324">The user selected a new file type from the list of file types.</span></span>                                                                                                                                                                                                                                 |



 

<span data-ttu-id="ced1a-325">Questi [**messaggi WM \_ NOTIFY**](../controls/wm-notify.md) soppiattono i  messaggi registrati [**FILEOKSTRING,**](fileokstring.md) [**LBSELCHSTRING,**](lbselchstring.md) [**SHAREVISTRING**](sharevistring.md)  [**e HELPMSGSTRING**](helpmsgstring.md) usati dalle versioni precedenti delle finestre di dialogo Apri e Salva con nome.</span><span class="sxs-lookup"><span data-stu-id="ced1a-325">These [**WM\_NOTIFY**](../controls/wm-notify.md) messages supersede the [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md), and [**HELPMSGSTRING**](helpmsgstring.md) registered messages used by previous versions of the **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="ced1a-326">Tuttavia, la routine hook riceve anche il messaggio sostituito dopo il messaggio **WM \_ NOTIFY** se l'elaborazione **WM \_ NOTIFY** non usa [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) per impostare un valore **\_ MSGRESULT DWL** diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="ced1a-326">However, the hook procedure also receives the superseded message after the **WM\_NOTIFY** message if the **WM\_NOTIFY** processing does not use [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) to set a nonzero **DWL\_MSGRESULT** value.</span></span>

<span data-ttu-id="ced1a-327">Per recuperare informazioni sullo stato della finestra di dialogo o per controllare il comportamento e l'aspetto della finestra di dialogo, la procedura hook può inviare i messaggi seguenti alla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-327">To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</span></span>



| <span data-ttu-id="ced1a-328">Messaggio</span><span class="sxs-lookup"><span data-stu-id="ced1a-328">Message</span></span>                                             | <span data-ttu-id="ced1a-329">Significato</span><span class="sxs-lookup"><span data-stu-id="ced1a-329">Meaning</span></span>                                                                                                                                                                                                                  |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ced1a-330">**CDM \_ GETFILEPATH**</span><span class="sxs-lookup"><span data-stu-id="ced1a-330">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)         | <span data-ttu-id="ced1a-331">Recupera il percorso e il nome del file selezionato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-331">Retrieves the path and file name of the selected file.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="ced1a-332">**CDM \_ GETFOLDERIDLIST**</span><span class="sxs-lookup"><span data-stu-id="ced1a-332">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md) | <span data-ttu-id="ced1a-333">Recupera l'elenco di identificatori di elemento corrispondente alla cartella corrente aperta nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-333">Retrieves the item identifier list corresponding to the current folder that the dialog box has open.</span></span> <span data-ttu-id="ced1a-334">Per altre informazioni sugli elenchi di identificatori di elemento, vedere [Introduzione allo spazio dei nomi della shell.](/windows/desktop/shell/namespace-intro)</span><span class="sxs-lookup"><span data-stu-id="ced1a-334">For more information about item identifier lists, see [Introduction to the Shell Namespace](/windows/desktop/shell/namespace-intro).</span></span> |
| [<span data-ttu-id="ced1a-335">**CDM \_ GETFOLDERPATH**</span><span class="sxs-lookup"><span data-stu-id="ced1a-335">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)     | <span data-ttu-id="ced1a-336">Recupera il percorso della cartella o della directory corrente per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-336">Retrieves the path of the current folder or directory for the dialog box.</span></span>                                                                                                                                                |
| [<span data-ttu-id="ced1a-337">**CDM \_ GETSPEC**</span><span class="sxs-lookup"><span data-stu-id="ced1a-337">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                 | <span data-ttu-id="ced1a-338">Recupera il nome file (senza il percorso) del file attualmente selezionato nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-338">Retrieves the file name (not including the path) of the file currently selected in the dialog box.</span></span>                                                                                                                       |
| [<span data-ttu-id="ced1a-339">**HIDECONTROL DI CDM \_**</span><span class="sxs-lookup"><span data-stu-id="ced1a-339">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)         | <span data-ttu-id="ced1a-340">Nasconde il controllo specificato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-340">Hides the specified control.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="ced1a-341">**CDM \_ SETCONTROLTEXT**</span><span class="sxs-lookup"><span data-stu-id="ced1a-341">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)   | <span data-ttu-id="ced1a-342">Imposta il testo nel controllo specificato.</span><span class="sxs-lookup"><span data-stu-id="ced1a-342">Sets the text in the specified control.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="ced1a-343">**CDM \_ SETDEFEXT**</span><span class="sxs-lookup"><span data-stu-id="ced1a-343">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)             | <span data-ttu-id="ced1a-344">Imposta l'estensione di file predefinita per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-344">Sets the default file name extension for the dialog box.</span></span>                                                                                                                                                                 |



 

## <a name="explorer-style-custom-templates"></a><span data-ttu-id="ced1a-345">Explorer-Style modelli personalizzati</span><span class="sxs-lookup"><span data-stu-id="ced1a-345">Explorer-Style Custom Templates</span></span>

<span data-ttu-id="ced1a-346">Per definire controlli aggiuntivi per  una  finestra di dialogo Apri o Salva con nome di tipo Esplora risorse, usare la struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) per specificare un modello per una finestra di dialogo figlio contenente i controlli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="ced1a-346">To define additional controls for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a template for a child dialog box that contains the additional controls.</span></span> <span data-ttu-id="ced1a-347">Se il modello di dialogo figlio è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **\_ OFN ENABLETEMPLATE** nel membro **Flags** e usare i membri **hInstance** e **lpTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="ced1a-347">If your child dialog template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="ced1a-348">Se il modello è già in memoria, impostare il flag **OFN \_ ENABLETEMPLATEHANDLE** e usare il membro **hInstance** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="ced1a-348">If the template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="ced1a-349">Quando si specifica un modello di finestra di dialogo figlio per una finestra di dialogo di tipo Esplora risorse, è necessario impostare anche il flag **OFN \_ EXPLORER.** In caso contrario, il sistema presuppone che si fornirà un modello sostitutivo per una finestra di dialogo di tipo precedente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-349">When providing a child dialog template for an Explorer-style dialog box, you must also set the **OFN\_EXPLORER** flag; otherwise, the system assumes you are providing a replacement template for an old-style dialog box.</span></span> <span data-ttu-id="ced1a-350">In genere, se si forniscono controlli aggiuntivi, è necessario fornire anche una procedura hook di tipo [Explorer](#explorer-style-hook-procedures) per elaborare i messaggi per i nuovi controlli.</span><span class="sxs-lookup"><span data-stu-id="ced1a-350">Typically, if you provide additional controls, you must also provide an [Explorer-style hook procedure](#explorer-style-hook-procedures) to process messages for the new controls.</span></span>

<span data-ttu-id="ced1a-351">È possibile creare il modello di finestra di dialogo figlio come qualsiasi altro modello, ad eccezione del fatto che è necessario specificare gli stili **WS \_ CHILD** e **WS \_ CLIPSIBLINGS** e gli stili **DS \_ 3DLOOK** e **DS \_ CONTROL.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-351">You can create your child dialog box template as you do any other template, except that you must specify the **WS\_CHILD** and **WS\_CLIPSIBLINGS** styles and should specify the **DS\_3DLOOK** and **DS\_CONTROL** styles.</span></span> <span data-ttu-id="ced1a-352">Il sistema richiede lo **stile WS \_ CHILD** perché il modello definisce una finestra di dialogo figlio della finestra di dialogo predefinita **Apri** o **Salva** con nome.</span><span class="sxs-lookup"><span data-stu-id="ced1a-352">The system requires the **WS\_CHILD** style because your template defines a child dialog of the default **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="ced1a-353">Lo **stile \_ WS CLIPSIBLINGS** garantisce che la finestra di dialogo figlio non dipinga alcun controllo nella finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-353">The **WS\_CLIPSIBLINGS** style ensures that the child dialog box does not paint over any of the controls in the default dialog box.</span></span> <span data-ttu-id="ced1a-354">Lo **stile DS \_ 3DLOOK** assicura che l'aspetto dei controlli nella finestra di dialogo figlio sia coerente con i controlli nella finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-354">The **DS\_3DLOOK** style makes sure that the appearance of the controls in the child dialog box is consistent with the controls in the default dialog box.</span></span> <span data-ttu-id="ced1a-355">Lo **stile DS \_ CONTROL** garantisce che l'utente possa usare TAB e altri tasti di spostamento per spostarsi tra tutti i controlli, predefiniti o personalizzati, nella finestra di dialogo personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ced1a-355">The **DS\_CONTROL** style makes sure that the user can use the TAB and other navigation keys to move between all controls, default or custom, in the customized dialog box.</span></span>

<span data-ttu-id="ced1a-356">Per fare spazio ai nuovi controlli, il sistema espande la finestra di dialogo predefinita in base alla larghezza e all'altezza della finestra di dialogo personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ced1a-356">To make room for the new controls, the system expands the default dialog box by the width and height of the custom dialog box.</span></span> <span data-ttu-id="ced1a-357">Per impostazione predefinita, tutti i controlli della finestra di dialogo personalizzata sono posizionati sotto i controlli nella finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-357">By default, all controls from the custom dialog box are positioned below the controls in the default dialog box.</span></span> <span data-ttu-id="ced1a-358">È tuttavia possibile eseguire l'override di questo posizionamento predefinito includendo un controllo di testo statico nel modello di finestra di dialogo personalizzato e assegnando il valore dell'identificatore di controllo **stc32**.</span><span class="sxs-lookup"><span data-stu-id="ced1a-358">However, you can override this default positioning by including a static text control in your custom dialog box template and assigning it the control identifier value of **stc32**.</span></span> <span data-ttu-id="ced1a-359">Questo valore è definito nel file di intestazione Dlgs.h. In questo caso, il sistema usa il controllo come punto di riferimento per determinare dove posizionare i nuovi controlli.</span><span class="sxs-lookup"><span data-stu-id="ced1a-359">(This value is defined in the Dlgs.h header file.) In this case, the system uses the control as the point of reference for determining where to position the new controls.</span></span> <span data-ttu-id="ced1a-360">Tutti i nuovi controlli sopra e a sinistra del controllo **stc32** vengono posizionati nella stessa quantità sopra e a sinistra dei controlli nella finestra di dialogo predefinita.</span><span class="sxs-lookup"><span data-stu-id="ced1a-360">All new controls above and to the left of the **stc32** control are positioned the same amount above and to the left of the controls in the default dialog box.</span></span> <span data-ttu-id="ced1a-361">I nuovi controlli sotto e a destra del **controllo stc32** sono posizionati sotto e a destra dei controlli predefiniti.</span><span class="sxs-lookup"><span data-stu-id="ced1a-361">New controls below and to the right of the **stc32** control are positioned below and to the right of the default controls.</span></span> <span data-ttu-id="ced1a-362">In generale, ogni nuovo controllo viene posizionato in modo che abbia la stessa posizione rispetto ai controlli predefiniti rispetto al controllo **stc32.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-362">In general, each new control is positioned so that it has the same position relative to the default controls as it had to the **stc32** control.</span></span> <span data-ttu-id="ced1a-363">Per fare spazio a questi nuovi controlli, il sistema aggiunge spazio a sinistra, a destra, in basso e nella parte superiore della finestra di dialogo predefinita in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="ced1a-363">To make room for these new controls, the system adds space to the left, right, bottom, and top of the default dialog box as needed.</span></span>

<span data-ttu-id="ced1a-364">Il sistema richiede la procedura hook per elaborare tutti i messaggi destinati alla finestra di dialogo personalizzata e pertanto invia gli stessi messaggi della finestra alla routine hook di qualsiasi altra routine della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-364">The system requires the hook procedure to process all messages intended for the custom dialog box and therefore sends the same window messages to the hook procedure as to any other dialog box procedure.</span></span> <span data-ttu-id="ced1a-365">Ad esempio, la routine hook riceve messaggi [**WM \_ COMMAND**](/windows/desktop/menurc/wm-command) quando l'utente fa clic sui controlli pulsante nella finestra di dialogo personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ced1a-365">For example, the hook procedure receives [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages when the user clicks on button controls in the custom dialog box.</span></span> <span data-ttu-id="ced1a-366">La procedura hook è responsabile dell'inizializzazione di questi controlli e del recupero dei valori dai controlli quando la finestra di dialogo viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="ced1a-366">The hook procedure is responsible for initializing these controls and retrieving values from the controls when the dialog box is closed.</span></span> <span data-ttu-id="ced1a-367">Si noti che quando la routine hook riceve il messaggio [**\_ WM INITDIALOG,**](wm-initdialog.md) il sistema non ha ancora spostato i controlli nelle posizioni finali.</span><span class="sxs-lookup"><span data-stu-id="ced1a-367">Note that when the hook procedure receives the [**WM\_INITDIALOG**](wm-initdialog.md) message, the system has not yet moved the controls to their final positions.</span></span>

<span data-ttu-id="ced1a-368">La routine predefinita della finestra di dialogo gestisce i messaggi per tutti i controlli nella finestra di dialogo predefinita, ma la procedura hook riceve i messaggi di notifica per le azioni dell'utente su questi controlli, come descritto in Procedure hook in stile [Esplora](#explorer-style-hook-procedures)risorse .</span><span class="sxs-lookup"><span data-stu-id="ced1a-368">The default dialog box procedure handles messages for all the controls in the default dialog box, but the hook procedure receives the notification messages for user actions on these controls as described in [Explorer-Style Hook Procedures](#explorer-style-hook-procedures).</span></span>

## <a name="explorer-style-control-identifiers"></a><span data-ttu-id="ced1a-369">Explorer-Style identificatori di controllo</span><span class="sxs-lookup"><span data-stu-id="ced1a-369">Explorer-Style Control Identifiers</span></span>

<span data-ttu-id="ced1a-370">Il Windows Software Development Kit (Windows SDK) (SDK) fornisce il modello di finestra di dialogo predefinito per le finestre di dialogo di tipo precedente, ma non include il modello predefinito per le finestre di dialogo in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-370">The Windows Software Development Kit (SDK) provides the default dialog box template for the old-style dialog boxes, but does not include the default template for the Explorer-style dialog boxes.</span></span> <span data-ttu-id="ced1a-371">Ciò è dovuto al fatto che le finestre di dialogo di tipo Esplora risorse consentono di aggiungere controlli personalizzati, ma non supportano la modifica del modello per i controlli standard.</span><span class="sxs-lookup"><span data-stu-id="ced1a-371">This is because the Explorer-style dialog boxes allow you to add your own controls but do not support modifying the template for the standard controls.</span></span> <span data-ttu-id="ced1a-372">In alcuni casi, tuttavia, potrebbe essere necessario conoscere gli identificatori di controllo usati nei modelli predefiniti.</span><span class="sxs-lookup"><span data-stu-id="ced1a-372">However, in some cases, you may need to know the control identifiers used in the default templates.</span></span> <span data-ttu-id="ced1a-373">Ad esempio, i messaggi [**\_ HIDECONTROL e**](cdm-hidecontrol.md) [**\_ SETCONTROLTEXT CDM di CDM**](cdm-setcontroltext.md) richiedono un identificatore di controllo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-373">For example, the [**CDM\_HIDECONTROL**](cdm-hidecontrol.md) and [**CDM\_SETCONTROLTEXT**](cdm-setcontroltext.md) messages require a control identifier.</span></span>

<span data-ttu-id="ced1a-374">La tabella seguente illustra gli identificatori dei controlli  standard nelle finestre di dialogo Apri e **Salva con** nome in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-374">The following table shows the identifiers of the standard controls in the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="ced1a-375">Gli identificatori sono costanti definite in Dlgs.h e Winuser.h.</span><span class="sxs-lookup"><span data-stu-id="ced1a-375">The identifiers are constants defined in Dlgs.h and Winuser.h.</span></span>



| <span data-ttu-id="ced1a-376">Identificatore del controllo</span><span class="sxs-lookup"><span data-stu-id="ced1a-376">Control identifier</span></span> | <span data-ttu-id="ced1a-377">Descrizione del controllo</span><span class="sxs-lookup"><span data-stu-id="ced1a-377">Control description</span></span>                                                                                                                                                                                                                                                                        |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ced1a-378">**chx1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-378">**chx1**</span></span>           | <span data-ttu-id="ced1a-379">Casella di controllo di sola lettura</span><span class="sxs-lookup"><span data-stu-id="ced1a-379">The read-only check box</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="ced1a-380">**cmb1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-380">**cmb1**</span></span>           | <span data-ttu-id="ced1a-381">Casella combinata a discesa che visualizza l'elenco dei filtri per i tipi di file</span><span class="sxs-lookup"><span data-stu-id="ced1a-381">Drop-down combo box that displays the list of file type filters</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="ced1a-382">**stc2**</span><span class="sxs-lookup"><span data-stu-id="ced1a-382">**stc2**</span></span>           | <span data-ttu-id="ced1a-383">Etichetta per la **casella combinata cmb1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-383">Label for the **cmb1** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="ced1a-384">**cmb2**</span><span class="sxs-lookup"><span data-stu-id="ced1a-384">**cmb2**</span></span>           | <span data-ttu-id="ced1a-385">Casella combinata a discesa che visualizza l'unità o la cartella corrente e che consente all'utente di selezionare un'unità o una cartella da aprire</span><span class="sxs-lookup"><span data-stu-id="ced1a-385">Drop-down combo box that displays the current drive or folder, and that allows the user to select a drive or folder to open</span></span>                                                                                                                                                                |
| <span data-ttu-id="ced1a-386">**stc4**</span><span class="sxs-lookup"><span data-stu-id="ced1a-386">**stc4**</span></span>           | <span data-ttu-id="ced1a-387">Etichetta per la **casella combinata cmb2**</span><span class="sxs-lookup"><span data-stu-id="ced1a-387">Label for the **cmb2** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="ced1a-388">**cmb13**</span><span class="sxs-lookup"><span data-stu-id="ced1a-388">**cmb13**</span></span>          | <span data-ttu-id="ced1a-389">Casella combinata a discesa che visualizza il nome del file corrente, consente all'utente di digitare il nome di un file da aprire e selezionare un file aperto o salvato di recente.</span><span class="sxs-lookup"><span data-stu-id="ced1a-389">Drop-down combo box that displays the name of the current file, allows the user to type the name of a file to open, and select a file that has been opened or saved recently.</span></span> <span data-ttu-id="ced1a-390">Questo è per le applicazioni precedenti compatibili con Esplora risorse senza hook o modello di finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-390">This is for earlier Explorer-compatible applications without hook or dialog template.</span></span> <span data-ttu-id="ced1a-391">Confrontare con **edt1**.</span><span class="sxs-lookup"><span data-stu-id="ced1a-391">Compare with **edt1**.</span></span> |
| <span data-ttu-id="ced1a-392">**edt1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-392">**edt1**</span></span>           | <span data-ttu-id="ced1a-393">Controllo di modifica che visualizza il nome del file corrente o consente all'utente di digitare il nome del file da aprire.</span><span class="sxs-lookup"><span data-stu-id="ced1a-393">Edit control that displays the name of the current file, or allows the user to type the name of the file to open.</span></span> <span data-ttu-id="ced1a-394">Confrontare con **cmb13**.</span><span class="sxs-lookup"><span data-stu-id="ced1a-394">Compare with **cmb13**.</span></span>                                                                                                                                                  |
| <span data-ttu-id="ced1a-395">**stc3**</span><span class="sxs-lookup"><span data-stu-id="ced1a-395">**stc3**</span></span>           | <span data-ttu-id="ced1a-396">Etichetta per la casella **combinata cmb13** e il controllo di modifica edt1</span><span class="sxs-lookup"><span data-stu-id="ced1a-396">Label for the **cmb13** combo box and the edt1 edit control</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="ced1a-397">**lst1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-397">**lst1**</span></span>           | <span data-ttu-id="ced1a-398">Casella di riepilogo che visualizza il contenuto dell'unità o della cartella corrente</span><span class="sxs-lookup"><span data-stu-id="ced1a-398">List box that displays the contents of the current drive or folder</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="ced1a-399">**stc1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-399">**stc1**</span></span>           | <span data-ttu-id="ced1a-400">Etichetta per la casella **di riepilogo lst1**</span><span class="sxs-lookup"><span data-stu-id="ced1a-400">Label for the **lst1** list box</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="ced1a-401">**IDOK**</span><span class="sxs-lookup"><span data-stu-id="ced1a-401">**IDOK**</span></span>           | <span data-ttu-id="ced1a-402">Pulsante di comando **OK** (pulsante di invio)</span><span class="sxs-lookup"><span data-stu-id="ced1a-402">The **OK** command button (push button)</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="ced1a-403">**IDCANCEL**</span><span class="sxs-lookup"><span data-stu-id="ced1a-403">**IDCANCEL**</span></span>       | <span data-ttu-id="ced1a-404">Pulsante **di** comando Annulla (pulsante di invio)</span><span class="sxs-lookup"><span data-stu-id="ced1a-404">The **Cancel** command button (push button)</span></span>                                                                                                                                                                                                                                                |
| <span data-ttu-id="ced1a-405">**pshHelp**</span><span class="sxs-lookup"><span data-stu-id="ced1a-405">**pshHelp**</span></span>        | <span data-ttu-id="ced1a-406">Pulsante **di** comando Guida (pulsante di comando)</span><span class="sxs-lookup"><span data-stu-id="ced1a-406">The **Help** command button (push button)</span></span>                                                                                                                                                                                                                                                  |



 

## <a name="customizing-old-style-dialog-boxes"></a><span data-ttu-id="ced1a-407">Personalizzazione di Old-Style finestre di dialogo</span><span class="sxs-lookup"><span data-stu-id="ced1a-407">Customizing Old-Style Dialog Boxes</span></span>

<span data-ttu-id="ced1a-408">È possibile personalizzare una  finestra  di dialogo Apri o Salva con nome precedente fornendo una routine hook [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) che riceve messaggi o notifiche destinati alla procedura predefinita della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-408">You can customize an old-style **Open** or **Save As** dialog box by providing an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure that receives messages or notifications intended for the default dialog box procedure.</span></span> <span data-ttu-id="ced1a-409">È anche possibile fornire un modello personalizzato da usare al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="ced1a-409">You can also provide a custom template to use in place of the default template.</span></span> <span data-ttu-id="ced1a-410">Le procedure hook e i modelli utilizzati con le finestre di dialogo di tipo precedente sono simili a quelli usati con le altre finestre di dialogo comuni.</span><span class="sxs-lookup"><span data-stu-id="ced1a-410">The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes.</span></span> <span data-ttu-id="ced1a-411">Per altre informazioni, vedere [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and Custom [Templates](customizing-common-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="ced1a-411">For more information, see [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and [Custom Templates](customizing-common-dialog-boxes.md).</span></span>

<span data-ttu-id="ced1a-412">Per abilitare una routine hook  per una finestra di dialogo Apri o **Salva** con nome precedente, usare la struttura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) quando si crea la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-412">To enable a hook procedure for an old-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="ced1a-413">Impostare il flag **OFN \_ ENABLEHOOK** nel membro **Flags** e specificare l'indirizzo di una procedura hook [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) nel membro **lpfnHook.**</span><span class="sxs-lookup"><span data-stu-id="ced1a-413">Set the **OFN\_ENABLEHOOK** flag in the **Flags** member and specify the address of an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="ced1a-414">La routine della finestra di dialogo invia un messaggio [**WM \_ INITDIALOG**](wm-initdialog.md) alla routine hook con il parametro *Param* impostato sull'indirizzo della struttura **OPENFILENAME** usata per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="ced1a-414">The dialog box procedure sends a [**WM\_INITDIALOG**](wm-initdialog.md) message to the hook procedure with the *Param* parameter set to the address of the **OPENFILENAME** structure used to initialize the dialog box.</span></span>

<span data-ttu-id="ced1a-415">È possibile usare la [**struttura OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) per  specificare  un modello personalizzato per la finestra di dialogo Apri o Salva con nome da usare al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="ced1a-415">You can use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a custom template for the **Open** or **Save As** dialog box to use in place of the default template.</span></span> <span data-ttu-id="ced1a-416">Se il modello personalizzato è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **\_ OFN ENABLETEMPLATE** nel membro **Flags** e usare i membri **hInstance** e **lpTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="ced1a-416">If your custom template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="ced1a-417">Se il modello personalizzato è già in memoria, impostare il flag **OFN \_ ENABLETEMPLATEHANDLE** e usare il membro **hInstance** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="ced1a-417">If your custom template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="ced1a-418">Creare il modello personalizzato modificando il modello predefinito specificato nel file Fileopen.dlg.</span><span class="sxs-lookup"><span data-stu-id="ced1a-418">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span> <span data-ttu-id="ced1a-419">Gli identificatori di controllo usati nei modelli predefiniti della finestra di dialogo Trova e sostituisci sono definiti nel file Dlgs.h.</span><span class="sxs-lookup"><span data-stu-id="ced1a-419">The control identifiers used in the default Find and Replace dialog templates are defined in the Dlgs.h file.</span></span>

<span data-ttu-id="ced1a-420">Per impostazione predefinita, le [**funzioni GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) e [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) visualizzano le finestre di dialogo in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-420">By default, the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions display the Explorer-style dialog boxes.</span></span> <span data-ttu-id="ced1a-421">Se si vuole visualizzare una finestra di dialogo di stile precedente, è necessario fornire una routine hook [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) e assicurarsi che il flag **OFN \_ EXPLORER** non sia impostato nel membro **Flags** della struttura [**OPENFILENAME.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="ced1a-421">If you want to display an old-style dialog box, you must provide an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and ensure that the **OFN\_EXPLORER** flag is not set in the **Flags** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="ced1a-422">Se si imposta il flag **OFN \_ EXPLORER,** il sistema considera una procedura hook o un modello personalizzato come una personalizzazione di tipo Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="ced1a-422">If you set the **OFN\_EXPLORER** flag, the system treats a hook procedure or custom template as an Explorer-style customization.</span></span> <span data-ttu-id="ced1a-423">Per informazioni sulla personalizzazione di una finestra di dialogo in stile Esplora risorse, vedere [Modelli personalizzati in stile Esplora risorse](#explorer-style-custom-templates).</span><span class="sxs-lookup"><span data-stu-id="ced1a-423">For information about customizing an Explorer-style dialog box, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

## <a name="see-also"></a><span data-ttu-id="ced1a-424">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="ced1a-424">See also</span></span>

* [<span data-ttu-id="ced1a-425">Esempio di file in uso</span><span class="sxs-lookup"><span data-stu-id="ced1a-425">File is in use sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)
