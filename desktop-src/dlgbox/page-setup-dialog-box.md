---
title: Finestra di dialogo Imposta pagina
description: Visualizza una finestra di dialogo modale che consente all'utente di scegliere le impostazioni che includono il tipo di carta, l'origine della carta, l'orientamento della pagina e la larghezza dei margini della pagina.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Interfaccia utente di Windows, input utente
- Interfaccia utente di Windows, libreria finestra di dialogo comune
- input utente, libreria finestra di dialogo comune
- acquisizione dell'input dell'utente, libreria finestra di dialogo comune
- Libreria finestra di dialogo comune
- finestre di dialogo comuni
- Imposta pagina - finestra di dialogo
- personalizzazione della finestra di dialogo Imposta pagina
- Hook, finestra di dialogo Imposta pagina
- finestre di dialogo predefinite
- finestre di dialogo, Imposta pagina
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118410"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="a4033-114">Finestra di dialogo Imposta pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="a4033-115">Visualizza una finestra di dialogo modale che consente all'utente di impostare gli attributi seguenti della pagina stampata:</span><span class="sxs-lookup"><span data-stu-id="a4033-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="a4033-116">Il tipo di carta (busta, legale, lettera e così via)</span><span class="sxs-lookup"><span data-stu-id="a4033-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="a4033-117">Origine della carta (feed manuale, feed del trattore, alimentatore del foglio e così via)</span><span class="sxs-lookup"><span data-stu-id="a4033-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="a4033-118">Orientamento della pagina (verticale o orizzontale)</span><span class="sxs-lookup"><span data-stu-id="a4033-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="a4033-119">Larghezza dei margini della pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-119">The width of the page margins</span></span>

<span data-ttu-id="a4033-120">Per creare e visualizzare una finestra di dialogo di **impostazione della pagina** , inizializzare una struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) e passare la struttura alla funzione [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a4033-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="a4033-121">Tuttavia, gli attributi presentati nella finestra di dialogo variano a seconda delle funzionalità della stampante.</span><span class="sxs-lookup"><span data-stu-id="a4033-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="a4033-122">Nella figura seguente viene illustrata una tipica finestra di dialogo di **impostazione della pagina** .</span><span class="sxs-lookup"><span data-stu-id="a4033-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![finestra di dialogo Imposta pagina](images/pagesetupdialogboxxp.png)

<span data-ttu-id="a4033-124">Se l'utente fa clic sul pulsante **OK** , [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) restituisce **true** dopo avere impostato diversi membri nella struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) per specificare le selezioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a4033-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="a4033-125">I membri **ptPaperSize** e **rtMargin** contengono i valori specificati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="a4033-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="a4033-126">I membri **hDevMode** e **hDevNames** contengono handle di memoria globali per le strutture [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) e [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="a4033-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="a4033-127">Queste strutture contengono informazioni aggiuntive sulla pagina, nonché informazioni sulla stampante.</span><span class="sxs-lookup"><span data-stu-id="a4033-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="a4033-128">È possibile utilizzare queste informazioni per preparare l'output da inviare alla stampante selezionata.</span><span class="sxs-lookup"><span data-stu-id="a4033-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="a4033-129">Se l'utente annulla la finestra di dialogo **Imposta pagina** o si verifica un errore, [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) restituisce **false**.</span><span class="sxs-lookup"><span data-stu-id="a4033-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="a4033-130">Per determinare la cause dell'errore, chiamare la funzione [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) per recuperare il valore di errore esteso.</span><span class="sxs-lookup"><span data-stu-id="a4033-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="a4033-131">In questa sezione vengono illustrati gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="a4033-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="a4033-132">Inizializzazione della finestra di dialogo Imposta pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="a4033-133">Personalizzazione della finestra di dialogo Imposta pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="a4033-134">Personalizzazione della pagina di esempio</span><span class="sxs-lookup"><span data-stu-id="a4033-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="a4033-135">Inizializzazione della finestra di dialogo Imposta pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="a4033-136">Per impostazione predefinita, nella finestra di dialogo **Imposta pagina** vengono visualizzate informazioni sulla stampante predefinita corrente.</span><span class="sxs-lookup"><span data-stu-id="a4033-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="a4033-137">Per indicare alla finestra di dialogo di visualizzare informazioni su una stampante specifica, impostare i membri di una struttura [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) o [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) e assegnare gli handle di memoria globale di queste strutture al membro corrispondente in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span><span class="sxs-lookup"><span data-stu-id="a4033-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="a4033-138">Se si specifica il nome di una stampante attualmente non installata, nella finestra di dialogo verrà visualizzato un messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="a4033-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="a4033-139">Per impedire alla finestra di dialogo di visualizzare i messaggi di errore, usare il valore di **\_ Nowarning di PSD** .</span><span class="sxs-lookup"><span data-stu-id="a4033-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="a4033-140">Per recuperare informazioni sulla stampante predefinita senza visualizzare la finestra di dialogo **Imposta pagina** , usare il **valore \_ RETURNDEFAULT di PSD** .</span><span class="sxs-lookup"><span data-stu-id="a4033-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="a4033-141">Se il sistema di misurazione predefinito è pollici, la finestra di dialogo utilizza i millesimi di pollice come unità di misura predefinita.</span><span class="sxs-lookup"><span data-stu-id="a4033-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="a4033-142">Se il sistema di misurazione predefinito è metrica, la finestra di dialogo utilizza centesimi di millimetri come unità di misura predefinita.</span><span class="sxs-lookup"><span data-stu-id="a4033-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="a4033-143">Per eseguire l'override dell'unità di misura predefinita, impostare il flag **PSD \_ INHUNDREDTHSOFMILLIMETERS** o **PSD \_ INTHOUSANDTHSOFINCHES** nel membro **Flags** della struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a4033-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="a4033-144">Per impostazione predefinita, i valori iniziali per i margini sono di un pollice.</span><span class="sxs-lookup"><span data-stu-id="a4033-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="a4033-145">Se si imposta il flag dei **\_ margini PSD** , nella finestra di dialogo verranno visualizzati i valori dei margini iniziali specificati nel membro **rtMargin** .</span><span class="sxs-lookup"><span data-stu-id="a4033-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="a4033-146">I valori minimi predefiniti che l'utente può specificare per i margini sono i margini minimi consentiti dalla stampante.</span><span class="sxs-lookup"><span data-stu-id="a4033-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="a4033-147">Se si imposta il **flag \_ MINMARGINS di PSD** , la finestra di dialogo impone i margini minimi specificati nel membro **rtMinMargin** .</span><span class="sxs-lookup"><span data-stu-id="a4033-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="a4033-148">Per impedire agli utenti di selezionare determinate opzioni, impostare una combinazione dei flag seguenti per disabilitare i controlli corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="a4033-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="a4033-149">Contrassegno</span><span class="sxs-lookup"><span data-stu-id="a4033-149">Flag</span></span>                        | <span data-ttu-id="a4033-150">Significato</span><span class="sxs-lookup"><span data-stu-id="a4033-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="a4033-151">**\_DISABLEMARGINS PSD**</span><span class="sxs-lookup"><span data-stu-id="a4033-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="a4033-152">Disabilita i controlli di modifica in cui l'utente immette le impostazioni dei margini.</span><span class="sxs-lookup"><span data-stu-id="a4033-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="a4033-153">**\_DISABLEORIENTATION PSD**</span><span class="sxs-lookup"><span data-stu-id="a4033-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="a4033-154">Disabilita i pulsanti di opzione **verticale** e **orizzontale** .</span><span class="sxs-lookup"><span data-stu-id="a4033-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="a4033-155">**\_DISABLEPAPER PSD**</span><span class="sxs-lookup"><span data-stu-id="a4033-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="a4033-156">Disabilita i controlli per selezionare il formato della carta e l'origine della carta.</span><span class="sxs-lookup"><span data-stu-id="a4033-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="a4033-157">**\_DISABLEPRINTER PSD**</span><span class="sxs-lookup"><span data-stu-id="a4033-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="a4033-158">Disabilita il pulsante **stampante** .</span><span class="sxs-lookup"><span data-stu-id="a4033-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="a4033-159">Personalizzazione della finestra di dialogo Imposta pagina</span><span class="sxs-lookup"><span data-stu-id="a4033-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="a4033-160">È possibile specificare un modello personalizzato per la finestra di dialogo **Imposta pagina** , ad esempio se si desidera includere controlli aggiuntivi che siano univoci per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a4033-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="a4033-161">La funzione [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) usa il modello personalizzato al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="a4033-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="a4033-162">**Per fornire un modello personalizzato per la finestra di dialogo Imposta pagina**</span><span class="sxs-lookup"><span data-stu-id="a4033-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="a4033-163">Creare il modello personalizzato modificando il modello predefinito specificato nel file prnsetup. dlg.</span><span class="sxs-lookup"><span data-stu-id="a4033-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="a4033-164">Gli identificatori di controllo utilizzati nel modello di finestra di dialogo **Imposta pagina** predefinito sono definiti nel file Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="a4033-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="a4033-165">Utilizzare la struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) per abilitare il modello nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="a4033-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="a4033-166">Se il modello personalizzato è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **PSD \_ ENABLEPAGESETUPTEMPLATE** nel membro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="a4033-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="a4033-167">Usare i membri **HINSTANCE** e **lpPageSetupTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a4033-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="a4033-168">oppure</span><span class="sxs-lookup"><span data-stu-id="a4033-168">-Or-</span></span>

        -   <span data-ttu-id="a4033-169">Se il modello personalizzato è già in memoria, impostare il **flag \_ ENABLEPAGESETUPTEMPLATEHANDLE di PSD** .</span><span class="sxs-lookup"><span data-stu-id="a4033-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="a4033-170">Usare il membro **hPageSetupTemplate** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="a4033-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="a4033-171">Per filtrare i messaggi inviati alla routine della finestra di dialogo, è possibile specificare una procedura di hook [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="a4033-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="a4033-172">Se si usa un modello personalizzato per definire controlli aggiuntivi, è necessario fornire una procedura hook **PageSetupHook** per elaborare l'input per i controlli.</span><span class="sxs-lookup"><span data-stu-id="a4033-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="a4033-173">Inoltre, è possibile fornire una procedura [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook per personalizzare il contenuto della pagina di esempio visualizzata dalla finestra di dialogo **Imposta pagina** .</span><span class="sxs-lookup"><span data-stu-id="a4033-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="a4033-174">Per ulteriori informazioni sulla procedura di hook **PagePaintHook** , vedere [personalizzazione della pagina di esempio](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="a4033-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="a4033-175">**Per abilitare una procedura PageSetupHook Hook**</span><span class="sxs-lookup"><span data-stu-id="a4033-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="a4033-176">Impostare il **flag \_ ENABLEPAGESETUPHOOK di PSD** nel membro **Flags** della struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a4033-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="a4033-177">Specificare l'indirizzo della routine hook nel membro **lpfnPageSetupHook** .</span><span class="sxs-lookup"><span data-stu-id="a4033-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="a4033-178">Dopo l'elaborazione del messaggio [**WM \_ INITDIALOG**](wm-initdialog.md) , la routine della finestra di dialogo Invia un messaggio **WM \_ INITDIALOG** alla routine hook [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="a4033-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="a4033-179">Il parametro *lParam* di questo messaggio è un puntatore alla struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) utilizzata per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="a4033-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="a4033-180">Personalizzazione della pagina di esempio</span><span class="sxs-lookup"><span data-stu-id="a4033-180">Customizing the Sample Page</span></span>

<span data-ttu-id="a4033-181">Nella finestra di dialogo **Imposta pagina** è inclusa un'immagine di una pagina di esempio in cui viene illustrato il modo in cui le selezioni dell'utente influiscono sull'aspetto dell'output stampato.</span><span class="sxs-lookup"><span data-stu-id="a4033-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="a4033-182">L'immagine è costituita da un rettangolo che rappresenta il tipo di carta o busta selezionato, con un rettangolo della linea tratteggiata che rappresenta i margini correnti e i caratteri parziali (testo greco) per mostrare come appare il testo nella pagina stampata.</span><span class="sxs-lookup"><span data-stu-id="a4033-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="a4033-183">Quando si chiama la funzione [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) , è possibile fornire una procedura di hook [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) per personalizzare l'aspetto della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="a4033-184">**Per abilitare una procedura PagePaintHook Hook**</span><span class="sxs-lookup"><span data-stu-id="a4033-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="a4033-185">Impostare il **flag \_ ENABLEPAGEPAINTHOOK di PSD** nel membro **Flags** della struttura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="a4033-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="a4033-186">Specificare l'indirizzo della routine hook nel membro **lpfnPagePaintHook** .</span><span class="sxs-lookup"><span data-stu-id="a4033-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="a4033-187">Ogni volta che la finestra di dialogo sta per creare il contenuto della pagina di esempio, la procedura di hook riceve i messaggi seguenti nell'ordine in cui sono elencati.</span><span class="sxs-lookup"><span data-stu-id="a4033-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="a4033-188">Messaggio</span><span class="sxs-lookup"><span data-stu-id="a4033-188">Message</span></span>                                                  | <span data-ttu-id="a4033-189">Significato</span><span class="sxs-lookup"><span data-stu-id="a4033-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a4033-190">**\_PAGESETUPDLG PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="a4033-191">La finestra di dialogo sta per creare la pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a4033-192">La procedura hook può utilizzare questo messaggio per prepararsi a creare il contenuto della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="a4033-193">**\_FULLPAGERECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="a4033-194">La finestra di dialogo sta per creare la pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a4033-195">Questo messaggio specifica il rettangolo delimitatore della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="a4033-196">**\_MINMARGINRECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="a4033-197">La finestra di dialogo sta per creare la pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="a4033-198">Questo messaggio specifica il rettangolo del margine.</span><span class="sxs-lookup"><span data-stu-id="a4033-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="a4033-199">**\_MARGINRECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="a4033-200">La finestra di dialogo sta per creare il rettangolo dei margini.</span><span class="sxs-lookup"><span data-stu-id="a4033-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="a4033-201">**\_GREEKTEXTRECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="a4033-202">La finestra di dialogo sta per creare il testo greco all'interno del rettangolo dei margini.</span><span class="sxs-lookup"><span data-stu-id="a4033-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="a4033-203">**\_ENVSTAMPRECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="a4033-204">La finestra di dialogo sta per essere creata nel rettangolo del timbro della busta di una pagina di esempio della busta.</span><span class="sxs-lookup"><span data-stu-id="a4033-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="a4033-205">Questo messaggio viene inviato solo per le buste.</span><span class="sxs-lookup"><span data-stu-id="a4033-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="a4033-206">**\_YAFULLPAGERECT PSD \_ WM**</span><span class="sxs-lookup"><span data-stu-id="a4033-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="a4033-207">La finestra di dialogo sta per creare la parte dell'indirizzo restituito di una pagina di esempio della busta.</span><span class="sxs-lookup"><span data-stu-id="a4033-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="a4033-208">Questo messaggio viene inviato per le buste e altri formati di carta.</span><span class="sxs-lookup"><span data-stu-id="a4033-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="a4033-209">Se la procedura di hook restituisce **true** per uno dei primi tre messaggi di una sequenza di disegno ([**WM \_ PSD \_ PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM \_ PSD \_ FULLPAGERECT**](wm-psd-fullpagerect.md)o [**WM \_ PSD \_ MINMARGINRECT**](wm-psd-minmarginrect.md)) la finestra di dialogo non invia più messaggi e non disegna nella pagina di esempio fino alla successiva necessità di ridisegnare la pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="a4033-210">Se la routine hook restituisce **false** per tutti e tre i messaggi, la finestra di dialogo invierà i messaggi rimanenti della sequenza di disegno.</span><span class="sxs-lookup"><span data-stu-id="a4033-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="a4033-211">Se la procedura di hook restituisce **true** per uno dei messaggi rimanenti in una sequenza di disegno, nella finestra di dialogo non viene disegnata la parte corrispondente della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="a4033-212">Se la procedura di hook restituisce **false** per uno di questi messaggi, la finestra di dialogo disegna la parte della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="a4033-213">Per evitare che la finestra di dialogo disegni il contenuto della pagina di esempio, è possibile impostare il flag **\_ DISABLEPAGEPAINTING di PSD** .</span><span class="sxs-lookup"><span data-stu-id="a4033-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="a4033-214">Questo flag non influisce sulla procedura [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) Hook, che ancora riceve tutti i messaggi di **WM \_ PSD \_ \*** e può tracciare il contenuto della pagina di esempio.</span><span class="sxs-lookup"><span data-stu-id="a4033-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 