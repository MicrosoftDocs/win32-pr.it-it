---
title: Stampa finestra delle proprietà
description: La finestra delle proprietà di stampa è un'interfaccia utente standard che consente all'utente di specificare le proprietà di un particolare processo di stampa.
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Interfaccia utente di Windows, input utente
- Interfaccia utente di Windows, libreria finestra di dialogo comune
- input utente, libreria finestra di dialogo comune
- acquisizione dell'input dell'utente, libreria finestra di dialogo comune
- Libreria finestra di dialogo comune
- finestre di dialogo comuni
- Finestra di dialogo finestra delle proprietà di stampa
- personalizzazione della finestra di dialogo finestra delle proprietà di stampa
- finestre di dialogo predefinite
- finestre di dialogo, finestra delle proprietà di stampa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20905f76af290b3978bec828a382604147297998
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047330"
---
# <a name="print-property-sheet"></a><span data-ttu-id="da060-113">Stampa finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="da060-113">Print Property Sheet</span></span>

<span data-ttu-id="da060-114">La finestra delle proprietà di **stampa** è un'interfaccia utente standard che consente all'utente di specificare le proprietà di un particolare processo di stampa.</span><span class="sxs-lookup"><span data-stu-id="da060-114">The **Print** property sheet is a standard user interface that enables the user to specify the properties of a particular print job.</span></span> <span data-ttu-id="da060-115">La finestra delle proprietà è costituita da un set di pagine delle proprietà che varia in base alla stampante o all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="da060-115">The property sheet is composed of a set of property pages that varies by printer or application.</span></span> <span data-ttu-id="da060-116">Per un subset di pagine delle proprietà standard di Windows, alcune stampanti potrebbero aggiungere pagine di proprietà specifiche del driver e alcune applicazioni potrebbero aggiungere pagine delle proprietà specifiche dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="da060-116">To a subset of standard Windows property pages, some printers might add driver-specific property pages and some applications might add application-specific property pages.</span></span>

<span data-ttu-id="da060-117">Per creare e visualizzare una finestra delle proprietà di **stampa** , inizializzare una struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) e passare la struttura alla funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="da060-117">To create and display a **Print** property sheet, initialize a [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure and pass the structure to the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span>

<span data-ttu-id="da060-118">Nella figura seguente viene illustrata una tipica finestra delle proprietà di **stampa** .</span><span class="sxs-lookup"><span data-stu-id="da060-118">The following illustration shows a typical **Print** property sheet.</span></span>

![finestra delle proprietà della stampante](images/printerpropertypagexp.png)

<span data-ttu-id="da060-120">La maggior parte dei membri della struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) è identica a quella della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="da060-120">Most members of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure are identical to those of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="da060-121">Per le descrizioni di come usare i membri della struttura comune per interagire con i controlli della finestra di dialogo, vedere [finestra di dialogo Stampa](print-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="da060-121">For descriptions of how to use the common structure members to interact with the dialog box controls, see [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="da060-122">Nella parte restante di questo argomento vengono descritte le caratteristiche della finestra delle proprietà di **stampa** che si differenziano dalla finestra di dialogo **stampa** .</span><span class="sxs-lookup"><span data-stu-id="da060-122">The remainder of this topic describes the **Print** property sheet features that differ from the **Print** dialog box.</span></span>

<span data-ttu-id="da060-123">È possibile personalizzare una finestra delle proprietà di **stampa** specificando un modello di finestra di dialogo personalizzato per la parte inferiore della pagina **generale** e specificando pagine delle proprietà aggiuntive per seguire la pagina **generale** .</span><span class="sxs-lookup"><span data-stu-id="da060-123">You can customize a **Print** property sheet by specifying a custom dialog box template for the lower portion of the **General** page and by specifying additional property pages to follow the **General** page.</span></span> <span data-ttu-id="da060-124">Per ulteriori informazioni, vedere [personalizzazione della finestra delle proprietà di stampa](#customizing-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="da060-124">For more information, see [Customizing the Print Property Sheet](#customizing-the-print-property-sheet).</span></span>

<span data-ttu-id="da060-125">È possibile implementare un oggetto callback per ricevere notifiche e messaggi dalla funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) mentre viene visualizzata la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="da060-125">You can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="da060-126">Le applicazioni che forniscono modelli personalizzati o pagine aggiuntive utilizzano l'oggetto callback per comunicare con la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="da060-126">Applications that provide custom templates or additional pages use the callback object to communicate with the property sheet.</span></span> <span data-ttu-id="da060-127">Per ulteriori informazioni, vedere [oggetto callback per la finestra delle proprietà di stampa](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="da060-127">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="da060-128">La finestra delle proprietà di **stampa** fornisce supporto per la specifica di più intervalli di pagine non contigui da stampare.</span><span class="sxs-lookup"><span data-stu-id="da060-128">The **Print** property sheet provides support for specifying multiple, noncontiguous page ranges to print.</span></span> <span data-ttu-id="da060-129">Il membro **lpPageRanges** della struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) specifica una matrice di strutture [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) in cui ogni struttura specifica un intervallo di pagine.</span><span class="sxs-lookup"><span data-stu-id="da060-129">The **lpPageRanges** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure specifies an array of [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) structures in which each structure specifies a page range.</span></span>

<span data-ttu-id="da060-130">La finestra delle proprietà **stampa** Visualizza un pulsante di opzione **pagina corrente** come parte del gruppo di **intervalli di pagine** di pulsanti di opzione.</span><span class="sxs-lookup"><span data-stu-id="da060-130">The **Print** property sheet displays a **Current Page** radio button as part of the **Page Range** group of radio buttons.</span></span> <span data-ttu-id="da060-131">Per controllare il pulsante di opzione della **pagina corrente** , usare i flag **PD \_ CURRENTPAGE** e **PD \_ NOCURRENTPAGE** nel membro **Flags** della struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="da060-131">To control the **Current Page** radio button, use the **PD\_CURRENTPAGE** and **PD\_NOCURRENTPAGE** flags in the **Flags** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="da060-132">In questa sezione vengono illustrati gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="da060-132">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="da060-133">Personalizzazione della finestra delle proprietà di stampa</span><span class="sxs-lookup"><span data-stu-id="da060-133">Customizing the Print Property Sheet</span></span>](#customizing-the-print-property-sheet)
-   [<span data-ttu-id="da060-134">Oggetto callback per la finestra delle proprietà di stampa</span><span class="sxs-lookup"><span data-stu-id="da060-134">Callback Object for the Print Property Sheet</span></span>](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a><span data-ttu-id="da060-135">Personalizzazione della finestra delle proprietà di stampa</span><span class="sxs-lookup"><span data-stu-id="da060-135">Customizing the Print Property Sheet</span></span>

<span data-ttu-id="da060-136">È possibile personalizzare la finestra delle proprietà di **stampa** nei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="da060-136">You can customize the **Print** property sheet in the following ways:</span></span>

-   <span data-ttu-id="da060-137">Fornire un modello personalizzato per la parte inferiore della pagina **generale** .</span><span class="sxs-lookup"><span data-stu-id="da060-137">Provide a custom template for the lower portion of the **General** page.</span></span> <span data-ttu-id="da060-138">Ciò consente di includere controlli aggiuntivi che sono univoci per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="da060-138">This allows you to include additional controls that are unique to your application.</span></span> <span data-ttu-id="da060-139">La funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa il modello personalizzato al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="da060-139">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses your custom template in place of the default template.</span></span>
-   <span data-ttu-id="da060-140">Fornire pagine di proprietà aggiuntive per seguire la pagina **generale** .</span><span class="sxs-lookup"><span data-stu-id="da060-140">Provide additional property pages to follow the **General** page.</span></span>
-   <span data-ttu-id="da060-141">Fornire un oggetto callback.</span><span class="sxs-lookup"><span data-stu-id="da060-141">Provide a callback object.</span></span> <span data-ttu-id="da060-142">Per ulteriori informazioni, vedere [oggetto callback per la finestra delle proprietà di stampa](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="da060-142">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="da060-143">Non è possibile modificare la parte superiore della pagina **generale** .</span><span class="sxs-lookup"><span data-stu-id="da060-143">You cannot change the upper portion of the **General** page.</span></span> <span data-ttu-id="da060-144">Non è possibile modificare le pagine delle proprietà fornite dal driver della stampante.</span><span class="sxs-lookup"><span data-stu-id="da060-144">You cannot change property pages provided by the printer driver.</span></span>

<span data-ttu-id="da060-145">Per fornire un modello personalizzato per la pagina generale:</span><span class="sxs-lookup"><span data-stu-id="da060-145">To provide a custom template for the General page:</span></span>

1.  <span data-ttu-id="da060-146">Creare un modello personalizzato per la parte inferiore della pagina **generale** modificando il modello PRINTDLGEXORD specificato nel file prnsetup. dlg.</span><span class="sxs-lookup"><span data-stu-id="da060-146">Create a custom template for the lower portion of the **General** page by modifying the PRINTDLGEXORD template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="da060-147">In genere, il modello personalizzato deve avere le stesse dimensioni del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="da060-147">Typically, the custom template must be the same size as the default template.</span></span> <span data-ttu-id="da060-148">Tuttavia, è possibile ingrandire il modello personalizzato se si specifica il flag **PD \_ USELARGETEMPLATE** per creare una pagina **generale** di dimensioni maggiori.</span><span class="sxs-lookup"><span data-stu-id="da060-148">However, you can enlarge the custom template if you specify the **PD\_USELARGETEMPLATE** flag to create a larger **General** page.</span></span> <span data-ttu-id="da060-149">Gli identificatori di controllo utilizzati nel modello della finestra di dialogo di **stampa** predefinita sono definiti nel file Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="da060-149">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="da060-150">Utilizzare la struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) per abilitare il modello nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="da060-150">Use the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="da060-151">Se il modello personalizzato è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **PD \_ ENABLEPRINTTEMPLATE** nel membro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="da060-151">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="da060-152">Usare i membri **HINSTANCE** e **lpPrintTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="da060-152">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="da060-153">oppure</span><span class="sxs-lookup"><span data-stu-id="da060-153">-Or-</span></span>

    -   <span data-ttu-id="da060-154">Se il modello personalizzato è già in memoria, impostare il flag **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="da060-154">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="da060-155">Usare il membro **HINSTANCE** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="da060-155">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

3.  <span data-ttu-id="da060-156">Se si usa un modello personalizzato per definire controlli aggiuntivi, è necessario fornire un oggetto callback per elaborare l'input per i controlli.</span><span class="sxs-lookup"><span data-stu-id="da060-156">If you use a custom template to define additional controls, you must provide a callback object to process input for your controls.</span></span> <span data-ttu-id="da060-157">L'oggetto callback implementa un metodo [**IPrintDialogCallback:: HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) che riceve i messaggi inviati alla finestra di dialogo personalizzata.</span><span class="sxs-lookup"><span data-stu-id="da060-157">The callback object implements a [**IPrintDialogCallback::HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) method which receives messages sent to the custom dialog box.</span></span>

<span data-ttu-id="da060-158">Per fornire pagine di proprietà aggiuntive</span><span class="sxs-lookup"><span data-stu-id="da060-158">To provide additional property pages</span></span>

1.  <span data-ttu-id="da060-159">Utilizzare la funzione per creare le pagine aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="da060-159">Use the function to create the additional pages.</span></span>
2.  <span data-ttu-id="da060-160">Usare il membro **lphPropertyPages** della struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) per specificare una matrice di handle per le pagine aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="da060-160">Use the **lphPropertyPages** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to specify an array of handles to the additional pages.</span></span>

    <span data-ttu-id="da060-161">Le routine della finestra di dialogo specificate al momento della creazione di ogni pagina messaggi di processo inviati alle pagine.</span><span class="sxs-lookup"><span data-stu-id="da060-161">The dialog box procedures specified when you created each page process messages sent to the pages.</span></span>

3.  <span data-ttu-id="da060-162">Potrebbe essere necessario fornire un oggetto callback che implementi l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="da060-162">You might want to provide a callback object that implements the interface.</span></span> <span data-ttu-id="da060-163">La funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa questa interfaccia per passare all'applicazione un puntatore a un'interfaccia [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) .</span><span class="sxs-lookup"><span data-stu-id="da060-163">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses this interface to pass to the application a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface.</span></span> <span data-ttu-id="da060-164">Le procedure della finestra di dialogo per le pagine delle proprietà aggiuntive possono utilizzare questa interfaccia per recuperare informazioni sulla stampante attualmente selezionata.</span><span class="sxs-lookup"><span data-stu-id="da060-164">The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</span></span>

## <a name="callback-object-for-the-print-property-sheet"></a><span data-ttu-id="da060-165">Oggetto callback per la finestra delle proprietà di stampa</span><span class="sxs-lookup"><span data-stu-id="da060-165">Callback Object for the Print Property Sheet</span></span>

<span data-ttu-id="da060-166">Un'applicazione che visualizza una finestra delle proprietà di **stampa** può implementare un oggetto callback per ricevere notifiche e messaggi dalla funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) mentre viene visualizzata la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="da060-166">An application that displays a **Print** property sheet can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="da060-167">Per fornire un oggetto callback, specificare un puntatore all'oggetto nel membro **lpCallback** della struttura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="da060-167">To provide a callback object, specify a pointer to the object in the **lpCallback** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="da060-168">L'oggetto callback deve implementare l'interfaccia [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) .</span><span class="sxs-lookup"><span data-stu-id="da060-168">The callback object must implement the [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) interface.</span></span> <span data-ttu-id="da060-169">La funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) chiama i metodi **IPrintDialogCallback** nelle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="da060-169">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls **IPrintDialogCallback** methods in the following situations:</span></span>

-   <span data-ttu-id="da060-170">Quando la finestra di dialogo è stata inizializzata</span><span class="sxs-lookup"><span data-stu-id="da060-170">When the dialog box has been initialized</span></span>
-   <span data-ttu-id="da060-171">Quando l'utente seleziona una stampante diversa dall'elenco delle stampanti installate visualizzate dalla finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="da060-171">When the user selects a different printer from the list of installed printers displayed by the property sheet</span></span>
-   <span data-ttu-id="da060-172">Quando riceve i messaggi per la finestra di dialogo figlio nella parte inferiore della pagina **generale** della finestra delle proprietà</span><span class="sxs-lookup"><span data-stu-id="da060-172">When it receives messages for the child dialog box in the lower portion of the property sheet's **General** page</span></span>

<span data-ttu-id="da060-173">Anche l'oggetto callback deve implementare l'interfaccia [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) .</span><span class="sxs-lookup"><span data-stu-id="da060-173">The callback object should also implement the [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) interface.</span></span> <span data-ttu-id="da060-174">La funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) chiama il metodo per passare un puntatore a un'interfaccia [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="da060-174">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls the method to pass a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface to an application.</span></span> <span data-ttu-id="da060-175">I metodi [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) possono usare l'interfaccia **IPrintDialogServices** per recuperare informazioni sulla stampante attualmente selezionata.</span><span class="sxs-lookup"><span data-stu-id="da060-175">The [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) methods can use the **IPrintDialogServices** interface to retrieve information about the currently selected printer.</span></span> <span data-ttu-id="da060-176">L'interfaccia **IPrintDialogServices** è utile anche per le applicazioni che creano pagine aggiuntive per seguire la pagina **generale** della finestra delle proprietà di **stampa** .</span><span class="sxs-lookup"><span data-stu-id="da060-176">The **IPrintDialogServices** interface is also useful for applications that create additional pages to follow the **General** page of the **Print** property sheet.</span></span> <span data-ttu-id="da060-177">Le routine della finestra di dialogo per le pagine aggiuntive possono chiamare i metodi **IPrintDialogServices** .</span><span class="sxs-lookup"><span data-stu-id="da060-177">The dialog box procedures for the additional pages can call **IPrintDialogServices** methods.</span></span>

 

 