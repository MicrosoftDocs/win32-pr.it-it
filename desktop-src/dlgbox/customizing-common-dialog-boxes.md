---
title: Personalizzazione delle finestre di dialogo comuni
description: In questo argomento viene illustrato come utilizzare le finestre di dialogo comuni.
ms.assetid: 31ba9deb-32e6-455c-be0e-ff8bcc691c80
keywords:
- Libreria finestra di dialogo comune, personalizzazione
- finestre di dialogo comuni, personalizzazione
- personalizzazione delle finestre di dialogo comuni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7eaa71c4f6fc6aa038ef150eb53935f6b3ec280
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399616"
---
# <a name="customizing-common-dialog-boxes"></a><span data-ttu-id="abcd5-106">Personalizzazione delle finestre di dialogo comuni</span><span class="sxs-lookup"><span data-stu-id="abcd5-106">Customizing Common Dialog Boxes</span></span>

<span data-ttu-id="abcd5-107">È possibile usare le finestre di dialogo comuni nel formato standard oppure è possibile personalizzarle.</span><span class="sxs-lookup"><span data-stu-id="abcd5-107">You can use the common dialog boxes in their standard form, or you can customize them.</span></span> <span data-ttu-id="abcd5-108">Dal punto di vista dell'utente, il vantaggio principale della finestra di dialogo comune è l'aspetto e la funzionalità coerenti dell'applicazione all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="abcd5-108">From the user's perspective, the chief benefit of the common dialog box is its consistent appearance and functionality from application to application.</span></span> <span data-ttu-id="abcd5-109">È pertanto importante personalizzare una finestra di dialogo comune solo quando è assolutamente necessaria per un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="abcd5-109">Therefore, it is important that you customize a common dialog box only when it is absolutely necessary for an application.</span></span> <span data-ttu-id="abcd5-110">In caso contrario, l'aspetto coerente e l'interfaccia di codifica semplice andranno perduti.</span><span class="sxs-lookup"><span data-stu-id="abcd5-110">Otherwise, the consistent appearance and simple coding interface are lost.</span></span> <span data-ttu-id="abcd5-111">Le personalizzazioni appropriate lasciano intatto il maggior numero possibile di controlli originali.</span><span class="sxs-lookup"><span data-stu-id="abcd5-111">Appropriate customizations leave intact as many of the original controls as possible.</span></span> <span data-ttu-id="abcd5-112">L'aumento delle dimensioni della finestra di dialogo o l'aggiunta di nuovi controlli nello spazio già disponibile nella finestra di dialogo è una personalizzazione appropriata.</span><span class="sxs-lookup"><span data-stu-id="abcd5-112">Increasing the size of the dialog box or adding new controls in the space already available in the dialog box is an appropriate customization.</span></span> <span data-ttu-id="abcd5-113">Nascondere i controlli originali o modificare in altro modo la funzionalità desiderata dei controlli originali è una personalizzazione meno appropriata.</span><span class="sxs-lookup"><span data-stu-id="abcd5-113">Hiding original controls or otherwise changing the intended functionality of the original controls is a less appropriate customization.</span></span>

<span data-ttu-id="abcd5-114">In questa sezione vengono illustrati i metodi seguenti per la personalizzazione di una finestra di dialogo comune:</span><span class="sxs-lookup"><span data-stu-id="abcd5-114">This section discusses the following methods for customizing a common dialog box:</span></span>

-   [<span data-ttu-id="abcd5-115">Modelli personalizzati</span><span class="sxs-lookup"><span data-stu-id="abcd5-115">Custom Templates</span></span>](#custom-templates)
-   [<span data-ttu-id="abcd5-116">Procedure hook per le finestre di dialogo comuni</span><span class="sxs-lookup"><span data-stu-id="abcd5-116">Hook Procedures for Common Dialog Boxes</span></span>](#hook-procedures-for-common-dialog-boxes)
-   [<span data-ttu-id="abcd5-117">Messaggi comuni della finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="abcd5-117">Common Dialog Messages</span></span>](#common-dialog-messages)
-   [<span data-ttu-id="abcd5-118">Supporto della Guida</span><span class="sxs-lookup"><span data-stu-id="abcd5-118">Help Support</span></span>](#help-support)
    -   [<span data-ttu-id="abcd5-119">Guida sensibile al contesto</span><span class="sxs-lookup"><span data-stu-id="abcd5-119">Context-Sensitive Help</span></span>](#context-sensitive-help)
    -   [<span data-ttu-id="abcd5-120">Pulsante ?</span><span class="sxs-lookup"><span data-stu-id="abcd5-120">The Help Button</span></span>](#the-help-button)

## <a name="custom-templates"></a><span data-ttu-id="abcd5-121">Modelli personalizzati</span><span class="sxs-lookup"><span data-stu-id="abcd5-121">Custom Templates</span></span>

<span data-ttu-id="abcd5-122">Nelle finestre di dialogo comuni sono disponibili modelli predefiniti che definiscono il numero, il tipo e la posizione dei controlli standard nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-122">Common dialog boxes have default templates that define the number, type, and position of the standard controls in the dialog box.</span></span> <span data-ttu-id="abcd5-123">È possibile definire un modello personalizzato per concedere agli utenti l'accesso a controlli aggiuntivi che sono univoci per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="abcd5-123">You can define a custom template to give users access to additional controls that are unique to your application.</span></span>

<span data-ttu-id="abcd5-124">Per tutte le finestre di dialogo comuni ad eccezione delle finestre di dialogo **Apri** e **Salva con nome** di tipo Esplora risorse, è possibile modificare il modello predefinito per creare un modello personalizzato che sostituisce il modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="abcd5-124">For all common dialog boxes except the Explorer-style **Open** and **Save As** dialog boxes, you modify the default template to create a custom template that replaces the default template.</span></span> <span data-ttu-id="abcd5-125">Il modello personalizzato definisce il tipo e la posizione dei controlli standard, oltre a eventuali controlli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="abcd5-125">The custom template defines the type and position of the standard controls as well as any additional controls.</span></span>

<span data-ttu-id="abcd5-126">Quando si crea un modello di finestra di dialogo personalizzato modificando il modello predefinito della finestra di dialogo, verificare che gli identificatori per i controlli aggiunti siano univoci e non siano in conflitto con gli identificatori dei controlli standard.</span><span class="sxs-lookup"><span data-stu-id="abcd5-126">When you create a custom dialog box template by modifying the default dialog box template, make sure the identifiers for any added controls are unique and do not conflict with the identifiers of the standard controls.</span></span> <span data-ttu-id="abcd5-127">Nella tabella seguente sono elencati il nome del file di modello predefinito e il file di inclusione per ognuno dei tipi di finestra di dialogo comuni.</span><span class="sxs-lookup"><span data-stu-id="abcd5-127">The following table lists the name of the default template file and include file for each of the common dialog box types.</span></span>



| <span data-ttu-id="abcd5-128">Tipo di finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="abcd5-128">Dialog box type</span></span>               | <span data-ttu-id="abcd5-129">File modello</span><span class="sxs-lookup"><span data-stu-id="abcd5-129">Template file</span></span> | <span data-ttu-id="abcd5-130">File di inclusione</span><span class="sxs-lookup"><span data-stu-id="abcd5-130">Include file</span></span> |
|-------------------------------|---------------|--------------|
| <span data-ttu-id="abcd5-131">**Colore**</span><span class="sxs-lookup"><span data-stu-id="abcd5-131">**Color**</span></span>                     | <span data-ttu-id="abcd5-132">Color. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-132">Color.dlg</span></span>     | <span data-ttu-id="abcd5-133">ColorDlg. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-133">ColorDlg.h</span></span>   |
| <span data-ttu-id="abcd5-134">**Find**</span><span class="sxs-lookup"><span data-stu-id="abcd5-134">**Find**</span></span>                      | <span data-ttu-id="abcd5-135">FindText. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-135">Findtext.dlg</span></span>  | <span data-ttu-id="abcd5-136">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-136">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-137">**Carattere**</span><span class="sxs-lookup"><span data-stu-id="abcd5-137">**Font**</span></span>                      | <span data-ttu-id="abcd5-138">Font. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-138">Font.dlg</span></span>      | <span data-ttu-id="abcd5-139">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-139">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-140">**Apri** (selezione multipla)</span><span class="sxs-lookup"><span data-stu-id="abcd5-140">**Open** (multiple selection)</span></span> | <span data-ttu-id="abcd5-141">FileOpen. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-141">Fileopen.dlg</span></span>  | <span data-ttu-id="abcd5-142">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-142">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-143">**Apri** (selezione singola)</span><span class="sxs-lookup"><span data-stu-id="abcd5-143">**Open** (single selection)</span></span>   | <span data-ttu-id="abcd5-144">FileOpen. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-144">Fileopen.dlg</span></span>  | <span data-ttu-id="abcd5-145">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-145">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-146">**Imposta pagina**</span><span class="sxs-lookup"><span data-stu-id="abcd5-146">**Page Setup**</span></span>                | <span data-ttu-id="abcd5-147">Prnsetup. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-147">Prnsetup.dlg</span></span>  | <span data-ttu-id="abcd5-148">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-148">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-149">**Stampa**</span><span class="sxs-lookup"><span data-stu-id="abcd5-149">**Print**</span></span>                     | <span data-ttu-id="abcd5-150">Prnsetup. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-150">Prnsetup.dlg</span></span>  | <span data-ttu-id="abcd5-151">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-151">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-152">**Imposta di stampa** (obsoleto)</span><span class="sxs-lookup"><span data-stu-id="abcd5-152">**Print Setup** (obsolete)</span></span>    | <span data-ttu-id="abcd5-153">Prnsetup. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-153">Prnsetup.dlg</span></span>  | <span data-ttu-id="abcd5-154">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-154">Dlgs.h</span></span>       |
| <span data-ttu-id="abcd5-155">**Replace**</span><span class="sxs-lookup"><span data-stu-id="abcd5-155">**Replace**</span></span>                   | <span data-ttu-id="abcd5-156">FindText. dlg</span><span class="sxs-lookup"><span data-stu-id="abcd5-156">Findtext.dlg</span></span>  | <span data-ttu-id="abcd5-157">Dlgs. h</span><span class="sxs-lookup"><span data-stu-id="abcd5-157">Dlgs.h</span></span>       |



 

<span data-ttu-id="abcd5-158">Per abilitare un modello personalizzato, è necessario impostare un flag nel membro **Flags** della struttura corrispondente per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-158">To enable a custom template, you must set a flag in the **Flags** member of the corresponding structure for the dialog box.</span></span> <span data-ttu-id="abcd5-159">Se il modello è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare un flag **ENABLETEMPLATE** nel membro **Flags** e usare i membri **HINSTANCE** e **lpTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="abcd5-159">If the template is a resource in an application or dynamic-link library, set an **ENABLETEMPLATE** flag in the **Flags** member, and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="abcd5-160">Se il modello è già in memoria, impostare un flag **ENABLETEMPLATEHANDLE** nel membro **Flags** e usare il membro **HINSTANCE** per identificare l'oggetto Memory che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="abcd5-160">If the template is already in memory, set an **ENABLETEMPLATEHANDLE** flag in the **Flags** member, and use the **hInstance** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="abcd5-161">Nella maggior parte dei casi, è necessario abilitare anche una procedura di hook per la finestra di dialogo per supportare ed elaborare l'input per i controlli aggiuntivi nel modello personalizzato.</span><span class="sxs-lookup"><span data-stu-id="abcd5-161">In most cases, you must also enable a hook procedure for the dialog box to support and process input for the additional controls in your custom template.</span></span>

<span data-ttu-id="abcd5-162">Per le finestre di dialogo **Apri** e **Salva con nome** di tipo Esplora risorse, i modelli predefiniti non sono disponibili per la modifica.</span><span class="sxs-lookup"><span data-stu-id="abcd5-162">For the Explorer-style **Open** and **Save As** dialog boxes, the default templates are not available for modification.</span></span> <span data-ttu-id="abcd5-163">Al contrario, il modello personalizzato definisce una finestra di dialogo figlio che include solo gli elementi da aggiungere alla finestra di dialogo standard.</span><span class="sxs-lookup"><span data-stu-id="abcd5-163">Instead, your custom template defines a child dialog box that includes only the items to be added to the standard dialog box.</span></span> <span data-ttu-id="abcd5-164">Il modello personalizzato può anche definire un controllo statico che specifica il percorso del cluster di controlli standard nella finestra di dialogo figlio.</span><span class="sxs-lookup"><span data-stu-id="abcd5-164">The custom template can also define a static control that specifies the location of the cluster of standard controls in the child dialog box.</span></span> <span data-ttu-id="abcd5-165">Per ulteriori informazioni, vedere [modelli personalizzati di tipo Esplora risorse](open-and-save-as-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="abcd5-165">For more information, see [Explorer-Style Custom Templates](open-and-save-as-dialog-boxes.md).</span></span>

## <a name="hook-procedures-for-common-dialog-boxes"></a><span data-ttu-id="abcd5-166">Procedure hook per le finestre di dialogo comuni</span><span class="sxs-lookup"><span data-stu-id="abcd5-166">Hook Procedures for Common Dialog Boxes</span></span>

<span data-ttu-id="abcd5-167">Per ognuna delle finestre di dialogo comuni, è possibile abilitare una procedura hook per elaborare i messaggi dalla procedura predefinita della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-167">For each of the common dialog boxes, you can enable a hook procedure to process messages from the default dialog box procedure.</span></span> <span data-ttu-id="abcd5-168">Esistono due tipi generali di procedure comuni di hook della finestra di dialogo:</span><span class="sxs-lookup"><span data-stu-id="abcd5-168">There are two general types of common dialog hook procedures:</span></span>

-   <span data-ttu-id="abcd5-169">Procedura di hook standard utilizzata con le finestre di dialogo più comuni</span><span class="sxs-lookup"><span data-stu-id="abcd5-169">The standard hook procedure used with most common dialog boxes</span></span>
-   <span data-ttu-id="abcd5-170">Procedura di hook di tipo Esplora risorse supportata dalle finestre di dialogo **Apri** e **Salva con nome**</span><span class="sxs-lookup"><span data-stu-id="abcd5-170">The Explorer-style hook procedure supported by the **Open** and **Save As** dialog boxes</span></span>

<span data-ttu-id="abcd5-171">Quando si fornisce una procedura di Hook Standard per una delle finestre di dialogo comuni, la routine della finestra di dialogo predefinita gestisce i messaggi nel modo seguente.</span><span class="sxs-lookup"><span data-stu-id="abcd5-171">When you provide a standard hook procedure for one of the common dialog boxes, the default dialog box procedure handles its messages as follows.</span></span>



| <span data-ttu-id="abcd5-172">Message</span><span class="sxs-lookup"><span data-stu-id="abcd5-172">Message</span></span>                                 | <span data-ttu-id="abcd5-173">Gestione</span><span class="sxs-lookup"><span data-stu-id="abcd5-173">Handling</span></span>                                                                                                                                                                                                             |
|-----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="abcd5-174">**\_INITDIALOG WM**</span><span class="sxs-lookup"><span data-stu-id="abcd5-174">**WM\_INITDIALOG**</span></span>](wm-initdialog.md) | <span data-ttu-id="abcd5-175">La routine predefinita della finestra di dialogo elabora il messaggio prima di passarlo alla routine hook.</span><span class="sxs-lookup"><span data-stu-id="abcd5-175">The default dialog box procedure processes the message before passing it to the hook procedure.</span></span> <span data-ttu-id="abcd5-176">Il parametro *lParam* del messaggio è un puntatore alla struttura di inizializzazione specificata al momento della creazione della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-176">The message's *lParam* parameter is a pointer to the initialization structure specified when the dialog was created.</span></span> |
| <span data-ttu-id="abcd5-177">Tutti gli altri messaggi</span><span class="sxs-lookup"><span data-stu-id="abcd5-177">All other messages</span></span>                      | <span data-ttu-id="abcd5-178">La routine hook riceve prima il messaggio.</span><span class="sxs-lookup"><span data-stu-id="abcd5-178">The hook procedure receives the message first.</span></span> <span data-ttu-id="abcd5-179">Quindi, il valore restituito della routine hook determina se la routine della finestra di dialogo predefinita elabora il messaggio o lo ignora.</span><span class="sxs-lookup"><span data-stu-id="abcd5-179">Then, the return value of the hook procedure determines whether the default dialog procedure processes the message or ignores it.</span></span>                                     |



 

<span data-ttu-id="abcd5-180">Per le finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse, la routine hook non riceve messaggi destinati ai controlli standard nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-180">For the Explorer-style **Open** and **Save As** dialog boxes, the hook procedure does not receive messages intended for the standard controls in the dialog box.</span></span> <span data-ttu-id="abcd5-181">Al contrario, riceve i messaggi di notifica dalla finestra di dialogo e i messaggi per qualsiasi altro controllo definito in un modello personalizzato.</span><span class="sxs-lookup"><span data-stu-id="abcd5-181">Instead, it receives notification messages from the dialog box and messages for any additional controls that you defined in a custom template.</span></span> <span data-ttu-id="abcd5-182">Per ulteriori informazioni, vedere [procedure hook di tipo Esplora risorse](open-and-save-as-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="abcd5-182">For more information, see [Explorer-Style Hook Procedures](open-and-save-as-dialog-boxes.md).</span></span>

<span data-ttu-id="abcd5-183">Per abilitare una routine hook, impostare un valore **ENABLEHOOK** nel membro **Flags** della struttura corrispondente per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-183">To enable a hook procedure, set an **ENABLEHOOK** value in the **Flags** member of the corresponding structure for the dialog box.</span></span> <span data-ttu-id="abcd5-184">Se è impostato un flag **ENABLEHOOK** , è necessario che un membro **lpfnHook** della struttura specifichi l'indirizzo della routine hook.</span><span class="sxs-lookup"><span data-stu-id="abcd5-184">If an **ENABLEHOOK** flag is set, an **lpfnHook** member of the structure must specify the address of the hook procedure.</span></span>

<span data-ttu-id="abcd5-185">Nella tabella seguente viene illustrato il tipo di routine hook da fornire per ognuna delle finestre di dialogo comuni.</span><span class="sxs-lookup"><span data-stu-id="abcd5-185">The following table shows the type of hook procedure to provide for each of the common dialog boxes.</span></span>



| <span data-ttu-id="abcd5-186">Tipo di finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="abcd5-186">Dialog box type</span></span>                          | <span data-ttu-id="abcd5-187">Routine hook</span><span class="sxs-lookup"><span data-stu-id="abcd5-187">Hook procedure</span></span>                                      |
|------------------------------------------|-----------------------------------------------------|
| <span data-ttu-id="abcd5-188">**Colore**</span><span class="sxs-lookup"><span data-stu-id="abcd5-188">**Color**</span></span>                                | [<span data-ttu-id="abcd5-189">*CCHookProc*</span><span class="sxs-lookup"><span data-stu-id="abcd5-189">*CCHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc)                      |
| <span data-ttu-id="abcd5-190">**Trova** o **Sostituisci**</span><span class="sxs-lookup"><span data-stu-id="abcd5-190">**Find** or **Replace**</span></span>                  | [<span data-ttu-id="abcd5-191">*FRHookProc*</span><span class="sxs-lookup"><span data-stu-id="abcd5-191">*FRHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpfrhookproc)                      |
| <span data-ttu-id="abcd5-192">**Carattere**</span><span class="sxs-lookup"><span data-stu-id="abcd5-192">**Font**</span></span>                                 | [<span data-ttu-id="abcd5-193">*CFHookProc*</span><span class="sxs-lookup"><span data-stu-id="abcd5-193">*CFHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc)                      |
| <span data-ttu-id="abcd5-194">**Apri** o **Salva con nome** (stile Explorer)</span><span class="sxs-lookup"><span data-stu-id="abcd5-194">**Open** or **Save As** (Explorer-style)</span></span> | [<span data-ttu-id="abcd5-195">*OFNHookProc*</span><span class="sxs-lookup"><span data-stu-id="abcd5-195">*OFNHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)                    |
| <span data-ttu-id="abcd5-196">**Apri** o **Salva con nome** (obsoleto)</span><span class="sxs-lookup"><span data-stu-id="abcd5-196">**Open** or **Save As** (Old-style)</span></span>      | <span data-ttu-id="abcd5-197">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="abcd5-197">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span></span> |
| <span data-ttu-id="abcd5-198">**Stampa**</span><span class="sxs-lookup"><span data-stu-id="abcd5-198">**Print**</span></span>                                | [<span data-ttu-id="abcd5-199">*PrintHookProc*</span><span class="sxs-lookup"><span data-stu-id="abcd5-199">*PrintHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc)                |
| <span data-ttu-id="abcd5-200">**Imposta pagina**</span><span class="sxs-lookup"><span data-stu-id="abcd5-200">**Page Setup**</span></span>                           | [<span data-ttu-id="abcd5-201">*PageSetupHook*</span><span class="sxs-lookup"><span data-stu-id="abcd5-201">*PageSetupHook*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook)                |



 

<span data-ttu-id="abcd5-202">Per la finestra di dialogo **Imposta pagina** , è anche possibile specificare una procedura hook [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) .</span><span class="sxs-lookup"><span data-stu-id="abcd5-202">For the **Page Setup** dialog box, you can also specify a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure.</span></span> <span data-ttu-id="abcd5-203">Si tratta di una procedura di hook speciale che è possibile utilizzare per personalizzare l'aspetto della pagina di esempio visualizzata dalla finestra di dialogo **Imposta pagina** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-203">This is a special hook procedure that you can use to customize the appearance of the sample page displayed by the **Page Setup** dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="abcd5-204">La finestra di dialogo imposta **stampa** è stata sostituita dalla finestra di dialogo **Imposta pagina** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-204">The **Print Setup** dialog box has been superseded by the **Page Setup** dialog box.</span></span> <span data-ttu-id="abcd5-205">Le applicazioni devono utilizzare la finestra di dialogo **Imposta pagina** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-205">Applications should use the **Page Setup** dialog box.</span></span> <span data-ttu-id="abcd5-206">Tuttavia, per compatibilità, la funzione [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) continua a supportare la visualizzazione della finestra di dialogo di **installazione di stampa** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-206">However, for compatibility, the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function continues to support display of the **Print Setup** dialog box.</span></span> <span data-ttu-id="abcd5-207">È possibile specificare una procedura di hook [*SetupHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpsetuphookproc) per la finestra di dialogo **Imposta stampa** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-207">You can provide a [*SetupHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpsetuphookproc) hook procedure for the **Print Setup** dialog box.</span></span>

 

## <a name="common-dialog-messages"></a><span data-ttu-id="abcd5-208">Messaggi comuni della finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="abcd5-208">Common Dialog Messages</span></span>

<span data-ttu-id="abcd5-209">Nelle finestre di dialogo comuni vengono utilizzati messaggi per notificare alla routine della finestra o all'hook la procedura quando si verificano determinati eventi.</span><span class="sxs-lookup"><span data-stu-id="abcd5-209">Common dialog boxes use messages to notify your window procedure or hook procedure when certain events occur.</span></span> <span data-ttu-id="abcd5-210">Sono inoltre disponibili messaggi che è possibile inviare a una finestra di dialogo comune per recuperare informazioni o controllare il comportamento o l'aspetto della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-210">In addition, there are messages that you can send to a common dialog box to retrieve information or to control the behavior or appearance of the dialog box.</span></span> <span data-ttu-id="abcd5-211">In questa sezione vengono descritti i messaggi di dialogo comuni registrati dalla funzione [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) , i messaggi utilizzati dalla finestra di dialogo **tipo di carattere** e la finestra di dialogo **Imposta pagina** e i messaggi utilizzati dalle finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="abcd5-211">This section describes the common dialog messages registered by the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function, messages used by the **Font** dialog box and **Page Setup** dialog box, and messages used by the Explorer-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="abcd5-212">La libreria finestra di dialogo comune definisce un set di stringhe di messaggio.</span><span class="sxs-lookup"><span data-stu-id="abcd5-212">The Common Dialog Box Library defines a set of message strings.</span></span> <span data-ttu-id="abcd5-213">È possibile passare una costante associata a una di queste stringhe di messaggio a [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) per ottenere un identificatore del messaggio.</span><span class="sxs-lookup"><span data-stu-id="abcd5-213">You can pass a constant associated with one of these message strings to [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) to get a message identifier.</span></span> <span data-ttu-id="abcd5-214">È quindi possibile utilizzare l'identificatore per rilevare ed elaborare i messaggi inviati da una finestra di dialogo comune o per inviare messaggi a una finestra di dialogo comune.</span><span class="sxs-lookup"><span data-stu-id="abcd5-214">You can then use the identifier to detect and process messages sent from a common dialog box, or to send messages to a common dialog box.</span></span> <span data-ttu-id="abcd5-215">Nella tabella seguente vengono illustrate le costanti del messaggio e ne viene descritto l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-215">The following table shows the message constants and describes their use.</span></span>



| <span data-ttu-id="abcd5-216">Contante</span><span class="sxs-lookup"><span data-stu-id="abcd5-216">Contants</span></span>                               | <span data-ttu-id="abcd5-217">Uso</span><span class="sxs-lookup"><span data-stu-id="abcd5-217">Use</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="abcd5-218">**COLOROKSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-218">**COLOROKSTRING**</span></span>](colorokstring.md) | <span data-ttu-id="abcd5-219">Una finestra di dialogo **colore** Invia questo messaggio alla procedura hook quando l'utente seleziona un colore e fa clic sul pulsante **OK** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-219">A **Color** dialog box sends this message to the hook procedure when the user selects a color and clicks the **OK** button.</span></span> <span data-ttu-id="abcd5-220">La routine hook può accettare il colore o rifiutarla e forzare la finestra di dialogo in modo che rimanga aperta.</span><span class="sxs-lookup"><span data-stu-id="abcd5-220">The hook procedure can accept the color, or reject it and force the dialog box to remain open.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="abcd5-221">**FILEOKSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-221">**FILEOKSTRING**</span></span>](fileokstring.md)   | <span data-ttu-id="abcd5-222">Una finestra di dialogo **Apri** o **Salva con** nome Invia questo messaggio alla procedura hook quando l'utente seleziona un nome file e fa clic sul pulsante **OK** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-222">An **Open** or **Save As** dialog box sends this message to the hook procedure when the user selects a file name and clicks the **OK** button.</span></span> <span data-ttu-id="abcd5-223">La procedura di hook può accettare il nome del file o rifiutarla e forzare la finestra di dialogo in modo che rimanga aperta.</span><span class="sxs-lookup"><span data-stu-id="abcd5-223">The hook procedure can accept the file name, or reject it and force the dialog box to remain open.</span></span> <span data-ttu-id="abcd5-224">Per le finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse, questo messaggio è stato sostituito dal messaggio di notifica [**\_ FILEOK**](cdn-fileok.md) della rete CDN.</span><span class="sxs-lookup"><span data-stu-id="abcd5-224">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_FILEOK**](cdn-fileok.md) notification message.</span></span><br/> |
| [<span data-ttu-id="abcd5-225">**FINDMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-225">**FINDMSGSTRING**</span></span>](findmsgstring.md) | <span data-ttu-id="abcd5-226">Una finestra di dialogo **trova** o **Sostituisci** Invia questo messaggio alla routine della finestra della finestra padre quando l'utente fa clic sulla finestra di dialogo **Trova successivo**, **Sostituisci** o **Sostituisci tutto** oppure chiude la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-226">A **Find** or **Replace** dialog box sends this message to the window procedure of its parent window when the user clicks the **Find Next**, **Replace**, or **Replace All**, or closes the dialog box.</span></span> <span data-ttu-id="abcd5-227">Il parametro *lParam* del messaggio è un puntatore a una struttura [**FindReplace**](/windows/win32/api/commdlg/ns-commdlg-findreplacea) contenente l'input dell'utente.</span><span class="sxs-lookup"><span data-stu-id="abcd5-227">The message's *lParam* parameter is a pointer to a [**FINDREPLACE**](/windows/win32/api/commdlg/ns-commdlg-findreplacea) structure containing the user's input.</span></span>                                                                               |
| [<span data-ttu-id="abcd5-228">**HELPMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-228">**HELPMSGSTRING**</span></span>](helpmsgstring.md) | <span data-ttu-id="abcd5-229">Tutte le finestre di dialogo comuni inviano questo messaggio alla routine della finestra della finestra padre quando l'utente fa clic sul pulsante della **Guida** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-229">All common dialog boxes send this message to the window procedure of their parent window when the user clicks the **Help** button.</span></span> <span data-ttu-id="abcd5-230">Per le finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse, questo messaggio è stato sostituito dal messaggio di notifica della [**\_ Guida**](cdn-help.md) della rete CDN.</span><span class="sxs-lookup"><span data-stu-id="abcd5-230">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_HELP**](cdn-help.md) notification message.</span></span><br/>                                                                                                                    |
| [<span data-ttu-id="abcd5-231">**LBSELCHSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-231">**LBSELCHSTRING**</span></span>](lbselchstring.md) | <span data-ttu-id="abcd5-232">Una finestra di dialogo **Apri** o **Salva con** nome Invia questo messaggio alla procedura hook quando l'utente modifica la selezione nella casella di riepilogo **nome file** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-232">An **Open** or **Save As** dialog box sends this message to the hook procedure when the user changes the selection in the **File Name** list box.</span></span> <span data-ttu-id="abcd5-233">Per le finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse, questo messaggio è stato sostituito dal messaggio di notifica [**\_ selChange**](cdn-selchange.md) della rete CDN.</span><span class="sxs-lookup"><span data-stu-id="abcd5-233">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_SELCHANGE**](cdn-selchange.md) notification message.</span></span><br/>                                                                                           |
| [<span data-ttu-id="abcd5-234">**SETRGBSTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-234">**SETRGBSTRING**</span></span>](setrgbstring.md)   | <span data-ttu-id="abcd5-235">Una procedura hook può inviare questo messaggio a una finestra di dialogo **colore** per impostare la selezione del colore corrente.</span><span class="sxs-lookup"><span data-stu-id="abcd5-235">A hook procedure can send this message to a **Color** dialog box to set the current color selection.</span></span>                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="abcd5-236">**SHAREVISTRING**</span><span class="sxs-lookup"><span data-stu-id="abcd5-236">**SHAREVISTRING**</span></span>](sharevistring.md) | <span data-ttu-id="abcd5-237">Una finestra di dialogo **Apri** o **Salva con nome** Invia questo messaggio alla procedura hook se si verifica una violazione di condivisione per il file selezionato quando l'utente fa clic sul pulsante **OK** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-237">An **Open** or **Save As** dialog box sends this message to the hook procedure if a sharing violation occurs for the selected file when the user clicks the **OK** button.</span></span> <span data-ttu-id="abcd5-238">Per le finestre di dialogo **Apri** e **Salva con nome** in stile Esplora risorse, questo messaggio è stato sostituito dal messaggio di notifica [**\_ SHAREVIOLATION**](cdn-shareviolation.md) della rete CDN.</span><span class="sxs-lookup"><span data-stu-id="abcd5-238">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) notification message.</span></span><br/>                                                        |



 

<span data-ttu-id="abcd5-239">Alcune finestre di dialogo comuni inviano e ricevono altri messaggi della finestra.</span><span class="sxs-lookup"><span data-stu-id="abcd5-239">Some common dialog boxes send and receive other window messages.</span></span> <span data-ttu-id="abcd5-240">La procedura hook per una finestra di dialogo **tipo di carattere** può inviare qualsiasi messaggio **WM \_ ChooseFont \_ \*** alla finestra di dialogo **tipo di carattere** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-240">The hook procedure for a **Font** dialog box can send any of the **WM\_CHOOSEFONT\_\*** messages to the **Font** dialog box.</span></span> <span data-ttu-id="abcd5-241">Per ulteriori informazioni, vedere finestra di [dialogo tipo di carattere](font-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="abcd5-241">For more information, see [Font Dialog Box](font-dialog-box.md).</span></span> <span data-ttu-id="abcd5-242">Se è stata abilitata una procedura [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) Hook, la finestra di dialogo **Imposta pagina** invia i messaggi di **WM \_ PSD \_ \*** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-242">The **Page Setup** dialog box sends the **WM\_PSD\_\*** messages if you have enabled a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure.</span></span> <span data-ttu-id="abcd5-243">Per ulteriori informazioni, vedere finestra di [dialogo Imposta pagina](page-setup-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="abcd5-243">For more information, see [Page Setup Dialog Box](page-setup-dialog-box.md).</span></span>

<span data-ttu-id="abcd5-244">Le finestre di dialogo **Apri** e **Salva con nome di** tipo Esplora risorse supportano un set di messaggi predefiniti.</span><span class="sxs-lookup"><span data-stu-id="abcd5-244">The Explorer-style **Open** and **Save As** dialog boxes support a set of predefined messages.</span></span> <span data-ttu-id="abcd5-245">Sono inclusi i messaggi di notifica inviati sotto forma di un messaggio di [**\_ notifica WM**](../controls/wm-notify.md) alla routine hook e i messaggi che la procedura di hook può inviare alla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-245">These include notification messages sent in the form of a [**WM\_NOTIFY**](../controls/wm-notify.md) message to your hook procedure, and messages that your hook procedure can send to the dialog box.</span></span> <span data-ttu-id="abcd5-246">Per un elenco completo di questi messaggi, vedere [procedure hook di tipo Esplora risorse](open-and-save-as-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="abcd5-246">For a complete list of these messages, see [Explorer-Style Hook Procedures](open-and-save-as-dialog-boxes.md).</span></span>

## <a name="help-support"></a><span data-ttu-id="abcd5-247">Supporto della Guida</span><span class="sxs-lookup"><span data-stu-id="abcd5-247">Help Support</span></span>

<span data-ttu-id="abcd5-248">Le finestre di dialogo comuni forniscono la Guida sensibile al contesto per i controlli standard della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-248">Common dialog boxes provide context-sensitive help for the standard controls of the dialog box.</span></span> <span data-ttu-id="abcd5-249">Per fornire una Guida aggiuntiva per una finestra di dialogo comune, è possibile visualizzare un pulsante della **Guida** ed elaborare i messaggi generati quando l'utente fa clic sul pulsante.</span><span class="sxs-lookup"><span data-stu-id="abcd5-249">To provide additional help for a common dialog box, you can display a **Help** button and process messages generated when the user clicks the button.</span></span> <span data-ttu-id="abcd5-250">Il pulsante della **Guida** è un supplemento alla Guida sensibile al contesto predefinita.</span><span class="sxs-lookup"><span data-stu-id="abcd5-250">The **Help** button is a supplement to the default context-sensitive help.</span></span> <span data-ttu-id="abcd5-251">Il **pulsante?** è utile per descrivere lo scopo generale della finestra di dialogo che si applica all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="abcd5-251">The **Help** button is useful for describing the general purpose of the dialog box as it applies to your application.</span></span>

-   [<span data-ttu-id="abcd5-252">Guida sensibile al contesto</span><span class="sxs-lookup"><span data-stu-id="abcd5-252">Context-Sensitive Help</span></span>](#context-sensitive-help)
-   [<span data-ttu-id="abcd5-253">Pulsante ?</span><span class="sxs-lookup"><span data-stu-id="abcd5-253">The Help Button</span></span>](#the-help-button)

### <a name="context-sensitive-help"></a><span data-ttu-id="abcd5-254">Guida Context-Sensitive</span><span class="sxs-lookup"><span data-stu-id="abcd5-254">Context-Sensitive Help</span></span>

<span data-ttu-id="abcd5-255">Tutte le finestre di dialogo comuni forniscono la Guida sensibile al contesto per i controlli standard della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-255">All common dialog boxes provide context-sensitive help for the standard controls of the dialog box.</span></span> <span data-ttu-id="abcd5-256">L'utente può visualizzare la guida per i singoli controlli mediante uno dei metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="abcd5-256">The user can display help for individual controls by any of the following methods:</span></span>

-   <span data-ttu-id="abcd5-257">Selezione del controllo e pressione del tasto F1.</span><span class="sxs-lookup"><span data-stu-id="abcd5-257">Selecting the control and pressing the F1 key.</span></span>
-   <span data-ttu-id="abcd5-258">Fare clic su **?**</span><span class="sxs-lookup"><span data-stu-id="abcd5-258">Clicking the **?**</span></span> <span data-ttu-id="abcd5-259">nella barra del titolo e quindi facendo clic su un controllo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-259">button in the title bar and subsequently clicking on a control.</span></span>
-   <span data-ttu-id="abcd5-260">Fare clic con il pulsante destro del mouse su un controllo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-260">Clicking the right mouse button over a control.</span></span>

<span data-ttu-id="abcd5-261">Se si personalizza una finestra di dialogo aggiungendo nuovi controlli, è necessario estendere anche il supporto della Guida per questi controlli elaborando le richieste di supporto nella procedura hook.</span><span class="sxs-lookup"><span data-stu-id="abcd5-261">If you customize a dialog box by adding new controls, you must also extend help support for these controls by processing requests for help in the hook procedure.</span></span> <span data-ttu-id="abcd5-262">La routine hook riceve i messaggi seguenti quando l'utente richiede la guida.</span><span class="sxs-lookup"><span data-stu-id="abcd5-262">The hook procedure receives the following messages when the user requests help.</span></span>



| <span data-ttu-id="abcd5-263">Azione utente</span><span class="sxs-lookup"><span data-stu-id="abcd5-263">User action</span></span>                                                           | <span data-ttu-id="abcd5-264">Message</span><span class="sxs-lookup"><span data-stu-id="abcd5-264">Message</span></span>                                      |
|-----------------------------------------------------------------------|----------------------------------------------|
| <span data-ttu-id="abcd5-265">Fare clic con il pulsante destro del mouse su un controllo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-265">Click the right mouse button over a control.</span></span>                          | [<span data-ttu-id="abcd5-266">**ContextMenu di WM \_**</span><span class="sxs-lookup"><span data-stu-id="abcd5-266">**WM\_CONTEXTMENU**</span></span>](/windows/desktop/menurc/wm-contextmenu) |
| <span data-ttu-id="abcd5-267">Premere il tasto F1.</span><span class="sxs-lookup"><span data-stu-id="abcd5-267">Pressed the F1 key.</span></span>                                                   | [<span data-ttu-id="abcd5-268">**Guida di WM \_**</span><span class="sxs-lookup"><span data-stu-id="abcd5-268">**WM\_HELP**</span></span>](../shell/wm-help.md)               |
| <span data-ttu-id="abcd5-269">Fai clic sul pulsante **?**</span><span class="sxs-lookup"><span data-stu-id="abcd5-269">Clicked the **?**</span></span> <span data-ttu-id="abcd5-270">sulla barra del titolo, quindi fare clic su un controllo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-270">button on the title bar and then clicked a control.</span></span> | [<span data-ttu-id="abcd5-271">**Guida di WM \_**</span><span class="sxs-lookup"><span data-stu-id="abcd5-271">**WM\_HELP**</span></span>](../shell/wm-help.md)               |



 

<span data-ttu-id="abcd5-272">È necessario elaborare questi messaggi per i controlli aggiunti, ma lasciare che la routine della finestra di dialogo predefinita elabori i messaggi per i controlli standard.</span><span class="sxs-lookup"><span data-stu-id="abcd5-272">You should process these messages for the controls you have added, but let the default dialog box procedure process the messages for the standard controls.</span></span> <span data-ttu-id="abcd5-273">Per ulteriori informazioni su come elaborare questi messaggi, vedere la [Guida](/previous-versions/windows/desktop/legacy/bb776786(v=vs.85))di.</span><span class="sxs-lookup"><span data-stu-id="abcd5-273">For more information about how to process these messages, see [Help](/previous-versions/windows/desktop/legacy/bb776786(v=vs.85)).</span></span>

### <a name="the-help-button"></a><span data-ttu-id="abcd5-274">Pulsante ?</span><span class="sxs-lookup"><span data-stu-id="abcd5-274">The Help Button</span></span>

<span data-ttu-id="abcd5-275">È possibile visualizzare un pulsante della **Guida** in una delle finestre di dialogo comuni impostando un valore **SHOWHELP** nel membro **Flags** della struttura di inizializzazione per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-275">You can display a **Help** button in any of the common dialog boxes by setting a **SHOWHELP** value in the **Flags** member of the initialization structure for the dialog box.</span></span> <span data-ttu-id="abcd5-276">Se viene visualizzato il **pulsante?** , è necessario elaborare la richiesta dell'utente per la guida.</span><span class="sxs-lookup"><span data-stu-id="abcd5-276">If you display the **Help** button, you must process the user's request for help.</span></span> <span data-ttu-id="abcd5-277">L'elaborazione può essere eseguita in una delle routine della finestra dell'applicazione o in una procedura di hook per la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="abcd5-277">The processing can be done either in one of your application's window procedures or in a hook procedure for the dialog box.</span></span> <span data-ttu-id="abcd5-278">In genere, la richiesta di assistenza viene elaborata chiamando la funzione [**WinHelp**](/windows/win32/api/winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="abcd5-278">Typically, you would process the request for help by calling the [**WinHelp**](/windows/win32/api/winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="abcd5-279">Per elaborare i messaggi della Guida in una delle routine della finestra, è necessario ottenere un identificatore di messaggio per la stringa definita dal valore [**HELPMSGSTRING**](helpmsgstring.md) e identificare la finestra per la ricezione dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="abcd5-279">To process help messages in one of your window procedures, you must get a message identifier for the string defined by the [**HELPMSGSTRING**](helpmsgstring.md) value and identify the window to receive messages.</span></span> <span data-ttu-id="abcd5-280">Per ottenere l'identificatore del messaggio, specificare **HELPMSGSTRING** come parametro in una chiamata alla funzione [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) .</span><span class="sxs-lookup"><span data-stu-id="abcd5-280">To get the message identifier, specify **HELPMSGSTRING** as the parameter in a call to the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function.</span></span> <span data-ttu-id="abcd5-281">Quando si crea la finestra di dialogo, utilizzare il membro **hwndOwner** della struttura di inizializzazione della finestra di dialogo per identificare la finestra che riceverà i messaggi.</span><span class="sxs-lookup"><span data-stu-id="abcd5-281">When you create the dialog box, use the **hwndOwner** member of the dialog box initialization structure to identify the window that is to receive the messages.</span></span> <span data-ttu-id="abcd5-282">La routine della finestra di dialogo Invia il messaggio alla routine della finestra ogni volta che l'utente fa clic sul pulsante della **Guida** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-282">The dialog box procedure sends the message to the window procedure whenever the user clicks the **Help** button.</span></span>

<span data-ttu-id="abcd5-283">Per elaborare i messaggi della Guida in una procedura hook, è necessario elaborare il messaggio di [**\_ comando WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="abcd5-283">To process help messages in a hook procedure, you should process the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="abcd5-284">La routine hook fornisce la guida se il parametro *wParam* di questo messaggio indica che l'utente ha fatto clic **sul pulsante?** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-284">The hook procedure provides help if the *wParam* parameter of this message indicates that the user clicked the **Help** button.</span></span> <span data-ttu-id="abcd5-285">**L'identificatore del pulsante?** è la costante **pshHelp** definita nel file Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="abcd5-285">The identifier of the **Help** button is the **pshHelp** constant defined in the Dlgs.h file.</span></span>

<span data-ttu-id="abcd5-286">Le procedure hook per le finestre di dialogo **Apri** e **Salva con nome** di tipo Esplora risorse non ricevono i messaggi di [**\_ comando WM**](/windows/desktop/menurc/wm-command) per il pulsante **Guida** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-286">Hook procedures for the Explorer-style **Open** and **Save As** dialog boxes do not receive [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages for the **Help** button.</span></span> <span data-ttu-id="abcd5-287">Al contrario, la finestra di dialogo Invia un messaggio di notifica della [**\_ Guida**](cdn-help.md) della rete CDN alla procedura hook quando si fa clic **sul pulsante?** .</span><span class="sxs-lookup"><span data-stu-id="abcd5-287">Instead, the dialog box sends a [**CDN\_HELP**](cdn-help.md) notification message to the hook procedure when the **Help** button is clicked.</span></span>

 

