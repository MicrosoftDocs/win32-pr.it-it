---
title: Finestra di dialogo Stampa
description: La finestra di dialogo Stampa consente all'utente di selezionare le opzioni per un particolare processo di stampa.
ms.assetid: 34f69b25-8a89-4322-af4c-a80b85a4a973
keywords:
- Interfaccia utente di Windows, input utente
- Interfaccia utente di Windows, libreria finestra di dialogo comune
- input utente, libreria finestra di dialogo comune
- acquisizione dell'input dell'utente, libreria finestra di dialogo comune
- Libreria finestra di dialogo comune
- finestre di dialogo comuni
- Finestra di dialogo Stampa
- Finestra di dialogo Imposta stampa
- personalizzazione della finestra di dialogo Stampa
- finestre di dialogo predefinite
- finestre di dialogo, stampa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fae1dd244391ea16478a0cb4f10803cf622dc64
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104118407"
---
# <a name="print-dialog-box"></a><span data-ttu-id="b31c6-114">Finestra di dialogo Stampa</span><span class="sxs-lookup"><span data-stu-id="b31c6-114">Print Dialog Box</span></span>

<span data-ttu-id="b31c6-115">La finestra di dialogo **stampa** consente all'utente di selezionare le opzioni per un particolare processo di stampa.</span><span class="sxs-lookup"><span data-stu-id="b31c6-115">The **Print** dialog box lets the user select options for a particular print job.</span></span> <span data-ttu-id="b31c6-116">Ad esempio, l'utente può specificare la stampante da usare, l'intervallo di pagine da stampare e il numero di copie.</span><span class="sxs-lookup"><span data-stu-id="b31c6-116">For example, the user can specify the printer to use, the range of pages to print, and the number of copies.</span></span>

<span data-ttu-id="b31c6-117">È possibile utilizzare la funzione [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) per visualizzare una [finestra delle proprietà di stampa](print-property-sheet.md), che include una pagina **generale** contenente controlli simili alla finestra di dialogo **stampa** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-117">You can use the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function to display a [Print Property Sheet](print-property-sheet.md), which has a **General** page containing controls similar to the **Print** dialog box.</span></span> <span data-ttu-id="b31c6-118">Nella finestra delle proprietà possono inoltre essere presenti pagine di proprietà aggiuntive specifiche per l'applicazione e specifiche del driver che seguono la pagina **generale** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-118">The property sheet can also have additional application-specific and driver-specific property pages following the **General** page.</span></span>

<span data-ttu-id="b31c6-119">Per creare e visualizzare una finestra di dialogo di **stampa** , inizializzare una struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) e passare la struttura alla funzione [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-119">You create and display a **Print** dialog box by initializing a [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure and passing the structure to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span>

<span data-ttu-id="b31c6-120">Nella figura seguente viene illustrata una tipica finestra di dialogo **stampa** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-120">The following illustration shows a typical **Print** dialog box.</span></span>

![finestra di dialogo Stampa](images/printdialogboxxp.png)

<span data-ttu-id="b31c6-122">Se l'utente fa clic sul pulsante **OK** , [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) restituisce **true** e usa la struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) per restituire informazioni sulle selezioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-122">If the user clicks the **OK** button, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **TRUE** and uses the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to return information about the user's selections.</span></span> <span data-ttu-id="b31c6-123">I membri **hDevMode** e **hDevNames** , ad esempio, restituiscono in genere handle di memoria globali per le strutture e [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-123">For example, the **hDevMode** and **hDevNames** members typically return global memory handles for and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="b31c6-124">È possibile utilizzare le informazioni contenute in queste strutture per creare un contesto di dispositivo o un contesto di informazioni per la stampante selezionata.</span><span class="sxs-lookup"><span data-stu-id="b31c6-124">You can use the information in these structures to create a device context or an information context for the selected printer.</span></span>

<span data-ttu-id="b31c6-125">Se l'utente annulla la finestra di dialogo **stampa** o si verifica un errore, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) restituisce **false**.</span><span class="sxs-lookup"><span data-stu-id="b31c6-125">If the user cancels the **Print** dialog box or an error occurs, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="b31c6-126">È possibile determinare la provocazione di un errore utilizzando la funzione [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) per recuperare il valore di errore esteso.</span><span class="sxs-lookup"><span data-stu-id="b31c6-126">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="b31c6-127">Nella finestra di dialogo **stampa** è incluso un gruppo di pulsanti di opzione di **stampa** che indica se l'utente desidera stampare tutte le pagine, un intervallo di pagine o solo il testo selezionato.</span><span class="sxs-lookup"><span data-stu-id="b31c6-127">The **Print** dialog box includes a **Print Range** group of radio buttons that indicate whether the user wants to print all pages, a range of pages, or only the selected text.</span></span> <span data-ttu-id="b31c6-128">Prima di chiamare [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), è possibile impostare uno dei flag **PD \_ ALLPAGES**, **PD \_ Selection** o **PD \_ PAGENUMS** per indicare quale pulsante inizialmente è selezionato.</span><span class="sxs-lookup"><span data-stu-id="b31c6-128">Before calling [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), you can set one of the **PD\_ALLPAGES**, **PD\_SELECTION**, or **PD\_PAGENUMS** flags to indicate which button is initially selected.</span></span> <span data-ttu-id="b31c6-129">Quando **PrintDlg** restituisce **true**, la funzione imposta uno di questi flag per indicare le selezioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-129">When **PrintDlg** returns **TRUE**, the function sets one of these flags to indicate the user's selections.</span></span> <span data-ttu-id="b31c6-130">Se è impostato **PD \_ PAGENUMS** , i membri **nFromPage** e **nToPage** della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) contengono le pagine iniziale e finale specificate dall'utente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-130">If **PD\_PAGENUMS** is set, the **nFromPage** and **nToPage** members of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure contain the starting and ending pages specified by the user.</span></span> <span data-ttu-id="b31c6-131">Per disabilitare il pulsante di opzione **pagine** e il relativo oggetto associato **da** e **per** modificare i controlli, impostare il flag **PD \_ NOPAGENUMS** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-131">To disable the **Pages** radio button and its associated **From** and **To** edit controls, set the **PD\_NOPAGENUMS** flag.</span></span> <span data-ttu-id="b31c6-132">Per disabilitare il pulsante di opzione **selezione** , impostare il flag **PD \_ noselection** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-132">To disable the **Selection** radio button, set the **PD\_NOSELECTION** flag.</span></span>

<span data-ttu-id="b31c6-133">Nella finestra di dialogo è incluso un controllo di modifica in cui l'utente può digitare il numero di copie da stampare.</span><span class="sxs-lookup"><span data-stu-id="b31c6-133">The dialog box includes an edit control in which the user can type the number of copies to print.</span></span> <span data-ttu-id="b31c6-134">Se il membro **hDevMode** della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) è diverso da **null**, il membro **dmCopies** della struttura specifica il valore iniziale per questo controllo di modifica.</span><span class="sxs-lookup"><span data-stu-id="b31c6-134">If the **hDevMode** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure is non-**NULL**, the **dmCopies** member of the structure specifies the initial value for this edit control.</span></span> <span data-ttu-id="b31c6-135">Se **hDevMode** è **null**, il membro **nCopies** della struttura **PrintDlg** specifica il valore iniziale.</span><span class="sxs-lookup"><span data-stu-id="b31c6-135">If **hDevMode** is **NULL**, the **nCopies** member of the **PRINTDLG** structure specifies the initial value.</span></span> <span data-ttu-id="b31c6-136">Quando [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) restituisce, **nCopies** in genere indica il numero di copie specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-136">When [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns, **nCopies** typically indicates the number of copies specified by the user.</span></span> <span data-ttu-id="b31c6-137">Tuttavia, se si imposta il **flag PD \_ USEDEVMODECOPIESANDCOLLATE** quando si crea la finestra di dialogo, **nCopies** viene sempre impostato su 1 in fase di restituzione e il membro **dmCopies** di [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indica il numero di copie da stampare.</span><span class="sxs-lookup"><span data-stu-id="b31c6-137">However, if you set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag when you create the dialog box, **nCopies** is always set to 1 on return and the **dmCopies** member of [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indicates the number of copies to print.</span></span>

<span data-ttu-id="b31c6-138">La casella di controllo **COLLATE** indica se l'utente desidera eseguire l'ordinamento delle pagine se vengono stampate più copie.</span><span class="sxs-lookup"><span data-stu-id="b31c6-138">The **Collate** check box indicates whether the user wants to collate the pages if multiple copies are being printed.</span></span> <span data-ttu-id="b31c6-139">Se è selezionata la casella di controllo **COLLATE** , il flag di **\_ ordinamento PD** viene impostato.</span><span class="sxs-lookup"><span data-stu-id="b31c6-139">The **PD\_COLLATE** flag is set if the **Collate** check box is selected.</span></span> <span data-ttu-id="b31c6-140">Se l'applicazione non supporta più copie o regole di confronto simulate, impostare il flag **PD \_ USEDEVMODECOPIESANDCOLLATE** nel membro **Flags** della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-140">If your application does not support multiple copies or simulated collation, set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="b31c6-141">In questo modo vengono disabilitate la casella di controllo **COLLATE** e il controllo **di modifica numero di copie** , a meno che il driver della stampante non supporti più copie e regole di confronto.</span><span class="sxs-lookup"><span data-stu-id="b31c6-141">This disables the **Collate** check box and the **Number of Copies** edit control unless the printer driver supports multiple copies and collation.</span></span>

<span data-ttu-id="b31c6-142">La casella **di controllo stampa su file** indica se l'utente desidera inviare l'output a un file anziché a una stampante.</span><span class="sxs-lookup"><span data-stu-id="b31c6-142">The **Print To File** check box indicates whether the user wants to send output to a file rather than to a printer.</span></span> <span data-ttu-id="b31c6-143">È possibile impostare il flag **PD \_ PrintToFile** in modo che la casella di controllo sia selezionata inizialmente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-143">You can set the **PD\_PRINTTOFILE** flag so the check box is initially selected.</span></span> <span data-ttu-id="b31c6-144">Per nascondere la casella di controllo, impostare il flag **PD \_ HIDEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-144">To hide the check box, set the **PD\_HIDEPRINTTOFILE** flag.</span></span> <span data-ttu-id="b31c6-145">Per disabilitarlo, impostare il flag **PD \_ DISABLEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-145">To disable it, set the **PD\_DISABLEPRINTTOFILE** flag.</span></span> <span data-ttu-id="b31c6-146">Se l'utente seleziona l'opzione **stampa su file** , [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) imposta il flag **PD \_ PrintToFile** e restituisce "file:" in corrispondenza dell'offset indicato dal membro **wOutputOffset** della struttura [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-146">If the user selects the **Print To File** option, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) sets the **PD\_PRINTTOFILE** flag and returns "FILE:" at the offset indicated by the **wOutputOffset** member of the [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure.</span></span> <span data-ttu-id="b31c6-147">Quando si chiama la funzione per avviare l'operazione di stampa, specificare la stringa "FILE:" nel membro **lpszOutput** della struttura.</span><span class="sxs-lookup"><span data-stu-id="b31c6-147">When you call the function to start the printing operation, specify this "FILE:" string in the **lpszOutput** member of the structure.</span></span> <span data-ttu-id="b31c6-148">Se si specifica questa stringa, il sottosistema di stampa esegue una query sull'utente per il nome del file di output.</span><span class="sxs-lookup"><span data-stu-id="b31c6-148">Specifying this string causes the print subsystem to query the user for the name of the output file.</span></span>

<span data-ttu-id="b31c6-149">Per impostazione predefinita, nella finestra di dialogo **stampa** vengono inizialmente visualizzate informazioni sulla stampante predefinita corrente.</span><span class="sxs-lookup"><span data-stu-id="b31c6-149">By default, the **Print** dialog box initially displays information about the current default printer.</span></span> <span data-ttu-id="b31c6-150">Per visualizzare informazioni per un'altra stampante installata, inizializzare una struttura e una struttura [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) e assegnare l'handle di memoria globale alla struttura ai membri **hDevMode** e **hDevNames** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-150">To display information for another installed printer, initialize a and a [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handle to the structure to the **hDevMode** and **hDevNames** members.</span></span> <span data-ttu-id="b31c6-151">Il nome del dispositivo specificato nel membro **dmDeviceName** della struttura [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) e nel membro **wDriverOffset** della struttura **DEVNAMES** deve identificare un dispositivo di stampa che è elencato anche nella \[ sezione Devices \] del file di Win.ini.</span><span class="sxs-lookup"><span data-stu-id="b31c6-151">The device name you specify in the **dmDeviceName** member of the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure and in the **wDriverOffset** member of the **DEVNAMES** structure must identify a printer device that is also listed in the \[Devices\] section of the Win.ini file.</span></span> <span data-ttu-id="b31c6-152">Se il dispositivo non è elencato, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) restituisce un errore.</span><span class="sxs-lookup"><span data-stu-id="b31c6-152">If the device is not listed, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns an error.</span></span>

<span data-ttu-id="b31c6-153">È possibile indirizzare [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) per creare un contesto di dispositivo o un contesto di informazioni per la stampante impostando il flag **PD \_ RETURNDC** o **PD \_ Returnal** nel membro **Flags** della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-153">You can direct [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) to create a device context or information context for the printer by setting the **PD\_RETURNDC** or **PD\_RETURNIC** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="b31c6-154">La funzione restituisce un handle per il contesto di dispositivo o il contesto delle informazioni nel membro **HDC** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-154">The function returns a handle to the device context or information context in the **hDC** member.</span></span> <span data-ttu-id="b31c6-155">Se si usa il flag **PD \_ RETURNDC** , è possibile usare il contesto di dispositivo per generare l'output per la stampante.</span><span class="sxs-lookup"><span data-stu-id="b31c6-155">If you use the **PD\_RETURNDC** flag, you can use the device context to generate output for the printer.</span></span>

<span data-ttu-id="b31c6-156">Per recuperare le informazioni sulla stampante predefinita senza visualizzare la finestra di dialogo **stampa** , impostare il flag **PD \_ RETURNDEFAULT** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-156">To retrieve information about the default printer without displaying the **Print** dialog box, set the **PD\_RETURNDEFAULT** flag.</span></span> <span data-ttu-id="b31c6-157">In questo caso, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) viene restituito immediatamente dopo aver impostato i membri **hDevMode** e **hDevNames** su handle per le strutture che contengono le informazioni.</span><span class="sxs-lookup"><span data-stu-id="b31c6-157">In this case, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns immediately after setting the **hDevMode** and **hDevNames** members to handles for structures containing the information.</span></span>

<span data-ttu-id="b31c6-158">Per impostazione predefinita, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) Visualizza le finestre di messaggio quando si verificano errori.</span><span class="sxs-lookup"><span data-stu-id="b31c6-158">By default, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) displays message boxes when errors occur.</span></span> <span data-ttu-id="b31c6-159">La funzione, ad esempio, Visualizza un messaggio di errore se non sono installate stampanti.</span><span class="sxs-lookup"><span data-stu-id="b31c6-159">For example, the function displays an error message if no printers are installed.</span></span> <span data-ttu-id="b31c6-160">Per impedire la visualizzazione di questi messaggi di avviso da parte della funzione, impostare il flag **PD \_ nowarning** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-160">To prevent the function from displaying these warning messages, set the **PD\_NOWARNING** flag.</span></span>

<span data-ttu-id="b31c6-161">In questa sezione vengono descritti gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="b31c6-161">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="b31c6-162">Personalizzazione della finestra di dialogo Stampa</span><span class="sxs-lookup"><span data-stu-id="b31c6-162">Customizing the Print Dialog Box</span></span>](#customizing-the-print-dialog-box)
-   [<span data-ttu-id="b31c6-163">Finestra di dialogo Imposta stampa</span><span class="sxs-lookup"><span data-stu-id="b31c6-163">Print Setup Dialog Box</span></span>](#print-setup-dialog-box)

## <a name="customizing-the-print-dialog-box"></a><span data-ttu-id="b31c6-164">Personalizzazione della finestra di dialogo Stampa</span><span class="sxs-lookup"><span data-stu-id="b31c6-164">Customizing the Print Dialog Box</span></span>

<span data-ttu-id="b31c6-165">È possibile specificare un modello personalizzato per la finestra di dialogo **stampa** , ad esempio se si desidera includere controlli aggiuntivi che siano univoci per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b31c6-165">You can provide a custom template for the **Print** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="b31c6-166">La funzione [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) usa il modello personalizzato al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="b31c6-166">The [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="b31c6-167">Per fornire un modello personalizzato per la finestra di dialogo **stampa** :</span><span class="sxs-lookup"><span data-stu-id="b31c6-167">To provide a custom template for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="b31c6-168">Creare il modello personalizzato modificando il modello predefinito specificato nel file prnsetup. dlg.</span><span class="sxs-lookup"><span data-stu-id="b31c6-168">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="b31c6-169">Gli identificatori di controllo utilizzati nel modello della finestra di dialogo di **stampa** predefinita sono definiti nel file Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="b31c6-169">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="b31c6-170">Utilizzare la struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) per abilitare il modello nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="b31c6-170">Use the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="b31c6-171">Se il modello personalizzato è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **PD \_ ENABLEPRINTTEMPLATE** nel membro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-171">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="b31c6-172">Usare i membri **HINSTANCE** e **lpPrintTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="b31c6-172">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="b31c6-173">oppure</span><span class="sxs-lookup"><span data-stu-id="b31c6-173">-Or-</span></span>

    -   <span data-ttu-id="b31c6-174">Se il modello personalizzato è già in memoria, impostare il flag **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-174">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="b31c6-175">Usare il membro **hPrintTemplate** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="b31c6-175">Use the **hPrintTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="b31c6-176">È possibile specificare una procedura di hook [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) per la finestra di dialogo **stampa** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-176">You can provide a [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) hook procedure for the **Print** dialog box.</span></span> <span data-ttu-id="b31c6-177">La procedura hook può elaborare i messaggi inviati alla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b31c6-177">The hook procedure can process messages sent to the dialog box.</span></span> <span data-ttu-id="b31c6-178">Può inoltre inviare messaggi alla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b31c6-178">It can also send messages to the dialog box.</span></span> <span data-ttu-id="b31c6-179">Se si usa un modello personalizzato per definire controlli aggiuntivi, è necessario fornire una procedura di hook per elaborare l'input per i controlli.</span><span class="sxs-lookup"><span data-stu-id="b31c6-179">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="b31c6-180">Per abilitare una procedura di hook per la finestra di dialogo **stampa** :</span><span class="sxs-lookup"><span data-stu-id="b31c6-180">To enable a hook procedure for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="b31c6-181">Impostare il flag **PD \_ ENABLEPRINTHOOK** nel membro **Flags** della struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-181">Set the **PD\_ENABLEPRINTHOOK** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span>
2.  <span data-ttu-id="b31c6-182">Specificare l'indirizzo della routine hook nel membro **lpfnPrintHook** .</span><span class="sxs-lookup"><span data-stu-id="b31c6-182">Specify the address of the hook procedure in the **lpfnPrintHook** member.</span></span>

<span data-ttu-id="b31c6-183">Dopo l'elaborazione del messaggio [**WM \_ INITDIALOG**](wm-initdialog.md) , la routine della finestra di dialogo Invia un messaggio **WM \_ INITDIALOG** alla routine hook.</span><span class="sxs-lookup"><span data-stu-id="b31c6-183">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="b31c6-184">Il parametro *lParam* di questo messaggio è un puntatore alla struttura [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) utilizzata per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b31c6-184">The *lParam* parameter of this message is a pointer to the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure used to initialize the dialog box.</span></span>

## <a name="print-setup-dialog-box"></a><span data-ttu-id="b31c6-185">Finestra di dialogo Imposta stampa</span><span class="sxs-lookup"><span data-stu-id="b31c6-185">Print Setup Dialog Box</span></span>

<span data-ttu-id="b31c6-186">È possibile creare e visualizzare una finestra di dialogo di **stampa** impostando il flag **PD \_ PRINTSETUP** in una chiamata alla funzione [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="b31c6-186">You can create and display a **Print Setup** dialog box by setting the **PD\_PRINTSETUP** flag in a call to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span> <span data-ttu-id="b31c6-187">Tuttavia, la finestra di dialogo **Imposta stampa** è stata sostituita dalla finestra di dialogo **Imposta pagina** e non deve essere utilizzata nelle nuove applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b31c6-187">However, the **Print Setup** dialog box has been superseded by the **Page Setup** dialog box and should not be used in new applications.</span></span>

<span data-ttu-id="b31c6-188">I flag seguenti si applicano solo alla finestra di dialogo **Imposta stampa** :</span><span class="sxs-lookup"><span data-stu-id="b31c6-188">The following flags apply only to the **Print Setup** dialog box:</span></span>

-   <span data-ttu-id="b31c6-189">**\_ENABLESETUPHOOK PD**</span><span class="sxs-lookup"><span data-stu-id="b31c6-189">**PD\_ENABLESETUPHOOK**</span></span>
-   <span data-ttu-id="b31c6-190">**\_ENABLESETUPTEMPLATE PD**</span><span class="sxs-lookup"><span data-stu-id="b31c6-190">**PD\_ENABLESETUPTEMPLATE**</span></span>
-   <span data-ttu-id="b31c6-191">**\_ENABLESETUPTEMPLATEHANDLE PD**</span><span class="sxs-lookup"><span data-stu-id="b31c6-191">**PD\_ENABLESETUPTEMPLATEHANDLE**</span></span>

 

 