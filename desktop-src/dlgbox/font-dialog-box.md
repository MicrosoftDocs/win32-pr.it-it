---
title: Finestra di dialogo Tipo di carattere
description: La finestra di dialogo tipo di carattere consente all'utente di scegliere gli attributi per un tipo di carattere logico, ad esempio la famiglia di caratteri e lo stile del carattere associato, le dimensioni del punto, gli effetti (sottolineato, l'attacco e il colore del testo) e uno script (o set di caratteri).
ms.assetid: e8a996aa-4e34-45d0-a325-9c20b1a6ce07
keywords:
- Interfaccia utente di Windows, input utente
- Interfaccia utente di Windows, libreria finestra di dialogo comune
- input utente, libreria finestra di dialogo comune
- acquisizione dell'input dell'utente, libreria finestra di dialogo comune
- Libreria finestra di dialogo comune
- finestre di dialogo comuni
- Tipo di carattere (finestra di dialogo)
- personalizzazione della finestra di dialogo carattere
- flag, finestra di dialogo carattere
- flag di inizializzazione
- finestre di dialogo predefinite
- finestre di dialogo, carattere
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9a752ce53ecf496c58efb0c346a8c3d67c4f1b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104047297"
---
# <a name="font-dialog-box"></a><span data-ttu-id="12c3e-115">Finestra di dialogo Tipo di carattere</span><span class="sxs-lookup"><span data-stu-id="12c3e-115">Font Dialog Box</span></span>

<span data-ttu-id="12c3e-116">La finestra di dialogo **tipo di carattere** consente all'utente di scegliere gli attributi per un tipo di carattere logico, ad esempio la famiglia di caratteri e lo stile del carattere associato, le dimensioni del punto, gli effetti (sottolineato, l'attacco e il colore del testo) e uno script (o set di caratteri).</span><span class="sxs-lookup"><span data-stu-id="12c3e-116">The **Font** dialog box lets the user choose attributes for a logical font, such as font family and associated font style, point size, effects (underline, strikeout, and text color), and a script (or character set).</span></span>

<span data-ttu-id="12c3e-117">Per creare e visualizzare una finestra di dialogo **tipo di carattere** , inizializzare una struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) e passare la struttura alla funzione [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="12c3e-117">You create and display a **Font** dialog box by initializing a [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure and passing the structure to the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function.</span></span>

<span data-ttu-id="12c3e-118">Lo screenshot seguente mostra una finestra di dialogo tipica del **tipo di carattere** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-118">The following screen shot shows a typical **Font** dialog box.</span></span>

![screenshot che mostra la finestra di dialogo tipo di carattere](images/fontdialogboxxp.png)

<span data-ttu-id="12c3e-120">Se l'utente fa clic sul pulsante **OK** , la funzione [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) restituisce **true** e imposta le informazioni sulla selezione dell'utente nella struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="12c3e-120">If the user clicks the **OK** button, the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function returns **TRUE** and sets the information about the user's selection in the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure.</span></span>

<span data-ttu-id="12c3e-121">Se l'utente annulla la finestra di dialogo **tipo di carattere** o si verifica un errore, [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) restituisce **false** e il contenuto della struttura [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) non è definito.</span><span class="sxs-lookup"><span data-stu-id="12c3e-121">If the user cancels the **Font** dialog box or an error occurs, [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) returns **FALSE** and the contents of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure are not defined.</span></span> <span data-ttu-id="12c3e-122">È possibile determinare la provocazione di un errore utilizzando la funzione [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) per recuperare il valore di errore esteso.</span><span class="sxs-lookup"><span data-stu-id="12c3e-122">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="12c3e-123">In questa sezione vengono descritti gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="12c3e-123">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="12c3e-124">Flag di inizializzazione della finestra di dialogo carattere</span><span class="sxs-lookup"><span data-stu-id="12c3e-124">Font Dialog Box Initialization Flags</span></span>](#font-dialog-box-initialization-flags)
-   [<span data-ttu-id="12c3e-125">Personalizzazione della finestra di dialogo tipo di carattere nelle versioni precedenti di Windows</span><span class="sxs-lookup"><span data-stu-id="12c3e-125">Customizing the Font Dialog Box on earlier versions of Windows</span></span>](#customizing-the-font-dialog-box-on-earlier-versions-of-windows)
-   [<span data-ttu-id="12c3e-126">Personalizzazione della finestra di dialogo tipo di carattere in Windows 7</span><span class="sxs-lookup"><span data-stu-id="12c3e-126">Customizing the Font Dialog Box on Windows 7</span></span>](#customizing-the-font-dialog-box-on-windows-7)

## <a name="font-dialog-box-initialization-flags"></a><span data-ttu-id="12c3e-127">Flag di inizializzazione della finestra di dialogo carattere</span><span class="sxs-lookup"><span data-stu-id="12c3e-127">Font Dialog Box Initialization Flags</span></span>

<span data-ttu-id="12c3e-128">Prima di chiamare [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta), è necessario che il membro dei **flag** della struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) specifichi **CF \_ SCREENFONTS**, **CF \_ PRINTERFONTS** o CF per indicare se nella finestra di dialogo sono elencati i tipi di carattere della schermata, i tipi di carattere della stampante o entrambi. **\_**</span><span class="sxs-lookup"><span data-stu-id="12c3e-128">Before calling [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta), the **Flags** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure must specify **CF\_SCREENFONTS**, **CF\_PRINTERFONTS**, or **CF\_BOTH**, to indicate whether the dialog box should list screen fonts, printer fonts, or both.</span></span> <span data-ttu-id="12c3e-129">Se si specifica **CF \_ PRINTERFONTS** o **CF \_ both**, il membro **HDC** della struttura **ChooseFont** deve specificare un handle per un contesto di dispositivo per la stampante.</span><span class="sxs-lookup"><span data-stu-id="12c3e-129">If you specify **CF\_PRINTERFONTS** or **CF\_BOTH**, the **hDC** member of the **CHOOSEFONT** structure must specify a handle to a device context for the printer.</span></span>

<span data-ttu-id="12c3e-130">Se è impostato il flag **CF \_ PRINTERFONTS** o **CF \_** , l'etichetta Descrizione tipo di carattere viene visualizzata nella parte inferiore della finestra di dialogo tipo di **carattere** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-130">If the **CF\_PRINTERFONTS** or **CF\_BOTH** flag is set, the font type description label appears at the bottom of the **Font** dialog box.</span></span>

<span data-ttu-id="12c3e-131">A partire da Windows 7, i flag CF **\_ PRINTERFONTS**, **CF \_ SCREENFONTS**, **CF \_ both** e **CF \_ WYSIWYG** non vengono più usati dalla funzione [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) per l'enumerazione del tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="12c3e-131">Starting with Windows 7, the **CF\_PRINTERFONTS**, **CF\_SCREENFONTS**, **CF\_BOTH**, and **CF\_WYSIWYG** flags are no longer used by the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function for font enumeration.</span></span> <span data-ttu-id="12c3e-132">Sono obsolete in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="12c3e-132">They are obsolete in Windows 7.</span></span> <span data-ttu-id="12c3e-133">Tuttavia, il flag **CF \_ PRINTERFONTS** mantiene una funzione: per visualizzare l'etichetta della descrizione del tipo di carattere nella parte inferiore della finestra di dialogo tipo di **carattere** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-133">However, the **CF\_PRINTERFONTS** flag retains one function: to display the font type description label at the bottom of the **Font** dialog box.</span></span>

<span data-ttu-id="12c3e-134">È possibile usare il membro **Flags** per abilitare o disabilitare alcuni dei controlli della finestra di dialogo del **tipo di carattere** ed è possibile usare il membro **Flags** insieme ad altri membri [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) per controllare i valori iniziali di alcuni controlli.</span><span class="sxs-lookup"><span data-stu-id="12c3e-134">You can use the **Flags** member to enable or disable some of the **Font** dialog box controls, and you can use the **Flags** member in conjunction with other [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) members to control the initial values of some controls.</span></span>

<span data-ttu-id="12c3e-135">**Per visualizzare i controlli che consentono all'utente di selezionare le opzioni di attacco, sottolineatura e colore:**</span><span class="sxs-lookup"><span data-stu-id="12c3e-135">**To display the controls that allow the user to select strikeout, underline, and color options:**</span></span>

-   <span data-ttu-id="12c3e-136">Imposta il **flag \_ degli effetti CF** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-136">Set the **CF\_EFFECTS** flag.</span></span> <span data-ttu-id="12c3e-137">È possibile usare il membro **rgbColors** della struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) per specificare un colore iniziale del carattere.</span><span class="sxs-lookup"><span data-stu-id="12c3e-137">You can use the **rgbColors** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure to specify an initial font color.</span></span>

<span data-ttu-id="12c3e-138">**Per specificare i valori iniziali per il tipo di carattere, lo stile del carattere, le dimensioni, l'attacco e la sottolineatura controlli della finestra di dialogo:**</span><span class="sxs-lookup"><span data-stu-id="12c3e-138">**To specify the initial values for the Font, Font Style, Size, Strikeout, and Underline dialog box controls:**</span></span>

1.  <span data-ttu-id="12c3e-139">Per specificare i valori iniziali per il tipo di carattere, lo stile del carattere, le dimensioni, l'attacco e la sottolineatura controlli della finestra di dialogo:</span><span class="sxs-lookup"><span data-stu-id="12c3e-139">To specify the initial values for the Font, Font Style, Size, Strikeout, and Underline dialog box controls:</span></span>
2.  <span data-ttu-id="12c3e-140">Impostare il **flag CF \_ INITTOLOGFONTSTRUCT** nel membro **Flags** , insieme ai membri della struttura [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) a cui punta **LPLOGFONT**, per specificare i valori iniziali per gli attributi del tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="12c3e-140">Set the **CF\_INITTOLOGFONTSTRUCT** flag in the **Flags** member, along with members of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that is pointed to by the **lpLogFont**, to specify the initial values for the font attributes.</span></span>
3.  <span data-ttu-id="12c3e-141">È anche possibile usare i **flag \_ CF NOFACESEL**, **CF \_ NOSTYLESEL** e **CF \_ NOSIZESEL** per impedire alla finestra di dialogo **tipo di carattere** di visualizzare i valori iniziali per i controlli corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="12c3e-141">You can also use the **CF\_NOFACESEL**, **CF\_NOSTYLESEL**, and **CF\_NOSIZESEL** flags to prevent the **Font** dialog box from displaying initial values for the corresponding controls.</span></span> <span data-ttu-id="12c3e-142">Questa operazione è utile quando si utilizza una selezione di testo con più di un carattere tipografico, uno stile o una dimensione del punto.</span><span class="sxs-lookup"><span data-stu-id="12c3e-142">This is useful when you are working with a selection of text that has more than one typeface, style, or point size.</span></span> <span data-ttu-id="12c3e-143">Questi valori verranno impostati nei **flag** anche quando [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) restituisce, se l'utente non ha selezionato un valore corrispondente.</span><span class="sxs-lookup"><span data-stu-id="12c3e-143">These values will also be set in **Flags** when [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) returns, if the user did not select a corresponding value.</span></span>

<span data-ttu-id="12c3e-144">**Per inizializzare il controllo dello stile del tipo di carattere sul nome di uno stile specificato**</span><span class="sxs-lookup"><span data-stu-id="12c3e-144">**To initialize the Font Style control to a specified style name**</span></span>

-   <span data-ttu-id="12c3e-145">Impostare il flag **CF \_ USESTYLE** e usare il membro **lpszStyle** per specificare il nome dello stile.</span><span class="sxs-lookup"><span data-stu-id="12c3e-145">Set the **CF\_USESTYLE** flag and use the **lpszStyle** member to specify the style name.</span></span>

> [!Note]  
> <span data-ttu-id="12c3e-146">Per globalizzare l'applicazione, specificare lo stile usando i membri **lfWeight** e **LfItalic** della struttura [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) a cui punta **LPLOGFONT**.</span><span class="sxs-lookup"><span data-stu-id="12c3e-146">To globalize your application, specify the style by using the **lfWeight** and **lfItalic** members of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that is pointed to by **lpLogFont**.</span></span> <span data-ttu-id="12c3e-147">Il nome dello stile può variare a seconda della lingua dell'interfaccia utente del sistema.</span><span class="sxs-lookup"><span data-stu-id="12c3e-147">The style name may change depending on the system user interface language.</span></span>

 

<span data-ttu-id="12c3e-148">**Per visualizzare il pulsante applica**</span><span class="sxs-lookup"><span data-stu-id="12c3e-148">**To display the Apply button**</span></span>

-   <span data-ttu-id="12c3e-149">Impostare il flag **CF \_ Apply** e fornire una procedura di hook per elaborare i messaggi di [**\_ comando WM**](/windows/desktop/menurc/wm-command) per il pulsante **applica** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-149">Set the **CF\_APPLY** flag and provide a hook procedure to process [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages for the **Apply** button.</span></span> <span data-ttu-id="12c3e-150">La procedura hook può inviare il messaggio [**WM \_ ChooseFont \_ GETLOGFONT**](wm-choosefont-getlogfont.md) alla finestra di dialogo per recuperare l'indirizzo della struttura [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) che contiene le selezioni correnti per il tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="12c3e-150">The hook procedure can send the [**WM\_CHOOSEFONT\_GETLOGFONT**](wm-choosefont-getlogfont.md) message to the dialog box to retrieve the address of the [**LOGFONT**](/windows/win32/api/wingdi/ns-wingdi-logfonta) structure that contains the current selections for the font.</span></span>

<span data-ttu-id="12c3e-151">**Per visualizzare il pulsante?**</span><span class="sxs-lookup"><span data-stu-id="12c3e-151">**To display the Help button**</span></span>

-   <span data-ttu-id="12c3e-152">Impostare il flag **CF \_ SHOWHELP** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-152">Set the **CF\_SHOWHELP** flag.</span></span> <span data-ttu-id="12c3e-153">Il membro **hwndOwner** deve identificare la finestra per ricevere il messaggio registrato [**HELPMSGSTRING**](helpmsgstring.md) quando l'utente fa clic sul pulsante della **Guida** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-153">The **hwndOwner** member must identify the window to receive the [**HELPMSGSTRING**](helpmsgstring.md) registered message when the user clicks the **Help** button.</span></span>

<span data-ttu-id="12c3e-154">**Per limitare i tipi di carattere visualizzati nella finestra di dialogo**</span><span class="sxs-lookup"><span data-stu-id="12c3e-154">**To restrict the fonts displayed in the dialog box**</span></span>

-   <span data-ttu-id="12c3e-155">Impostare qualsiasi combinazione dei flag **CF \_ TTONLY**, **CF \_ FIXEDPITCHONLY**, **CF \_ NOVECTORFONTS**, **CF \_ NOVERTFONTS**, **CF \_ SCALABLEONLY** e **CF \_ WYSIWYG** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-155">Set any combination of the **CF\_TTONLY**, **CF\_FIXEDPITCHONLY**, **CF\_NOVECTORFONTS**, **CF\_NOVERTFONTS**, **CF\_SCALABLEONLY**, and **CF\_WYSIWYG** flags.</span></span> <span data-ttu-id="12c3e-156">È anche possibile limitare gli stili disponibili visualizzati nella finestra di dialogo per alcuni tipi di carattere usando il valore **CF \_ NoSimulations** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-156">You can also restrict the available styles that the dialog box displays for some fonts by using the **CF\_NOSIMULATIONS** value.</span></span>

<span data-ttu-id="12c3e-157">A partire da Windows 7, l'elenco dei tipi di carattere visualizzati nella finestra di dialogo viene limitato in base ai tipi di carattere visualizzati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="12c3e-157">Starting with Windows 7, the list of fonts displayed in the dialog box is restricted based on the user's shown fonts.</span></span> <span data-ttu-id="12c3e-158">Per rimuovere la restrizione, impostare il flag **CF \_ INACTIVEFONTS** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-158">To remove the restriction, set the **CF\_INACTIVEFONTS** flag.</span></span>

<span data-ttu-id="12c3e-159">**Per limitare i nomi dei caratteri tipografici, gli stili e le dimensioni dei punti che l'utente può specificare**</span><span class="sxs-lookup"><span data-stu-id="12c3e-159">**To restrict the typeface names, styles, and point sizes that the user can specify**</span></span>

1.  <span data-ttu-id="12c3e-160">Impostare il flag **CF \_ FORCEFONTEXIST** per impedire all'utente di specificare solo nomi di caratteri tipografici validi, stili e dimensioni di punti elencati nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="12c3e-160">Set the **CF\_FORCEFONTEXIST** flag to restrict the user to specifying only valid typeface names, styles, and point sizes listed in the dialog box.</span></span>
2.  <span data-ttu-id="12c3e-161">Impostare il flag **CF \_ LIMITSIZE** per impedire all'utente di specificare le dimensioni dei punti nell'intervallo specificato dai membri **nSizeMin** e **nSizeMax** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-161">Set the **CF\_LIMITSIZE** flag to restrict the user to specifying point sizes in the range specified by the **nSizeMin** and **nSizeMax** members.</span></span>

<span data-ttu-id="12c3e-162">**Per limitare o disabilitare la casella combinata script**</span><span class="sxs-lookup"><span data-stu-id="12c3e-162">**To restrict or disable the Scripts combo box**</span></span>

-   <span data-ttu-id="12c3e-163">Impostare il **flag \_ CF NOSCRIPTSEL** per disabilitare la casella combinata **script** oppure impostare il flag **CF \_ SELECTSCRIPT** per limitare le selezioni nella casella combinata **script** a un set di caratteri specificato.</span><span class="sxs-lookup"><span data-stu-id="12c3e-163">Set the **CF\_NOSCRIPTSEL** flag to disable the **Scripts** combo box, or set the **CF\_SELECTSCRIPT** flag to restrict selections in the **Scripts** combo box to a specified character set.</span></span>

## <a name="customizing-the-font-dialog-box-on-earlier-versions-of-windows"></a><span data-ttu-id="12c3e-164">Personalizzazione della finestra di dialogo tipo di carattere nelle versioni precedenti di Windows</span><span class="sxs-lookup"><span data-stu-id="12c3e-164">Customizing the Font Dialog Box on earlier versions of Windows</span></span>

<span data-ttu-id="12c3e-165">È possibile specificare un modello personalizzato per la finestra di dialogo **tipo di carattere** , ad esempio se si desidera includere controlli aggiuntivi che siano univoci per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="12c3e-165">You can provide a custom template for the **Font** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="12c3e-166">La funzione [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) usa il modello personalizzato al posto del modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="12c3e-166">The [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="12c3e-167">**Per fornire un modello personalizzato per la finestra di dialogo tipo di carattere**</span><span class="sxs-lookup"><span data-stu-id="12c3e-167">**To provide a custom template for the Font dialog box**</span></span>

1.  <span data-ttu-id="12c3e-168">Creare il modello personalizzato modificando il modello predefinito specificato nel file font. dlg.</span><span class="sxs-lookup"><span data-stu-id="12c3e-168">Create the custom template by modifying the default template specified in the Font.dlg file.</span></span> <span data-ttu-id="12c3e-169">Gli identificatori di controllo usati nel modello di finestra di dialogo del tipo di carattere predefinito vengono definiti nel file Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="12c3e-169">The control identifiers used in the default Font dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="12c3e-170">Utilizzare la struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) per abilitare il modello nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="12c3e-170">Use the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="12c3e-171">Se il modello personalizzato è una risorsa in un'applicazione o in una libreria a collegamento dinamico, impostare il flag **CF \_ ENABLETEMPLATE** nel membro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-171">If your custom template is a resource in an application or dynamic link library, set the **CF\_ENABLETEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="12c3e-172">Usare i membri **HINSTANCE** e **lpTemplateName** della struttura per identificare il modulo e il nome della risorsa.</span><span class="sxs-lookup"><span data-stu-id="12c3e-172">Use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span>
    -   <span data-ttu-id="12c3e-173">Se il modello personalizzato è già in memoria, impostare il flag **CF \_ ENABLETEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-173">If your custom template is already in memory, set the **CF\_ENABLETEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="12c3e-174">Usare il membro **HINSTANCE** per identificare l'oggetto memoria che contiene il modello.</span><span class="sxs-lookup"><span data-stu-id="12c3e-174">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="12c3e-175">È possibile specificare una procedura di hook [**CFHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc) per la finestra di dialogo **tipo di carattere** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-175">You can provide a [**CFHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc) hook procedure for the **Font** dialog box.</span></span> <span data-ttu-id="12c3e-176">La procedura hook può elaborare i messaggi inviati alla finestra di dialogo e inviare messaggi alla finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="12c3e-176">The hook procedure can process messages sent to the dialog box and send messages to the dialog box.</span></span> <span data-ttu-id="12c3e-177">Se si usa un modello personalizzato per definire controlli aggiuntivi, è necessario fornire una procedura di hook per elaborare l'input per i controlli.</span><span class="sxs-lookup"><span data-stu-id="12c3e-177">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="12c3e-178">**Per abilitare una routine hook per la finestra di dialogo tipo di carattere**</span><span class="sxs-lookup"><span data-stu-id="12c3e-178">**To enable a hook procedure for the Font dialog box**</span></span>

1.  <span data-ttu-id="12c3e-179">Impostare il flag **CF \_ ENABLEHOOK** nel membro **Flags** della struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) .</span><span class="sxs-lookup"><span data-stu-id="12c3e-179">Set the **CF\_ENABLEHOOK** flag in the **Flags** member of the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure.</span></span>
2.  <span data-ttu-id="12c3e-180">Specificare l'indirizzo della routine hook nel membro **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="12c3e-180">Specify the address of the hook procedure in the **lpfnHook** member.</span></span>

<span data-ttu-id="12c3e-181">Dopo l'elaborazione del messaggio [**WM \_ INITDIALOG**](wm-initdialog.md) , la routine della finestra di dialogo Invia un messaggio **WM \_ INITDIALOG** alla routine hook.</span><span class="sxs-lookup"><span data-stu-id="12c3e-181">After processing the [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="12c3e-182">Il parametro *lParam* di questo messaggio è un puntatore alla struttura [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) utilizzata per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="12c3e-182">The *lParam* parameter of this message is a pointer to the [**CHOOSEFONT**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) structure that is used to initialize the dialog box.</span></span>

<span data-ttu-id="12c3e-183">La procedura di hook può inviare i messaggi [**WM \_ ChooseFont \_ GETLOGFONT**](wm-choosefont-getlogfont.md), [**WM \_ ChooseFont \_ SETLOGFONT**](wm-choosefont-setlogfont.md)e [**WM \_ ChooseFont \_ Flags**](wm-choosefont-setflags.md) alla finestra di dialogo per ottenere e impostare i valori correnti e i flag della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="12c3e-183">The hook procedure can send the [**WM\_CHOOSEFONT\_GETLOGFONT**](wm-choosefont-getlogfont.md), [**WM\_CHOOSEFONT\_SETLOGFONT**](wm-choosefont-setlogfont.md), and [**WM\_CHOOSEFONT\_SETFLAGS**](wm-choosefont-setflags.md) messages to the dialog box to get and set the current values and flags of the dialog box.</span></span>

## <a name="customizing-the-font-dialog-box-on-windows-7"></a><span data-ttu-id="12c3e-184">Personalizzazione della finestra di dialogo tipo di carattere in Windows 7</span><span class="sxs-lookup"><span data-stu-id="12c3e-184">Customizing the Font Dialog Box on Windows 7</span></span>

<span data-ttu-id="12c3e-185">Lo screenshot seguente mostra una finestra di dialogo tipica dei **tipi di carattere** in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="12c3e-185">The following screen shot shows a typical **Font** dialog box in Windows 7.</span></span>

![screenshot che mostra il tipo di carattere DIALOB box](images/fontdialogboxwin7.png)

<span data-ttu-id="12c3e-187">Nelle versioni precedenti di Windows, il file di modello font. dlg contiene un modello ChooseFont predefinito.</span><span class="sxs-lookup"><span data-stu-id="12c3e-187">In earlier Windows versions, the font.dlg template file contains one default ChooseFont template.</span></span> <span data-ttu-id="12c3e-188">Il file di modello font. dlg in Windows 7 contiene due modelli predefiniti: il modello predefinito di versioni precedenti di Windows e il nuovo modello ChooseFont di Windows 7.</span><span class="sxs-lookup"><span data-stu-id="12c3e-188">The font.dlg template file on Windows 7 contains two default templates: the default template from earlier Windows versions and the new Windows 7 ChooseFont template.</span></span> <span data-ttu-id="12c3e-189">Pertanto, quando si Personalizza la finestra di dialogo **tipo di carattere** in Windows 7, è necessario considerare i seguenti problemi.</span><span class="sxs-lookup"><span data-stu-id="12c3e-189">Therefore, when you customize the **Font** dialog box on Windows 7, you must consider the following issues.</span></span>

1.  <span data-ttu-id="12c3e-190">Utilizzare il nuovo modello quando si creano modelli personalizzati per le applicazioni eseguite in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="12c3e-190">Use the new template when you create custom templates for applications that run on Windows 7.</span></span> <span data-ttu-id="12c3e-191">Questo nuovo modello contiene un controllo collegamento su cui l'utente può fare clic per avviare la finestra del **Pannello di controllo dei tipi di carattere** , come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="12c3e-191">This new template contains a link control that the user can click to launch the **Fonts Control Panel** window, as shown in the following screen shot.</span></span>

    ![screenshot che mostra il pannello di controllo dei tipi di carattere in Windows 7](images/fontcontrolpanelforwin7.png)

2.  <span data-ttu-id="12c3e-193">Per utilizzare questo controllo collegamento, è necessario che nell'applicazione chiamante venga utilizzato il COMCTL32.DLL versione 6 o successiva.</span><span class="sxs-lookup"><span data-stu-id="12c3e-193">To use this link control, your calling application must use the COMCTL32.DLL version 6 or later.</span></span> <span data-ttu-id="12c3e-194">In caso contrario, la funzione [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) restituisce un errore quando tenta di creare il controllo dei collegamenti nel modello personalizzato.</span><span class="sxs-lookup"><span data-stu-id="12c3e-194">Otherwise, the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function returns an error when it tries to create the link control in your custom template.</span></span> <span data-ttu-id="12c3e-195">Per determinare se il controllo è abilitato, compilare l'applicazione chiamante sulla versione di COMCTL32.DLL 6,0.</span><span class="sxs-lookup"><span data-stu-id="12c3e-195">To determine if this control is enabled, compile your calling application against COMCTL32.DLL version 6.0.</span></span> <span data-ttu-id="12c3e-196">Per altre informazioni, vedere [Abilitazione degli stili di visualizzazione con i controlli comuni](/previous-versions//ms649781(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="12c3e-196">For more information, see [Enabling Visual Styles with Common Controls](/previous-versions//ms649781(v=vs.85)).</span></span>
3.  <span data-ttu-id="12c3e-197">Se l'applicazione usa COMCTL32.DLL versione 5,0 o precedente, quando si crea un modello personalizzato è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="12c3e-197">If your application uses COMCTL32.DLL version 5.0 or earlier, you must do the following when you create a custom template:</span></span>

    -   <span data-ttu-id="12c3e-198">Specificare il controllo come **pulsante**.</span><span class="sxs-lookup"><span data-stu-id="12c3e-198">Specify the control as a **PUSHBUTTON**.</span></span> <span data-ttu-id="12c3e-199">Il controllo usato per avviare il **Pannello di controllo dei tipi di carattere** verrà visualizzato come pulsante anziché come collegamento.</span><span class="sxs-lookup"><span data-stu-id="12c3e-199">The control used to launch the **Fonts Control Panel** will appear as a button rather than as a link.</span></span>
    -   <span data-ttu-id="12c3e-200">Sostituire il testo seguente in font. dlg:</span><span class="sxs-lookup"><span data-stu-id="12c3e-200">Replace the following text in the font.dlg:</span></span>

        `CONTROL         "<A>Show more fonts</A>", IDC_MANAGE_LINK, "SysLink", WS_TABSTOP, 7, 199, 227, 9`

        <span data-ttu-id="12c3e-201">con il testo seguente:</span><span class="sxs-lookup"><span data-stu-id="12c3e-201">with the following text:</span></span>

        `PUSHBUTTON      "S&how more fonts", IDC_MANAGE_LINK, 7, 199, 74, 14 , WS_TABSTOP`

    -   <span data-ttu-id="12c3e-202">Per assicurarsi che l'applicazione usi un modello personalizzato, è necessario specificare un modello personalizzato con il flag **CF \_ ENABLETEMPLATE** , creare un modello personalizzato basato sul modello ChooseFont di Windows 7 e, facoltativamente, abilitare una procedura hook.</span><span class="sxs-lookup"><span data-stu-id="12c3e-202">To ensure that your application uses a custom template, you must specify a custom template with the **CF\_ENABLETEMPLATE** flag, create a custom template based on the Windows 7 ChooseFont template, and then optionally enable a hook procedure.</span></span>

        <span data-ttu-id="12c3e-203">Se si abilita una procedura hook senza creare un modello personalizzato, verrà caricato il modello ChooseFont predefinito per le versioni precedenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="12c3e-203">If you enable a hook procedure without creating a custom template, the default ChooseFont template for earlier Windows versions will be loaded.</span></span>

> [!Note]  
> <span data-ttu-id="12c3e-204">È necessario specificare il tipo di controllo del **controllo** o del **pulsante** nel nuovo modello, a seconda della versione di COMMCTL.DLL eseguita per la compilazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="12c3e-204">You must specify the **CONTROL** or **PUSHBUTTON** control type in your new template, depending on the version of COMMCTL.DLL that your application compiles against.</span></span> <span data-ttu-id="12c3e-205">Si noti inoltre che le funzionalità specifiche di Windows 7, ad esempio la visualizzazione WYSIWYG degli elenchi di tipi di carattere e le famiglie estese, non sono disponibili quando le applicazioni vengono eseguite in versioni precedenti del sistema operativo Windows.</span><span class="sxs-lookup"><span data-stu-id="12c3e-205">Also note that Windows 7 specific features, such as WYSIWYG display of font lists and extended families, are not available when your applications run on earlier versions of the Windows operating system.</span></span>

 

 

 