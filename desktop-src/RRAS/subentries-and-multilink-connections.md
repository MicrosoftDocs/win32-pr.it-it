---
title: Voci secondarie e connessioni a collegamento multiplo
description: Windows NT Server 4,0 fornisce supporto per le sottovoci del libro telefonico che consentono le connessioni a più collegamenti. Una connessione a collegamento multiplo combina la larghezza di banda di più connessioni per fornire una singola connessione con una maggiore larghezza di banda.
ms.assetid: 19cf6e1a-cdba-47e4-8d8f-d6030ed6f9e3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1970e2e2ad668b376b1097aa20cd18986fb605a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338734"
---
# <a name="subentries-and-multilink-connections"></a><span data-ttu-id="3d4f6-104">Voci secondarie e connessioni a collegamento multiplo</span><span class="sxs-lookup"><span data-stu-id="3d4f6-104">Subentries and Multilink Connections</span></span>

<span data-ttu-id="3d4f6-105">Windows NT Server 4,0 fornisce supporto per le sottovoci del libro telefonico che consentono le connessioni a più collegamenti.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-105">Windows NT Server 4.0 provides support for phone-book subentries, which enable multilink connections.</span></span> <span data-ttu-id="3d4f6-106">Una connessione a collegamento multiplo combina la larghezza di banda di più connessioni per fornire una singola connessione con una maggiore larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-106">A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth.</span></span>

<span data-ttu-id="3d4f6-107">Una voce del libro telefonico RAS può includere zero o più voci secondarie.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-107">A RAS phone-book entry can have zero or more subentries.</span></span> <span data-ttu-id="3d4f6-108">La funzione [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) recupera una struttura [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) che include informazioni sulle voci secondarie di una voce della rubrica telefonica.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-108">The [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) function retrieves a [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) structure that includes information about the subentries of a phone-book entry.</span></span> <span data-ttu-id="3d4f6-109">Il membro **dwSubEntries** della struttura **RASENTRY** indica il numero di voci secondarie.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-109">The **dwSubEntries** member of the **RASENTRY** structure indicates the number of subentries.</span></span> <span data-ttu-id="3d4f6-110">Le voci del libro telefonico non hanno inizialmente elementi secondari.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-110">Phone-book entries initially have no subentries.</span></span> <span data-ttu-id="3d4f6-111">Per aggiungere voci secondarie a una voce della rubrica telefonica, utilizzare la funzione [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) .</span><span class="sxs-lookup"><span data-stu-id="3d4f6-111">To add subentries to a phone-book entry, use the [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) function.</span></span>

<span data-ttu-id="3d4f6-112">Le proprietà di ogni sottovoce includono un numero di telefono e il nome e il tipo del dispositivo TAPI da usare quando si compone la voce secondaria.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-112">The properties for each subentry include a phone number and the name and type of the TAPI device to use when dialing the subentry.</span></span> <span data-ttu-id="3d4f6-113">Inoltre, una voce secondaria può includere un elenco di numeri di telefono alternativi da comporre se RAS non è in grado di effettuare una connessione utilizzando il numero primario.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-113">In addition, a subentry can include a list of alternate phone numbers to dial if RAS cannot make a connection using the primary number.</span></span> <span data-ttu-id="3d4f6-114">Le funzioni [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) e [**RasGetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetsubentrypropertiesa) usano la struttura [**RASSUBENTRY**](/previous-versions/windows/desktop/legacy/aa377839(v=vs.85)) per impostare e recuperare le proprietà di una sottovoce del libro telefonico specificata.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-114">The [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) and [**RasGetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetsubentrypropertiesa) functions use the [**RASSUBENTRY**](/previous-versions/windows/desktop/legacy/aa377839(v=vs.85)) structure to set and retrieve the properties of a specified phone-book subentry.</span></span> <span data-ttu-id="3d4f6-115">Le sottovoci sono identificate da un indice in base uno.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-115">Subentries are identified by a one-based index.</span></span>

<span data-ttu-id="3d4f6-116">È possibile chiamare la funzione [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) per configurare una voce RAS a più collegamenti per la connessione di tutte le sottovoci al momento della prima connessione.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-116">You can call the [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) function to configure a multilink RAS entry to connect all subentries when it is first dialed.</span></span> <span data-ttu-id="3d4f6-117">In alternativa, è possibile configurare una voce per fornire la larghezza di banda variabile.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-117">Alternatively, you can configure an entry to provide variable bandwidth.</span></span> <span data-ttu-id="3d4f6-118">In questo caso, RAS connette inizialmente una singola sottovoce, quindi connette o disconnette altre sottovoci in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-118">In this case, RAS connects a single subentry initially, and then connects or disconnects additional subentries as needed.</span></span> <span data-ttu-id="3d4f6-119">Per una connessione multilink a larghezza di banda variabile, è possibile usare la struttura [**RASDIALPARAMS**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) per specificare la sottovoce iniziale da connettere quando si chiama la funzione [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) .</span><span class="sxs-lookup"><span data-stu-id="3d4f6-119">For a variable-bandwidth multilink connection, you can use the [**RASDIALPARAMS**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) structure to specify the initial subentry to connect when you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function.</span></span> <span data-ttu-id="3d4f6-120">Quando si usa la funzione [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) per connettere una voce a più collegamenti, è possibile usare la struttura [**RasDialDlg**](/previous-versions/windows/desktop/legacy/aa377023(v=vs.85)) per specificare la sottovoce iniziale da connettere.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-120">When using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function to connect a multilink entry, you can use the [**RASDIALDLG**](/previous-versions/windows/desktop/legacy/aa377023(v=vs.85)) structure to specify the initial subentry to connect.</span></span>

<span data-ttu-id="3d4f6-121">Per una connessione multilink a larghezza di banda variabile, utilizzare la struttura [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) con la funzione [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) per specificare i parametri per la connessione e la disconnessione delle singole voci secondarie.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-121">For a variable-bandwidth multilink connection, use the [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) structure with the [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) function to specify the parameters for connecting and disconnecting the individual subentries.</span></span> <span data-ttu-id="3d4f6-122">RAS connette una voce secondaria aggiuntiva quando la larghezza di banda utilizzata supera una percentuale specificata della larghezza di banda disponibile per un intervallo specificato.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-122">RAS connects an additional subentry when the bandwidth being used exceeds a specified percentage of the available bandwidth for a specified interval.</span></span>

<span data-ttu-id="3d4f6-123">Se si chiama la funzione [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) per stabilire una connessione a più collegamenti, è possibile specificare una funzione di callback [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) per ricevere le notifiche relative alla connessione.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-123">If you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function to establish a multilink connection, you can specify a [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) callback function to receive notifications about the connection.</span></span> <span data-ttu-id="3d4f6-124">**RasDialFunc2** è simile alla funzione di callback [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) , ad eccezione del fatto che fornisce informazioni aggiuntive per una connessione a più collegamenti, ad esempio l'indice della sottovoce che ha causato la notifica.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-124">**RasDialFunc2** is similar to the [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) callback function, except that it provides additional information for a multilink connection, such as the index of the subentry that caused the notification.</span></span> <span data-ttu-id="3d4f6-125">RAS chiama la funzione **RasDialFunc2** quando si connette o disconnette una voce secondaria.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-125">RAS calls your **RasDialFunc2** function when it connects or disconnects a subentry.</span></span>

<span data-ttu-id="3d4f6-126">È possibile usare un handle di connessione **HRASCONN** per bloccare o recuperare le informazioni su una connessione a più collegamenti.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-126">You can use an **HRASCONN** connection handle to hang up or retrieve information about a multilink connection.</span></span> <span data-ttu-id="3d4f6-127">È possibile ottenere un handle di connessione per ogni connessione secondaria che compongono il collegamento multiplo, nonché per la connessione a più collegamenti combinata.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-127">You can get a connection handle for each of the subentry connections that make up the multilink, as well as for the combined multilink connection.</span></span> <span data-ttu-id="3d4f6-128">Quando si chiama la funzione [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) per stabilire una connessione a più collegamenti, **RasDial** restituisce un handle per la connessione a più collegamenti combinata.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-128">When you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function to establish a multilink connection, **RasDial** returns a handle to the combined multilink connection.</span></span> <span data-ttu-id="3d4f6-129">Analogamente, [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) restituisce l'handle combinato Multilink quando si enumerano le connessioni.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-129">Similarly, [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) returns the combined multilink handle when you enumerate connections.</span></span> <span data-ttu-id="3d4f6-130">Per ottenere un handle per una delle connessioni della sottovoce in una connessione a più collegamenti, chiamare la funzione [**RasGetSubEntryHandle**](/windows/desktop/api/Ras/nf-ras-rasgetsubentryhandlea) .</span><span class="sxs-lookup"><span data-stu-id="3d4f6-130">To get a handle to one of the subentry connections in a multilink connection, call the [**RasGetSubEntryHandle**](/windows/desktop/api/Ras/nf-ras-rasgetsubentryhandlea) function.</span></span>

<span data-ttu-id="3d4f6-131">È possibile usare l'handle di connessione multicollegamento combinato e gli handle di connessione per le sottovoci nelle funzioni [**RasHangup**](/windows/desktop/api/Ras/nf-ras-rashangupa), [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa)e [**RasGetProjectionInfo**](/previous-versions/windows/embedded/ms897107(v=msdn.10)) .</span><span class="sxs-lookup"><span data-stu-id="3d4f6-131">You can use the combined multilink connection handle and the subentry connection handles in the [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa), [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa), and [**RasGetProjectionInfo**](/previous-versions/windows/embedded/ms897107(v=msdn.10)) functions.</span></span> <span data-ttu-id="3d4f6-132">La chiamata di **RasHangup** con un handle combinato Multilink termina l'intera connessione. chiamandolo con un handle di voce secondaria si blocca solo tale connessione secondaria.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-132">Calling **RasHangUp** with a combined multilink handle terminates the entire connection; calling it with a subentry handle hangs up only that subentry connection.</span></span> <span data-ttu-id="3d4f6-133">Analogamente, **RasGetConnectStatus** restituisce informazioni per la connessione combinata o singola, a seconda dell'handle specificato.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-133">Similarly, **RasGetConnectStatus** returns information for the combined or individual connection, depending on the handle specified.</span></span> <span data-ttu-id="3d4f6-134">Le informazioni di proiezione restituite da **RasGetProjectionInfo** per una voce a più collegamenti sono le stesse per ogni handle di connessione di sottovoce così come per l'handle di connessione principale.</span><span class="sxs-lookup"><span data-stu-id="3d4f6-134">The projection information returned by **RasGetProjectionInfo** for a multilink entry is the same for each of the subentry connection handles as it is for the main connection handle.</span></span>

 

 