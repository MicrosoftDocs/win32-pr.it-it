---
title: Script personalizzato RAS
description: Gli sviluppatori possono creare una DLL di scripting personalizzata che risiede in un computer client RAS. Questa DLL può comunicare con il server durante il processo di creazione di una connessione.
ms.assetid: c27b8b02-6018-4441-a355-1fb890b9001c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c625f020d9dafcb352c5f1b382014f9dba189330
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103963191"
---
# <a name="ras-custom-scripting"></a><span data-ttu-id="f688e-104">Script personalizzato RAS</span><span class="sxs-lookup"><span data-stu-id="f688e-104">RAS Custom Scripting</span></span>

<span data-ttu-id="f688e-105">Gli sviluppatori possono creare una DLL di scripting personalizzata che risiede in un computer client RAS.</span><span class="sxs-lookup"><span data-stu-id="f688e-105">Developers can create a custom-scripting DLL that resides on a RAS client computer.</span></span> <span data-ttu-id="f688e-106">Questa DLL può comunicare con il server durante il processo di creazione di una connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-106">This DLL can communicate with the server during the process of establishing a connection.</span></span>

<span data-ttu-id="f688e-107">**Windows NT:** Lo scripting personalizzato non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="f688e-107">**Windows NT:** Custom scripting is not available.</span></span>

## <a name="setting-up-the-dll"></a><span data-ttu-id="f688e-108">Configurazione della DLL</span><span class="sxs-lookup"><span data-stu-id="f688e-108">Setting up the DLL</span></span>

<span data-ttu-id="f688e-109">Per configurare la DLL, creare un valore con il nome **CustomScriptDllPath** nella seguente chiave del registro di sistema:</span><span class="sxs-lookup"><span data-stu-id="f688e-109">To set up the DLL, create a value with the name **CustomScriptDllPath** under the following registry key:</span></span>

```
HKEY_LOCAL_MACHINE
   System
      CurrentControlSet
         Services
            Rasman
               Parameters
```

<span data-ttu-id="f688e-110">Questo valore deve essere di tipo **reg \_ expand \_ SZ**.</span><span class="sxs-lookup"><span data-stu-id="f688e-110">This value should be of type **REG\_EXPAND\_SZ**.</span></span> <span data-ttu-id="f688e-111">Il valore deve contenere il percorso della DLL di scripting personalizzata.</span><span class="sxs-lookup"><span data-stu-id="f688e-111">The value should contain the path to the custom-scripting DLL.</span></span> <span data-ttu-id="f688e-112">Per ogni computer client RAS è supportata una sola DLL di scripting personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f688e-112">Only one custom-scripting DLL is supported for each RAS client computer.</span></span>

## <a name="interaction-between-the-server-ras-and-the-custom-scripting-dll"></a><span data-ttu-id="f688e-113">Interazione tra server, RAS e DLL Custom-Scripting</span><span class="sxs-lookup"><span data-stu-id="f688e-113">Interaction Between the Server, RAS, and the Custom-Scripting DLL</span></span>

<span data-ttu-id="f688e-114">La DLL di scripting personalizzata deve esportare un singolo punto di ingresso: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="f688e-114">The custom scripting DLL should export a single entry point: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="f688e-115">RAS chiama questa funzione durante lo \_ stato interattivo RASCS del processo di connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-115">RAS calls this function during the RASCS\_Interactive state of the connection process.</span></span> <span data-ttu-id="f688e-116">Lo stato \_ interattivo RASCS è uno stato in pausa, che consente all'utente di interagire con un'interfaccia utente presentata dalla DLL di scripting personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f688e-116">The RASCS\_Interactive state is a paused state, which allows the user to interact with a user interface presented by the custom-scripting DLL.</span></span> <span data-ttu-id="f688e-117">Per ulteriori informazioni sugli stati di connessione, vedere [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f688e-117">See [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) for more information about connection states.</span></span>

<span data-ttu-id="f688e-118">RAS viene passato come parametro alla funzione [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) :</span><span class="sxs-lookup"><span data-stu-id="f688e-118">RAS will pass as parameters to the [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) function:</span></span>

-   <span data-ttu-id="f688e-119">Handle per la porta sul computer client utilizzato per la connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-119">A handle to the port on the client computer that is being used for the connection.</span></span>
-   <span data-ttu-id="f688e-120">Stringhe che identificano la Rubrica e la voce della connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-120">Strings that identify the phone book and entry for the connection.</span></span>
-   <span data-ttu-id="f688e-121">RAS passa inoltre un handle a una finestra per consentire alla DLL di presentare un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="f688e-121">RAS also passes in a handle to a window to enable the DLL to present a user interface.</span></span>
-   <span data-ttu-id="f688e-122">Set di puntatori a funzione che la DLL può usare per comunicare con il server.</span><span class="sxs-lookup"><span data-stu-id="f688e-122">A set of function pointers that the DLL can use to communicate with the server.</span></span>

<span data-ttu-id="f688e-123">Per ulteriori informazioni su questi parametri, vedere [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) .</span><span class="sxs-lookup"><span data-stu-id="f688e-123">See [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) for more information about these parameters.</span></span>

<span data-ttu-id="f688e-124">RAS passa un puntatore a una struttura [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) come ultimo parametro a [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="f688e-124">RAS passes a pointer to a [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) structure as the last parameter to [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="f688e-125">Questa struttura contiene un puntatore a una funzione di tipo [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span><span class="sxs-lookup"><span data-stu-id="f688e-125">This structure contains a pointer to a function of type [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span></span> <span data-ttu-id="f688e-126">La DLL di scripting personalizzato chiama questa funzione per modificare le impostazioni di comunicazione sulla porta utilizzata dalla connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-126">The custom-scripting DLL calls this function to modify the communication settings on the port being used by the connection.</span></span>

<span data-ttu-id="f688e-127">RAS media l'interazione tra il server e la DLL di scripting personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f688e-127">RAS mediates the interaction between the server and the custom-scripting DLL.</span></span> <span data-ttu-id="f688e-128">In genere, il server avvia la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="f688e-128">Typically, the server initiates the dialog.</span></span> <span data-ttu-id="f688e-129">Ad esempio, il server può richiedere il nome utente e la password dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f688e-129">For example, the server may request the user name and password of the user.</span></span>

<span data-ttu-id="f688e-130">Quando si usa lo scripting personalizzato per stabilire una connessione, il server non deve eseguire Windows NT 4,0 o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="f688e-130">When using custom-scripting to establish a connection, the server need not be running Windows NT 4.0 or Windows 2000.</span></span>

## <a name="custom-scripting-user-interface-must-support-idcancel"></a><span data-ttu-id="f688e-131">L'interfaccia utente di scripting personalizzata deve supportare IDCANCEL</span><span class="sxs-lookup"><span data-stu-id="f688e-131">Custom Scripting User Interface Must Support IDCANCEL</span></span>

<span data-ttu-id="f688e-132">Se il dialer personalizzato Visualizza un'interfaccia utente, l'interfaccia utente deve supportare \_ i messaggi di comando WM in cui LOWORD (*wParam*) è uguale a IDCANCEL.</span><span class="sxs-lookup"><span data-stu-id="f688e-132">If the custom dialer displays a user interface, the user interface must support WM\_COMMAND messages where LOWORD(*wParam*) equals IDCANCEL.</span></span>

## <a name="configuring-the-connection"></a><span data-ttu-id="f688e-133">Configurazione della connessione</span><span class="sxs-lookup"><span data-stu-id="f688e-133">Configuring the Connection</span></span>

<span data-ttu-id="f688e-134">Il punto di ingresso di [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) può essere richiamato da [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) o, in Windows XP, da [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span><span class="sxs-lookup"><span data-stu-id="f688e-134">The [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) entry point can be invoked from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) or, on Windows XP, from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span></span>

<span data-ttu-id="f688e-135">Per richiamare [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) da [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), impostare l' \_ opzione raseo CustomScript nella voce della rubrica telefonica relativa alla connessione.</span><span class="sxs-lookup"><span data-stu-id="f688e-135">To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), set the RASEO\_CustomScript option in the phone-book entry for the connection.</span></span> <span data-ttu-id="f688e-136">Per una descrizione delle opzioni di immissione della rubrica telefonica, vedere il membro **dwfOptions** di [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f688e-136">See the **dwfOptions** member of [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) for a description of phone-book entry options.</span></span> <span data-ttu-id="f688e-137">Usare le funzioni [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) e [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) per impostare questa opzione a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="f688e-137">Use the [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) and [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) functions to set this option programmatically.</span></span>

<span data-ttu-id="f688e-138">**Windows XP:** Per richiamare [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) da [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), la chiamata a **RasDial** deve specificare una struttura [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) e questa struttura deve specificare il flag RDEOPT UseCustomScripting \_ .</span><span class="sxs-lookup"><span data-stu-id="f688e-138">**Windows XP:** To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), the call to **RasDial** must specify a [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) structure, and this structure must specify the RDEOPT\_UseCustomScripting flag.</span></span> <span data-ttu-id="f688e-139">Inoltre, la voce della rubrica telefonica per la connessione deve specificare l'opzione RASEO \_ CustomScript come descritto nel paragrafo precedente.</span><span class="sxs-lookup"><span data-stu-id="f688e-139">In addition, the phone-book entry for the connection must specify the RASEO\_CustomScript option as described in the preceding paragraph.</span></span>

## <a name="invoking-the-custom-scripting-dll"></a><span data-ttu-id="f688e-140">Richiamo della DLL di scripting personalizzata</span><span class="sxs-lookup"><span data-stu-id="f688e-140">Invoking the Custom Scripting DLL</span></span>

<span data-ttu-id="f688e-141">Se l'utente attiva una connessione per una voce di Rubrica con RASEO \_ CustomScript impostata, RAS richiama la dll di scripting personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f688e-141">If the user activates a connection for a phone-book entry that has RASEO\_CustomScript set, RAS invokes the custom-scripting DLL.</span></span> <span data-ttu-id="f688e-142">In questo scenario, RAS richiama la DLL di scripting personalizzato da [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span><span class="sxs-lookup"><span data-stu-id="f688e-142">In this scenario, RAS invokes the custom-scripting DLL from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span></span>

<span data-ttu-id="f688e-143">Per richiamare la DLL di scripting personalizzato a livello di codice, stabilire la connessione tramite la funzione [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) .</span><span class="sxs-lookup"><span data-stu-id="f688e-143">To invoke the custom-scripting DLL programmatically, establish the connection using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function.</span></span> <span data-ttu-id="f688e-144">In Windows XP, la funzione [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) richiama anche la dll di scripting personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f688e-144">On Windows XP, the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function also invokes the custom-scripting DLL.</span></span>

 

 