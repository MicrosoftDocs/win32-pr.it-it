---
title: Evitare le informazioni nascoste
description: Occasionalmente, i programmi nascondono intenzionalmente o inavvertitamente le informazioni dal motore di marshalling RPC.
ms.assetid: 016b9221-092d-4c25-a396-4f41dcdfb3cf
keywords:
- Programmazione Windows con compatibilità con le versioni precedenti a 64 bit
- problemi di compatibilità programmazione Windows a 64 bit
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f4b9e4ba7ed5165378beb93005243af03f9e469
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399287"
---
# <a name="avoiding-information-hiding"></a><span data-ttu-id="26094-105">Evitare le informazioni nascoste</span><span class="sxs-lookup"><span data-stu-id="26094-105">Avoiding Information Hiding</span></span>

<span data-ttu-id="26094-106">Occasionalmente, i programmi nascondono intenzionalmente o inavvertitamente le informazioni dal motore di marshalling RPC.</span><span class="sxs-lookup"><span data-stu-id="26094-106">Occasionally, programs deliberately or inadvertently hide information from the RPC marshaling engine.</span></span> <span data-ttu-id="26094-107">Di seguito sono riportati alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="26094-107">Some examples are as follows:</span></span>

-   <span data-ttu-id="26094-108">Invio di una struttura di dati come blocco di byte non differenziato</span><span class="sxs-lookup"><span data-stu-id="26094-108">Sending a data structure as an undifferentiated block of bytes</span></span>
-   <span data-ttu-id="26094-109">Sfruttando le prestazioni usando un effetto collaterale di un metodo per il canale di dati aggiuntivi attraverso la rete</span><span class="sxs-lookup"><span data-stu-id="26094-109">Leveraging performance by using a side effect from a method to channel additional data across the wire</span></span>
-   <span data-ttu-id="26094-110">Tentativo di mascherare un handle passandolo come **valore DWORD** o **ULONG**</span><span class="sxs-lookup"><span data-stu-id="26094-110">Attempting to disguise a handle by passing it as a **DWORD** or a **ULONG**</span></span>

<span data-ttu-id="26094-111">Queste tecniche sono quasi garantite per introdurre problemi di compatibilità anche prima di trasferire l'applicazione in Windows a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="26094-111">These techniques are almost guaranteed to introduce compatibility problems even before you port your application to 64-bit Windows.</span></span>

<span data-ttu-id="26094-112">Anziché inviare un contesto server come **DWORD** in una chiamata di procedura remota standard, utilizzare un handle di contesto per fornire un handle opaco a un contesto server che viene mantenuto per conto di un client.</span><span class="sxs-lookup"><span data-stu-id="26094-112">Instead of sending a server context as a **DWORD** in a standard remote procedure call, use a context handle to provide an opaque handle to a server context that is held on behalf of a client.</span></span> <span data-ttu-id="26094-113">I contesti vengono identificati dai GUID definiti dalla fase di esecuzione RPC quando un server crea un handle di contesto per un client.</span><span class="sxs-lookup"><span data-stu-id="26094-113">Contexts are identified by GUIDs defined by the RPC run time when a server creates a context handle for a client.</span></span> <span data-ttu-id="26094-114">Nessun puntatore viene utilizzato in transito e l'operazione è completamente trasparente nei limiti 32 o 64 bit.</span><span class="sxs-lookup"><span data-stu-id="26094-114">No pointer is used over the wire and the operation is completely transparent across 32- or 64-bit boundaries.</span></span> <span data-ttu-id="26094-115">Per altre informazioni sull'uso degli handle di contesto, vedere [handle di contesto](/windows/desktop/Rpc/context-handles).</span><span class="sxs-lookup"><span data-stu-id="26094-115">For more information on using context handles, see [Context Handles](/windows/desktop/Rpc/context-handles).</span></span>

<span data-ttu-id="26094-116">Le interfacce DCOM non possono utilizzare handle di contesto poiché COM fornisce la propria gestione del contesto.</span><span class="sxs-lookup"><span data-stu-id="26094-116">DCOM interfaces cannot use context handles because COM provides its own context management.</span></span> <span data-ttu-id="26094-117">Anziché creare un handle di contesto, è possibile passare un puntatore di interfaccia all'oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="26094-117">Instead of creating a context handle, you can pass an interface pointer to the COM object.</span></span> <span data-ttu-id="26094-118">È quindi possibile chiamare i metodi direttamente tramite il puntatore di interfaccia o posizionare il puntatore all'interno di altre chiamate.</span><span class="sxs-lookup"><span data-stu-id="26094-118">Then you can call the methods directly through the interface pointer or place the pointer inside other calls.</span></span> <span data-ttu-id="26094-119">Per rilasciare l'oggetto server, il client chiama il metodo di **rilascio** dell'interfaccia tramite il puntatore di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="26094-119">To release the server object, the client calls the interface's **Release** method through the interface pointer.</span></span>

<span data-ttu-id="26094-120">Anche in questo caso, è possibile che non sia possibile modificare la progettazione originale del codice che si sta trasportando.</span><span class="sxs-lookup"><span data-stu-id="26094-120">Again, there may be times when you cannot change the original design of the code that you are porting.</span></span> <span data-ttu-id="26094-121">Se non esiste alcun modo per evitare di inviare un puntatore attraverso la rete come **DWORD**, sarà necessario implementare una forma di mapping lato server tra i valori **DWORD** e i puntatori.</span><span class="sxs-lookup"><span data-stu-id="26094-121">If there is no way to avoid sending a pointer across the wire as a **DWORD**, you will have to implement some form of server-side mapping between **DWORD** values and pointers.</span></span> <span data-ttu-id="26094-122">Un modo per eseguire questa operazione consiste nel modificare i puntatori nell'applicazione lato client in tipi di precisione puntatore, ad esempio **ULONG \_ ptr** o **DWORD \_ ptr**.</span><span class="sxs-lookup"><span data-stu-id="26094-122">One way to do this is to change the pointers in the client side application to pointer-precision types, such as **ULONG\_PTR** or **DWORD\_PTR**.</span></span> <span data-ttu-id="26094-123">Usare quindi la \[ [**chiamata MIDL \_ come**](/windows/desktop/Midl/call-as) \] attributo per inserire i puntatori in transito come valori **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="26094-123">Then use the MIDL \[[**call\_as**](/windows/desktop/Midl/call-as)\] attribute to put the pointers on the wire as **DWORD** values.</span></span> <span data-ttu-id="26094-124">Il wrapper lato client deve passare solo gli argomenti insieme a.</span><span class="sxs-lookup"><span data-stu-id="26094-124">The client-side wrapper need only pass the arguments along.</span></span> <span data-ttu-id="26094-125">Il wrapper lato server gestisce il mapping tra entrambi i tipi.</span><span class="sxs-lookup"><span data-stu-id="26094-125">The server-side wrapper handles the mapping between both types.</span></span> <span data-ttu-id="26094-126">In modo analogo, è possibile usare l'attributo \[ [**trasmissione \_ As**](/windows/desktop/Midl/transmit-as) \] o l'attributo \[ [**rappresenta \_ come**](/windows/desktop/Midl/represent-as) \] per convertire i dati in un formato compatibile con le versioni precedenti per la rappresentazione in transito.</span><span class="sxs-lookup"><span data-stu-id="26094-126">In a similar way, you can use either the \[[**transmit\_as**](/windows/desktop/Midl/transmit-as)\] attribute or the \[[**represent\_as**](/windows/desktop/Midl/represent-as)\] attribute to convert your data to a backward-compatible format for wire representation.</span></span>

<span data-ttu-id="26094-127">Se la compatibilità con i fili precedenti non è un problema o se l'handle non viene usato per le chiamate remote e si è certi che le chiamate remote tra i processi 32 e 64 bit non verranno mai eseguite, è possibile ridefinire un argomento come **ULONG64**.</span><span class="sxs-lookup"><span data-stu-id="26094-127">If backward-wire compatibility is not an issue or if the handle is not used for remote calls and you are sure that remote calls between 32- and 64-bit processes will never happen, you can redefine an argument as a **ULONG64**.</span></span> <span data-ttu-id="26094-128">Se necessario, è possibile modificare l'applicazione a 32 bit per passare un **valore DWORD** all'utente.</span><span class="sxs-lookup"><span data-stu-id="26094-128">If necessary, you can modify the 32-bit application to pass a **DWORD** to the user.</span></span> <span data-ttu-id="26094-129">In alternativa, è possibile compilare Stub distinti da file IDL distinti per ogni piattaforma usando un **valore DWORD** in windows a 32 bit e un **ULONG64** su Windows a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="26094-129">Alternatively, you can build separate stubs from separate IDL files for each platform using a **DWORD** on 32-bit Windows and a **ULONG64** on 64-bit Windows.</span></span>

 

 