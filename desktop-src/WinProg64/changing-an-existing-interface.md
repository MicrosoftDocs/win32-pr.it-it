---
title: Modifica di un'interfaccia esistente
description: Quando possibile, implementare una nuova interfaccia per l'applicazione, invece di apportare modifiche a un oggetto esistente.
ms.assetid: 29845cf5-445c-403d-b298-d4e07c3536b7
keywords:
- modifica della programmazione Windows a 64 bit delle interfacce esistenti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 51a656ee768dcc2e88725d2cff0ddc5604fd771f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104516918"
---
# <a name="changing-an-existing-interface"></a><span data-ttu-id="ae460-104">Modifica di un'interfaccia esistente</span><span class="sxs-lookup"><span data-stu-id="ae460-104">Changing an Existing Interface</span></span>

<span data-ttu-id="ae460-105">Quando possibile, implementare una nuova interfaccia per l'applicazione, invece di apportare modifiche a un oggetto esistente.</span><span class="sxs-lookup"><span data-stu-id="ae460-105">Whenever possible, implement a new interface for your application, rather than making changes to an existing one.</span></span> <span data-ttu-id="ae460-106">Se non è possibile modificare un'interfaccia esistente, utilizzare i nuovi tipi di dati solo nei nuovi metodi.</span><span class="sxs-lookup"><span data-stu-id="ae460-106">If you cannot avoid changing an existing interface, use new data types in new methods only.</span></span> <span data-ttu-id="ae460-107">L'introduzione di un nuovo tipo di dati o la modifica di un tipo esistente è l'origine più comune di problemi di incompatibilità.</span><span class="sxs-lookup"><span data-stu-id="ae460-107">Introducing a new data type or modifying an existing type is the most common source of incompatibility problems.</span></span> <span data-ttu-id="ae460-108">Il modello di runtime RPC presuppone che l'applicazione ricevente conosca i tipi di dati ricevuti, quindi i dati vengono inseriti in rete senza una descrizione dei dati generici.</span><span class="sxs-lookup"><span data-stu-id="ae460-108">The RPC run-time model assumes that the receiving application knows about the types of data that it receives, so data is put onto the wire without a generic data description.</span></span> <span data-ttu-id="ae460-109">Quando il destinatario prevede un tipo di dati diverso rispetto a quello che il mittente ha messo in rete, lo stub genera un'eccezione (o la trasmissione ha esito negativo in un altro modo meno appropriato).</span><span class="sxs-lookup"><span data-stu-id="ae460-109">When the recipient expects a different data type than what the sender has put on the wire, the stub raises an exception (or transmission fails in some other less graceful manner).</span></span>

<span data-ttu-id="ae460-110">Un'interfaccia RPC è definita dal rispettivo UUID e dai numeri di versione principale e secondaria.</span><span class="sxs-lookup"><span data-stu-id="ae460-110">An RPC interface is defined by its UUID and its major and minor version numbers.</span></span> <span data-ttu-id="ae460-111">Quando si modifica un'interfaccia esistente, è necessario aggiungere i nuovi metodi alla fine dell'interfaccia e modificare il numero della versione secondaria.</span><span class="sxs-lookup"><span data-stu-id="ae460-111">When you change an existing interface, you should add the new methods at the end of the interface and change the minor version number.</span></span> <span data-ttu-id="ae460-112">Se si aggiungono metodi altrove o si apportano altre modifiche all'interfaccia, sarà necessario modificare anche il numero di versione principale.</span><span class="sxs-lookup"><span data-stu-id="ae460-112">If you add methods anywhere else or make any other changes to the interface, you will also need to change the major version number.</span></span>

<span data-ttu-id="ae460-113">Realisticamente, in alcuni casi non è possibile modificare anche il numero di versione secondario, perché un nuovo client non sarà in grado di comunicare con un server precedente e non sarà possibile aggiornare il server.</span><span class="sxs-lookup"><span data-stu-id="ae460-113">Realistically, there are times when you cannot change even the minor version number, because a new client will not be able to communicate with an old server and you cannot update the server.</span></span> <span data-ttu-id="ae460-114">Il tempo di esecuzione RPC genera un'eccezione, \_ \_ PROCNUM RPC \_ fuori \_ \_ intervallo, quando un client chiama un metodo oltre quelli specificati per la relativa interfaccia con il server.</span><span class="sxs-lookup"><span data-stu-id="ae460-114">The RPC run time raises an exception, RPC\_S\_PROCNUM\_OUT\_OF\_RANGE, when a client calls a method beyond the ones specified for its interface with the server.</span></span> <span data-ttu-id="ae460-115">La soluzione alternativa consiste nel lasciare invariati i numeri di versione e scrivere il codice client per gestire correttamente questa eccezione, ovvero dal client, ad esempio, o con qualsiasi mezzo, appropriato per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ae460-115">The workaround is to leave the version numbers unchanged and write your client code to handle this exception gracefully—by the client degrading its performance, for example, or by whatever means are appropriate for your application.</span></span>

<span data-ttu-id="ae460-116">Esiste una soluzione alternativa simile per un caso speciale di modifica di un tipo di dati in un metodo esistente.</span><span class="sxs-lookup"><span data-stu-id="ae460-116">There is a similar workaround for one special case of changing a data type in an existing method.</span></span> <span data-ttu-id="ae460-117">Se si dispone di un' [**Unione**](/windows/desktop/Midl/union) i cui rami sono puntatori e che non dispone di un ramo predefinito per i tipi non riconosciuti, è possibile aggiungere un nuovo ramo che utilizza il nuovo tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="ae460-117">If you have a [**union**](/windows/desktop/Midl/union) whose branches are pointers and that does not have a default branch for unrecognized types, you can add a new branch that uses the new data type.</span></span> <span data-ttu-id="ae460-118">In questo modo non si modificano le dimensioni della struttura dei dati.</span><span class="sxs-lookup"><span data-stu-id="ae460-118">This will not change the size of the data structure.</span></span> <span data-ttu-id="ae460-119">Quando il client comunica con un nuovo server, può utilizzare il nuovo tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="ae460-119">When your client talks to a new server, it can use the new data type.</span></span> <span data-ttu-id="ae460-120">Tuttavia, quando il client comunica con un vecchio server, il tempo di esecuzione genera il \_ \_ tag non valido per la RPC di eccezione \_ .</span><span class="sxs-lookup"><span data-stu-id="ae460-120">However, when your client talks to an old server, the run time will raise the exception RPC\_S\_INVALID\_TAG.</span></span> <span data-ttu-id="ae460-121">Anche in questo caso, sarà necessario scrivere il codice client per gestire questa eccezione.</span><span class="sxs-lookup"><span data-stu-id="ae460-121">Again, you will need to write your client code to handle this exception appropriately.</span></span>

<span data-ttu-id="ae460-122">Un'interfaccia DCOM è identificata dal relativo GUID.</span><span class="sxs-lookup"><span data-stu-id="ae460-122">A DCOM interface is identified by its GUID.</span></span> <span data-ttu-id="ae460-123">In DCOM le interfacce sono considerate non modificabili ed è possibile apportare modifiche solo creando una nuova interfaccia che eredita da quella precedente.</span><span class="sxs-lookup"><span data-stu-id="ae460-123">In DCOM, interfaces are considered immutable and you can make changes only by creating a new interface that inherits from the old one.</span></span> <span data-ttu-id="ae460-124">Queste regole assicurano che client e server rimangano compatibili.</span><span class="sxs-lookup"><span data-stu-id="ae460-124">These rules ensure that clients and servers remain compatible.</span></span>

 

 