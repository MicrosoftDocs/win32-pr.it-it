---
description: L' \_ \_ enumerazione livello di rappresentazione di sicurezza definisce quattro livelli di rappresentazione che determinano le operazioni che un server può eseguire nel contesto dei client.
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Livelli di rappresentazione (autorizzazione)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317048"
---
# <a name="impersonation-levels-authorization"></a><span data-ttu-id="f5092-103">Livelli di rappresentazione (autorizzazione)</span><span class="sxs-lookup"><span data-stu-id="f5092-103">Impersonation Levels (Authorization)</span></span>

<span data-ttu-id="f5092-104">L' [**enumerazione \_ \_ livello di rappresentazione di sicurezza**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) definisce quattro livelli di rappresentazione che determinano le operazioni che un server può eseguire nel contesto del client.</span><span class="sxs-lookup"><span data-stu-id="f5092-104">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) enumeration defines four impersonation levels that determine the operations a server can perform in the client's context.</span></span>



| <span data-ttu-id="f5092-105">Livello di rappresentazione</span><span class="sxs-lookup"><span data-stu-id="f5092-105">Impersonation level</span></span>    | <span data-ttu-id="f5092-106">Descrizione</span><span class="sxs-lookup"><span data-stu-id="f5092-106">Description</span></span>                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f5092-107">SecurityAnonymous</span><span class="sxs-lookup"><span data-stu-id="f5092-107">SecurityAnonymous</span></span>      | <span data-ttu-id="f5092-108">Il server non può rappresentare o identificare il client.</span><span class="sxs-lookup"><span data-stu-id="f5092-108">The server cannot impersonate or identify the client.</span></span>                                            |
| <span data-ttu-id="f5092-109">SecurityIdentification</span><span class="sxs-lookup"><span data-stu-id="f5092-109">SecurityIdentification</span></span> | <span data-ttu-id="f5092-110">Il server può ottenere l'identità e i privilegi del client, ma non può rappresentare il client.</span><span class="sxs-lookup"><span data-stu-id="f5092-110">The server can get the identity and privileges of the client, but cannot impersonate the client.</span></span> |
| <span data-ttu-id="f5092-111">SecurityImpersonation</span><span class="sxs-lookup"><span data-stu-id="f5092-111">SecurityImpersonation</span></span>  | <span data-ttu-id="f5092-112">Il server può rappresentare il contesto di sicurezza del client nel sistema locale.</span><span class="sxs-lookup"><span data-stu-id="f5092-112">The server can impersonate the client's security context on the local system.</span></span>                    |
| <span data-ttu-id="f5092-113">SecurityDelegation</span><span class="sxs-lookup"><span data-stu-id="f5092-113">SecurityDelegation</span></span>     | <span data-ttu-id="f5092-114">Il server può rappresentare il contesto di sicurezza del client nei sistemi remoti.</span><span class="sxs-lookup"><span data-stu-id="f5092-114">The server can impersonate the client's security context on remote systems.</span></span>                      |



 

<span data-ttu-id="f5092-115">Il client di una connessione named pipe, RPC o DDE può controllare il livello di rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="f5092-115">The client of a named pipe, RPC, or DDE connection can control the impersonation level.</span></span> <span data-ttu-id="f5092-116">Ad esempio, un client named pipe può chiamare la funzione [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) per aprire un handle per un named pipe e specificare il livello di rappresentazione del server.</span><span class="sxs-lookup"><span data-stu-id="f5092-116">For example, a named pipe client can call the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function to open a handle to a named pipe and specify the server's impersonation level.</span></span>

<span data-ttu-id="f5092-117">Quando la connessione named pipe, RPC o DDE è remota, i flag passati a [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) per impostare il livello di rappresentazione vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="f5092-117">When the named pipe, RPC, or DDE connection is remote, the flags passed to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to set the impersonation level are ignored.</span></span> <span data-ttu-id="f5092-118">In questo caso, il livello di rappresentazione del client è determinato dai livelli di rappresentazione abilitati dal server, che viene impostato da un flag nell'account del server nel servizio directory.</span><span class="sxs-lookup"><span data-stu-id="f5092-118">In this case, the impersonation level of the client is determined by the impersonation levels enabled by the server, which is set by a flag on the server's account in the directory service.</span></span> <span data-ttu-id="f5092-119">Se, ad esempio, il server è abilitato per la delega, anche il livello di rappresentazione del client verrà impostato sulla delega anche se i flag passati a **CreateFile** specificano il livello di rappresentazione di identificazione.</span><span class="sxs-lookup"><span data-stu-id="f5092-119">For example, if the server is enabled for delegation, the client's impersonation level will also be set to delegation even if the flags passed to **CreateFile** specify the identification impersonation level.</span></span>

<span data-ttu-id="f5092-120">I client DDE utilizzano la funzione [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) con [**la \_ qualità \_ di sicurezza della struttura del \_ servizio**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) per specificare il livello di rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="f5092-120">DDE clients use the [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) function with the [**SECURITY\_QUALITY\_OF\_SERVICE**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) structure to specify the impersonation level.</span></span> <span data-ttu-id="f5092-121">Il livello SecurityImpersonation è l'impostazione predefinita per i server named pipe, RPC e DDE.</span><span class="sxs-lookup"><span data-stu-id="f5092-121">The SecurityImpersonation level is the default for named pipe, RPC, and DDE servers.</span></span> <span data-ttu-id="f5092-122">Le funzioni [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)e [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) consentono al chiamante di specificare un livello di rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="f5092-122">The [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), and [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) functions allow the caller to specify an impersonation level.</span></span> <span data-ttu-id="f5092-123">Utilizzare la funzione [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) per recuperare il livello di rappresentazione di un [*token di accesso*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="f5092-123">Use the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function to retrieve the impersonation level of an [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="f5092-124">A livello di SecurityImpersonation, la maggior parte delle azioni del thread si verifica nel contesto di sicurezza del [*token di rappresentazione*](/windows/desktop/SecGloss/i-gly) del thread invece che nel [*token primario*](/windows/desktop/SecGloss/p-gly) del [*processo*](/windows/desktop/SecGloss/p-gly) che possiede il thread.</span><span class="sxs-lookup"><span data-stu-id="f5092-124">At the SecurityImpersonation level, most of the thread's actions occur in the security context of the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly) rather than in the [*primary token*](/windows/desktop/SecGloss/p-gly) of the [*process*](/windows/desktop/SecGloss/p-gly) that owns the thread.</span></span> <span data-ttu-id="f5092-125">Se, ad esempio, un thread di rappresentazione apre un [oggetto a protezione diretta](securable-objects.md), il sistema usa il token di rappresentazione per verificare l'accesso del thread.</span><span class="sxs-lookup"><span data-stu-id="f5092-125">For example, if an impersonating thread opens a [securable object](securable-objects.md), the system uses the impersonation token to check the thread's access.</span></span> <span data-ttu-id="f5092-126">Analogamente, se un thread di rappresentazione crea un nuovo oggetto, ad esempio chiamando la funzione [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , il proprietario del nuovo oggetto è il proprietario predefinito del [*token di accesso*](/windows/desktop/SecGloss/a-gly)del client.</span><span class="sxs-lookup"><span data-stu-id="f5092-126">Similarly, if an impersonating thread creates a new object, for example by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function, the owner of the new object is the default owner from the client's [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="f5092-127">Tuttavia, il sistema usa il token primario del processo anziché il token di rappresentazione del thread chiamante nelle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="f5092-127">However, the system uses the primary token of the process rather than the impersonation token of the calling thread in the following situations:</span></span>

-   <span data-ttu-id="f5092-128">Se un thread di rappresentazione chiama la funzione [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) , il nuovo processo eredita sempre il token primario del processo.</span><span class="sxs-lookup"><span data-stu-id="f5092-128">If an impersonating thread calls the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function, the new process always inherits the primary token of the process.</span></span>
-   <span data-ttu-id="f5092-129">Per le funzioni che richiedono il \_ privilegio se TCB \_ , ad esempio la funzione [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) , il sistema verifica sempre il privilegio nel token primario del processo.</span><span class="sxs-lookup"><span data-stu-id="f5092-129">For functions that require the SE\_TCB\_NAME privilege, such as the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="f5092-130">Per le funzioni che richiedono il \_ privilegio se controlla \_ nome, ad esempio la funzione [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) , il sistema verifica sempre il privilegio nel token primario del processo.</span><span class="sxs-lookup"><span data-stu-id="f5092-130">For functions that require the SE\_AUDIT\_NAME privilege, such as the [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="f5092-131">In una chiamata alla funzione [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) , un thread può specificare se la funzione usa il token di rappresentazione o il token primario per determinare se concedere l'accesso richiesto.</span><span class="sxs-lookup"><span data-stu-id="f5092-131">In a call to the [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function, a thread can specify whether the function uses the impersonation token or the primary token to determine whether to grant the requested access.</span></span>

 

 
