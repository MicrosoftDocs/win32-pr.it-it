---
description: Linee guida di implementazione per la serializzazione delle impostazioni di IWICDevelopRaw
ms.assetid: 4ecff5cc-24f3-4b89-b681-85c867b053e7
title: Linee guida di implementazione per la serializzazione delle impostazioni di IWICDevelopRaw
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48cdc78f68e6d63ee7870b9296ae4cfa4f85547a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "103758294"
---
# <a name="implementation-guidelines-for-serializing-iwicdevelopraw-settings"></a><span data-ttu-id="c803c-103">Linee guida di implementazione per la serializzazione delle impostazioni di IWICDevelopRaw</span><span class="sxs-lookup"><span data-stu-id="c803c-103">Implementation Guidelines for Serializing IWICDevelopRaw Settings</span></span>

<span data-ttu-id="c803c-104">L'interfaccia [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) espone le impostazioni che possono essere utilizzate dall'applicazione per modificare l'elaborazione dell'immagine non elaborata.</span><span class="sxs-lookup"><span data-stu-id="c803c-104">The [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface exposes settings that the application can use to modify the processing of the RAW image.</span></span> <span data-ttu-id="c803c-105">Le impostazioni devono essere serializzate in modo che vengano mantenute tra le sessioni.</span><span class="sxs-lookup"><span data-stu-id="c803c-105">The settings should be able to be serialized so that they persist across sessions.</span></span> <span data-ttu-id="c803c-106">Sebbene questa operazione possa essere eseguita in diversi modi, è consigliabile codificare i dati in modo coerente con altri metadati.</span><span class="sxs-lookup"><span data-stu-id="c803c-106">Although this can be done in several ways, it is recommended to encode this data in a manner that is consistent with other metadata.</span></span>

<span data-ttu-id="c803c-107">Di seguito sono riportate alcune linee guida generali per l'implementazione:</span><span class="sxs-lookup"><span data-stu-id="c803c-107">The following are some general implementation guidelines:</span></span>

-   <span data-ttu-id="c803c-108">Tutte le impostazioni effettuate tramite [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) , ad esempio rotazione o bilanciamento del bianco, devono evitare la sovrascrittura delle impostazioni della fotocamera o dei dati "come-shot", a meno che il tag non venga comunemente utilizzato come "impostazione corrente".</span><span class="sxs-lookup"><span data-stu-id="c803c-108">Any settings made via [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (such as rotation or white balance) should avoid overwriting camera setting or "as-shot" data unless the tag is commonly used as a "current setting."</span></span> <span data-ttu-id="c803c-109">Ad esempio, è possibile usare i tag di orientamento EXIF per la rotazione permanente.</span><span class="sxs-lookup"><span data-stu-id="c803c-109">For example, EXIF orientation tags can be used to persist rotation.</span></span>
-   <span data-ttu-id="c803c-110">È preferibile non dover salvare l'intero file (inclusi i dati del pixel mosaico) ogni volta che viene richiesta la serializzazione delle impostazioni di [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="c803c-110">It is preferable not to have to save the entire file (including the mosaic pixel data) each time that the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings are asked to be serialized.</span></span>
-   <span data-ttu-id="c803c-111">Il processo di serializzazione delle impostazioni di [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) seguirà in genere questo ordine di eventi.</span><span class="sxs-lookup"><span data-stu-id="c803c-111">The process of serializing [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings will generally follow this order of events.</span></span> <span data-ttu-id="c803c-112">L'applicazione:</span><span class="sxs-lookup"><span data-stu-id="c803c-112">The application:</span></span>

    1.  <span data-ttu-id="c803c-113">Crea un'istanza di un [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) in un file non elaborato.</span><span class="sxs-lookup"><span data-stu-id="c803c-113">Instantiates an [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) on a RAW file.</span></span>
    2.  <span data-ttu-id="c803c-114">Chiama [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) per ottenere un [**IWICBITMAPFRAMEDECODE**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) per il frame non elaborato.</span><span class="sxs-lookup"><span data-stu-id="c803c-114">Calls [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) to get an [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) for the RAW frame.</span></span>
    3.  <span data-ttu-id="c803c-115">Chiama QueryInterface sull'interfaccia IWICBitmapFrameDecode per l'interfaccia IWICDevelopRaw.</span><span class="sxs-lookup"><span data-stu-id="c803c-115">Calls QueryInterface on the IWICBitmapFrameDecode interface for the IWICDevelopRaw interface.</span></span>
    4.  <span data-ttu-id="c803c-116">Chiama [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), che restituisce un'interfaccia IPropertyBag2 con tutte le proprietà correnti archiviate.</span><span class="sxs-lookup"><span data-stu-id="c803c-116">Calls [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), which returns an IPropertyBag2 interface with all of the current properties stored in it.</span></span>

        <span data-ttu-id="c803c-117">A questo punto del processo, l'obiettivo è quello di serializzare le impostazioni nell'interfaccia IPropertyBag2 nel file non elaborato.</span><span class="sxs-lookup"><span data-stu-id="c803c-117">At this point of the process, the goal is to serialize the settings in the IPropertyBag2 interface into the RAW file.</span></span> <span data-ttu-id="c803c-118">A tale scopo, è necessario ruotare un codificatore e così via, che viene descritto in dettaglio nei passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="c803c-118">To do so requires spinning up an encoder and so on, which is detailed in the following steps.</span></span>

    5.  <span data-ttu-id="c803c-119">Crea un [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) per il file non elaborato.</span><span class="sxs-lookup"><span data-stu-id="c803c-119">Creates an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) for the RAW file.</span></span>
    6.  <span data-ttu-id="c803c-120">Chiama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passando un nuovo flusso (vuoto) da codificare.</span><span class="sxs-lookup"><span data-stu-id="c803c-120">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passing in a new (blank) stream to encode.</span></span>
    7.  <span data-ttu-id="c803c-121">Chiama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) per creare un nuovo IWICBitmapFrameEncode per il frame non elaborato.</span><span class="sxs-lookup"><span data-stu-id="c803c-121">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) to create a new IWICBitmapFrameEncode for the RAW frame.</span></span>
    8.  <span data-ttu-id="c803c-122">Chiama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize)e passa l'interfaccia IPropertyBag2 del passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="c803c-122">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), and passes in the IPropertyBag2 interface from step 4.</span></span>
    9.  <span data-ttu-id="c803c-123">Chiama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) con [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) dal frame dell'immagine non elaborata del decodificatore.</span><span class="sxs-lookup"><span data-stu-id="c803c-123">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) with [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) from decoder's RAW image frame.</span></span>
    10. <span data-ttu-id="c803c-124">Chiama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="c803c-124">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span> <span data-ttu-id="c803c-125">Il codec serializza quindi le proprietà in IPropertyBag2 dal passaggio 8 al file.</span><span class="sxs-lookup"><span data-stu-id="c803c-125">The codec then serializes the properties in the IPropertyBag2 from step 8 into the file.</span></span> <span data-ttu-id="c803c-126">Il metodo più comune per la serializzazione delle proprietà si presuppone che vengano scritti come metadati nel file.</span><span class="sxs-lookup"><span data-stu-id="c803c-126">The most common method of serializing the properties is assumed to be by writing them out as metadata in the file.</span></span>
    11. <span data-ttu-id="c803c-127">Chiama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="c803c-127">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span>
    12. <span data-ttu-id="c803c-128">Chiama IStream:: commit nel flusso nel passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="c803c-128">Calls IStream::Commit on the stream in step 6.</span></span>

    <span data-ttu-id="c803c-129">Le impostazioni vengono serializzate nel file.</span><span class="sxs-lookup"><span data-stu-id="c803c-129">The settings are serialized in the file.</span></span>

    <span data-ttu-id="c803c-130">Questo metodo implica il costo della riscrittura dell'intero file non elaborato ogni volta che vengono serializzate le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="c803c-130">This method does incur the cost of rewriting the entire RAW file each time the settings are serialized.</span></span> <span data-ttu-id="c803c-131">Questa operazione può essere evitata se si implementa [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) o se il formato di file di immagine supporta XMP o EXIF, perché WIC fornisce [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) per entrambi questi formati.</span><span class="sxs-lookup"><span data-stu-id="c803c-131">This can be avoided if you implement [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) or if your image file format supports XMP or EXIF, as WIC provides [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) for both of these formats.</span></span> <span data-ttu-id="c803c-132">Inoltre, se il codec scrive le modifiche alla fine del file di immagine, l'intero file di immagine non verrà riscritto.</span><span class="sxs-lookup"><span data-stu-id="c803c-132">Also, if your codec writes changes to the end of the image file, then you won't end up rewriting the entire image file.</span></span>

-   <span data-ttu-id="c803c-133">I set di parametri vengono caricati dallo stato serializzato quando l'applicazione imposta l'enumerazione [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) nel metodo [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) .</span><span class="sxs-lookup"><span data-stu-id="c803c-133">Parameter sets are loaded from the serialized state when the application sets the [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) enumeration on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) method.</span></span> <span data-ttu-id="c803c-134">Il flag [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) fa riferimento al set di parametri Last-saved, quindi un carico con questo flag dovrebbe comportare il ripristino dei parametri per l'ultimo stato salvato.</span><span class="sxs-lookup"><span data-stu-id="c803c-134">The [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag refers to the last-saved parameter set, so a load with this flag should result in restoring parameters to the last-saved state.</span></span>
-   <span data-ttu-id="c803c-135">Al caricamento iniziale è necessario caricare il set di parametri Last-saved, se disponibile.</span><span class="sxs-lookup"><span data-stu-id="c803c-135">Upon initial load, the last-saved parameter set should be loaded, if available.</span></span> <span data-ttu-id="c803c-136">In caso contrario, le impostazioni "As-shot" devono essere usate come impostazioni predefinite nelle variabili di interfaccia [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="c803c-136">If not, then the "as-shot" settings should be used as presets on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface variables.</span></span> <span data-ttu-id="c803c-137">È anche possibile caricare queste impostazioni come-shot usando il flag [**WICRawParameterSet. WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) .</span><span class="sxs-lookup"><span data-stu-id="c803c-137">These as-shot settings can also be loaded by using the [**WICRawParameterSet.WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag.</span></span>
-   <span data-ttu-id="c803c-138">L'identificatore [**WICRawParameterSet. WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) è progettato per rappresentare un'impostazione "auto".</span><span class="sxs-lookup"><span data-stu-id="c803c-138">The identifier [**WICRawParameterSet.WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) is meant to represent an "Auto" setting.</span></span> <span data-ttu-id="c803c-139">In progettazione codec è possibile scegliere uno degli approcci seguenti per impostare i parametri [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) quando viene effettuata questa impostazione:</span><span class="sxs-lookup"><span data-stu-id="c803c-139">The codec designer can elect any of the following approaches on how to set [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) parameters when this setting is made:</span></span>

    -   <span data-ttu-id="c803c-140">Eseguire un'ottimizzazione algoritmica di alcuni parametri, ad esempio l'esposizione o il colore.</span><span class="sxs-lookup"><span data-stu-id="c803c-140">Perform an algorithmic optimization of some parameters, such as exposure or color.</span></span> <span data-ttu-id="c803c-141">Questo è il modo in cui le funzioni automatiche negli editor di immagini tipiche sono basate principalmente sull'analisi dei dati in pixel.</span><span class="sxs-lookup"><span data-stu-id="c803c-141">This is how Auto functions in typical image editors and is based primarily on pixel data analysis.</span></span>
    -   <span data-ttu-id="c803c-142">Impostare le impostazioni della fotocamera in modo analogo al comportamento di un'impostazione automatica.</span><span class="sxs-lookup"><span data-stu-id="c803c-142">Set camera settings similar to how an Auto setting would have behaved.</span></span> <span data-ttu-id="c803c-143">Questa operazione è utile se l'immagine è stata scattata in un'impostazione manuale e consente all'utente di eseguire l'override delle impostazioni manuali.</span><span class="sxs-lookup"><span data-stu-id="c803c-143">This is useful if the image was shot on a Manual setting and allows the user to override manual settings.</span></span>
    -   <span data-ttu-id="c803c-144">Non eseguire alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="c803c-144">Do nothing.</span></span> <span data-ttu-id="c803c-145">Non è necessario impostare tutti i controlli quando è selezionata l'opzione auto ed è possibile lasciare invariate le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="c803c-145">Not all controls need to be set when Auto is selected, and it is OK to leave settings unchanged.</span></span>

<span data-ttu-id="c803c-146">La raccolta foto di Windows Vista e gli strumenti di modifica della raccolta foto di Windows Live e altre applicazioni di modifica usano il caricamento automatico dei parametri [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) quando l'utente seleziona correzione automatica per tutte le normali regolazioni del controllo codec, ad esempio il colore e l'esposizione, per ottenere risultati ottimali.</span><span class="sxs-lookup"><span data-stu-id="c803c-146">The Windows Vista Photo Gallery and Windows Live Photo Gallery editing tools and other editing applications use the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) Auto parameter load when the user selects Auto Correct for all normal codec control adjustments such as color and exposure to get the best results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c803c-147">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c803c-147">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="c803c-148">**Informazioni concettuali**</span><span class="sxs-lookup"><span data-stu-id="c803c-148">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="c803c-149">Panoramica del componente imaging Windows</span><span class="sxs-lookup"><span data-stu-id="c803c-149">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="c803c-150">Linee guida per WIC per i formati di immagine RAW della fotocamera</span><span class="sxs-lookup"><span data-stu-id="c803c-150">WIC Guidelines for Camera RAW Image Formats</span></span>](-wic-rawguidelines.md)
</dt> <dt>

[<span data-ttu-id="c803c-151">Come scrivere un CODEC WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="c803c-151">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> </dl>

 

 



