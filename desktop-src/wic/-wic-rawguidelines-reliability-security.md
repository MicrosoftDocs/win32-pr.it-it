---
description: Affidabilità e sicurezza
ms.assetid: 1cbfabce-3d56-4e23-b9a7-02369c67e392
title: Affidabilità e sicurezza
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a0f0e4a244de2c1463cdadb76162c18b041812b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106315941"
---
# <a name="reliability-and-security"></a><span data-ttu-id="d0ad3-103">Affidabilità e sicurezza</span><span class="sxs-lookup"><span data-stu-id="d0ad3-103">Reliability and Security</span></span>

<span data-ttu-id="d0ad3-104">Poiché i codec di Windows Imaging Component (WIC) verranno richiamati dalla shell di Windows e dalla raccolta foto, gli autori di codec dovranno eseguire ogni sforzo per garantire un elevato livello di affidabilità e sicurezza nei propri codec WIC.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-104">Because Windows Imaging Component (WIC) codecs will be invoked from within the Windows shell and Photo Gallery, codec authors should make every effort to ensure a high level of reliability and security in their WIC codecs.</span></span>

<span data-ttu-id="d0ad3-105">La scrittura di codice affidabile in gran parte dipende da procedure di codifica valide, revisioni del codice efficaci e test completi di unit test e test dello scenario.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-105">Writing reliable code largely depends on good coding practices, effective code reviews, and thorough unit testing and scenario testing.</span></span> <span data-ttu-id="d0ad3-106">Inoltre, le linee guida seguenti consentiranno di garantire che il codec sia conforme ai criteri di Windows Vista relativi all'affidabilità.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-106">In addition, the following guidelines will help ensure that the codec complies with Windows Vista policies regarding reliability.</span></span>

-   <span data-ttu-id="d0ad3-107">Abilita l'annullamento I/O.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-107">Enable I/O cancellation.</span></span>

    <span data-ttu-id="d0ad3-108">Gli autori di codec devono consentire all'utente finale di annullare qualsiasi operazione a esecuzione prolungata.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-108">Codec authors should provide a way for the end user to cancel any long-running operation.</span></span> <span data-ttu-id="d0ad3-109">I codec WIC supportano questa operazione implementando IWICBitmapProgressNotification.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-109">WIC codecs support this by implementing IWICBitmapProgressNotification.</span></span> <span data-ttu-id="d0ad3-110">Questo consente a un'applicazione chiamante di specificare una funzione di callback per il codec da chiamare a intervalli specificati per notificare al chiamante lo stato dell'operazione corrente.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-110">This allows a calling application to specify a callback function for the codec to call at specified intervals to notify the caller of the progress of the current operation.</span></span> <span data-ttu-id="d0ad3-111">Quando un'applicazione restituisce un errore \_ annullato dalla funzione di callback, il codec deve annullare qualsiasi operazione in corso e propagare di nuovo HRESULT al chiamante.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-111">When an application returns ERROR\_CANCELLED from the callback function, the codec must cancel whatever operation is in progress and propagate the HRESULT back to the caller.</span></span> <span data-ttu-id="d0ad3-112">Questa operazione è particolarmente importante per i codec non ELABORAti, perché potrebbero essere necessari alcuni secondi per decodificare un'immagine non ELABORAta di dimensioni complete e le applicazioni necessitano di un modo per interrompere l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-112">This is especially important for RAW codecs, because it might take several seconds to decode a full-size RAW image and applications need a way to abort this processing.</span></span>

-   <span data-ttu-id="d0ad3-113">Verificare che il codice venga eseguito nell'ambito più piccolo necessario per eseguire la relativa funzione.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-113">Make sure that code runs in the smallest scope that is required to perform its function.</span></span>

    <span data-ttu-id="d0ad3-114">Gli autori di codec devono assicurarsi che il codec non utilizzi più risorse del necessario o abbia un ambito maggiore di quello necessario.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-114">Codec authors must ensure that the codec does not consume more resources than necessary or have a greater scope than is required.</span></span> <span data-ttu-id="d0ad3-115">L'ambito di un codec in WIC è un singolo file di immagine; il codec viene creato quando viene caricato un file di immagine e il codec viene rilasciato quando l'immagine viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-115">The scope of a codec in WIC is a single image file; the codec is created when an image file is loaded, and the codec is released when the image is closed.</span></span> <span data-ttu-id="d0ad3-116">Poiché WIC è una piattaforma estensibile basata su componenti, i codec WIC avranno carichi e Scaricamenti sovrapposti e verranno avviati e arrestati, tutti all'interno dello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-116">Because WIC is an extensible component-based platform, WIC codecs will have overlapping loads and unloads, and starts and stops, all within the same process.</span></span> <span data-ttu-id="d0ad3-117">Se l'infrastruttura sottostante di un codec richiede operazioni di avvio e arresto in un ambito più grande di una singola immagine, l'affidabilità sarà interessata.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-117">If the underlying infrastructure of a codec requires start and stop operations at a scope larger than a single image, reliability will be impacted.</span></span> <span data-ttu-id="d0ad3-118">I codec abilitati per WIC verranno utilizzati da Esplora risorse, nonché da altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-118">WIC-enabled codecs will be used by the Windows Explorer, as well as other applications.</span></span> <span data-ttu-id="d0ad3-119">Se pertanto un codec rimane caricato per tutta la durata del processo, la memoria non verrà rilasciata in modo efficiente e un errore del codec potrebbe bloccare Esplora risorse e potenzialmente richiedere il riavvio del computer.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-119">Therefore, if a codec remains loaded for the lifetime of the process, memory will not be released efficiently and a failure of the codec could hang Windows Explorer and potentially require the machine to be rebooted.</span></span> <span data-ttu-id="d0ad3-120">Tenere presente che il codec verrà richiamato ogni volta che un'immagine viene visualizzata per la prima volta in Esplora risorse: è essenziale che questa sia un'operazione semplice.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-120">(Consider that the codec will be invoked every time an image is thumbnailed for the first time in Windows Explorer: it is essential that this be a lightweight operation.)</span></span>

-   <span data-ttu-id="d0ad3-121">Usare gli strumenti di analisi del codice statico e dinamico.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-121">Use static and dynamic code analysis tools.</span></span>

    -   <span data-ttu-id="d0ad3-122">Strumenti di analisi statica:</span><span class="sxs-lookup"><span data-stu-id="d0ad3-122">Static analysis tools:</span></span>

        <span data-ttu-id="d0ad3-123">Prefisso: per il rilevamento degli errori in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-123">PREfix - for detecting errors at compile time.</span></span>

        <span data-ttu-id="d0ad3-124">PREfast: per l'analisi del codice per i bug.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-124">PREfast - for analyzing code for bugs.</span></span>

    -   <span data-ttu-id="d0ad3-125">Strumenti di analisi dinamica:</span><span class="sxs-lookup"><span data-stu-id="d0ad3-125">Dynamic analysis tools:</span></span>

        <span data-ttu-id="d0ad3-126">AppVerifier: consente di rendere le applicazioni più resilienti simulando problemi comuni del software reale.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-126">AppVerifier - which helps make applications more resilient by simulating common real-world software issues.</span></span>

-   <span data-ttu-id="d0ad3-127">Verificare tutti gli input nelle revisioni del codice.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-127">Verify all inputs in code reviews.</span></span>

    <span data-ttu-id="d0ad3-128">Tutti i parametri per i metodi esportati e tutti i dati dei file devono essere verificati con attenzione e rifiutati in modo affidabile in caso di errori, per proteggersi da sovraccarichi del buffer e sottoesecuzioni, overflow aritmetici e sottoflussi e tipi imprevisti.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-128">All parameters for exported methods and all file data must be carefully verified for validity and robustly rejected if faulty, in order to protect against buffer overruns and underruns, arithmetic overflows and underflows, and unexpected types.</span></span>

-   <span data-ttu-id="d0ad3-129">Usare tecniche di fuzzing di file per individuare potenziali arresti anomali e blocchi.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-129">Use file fuzzing techniques to discover potential crashes and hangs.</span></span>

    <span data-ttu-id="d0ad3-130">Il fuzzing dei file è il processo di test del codec con input permutati in modo casuale.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-130">File fuzzing is the process of testing the codec with randomly permuted inputs.</span></span>

    <span data-ttu-id="d0ad3-131">Esistono due forme di fuzzing dei file: fuzzing non indirizzato (casuale) e fuzzing diretto.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-131">There are two forms of file fuzzing: undirected (random) fuzzing and directed fuzzing.</span></span> <span data-ttu-id="d0ad3-132">Il fuzzing non diretto esegue un capovolgimento casuale dei bit per verificare se l'input casuale può causare l'arresto anomalo del codec.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-132">Undirected fuzzing does some random bit flipping to see if random input can crash the codec.</span></span> <span data-ttu-id="d0ad3-133">Il fuzzing diretto permuta l'input in base a una certa conoscenza del formato di file.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-133">Directed fuzzing permutes the input based on some knowledge of the file format.</span></span> <span data-ttu-id="d0ad3-134">Se, ad esempio, è presente un controllo di ridondanza del ciclo (CRC) a offset di byte 32, la modifica di qualsiasi byte senza aggiornare il CRC probabilmente non eserciterà la maggior parte dei percorsi di codepath.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-134">For example, if there is a cycle redundancy check (CRC) at byte offset 32, then changing any bytes without updating the CRC will likely not exercise most of the codepaths.</span></span> <span data-ttu-id="d0ad3-135">In questo esempio, un fuzzer diretto deve correggere il CRC quando vengono modificati tutti i byte.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-135">In this example, a directed fuzzer should fix the CRC when any bytes are modified.</span></span>

    <span data-ttu-id="d0ad3-136">Il set di input di immagini per il fuzzing dei file deve essere creato in modo che ogni combinazione di parametri supportata dal decodificatore venga testata.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-136">The input set of images for file fuzzing should be created so that each parameter combination that the decoder supports is tested.</span></span> <span data-ttu-id="d0ad3-137">Se, ad esempio, il decodificatore supporta file Little e Big-Endian e tre impostazioni di compressione, il set di input dell'immagine deve essere costituito da file Little-Endian di ogni impostazione di compressione e file big-endian per ogni impostazione di compressione.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-137">For example, if the decoder supports little- and big-endian files and three compression settings, then the input set of image should consist of little-endian files of each compression setting and big-endian files for each compression setting.</span></span> <span data-ttu-id="d0ad3-138">Questo approccio produrrà un set di immagini di input di grandi dimensioni, ma molto affidabili, da testare.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-138">This approach will yield a large, but very robust set of input images to be tested.</span></span> <span data-ttu-id="d0ad3-139">Anche se nessuna fotocamera produce ognuna delle combinazioni, ma il decodificatore supporta queste combinazioni teoriche, gli autori di codec dovrebbero fuzzare questi input.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-139">Even if no camera produces each of the combinations but the decoder supports these theoretical combinations, codec authors should fuzz these inputs.</span></span>

    <span data-ttu-id="d0ad3-140">La sicurezza può essere migliorata mediante l'esecuzione regolare di test fuzzy dei file di immagine durante lo sviluppo di codec.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-140">Security can be greatly enhanced by regularly performing fuzz testing of image files during codec development.</span></span> <span data-ttu-id="d0ad3-141">I codec devono essere sempre in grado di rilevare il danneggiamento dei file di immagine e non vengono eseguiti normalmente in caso di una richiesta in formato non valido o di dati in formato non valido.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-141">Codecs should always be able to detect image file corruption and fail gracefully in the case of a malformed request or of malformed data.</span></span>

-   <span data-ttu-id="d0ad3-142">Evidenziare il codice.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-142">Stress the code.</span></span>

    <span data-ttu-id="d0ad3-143">Sottoporre a test il codec eseguendolo continuamente in più processi simultanei, eseguendo tutte le operazioni supportate in tutte le sequenze possibili, su immagini di dimensioni variabili (incluse immagini di grandi dimensioni) da ogni fotocamera supportata.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-143">Stress-test the codec by running it continually in multiple simultaneous processes, performing all supported operations in all possible sequences, on images of varying sizes (including very large images) from every supported camera.</span></span>

-   <span data-ttu-id="d0ad3-144">Thread safety.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-144">Thread safety.</span></span>

    <span data-ttu-id="d0ad3-145">A partire da Windows 7, per WIC è necessario che i CODEC non ELABORAti siano di tipo apartment COM "both".</span><span class="sxs-lookup"><span data-stu-id="d0ad3-145">As of Windows 7, WIC requires that RAW CODECs be of COM apartment type "Both".</span></span> <span data-ttu-id="d0ad3-146">Ciò significa che è necessario eseguire il blocco appropriato per gestire i chiamanti e i chiamanti tra più Apartment negli scenari multithread.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-146">This means that you must do the appropriate locking to handle cross-apartment callers and callers in multi-threaded scenarios.</span></span> <span data-ttu-id="d0ad3-147">Gli oggetti all'interno di un Apartment a thread multipli (MTA) possono essere chiamati simultaneamente da un numero qualsiasi di thread all'interno dell'MTA, consentendo prestazioni migliori nei sistemi multicore e in alcuni scenari server.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-147">Objects within an Multi Threaded Apartment (MTA) may be called concurrently by any number of threads within the MTA, allowing for better performance on multi-core systems and certain server scenarios.</span></span> <span data-ttu-id="d0ad3-148">Inoltre, i CODEC WIC che risiedono all'interno di un MTA possono chiamare altri oggetti che risiedono all'interno dell'MTA senza il costo di marshalling associato alla chiamata tra thread che si trovano in diversi apartment STA.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-148">In addition, WIC CODECs that live within an MTA can call other objects that live within the MTA without the marshalling cost associated of calling between threads that live in different STA apartments.</span></span> <span data-ttu-id="d0ad3-149">In Windows 7, tutti i CODEC WIC inclusi sono stati aggiornati per supportare gli MTA, tra cui JPEG, TIFF, PNG, GIF, ICO e BMP.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-149">In Windows 7, all in-box WIC CODECs have been updated to support MTAs, including JPEG, TIFF, PNG, GIF, ICO, and BMP.</span></span> <span data-ttu-id="d0ad3-150">i CODEC di terze parti che non supportano gli MTA provocheranno costi significativi in termini di prestazioni nelle applicazioni multithread a causa del marshalling.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-150">3rd-party CODECs that do not to support MTAs will cause significant performance costs in multithreaded applications due to marshaling.</span></span> <span data-ttu-id="d0ad3-151">Per abilitare il supporto MTA, è necessario implementare una corretta sincronizzazione nel CODEC di terze parti.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-151">Enabling MTA support requires proper synchronization to be implemented in the 3rd-party CODEC.</span></span> <span data-ttu-id="d0ad3-152">L'implementazione esatta di queste tecniche di sincronizzazione esula dall'ambito di questo documento.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-152">Exact implementation of these synchronization techniques is beyond the scope of this paper.</span></span> <span data-ttu-id="d0ad3-153">Di seguito è riportato un riferimento generale per la sincronizzazione di oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="d0ad3-153">A general reference for synchronizing COM objects is provided below.</span></span>

    https://msdn.microsoft.com/library/ms809971.aspx

## <a name="related-topics"></a><span data-ttu-id="d0ad3-154">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d0ad3-154">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="d0ad3-155">**Informazioni concettuali**</span><span class="sxs-lookup"><span data-stu-id="d0ad3-155">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="d0ad3-156">Panoramica del componente imaging Windows</span><span class="sxs-lookup"><span data-stu-id="d0ad3-156">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="d0ad3-157">Linee guida per WIC per i formati di immagine RAW della fotocamera</span><span class="sxs-lookup"><span data-stu-id="d0ad3-157">WIC Guidelines for Camera RAW Image Formats</span></span>](-wic-rawguidelines.md)
</dt> <dt>

[<span data-ttu-id="d0ad3-158">Come scrivere un CODEC WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="d0ad3-158">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> </dl>

 

 



