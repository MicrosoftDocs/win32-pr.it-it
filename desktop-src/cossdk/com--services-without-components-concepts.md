---
description: In COM+ 1,5 è stata introdotta la possibilità di utilizzare i servizi COM+ senza componenti.
ms.assetid: da93d164-234a-4d1e-b82c-f3f904bb8cb6
title: Concetti relativi ai servizi COM+ senza componenti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d692657d33143b9437a9c8134260a8c32431cb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103878198"
---
# <a name="com-services-without-components-concepts"></a><span data-ttu-id="67341-103">Concetti relativi ai servizi COM+ senza componenti</span><span class="sxs-lookup"><span data-stu-id="67341-103">COM+ Services Without Components Concepts</span></span>

<span data-ttu-id="67341-104">In COM+ 1,5 è stata introdotta la possibilità di utilizzare i servizi COM+ senza componenti.</span><span class="sxs-lookup"><span data-stu-id="67341-104">COM+ 1.5 introduces the ability to use COM+ services without components.</span></span> <span data-ttu-id="67341-105">Questo consente di ridurre significativamente i costi di prestazioni quando si utilizzano i servizi COM+ da un ambiente che non utilizza i componenti di e viene eliminata anche la complessità dell'utilizzo di questi servizi.</span><span class="sxs-lookup"><span data-stu-id="67341-105">This significantly reduces the performance costs when using COM+ services from an environment that doesn't use components, and it also eliminates the complexity of using these services.</span></span> <span data-ttu-id="67341-106">A partire da IIS 6,0, IIS e ASP sfruttano i vantaggi dell'utilizzo di servizi COM+ senza componenti.</span><span class="sxs-lookup"><span data-stu-id="67341-106">Beginning with IIS 6.0, IIS and ASP take advantage of using COM+ services without components.</span></span>

<span data-ttu-id="67341-107">I servizi COM+ sono stati originariamente progettati per essere utilizzati con i componenti COM+.</span><span class="sxs-lookup"><span data-stu-id="67341-107">COM+ services were originally designed to be used with COM+ components.</span></span> <span data-ttu-id="67341-108">Tuttavia, alcuni ambienti di programmazione non sono basati su componenti e pertanto richiedono un sovraccarico sostanziale per l'utilizzo dei servizi COM+.</span><span class="sxs-lookup"><span data-stu-id="67341-108">However, some programming environments are not component-based and therefore required substantial overhead to use COM+ services.</span></span> <span data-ttu-id="67341-109">Ad esempio, prima del rilascio di COM+ 1,5, IIS doveva creare oggetti shim esclusivamente per poter utilizzare i servizi di transazione COM+ nelle pagine ASP.</span><span class="sxs-lookup"><span data-stu-id="67341-109">For example, before the release of COM+ 1.5, IIS had to create shim objects solely to be able to use COM+ transaction services in ASP pages.</span></span> <span data-ttu-id="67341-110">I costi di prestazioni derivanti dalla creazione di tali oggetti includono l'archiviazione dei dati di configurazione sia nella metabase IIS che nel database di registrazione COM+ (RegDB), nonché nella comunicazione aggiuntiva tra la metabase IIS e il RegDB COM+ necessario per gestire efficacemente i dati di configurazione.</span><span class="sxs-lookup"><span data-stu-id="67341-110">The performance costs that come from creating those objects include storing the configuration data in both the IIS metabase and the COM+ registration database (RegDB) as well as the extra communication between the IIS metabase and the COM+ RegDB that is needed to effectively manage the configuration data.</span></span>

<span data-ttu-id="67341-111">Se IIS avesse dovuto usare un secondo servizio COM+, ad esempio la sincronizzazione, doveva creare un oggetto shim completamente diverso a tale scopo.</span><span class="sxs-lookup"><span data-stu-id="67341-111">If IIS needed to use a second COM+ service, such as synchronization, it had to create a completely different shim object to do so.</span></span> <span data-ttu-id="67341-112">Per utilizzare le transazioni COM+ e la sincronizzazione, è necessario un terzo tipo di oggetto shim.</span><span class="sxs-lookup"><span data-stu-id="67341-112">To use both COM+ transactions and synchronization, a third type of shim object would be needed.</span></span> <span data-ttu-id="67341-113">La complessità di questo approccio è scalabile come O (N2), rendendo estremamente difficile l'implementazione di nuovi servizi.</span><span class="sxs-lookup"><span data-stu-id="67341-113">The complexity of this approach scales as O(n2), making the implementation of new services extremely difficult.</span></span>

<span data-ttu-id="67341-114">Con l'introduzione dei servizi COM+ senza componenti, i servizi necessari vengono configurati tramite un oggetto di cui è stata creata un'istanza dalla classe.</span><span class="sxs-lookup"><span data-stu-id="67341-114">With the introduction of COM+ services without components, the services that are needed are configured through an object instantiated from the class.</span></span> <span data-ttu-id="67341-115">La classe [**CServiceConfig**](cserviceconfig.md) implementa le interfacce necessarie per configurare i diversi servizi, garantendo allo stesso tempo la flessibilità necessaria per supportare più servizi e la possibilità di supportare nuovi servizi in futuro.</span><span class="sxs-lookup"><span data-stu-id="67341-115">The [**CServiceConfig**](cserviceconfig.md) class implements the interfaces needed to configure the different services while providing the flexibility to support multiple services at the same time and the ability to support new services in the future.</span></span>

<span data-ttu-id="67341-116">I servizi configurati possono quindi essere usati attraverso due meccanismi diversi: possono essere usati tramite la funzione [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) , che applica i servizi a tutto il lavoro inviato tramite l'attività creata dalla funzione e può essere usato anche incorporando il lavoro che usa i servizi tra le chiamate alle funzioni [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) e [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) .</span><span class="sxs-lookup"><span data-stu-id="67341-116">The configured services can then be used through two different mechanisms: They can be used through the [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) function, which applies the services to all of the work submitted via the activity that is created by the function, and they can also be used by embedding the work that uses the services between calls to the [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) and [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) functions.</span></span> <span data-ttu-id="67341-117">Nessuna di queste funzioni richiede la creazione di nuovi componenti per poter utilizzare i servizi COM+. è necessario solo l'oggetto [**CServiceConfig**](cserviceconfig.md) .</span><span class="sxs-lookup"><span data-stu-id="67341-117">None of these functions requires the creation of any new components to be able to use the COM+ services; only the [**CServiceConfig**](cserviceconfig.md) object is needed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="67341-118">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="67341-118">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="67341-119">Servizi COM+ senza attività componenti</span><span class="sxs-lookup"><span data-stu-id="67341-119">COM+ Services Without Components Tasks</span></span>](com--services-without-components-tasks.md)
</dt> </dl>

 

 



