---
description: Il riciclo delle applicazioni può aumentare significativamente la stabilità complessiva delle applicazioni COM+ offrendo una correzione rapida per i problemi noti e proteggendosi da quelli imprevisti.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Concetti relativi al riciclo delle applicazioni COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104401408"
---
# <a name="com-application-recycling-concepts"></a><span data-ttu-id="63bd5-103">Concetti relativi al riciclo delle applicazioni COM+</span><span class="sxs-lookup"><span data-stu-id="63bd5-103">COM+ Application Recycling Concepts</span></span>

<span data-ttu-id="63bd5-104">Il riciclo delle applicazioni può aumentare significativamente la stabilità complessiva delle applicazioni COM+ offrendo una correzione rapida per i problemi noti e proteggendosi da quelli imprevisti.</span><span class="sxs-lookup"><span data-stu-id="63bd5-104">Application recycling can significantly increase the overall stability of your COM+ applications by offering a quick fix for known problems and helping to protect against unexpected ones.</span></span> <span data-ttu-id="63bd5-105">Ad esempio, le prestazioni dell'applicazione possono peggiorare nel tempo a causa di problemi quali le perdite di memoria, l'utilizzo non scalabile delle risorse e l'errore di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="63bd5-105">For example, application performance can degrade over time because of problems such as memory leaks, nonscalable resource usage, and process failure.</span></span> <span data-ttu-id="63bd5-106">COM+ fornisce il riciclo delle applicazioni come una soluzione a questi problemi.</span><span class="sxs-lookup"><span data-stu-id="63bd5-106">COM+ provides application recycling as a solution to these problems.</span></span> <span data-ttu-id="63bd5-107">È possibile usare il riciclo delle applicazioni per arrestare automaticamente un processo e riavviarlo, reinizializzando in tal modo un processo non riuscito e riallocando la memoria utilizzata.</span><span class="sxs-lookup"><span data-stu-id="63bd5-107">You can use application recycling to automatically shut down a process and restart it, thus reinitializing a failing process and reallocating memory it uses.</span></span>

<span data-ttu-id="63bd5-108">Il riciclo delle applicazioni funziona creando un duplicato del processo Dllhost associato a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="63bd5-108">Application recycling works by creating a duplicate of the Dllhost process associated with an application.</span></span> <span data-ttu-id="63bd5-109">Questo processo Dllhost duplicato gestisce tutte le richieste di oggetti future, che lasciano il vecchio dllhost per completare la manutenzione delle richieste di oggetti rimanenti.</span><span class="sxs-lookup"><span data-stu-id="63bd5-109">This duplicate Dllhost process services all future object requests, which leaves the old Dllhost to finish servicing the remaining object requests.</span></span> <span data-ttu-id="63bd5-110">Il processo Dllhost precedente viene arrestato quando rileva il rilascio di tutti i riferimenti esterni agli oggetti nel processo o quando viene raggiunto il valore di timeout della scadenza.</span><span class="sxs-lookup"><span data-stu-id="63bd5-110">The old Dllhost process is shut down when it detects the release of all external references to objects in the process or when the expiration time-out value is reached.</span></span> <span data-ttu-id="63bd5-111">Grazie a questo comportamento, il riciclo delle applicazioni garantisce che un'applicazione client non verifichi un'interruzione del servizio.</span><span class="sxs-lookup"><span data-stu-id="63bd5-111">Through this behavior, application recycling ensures that a client application does not experience a service interruption.</span></span>

> [!Note]  
> <span data-ttu-id="63bd5-112">Non è possibile riciclare un'applicazione COM+ configurata per l'esecuzione come servizio Windows.</span><span class="sxs-lookup"><span data-stu-id="63bd5-112">You cannot recycle a COM+ application that has been configured to run as a Windows service.</span></span> <span data-ttu-id="63bd5-113">Inoltre, le applicazioni di libreria dispongono delle proprietà di riciclo e pool del processo host.</span><span class="sxs-lookup"><span data-stu-id="63bd5-113">Also, library applications have the recycling and pooling properties of their host process.</span></span>

 

<span data-ttu-id="63bd5-114">È possibile configurare il riciclo delle applicazioni in modo amministrativo, utilizzando lo strumento di amministrazione Servizi componenti o a livello di codice tramite l'SDK di amministrazione COM+.</span><span class="sxs-lookup"><span data-stu-id="63bd5-114">You can configure application recycling administratively, by using the Component Services administrative tool, or programmatically, through the COM+ Administrative SDK.</span></span> <span data-ttu-id="63bd5-115">È possibile riciclare i processi in base a diversi criteri, determinati dalle seguenti proprietà di un oggetto [**COMAdminCatalogObject**](comadmincatalogobject.md) nella raccolta di [**applicazioni**](applications.md) :</span><span class="sxs-lookup"><span data-stu-id="63bd5-115">You can recycle processes based on several criteria, determined by the following properties of a [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection:</span></span>

-   <span data-ttu-id="63bd5-116">**RecycleLifetimeLimit.**</span><span class="sxs-lookup"><span data-stu-id="63bd5-116">**RecycleLifetimeLimit.**</span></span> <span data-ttu-id="63bd5-117">Numero massimo di minuti per cui un processo può essere eseguito prima di essere riciclato.</span><span class="sxs-lookup"><span data-stu-id="63bd5-117">The maximum number of minutes a process can run before it's recycled.</span></span> <span data-ttu-id="63bd5-118">L'intervallo valido è compreso tra 0 e 30.240 minuti (21 giorni).</span><span class="sxs-lookup"><span data-stu-id="63bd5-118">The valid range is 0 through 30,240 minutes (21 days).</span></span> <span data-ttu-id="63bd5-119">Il numero predefinito di minuti è 0, che indica che il processo non verrà riciclato fino al raggiungimento di un limite di durata.</span><span class="sxs-lookup"><span data-stu-id="63bd5-119">The default number of minutes is 0, which indicates that the process will not recycle from reaching a lifetime limit.</span></span>
-   <span data-ttu-id="63bd5-120">**RecycleMemoryLimit.**</span><span class="sxs-lookup"><span data-stu-id="63bd5-120">**RecycleMemoryLimit.**</span></span> <span data-ttu-id="63bd5-121">Quantità massima di utilizzo della memoria del processo (espressa in kilobyte) prima del riciclo del processo.</span><span class="sxs-lookup"><span data-stu-id="63bd5-121">The maximum amount of process memory usage (in kilobytes) before recycling the process.</span></span> <span data-ttu-id="63bd5-122">Se l'utilizzo della memoria del processo supera il numero specificato per più di un minuto, il processo viene riciclato.</span><span class="sxs-lookup"><span data-stu-id="63bd5-122">If the process memory usage exceeds the specified number for longer than one minute, the process is recycled.</span></span> <span data-ttu-id="63bd5-123">L'intervallo valido è compreso tra 0 e 1.048.576 KB.</span><span class="sxs-lookup"><span data-stu-id="63bd5-123">The valid range is 0 through 1,048,576 KB.</span></span> <span data-ttu-id="63bd5-124">La quantità predefinita di utilizzo della memoria è 0 KB, che indica che il processo non verrà riciclato fino al raggiungimento di un limite di memoria.</span><span class="sxs-lookup"><span data-stu-id="63bd5-124">The default amount of memory usage is 0 KB, which indicates that the process will not recycle from reaching a memory limit.</span></span>
-   <span data-ttu-id="63bd5-125">**RecycleCallLimit.**</span><span class="sxs-lookup"><span data-stu-id="63bd5-125">**RecycleCallLimit.**</span></span> <span data-ttu-id="63bd5-126">Numero massimo di chiamate che gli oggetti applicazione possono accettare prima di riciclare il processo.</span><span class="sxs-lookup"><span data-stu-id="63bd5-126">The maximum number of calls that application objects can accept before recycling the process.</span></span> <span data-ttu-id="63bd5-127">L'intervallo valido è compreso tra 0 e 1.048.576 chiamate.</span><span class="sxs-lookup"><span data-stu-id="63bd5-127">The valid range is 0 through 1,048,576 calls.</span></span> <span data-ttu-id="63bd5-128">Il numero predefinito di chiamate è 0, che indica che il processo non verrà riciclato fino al raggiungimento di un limite di chiamate.</span><span class="sxs-lookup"><span data-stu-id="63bd5-128">The default number of calls is 0, which indicates that the process will not recycle from reaching a call limit.</span></span>
-   <span data-ttu-id="63bd5-129">**RecycleActivationLimit.**</span><span class="sxs-lookup"><span data-stu-id="63bd5-129">**RecycleActivationLimit.**</span></span> <span data-ttu-id="63bd5-130">Numero massimo di attivazioni di oggetti applicazione da accettare prima del riciclo del processo.</span><span class="sxs-lookup"><span data-stu-id="63bd5-130">The maximum number of application object activations to accept before recycling the process.</span></span> <span data-ttu-id="63bd5-131">L'intervallo valido è compreso tra 0 e 1.048.576 attivazioni.</span><span class="sxs-lookup"><span data-stu-id="63bd5-131">The valid range is 0 through 1,048,576 activations.</span></span> <span data-ttu-id="63bd5-132">Il numero predefinito di attivazioni è 0, che indica che il processo non verrà riciclato fino al raggiungimento di un limite di attivazione.</span><span class="sxs-lookup"><span data-stu-id="63bd5-132">The default number of activations is 0, which indicates that the process will not recycle from reaching an activation limit.</span></span>

<span data-ttu-id="63bd5-133">Inoltre, la proprietà RecycleExpirationTimeout dell'oggetto [**COMAdminCatalogObject**](comadmincatalogobject.md) viene usata per forzare l'arresto di un processo riciclato.</span><span class="sxs-lookup"><span data-stu-id="63bd5-133">Additionally, the RecycleExpirationTimeout property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object is used to force the shutdown of a recycled process.</span></span> <span data-ttu-id="63bd5-134">Indica il numero di minuti di attesa per il rilascio di tutti i riferimenti esterni a oggetti nel processo riciclato prima di arrestare forzatamente il processo.</span><span class="sxs-lookup"><span data-stu-id="63bd5-134">It indicates the number of minutes to wait for the release of all external references to objects in the recycled process before forcibly shutting down the process.</span></span> <span data-ttu-id="63bd5-135">L'intervallo valido è compreso tra 1 e 1440 minuti (24 ore) e il timeout di scadenza predefinito è 15 minuti.</span><span class="sxs-lookup"><span data-stu-id="63bd5-135">The valid range is 1 through 1440 minutes (24 hours), and the default expiration time-out is 15 minutes.</span></span> <span data-ttu-id="63bd5-136">Questo valore viene utilizzato solo se è già stato determinato che un processo verrà riciclato in base agli altri criteri.</span><span class="sxs-lookup"><span data-stu-id="63bd5-136">This value is used only when it is already determined that a process will be recycled based on the other criteria.</span></span>

<span data-ttu-id="63bd5-137">È possibile selezionare più di un criterio per il riciclo di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="63bd5-137">You can select more than one criterion for recycling an application.</span></span> <span data-ttu-id="63bd5-138">COM+ ricicla l'applicazione dopo che è stato soddisfatto il primo set di criteri.</span><span class="sxs-lookup"><span data-stu-id="63bd5-138">COM+ recycles the application after the first of the set of criteria is satisfied.</span></span> <span data-ttu-id="63bd5-139">È possibile impostare il valore di timeout di scadenza per determinare per quanto tempo un processo Dllhost precedente può trascorrere il completamento delle richieste di servizio rimanenti prima di essere arrestato forzatamente.</span><span class="sxs-lookup"><span data-stu-id="63bd5-139">You can set the expiration time-out value to determine how long an old Dllhost process can spend completing remaining service requests before being forcibly shut down.</span></span>

<span data-ttu-id="63bd5-140">La raccolta [**ApplicationInstances**](applicationinstances.md) fornisce la proprietà HasRecycled, che fornisce un modo per determinare se l'applicazione è già stata riciclata.</span><span class="sxs-lookup"><span data-stu-id="63bd5-140">The [**ApplicationInstances**](applicationinstances.md) collection provides the HasRecycled property, which provides a way to determine whether the application has ever been recycled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="63bd5-141">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="63bd5-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="63bd5-142">Attività di riciclo delle applicazioni COM+</span><span class="sxs-lookup"><span data-stu-id="63bd5-142">COM+ Application Recycling Tasks</span></span>](com--application-recycling-tasks.md)
</dt> <dt>

[<span data-ttu-id="63bd5-143">**RecycleSurrogate**</span><span class="sxs-lookup"><span data-stu-id="63bd5-143">**RecycleSurrogate**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



