---
description: Rilevamento COM+
ms.assetid: ad3bdeb5-f303-411a-abfb-ccde3f9a86b9
title: Rilevamento COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 828cc87b5a24363fd814d37c29e61a3ce204d988
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104483061"
---
# <a name="com-tracking"></a><span data-ttu-id="0daf4-103">Rilevamento COM+</span><span class="sxs-lookup"><span data-stu-id="0daf4-103">COM+ Tracking</span></span>

<span data-ttu-id="0daf4-104">Il servizio di rilevamento COM+ consente di compilare programmi amministrativi e di diagnostica personalizzati che tengono traccia dello stato e delle prestazioni dell'esecuzione di applicazioni COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-104">The COM+ tracking service enables you to build your own administrative and diagnostic programs that track the status and performance of running COM+ applications.</span></span> <span data-ttu-id="0daf4-105">Il rilevamento COM+ fornisce informazioni statistiche sull'utilizzo delle applicazioni COM+, nonché informazioni sullo stato, ad esempio se un'istanza dell'applicazione server COM+ è sospesa o è stata riciclata.</span><span class="sxs-lookup"><span data-stu-id="0daf4-105">COM+ tracking provides statistical information about the use of COM+ applications as well as status information, such as whether a COM+ server application instance is paused or has been recycled.</span></span> <span data-ttu-id="0daf4-106">Gli strumenti possono utilizzare le informazioni di rilevamento nel monitoraggio diagnostico o a scopo di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="0daf4-106">Tools can use tracking information in diagnostic monitoring or for display purposes.</span></span> <span data-ttu-id="0daf4-107">Lo strumento di amministrazione Servizi componenti, ad esempio, utilizza il rilevamento COM+ per visualizzare lo stato delle istanze dell'applicazione COM+ nelle cartelle applicazioni COM+ e processi in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="0daf4-107">For example, the Component Services administrative tool uses COM+ tracking to display the status of COM+ application instances in the COM+ Applications and Running Processes folders.</span></span>

<span data-ttu-id="0daf4-108">Il rilevamento COM+ calcola e aggiorna periodicamente un set di metriche di uso comune, rendendo queste informazioni disponibili ai programmi che lo richiedono.</span><span class="sxs-lookup"><span data-stu-id="0daf4-108">COM+ tracking calculates and periodically updates a set of commonly-used metrics, making this information available to programs that need it.</span></span> <span data-ttu-id="0daf4-109">È simile alla strumentazione COM+ in quanto entrambi i servizi raccolgono automaticamente i dati dalle istanze dell'applicazione COM+ e rendono tali dati disponibili ai consumer.</span><span class="sxs-lookup"><span data-stu-id="0daf4-109">It is similar to COM+ Instrumentation in that both services automatically collect data from COM+ application instances and make this data available to consumers.</span></span> <span data-ttu-id="0daf4-110">Tuttavia, esistono alcune differenze importanti tra questi servizi, sia nella funzionalità fornita che nell'utilizzo tipico.</span><span class="sxs-lookup"><span data-stu-id="0daf4-110">However, there are some important differences between these services, both in the functionality provided and typical usage.</span></span> <span data-ttu-id="0daf4-111">Nella tabella seguente sono riepilogate queste differenze.</span><span class="sxs-lookup"><span data-stu-id="0daf4-111">The following table summarizes these differences.</span></span>



| <span data-ttu-id="0daf4-112">Strumentazione COM+</span><span class="sxs-lookup"><span data-stu-id="0daf4-112">COM+ Instrumentation</span></span>                                                                                                                                                                                                   | <span data-ttu-id="0daf4-113">Rilevamento COM+</span><span class="sxs-lookup"><span data-stu-id="0daf4-113">COM+ Tracking</span></span>                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0daf4-114">Dati con granularità fine.</span><span class="sxs-lookup"><span data-stu-id="0daf4-114">Fine-grained data.</span></span> <span data-ttu-id="0daf4-115">Il servizio di strumentazione COM+ invia una notifica ai sottoscrittori registrati dei singoli eventi discreti (ad esempio, metodo chiamato, oggetto distrutto) che si verificano in un'istanza dell'applicazione COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-115">The COM+ instrumentation service notifies registered subscribers of individual discrete events (for example, method called, object destroyed) that occur in a COM+ application instance.</span></span><br/> | <span data-ttu-id="0daf4-116">Dati aggregati.</span><span class="sxs-lookup"><span data-stu-id="0daf4-116">Aggregated data.</span></span> <span data-ttu-id="0daf4-117">Il rilevamento COM+ calcola e aggiorna periodicamente le metriche usate comunemente per lo stato e le prestazioni delle istanze di applicazioni COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-117">COM+ tracking calculates and periodically updates commonly-used metrics for the status and performance of COM+ application instances.</span></span><br/> |
| <span data-ttu-id="0daf4-118">I sottoscrittori di eventi in genere calcolano la metrica autonomamente, usando algoritmi e criteri ad hoc.</span><span class="sxs-lookup"><span data-stu-id="0daf4-118">Event subscribers typically calculate metrics on their own, using ad-hoc algorithms and policies.</span></span><br/>                                                                                                           | <span data-ttu-id="0daf4-119">Le metriche vengono calcolate automaticamente dal servizio di rilevamento COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-119">Metrics are calculated automatically by the COM+ tracking service.</span></span> <span data-ttu-id="0daf4-120">Tutti i consumer ottengono gli stessi dati, senza supporto per le metriche personalizzate.</span><span class="sxs-lookup"><span data-stu-id="0daf4-120">All consumers get the same data, with no support for custom metrics.</span></span><br/>                |
| <span data-ttu-id="0daf4-121">Dopo la registrazione di una sottoscrizione, il consumer non riceve alcuna informazione su un'istanza dell'applicazione COM+ fino a quando non si verifica un evento.</span><span class="sxs-lookup"><span data-stu-id="0daf4-121">After registering a subscription, the consumer does not receive any information about a COM+ application instance until an event occurs.</span></span><br/>                                                                    | <span data-ttu-id="0daf4-122">I dati di rilevamento per tutte le istanze dell'applicazione COM+ possono essere recuperati in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="0daf4-122">Tracking data for all COM+ application instances may be retrieved at any time.</span></span><br/>                                                                         |
| <span data-ttu-id="0daf4-123">Supporta solo un meccanismo di sottoscrizione basata su eventi COM+ per i consumer.</span><span class="sxs-lookup"><span data-stu-id="0daf4-123">Supports only a COM+ events-based subscription mechanism for consumers.</span></span><br/>                                                                                                                                     | <span data-ttu-id="0daf4-124">Supporta sia un meccanismo di sottoscrizione basato su eventi COM+ sia il polling su un'interfaccia server locale COM.</span><span class="sxs-lookup"><span data-stu-id="0daf4-124">Supports both a COM+ events-based subscription mechanism and polling on a COM local server interface.</span></span><br/>                                                  |
| <span data-ttu-id="0daf4-125">Esempio</span><span class="sxs-lookup"><span data-stu-id="0daf4-125">Examples</span></span>                                                                                                                                                                                                               |                                                                                                                                                                   |
| <span data-ttu-id="0daf4-126">Notifiche quando un metodo viene chiamato o restituisce.</span><span class="sxs-lookup"><span data-stu-id="0daf4-126">Notifications when a method is called or returns.</span></span><br/>                                                                                                                                                           | <span data-ttu-id="0daf4-127">Tempo medio di risposta delle chiamate, numero di chiamate al metodo che hanno avuto esito positivo o negativo in un periodo di tempo recente, numero di oggetti attualmente in una chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="0daf4-127">Average call response time, number of method calls that succeeded or failed in a recent time period, number of objects currently in a method call.</span></span><br/>     |
| <span data-ttu-id="0daf4-128">Notifiche quando un oggetto viene aggiunto o ottenuto dal pool di oggetti.</span><span class="sxs-lookup"><span data-stu-id="0daf4-128">Notifications when an object is added to or obtained from the object pool.</span></span><br/>                                                                                                                                  | <span data-ttu-id="0daf4-129">Numero di oggetti nel pool, numero totale di oggetti.</span><span class="sxs-lookup"><span data-stu-id="0daf4-129">Number of objects in the pool, total number of objects.</span></span><br/>                                                                                                |
| <span data-ttu-id="0daf4-130">Notifiche quando un'applicazione server COM+ viene avviata, sospesa o riciclata.</span><span class="sxs-lookup"><span data-stu-id="0daf4-130">Notifications when a COM+ server application is started, paused, or recycled.</span></span><br/>                                                                                                                               | <span data-ttu-id="0daf4-131">Stato del processo dell'applicazione server COM+, ad esempio se è in pausa o riciclato.</span><span class="sxs-lookup"><span data-stu-id="0daf4-131">Status of the COM+ server application process (for example, whether it is paused or recycled).</span></span><br/>                                                         |
| <span data-ttu-id="0daf4-132">Notifiche degli eventi di avvio, preparazione, interruzione e commit delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="0daf4-132">Notifications of transaction start, prepare, abort, and commit events.</span></span><br/>                                                                                                                                      | <span data-ttu-id="0daf4-133">Nessun equivalente.</span><span class="sxs-lookup"><span data-stu-id="0daf4-133">No equivalent.</span></span><br/>                                                                                                                                         |
| <span data-ttu-id="0daf4-134">Notifiche di tentativi di autenticazione a livello di chiamata al metodo riusciti e non riusciti.</span><span class="sxs-lookup"><span data-stu-id="0daf4-134">Notifications of successful and failed method call level authentication attempts.</span></span><br/>                                                                                                                           | <span data-ttu-id="0daf4-135">Nessun equivalente.</span><span class="sxs-lookup"><span data-stu-id="0daf4-135">No equivalent.</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="0daf4-136">Sebbene il rilevamento COM+ sia più limitato in termini di ambito dei dati e flessibilità per il calcolo delle metriche, le metriche fornite dovrebbero essere sufficienti per un'ampia gamma di programmi amministrativi e di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="0daf4-136">Although COM+ tracking is more limited in terms of data scope and flexibility for calculating metrics, the metrics it provides should be sufficient for a wide variety of administrative and diagnostic programs.</span></span> <span data-ttu-id="0daf4-137">L'utilizzo del rilevamento COM+, quando possibile, può semplificare la progettazione di questi programmi.</span><span class="sxs-lookup"><span data-stu-id="0daf4-137">Using COM+ tracking, when possible, can simplify the design of these programs.</span></span> <span data-ttu-id="0daf4-138">Inoltre, l'utilizzo del rilevamento COM+ nei sistemi di produzione può avere un notevole calo delle prestazioni, rendendolo più appropriato per gli strumenti di monitoraggio in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="0daf4-138">Additionally, using COM+ tracking in production systems can have a significantly lower performance impact, making it more appropriate for real-time monitoring tools.</span></span>

## <a name="how-com-tracking-collects-data"></a><span data-ttu-id="0daf4-139">Raccolta dei dati in rilevamento COM+</span><span class="sxs-lookup"><span data-stu-id="0daf4-139">How COM+ Tracking Collects Data</span></span>

<span data-ttu-id="0daf4-140">Quando viene avviato un processo dell'applicazione server COM+, COM+ registra il processo con il *server di rilevamento*, un componente dell'applicazione di sistema.</span><span class="sxs-lookup"><span data-stu-id="0daf4-140">When a COM+ server application process is started, COM+ registers the process with the *tracker server*, a component of the system application.</span></span> <span data-ttu-id="0daf4-141">I componenti in applicazioni della libreria COM+ e i contesti di servizi senza componenti (SWC) supportano anche il rilevamento.</span><span class="sxs-lookup"><span data-stu-id="0daf4-141">Components in COM+ library applications and services without components (SWC) contexts also support tracking.</span></span> <span data-ttu-id="0daf4-142">Quando un componente della libreria o un contesto SWC viene creato in un processo, COM+ registra il processo con il server di rilevamento se non è già stato registrato.</span><span class="sxs-lookup"><span data-stu-id="0daf4-142">When a library component or SWC context is created in a process, COM+ registers the process with the tracker server if it has not been registered already.</span></span>

<span data-ttu-id="0daf4-143">COM+ aggiorna le statistiche per un processo rilevato quando si verificano determinati eventi nel processo, ad esempio la creazione di un oggetto o il completamento di una chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="0daf4-143">COM+ updates statistics for a tracked process when certain events occur in the process, such as the creation of an object or the completion of a method call.</span></span> <span data-ttu-id="0daf4-144">I dati aggiornati vengono inviati periodicamente al server di rilevamento, a quel punto diventa disponibile per i consumer.</span><span class="sxs-lookup"><span data-stu-id="0daf4-144">Updated data is periodically submitted to the tracker server, at which point it becomes available to consumers.</span></span> <span data-ttu-id="0daf4-145">Il server di rilevamento è inoltre responsabile del calcolo di alcune delle metriche utilizzate dalle funzionalità di monitoraggio e blocco delle applicazioni COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-145">The tracker server is also responsible for calculating some of the metrics used by the COM+ application recycling and hang monitoring features.</span></span> <span data-ttu-id="0daf4-146">Questi dati sono disponibili anche per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="0daf4-146">This data is also available to consumers.</span></span>

<span data-ttu-id="0daf4-147">I dati di rilevamento sono organizzati in base al processo che ha generato i dati.</span><span class="sxs-lookup"><span data-stu-id="0daf4-147">Tracking data is organized according to the process that generated the data.</span></span> <span data-ttu-id="0daf4-148">I dati a livello di singole applicazioni o componenti COM+ del processo sono disponibili anche per gli utenti che necessitano di queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="0daf4-148">Data at the level of individual COM+ applications or components in the process is also available for consumers that need this information.</span></span>

## <a name="events-versus-polling"></a><span data-ttu-id="0daf4-149">Eventi e polling</span><span class="sxs-lookup"><span data-stu-id="0daf4-149">Events versus Polling</span></span>

<span data-ttu-id="0daf4-150">Il rilevamento COM+ supporta due meccanismi che consentono a un consumer di ottenere i dati di rilevamento dal server tracker, un meccanismo di sottoscrizione basato su eventi COM+ e un'interfaccia server locale COM.</span><span class="sxs-lookup"><span data-stu-id="0daf4-150">COM+ tracking supports two mechanisms for a consumer to obtain tracking data from the tracker server, a COM+ events-based subscription mechanism and a COM local server interface.</span></span>

<span data-ttu-id="0daf4-151">I programmi che devono essere notificati periodicamente con i dati di rilevamento aggiornati possono registrare una sottoscrizione per l'interfaccia eventi [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) .</span><span class="sxs-lookup"><span data-stu-id="0daf4-151">Programs that need to be notified periodically with updated tracking data can register a subscription for the [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) event interface.</span></span> <span data-ttu-id="0daf4-152">Approssimativamente ogni tre secondi, il server di rilevamento chiama il metodo [**IComTrackingInfoEvents:: OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) di ogni Sottoscrittore, inviando i dati di rilevamento più recenti sotto forma di oggetto raccolta.</span><span class="sxs-lookup"><span data-stu-id="0daf4-152">Roughly every three seconds, the tracker server calls each subscriber's [**IComTrackingInfoEvents::OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) method, sending the most recent tracking data in the form of a collection object.</span></span> <span data-ttu-id="0daf4-153">Questo oggetto implementa l'interfaccia [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) e i sottoscrittori possono esplorare questa raccolta per trovare i dati a cui sono interessati.</span><span class="sxs-lookup"><span data-stu-id="0daf4-153">This object implements the [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) interface, and subscribers can navigate this collection to find the data they are interested in.</span></span>

<span data-ttu-id="0daf4-154">Per diversi motivi, potrebbe essere opportuno che un programma esegua il polling del server di rilevamento per i dati.</span><span class="sxs-lookup"><span data-stu-id="0daf4-154">For various reasons, it might make more sense for a program to poll tracker server for data.</span></span> <span data-ttu-id="0daf4-155">Uno strumento di monitoraggio, ad esempio, potrebbe richiedere aggiornamenti con una frequenza molto inferiore rispetto a un programma che visualizza lo stato in un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="0daf4-155">For example, a monitoring tool may need updates much less frequently than a program that displays status in a user interface.</span></span> <span data-ttu-id="0daf4-156">Inoltre, un programma può utilizzare solo una piccola parte dei dati di rilevamento disponibili per il sistema. ad esempio, è possibile che uno strumento monitori solo le prestazioni delle istanze di una singola applicazione COM+.</span><span class="sxs-lookup"><span data-stu-id="0daf4-156">Also, a program may use only a small portion of the tracking data available for the system (for example, a tool might only monitor the performance of instances of a single COM+ application).</span></span> <span data-ttu-id="0daf4-157">Il modello di sottoscrizione Invia a ogni Sottoscrittore i dati di rilevamento per tutte le applicazioni COM+ in ogni notifica ed è responsabilità del Sottoscrittore individuare i dati desiderati.</span><span class="sxs-lookup"><span data-stu-id="0daf4-157">The subscription model sends each subscriber the tracking data for all COM+ applications in each notification, and it is the responsibility of the subscriber to find the data it wants.</span></span> <span data-ttu-id="0daf4-158">Infine, gli eventi COM+ sono un meccanismo di notifica degli eventi con il massimo sforzo.</span><span class="sxs-lookup"><span data-stu-id="0daf4-158">Finally, COM+ events is a best-effort event notification mechanism.</span></span> <span data-ttu-id="0daf4-159">I servizi di recapito dei messaggi affidabili non sono disponibili e non è possibile che un Sottoscrittore rilevi che il server di rilevamento non è stato in grado di inviare una notifica.</span><span class="sxs-lookup"><span data-stu-id="0daf4-159">Reliable message delivery services are not provided, and there is no way for a subscriber to detect that the tracker server failed to send it a notification.</span></span>

<span data-ttu-id="0daf4-160">Un programma che necessita di un maggiore controllo sul recupero dei dati di rilevamento può usare l'interfaccia [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) del server tracker.</span><span class="sxs-lookup"><span data-stu-id="0daf4-160">A program that needs greater control over its retrieval of tracking data can use the [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) interface of the tracker server.</span></span>

 

 




