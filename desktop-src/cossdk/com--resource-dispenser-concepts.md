---
description: I componenti dell'applicazione usano il dispenser di risorse COM+ per accedere e gestire informazioni sullo stato condivise e non durevoli, ad esempio le connessioni tra i componenti e un gestore di risorse specifico.
ms.assetid: 252c7180-61b1-485d-883d-36bf77357a29
title: Concetti relativi al dispenser di risorse COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f0fcf281d6d7b8ed0e087b6d77e4d686e28e1fa
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103748066"
---
# <a name="com-resource-dispenser-concepts"></a><span data-ttu-id="ba1b0-103">Concetti relativi al dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-103">COM+ Resource Dispenser Concepts</span></span>

<span data-ttu-id="ba1b0-104">I componenti dell'applicazione usano il dispenser di risorse COM+ per accedere e gestire informazioni sullo stato condivise e non durevoli, ad esempio le connessioni tra i componenti e un gestore di risorse specifico.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-104">Application components use the COM+ resource dispenser to access and manage shared, nondurable state information, such as connections between components and a given resource manager.</span></span> <span data-ttu-id="ba1b0-105">In fase di esecuzione, i pool dinamici di risorse, ad esempio le connessioni di database, le connessioni di rete, le connessioni a code, thread, oggetti e blocchi di memoria, vengono resi disponibili per il dispenser di risorse.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-105">At runtime, dynamic pools of resources, such as database connections, network connections, connections to queues, threads, objects, and memory blocks, are made available to the resource dispenser.</span></span> <span data-ttu-id="ba1b0-106">Il processo dell'applicazione consente di ottenere prestazioni elevate utilizzando un numero minimo di risorse utilizzate di frequente.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-106">The application process achieves high performance by using a minimum number of frequently used resources.</span></span> <span data-ttu-id="ba1b0-107">Il dispenser di risorse può anche automatizzare le transazioni e il recupero.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-107">The resource dispenser can also automate transactions and reclamation.</span></span> <span data-ttu-id="ba1b0-108">Per ulteriori informazioni su questa funzionalità, vedere [recupero automatico delle risorse](automatic-resource-reclamation.md) .</span><span class="sxs-lookup"><span data-stu-id="ba1b0-108">(See [Automatic Resource Reclamation](automatic-resource-reclamation.md) for more information about this feature.)</span></span>

> [!Note]  
> <span data-ttu-id="ba1b0-109">Una *risorsa* è un elemento creato da un dispenser di risorse.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-109">A *resource* is anything a resource dispenser creates.</span></span> <span data-ttu-id="ba1b0-110">Una connessione a un gestore di risorse, ad esempio, è una risorsa comune.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-110">For example, a connection to a resource manager is a common resource.</span></span> <span data-ttu-id="ba1b0-111">Le risorse si trovano nella memoria del dispenser di risorse e non vengono mai copiate nel gestore di dispenser.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-111">Resources reside in the resource dispenser's memory and are never copied to the dispenser manager.</span></span> <span data-ttu-id="ba1b0-112">Una risorsa è nota solo da un handle opaco (**da un Resid**) e può o non essere in grado di eseguire transazioni.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-112">A resource is known only by an opaque handle (**RESID**) and may or may not be capable of performing transactions.</span></span> <span data-ttu-id="ba1b0-113">Sebbene le risorse gestite siano spesso connessioni a un componente che gestisce uno stato durevole, le connessioni stesse non sono durevoli.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-113">Although the resources managed might often be connections to a component managing a durable state, the connections themselves are not durable.</span></span> <span data-ttu-id="ba1b0-114">Un dispenser di risorse usa spesso un gestore di risorse correlato per mantenere lo stato durevole.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-114">A resource dispenser often uses a related resource manager to retain the durable state.</span></span>

 

<span data-ttu-id="ba1b0-115">In architettura, il sistema di dispenser di risorse COM+ è costituito da distributori di risorse e da un responsabile del dispenser.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-115">Architecturally, the COM+ resource dispenser system consists of resource dispensers and a dispenser manager.</span></span> <span data-ttu-id="ba1b0-116">I distributori di risorse sono componenti forniti dall'utente che forniscono applicazioni con interfacce semplici per le risorse condivise.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-116">Resource dispensers are user-supplied components that provide applications with simple interfaces to shared resources.</span></span> <span data-ttu-id="ba1b0-117">Il gestore di dispenser è un componente fornito da COM+ che coordina le attività dei diversi dispenser di risorse.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-117">The dispenser manager is a component provided by COM+ that coordinates the activities of the various resource dispensers.</span></span>

<span data-ttu-id="ba1b0-118">Un dispenser di risorse è un componente libreria a collegamento dinamico (DLL) che fornisce almeno due interfacce.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-118">A resource dispenser is a dynamic-link library (DLL) component that provides at least two interfaces.</span></span> <span data-ttu-id="ba1b0-119">Il primo, [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver), fornisce al responsabile del dispenser le informazioni di base su come creare, eliminare e integrare le risorse gestite.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-119">The first, [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver), provides the dispenser manager with basic information on how to create, destroy, and enlist the resources it manages.</span></span> <span data-ttu-id="ba1b0-120">Il secondo è esposto alle applicazioni e può essere un'interfaccia COM o un set di interfacce oppure può essere un Application Programming Interface (API) a cui un componente è collegato tramite una libreria di importazione.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-120">The second is exposed to the applications and can be a COM interface or set of interfaces or can be an application programming interface (API) to which a component is linked via an import library.</span></span> <span data-ttu-id="ba1b0-121">Un'applicazione può chiamare qualsiasi dispenser di risorse, che a sua volta può offrire qualsiasi API all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-121">An application can call any resource dispenser, which in turn may offer any API to the application.</span></span> <span data-ttu-id="ba1b0-122">Se il dispenser di risorse è un componente di automazione, è possibile accedervi da Microsoft Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-122">If the resource dispenser is an Automation component, it can be accessed from Microsoft Visual Basic.</span></span> <span data-ttu-id="ba1b0-123">Viene creata un'istanza di un dispenser di risorse quando si fa riferimento a un componente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-123">A resource dispenser is instantiated when an application component refers to it.</span></span>

<span data-ttu-id="ba1b0-124">Il gestore di dispenser fornito da COM+ tiene traccia dei distributori di risorse e delle coordinate tra di essi.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-124">The dispenser manager provided by COM+ tracks resource dispensers and coordinates among them.</span></span> <span data-ttu-id="ba1b0-125">Implementa due interfacce: [**IDispenserManager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) e [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-125">It implements two interfaces: [**IDispenserManager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) and [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span> <span data-ttu-id="ba1b0-126">i dispenser di risorse si registrano usando l'interfaccia **IDispenserManager** .</span><span class="sxs-lookup"><span data-stu-id="ba1b0-126">resource dispensers register themselves using the **IDispenserManager** interface.</span></span> <span data-ttu-id="ba1b0-127">Il gestore del dispenser fornisce quindi un puntatore a un **IHolder** che usa per notificare al responsabile del dispenser le proprie attività.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-127">The dispenser manager then gives them a pointer to an **IHolder** that they use to notify the dispenser manager of their activities.</span></span>

<span data-ttu-id="ba1b0-128">Un dispenser di risorse transazionali deve essere integrato in una transazione Distributed Transaction Coordinator (DTC).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-128">A transactional resource dispenser must enlist in a Distributed Transaction Coordinator (DTC) transaction.</span></span> <span data-ttu-id="ba1b0-129">Ciò implica l'uso di un gestore di risorse interno o esterno (per il dispenser di risorse), che è conforme alle transazioni OLE.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-129">This implies use of either an internal or an external (to the resource dispenser) resource manager that is OLE transactions-compliant.</span></span>

> [!Note]  
> <span data-ttu-id="ba1b0-130">Nel modello di programmazione COM+ sono incluse *transazioni dichiarative*, che consentono di proteggere il lavoro eseguito da un oggetto applicazione durante la relativa durata.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-130">The COM+ programming model includes *declarative transactions*, which help protect the work performed by an application object during its lifetime.</span></span> <span data-ttu-id="ba1b0-131">Quando un oggetto applicazione usa un dispenser di risorse COM+, il lavoro che esegue è automaticamente transazionale. ovvero, il componente non deve dichiarare in modo esplicito le transazioni.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-131">When an application object uses a COM+ resource dispenser, the work it performs is automatically transactional; that is, the component doesn't have to explicitly declare transactions.</span></span> <span data-ttu-id="ba1b0-132">Queste transazioni sono definite nella specifica delle transazioni OLE, implementate dal DTC e avviate per conto dell'oggetto applicazione da COM+.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-132">These transactions are defined in the OLE Transactions specification, implemented by the DTC, and initiated on behalf of the application object by COM+.</span></span> <span data-ttu-id="ba1b0-133">Per ulteriori informazioni, vedere la Guida allo sviluppo di DTC.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-133">See the DTC Development Guide for more information.</span></span>

 

<span data-ttu-id="ba1b0-134">Le risorse non devono essere transazionali.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-134">Resources need not be transactional.</span></span> <span data-ttu-id="ba1b0-135">Un dispenser di risorse che consente di creare un pool di risorse non transazionali può comunque ottenere prestazioni elevate consentendo agli oggetti dell'applicazione di accedere a un pool condiviso di queste risorse.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-135">A resource dispenser that pools non-transactional resources can still achieve high performance by allowing application objects to access a shared pool of these resources.</span></span> <span data-ttu-id="ba1b0-136">Questo tipo di dispenser di risorse restituisce \_ false dal metodo [**IDispenserDriver:: EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) , il che significa che il dispenser di risorse non ha integrato la risorsa perché la risorsa non è transazionale.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-136">This type of resource dispenser returns S\_FALSE from the [**IDispenserDriver::EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method, which means that the resource dispenser did not enlist the resource because the resource is not transactional.</span></span>

<span data-ttu-id="ba1b0-137">Il dispenser di risorse può anche funzionare indipendentemente da COM+, fornendo solo le funzionalità di pooling delle risorse.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-137">The resource dispenser can also function independently of COM+, providing only resource pooling capabilities.</span></span> <span data-ttu-id="ba1b0-138">Se, ad esempio, un dispenser di risorse espone un'API, ad esempio ODBC, il dispenser di risorse potrebbe essere una DLL a cui l'applicazione accede tramite una libreria di importazione (oppure usando le funzioni [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) e [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) ).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-138">For example, if a resource dispenser exposes an API (such as ODBC), the resource dispenser might be a DLL that is accessed by the application through an import library (or using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) functions).</span></span> <span data-ttu-id="ba1b0-139">Un dispenser di risorse può anche essere un componente COM a cui un'applicazione accede chiamando [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-139">A resource dispenser might also be a COM component that an application accesses by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span> <span data-ttu-id="ba1b0-140">Senza COM+, il metodo [**EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) di un dispenser di risorse non può mai essere chiamato perché il gestore del dispenser non conosce la transazione del componente corrente.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-140">Without COM+, a resource dispenser's [**EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method can never be called because the dispenser manager has no knowledge of the current component transaction.</span></span>

<span data-ttu-id="ba1b0-141">All'avvio, la DLL di un dispenser di risorse deve registrarsi con il gestore dispenser.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-141">On startup, a resource dispenser DLL must register itself with the dispenser manager.</span></span> <span data-ttu-id="ba1b0-142">Il responsabile del dispenser è il dirigente di controllo che gestisce il caricamento e lo scaricamento di dispenser di risorse, fornisce il contesto COM+ e controlla la gestione delle statistiche di inventario.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-142">The dispenser manager is the controlling executive that manages the loading and unloading of resource dispensers, provides the COM+ context, and controls the inventory statistics manager.</span></span> <span data-ttu-id="ba1b0-143">Per ulteriori informazioni, vedere [com+ dispenser Manager](com--dispenser-manager.md). Il dispenser di risorse chiama prima la funzione [**GetDispenserManager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) e quindi chiama il metodo [**IDispenserManager:: RegisterDispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) , passando il puntatore [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) che il dispenser di risorse implementa.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-143">(For more information, see [COM+ Dispenser Manager](com--dispenser-manager.md).) The resource dispenser first calls the [**GetDispenserManager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) function and then calls the [**IDispenserManager::RegisterDispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) method, passing the [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) pointer that the resource dispenser implements.</span></span> <span data-ttu-id="ba1b0-144">Questa chiamata restituisce un riferimento a [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-144">This call returns a reference to [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span>

<span data-ttu-id="ba1b0-145">Per arrestare, un dispenser di risorse chiama [**IHolder:: Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close).</span><span class="sxs-lookup"><span data-stu-id="ba1b0-145">To shut down, a resource dispenser calls [**IHolder::Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close).</span></span> <span data-ttu-id="ba1b0-146">Per garantire l'arresto di un pacchetto pulito, un dispenser di risorse deve essere in grado di gestire la situazione in cui le chiamate continuano a provenire dagli oggetti business dopo che COM+ ha richiesto l'arresto del dispenser.</span><span class="sxs-lookup"><span data-stu-id="ba1b0-146">To ensure a clean package shutdown, a resource dispenser must be able to handle the situation when calls continue to arrive from business objects after COM+ has asked the dispenser to shut down.</span></span>

<span data-ttu-id="ba1b0-147">Negli argomenti seguenti di questa sezione vengono fornite informazioni più dettagliate sul servizio di dispenser di risorse COM+:</span><span class="sxs-lookup"><span data-stu-id="ba1b0-147">The following topics in this section provide more detailed information about the COM+ resource dispenser service:</span></span>

-   [<span data-ttu-id="ba1b0-148">Gestore di distribuzioni COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-148">COM+ Dispenser Manager</span></span>](com--dispenser-manager.md)
-   [<span data-ttu-id="ba1b0-149">Tipi di thread del dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-149">COM+ Resource Dispenser Thread Types</span></span>](com--resource-dispenser-thread-types.md)
-   [<span data-ttu-id="ba1b0-150">Stati risorse in pool disponibili per il dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-150">Pooled Resource States Available to COM+ Resource Dispenser</span></span>](pooled-resource-states-available-to-com--resource-dispenser.md)
-   [<span data-ttu-id="ba1b0-151">Integrazione di una risorsa in una transazione</span><span class="sxs-lookup"><span data-stu-id="ba1b0-151">Enlisting a Resource in a Transaction</span></span>](enlisting-a-resource-in-a-transaction.md)
-   [<span data-ttu-id="ba1b0-152">Processo di allocazione delle risorse del dispenser di risorse</span><span class="sxs-lookup"><span data-stu-id="ba1b0-152">Resource Dispenser Resource Allocation Process</span></span>](resource-dispenser-resource-allocation-process.md)
-   [<span data-ttu-id="ba1b0-153">Rilevamento di risorse non allocate</span><span class="sxs-lookup"><span data-stu-id="ba1b0-153">Tracking Non-Allocated Resources</span></span>](tracking-non-allocated-resources.md)
-   [<span data-ttu-id="ba1b0-154">Recupero automatico delle risorse</span><span class="sxs-lookup"><span data-stu-id="ba1b0-154">Automatic Resource Reclamation</span></span>](automatic-resource-reclamation.md)
-   [<span data-ttu-id="ba1b0-155">Tipi utilizzati nelle interfacce del dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-155">Types Used in COM+ Resource Dispenser Interfaces</span></span>](types-used-in-com--resource-dispenser-interfaces.md)
-   [<span data-ttu-id="ba1b0-156">Interfacce del dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-156">COM+ Resource Dispenser Interfaces</span></span>](com--resource-dispenser-interfaces.md)

## <a name="related-topics"></a><span data-ttu-id="ba1b0-157">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="ba1b0-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ba1b0-158">Attività del dispenser di risorse COM+</span><span class="sxs-lookup"><span data-stu-id="ba1b0-158">COM+ Resource Dispenser Tasks</span></span>](com--resource-dispenser-tasks.md)
</dt> </dl>

 

 
