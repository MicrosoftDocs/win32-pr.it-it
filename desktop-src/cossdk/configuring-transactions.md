---
description: L'attributo Transaction è una proprietà dichiarativa che gestisce automaticamente le transazioni per lo sviluppatore di componenti. Impostando questo attributo, si elimina la necessità di utilizzare controlli di transazione espliciti nel componente.
ms.assetid: ea0e4d7e-2598-4a42-993c-58815f2fa138
title: Configurazione di transazioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b57f27d47836193dc5d23c44e3344cb2a81d5984
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2021
ms.locfileid: "104554564"
---
# <a name="configuring-transactions"></a><span data-ttu-id="8d9ba-104">Configurazione di transazioni</span><span class="sxs-lookup"><span data-stu-id="8d9ba-104">Configuring Transactions</span></span>

<span data-ttu-id="8d9ba-105">L' *attributo Transaction* è una proprietà dichiarativa che gestisce automaticamente le transazioni per lo sviluppatore di componenti.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-105">The *transaction attribute* is a declarative property that automatically manages transactions for the component developer.</span></span> <span data-ttu-id="8d9ba-106">Impostando questo attributo, si elimina la necessità di utilizzare controlli di transazione espliciti nel componente.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-106">By setting this attribute, you eliminate the need to use explicit transaction controls in your component.</span></span>

<span data-ttu-id="8d9ba-107">COM+ utilizza l'attributo Transaction del componente per determinare il tipo di protezione delle transazioni richiesto per ogni oggetto attivato.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-107">COM+ uses the component's transaction attribute to determine the type of transaction protection required for each object it activates.</span></span> <span data-ttu-id="8d9ba-108">A seconda del requisito, un oggetto può condividere la transazione del chiamante, richiedere una nuova transazione o operare senza la protezione delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-108">Depending on its requirement, an object can share its caller's transaction, require a new transaction, or operate without transaction protection.</span></span>

<span data-ttu-id="8d9ba-109">COM+ fornisce i seguenti valori di attributo di transazione:</span><span class="sxs-lookup"><span data-stu-id="8d9ba-109">COM+ provides the following transaction attribute values:</span></span>

<dl> <dt>

<span data-ttu-id="8d9ba-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Disabilitato</span><span class="sxs-lookup"><span data-stu-id="8d9ba-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Disabled</span></span>
</dt> <dd>

<span data-ttu-id="8d9ba-111">In generale, è consigliabile impostare questo valore di attributo solo quando si è certi che il componente non acceda mai a Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-111">In general, you should set this attribute value only when you are sure that the component never accesses a resource manager.</span></span> <span data-ttu-id="8d9ba-112">Quando si disabilita l'attributo Transaction, COM+ ignora i requisiti transazionali del componente nella determinazione del posizionamento del contesto dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-112">When you disable the transaction attribute, COM+ ignores the transactional requirements of the component in determining context placement of the object.</span></span> <span data-ttu-id="8d9ba-113">Di conseguenza, l'oggetto può condividere il contesto del chiamante (e la transazione).</span><span class="sxs-lookup"><span data-stu-id="8d9ba-113">As a result, the object can share its caller's context (and transaction).</span></span> <span data-ttu-id="8d9ba-114">Quando si esegue la migrazione di un componente COM a COM+, è necessario disabilitare l'attributo Transaction per mantenere lo stesso comportamento transazionale del componente COM non configurato.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-114">When migrating a COM component to COM+, you must disable the transaction attribute to maintain the same transactional behavior as the unconfigured COM component.</span></span>

> [!Note]  
> <span data-ttu-id="8d9ba-115">Un *componente non configurato* è un componente COM che non è stato installato in un'applicazione com+.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-115">An *unconfigured component* is a COM component that has not been installed in a COM+ application.</span></span>

 

</dd> <dt>

<span data-ttu-id="8d9ba-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Non supportato</span><span class="sxs-lookup"><span data-stu-id="8d9ba-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Not Supported</span></span>
</dt> <dd>

<span data-ttu-id="8d9ba-117">Quando si imposta questo valore di attributo, COM+ garantisce che tutti gli oggetti creati dal componente non partecipino mai a una transazione, indipendentemente dallo stato transazionale del chiamante.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-117">When you set this attribute value, COM+ ensures that any object created from the component never participates in a transaction, regardless of the transactional status of its caller.</span></span> <span data-ttu-id="8d9ba-118">Dichiarando questo valore, si garantisce che un oggetto non voti nella transazione del chiamante né può iniziare una transazione autonomamente.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-118">By declaring this value, you ensure that an object does not vote in its caller's transaction nor can it begin a transaction of its own.</span></span> <span data-ttu-id="8d9ba-119">Il valore predefinito per tutti i componenti non è supportato.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-119">Not Supported is the default value for all components.</span></span>

</dd> <dt>

<span data-ttu-id="8d9ba-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Supportato</span><span class="sxs-lookup"><span data-stu-id="8d9ba-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Supported</span></span>
</dt> <dd>

<span data-ttu-id="8d9ba-121">Quando si imposta questo valore di attributo, COM+ garantisce che tutti gli oggetti creati dal componente partecipino a una transazione, se ne esiste una.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-121">When you set this attribute value, COM+ ensures that any object created from the component participates in a transaction if one exists.</span></span> <span data-ttu-id="8d9ba-122">Questo valore viene dichiarato quando si desidera che un oggetto condivida la transazione del chiamante senza che sia necessaria una transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-122">You declare this value when you want an object to share in its caller's transaction without requiring a transaction of its own.</span></span>

</dd> <dt>

<span data-ttu-id="8d9ba-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Obbligatorio</span><span class="sxs-lookup"><span data-stu-id="8d9ba-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Required</span></span>
</dt> <dd>

<span data-ttu-id="8d9ba-124">Quando si imposta questo valore di attributo, COM+ garantisce che tutti gli oggetti creati dal componente siano transazionali.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-124">When you set this attribute value, COM+ ensures that any object created from the component is transactional.</span></span> <span data-ttu-id="8d9ba-125">Quando COM+ attiva un oggetto con l'impostazione obbligatoria, esamina lo stato transazionale del chiamante.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-125">When COM+ activates an object with the Required setting, it looks at the transactional status of its caller.</span></span> <span data-ttu-id="8d9ba-126">Se il chiamante dispone di una transazione, il nuovo oggetto verrà incluso nella transazione corrente.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-126">If the caller has a transaction, the new object is included in the current transaction.</span></span> <span data-ttu-id="8d9ba-127">In caso contrario, COM+ inizia una transazione, rendendo il nuovo oggetto la radice della transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-127">Otherwise, COM+ begins a transaction, making the new object the root of the transaction.</span></span> <span data-ttu-id="8d9ba-128">Si tratta dell'impostazione preferita per un componente che esegue attività di risorse, in quanto consente di garantire la protezione delle transazioni per tali attività.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-128">This is the preferred setting for a component that performs resource activities because it helps provide transaction protection for those activities.</span></span>

</dd> <dt>

<span data-ttu-id="8d9ba-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Richiede nuovo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Requires New</span></span>
</dt> <dd>

<span data-ttu-id="8d9ba-130">Quando si imposta questo valore di attributo, COM+ garantisce che tutti gli oggetti creati dal componente debbano partecipare a una nuova transazione come radice della transazione, indipendentemente dallo stato transazionale del chiamante.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-130">When you set this attribute value, COM+ ensures that any objects created from the component must participate in a new transaction as the root of the transaction, regardless of the transactional status of the caller.</span></span> <span data-ttu-id="8d9ba-131">COM+ avvia automaticamente una nuova transazione che è diversa dalla transazione del chiamante.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-131">COM+ automatically initiates a new transaction that is distinct from the caller's transaction.</span></span>

> [!Note]  
> <span data-ttu-id="8d9ba-132">COM+ non supporta le transazioni nidificate.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-132">COM+ does not support nested transactions.</span></span> <span data-ttu-id="8d9ba-133">Quando un oggetto transazionale chiama un altro componente contrassegnato come requires New, COM+ crea un limite transazionale indipendente per l'oggetto appena attivato.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-133">When one transactional object calls another component marked as Requires New, COM+ creates an independent transactional boundary for the newly activated object.</span></span> <span data-ttu-id="8d9ba-134">La seconda transazione non può influire sulla prima transazione, a meno che la prima transazione non specifichi in modo esplicito i risultati della seconda transazione e modifichi il voto in base a tali risultati.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-134">The second transaction cannot affect the first transaction unless the first transaction explicitly notes the results of the second transaction and modifies its vote based on those results.</span></span>

 

</dd> </dl>

## <a name="transaction-attribute-dependencies"></a><span data-ttu-id="8d9ba-135">Dipendenze degli attributi di transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-135">Transaction Attribute Dependencies</span></span>

<span data-ttu-id="8d9ba-136">Nella tabella seguente sono illustrate le caratteristiche di ogni valore di attributo di transazione COM+, incluso l'effetto del valore sulle caratteristiche della transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-136">The following table shows the characteristics of each COM+ transaction attribute value, including the value's effect on transaction characteristics.</span></span> <span data-ttu-id="8d9ba-137">COM+ impone l'attivazione e la [sincronizzazione](com--synchronization.md) [JIT](com--just-in-time-activation.md) per tutti i componenti della transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-137">COM+ enforces [JIT activation](com--just-in-time-activation.md) and [Synchronization](com--synchronization.md) for all transaction components.</span></span>



| <span data-ttu-id="8d9ba-138">Valore dell'attributo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-138">Attribute Value</span></span>          | <span data-ttu-id="8d9ba-139">Nuova transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-139">New Transaction</span></span>   | <span data-ttu-id="8d9ba-140">Transazione del client</span><span class="sxs-lookup"><span data-stu-id="8d9ba-140">Client's Transaction</span></span>                 | <span data-ttu-id="8d9ba-141">Radice transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-141">Transaction Root</span></span>                        | <span data-ttu-id="8d9ba-142">Attivazione JIT</span><span class="sxs-lookup"><span data-stu-id="8d9ba-142">JIT Activation</span></span>      | <span data-ttu-id="8d9ba-143">Sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-143">Synchronization</span></span>     |
|--------------------------|-------------------|--------------------------------------|-----------------------------------------|---------------------|---------------------|
| <span data-ttu-id="8d9ba-144">Disabled</span><span class="sxs-lookup"><span data-stu-id="8d9ba-144">Disabled</span></span><br/>      | <span data-ttu-id="8d9ba-145">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-145">Never</span></span><br/>  | <span data-ttu-id="8d9ba-146">È possibile</span><span class="sxs-lookup"><span data-stu-id="8d9ba-146">Maybe</span></span><br/>                     | <span data-ttu-id="8d9ba-147">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-147">Never</span></span><br/>                        | <span data-ttu-id="8d9ba-148">Facoltativo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-148">Optional</span></span><br/> | <span data-ttu-id="8d9ba-149">Facoltativo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-149">Optional</span></span><br/> |
| <span data-ttu-id="8d9ba-150">Non supportato</span><span class="sxs-lookup"><span data-stu-id="8d9ba-150">Not Supported</span></span><br/> | <span data-ttu-id="8d9ba-151">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-151">Never</span></span><br/>  | <span data-ttu-id="8d9ba-152">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-152">Never</span></span><br/>                     | <span data-ttu-id="8d9ba-153">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-153">Never</span></span><br/>                        | <span data-ttu-id="8d9ba-154">Facoltativo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-154">Optional</span></span><br/> | <span data-ttu-id="8d9ba-155">Facoltativo</span><span class="sxs-lookup"><span data-stu-id="8d9ba-155">Optional</span></span><br/> |
| <span data-ttu-id="8d9ba-156">Supportato</span><span class="sxs-lookup"><span data-stu-id="8d9ba-156">Supported</span></span><br/>     | <span data-ttu-id="8d9ba-157">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-157">Never</span></span><br/>  | <span data-ttu-id="8d9ba-158">Se il client ha una transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-158">If client has transaction</span></span><br/> | <span data-ttu-id="8d9ba-159">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-159">Never</span></span><br/>                        | <span data-ttu-id="8d9ba-160">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-160">Required</span></span><br/> | <span data-ttu-id="8d9ba-161">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-161">Required</span></span><br/> |
| <span data-ttu-id="8d9ba-162">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-162">Required</span></span><br/>      | <span data-ttu-id="8d9ba-163">È possibile</span><span class="sxs-lookup"><span data-stu-id="8d9ba-163">Maybe</span></span><br/>  | <span data-ttu-id="8d9ba-164">Se il client ha una transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-164">If client has transaction</span></span><br/> | <span data-ttu-id="8d9ba-165">Se il client non dispone di alcuna transazione</span><span class="sxs-lookup"><span data-stu-id="8d9ba-165">If client has no transaction</span></span><br/> | <span data-ttu-id="8d9ba-166">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-166">Required</span></span><br/> | <span data-ttu-id="8d9ba-167">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-167">Required</span></span><br/> |
| <span data-ttu-id="8d9ba-168">RequiresNew</span><span class="sxs-lookup"><span data-stu-id="8d9ba-168">Requires New</span></span><br/>  | <span data-ttu-id="8d9ba-169">Always</span><span class="sxs-lookup"><span data-stu-id="8d9ba-169">Always</span></span><br/> | <span data-ttu-id="8d9ba-170">Mai</span><span class="sxs-lookup"><span data-stu-id="8d9ba-170">Never</span></span><br/>                     | <span data-ttu-id="8d9ba-171">Always</span><span class="sxs-lookup"><span data-stu-id="8d9ba-171">Always</span></span><br/>                       | <span data-ttu-id="8d9ba-172">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-172">Required</span></span><br/> | <span data-ttu-id="8d9ba-173">Obbligatoria</span><span class="sxs-lookup"><span data-stu-id="8d9ba-173">Required</span></span><br/> |



 

## <a name="transaction-boundaries"></a><span data-ttu-id="8d9ba-174">Limiti delle transazioni</span><span class="sxs-lookup"><span data-stu-id="8d9ba-174">Transaction Boundaries</span></span>

<span data-ttu-id="8d9ba-175">Una transazione ha un inizio, un'entità finale e si verifica esattamente una volta.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-175">A transaction has a beginning, an end, and occurs exactly once.</span></span> <span data-ttu-id="8d9ba-176">Durante l'esecuzione, una transazione può chiamare su una risorsa, ad esempio un database o una coda, per eseguire una o più attività.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-176">During its execution, a transaction may call on a resource, such as a database or queue, to accomplish one or more tasks.</span></span> <span data-ttu-id="8d9ba-177">Ogni risorsa rientra nel *limite della transazione*.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-177">Each resource falls within the *transaction boundary*.</span></span> <span data-ttu-id="8d9ba-178">Tutte le risorse all'interno di un limite di transazione, che può estendersi su più limiti di processi e computer, condividono una singola transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-178">All resources within a transaction boundary, which can span multiple process and computer boundaries, share a single transaction.</span></span> <span data-ttu-id="8d9ba-179">È importante gestire la coerenza tra questi limiti di processo e computer.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-179">Managing consistency across these process and computer boundaries is important.</span></span>

<span data-ttu-id="8d9ba-180">COM+ garantisce la coerenza gestendo automaticamente i limiti delle transazioni, in base al valore dell'attributo di transazione impostato per ogni componente.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-180">COM+ ensures consistency by managing transaction boundaries automatically, based on the value of the transaction attribute that you set for each component.</span></span> <span data-ttu-id="8d9ba-181">Una transazione COM+ passa automaticamente agli oggetti a cui è stato richiesto di partecipare a una transazione e ignora gli oggetti a cui è stato richiesto di eseguire all'esterno di una transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-181">A COM+ transaction automatically flows to objects instructed to participate in a transaction and bypasses objects instructed to execute outside a transaction.</span></span> <span data-ttu-id="8d9ba-182">COM+ non supporta le transazioni nidificate.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-182">COM+ does not support nested transactions.</span></span> <span data-ttu-id="8d9ba-183">Al contrario, le transazioni COM+ sono distinte e di breve durata.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-183">Instead, COM+ transactions are distinct and short-lived.</span></span>

<span data-ttu-id="8d9ba-184">Il primo oggetto in un limite di transazione è speciale per la transazione e viene chiamato *oggetto radice* della transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-184">The first object in a transaction boundary is special to the transaction and is called the *root object* of the transaction.</span></span> <span data-ttu-id="8d9ba-185">In una transazione può essere presente un solo oggetto radice.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-185">There can be only one root object in a transaction.</span></span> <span data-ttu-id="8d9ba-186">Tutti gli altri oggetti nella gerarchia transazionale sotto l'oggetto radice sono detti *oggetti interni*.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-186">All other objects in the transactional hierarchy under the root object are called *interior objects*.</span></span>

## <a name="mapping-transactions"></a><span data-ttu-id="8d9ba-187">Transazioni di mapping</span><span class="sxs-lookup"><span data-stu-id="8d9ba-187">Mapping Transactions</span></span>

<span data-ttu-id="8d9ba-188">Un modo per garantire che un oggetto sia incluso nel limite di transazioni corretto consiste nel mappare le transazioni prima di iniziare a scrivere i componenti.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-188">One way to ensure that an object is included in the correct transaction boundary is to map your transactions before you start writing your components.</span></span> <span data-ttu-id="8d9ba-189">Eseguendo il mapping delle transazioni, è possibile determinare l'impostazione migliore per ogni componente che si scrive.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-189">By mapping transactions, you can determine the best setting for each component you write.</span></span> <span data-ttu-id="8d9ba-190">Maggiore è il modo in cui vengono usati i componenti, più è semplice selezionare il valore corretto dell'attributo Transaction.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-190">The more certain you are about how your components are to be used, the easier it is to select the correct transaction attribute value.</span></span>

<span data-ttu-id="8d9ba-191">In fase di esecuzione, COM+ esamina l'attributo Transaction per determinare se un oggetto deve essere la radice di una nuova transazione, essere creato in una transazione esistente o essere creato come oggetto non transazionale.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-191">At run time, COM+ looks at the transaction attribute to determine whether an object should be the root of a new transaction, be created in an existing transaction, or be created as a non-transactional object.</span></span>

<span data-ttu-id="8d9ba-192">Nella figura seguente viene illustrato un possibile mapping delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-192">The following illustration shows a possible transaction mapping.</span></span> <span data-ttu-id="8d9ba-193">Nell'illustrazione, il client crea l'oggetto 1, che richiede una transazione.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-193">In the illustration, the client creates Object  1, which requires a transaction.</span></span> <span data-ttu-id="8d9ba-194">Poiché non esiste alcuna transazione, COM+ crea la transazione 1 e inserisce l'oggetto 1 come oggetto radice.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-194">Because no transaction exists, COM+ creates Transaction 1 and places Object 1 in it as the root object.</span></span> <span data-ttu-id="8d9ba-195">L'oggetto 1 crea l'oggetto 2, che supporta le transazioni e pertanto viene inserito nella transazione 1.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-195">Object 1 creates Object 2, which supports transactions and is therefore placed in Transaction 1.</span></span> <span data-ttu-id="8d9ba-196">L'oggetto 2 crea l'oggetto 3, che non supporta le transazioni e pertanto viene inserito all'esterno di tutte le transazioni.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-196">Object 2 creates Object 3, which does not support transactions and therefore is placed outside all transactions.</span></span> <span data-ttu-id="8d9ba-197">Nell'oggetto 2 viene inoltre creato l'oggetto 4, che richiede una transazione ed è quindi inserito nella transazione 1.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-197">Object 2 also creates Object 4, which requires a transaction and is therefore placed in Transaction  1.</span></span> <span data-ttu-id="8d9ba-198">L'oggetto 3 crea l'oggetto 5 che supporta le transazioni.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-198">Object 3 creates Object 5, which supports transactions.</span></span> <span data-ttu-id="8d9ba-199">Tuttavia, poiché l'oggetto 5 viene creato da un oggetto che non esiste all'interno di una transazione, viene inserito anche al di fuori di tutte le transazioni.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-199">However, because Object 5 is created by an object that does not exist within a transaction, it also is placed outside all transactions.</span></span> <span data-ttu-id="8d9ba-200">L'oggetto 4 crea l'oggetto 6, che richiede una nuova transazione, quindi COM+ crea la transazione 2 e inserisce l'oggetto 6 come oggetto radice.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-200">Object 4 creates Object 6, which requires a new transaction, so COM+ creates Transaction 2 and places Object 6 in it as the root object.</span></span> <span data-ttu-id="8d9ba-201">L'oggetto 6 crea l'oggetto 7, che supporta le transazioni, quindi viene inserito nella transazione 2.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-201">Object 6 creates Object 7, which supports transactions and is therefore placed in Transaction 2.</span></span>

![Diagramma che mostra un'interazione del client con la transazione 1 e la transazione 2.](images/fc7e2d03-94c2-40d9-a79b-1e05ca31dd80.png)

<span data-ttu-id="8d9ba-203">Nella figura precedente vengono illustrate due potenziali aree problematiche.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-203">The preceding illustration shows two potential problem areas.</span></span> <span data-ttu-id="8d9ba-204">In primo luogo, la maggior parte del lavoro viene suddivisa tra due transazioni distinte.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-204">First, the majority of work is split between two distinct transactions.</span></span> <span data-ttu-id="8d9ba-205">Se la transazione 1 ha esito negativo dopo che l'oggetto 4 crea l'oggetto 6, la transazione 2 viene eseguita in base al risultato della transazione 1.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-205">If Transaction 1 fails after Object 4 creates Object 6, Transaction 2 runs unaffected by the outcome of Transaction 1.</span></span> <span data-ttu-id="8d9ba-206">Se il risultato non è previsto, potrebbe essere preferibile ridurre le operazioni di entrambe le transazioni in un'unica transazione, operazione che è possibile eseguire cambiando l'attributo Transaction dell'oggetto 6 in required.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-206">If this outcome is unintended, you might prefer to fold the operations of both transactions into a single transaction, which you can accomplish by changing the transaction attribute of Object  6 to Required.</span></span>

<span data-ttu-id="8d9ba-207">Nell'illustrazione di mapping viene inoltre illustrato che l'oggetto 3 e l'oggetto 5 sono non transazionali, in esecuzione completamente al di fuori dell'ambito delle transazioni 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-207">The mapping illustration also shows that Object 3 and Object 5 are non-transactional, running completely outside the scope of Transactions 1 and 2.</span></span> <span data-ttu-id="8d9ba-208">Se l'oggetto 5 aggiorna i dati persistenti, potrebbe essere necessario riconsiderarne lo stato non transazionale.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-208">If Object 5 updates persistent data, you might want to reconsider its non-transactional status.</span></span> <span data-ttu-id="8d9ba-209">È possibile inserire l'oggetto 5 all'interno di una transazione modificando il relativo attributo Transaction su Required.</span><span class="sxs-lookup"><span data-stu-id="8d9ba-209">Object 5 can be placed within a transaction by changing its transaction attribute to Required.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8d9ba-210">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8d9ba-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8d9ba-211">Impostazione dell'attributo Transaction</span><span class="sxs-lookup"><span data-stu-id="8d9ba-211">Setting the Transaction Attribute</span></span>](setting-the-transaction-attribute.md)
</dt> </dl>

 

 




