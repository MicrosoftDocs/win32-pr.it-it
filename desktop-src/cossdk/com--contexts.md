---
description: Per i componenti configurati in esecuzione all'interno di applicazioni COM+, i contesti rappresentano la base in cui vengono forniti i servizi COM+.
ms.assetid: 62a0bef2-c3c2-4a60-a5d1-6c038958e13e
title: Contesti COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0ae1228f89797f9124e817db07f11a23dbec12
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104401489"
---
# <a name="com-contexts"></a><span data-ttu-id="2aa10-103">Contesti COM+</span><span class="sxs-lookup"><span data-stu-id="2aa10-103">COM+ Contexts</span></span>

<span data-ttu-id="2aa10-104">Per i componenti configurati in esecuzione all'interno di applicazioni COM+, i *contesti* rappresentano la base in cui vengono forniti i servizi com+.</span><span class="sxs-lookup"><span data-stu-id="2aa10-104">For configured components running within COM+ applications, *contexts* are the foundation on which COM+ services are provided.</span></span> <span data-ttu-id="2aa10-105">In COM+ un contesto viene definito come set di proprietà di runtime associate a uno o più oggetti COM utilizzati per fornire servizi per tali oggetti.</span><span class="sxs-lookup"><span data-stu-id="2aa10-105">In COM+, a context is defined as set of run-time properties associated with one or more COM objects that are used to provide services for those objects.</span></span>

<span data-ttu-id="2aa10-106">In COM+ ogni oggetto COM è associato esattamente a un contesto in cui viene eseguito, ovvero tra l'attivazione e la disattivazione, e ogni contesto risiede all'interno di un solo apartment COM.</span><span class="sxs-lookup"><span data-stu-id="2aa10-106">In COM+, every COM object is associated with precisely one context as it runs (that is, between its activation and deactivation), and every context resides within precisely one COM apartment.</span></span> <span data-ttu-id="2aa10-107">Più oggetti possono essere eseguiti nello stesso contesto e più contesti possono trovarsi all'interno dello stesso Apartment.</span><span class="sxs-lookup"><span data-stu-id="2aa10-107">Multiple objects can run within the same context, and multiple contexts can reside within the same apartment.</span></span> <span data-ttu-id="2aa10-108">Inizializzata quando un oggetto viene attivato, le proprietà di contesto, ad esempio le proprietà del contesto di sicurezza, rappresentano le esigenze di runtime di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-108">Initialized when an object is activated, context properties, such as security context properties, represent the run-time needs of an object.</span></span>

> [!Note]  
> <span data-ttu-id="2aa10-109">Per i componenti non configurati che non utilizzano servizi COM+, il contesto è, nella maggior parte dei casi, ignorato.</span><span class="sxs-lookup"><span data-stu-id="2aa10-109">For unconfigured components that do not use COM+ services, the context is, for the most part, ignored.</span></span>

 

<span data-ttu-id="2aa10-110">COM+ utilizza le proprietà di contesto come base per la fornitura di servizi in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2aa10-110">COM+ uses context properties as the basis for providing run-time services.</span></span> <span data-ttu-id="2aa10-111">Queste proprietà contengono lo stato che determina il modo in cui l'ambiente di esecuzione esegue i servizi per gli oggetti all'interno del contesto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-111">These properties hold state that determines how the execution environment performs services for objects within the context.</span></span> <span data-ttu-id="2aa10-112">In alcuni casi, è possibile interagire direttamente con le proprietà di contesto di un oggetto per indicare uno stato pertinente per un servizio fornito per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-112">In some cases, you can interact directly with an object's context properties to indicate some state relevant to a service being provided for the object.</span></span> <span data-ttu-id="2aa10-113">Questa operazione può essere eseguita, ad esempio, quando un oggetto che partecipa a una transazione automatica Vota il risultato della transazione.</span><span class="sxs-lookup"><span data-stu-id="2aa10-113">For example, you would do this when an object that is participating in an automatic transaction votes on the outcome of the transaction.</span></span>

<span data-ttu-id="2aa10-114">Per una descrizione dettagliata dei concetti di base di questi concetti, vedere [processi, thread e Apartment](/windows/desktop/com/processes--threads--and-apartments).</span><span class="sxs-lookup"><span data-stu-id="2aa10-114">For a detailed discussion of the COM foundation of these concepts, see [Processes, Threads, and Apartments](/windows/desktop/com/processes--threads--and-apartments).</span></span>

## <a name="programmatic-interaction-with-context-properties"></a><span data-ttu-id="2aa10-115">Interazione a livello di codice con le proprietà di contesto</span><span class="sxs-lookup"><span data-stu-id="2aa10-115">Programmatic Interaction with Context Properties</span></span>

<span data-ttu-id="2aa10-116">A ogni contesto è associato un oggetto [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) che tiene traccia delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="2aa10-116">Each context has an associated [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object that keeps track of its properties.</span></span> <span data-ttu-id="2aa10-117">È possibile accedere a **ObjectContext** chiamando la funzione [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) .</span><span class="sxs-lookup"><span data-stu-id="2aa10-117">You can access **ObjectContext** by calling the [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) function.</span></span> <span data-ttu-id="2aa10-118">Dopo aver eseguito l'accesso a **ObjectContext**, è possibile chiamare i metodi sull'interfaccia [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) che espone per modificare le proprietà di contesto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-118">After you have accessed **ObjectContext**, you can call methods on the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) interface it exposes to manipulate context properties.</span></span>

<span data-ttu-id="2aa10-119">Ad esempio, la chiamata di [**IObjectContext:: Tocomplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) ha l'effetto di impostare il bit di coerenza della transazione su "coerente" e il bit di [attivazione JIT](com--just-in-time-activation.md) su "Done" nel contesto associato all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-119">For example, calling [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) has the effect of setting the transaction consistency bit to "consistent" and the [JIT-activation](com--just-in-time-activation.md) done bit to "done" on the context associated with the object.</span></span> <span data-ttu-id="2aa10-120">"Coerente" segnala a COM+ che si vota per eseguire il commit della transazione e "Done" indica che l'oggetto è pronto per essere disattivato quando il metodo restituisce.</span><span class="sxs-lookup"><span data-stu-id="2aa10-120">"Consistent" signals to COM+ that you vote to commit the transaction, and "done" indicates that your object is ready to be deactivated when the method returns.</span></span>

<span data-ttu-id="2aa10-121">Oltre a [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), altre interfacce specializzate che forniscono accesso alle proprietà di contesto sono [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate)e [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span><span class="sxs-lookup"><span data-stu-id="2aa10-121">In addition to [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), other specialized interfaces providing access to context properties are [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate), and [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span></span> <span data-ttu-id="2aa10-122">A un certo punto, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) accede anche alle proprietà di contesto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-122">To a certain extent, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) also accesses context properties.</span></span> <span data-ttu-id="2aa10-123">È possibile usare [**IGetSecurityCallContext:: GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) per ottenere **ISecurityCallContext**.</span><span class="sxs-lookup"><span data-stu-id="2aa10-123">You can use [**IGetSecurityCallContext::GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) to obtain **ISecurityCallContext**.</span></span>

## <a name="understanding-activation-and-interception"></a><span data-ttu-id="2aa10-124">Informazioni sull'attivazione e l'intercettazione</span><span class="sxs-lookup"><span data-stu-id="2aa10-124">Understanding Activation and Interception</span></span>

<span data-ttu-id="2aa10-125">In genere, è necessario considerare il contesto solo nella misura in cui rappresenta un certo numero di proprietà, alcune delle quali è possibile impostare o ottenere, utilizzate per fornire servizi COM+ per i componenti.</span><span class="sxs-lookup"><span data-stu-id="2aa10-125">Generally, you need to think about context only to the extent that it represents a number of properties, some of which you can set or get, that are used to provide COM+ services for your components.</span></span> <span data-ttu-id="2aa10-126">In alcune circostanze, tuttavia, potrebbe essere necessario considerare in modo più dettagliato i due facet correlati seguenti di contesti:</span><span class="sxs-lookup"><span data-stu-id="2aa10-126">In some circumstances, however, you might need to consider the following two interrelated facets of contexts in greater detail:</span></span>

-   <span data-ttu-id="2aa10-127">[Attivazione del contesto](context-activation.md)o inizializzazione di un oggetto in un contesto appropriato.</span><span class="sxs-lookup"><span data-stu-id="2aa10-127">[Context activation](context-activation.md), or the initialization of an object in an appropriate context.</span></span>
-   <span data-ttu-id="2aa10-128">[Intercettazione](interception-of-cross-context-calls.md)o operazione eseguita da com+ sulle chiamate attraverso un limite del contesto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-128">[Interception](interception-of-cross-context-calls.md), or what COM+ does on calls across a context boundary.</span></span>

## <a name="relation-to-mts-context-wrappers"></a><span data-ttu-id="2aa10-129">Relazione ai wrapper del contesto MTS</span><span class="sxs-lookup"><span data-stu-id="2aa10-129">Relation to MTS Context Wrappers</span></span>

<span data-ttu-id="2aa10-130">I contesti sostituiscono in modo efficace i wrapper del contesto MTS.</span><span class="sxs-lookup"><span data-stu-id="2aa10-130">Contexts effectively replace the MTS context wrappers.</span></span> <span data-ttu-id="2aa10-131">Lo scopo che ha servito, ovvero fornire servizi automatici tramite l'intercettazione delle richieste di creazione, è ora una funzionalità integrata di COM+.</span><span class="sxs-lookup"><span data-stu-id="2aa10-131">The purpose they served—providing automatic services by trapping creation requests—is now an integrated feature of COM+.</span></span> <span data-ttu-id="2aa10-132">Di conseguenza, non è più necessario usare la funzione [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) .</span><span class="sxs-lookup"><span data-stu-id="2aa10-132">As a result, you no longer need to use the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) function.</span></span> <span data-ttu-id="2aa10-133">In MTS è stato usato **SafeRef** per ottenere un riferimento all'oggetto che può essere passato all'esterno del relativo wrapper di contesto.</span><span class="sxs-lookup"><span data-stu-id="2aa10-133">In MTS, **SafeRef** was used to obtain a reference to your object which could be passed outside of its context wrapper.</span></span> <span data-ttu-id="2aa10-134">In COM+ questa operazione non è necessaria. i riferimenti agli oggetti normali (**questo** puntatori) funzionano.</span><span class="sxs-lookup"><span data-stu-id="2aa10-134">In COM+, this is unnecessary; normal object references (**this** pointers) work.</span></span>

 

 
