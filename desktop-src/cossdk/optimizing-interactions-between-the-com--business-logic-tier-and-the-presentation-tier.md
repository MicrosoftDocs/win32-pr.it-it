---
description: In genere, la latenza tra i livelli di un'applicazione distribuita è molto diversa.
ms.assetid: 4780a9fd-5940-4b10-a596-22214b17c033
title: Ottimizzazione delle interazioni tra il livello di logica di business COM+ e il livello di presentazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe6094cb12cc7875d8a18dea3d28ac55bf8d6ae2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106305140"
---
# <a name="optimizing-interactions-between-the-com-business-logic-tier-and-the-presentation-tier"></a><span data-ttu-id="b9b1b-103">Ottimizzazione delle interazioni tra il livello di logica di business COM+ e il livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="b9b1b-103">Optimizing Interactions Between the COM+ Business Logic Tier and the Presentation Tier</span></span>

<span data-ttu-id="b9b1b-104">In genere, la latenza tra i livelli di un'applicazione distribuita è molto diversa.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-104">Typically, the latency between tiers of a distributed application differs greatly.</span></span> <span data-ttu-id="b9b1b-105">Le chiamate tra il livello di presentazione e il livello della logica di business sono spesso un ordine di grandezza più lento rispetto alle chiamate tra il livello business e il livello dati.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-105">Calls between the presentation tier and business logic tier are often an order of magnitude slower than calls between the business tier and data tier.</span></span> <span data-ttu-id="b9b1b-106">Di conseguenza, lo stato mantenuto è più oneroso quando si chiama il livello della logica di business.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-106">As a result, held state is more costly when calling into the business logic tier.</span></span>

<span data-ttu-id="b9b1b-107">Negli argomenti seguenti vengono illustrati i modi per passare i dati tra i livelli di presentazione e della logica di business:</span><span class="sxs-lookup"><span data-stu-id="b9b1b-107">The following topics discuss ways to pass data between the presentation and business logic tiers:</span></span>

-   [<span data-ttu-id="b9b1b-108">Passaggio di parametri</span><span class="sxs-lookup"><span data-stu-id="b9b1b-108">Passing Parameters</span></span>](#passing-parameters)
-   [<span data-ttu-id="b9b1b-109">Opzioni di passaggio dei dati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-109">Data Passing Options</span></span>](#data-passing-options)
-   [<span data-ttu-id="b9b1b-110">Uso di un modello factory per passare i dati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-110">Using a Factory Pattern to Pass Data</span></span>](#using-a-factory-pattern-to-pass-data)
-   [<span data-ttu-id="b9b1b-111">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-111">Related topics</span></span>](#related-topics)

## <a name="passing-parameters"></a><span data-ttu-id="b9b1b-112">Passaggio di parametri</span><span class="sxs-lookup"><span data-stu-id="b9b1b-112">Passing Parameters</span></span>

<span data-ttu-id="b9b1b-113">Per passare un set di informazioni specifico tra il livello di presentazione e il livello della logica di business, è possibile che sia presente una singola riga, più righe o una combinazione di una singola riga (ad esempio un'intestazione) e di più righe di dettaglio di dati.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-113">For a given set of information to be passed between the presentation tier and the business logic tier, you may have a single row, multiple rows, or a combination of a single row (such as a header) and multiple detail rows of data.</span></span> <span data-ttu-id="b9b1b-114">Il modo più efficiente per passare queste informazioni tra i livelli è tramite una singola chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-114">The most efficient way to pass this information between tiers is by a single method call.</span></span> <span data-ttu-id="b9b1b-115">Questa singola chiamata gestirà l'intero set di informazioni da passare.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-115">This single call would manage the entire information set to be passed.</span></span> <span data-ttu-id="b9b1b-116">Questa operazione è necessaria a meno che non si scelga di controllare la transazione dal livello di presentazione (e di rendere identico tutto il trattamento delle transazioni nel livello di presentazione nella funzione).</span><span class="sxs-lookup"><span data-stu-id="b9b1b-116">This is necessary unless you choose to control the transaction from the presentation tier (and make all transaction treatment in the presentation tier identical in function).</span></span> <span data-ttu-id="b9b1b-117">Microsoft non consiglia di eseguire transazioni dal livello di presentazione perché le chiamate tra questo livello e il livello di logica di business sono in genere il più lento tra le chiamate in un'applicazione multilivello.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-117">Microsoft does not recommend conducting transactions from the presentation tier because calls between this tier and the business logic tier are usually the slowest of any calls in a multi-tier application.</span></span>

<span data-ttu-id="b9b1b-118">Un modo per creare un metodo di questo tipo consiste nel passare singole righe di informazioni come parametri e passare più righe come recordset ADO.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-118">One way to create such a method is to pass single rows of information as parameters and pass multiple rows as ADO recordsets.</span></span> <span data-ttu-id="b9b1b-119">I recordset rappresentano la base della metodologia di accesso ai dati ADO di Microsoft e l'utilizzo di recordset ADO consente di passare tutte le informazioni relative a una singola transazione in un unico passaggio.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-119">Recordsets are the core of Microsoft's ADO data access methodology, and using ADO recordsets allows you to pass all the information related to a single transaction in one step.</span></span>

## <a name="data-passing-options"></a><span data-ttu-id="b9b1b-120">Opzioni di passaggio dei dati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-120">Data Passing Options</span></span>

<span data-ttu-id="b9b1b-121">Sono disponibili altre opzioni da considerare quando si passano i dati.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-121">There are other options to consider when passing data.</span></span> <span data-ttu-id="b9b1b-122">Che includono l'utilizzo di un elenco di parametri e di recordset ADO (come illustrato in precedenza), solo recordset ADO, stringhe con codifica XML o matrici di strutture.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-122">These include using a list of parameters and ADO recordsets (as discussed above), just ADO recordsets, XML encoded strings, or arrays of structures.</span></span> <span data-ttu-id="b9b1b-123">In questa sezione viene illustrata ciascuna di queste opzioni.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-123">This section discusses each of these options.</span></span>

<span data-ttu-id="b9b1b-124">La tabella seguente illustra le aree in cui è necessario prestare particolare attenzione quando si usa una delle quattro diverse possibilità di passaggio di argomenti.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-124">The following table shows areas where extra care needs to be taken when using any of the four different argument-passing possibilities.</span></span> <span data-ttu-id="b9b1b-125">Una "X" rappresenta le aree in cui i compromessi devono essere compresi e ponderati in base alle esigenze di ogni progetto.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-125">An "X" represents areas where trade-offs need to be understood and weighed against the needs of each project.</span></span> <span data-ttu-id="b9b1b-126">Provare a non prendere decisioni che passano gli argomenti per ogni singolo componente.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-126">Try not to make argument-passing decisions on a per-component basis.</span></span> <span data-ttu-id="b9b1b-127">I vantaggi di un modello di programmazione coerente all'interno di un progetto superano di gran lunga tutti i vantaggi offerti dall'ottimizzazione in base al metodo o al singolo componente in tutte le circostanze, tranne le più estreme.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-127">The benefits of a consistent programming model throughout a project far outweigh any advantage of optimizing on a per-method or per-component basis in all but the most extreme circumstances.</span></span> <span data-ttu-id="b9b1b-128">Le colonne sono descritte nell'elenco che segue la tabella.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-128">The columns are described in the list that follows the table.</span></span>



|                       | <span data-ttu-id="b9b1b-129">Concorrenza</span><span class="sxs-lookup"><span data-stu-id="b9b1b-129">Concurrency</span></span>  | <span data-ttu-id="b9b1b-130">WAN</span><span class="sxs-lookup"><span data-stu-id="b9b1b-130">WAN</span></span>          | <span data-ttu-id="b9b1b-131">Distribuzione</span><span class="sxs-lookup"><span data-stu-id="b9b1b-131">Deployment</span></span>   | <span data-ttu-id="b9b1b-132">Complessità</span><span class="sxs-lookup"><span data-stu-id="b9b1b-132">Complexity</span></span>   |
|-----------------------|--------------|--------------|--------------|--------------|
| <span data-ttu-id="b9b1b-133">Voce</span><span class="sxs-lookup"><span data-stu-id="b9b1b-133">Entry</span></span> | <span data-ttu-id="b9b1b-134">Valore</span><span class="sxs-lookup"><span data-stu-id="b9b1b-134">Value</span></span> |
| <span data-ttu-id="b9b1b-135">Recordset</span><span class="sxs-lookup"><span data-stu-id="b9b1b-135">Recordsets</span></span><br/> |              | <span data-ttu-id="b9b1b-136">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-136">X</span></span><br/> | <span data-ttu-id="b9b1b-137">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-137">X</span></span><br/> | <span data-ttu-id="b9b1b-138">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-138">X</span></span><br/> |
| <span data-ttu-id="b9b1b-139">XML</span><span class="sxs-lookup"><span data-stu-id="b9b1b-139">XML</span></span><br/>        | <span data-ttu-id="b9b1b-140">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-140">X</span></span><br/> |              | <span data-ttu-id="b9b1b-141">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-141">X</span></span><br/> | <span data-ttu-id="b9b1b-142">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-142">X</span></span><br/> |
| <span data-ttu-id="b9b1b-143">Matrici</span><span class="sxs-lookup"><span data-stu-id="b9b1b-143">Arrays</span></span><br/>     | <span data-ttu-id="b9b1b-144">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-144">X</span></span><br/> |              | <span data-ttu-id="b9b1b-145">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-145">X</span></span><br/> | <span data-ttu-id="b9b1b-146">X</span><span class="sxs-lookup"><span data-stu-id="b9b1b-146">X</span></span><br/> |



 

<span data-ttu-id="b9b1b-147">Le quattro colonne definiscono le aree da controllare quando si usa tale opzione per passare i parametri.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-147">The four columns define areas to watch out for when using that option to pass parameters.</span></span>

-   <span data-ttu-id="b9b1b-148">**La colonna concorrenza** rappresenta la necessità di scrivere codice o fornire un meccanismo per gestire le condizioni di blocco sulle operazioni di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-148">**The Concurrency column** represents the need to code or provide a mechanism that manages locking conditions on update operations.</span></span> <span data-ttu-id="b9b1b-149">Poiché i metodi che eseguono i salvataggi possono rappresentare aggiornamenti, possono verificarsi problemi di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-149">Since methods that perform saves can represent updates, concurrency problems can arise.</span></span> <span data-ttu-id="b9b1b-150">Due tipi di blocco sono ottimistici e pessimistici prevalentemente.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-150">Two types of locking are prevalent optimistic and pessimistic.</span></span> <span data-ttu-id="b9b1b-151">I blocchi pessimistici impediscono a un utente di recuperare i dati per l'aggiornamento, mentre un altro utente ha la possibilità di eseguire un aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-151">Pessimistic locks prevent a user from getting data for update while another user has the potential for performing an update.</span></span> <span data-ttu-id="b9b1b-152">Il blocco ottimistico supporta un numero elevato di utenti, negoziando la probabilità che due utenti aggiornino lo stesso documento nello stesso momento.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-152">Optimistic locking supports a great many more users by trading against the likelihood that any two users would be updating the same document at the same time.</span></span> <span data-ttu-id="b9b1b-153">Il blocco ottimistico chiama per verificare che i dati archiviati corrispondano ai dati nel punto in cui è stato eseguito l'accesso a una copia dei dati per la modifica.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-153">Optimistic locking calls for checking to see that the data that is stored matches the data at the point when a copy of the data was accessed for modification.</span></span> <span data-ttu-id="b9b1b-154">I recordset ADO forniscono supporto automatico per il blocco ottimistico.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-154">ADO recordsets provide automatic support for optimistic locking.</span></span> <span data-ttu-id="b9b1b-155">Gli scenari di aggiornamento che coinvolgono elenchi di parametri a riga singola non forniscono supporto sufficiente per il controllo della concorrenza.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-155">Update scenarios involving single row parameter lists do not provide sufficient support for concurrency checking.</span></span> <span data-ttu-id="b9b1b-156">XML soffre di questo stesso problema, in quanto non è presente alcuna consapevolezza di blocco nei dati XML.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-156">XML suffers from this same problem, in that no locking awareness is present in XML data.</span></span>
-   <span data-ttu-id="b9b1b-157">**La colonna WAN** rappresenta le condizioni in cui è possibile che si verifichi una contesa di trasmissione in un Wide Area Network (WAN).</span><span class="sxs-lookup"><span data-stu-id="b9b1b-157">**The WAN column** represents conditions where there may be transmission contention on a wide area network (WAN ).</span></span> <span data-ttu-id="b9b1b-158">Quando la rete WAN non dispone di capacità sufficiente per la gestione di tutti i dati spostati in una sola volta, gli utenti dell'applicazione ritarderanno i tempi di risposta.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-158">When the WAN does not have sufficient capacity to manage all of the data being moved at any one time, application users experience response time delays.</span></span> <span data-ttu-id="b9b1b-159">Per supportare la concorrenza ottimistica, i recordset ADO disconnessi passano due copie dei dati dal server al client.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-159">To support optimistic concurrency, disconnected ADO recordsets pass two copies of the data from the server to the client.</span></span> <span data-ttu-id="b9b1b-160">La seconda copia viene utilizzata dal client per determinare il set di righe di aggiornamento più piccolo da restituire quando viene eseguito il commit di una modifica.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-160">The second copy is used by the client to determine the smallest update rowset to pass back when a change is being committed.</span></span> <span data-ttu-id="b9b1b-161">Anche se questa operazione riduce il traffico dal livello di presentazione ai dati, il carico aggiuntivo della seconda copia può essere significativo.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-161">While this cuts down on traffic from the presentation tier to the data, the extra load of the second copy can be significant.</span></span> <span data-ttu-id="b9b1b-162">L'utilizzo di recordset come unico mezzo per passare tutte le informazioni determina pertanto il passaggio del doppio dei dati tra i livelli in base alle esigenze, tranne quando il set di righe di aggiornamento viene passato nuovamente al livello dati da un livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-162">Using recordsets as the sole means of passing all information therefore causes twice as much data to be passed between tiers as is required, except when the update rowset is being passed back to the data tier from a presentation tier.</span></span>
-   <span data-ttu-id="b9b1b-163">**La colonna di distribuzione rappresenta i** problemi associati al passaggio dei dati quando è necessaria una tecnologia speciale sia sul lato chiamante che sul lato componente della rete.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-163">**The Deployment column** represents issues associated with data passing when special technology is required on both the caller and component side of the network.</span></span> <span data-ttu-id="b9b1b-164">Ad esempio, l'utilizzo di recordset ADO richiede che i componenti ADO siano presenti sia nel client che nel server.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-164">For example, using ADO recordsets requires ADO components to be present on both client and server.</span></span> <span data-ttu-id="b9b1b-165">I parser XML devono essere presenti anche su entrambi i lati, per evitare di dover codificare i parser nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-165">XML parsers must be present on both sides as well, to avoid having to code parsers into your applications.</span></span>
-   <span data-ttu-id="b9b1b-166">**La colonna complessità** è indicata per tutte e quattro le scelte ed è una questione di preferenza o di un modello di programmazione precedente che può essere già stabilito nell'organizzazione di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-166">**The Complexity column** is indicated for all four choices, and is a matter of preference or prior programming model experience that may be already established in your development organization.</span></span> <span data-ttu-id="b9b1b-167">Alcuni utenti trovano il passaggio dei parametri per essere ingombranti e si ritiene che aggiunga una complessità eccessiva al problema di programmazione.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-167">Some people find parameter passing to be cumbersome and feel it adds too much complexity to the programming problem.</span></span> <span data-ttu-id="b9b1b-168">Tenere traccia del parametro che si sta gestendo e renderli visibili in un'unica finestra di modifica, può creare una complessità logistica che alcuni sviluppatori trovano non gestibili.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-168">Keeping track of which parameter you are handling, and getting them all visible in one editing window, can create a logistical complexity that some developers find unmanageable.</span></span>

<span data-ttu-id="b9b1b-169">Anche il metodo di passaggio dei parametri può comportare compromessi, come i seguenti:</span><span class="sxs-lookup"><span data-stu-id="b9b1b-169">The parameter-passing method also can have trade-offs, such as the following:</span></span>

-   <span data-ttu-id="b9b1b-170">I parametri possono comportare la gestione di più argomenti e tipi di argomento, nonché la necessità di decidere quando è opportuno creare un recordset per un parametro.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-170">Parameters can involve managing multiple arguments and argument types as well as having to decide when it is appropriate to make a recordset a parameter.</span></span>
-   <span data-ttu-id="b9b1b-171">I recordset ADO possono tagliare le relazioni gerarchiche nei parametri del metodo fino a uno o due argomenti.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-171">ADO recordsets can cut hierarchical relationships in method parameters down to one or two arguments.</span></span> <span data-ttu-id="b9b1b-172">In questo modo, il modello di programmazione viene semplificato in modo significativo e viene supportata l'aggiunta di colonne in un secondo momento, ma viene nascosta anche la gerarchia delle informazioni.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-172">This simplifies the programming model dramatically and supports adding columns at a later time, but it also hides the information hierarchy.</span></span> <span data-ttu-id="b9b1b-173">Le informazioni di riempimento in un recordset ADO e in un secondo momento l'estrazione includono i nomi di ogni colonna o l'ordine delle colonne.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-173">Stuffing information into an ADO recordset and later extracting it involves knowing the names of each column or knowing the column order.</span></span> <span data-ttu-id="b9b1b-174">Questa situazione può aggiungere complessità per altri sviluppatori di componenti o applicazioni nel progetto.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-174">This situation can add complexity for other component or application developers on the project.</span></span>
-   <span data-ttu-id="b9b1b-175">XML è un altro spin sulla complicazione della gerarchia nascosta indicata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-175">XML is a different spin on the hidden hierarchy complication mentioned above.</span></span> <span data-ttu-id="b9b1b-176">Il programmatore deve comprendere l'uso di un parser XML per ottenere l'accesso alle informazioni e spesso deve conoscere i nomi di ogni elemento nel set di dati prima di poter trovare il set di dati.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-176">The programmer needs to understand the use of an XML parser to gain access to the information and often must know the names of each item in the data set before the data set can be found.</span></span>
-   <span data-ttu-id="b9b1b-177">Le matrici di strutture introducono la necessità di una conoscenza comune delle informazioni passate sulla parte del chiamante e del componente.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-177">Arrays of structures introduce the need for a common understanding of the information being passed on the part of both caller and component.</span></span> <span data-ttu-id="b9b1b-178">Questa esigenza di una mappa condivisa tra due elementi di sistema può causare difficoltà quando si gestiscono versioni diverse dei componenti.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-178">This need for a map that is shared between two system elements can lead to difficulties when dealing with different versions of components.</span></span> <span data-ttu-id="b9b1b-179">Sebbene la firma del metodo non venga modificata, le modifiche apportate alle informazioni previste possono rendere incompatibili i programmi chiamante.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-179">While the method signature might not change, changes to the expected information can render calling programs incompatible.</span></span>

<span data-ttu-id="b9b1b-180">Poiché i problemi di complessità associati a tutti e quattro i metodi di passaggio dei parametri sono così simili, è discutibile che è presente un'opportunità di semplificazione significativa associata a una qualsiasi selezione.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-180">Because the complexity issues associated with all four parameter-passing methods are so similar, it is debatable that there is a significant simplification opportunity associated with any one selection.</span></span>

## <a name="using-a-factory-pattern-to-pass-data"></a><span data-ttu-id="b9b1b-181">Uso di un modello factory per passare i dati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-181">Using a Factory Pattern to Pass Data</span></span>

<span data-ttu-id="b9b1b-182">Un punto di progettazione importante è la semplicità d'uso.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-182">One important design point is ease of use.</span></span> <span data-ttu-id="b9b1b-183">Nel momento in cui si è deciso di utilizzare i recordset ADO per passare un set strutturato di dettagli al livello di presentazione, è stato introdotto un problema di complessità.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-183">The moment you decided to use ADO recordsets to pass a structured set of details back to the presentation tier, you introduced a complexity problem.</span></span> <span data-ttu-id="b9b1b-184">I programmatori del livello presentazione devono comprendere la struttura di questi Recordset.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-184">Presentation tier programmers need to understand the structure of those recordsets.</span></span> <span data-ttu-id="b9b1b-185">Un problema di complessità maggiore può verificarsi quando sono necessari più dettagli per un set di dati da passare in un recordset.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-185">A greater complexity issue can arise when you require multiple details for a set of data to be passed in a recordset.</span></span> <span data-ttu-id="b9b1b-186">Per semplificare le cose, è consigliabile creare un metodo factory recordset quando si desidera che i dati vengano passati nei recordset ADO strutturati.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-186">To simplify matters, you should consider creating a recordset factory method whenever you intend to require data to be passed in structured ADO recordsets.</span></span>

<span data-ttu-id="b9b1b-187">La Factory recordset deve restituire al chiamante un recordset disconnesso, ma scrivibile.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-187">The recordset factory should return an empty but writable disconnected recordset to the caller.</span></span> <span data-ttu-id="b9b1b-188">Questo recordset deve avere i campi appropriati (nomi e tipi di dati) già configurati in modo che il client chiamante non debba essere in grado di produrre il recordset.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-188">This recordset should have the proper fields (names and data types) already configured so that the calling client does not need to know how to manufacture the recordset.</span></span> <span data-ttu-id="b9b1b-189">Questo approccio viene spesso definito *modello di Factory* ed è un modello di soluzione comune che risolve la necessità di creare un oggetto di una determinata complessità senza che sia necessario conoscerne le sfumature.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-189">This approach is often referred to as the *factory pattern* and is a common solution pattern that solves the need to create an object of a given complexity without having to know the nuances of creating it.</span></span>

<span data-ttu-id="b9b1b-190">Semplici scelte di progettazione, ad esempio la scelta dello stesso nome di parametro per lo stesso tipo di dati in tutti i metodi in cui vengono passate le informazioni, semplificano l'aspetto di un metodo e sanno cosa è previsto.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-190">Simple design choices such as choosing the same parameter name for the same piece of data across every method where that information is passed makes it easy to look at a method and know what is expected.</span></span> <span data-ttu-id="b9b1b-191">Assicurarsi che l'ordine in cui vengono passati gli argomenti sia coerente in un'intera famiglia di metodi fornisce un punto di comodità che impone un modello coerente.</span><span class="sxs-lookup"><span data-stu-id="b9b1b-191">Making sure that the order in which like arguments are passed is consistent across an entire family of methods provides a comfort point that enforces a consistent model.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b9b1b-192">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b9b1b-193">Ottimizzazione delle interazioni tra il livello di logica di business COM+ e il livello dati</span><span class="sxs-lookup"><span data-stu-id="b9b1b-193">Optimizing Interactions Between the COM+ Business Logic Tier and the Data Tier</span></span>](optimizing-interactions-between-the-com--business-logic-tier-and-the-data-tier.md)
</dt> </dl>

 

 




