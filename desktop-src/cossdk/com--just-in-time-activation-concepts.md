---
description: Il servizio di attivazione JIT (just-in-Time) consente a COM+ di disattivare un oggetto mentre un client conserva ancora un riferimento attivo a tale oggetto.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Concetti relativi all'attivazione JIT di COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106304642"
---
# <a name="com-just-in-time-activation-concepts"></a><span data-ttu-id="8ff13-103">Concetti relativi all'attivazione JIT di COM+</span><span class="sxs-lookup"><span data-stu-id="8ff13-103">COM+ Just-in-Time Activation Concepts</span></span>

<span data-ttu-id="8ff13-104">Il servizio di attivazione JIT (just-in-Time) consente a COM+ di disattivare un oggetto mentre un client conserva ancora un riferimento attivo a tale oggetto.</span><span class="sxs-lookup"><span data-stu-id="8ff13-104">The just-in-time (JIT) activation service enables COM+ to deactivate an object while a client still holds an active reference to that object.</span></span> <span data-ttu-id="8ff13-105">La volta successiva che il client chiama un metodo sull'oggetto, che il client ritiene ancora attivo, il servizio di attivazione JIT COM+ riattiva l'oggetto in modo trasparente al client, solo nel tempo.</span><span class="sxs-lookup"><span data-stu-id="8ff13-105">The next time the client calls a method on the object, which the client believes to be still active, the COM+ JIT activation service reactivates the object transparently to the client, just in time.</span></span>

<span data-ttu-id="8ff13-106">Il vantaggio principale dell'utilizzo di COM + JIT è che è possibile consentire ai client di mantenere i riferimenti agli oggetti per tutto il tempo necessario, senza necessariamente vincolare risorse server importanti, ad esempio la memoria.</span><span class="sxs-lookup"><span data-stu-id="8ff13-106">The main advantage of using COM + JIT activation is that you can enable clients to hold references to objects for as long as they need them, without necessarily tying up valuable server resources such as memory.</span></span> <span data-ttu-id="8ff13-107">Altri importanti vantaggi sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="8ff13-107">Other important benefits include the following:</span></span>

-   <span data-ttu-id="8ff13-108">Utilizzando il servizio di attivazione JIT COM+, il modello di programmazione per il client viene notevolmente semplificato in quanto il client non deve considerare la modalità di utilizzo di oggetti server e risorse server costosi.</span><span class="sxs-lookup"><span data-stu-id="8ff13-108">Using the COM+ JIT activation service greatly simplifies the programming model for the client because the client doesn't have to think about how it uses expensive server objects and server resources.</span></span> <span data-ttu-id="8ff13-109">Senza l'attivazione JIT, i client possono comportare una riduzione significativa quando spesso devono chiamare e rilasciare oggetti.</span><span class="sxs-lookup"><span data-stu-id="8ff13-109">Without JIT activation, clients can incur a significant penalty when they frequently need to call and release objects.</span></span>
    > [!Note]  
    > <span data-ttu-id="8ff13-110">È possibile affinare ulteriormente questo vantaggio in merito alle prestazioni utilizzando il servizio di [pool di oggetti com+](com--object-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="8ff13-110">You can refine this performance benefit further by using the [COM+ Object Pooling](com--object-pooling.md) service.</span></span> <span data-ttu-id="8ff13-111">Grazie al pool di oggetti attivati tramite JIT, è possibile velocizzare la riattivazione degli oggetti per i client mentre si riutilizzano le risorse che potrebbero contenere, garantendo un controllo più preciso sulla quantità di memoria utilizzata da un determinato oggetto nel server.</span><span class="sxs-lookup"><span data-stu-id="8ff13-111">By pooling JIT-activated objects, you can greatly speed object reactivation for clients while reusing whatever resources they might be holding, giving you more precise control over how much memory is used by a given object on the server.</span></span> <span data-ttu-id="8ff13-112">Per informazioni dettagliate, vedere [pool di oggetti e attivazione JIT com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="8ff13-112">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

     

-   <span data-ttu-id="8ff13-113">Con le applicazioni distribuite, è necessario un ciclo di andata e ritorno di rete costoso per la creazione di ogni oggetto e maggiore è il client dal server, maggiori sono i costi di attivazione e di marshalling dell'oggetto server, l'apertura del canale e la configurazione del proxy e dello stub.</span><span class="sxs-lookup"><span data-stu-id="8ff13-113">With distributed applications, an expensive network round-trip is required for the creation of every object, and the farther the client is from the server, the greater the costs of activating and marshaling the server object, opening the channel, and setting up the proxy and stub.</span></span> <span data-ttu-id="8ff13-114">Utilizzando il servizio di attivazione JIT COM+, è possibile ridurre al minimo la frequenza di creazione di oggetti per migliorare significativamente le prestazioni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8ff13-114">By using the COM+ JIT activation service, you can minimize the frequency of object creation to significantly improve the performance of your application.</span></span>
-   <span data-ttu-id="8ff13-115">Quando si utilizza l'attivazione JIT COM+ per attivare gli oggetti ai quali i client contengono riferimenti di lunga durata ma che non vengono necessariamente utilizzati continuamente, la memoria del server non è sempre vincolata a mantenere attivi gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="8ff13-115">When you use COM+ JIT activation to activate those objects to which clients hold long-lived references but which they aren't necessarily using all the time, server memory is not always tied up keeping those objects alive.</span></span> <span data-ttu-id="8ff13-116">Questo può aumentare significativamente la scalabilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8ff13-116">This can significantly increase the scalability of your application.</span></span> <span data-ttu-id="8ff13-117">L'unico miglioramento delle prestazioni che i client vedono è il tempo impiegato da COM+ per riattivare l'oggetto, in genere solo marginalmente più tempo del necessario per allocare memoria per l'oggetto e sostanzialmente inferiore rispetto al round trip della rete per la creazione di oggetti remoti.</span><span class="sxs-lookup"><span data-stu-id="8ff13-117">The only performance hit that clients see is the time it takes COM+ to reactivate the object, usually just marginally more time than it takes to allocate memory for the object and substantially less than the network round-trip for remote object creation.</span></span>

## <a name="enabling-com-jit-activation"></a><span data-ttu-id="8ff13-118">Abilitazione dell'attivazione JIT COM+</span><span class="sxs-lookup"><span data-stu-id="8ff13-118">Enabling COM+ JIT Activation</span></span>

<span data-ttu-id="8ff13-119">È possibile abilitare il servizio di attivazione JIT COM+ per un componente utilizzando lo strumento di amministrazione Servizi componenti o le funzioni amministrative.</span><span class="sxs-lookup"><span data-stu-id="8ff13-119">You can enable the COM+ JIT activation service for a component by using either the Component Services administrative tool or the Administrative functions.</span></span> <span data-ttu-id="8ff13-120">Per informazioni dettagliate su come eseguire questa operazione, vedere [Abilitazione dell'attivazione JIT per un componente](enabling-jit-activation-for-a-component.md).</span><span class="sxs-lookup"><span data-stu-id="8ff13-120">For details about how to do this, see [Enabling JIT Activation for a Component](enabling-jit-activation-for-a-component.md).</span></span>

<span data-ttu-id="8ff13-121">L'attivazione JIT COM+ può interagire con altri servizi COM+, come nel seguente esempio:</span><span class="sxs-lookup"><span data-stu-id="8ff13-121">COM+ JIT activation can interact with other COM+ services, such as the following:</span></span>

-   <span data-ttu-id="8ff13-122">Quando il componente richiede transazioni, l'attivazione JIT viene abilitata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="8ff13-122">When your component requires transactions, JIT activation is automatically enabled for it.</span></span> <span data-ttu-id="8ff13-123">Per maggiori dettagli, vedere [transazioni e attivazione JIT com+](transactions-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="8ff13-123">For greater detail, see [Transactions and COM+ JIT Activation](transactions-and-com--jit-activation.md).</span></span>
-   <span data-ttu-id="8ff13-124">Quando il componente è abilitato per l'attivazione JIT, la sincronizzazione viene impostata automaticamente su Required.</span><span class="sxs-lookup"><span data-stu-id="8ff13-124">When your component is enabled for JIT activation, synchronization is automatically set to required.</span></span> <span data-ttu-id="8ff13-125">Ciò significa che se due client chiamano simultaneamente un componente attivato tramite JIT e una chiamata al metodo per uno di essi restituisce, causando la disattivazione dell'oggetto, l'altro non viene lasciato invariato.</span><span class="sxs-lookup"><span data-stu-id="8ff13-125">This means that if two clients simultaneously call a JIT-activated component and a method call for one of them returns, causing the object to be deactivated, the other is not left stranded.</span></span>

## <a name="how-deactivation-is-triggered"></a><span data-ttu-id="8ff13-126">Modalità di attivazione della disattivazione</span><span class="sxs-lookup"><span data-stu-id="8ff13-126">How Deactivation Is Triggered</span></span>

<span data-ttu-id="8ff13-127">COM+ disattiva un oggetto in base allo stato del bit di fatto sul contesto dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="8ff13-127">COM+ deactivates an object based on the status of the doneness bit on the object context.</span></span> <span data-ttu-id="8ff13-128">L'oggetto può utilizzare questo bit per indicare se è stato eseguito, ovvero se è pronto per essere disattivato, durante una chiamata al metodo specificata.</span><span class="sxs-lookup"><span data-stu-id="8ff13-128">Your object can use this bit to signal whether it is done—that is, ready to be deactivated—during a given method call.</span></span> <span data-ttu-id="8ff13-129">Per ulteriori informazioni, vedere [impostazione del bit fatto](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="8ff13-129">For more information, see [Setting the Done Bit](setting-the-done-bit.md).</span></span>

## <a name="using-the-auto-done-property"></a><span data-ttu-id="8ff13-130">Uso della proprietà auto-done</span><span class="sxs-lookup"><span data-stu-id="8ff13-130">Using the Auto-Done Property</span></span>

<span data-ttu-id="8ff13-131">Utilizzando lo strumento di amministrazione Servizi componenti, è possibile configurare un metodo in modo che l'oggetto venga disattivato automaticamente al ritorno del metodo.</span><span class="sxs-lookup"><span data-stu-id="8ff13-131">Using the Component Services administrative tool, you can configure a method such that the object is automatically deactivated on method return.</span></span> <span data-ttu-id="8ff13-132">(Vedere [Abilitazione dell'operazione automatica per un metodo](enabling-auto-done-for-a-method.md) per istruzioni su come impostare questa proprietà). Selezionando questa opzione, è possibile eliminare le chiamate al metodo ripetitive per votare le transazioni.</span><span class="sxs-lookup"><span data-stu-id="8ff13-132">(See [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) for instructions about how to set this property.) By selecting this option, you can eliminate the repetitive method calls for voting in transactions.</span></span> <span data-ttu-id="8ff13-133">Poiché l'impostazione predefinita per il bit di coerenza è true, se è stato modificato il bit done su true e non si esegue alcuna operazione per modificare queste impostazioni, [**IObjectContext:: Tocomplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) viene chiamato automaticamente dopo la restituzione del metodo.</span><span class="sxs-lookup"><span data-stu-id="8ff13-133">Because the default setting for the consistency bit is True, if you have changed the done bit to True as well and you take no action to change these settings, [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) is called automatically after the method returns.</span></span>

<span data-ttu-id="8ff13-134">Tuttavia, esiste un avvertimento a questo comportamento: COM+ analizzerà il valore HRESULT restituito dal metodo.</span><span class="sxs-lookup"><span data-stu-id="8ff13-134">However, there is one caveat to this behavior: COM+ will examine the HRESULT that the method returns.</span></span> <span data-ttu-id="8ff13-135">Se HRESULT indica un errore, il bit di coerenza è impostato su false e il risultato è lo stesso di se è stato chiamato [**IObjectContext:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="8ff13-135">If that HRESULT indicates failure, the consistency bit is set to False and the result is the same as if you had called [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

<span data-ttu-id="8ff13-136">Per riepilogare, se si seleziona operazione eseguita automaticamente per un metodo e non si esegue alcuna azione per impostare alcun bit e se viene restituito HRESULT (HR), si applica quanto segue:</span><span class="sxs-lookup"><span data-stu-id="8ff13-136">To summarize, if you select auto-done for a method and don't take any action to set any bits, and if an HRESULT(hr) is returned, the following applies:</span></span>

-   <span data-ttu-id="8ff13-137">Se ha ESITo positivo (HR), è come se fosse stato chiamato il metodo [**Tocomplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span><span class="sxs-lookup"><span data-stu-id="8ff13-137">If SUCCEEDS(hr), it is as though you called [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span></span>
-   <span data-ttu-id="8ff13-138">Se ha ESITo negativo (HR), è come se fosse stato chiamato il metodo [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="8ff13-138">If FAILED(hr), it is as though you called [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a><span data-ttu-id="8ff13-139">Uso di IObjectControl per gestire l'attivazione e la disattivazione di oggetti</span><span class="sxs-lookup"><span data-stu-id="8ff13-139">Using IObjectControl to Manage Object Activation and Deactivation</span></span>

<span data-ttu-id="8ff13-140">È possibile implementare l'interfaccia [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) in modo che il runtime com+ gestisca automaticamente la disattivazione e la riattivazione per gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="8ff13-140">You can implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface so that the COM+ runtime automatically manages deactivation and reactivation for your objects.</span></span> <span data-ttu-id="8ff13-141">Quando un oggetto implementa questa interfaccia, COM+ chiama [**IObjectControl::D ttiva**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) quando disattiva l'oggetto e [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) quando viene riattivato.</span><span class="sxs-lookup"><span data-stu-id="8ff13-141">When an object implements this interface, COM+ calls [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) when it deactivates the object and [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) when it reactivates it.</span></span> <span data-ttu-id="8ff13-142">Questi metodi consentono l'inizializzazione automatica del contesto per l'attivazione di oggetti e la pulizia dello stato in caso di disattivazione.</span><span class="sxs-lookup"><span data-stu-id="8ff13-142">These methods enable automatic context initialization on object activation and cleanup of state on deactivation.</span></span>

<span data-ttu-id="8ff13-143">Se si esegue il pooling di oggetti che utilizzano l'attivazione JIT COM+, è consigliabile implementare [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="8ff13-143">If you are pooling objects that use COM+ JIT activation, it is highly recommended that you implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="8ff13-144">Per informazioni dettagliate, vedere [pool di oggetti e attivazione JIT com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="8ff13-144">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

## <a name="statelessness-and-jit-activation"></a><span data-ttu-id="8ff13-145">Stato di assenza e attivazione JIT</span><span class="sxs-lookup"><span data-stu-id="8ff13-145">Statelessness and JIT Activation</span></span>

<span data-ttu-id="8ff13-146">Gli oggetti transazionali sono necessariamente senza stato perché non è possibile condividere lo stato attraverso un limite di transazione.</span><span class="sxs-lookup"><span data-stu-id="8ff13-146">Transactional objects are necessarily stateless because you cannot share state across a transaction boundary.</span></span> <span data-ttu-id="8ff13-147">Pertanto, si utilizzerà l'attivazione JIT solo quando l'oggetto non dispone di alcuno stato che andrebbe perso in caso di disattivazione. in caso contrario, si viola l'isolamento delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="8ff13-147">Therefore, you would use JIT activation only when your object holds no state that would be lost on deactivation; otherwise, you violate the isolation of the transactions.</span></span> <span data-ttu-id="8ff13-148">A causa dei modelli di utilizzo naturale degli oggetti transazionali, eseguono alcune unità di lavoro e rilasciano l'oggetto quando viene eseguito il commit o l'interruzione della transazione, ovvero l'attivazione JIT e le transazioni automatiche sono strettamente correlate.</span><span class="sxs-lookup"><span data-stu-id="8ff13-148">Due to the natural use patterns of transactional objects—they do some unit of work and release the object when the transaction commits or aborts—JIT activation and automatic transactions are closely related.</span></span> <span data-ttu-id="8ff13-149">La configurazione di un oggetto per richiedere transazioni Abilita automaticamente l'attivazione JIT COM+.</span><span class="sxs-lookup"><span data-stu-id="8ff13-149">Configuring an object to require transactions enables COM+ JIT activation automatically.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8ff13-150">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8ff13-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8ff13-151">Attività di attivazione JIT di COM+</span><span class="sxs-lookup"><span data-stu-id="8ff13-151">COM+ Just-in-Time Activation Tasks</span></span>](com--just-in-time-activation-tasks.md)
</dt> <dt>

[<span data-ttu-id="8ff13-152">Pool di oggetti e attivazione JIT COM+</span><span class="sxs-lookup"><span data-stu-id="8ff13-152">Object Pooling and COM+ JIT Activation</span></span>](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[<span data-ttu-id="8ff13-153">Transazioni e attivazione JIT COM+</span><span class="sxs-lookup"><span data-stu-id="8ff13-153">Transactions and COM+ JIT Activation</span></span>](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



