---
description: Creazione di un filtro editore
ms.assetid: d91efecc-f02a-41c6-acf7-37b74723e7e8
title: Creazione di un filtro editore
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 997fe37cf0021bcb2aa153c2dc4b73597e0c43cc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127555"
---
# <a name="creating-a-publisher-filter"></a><span data-ttu-id="bbb35-103">Creazione di un filtro editore</span><span class="sxs-lookup"><span data-stu-id="bbb35-103">Creating a Publisher Filter</span></span>

<span data-ttu-id="bbb35-104">Esistono due metodi per stabilire il filtro del server di pubblicazione: utilizzando la proprietà MultiPublisherFilterCLSID della classe di evento o utilizzando [**IEventControl:: SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="bbb35-104">There are two methods to establish the publisher filter: using the MultiPublisherFilterCLSID property of the event class, or using [**IEventControl::SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span>

-   <span data-ttu-id="bbb35-105">Poiché consente di comporre l'oggetto evento con il servizio [componenti in coda com+](com--queued-components.md) , il metodo preferito consiste nell'usare la proprietà MultiPublisherFilterCLSID nella classe di evento per impostare il filtro del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="bbb35-105">Because it allows you to compose the event object with the [COM+ queued components](com--queued-components.md) service, the preferred method is to use the MultiPublisherFilterCLSID property in the event class to set the publisher filter.</span></span> <span data-ttu-id="bbb35-106">Viene stabilito un oggetto filtro per tutti i metodi delle interfacce evento per un oggetto evento.</span><span class="sxs-lookup"><span data-stu-id="bbb35-106">This establishes one filter object for all the methods of the event interfaces for an event object.</span></span> <span data-ttu-id="bbb35-107">L'oggetto evento attiva il filtro del server di pubblicazione quando viene creata un'istanza dell'oggetto classe di evento utilizzando [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="bbb35-107">The event object activates the publisher filter when the event class object is instantiated using [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>
-   <span data-ttu-id="bbb35-108">È anche possibile usare [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="bbb35-108">You can also use [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span> <span data-ttu-id="bbb35-109">Tuttavia, se si sceglie questo metodo, l'interfaccia non è accodabile e pertanto non può utilizzare l'oggetto evento con il servizio componenti in coda COM+ tra il server di pubblicazione e l'oggetto classe di evento.</span><span class="sxs-lookup"><span data-stu-id="bbb35-109">However, if you choose this method, the interface is not queuable and therefore cannot use the event object with the COM+ queued components service between the publisher and the event class object.</span></span> <span data-ttu-id="bbb35-110">Per ulteriori informazioni sull'utilizzo del servizio componenti in coda con eventi COM+, vedere [utilizzo di eventi com+ con componenti in coda com+](using-com--events-with-com--queued-components.md).</span><span class="sxs-lookup"><span data-stu-id="bbb35-110">For additional information about using the queued components service with COM+ Events, see [Using COM+ Events with COM+ Queued Components](using-com--events-with-com--queued-components.md).</span></span>

<span data-ttu-id="bbb35-111">Un evento può contenere uno o più oggetti filtro o nessuno.</span><span class="sxs-lookup"><span data-stu-id="bbb35-111">An event can have one or more filter objects or none at all.</span></span> <span data-ttu-id="bbb35-112">Gli oggetti filtro del server di pubblicazione devono supportare [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) o [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), a seconda che si disponga di una singola interfaccia di attivazione o di più interfacce di attivazione nell'oggetto classe di evento.</span><span class="sxs-lookup"><span data-stu-id="bbb35-112">The publisher filter objects must support either [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) or [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), depending on whether you have a single firing interface or multiple firing interfaces on the event class object.</span></span> <span data-ttu-id="bbb35-113">Le interfacce **IPublisherFilter** e **IMultiInterfacePublisherFilter** specificano entrambe un metodo **Initialize** .</span><span class="sxs-lookup"><span data-stu-id="bbb35-113">The **IPublisherFilter** and **IMultiInterfacePublisherFilter** interfaces both specify an **Initialize** method.</span></span> <span data-ttu-id="bbb35-114">Il metodo **Initialize** viene chiamato dall'oggetto della classe di evento immediatamente dopo la creazione dell'oggetto Filter.</span><span class="sxs-lookup"><span data-stu-id="bbb35-114">The **Initialize** method is called by the event class object immediately after creating the filter object.</span></span>

<span data-ttu-id="bbb35-115">Gli eventi COM+ tentano di richiamare due metodi sul filtro.</span><span class="sxs-lookup"><span data-stu-id="bbb35-115">COM+ Events tries to invoke two methods on the filter.</span></span> <span data-ttu-id="bbb35-116">In primo luogo chiama [**IPublisherFilter::P reparetofire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) e passa un puntatore di interfaccia [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) al filtro.</span><span class="sxs-lookup"><span data-stu-id="bbb35-116">First it calls [**IPublisherFilter::PrepareToFire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) and passes an [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) interface pointer to the filter.</span></span> <span data-ttu-id="bbb35-117">Viene quindi eseguita una query sull'oggetto filtro per l'interfaccia evento.</span><span class="sxs-lookup"><span data-stu-id="bbb35-117">Then it queries the filter object for the event interface.</span></span> <span data-ttu-id="bbb35-118">Se il filtro supporta l'interfaccia evento, richiama un metodo su di esso.</span><span class="sxs-lookup"><span data-stu-id="bbb35-118">If the filter supports the event interface, it invokes a method on it.</span></span> <span data-ttu-id="bbb35-119">Ciò consente di accedere ai parametri del server di pubblicazione per un evento.</span><span class="sxs-lookup"><span data-stu-id="bbb35-119">This provides access to the publisher parameters for an event.</span></span> <span data-ttu-id="bbb35-120">Il filtro può usare questi parametri per determinare le sottoscrizioni da attivare.</span><span class="sxs-lookup"><span data-stu-id="bbb35-120">The filter can use these parameters to determine which subscriptions to fire.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bbb35-121">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="bbb35-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bbb35-122">Filtro di eventi in COM+</span><span class="sxs-lookup"><span data-stu-id="bbb35-122">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> </dl>

 

 
