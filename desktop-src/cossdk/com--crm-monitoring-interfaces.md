---
description: L'infrastruttura CRM fornisce un set di interfacce che è possibile utilizzare per il monitoraggio dei dispongono all'interno di una particolare applicazione server.
ms.assetid: b8f40c91-001b-4003-b377-57a918988100
title: Interfacce di monitoraggio COM+ CRM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c893040c46810c980c647cbacdc808200e8d5f5e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104225587"
---
# <a name="com-crm-monitoring-interfaces"></a><span data-ttu-id="c2bfd-103">Interfacce di monitoraggio COM+ CRM</span><span class="sxs-lookup"><span data-stu-id="c2bfd-103">COM+ CRM Monitoring Interfaces</span></span>

<span data-ttu-id="c2bfd-104">L'infrastruttura CRM fornisce un set di interfacce che è possibile utilizzare per il monitoraggio dei dispongono all'interno di una particolare applicazione server.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-104">The CRM infrastructure provides a set of interfaces that can be used for monitoring the CRMs within a particular server application.</span></span> <span data-ttu-id="c2bfd-105">Per accedere alle interfacce di monitoraggio, un componente in esecuzione all'interno dell'applicazione server deve prima creare un clerk CRM specializzato denominato Clerk Recovery CRM.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-105">To access the monitoring interfaces, a component running within the server application must first create a specialized CRM clerk called the CRM recovery clerk.</span></span>

<span data-ttu-id="c2bfd-106">Nell'uso normale di dispongono, le transazioni devono essere di breve durata e, di conseguenza, i ruoli di lavoro e i compensatori CRM sono disponibili per un breve periodo di tempo, in genere solo pochi secondi.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-106">In normal use of CRMs, transactions are expected to be short-lived, and hence CRM Workers and CRM Compensators exist for a brief period of time, typically only a few seconds at most.</span></span> <span data-ttu-id="c2bfd-107">Le interfacce di monitoraggio sono pertanto progettate per fornire uno snapshot dello stato del dispongono in esecuzione in un determinato momento.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-107">The monitoring interfaces are therefore designed to give a snapshot of the state of the executing CRMs at a particular point in time.</span></span> <span data-ttu-id="c2bfd-108">Se si verificano problemi in uno dei dispongono, le interfacce di monitoraggio possono essere usate per azzerare il CRM problematico, esaminare i record di log e interrompere la transazione, se necessario.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-108">If any of the CRMs are having problems, the monitoring interfaces can be used to zero in on the troublesome CRM, to inspect its log records and to abort its transaction if required.</span></span>

<span data-ttu-id="c2bfd-109">Di seguito sono riportate le tre interfacce di monitoraggio CRM e le descrizioni del loro funzionamento.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-109">Following are the three CRM monitoring interfaces and descriptions of how they work.</span></span>



| <span data-ttu-id="c2bfd-110">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="c2bfd-110">Interface</span></span>                                                         | <span data-ttu-id="c2bfd-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c2bfd-111">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c2bfd-112">**ICrmMonitor**</span><span class="sxs-lookup"><span data-stu-id="c2bfd-112">**ICrmMonitor**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitor)<br/>                     | <span data-ttu-id="c2bfd-113">L'uso di [**ICrmMonitor:: Getclerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks)consente di ottenere uno snapshot del set corrente di clerk CRM attivi all'interno dell'applicazione server.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-113">Using [**ICrmMonitor::GetClerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks), a snapshot can be obtained of the current set of active CRM clerks within the server application.</span></span> <span data-ttu-id="c2bfd-114">Da questo, è possibile trovare ed eseguire query su un particolare oggetto raccolta Clerk CRM di interesse, incluso lo stato corrente della transazione e i record di log scritti dal CRM.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-114">From this, a particular CRM clerk collection object of interest can be located and queried, including the current state of its transaction and the log records written by the CRM.</span></span><br/> <span data-ttu-id="c2bfd-115">Quando lo strumento di monitoraggio ha determinato quale Clerk è di interesse, viene chiamato [**ICrmMonitor:: HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) per ottenere un'interfaccia [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) su quel particolare Clerk.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-115">When the monitoring tool has determined which clerk is of interest, it calls [**ICrmMonitor::HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) to get an [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface on that particular clerk.</span></span> <span data-ttu-id="c2bfd-116">A questo punto, lo strumento di monitoraggio contiene un riferimento a tale Clerk e, se la transazione viene completata, il clerk viene mantenuto in memoria e non viene rilasciato fino a quando non viene eseguito lo strumento di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-116">At this point, the monitoring tool is holding a reference to that clerk, and if the transaction completes, the clerk is held in memory and is not released until the monitoring tool is done.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="c2bfd-117">**ICrmMonitorClerks**</span><span class="sxs-lookup"><span data-stu-id="c2bfd-117">**ICrmMonitorClerks**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorclerks)<br/>         | <span data-ttu-id="c2bfd-118">Utilizzando questa interfaccia, è possibile esplorare l'oggetto raccolta Clerk per ottenere informazioni sullo stato della raccolta Clerk nel momento in cui è stato ottenuto.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-118">Using this interface, the clerk collection object can be browsed for information about the state of the clerk collection at the moment it was obtained.</span></span> <span data-ttu-id="c2bfd-119">Queste informazioni includono il numero di Clerk, il ProgID del compensatore CRM usato dal Clerk, la descrizione fornita nel momento in cui il compensatore CRM è stato registrato (usando [**ICrmLogControl:: RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), l'ID unità di transazione e l'ID attività.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-119">This information includes the number of clerks, the ProgID of the CRM Compensator used by the clerk, the description provided at the time the CRM Compensator was registered (using [**ICrmLogControl::RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), the transaction unit-of-work ID, and the activity ID.</span></span> <span data-ttu-id="c2bfd-120">I singoli Clerk sono anche identificati in modo univoco da un "CLSID dell'istanza Clerk", che non è un CLSID COM nel normale senso del termine, ma semplicemente un GUID univoco che identifica questo clerk specifico per la sua durata.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-120">Individual clerks are also uniquely identified by a "clerk instance CLSID," which is not a COM CLSID in the usual sense of the term but simply a unique GUID that identifies this particular clerk for its lifetime.</span></span><br/>                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="c2bfd-121">**ICrmMonitorLogRecords**</span><span class="sxs-lookup"><span data-stu-id="c2bfd-121">**ICrmMonitorLogRecords**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords)<br/> | <span data-ttu-id="c2bfd-122">Questa interfaccia può essere utilizzata per eseguire una query sullo stato corrente della transazione, per individuare il numero di record di log scritti da questo clerk CRM e per ottenere i dati effettivi del record di log.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-122">This interface can be used to query the current state of the transaction, to find out how many log records this CRM clerk has written, and to get the actual log record data.</span></span> <span data-ttu-id="c2bfd-123">I record di log vengono forniti dall'interfaccia [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) nello stesso formato in cui sono stati originariamente scritti (tramite [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span><span class="sxs-lookup"><span data-stu-id="c2bfd-123">The log records are provided from the [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface in the same format that they were originally written (using [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span></span> <span data-ttu-id="c2bfd-124">Inoltre, è possibile implementare facoltativamente **ICrmMonitorLogRecords** per convertire i record di log in formato visualizzabile, in modo che possano essere presentati usando uno strumento di monitoraggio generico.</span><span class="sxs-lookup"><span data-stu-id="c2bfd-124">In addition, **ICrmMonitorLogRecords** can be optionally implemented to convert the log records to viewable format so they can be presented using a generic monitoring tool.</span></span><br/> <span data-ttu-id="c2bfd-125">Poiché [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) viene implementato direttamente nel Clerk CRM, è possibile [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (implementato anche nel Clerk CRM).</span><span class="sxs-lookup"><span data-stu-id="c2bfd-125">Because [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) is implemented directly on the CRM clerk, you can [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (also implemented on the CRM clerk).</span></span> <span data-ttu-id="c2bfd-126">Questo può essere usato per interrompere direttamente la transazione, se necessario ([**ICrmLogControl:: ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span><span class="sxs-lookup"><span data-stu-id="c2bfd-126">This can then be used to directly abort the transaction if required ([**ICrmLogControl::ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="c2bfd-127">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c2bfd-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c2bfd-128">Concetti Gestione risorse di compensazione COM+</span><span class="sxs-lookup"><span data-stu-id="c2bfd-128">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

