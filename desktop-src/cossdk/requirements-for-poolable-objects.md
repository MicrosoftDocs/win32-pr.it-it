---
description: Gli oggetti configurabili devono soddisfare determinati requisiti per consentire l'uso di una singola istanza di oggetto da parte di più client.
ms.assetid: 2cd4211e-be12-4197-8b43-5cb9f2321016
title: Requisiti per gli oggetti pool
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78d6834210f180ad8b514b51b6926b5cd30714fd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103966106"
---
# <a name="requirements-for-poolable-objects"></a><span data-ttu-id="e4930-103">Requisiti per gli oggetti pool</span><span class="sxs-lookup"><span data-stu-id="e4930-103">Requirements for Poolable Objects</span></span>

<span data-ttu-id="e4930-104">Gli oggetti configurabili devono soddisfare determinati requisiti per consentire l'uso di una singola istanza di oggetto da parte di più client.</span><span class="sxs-lookup"><span data-stu-id="e4930-104">Poolable objects must meet certain requirements to enable a single object instance to be used by multiple clients.</span></span>

## <a name="stateless"></a><span data-ttu-id="e4930-105">Senza stato</span><span class="sxs-lookup"><span data-stu-id="e4930-105">Stateless</span></span>

<span data-ttu-id="e4930-106">Per mantenere la sicurezza, la coerenza e l'isolamento, gli oggetti raggruppabili non devono mantenere lo stato specifico del client da client a client.</span><span class="sxs-lookup"><span data-stu-id="e4930-106">To maintain security, consistency, and isolation, poolable objects should hold no client-specific state from client to client.</span></span> <span data-ttu-id="e4930-107">È possibile gestire qualsiasi stato per ogni client usando [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), eseguendo l'inizializzazione specifica del contesto con [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) e pulendo qualsiasi stato del client con [**IObjectControl::D ttiva**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate).</span><span class="sxs-lookup"><span data-stu-id="e4930-107">You can manage any per-client state by using [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), performing context-specific initialization with [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and cleaning up any client state with [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate).</span></span> <span data-ttu-id="e4930-108">Per informazioni dettagliate, vedere [controllo della durata e dello stato degli oggetti](controlling-object-lifetime-and-state.md).</span><span class="sxs-lookup"><span data-stu-id="e4930-108">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="no-thread-affinity"></a><span data-ttu-id="e4930-109">Nessuna affinità di thread</span><span class="sxs-lookup"><span data-stu-id="e4930-109">No Thread Affinity</span></span>

<span data-ttu-id="e4930-110">Impossibile associare oggetti pool a un thread specifico. in caso contrario, le prestazioni potrebbero essere potenzialmente disastrose.</span><span class="sxs-lookup"><span data-stu-id="e4930-110">Poolable objects cannot be bound to a particular thread; otherwise, performance could be potentially disastrous.</span></span> <span data-ttu-id="e4930-111">Per questo motivo, non è possibile contrassegnare gli oggetti pool per l'esecuzione nel modello di Apartment; devono essere eseguiti nell'Apartment a thread multipli o in quello neutro.</span><span class="sxs-lookup"><span data-stu-id="e4930-111">For this reason, poolable objects cannot be marked to run in the apartment model; they must run in the multithreaded apartment or the neutral apartment.</span></span> <span data-ttu-id="e4930-112">Inoltre, gli oggetti del pool non devono usare l'archiviazione locale di thread né devono aggregare il gestore di marshalling a thread libero.</span><span class="sxs-lookup"><span data-stu-id="e4930-112">In addition, poolable objects should not use thread local storage nor should they aggregate the free-threaded marshaler.</span></span> <span data-ttu-id="e4930-113">Per informazioni più dettagliate sul threading in COM+, vedere [modelli di threading com+](com--threading-models.md).</span><span class="sxs-lookup"><span data-stu-id="e4930-113">For more detail about threading in COM+, see [COM+ Threading Models](com--threading-models.md).</span></span>

> [!Note]  
> <span data-ttu-id="e4930-114">Gli ambienti di sviluppo Microsoft Visual Basic 6,0 e versioni precedenti possono creare solo componenti del modello di Apartment.</span><span class="sxs-lookup"><span data-stu-id="e4930-114">The Microsoft Visual Basic 6.0 and earlier development environments can create only apartment model components.</span></span> <span data-ttu-id="e4930-115">Tuttavia, in Visual Basic .NET è possibile raggruppare i componenti.</span><span class="sxs-lookup"><span data-stu-id="e4930-115">However, in Visual Basic .NET, components can be pooled.</span></span>

 

## <a name="aggregatable"></a><span data-ttu-id="e4930-116">Aggregabile</span><span class="sxs-lookup"><span data-stu-id="e4930-116">Aggregatable</span></span>

<span data-ttu-id="e4930-117">Gli oggetti pool devono supportare l'aggregazione, ovvero devono supportare la creazione richiamando [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) con un argomento *pUnkOuter* non null.</span><span class="sxs-lookup"><span data-stu-id="e4930-117">Poolable objects must support aggregation—that is, they must support being created by invoking [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) with a non-NULL *pUnkOuter* argument.</span></span> <span data-ttu-id="e4930-118">Quando COM+ attiva un oggetto in pool, crea un'aggregazione per gestire la durata dell'oggetto in pool e per chiamare i metodi su [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="e4930-118">When COM+ activates a pooled object, it creates an aggregate to manage the lifetime of the pooled object and to call methods on [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="e4930-119">Per informazioni dettagliate sulla scrittura di oggetti aggregabili, vedere [aggregazione](/windows/desktop/com/aggregation).</span><span class="sxs-lookup"><span data-stu-id="e4930-119">For details on writing aggregatable objects, see [Aggregation](/windows/desktop/com/aggregation).</span></span>

## <a name="transactional-components"></a><span data-ttu-id="e4930-120">Componenti transazionali</span><span class="sxs-lookup"><span data-stu-id="e4930-120">Transactional Components</span></span>

<span data-ttu-id="e4930-121">Gli oggetti pool che fanno parte delle transazioni devono integrare manualmente le risorse gestite.</span><span class="sxs-lookup"><span data-stu-id="e4930-121">Poolable objects that participate in transactions must manually enlist managed resources.</span></span> <span data-ttu-id="e4930-122">Quando viene inserito in un pool, se l'oggetto contiene una risorsa gestita, ad esempio una connessione di database, non sarà possibile eseguire automaticamente l'integrazione di Resource Manager in una transazione quando l'oggetto viene attivato nel contesto specificato.</span><span class="sxs-lookup"><span data-stu-id="e4930-122">While it is pooled, if your object holds a managed resource such as a database connection, there will be no way for the resource manager to automatically enlist in a transaction when the object is activated in given context.</span></span> <span data-ttu-id="e4930-123">Pertanto, è necessario che l'oggetto stesso gestisca la logica di rilevamento della transazione, disattivando l'integrazione automatica di Resource Manager e integrando manualmente tutte le risorse che possiede.</span><span class="sxs-lookup"><span data-stu-id="e4930-123">Therefore, the object itself must handle the logic of detecting the transaction, turning off the resource manager's auto-enlistment and manually enlisting any resources that it holds.</span></span> <span data-ttu-id="e4930-124">Inoltre, un oggetto in pool transazionale deve riflettere lo stato corrente delle risorse nei valori dei parametri di [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span><span class="sxs-lookup"><span data-stu-id="e4930-124">In addition, a transactional pooled object should reflect the current state of its resources in the parameter values of [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span></span> <span data-ttu-id="e4930-125">Per informazioni dettagliate, vedere [pooling di oggetti transazionali](pooling-transactional-objects.md).</span><span class="sxs-lookup"><span data-stu-id="e4930-125">For more detail, see [Pooling Transactional Objects](pooling-transactional-objects.md).</span></span>

## <a name="implement-iobjectcontrol-to-manage-the-object-lifetime"></a><span data-ttu-id="e4930-126">Implementare IObjectControl per gestire la durata degli oggetti</span><span class="sxs-lookup"><span data-stu-id="e4930-126">Implement IObjectControl to Manage the Object Lifetime</span></span>

<span data-ttu-id="e4930-127">Gli oggetti in pool devono implementare [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), anche se non è strettamente necessario.</span><span class="sxs-lookup"><span data-stu-id="e4930-127">Poolable objects should implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), although it is not strictly necessary to do so.</span></span> <span data-ttu-id="e4930-128">I componenti transazionali in pool devono tuttavia implementare **IObjectControl**.</span><span class="sxs-lookup"><span data-stu-id="e4930-128">Transactional components that are pooled, however, must implement **IObjectControl**.</span></span> <span data-ttu-id="e4930-129">Questi componenti dovrebbero monitorare lo stato delle risorse che contengono e indicano quando non possono essere riutilizzati. Quando [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) restituisce false, verrà eliminata una transazione.</span><span class="sxs-lookup"><span data-stu-id="e4930-129">These components should monitor the state of the resources they hold and indicate when they can't be reused; when [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) returns false, it will doom a transaction.</span></span> <span data-ttu-id="e4930-130">Per informazioni dettagliate, vedere [controllo della durata e dello stato degli oggetti](controlling-object-lifetime-and-state.md).</span><span class="sxs-lookup"><span data-stu-id="e4930-130">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="language-restrictions"></a><span data-ttu-id="e4930-131">Limitazioni della lingua</span><span class="sxs-lookup"><span data-stu-id="e4930-131">Language Restrictions</span></span>

<span data-ttu-id="e4930-132">I componenti sviluppati con Microsoft Visual Basic 6,0 e versioni precedenti non possono essere raggruppati in quanto questi componenti saranno con threading di tipo Apartment.</span><span class="sxs-lookup"><span data-stu-id="e4930-132">Components developed using Microsoft Visual Basic 6.0 and earlier cannot be pooled because these components will be apartment-model threaded.</span></span> <span data-ttu-id="e4930-133">Tuttavia, in Visual Basic .NET è possibile raggruppare i componenti.</span><span class="sxs-lookup"><span data-stu-id="e4930-133">However, in Visual Basic .NET, components can be pooled.</span></span>

## <a name="legacy-components"></a><span data-ttu-id="e4930-134">Componenti legacy</span><span class="sxs-lookup"><span data-stu-id="e4930-134">Legacy Components</span></span>

<span data-ttu-id="e4930-135">Fino a quando non sono transazionali e sono conformi ai requisiti precedenti appropriati, i componenti possono essere inseriti in un pool anche se non sono stati scritti specificamente con la capacità del pool.</span><span class="sxs-lookup"><span data-stu-id="e4930-135">As long as they are non-transactional and conform to the appropriate preceding requirements, components can be pooled even if they were not specifically written with pooling capability in mind.</span></span> <span data-ttu-id="e4930-136">Non è necessario implementare [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol). un componente che non esegue questa operazione non farà semplicemente parte della gestione del suo ciclo di vita.</span><span class="sxs-lookup"><span data-stu-id="e4930-136">It is not necessary to implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol); a component that does not do so simply won't participate in managing its lifetime.</span></span> <span data-ttu-id="e4930-137">Se [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) non è implementato, l'oggetto continuerà a essere usato fino a quando il pool non raggiunge la dimensione massima.</span><span class="sxs-lookup"><span data-stu-id="e4930-137">If [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) is not implemented, the object will continue to be reused until the pool attains maximum size.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e4930-138">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="e4930-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e4930-139">Stringhe del costruttore di oggetti COM+</span><span class="sxs-lookup"><span data-stu-id="e4930-139">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="e4930-140">Controllo della durata e dello stato degli oggetti</span><span class="sxs-lookup"><span data-stu-id="e4930-140">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="e4930-141">Funzionamento del pool di oggetti</span><span class="sxs-lookup"><span data-stu-id="e4930-141">How Object Pooling Works</span></span>](how-object-pooling-works.md)
</dt> <dt>

[<span data-ttu-id="e4930-142">Miglioramento delle prestazioni con il pool di oggetti</span><span class="sxs-lookup"><span data-stu-id="e4930-142">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)
</dt> <dt>

[<span data-ttu-id="e4930-143">Raggruppamento di oggetti transazionali</span><span class="sxs-lookup"><span data-stu-id="e4930-143">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> </dl>

 

 
