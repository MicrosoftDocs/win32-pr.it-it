---
description: Il servizio eventi COM+ utilizza un oggetto classe di evento per gestire la connessione tra server di pubblicazione e Sottoscrittore.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: Oggetto della classe di evento COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aae397f647354ac24395fa073365160829a687a2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "103966104"
---
# <a name="the-com-event-class-object"></a><span data-ttu-id="8d0be-103">Oggetto della classe di evento COM+</span><span class="sxs-lookup"><span data-stu-id="8d0be-103">The COM+ Event Class Object</span></span>

<span data-ttu-id="8d0be-104">Il servizio eventi COM+ utilizza un *oggetto classe di evento* per gestire la connessione tra server di pubblicazione e Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="8d0be-104">The COM+ Events service uses an *event class object* to manage the connection between publisher and subscriber.</span></span> <span data-ttu-id="8d0be-105">L'oggetto della classe di evento è un componente COM+ gestito e archiviato dal sistema di eventi COM+ e contiene le interfacce e i metodi utilizzati da un server di pubblicazione per generare eventi.</span><span class="sxs-lookup"><span data-stu-id="8d0be-105">The event class object is a COM+ component that is managed and stored by the COM+ Events system and contains the interfaces and methods used by a publisher to fire events.</span></span> <span data-ttu-id="8d0be-106">Si tratta di un oggetto persistente che indica gli eventi che possono verificarsi e, facoltativamente, identifica il server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8d0be-106">It is a persistent object that indicates the events that can occur and, optionally, identifies the publisher.</span></span> <span data-ttu-id="8d0be-107">È possibile specificare le interfacce e i metodi che devono essere contenuti in una classe di evento fornendo una libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="8d0be-107">You specify the interfaces and methods you want an event class to contain by providing a type library.</span></span>

<span data-ttu-id="8d0be-108">Per generare un evento, il server di pubblicazione crea un'istanza dell'oggetto della classe di evento chiamando [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) o il metodo **CreateObject** Microsoft Visual Basic e richiedendo che venga restituita l'interfaccia evento.</span><span class="sxs-lookup"><span data-stu-id="8d0be-108">To fire an event, the publisher instantiates the event class object by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or the Microsoft Visual Basic **CreateObject** method and requesting the event interface be returned.</span></span> <span data-ttu-id="8d0be-109">L'oggetto della classe di evento di cui è stata creata un'istanza contiene l'implementazione del sistema di eventi dell'interfaccia richiesta.</span><span class="sxs-lookup"><span data-stu-id="8d0be-109">The instantiated event class object contains the event system's implementation of the requested interface.</span></span> <span data-ttu-id="8d0be-110">Un Sottoscrittore interessato deve implementare anche l'interfaccia della classe di evento per ricevere eventi da un server di pubblicazione specificato.</span><span class="sxs-lookup"><span data-stu-id="8d0be-110">An interested subscriber must also implement the event class interface to receive events from a given publisher.</span></span> <span data-ttu-id="8d0be-111">Quando viene creata un'istanza dell'oggetto della classe di evento, il sistema di eventi lo associa ai sottoscrittori appropriati.</span><span class="sxs-lookup"><span data-stu-id="8d0be-111">When the event class object is instantiated, the event system associates it with the appropriate subscribers.</span></span> <span data-ttu-id="8d0be-112">L'elenco di sottoscrittori viene mantenuto per la durata dell'oggetto classe di evento.</span><span class="sxs-lookup"><span data-stu-id="8d0be-112">The list of subscribers is maintained for the lifetime of the event class object.</span></span> <span data-ttu-id="8d0be-113">Un evento può essere recapitato a più Sottoscrittori in serie o in parallelo.</span><span class="sxs-lookup"><span data-stu-id="8d0be-113">An event can be delivered to multiple subscribers either serially or in parallel.</span></span>

<span data-ttu-id="8d0be-114">Quando si implementa un oggetto della classe di evento, è necessario fornire una DLL con registrazione automatica che esporti le funzioni [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) e [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) .</span><span class="sxs-lookup"><span data-stu-id="8d0be-114">When you implement an event class object, you should provide a self-registering DLL that exports the [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) and [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) functions.</span></span> <span data-ttu-id="8d0be-115">La funzione **DllRegisterServer** registra una classe com e la funzione **DllUnregisterServer** Annulla la registrazione del componente.</span><span class="sxs-lookup"><span data-stu-id="8d0be-115">The **DllRegisterServer** function registers a COM class, and the **DllUnregisterServer** function unregisters the component.</span></span> <span data-ttu-id="8d0be-116">Gli oggetti della classe di evento vengono archiviati nel catalogo COM+ utilizzando lo strumento di amministrazione Servizi componenti o a livello di codice utilizzando i metodi delle interfacce [**ICOMAdminCatalog:: InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) o [**ICOMAdminCatalog:: InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) .</span><span class="sxs-lookup"><span data-stu-id="8d0be-116">Event class objects are stored in the COM+ catalog, either by using the Component Services administration tool or programmatically by using the methods of the [**ICOMAdminCatalog::InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) or [**ICOMAdminCatalog::InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) interfaces.</span></span> <span data-ttu-id="8d0be-117">Per informazioni dettagliate sulla registrazione di oggetti della classe di evento, vedere [registrazione di una classe di evento](registering-an-event-class.md).</span><span class="sxs-lookup"><span data-stu-id="8d0be-117">For detailed information about registering event class objects, see [Registering an Event Class](registering-an-event-class.md).</span></span>

<span data-ttu-id="8d0be-118">Poiché gli oggetti della classe di evento sono componenti configurati, è possibile configurare altri attributi, ad esempio l'accodamento, le transazioni, la sicurezza e così via, usando lo strumento di amministrazione Servizi componenti o le funzioni SDK di amministrazione COM+.</span><span class="sxs-lookup"><span data-stu-id="8d0be-118">Because event class objects are configured components, other attributes, such as queuing, transactions, security, and so on, can be configured for them by using either the Component Services administration tool or the COM+ Administrative SDK functions.</span></span>

> [!Note]  
> <span data-ttu-id="8d0be-119">Il servizio eventi COM+ utilizza il marshalling della libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="8d0be-119">The COM+ Events service uses type library marshaling.</span></span> <span data-ttu-id="8d0be-120">Questa operazione impone alcune restrizioni sulle interfacce della classe di evento.</span><span class="sxs-lookup"><span data-stu-id="8d0be-120">This places some restrictions on event class interfaces.</span></span> <span data-ttu-id="8d0be-121">Ad esempio, il gestore di marshalling della libreria dei tipi non supporta [**le \_ dimensioni**](/windows/desktop/Midl/size-is) degli attributi MIDL e la [**lunghezza \_ è**](/windows/desktop/Midl/length-is).</span><span class="sxs-lookup"><span data-stu-id="8d0be-121">For example, the type library marshaler does not support the MIDL attributes [**size\_is**](/windows/desktop/Midl/size-is) and [**length\_is**](/windows/desktop/Midl/length-is).</span></span>

 

<span data-ttu-id="8d0be-122">Un oggetto della classe di evento dispone degli attributi di pubblicazione che determinano la modalità di pubblicazione degli eventi, nonché le proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="8d0be-122">An event class object possesses publication attributes that determine the way events are published, as well as the following properties:</span></span>

-   <span data-ttu-id="8d0be-123">**EventCLSID**.</span><span class="sxs-lookup"><span data-stu-id="8d0be-123">**EventCLSID**.</span></span> <span data-ttu-id="8d0be-124">Identificatore univoco che specifica il CLSID del componente.</span><span class="sxs-lookup"><span data-stu-id="8d0be-124">A unique identifier that specifies the CLSID of the component.</span></span>
-   <span data-ttu-id="8d0be-125">**EventClassName**.</span><span class="sxs-lookup"><span data-stu-id="8d0be-125">**EventClassName**.</span></span> <span data-ttu-id="8d0be-126">Identificatore univoco che specifica il PROGID del componente.</span><span class="sxs-lookup"><span data-stu-id="8d0be-126">A unique identifier that specifies the PROGID of the component.</span></span>
-   <span data-ttu-id="8d0be-127">**Libreria dei tipi**.</span><span class="sxs-lookup"><span data-stu-id="8d0be-127">**TypeLibrary**.</span></span> <span data-ttu-id="8d0be-128">Fornisce un elenco di interfacce offerte dall'oggetto della classe di evento.</span><span class="sxs-lookup"><span data-stu-id="8d0be-128">Provides a list of interfaces offered by the event class object.</span></span> <span data-ttu-id="8d0be-129">Non è necessario implementare le interfacce di attivazione specificate nella libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="8d0be-129">There is no need to implement the firing interfaces specified in the type library.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8d0be-130">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8d0be-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8d0be-131">Considerazioni sulla sicurezza degli eventi COM+</span><span class="sxs-lookup"><span data-stu-id="8d0be-131">COM+ Events Security Considerations</span></span>](com--events-security-considerations.md)
</dt> <dt>

[<span data-ttu-id="8d0be-132">Filtro di eventi in COM+</span><span class="sxs-lookup"><span data-stu-id="8d0be-132">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="8d0be-133">Pubblicazione e distribuzione di eventi in COM+</span><span class="sxs-lookup"><span data-stu-id="8d0be-133">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="8d0be-134">Sottoscrizioni</span><span class="sxs-lookup"><span data-stu-id="8d0be-134">Subscriptions</span></span>](subscriptions.md)
</dt> <dt>

[<span data-ttu-id="8d0be-135">Uso di eventi COM+ con componenti in coda COM+</span><span class="sxs-lookup"><span data-stu-id="8d0be-135">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 
