---
description: Passaggio di oggetti come parametri
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Passaggio di oggetti come parametri
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104524042"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="00570-103">Passaggio di oggetti come parametri</span><span class="sxs-lookup"><span data-stu-id="00570-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="00570-104">Il servizio componenti in coda COM+ non Abilita l'accodamento per ogni componente COM esistente.</span><span class="sxs-lookup"><span data-stu-id="00570-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="00570-105">Esistono restrizioni sui tipi di metodi che possono essere accodati.</span><span class="sxs-lookup"><span data-stu-id="00570-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="00570-106">A causa dei vincoli di messaggistica, i metodi devono rispettare le regole seguenti:</span><span class="sxs-lookup"><span data-stu-id="00570-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="00570-107">Devono contenere solo parametri di input.</span><span class="sxs-lookup"><span data-stu-id="00570-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="00570-108">Non devono restituire risultati specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="00570-108">They must return no application-specific result.</span></span>

<span data-ttu-id="00570-109">Esistono inoltre restrizioni sui tipi di parametri di input che possono essere passati a un componente in coda.</span><span class="sxs-lookup"><span data-stu-id="00570-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="00570-110">In fase di esecuzione, il servizio componenti in coda crea il pacchetto degli argomenti nel client e li passa al componente server utilizzando [Accodamento messaggi](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="00570-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="00570-111">È possibile eseguire facilmente il marshalling di tipi semplici, ad esempio numeri interi e booleani. i tipi più complessi non possono essere sottoposti a marshalling senza guida.</span><span class="sxs-lookup"><span data-stu-id="00570-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="00570-112">Nel caso di passaggio di un oggetto tramite la chiamata al metodo di un componente in coda come parametro, il client passa l'oggetto al registratore.</span><span class="sxs-lookup"><span data-stu-id="00570-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="00570-113">Il registratore esegue il marshalling dell'oggetto in un messaggio di Accodamento messaggi e lo passa al listener.</span><span class="sxs-lookup"><span data-stu-id="00570-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="00570-114">Quando il listener preleva il messaggio e lo passa al lettore, il lettore deve creare una nuova istanza dell'oggetto per inviarlo alla chiamata al metodo specificata dal client.</span><span class="sxs-lookup"><span data-stu-id="00570-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="00570-115">In base alla durata del client e del server in un ambiente in coda, l'implicazione è che questi oggetti devono essere in grado di effettuare il marshalling in base al valore.</span><span class="sxs-lookup"><span data-stu-id="00570-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="00570-116">Poiché COM+ non fornisce la semantica pass-by-value per gli oggetti COM standard, il registratore e il lettore necessitano di assistenza dal componente per eseguire il marshalling e l'unmarshalling dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="00570-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="00570-117">I riferimenti agli oggetti che supportano [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) possono essere usati come parametri per le chiamate ai metodi sui componenti in coda.</span><span class="sxs-lookup"><span data-stu-id="00570-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="00570-118">L'oggetto non può fare supposizioni su quando verrà ricreata la nuova istanza.</span><span class="sxs-lookup"><span data-stu-id="00570-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="00570-119">È ad esempio possibile che il server non sia disponibile o che il componente server non venga avviato solo in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="00570-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="00570-120">Gli oggetti che non supportano **IPersistStream** restituiranno un errore.</span><span class="sxs-lookup"><span data-stu-id="00570-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="00570-121">Visual Basic di oggetti resi permanente</span><span class="sxs-lookup"><span data-stu-id="00570-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="00570-122">Microsoft Visual Basic 6 consente la creazione di oggetti salvati in modo permanente.</span><span class="sxs-lookup"><span data-stu-id="00570-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="00570-123">Questi oggetti supportano [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) e possono essere passati come parametri alle chiamate al metodo del componente in coda.</span><span class="sxs-lookup"><span data-stu-id="00570-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="00570-124">Prima che un oggetto Visual Basic possa essere passato a un componente in coda, è necessario inizializzare l'oggetto permanente.</span><span class="sxs-lookup"><span data-stu-id="00570-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="00570-125">Questa operazione può essere eseguita in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="00570-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="00570-126">Se l'applicazione che crea l'oggetto permanente viene scritta in Visual Basic, il runtime di Visual Basic gestisce automaticamente l'inizializzazione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="00570-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="00570-127">Se l'applicazione che crea il Visual Basic oggetto permanente viene scritta in una lingua diversa da Visual Basic, ad esempio Microsoft Visual C++, l'applicazione deve inizializzare in modo esplicito il componente eseguendo una query per l'interfaccia [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) dell'oggetto permanente oppure chiamando il metodo [**IPersistStreamInit:: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)o [**IPersistStream:: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) .</span><span class="sxs-lookup"><span data-stu-id="00570-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="00570-128">Recordset ADO e set di righe OLE DB</span><span class="sxs-lookup"><span data-stu-id="00570-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="00570-129">Il passaggio di oggetti **Recordset** ADO o OLE DB set di righe tra componenti consente a un componente di elaborare i risultati delle query eseguite da un altro componente.</span><span class="sxs-lookup"><span data-stu-id="00570-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="00570-130">Questa operazione è utile quando si distribuisce un'applicazione in più computer.</span><span class="sxs-lookup"><span data-stu-id="00570-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="00570-131">Gli oggetti **Recordset** e set di righe possono essere passati come parametri del metodo ai componenti in coda, con le restrizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="00570-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="00570-132">Impossibile effettuare il marshalling degli oggetti **Recordset** sul lato server utilizzando [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="00570-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="00570-133">Solo gli oggetti **Recordset** lato client possono essere passati come parametri a una chiamata al metodo del componente in coda.</span><span class="sxs-lookup"><span data-stu-id="00570-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="00570-134">Se si lavora direttamente con OLE DB, il set di righe OLE DB deve essere definito come set di righe lato client.</span><span class="sxs-lookup"><span data-stu-id="00570-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
