---
description: "I dati della sottoscrizione si trovano nel catalogo COM+ della sottoscrizione. È possibile creare una sottoscrizione usando lo strumento di amministrazione Servizi componenti o a livello di codice usando l'interfaccia ICOMAdminCatalog:: InstallComponent."
ms.assetid: 190e88f3-1d87-4c27-9451-0a633cbae829
title: Sottoscrizioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9973eb76fc22354f1a2fc8e381c90cf5be1efee3
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104225632"
---
# <a name="subscriptions"></a><span data-ttu-id="0b554-104">Sottoscrizioni</span><span class="sxs-lookup"><span data-stu-id="0b554-104">Subscriptions</span></span>

<span data-ttu-id="0b554-105">I dati della sottoscrizione si trovano nel catalogo COM+ della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="0b554-105">Subscription data resides in the subscription COM+ catalog.</span></span> <span data-ttu-id="0b554-106">È possibile creare una sottoscrizione usando lo strumento di amministrazione Servizi componenti o a livello di codice usando l'interfaccia [**ICOMAdminCatalog:: InstallComponent**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installcomponent) .</span><span class="sxs-lookup"><span data-stu-id="0b554-106">A subscription can be created either by using the Component Services administrative tool or programmatically by using the [**ICOMAdminCatalog::InstallComponent**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installcomponent) interface.</span></span>

<span data-ttu-id="0b554-107">La raccolta [**SubscriptionsForComponent**](subscriptionsforcomponent.md) viene utilizzata per aggiungere, eliminare o modificare le informazioni relative alle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="0b554-107">The [**SubscriptionsForComponent**](subscriptionsforcomponent.md) collection is used to add, delete, or change information pertaining to subscriptions.</span></span> <span data-ttu-id="0b554-108">La raccolta **SubscriptionsForComponent** è una raccolta figlio di un componente.</span><span class="sxs-lookup"><span data-stu-id="0b554-108">The **SubscriptionsForComponent** collection is a child collection to a component.</span></span> <span data-ttu-id="0b554-109">Per aggiungere una sottoscrizione, ottenere la raccolta **SubscriptionsForComponent** del componente e usare il metodo [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) per aggiungere una voce alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="0b554-109">To add a subscription, get the component's **SubscriptionsForComponent** collection and use the [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) method to add an entry to the collection.</span></span> <span data-ttu-id="0b554-110">Per impostare le varie proprietà dell'oggetto sottoscrizione, utilizzare la proprietà [**valore**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_value) .</span><span class="sxs-lookup"><span data-stu-id="0b554-110">To set up the various properties of the subscription object, use the [**Value**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_value) property.</span></span> <span data-ttu-id="0b554-111">Per salvare le modifiche, usare [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) nell'oggetto della raccolta **SubscriptionsForComponent** .</span><span class="sxs-lookup"><span data-stu-id="0b554-111">To save the changes, use [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) on the **SubscriptionsForComponent** collection object.</span></span>

<span data-ttu-id="0b554-112">È inoltre possibile utilizzare lo strumento di amministrazione Servizi componenti per modificare alcune delle proprietà della sottoscrizione, ma non tutte.</span><span class="sxs-lookup"><span data-stu-id="0b554-112">You can also use the Component Services administration tool to modify some, but not all, of the subscription properties.</span></span> <span data-ttu-id="0b554-113">Le sottoscrizioni specificano le seguenti informazioni:</span><span class="sxs-lookup"><span data-stu-id="0b554-113">Subscriptions specify the following information:</span></span>

-   <span data-ttu-id="0b554-114">Identità e percorso del Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="0b554-114">Identity and location of the subscriber</span></span>
-   <span data-ttu-id="0b554-115">Metodo di distribuzione</span><span class="sxs-lookup"><span data-stu-id="0b554-115">Delivery method</span></span>
-   <span data-ttu-id="0b554-116">Metodi di evento da recapitare</span><span class="sxs-lookup"><span data-stu-id="0b554-116">Event methods to deliver</span></span>
-   <span data-ttu-id="0b554-117">Oggetto classe di evento e proprietà PublisherID di un componente della classe di evento da cui il sottoscrittore desidera ricevere eventi</span><span class="sxs-lookup"><span data-stu-id="0b554-117">Event class object and PublisherID property of an event class component from which the subscriber wants to receive events</span></span>

<span data-ttu-id="0b554-118">Le sottoscrizioni esistono indipendentemente dagli oggetti della classe di evento.</span><span class="sxs-lookup"><span data-stu-id="0b554-118">Subscriptions exist independently from event class objects.</span></span> <span data-ttu-id="0b554-119">È possibile disabilitare una sottoscrizione impostando la proprietà Enabled su false.</span><span class="sxs-lookup"><span data-stu-id="0b554-119">You can disable a subscription by setting the Enabled property to False.</span></span> <span data-ttu-id="0b554-120">Una sottoscrizione disabilitata non viene chiamata dagli eventi COM+.</span><span class="sxs-lookup"><span data-stu-id="0b554-120">A disabled subscription is not called by COM+ Events.</span></span>

<span data-ttu-id="0b554-121">Di seguito sono riportati i tre tipi di sottoscrizioni:</span><span class="sxs-lookup"><span data-stu-id="0b554-121">The three types of subscriptions are as follows:</span></span>

<dl> <dt>

<span data-ttu-id="0b554-122"><span id="Persistent"></span><span id="persistent"></span><span id="PERSISTENT"></span>Persistente</span><span class="sxs-lookup"><span data-stu-id="0b554-122"><span id="Persistent"></span><span id="persistent"></span><span id="PERSISTENT"></span>Persistent</span></span>
</dt> <dd>

<span data-ttu-id="0b554-123">Le sottoscrizioni permanenti si trovano nel catalogo COM+ e sono indipendenti dalla durata del Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="0b554-123">Persistent subscriptions reside in the COM+ catalog and are independent from the subscriber's lifetime.</span></span> <span data-ttu-id="0b554-124">Le sottoscrizioni permanenti rimangono in un riavvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="0b554-124">Persistent subscriptions survive a system restart.</span></span> <span data-ttu-id="0b554-125">In genere, viene creata una sottoscrizione permanente quando un'applicazione viene installata nel computer di un Sottoscrittore e viene rimossa quando l'applicazione viene rimossa.</span><span class="sxs-lookup"><span data-stu-id="0b554-125">Generally, a persistent subscription is created when an application is installed on a subscriber's computer and removed when the application is removed.</span></span> <span data-ttu-id="0b554-126">Dopo la creazione di una sottoscrizione permanente, gli eventi COM+ attivano il Sottoscrittore ogni volta che un evento deve essere recapitato.</span><span class="sxs-lookup"><span data-stu-id="0b554-126">After a persistent subscription is created, COM+ Events activates the subscriber each time an event should be delivered to it.</span></span>

<span data-ttu-id="0b554-127">Quando un server di pubblicazione crea un'istanza ed esegue una chiamata su un oggetto della [classe di evento](the-com--event-class-object.md) , l'oggetto Cerca tutte le sottoscrizioni permanenti nel catalogo com+ e crea una nuova istanza di ogni oggetto.</span><span class="sxs-lookup"><span data-stu-id="0b554-127">When a publisher instantiates and makes a call on an [event class](the-com--event-class-object.md) object, the object looks for all the persistent subscriptions in the COM+ catalog and creates a new instance of each object.</span></span> <span data-ttu-id="0b554-128">Il processo di creazione può essere diretto o tramite un moniker per i componenti in coda.</span><span class="sxs-lookup"><span data-stu-id="0b554-128">The creation process can be either direct or through a moniker for queued components.</span></span> <span data-ttu-id="0b554-129">Specificare l'oggetto Sottoscrittore tramite la proprietà [**SubscriberMoniker**](subscriptionsforcomponent.md) della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="0b554-129">Specify the subscriber object by the [**SubscriberMoniker**](subscriptionsforcomponent.md) property of the subscription.</span></span> <span data-ttu-id="0b554-130">Gli oggetti del Sottoscrittore creati da una sottoscrizione permanente vengono sempre rilasciati dopo ogni chiamata di evento.</span><span class="sxs-lookup"><span data-stu-id="0b554-130">Subscriber objects created by a persistent subscription are always released after each event call.</span></span>

</dd> <dt>

<span data-ttu-id="0b554-131"><span id="Transient"></span><span id="transient"></span><span id="TRANSIENT"></span>Transitoria</span><span class="sxs-lookup"><span data-stu-id="0b554-131"><span id="Transient"></span><span id="transient"></span><span id="TRANSIENT"></span>Transient</span></span>
</dt> <dd>

<span data-ttu-id="0b554-132">Per le sottoscrizioni temporanee, è possibile usare la raccolta [**TransientSubscriptions**](transientsubscriptions.md) , il cui oggetto padre è l'oggetto Catalogo radice.</span><span class="sxs-lookup"><span data-stu-id="0b554-132">For transient subscriptions, you can use the [**TransientSubscriptions**](transientsubscriptions.md) collection, whose parent object is the root catalog object.</span></span> <span data-ttu-id="0b554-133">Le sottoscrizioni temporanee richiedono un evento per un oggetto Sottoscrittore specifico già esistente.</span><span class="sxs-lookup"><span data-stu-id="0b554-133">Transient subscriptions request an event for a specific subscriber object that already exists.</span></span> <span data-ttu-id="0b554-134">Le sottoscrizioni temporanee vengono archiviate nel catalogo COM+, ma la sottoscrizione viene eliminata se il sistema operativo o il sistema operativo viene arrestato.</span><span class="sxs-lookup"><span data-stu-id="0b554-134">Transient subscriptions are stored in the COM+ catalog, but the subscription is deleted if the event system or operating system is stopped.</span></span> <span data-ttu-id="0b554-135">Diversamente dalle sottoscrizioni permanenti, le sottoscrizioni temporanee sono associate a un determinato oggetto e vengono archiviate solo nel sistema di eventi.</span><span class="sxs-lookup"><span data-stu-id="0b554-135">Unlike persistent subscriptions, transient subscriptions are tied to a particular object and are stored only in the event system.</span></span> <span data-ttu-id="0b554-136">Le sottoscrizioni temporanee possono essere più efficienti rispetto alle sottoscrizioni persistenti, ma è necessario gestire i cicli di vita degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="0b554-136">Transient subscriptions can be more efficient than persistent subscriptions, but you must manage their object life cycles.</span></span> <span data-ttu-id="0b554-137">Per informazioni sulla registrazione di una sottoscrizione temporanea, vedere la pagina relativa alla [registrazione di una sottoscrizione temporanea](registering-a-transient-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="0b554-137">For information about registering a transient subscription, see [Registering a Transient Subscription](registering-a-transient-subscription.md).</span></span>

</dd> <dt>

<span data-ttu-id="0b554-138"><span id="Per_user"></span><span id="per_user"></span><span id="PER_USER"></span>Per utente</span><span class="sxs-lookup"><span data-stu-id="0b554-138"><span id="Per_user"></span><span id="per_user"></span><span id="PER_USER"></span>Per user</span></span>
</dt> <dd>

<span data-ttu-id="0b554-139">Le sottoscrizioni per utente possono recapitare gli eventi solo quando il Sottoscrittore è connesso al computer del sistema di eventi.</span><span class="sxs-lookup"><span data-stu-id="0b554-139">Per User subscriptions can deliver events only when the subscriber is logged on to the event system's computer.</span></span> <span data-ttu-id="0b554-140">Quando il Sottoscrittore esegue l'accesso, il sistema di eventi Abilita tutte le sottoscrizioni per cui il flag di *lettura* è impostato su **true** e *username* è impostato sul nome dell'utente che ha eseguito l'accesso.</span><span class="sxs-lookup"><span data-stu-id="0b554-140">When the subscriber logs on, the event system enables all subscriptions on which the *PerUser* flag is set to **TRUE** and *UserName* is set to the name of the user who is logged on.</span></span> <span data-ttu-id="0b554-141">Quando il Sottoscrittore si disconnette, le sottoscrizioni vengono disabilitate.</span><span class="sxs-lookup"><span data-stu-id="0b554-141">When the subscriber logs off, the subscriptions are disabled.</span></span>

<span data-ttu-id="0b554-142">Le sottoscrizioni per utente sono valide solo quando il server di pubblicazione e il Sottoscrittore si trovano nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="0b554-142">Per User subscriptions are effective only when the publisher and subscriber are on the same computer.</span></span> <span data-ttu-id="0b554-143">L'accesso e la disconnessione vengono rilevati solo nel computer del server di pubblicazione, non nel computer in cui risiede l'oggetto Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="0b554-143">Logon and logoff are detected only at the publisher's computer—not the computer on which the subscriber object resides.</span></span>

</dd> </dl>

<span data-ttu-id="0b554-144">Il sistema di eventi USA i metadati per notificare ai sottoscrittori interessati ogni volta che vengono creati, modificati o rimossi sottoscrizioni o oggetti della classe di evento.</span><span class="sxs-lookup"><span data-stu-id="0b554-144">The event system uses meta-events to notify interested subscribers whenever event class objects or subscriptions are created, modified, or removed.</span></span> <span data-ttu-id="0b554-145">Per ricevere i metadati dal sistema di eventi, le applicazioni devono creare una sottoscrizione che risiede nel computer del sistema di eventi e che specifica l'ID dell'interfaccia di generazione (IID \_ IEventObjectChange).</span><span class="sxs-lookup"><span data-stu-id="0b554-145">To receive meta-events from the event system, applications must create a subscription that resides on the event system's computer and that specifies the firing interface ID (IID\_IEventObjectChange).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0b554-146">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0b554-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0b554-147">Filtro di eventi in COM+</span><span class="sxs-lookup"><span data-stu-id="0b554-147">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="0b554-148">Pubblicazione e distribuzione di eventi in COM+</span><span class="sxs-lookup"><span data-stu-id="0b554-148">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="0b554-149">Oggetto della classe di evento COM+</span><span class="sxs-lookup"><span data-stu-id="0b554-149">The COM+ Event Class Object</span></span>](the-com--event-class-object.md)
</dt> <dt>

[<span data-ttu-id="0b554-150">Uso di eventi COM+ con componenti in coda COM+</span><span class="sxs-lookup"><span data-stu-id="0b554-150">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 



