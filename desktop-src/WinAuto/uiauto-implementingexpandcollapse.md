---
title: Pattern di controllo ExpandCollapse
description: Vengono descritte le linee guida e le convenzioni per l'implementazione di IExpandCollapseProvider, incluse informazioni su proprietà, metodi ed eventi.
ms.assetid: 0ffc26c3-8696-44f9-b463-902a69e06d21
keywords:
- Automazione interfaccia utente, implementazione del pattern di controllo ExpandCollapse
- Automazione interfaccia utente, pattern di controllo ExpandCollapse
- Automazione interfaccia utente, IExpandCollapseProvider
- IExpandCollapseProvider
- implementazione di pattern di controllo ExpandCollapse di automazione interfaccia utente
- Pattern di controllo ExpandCollapse
- pattern di controllo, IExpandCollapseProvider
- pattern di controllo, implementazione dell'automazione interfaccia utente ExpandCollapse
- pattern di controllo, ExpandCollapse
- interfacce, IExpandCollapseProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45bd28ddcc201dcff0a4811a1eb8e04670f93091
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104044478"
---
# <a name="expandcollapse-control-pattern"></a><span data-ttu-id="3e455-113">Pattern di controllo ExpandCollapse</span><span class="sxs-lookup"><span data-stu-id="3e455-113">ExpandCollapse Control Pattern</span></span>

<span data-ttu-id="3e455-114">Vengono descritte le linee guida e le convenzioni per l'implementazione di [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), incluse informazioni su proprietà, metodi ed eventi.</span><span class="sxs-lookup"><span data-stu-id="3e455-114">Describes guidelines and conventions for implementing [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), including information about properties, methods, and events.</span></span> <span data-ttu-id="3e455-115">Il pattern di controllo **ExpandCollapse** viene usato per supportare i controlli che si espandono visivamente per visualizzare più contenuto e comprimere per nascondere il contenuto.</span><span class="sxs-lookup"><span data-stu-id="3e455-115">The **ExpandCollapse** control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span>

<span data-ttu-id="3e455-116">Per esempi di controlli che implementano questo pattern di controllo, vedere [tipi di controllo e i pattern di controllo supportati](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="3e455-116">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

<span data-ttu-id="3e455-117">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="3e455-117">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="3e455-118">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="3e455-118">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="3e455-119">Membri obbligatori per **IExpandCollapseProvider**</span><span class="sxs-lookup"><span data-stu-id="3e455-119">Required Members for **IExpandCollapseProvider**</span></span>](#required-members-for-iexpandcollapseprovider)
-   [<span data-ttu-id="3e455-120">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3e455-120">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="3e455-121">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="3e455-121">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="3e455-122">Quando si implementa il pattern di controllo **ExpandCollapse** , tenere presenti le linee guida e le convenzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3e455-122">When implementing the **ExpandCollapse** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="3e455-123">I controlli aggregati, compilati con oggetti figlio che forniscono l'interfaccia utente con funzionalità di espansione/compressione, devono supportare il pattern di controllo **ExpandCollapse** , mentre i relativi elementi figlio non lo sono.</span><span class="sxs-lookup"><span data-stu-id="3e455-123">Aggregate controls, built with child objects that provide the UI with expand/collapse functionality, must support the **ExpandCollapse** control pattern whereas their child elements do not.</span></span> <span data-ttu-id="3e455-124">Ad esempio, un controllo casella combinata viene compilato con una combinazione di controlli casella di riepilogo, pulsante e modifica, ma è solo la casella combinata padre che deve supportare il pattern di controllo **ExpandCollapse** .</span><span class="sxs-lookup"><span data-stu-id="3e455-124">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the **ExpandCollapse** control pattern.</span></span>
    > [!Note]  
    > <span data-ttu-id="3e455-125">Un'eccezione è rappresentata dal controllo menu, che è un'aggregazione di singoli oggetti voce di menu.</span><span class="sxs-lookup"><span data-stu-id="3e455-125">An exception is the menu control, which is an aggregate of individual menu item objects.</span></span> <span data-ttu-id="3e455-126">Gli oggetti voce di menu possono supportare il pattern di controllo **ExpandCollapse** , ma il controllo menu padre non può.</span><span class="sxs-lookup"><span data-stu-id="3e455-126">The menu item objects can support the **ExpandCollapse** control pattern, but the parent menu control cannot.</span></span> <span data-ttu-id="3e455-127">Un'eccezione simile si applica ai controlli dell'albero e dell'elemento dell'albero.</span><span class="sxs-lookup"><span data-stu-id="3e455-127">A similar exception applies to the tree and tree item controls.</span></span>

     

-   <span data-ttu-id="3e455-128">Quando l'oggetto [**IExpandCollapseProvider:: ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) di un controllo è impostato su **ExpandCollapseState \_ leafnode**, tutte le funzionalità di **ExpandCollapse** sono attualmente inattive per il controllo e le uniche informazioni che è possibile ottenere utilizzando questo pattern di controllo sono **ExpandCollapseState**.</span><span class="sxs-lookup"><span data-stu-id="3e455-128">When the [**IExpandCollapseProvider::ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) of a control is set to **ExpandCollapseState\_LeafNode**, any **ExpandCollapse** functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the **ExpandCollapseState**.</span></span> <span data-ttu-id="3e455-129">Se successivamente vengono aggiunti oggetti figlio, viene attivata la funzionalità **ExpandCollapseState** e **ExpandCollapse** .</span><span class="sxs-lookup"><span data-stu-id="3e455-129">If any child objects are subsequently added, the **ExpandCollapseState** changes and **ExpandCollapse** functionality is activated.</span></span>
-   <span data-ttu-id="3e455-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) si riferisce solo alla visibilità degli oggetti figlio diretti; non si riferisce alla visibilità di tutti gli oggetti discendenti.</span><span class="sxs-lookup"><span data-stu-id="3e455-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>
-   <span data-ttu-id="3e455-131">La funzionalità [**IExpandCollapseProvider:: Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) e [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) è specifica del controllo.</span><span class="sxs-lookup"><span data-stu-id="3e455-131">[**IExpandCollapseProvider::Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) and [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) functionality is control-specific.</span></span> <span data-ttu-id="3e455-132">Di seguito sono riportati alcuni esempi di questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="3e455-132">The following are examples of this behavior.</span></span>
    -   <span data-ttu-id="3e455-133">Il menu personale di Office può essere una voce di menu a tre stati ("espanso", "compresso" e "PartiallyExpanded") in cui il controllo specifica lo stato da adottare quando viene chiamato [**Espandi**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) o [**Comprimi**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) .</span><span class="sxs-lookup"><span data-stu-id="3e455-133">The Office Personal Menu can be a three-state menu item ("Expanded", "Collapsed" and "PartiallyExpanded") where the control specifies the state to adopt when [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) is called.</span></span>
    -   <span data-ttu-id="3e455-134">La chiamata di [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) su un elemento dell'albero può visualizzare tutti i discendenti o solo gli elementi figlio immediati.</span><span class="sxs-lookup"><span data-stu-id="3e455-134">Calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) on a tree item may display all descendants or only immediate children.</span></span>
    -   <span data-ttu-id="3e455-135">Se la chiamata a [**expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) o [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) su un controllo mantiene lo stato dei relativi discendenti, deve essere inviato un evento di modifica della visibilità, non un evento di modifica dello stato.</span><span class="sxs-lookup"><span data-stu-id="3e455-135">If calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event.</span></span> <span data-ttu-id="3e455-136">Se il controllo padre non mantiene lo stato dei relativi discendenti quando viene compresso, il controllo può eliminare tutti i discendenti non più visibili e generare un evento eliminato definitivamente; oppure può modificare il valore di [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) per ogni discendente e generare un evento di modifica della visibilità.</span><span class="sxs-lookup"><span data-stu-id="3e455-136">If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) for each descendant and raise a visibility change event.</span></span>
-   <span data-ttu-id="3e455-137">Per garantire la navigazione, è consigliabile che un oggetto si trovi nell'albero di automazione interfaccia utente Microsoft (con lo stato di visibilità appropriato) indipendentemente dagli elementi padre [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span><span class="sxs-lookup"><span data-stu-id="3e455-137">To guarantee navigation, it is desirable for an object to be in the Microsoft UI Automation tree (with appropriate visibility state) regardless of its parents [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span></span> <span data-ttu-id="3e455-138">Se i discendenti vengono generati su richiesta, possono essere visualizzati solo nell'albero di automazione interfaccia utente dopo essere stati visualizzati per la prima volta o solo quando sono visibili.</span><span class="sxs-lookup"><span data-stu-id="3e455-138">If descendants are generated on demand, they may only appear in the UI Automation tree after being displayed for the first time or only while they are visible.</span></span>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="3e455-139">Membri obbligatori per **IExpandCollapseProvider**</span><span class="sxs-lookup"><span data-stu-id="3e455-139">Required Members for **IExpandCollapseProvider**</span></span>

<span data-ttu-id="3e455-140">Le proprietà, i metodi e gli eventi seguenti sono obbligatori per l'implementazione dell'interfaccia [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) .</span><span class="sxs-lookup"><span data-stu-id="3e455-140">The following properties, methods, and events are required for implementing the [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) interface.</span></span>



| <span data-ttu-id="3e455-141">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="3e455-141">Required members</span></span>                                                                                    | <span data-ttu-id="3e455-142">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="3e455-142">Member type</span></span> | <span data-ttu-id="3e455-143">Note</span><span class="sxs-lookup"><span data-stu-id="3e455-143">Notes</span></span>                                                                  |
|-----------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------|
| [<span data-ttu-id="3e455-144">**ExpandCollapseState**</span><span class="sxs-lookup"><span data-stu-id="3e455-144">**ExpandCollapseState**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)                   | <span data-ttu-id="3e455-145">Proprietà</span><span class="sxs-lookup"><span data-stu-id="3e455-145">Property</span></span>    | <span data-ttu-id="3e455-146">nessuno</span><span class="sxs-lookup"><span data-stu-id="3e455-146">None</span></span>                                                                   |
| [<span data-ttu-id="3e455-147">**Espandere**</span><span class="sxs-lookup"><span data-stu-id="3e455-147">**Expand**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand)                                             | <span data-ttu-id="3e455-148">Metodo</span><span class="sxs-lookup"><span data-stu-id="3e455-148">Method</span></span>      | <span data-ttu-id="3e455-149">nessuno</span><span class="sxs-lookup"><span data-stu-id="3e455-149">None</span></span>                                                                   |
| [<span data-ttu-id="3e455-150">**Comprimi**</span><span class="sxs-lookup"><span data-stu-id="3e455-150">**Collapse**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse)                                         | <span data-ttu-id="3e455-151">Metodo</span><span class="sxs-lookup"><span data-stu-id="3e455-151">Method</span></span>      | <span data-ttu-id="3e455-152">nessuno</span><span class="sxs-lookup"><span data-stu-id="3e455-152">None</span></span>                                                                   |
| [<span data-ttu-id="3e455-153">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="3e455-153">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler) | <span data-ttu-id="3e455-154">Evento</span><span class="sxs-lookup"><span data-stu-id="3e455-154">Event</span></span>       | <span data-ttu-id="3e455-155">A questo controllo non sono associati eventi. utilizzare questo gestore dell'evento generico.</span><span class="sxs-lookup"><span data-stu-id="3e455-155">This control has no associated events; use this generic event handler.</span></span> |



 

## <a name="related-topics"></a><span data-ttu-id="3e455-156">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3e455-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3e455-157">Tipi di controllo e i pattern di controllo supportati</span><span class="sxs-lookup"><span data-stu-id="3e455-157">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="3e455-158">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="3e455-158">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="3e455-159">Panoramica dell'albero di automazione dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="3e455-159">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 




