---
title: Active Accessibility e il ridimensionamento dello schermo di Windows Vista
description: Windows Vista consente agli utenti di modificare l'impostazione di punti per pollice (dpi) in modo che la maggior parte degli elementi dell'interfaccia utente sullo schermo risulti più grande.
ms.assetid: c781fefd-09f0-4340-b3d3-f4e57308f392
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db8e192dc01d4c7d75f19741cdfac7b3b08d22c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104473787"
---
# <a name="active-accessibility-and-windows-vista-screen-scaling"></a><span data-ttu-id="17a8f-103">Active Accessibility e il ridimensionamento dello schermo di Windows Vista</span><span class="sxs-lookup"><span data-stu-id="17a8f-103">Active Accessibility and Windows Vista Screen Scaling</span></span>

<span data-ttu-id="17a8f-104">Windows Vista consente agli utenti di modificare l'impostazione di punti per pollice (dpi) in modo che la maggior parte degli elementi dell'interfaccia utente sullo schermo risulti più grande.</span><span class="sxs-lookup"><span data-stu-id="17a8f-104">Windows Vista enables users to change the dots-per-inch (dpi) setting so that most UI elements on the screen appear larger.</span></span> <span data-ttu-id="17a8f-105">Sebbene questa funzionalità sia stata a lungo disponibile in Microsoft Windows, nelle versioni precedenti il ridimensionamento doveva essere implementato dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="17a8f-105">Although this feature has long been available in Microsoft Windows, in previous versions the scaling had to be implemented by applications.</span></span> <span data-ttu-id="17a8f-106">In Windows Vista, il Gestione finestre desktop esegue il ridimensionamento predefinito per tutte le applicazioni che non gestiscono la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="17a8f-106">In Windows Vista, the Desktop Window Manager performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="17a8f-107">Le applicazioni client di Microsoft Active Accessibility devono tenere conto di questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="17a8f-107">Microsoft Active Accessibility client applications must take this feature into account.</span></span>

## <a name="scaling-in-windows-vista"></a><span data-ttu-id="17a8f-108">Ridimensionamento in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="17a8f-108">Scaling in Windows Vista</span></span>

<span data-ttu-id="17a8f-109">L'impostazione DPI predefinita è 96, il che significa che 96 pixel occupano una larghezza o un'altezza di un pollice teorico.</span><span class="sxs-lookup"><span data-stu-id="17a8f-109">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="17a8f-110">La misura esatta di un pollice dipende dalle dimensioni e dalla risoluzione fisica del monitor.</span><span class="sxs-lookup"><span data-stu-id="17a8f-110">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="17a8f-111">Ad esempio, su un monitor con una larghezza di 12 pollici e una risoluzione orizzontale di 1280 pixel, una riga orizzontale di 96 pixel si estende per circa 9/10 di un pollice.</span><span class="sxs-lookup"><span data-stu-id="17a8f-111">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>

<span data-ttu-id="17a8f-112">La modifica dell'impostazione DPI non corrisponde alla modifica della risoluzione dello schermo.</span><span class="sxs-lookup"><span data-stu-id="17a8f-112">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="17a8f-113">Con il ridimensionamento DPI, il numero di pixel fisici sullo schermo rimane lo stesso.</span><span class="sxs-lookup"><span data-stu-id="17a8f-113">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="17a8f-114">Il ridimensionamento viene tuttavia applicato alle dimensioni e alla posizione degli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="17a8f-114">However, scaling is applied to the size and location of UI elements.</span></span> <span data-ttu-id="17a8f-115">È possibile eseguire il ridimensionamento automaticamente con Gestione finestre desktop per il desktop e per le applicazioni che non richiedono tale funzionalità in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="17a8f-115">This scaling can be performed automatically by the Desktop Window Manager (DWM) for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>

<span data-ttu-id="17a8f-116">In effetti, quando l'utente imposta il fattore di scala su 120 dpi, un pollice verticale o orizzontale sullo schermo aumenta del 25%.</span><span class="sxs-lookup"><span data-stu-id="17a8f-116">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="17a8f-117">Tutte le dimensioni vengono ridimensionate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="17a8f-117">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="17a8f-118">L'offset di una finestra dai bordi superiore e sinistro dello schermo aumenta del 25%.</span><span class="sxs-lookup"><span data-stu-id="17a8f-118">The offset of a window from the top and left edges of the screen increases by 25 percent.</span></span> <span data-ttu-id="17a8f-119">Le dimensioni della finestra aumentano nella stessa proporzione, con gli offset e le dimensioni di tutti gli elementi dell'interfaccia utente che contiene.</span><span class="sxs-lookup"><span data-stu-id="17a8f-119">The size of the window increases in the same proportion, along with the offsets and sizes of all UI elements it contains.</span></span>

<span data-ttu-id="17a8f-120">Per impostazione predefinita, DWM non esegue la scalabilità per le applicazioni non compatibili con DPI quando l'utente imposta il valore dpi su 120, ma lo esegue quando il valore dpi è impostato su un valore personalizzato pari a 144 o superiore.</span><span class="sxs-lookup"><span data-stu-id="17a8f-120">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform it when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="17a8f-121">È tuttavia possibile ignorare questo comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="17a8f-121">However, the user can override the default behavior.</span></span>

<span data-ttu-id="17a8f-122">Il ridimensionamento dello schermo crea nuove sfide per le applicazioni che dipendono dalle coordinate dello schermo.</span><span class="sxs-lookup"><span data-stu-id="17a8f-122">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="17a8f-123">Lo schermo contiene ora due sistemi di coordinate: fisico e logico.</span><span class="sxs-lookup"><span data-stu-id="17a8f-123">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="17a8f-124">Le coordinate fisiche di un punto sono l'offset effettivo in pixel dalla parte superiore sinistra dell'origine.</span><span class="sxs-lookup"><span data-stu-id="17a8f-124">The physical coordinates of a point are the actual offset in pixels from the top left of the origin.</span></span> <span data-ttu-id="17a8f-125">Le coordinate logiche sono gli offset così come si presenterebbero se i pixel fossero ridimensionati.</span><span class="sxs-lookup"><span data-stu-id="17a8f-125">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>

<span data-ttu-id="17a8f-126">Si supponga di progettare una finestra di dialogo con un pulsante in corrispondenza delle coordinate (100, 48).</span><span class="sxs-lookup"><span data-stu-id="17a8f-126">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="17a8f-127">Quando questa finestra di dialogo viene visualizzata sul valore predefinito 96 dpi, il pulsante si trova in corrispondenza delle coordinate fisiche (100, 48).</span><span class="sxs-lookup"><span data-stu-id="17a8f-127">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="17a8f-128">A 120 dpi si trova in corrispondenza delle coordinate fisiche (125, 60).</span><span class="sxs-lookup"><span data-stu-id="17a8f-128">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="17a8f-129">Tuttavia, le coordinate logiche sono le stesse in qualsiasi impostazione dpi: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="17a8f-129">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>

<span data-ttu-id="17a8f-130">Le coordinate logiche sono importanti, perché rendono il comportamento del sistema operativo e delle applicazioni coerenti indipendentemente dall'impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="17a8f-130">Logical coordinates are important, because they make the behavior of the operating system and applications consistent regardless of the dpi setting.</span></span> <span data-ttu-id="17a8f-131">Ad esempio, **System. Windows. Forms. Cursor. Position** restituisce normalmente le coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="17a8f-131">For example, **System.Windows.Forms.Cursor.Position** normally returns the logical coordinates.</span></span> <span data-ttu-id="17a8f-132">Se si sposta il cursore su un elemento in una finestra di dialogo, le stesse coordinate vengono restituite indipendentemente dall'impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="17a8f-132">If you move the cursor over an element in a dialog box, the same coordinates are returned regardless of the dpi setting.</span></span> <span data-ttu-id="17a8f-133">Se si disegna un controllo in (100, 100), questo viene disegnato su queste coordinate logiche e occupa la stessa posizione relativa in qualsiasi impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="17a8f-133">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>

## <a name="scaling-in-active-accessibility-clients"></a><span data-ttu-id="17a8f-134">Ridimensionamento nei client di Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="17a8f-134">Scaling in Active Accessibility Clients</span></span>

<span data-ttu-id="17a8f-135">Microsoft Active Accessibility non utilizza le coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="17a8f-135">Microsoft Active Accessibility does not use logical coordinates.</span></span> <span data-ttu-id="17a8f-136">I metodi e le funzioni seguenti restituiscono coordinate fisiche o le accettano come parametri.</span><span class="sxs-lookup"><span data-stu-id="17a8f-136">The following methods and functions either return physical coordinates or take them as parameters.</span></span>

-   [<span data-ttu-id="17a8f-137">**IAccessible:: accHitTest**</span><span class="sxs-lookup"><span data-stu-id="17a8f-137">**IAccessible::accHitTest**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest)
-   [<span data-ttu-id="17a8f-138">**IAccessible:: accLocation**</span><span class="sxs-lookup"><span data-stu-id="17a8f-138">**IAccessible::accLocation**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)
-   [<span data-ttu-id="17a8f-139">**AccessibleObjectFromPoint**</span><span class="sxs-lookup"><span data-stu-id="17a8f-139">**AccessibleObjectFromPoint**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)

<span data-ttu-id="17a8f-140">Per impostazione predefinita, un'applicazione client di Microsoft Active Accessibility in esecuzione in un ambiente non 96-dpi non sarà in grado di ottenere risultati corretti da queste chiamate.</span><span class="sxs-lookup"><span data-stu-id="17a8f-140">By default, an Microsoft Active Accessibility client application running in a non-96-dpi environment will not be able to obtain correct results from these calls.</span></span> <span data-ttu-id="17a8f-141">Ad esempio, poiché la posizione del cursore è in coordinate logiche, il client non può semplicemente passare queste coordinate a [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) per ottenere l'elemento che si trova sotto il cursore.</span><span class="sxs-lookup"><span data-stu-id="17a8f-141">For example, because the cursor position is in logical coordinates, the client cannot simply pass these coordinates to [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) to obtain the element that is under the cursor.</span></span>

<span data-ttu-id="17a8f-142">Inoltre, un'applicazione che crea una finestra al di fuori dell'area client, ad esempio un'applicazione di accessibilità che evidenzia gli elementi dell'interfaccia utente con lo stato attivo, non creerà la finestra nella posizione dello schermo corretta, perché la finestra sarà posizionata in corrispondenza delle coordinate logiche, non delle coordinate fisiche restituite da [**IAccessible:: accLocation**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation).</span><span class="sxs-lookup"><span data-stu-id="17a8f-142">In addition, an application that creates a window outside its client area, such as an accessibility application that highlights focused UI elements, will not create the window at the correct screen location, because the window will be placed at the logical coordinates, not the physical coordinates returned by [**IAccessible::accLocation**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation).</span></span>

<span data-ttu-id="17a8f-143">La soluzione è in due parti:</span><span class="sxs-lookup"><span data-stu-id="17a8f-143">The solution is in two parts:</span></span>

-   <span data-ttu-id="17a8f-144">Rendere l'applicazione client "compatibile con DPI".</span><span class="sxs-lookup"><span data-stu-id="17a8f-144">Make the client application "dpi-aware".</span></span> <span data-ttu-id="17a8f-145">A tale scopo, chiamare la funzione [**SetProcessDPIAware**](/windows/win32/api/winuser/nf-winuser-setprocessdpiaware) all'avvio.</span><span class="sxs-lookup"><span data-stu-id="17a8f-145">To do this, call the [**SetProcessDPIAware**](/windows/win32/api/winuser/nf-winuser-setprocessdpiaware) function at startup.</span></span> <span data-ttu-id="17a8f-146">Questa funzione rende l'intero processo compatibile con dpi, vale a dire che tutte le finestre appartenenti al processo non vengono ridimensionate.</span><span class="sxs-lookup"><span data-stu-id="17a8f-146">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span>
-   <span data-ttu-id="17a8f-147">Usare funzioni compatibili con i valori dpi.</span><span class="sxs-lookup"><span data-stu-id="17a8f-147">Use functions that are dpi-aware.</span></span> <span data-ttu-id="17a8f-148">Per ottenere, ad esempio, le coordinate del cursore, chiamare la funzione [**GetPhysicalCursorPos**](/windows/win32/api/winuser/nf-winuser-getphysicalcursorpos) .</span><span class="sxs-lookup"><span data-stu-id="17a8f-148">For example, to get cursor coordinates, call the [**GetPhysicalCursorPos**](/windows/win32/api/winuser/nf-winuser-getphysicalcursorpos) function.</span></span> <span data-ttu-id="17a8f-149">Non utilizzare [**GetCursorPos**](/windows/win32/api/winuser/nf-winuser-getcursorpos); il comportamento delle applicazioni in grado di riconoscere DPI non è definito.</span><span class="sxs-lookup"><span data-stu-id="17a8f-149">Do not use [**GetCursorPos**](/windows/win32/api/winuser/nf-winuser-getcursorpos); its behavior in dpi-aware applications is undefined.</span></span>

<span data-ttu-id="17a8f-150">Se l'applicazione esegue la comunicazione tra processi diretta con applicazioni non compatibili con dpi, è possibile che sia presente una conversione tra coordinate logiche e fisiche usando le funzioni [**PhysicalToLogicalPoint**](/windows/win32/api/winuser/nf-winuser-physicaltologicalpoint) e [**LogicalToPhysicalPoint**](/windows/win32/api/winuser/nf-winuser-logicaltophysicalpoint) .</span><span class="sxs-lookup"><span data-stu-id="17a8f-150">If your application performs direct cross-process communication with non-dpi-aware applications, you may have convert between logical and physical coordinates by using the [**PhysicalToLogicalPoint**](/windows/win32/api/winuser/nf-winuser-physicaltologicalpoint) and [**LogicalToPhysicalPoint**](/windows/win32/api/winuser/nf-winuser-logicaltophysicalpoint) functions.</span></span>

 

 