---
title: Panoramica di WinEvents e Active Accessibility
description: I server Microsoft Active Accessibility generano WinEvents per notificare ai client quando un oggetto accessibile viene modificato.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/29/2020
ms.locfileid: "103956139"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="0a056-103">WinEvents e Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="0a056-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="0a056-104">I server Microsoft Active Accessibility generano *winEvents* per notificare ai client quando un oggetto accessibile viene modificato.</span><span class="sxs-lookup"><span data-stu-id="0a056-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="0a056-105">Esistono numerose condizioni in cui un server invia una notifica a un client di una modifica.</span><span class="sxs-lookup"><span data-stu-id="0a056-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="0a056-106">Ogni [costante di evento](event-constants.md) definita da Microsoft Active Accessibility descrive una condizione per cui un client riceve una notifica.</span><span class="sxs-lookup"><span data-stu-id="0a056-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="0a056-107">Ad esempio, WinEvents può segnalare:</span><span class="sxs-lookup"><span data-stu-id="0a056-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="0a056-108">Quando un oggetto viene creato o eliminato definitivamente.</span><span class="sxs-lookup"><span data-stu-id="0a056-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="0a056-109">Quando un oggetto riceve o perde lo stato attivo.</span><span class="sxs-lookup"><span data-stu-id="0a056-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="0a056-110">Quando viene modificato lo stato o la posizione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="0a056-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="0a056-111">Quando viene modificata una proprietà di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="0a056-111">When any property of an object changes.</span></span>

<span data-ttu-id="0a056-112">Le applicazioni client non ricevono automaticamente le notifiche degli eventi; devono specificare gli eventi che vogliono ricevere chiamando la funzione [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) .</span><span class="sxs-lookup"><span data-stu-id="0a056-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="0a056-113">Con **SetWinEventHook**, un client esegue la registrazione per ricevere uno o più eventi e imposta una funzione hook per la gestione degli eventi specificati.</span><span class="sxs-lookup"><span data-stu-id="0a056-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="0a056-114">I client possono usare la stessa funzione hook per gestire più tipi di eventi oppure possono usare funzioni hook multipe.</span><span class="sxs-lookup"><span data-stu-id="0a056-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="0a056-115">I client chiamano **SetWinEventHook** una volta per ogni funzione hook che deve registrare.</span><span class="sxs-lookup"><span data-stu-id="0a056-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="0a056-116">Le funzioni hook si trovano all'interno del corpo del codice del client, in una DLL mappata al processo del client o in una DLL mappata al processo del server.</span><span class="sxs-lookup"><span data-stu-id="0a056-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="0a056-117">Ognuno di questi metodi presenta vantaggi e svantaggi.</span><span class="sxs-lookup"><span data-stu-id="0a056-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="0a056-118">Per altre informazioni, vedere [funzioni hook nel contesto e out-of-Context](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="0a056-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="0a056-119">Per notificare ai client l'occorrenza di un evento, i server chiamano [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span><span class="sxs-lookup"><span data-stu-id="0a056-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="0a056-120">Il sistema controlla se le applicazioni client dispongono di funzioni hook impostate per l'evento e chiama le funzioni hook appropriate in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="0a056-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="0a056-121">Quando viene chiamata la funzione hook del client, riceve un numero di parametri che descrivono l'evento e l'oggetto che ha generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="0a056-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="0a056-122">Per ottenere l'accesso all'oggetto che ha generato l'evento, la funzione di hook client chiama [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span><span class="sxs-lookup"><span data-stu-id="0a056-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="0a056-123">Se nessun client è stato registrato per la ricezione di WinEvents, l'effetto sulle prestazioni di un server per chiamare [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) è irrilevante.</span><span class="sxs-lookup"><span data-stu-id="0a056-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="0a056-124">I server chiamano [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) per le modifiche solo nei propri oggetti accessibili; non chiamano **NotifyWinEvent** per le modifiche negli elementi dell'interfaccia utente forniti dal sistema.</span><span class="sxs-lookup"><span data-stu-id="0a056-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="0a056-125">Comunicazione Event-Driven</span><span class="sxs-lookup"><span data-stu-id="0a056-125">Event-Driven Communication</span></span>

<span data-ttu-id="0a056-126">Per poter ricevere notifiche WinEvent, i client devono registrare un hook WinEvent.</span><span class="sxs-lookup"><span data-stu-id="0a056-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="0a056-127">Per evitare callback superflui e migliorare le prestazioni, è consigliabile che i client si registrino solo per gli eventi che devono ricevere.</span><span class="sxs-lookup"><span data-stu-id="0a056-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="0a056-128">All'interno della routine hook, il client può chiamare [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) per recuperare un oggetto [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) per l'elemento a cui si applica l'evento.</span><span class="sxs-lookup"><span data-stu-id="0a056-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="0a056-129">Con questo oggetto, il client può iniziare a chiamare i metodi **IAccessible** per recuperare informazioni o interagire con l'elemento dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="0a056-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0a056-130">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0a056-130">Related topics</span></span>

[<span data-ttu-id="0a056-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="0a056-131">WinEvents</span></span>](winevents-infrastructure.md)
