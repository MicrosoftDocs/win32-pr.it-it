---
title: Utilizzo degli elementi virtualizzati
description: Questo argomento descrive come usare la funzionalità fornita dai pattern di controllo ItemContainer e VirtualizedItem per trovare e recuperare informazioni sugli elementi virtualizzati.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- client, elementi virtualizzati di automazione interfaccia utente
- client, elementi virtualizzati
- client, pattern di controllo
- client, pattern di controllo VirtualizedItem
- client, pattern di controllo ItemContainer
- client, pattern di controllo VirtualizedItem di automazione interfaccia utente
- client, pattern di controllo di automazione interfaccia utente
- client, pattern di controllo ItemContainer di automazione interfaccia utente
- Automazione interfaccia utente, elementi virtualizzati
- Automazione interfaccia utente, pattern di controllo
- Automazione interfaccia utente, pattern di controllo VirtualizedItem
- Automazione interfaccia utente, pattern di controllo ItemContainer
- Pattern di controllo VirtualizedItem
- Pattern di controllo ItemContainer
- pattern di controllo, VirtualizedItem
- pattern di controllo, ItemContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb29232b06304079ad5b9dfdfb589ad510a5b51f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104331404"
---
# <a name="working-with-virtualized-items"></a><span data-ttu-id="8a871-119">Utilizzo degli elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="8a871-119">Working with Virtualized Items</span></span>

<span data-ttu-id="8a871-120">Questo argomento descrive come usare la funzionalità fornita dai pattern di controllo [ItemContainer](uiauto-implementingitemcontainer.md) e [VirtualizedItem](uiauto-implementingvirtualizeditem.md) per trovare e recuperare informazioni sugli elementi virtualizzati.</span><span class="sxs-lookup"><span data-stu-id="8a871-120">This topic describes how to use functionality provided by the [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control patterns to find and retrieve information about virtualized items.</span></span>

-   [<span data-ttu-id="8a871-121">Panoramica della virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="8a871-121">Overview of Virtualization</span></span>](#overview-of-virtualization)
-   [<span data-ttu-id="8a871-122">Come un controllo supporta la virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="8a871-122">How a Control Supports Virtualization</span></span>](#how-a-control-supports-virtualization)
-   [<span data-ttu-id="8a871-123">Come i client trovano e realizzano elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="8a871-123">How Clients Find and Realize Virtualized Items</span></span>](#how-clients-find-and-realize-virtualized-items)
-   [<span data-ttu-id="8a871-124">Esempio</span><span class="sxs-lookup"><span data-stu-id="8a871-124">Example</span></span>](#example)
-   [<span data-ttu-id="8a871-125">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8a871-125">Related topics</span></span>](#related-topics)

## <a name="overview-of-virtualization"></a><span data-ttu-id="8a871-126">Panoramica della virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="8a871-126">Overview of Virtualization</span></span>

<span data-ttu-id="8a871-127">I controlli che contengono un numero elevato di elementi figlio possono utilizzare la virtualizzazione per gestire in modo efficiente gli elementi.</span><span class="sxs-lookup"><span data-stu-id="8a871-127">Controls that contain a large number of child items can use virtualization to efficiently manage the items.</span></span> <span data-ttu-id="8a871-128">Con la virtualizzazione, il controllo mantiene le informazioni complete in memoria solo per un subset di elementi in un determinato momento.</span><span class="sxs-lookup"><span data-stu-id="8a871-128">With virtualization, the control maintains full information in memory for only a subset of items at any given time.</span></span> <span data-ttu-id="8a871-129">In genere, il subset include solo gli elementi attualmente visibili all'utente.</span><span class="sxs-lookup"><span data-stu-id="8a871-129">Typically, the subset includes only those items that are currently visible to the user.</span></span> <span data-ttu-id="8a871-130">Le informazioni complete sugli elementi virtualizzati rimanenti vengono mantenute nello spazio di archiviazione e vengono caricate in memoria, o realizzate, perché il controllo lo richiede, ad esempio, perché i nuovi elementi diventano visibili all'utente.</span><span class="sxs-lookup"><span data-stu-id="8a871-130">Full information about the remaining virtualized items is kept in storage and is loaded into memory, or realized, as the control needs it, for example, as new items become visible to the user.</span></span>

<span data-ttu-id="8a871-131">I controlli che usano la virtualizzazione rappresentano una sfida perché solo gli elementi realizzati sono completamente disponibili come elementi di automazione interfaccia utente Microsoft nell'albero di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="8a871-131">Controls that use virtualization represent a challenge because only realized items are fully available as Microsoft UI Automation elements in the UI Automation tree.</span></span> <span data-ttu-id="8a871-132">Gli elementi virtualizzati non esistono nell'albero, quindi le informazioni su di essi non sono disponibili per i client.</span><span class="sxs-lookup"><span data-stu-id="8a871-132">Virtualized items do not exist in the tree, so information about them is not available to clients.</span></span> <span data-ttu-id="8a871-133">Per recuperare informazioni sugli elementi virtualizzati, i client devono avere un modo per forzare l'automazione dell'interfaccia utente a passare la richiesta per realizzare gli elementi al controllo.</span><span class="sxs-lookup"><span data-stu-id="8a871-133">To retrieve information about virtualized items, clients need a way to force UI Automation to pass the request to realize the items to the control.</span></span> <span data-ttu-id="8a871-134">Una volta realizzati gli elementi, l'automazione interfaccia utente può creare elementi di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="8a871-134">After the items have been realized, UI Automation can create UI Automation elements for them.</span></span> <span data-ttu-id="8a871-135">Automazione interfaccia utente include due pattern di controllo per consentire ai client di usare elementi virtualizzati: [ItemContainer](uiauto-implementingitemcontainer.md) e [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span><span class="sxs-lookup"><span data-stu-id="8a871-135">UI Automation includes two control patterns to enable clients to work with virtualized items: [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span></span>

## <a name="how-a-control-supports-virtualization"></a><span data-ttu-id="8a871-136">Come un controllo supporta la virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="8a871-136">How a Control Supports Virtualization</span></span>

<span data-ttu-id="8a871-137">Qualsiasi controllo che può contenere elementi virtualizzati deve supportare il pattern di controllo [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="8a871-137">Any control that can contain virtualized items must support the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="8a871-138">Inoltre, qualsiasi elemento che può essere virtualizzato deve supportare il pattern di controllo [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="8a871-138">Further, any item that can be virtualized must support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="8a871-139">Le funzionalità esposte dai pattern di controllo ItemContainer e VirtualizedItem sono accessibili ai client tramite le interfacce [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) e [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="8a871-139">The functionality that is exposed by the ItemContainer and VirtualizedItem control patterns is accessible to clients through the [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) and [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interfaces.</span></span>

## <a name="how-clients-find-and-realize-virtualized-items"></a><span data-ttu-id="8a871-140">Come i client trovano e realizzano elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="8a871-140">How Clients Find and Realize Virtualized Items</span></span>

<span data-ttu-id="8a871-141">I client possono usare il metodo [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) per cercare gli elementi figlio nel contenitore in base al valore di una determinata proprietà.</span><span class="sxs-lookup"><span data-stu-id="8a871-141">Clients can use the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method to search for child items in the container based on the value of a particular property.</span></span> <span data-ttu-id="8a871-142">Il metodo può anche recuperare il primo elemento nel contenitore o l'elemento che segue l'elemento specificato.</span><span class="sxs-lookup"><span data-stu-id="8a871-142">The method can also retrieve the first item in the container or the item that follows the specified item.</span></span> <span data-ttu-id="8a871-143">Se viene trovato un elemento figlio corrispondente, **FindItemByProperty** recupera un'interfaccia [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) per l'elemento.</span><span class="sxs-lookup"><span data-stu-id="8a871-143">If a matching child item is found, the **FindItemByProperty** retrieves an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the item.</span></span> <span data-ttu-id="8a871-144">Tuttavia, se l'elemento figlio è virtualizzato, l'interfaccia **IUIAutomationElement** è un segnaposto.</span><span class="sxs-lookup"><span data-stu-id="8a871-144">However, if the child item is virtualized, the **IUIAutomationElement** interface is a placeholder.</span></span> <span data-ttu-id="8a871-145">L'errore [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) si verifica quando il client tenta di usare l'interfaccia **IUIAutomationElement** per recuperare i valori di proprietà o chiamare metodi non ancora disponibili.</span><span class="sxs-lookup"><span data-stu-id="8a871-145">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error occurs when the client attempts to use the **IUIAutomationElement** interface to retrieve property values or call methods that are not yet available.</span></span> <span data-ttu-id="8a871-146">Le proprietà o i metodi disponibili tramite un segnaposto dipendono dall'implementazione del controllo.</span><span class="sxs-lookup"><span data-stu-id="8a871-146">Which properties or methods are available through a placeholder depends on the control implementation.</span></span> <span data-ttu-id="8a871-147">L'unico requisito per un segnaposto è supportare l'interfaccia [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="8a871-147">The only requirement for a placeholder is to support the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface.</span></span>

<span data-ttu-id="8a871-148">L'errore [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) indica al client che un elemento può essere virtualizzato.</span><span class="sxs-lookup"><span data-stu-id="8a871-148">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error is an indication to the client that an item may be virtualized.</span></span> <span data-ttu-id="8a871-149">Il client deve rispondere recuperando l'interfaccia [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) per l'elemento e quindi realizzando l'elemento chiamando il metodo [**IUIAutomationVirtualizedItemPattern:: réalisateur**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) .</span><span class="sxs-lookup"><span data-stu-id="8a871-149">The client should respond by retrieving the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface for the item, and then realizing the item by calling the [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method.</span></span> <span data-ttu-id="8a871-150">Se l'operazione ha esito positivo, l'interfaccia [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) è completamente funzionante con tutte le proprietà appropriate disponibili.</span><span class="sxs-lookup"><span data-stu-id="8a871-150">If this succeeds, the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface is fully functional with all appropriate properties available.</span></span>

<span data-ttu-id="8a871-151">A seconda dell'implementazione del controllo, la chiamata a [**IUIAutomationVirtualizedItemPattern:: rende**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) possibile il controllo per scorrere l'elemento nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="8a871-151">Depending on the control implementation, calling [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) may cause the control to scroll the item into view.</span></span> <span data-ttu-id="8a871-152">Tuttavia, un client non deve basarsi sullo scorrimento della visualizzazione o rendere visibile l'elemento.</span><span class="sxs-lookup"><span data-stu-id="8a871-152">However, a client should not rely on the item scrolling into view or made visible.</span></span> <span data-ttu-id="8a871-153">Per assicurarsi che l'elemento sia visibile, il client può usare il metodo [**IUIAutomationScrollItemPattern:: ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) .</span><span class="sxs-lookup"><span data-stu-id="8a871-153">To ensure that the item is visible, the client can use the [**IUIAutomationScrollItemPattern::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) method.</span></span>

## <a name="example"></a><span data-ttu-id="8a871-154">Esempio</span><span class="sxs-lookup"><span data-stu-id="8a871-154">Example</span></span>

<span data-ttu-id="8a871-155">Per un esempio di codice che illustra come usare il supporto di automazione interfaccia utente per la virtualizzazione, vedere [come recuperare un elemento virtualizzato](uiauto-howto-retrieve-virtualized-item.md).</span><span class="sxs-lookup"><span data-stu-id="8a871-155">For example code that shows how to use the UI Automation support for virtualization, see [How to Retrieve a Virtualized Item](uiauto-howto-retrieve-virtualized-item.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8a871-156">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8a871-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8a871-157">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="8a871-157">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




