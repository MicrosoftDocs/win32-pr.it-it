---
title: Trascinare il pattern di controllo
description: Vengono fornite linee guida e convenzioni per l'implementazione del pattern di controllo di trascinamento mediante IDragProvider, incluse informazioni su proprietà e metodi. Il pattern di controllo di trascinamento viene usato per supportare i controlli trascinabili o i controlli con elementi trascinabili.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Automazione interfaccia utente, implementazione del pattern di controllo drag
- Automazione interfaccia utente, trascinare pattern di controllo
- Automazione interfaccia utente, IDragProvider
- IDragProvider
- implementazione di pattern di controllo drag di automazione interfaccia utente
- Trascinare i pattern di controllo
- pattern di controllo, IDragProvider
- pattern di controllo, implementazione del drag di automazione interfaccia utente
- pattern di controllo, trascinamento
- interfacce, IDragProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104046965"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="82100-114">Trascinare il pattern di controllo</span><span class="sxs-lookup"><span data-stu-id="82100-114">Drag Control Pattern</span></span>

<span data-ttu-id="82100-115">Vengono fornite linee guida e convenzioni per l'implementazione del pattern di controllo di **trascinamento** mediante [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), incluse informazioni su proprietà e metodi.</span><span class="sxs-lookup"><span data-stu-id="82100-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="82100-116">Il pattern di controllo di **trascinamento** viene usato per supportare i controlli trascinabili o i controlli con elementi trascinabili.</span><span class="sxs-lookup"><span data-stu-id="82100-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="82100-117">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="82100-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="82100-118">Quando si implementa il pattern di controllo **drag** , usare le linee guida e le convenzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="82100-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="82100-119">L'interfaccia [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) supporta due stili di trascinamento diversi, ovvero lo stile di origine/destinazione e lo stile di sola origine.</span><span class="sxs-lookup"><span data-stu-id="82100-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="82100-120">È necessario scegliere lo stile più adatto per gli scenari di trascinamento della selezione:</span><span class="sxs-lookup"><span data-stu-id="82100-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="82100-121">**Stile di origine/destinazione:** Ogni destinazione di rilascio può essere rappresentata da un elemento che implementa l'interfaccia [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) .</span><span class="sxs-lookup"><span data-stu-id="82100-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="82100-122">Durante un'operazione di trascinamento, gli eventi di automazione interfaccia utente Microsoft provengono dall'elemento trascinato e dagli elementi della destinazione di rilascio.</span><span class="sxs-lookup"><span data-stu-id="82100-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="82100-123">**Stile di sola origine:** Gli obiettivi di rilascio non sono rappresentati dagli elementi di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="82100-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="82100-124">Durante un'operazione di trascinamento, gli eventi hanno origine solo dall'elemento trascinato.</span><span class="sxs-lookup"><span data-stu-id="82100-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="82100-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) è un'interfaccia di sola lettura progettata per il monitoraggio delle operazioni di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="82100-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="82100-126">Non è possibile usarlo per controllare un'operazione di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="82100-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="82100-127">È possibile automatizzare le operazioni di trascinamento inviando l'input del mouse a un controllo.</span><span class="sxs-lookup"><span data-stu-id="82100-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="82100-128">La proprietà [**IDragProvider:: grabbing**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) è obbligatoria.</span><span class="sxs-lookup"><span data-stu-id="82100-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="82100-129">Le proprietà [**IDragProvider::D ropeffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) e [**IDragProvider::D ropeffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) sono necessarie per l'implementazione di uno stile di solo origine e non sono consentite per un'implementazione dello stile di origine/destinazione.</span><span class="sxs-lookup"><span data-stu-id="82100-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="82100-130">In un'implementazione dello stile di origine/destinazione, è possibile eseguire una query sugli elementi drop-target per individuare gli effetti di rilascio.</span><span class="sxs-lookup"><span data-stu-id="82100-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="82100-131">La proprietà [**IDragProvider:: GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) rappresenta il trascinamento di più elementi.</span><span class="sxs-lookup"><span data-stu-id="82100-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="82100-132">Quando l'utente inizia l'operazione di trascinamento, è necessario creare un nuovo elemento di automazione interfaccia utente che funga da elemento di origine evento.</span><span class="sxs-lookup"><span data-stu-id="82100-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="82100-133">Questo nuovo elemento genera tutti gli eventi che l'elemento di origine avrebbe generato nella modalità di origine/destinazione o solo origine, mentre nessuno degli elementi effettivamente trascinati genera eventi.</span><span class="sxs-lookup"><span data-stu-id="82100-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="82100-134">Al termine dell'operazione di trascinamento, eliminare definitivamente l'elemento di origine dell'evento.</span><span class="sxs-lookup"><span data-stu-id="82100-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="82100-135">L'elemento deve generare eventi di modifica di proprietà per le proprietà **DropEffect** ([**\_ DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) e **DropEffects** ([**UIA \_ DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) quando cambiano.</span><span class="sxs-lookup"><span data-stu-id="82100-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="82100-136">Gli eventi di modifica delle proprietà per le altre proprietà sono consentiti, ma possono essere dedotti dagli eventi **DragStart** (DragStartEventId drag), **DragCancel** ([**UIA \_ drag \_ DragCancelEventId**](uiauto-event-ids.md)) **e DragComplete** ([**\_ \_**](uiauto-event-ids.md)[**\_ drag \_ DragCompleteEventId**](uiauto-event-ids.md)) necessari.</span><span class="sxs-lookup"><span data-stu-id="82100-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="82100-137">Membri obbligatori per **IDragProvider**</span><span class="sxs-lookup"><span data-stu-id="82100-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="82100-138">Le proprietà e i metodi seguenti sono necessari per implementare l'interfaccia [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) .</span><span class="sxs-lookup"><span data-stu-id="82100-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="82100-139">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="82100-139">Required members</span></span>                                                                        | <span data-ttu-id="82100-140">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="82100-140">Member type</span></span> | <span data-ttu-id="82100-141">Note</span><span class="sxs-lookup"><span data-stu-id="82100-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="82100-142">**Con acquisizione**</span><span class="sxs-lookup"><span data-stu-id="82100-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="82100-143">Proprietà</span><span class="sxs-lookup"><span data-stu-id="82100-143">Property</span></span>    | <span data-ttu-id="82100-144">nessuno</span><span class="sxs-lookup"><span data-stu-id="82100-144">None</span></span>                                                                          |
| [<span data-ttu-id="82100-145">**DropEffect**</span><span class="sxs-lookup"><span data-stu-id="82100-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="82100-146">Proprietà</span><span class="sxs-lookup"><span data-stu-id="82100-146">Property</span></span>    | <span data-ttu-id="82100-147">Obbligatorio per un'implementazione dello stile di sola origine.</span><span class="sxs-lookup"><span data-stu-id="82100-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="82100-148">**DropEffects**</span><span class="sxs-lookup"><span data-stu-id="82100-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="82100-149">Proprietà</span><span class="sxs-lookup"><span data-stu-id="82100-149">Property</span></span>    | <span data-ttu-id="82100-150">Obbligatorio se è presente più di un possibile effetto di rilascio per l'elemento catturato.</span><span class="sxs-lookup"><span data-stu-id="82100-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="82100-151">**GetGrabbedItems**</span><span class="sxs-lookup"><span data-stu-id="82100-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="82100-152">Metodo</span><span class="sxs-lookup"><span data-stu-id="82100-152">Method</span></span>      | <span data-ttu-id="82100-153">Obbligatorio per un'operazione di trascinamento di più elementi.</span><span class="sxs-lookup"><span data-stu-id="82100-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="82100-154">**\_Drag \_ DRAGSTARTEVENTID di UIA**</span><span class="sxs-lookup"><span data-stu-id="82100-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="82100-155">Evento</span><span class="sxs-lookup"><span data-stu-id="82100-155">Event</span></span>       | <span data-ttu-id="82100-156">nessuno</span><span class="sxs-lookup"><span data-stu-id="82100-156">None</span></span>                                                                          |
| [<span data-ttu-id="82100-157">**\_Drag \_ DRAGCANCELEVENTID di UIA**</span><span class="sxs-lookup"><span data-stu-id="82100-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="82100-158">Evento</span><span class="sxs-lookup"><span data-stu-id="82100-158">Event</span></span>       | <span data-ttu-id="82100-159">nessuno</span><span class="sxs-lookup"><span data-stu-id="82100-159">None</span></span>                                                                          |
| [<span data-ttu-id="82100-160">**\_Drag \_ DRAGCOMPLETEEVENTID di UIA**</span><span class="sxs-lookup"><span data-stu-id="82100-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="82100-161">Evento</span><span class="sxs-lookup"><span data-stu-id="82100-161">Event</span></span>       | <span data-ttu-id="82100-162">nessuno</span><span class="sxs-lookup"><span data-stu-id="82100-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="82100-163">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="82100-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="82100-164">Tipi di controllo e i pattern di controllo supportati</span><span class="sxs-lookup"><span data-stu-id="82100-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="82100-165">Pattern di controllo DropTarget</span><span class="sxs-lookup"><span data-stu-id="82100-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="82100-166">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="82100-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="82100-167">Panoramica dell'albero di automazione dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="82100-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="82100-168">Supporto di automazione interfaccia utente per il trascinamento della selezione</span><span class="sxs-lookup"><span data-stu-id="82100-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 