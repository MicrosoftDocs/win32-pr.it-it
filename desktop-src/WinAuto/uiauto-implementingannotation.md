---
title: Pattern di controllo Annotation
description: Vengono descritte le linee guida e le convenzioni per l'implementazione di IAnnotationProvider, incluse informazioni su proprietà e metodi. Il pattern di controllo Annotation viene usato per esporre le proprietà di un'annotazione in un documento.
ms.assetid: 5A334991-66AF-4A82-9A09-09D5BDAAA771
keywords:
- Automazione interfaccia utente, implementazione del pattern di controllo Annotation
- Automazione interfaccia utente, pattern di controllo Annotation
- Automazione interfaccia utente, IAnnotationProvider
- IAnnotationProvider
- implementazione del pattern di controllo Annotation di automazione interfaccia utente
- pattern di controllo Annotation
- pattern di controllo, IAnnotationProvider
- pattern di controllo, implementazione dell'annotazione automazione interfaccia utente
- pattern di controllo, annotazione
- interfacce, IAnnotationProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c1a0441816e548faaa9076b3a9717c0aa76f08a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300060"
---
# <a name="annotation-control-pattern"></a><span data-ttu-id="8e817-114">Pattern di controllo Annotation</span><span class="sxs-lookup"><span data-stu-id="8e817-114">Annotation Control Pattern</span></span>

<span data-ttu-id="8e817-115">Vengono descritte le linee guida e le convenzioni per l'implementazione di [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), incluse informazioni su proprietà e metodi.</span><span class="sxs-lookup"><span data-stu-id="8e817-115">Describes guidelines and conventions for implementing [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), including information about properties and methods.</span></span> <span data-ttu-id="8e817-116">Il pattern di controllo **annotation** viene usato per esporre le proprietà di un'annotazione in un documento.</span><span class="sxs-lookup"><span data-stu-id="8e817-116">The **Annotation** control pattern is used to expose the properties of an annotation in a document.</span></span>

<span data-ttu-id="8e817-117">Un esempio è un fumetto di commento che si trova nel margine di un documento ed è connesso a un testo del documento o a una cella di un foglio di calcolo.</span><span class="sxs-lookup"><span data-stu-id="8e817-117">One example is a comment balloon that is in the margin of a document and is connected to some document text or a spreadsheet cell.</span></span>

<span data-ttu-id="8e817-118">Nell'illustrazione seguente viene illustrato un esempio di un'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-118">The following illustration shows an example of an annotation.</span></span> <span data-ttu-id="8e817-119">Per esempi di controlli che implementano questo pattern di controllo, vedere [tipi di controllo e i pattern di controllo supportati](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="8e817-119">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

![screenshot che mostra un commento baloon in un documento](images/annotation.png)

<span data-ttu-id="8e817-121">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="8e817-121">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="8e817-122">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="8e817-122">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="8e817-123">Membri obbligatori per **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="8e817-123">Required Members for **IAnnotationProvider**</span></span>](#required-members-for-iannotationprovider)
-   [<span data-ttu-id="8e817-124">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8e817-124">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="8e817-125">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="8e817-125">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="8e817-126">Quando si implementa il pattern di controllo **annotation** , tenere presenti le linee guida e le convenzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e817-126">When implementing the **Annotation** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="8e817-127">Esistono molti tipi diversi di annotazioni.</span><span class="sxs-lookup"><span data-stu-id="8e817-127">There are many different kinds of annotations.</span></span> <span data-ttu-id="8e817-128">Il file di intestazione UIAutomationClient. h definisce un set di valori costanti denominati che identificano i tipi di annotazioni supportati da automazione interfaccia utente Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8e817-128">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that Microsoft UI Automation supports.</span></span> <span data-ttu-id="8e817-129">Per altre informazioni, vedere [**identificatori dei tipi di annotazione**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="8e817-129">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>
-   <span data-ttu-id="8e817-130">Se si usa [**AnnotationType \_ Unknown**](uiauto-annotation-type-identifiers.md), è necessario implementare la proprietà [**IAnnotationProvider:: AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) per consentire ai client di individuare il nome del tipo di annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-130">If you use [**AnnotationType\_Unknown**](uiauto-annotation-type-identifiers.md), you must implement the [**IAnnotationProvider::AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) property to enable clients to discover the name of the annotation type.</span></span> <span data-ttu-id="8e817-131">Non è necessario implementare **AnnotationTypeName** per un tipo di annotazione standard perché automazione interfaccia utente fornisce un nome predefinito, ma è possibile implementarlo se è necessario eseguire l'override del nome predefinito.</span><span class="sxs-lookup"><span data-stu-id="8e817-131">You do not need to implement **AnnotationTypeName** for a standard annotation type because UI Automation provides a default name, but you can implement it if you need to override the default name.</span></span>
-   <span data-ttu-id="8e817-132">La proprietà [**IAnnotationProvider:: Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="8e817-132">The [**IAnnotationProvider::Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) property is optional.</span></span>
-   <span data-ttu-id="8e817-133">La proprietà [**IAnnotationProvider::D atetime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="8e817-133">The [**IAnnotationProvider::DateTime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) property is optional.</span></span>
-   <span data-ttu-id="8e817-134">La proprietà [**IAnnotationProvider:: target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) è obbligatoria perché collega un'annotazione a un elemento dell'interfaccia utente, consentendo a un client di spostarsi dall'annotazione all'elemento dell'interfaccia utente a cui si riferisce l'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-134">The [**IAnnotationProvider::Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) property is required because it links an annotation to a UI element, enabling a client to navigate from the annotation back to the UI element to which the annotation refers.</span></span>
-   <span data-ttu-id="8e817-135">Poiché le annotazioni possono assumere molti formati diversi, l'interfaccia [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) non definisce una proprietà per archiviare il valore o il testo di un'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-135">Because annotations can take many different forms, the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface does not define a property for storing the value or text of an annotation.</span></span> <span data-ttu-id="8e817-136">Un'annotazione semplice deve esporre l'interfaccia [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) e la proprietà [**IValueProvider:: value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) deve restituire un valore di sola lettura che specifica il testo dell'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-136">A simple annotation should expose the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface, and the [**IValueProvider::Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) property should return a read-only value that specifies the annotation text.</span></span> <span data-ttu-id="8e817-137">Un'annotazione più dettagliata deve esporre l'interfaccia [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) per fornire un testo più completo ai client.</span><span class="sxs-lookup"><span data-stu-id="8e817-137">A richer annotation should expose the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface to provide richer text to clients.</span></span>
-   <span data-ttu-id="8e817-138">Lo spostamento da un elemento dell'interfaccia utente a un'annotazione sull'elemento dipende dal tipo di elemento annotato, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="8e817-138">Navigating from a UI element to an annotation on the element depends on the kind of element being annotated, as follows:</span></span>
    -   <span data-ttu-id="8e817-139">Per le celle del foglio di calcolo, implementare il metodo [**ISpreadsheetItemProvider:: GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) per fare riferimento all'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-139">For spreadsheet cells, implement the [**ISpreadsheetItemProvider::GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) method to refer to the annotation.</span></span>
    -   <span data-ttu-id="8e817-140">Per il contenuto testuale, implementare l'attributo di testo [**AnnotationObjects**](uiauto-textattribute-ids.md) nell'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) per fare riferimento all'annotazione.</span><span class="sxs-lookup"><span data-stu-id="8e817-140">For textual content, implement the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute on the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface to refer to the annotation.</span></span>
-   <span data-ttu-id="8e817-141">Alcuni tipi di annotazioni non richiedono un'implementazione completa dell'interfaccia [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="8e817-141">Some kinds of annotations do not require a full implementation of the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span> <span data-ttu-id="8e817-142">Ad esempio, un indicatore di errore di ortografia semplice può essere rappresentato facendo in modo che l'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) restituisca un attributo di testo [**AnnotationTypes**](uiauto-textattribute-ids.md) di [**AnnotationType \_ SpellingError**](uiauto-annotation-type-identifiers.md)e un valore null per l'attributo di testo [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="8e817-142">For example, a simple spelling-error indicator could be represented by having the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
-   <span data-ttu-id="8e817-143">Può essere utile implementare l'interfaccia [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) su un elemento dell'interfaccia utente che non è visibile.</span><span class="sxs-lookup"><span data-stu-id="8e817-143">It can be useful to implement the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface on a UI element that is not visible.</span></span> <span data-ttu-id="8e817-144">Ad esempio, è possibile creare un elemento di automazione interfaccia utente non visibile che implementi **IAnnotationProvider** per fornire informazioni estese su un errore di grammatica.</span><span class="sxs-lookup"><span data-stu-id="8e817-144">For example, you could create a non-visible UI Automation element that implements **IAnnotationProvider** to provide extended information about a grammar error.</span></span>
-   <span data-ttu-id="8e817-145">Le annotazioni in un controllo basato su testo possono essere complesse se il controllo contiene commenti sovrapposti.</span><span class="sxs-lookup"><span data-stu-id="8e817-145">Annotations in a text-based control can be complex if the control contains overlapping comments.</span></span> <span data-ttu-id="8e817-146">Usare le linee guida seguenti per gestire le annotazioni complesse:</span><span class="sxs-lookup"><span data-stu-id="8e817-146">Use the following guidelines to handle complex annotations:</span></span>
    -   <span data-ttu-id="8e817-147">Un intervallo di testo senza annotazioni deve restituire una matrice vuota per l'attributo di testo [**AnnotationTypes**](uiauto-textattribute-ids.md) e una matrice vuota per l'attributo di testo [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="8e817-147">A text range with no annotations should return an empty array for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an empty array for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="8e817-148">Un intervallo di testo con un'annotazione deve restituire una matrice di un valore integer per l'attributo di testo [**AnnotationTypes**](uiauto-textattribute-ids.md) e una matrice di un'interfaccia [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) per l'attributo di testo [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="8e817-148">A text range with one annotation should return an array of one integer value for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of one [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="8e817-149">Un intervallo di testo con più annotazioni deve restituire una matrice di più valori integer per l'attributo di testo [**AnnotationTypes**](uiauto-textattribute-ids.md) e una matrice di un numero corrispondente di interfacce [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) per l'attributo di testo [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="8e817-149">A text range with multiple annotations should return an array of multiple integer values for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of a matching number of [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interfaces for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="8e817-150">Un intervallo di testo con annotazioni variabili, ad esempio un intervallo con testo con annotazioni e senza annotazioni, deve restituire la proprietà [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) sia per [**AnnotationTypes**](uiauto-textattribute-ids.md) che per [**AnnotationObjects**](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="8e817-150">A text range with varying annotations, such as a range with both annotated and non-annotated text, should return the [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) property for both [**AnnotationTypes**](uiauto-textattribute-ids.md) and [**AnnotationObjects**](uiauto-textattribute-ids.md).</span></span> <span data-ttu-id="8e817-151">Un client che riceve questa risposta può suddividere l'intervallo di testo per individuare il punto in cui iniziano e terminano le annotazioni.</span><span class="sxs-lookup"><span data-stu-id="8e817-151">A client receiving this response can subdivide the text range to find where the annotations begin and end.</span></span>

## <a name="required-members-for-iannotationprovider"></a><span data-ttu-id="8e817-152">Membri obbligatori per **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="8e817-152">Required Members for **IAnnotationProvider**</span></span>

<span data-ttu-id="8e817-153">Le proprietà seguenti sono necessarie per l'implementazione dell'interfaccia [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="8e817-153">The following properties are required for implementing the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span>



| <span data-ttu-id="8e817-154">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="8e817-154">Required members</span></span>                                                                | <span data-ttu-id="8e817-155">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="8e817-155">Member type</span></span> | <span data-ttu-id="8e817-156">Note</span><span class="sxs-lookup"><span data-stu-id="8e817-156">Notes</span></span> |
|---------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="8e817-157">**AnnotationTypeId**</span><span class="sxs-lookup"><span data-stu-id="8e817-157">**AnnotationTypeId**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypeid)     | <span data-ttu-id="8e817-158">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8e817-158">Property</span></span>    | <span data-ttu-id="8e817-159">Nessuna.</span><span class="sxs-lookup"><span data-stu-id="8e817-159">None.</span></span> |
| [<span data-ttu-id="8e817-160">**AnnotationTypeName**</span><span class="sxs-lookup"><span data-stu-id="8e817-160">**AnnotationTypeName**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) | <span data-ttu-id="8e817-161">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8e817-161">Property</span></span>    | <span data-ttu-id="8e817-162">Nessuna.</span><span class="sxs-lookup"><span data-stu-id="8e817-162">None.</span></span> |
| [<span data-ttu-id="8e817-163">**Autore**</span><span class="sxs-lookup"><span data-stu-id="8e817-163">**Author**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)                         | <span data-ttu-id="8e817-164">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8e817-164">Property</span></span>    | <span data-ttu-id="8e817-165">Nessuna.</span><span class="sxs-lookup"><span data-stu-id="8e817-165">None.</span></span> |
| [<span data-ttu-id="8e817-166">**DateTime**</span><span class="sxs-lookup"><span data-stu-id="8e817-166">**DateTime**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)                     | <span data-ttu-id="8e817-167">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8e817-167">Property</span></span>    | <span data-ttu-id="8e817-168">Nessuna.</span><span class="sxs-lookup"><span data-stu-id="8e817-168">None.</span></span> |
| [<span data-ttu-id="8e817-169">**Destinazione**</span><span class="sxs-lookup"><span data-stu-id="8e817-169">**Target**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)                         | <span data-ttu-id="8e817-170">Proprietà</span><span class="sxs-lookup"><span data-stu-id="8e817-170">Property</span></span>    | <span data-ttu-id="8e817-171">Nessuna.</span><span class="sxs-lookup"><span data-stu-id="8e817-171">None.</span></span> |



 

<span data-ttu-id="8e817-172">Questo pattern di controllo non è associato a eventi.</span><span class="sxs-lookup"><span data-stu-id="8e817-172">This control pattern has no associated events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8e817-173">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="8e817-173">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8e817-174">Tipi di controllo e i pattern di controllo supportati</span><span class="sxs-lookup"><span data-stu-id="8e817-174">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="8e817-175">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="8e817-175">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="8e817-176">Panoramica dell'albero di automazione dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="8e817-176">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 