---
title: Chiamata di API Active Accessibility
description: Microsoft Active Accessibility fornisce API (Application Programming Interface) per client e server.
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104046887"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="eaa25-103">Chiamata di API Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="eaa25-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="eaa25-104">Microsoft Active Accessibility fornisce API (Application Programming Interface) per client e server.</span><span class="sxs-lookup"><span data-stu-id="eaa25-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="eaa25-105">La maggior parte è implementata nella libreria a collegamento dinamico Microsoft Active Accessibility, Oleacc.dll, mentre [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)e [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) sono implementate in user32.dll, che è un componente principale del sistema operativo Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="eaa25-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="eaa25-106">I computer che eseguono Windows 95 o Microsoft Windows NT 4,0 non hanno Oleacc.dll e la versione corretta di user32.dll installata perché Microsoft Active Accessibility è stata incorporata in fasi nelle versioni successive di Windows.</span><span class="sxs-lookup"><span data-stu-id="eaa25-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="eaa25-107">Di conseguenza, le applicazioni eseguite su queste piattaforme si collegano in modo esplicito a Oleacc.dll in fase di esecuzione utilizzando la funzione [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) anziché basarsi sulle librerie di importazione.</span><span class="sxs-lookup"><span data-stu-id="eaa25-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="eaa25-108">Active Accessibility 1,3 supporta Windows 95 e Microsoft Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="eaa25-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="eaa25-109">Le versioni precedenti di Windows non sono supportate da Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="eaa25-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="eaa25-110">Le applicazioni server utilizzano la funzione [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) per recuperare l'indirizzo di una funzione di Microsoft Active Accessibility e quindi effettuare la chiamata tramite un puntatore a funzione.</span><span class="sxs-lookup"><span data-stu-id="eaa25-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="eaa25-111">Se si chiama una funzione implementata in Oleacc.dll, le applicazioni server utilizzano l'handle restituito da [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) nella chiamata a **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="eaa25-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="eaa25-112">Se si chiama una funzione definita in user32.dll, le applicazioni server chiamano [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specificando "user32" e utilizzano l'handle del modulo restituito nella chiamata a **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="eaa25-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="eaa25-113">Se, ad esempio, un'applicazione usa [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), chiama [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) usando l'handle del modulo di user32.dll per ottenere l'indirizzo della funzione.</span><span class="sxs-lookup"><span data-stu-id="eaa25-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="eaa25-114">Se la chiamata ha esito positivo (vale a dire che questa versione di Windows supporta Microsoft Active Accessibility), l'applicazione imposta un flag che indica che è sicuro chiamare **NotifyWinEvent**.</span><span class="sxs-lookup"><span data-stu-id="eaa25-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="eaa25-115">L'indirizzo ricevuto da **GetProcAddress** viene archiviato in una variabile puntatore a funzione e usato in tutto il codice.</span><span class="sxs-lookup"><span data-stu-id="eaa25-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 