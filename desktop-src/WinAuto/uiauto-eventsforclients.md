---
title: Sottoscrizione degli eventi di automazione interfaccia utente
description: Automazione interfaccia utente Microsoft consente ai client di sottoscrivere gli eventi di interesse. Questa funzionalità consente di migliorare le prestazioni eliminando la necessità di eseguire continuamente il polling degli elementi dell'interfaccia utente nel sistema per verificare se sono state apportate modifiche alle informazioni, alla struttura o allo stato.
ms.assetid: 7019ecb8-6123-4e00-926c-6725d7e71385
keywords:
- client, eventi di automazione interfaccia utente
- client, eventi per l'automazione interfaccia utente
- Automazione interfaccia utente, eventi per i client
- Automazione interfaccia utente, eventi client
- Automazione interfaccia utente, sottoscrizione di eventi
- Automazione interfaccia utente, metodi di sottoscrizione
- Automazione interfaccia utente, esempi di codice
- Automazione interfaccia utente, esempi
- Automazione interfaccia utente, esempi
- sottoscrizione a eventi di automazione interfaccia utente
- eventi, sottoscrizione di automazione interfaccia utente
- Esempi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d9a89df1b9d2afc401e07b6cd77d1307d912f11
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104330359"
---
# <a name="subscribing-to-ui-automation-events"></a><span data-ttu-id="1282d-116">Sottoscrizione degli eventi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="1282d-116">Subscribing to UI Automation Events</span></span>

<span data-ttu-id="1282d-117">Automazione interfaccia utente Microsoft consente ai client di sottoscrivere gli eventi di interesse.</span><span class="sxs-lookup"><span data-stu-id="1282d-117">Microsoft UI Automation allows clients to subscribe to events of interest.</span></span> <span data-ttu-id="1282d-118">Questa funzionalità consente di migliorare le prestazioni eliminando la necessità di eseguire continuamente il polling degli elementi dell'interfaccia utente nel sistema per verificare se sono state apportate modifiche alle informazioni, alla struttura o allo stato.</span><span class="sxs-lookup"><span data-stu-id="1282d-118">This capability improves performance by eliminating the need to continually poll the UI elements in the system to see if any information, structure, or state has changed.</span></span>

<span data-ttu-id="1282d-119">Una maggiore efficienza è ottenuta anche grazie alla possibilità di restare in ascolto di eventi solo in un ambito definito.</span><span class="sxs-lookup"><span data-stu-id="1282d-119">Efficiency is also improved by the ability to listen for events only within a defined scope.</span></span> <span data-ttu-id="1282d-120">Un client può ad esempio restare in ascolto delle modifiche di selezione di un elemento di un elenco, nell'elenco stesso o in un'intera finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="1282d-120">For example, a client can listen for selection changes on an item in a list, on the list itself, or on an entire dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="1282d-121">Non presupporre che tutti gli eventi possibili vengano generati da un provider di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="1282d-121">Do not assume that all possible events are raised by a UI Automation provider.</span></span> <span data-ttu-id="1282d-122">Non tutte le modifiche alle proprietà, ad esempio, determinano la generazione di eventi da parte dei provider proxy standard per i controlli Windows Form e Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="1282d-122">For example, not all property changes cause events to be raised by the standard proxy providers for Windows Forms and Microsoft Win32 controls.</span></span>

 

<span data-ttu-id="1282d-123">Per una visualizzazione più ampia degli eventi di automazione interfaccia utente, vedere [Cenni preliminari sugli eventi di automazione interfaccia utente](uiauto-eventsoverview.md).</span><span class="sxs-lookup"><span data-stu-id="1282d-123">For a broader view of UI Automation events, see [UI Automation Events Overview](uiauto-eventsoverview.md).</span></span>

> [!Note]  
> <span data-ttu-id="1282d-124">Prima di implementare un gestore eventi, è necessario conoscere i problemi di threading descritti in [informazioni sui problemi di threading](uiauto-threading.md).</span><span class="sxs-lookup"><span data-stu-id="1282d-124">Before implementing an event handler, you should be familiar with the threading issues described in [Understanding Threading Issues](uiauto-threading.md).</span></span>

 

<span data-ttu-id="1282d-125">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="1282d-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="1282d-126">Registrazione di gestori eventi</span><span class="sxs-lookup"><span data-stu-id="1282d-126">Registering Event Handlers</span></span>](#registering-event-handlers)
-   [<span data-ttu-id="1282d-127">esempi</span><span class="sxs-lookup"><span data-stu-id="1282d-127">Examples</span></span>](#examples)
-   [<span data-ttu-id="1282d-128">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1282d-128">Related topics</span></span>](#related-topics)

## <a name="registering-event-handlers"></a><span data-ttu-id="1282d-129">Registrazione di gestori eventi</span><span class="sxs-lookup"><span data-stu-id="1282d-129">Registering Event Handlers</span></span>

<span data-ttu-id="1282d-130">Le applicazioni client sottoscrivono eventi di un particolare tipo registrando un gestore eventi, usando uno dei metodi [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) seguenti.</span><span class="sxs-lookup"><span data-stu-id="1282d-130">Client applications subscribe to events of a particular kind by registering an event handler, using one of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>



| <span data-ttu-id="1282d-131">Metodo di sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="1282d-131">Subscription Method</span></span>                                                                                                                                                                                                | <span data-ttu-id="1282d-132">Tipo evento</span><span class="sxs-lookup"><span data-stu-id="1282d-132">Event Type</span></span>       | <span data-ttu-id="1282d-133">Interfaccia di callback</span><span class="sxs-lookup"><span data-stu-id="1282d-133">Callback Interface</span></span>                                                                                    |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1282d-134">**AddFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-134">**AddFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler)                                                                                                                            | <span data-ttu-id="1282d-135">Modifica dello stato attivo</span><span class="sxs-lookup"><span data-stu-id="1282d-135">Focus change</span></span>     | [<span data-ttu-id="1282d-136">**IUIAutomationFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-136">**IUIAutomationFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler)         |
| <span data-ttu-id="1282d-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [ **AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span><span class="sxs-lookup"><span data-stu-id="1282d-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span></span> | <span data-ttu-id="1282d-138">Modifica proprietà</span><span class="sxs-lookup"><span data-stu-id="1282d-138">Property change</span></span>  | [<span data-ttu-id="1282d-139">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-139">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler)   |
| [<span data-ttu-id="1282d-140">**AddStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-140">**AddStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler)                                                                                                                    | <span data-ttu-id="1282d-141">Modifica struttura</span><span class="sxs-lookup"><span data-stu-id="1282d-141">Structure change</span></span> | [<span data-ttu-id="1282d-142">**IUIAutomationStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-142">**IUIAutomationStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationstructurechangedeventhandler) |
| [<span data-ttu-id="1282d-143">**AddNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-143">**AddNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler)                                                                                                                           | <span data-ttu-id="1282d-144">Notifica</span><span class="sxs-lookup"><span data-stu-id="1282d-144">Notification</span></span>     | [<span data-ttu-id="1282d-145">**IUIAutomationNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-145">**IUIAutomationNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationnotificationeventhandler)         |
| [<span data-ttu-id="1282d-146">**AddAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-146">**AddAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler)                                                                                                                                | <span data-ttu-id="1282d-147">Altri eventi</span><span class="sxs-lookup"><span data-stu-id="1282d-147">Other events</span></span>     | [<span data-ttu-id="1282d-148">**IUIAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-148">**IUIAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationeventhandler)                                 |



 

<span data-ttu-id="1282d-149">Quando un client aggiunge un gestore eventi per tutti i discendenti [**( \_ discendenti TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), l'automazione interfaccia utente aggiunge un solo gestore per la radice del sottoalbero e il gestore resta in attesa su tutti i discendenti.</span><span class="sxs-lookup"><span data-stu-id="1282d-149">When a client adds an event handler for all descendants ([**TreeScope\_Descendants**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), UI Automation adds only one handler for the root of sub-tree, and the handler listens across all descendents.</span></span> <span data-ttu-id="1282d-150">L'automazione interfaccia utente non aggiunge i gestori eventi in modo ricorsivo.</span><span class="sxs-lookup"><span data-stu-id="1282d-150">UI Automation does not add event handlers recursively.</span></span>

<span data-ttu-id="1282d-151">Quando un client chiama il metodo [**IUIAutomation:: RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) , l'automazione interfaccia utente rimuove tutti i gestori eventi dal processo client.</span><span class="sxs-lookup"><span data-stu-id="1282d-151">When a client calls the [**IUIAutomation::RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) method, UI Automation removes all event handlers from the client process.</span></span>

<span data-ttu-id="1282d-152">Per ricevere e gestire gli eventi, si implementa un oggetto di gestione degli eventi che espone un'interfaccia di callback ed è necessario registrare l'oggetto chiamando un metodo di registrazione eventi, ad esempio [**IUIAutomation:: AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1282d-152">To receive and handle events, you implement an event-handling object that exposes a callback interface, and you must register the object by calling an event registration method such as [**IUIAutomation::AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span></span> <span data-ttu-id="1282d-153">L'interfaccia di callback ha un solo metodo; Automazione interfaccia utente chiama questo metodo quando l'evento viene elaborato.</span><span class="sxs-lookup"><span data-stu-id="1282d-153">The callback interface has a single method; UI Automation calls this method when the event is processed.</span></span>

<span data-ttu-id="1282d-154">Al momento dell'arresto o quando gli eventi di automazione interfaccia utente non sono più di interesse per l'applicazione, i client di automazione interfaccia utente devono chiamare uno o più dei seguenti metodi [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) .</span><span class="sxs-lookup"><span data-stu-id="1282d-154">On shutdown, or when UI Automation events are no longer of interest to the application, UI Automation clients should call one or more of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>

> [!Note]  
> <span data-ttu-id="1282d-155">Un client di automazione interfaccia utente non deve usare più thread per aggiungere o rimuovere i gestori eventi.</span><span class="sxs-lookup"><span data-stu-id="1282d-155">A UI Automation client should not use multiple threads to add or remove event handlers.</span></span> <span data-ttu-id="1282d-156">Un comportamento imprevisto può verificarsi se un gestore eventi viene aggiunto o rimosso mentre un altro viene aggiunto o rimosso nello stesso processo client.</span><span class="sxs-lookup"><span data-stu-id="1282d-156">Unexpected behavior can result if one event handler is being added or removed while another is being added or removed in the same client process.</span></span>

 



| <span data-ttu-id="1282d-157">Metodo</span><span class="sxs-lookup"><span data-stu-id="1282d-157">Method</span></span>                                                                                                | <span data-ttu-id="1282d-158">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1282d-158">Description</span></span>                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1282d-159">**RemoveAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-159">**RemoveAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removeautomationeventhandler)             | <span data-ttu-id="1282d-160">Annulla la registrazione di un gestore eventi registrato utilizzando [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1282d-160">Unregisters an event handler that was registered by using [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span></span>                                                                                                                                  |
| [<span data-ttu-id="1282d-161">**RemoveFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-161">**RemoveFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removefocuschangedeventhandler)         | <span data-ttu-id="1282d-162">Annulla la registrazione di un gestore eventi registrato utilizzando [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1282d-162">Unregisters an event handler that was registered by using [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span></span>                                                                                                                              |
| [<span data-ttu-id="1282d-163">**RemovePropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-163">**RemovePropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removepropertychangedeventhandler)   | <span data-ttu-id="1282d-164">Annulla la registrazione di un gestore eventi registrato tramite [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) o [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span><span class="sxs-lookup"><span data-stu-id="1282d-164">Unregisters an event handler that was registered by using [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) or [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span></span> |
| [<span data-ttu-id="1282d-165">**RemoveStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-165">**RemoveStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removestructurechangedeventhandler) | <span data-ttu-id="1282d-166">Annulla la registrazione di un gestore eventi registrato utilizzando [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1282d-166">Unregisters an event handler that was registered by using [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span></span>                                                                                                                      |
| [<span data-ttu-id="1282d-167">**RemoveNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="1282d-167">**RemoveNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-removenotificationeventhandler)        | <span data-ttu-id="1282d-168">Annulla la registrazione di un gestore eventi registrato da Weas usando [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="1282d-168">Unregisters an event handler that weas registered by using [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span></span>                                                                                                                            |
| [<span data-ttu-id="1282d-169">**RemoveAllEventHandlers**</span><span class="sxs-lookup"><span data-stu-id="1282d-169">**RemoveAllEventHandlers**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers)                         | <span data-ttu-id="1282d-170">Annulla la registrazione di tutti i gestori eventi registrati.</span><span class="sxs-lookup"><span data-stu-id="1282d-170">Unregisters all registered event handlers.</span></span>                                                                                                                                                                                                                                      |



 

<span data-ttu-id="1282d-171">È possibile recapitare un evento a un gestore eventi dopo che è stata annullata la sottoscrizione del gestore, se l'evento viene ricevuto simultaneamente con la richiesta di annullare la sottoscrizione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="1282d-171">It is possible for an event to be delivered to an event handler after the handler has been unsubscribed, if the event is received simultaneously with the request to unsubscribe the event.</span></span> <span data-ttu-id="1282d-172">La procedura consigliata consiste nel seguire lo standard Component Object Model (COM) ed evitare di eliminare definitivamente l'oggetto gestore eventi fino a quando il conteggio dei riferimenti non raggiunge zero.</span><span class="sxs-lookup"><span data-stu-id="1282d-172">The best practice is to follow the Component Object Model (COM) standard and avoid destroying the event handler object until its reference count has reached zero.</span></span> <span data-ttu-id="1282d-173">L'eliminazione definitiva di un gestore eventi dopo l'annullamento della sottoscrizione per gli eventi potrebbe causare una violazione di accesso se un evento viene recapitato in ritardo.</span><span class="sxs-lookup"><span data-stu-id="1282d-173">Destroying an event handler immediately after unsubscribing for events may result in an access violation if an event is delivered late.</span></span>

## <a name="examples"></a><span data-ttu-id="1282d-174">Esempio</span><span class="sxs-lookup"><span data-stu-id="1282d-174">Examples</span></span>

<span data-ttu-id="1282d-175">Per esempi di codice che illustrano come gestire gli eventi di automazione interfaccia utente, vedere [come implementare i gestori eventi](uiauto-howto-implement-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1282d-175">For code examples that show how to handle UI Automation events, see [How to Implement Event Handlers](uiauto-howto-implement-event-handlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1282d-176">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1282d-176">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="1282d-177">**Informazioni concettuali**</span><span class="sxs-lookup"><span data-stu-id="1282d-177">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="1282d-178">Cenni preliminari sugli eventi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="1282d-178">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> <dt>

[<span data-ttu-id="1282d-179">Informazioni sui problemi di threading</span><span class="sxs-lookup"><span data-stu-id="1282d-179">Understanding Threading Issues</span></span>](uiauto-threading.md)
</dt> </dl>

 

 




