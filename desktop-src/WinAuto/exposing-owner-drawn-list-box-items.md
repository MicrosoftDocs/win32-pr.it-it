---
title: Esposizione Owner-Drawn elementi della casella di riepilogo
description: Gli sviluppatori di applicazioni non devono implementare IAccessible per esporre gli elementi in una casella di riepilogo creata dal proprietario con lo stile LBS \_ HASSTRINGS perché Microsoft Active Accessibility espone gli elementi nelle caselle di riepilogo con questo stile.
ms.assetid: d54ce297-ce8a-46c0-a86d-4acffa1eda27
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2fbb72285f55796a285cd6e1a8838a629218659b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399486"
---
# <a name="exposing-owner-drawn-list-box-items"></a><span data-ttu-id="e8d55-103">Esposizione Owner-Drawn elementi della casella di riepilogo</span><span class="sxs-lookup"><span data-stu-id="e8d55-103">Exposing Owner-Drawn List Box Items</span></span>

<span data-ttu-id="e8d55-104">Gli sviluppatori di applicazioni non devono implementare [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) per esporre gli elementi in una casella di riepilogo creata dal proprietario con lo stile **lbs \_ HASSTRINGS** perché Microsoft Active Accessibility espone gli elementi nelle caselle di riepilogo con questo stile.</span><span class="sxs-lookup"><span data-stu-id="e8d55-104">Application developers do not need to implement [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) to expose the items in an owner-drawn list box that has the style **LBS\_HASSTRINGS** because Microsoft Active Accessibility exposes the items in list boxes with this style.</span></span> <span data-ttu-id="e8d55-105">Gli elementi in una casella di riepilogo creata dal proprietario con lo stile **\_ HASSTRINGS lbs** vengono visualizzati come testo.</span><span class="sxs-lookup"><span data-stu-id="e8d55-105">The items in an owner-drawn list box with the **LBS\_HASSTRINGS** style are displayed as text.</span></span> <span data-ttu-id="e8d55-106">Questo stile viene tuttavia utilizzato anche con caselle di riepilogo create dal proprietario che non visualizzano testo, in modo che gli elementi della casella di riepilogo siano esposti da Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="e8d55-106">However, this style is also used with owner-drawn list boxes that do not display text so that the list box items are exposed by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="e8d55-107">Per consentire a Microsoft Active Accessibility di esporre gli elementi in una casella di riepilogo creata dal proprietario che non Visualizza il testo:</span><span class="sxs-lookup"><span data-stu-id="e8d55-107">To allow Microsoft Active Accessibility to expose the items in an owner-drawn list box that does not display text:</span></span>

-   <span data-ttu-id="e8d55-108">Usare lo **stile \_ HASSTRINGS di lbs** durante la creazione della casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="e8d55-108">Use the **LBS\_HASSTRINGS** style when creating the list box.</span></span>
-   <span data-ttu-id="e8d55-109">Creare una controparte testuale che denomina o descriva ogni elemento nella casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="e8d55-109">Create a textual counterpart that names or describes each item in the list box.</span></span>
-   <span data-ttu-id="e8d55-110">Quando si aggiungono elementi alla casella di riepilogo creata dal proprietario, usare il messaggio [lb \_ ADDSTRING](../controls/lb-addstring.md) per aggiungere il testo che si vuole esporre a Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="e8d55-110">When adding items to the owner-drawn list box, use the [LB\_ADDSTRING](../controls/lb-addstring.md) message to add the text that you want Microsoft Active Accessibility to expose.</span></span> <span data-ttu-id="e8d55-111">Questo testo non viene visualizzato, quindi non fa parte dei dati creati dal proprietario.</span><span class="sxs-lookup"><span data-stu-id="e8d55-111">This text is not displayed, so it is not part of the owner-drawn data.</span></span> <span data-ttu-id="e8d55-112">Aggiungere i dati dell'elemento creati dal proprietario usando il messaggio [lb \_ SETITEMDATA](../controls/lb-setitemdata.md) .</span><span class="sxs-lookup"><span data-stu-id="e8d55-112">Add the owner-drawn item data using the [LB\_SETITEMDATA](../controls/lb-setitemdata.md) message.</span></span>

<span data-ttu-id="e8d55-113">Quando si usa il metodo precedente, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e8d55-113">When using the above method, note the following:</span></span>

-   <span data-ttu-id="e8d55-114">Se si usa lo stile di **\_ ordinamento lbs** , la casella di riepilogo viene ordinata con le stringhe fornite e non con la procedura di callback [WM \_ COMPAREITEM](../controls/wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="e8d55-114">If you use the **LBS\_SORT** style, the list box is sorted using the supplied strings and not the [WM\_COMPAREITEM](../controls/wm-compareitem.md) callback procedure.</span></span>
-   <span data-ttu-id="e8d55-115">Con le caselle di riepilogo delle variabili disegnate dal proprietario create con lo stile **lbs \_ OwnerDrawVariable**, usare una variabile globale o un altro meccanismo per tenere traccia del momento in cui il **membro ItemData** di [MEASUREITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-measureitemstruct) è valido.</span><span class="sxs-lookup"><span data-stu-id="e8d55-115">With owner-drawn variable list boxes created with the style **LBS\_OWNERDRAWVARIABLE**, use a global variable or some other mechanism to keep track of when the **itemData member** of the [MEASUREITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-measureitemstruct) is valid.</span></span> <span data-ttu-id="e8d55-116">La variabile globale è necessaria perché il sistema invia il messaggio [WM \_ MeasureItem](../controls/wm-measureitem.md) non appena la stringa viene aggiunta ma prima che i dati dell'elemento siano collegati e a questo punto il membro **ItemData** non è valido.</span><span class="sxs-lookup"><span data-stu-id="e8d55-116">The global variable is needed because the system sends the [WM\_MEASUREITEM](../controls/wm-measureitem.md) message as soon as the string is added but before the item data is attached, and at this point the **itemData** member is not valid.</span></span>
-   <span data-ttu-id="e8d55-117">Per modificare la stringa per un elemento in una casella di riepilogo con lo stile **\_ HASSTRINGS lbs** , eliminare l'elemento con il messaggio [lb \_ DELETESTRING](../controls/lb-deletestring.md) e aggiungere la nuova stringa con il \_ messaggio lb ADDSTRING.</span><span class="sxs-lookup"><span data-stu-id="e8d55-117">To change the string for an item in a list box with the **LBS\_HASSTRINGS** style, delete the item with the [LB\_DELETESTRING](../controls/lb-deletestring.md) message and add the new string with the LB\_ADDSTRING message.</span></span>

 

 