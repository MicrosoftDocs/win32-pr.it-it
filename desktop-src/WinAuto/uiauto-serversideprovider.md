---
title: Implementare un provider di automazione interfaccia utente Server-Side
description: Questo argomento descrive come implementare un provider di automazione interfaccia utente Microsoft sul lato server per un controllo personalizzato scritto in C++.
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- Automazione interfaccia utente, implementazione del provider lato server
- Automazione interfaccia utente, implementazione del provider
- Automazione interfaccia utente, implementazione di provider lato server
- Automazione interfaccia utente, implementazione di provider
- provider lato server, implementazione
- provider lato server, interfacce
- provider lato server, valori delle proprietà
- provider lato server, eventi
- provider lato server, assegnazione di un nuovo elemento padre
- eventi, provider lato server
- interfacce, provider lato server
- provider, implementazione
- implementazione di provider lato server
- implementazione di provider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300266"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="53104-117">Implementare un provider di automazione interfaccia utente Server-Side</span><span class="sxs-lookup"><span data-stu-id="53104-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="53104-118">Questo argomento descrive come implementare un provider di automazione interfaccia utente Microsoft sul lato server per un controllo personalizzato scritto in C++.</span><span class="sxs-lookup"><span data-stu-id="53104-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="53104-119">Contiene le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="53104-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="53104-120">Interfacce del provider</span><span class="sxs-lookup"><span data-stu-id="53104-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="53104-121">Funzionalità richiesta per i provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="53104-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="53104-122">Valori delle proprietà</span><span class="sxs-lookup"><span data-stu-id="53104-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="53104-123">Eventi dai provider</span><span class="sxs-lookup"><span data-stu-id="53104-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="53104-124">Navigazione del provider</span><span class="sxs-lookup"><span data-stu-id="53104-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="53104-125">Assegnazione di un nuovo elemento padre</span><span class="sxs-lookup"><span data-stu-id="53104-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="53104-126">Riposizionamento del provider</span><span class="sxs-lookup"><span data-stu-id="53104-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="53104-127">Disconnessione di provider</span><span class="sxs-lookup"><span data-stu-id="53104-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="53104-128">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="53104-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="53104-129">Per esempi di codice che illustrano come implementare i provider lato server, vedere procedure [per i provider di automazione interfaccia utente](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="53104-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="53104-130">Interfacce del provider</span><span class="sxs-lookup"><span data-stu-id="53104-130">Provider Interfaces</span></span>

<span data-ttu-id="53104-131">Le seguenti interfacce di Component Object Model (COM) forniscono funzionalità per i controlli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="53104-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="53104-132">Per fornire funzionalità di base, ogni provider di automazione interfaccia utente deve implementare almeno l'interfaccia [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) .</span><span class="sxs-lookup"><span data-stu-id="53104-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="53104-133">Le interfacce [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) e [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) sono facoltative, ma devono essere implementate per gli elementi in un controllo complesso per fornire funzionalità aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="53104-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="53104-134">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="53104-134">Interface</span></span>                                                                         | <span data-ttu-id="53104-135">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53104-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="53104-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="53104-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="53104-137">Fornisce funzionalità di base per un controllo ospitato in una finestra, incluso il supporto per pattern di controllo e proprietà.</span><span class="sxs-lookup"><span data-stu-id="53104-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="53104-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="53104-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="53104-139">Aggiunge la funzionalità per un elemento in un controllo complesso, inclusa la navigazione nel frammento, l'impostazione dello stato attivo e la restituzione del rettangolo di delimitazione dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="53104-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="53104-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="53104-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="53104-141">Aggiunge la funzionalità per l'elemento radice in un controllo complesso, inclusi l'individuazione di un elemento figlio in corrispondenza delle coordinate specificate e l'impostazione dello stato attivo per l'intero controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="53104-142">Nell'API di automazione interfaccia utente per il codice gestito, queste interfacce formano una gerarchia di ereditarietà.</span><span class="sxs-lookup"><span data-stu-id="53104-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="53104-143">Questo non avviene in C++, in cui le interfacce sono completamente separate.</span><span class="sxs-lookup"><span data-stu-id="53104-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="53104-144">Le interfacce seguenti forniscono funzionalità aggiunte, ma l'implementazione è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="53104-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="53104-145">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="53104-145">Interface</span></span>                                                                         | <span data-ttu-id="53104-146">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53104-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="53104-147">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="53104-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="53104-148">Consente al provider di tenere traccia delle richieste per eventi.</span><span class="sxs-lookup"><span data-stu-id="53104-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="53104-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="53104-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="53104-150">Abilita il riposizionamento degli elementi basati su finestra nell'albero di automazione interfaccia utente di un frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="53104-151">Funzionalità richiesta per i provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="53104-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="53104-152">Per comunicare con l'automazione interfaccia utente, il controllo deve implementare le aree di funzionalità principali descritte nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="53104-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="53104-153">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="53104-153">Functionality</span></span>                                              | <span data-ttu-id="53104-154">Implementazione</span><span class="sxs-lookup"><span data-stu-id="53104-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="53104-155">Esporre il provider all'automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="53104-156">In risposta a un messaggio [**WM \_ GetObject**](wm-getobject.md) inviato alla finestra del controllo, restituire l'oggetto che implementa [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span><span class="sxs-lookup"><span data-stu-id="53104-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="53104-157">Per i frammenti, deve trattarsi del provider per la radice del frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="53104-158">Specificare i valori delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="53104-158">Provide property values.</span></span>                                   | <span data-ttu-id="53104-159">Implementare [**IRawElementProviderSimple:: GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) per fornire o eseguire l'override di valori.</span><span class="sxs-lookup"><span data-stu-id="53104-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="53104-160">Consentire al client di interagire con il controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="53104-161">Implementare le interfacce che supportano ogni pattern di controllo appropriato, ad esempio [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="53104-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="53104-162">Restituire questi provider di pattern di controllo nell'implementazione di [**IRawElementProviderSimple:: GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span><span class="sxs-lookup"><span data-stu-id="53104-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="53104-163">Generare eventi.</span><span class="sxs-lookup"><span data-stu-id="53104-163">Raise events.</span></span>                                              | <span data-ttu-id="53104-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), metodi di [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="53104-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="53104-165">Abilitare lo spostamento e la messa a fuoco in un frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="53104-166">Implementare [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) per ogni elemento all'interno del frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="53104-167">Non necessario per gli elementi che non fanno parte di un frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="53104-168">Abilitare la messa a fuoco e individuare gli elementi figlio in un frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="53104-169">Implementare [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="53104-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="53104-170">Non necessario per gli elementi che non sono radici di frammenti.</span><span class="sxs-lookup"><span data-stu-id="53104-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="53104-171">Valori della proprietà</span><span class="sxs-lookup"><span data-stu-id="53104-171">Property Values</span></span>

<span data-ttu-id="53104-172">I provider di automazione interfaccia utente per i controlli personalizzati devono supportare determinate proprietà che possono essere usate dall'automazione interfaccia utente e dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="53104-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="53104-173">Per gli elementi ospitati in Windows, l'automazione interfaccia utente può recuperare alcune proprietà dal provider di finestra predefinito, ma deve ottenerne altre dal provider personalizzato.</span><span class="sxs-lookup"><span data-stu-id="53104-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="53104-174">In genere, i provider per i controlli basati su finestra non devono fornire le proprietà seguenti identificate da **PROPERTYID**:</span><span class="sxs-lookup"><span data-stu-id="53104-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="53104-175">**\_BOUNDINGRECTANGLEPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-176">**\_CLICKABLEPOINTPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-177">**\_PROCESSIDPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-178">**\_CLASSNAMEPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-179">**\_HASKEYBOARDFOCUSPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-180">**\_ISENABLEDPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-181">**\_ISKEYBOARDFOCUSABLEPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-182">**\_ISPASSWORDPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-183">**\_NAMEPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="53104-184">**\_RUNTIMEIDPROPERTYID UIA**</span><span class="sxs-lookup"><span data-stu-id="53104-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="53104-185">La proprietà IDruntime di un elemento semplice o di una radice di frammento ospitata in una finestra viene ottenuta dalla finestra.</span><span class="sxs-lookup"><span data-stu-id="53104-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="53104-186">Tuttavia, gli elementi del frammento sotto la radice, ad esempio gli elementi di elenco in una casella di riepilogo, devono fornire i propri identificatori.</span><span class="sxs-lookup"><span data-stu-id="53104-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="53104-187">Per ulteriori informazioni, vedere [**IRawElementProviderFragment:: GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="53104-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="53104-188">La proprietà IsKeyboardFocusable deve essere restituita per i provider ospitati in un controllo Windows Form.</span><span class="sxs-lookup"><span data-stu-id="53104-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="53104-189">In questo caso, il provider di finestra predefinito potrebbe non essere in grado di recuperare il valore corretto.</span><span class="sxs-lookup"><span data-stu-id="53104-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="53104-190">La proprietà Name viene in genere fornita dal provider host.</span><span class="sxs-lookup"><span data-stu-id="53104-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="53104-191">Eventi dai provider</span><span class="sxs-lookup"><span data-stu-id="53104-191">Events from Providers</span></span>

<span data-ttu-id="53104-192">I provider di automazione interfaccia utente devono generare eventi per notificare alle applicazioni client le modifiche allo stato dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="53104-193">Le funzioni seguenti vengono utilizzate per generare eventi.</span><span class="sxs-lookup"><span data-stu-id="53104-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="53104-194">Funzione</span><span class="sxs-lookup"><span data-stu-id="53104-194">Function</span></span>                                                                                   | <span data-ttu-id="53104-195">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53104-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="53104-196">**UiaRaiseAutomationEvent**</span><span class="sxs-lookup"><span data-stu-id="53104-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="53104-197">Genera vari eventi, inclusi gli eventi attivati dai pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="53104-198">**UiaRaiseAutomationPropertyChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="53104-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="53104-199">Genera un evento quando viene modificata una proprietà di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="53104-200">**UiaRaiseStructureChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="53104-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="53104-201">Genera un evento quando la struttura dell'albero di automazione interfaccia utente è cambiata, ad esempio rimuovendo o aggiungendo un elemento.</span><span class="sxs-lookup"><span data-stu-id="53104-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="53104-202">Lo scopo di un evento è informare il client di qualcosa che si verifica nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="53104-203">I provider devono generare un evento indipendentemente dal fatto che la modifica sia stata attivata dall'input dell'utente o da un'applicazione client che usa l'automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="53104-204">Ad esempio, l'evento identificato da [**UIA \_ Invoke \_ InvokedEventId**](uiauto-event-ids.md) deve essere generato ogni volta che viene richiamato il controllo, tramite input utente diretto o dall'applicazione client che chiama [**IUIAutomationInvokePattern:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="53104-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="53104-205">Per ottimizzare le prestazioni, un provider può generare eventi in modo selettivo o non generarne affatto se nessuna applicazione client è registrata per riceverli.</span><span class="sxs-lookup"><span data-stu-id="53104-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="53104-206">Per l'ottimizzazione vengono usati gli elementi API seguenti.</span><span class="sxs-lookup"><span data-stu-id="53104-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="53104-207">Elemento API</span><span class="sxs-lookup"><span data-stu-id="53104-207">API Element</span></span>                                                                       | <span data-ttu-id="53104-208">Descrizione</span><span class="sxs-lookup"><span data-stu-id="53104-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="53104-209">**UiaClientsAreListening**</span><span class="sxs-lookup"><span data-stu-id="53104-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="53104-210">Questa funzione verifica se le applicazioni client hanno sottoscritto eventi di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="53104-211">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="53104-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="53104-212">L'implementazione di questa interfaccia in una radice di frammento consente al provider di essere avvisati quando i client registrano e annullano la registrazione dei gestori eventi per gli eventi nel frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="53104-213">Analogamente all'implementazione del conteggio dei riferimenti nella programmazione COM, è importante per i provider di automazione interfaccia utente trattare i metodi [**IRawElementProviderAdviseEvents:: AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) e [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) , come i metodi [**IUnknown:: AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) e [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) dell'interfaccia [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="53104-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="53104-214">Fino a quando **AdviseEventAdded** è stato chiamato più volte rispetto a **AdviseEventRemoved** per un evento o una proprietà specifica, il provider deve continuare a generare eventi corrispondenti, perché alcuni client sono ancora in ascolto.</span><span class="sxs-lookup"><span data-stu-id="53104-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="53104-215">In alternativa, i provider di automazione interfaccia utente possono utilizzare la funzione [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) per determinare se almeno un client è in ascolto e, in caso affermativo, generare tutti gli eventi appropriati.</span><span class="sxs-lookup"><span data-stu-id="53104-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="53104-216">Navigazione del provider</span><span class="sxs-lookup"><span data-stu-id="53104-216">Provider Navigation</span></span>

<span data-ttu-id="53104-217">I provider per controlli semplici, ad esempio un pulsante personalizzato ospitato in una finestra, non devono supportare la navigazione nell'albero di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="53104-218">La navigazione verso e dall'elemento viene gestita dal provider predefinito per la finestra host, specificata nell'implementazione di [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span><span class="sxs-lookup"><span data-stu-id="53104-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="53104-219">Quando si implementa un provider per un controllo personalizzato complesso, tuttavia, è necessario supportare la navigazione tra il nodo radice del frammento e i relativi discendenti, nonché tra nodi di pari livello.</span><span class="sxs-lookup"><span data-stu-id="53104-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="53104-220">Gli elementi di un frammento diversi dalla radice devono restituire **null** da [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), perché non sono ospitati direttamente in una finestra e nessun provider predefinito può supportare lo spostamento verso e da essi.</span><span class="sxs-lookup"><span data-stu-id="53104-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="53104-221">La struttura del frammento è determinata dall'implementazione di [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span><span class="sxs-lookup"><span data-stu-id="53104-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="53104-222">Per ogni possibile direzione da ogni frammento, questo metodo restituisce l'oggetto provider per l'elemento in quella direzione.</span><span class="sxs-lookup"><span data-stu-id="53104-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="53104-223">Se non è presente alcun elemento in tale direzione, il metodo restituisce **null**.</span><span class="sxs-lookup"><span data-stu-id="53104-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="53104-224">La radice del frammento supporta la navigazione solo verso gli elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="53104-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="53104-225">Ad esempio, una casella di riepilogo restituisce il primo elemento nell'elenco quando la direzione è **NavigateDirection \_ FirstChild** e restituisce l'ultimo elemento quando la direzione è **NavigateDirection \_ LastChild**.</span><span class="sxs-lookup"><span data-stu-id="53104-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="53104-226">La radice del frammento non supporta la navigazione verso un elemento padre o per gli elementi di pari livello. Questa operazione viene gestita dal provider della finestra host.</span><span class="sxs-lookup"><span data-stu-id="53104-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="53104-227">Gli elementi di un frammento non radice devono supportare la navigazione verso l'elemento padre e verso eventuali elementi di pari livello e figli.</span><span class="sxs-lookup"><span data-stu-id="53104-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="53104-228">Assegnazione di un nuovo elemento padre</span><span class="sxs-lookup"><span data-stu-id="53104-228">Assigning a New Parent</span></span>

<span data-ttu-id="53104-229">Le finestre popup sono in effetti finestre di primo livello e, per impostazione predefinita, vengono visualizzate nell'albero di automazione interfaccia utente come elementi figlio del desktop.</span><span class="sxs-lookup"><span data-stu-id="53104-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="53104-230">In molti casi, tuttavia, le finestre popup sono logicamente elementi figlio di un altro controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="53104-231">Ad esempio, l'elenco a discesa di una casella combinata è logicamente un elemento figlio della casella combinata.</span><span class="sxs-lookup"><span data-stu-id="53104-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="53104-232">Analogamente, una finestra popup di menu è logicamente un elemento figlio del menu.</span><span class="sxs-lookup"><span data-stu-id="53104-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="53104-233">Automazione interfaccia utente fornisce supporto per assegnare un nuovo elemento padre a una finestra popup in modo che sembri essere un elemento figlio del controllo associato.</span><span class="sxs-lookup"><span data-stu-id="53104-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="53104-234">Per assegnare un nuovo elemento padre a una finestra popup:</span><span class="sxs-lookup"><span data-stu-id="53104-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="53104-235">Creare un provider per la finestra popup.</span><span class="sxs-lookup"><span data-stu-id="53104-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="53104-236">A tale scopo, è necessario che la classe della finestra popup sia nota in anticipo.</span><span class="sxs-lookup"><span data-stu-id="53104-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="53104-237">Implementare tutte le proprietà e i pattern di controllo come di consueto per tale popup, come se si trattasse di un controllo in un proprio diritto.</span><span class="sxs-lookup"><span data-stu-id="53104-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="53104-238">Implementare la proprietà [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) in modo che restituisca il valore ottenuto da [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), dove il parametro è l'handle della finestra popup.</span><span class="sxs-lookup"><span data-stu-id="53104-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="53104-239">Implementare [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) per la finestra popup e il relativo elemento padre in modo che la navigazione venga gestita correttamente dall'elemento padre logico agli elementi figlio logici e tra gli elementi figlio di pari livello.</span><span class="sxs-lookup"><span data-stu-id="53104-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="53104-240">Quando automazione interfaccia utente rileva la finestra popup, riconosce che è in corso l'override della navigazione rispetto all'impostazione predefinita e ignora la finestra popup quando viene rilevata come figlio del desktop.</span><span class="sxs-lookup"><span data-stu-id="53104-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="53104-241">Al contrario, il nodo è raggiungibile solo tramite il frammento.</span><span class="sxs-lookup"><span data-stu-id="53104-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="53104-242">L'assegnazione di un nuovo elemento padre non è adatta ai casi in cui un controllo può ospitare una finestra di qualsiasi classe.</span><span class="sxs-lookup"><span data-stu-id="53104-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="53104-243">Ad esempio, un controllo Rebar può ospitare qualsiasi tipo di finestra nelle bande.</span><span class="sxs-lookup"><span data-stu-id="53104-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="53104-244">Per gestire questi casi, l'automazione interfaccia utente supporta un tipo alternativo di rilocazione della finestra, come descritto nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="53104-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="53104-245">Riposizionamento del provider</span><span class="sxs-lookup"><span data-stu-id="53104-245">Provider Repositioning</span></span>

<span data-ttu-id="53104-246">I frammenti di automazione interfaccia utente possono contenere due o più elementi ognuno contenuti in una finestra.</span><span class="sxs-lookup"><span data-stu-id="53104-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="53104-247">Poiché ogni finestra ha il proprio provider predefinito che considera la finestra come figlio di una finestra che lo contiene, l'albero di automazione interfaccia utente per impostazione predefinita mostrerà le finestre nel frammento come elementi figlio della finestra padre.</span><span class="sxs-lookup"><span data-stu-id="53104-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="53104-248">Nella maggior parte dei casi si tratta di un comportamento auspicabile, ma a volte può causare confusione perché non corrisponde alla struttura logica dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="53104-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="53104-249">Un esempio valido è un controllo Rebar.</span><span class="sxs-lookup"><span data-stu-id="53104-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="53104-250">Un controllo Rebar contiene bande, ognuna delle quali può contenere a sua volta un controllo basato su finestra, ad esempio una barra degli strumenti, una casella di modifica o una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="53104-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="53104-251">Il provider di finestra predefinito per la finestra Rebar Visualizza le finestre di controllo della banda come elementi figlio e il provider Rebar Visualizza le bande come elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="53104-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="53104-252">Poiché il provider della finestra e il provider Rebar operano in tandem e combinano i rispettivi elementi figlio, sia le bande che i controlli basati su finestra vengono visualizzati come elementi figlio del controllo Rebar.</span><span class="sxs-lookup"><span data-stu-id="53104-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="53104-253">Logicamente, tuttavia, solo le bande devono apparire come elementi figlio del controllo Rebar e ogni provider di banda deve essere abbinato al provider di finestra predefinito per il controllo che contiene.</span><span class="sxs-lookup"><span data-stu-id="53104-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="53104-254">A tale scopo, il provider di radice del frammento per il controllo Rebar espone un set di elementi figlio che rappresentano le bande.</span><span class="sxs-lookup"><span data-stu-id="53104-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="53104-255">Ogni banda ha un singolo provider che può esporre le proprietà e i pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="53104-256">Nell'implementazione di [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), il provider di bande restituisce il provider di finestra predefinito per la finestra di controllo, che ottiene chiamando [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passando l'handle di finestra (**HWND**) del controllo.</span><span class="sxs-lookup"><span data-stu-id="53104-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="53104-257">Infine, il provider di radice del frammento per il controllo Rebar implementa l'interfaccia [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) e, nell'implementazione di [**IRawElementProviderHwndOverride:: GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), restituisce il provider di bande appropriato per il controllo contenuto nella finestra specificata.</span><span class="sxs-lookup"><span data-stu-id="53104-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="53104-258">Disconnessione di provider</span><span class="sxs-lookup"><span data-stu-id="53104-258">Disconnecting Providers</span></span>

<span data-ttu-id="53104-259">Le applicazioni in genere creano controlli quando sono necessari e li eliminano successivamente.</span><span class="sxs-lookup"><span data-stu-id="53104-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="53104-260">Dopo l'eliminazione di un controllo, le risorse del provider di automazione interfaccia utente associate al controllo devono essere rilasciate chiamando [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span><span class="sxs-lookup"><span data-stu-id="53104-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="53104-261">Analogamente, un'applicazione deve usare la funzione [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) per rilasciare tutte le risorse di automazione interfaccia utente mantenute da tutti i provider nell'applicazione prima di arrestarsi.</span><span class="sxs-lookup"><span data-stu-id="53104-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="53104-262">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="53104-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="53104-263">Guida per programmatori del provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="53104-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 