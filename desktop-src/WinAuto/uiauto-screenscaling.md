---
title: Informazioni sui problemi di scalabilità dello schermo
description: Windows Vista e le versioni successive del sistema operativo consentono agli utenti di modificare l'impostazione dpi (punti per pollice) in modo che la maggior parte degli elementi dell'interfaccia utente sullo schermo risulti più grande.
ms.assetid: 27dc49e7-2466-4ea3-a6d9-5ea86d6b4c60
keywords:
- client, ridimensionamento dello schermo di automazione interfaccia utente
- client, ridimensionamento dello schermo
- client, ridimensionamento
- Automazione interfaccia utente, ridimensionamento dello schermo
- Automazione interfaccia utente, ridimensionamento
- ridimensionamento dello schermo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 05d790ee7747f258847cd23aea8bbbe8c25813fe
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399533"
---
# <a name="understanding-screen-scaling-issues"></a><span data-ttu-id="35fdb-109">Informazioni sui problemi di scalabilità dello schermo</span><span class="sxs-lookup"><span data-stu-id="35fdb-109">Understanding Screen Scaling Issues</span></span>

<span data-ttu-id="35fdb-110">Windows Vista e le versioni successive del sistema operativo consentono agli utenti di modificare l'impostazione dpi (punti per pollice) in modo che la maggior parte degli elementi dell'interfaccia utente sullo schermo risulti più grande.</span><span class="sxs-lookup"><span data-stu-id="35fdb-110">Windows Vista and later versions of the operating system enable users to change the dots per inch (dpi) setting so that most UI elements on the screen appear larger.</span></span> <span data-ttu-id="35fdb-111">Nelle versioni precedenti di Windows, la scalabilità doveva essere implementata dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="35fdb-111">In earlier versions of Windows, the scaling had to be implemented by applications.</span></span> <span data-ttu-id="35fdb-112">In Windows Vista e versioni successive, il Gestione finestre desktop (DWM) esegue il ridimensionamento predefinito per tutte le applicazioni che non gestiscono la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="35fdb-112">In Windows Vista and later, the Desktop Window Manager (DWM) performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="35fdb-113">Le applicazioni client di automazione interfaccia utente Microsoft devono tenere conto di questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="35fdb-113">Microsoft UI Automation client applications must take this feature into account.</span></span>

<span data-ttu-id="35fdb-114">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="35fdb-114">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="35fdb-115">Ridimensionamento in Windows Vista e versioni successive</span><span class="sxs-lookup"><span data-stu-id="35fdb-115">Scaling in Windows Vista and Later</span></span>](#scaling-in-windows-vista-and-later)
-   [<span data-ttu-id="35fdb-116">Ridimensionamento nei client di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="35fdb-116">Scaling in UI Automation Clients</span></span>](#scaling-in-ui-automation-clients)

## <a name="scaling-in-windows-vista-and-later"></a><span data-ttu-id="35fdb-117">Ridimensionamento in Windows Vista e versioni successive</span><span class="sxs-lookup"><span data-stu-id="35fdb-117">Scaling in Windows Vista and Later</span></span>

<span data-ttu-id="35fdb-118">L'impostazione DPI predefinita è 96, il che significa che 96 pixel occupano una larghezza o un'altezza di un pollice teorico.</span><span class="sxs-lookup"><span data-stu-id="35fdb-118">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="35fdb-119">La misura esatta di un pollice dipende dalle dimensioni e dalla risoluzione fisica del monitor.</span><span class="sxs-lookup"><span data-stu-id="35fdb-119">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="35fdb-120">Ad esempio, su un monitor con una larghezza di 12 pollici e una risoluzione orizzontale di 1280 pixel, una riga orizzontale di 96 pixel si estende per circa 9/10 di un pollice.</span><span class="sxs-lookup"><span data-stu-id="35fdb-120">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>

<span data-ttu-id="35fdb-121">La modifica dell'impostazione DPI non corrisponde alla modifica della risoluzione dello schermo.</span><span class="sxs-lookup"><span data-stu-id="35fdb-121">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="35fdb-122">Con il ridimensionamento DPI, il numero di pixel fisici sullo schermo rimane lo stesso.</span><span class="sxs-lookup"><span data-stu-id="35fdb-122">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="35fdb-123">Il ridimensionamento viene tuttavia applicato alle dimensioni e alla posizione degli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="35fdb-123">However, scaling is applied to the size and location of UI elements.</span></span> <span data-ttu-id="35fdb-124">Questo ridimensionamento può essere eseguito automaticamente da DWM per il desktop e per le applicazioni che non richiedono in modo esplicito la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="35fdb-124">This scaling can be performed automatically by the DWM for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>

<span data-ttu-id="35fdb-125">In effetti, quando l'utente imposta il fattore di scala su 120 dpi, un pollice verticale o orizzontale sullo schermo aumenta del 25%.</span><span class="sxs-lookup"><span data-stu-id="35fdb-125">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="35fdb-126">Tutte le dimensioni vengono ridimensionate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="35fdb-126">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="35fdb-127">L'offset di una finestra dell'applicazione dal bordo superiore e il bordo sinistro dello schermo aumenta del 25%.</span><span class="sxs-lookup"><span data-stu-id="35fdb-127">The offset of an application window from the top edge and left edge of the screen increases by 25 percent.</span></span> <span data-ttu-id="35fdb-128">Se il ridimensionamento dell'applicazione è abilitato e l'applicazione non è compatibile con dpi, le dimensioni della finestra aumentano nella stessa proporzione, con gli offset e le dimensioni di tutti gli elementi dell'interfaccia utente che contiene.</span><span class="sxs-lookup"><span data-stu-id="35fdb-128">If application scaling is enabled and the application is not dpi-aware, the size of the window increases in the same proportion, along with the offsets and sizes of all UI elements it contains.</span></span>

> [!Note]  
> <span data-ttu-id="35fdb-129">Per impostazione predefinita, DWM non esegue la scalabilità per le applicazioni non compatibili con DPI quando l'utente imposta il valore dpi su 120, ma esegue il ridimensionamento quando il valore dpi è impostato su un valore personalizzato pari a 144 o superiore.</span><span class="sxs-lookup"><span data-stu-id="35fdb-129">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform scaling when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="35fdb-130">È tuttavia possibile ignorare questo comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="35fdb-130">However, the user can override the default behavior.</span></span>

 

<span data-ttu-id="35fdb-131">Il ridimensionamento dello schermo crea nuove sfide per le applicazioni che dipendono dalle coordinate dello schermo.</span><span class="sxs-lookup"><span data-stu-id="35fdb-131">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="35fdb-132">Lo schermo contiene ora due sistemi di coordinate: fisico e logico.</span><span class="sxs-lookup"><span data-stu-id="35fdb-132">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="35fdb-133">Le coordinate fisiche di un punto sono l'offset effettivo in pixel dalla parte superiore sinistra del punto di origine.</span><span class="sxs-lookup"><span data-stu-id="35fdb-133">The physical coordinates of a point are the actual offset in pixels from the upper-left of the origin point.</span></span> <span data-ttu-id="35fdb-134">Le coordinate logiche sono gli offset così come si presenterebbero se i pixel fossero ridimensionati.</span><span class="sxs-lookup"><span data-stu-id="35fdb-134">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>

<span data-ttu-id="35fdb-135">Si supponga di progettare una finestra di dialogo con un pulsante in corrispondenza delle coordinate (100, 48).</span><span class="sxs-lookup"><span data-stu-id="35fdb-135">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="35fdb-136">Quando questa finestra di dialogo viene visualizzata sul valore predefinito 96 dpi, il pulsante si trova in corrispondenza delle coordinate fisiche (100, 48).</span><span class="sxs-lookup"><span data-stu-id="35fdb-136">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="35fdb-137">A 120 dpi si trova in corrispondenza delle coordinate fisiche (125, 60).</span><span class="sxs-lookup"><span data-stu-id="35fdb-137">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="35fdb-138">Tuttavia, le coordinate logiche sono le stesse in qualsiasi impostazione dpi: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="35fdb-138">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>

<span data-ttu-id="35fdb-139">Le coordinate logiche sono importanti, perché rendono coerenti il comportamento del sistema operativo e delle applicazioni, indipendentemente dall'impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="35fdb-139">Logical coordinates are important, because they make the behavior of the operating system and applications consistent, regardless of the dpi setting.</span></span> <span data-ttu-id="35fdb-140">Ad esempio, la funzione [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) restituisce in genere le coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="35fdb-140">For example, typically, the [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) function returns the logical coordinates.</span></span> <span data-ttu-id="35fdb-141">Se si sposta il cursore su un elemento in una finestra di dialogo, vengono restituite le stesse coordinate, indipendentemente dall'impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="35fdb-141">If you move the cursor over an element in a dialog box, the same coordinates are returned, regardless of the dpi setting.</span></span> <span data-ttu-id="35fdb-142">Se si disegna un controllo in (100, 100), questo viene disegnato su queste coordinate logiche e occupa la stessa posizione relativa in qualsiasi impostazione dpi.</span><span class="sxs-lookup"><span data-stu-id="35fdb-142">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>

## <a name="scaling-in-ui-automation-clients"></a><span data-ttu-id="35fdb-143">Ridimensionamento nei client di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="35fdb-143">Scaling in UI Automation Clients</span></span>

<span data-ttu-id="35fdb-144">L'API di automazione interfaccia utente non usa coordinate logiche.</span><span class="sxs-lookup"><span data-stu-id="35fdb-144">The UI Automation API does not use logical coordinates.</span></span> <span data-ttu-id="35fdb-145">I metodi e le proprietà seguenti restituiscono coordinate fisiche o accettano coordinate fisiche come parametri.</span><span class="sxs-lookup"><span data-stu-id="35fdb-145">The following methods and properties return physical coordinates or take physical coordinates as parameters.</span></span>

-   [<span data-ttu-id="35fdb-146">**IUIAutomation::ElementFromPoint**</span><span class="sxs-lookup"><span data-stu-id="35fdb-146">**IUIAutomation::ElementFromPoint**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)
-   [<span data-ttu-id="35fdb-147">**IUIAutomation::ElementFromPointBuildCache**</span><span class="sxs-lookup"><span data-stu-id="35fdb-147">**IUIAutomation::ElementFromPointBuildCache**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache)
-   [<span data-ttu-id="35fdb-148">**IUIAutomationElement:: GetClickablePoint**</span><span class="sxs-lookup"><span data-stu-id="35fdb-148">**IUIAutomationElement::GetClickablePoint**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getclickablepoint)
-   [<span data-ttu-id="35fdb-149">**IUIAutomationElement::CurrentBoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="35fdb-149">**IUIAutomationElement::CurrentBoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentboundingrectangle)
-   [<span data-ttu-id="35fdb-150">**IUIAutomationElement::CachedBoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="35fdb-150">**IUIAutomationElement::CachedBoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedboundingrectangle)
-   [<span data-ttu-id="35fdb-151">**IRawElementProviderFragment:: BoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="35fdb-151">**IRawElementProviderFragment::BoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-get_boundingrectangle)

<span data-ttu-id="35fdb-152">Per impostazione predefinita, le applicazioni di automazione interfaccia utente in esecuzione in un ambiente che non è impostato su 96 dpi non otterranno risultati corretti da questi metodi e proprietà.</span><span class="sxs-lookup"><span data-stu-id="35fdb-152">By default, UI Automation applications that are running in an environment that is not set to 96 dpi will not obtain correct results from these methods and properties.</span></span> <span data-ttu-id="35fdb-153">Ad esempio, poiché la posizione del cursore è nelle coordinate logiche, il client non può passare queste coordinate a [**IUIAutomation:: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) per ottenere l'elemento che si trova sotto il cursore.</span><span class="sxs-lookup"><span data-stu-id="35fdb-153">For example, because the cursor position is in logical coordinates, the client cannot pass these coordinates to [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) to obtain the element that is under the cursor.</span></span> <span data-ttu-id="35fdb-154">Inoltre, l'applicazione non sarà in grado di posizionare correttamente le finestre al di fuori dell'area client.</span><span class="sxs-lookup"><span data-stu-id="35fdb-154">In addition, the application will not be able to correctly place windows outside its client area.</span></span>

<span data-ttu-id="35fdb-155">La soluzione è costituita da due parti.</span><span class="sxs-lookup"><span data-stu-id="35fdb-155">The solution has two parts.</span></span>

<span data-ttu-id="35fdb-156">Per prima cosa, fare in modo che l'applicazione client sia compatibile con dpi.</span><span class="sxs-lookup"><span data-stu-id="35fdb-156">First, make the client application dpi-aware.</span></span> <span data-ttu-id="35fdb-157">A tale scopo, chiamare la funzione [**SetProcessDPIAware**](/windows/desktop/api/winuser/nf-winuser-setprocessdpiaware) all'avvio.</span><span class="sxs-lookup"><span data-stu-id="35fdb-157">To do this, call the [**SetProcessDPIAware**](/windows/desktop/api/winuser/nf-winuser-setprocessdpiaware) function at startup.</span></span> <span data-ttu-id="35fdb-158">Questa funzione rende l'intero processo compatibile con dpi, vale a dire che tutte le finestre appartenenti al processo non vengono ridimensionate.</span><span class="sxs-lookup"><span data-stu-id="35fdb-158">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span>

<span data-ttu-id="35fdb-159">In secondo luogo, per ottenere le coordinate del cursore, chiamare la funzione [**GetPhysicalCursorPos**](/windows/desktop/api/winuser/nf-winuser-getphysicalcursorpos) .</span><span class="sxs-lookup"><span data-stu-id="35fdb-159">Second, to get cursor coordinates, call the [**GetPhysicalCursorPos**](/windows/desktop/api/winuser/nf-winuser-getphysicalcursorpos) function.</span></span>

 

 