---
title: Informazioni sui pattern di controllo Text e TextRange
description: Il contenuto testuale di un controllo viene esposto usando il pattern di controllo Text, che rappresenta il contenuto di un contenitore di testo come flusso di testo.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- Automazione interfaccia utente, supporto contenuto testuale
- Automazione interfaccia utente, panoramica del modello di testo
- Automazione interfaccia utente, Cenni preliminari sui controlli testo
- Automazione interfaccia utente, pattern di controllo Text
- Automazione interfaccia utente, Framework dei servizi di testo (TSF)
- Automazione interfaccia utente, TSF
- Automazione interfaccia utente, prestazioni
- modelli di testo, informazioni
- modelli di testo, Framework dei servizi di testo (TSF)
- controlli testo, informazioni
- contenuto testuale, supporto per
- controlli testo, prestazioni
- Pattern di controllo Text
- pattern di controllo, testo
- Framework servizi di testo
- TSF (Framework dei servizi di testo)
- prestazioni
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300356"
---
# <a name="about-the-text-and-textrange-control-patterns"></a><span data-ttu-id="baa9a-120">Informazioni sui pattern di controllo Text e TextRange</span><span class="sxs-lookup"><span data-stu-id="baa9a-120">About the Text and TextRange Control Patterns</span></span>

<span data-ttu-id="baa9a-121">Il contenuto testuale di un controllo viene esposto usando il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) , che rappresenta il contenuto di un contenitore di testo come flusso di testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-121">The textual content of a control is exposed by using the [Text](uiauto-implementingtextandtextrange.md) control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="baa9a-122">Il pattern di controllo Text richiede il supporto del pattern di controllo TextRange per esporre gli attributi di formato e stile.</span><span class="sxs-lookup"><span data-stu-id="baa9a-122">The Text control pattern requires the support of the TextRange control pattern to expose format and style attributes.</span></span> <span data-ttu-id="baa9a-123">Il pattern di controllo TextRange supporta il pattern di controllo Text mediante la rappresentazione di intervalli di testo contigui o multipli, non contigui (o intervalli) in un contenitore di testo con una raccolta di endpoint di inizio e di fine.</span><span class="sxs-lookup"><span data-stu-id="baa9a-123">The TextRange control pattern supports the Text control pattern by representing contiguous or multiple, disjoint text spans (or ranges) in a text container with a collection of start and end endpoints.</span></span> <span data-ttu-id="baa9a-124">Il pattern di controllo TextRange supporta funzionalità quali la selezione, il confronto, il recupero e l'attraversamento.</span><span class="sxs-lookup"><span data-stu-id="baa9a-124">The TextRange control pattern supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!Note]  
> <span data-ttu-id="baa9a-125">Il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) non fornisce un mezzo per inserire o modificare il testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-125">The [Text](uiauto-implementingtextandtextrange.md) control pattern does not provide a means to insert or modify text.</span></span> <span data-ttu-id="baa9a-126">Tuttavia, a seconda del controllo, questa operazione può essere eseguita usando il pattern di controllo [value](uiauto-implementingvalue.md) di automazione interfaccia utente Microsoft o l'input diretto della tastiera.</span><span class="sxs-lookup"><span data-stu-id="baa9a-126">However, depending on the control, this may be accomplished by using the Microsoft UI Automation [Value](uiauto-implementingvalue.md) control pattern or through direct keyboard input.</span></span> <span data-ttu-id="baa9a-127">È disponibile anche un modello [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) che supporta la modifica a livello di codice del testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-127">There's also a [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) pattern that supports programmatic change to text.</span></span>

 

<span data-ttu-id="baa9a-128">La funzionalità descritta in questo argomento è fondamentale per i fornitori di tecnologie per l'accesso facilitato e per gli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="baa9a-128">The functionality described in this topic is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="baa9a-129">Le tecnologie per l'accesso facilitato possono usare l'automazione dell'interfaccia utente per raccogliere informazioni complete sulla formattazione del testo per l'utente e fornire navigazione a livello di codice e selezione del testo in base a [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (carattere, parola, riga o paragrafo).</span><span class="sxs-lookup"><span data-stu-id="baa9a-129">Assistive technologies can use UI Automation to gather complete text formatting information for the user and provide programmatic navigation and selection of text by [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (character, word, line, or paragraph).</span></span>

<span data-ttu-id="baa9a-130">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="baa9a-130">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="baa9a-131">Textpattern di automazione interfaccia utente e il Framework dei servizi di testo</span><span class="sxs-lookup"><span data-stu-id="baa9a-131">UI Automation TextPattern and the Text Services Framework</span></span>](#ui-automation-textpattern-and-the-text-services-framework)
-   [<span data-ttu-id="baa9a-132">Tipi di controllo</span><span class="sxs-lookup"><span data-stu-id="baa9a-132">Control Types</span></span>](#control-types)
-   [<span data-ttu-id="baa9a-133">Interfacce del provider</span><span class="sxs-lookup"><span data-stu-id="baa9a-133">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="baa9a-134">Interfacce client</span><span class="sxs-lookup"><span data-stu-id="baa9a-134">Client Interfaces</span></span>](#client-interfaces)
-   [<span data-ttu-id="baa9a-135">Prestazioni</span><span class="sxs-lookup"><span data-stu-id="baa9a-135">Performance</span></span>](#performance)
-   [<span data-ttu-id="baa9a-136">Modello di testo e oggetti incorporati virtualizzati</span><span class="sxs-lookup"><span data-stu-id="baa9a-136">Text Pattern and Virtualized Embedded Objects</span></span>](#text-pattern-and-virtualized-embedded-objects)
-   [<span data-ttu-id="baa9a-137">Uso del tipo di controllo personalizzato con il pattern di controllo Text</span><span class="sxs-lookup"><span data-stu-id="baa9a-137">Using the Custom Control Type with the Text Control Pattern</span></span>](#using-the-custom-control-type-with-the-text-control-pattern)
-   [<span data-ttu-id="baa9a-138">Durata di un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="baa9a-138">Lifetime of a Text Range</span></span>](#lifetime-of-a-text-range)
-   [<span data-ttu-id="baa9a-139">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="baa9a-139">Related topics</span></span>](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a><span data-ttu-id="baa9a-140">Textpattern di automazione interfaccia utente e il Framework dei servizi di testo</span><span class="sxs-lookup"><span data-stu-id="baa9a-140">UI Automation TextPattern and the Text Services Framework</span></span>

<span data-ttu-id="baa9a-141">Il Framework di servizi di testo (TSF) è un Framework di sistema semplice e scalabile che Abilita servizi di linguaggio naturale e input di testo avanzato sul desktop e nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="baa9a-141">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and in applications.</span></span> <span data-ttu-id="baa9a-142">Oltre a fornire interfacce per le applicazioni che espongono l'archivio di testo, supporta anche i metadati per l'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-142">In addition to providing interfaces for applications to expose their text store, it also supports metadata for the text store.</span></span>

<span data-ttu-id="baa9a-143">TSF è stato progettato per le applicazioni che devono inserire input in scenari compatibili con il contesto.</span><span class="sxs-lookup"><span data-stu-id="baa9a-143">TSF was designed for applications that need to inject input into context-aware scenarios.</span></span> <span data-ttu-id="baa9a-144">Il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) , tuttavia, è una soluzione di sola lettura progettata per fornire accesso ottimizzato a un archivio di testo per i lettori dello schermo e i dispositivi Braille.</span><span class="sxs-lookup"><span data-stu-id="baa9a-144">The [Text](uiauto-implementingtextandtextrange.md) control pattern, however, is a read-only solution that is intended to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="baa9a-145">Le tecnologie accessibili che richiedono l'accesso in sola lettura a un archivio di testo possono usare il pattern di controllo Text, ma richiedono la funzionalità di TSF per l'input compatibile con il contesto.</span><span class="sxs-lookup"><span data-stu-id="baa9a-145">Accessible technologies that require read-only access to a text store can use the Text control pattern, but will need the functionality of TSF for context-aware input.</span></span>

<span data-ttu-id="baa9a-146">Per altre informazioni, vedere [Framework di servizi di testo](/windows/desktop/TSF/text-services-framework).</span><span class="sxs-lookup"><span data-stu-id="baa9a-146">For more information, see [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span></span>

## <a name="control-types"></a><span data-ttu-id="baa9a-147">Tipi di controllo</span><span class="sxs-lookup"><span data-stu-id="baa9a-147">Control Types</span></span>

<span data-ttu-id="baa9a-148">Il tipo di controllo di [modifica](uiauto-supporteditcontroltype.md) e [il tipo di controllo di](uiauto-supportdocumentcontroltype.md) automazione interfaccia utente devono supportare il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="baa9a-148">The UI Automation [Edit](uiauto-supporteditcontroltype.md) control type and [Document](uiauto-supportdocumentcontroltype.md) control type must support the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="baa9a-149">Per migliorare l'accessibilità, è consigliabile che i tipi di controllo [ToolTip](uiauto-supporttooltipcontroltype.md) e Text supportino anche il pattern di controllo Text, ma non è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="baa9a-149">For improved accessibility, Microsoft recommends that the [ToolTip](uiauto-supporttooltipcontroltype.md) and Text control types also support the Text control pattern, but it is not required.</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="baa9a-150">Interfacce del provider</span><span class="sxs-lookup"><span data-stu-id="baa9a-150">Provider Interfaces</span></span>

<span data-ttu-id="baa9a-151">I provider di automazione interfaccia utente supportano il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) per un controllo mediante l'implementazione delle interfacce [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="baa9a-151">UI Automation providers support the [Text](uiauto-implementingtextandtextrange.md) control pattern for a control by implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interfaces.</span></span> <span data-ttu-id="baa9a-152">Queste interfacce espongono informazioni dettagliate sugli attributi per il testo nel controllo e forniscono funzionalità di spostamento affidabili.</span><span class="sxs-lookup"><span data-stu-id="baa9a-152">These interfaces expose detailed attribute information for text in the control and provide robust navigational capabilities.</span></span>

<span data-ttu-id="baa9a-153">Non è necessario che un provider supporti tutti gli attributi di testo se il controllo non dispone del supporto per un attributo specifico.</span><span class="sxs-lookup"><span data-stu-id="baa9a-153">A provider does not need to support all text attributes if the control lacks support for any particular attribute.</span></span>

<span data-ttu-id="baa9a-154">Un provider deve supportare i metodi [**ITextProvider:: GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) e [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) se il controllo supporta la selezione di testo o il posizionamento del cursore di testo (o cursore di sistema) all'interno dell'area di testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-154">A provider must support the [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) and [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) methods if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="baa9a-155">Se il controllo non supporta questa funzionalità, non è necessario che supporti uno di questi metodi.</span><span class="sxs-lookup"><span data-stu-id="baa9a-155">If the control does not support this functionality, it does not need to support either of these methods.</span></span> <span data-ttu-id="baa9a-156">Il controllo deve tuttavia esporre il tipo di selezione di testo supportato implementando la proprietà [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="baa9a-156">However, the control must expose the type of text selection it supports by implementing the [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property.</span></span>

<span data-ttu-id="baa9a-157">Un provider deve supportare sempre le costanti [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , il **\_ carattere TextUnit** e **il \_ documento TextUnit**, nonché tutti gli altri che è in grado di supportare.</span><span class="sxs-lookup"><span data-stu-id="baa9a-157">A provider must always support the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) constants, **TextUnit\_Character** and **TextUnit\_Document**, as well as any others it is capable of supporting.</span></span>

> [!Note]  
> <span data-ttu-id="baa9a-158">Il provider può ignorare il supporto per un [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) specifico facendo riferimento alla successiva unità più grande supportata nell'ordine seguente: **TextUnit \_ character**, **TextUnit \_ Format**, **TextUnit \_ Word**, **TextUnit \_ line**, **TextUnit \_ Paragraph**, **TextUnit \_ Page** e **TextUnit \_ Document**.</span><span class="sxs-lookup"><span data-stu-id="baa9a-158">The provider may skip support for a specific [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) by deferring to the next largest unit supported in the following order: **TextUnit\_Character**, **TextUnit\_Format**, **TextUnit\_Word**, **TextUnit\_Line**, **TextUnit\_Paragraph**, **TextUnit\_Page**, and **TextUnit\_Document**.</span></span>

 

## <a name="client-interfaces"></a><span data-ttu-id="baa9a-159">Interfacce client</span><span class="sxs-lookup"><span data-stu-id="baa9a-159">Client Interfaces</span></span>

<span data-ttu-id="baa9a-160">Le applicazioni client di automazione interfaccia utente utilizzano le interfacce [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) e [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) per accedere al contenuto testuale di un controllo di testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-160">UI Automation client applications use the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) and [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interfaces to access the textual content of a text control.</span></span> <span data-ttu-id="baa9a-161">I client usano **IUIAutomationTextPattern** per selezionare intervalli di testo denominati *intervalli di testo* e per recuperare i puntatori alle interfacce **IUIAutomationTextRange** per gli intervalli.</span><span class="sxs-lookup"><span data-stu-id="baa9a-161">Clients use **IUIAutomationTextPattern** to select spans of text called *text ranges*, and to retrieve pointers to **IUIAutomationTextRange** interfaces for the ranges.</span></span> <span data-ttu-id="baa9a-162">L'interfaccia **IUIAutomationTextRange** consente ai client di modificare l'intervallo di testo e di recuperare informazioni sul testo nell'intervallo, inclusi attributi come il nome del tipo di carattere, il colore di primo piano, lo stile di sottolineatura e così via.</span><span class="sxs-lookup"><span data-stu-id="baa9a-162">The **IUIAutomationTextRange** interface enables clients to manipulate the text range, and to retrieve information about the text in the range, including attributes such as font name, foreground color, underline style, and so on.</span></span> <span data-ttu-id="baa9a-163">Per altre informazioni, vedere [identificatori di attributi di testo](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="baa9a-163">For more information, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

## <a name="performance"></a><span data-ttu-id="baa9a-164">Prestazioni</span><span class="sxs-lookup"><span data-stu-id="baa9a-164">Performance</span></span>

<span data-ttu-id="baa9a-165">Il pattern di controllo **Text** si basa sulle chiamate tra processi per la maggior parte delle funzionalità, pertanto non fornisce un meccanismo di memorizzazione nella cache per migliorare le prestazioni durante l'elaborazione del contenuto.</span><span class="sxs-lookup"><span data-stu-id="baa9a-165">The **Text** control pattern relies on cross-process calls for most of its functionality, so it does not provide a caching mechanism to improve performance when it processes content.</span></span> <span data-ttu-id="baa9a-166">Per accedere ad altri pattern di controllo nell'automazione interfaccia utente Microsoft, è possibile usare il metodo [**IUIAutomationElement:: GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .</span><span class="sxs-lookup"><span data-stu-id="baa9a-166">Other control patterns in Microsoft UI Automation can be accessed by using the [**IUIAutomationElement::GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) method.</span></span>

<span data-ttu-id="baa9a-167">Una tecnica per migliorare le prestazioni consiste nel garantire che i client di automazione interfaccia utente tentino di recuperare blocchi di testo di dimensioni moderate tramite il metodo [**IUIAutomationTextRange:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) .</span><span class="sxs-lookup"><span data-stu-id="baa9a-167">One technique for improving performance is to ensure that UI Automation clients attempt to retrieve moderately sized blocks of text by using the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method.</span></span> <span data-ttu-id="baa9a-168">Ad esempio, l'utilizzo di **gettext** per recuperare i singoli caratteri comporterà riscontri tra processi per ogni carattere, mentre se non si specifica una lunghezza massima durante la chiamata di **gettext** , viene raggiunto un hit tra processi, ma può avere una latenza elevata a seconda delle dimensioni dell'intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-168">For example, using **GetText** to retrieve single characters will incur cross-process hits for each character, whereas not specifying a maximum length when calling **GetText** will incur one cross-process hit, but can have high latency depending on the size of the text range.</span></span>

## <a name="text-pattern-and-virtualized-embedded-objects"></a><span data-ttu-id="baa9a-169">Modello di testo e oggetti incorporati virtualizzati</span><span class="sxs-lookup"><span data-stu-id="baa9a-169">Text Pattern and Virtualized Embedded Objects</span></span>

<span data-ttu-id="baa9a-170">Quando possibile, un'implementazione del provider di [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) deve supportare l'intero testo di un documento, incluso il testo all'esterno del viewport.</span><span class="sxs-lookup"><span data-stu-id="baa9a-170">Whenever possible, a provider implementation of [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) should support the entire text of a document, including any text outside of the viewport.</span></span> <span data-ttu-id="baa9a-171">Per il testo non visualizzato o gli oggetti incorporati virtualizzati, i provider devono supportare il [pattern di controllo VirtualizedItem](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span><span class="sxs-lookup"><span data-stu-id="baa9a-171">For off-screen text or embedded objects that are virtualized, providers should support the [VirtualizedItem control pattern](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span></span>

<span data-ttu-id="baa9a-172">Se un documento è virtualizzato mentre è ancora disponibile l'intero flusso di testo, la proprietà [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) recupererà un intervallo di testo che include l'intero documento.</span><span class="sxs-lookup"><span data-stu-id="baa9a-172">If a document is virtualized while the entire text stream is still available, the [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property will retrieve a text range that includes the entire document.</span></span> <span data-ttu-id="baa9a-173">La chiamata al metodo [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) , tuttavia, consente di recuperare una raccolta di oggetti virtualizzati che rappresentano tutti gli oggetti incorporati nel documento.</span><span class="sxs-lookup"><span data-stu-id="baa9a-173">However, calling the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method will retrieve a collection of virtualized objects that represent all embedded objects in the document.</span></span> <span data-ttu-id="baa9a-174">Per interagire con un oggetto incorporato virtualizzato, i client devono chiamare il metodo [**IVirtualizedItemProvider:: réalisateur**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , che rende gli elementi completamente accessibili come elementi di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="baa9a-174">To interact with a virtualized embedded object, clients must call the [**IVirtualizedItemProvider::Realize**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) method, which makes the items fully accessible as UI Automation elements.</span></span> <span data-ttu-id="baa9a-175">I client devono seguire un processo simile per lavorare con gli elementi della griglia in una tabella incorporata in cui una parte della tabella è fuori schermo e virtualizzata.</span><span class="sxs-lookup"><span data-stu-id="baa9a-175">Clients must follow a similar process to work with grid elements in an embedded table where a portion of the table is off-screen and virtualized.</span></span>

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a><span data-ttu-id="baa9a-176">Uso del tipo di controllo personalizzato con il pattern di controllo Text</span><span class="sxs-lookup"><span data-stu-id="baa9a-176">Using the Custom Control Type with the Text Control Pattern</span></span>

<span data-ttu-id="baa9a-177">Sebbene il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) supporti molti attributi di testo e oggetti incorporati, non è possibile definire in anticipo tutti i possibili elementi del documento e i tipi di presentazione.</span><span class="sxs-lookup"><span data-stu-id="baa9a-177">While the [Text](uiauto-implementingtextandtextrange.md) control pattern supports many text attributes and embedded objects, it is not possible to define in advance all possible document elements and presentation types.</span></span> <span data-ttu-id="baa9a-178">Per gli elementi del documento non supportati dagli attributi esistenti o dai tipi di controllo standard, i provider possono utilizzare le funzionalità di estendibilità fornite dal tipo di controllo **personalizzato** di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="baa9a-178">For document elements that are not supported by the existing attributes or standard control types, providers can use the extensibility features provided by the UI Automation **Custom** control type.</span></span>

<span data-ttu-id="baa9a-179">Per le applicazioni e le interfacce utente basate sulle presentazioni della pagina, la presentazione del limite e del layout di "Page" può essere espressa anche come oggetto incorporato che dispone di un tipo di controllo personalizzato (ovvero `LocalizedControlType="page"` ).</span><span class="sxs-lookup"><span data-stu-id="baa9a-179">For applications and user interfaces that are based on page presentations, the boundary and layout presentation of "page" can also be expressed as an embedded object that has a custom control type (that is, `LocalizedControlType="page"`).</span></span> <span data-ttu-id="baa9a-180">In questo modo, l'oggetto incorporato può ospitare altri elementi della pagina che non possono facilmente far parte del flusso di testo del documento, ad esempio i campi di intestazione e piè di pagina di ogni pagina, come elementi figlio dell'oggetto incorporato "Page".</span><span class="sxs-lookup"><span data-stu-id="baa9a-180">That way, the embedded object can host other page elements that cannot easily be part of the document text stream, such as the header and footer fields of each page, as children of the "page" embedded object.</span></span> <span data-ttu-id="baa9a-181">In alternativa, ogni oggetto "Page" può supportare il pattern di controllo [Text](uiauto-implementingtextandtextrange.md) in modo indipendente, che funziona bene per le applicazioni, ad esempio gli strumenti di creazione di presentazioni o gli ambienti di pubblicazione desktop basati su pagine.</span><span class="sxs-lookup"><span data-stu-id="baa9a-181">Alternatively, each "page" object can support the [Text](uiauto-implementingtextandtextrange.md) control pattern independently, which works well for applications such as authoring tools for slide show presentations, or page-based desktop publishing environments.</span></span>

## <a name="lifetime-of-a-text-range"></a><span data-ttu-id="baa9a-182">Durata di un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="baa9a-182">Lifetime of a Text Range</span></span>

<span data-ttu-id="baa9a-183">Se possibile, un provider deve garantire che tutte le modifiche apportate al testo, ad esempio eliminazioni, inserimenti e spostamenti, siano riflesse nell'intervallo di testo associato.</span><span class="sxs-lookup"><span data-stu-id="baa9a-183">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range.</span></span> <span data-ttu-id="baa9a-184">Se non è possibile aggiornare l'intervallo di testo, il provider deve generare un evento [**\_ \_ TextChangedEventId di testo UIA**](uiauto-event-ids.md) per notificare ai client che l'intervallo di testo non è più valido ed è necessario recuperarne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="baa9a-184">If updating the text range is not possible, the provider should raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event to notify clients that the text range is no longer valid and a new one must be retrieved.</span></span>

## <a name="related-topics"></a><span data-ttu-id="baa9a-185">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="baa9a-185">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="baa9a-186">**Informazioni concettuali**</span><span class="sxs-lookup"><span data-stu-id="baa9a-186">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="baa9a-187">Come automazione interfaccia utente supporta oggetti incorporati</span><span class="sxs-lookup"><span data-stu-id="baa9a-187">How UI Automation Supports Embedded Objects</span></span>](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[<span data-ttu-id="baa9a-188">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="baa9a-188">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="baa9a-189">Supporto di automazione interfaccia utente per contenuto testuale</span><span class="sxs-lookup"><span data-stu-id="baa9a-189">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="baa9a-190">Utilizzo di controlli basati su testo</span><span class="sxs-lookup"><span data-stu-id="baa9a-190">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

<span data-ttu-id="baa9a-191">**Altre risorse**</span><span class="sxs-lookup"><span data-stu-id="baa9a-191">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="baa9a-192">Text Services Framework</span><span class="sxs-lookup"><span data-stu-id="baa9a-192">Text Services Framework</span></span>](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 