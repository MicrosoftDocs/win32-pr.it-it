---
title: interoperabilità a 32 bit e a 64 bit
description: Per ottenere informazioni sull'interfaccia utente dai server Microsoft Active Accessibility e dai provider di automazione interfaccia utente Microsoft, le applicazioni per l'accessibilità devono comunicare attraverso i limiti dei processi.
ms.assetid: 8b46daed-4fd9-430c-bb4d-24be9c8015b5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6897082db00e27d77d90e5fc72d5f229834ce760
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103728439"
---
# <a name="32-bit-and-64-bit-interoperability"></a><span data-ttu-id="5114f-103">interoperabilità a 32 bit e a 64 bit</span><span class="sxs-lookup"><span data-stu-id="5114f-103">32-bit and 64-bit Interoperability</span></span>

<span data-ttu-id="5114f-104">Per ottenere informazioni sull'interfaccia utente dai server Microsoft Active Accessibility e dai provider di automazione interfaccia utente Microsoft, le applicazioni per l'accessibilità devono comunicare attraverso i limiti dei processi.</span><span class="sxs-lookup"><span data-stu-id="5114f-104">Assistive technology applications need to communicate across process boundaries to get UI information from Microsoft Active Accessibility servers and Microsoft UI Automation providers.</span></span> <span data-ttu-id="5114f-105">In questo argomento vengono descritti i principali problemi di comunicazione tra processi che è necessario tenere presenti quando si sviluppano applicazioni di accessibilità di Windows.</span><span class="sxs-lookup"><span data-stu-id="5114f-105">This topic describes the main interprocess communication issues that you need to keep in mind when developing Windows accessibility applications.</span></span>

<span data-ttu-id="5114f-106">Quando le applicazioni usano l'API di automazione di Windows, i componenti della fase di esecuzione di Microsoft Active Accessibility e di automazione interfaccia utente gestiscono automaticamente tutti i problemi e le complessità che interessano l'esecuzione delle comunicazioni interprocesso, inclusi i problemi di interoperabilità che si verificano quando un processo è 32 bit e l'altro è 64 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-106">When applications use the Windows Automation API, the Microsoft Active Accessibility and UI Automation run-time components automatically handle all of the issues and complexities involved in performing interprocess communications (IPC), including the interoperability issues involved when one process is 32-bits and the other is 64-bits.</span></span> <span data-ttu-id="5114f-107">Microsoft riconosce che in alcuni casi è possibile che un'applicazione di Assistive Technology debba utilizzare una sorta di IPC anziché l'API di automazione di Windows per comunicare con un server Microsoft Active Accessibility o un provider di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="5114f-107">Microsoft recognizes that there are occasions when an assistive technology application may need to use some form of IPC instead of the Windows Automation API to communicate with a Microsoft Active Accessibility server or UI Automation provider.</span></span> <span data-ttu-id="5114f-108">In questi casi, Microsoft consiglia di usare messaggi DCOM o Windows (quelli con valori inferiori a quelli dell' **\_ utente WM**) per comunicare con altri processi.</span><span class="sxs-lookup"><span data-stu-id="5114f-108">On these occasions, Microsoft recommends that you use DCOM or Windows messages (those with values less than that of **WM\_USER**) to communicate with other processes.</span></span> <span data-ttu-id="5114f-109">Analogamente all'API di automazione di Windows, i messaggi DCOM e Windows gestiscono automaticamente tutti i problemi IPC, inclusa l'interoperabilità da 32 bit a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-109">Like the Windows Automation API, DCOM and Windows messages automatically handle all IPC issues for you, including 32-bit to 64-bit interoperability.</span></span>

<span data-ttu-id="5114f-110">Quando l'API di automazione di Windows, DCOM e i messaggi di Windows non sono un'opzione, tenere presenti i seguenti problemi quando si implementa il metodo IPC scelto:</span><span class="sxs-lookup"><span data-stu-id="5114f-110">When the Windows Automation API, DCOM, and Windows messages are not an option, keep the following issues in mind when implementing your chosen IPC method:</span></span>

-   <span data-ttu-id="5114f-111">Memoria condivisa: quando si usa la memoria condivisa, tenere presente che una struttura in un processo a 32 bit può avere dimensioni e layout differenti rispetto alla stessa struttura in un processo a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-111">Shared Memory—When using shared memory, be aware that a structure in a 32-bit process may have a different size and layout than the same structure in a 64-bit process.</span></span> <span data-ttu-id="5114f-112">Questa operazione è particolarmente valida per le strutture che contengono puntatori o handle.</span><span class="sxs-lookup"><span data-stu-id="5114f-112">This is especially true for structures that contain pointers or handles.</span></span>
-   <span data-ttu-id="5114f-113">Troncamento del puntatore: anche se un'applicazione a 32 bit può usare il tipo di dati **LONGLONG** per archiviare un valore a 64 bit, esistono istanze in cui non esiste alcun elemento API Windows che consenta all'applicazione a 32 bit di ricevere un valore a 64 bit da un processo a 64 bit o di inviare un valore a 64 bit a un processo a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-113">Pointer Truncation—Although a 32-bit application can use the **LONGLONG** data type to store a 64-bit value, there are instances where no Windows API element exists that would enable the 32-bit application to receive a 64-bit value from a 64-bit process, or to send a 64-bit value to a 64-bit process.</span></span> <span data-ttu-id="5114f-114">Le funzioni [**GetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-getwindowlongptra) e [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) , ad esempio, troncano tutti i valori del puntatore, lasciando l'applicazione a 32 bit con un valore inutile.</span><span class="sxs-lookup"><span data-stu-id="5114f-114">For example, the [**GetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-getwindowlongptra) and [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) functions truncate all pointer values, leaving the 32-bit application with a useless value.</span></span>
-   <span data-ttu-id="5114f-115">Handle: poiché gli handle Kernel32 e User32 sono significativi solo a 32 bit nei processi a 32 bit e 64 bit, possono essere trasferiti tra processi senza problemi.</span><span class="sxs-lookup"><span data-stu-id="5114f-115">Handles—Because kernel32 and user32 handles are only 32-bit significant in both 32-bit and 64-bit processes, they can be transferred between processes without a problem.</span></span> <span data-ttu-id="5114f-116">Tuttavia, alcuni elementi definiti da Windows come handle sono solo puntatori di wrapper, ad esempio **HTREEITEM**.</span><span class="sxs-lookup"><span data-stu-id="5114f-116">However, some items that Windows defines as handles are really just wrapped pointers (for example, **HTREEITEM**).</span></span> <span data-ttu-id="5114f-117">Questi "handle" verranno troncati se vengono passati da un processo a 64 bit a un processo a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-117">These "handles" will be truncated if they are passed from a 64-bit process to a 32-bit process.</span></span>
-   <span data-ttu-id="5114f-118">[WinEvent](winevents-infrastructure.md) Funzioni hook: per registrare una funzione hook nel contesto con un processo server a 32 bit, la funzione hook deve risiedere in una DLL a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-118">[WinEvent](winevents-infrastructure.md) Hook Functions—To register an in-context hook function with a 32-bit server process, the hook function must reside in a 32-bit DLL.</span></span> <span data-ttu-id="5114f-119">Analogamente, per registrare una funzione hook nel contesto con un processo server a 64 bit, la funzione hook deve risiedere in una DLL a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="5114f-119">Similarly, to register an in-context hook function with a 64-bit server process, the hook function must reside in a 64-bit DLL.</span></span> <span data-ttu-id="5114f-120">Se un'applicazione Assistive Technology tenta di registrare una funzione hook nel contesto con un server con una profondità di bit diversa, gli eventi verranno comunque recapitati alla funzione hook, ma verranno recapitati fuori contesto.</span><span class="sxs-lookup"><span data-stu-id="5114f-120">If an assistive technology application attempts to register an in-context hook function with a server that has a different bit-depth, events will still be delivered to the hook function, but they will be delivered out-of-context.</span></span> <span data-ttu-id="5114f-121">Per altre informazioni, vedere WinEvents e [funzioni hook in-context e out-of-Context](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5114f-121">For more information, see WinEvents and [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="5114f-122">Per ulteriori informazioni sull'interoperabilità a 32 bit e a 64 bit, vedere [interoperabilità dei processi](/windows/desktop/WinProg64/process-interoperability).</span><span class="sxs-lookup"><span data-stu-id="5114f-122">For more information about 32-bit and 64-bit interoperability, see [Process Interoperability](/windows/desktop/WinProg64/process-interoperability).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5114f-123">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="5114f-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5114f-124">Panoramica dell'API di automazione di Windows</span><span class="sxs-lookup"><span data-stu-id="5114f-124">Windows Automation API Overview</span></span>](windows-automation-api-overview.md)
</dt> </dl>

 

 