---
title: Memorizzare nella cache le proprietà e i pattern di controllo di automazione interfaccia utente
description: Quando si usa l'automazione interfaccia utente Microsoft, i client spesso devono recuperare più proprietà per più elementi di automazione.
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- Caching, proprietà di automazione interfaccia utente
- memorizzazione nella cache, proprietà
- memorizzazione nella cache, pattern di controllo di automazione interfaccia utente
- memorizzazione nella cache, pattern di controllo
- Automazione interfaccia utente, proprietà di Caching
- Automazione interfaccia utente, memorizzazione nella cache delle proprietà
- client, memorizzazione nella cache delle proprietà di automazione interfaccia utente
- client, memorizzazione nella cache dei pattern di controllo di automazione interfaccia utente
- Automazione interfaccia utente, pattern di controllo di memorizzazione nella cache
- Automazione interfaccia utente, Caching pattern di controllo
- pattern di controllo, Caching
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104395611"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="c143c-114">Memorizzare nella cache le proprietà e i pattern di controllo di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="c143c-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="c143c-115">Quando si usa l'automazione interfaccia utente Microsoft, i client spesso devono recuperare più proprietà per più elementi di automazione.</span><span class="sxs-lookup"><span data-stu-id="c143c-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="c143c-116">Un client può recuperare le singole proprietà un elemento alla volta usando i metodi di recupero delle proprietà, ad esempio [**IUIAutomationElement:: currentname**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) o [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span><span class="sxs-lookup"><span data-stu-id="c143c-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="c143c-117">Tuttavia, questo metodo è lento e inefficiente perché richiede una chiamata tra processi per ogni proprietà recuperata.</span><span class="sxs-lookup"><span data-stu-id="c143c-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="c143c-118">Per migliorare le prestazioni, i client possono usare le funzionalità di memorizzazione nella cache (chiamate anche recupero bulk) dell'automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="c143c-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="c143c-119">La memorizzazione nella cache consente a un client di recuperare tutte le proprietà desiderate per tutti gli elementi desiderati con una singola chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="c143c-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="c143c-120">Il client può quindi recuperare le singole proprietà dalla cache in base alle esigenze e può ottenere periodicamente un nuovo snapshot della cache, in genere in risposta a eventi che indicano modifiche nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="c143c-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="c143c-121">L'applicazione può richiedere la memorizzazione nella cache quando recupera un elemento di automazione interfaccia utente usando un metodo, ad esempio [**IUIAutomation:: ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker:: GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)o [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span><span class="sxs-lookup"><span data-stu-id="c143c-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="c143c-122">La memorizzazione nella cache viene eseguita anche quando si specifica una richiesta di cache durante la sottoscrizione degli eventi.</span><span class="sxs-lookup"><span data-stu-id="c143c-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="c143c-123">L'elemento di automazione interfaccia utente passato al gestore eventi come origine di un evento contiene le proprietà e i pattern di controllo memorizzati nella cache specificati dalla richiesta della cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="c143c-124">Eventuali modifiche apportate alla richiesta della cache dopo la sottoscrizione dell'evento non hanno alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="c143c-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="c143c-125">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="c143c-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="c143c-126">Richieste cache</span><span class="sxs-lookup"><span data-stu-id="c143c-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="c143c-127">Impostazione della proprietà e pattern di controllo da memorizzare nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="c143c-128">Specifica dell'ambito e del filtro di una richiesta di memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="c143c-129">Livello di attendibilità dei riferimenti agli elementi</span><span class="sxs-lookup"><span data-stu-id="c143c-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="c143c-130">Recupero di elementi figlio e padre memorizzati nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="c143c-131">Recupero di un nuovo snapshot della cache</span><span class="sxs-lookup"><span data-stu-id="c143c-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="c143c-132">esempi</span><span class="sxs-lookup"><span data-stu-id="c143c-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="c143c-133">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c143c-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="c143c-134">Richieste cache</span><span class="sxs-lookup"><span data-stu-id="c143c-134">Cache Requests</span></span>

<span data-ttu-id="c143c-135">La memorizzazione nella cache comporta la determinazione delle proprietà da recuperare e degli elementi da cui recuperarle e quindi l'utilizzo di queste informazioni per creare una richiesta della cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="c143c-136">Ogni volta che il client ottiene un'interfaccia [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) per l'elemento dell'interfaccia utente, l'automazione interfaccia utente memorizza nella cache le informazioni specificate nella richiesta della cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="c143c-137">Per creare una richiesta della cache, iniziare usando il metodo [**IUIAutomation:: CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) per recuperare un puntatore a interfaccia [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) .</span><span class="sxs-lookup"><span data-stu-id="c143c-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="c143c-138">Configurare quindi la richiesta della cache usando i metodi di **IUIAutomationCacheRequest**.</span><span class="sxs-lookup"><span data-stu-id="c143c-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="c143c-139">Impostazione della proprietà e pattern di controllo da memorizzare nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="c143c-140">È possibile specificare le proprietà da memorizzare nella cache chiamando [**IUIAutomationCacheRequest:: AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span><span class="sxs-lookup"><span data-stu-id="c143c-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="c143c-141">È possibile specificare i pattern di controllo da memorizzare nella cache chiamando [**IUIAutomationCacheRequest:: AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span><span class="sxs-lookup"><span data-stu-id="c143c-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="c143c-142">Quando un pattern di controllo viene memorizzato nella cache, le proprietà non vengono automaticamente memorizzate nella cache. è necessario specificare le proprietà che si desidera memorizzare nella cache utilizzando **AddProperty**.</span><span class="sxs-lookup"><span data-stu-id="c143c-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="c143c-143">È possibile recuperare una proprietà del pattern di controllo (ad esempio, la proprietà Value del pattern di controllo [value](uiauto-implementingvalue.md) ), senza dover recuperare l'intero pattern di controllo nella cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="c143c-144">È necessario recuperare il pattern di controllo solo se è necessario usare un metodo del pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="c143c-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="c143c-145">Specifica dell'ambito e del filtro di una richiesta di memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="c143c-146">È possibile specificare gli elementi di cui si desidera memorizzare nella cache le proprietà e i pattern di controllo impostando la proprietà [**IUIAutomationCacheRequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) prima di utilizzare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="c143c-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="c143c-147">L'ambito è relativo agli elementi recuperati dal metodo a cui viene passata la richiesta della cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="c143c-148">Se ad esempio si impostano solo gli elementi [**\_ figlio TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)e quindi si recupera un elemento di automazione interfaccia utente, le proprietà e i pattern di controllo degli elementi figlio di tale elemento vengono memorizzati nella cache, ma le proprietà e i pattern di controllo dell'elemento stesso non vengono memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="c143c-149">Per assicurarsi che la memorizzazione nella cache venga eseguita per l'elemento recuperato, è necessario includere l' **\_ elemento TreeScope** nella proprietà **IUIAutomationCacheRequest:: TreeScope** .</span><span class="sxs-lookup"><span data-stu-id="c143c-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="c143c-150">Non è possibile impostare l'ambito su **TreeScope \_ padre** o **TreeScope \_ predecessori**.</span><span class="sxs-lookup"><span data-stu-id="c143c-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="c143c-151">Un elemento padre, tuttavia, può essere memorizzato nella cache quando un elemento figlio viene memorizzato nella cache. Vedere Recupero di elementi figlio e padre memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="c143c-152">L'ambito della memorizzazione nella cache è influenzato anche dalla proprietà [**IUIAutomationCacheRequest:: TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) .</span><span class="sxs-lookup"><span data-stu-id="c143c-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="c143c-153">Per impostazione predefinita, la memorizzazione nella cache viene eseguita solo per gli elementi visualizzati nella visualizzazione controlli dell'albero di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="c143c-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="c143c-154">È possibile, tuttavia, modificare questa proprietà per poter applicare la memorizzazione nella cache a tutti gli elementi o solo agli elementi presenti nella visualizzazione contenuto.</span><span class="sxs-lookup"><span data-stu-id="c143c-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="c143c-155">Livello di attendibilità dei riferimenti agli elementi</span><span class="sxs-lookup"><span data-stu-id="c143c-155">Strength of Element References</span></span>

<span data-ttu-id="c143c-156">Quando si recupera un elemento di automazione, per impostazione predefinita si ha accesso a tutte le proprietà e pattern di controllo di tale elemento, incluse le proprietà e i pattern di controllo che non sono stati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="c143c-157">Tuttavia, è possibile specificare che il riferimento all'elemento si riferisce solo ai dati memorizzati nella cache, impostando la proprietà [**IUIAutomationCacheRequest:: AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) su **AutomationElementMode \_ None**.</span><span class="sxs-lookup"><span data-stu-id="c143c-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="c143c-158">In questo caso, non è possibile accedere alle proprietà non memorizzate nella cache e ai pattern di controllo degli elementi recuperati.</span><span class="sxs-lookup"><span data-stu-id="c143c-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="c143c-159">Ciò significa che non è possibile accedere ad alcuna proprietà corrente, ad esempio [**IUIAutomationElement:: CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) o recuperare un pattern di controllo usando [**IUIAutomationElement:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span><span class="sxs-lookup"><span data-stu-id="c143c-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="c143c-160">Nei pattern di controllo memorizzati nella cache non è possibile chiamare metodi che eseguono azioni sul controllo, ad esempio [**IUIAutomationInvokePattern:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="c143c-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="c143c-161">Un esempio di applicazione che potrebbe non avere bisogno di riferimenti completi agli oggetti è un'applicazione per la lettura dello schermo, che potrebbe prerecuperare le proprietà del tipo di controllo e del nome degli elementi in una finestra senza che siano necessari gli oggetti dell'elemento di automazione.</span><span class="sxs-lookup"><span data-stu-id="c143c-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="c143c-162">Recupero di elementi figlio e padre memorizzati nella cache</span><span class="sxs-lookup"><span data-stu-id="c143c-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="c143c-163">Quando si recupera un elemento di automazione e si utilizza la memorizzazione nella cache delle richieste per gli elementi figlio di tale elemento tramite la proprietà [**IUIAutomationCacheRequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) della richiesta, è possibile ottenere gli elementi figlio chiamando [**IUIAutomationElement:: GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) sull'elemento recuperato.</span><span class="sxs-lookup"><span data-stu-id="c143c-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="c143c-164">Se [**l' \_ elemento TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) è stato incluso nell'ambito della richiesta della cache, l'elemento radice della richiesta può essere recuperato chiamando [**IUIAutomationElement:: GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) su uno qualsiasi degli elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="c143c-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="c143c-165">Non è possibile memorizzare nella cache elementi padre o predecessori dell'elemento radice della richiesta.</span><span class="sxs-lookup"><span data-stu-id="c143c-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="c143c-166">Recupero di un nuovo snapshot della cache</span><span class="sxs-lookup"><span data-stu-id="c143c-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="c143c-167">La cache è valida solo finché non vengono apportate modifiche all'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="c143c-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="c143c-168">L'applicazione è responsabile del recupero di un nuovo snapshot della cache, in genere in risposta agli eventi.</span><span class="sxs-lookup"><span data-stu-id="c143c-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="c143c-169">Se si sottoscrive un evento con una richiesta di cache, si ottiene un nuovo snapshot [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) della cache come origine dell'evento ogni volta che viene chiamato il gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="c143c-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="c143c-170">È anche possibile recuperare un nuovo snapshot delle informazioni memorizzate nella cache per un elemento chiamando [**IUIAutomationElement:: BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span><span class="sxs-lookup"><span data-stu-id="c143c-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="c143c-171">È possibile passare la [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) originale per ottenere un nuovo snapshot di tutte le informazioni precedentemente memorizzate nella cache.</span><span class="sxs-lookup"><span data-stu-id="c143c-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="c143c-172">Il recupero di un nuovo snapshot della cache non comporta la modifica delle proprietà di nessun riferimento [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) esistente.</span><span class="sxs-lookup"><span data-stu-id="c143c-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="c143c-173">Esempio</span><span class="sxs-lookup"><span data-stu-id="c143c-173">Examples</span></span>

<span data-ttu-id="c143c-174">Per esempi di codice che illustrano come usare le funzionalità di memorizzazione nella cache di automazione interfaccia utente, vedere [come usare la memorizzazione nella cache](uiauto-howto-use-caching.md).</span><span class="sxs-lookup"><span data-stu-id="c143c-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c143c-175">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c143c-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="c143c-176">**Informazioni concettuali**</span><span class="sxs-lookup"><span data-stu-id="c143c-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="c143c-177">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="c143c-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="c143c-178">Ottenere elementi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="c143c-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="c143c-179">Cenni preliminari sulle proprietà di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="c143c-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




