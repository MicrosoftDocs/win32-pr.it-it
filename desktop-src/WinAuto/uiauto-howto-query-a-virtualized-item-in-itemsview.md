---
title: Come eseguire una query su un elemento virtualizzato nella visualizzazione elementi
description: Questo argomento descrive come usare l'automazione interfaccia utente Microsoft per recuperare informazioni sull'interfaccia utente sugli elementi virtualizzati nella visualizzazione elementi di Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "104396663"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="b3cd5-103">Come eseguire una query su un elemento virtualizzato nella visualizzazione elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="b3cd5-104">Questo argomento descrive come usare l'automazione interfaccia utente Microsoft per recuperare informazioni sull'interfaccia utente sugli elementi virtualizzati nella visualizzazione elementi di Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="b3cd5-105">In questo argomento sono incluse le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="b3cd5-106">Questo argomento si applica solo a Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="b3cd5-107">Tenere presente che le funzionalità di accessibilità descritte in questo argomento possono cambiare nelle versioni future di Windows.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="b3cd5-108">Overview</span><span class="sxs-lookup"><span data-stu-id="b3cd5-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="b3cd5-109">Struttura ad albero di visualizzazione elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="b3cd5-110">Virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="b3cd5-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="b3cd5-111">Recupero di un conteggio di tutti gli elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="b3cd5-112">Recupero di un indice di elemento rispetto a tutti gli elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="b3cd5-113">Recupero di un riferimento a un elemento Vitualized</span><span class="sxs-lookup"><span data-stu-id="b3cd5-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="b3cd5-114">Scorrimento di un elemento virtualizzato sullo schermo</span><span class="sxs-lookup"><span data-stu-id="b3cd5-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="b3cd5-115">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="b3cd5-116">Panoramica</span><span class="sxs-lookup"><span data-stu-id="b3cd5-116">Overview</span></span>

<span data-ttu-id="b3cd5-117">Visualizzazione elementi è un componente dell'interfaccia utente che consente agli utenti di visualizzare e interagire con i file e altri elementi.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="b3cd5-118">In Windows 7, visualizzazione elementi sostituisce il controllo visualizzazione elenco per la presentazione degli elementi nella visualizzazione predefinita di Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="b3cd5-119">La visualizzazione elementi viene usata anche nella finestra di dialogo elemento comune, nei risultati di ricerca del menu Start e in altri elementi dell'interfaccia utente di Windows 7 che usano il controllo browser di Explorer.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="b3cd5-120">Rispetto al controllo visualizzazione elenco, visualizzazione elementi offre i vantaggi seguenti agli utenti:</span><span class="sxs-lookup"><span data-stu-id="b3cd5-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="b3cd5-121">La visualizzazione elementi può presentare elementi in modo più utile, auspicabile e pertinente, consentendo agli utenti di trovare e organizzare gli elementi in modo più semplice, rapido e piacevole.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="b3cd5-122">La visualizzazione elementi può visualizzare grandi set di elementi da origini dati con caratteristiche di prestazioni diverse, consentendo agli utenti di esplorare e cercare l'intera raccolta di elementi in più origini.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="b3cd5-123">Nell'immagine seguente viene illustrata la visualizzazione elementi in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-123">The following image shows the Items View in Windows Explorer.</span></span>

![screenshot che Mostra Esplora risorse con componente visualizzazione elementi](images/itemsview.gif)

<span data-ttu-id="b3cd5-125">Dal punto di vista di uno sviluppatore, la struttura generale e le funzionalità della visualizzazione elementi sono simili a quelle del controllo visualizzazione elenco.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="b3cd5-126">La differenza principale è che la visualizzazione elementi supporta la virtualizzazione, mentre il controllo visualizzazione elenco non lo è.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="b3cd5-127">Inoltre, la visualizzazione elementi usa due nuove interfacce di automazione interfaccia utente per garantire che il contenuto virtualizzato fornito dalla visualizzazione elementi sia accessibile.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="b3cd5-128">Queste interfacce sono descritte nelle sezioni seguenti di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="b3cd5-129">Per informazioni generali sulla virtualizzazione nell'automazione interfaccia utente, vedere [utilizzo di elementi virtualizzati](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="b3cd5-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="b3cd5-130">Struttura ad albero di visualizzazione elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-130">Items View Tree Structure</span></span>

<span data-ttu-id="b3cd5-131">Nell'albero di automazione interfaccia utente, l'elemento di automazione interfaccia utente di livello superiore della visualizzazione elementi ha il nome "ItemsView" e il tipo di controllo "list".</span><span class="sxs-lookup"><span data-stu-id="b3cd5-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="b3cd5-132">Nell'immagine precedente, l'elemento di automazione interfaccia utente di ItemsView è descritto in rosso.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="b3cd5-133">Diversi elementi di automazione interfaccia utente sono al di sotto del livello principale di ItemsView, ma in questo documento sono presenti solo due elementi di automazione interfaccia utente: elementi del gruppo ed elementi elenco.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="b3cd5-134">Gli elementi del gruppo sono gli elementi di automazione interfaccia utente che contengono tutti gli elementi dell'elenco di tale gruppo, il cui tipo di controllo è "gruppo" e i loro nomi variano a seconda del nome del gruppo.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="b3cd5-135">Nell'immagine precedente, il primo elemento del gruppo contiene sia l'intestazione "A-H (1)" che l'elemento dell'elenco "Folder" e il nome è "A-H".</span><span class="sxs-lookup"><span data-stu-id="b3cd5-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="b3cd5-136">Gli elementi dell'elenco sono gli elementi di automazione interfaccia utente che rappresentano gli elementi foglia nella vista: il tipo di controllo è "ListItem" e i relativi nomi variano a seconda del nome dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="b3cd5-137">Nell'immagine precedente, gli elementi dell'elenco sono gli elementi foglia, ad esempio "Folder", "Music" e "Picture".</span><span class="sxs-lookup"><span data-stu-id="b3cd5-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="b3cd5-138">Questi tre elementi di automazione interfaccia utente sono indicati dall'elemento ItemsView, elemento Group e ListItem nella parte restante di questo documento.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="b3cd5-139">Virtualizzazione</span><span class="sxs-lookup"><span data-stu-id="b3cd5-139">Virtualization</span></span>

<span data-ttu-id="b3cd5-140">La visualizzazione elementi usa la virtualizzazione, che significa che gli elementi al di fuori dell'area visibile della vista non vengono recuperati dal sistema e la rappresentazione dell'interfaccia utente non viene creata.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="b3cd5-141">Questi elementi sono detti *elementi virtualizzati*.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="b3cd5-142">Poiché non vengono creati, gli elementi virtualizzati non hanno elementi di automazione interfaccia utente e pertanto non vengono visualizzati nell'albero di automazione interfaccia utente quando un client di automazione interfaccia utente enumera l'albero.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="b3cd5-143">Inoltre, i pattern di controllo di automazione interfaccia utente funzionano solo su elementi visibili.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="b3cd5-144">Ad esempio, il pattern di controllo [Selection](uiauto-implementingselection.md) restituisce solo gli elementi selezionati visibili quando un client chiama il metodo [**IUIAutomationSelectionPattern:: GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="b3cd5-145">Visualizzazione elementi supporta la possibilità di recuperare le seguenti informazioni sugli elementi virtualizzati:</span><span class="sxs-lookup"><span data-stu-id="b3cd5-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="b3cd5-146">Conteggio del numero totale di elementi, inclusi gli elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="b3cd5-147">Elementi di automazione interfaccia utente per elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="b3cd5-148">Elementi di automazione interfaccia utente per gli elementi virtualizzati selezionati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="b3cd5-149">Recupero di un conteggio di tutti gli elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="b3cd5-150">Un client può usare l'elemento ItemsView per ottenere un conteggio di tutti gli elementi, nonché un conteggio degli elementi selezionati.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="b3cd5-151">L'elemento ItemsView fornisce due modi per ottenere questi conteggi.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="b3cd5-152">Il primo consiste nell'ottenere la proprietà ItemStatus dell'elemento ItemsView e la seconda ottenendo proprietà personalizzate dall'elemento ItemsView.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="b3cd5-153">La proprietà ItemStatus è una stringa che specifica un conteggio del numero totale di elementi e un conteggio degli elementi selezionati, separati da una virgola.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="b3cd5-154">Ad esempio: "3 elementi, 1 elemento selezionato".</span><span class="sxs-lookup"><span data-stu-id="b3cd5-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="b3cd5-155">Questa stringa è localizzata e può essere comunicata direttamente all'utente.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="b3cd5-156">Le proprietà personalizzate dell'elemento ItemsView includono una proprietà per il numero di elementi e un'altra per il numero di selezioni.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="b3cd5-157">e comprendono:</span><span class="sxs-lookup"><span data-stu-id="b3cd5-157">They include:</span></span>

-   <span data-ttu-id="b3cd5-158">ItemCount \_ Property \_ GUID (ABBF5C45-5CCC-47B7-BB4E-87CB87BBD162): numero di tutti gli elementi univoci nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="b3cd5-159">Se raggruppati in base a una proprietà multivalore (MVP), in modo che un singolo elemento possa essere visualizzato più volte, ogni elemento viene conteggiato una sola volta.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="b3cd5-160">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome a livello di codice: "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="b3cd5-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="b3cd5-161">\_ \_ GUID della proprietà SELECTEDITEMCOUNT (92A053DA-2969-4021-BF27-514CFC2E4A69): numero di tutti gli elementi univoci selezionati nella vista.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="b3cd5-162">Se raggruppati in base a una proprietà multivalore (MVP), in modo che un singolo elemento possa essere visualizzato più volte, ogni elemento viene conteggiato una sola volta.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="b3cd5-163">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome a livello di codice: "SelectedItemCount")</span><span class="sxs-lookup"><span data-stu-id="b3cd5-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="b3cd5-164">Queste proprietà personalizzate sono definite in Shlguid. h, incluso in Windows Software Development Kit (SDK), e queste proprietà vengono registrate tramite il metodo [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="b3cd5-165">I client di automazione interfaccia utente usano **RegisterProperty** per recuperare gli identificatori di proprietà (PROPERTYIDs) per le proprietà personalizzate.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="b3cd5-166">Recupero di un indice di elemento rispetto a tutti gli elementi</span><span class="sxs-lookup"><span data-stu-id="b3cd5-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="b3cd5-167">Un client può ottenere l'indice di un elemento ottenendo la proprietà ItemStatus di un elemento ListItem oppure ottenendo una proprietà personalizzata di un elemento ListItem.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="b3cd5-168">La proprietà ItemStatus è una stringa che contiene l'indice di un elemento rispetto al numero totale di elementi.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="b3cd5-169">Ad esempio: "elemento 1 di 3".</span><span class="sxs-lookup"><span data-stu-id="b3cd5-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="b3cd5-170">Questa stringa è localizzata e può essere comunicata direttamente all'utente.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="b3cd5-171">La proprietà personalizzata seguente ottiene l'indice dell'elemento di un elemento ListItem:</span><span class="sxs-lookup"><span data-stu-id="b3cd5-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="b3cd5-172">\_ \_ GUID della proprietà ITEMINDEX (92A053DA-2969-4021-BF27-514CFC2E4A69): indice assoluto in base 1 di un elemento.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="b3cd5-173">Se raggruppati in base a una proprietà multivalore (MVP), in modo che un singolo elemento possa essere visualizzato due volte, ogni aspetto dell'elemento ottiene un indice separato.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="b3cd5-174">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome a livello di codice: "ItemIndex")</span><span class="sxs-lookup"><span data-stu-id="b3cd5-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="b3cd5-175">Questa proprietà personalizzata è definita in Shlguid. h, inclusa nella Windows SDK, ed è registrata tramite il metodo [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="b3cd5-176">I client di automazione interfaccia utente usano **RegisterProperty** per recuperare un identificatore di proprietà (PROPERTYIDs) per la proprietà personalizzata.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="b3cd5-177">Recupero di un riferimento a un elemento Vitualized</span><span class="sxs-lookup"><span data-stu-id="b3cd5-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="b3cd5-178">Un elemento ItemsView implementa il pattern di controllo [ItemContainer](uiauto-implementingitemcontainer.md) (interfaccia [**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), che consente a un client di ottenere un elemento di automazione interfaccia utente per un elemento virtualizzato (un elemento che si trova al di fuori dell'area visibile).</span><span class="sxs-lookup"><span data-stu-id="b3cd5-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="b3cd5-179">ItemsView consente al client di trovare un elemento ListItem eseguendo una ricerca sulle proprietà Name e Selection. il tentativo di eseguire la ricerca in qualsiasi altra proprietà avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="b3cd5-180">Un elemento virtuale implementa solo il pattern di controllo [VirtualizedItem](uiauto-implementingvirtualizeditem.md) (interfaccia [**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ).</span><span class="sxs-lookup"><span data-stu-id="b3cd5-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="b3cd5-181">Poiché l'elemento rappresentato da un elemento di automazione interfaccia utente virtualizzato non esiste ancora, il tentativo di ottenere qualsiasi altro pattern di controllo o proprietà dell'elemento avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="b3cd5-182">Gli elementi ListItem e Group sono virtualizzati, ma solo gli elementi ListItem possono essere restituiti dal pattern di controllo [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="b3cd5-183">Poiché la chiamata al metodo [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) viene eseguita sul thread dell'interfaccia utente e sta bloccando, la visualizzazione non risponde fino a quando **FindItemByProperty** non restituisce il risultato e qualsiasi altra chiamata al metodo nel provider deve attendere fino al termine di **FindItemByProperty** .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="b3cd5-184">In alcuni casi, **FindItemByProperty** deve elaborare l'intero set di dati prima di restituire, operazione che può richiedere un utilizzo intensivo delle risorse.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="b3cd5-185">Se si specifica **null** come elemento iniziale, **FindItemByProperty** inizia la ricerca con il primo elemento nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="b3cd5-186">ItemsView supporta le proprietà seguenti per [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="b3cd5-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="b3cd5-187">Nome (UIA \_ NamePropertyId): Cerca il primo elemento il cui nome corrisponde completamente alla stringa specificata.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="b3cd5-188">Alla ricerca non viene applicata la distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-188">The search is not case sensitive.</span></span> <span data-ttu-id="b3cd5-189">I caratteri jolly o le corrispondenze parziali non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="b3cd5-190">Se viene specificato un nome **null** , viene restituito l'elemento successivo dopo l'elemento iniziale.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="b3cd5-191">La specifica di nomi **null** consente a un client di automazione interfaccia utente di enumerare tutti gli elementi nella visualizzazione. Tuttavia, l'enumerazione di tutti gli elementi è sconsigliata perché causa la realizzazione di tutti gli elementi della vista.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="b3cd5-192">SelectionItem \_ IsSelected ( \_ SelectionItemIsSelectedPropertyId UIA): Cerca il primo elemento la cui \_ Proprietà SelectionItem IsSelected corrisponde al valore specificato.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="b3cd5-193">Specificare **true** per trovare il primo elemento selezionato oppure **false** per trovare il primo elemento non selezionato.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="b3cd5-194">Prestare attenzione durante l'enumerazione di tutti gli elementi selezionati perché il numero di elementi selezionati può essere molto elevato, soprattutto se l'utente ha selezionato tutti gli elementi.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="b3cd5-195">Scorrimento di un elemento virtualizzato sullo schermo</span><span class="sxs-lookup"><span data-stu-id="b3cd5-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="b3cd5-196">Dopo aver ottenuto un riferimento a un elemento di automazione interfaccia utente per un elemento virtualizzato (fuori schermo), il client può scorrere l'elemento nella visualizzazione usando il metodo [**IUIAutomationVirtualizeItemPattern:: réalisateur**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) del pattern di controllo [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="b3cd5-197">Una volta realizzato, l'elemento è visibile e tutte le proprietà e i pattern di controllo normalmente associati a un elemento ListItem sono disponibili per il client.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="b3cd5-198">Solo gli elementi ListItem ottenuti dal metodo [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) espongono il pattern di controllo [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="b3cd5-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="b3cd5-199">Quando un elemento sullo schermo viene spostato fuori schermo, l'elemento diventa non valido e il client deve chiamare **FindItemByProperty** per ottenere il riferimento fuori schermo.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="b3cd5-200">È anche possibile spostare elementi all'interno e all'esterno della visualizzazione usando il pattern di controllo [Scroll](uiauto-implementingscroll.md) (oppure usando le barre di scorrimento).</span><span class="sxs-lookup"><span data-stu-id="b3cd5-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="b3cd5-201">Gli elementi e i gruppi vengono realizzati mentre scorrono nella visualizzazione e vengono virtualizzati quando scorrono fuori dalla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="b3cd5-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b3cd5-202">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b3cd5-203">Utilizzo degli elementi virtualizzati</span><span class="sxs-lookup"><span data-stu-id="b3cd5-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




