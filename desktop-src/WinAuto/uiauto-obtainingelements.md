---
title: Ottenere elementi di automazione interfaccia utente
description: Questo argomento descrive i vari modi per ottenere le interfacce IUIAutomationElement per gli elementi dell'interfaccia utente.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- client, acquisizione di elementi di automazione interfaccia utente
- client, elementi di automazione interfaccia utente
- client, elementi radice
- client, ambito di ricerca
- Automazione interfaccia utente, recupero di elementi
- Automazione interfaccia utente, elementi
- Automazione interfaccia utente, elementi radice
- Automazione interfaccia utente, condizioni
- Automazione interfaccia utente, ambito di ricerca
- recupero di elementi di automazione interfaccia utente
- elementi radice
- ambito di ricerca
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/20/2021
ms.locfileid: "106323877"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="b6d39-115">Ottenere elementi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="b6d39-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="b6d39-116">Questo argomento descrive i vari modi per ottenere le interfacce [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) per gli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b6d39-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="b6d39-117">**IUIAutomationElement** viene usato nell' [app di esempio client di contenuto del documento di automazione interfaccia utente](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span><span class="sxs-lookup"><span data-stu-id="b6d39-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="b6d39-118">Elemento radice</span><span class="sxs-lookup"><span data-stu-id="b6d39-118">Root Element</span></span>

<span data-ttu-id="b6d39-119">Sebbene gli elementi possano essere recuperati direttamente usando metodi, ad esempio [**IUIAutomation:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), alcune applicazioni client richiedono una visualizzazione della struttura gerarchica degli elementi, nota come albero di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b6d39-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="b6d39-120">L'elemento radice di questa gerarchia è il desktop.</span><span class="sxs-lookup"><span data-stu-id="b6d39-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="b6d39-121">È possibile ottenere questo elemento usando il metodo [**IUIAutomation:: getRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) o [**IUIAutomation:: GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="b6d39-122">Entrambi questi metodi recuperano un puntatore di interfaccia [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="b6d39-123">È possibile cercare elementi discendenti usando metodi, ad esempio [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) e [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="b6d39-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="b6d39-124">In generale, è consigliabile provare a ottenere solo gli elementi figlio diretti dell'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="b6d39-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="b6d39-125">Una ricerca di discendenti può scorrere centinaia o migliaia di elementi.</span><span class="sxs-lookup"><span data-stu-id="b6d39-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="b6d39-126">Per ottenere un elemento specifico a un livello inferiore, è consigliabile avviare la ricerca dalla finestra dell'applicazione o da un contenitore a un livello inferiore.</span><span class="sxs-lookup"><span data-stu-id="b6d39-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="b6d39-127">Condizioni</span><span class="sxs-lookup"><span data-stu-id="b6d39-127">Conditions</span></span>

<span data-ttu-id="b6d39-128">Per la maggior parte delle tecniche usate per recuperare gli elementi di automazione interfaccia utente, è necessario specificare una condizione.</span><span class="sxs-lookup"><span data-stu-id="b6d39-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="b6d39-129">Una condizione è un set di criteri che definisce gli elementi che si desidera recuperare.</span><span class="sxs-lookup"><span data-stu-id="b6d39-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="b6d39-130">Una condizione è rappresentata dall'interfaccia [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="b6d39-131">La condizione più semplice è la condizione vera, ovvero un oggetto predefinito che specifica che devono essere restituiti tutti gli elementi nell'ambito di ricerca.</span><span class="sxs-lookup"><span data-stu-id="b6d39-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="b6d39-132">La condizione falsa è l'inverso della condizione vera ed è meno utile, perché impedirebbe la rilevanza di qualsiasi elemento.</span><span class="sxs-lookup"><span data-stu-id="b6d39-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="b6d39-133">È possibile ottenere un'interfaccia per la condizione true usando [**IUIAutomation:: CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span><span class="sxs-lookup"><span data-stu-id="b6d39-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="b6d39-134">Altre tre condizioni predefinite, disponibili come proprietà per l'oggetto [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , possono essere usate singolarmente o in combinazione con altre condizioni: [**IUIAutomation:: ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)e [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="b6d39-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="b6d39-135">**RawViewCondition**, usato da solo, equivale alla condizione true, perché non filtra gli elementi in base alle proprietà [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) o [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="b6d39-136">Altre condizioni sono compilate da oggetti Condition, ognuno dei quali specifica un valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="b6d39-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="b6d39-137">Una condizione di proprietà, ad esempio, potrebbe specificare che l'elemento è abilitato o che supporta un determinato pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="b6d39-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="b6d39-138">Le condizioni che usano la logica booleana possono essere combinate chiamando [**IUIAutomation:: CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)e i metodi correlati.</span><span class="sxs-lookup"><span data-stu-id="b6d39-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="b6d39-139">Ambito di ricerca</span><span class="sxs-lookup"><span data-stu-id="b6d39-139">Search Scope</span></span>

<span data-ttu-id="b6d39-140">Le ricerche eseguite con [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) o [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) devono avere un ambito e una posizione iniziale.</span><span class="sxs-lookup"><span data-stu-id="b6d39-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="b6d39-141">Eventuali commenti su questi due metodi si applicano anche a [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) e [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="b6d39-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="b6d39-142">L'ambito definisce lo spazio intorno al punto di inizio in cui eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="b6d39-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="b6d39-143">Ciò può includere l'elemento stesso, i relativi elementi di pari livello, il padre, i relativi elementi figlio immediati e i relativi discendenti.</span><span class="sxs-lookup"><span data-stu-id="b6d39-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="b6d39-144">Tenere presente che i metodi **Find** non supportano la ricerca nell'albero di automazione interfaccia utente Microsoft; ovvero la ricerca di elementi predecessori non è supportata.</span><span class="sxs-lookup"><span data-stu-id="b6d39-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="b6d39-145">L'ambito di una ricerca viene definito da una combinazione bit per bit dei valori del tipo enumerato [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="b6d39-146">Ricerca di un elemento noto</span><span class="sxs-lookup"><span data-stu-id="b6d39-146">Finding a Known Element</span></span>

<span data-ttu-id="b6d39-147">Per trovare un elemento noto identificato dal nome, dall'ID di automazione o da altre proprietà o combinazioni di proprietà, è più semplice usare il metodo [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="b6d39-148">Se l'elemento cercato è una finestra dell'applicazione, il punto iniziale della ricerca può essere l'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="b6d39-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="b6d39-149">Questo modo per trovare gli elementi di automazione interfaccia utente è particolarmente utile negli scenari di test automatizzati.</span><span class="sxs-lookup"><span data-stu-id="b6d39-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="b6d39-150">Per un esempio di codice in cui viene illustrato come trovare un elemento know, vedere [ricerca di un elemento in base al nome](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="b6d39-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="b6d39-151">Ricerca di elementi in un sottoalbero</span><span class="sxs-lookup"><span data-stu-id="b6d39-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="b6d39-152">Per trovare tutti gli elementi che soddisfano criteri specifici e sono correlati a un elemento noto, è possibile chiamare [**IUIAutomationElement:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) sull'elemento noto.</span><span class="sxs-lookup"><span data-stu-id="b6d39-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="b6d39-153">Usare, ad esempio, questo metodo per recuperare elementi elenco o voci di menu da un elenco o menu o per identificare tutti i controlli in una finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="b6d39-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="b6d39-154">Per un esempio di codice che illustra come trovare elementi in un sottoalbero, vedere [ricerca di elementi correlati](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="b6d39-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="b6d39-155">Esplorazione di un sottoalbero</span><span class="sxs-lookup"><span data-stu-id="b6d39-155">Walking a Subtree</span></span>

<span data-ttu-id="b6d39-156">Se non si ha alcuna conoscenza precedente delle applicazioni con cui il client può essere usato, è possibile costruire un sottoalbero di tutti gli elementi di interesse usando [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span><span class="sxs-lookup"><span data-stu-id="b6d39-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="b6d39-157">Il client può eseguire questa operazione, ad esempio, in risposta a un evento di modifica dello stato attivo; ovvero, quando un'applicazione o un controllo riceve lo stato attivo per l'input, il client di automazione interfaccia utente esamina gli elementi figlio ed eventualmente tutti i discendenti dell'elemento con lo stato attivo.</span><span class="sxs-lookup"><span data-stu-id="b6d39-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="b6d39-158">Tenere presente che la struttura ad albero di automazione interfaccia utente richiede un utilizzo intensivo delle risorse.</span><span class="sxs-lookup"><span data-stu-id="b6d39-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="b6d39-159">Esaminare l'albero solo quando non è possibile usare i metodi [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)o [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="b6d39-160">È possibile definire il proprio camminatore di albero passando una condizione personalizzata a [**IUIAutomation:: CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker)oppure è possibile usare uno degli oggetti predefiniti seguenti che vengono definiti come proprietà del [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)di base.</span><span class="sxs-lookup"><span data-stu-id="b6d39-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="b6d39-161">Oggetto</span><span class="sxs-lookup"><span data-stu-id="b6d39-161">Object</span></span>                                                              | <span data-ttu-id="b6d39-162">Scopo</span><span class="sxs-lookup"><span data-stu-id="b6d39-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b6d39-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="b6d39-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="b6d39-164">Trova solo gli elementi la cui proprietà [**IUIAutomationElement:: CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) è **true**.</span><span class="sxs-lookup"><span data-stu-id="b6d39-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="b6d39-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="b6d39-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="b6d39-166">Trova solo gli elementi la cui proprietà [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) è **true**.</span><span class="sxs-lookup"><span data-stu-id="b6d39-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="b6d39-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="b6d39-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="b6d39-168">Trova tutti gli elementi.</span><span class="sxs-lookup"><span data-stu-id="b6d39-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="b6d39-169">Dopo aver ottenuto un [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), chiamare i metodi **IUIAutomationTreeWalker:: GetXxx** per spostarsi tra gli elementi del sottoalbero, passando l'elemento da cui iniziare a camminare.</span><span class="sxs-lookup"><span data-stu-id="b6d39-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="b6d39-170">Il metodo [**IUIAutomationTreeWalker:: Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) può essere usato per passare a un elemento nel sottoalbero da un altro elemento che non fa parte della visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="b6d39-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="b6d39-171">Si supponga, ad esempio, di creare una vista di un sottoalbero usando [**IUIAutomation:: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="b6d39-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="b6d39-172">L'applicazione riceve la notifica che una barra di scorrimento ha ricevuto lo stato attivo per l'input.</span><span class="sxs-lookup"><span data-stu-id="b6d39-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="b6d39-173">Poiché una barra di scorrimento non è un elemento con contenuto, non è presente nella visualizzazione del sottoalbero.</span><span class="sxs-lookup"><span data-stu-id="b6d39-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="b6d39-174">Tuttavia, è possibile passare il [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) che rappresenta la barra di scorrimento a **IUIAutomationTreeWalker:: Normalize** e recuperare il predecessore più vicino nella visualizzazione contenuto.</span><span class="sxs-lookup"><span data-stu-id="b6d39-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="b6d39-175">Per esempi di codice che illustrano come usare l'interfaccia [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) , vedere [come esaminare l'albero di automazione interfaccia utente](uiauto-howto-walk-uiautomation-tree.md).</span><span class="sxs-lookup"><span data-stu-id="b6d39-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="b6d39-176">Altri modi per recuperare un elemento</span><span class="sxs-lookup"><span data-stu-id="b6d39-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="b6d39-177">Oltre alle ricerche e alla navigazione, è possibile recuperare un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) nei modi seguenti.</span><span class="sxs-lookup"><span data-stu-id="b6d39-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="b6d39-178">Da un evento</span><span class="sxs-lookup"><span data-stu-id="b6d39-178">From an Event</span></span>

<span data-ttu-id="b6d39-179">Quando l'applicazione riceve un evento di automazione interfaccia utente, l'oggetto di origine passato al gestore eventi è rappresentato da un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span><span class="sxs-lookup"><span data-stu-id="b6d39-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="b6d39-180">Se ad esempio si effettua la sottoscrizione agli eventi di modifica dello stato attivo, l'origine passata a [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) è l'elemento che ha ricevuto lo stato attivo.</span><span class="sxs-lookup"><span data-stu-id="b6d39-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="b6d39-181">Per altre informazioni, vedere [sottoscrizione di eventi di automazione interfaccia utente](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="b6d39-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="b6d39-182">Da un punto</span><span class="sxs-lookup"><span data-stu-id="b6d39-182">From a Point</span></span>

<span data-ttu-id="b6d39-183">Per recuperare un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) dalle coordinate dello schermo, ad esempio una posizione del cursore, usare il metodo [**IUIAutomation:: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="b6d39-184">Da un handle di finestra</span><span class="sxs-lookup"><span data-stu-id="b6d39-184">From a Window Handle</span></span>

<span data-ttu-id="b6d39-185">Per recuperare un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) da un **HWND**, usare il metodo [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="b6d39-186">Dal controllo con lo stato attivo</span><span class="sxs-lookup"><span data-stu-id="b6d39-186">From the Focused Control</span></span>

<span data-ttu-id="b6d39-187">Per recuperare un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) che rappresenta il controllo con stato attivo, usare il metodo [**IUIAutomation:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) .</span><span class="sxs-lookup"><span data-stu-id="b6d39-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b6d39-188">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b6d39-188">Related topics</span></span>

[<span data-ttu-id="b6d39-189">Panoramica dell'albero di automazione dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="b6d39-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="b6d39-190">App di esempio client di contenuto del documento di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="b6d39-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
