---
title: Uso dell'annotazione server
description: In questo argomento vengono fornite informazioni sull'utilizzo delle annotazioni server per specificare un oggetto callback.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300033"
---
# <a name="using-server-annotation"></a><span data-ttu-id="0862f-103">Uso dell'annotazione server</span><span class="sxs-lookup"><span data-stu-id="0862f-103">Using Server Annotation</span></span>

<span data-ttu-id="0862f-104">In questo argomento vengono fornite informazioni sull'utilizzo delle annotazioni server per specificare un oggetto callback.</span><span class="sxs-lookup"><span data-stu-id="0862f-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="0862f-105">**Per eseguire l'override di una proprietà che specifica un oggetto callback**</span><span class="sxs-lookup"><span data-stu-id="0862f-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="0862f-106">Ottenere un puntatore di interfaccia [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) all'elemento accessibile da annotare.</span><span class="sxs-lookup"><span data-stu-id="0862f-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="0862f-107">Chiamare [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) sull'elemento accessible per ottenere un puntatore di interfaccia [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) .</span><span class="sxs-lookup"><span data-stu-id="0862f-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="0862f-108">Chiamare [**IAccIdentity:: GetIdentityString ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) sul puntatore a interfaccia [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) per ottenere una stringa che identifichi in modo univoco l'elemento accessibile da annotare.</span><span class="sxs-lookup"><span data-stu-id="0862f-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="0862f-109">Utilizzare [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) o [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) per creare l'oggetto [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) .</span><span class="sxs-lookup"><span data-stu-id="0862f-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="0862f-110">Creare un oggetto Component Object Model (COM) che implementi [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span><span class="sxs-lookup"><span data-stu-id="0862f-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="0862f-111">Chiamare [**IAccPropServices:: SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passando la stringa di identità, un GUID che indica la proprietà di cui eseguire l'override e un puntatore all'oggetto callback [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) .</span><span class="sxs-lookup"><span data-stu-id="0862f-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="0862f-112">Puntatori dell'interfaccia di versione e memoria libera.</span><span class="sxs-lookup"><span data-stu-id="0862f-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="0862f-113">Quando un client richiede la proprietà dell'elemento accessible, viene chiamato l'oggetto callback e il valore viene restituito al client.</span><span class="sxs-lookup"><span data-stu-id="0862f-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="0862f-114">Come quando si specifica un valore, gli sviluppatori di server possono usare in alternativa il metodo [**IAccPropServices:: ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) per ottenere una stringa di identità. in alternativa, è possibile usare il metodo [**IAccPropServices:: SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) e specificare i parametri *HWND*, *idObject* o *idChild* anziché una stringa di identità.</span><span class="sxs-lookup"><span data-stu-id="0862f-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="0862f-115">Quando si utilizza [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) o [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) su un oggetto contenitore, gli sviluppatori di server possono facoltativamente specificare che anche le informazioni di override devono essere applicate a tutti gli elementi figlio di tale contenitore.</span><span class="sxs-lookup"><span data-stu-id="0862f-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="0862f-116">I server possono cancellare in modo esplicito l'annotazione in qualsiasi momento usando [**IAccPropServices:: ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span><span class="sxs-lookup"><span data-stu-id="0862f-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="0862f-117">Questa operazione non è in genere necessaria perché il servizio di annotazione pulisce automaticamente e rilascia le informazioni di annotazione quando l'elemento accessibile annotato scompare.</span><span class="sxs-lookup"><span data-stu-id="0862f-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="0862f-118">Di seguito è riportato un elenco di proprietà che possono essere annotate mediante questa procedura.</span><span class="sxs-lookup"><span data-stu-id="0862f-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="0862f-119">Proprietà supportate quando si specifica un callback</span><span class="sxs-lookup"><span data-stu-id="0862f-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="0862f-120">Quando si specifica un callback, è possibile annotare le proprietà seguenti.</span><span class="sxs-lookup"><span data-stu-id="0862f-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="0862f-121">Attualmente queste proprietà non possono essere annotate direttamente specificando un valore.</span><span class="sxs-lookup"><span data-stu-id="0862f-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="0862f-122">Proprietà</span><span class="sxs-lookup"><span data-stu-id="0862f-122">Property</span></span>                      | <span data-ttu-id="0862f-123">Type</span><span class="sxs-lookup"><span data-stu-id="0862f-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="0862f-124">\_nome ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="0862f-125">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-126">\_Descrizione ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="0862f-127">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-128">\_ruolo ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="0862f-129">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="0862f-130">\_stato ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="0862f-131">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="0862f-132">Guida di PROPID \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="0862f-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="0862f-133">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-134">\_KEYBOARDSHORTCUT ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="0862f-135">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-136">\_DefaultAction propid ACC \_</span><span class="sxs-lookup"><span data-stu-id="0862f-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="0862f-137">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-138">\_VALUEMAP ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="0862f-139">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-140">\_ROLEMAP ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="0862f-141">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-142">\_STATEMAP ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="0862f-143">\_BSTR VT</span><span class="sxs-lookup"><span data-stu-id="0862f-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="0862f-144">\_ \_ stato attivo ACC propid</span><span class="sxs-lookup"><span data-stu-id="0862f-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="0862f-145">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-146">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-147">\_selezione ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="0862f-148">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-149">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-149">VT\_I4</span></span><br/> <span data-ttu-id="0862f-150">VT \_ sconosciuto</span><span class="sxs-lookup"><span data-stu-id="0862f-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="0862f-151">\_padre ACC \_ propid</span><span class="sxs-lookup"><span data-stu-id="0862f-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="0862f-152">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="0862f-153">PROPID \_ di \_ navigazione \_ ACC</span><span class="sxs-lookup"><span data-stu-id="0862f-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="0862f-154">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-155">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-156">PROPID \_ di \_ navigazione ACC \_ giù</span><span class="sxs-lookup"><span data-stu-id="0862f-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="0862f-157">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-158">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-159">PROPID \_ ACC \_ NAV a \_ sinistra</span><span class="sxs-lookup"><span data-stu-id="0862f-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="0862f-160">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-161">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-162">PROPID \_ ACC \_ NAV a \_ destra</span><span class="sxs-lookup"><span data-stu-id="0862f-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="0862f-163">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-164">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-165">PROPID \_ ACC \_ NAV \_ precedente</span><span class="sxs-lookup"><span data-stu-id="0862f-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="0862f-166">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-167">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-168">PROPID \_ ACC \_ NAV \_ Avanti</span><span class="sxs-lookup"><span data-stu-id="0862f-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="0862f-169">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-170">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-171">PROPID \_ ACC \_ NAV \_ FIRSTCHILD</span><span class="sxs-lookup"><span data-stu-id="0862f-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="0862f-172">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-173">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="0862f-174">PROPID \_ ACC \_ NAV \_ LastChild</span><span class="sxs-lookup"><span data-stu-id="0862f-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="0862f-175">\_invio VT</span><span class="sxs-lookup"><span data-stu-id="0862f-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="0862f-176">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="0862f-176">VT\_I4</span></span><br/>                        |



 

 

