---
title: Gestione del messaggio WM_GETOBJECT
description: Microsoft Active Accessibility e automazione interfaccia utente Microsoft inviano il \_ messaggio WM GetObject a un'applicazione server o provider per recuperare informazioni su un oggetto accessibile supportato dal server o dal provider.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "106300242"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="7e4ed-103">Gestione del \_ messaggio WM GETobject</span><span class="sxs-lookup"><span data-stu-id="7e4ed-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="7e4ed-104">Microsoft Active Accessibility e automazione interfaccia utente Microsoft inviano il messaggio [**WM \_ GetObject**](wm-getobject.md) a un'applicazione server o provider per recuperare informazioni su un oggetto accessibile supportato dal server o dal provider.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="7e4ed-105">I client non inviano mai direttamente **WM \_ GetObject** .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="7e4ed-106">Al contrario, Microsoft Active Accessibility Invia questo messaggio quando un client chiama le funzioni [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)e [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="7e4ed-107">Automazione interfaccia utente **Invia WM \_ GetObject** quando un client chiama [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)e [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement)e quando gestisce gli eventi per i quali il client ha effettuato la registrazione.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="7e4ed-108">Microsoft Active Accessibility o automazione interfaccia utente specifica il tipo di oggetto per cui è necessario ottenere informazioni passando un valore denominato *identificatore oggetto* con il messaggio [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="7e4ed-109">Quando riceve il messaggio, il server o il provider esamina l'identificatore di oggetto per determinare la modalità di risposta al messaggio.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="7e4ed-110">La risposta dipende dal fatto che l'applicazione ricevente implementi Microsoft Active Accessibility (un server), l'automazione interfaccia utente (un provider) o nessuna delle due per l'oggetto specificato.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="7e4ed-111">Se l'applicazione ricevente è un server Microsoft Active Accessibility e il messaggio [**WM \_ GetObject**](wm-getobject.md) include un identificatore di oggetto del [**\_ client ObjID**](object-identifiers.md), il server deve restituire il valore ottenuto passando l'interfaccia [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) dell'oggetto alla funzione [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="7e4ed-112">Se l'applicazione ricevente è il provider di automazione aUI e l'identificatore di oggetto è **UiaRootObjectId**, il provider deve restituire l'interfaccia [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="7e4ed-113">Il provider ottiene l'interfaccia chiamando la funzione [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="7e4ed-114">Se l'applicazione ricevente non implementa né Microsoft Active Accessibility né automazione interfaccia utente, deve passare il messaggio [**WM \_ GetObject**](wm-getobject.md) alla funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="7e4ed-115">Il passaggio del messaggio consente al Framework di accessibilità di determinare se è disponibile un proxy per l'oggetto specificato.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="7e4ed-116">Se l'identificatore di oggetto non è né [**\_ client ObjID**](object-identifiers.md) né UiaRootObjectId, l'applicazione ricevente deve passare il messaggio [**WM \_ GetObject**](wm-getobject.md) alla funzione [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="7e4ed-117">Il passaggio del messaggio consente al Framework di accessibilità di usare i provider predefiniti per gli elementi dell'interfaccia utente standard.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="7e4ed-118">Microsoft Active Accessibility e automazione interfaccia utente possono passare identificatori di oggetto personalizzati in un messaggio [**WM \_ GetObject**](wm-getobject.md) per recuperare oggetti o valori definiti dall'applicazione da un server o da un provider.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="7e4ed-119">È possibile usare l'identificatore di oggetto [**objid \_ NATIVEOM**](object-identifiers.md) o [**objid \_ QUERYCLASSNAMEIDX**](object-identifiers.md) per recuperare un'interfaccia del modello a oggetti nativo o per richiedere un oggetto proxy specifico supportato da Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="7e4ed-120">Gestendo sia gli identificatori di oggetto [**\_ client ObjID**](object-identifiers.md) che **UiaRootObjectId** , un'implementazione di Microsoft Active Accessibility server può coesistere insieme a un'implementazione del provider di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="7e4ed-121">Poiché la maggior parte dei controlli Windows standard e dei controlli comuni implementati dalla libreria di controlli comuni (ComCtl32.dll) non implementano Microsoft Active Accessibility o l'automazione dell'interfaccia utente, questi controlli in genere non gestiscono il messaggio [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="7e4ed-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="7e4ed-122">Al contrario, il Framework di automazione interfaccia utente o Active Accessibility Microsoft verifica se è disponibile un oggetto proxy per un particolare elemento dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="7e4ed-123">In caso contrario, fornisce l'oggetto proxy predefinito per l'oggetto finestra host.</span><span class="sxs-lookup"><span data-stu-id="7e4ed-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 