---
title: Pattern di controllo Text e TextRange
description: Vengono descritte le linee guida e le convenzioni per l'implementazione di ITextProvider, ITextProvider2 e ITextRangeProvider, incluse informazioni su proprietà e metodi.
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- Automazione interfaccia utente, implementazione del pattern di controllo Text
- Automazione interfaccia utente, implementazione del pattern di controllo TextRange
- Automazione interfaccia utente, pattern di controllo Text
- Automazione interfaccia utente, pattern di controllo TextRange
- Automazione interfaccia utente, ITextProvider
- Automazione interfaccia utente, ITextRangeProvider
- ITextProvider
- ITextRangeProvider
- implementazione del pattern di controllo Text di automazione interfaccia utente
- implementazione del pattern di controllo TextRange di automazione interfaccia utente
- Pattern di controllo Text
- Pattern di controllo TextRange
- pattern di controllo, ITextProvider
- pattern di controllo, ITextRangeProvider
- pattern di controllo, implementazione del testo di automazione interfaccia utente
- pattern di controllo, implementazione del TextRange di automazione interfaccia utente
- pattern di controllo, testo
- pattern di controllo, TextRange
- interfacce, ITextProvider
- interfacce, ITextRangeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104559660"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="ae827-123">Pattern di controllo Text e TextRange</span><span class="sxs-lookup"><span data-stu-id="ae827-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="ae827-124">Vengono descritte le linee guida e le convenzioni per l'implementazione di [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), incluse informazioni su proprietà e metodi.</span><span class="sxs-lookup"><span data-stu-id="ae827-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="ae827-125">Il pattern di controllo **Text** consente a applicazioni e controlli di esporre un modello a oggetti testo semplice, consentendo ai client di recuperare contenuto testuale, attributi di testo e oggetti incorporati da controlli basati su testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="ae827-126">Per supportare il pattern di controllo **Text** , i controlli implementano le interfacce [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="ae827-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="ae827-127">I tipi di controllo che devono supportare il pattern di controllo **Text** includono i tipi di controllo [Edit](uiauto-supporteditcontroltype.md) e [Document](uiauto-supportdocumentcontroltype.md) e qualsiasi altro tipo di controllo che consente all'utente di immettere testo o selezionare testo di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="ae827-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="ae827-128">Il pattern di controllo **Text** può essere usato con altri pattern di controllo di automazione interfaccia utente Microsoft per supportare diversi tipi di oggetti incorporati nel testo, tra cui tabelle, collegamenti ipertestuali e pulsanti di comando.</span><span class="sxs-lookup"><span data-stu-id="ae827-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="ae827-129">Le interfacce [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) includono diversi metodi per l'acquisizione di intervalli di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="ae827-130">Un *intervallo di testo* è un oggetto che rappresenta un intervallo di testo contiguo, o più intervalli di testo non contigui, in un contenitore di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="ae827-131">Un metodo **ITextProvider** acquisisce un intervallo di testo che rappresenta l'intero documento, mentre altri acquisiscono intervalli di testo che rappresentano una parte del documento, ad esempio il testo selezionato, il testo visibile o un oggetto incorporato nel testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="ae827-132">Un oggetto intervallo di testo è rappresentato dal pattern di controllo **TextRange** , che viene implementato tramite l'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="ae827-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="ae827-133">Il pattern di controllo **TextRange** fornisce metodi e proprietà usati per esporre informazioni sul testo nell'intervallo, spostare gli endpoint dell'intervallo, selezionare o deselezionare il testo, scorrere l'intervallo in visualizzazione e così via.</span><span class="sxs-lookup"><span data-stu-id="ae827-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="ae827-134">Per altre informazioni sui pattern di controllo **Text** e **TextRange** , vedere [supporto di automazione interfaccia utente per contenuti testuali](uiauto-ui-automation-textpattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ae827-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="ae827-135">A partire da Windows 8.1 i provider possono implementare l'interfaccia [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="ae827-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="ae827-136">Ciò consente di richiamare i menu di scelta rapida associati a un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="ae827-137">Sono supportati scenari come la correzione automatica del testo o la selezione del candidato IME (Input Method Editor).</span><span class="sxs-lookup"><span data-stu-id="ae827-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="ae827-138">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="ae827-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="ae827-139">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="ae827-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="ae827-140">Membri obbligatori per **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="ae827-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="ae827-141">Membri obbligatori per **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="ae827-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="ae827-142">Supporto di intervalli di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="ae827-143">Modifica di un intervallo di testo in base all'unità di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="ae827-144">Selezione di testo in un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="ae827-145">Acquisizione di testo da un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="ae827-146">Implementazione di ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="ae827-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="ae827-147">Interoperabilità con il cursore di sistema</span><span class="sxs-lookup"><span data-stu-id="ae827-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="ae827-148">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="ae827-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="ae827-149">Linee guida e convenzioni di implementazione</span><span class="sxs-lookup"><span data-stu-id="ae827-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="ae827-150">Quando si implementa il pattern di controllo **Text** , tenere presenti le linee guida e le convenzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ae827-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="ae827-151">Qualsiasi controllo che consente l'accesso al testo (ad esempio, l'immissione di testo o la selezione di testo di sola lettura) deve supportare il pattern di controllo **Text** .</span><span class="sxs-lookup"><span data-stu-id="ae827-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="ae827-152">Il pattern di controllo **Text** può essere usato con qualsiasi elemento dell'interfaccia utente che presenta testo, persino un'etichetta statica in un controllo Button standard.</span><span class="sxs-lookup"><span data-stu-id="ae827-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="ae827-153">Tuttavia, non è necessario per i controlli di testo statici che non possono essere selezionati o che non dispongono di un punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="ae827-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="ae827-154">Per garantire che il testo sia completamente accessibile, i controlli che implementano [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) devono supportare anche l'interfaccia [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) .</span><span class="sxs-lookup"><span data-stu-id="ae827-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="ae827-155">**IValueProvider** integra **ITextProvider** fornendo un modo programmatico per modificare il testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="ae827-156">Offre inoltre una maggiore compatibilità con le applicazioni client di Assistive Technology, incluse quelle basate su tecnologie legacy come Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="ae827-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="ae827-157">Quando vengono implementati entrambi i pattern di controllo, l'evento **TextChanged** ([**\_ \_ TextChangedEventId Text di UIA**](uiauto-event-ids.md)) e l'evento **AutomationPropertyChanged** ([**UIA \_ AutomationPropertyChangedEventId**](uiauto-event-ids.md)) sono equivalenti per la proprietà **value** ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span><span class="sxs-lookup"><span data-stu-id="ae827-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="ae827-158">Entrambi gli eventi devono essere supportati.</span><span class="sxs-lookup"><span data-stu-id="ae827-158">Both events must be supported.</span></span>
-   <span data-ttu-id="ae827-159">Il pattern di controllo **Text** supporta solo un flusso di testo e un viewport per controllo.</span><span class="sxs-lookup"><span data-stu-id="ae827-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="ae827-160">Se l'applicazione offre più viste del documento nei riquadri, ogni visualizzazione (controllo) deve supportare [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="ae827-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="ae827-161">Il metodo [**ITextProvider:: Getselectation**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) può restituire un singolo intervallo di testo che rappresenta il testo attualmente selezionato.</span><span class="sxs-lookup"><span data-stu-id="ae827-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="ae827-162">Se un controllo supporta la selezione di più intervalli di testo non contigui, il metodo **getselect** deve restituire una matrice che contiene un'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) per ogni intervallo di testo selezionato.</span><span class="sxs-lookup"><span data-stu-id="ae827-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="ae827-163">Il pattern di controllo **Text** rappresenta il punto di inserimento come un intervallo di testo degenerato (vuoto).</span><span class="sxs-lookup"><span data-stu-id="ae827-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="ae827-164">Il metodo [**ITextProvider:: Getselectation**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) deve restituire un intervallo di testo degenerato quando esiste il punto di inserimento e non è selezionato alcun testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="ae827-165">Per ulteriori informazioni, vedere [interoperabilità con il cursore di sistema](#interoperability-with-the-system-caret).</span><span class="sxs-lookup"><span data-stu-id="ae827-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="ae827-166">Il metodo [**ITextProvider:: GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) può restituire un singolo intervallo di testo se un intervallo di testo contiguo è visibile nel viewport oppure può restituire una matrice di intervalli di testo non contigui che rappresentano più righe di testo non visibili.</span><span class="sxs-lookup"><span data-stu-id="ae827-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="ae827-167">Il metodo [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) deve restituire un intervallo degenerato se l'elemento figlio non contiene testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="ae827-168">Poiché un oggetto incorporato può includere testo, il metodo **RangeFromChild** potrebbe non restituire sempre un intervallo di testo degenerato.</span><span class="sxs-lookup"><span data-stu-id="ae827-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="ae827-169">Per ulteriori informazioni, vedere [come automazione interfaccia utente espone oggetti incorporati](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ae827-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="ae827-170">Il metodo [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) esegue l'hit test nell'area del documento usando le coordinate dello schermo specificate.</span><span class="sxs-lookup"><span data-stu-id="ae827-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="ae827-171">L'intervallo di testo risultante deve essere coerente con il punto di inserimento o la selezione risultante facendo clic sulla posizione in corrispondenza delle coordinate dello schermo specificate.</span><span class="sxs-lookup"><span data-stu-id="ae827-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="ae827-172">Se, ad esempio, un'immagine si trova in corrispondenza delle coordinate dello schermo specificate, l'intervallo di testo risultante deve corrispondere all'intervallo di testo che il metodo [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) acquisisce per l'immagine.</span><span class="sxs-lookup"><span data-stu-id="ae827-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="ae827-173">Analogamente, se un'applicazione client richiede un intervallo di testo per la posizione al centro del cursore di sistema (punto di inserimento), l'intervallo di testo risultante deve essere uguale al percorso del cursore di sistema.</span><span class="sxs-lookup"><span data-stu-id="ae827-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="ae827-174">La proprietà [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) deve sempre fornire un intervallo di testo che includa tutto il testo supportato dall'implementazione di [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) corrispondente.</span><span class="sxs-lookup"><span data-stu-id="ae827-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="ae827-175">È necessario generare l'evento [**\_ \_ TextChangedEventId di testo UIA**](uiauto-event-ids.md) dopo che è stata apportata una modifica al testo, anche se la modifica non è visibile nel viewport.</span><span class="sxs-lookup"><span data-stu-id="ae827-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="ae827-176">Ad esempio, il provider deve generare l'evento anche se l'utente incolla esattamente lo stesso testo sul testo selezionato.</span><span class="sxs-lookup"><span data-stu-id="ae827-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="ae827-177">Il [**\_ \_ TextSelectionChangedEventId di testo UIA**](uiauto-event-ids.md) deve essere generato ogni volta che viene modificata la selezione del testo o ogni volta che il punto di inserimento (cursore) si sposta tra il testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="ae827-178">Quando si implementa il pattern di controllo **TextRange** , tenere presenti le linee guida e le convenzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ae827-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="ae827-179">Tutti i metodi del pattern di controllo **TextRange** devono eseguire operazioni di testo indipendentemente dallo stato di visibilità del testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="ae827-180">Per **determinare la visibilità** di un intervallo di testo, è sempre possibile eseguire una query sull'attributo di testo [**\_ IsHiddenAttributeId (UIA**](uiauto-textattribute-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="ae827-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="ae827-181">Se possibile, un provider deve garantire che tutte le modifiche apportate al testo, ad esempio le eliminazioni, gli inserimenti e gli spostamenti, vengano riflesse negli oggetti dell'intervallo di testo (istanze dell'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) ) associate e generino un evento [**\_ \_ TextChangedEventId di testo UIA**](uiauto-event-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="ae827-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="ae827-182">I client possono usare l'evento come hint per confermare le modifiche redazionali apportate al testo di un controllo.</span><span class="sxs-lookup"><span data-stu-id="ae827-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="ae827-183">Tutti gli oggetti intervallo di testo utilizzati dai metodi [**ITextRangeProvider:: compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**compareEndPoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)e [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) devono essere peer della stessa implementazione del pattern di controllo di **testo** .</span><span class="sxs-lookup"><span data-stu-id="ae827-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="ae827-184">Sebbene non sia obbligatorio, il valore *pRetVal* recuperato dal metodo [**ITextRangeProvider:: CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) può indicare la distanza, in caratteri ([**\_ carattere TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), tra i due endpoint.</span><span class="sxs-lookup"><span data-stu-id="ae827-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="ae827-185">Tuttavia, le applicazioni client non devono dipendere dall'accuratezza di *pRetVal* oltre il relativo valore positivo o negativo.</span><span class="sxs-lookup"><span data-stu-id="ae827-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="ae827-186">I metodi [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)e [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) richiedono un'attenta considerazione dell'unità di testo specificata.</span><span class="sxs-lookup"><span data-stu-id="ae827-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="ae827-187">Per ulteriori informazioni, vedere modifica di un TextRange per unità di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="ae827-188">Per i requisiti di implementazione correlati ai metodi [**ITextRangeProvider:: Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)e [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) , vedere Selezione di testo in un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="ae827-189">I metodi [**ITextRangeProvider:: FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) e [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) cercano avanti o indietro per una singola stringa di testo o attributo di testo corrispondente.</span><span class="sxs-lookup"><span data-stu-id="ae827-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="ae827-190">Devono restituire **null** se non viene trovata alcuna corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="ae827-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="ae827-191">Il metodo [**ITextRangeProvider:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) deve restituire l'indirizzo acquisito dalla funzione [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) o [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) se l'attributo associato varia nell'intervallo o se l'attributo non è supportato dal controllo testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="ae827-192">La specifica del pattern di controllo **TextRange** non consente l'aggiunta di nuovi identificatori di attributo di testo o la modifica del modo in cui vengono definiti gli attributi esistenti.</span><span class="sxs-lookup"><span data-stu-id="ae827-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="ae827-193">Se possibile, il metodo [**ITextRangeProvider:: GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) deve restituire una matrice che contiene un rettangolo di delimitazione per ogni riga di testo completamente o parzialmente visibile in un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="ae827-194">Se ciò non è possibile, il provider può restituire una matrice che contiene i rettangoli di delimitazione solo di righe completamente visibili; Tuttavia, questo limita la capacità di un'applicazione client di descrivere in modo accurato il modo in cui il testo viene visualizzato sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="ae827-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="ae827-195">Il metodo [**ITextRangeProvider:: GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) deve restituire tutti gli elementi figlio incorporati in un intervallo di testo, ma non deve restituire alcun elemento figlio degli elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="ae827-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="ae827-196">Se, ad esempio, un intervallo di testo contiene una tabella con un numero di celle figlio, il metodo **GetChildren** può restituire solo l'elemento Table e non gli elementi Cell.</span><span class="sxs-lookup"><span data-stu-id="ae827-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="ae827-197">Per motivi di prestazioni o architettura, un provider potrebbe non essere in grado di esporre tutti gli oggetti incorporati ospitati in un documento nell'albero di automazione.</span><span class="sxs-lookup"><span data-stu-id="ae827-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="ae827-198">In questo caso, il provider deve supportare almeno l'enumerazione degli oggetti figlio tramite il metodo **GetChildren** e, in alternativa, supportare il pattern di controllo [VirtualizedItem](uiauto-implementingvirtualizeditem.md) per il supporto di devirtualizzazione.</span><span class="sxs-lookup"><span data-stu-id="ae827-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="ae827-199">Il metodo [**ITextRangeProvider:: GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) restituisce in genere il provider di testo che fornisce l'intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="ae827-200">Tuttavia, se il provider di testo supporta oggetti figlio quali tabelle o collegamenti ipertestuali, l'elemento contenitore potrebbe essere un discendente del provider di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="ae827-201">L'elemento restituito da **GetEnclosingElement** deve essere l'elemento più vicino all'intervallo di testo specificato.</span><span class="sxs-lookup"><span data-stu-id="ae827-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="ae827-202">Se, ad esempio, l'intervallo di testo si trova in una cella di una tabella, **GetEnclosingElement** deve restituire la cella contenitore anziché l'elemento Table.</span><span class="sxs-lookup"><span data-stu-id="ae827-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="ae827-203">Il metodo [**ITextRangeProvider:: GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) deve restituire il testo normale nell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="ae827-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="ae827-204">Per ulteriori informazioni, vedere acquisizione di testo da un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="ae827-205">La chiamata di [**ITextRangeProvider:: ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) deve allineare il testo nel viewport del controllo di testo come specificato dal parametro *alignToTop* .</span><span class="sxs-lookup"><span data-stu-id="ae827-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="ae827-206">Sebbene non esistano requisiti in termini di allineamento orizzontale, l'intervallo di testo deve essere visibile sia orizzontalmente che verticalmente.</span><span class="sxs-lookup"><span data-stu-id="ae827-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="ae827-207">Quando si valuta il parametro *alignToTop* , un provider deve tenere conto dell'orientamento del controllo di testo e della direzione del flusso del testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="ae827-208">Se, ad esempio, *alignToTop* è **true** per un controllo di testo orientato verticalmente contenente testo che scorre da destra a sinistra, il provider deve allineare l'intervallo di testo al lato destro del viewport.</span><span class="sxs-lookup"><span data-stu-id="ae827-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="ae827-209">Quando si sposta un documento in base alla [**\_ riga TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), se l'intervallo di testo entra in una tabella incorporata, ogni riga di testo in una cella deve essere considerata come una linea.</span><span class="sxs-lookup"><span data-stu-id="ae827-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="ae827-210">Membri obbligatori per **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="ae827-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="ae827-211">Le proprietà e i metodi seguenti sono necessari per implementare l'interfaccia [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) .</span><span class="sxs-lookup"><span data-stu-id="ae827-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="ae827-212">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="ae827-212">Required members</span></span>                                                                                        | <span data-ttu-id="ae827-213">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="ae827-213">Member type</span></span> | <span data-ttu-id="ae827-214">Note</span><span class="sxs-lookup"><span data-stu-id="ae827-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="ae827-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="ae827-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="ae827-216">Proprietà</span><span class="sxs-lookup"><span data-stu-id="ae827-216">Property</span></span>    | <span data-ttu-id="ae827-217">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-217">None</span></span>  |
| [<span data-ttu-id="ae827-218">**SupportedTextSelection**</span><span class="sxs-lookup"><span data-stu-id="ae827-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="ae827-219">Proprietà</span><span class="sxs-lookup"><span data-stu-id="ae827-219">Property</span></span>    | <span data-ttu-id="ae827-220">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-220">None</span></span>  |
| [<span data-ttu-id="ae827-221">**GetSelection**</span><span class="sxs-lookup"><span data-stu-id="ae827-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="ae827-222">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-222">Method</span></span>      | <span data-ttu-id="ae827-223">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-223">None</span></span>  |
| [<span data-ttu-id="ae827-224">**GetVisibleRanges**</span><span class="sxs-lookup"><span data-stu-id="ae827-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="ae827-225">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-225">Method</span></span>      | <span data-ttu-id="ae827-226">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-226">None</span></span>  |
| [<span data-ttu-id="ae827-227">**RangeFromChild**</span><span class="sxs-lookup"><span data-stu-id="ae827-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="ae827-228">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-228">Method</span></span>      | <span data-ttu-id="ae827-229">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-229">None</span></span>  |
| [<span data-ttu-id="ae827-230">**RangeFromPoint**</span><span class="sxs-lookup"><span data-stu-id="ae827-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="ae827-231">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-231">Method</span></span>      | <span data-ttu-id="ae827-232">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-232">None</span></span>  |
| [<span data-ttu-id="ae827-233">**\_TextChangedEventId testo \_ UIA**</span><span class="sxs-lookup"><span data-stu-id="ae827-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="ae827-234">Evento</span><span class="sxs-lookup"><span data-stu-id="ae827-234">Event</span></span>       | <span data-ttu-id="ae827-235">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-235">None</span></span>  |
| [<span data-ttu-id="ae827-236">**\_TextSelectionChangedEventId testo \_ UIA**</span><span class="sxs-lookup"><span data-stu-id="ae827-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="ae827-237">Evento</span><span class="sxs-lookup"><span data-stu-id="ae827-237">Event</span></span>       | <span data-ttu-id="ae827-238">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-238">None</span></span>  |



 

<span data-ttu-id="ae827-239">Per l'implementazione dell'interfaccia [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) sono necessari i metodi e le proprietà aggiuntive seguenti.</span><span class="sxs-lookup"><span data-stu-id="ae827-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="ae827-240">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="ae827-240">Required members</span></span>                                                         | <span data-ttu-id="ae827-241">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="ae827-241">Member type</span></span> | <span data-ttu-id="ae827-242">Note</span><span class="sxs-lookup"><span data-stu-id="ae827-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="ae827-243">**GetCaretRange**</span><span class="sxs-lookup"><span data-stu-id="ae827-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="ae827-244">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-244">Method</span></span>      | <span data-ttu-id="ae827-245">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-245">None</span></span>  |
| [<span data-ttu-id="ae827-246">**RangeFromAnnotation**</span><span class="sxs-lookup"><span data-stu-id="ae827-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="ae827-247">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-247">Method</span></span>      | <span data-ttu-id="ae827-248">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="ae827-249">Membri obbligatori per **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="ae827-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="ae827-250">Le proprietà e i metodi seguenti sono necessari per implementare l'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="ae827-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="ae827-251">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="ae827-251">Required members</span></span>                                                                 | <span data-ttu-id="ae827-252">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="ae827-252">Member type</span></span> | <span data-ttu-id="ae827-253">Note</span><span class="sxs-lookup"><span data-stu-id="ae827-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="ae827-254">**AddToSelection**</span><span class="sxs-lookup"><span data-stu-id="ae827-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="ae827-255">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-255">Method</span></span>      | <span data-ttu-id="ae827-256">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-256">None</span></span>  |
| [<span data-ttu-id="ae827-257">**Clone**</span><span class="sxs-lookup"><span data-stu-id="ae827-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="ae827-258">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-258">Method</span></span>      | <span data-ttu-id="ae827-259">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-259">None</span></span>  |
| [<span data-ttu-id="ae827-260">**Confronto**</span><span class="sxs-lookup"><span data-stu-id="ae827-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="ae827-261">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-261">Method</span></span>      | <span data-ttu-id="ae827-262">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-262">None</span></span>  |
| [<span data-ttu-id="ae827-263">**CompareEndpoints**</span><span class="sxs-lookup"><span data-stu-id="ae827-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="ae827-264">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-264">Method</span></span>      | <span data-ttu-id="ae827-265">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-265">None</span></span>  |
| [<span data-ttu-id="ae827-266">**ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="ae827-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="ae827-267">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-267">Method</span></span>      | <span data-ttu-id="ae827-268">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-268">None</span></span>  |
| [<span data-ttu-id="ae827-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="ae827-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="ae827-270">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-270">Method</span></span>      | <span data-ttu-id="ae827-271">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-271">None</span></span>  |
| [<span data-ttu-id="ae827-272">**FindText**</span><span class="sxs-lookup"><span data-stu-id="ae827-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="ae827-273">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-273">Method</span></span>      | <span data-ttu-id="ae827-274">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-274">None</span></span>  |
| [<span data-ttu-id="ae827-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="ae827-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="ae827-276">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-276">Method</span></span>      | <span data-ttu-id="ae827-277">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-277">None</span></span>  |
| [<span data-ttu-id="ae827-278">**GetBoundingRectangles**</span><span class="sxs-lookup"><span data-stu-id="ae827-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="ae827-279">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-279">Method</span></span>      | <span data-ttu-id="ae827-280">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-280">None</span></span>  |
| [<span data-ttu-id="ae827-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="ae827-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="ae827-282">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-282">Method</span></span>      | <span data-ttu-id="ae827-283">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-283">None</span></span>  |
| [<span data-ttu-id="ae827-284">**GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="ae827-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="ae827-285">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-285">Method</span></span>      | <span data-ttu-id="ae827-286">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-286">None</span></span>  |
| [<span data-ttu-id="ae827-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="ae827-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="ae827-288">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-288">Method</span></span>      | <span data-ttu-id="ae827-289">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-289">None</span></span>  |
| [<span data-ttu-id="ae827-290">**Spostare**</span><span class="sxs-lookup"><span data-stu-id="ae827-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="ae827-291">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-291">Method</span></span>      | <span data-ttu-id="ae827-292">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-292">None</span></span>  |
| [<span data-ttu-id="ae827-293">**MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="ae827-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="ae827-294">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-294">Method</span></span>      | <span data-ttu-id="ae827-295">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-295">None</span></span>  |
| [<span data-ttu-id="ae827-296">**MoveEndpointByRange**</span><span class="sxs-lookup"><span data-stu-id="ae827-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="ae827-297">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-297">Method</span></span>      | <span data-ttu-id="ae827-298">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-298">None</span></span>  |
| [<span data-ttu-id="ae827-299">**Selezionare**</span><span class="sxs-lookup"><span data-stu-id="ae827-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="ae827-300">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-300">Method</span></span>      | <span data-ttu-id="ae827-301">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-301">None</span></span>  |
| [<span data-ttu-id="ae827-302">**ScrollIntoView**</span><span class="sxs-lookup"><span data-stu-id="ae827-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="ae827-303">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-303">Method</span></span>      | <span data-ttu-id="ae827-304">nessuno</span><span class="sxs-lookup"><span data-stu-id="ae827-304">None</span></span>  |



 

<span data-ttu-id="ae827-305">Per l'implementazione dell'interfaccia [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) sono necessari i metodi e le proprietà aggiuntive seguenti.</span><span class="sxs-lookup"><span data-stu-id="ae827-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="ae827-306">Membri obbligatori</span><span class="sxs-lookup"><span data-stu-id="ae827-306">Required members</span></span>                                                      | <span data-ttu-id="ae827-307">Tipo di membro</span><span class="sxs-lookup"><span data-stu-id="ae827-307">Member type</span></span> | <span data-ttu-id="ae827-308">Note</span><span class="sxs-lookup"><span data-stu-id="ae827-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="ae827-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="ae827-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="ae827-310">Metodo</span><span class="sxs-lookup"><span data-stu-id="ae827-310">Method</span></span>      | <span data-ttu-id="ae827-311">Vedere la sezione "implementazione di ShowContextMenu"</span><span class="sxs-lookup"><span data-stu-id="ae827-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="ae827-312">Al pattern di controllo **TextRange** non sono associati eventi.</span><span class="sxs-lookup"><span data-stu-id="ae827-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="ae827-313">Supporto di intervalli di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-313">Supporting Text Ranges</span></span>

<span data-ttu-id="ae827-314">Questa sezione descrive in che modo un provider deve implementare diversi metodi delle interfacce [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) e [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) per supportare il pattern di controllo **TextRange** .</span><span class="sxs-lookup"><span data-stu-id="ae827-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="ae827-315">Modifica di un intervallo di testo in base all'unità di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="ae827-316">L'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) fornisce diversi metodi per la manipolazione e l'esplorazione degli intervalli di testo in un controllo basato su testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="ae827-317">I metodi [**ITextRangeProvider:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)e [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) spostano un intervallo di testo o uno dei relativi endpoint in base all'unità di testo specificata, ad esempio il carattere, la parola, il paragrafo e così via.</span><span class="sxs-lookup"><span data-stu-id="ae827-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="ae827-318">Per altre informazioni, vedere [unità di testo di automazione interfaccia utente](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="ae827-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="ae827-319">Nonostante il nome, il metodo [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) non espande necessariamente un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="ae827-320">Ma "Normalizza" un intervallo di testo spostando gli endpoint in modo che l'intervallo includa l'unità di testo specificata.</span><span class="sxs-lookup"><span data-stu-id="ae827-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="ae827-321">L'intervallo viene espanso se è più piccolo dell'unità specificata o abbreviato se è più lungo dell'unità specificata.</span><span class="sxs-lookup"><span data-stu-id="ae827-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="ae827-322">È fondamentale che il metodo **ExpandToEnclosingUnit** normalizza sempre gli intervalli di testo in modo coerente. in caso contrario, altri aspetti della manipolazione dell'intervallo di testo in base all'unità di testo sarebbero imprevedibili.</span><span class="sxs-lookup"><span data-stu-id="ae827-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="ae827-323">Il diagramma seguente illustra il modo in cui **ExpandToEnclosingUnit** normalizza un intervallo di testo spostando gli endpoint dell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="ae827-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![diagramma che mostra le posizioni degli endpoint dell'intervallo di testo prima e dopo una chiamata a ExpandToEnclosingUnit](images/expandtoenclosingunit.jpg)

<span data-ttu-id="ae827-325">Se l'intervallo di testo inizia all'inizio di un'unità di testo e termina all'inizio di o prima del limite dell'unità di testo successiva, l'endpoint finale viene spostato al limite dell'unità di testo successiva (vedere 1 e 2 nel diagramma precedente).</span><span class="sxs-lookup"><span data-stu-id="ae827-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="ae827-326">Se l'intervallo di testo inizia all'inizio di un'unità di testo e termina in corrispondenza di, o dopo, il limite dell'unità successiva, l'endpoint finale rimane o viene spostato indietro al limite dell'unità successiva dopo l'endpoint iniziale (vedere 3 e 4 nell'illustrazione precedente).</span><span class="sxs-lookup"><span data-stu-id="ae827-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="ae827-327">Se è presente più di un limite di unità di testo tra gli endpoint iniziale e finale, l'endpoint finale viene spostato indietro al limite dell'unità successiva dopo l'endpoint iniziale, ottenendo un intervallo di testo di lunghezza pari a una unità di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="ae827-328">Se l'intervallo di testo inizia a metà dell'unità di testo, l'endpoint iniziale viene spostato all'inizio dell'unità di testo e l'endpoint finale viene spostato avanti o indietro, in base alle esigenze, al limite dell'unità successiva dopo l'endpoint iniziale (vedere da 5 a 8 nel diagramma precedente).</span><span class="sxs-lookup"><span data-stu-id="ae827-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="ae827-329">Quando viene chiamato il metodo [**ITextRangeProvider:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) , il provider normalizza l'intervallo di testo in base all'unità di testo specificata, usando la stessa logica di normalizzazione del metodo [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) .</span><span class="sxs-lookup"><span data-stu-id="ae827-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="ae827-330">Il provider sposta quindi l'intervallo avanti o indietro in base al numero di unità di testo specificato.</span><span class="sxs-lookup"><span data-stu-id="ae827-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="ae827-331">Quando si muove l'intervallo, il provider deve ignorare i limiti degli oggetti incorporati nel testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="ae827-332">(Tuttavia, il limite dell'unità può essere influenzato dall'esistenza di un oggetto incorporato).</span><span class="sxs-lookup"><span data-stu-id="ae827-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="ae827-333">Il diagramma seguente illustra il modo in cui il metodo **Move** sposta un intervallo di testo, unità per unità, tra oggetti incorporati e limiti di unità di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![diagramma che illustra come il metodo Move sposta gli endpoint di intervallo tra gli oggetti e i limiti di unità di testo](images/move.jpg)

<span data-ttu-id="ae827-335">Il metodo [**ITextRangeProvider:: MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) sposta uno degli endpoint avanti o indietro in base all'unità di testo specificata, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="ae827-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![diagramma che illustra il modo in cui MoveEndpointByUnit sposta l'endpoint di un intervallo](images/moveendpointbyunit.gif)

<span data-ttu-id="ae827-337">Il metodo [**ITextRangeProvider:: MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) consente a un'applicazione client di impostare un endpoint di un intervallo di testo nella stessa posizione dell'endpoint specificato di un secondo intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="ae827-338">Selezione di testo in un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="ae827-339">L'interfaccia [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) include diversi metodi per controllare la selezione del testo in un controllo basato su testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="ae827-340">Il metodo [**ITextRangeProvider:: Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) deve selezionare il testo che corrisponde a un intervallo di testo e rimuovere la selezione precedente, se presente, dal controllo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="ae827-341">Se **Select** viene chiamato su un intervallo di testo degenerato, il provider deve spostare il punto di inserimento nella posizione dell'intervallo di testo senza selezionare alcun testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="ae827-342">Se un controllo supporta la selezione di più intervalli di testo non contigui, i metodi [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) e [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) aggiungono intervalli di testo a e li rimuovino dalla raccolta di intervalli di testo selezionati.</span><span class="sxs-lookup"><span data-stu-id="ae827-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="ae827-343">Se il controllo supporta solo un intervallo di testo selezionato alla volta, ma l'operazione di selezione comporterebbe la selezione di più intervalli di testo non contigui, il provider deve restituire un errore **E \_ INVALIDOPERATION** oppure deve estendere o troncare la selezione corrente.</span><span class="sxs-lookup"><span data-stu-id="ae827-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="ae827-344">La proprietà [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) deve indicare se un controllo supporta la selezione di uno o più intervalli di testo o nessuno.</span><span class="sxs-lookup"><span data-stu-id="ae827-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="ae827-345">Se un controllo basato su testo supporta gli inserimenti di testo, la chiamata di [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) o [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) in un intervallo di testo degenerato nel controllo deve spostare il punto di inserimento, ma non deve selezionare alcun testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="ae827-346">Acquisizione di testo da un intervallo di testo</span><span class="sxs-lookup"><span data-stu-id="ae827-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="ae827-347">Il metodo [**ITextRangeProvider:: GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) deve restituire il testo normale di un intervallo di testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="ae827-348">Il testo normale deve includere tutti i caratteri di controllo trovati nel testo di origine, ad esempio i ritorni a capo e il contrassegno Unicode da sinistra a destra (LRM).</span><span class="sxs-lookup"><span data-stu-id="ae827-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="ae827-349">Il testo normale non deve includere tag di markup, ad esempio HTML, che potrebbero essere presenti nel testo di origine.</span><span class="sxs-lookup"><span data-stu-id="ae827-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="ae827-350">Inoltre, tutti i codici di escape nel testo di origine devono essere convertiti negli equivalenti di testo normale.</span><span class="sxs-lookup"><span data-stu-id="ae827-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="ae827-351">Ad esempio, " &nbsp; " deve essere convertito in un carattere di spazio semplice.</span><span class="sxs-lookup"><span data-stu-id="ae827-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="ae827-352">Se un oggetto incorporato si estende su un intervallo di testo, il testo normale deve includere il testo interno dell'oggetto, ma non il testo alternativo (la proprietà Name dell'oggetto incorporato) perché potrebbe non essere coerente con il testo interno descrittivo.</span><span class="sxs-lookup"><span data-stu-id="ae827-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="ae827-353">Per ulteriori informazioni, vedere [come automazione interfaccia utente espone oggetti incorporati](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ae827-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="ae827-354">Implementazione di ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="ae827-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="ae827-355">[**ITextRangeProvider2:: ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) deve sempre visualizzare il menu di scelta rapida in corrispondenza del punto finale iniziale dell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="ae827-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="ae827-356">Questa operazione dovrebbe essere equivalente a quanto accade se l'utente ha premuto il tasto del menu di scelta rapida o MAIUSC + F10 con il punto di inserimento all'inizio dell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="ae827-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="ae827-357">Se la visualizzazione del menu di scelta rapida determina il passaggio del punto di inserimento in una determinata posizione, è consigliabile eseguire questa operazione per richiamare [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) a livello di codice per il supporto di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="ae827-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="ae827-358">Interoperabilità con il cursore di sistema</span><span class="sxs-lookup"><span data-stu-id="ae827-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="ae827-359">Il corretto supporto del punto di inserimento è fondamentale per molte applicazioni client, incluse quelle non basate sull'automazione dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="ae827-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="ae827-360">Nel pattern di controllo **Text** il punto di inserimento è rappresentato da un intervallo di testo degenerato (vuoto) in corrispondenza della posizione del cursore di sistema.</span><span class="sxs-lookup"><span data-stu-id="ae827-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="ae827-361">Quando il punto di inserimento viene spostato, un controllo deve generare l'evento **TextSelectionChanged** ([**\_ \_ TextSelectionChangedEventId di testo UIA**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="ae827-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="ae827-362">Alcune applicazioni client dipendono da questo evento per monitorare la posizione del punto di inserimento e per tenere traccia della selezione del testo.</span><span class="sxs-lookup"><span data-stu-id="ae827-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="ae827-363">Quando un controllo contiene il testo selezionato, la struttura corrente del pattern di controllo **Text** non fornisce un modo per associare direttamente la posizione del punto di inserimento a un intervallo di testo specifico.</span><span class="sxs-lookup"><span data-stu-id="ae827-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="ae827-364">Il provider deve tenere traccia della selezione del testo e impostare il percorso del punto di inserimento in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="ae827-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="ae827-365">Poiché la selezione del testo viene in genere eseguita spostando il punto di inserimento tenendo premuto il tasto MAIUSC o CTRL oppure entrambi, un provider può tenere traccia della selezione del testo controllando lo stato di queste chiavi ogni volta che la selezione viene modificata.</span><span class="sxs-lookup"><span data-stu-id="ae827-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="ae827-366">Poiché il Framework di accessibilità fornisce supporto incorporato per il punto di inserimento del sistema, ma non per un accento circonflesso personalizzato, i controlli basati su testo devono usare il punto di inserimento del sistema laddove possibile.</span><span class="sxs-lookup"><span data-stu-id="ae827-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="ae827-367">I controlli che usano un cursore personalizzato possono garantire che il punto di inserimento sia accessibile creando un cursore di sistema con le stesse dimensioni del cursore personalizzato e posizionando il cursore del sistema nella stessa posizione dell'interfaccia utente del controllo come cursore personalizzato, ovvero nel punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="ae827-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="ae827-368">In alternativa, un controllo che usa un punto di inserimento personalizzato può implementare un provider Microsoft Active Accessibility per il punto di inserimento [**objid \_**](object-identifiers.md) per fornire informazioni sull'accessibilità direttamente per il punto di inserimento personalizzato.</span><span class="sxs-lookup"><span data-stu-id="ae827-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="ae827-369">Per ulteriori informazioni sul punto di inserimento del sistema, vedere la pagina relativa al punto di [inserimento](/windows/desktop/menurc/carets).</span><span class="sxs-lookup"><span data-stu-id="ae827-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="ae827-370">Per verificare se il controllo espone correttamente la posizione del punto di inserimento del sistema, usare gli strumenti di controllo degli eventi [ispezionabili](inspect-objects.md) e [accessibili](accessible-event-watcher.md) .</span><span class="sxs-lookup"><span data-stu-id="ae827-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="ae827-371">Le coordinate dello schermo del centro della bitmap del cursore di sistema devono corrispondere sempre alla posizione del punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="ae827-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="ae827-372">In questo modo, un client può usare le coordinate dello schermo del cursore in una chiamata a [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) per recuperare un intervallo di testo che rappresenta accuratamente la posizione del punto di inserimento.</span><span class="sxs-lookup"><span data-stu-id="ae827-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ae827-373">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="ae827-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ae827-374">Tipi di controllo e i pattern di controllo supportati</span><span class="sxs-lookup"><span data-stu-id="ae827-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="ae827-375">Tipo di controllo Text</span><span class="sxs-lookup"><span data-stu-id="ae827-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="ae827-376">Pattern di controllo TextEdit</span><span class="sxs-lookup"><span data-stu-id="ae827-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="ae827-377">Pattern di controllo TextChild</span><span class="sxs-lookup"><span data-stu-id="ae827-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="ae827-378">Cenni preliminari sui pattern di controllo per l'automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="ae827-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="ae827-379">Supporto di automazione interfaccia utente per contenuto testuale</span><span class="sxs-lookup"><span data-stu-id="ae827-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="ae827-380">Panoramica dell'albero di automazione dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="ae827-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 