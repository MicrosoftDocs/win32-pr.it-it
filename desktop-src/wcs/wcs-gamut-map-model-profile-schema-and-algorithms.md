---
title: Schema e algoritmi del profilo del modello di mappa del programma WCS
description: Schema e algoritmi del profilo del modello di mappa del programma WCS
ms.assetid: 64b9871a-1b4f-4e9a-be4d-4c25b3198b91
keywords:
- Windows Color System (WCS), profilo del modello di mappa gamut (GMMP)
- WCS (sistema di colori Windows), profilo del modello di mappa gamut (GMMP)
- Gestione colori immagine, profilo del modello di mappa gamut (GMMP)
- gestione dei colori, profilo del modello di mappa gamut (GMMP)
- colori, profilo del modello di mappa gamut (GMMP)
- Windows Color System (WCS), profili
- WCS (Windows Color System), profili
- Gestione colori immagine, profili
- gestione dei colori, profili
- colori, profili
- profilo del modello di mappa gamut (GMMP)
- GMMP (Profilo modello di mappa gamut)
- Profilo del modello di mappa della gamma WCS
- schemi, profilo del modello di mappa gamut (GMMP)
- algoritmi, profilo del modello di mappa gamut (GMMP)
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3714e5d7592cb1fbbbfa98e238642a2fcb38bafd
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/05/2021
ms.locfileid: "104554173"
---
# <a name="wcs-gamut-map-model-profile-schema-and-algorithms"></a><span data-ttu-id="16d48-118">Schema e algoritmi del profilo del modello di mappa del programma WCS</span><span class="sxs-lookup"><span data-stu-id="16d48-118">WCS Gamut Map Model Profile Schema and Algorithms</span></span>

-   [<span data-ttu-id="16d48-119">Overview</span><span class="sxs-lookup"><span data-stu-id="16d48-119">Overview</span></span>](#overview)
-   [<span data-ttu-id="16d48-120">Architettura del profilo del modello di mappa gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-120">Gamut Map Model Profile Architecture</span></span>](#gamut-map-model-profile-architecture)
-   [<span data-ttu-id="16d48-121">Generazione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-121">Generation of the Gamut Boundary</span></span>](#generation-of-the-gamut-boundary)
-   [<span data-ttu-id="16d48-122">Schema GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-122">The GMMP Schema</span></span>](#the-gmmp-schema)
-   [<span data-ttu-id="16d48-123">Elementi dello schema GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-123">The GMMP Schema Elements</span></span>](#the-gmmp-schema-elements)
-   [<span data-ttu-id="16d48-124">GamutMapModel</span><span class="sxs-lookup"><span data-stu-id="16d48-124">GamutMapModel</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="16d48-125">Namespace</span><span class="sxs-lookup"><span data-stu-id="16d48-125">Namespace</span></span>](#namespace)
    -   [<span data-ttu-id="16d48-126">Versione</span><span class="sxs-lookup"><span data-stu-id="16d48-126">Version</span></span>](#version)
    -   [<span data-ttu-id="16d48-127">Documentazione</span><span class="sxs-lookup"><span data-stu-id="16d48-127">Documentation</span></span>](#documentation)
    -   [<span data-ttu-id="16d48-128">Tipo DefaultBaselineGamutMapModel</span><span class="sxs-lookup"><span data-stu-id="16d48-128">DefaultBaselineGamutMapModel type</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="16d48-129">PlugInGamutMapType</span><span class="sxs-lookup"><span data-stu-id="16d48-129">PlugInGamutMapType</span></span>](#plugingamutmaptype)
    -   [<span data-ttu-id="16d48-130">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="16d48-130">ExtensionType</span></span>](#extensiontype)
-   [<span data-ttu-id="16d48-131">Algoritmi di base di GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-131">The GMMP Baseline Algorithms</span></span>](#the-gmmp-baseline-algorithms)
-   [<span data-ttu-id="16d48-132">Allineamento degli assi neutri</span><span class="sxs-lookup"><span data-stu-id="16d48-132">Aligning the Neutral Axes</span></span>](#aligning-the-neutral-axes)
    -   [<span data-ttu-id="16d48-133">Differenza colore minima (macinata)</span><span class="sxs-lookup"><span data-stu-id="16d48-133">Minimum Color Difference (MinCD)</span></span>](#minimum-color-difference-mincd)
    -   [<span data-ttu-id="16d48-134">BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="16d48-134">BasicPhoto</span></span>](#basicphoto)
    -   [<span data-ttu-id="16d48-135">Overview</span><span class="sxs-lookup"><span data-stu-id="16d48-135">Overview</span></span>](#overview)
    -   [<span data-ttu-id="16d48-136">Il caso della shell della gamma singola</span><span class="sxs-lookup"><span data-stu-id="16d48-136">The case of single gamut shell</span></span>](#the-case-of-single-gamut-shell)
    -   [<span data-ttu-id="16d48-137">Miglioramento nero</span><span class="sxs-lookup"><span data-stu-id="16d48-137">Black enhancement</span></span>](#black-enhancement)
    -   [<span data-ttu-id="16d48-138">Il caso di Shell Dual gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-138">The case of dual gamut shells</span></span>](#the-case-of-dual-gamut-shells)
    -   [<span data-ttu-id="16d48-139">Motivi per le modifiche apportate ai consigli CIE TC8-03</span><span class="sxs-lookup"><span data-stu-id="16d48-139">Reasons for changes from the CIE TC8-03 recommendations</span></span>](#reasons-for-changes-from-the-cie-tc8-03-recommendations)
    -   [<span data-ttu-id="16d48-140">Mapping tonalità</span><span class="sxs-lookup"><span data-stu-id="16d48-140">Hue mapping</span></span>](#hue-mapping)
-   [<span data-ttu-id="16d48-141">Descrizione limite gamut e algoritmi della shell gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-141">Gamut Boundary Description and Gamut Shell Algorithms</span></span>](#gamut-boundary-description-and-gamut-shell-algorithms)
    -   [<span data-ttu-id="16d48-142">Triangolazione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-142">Triangulation of the Gamut Boundary</span></span>](#triangulation-of-the-gamut-boundary)
    -   [<span data-ttu-id="16d48-143">Elementi linea limite</span><span class="sxs-lookup"><span data-stu-id="16d48-143">Boundary Line Elements</span></span>](#boundary-line-elements)
    -   [<span data-ttu-id="16d48-144">Operazione gamut: CheckGamut</span><span class="sxs-lookup"><span data-stu-id="16d48-144">Gamut Operation: CheckGamut</span></span>](#gamut-operation-checkgamut)
    -   [<span data-ttu-id="16d48-145">Piano di Hue completo: Intersect</span><span class="sxs-lookup"><span data-stu-id="16d48-145">Full Hue Plane: Intersect</span></span>](#full-hue-plane-intersect)
    -   [<span data-ttu-id="16d48-146">Operazione gamut: CheckGamut (continua)</span><span class="sxs-lookup"><span data-stu-id="16d48-146">Gamut Operation: CheckGamut (continued)</span></span>](#gamut-operation-checkgamut-continued)
    -   [<span data-ttu-id="16d48-147">Mapping del gamut di differenza colore minimo</span><span class="sxs-lookup"><span data-stu-id="16d48-147">Minimum Color Difference Gamut Mapping</span></span>](#minimum-color-difference-gamut-mapping)
    -   [<span data-ttu-id="16d48-148">Smussatura tonalità</span><span class="sxs-lookup"><span data-stu-id="16d48-148">Hue Smoothing</span></span>](#hue-smoothing)
    -   [<span data-ttu-id="16d48-149">Impostazione di primari e secondari nella descrizione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-149">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>](#setting-primaries-and-secondaries-in-the-gamut-boundary-description)
    -   [<span data-ttu-id="16d48-150">Impostazione dell'asse neutro nella descrizione del limite della gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-150">Setting the Neutral Axis in the Gamut Boundary Description</span></span>](#setting-the-neutral-axis-in-the-gamut-boundary-description)
-   [<span data-ttu-id="16d48-151">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="16d48-151">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="16d48-152">Panoramica</span><span class="sxs-lookup"><span data-stu-id="16d48-152">Overview</span></span>

<span data-ttu-id="16d48-153">Questo schema viene utilizzato per specificare il contenuto di un profilo del modello di mappa gamut (GMMP).</span><span class="sxs-lookup"><span data-stu-id="16d48-153">This schema is used to specify the content of a gamut map model profile (GMMP).</span></span> <span data-ttu-id="16d48-154">Gli algoritmi di base associati sono descritti nell'argomento seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-154">The associated baseline algorithms are described in the following topic.</span></span>

<span data-ttu-id="16d48-155">Lo schema GMMP di base è costituito da informazioni di intestazione comuni, un riferimento facoltativo a un plug-in del modello di mappa gamut preferito e tag di estensione.</span><span class="sxs-lookup"><span data-stu-id="16d48-155">The basic GMMP schema consists of common header information, an optional reference to a preferred Gamut Map Model plug-in, and extension tags.</span></span>

<span data-ttu-id="16d48-156">Inoltre, GMMP fornisce informazioni esplicite sul modello di mappa del gamut di destinazione e fornisce un criterio sul modello di mappa del gamut di fallback di base da usare se il modello di destinazione non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-156">In addition, the GMMP provides explicit information on the targeted Gamut Map Model, and provides a policy on the baseline fallback Gamut Map Model to use if the targeted model is unavailable.</span></span> <span data-ttu-id="16d48-157">Lo schema può includere informazioni sull'estensione privata, ma non includerà altre informazioni estranee.</span><span class="sxs-lookup"><span data-stu-id="16d48-157">The schema can include private extensional information, but will include no other extraneous information.</span></span>

## <a name="gamut-map-model-profile-architecture"></a><span data-ttu-id="16d48-158">Architettura del profilo del modello di mappa gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-158">Gamut Map Model Profile Architecture</span></span>

![Diagramma che mostra il profilo del modello di mappa gamut.](images/gmmp-image002.png)

<span data-ttu-id="16d48-160">Il campionamento dello spazio colorante del dispositivo di output viene eseguito scorrendo i coloranti da 0,0 a 1,0 con un passaggio frazionario, accumulando tutte le combinazioni di ogni colore a ogni passaggio e quindi convertendo tali combinazioni dallo spazio colorante del dispositivo allo spazio di aspetto dei colori utilizzando il metodo DM::D eviceToColorimetricColors seguito dal metodo CAM:: ColorimetricToAppearanceColors.</span><span class="sxs-lookup"><span data-stu-id="16d48-160">The sampling of the output device colorant space is done by iterating through the colorants from 0.0 to 1.0 with a fractional step, accumulating all combinations of each colorant at each step, and then converting them from device colorant space to color appearance space using the DM::DeviceToColorimetricColors method followed by the CAM::ColorimetricToAppearanceColors method.</span></span> <span data-ttu-id="16d48-161">Di seguito è riportato un esempio di come eseguire questa operazione per RGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-161">The following is an example of how this is done for RGB.</span></span>


```C++
For (red= 0.0; red <= 1.0; red += redStep) {

     For (green = 0.0; green <= 1.0; green += greenStep) {

          For (blue = 0.0; blue <= 1.0; blue += blueStep) {

               Colorants[0] = red; colorants[1] = green; colorants[2] = blue;

               pRGBDM->DeviceToColorimetricColors(1, colorants, &amp;XYZ);

               pCAM->ColorimetricToAppearanceColors(1, &amp;XYZ, &amp;JCh);

          }

     }

}

```



## <a name="generation-of-the-gamut-boundary"></a><span data-ttu-id="16d48-162">Generazione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-162">Generation of the Gamut Boundary</span></span>

<span data-ttu-id="16d48-163">Sono disponibili tre componenti al limite della gamma: le primarie, gli esempi neutri e le shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-163">There are three components to the gamut boundary: the primaries, the neutral samples, and the shells.</span></span> <span data-ttu-id="16d48-164">Le primarie vengono generate prendendo le primarie del dispositivo e applicando la trasformazione DeviceToColorimetric/ColorimetricToAppearance.</span><span class="sxs-lookup"><span data-stu-id="16d48-164">The primaries are generated by taking the device primaries and applying the DeviceToColorimetric/ColorimetricToAppearance transformation.</span></span> <span data-ttu-id="16d48-165">Gli esempi neutri vengono generati eseguendo il campionamento dello spazio colorante del dispositivo nell'area neutra e applicando la stessa trasformazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-165">The neutral samples are generated by sampling the device colorant space in the neutral area and applying the same transformation.</span></span> <span data-ttu-id="16d48-166">Per tre dispositivi colorati (RGB o CMY), gli esempi neutri vengono definiti come aventi tutti i coloranti uguali, ad esempio R = = G = = B. Per CMYK, gli esempi neutri sono definiti con C = = M = = Y = = 0.</span><span class="sxs-lookup"><span data-stu-id="16d48-166">For three colorant devices (RGB or CMY), the neutral samples are defined as having all of the colorants equal, for example, R == G == B. For CMYK, the neutral samples are defined as having C == M == Y == 0.</span></span>

<span data-ttu-id="16d48-167">I fattori che influenzano i dati usati per creare il limite di gamut sono gli esempi di dati (solo per i dispositivi baseline) e le condizioni di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-167">The factors that influence the data used to create the gamut boundary are the data samples (baseline devices only) and the viewing conditions.</span></span> <span data-ttu-id="16d48-168">La dimensione del passaggio utilizzata per eseguire il campionamento completo dello spazio colorato (per i monitoraggi e per la shell plausibile) è una costante interna e non è disponibile per la manipolazione esterna.</span><span class="sxs-lookup"><span data-stu-id="16d48-168">The step size used to do the full sampling of the colorant space (for monitors and for plausible shell) is an internal constant and isn't available for outside manipulation.</span></span> <span data-ttu-id="16d48-169">Se si modificano le condizioni di visualizzazione, il comportamento del modello di aspetto colore (camma) viene modificato e viene modificata la forma del limite della gamma, pertanto è necessario generare un limite di gamut associato al profilo delle condizioni di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-169">Changing the viewing conditions changes the behavior of the color appearance model (CAM) and alters the shape of the gamut boundary, so you must generate a gamut boundary tied to the viewing conditions profile.</span></span> <span data-ttu-id="16d48-170">Se si usano dati di esempio, come nel caso delle stampanti di base e dei dispositivi di acquisizione, gli esempi avranno un notevole impatto sulla forma della gamma di riferimento e influiscono sul comportamento del modello stesso.</span><span class="sxs-lookup"><span data-stu-id="16d48-170">If sample data is used, as in the case of baseline printers and capture devices, then the samples will have a lot of impact on the shape of the reference gamut and affect the behavior of the model itself.</span></span>

<span data-ttu-id="16d48-171">Per i dispositivi di input, ad esempio fotocamere e scanner, vengono usati campionamenti diversi per generare la shell di riferimento e la shell plausibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-171">For input devices, such as cameras and scanners, different samplings are used to generate the reference shell and the plausible shell.</span></span> <span data-ttu-id="16d48-172">La shell di riferimento viene generata dalle misurazioni usate per inizializzare il modello di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-172">The reference shell is generated from the measurements used to initialize the device model.</span></span> <span data-ttu-id="16d48-173">La shell plausibile viene generata in modo analogo all'illustrazione precedente per i dispositivi di output.</span><span class="sxs-lookup"><span data-stu-id="16d48-173">The plausible shell is generated similar to the prior illustration for output devices.</span></span> <span data-ttu-id="16d48-174">La differenza è che quando si importano una destinazione tipica, non si ottengono valori completamente saturi (dove R, G o B = 255).</span><span class="sxs-lookup"><span data-stu-id="16d48-174">The difference it that when you input a typical target, you don't get fully saturated values (where R, G, or B = 255).</span></span> <span data-ttu-id="16d48-175">È necessario estrapolare usando il modello di dispositivo per stimare tali valori.</span><span class="sxs-lookup"><span data-stu-id="16d48-175">You must extrapolate using the device model to estimate those values.</span></span>

## <a name="the-gmmp-schema"></a><span data-ttu-id="16d48-176">Schema GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-176">The GMMP Schema</span></span>


```C++
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema 
  xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:wcs="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes"
  targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"
  blockDefault="#all"
  version="1.0">

  <xs:annotation>
    <xs:documentation>
      Gamut Map Model profile schema.
      Copyright (C) Microsoft. All rights reserved.
    </xs:documentation>
  </xs:annotation>

  <xs:import namespace="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes" />

  <xs:element name="GamutMapModel">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="ProfileName" type="wcs:MultiLocalizedTextType"/>
        <xs:element name="Description" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="Author" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="DefaultBaselineGamutMapModel">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="HPMinCD_Absolute"/>
              <xs:enumeration value="HPMinCD_Relative"/>
              <xs:enumeration value="SGCK"/>
              <xs:enumeration value="HueMap"/>
            </xs:restriction>
          </xs:simpleType>
        </xs:element>
        <xs:element name="PlugInGamutMapModel" minOccurs="0">
          <xs:complexType>
            <xs:sequence>
              <xs:any namespace="##other" processContents="skip"
                minOccurs="0" maxOccurs="unbounded" />
            </xs:sequence>
            <xs:attribute name="GUID" type="wcs:GUIDType" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="ID" type="xs:string" use="optional" />
    </xs:complexType>
  </xs:element>
</xs:schema>
```



## <a name="the-gmmp-schema-elements"></a><span data-ttu-id="16d48-177">Elementi dello schema GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-177">The GMMP Schema Elements</span></span>

## <a name="gamutmapmodel"></a><span data-ttu-id="16d48-178">GamutMapModel</span><span class="sxs-lookup"><span data-stu-id="16d48-178">GamutMapModel</span></span>

<span data-ttu-id="16d48-179">Questo elemento è una sequenza dei sottoelementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="16d48-179">This element is a sequence of the following sub-elements:</span></span>

1.  <span data-ttu-id="16d48-180">Stringa ProfileName,</span><span class="sxs-lookup"><span data-stu-id="16d48-180">ProfileName string,</span></span>
2.  <span data-ttu-id="16d48-181">DefaultBaselineGamutMapModel,</span><span class="sxs-lookup"><span data-stu-id="16d48-181">DefaultBaselineGamutMapModel,</span></span>
3.  <span data-ttu-id="16d48-182">Stringa di descrizione facoltativa,</span><span class="sxs-lookup"><span data-stu-id="16d48-182">Optional Description string,</span></span>
4.  <span data-ttu-id="16d48-183">Stringa autore facoltativa,</span><span class="sxs-lookup"><span data-stu-id="16d48-183">Optional Author string,</span></span>
5.  <span data-ttu-id="16d48-184">PlugInGamutMap facoltativo e</span><span class="sxs-lookup"><span data-stu-id="16d48-184">Optional PlugInGamutMap, and</span></span>
6.  <span data-ttu-id="16d48-185">ExtensionType facoltativo.</span><span class="sxs-lookup"><span data-stu-id="16d48-185">Optional ExtensionType.</span></span>

<span data-ttu-id="16d48-186">**Condizioni di convalida** : ogni sottoelemento viene convalidato in base al relativo tipo.</span><span class="sxs-lookup"><span data-stu-id="16d48-186">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="namespace"></a><span data-ttu-id="16d48-187">Spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="16d48-187">Namespace</span></span>

<span data-ttu-id="16d48-188">xmlns: MGM = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="16d48-188">xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

<span data-ttu-id="16d48-189">targetNamespace = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="16d48-189">targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

### <a name="version"></a><span data-ttu-id="16d48-190">Versione</span><span class="sxs-lookup"><span data-stu-id="16d48-190">Version</span></span>

<span data-ttu-id="16d48-191">Versione "1,0" con la prima versione di Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="16d48-191">Version "1.0" with the first release of Windows Vista.</span></span>

<span data-ttu-id="16d48-192">**Condizioni di convalida** : 1,0 in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="16d48-192">**Validation conditions** : 1.0 in Windows Vista.</span></span> <span data-ttu-id="16d48-193">&lt;Sono inoltre valide le versioni 2,0 per supportare le modifiche non di rilievo nel formato.</span><span class="sxs-lookup"><span data-stu-id="16d48-193">Versions &lt;2.0 are also valid in order to support non-breaking changes to the format.</span></span>

### <a name="documentation"></a><span data-ttu-id="16d48-194">Documentazione</span><span class="sxs-lookup"><span data-stu-id="16d48-194">Documentation</span></span>

<span data-ttu-id="16d48-195">Schema del profilo del modello di mappa gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-195">Gamut Map Model Profile schema.</span></span>

<span data-ttu-id="16d48-196">Copyright (C) Microsoft.</span><span class="sxs-lookup"><span data-stu-id="16d48-196">Copyright (C) Microsoft.</span></span> <span data-ttu-id="16d48-197">Tutti i diritti sono riservati.</span><span class="sxs-lookup"><span data-stu-id="16d48-197">All rights reserved.</span></span>

<span data-ttu-id="16d48-198">**Condizioni di convalida** : ogni sottoelemento viene convalidato in base al relativo tipo.</span><span class="sxs-lookup"><span data-stu-id="16d48-198">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="defaultbaselinegamutmapmodel-type"></a><span data-ttu-id="16d48-199">Tipo DefaultBaselineGamutMapModel</span><span class="sxs-lookup"><span data-stu-id="16d48-199">DefaultBaselineGamutMapModel type</span></span>

<span data-ttu-id="16d48-200">Tipo UINT</span><span class="sxs-lookup"><span data-stu-id="16d48-200">UINT type</span></span>

<span data-ttu-id="16d48-201">Valori di enumerazione:</span><span class="sxs-lookup"><span data-stu-id="16d48-201">Enumeration values:</span></span>

<dl> <span data-ttu-id="16d48-202">"Totale tritati \_ "</span><span class="sxs-lookup"><span data-stu-id="16d48-202">"MinCD\_Absolute"</span></span>  
<span data-ttu-id="16d48-203">"MinCd \_ relativa"</span><span class="sxs-lookup"><span data-stu-id="16d48-203">"MinCD\_Relative"</span></span>  
<span data-ttu-id="16d48-204">"SIG \_ ginocchio"</span><span class="sxs-lookup"><span data-stu-id="16d48-204">"SIG\_KNEE"</span></span>  
<span data-ttu-id="16d48-205">"HueMap"</span><span class="sxs-lookup"><span data-stu-id="16d48-205">"HueMap"</span></span>  
</dl>

<span data-ttu-id="16d48-206">**Condizioni di convalida** : i valori devono corrispondere a una delle enumerazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-206">**Validation conditions** : The values must match one of the enumerations above.</span></span>

### <a name="plugingamutmaptype"></a><span data-ttu-id="16d48-207">PlugInGamutMapType</span><span class="sxs-lookup"><span data-stu-id="16d48-207">PlugInGamutMapType</span></span>

<span data-ttu-id="16d48-208">Questo elemento è una sequenza di un GUID GUIDType e di tutti gli elementi secondari.</span><span class="sxs-lookup"><span data-stu-id="16d48-208">This element is a sequence of a GUID GUIDType and any sub-elements.</span></span>

<span data-ttu-id="16d48-209">**Condizioni di convalida** : il GUID viene usato per trovare la corrispondenza con il GUID della dll del plug-in MGM.</span><span class="sxs-lookup"><span data-stu-id="16d48-209">**Validation conditions** : The GUID is used to match the GMM PlugIn DLL GUID.</span></span> <span data-ttu-id="16d48-210">Sono presenti un massimo di 100.000 sottoelementi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="16d48-210">There are a maximum of 100,000 custom sub-elements.</span></span>

### <a name="extensiontype"></a><span data-ttu-id="16d48-211">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="16d48-211">ExtensionType</span></span>

<span data-ttu-id="16d48-212">Questo elemento è una sequenza facoltativa di qualsiasi sottoelemento.</span><span class="sxs-lookup"><span data-stu-id="16d48-212">This element is a optional sequence of any sub-elements.</span></span>

<span data-ttu-id="16d48-213">**Condizioni di convalida** : possono essere presenti al massimo 100.000 sottoelementi.</span><span class="sxs-lookup"><span data-stu-id="16d48-213">**Validation conditions** : There can be a maximum of 100,000 sub-elements.</span></span>

## <a name="the-gmmp-baseline-algorithms"></a><span data-ttu-id="16d48-214">Algoritmi di base di GMMP</span><span class="sxs-lookup"><span data-stu-id="16d48-214">The GMMP Baseline Algorithms</span></span>

## <a name="aligning-the-neutral-axes"></a><span data-ttu-id="16d48-215">Allineamento degli assi neutri</span><span class="sxs-lookup"><span data-stu-id="16d48-215">Aligning the Neutral Axes</span></span>

<span data-ttu-id="16d48-216">La maggior parte degli algoritmi di mapping di gamut è in grado di eseguire il mapping dell'asse neutro del dispositivo di origine all'asse neutro del dispositivo di destinazione, ovvero il bianco passa a bianco, da nero a nero e da grigio a grigio.</span><span class="sxs-lookup"><span data-stu-id="16d48-216">Most gamut mapping algorithms have a goal of mapping the neutral axis of the source device to the neutral axis of the destination device: that is, white goes to white, black to black, and gray to gray.</span></span> <span data-ttu-id="16d48-217">Questo problema viene risolto in parte scalando la luminosità dei colori di origine in modo che corrisponda all'intervallo di luminosità del dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-217">This is addressed in part by scaling the lightness of source colors to match the lightness range of the destination device.</span></span> <span data-ttu-id="16d48-218">Ma questo non risolve completamente il problema.</span><span class="sxs-lookup"><span data-stu-id="16d48-218">But that does not completely address the problem.</span></span>

<span data-ttu-id="16d48-219">Si tratta di una proprietà fisica della maggior parte dei dispositivi di imaging che la cromatità del dispositivo bianco non corrisponde esattamente alla cromaticità del nero del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-219">It is a physical property of most imaging devices that the chromaticity of the device white does not exactly match the chromaticity of the device black.</span></span> <span data-ttu-id="16d48-220">Ad esempio, il monitoraggio del bianco dipende dalla somma delle cromaticità e dalle luminanze relative dei tre primari, mentre il monitor nero dipende dalla riflettenza della superficie di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-220">For example, monitor white depends on the sum of the chromaticities and relative luminances of the three primaries, while monitor black depends on the reflectance of the display surface.</span></span> <span data-ttu-id="16d48-221">Il bianco della stampante dipende dalla cromaticità della carta, mentre la stampante nera dipende dall'input penna o dal toner usato.</span><span class="sxs-lookup"><span data-stu-id="16d48-221">Printer white depends on the chromaticity of the paper, while printer black depends on the ink or toner used.</span></span> <span data-ttu-id="16d48-222">Un modello di aspetto che esegue il mapping del dispositivo bianco esattamente all'asse neutro dello spazio di aspetto (Chroma esattamente uguale a zero) non eseguirà il mapping del dispositivo nero all'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-222">An appearance model that maps device white exactly to the neutral axis of the appearance space (chroma exactly equal to zero) will not map device black to the neutral axis.</span></span> <span data-ttu-id="16d48-223">Poiché l'occhio è più sensibile alle differenze di croma Man mano che aumenta la luminosità, i grigi sono rappresentati come ancora più cromatici del nero del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-223">Because the eye is more sensitive to chroma differences as lightness increases, mid-grays will be represented as even more chromatic than device black.</span></span> <span data-ttu-id="16d48-224">Nella figura 1 viene illustrata la curvatura degli assi neutri in due dimensioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-224">(Figure 1 illustrates the curvature of the neutral axes in two dimensions.</span></span> <span data-ttu-id="16d48-225">Infatti, gli assi neutri formano una curva più complessa in tre dimensioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-225">In fact, the neutral axes form a more complex curve in three dimensions.)</span></span>

<span data-ttu-id="16d48-226">Mentre la camma prevede che questi colori neutri del dispositivo appariranno cromatici, gli osservatori effettivi sembrano compensare.</span><span class="sxs-lookup"><span data-stu-id="16d48-226">While the CAM predicts that these device neutral colors will appear chromatic, actual observers seem to compensate for this.</span></span> <span data-ttu-id="16d48-227">La maggior parte degli utenti non considera questi valori neutri del dispositivo come cromatici.</span><span class="sxs-lookup"><span data-stu-id="16d48-227">Most people do not consider these device neutral values to be chromatic.</span></span> <span data-ttu-id="16d48-228">Per la maggior parte dei modelli di mapping di gamut, è pertanto necessario continuare a eseguire il mapping di origini neutre al dispositivo neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-228">For most gamut mapping models, therefore, you should continue to map source neutrals to device neutrals.</span></span>

<span data-ttu-id="16d48-229">Per eseguire il mapping dei dati di origine neutri ai dispositivi neutri, regolare i limiti della gamma di origine e di destinazione e ogni pixel quando si applica l'algoritmo di mapping gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-229">To map source neutrals to device neutrals, adjust the source and destination gamut boundaries and each pixel when you apply the gamut mapping algorithm.</span></span> <span data-ttu-id="16d48-230">Modificare prima di tutto il valore del colore di origine in modo che l'asse neutro del dispositivo di origine alla luce del colore di origine cada direttamente sull'asse neutro dello spazio di aspetto.</span><span class="sxs-lookup"><span data-stu-id="16d48-230">First adjust each value in the source color so that the source device's neutral axis at the source color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="16d48-231">(Vedere il lato sinistro della figura 1). Modificare quindi la descrizione del limite gamut del dispositivo di destinazione in modo che ogni colore sull'asse neutro del dispositivo di destinazione alla luce del colore del limite della gamma di dispositivi di destinazione cada direttamente sull'asse neutro dello spazio di aspetto.</span><span class="sxs-lookup"><span data-stu-id="16d48-231">(See the left side of Figure 1.) Then adjust the destination device's gamut boundary description so that each color on the destination device's neutral axis at the destination device gamut boundary color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="16d48-232">(Vedere il lato destro della figura 1).</span><span class="sxs-lookup"><span data-stu-id="16d48-232">(See the right side of Figure 1.)</span></span>

![Diagramma che mostra il grafico dei limiti della gamma di origine a sinistra e il limite della gamma di destinazione a destra.](images/gmmp-image004.png)

<span data-ttu-id="16d48-234">**Figura 1** : allineamento degli assi neutri illustrati.</span><span class="sxs-lookup"><span data-stu-id="16d48-234">**Figure 1** : Alignment of the neutral axes illustrated.</span></span> <span data-ttu-id="16d48-235">Left: regolazione dei punti di origine relativi all'asse neutro del dispositivo di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-235">Left: Adjusting source points relative to the source device neutral axis.</span></span> <span data-ttu-id="16d48-236">Right: regolazione della descrizione del limite della gamma di destinazione rispetto alla descrizione del limite della gamma di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-236">Right: Adjusting the destination gamut boundary description relative to the destination gamut boundary description.</span></span>

<span data-ttu-id="16d48-237">Si noti che si regola ogni valore del pixel di origine in relazione all'asse neutro in corrispondenza del valore di luminosità.</span><span class="sxs-lookup"><span data-stu-id="16d48-237">Note that you adjust each source pixel value relative to the neutral axis at that lightness value.</span></span> <span data-ttu-id="16d48-238">Ciò assicura che i dispositivi di origine neutri siano ricadenti sull'asse neutro del modello di aspetto.</span><span class="sxs-lookup"><span data-stu-id="16d48-238">This assures that source device neutrals will fall on the neutral axis of the appearance model.</span></span> <span data-ttu-id="16d48-239">Si spostano anche tutti gli altri colori alla luce della stessa quantità, in modo che non vi siano discontinuità nella rappresentazione del gamut di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-239">You also shift all other colors at that lightness by the same amount, so that there are no discontinuities in the representation of the source gamut.</span></span> <span data-ttu-id="16d48-240">È necessario passare da importi diversi a livelli di luminosità diversi, perché i valori neutri del dispositivo di origine non sono rappresentati come cromatici allo stesso modo a livelli di luminosità diversi.</span><span class="sxs-lookup"><span data-stu-id="16d48-240">You have to shift by different amounts at different lightness levels, because the source device neutrals are not represented as equally chromatic at the different lightness levels.</span></span> <span data-ttu-id="16d48-241">Ovviamente, non si tratta di una trasformazione semplice.</span><span class="sxs-lookup"><span data-stu-id="16d48-241">Clearly, this is not a trivial transformation.</span></span>

<span data-ttu-id="16d48-242">La gestione dei valori del dispositivo di destinazione è leggermente più complessa.</span><span class="sxs-lookup"><span data-stu-id="16d48-242">Handling the destination device values is a little more tricky.</span></span> <span data-ttu-id="16d48-243">Inizialmente si regola l'intero limite della gamma di destinazione in modo analogo, ma in relazione all'asse neutro del dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-243">Initially, you adjust the entire destination gamut boundary in a similar manner, but relative to the destination device neutral axis.</span></span> <span data-ttu-id="16d48-244">Questa operazione è illustrata nella figura 1 sul lato destro.</span><span class="sxs-lookup"><span data-stu-id="16d48-244">This is illustrated in Figure 1 on the right side.</span></span> <span data-ttu-id="16d48-245">Questa regolazione garantisce che i valori grigio di origine eseguiranno il mapping ai valori grigi di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-245">That adjustment assures that source gray values will map to destination gray values.</span></span> <span data-ttu-id="16d48-246">Si tratta dello spazio in cui operano gli algoritmi di mapping della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-246">This is the space in which the gamut mapping algorithms operate.</span></span>

<span data-ttu-id="16d48-247">Tuttavia, questo spazio non descrive in modo accurato il vero comportamento del dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-247">However, this space does not accurately describe the true behavior of the destination device.</span></span> <span data-ttu-id="16d48-248">È necessario invertire il mapping prima che i colori con mapping del gamut vengano passati al modello di aspetto e al modello di dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-248">You must invert the mapping before gamut mapped colors are handed to the appearance model and destination device model.</span></span> <span data-ttu-id="16d48-249">Si sfalsano tutti i valori mappati in base al contrario dell'offset applicato in precedenza all'asse neutro del dispositivo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-249">You offset all the mapped values by the opposite of the offset applied earlier to the destination device neutral axis.</span></span> <span data-ttu-id="16d48-250">In questo modo viene eseguito il mapping dell'asse neutro di destinazione al valore rappresentato originariamente dalla camma.</span><span class="sxs-lookup"><span data-stu-id="16d48-250">This maps the destination neutral axis back to the value represented originally by the CAM.</span></span> <span data-ttu-id="16d48-251">Esegue la stessa operazione per il limite della gamma e per tutti i valori intermedi.</span><span class="sxs-lookup"><span data-stu-id="16d48-251">It does the same for the gamut boundary and all intermediate values.</span></span>

![Diagramma che mostra un grafico per l'angolazione dell'allineamento dell'asse neutro del dispositivo di destinazione.](images/gmmp-image008.png)

<span data-ttu-id="16d48-253">**Figura 2** : angolazione dell'allineamento dell'asse neutro del dispositivo di destinazione</span><span class="sxs-lookup"><span data-stu-id="16d48-253">**Figure 2** : Undoing the alignment of the destination device neutral axis</span></span>

### <a name="minimum-color-difference-mincd"></a><span data-ttu-id="16d48-254">Differenza colore minima (macinata)</span><span class="sxs-lookup"><span data-stu-id="16d48-254">Minimum Color Difference (MinCD)</span></span>

<span data-ttu-id="16d48-255">Differenze di colore minime (tritate) e relative versioni assolute, equivalenti allo scopo colorimetrico di ICC.</span><span class="sxs-lookup"><span data-stu-id="16d48-255">Minimum Color Difference(MinCD) Relative and Absolute versions - equivalent to the ICC colorimetric intent.</span></span>

> [!Note]  
> <span data-ttu-id="16d48-256">Il MGM tritato è adatto per il mapping di elementi grafici e linee che contengono colori "logo" (colori spot), sfumature di colore del logo con alcuni colori fuori gamma e per la fase finale delle trasformazioni di correzione.</span><span class="sxs-lookup"><span data-stu-id="16d48-256">The MinCD GMM is suitable for mapping graphics and line art containing "logo" colors (spot colors), logo color gradients with some out-of-gamut colors, and for the final stage of proofing transforms.</span></span> <span data-ttu-id="16d48-257">Sebbene il MGM tritato possa essere usato per immagini fotografiche completamente incluse nel gamut di destinazione, non è consigliabile per il rendering generale delle immagini fotografiche.</span><span class="sxs-lookup"><span data-stu-id="16d48-257">While the MinCD GMM could be used for photographic images that are entirely within the destination gamut, it is not recommended for general rendering of photographic images.</span></span> <span data-ttu-id="16d48-258">Il mapping dei colori out-of-gamut ai colori sulla superficie della gamma di destinazione può comportare artefatti indesiderati, ad esempio irregolarità di tono o Croma in sfumature smussate che superano il limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-258">The mapping of out-of-gamut colors to colors on the destination gamut surface can result in unwanted artifacts, such as tone or chroma irregularities in smooth gradients that cross the gamut boundary.</span></span> <span data-ttu-id="16d48-259">BasicPhoto è consigliato per le immagini fotografiche.</span><span class="sxs-lookup"><span data-stu-id="16d48-259">BasicPhoto is recommended for photographic images.</span></span> <span data-ttu-id="16d48-260">Se un'immagine fotografica o contonica richiede un mapping di gamut diverso da BasicPhoto, l'alternativa dovrebbe essere la creazione di un plug-in MGM di implementazione del mapping, anziché l'uso di MinCd.</span><span class="sxs-lookup"><span data-stu-id="16d48-260">If a photographic or contone image requires a gamut mapping other than BasicPhoto, then the alternative should be to create a plug-in GMM implementing that mapping, instead of using MinCD.</span></span>

 

<span data-ttu-id="16d48-261">I colori in-gamut rimangono invariati.</span><span class="sxs-lookup"><span data-stu-id="16d48-261">In-gamut colors are left unchanged.</span></span> <span data-ttu-id="16d48-262">Per i colori fuori gamma, la luminosità e la cromaticità vengono regolate individuando il punto nella gamma di destinazione che ha la distanza di colore minima dai punti di input fuori dalla gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-262">For out-of-gamut colors, lightness and chroma are adjusted by finding the point in the destination gamut that has the minimum color distance from out-of-gamut input points.</span></span> <span data-ttu-id="16d48-263">La distanza del colore viene calcolata nello spazio JCh.</span><span class="sxs-lookup"><span data-stu-id="16d48-263">The color distance is computed in JCh space.</span></span> <span data-ttu-id="16d48-264">Tuttavia, si pondera la distanza in chiaro (J) e la distanza in Chroma (C) o Hue (h) in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="16d48-264">However, you weight the distance in lightness (J) and the distance in chroma (C) or hue (h) differently.</span></span> <span data-ttu-id="16d48-265">Una funzione di peso dipendente da Chroma viene utilizzata per la distanza in chiaro, in modo che il peso sia minore per la Croma piccola e più grande per la crominanza grande fino a quando non viene raggiunta la croma della soglia, dopo la quale il peso rimane a 1, ovvero lo stesso peso della distanza in Chroma o Hue.</span><span class="sxs-lookup"><span data-stu-id="16d48-265">A chroma-dependent weight function is used for the distance in lightness so that the weight is smaller for small chroma and larger for large chroma until a threshold chroma is reached, after which the weight stays at 1, that is, the same weight as distance in chroma or hue.</span></span> <span data-ttu-id="16d48-266">Segue l'utilizzo consigliato per CMC e CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="16d48-266">This follows recommended usage for CMC and CIEDE2000.</span></span> <span data-ttu-id="16d48-267">Esistono due varianti: colorimetrico relativo e colorimetrico assoluto.</span><span class="sxs-lookup"><span data-stu-id="16d48-267">There are two variants: Relative colorimetric and absolute colorimetric.</span></span>

<span data-ttu-id="16d48-268">**Colorimetrico relativo:** Allineare innanzitutto gli assi neutri di origine e di destinazione come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-268">**Relative colorimetric:** First, align the source and destination neutral axes as described previously.</span></span> <span data-ttu-id="16d48-269">Quindi ritagliare il colore di origine regolato al limite della gamma di destinazione adattata.</span><span class="sxs-lookup"><span data-stu-id="16d48-269">Then clip the adjusted source color to the adjusted destination gamut boundary.</span></span> <span data-ttu-id="16d48-270">(Vedere la figura 4.</span><span class="sxs-lookup"><span data-stu-id="16d48-270">(See Figure 4.</span></span> <span data-ttu-id="16d48-271">Chroma mapping lungo la luminosità costante). Modificare i valori del dispositivo di destinazione come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-271">Chroma mapping along constant lightness.) Readjust the destination device values as described previously.</span></span> <span data-ttu-id="16d48-272">Nel caso di un limite di gamut di destinazione monocromatico, il ritaglio Chroma significa che il valore Chroma (C) è impostato su zero (0,0).</span><span class="sxs-lookup"><span data-stu-id="16d48-272">In the case of a monochrome destination gamut boundary, the chroma clipping means that the chroma value (C) is set to zero (0.0).</span></span>

<span data-ttu-id="16d48-273">**Colorimetrico assoluto:** Questa operazione è simile a colorimetrico relativo, ma senza l'allineamento dell'asse neutro di origine e di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-273">**Absolute colorimetric:** This is similar to relative colorimetric, but without the alignment of the source and destination neutral axis.</span></span> <span data-ttu-id="16d48-274">Il valore di origine viene ritagliato direttamente sull'asse neutro di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-274">The source value is clipped directly to the destination neutral axis.</span></span> <span data-ttu-id="16d48-275">Si noti che se i limiti del gamut di origine e di destinazione sono monocromi, il comportamento è identico alla variante colorimetrico relativa; ovvero viene eseguito l'allineamento degli assi neutri e quindi il Chroma viene troncato a zero.</span><span class="sxs-lookup"><span data-stu-id="16d48-275">Note that if both the source and destination gamut boundaries are monochrome, the behavior is identical to the relative colorimetric variant; that is, the neutral axes alignment is performed, and then the chroma is clipped to zero.</span></span> <span data-ttu-id="16d48-276">In questo modo si garantisce che un output ragionevole venga raggiunto anche se i supporti e i coloranti sono molto diversi.</span><span class="sxs-lookup"><span data-stu-id="16d48-276">This ensures that a reasonable output is attained even if the media and colorants are significantly different.</span></span>

![Diagramma che mostra un grafico per il ritaglio tritato alla gamma adattata.](images/gmmp-image010.png)

<span data-ttu-id="16d48-278">**Figura 3** : ritaglio tritato alla gamma adattata</span><span class="sxs-lookup"><span data-stu-id="16d48-278">**Figure 3** : MinCD clipping to the adjusted gamut</span></span>

### <a name="basicphoto"></a><span data-ttu-id="16d48-279">BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="16d48-279">BasicPhoto</span></span>

### <a name="overview"></a><span data-ttu-id="16d48-280">Panoramica</span><span class="sxs-lookup"><span data-stu-id="16d48-280">Overview</span></span>

<span data-ttu-id="16d48-281">BasicPhoto: equivalente all'intento di Preferred, pittorico o percettivo ICC.</span><span class="sxs-lookup"><span data-stu-id="16d48-281">BasicPhoto - equivalent to the ICC preferred, pictorial, or perceptual intent.</span></span>

<span data-ttu-id="16d48-282">Questo algoritmo è una variante del mapping di luminosità sigmoidal che dipende dal Chroma e del ridimensionamento del ginocchio cuspide (SGCK) descritto da CIE TC8-03 in CIE156:2004.</span><span class="sxs-lookup"><span data-stu-id="16d48-282">This algorithm is a variant of the chroma-dependent sigmoidal lightness mapping and cusp knee scaling (SGCK) described by CIE TC8-03 in CIE156:2004.</span></span> <span data-ttu-id="16d48-283">Questo algoritmo Variant supporta i descrittori di limite gamut (GBDs) con le shell a doppio gamut; ovvero GBDs con una shell di riferimento e una shell plausibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-283">This variant algorithm supports gamut boundary descriptors (GBDs) with dual gamut shells; that is, GBDs with a reference shell and a plausible shell.</span></span> <span data-ttu-id="16d48-284">L'algoritmo SGCK, che in origine presuppone solo una shell gamut in GBD, si basa sull'algoritmo del \_ ginocchio sig (Braun 1999), che incorpora il mapping della luminosità sigmoidal e il ridimensionamento delle funzioni ginocchio proposto da Braun e Fairchild (1999), combinati con la dipendenza Chroma da GCUSP (Morovic, 1998).</span><span class="sxs-lookup"><span data-stu-id="16d48-284">The SGCK algorithm, which originally assumes only one gamut shell in the GBD, is based on the SIG\_KNEE algorithm (Braun 1999), that incorporates the sigmoidal lightness mapping and knee function scaling proposed by Braun and Fairchild (1999), combined with the chroma dependence from GCUSP (Morovic, 1998).</span></span> <span data-ttu-id="16d48-285">Mantiene la costante Hue percepita, ad esempio, l'angolo di tonalità nel jab con correzione per Hue e usa un ridimensionamento della luminosità sigmoidal generico (indipendente dall'immagine) che viene applicato in modo dipendente da Chroma e una funzione del ginocchio del 90%.</span><span class="sxs-lookup"><span data-stu-id="16d48-285">It keeps perceived hue constant, for example, hue angle in hue-corrected Jab, and uses a generic (image-independent) sigmoidal lightness scaling which is applied in a chroma-dependent way and a 90 percent knee function chroma.</span></span> <span data-ttu-id="16d48-286">La variante si ridimensiona lungo le linee della luminosità costante.</span><span class="sxs-lookup"><span data-stu-id="16d48-286">The variant scales along lines of constant lightness.</span></span>

### <a name="the-case-of-single-gamut-shell"></a><span data-ttu-id="16d48-287">Il caso della shell della gamma singola</span><span class="sxs-lookup"><span data-stu-id="16d48-287">The case of single gamut shell</span></span>

<span data-ttu-id="16d48-288">È utile esaminare l'algoritmo nel caso in cui GBDs di origine e di destinazione abbiano solo una shell gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-288">It is helpful to review the algorithm in the case where both source and destination GBDs have only one gamut shell.</span></span> <span data-ttu-id="16d48-289">In questo caso, l'algoritmo è costituito dai calcoli seguenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-289">In this case, the algorithm consists of the following calculations.</span></span>

<span data-ttu-id="16d48-290">Eseguire innanzitutto il mapping della luminosità iniziale usando la formula seguente:</span><span class="sxs-lookup"><span data-stu-id="16d48-290">First, perform initial lightness mapping using the following formula:</span></span>

![Mostra la formula per il mapping della luminosità iniziale.](images/gmmp-image012.png) <span data-ttu-id="16d48-292">(1)</span><span class="sxs-lookup"><span data-stu-id="16d48-292">(1)</span></span>

<span data-ttu-id="16d48-293">dove *j ₒ* è la luce originale e *j <sub>R</sub>* è la luminosità della riproduzione.</span><span class="sxs-lookup"><span data-stu-id="16d48-293">where *Jₒ* is the original lightness and *J<sub>R</sub>* is the reproduction lightness.</span></span>

![Mostra la seconda formula di mapping di luminosità.](images/gmmp-image014.png) <span data-ttu-id="16d48-295">(2)</span><span class="sxs-lookup"><span data-stu-id="16d48-295">(2)</span></span>

<span data-ttu-id="16d48-296">Quando il limite della gamma di origine è monocromatico, il valore Chroma sarà zero per il limite monocromatico a causa dell'allineamento dell'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-296">When the source gamut boundary is monochrome, the chroma value will be zero for the monochrome boundary due to neutral axis alignment.</span></span> <span data-ttu-id="16d48-297">Questa operazione comporterà il caso di degenerazione dove C è uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="16d48-297">This will result in the degenerate case where C is equal to zero.</span></span> <span data-ttu-id="16d48-298">In questo caso, *p <sub>C</sub>* viene impostato su 1.</span><span class="sxs-lookup"><span data-stu-id="16d48-298">In this case, *p<sub>C</sub>* is set to 1.</span></span>

<span data-ttu-id="16d48-299">*p <sub>C</sub>* è un fattore di ponderazione dipendente da Chroma (Morovic, 1998) che dipende dal Chroma del colore originale, C e J sono *il <sub></sub>* risultato della luminosità originale di cui viene eseguito il mapping mediante una funzione sigmoidal.</span><span class="sxs-lookup"><span data-stu-id="16d48-299">*p <sub>C</sub>* is a chroma-dependent weighting factor (Morovic, 1998) that depends on the chroma of the original color, C and *J<sub>S</sub>* are the result of the original lightness being mapped using a sigmoidal function.</span></span>

 

<span data-ttu-id="16d48-300">Per calcolare *J <sub>S</sub>* (Braun e Fairchild, 1999), una tabella di ricerca unidimensionale (LUT) tra i valori originali e la luminosità della riproduzione viene prima configurata in base a una o più funzioni normali cumulative discrete.</span><span class="sxs-lookup"><span data-stu-id="16d48-300">To calculate *J<sub>S</sub>* (Braun and Fairchild, 1999), a one-dimensional lookup table (LUT) between original and reproduction lightness values is first set up on the basis of a discrete cumulative normal function (S).</span></span>

![Mostra una formula per il calcolo di J s.](images/gmmp-image016.png) <span data-ttu-id="16d48-302">(3)</span><span class="sxs-lookup"><span data-stu-id="16d48-302">(3)</span></span>

<span data-ttu-id="16d48-303">dove x ₀ e S sono rispettivamente la media e la deviazione standard della distribuzione normale e *i* = 0, 1, 2... *m*,*m* è il numero di punti usato in LUT.</span><span class="sxs-lookup"><span data-stu-id="16d48-303">where x ₀ and S are the mean and standard deviation of the normal distribution respectively and *i* = 0,1,2... *m*,*m* is the number of points used in the LUT.</span></span> <span data-ttu-id="16d48-304">*I <sub></sub> è il* valore della funzione normale cumulativa *per la*  / percentuale *m* .</span><span class="sxs-lookup"><span data-stu-id="16d48-304">*S <sub>i</sub>* is the value of the cumulative normal function for *i* /*m* percent.</span></span> <span data-ttu-id="16d48-305">I parametri dipendono dalla luminosità del punto nero del gamut di riproduzione e possono essere interpolati dalla tabella 1.</span><span class="sxs-lookup"><span data-stu-id="16d48-305">The parameters depend on the lightness of the black point of the reproduction gamut and can be interpolated from Table 1.</span></span> <span data-ttu-id="16d48-306">Per informazioni dettagliate sul calcolo di questi parametri, vedere Braun e Fairchild (1999, p.</span><span class="sxs-lookup"><span data-stu-id="16d48-306">For details of calculating these parameters see Braun and Fairchild (1999, p.</span></span> <span data-ttu-id="16d48-307">391).</span><span class="sxs-lookup"><span data-stu-id="16d48-307">391).</span></span>

:::row:::
    :::column:::
        <span data-ttu-id="16d48-308">J <sub>minOut</sub></span><span class="sxs-lookup"><span data-stu-id="16d48-308">J <sub>minOut</sub></span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="16d48-309">5.0</span><span class="sxs-lookup"><span data-stu-id="16d48-309">5.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-310">10,0</span><span class="sxs-lookup"><span data-stu-id="16d48-310">10.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-311">15.0</span><span class="sxs-lookup"><span data-stu-id="16d48-311">15.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-312">20,0</span><span class="sxs-lookup"><span data-stu-id="16d48-312">20.0</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="16d48-313">₀ x</span><span class="sxs-lookup"><span data-stu-id="16d48-313">x ₀</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="16d48-314">53,7</span><span class="sxs-lookup"><span data-stu-id="16d48-314">53.7</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-315">56,8</span><span class="sxs-lookup"><span data-stu-id="16d48-315">56.8</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-316">58,2</span><span class="sxs-lookup"><span data-stu-id="16d48-316">58.2</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-317">60,6</span><span class="sxs-lookup"><span data-stu-id="16d48-317">60.6</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="16d48-318">S</span><span class="sxs-lookup"><span data-stu-id="16d48-318">S</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="16d48-319">43,0</span><span class="sxs-lookup"><span data-stu-id="16d48-319">43.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-320">40,0</span><span class="sxs-lookup"><span data-stu-id="16d48-320">40.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-321">35.0</span><span class="sxs-lookup"><span data-stu-id="16d48-321">35.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="16d48-322">34.5</span><span class="sxs-lookup"><span data-stu-id="16d48-322">34.5</span></span>
    :::column-end:::
:::row-end:::


<span data-ttu-id="16d48-323">**Tabella 1** : calcolo del parametro di compressione della luminosità BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="16d48-323">**Table 1** : BasicPhoto lightness compression parameter calculation</span></span>

<span data-ttu-id="16d48-324">Per usare S come un mapping di luminosità LUT (S <sub>LUT</sub> ), è necessario prima normalizzarlo nell'intervallo di luminosità di \[ 0100 \] .</span><span class="sxs-lookup"><span data-stu-id="16d48-324">To use S as a lightness mapping LUT (S <sub>LUT</sub> ) it must first be normalized into the lightness range of \[0,100\].</span></span> <span data-ttu-id="16d48-325">I dati normalizzati vengono quindi ridimensionati nell'intervallo dinamico del dispositivo di destinazione, come illustrato nell'equazione 4, dove *j*<sub>min \ *out*</sub> e *j*<sub>Max \ *out*</sub> sono i valori della leggerezza del punto nero e il punto bianco del supporto di riproduzione, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="16d48-325">The normalized data is then scaled into the dynamic range of the destination device, as shown in Equation 4, where *J*<sub>min\ *Out*</sub> and *J*<sub>max\ *Out*</sub> are the values of lightness of the black point and the white point of the reproduction medium, respectively.</span></span>

![Mostra la formula per S come LUT di mapping di luminosità.](images/gmmp-image018.png) <span data-ttu-id="16d48-327">(4)</span><span class="sxs-lookup"><span data-stu-id="16d48-327">(4)</span></span>

<span data-ttu-id="16d48-328">A questo punto, è possibile ottenere i valori di *j* dalla <sub>LUT</sub> eseguendo l'interpolazione tra i punti *m* dei corrispondenti *j o '* e *j s* valori in esso contenuti e usando l'equazione seguente come input.</span><span class="sxs-lookup"><span data-stu-id="16d48-328">At this point, the *J S* values can be obtained from the S <sub>LUT</sub> by interpolating between the *m* points of corresponding *J O'* and *J S* values it contains, and using the following equation as the input.</span></span>

![Mostra la formula per ottenere i valori di J.](images/gmmp-image020.png) <span data-ttu-id="16d48-330">(5)</span><span class="sxs-lookup"><span data-stu-id="16d48-330">(5)</span></span>

<span data-ttu-id="16d48-331">J <sub>Minin</sub> è il valore di luminosità del punto nero del supporto originale, j <sub>Maxin</sub> è il valore di luminosità del punto bianco del supporto originale e j <sub>O</sub> è la luce originale.</span><span class="sxs-lookup"><span data-stu-id="16d48-331">J <sub>minIn</sub> is the lightness value of the black point of the original medium, J <sub>maxIn</sub> is the lightness value of the white point of the original medium, and J <sub>O</sub> is the original lightness.</span></span> <span data-ttu-id="16d48-332">Per riferimento futuro, è possibile indicare a *S* la funzione sigmoidal definita nel modo appena descritto, come illustrato nella figura 4 riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="16d48-332">For later reference, you can denote by *S* the sigmoidal function defined in the manner just outlined, as illustrated in the following Figure 4.</span></span>

![Diagramma che mostra il grafico per il mapping croma lungo la luce costante.](images/gmmp-image024.png)

<span data-ttu-id="16d48-334">**Figura 4** : mapping di Chroma lungo la luminosità costante</span><span class="sxs-lookup"><span data-stu-id="16d48-334">**Figure 4** : Chroma mapping along constant lightness</span></span>

<span data-ttu-id="16d48-335">In secondo luogo, se il limite della gamma di destinazione è cromatico, comprimere Chroma lungo le linee della luminosità costante (l) ed eseguire la compressione come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="16d48-335">Second, if the destination gamut boundary is chromatic, compress chroma along lines of constant lightness (l) and perform the compression as follows.</span></span>

![Mostra la formula per eseguire la compressione Chroma.](images/gmmp-image026.png) <span data-ttu-id="16d48-337"> (6)</span><span class="sxs-lookup"><span data-stu-id="16d48-337">(6)</span></span>

<span data-ttu-id="16d48-338">dove *d* rappresenta la distanza da *E* in *l*; *g* rappresenta il limite della gamma media; *r* rappresenta la riproduzione. e *o* la figura 5 originale.</span><span class="sxs-lookup"><span data-stu-id="16d48-338">where *d* represents distance from *E* on *l*;*g* represents the medium gamut boundary; *r* represents the reproduction; and *o* the original Figure 5.</span></span>

![Diagramma che mostra il grafico per la compressione Chroma e Light in BasicPhoto.](images/gmmp-image028.png)

<span data-ttu-id="16d48-340">**Figura 5** : compressione Chroma e lightity in BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="16d48-340">**Figure 5** : Chroma and lightness compression in BasicPhoto</span></span>

<span data-ttu-id="16d48-341">Se il limite della gamma di destinazione è monocromatico, il valore Chroma viene ritagliato a zero.</span><span class="sxs-lookup"><span data-stu-id="16d48-341">If the destination gamut boundary is monochrome, then the chroma value is clipped to zero.</span></span>

<span data-ttu-id="16d48-342">In terzo luogo, usare un clip tritato (descritto in precedenza) per eliminare eventuali errori residui.</span><span class="sxs-lookup"><span data-stu-id="16d48-342">Third, use a MinCD clip (described earlier) to eliminate any residual error.</span></span>

### <a name="black-enhancement"></a><span data-ttu-id="16d48-343">Miglioramento nero</span><span class="sxs-lookup"><span data-stu-id="16d48-343">Black enhancement</span></span>

<span data-ttu-id="16d48-344">L'algoritmo precedente può essere modificato per migliorare il nero quando la destinazione è un dispositivo di stampa.</span><span class="sxs-lookup"><span data-stu-id="16d48-344">The preceding algorithm can be modified to improve the black when the destination is a printer device.</span></span> <span data-ttu-id="16d48-345">Il problema ha a che fare con la scelta di *J <sub>minOut</sub>*, che in genere non corrisponde al colore più scuro che una stampante può produrre.</span><span class="sxs-lookup"><span data-stu-id="16d48-345">The issue has to do with the choice of *J<sub>minOut</sub>*, which usually does not correspond to the darkest color a printer can produce.</span></span>

<span data-ttu-id="16d48-346">In particolare, il colore con densità più elevata, ottenuto inserendo inchiostri 100% (o massima copertura possibile, se è attiva la limitazione di GCR/Ink), in genere non è "neutral" nello spazio di aspetto dei colori.</span><span class="sxs-lookup"><span data-stu-id="16d48-346">More specifically, the color with highest density, obtained by putting 100 percent inks (or maximum possible coverage, if GCR/ink limiting is in effect), is usually not "neutral" in the color appearance space.</span></span> <span data-ttu-id="16d48-347">Vedere la figura 6.</span><span class="sxs-lookup"><span data-stu-id="16d48-347">See Figure 6.</span></span> <span data-ttu-id="16d48-348">In altre parole, se per il dispositivo di destinazione viene usata la luminosità minima neutra, la luce scaler costruita verrà mappata a una leggerezza minima che non è la densità più elevata che può essere conseguita dalla stampante.</span><span class="sxs-lookup"><span data-stu-id="16d48-348">In other words, if neutral minimum lightness is used for the destination device, the lightness scaler constructed will map to a minimum lightness that is not the highest density that can be achieved by the printer.</span></span> <span data-ttu-id="16d48-349">Considerare il caso di utilizzo ulteriore di monitor per la stampante.</span><span class="sxs-lookup"><span data-stu-id="16d48-349">Consider the further use case of monitor to printer.</span></span> <span data-ttu-id="16d48-350">Il monitoraggio nero, R = G = B = 0, verrà quindi stampato come non la densità più elevata.</span><span class="sxs-lookup"><span data-stu-id="16d48-350">The monitor black, R=G=B=0, will then be printed as not the highest density.</span></span> <span data-ttu-id="16d48-351">L'effetto sulla qualità dell'immagine è la mancanza di profondità e contrasto.</span><span class="sxs-lookup"><span data-stu-id="16d48-351">The impact on the image quality is that there is a lack of depth and contrast.</span></span>

![Diagramma che Mostra come il punto nero del dispositivo potrebbe essere più scuro della luminosità minima neutra.](images/gmmp-seqfigure01.png)

<span data-ttu-id="16d48-353">**Figura 6** : il punto nero del dispositivo può essere più scuro della luminosità minima neutra.</span><span class="sxs-lookup"><span data-stu-id="16d48-353">**Figure 6** : The device black point may be darker than the neutral minimum lightness.</span></span>

<span data-ttu-id="16d48-354">Si supponga che il "punto nero del dispositivo" di destinazione sia Jkakbk/JkCkh k.</span><span class="sxs-lookup"><span data-stu-id="16d48-354">Suppose the destination "device black point" is Jₖaₖbₖ/JₖCₖh ₖ.</span></span> <span data-ttu-id="16d48-355">Se C k è diverso da zero, il punto nero del dispositivo non è neutro rispetto a CAM02.</span><span class="sxs-lookup"><span data-stu-id="16d48-355">If C ₖ is not zero, then the device black point is not neutral relative to CAM02.</span></span> <span data-ttu-id="16d48-356">Se si usa J k per la "luminosità minima neutra" della destinazione nella costruzione del scaler di luminosità; ovvero impostando</span><span class="sxs-lookup"><span data-stu-id="16d48-356">If you use J ₖ for the destination "neutral minimum lightness" in the construction of the lightness scaler; that is, setting</span></span>

<span data-ttu-id="16d48-357">*J <sub>minOut</sub> = JK*</span><span class="sxs-lookup"><span data-stu-id="16d48-357">*J<sub>minOut</sub> = Jₖ*</span></span>

<span data-ttu-id="16d48-358">e applicarlo alla shell della gamma di origine, è possibile ottenere la configurazione illustrata nella figura 7.</span><span class="sxs-lookup"><span data-stu-id="16d48-358">and apply it to the source gamut shell, you obtain the configuration depicted in Figure 7.</span></span> <span data-ttu-id="16d48-359">Nella figura il piano Hue corrisponde a h k.</span><span class="sxs-lookup"><span data-stu-id="16d48-359">In the figure, the hue plane corresponds to h ₖ.</span></span>

![Diagramma che mostra il ridimensionamento della luminosità modificato con il punto nero del dispositivo di destinazione.](images/gmmp-seqfigure02.png)

<span data-ttu-id="16d48-361">**Figura 7** : geometria usando il ridimensionamento della luminosità modificato con il punto nero del dispositivo di destinazione</span><span class="sxs-lookup"><span data-stu-id="16d48-361">**Figure 7** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="16d48-362">Per consentire il proseguimento dell'algoritmo di compressione Chroma successivo, è necessario allineare le lightnesses massime e minime nelle shell di origine e di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-362">To allow the subsequent chroma compression algorithm to proceed, you want to align the maximum and minimum lightnesses on the source and destination shells.</span></span> <span data-ttu-id="16d48-363">Questa operazione può essere eseguita modificando la shell di destinazione tra J <sub>neutralMin</sub> e j k spostando i punti verso sinistra.</span><span class="sxs-lookup"><span data-stu-id="16d48-363">This can be achieved by adjusting the destination shell between J <sub>neutralMin</sub> and J ₖ by shifting points to the left.</span></span> <span data-ttu-id="16d48-364">Inoltre, questa trasformazione deve essere applicata all'intero spazio jab, non solo al piano di tonalità corrispondente a h k.</span><span class="sxs-lookup"><span data-stu-id="16d48-364">Furthermore, this transformation must be applied on the whole Jab space, not just the hue plane corresponding to h ₖ.</span></span>

<span data-ttu-id="16d48-365">La trasformazione è</span><span class="sxs-lookup"><span data-stu-id="16d48-365">The transformation is</span></span>

![Mostra la formula per la trasformazione.](images/gmmp-seqfigure03.png)

<span data-ttu-id="16d48-367">Nella figura 8 viene illustrato l'effetto della trasformazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-367">Figure 8 shows the effect of the transformation.</span></span>

![Diagramma che illustra l'effetto del ridimensionamento della luminosità modificato con il punto nero del dispositivo di destinazione.](images/gmmp-seqfigure04.png)

<span data-ttu-id="16d48-369">**Figura 8** : geometria usando il ridimensionamento della luminosità modificato con il punto nero del dispositivo di destinazione</span><span class="sxs-lookup"><span data-stu-id="16d48-369">**Figure 8** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="16d48-370">Dopo aver applicato il consueto algoritmo di compressione Chroma, il punto deve essere "spostato indietro", ovvero è necessario applicare la trasformazione inversa per ottenere il colore finale mappato.</span><span class="sxs-lookup"><span data-stu-id="16d48-370">After applying the usual chroma compression algorithm, the point must then be "shifted back;" that is, the inverse transformation must be applied to obtain the final mapped color.</span></span>

![Mostra la formula per la trasformazione inversa per ottenere il colore finale mappato.](images/gmmp-seqfigure05.png)

### <a name="the-case-of-dual-gamut-shells"></a><span data-ttu-id="16d48-372">Il caso di Shell Dual gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-372">The case of dual gamut shells</span></span>

<span data-ttu-id="16d48-373">L'obiettivo consiste nel generalizzare il \_ ginocchio sig per la shell a gamma singola, nel caso in cui il dispositivo di origine GBD o il dispositivo di destinazione GBD disponga di una struttura a due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-373">The goal is to generalize SIG\_KNEE for single gamut shell to the case where either the source device GBD or the destination device GBD has a two-shell structure.</span></span> <span data-ttu-id="16d48-374">La shell interna verrà denominata Shell di riferimento, mentre la shell esterna verrà chiamata Shell plausibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-374">The inner shell will be called the Reference Shell, while the outer shell will be called the Plausible Shell.</span></span> <span data-ttu-id="16d48-375">Si desidera considerare i casi seguenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-375">You want to consider the following cases.</span></span>

<span data-ttu-id="16d48-376">(a) sia la GBD di origine che la GBD di destinazione hanno una struttura a due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-376">(a) Both the source GBD and destination GBD have a two-shell structure.</span></span>

<span data-ttu-id="16d48-377">(b) il GBD di origine dispone di una struttura a due Shell. il GBD di destinazione ha una sola Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-377">(b) The source GBD has a two-shell structure; the destination GBD has only one shell.</span></span>

<span data-ttu-id="16d48-378">(c) il GBD di origine ha una sola Shell; la GBD di destinazione ha una struttura a due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-378">(c) The source GBD has only one shell; the destination GBD has a two-shell structure.</span></span>

<span data-ttu-id="16d48-379">(d) la GBD di origine e la GBD di destinazione hanno solo una shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-379">(d) Both the source GBD and destination GBD have only one shell.</span></span>

<span data-ttu-id="16d48-380">Il caso (d) è il caso di una shell a gamma singola descritta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-380">Case (d) is the case of single gamut shell that was discussed previously.</span></span> <span data-ttu-id="16d48-381">Per i casi (a), (b) e (c), è possibile generalizzare il ridimensionamento della luminosità per usare le informazioni aggiuntive della struttura Dual Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-381">For cases (a), (b), and (c), you can generalize the lightness rescaling to use the extra information from the dual shell structure.</span></span> <span data-ttu-id="16d48-382">Nei casi (b) e (c) in cui l'origine o la destinazione dispone solo di una shell, viene introdotta una "shell di riferimento indotta" che verrà descritta in una sezione successiva, "indotta shell di riferimento".</span><span class="sxs-lookup"><span data-stu-id="16d48-382">In cases (b) and (c) where either the source or the destination has only one shell, you introduce an "induced reference shell" which will be discussed in a subsequent section, "Induced Reference Shell."</span></span> <span data-ttu-id="16d48-383">L'algoritmo generale per due Shell verrà descritto per i casi (a).</span><span class="sxs-lookup"><span data-stu-id="16d48-383">The general algorithm for two shells will be described for case (a).</span></span> <span data-ttu-id="16d48-384">Dopo la spiegazione della costruzione della shell di riferimento indotta, l'algoritmo può essere applicato anche a case (b) e (c).</span><span class="sxs-lookup"><span data-stu-id="16d48-384">After the Induced Reference Shell construction is explained, the algorithm can be applied to case (b) and (c), as well.</span></span> <span data-ttu-id="16d48-385">Come per la compressione Chroma, il rapporto di compressione sarà determinato dalle shell più grandi disponibili.</span><span class="sxs-lookup"><span data-stu-id="16d48-385">As for chroma compression, the compression ratio will be determined by the largest shells available.</span></span> <span data-ttu-id="16d48-386">In altre parole, se sono disponibili sia la shell plausibile che la shell di riferimento, verrà usata la shell plausibile. in caso contrario, verrà utilizzata la shell di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-386">In other words, if both the Plausible Shell and Reference Shell are available, the Plausible Shell will be used; otherwise, the Reference Shell will be used.</span></span>

<span data-ttu-id="16d48-387">*Ridimensionamento della luminosità generalizzato*</span><span class="sxs-lookup"><span data-stu-id="16d48-387">*Generalized Lightness Rescaling*</span></span>

<span data-ttu-id="16d48-388">L'esistenza di due Shell per GBD di origine e di destinazione significa che è necessario eseguire il mapping di un set di quattro punti dall'origine GBD a un set corrispondente nel GBD di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-388">The existence of two shells for both source and destination GBD means that you must map a set of four points from the source GBD to a corresponding set in the destination GBD.</span></span>

![Viene illustrato come eseguire il mapping di un set di quattro punti a un set corrispondente.](images/gmmp-image030.png)

<span data-ttu-id="16d48-390">Gli indici hanno i significati seguenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-390">The subscripts have the following meanings.</span></span>

<span data-ttu-id="16d48-391">o o r: "originale" (origine) o "riproduzione" (destinazione)</span><span class="sxs-lookup"><span data-stu-id="16d48-391">o or r: "original" (source) or "reproduction" (destination)</span></span>

<span data-ttu-id="16d48-392">min o max: luminosità minima neutra o luminosità massima neutra</span><span class="sxs-lookup"><span data-stu-id="16d48-392">min or max: minimum neutral lightness or maximum neutral lightness</span></span>

<span data-ttu-id="16d48-393">PLA o Ref: Shell plausibile o Shell di riferimento</span><span class="sxs-lookup"><span data-stu-id="16d48-393">pla or ref: Plausible Shell or Reference Shell</span></span>

<span data-ttu-id="16d48-394">L'ordinamento in ogni quadrupla è anche la grandezza relativa prevista di questi punti.</span><span class="sxs-lookup"><span data-stu-id="16d48-394">The ordering in each quadruple is also the expected relative magnitude of these points.</span></span>

<span data-ttu-id="16d48-395">La mappa di ridimensionamento della luminosità usa le stesse prime due equazioni della singola shell, ma *J S* è definito in modo a tratti, come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="16d48-395">The Lightness Rescaling map uses the same first two equations as the single shell, but *J S* is defined in a piecewise manner as follows.</span></span>

![Mostra la formula per J S in modo a tratti.](images/gmmp-image032.png) <span data-ttu-id="16d48-397">(7)</span><span class="sxs-lookup"><span data-stu-id="16d48-397">(7)</span></span>

<span data-ttu-id="16d48-398">In altre parole, è sigmoidal all'interno della shell di riferimento e lineare all'esterno.</span><span class="sxs-lookup"><span data-stu-id="16d48-398">In other words, it is sigmoidal within the reference shell, and linear outside.</span></span> <span data-ttu-id="16d48-399">Vedere Figura 9.</span><span class="sxs-lookup"><span data-stu-id="16d48-399">See Figure 9.</span></span>

![Diagramma che mostra un grafico per la funzione di ridimensionamento della luminosità per GBDs a due Shell.](images/gmmp-image033.png)

<span data-ttu-id="16d48-401">**Figura 9** : funzione di ridimensionamento della luminosità per GBDs a due Shell</span><span class="sxs-lookup"><span data-stu-id="16d48-401">**Figure 9** : Lightness Rescaling function for two-shell GBDs</span></span>

<span data-ttu-id="16d48-402">**SHELL DI RIFERIMENTO INDOTTA**</span><span class="sxs-lookup"><span data-stu-id="16d48-402">**INDUCED REFERENCE SHELL**</span></span>

<span data-ttu-id="16d48-403">Dove un GBD ha una shell e l'altra GBD ha due Shell, è necessario creare una "shell di riferimento" per il GBD con una sola Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-403">Where one GBD has one shell and the other GBD has two shells, you must create a "Reference Shell" for the GBD with only one shell.</span></span> <span data-ttu-id="16d48-404">La shell esistente, che verrebbe denominata Shell di riferimento, verrà modificata nella "Shell plausibile". In realtà, non è necessario creare una shell nello spazio jab completo.</span><span class="sxs-lookup"><span data-stu-id="16d48-404">The existing shell, which would be called the Reference Shell, will be changed to the "Plausible Shell."In fact, you don't actually have to create a shell in the full Jab space.</span></span> <span data-ttu-id="16d48-405">Poiché il ridimensionamento della luminosità usa solo *j max* e *j min*, è necessario costituire solo questi valori per la shell di riferimento indotta.</span><span class="sxs-lookup"><span data-stu-id="16d48-405">Because the lightness rescaling only uses *J max* and *J min*, you only have to make up these values for the induced Reference Shell.</span></span> <span data-ttu-id="16d48-406">Esistono due casi, a seconda del GBD che dispone di due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-406">There are two cases, depending on which GBD has two shells.</span></span>

<span data-ttu-id="16d48-407">Caso 1: il GBD di origine ha due Shell; GBD di destinazione ha una shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-407">Case 1: Source GBD has two shells; destination GBD has one shell.</span></span>

<span data-ttu-id="16d48-408">Determinare la shell di riferimento indotta dalla destinazione sull'asse neutro; ovvero J <sub>r, \ min, \ Ref</sub> e j <sub>r, \ Max, \ Ref</sub> della shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-408">Determine the destination induced Reference Shell on the neutral axis; that is, the J <sub>r,\ min,\ ref</sub> and J <sub>r,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="16d48-409">Questa operazione viene eseguita utilizzando l'algoritmo seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-409">This is done using the following algorithm.</span></span>

![Mostra l'algoritmo per determinare la shell di riferimento indotta dalla destinazione.](images/gmmp-induced01.png)

<span data-ttu-id="16d48-411">I fattori?</span><span class="sxs-lookup"><span data-stu-id="16d48-411">The factors ?</span></span> <span data-ttu-id="16d48-412"><sub>bassa</sub> e?</span><span class="sxs-lookup"><span data-stu-id="16d48-412"><sub>low</sub> and ?</span></span> <span data-ttu-id="16d48-413">controllo <sub>elevato</sub> della separazione tra la shell plausibile e la shell di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-413"><sub>high</sub> control the separation between the Plausible Shell and the Reference Shell.</span></span> <span data-ttu-id="16d48-414">Il valore 1 indica che i valori J <sub>min</sub> o j m ₐ ₓ coincidono.</span><span class="sxs-lookup"><span data-stu-id="16d48-414">A value of 1 means that the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="16d48-415">I valori sono "indotto" dalla shell di riferimento di origine e dalla shell plausibile di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-415">Their values are "induced" from the source Reference Shell and source Plausible Shell.</span></span>

![Mostra la formula per i valori della shell del riferimento di origine e della shell plausibile di origine.](images/gmmp-induced02.png)

<span data-ttu-id="16d48-417">I "fattori di fudge" F <sub>low</sub> e f <sub>High</sub> sono *parametri ottimizzabili* che devono essere compresi tra 0 e 1.</span><span class="sxs-lookup"><span data-stu-id="16d48-417">The "fudge factors" F <sub>low</sub> and F <sub>high</sub> are *tunable parameters* that must lie between 0 and 1.</span></span> <span data-ttu-id="16d48-418">Se il valore è 0, il valore di J <sub>min</sub> o j m ₐ ₓ viene direttamente indotto dalle shell di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-418">If the value is 0, then the J <sub>min</sub> or J ₘₐₓ are directly induced from the source shells.</span></span> <span data-ttu-id="16d48-419">Per questo caso, scegliere F <sub>low</sub> = 0,95 e f <sub>High</sub> = 0,1.</span><span class="sxs-lookup"><span data-stu-id="16d48-419">For this case, choose F <sub>low</sub> = 0.95, and F <sub>high</sub> = 0.1.</span></span>

<span data-ttu-id="16d48-420">Caso 2: l'origine GBD dispone di una shell; GBD di destinazione ha due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-420">Case 2: Source GBD has one shell; destination GBD has two shells.</span></span>

<span data-ttu-id="16d48-421">Determinare la shell di riferimento indotta dall'origine sull'asse neutro; ovvero J <sub>o, \ min, \ Ref</sub> e j <sub>o, \ Max, \ Ref</sub> della shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-421">Determine the source induced Reference Shell on the neutral axis; that is, the J <sub>o,\ min,\ ref</sub> and J <sub>o,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="16d48-422">Questa operazione viene eseguita utilizzando l'algoritmo seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-422">This is done using the following algorithm.</span></span>

![Mostra l'algoritmo per determinare la shell di riferimento indotta dalla destinazione sull'asse neutro.](images/gmmp-induced03.png)

<span data-ttu-id="16d48-424">Anche in questo caso, i fattori?</span><span class="sxs-lookup"><span data-stu-id="16d48-424">Again, the factors ?</span></span> <span data-ttu-id="16d48-425"><sub>bassa</sub> e?</span><span class="sxs-lookup"><span data-stu-id="16d48-425"><sub>low</sub> and ?</span></span> <span data-ttu-id="16d48-426">controllo <sub>elevato</sub> della separazione tra la shell plausibile e la shell di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-426"><sub>high</sub> control the separation between the Plausible Shell and Reference Shell.</span></span> <span data-ttu-id="16d48-427">Il valore 1 indica che i valori J <sub>min</sub> o j m ₐ ₓ coincidono.</span><span class="sxs-lookup"><span data-stu-id="16d48-427">A value of 1 means the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="16d48-428">I valori sono "indotto" dalla shell di riferimento di origine e dalla shell plausibile di origine:</span><span class="sxs-lookup"><span data-stu-id="16d48-428">Their values are "induced" from the source Reference Shell and source Plausible Shell:</span></span>

![Mostra l'algoritmo per controllare la separazione tra la shell di riferimento e la shell plausibile di origine.](images/gmmp-induced04.png)

### <a name="reasons-for-changes-from-the-cie-tc8-03-recommendations"></a><span data-ttu-id="16d48-430">Motivi per le modifiche apportate ai consigli CIE TC8-03</span><span class="sxs-lookup"><span data-stu-id="16d48-430">Reasons for changes from the CIE TC8-03 recommendations</span></span>

<span data-ttu-id="16d48-431">BasicPhoto differisce dalle raccomandazioni CIE TC8-03 nei modi seguenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-431">BasicPhoto differs from the CIE TC8-03 recommendations in the following ways.</span></span>

1.  <span data-ttu-id="16d48-432">Chroma non viene compresso verso la cuspide ma lungo le linee di luminosità costante.</span><span class="sxs-lookup"><span data-stu-id="16d48-432">Chroma is not compressed toward the cusp but along lines of constant lightness.</span></span>
2.  <span data-ttu-id="16d48-433">L'intervallo di luminosità usa la luminosità del colore più scuro nella gamma anziché il punto in corrispondenza del quale il limite della gamut supera l'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-433">The lightness range uses the lightness of the darkest color in the gamut rather than the point at which the gamut boundary crosses the neutral axis.</span></span>
3.  <span data-ttu-id="16d48-434">BasicPhoto supporta sia una shell gamut di riferimento sia una shell della gamma plausibile, se uno dei limiti della gamma nella trasformazione è costituito da due Shell.</span><span class="sxs-lookup"><span data-stu-id="16d48-434">BasicPhoto supports both a reference gamut shell and a plausible gamut shell, if either gamut boundary in the transform has two shells.</span></span>
4.  <span data-ttu-id="16d48-435">BasicPhoto USA CIECAM02; anziché usare CIECAM97s per eseguire la conversione in D65 a 400 CD/m2, quindi usare lo spazio dei colori RIT IPT.</span><span class="sxs-lookup"><span data-stu-id="16d48-435">BasicPhoto uses CIECAM02; instead of using CIECAM97s to convert to D65 at 400 cd/m2, and then using RIT IPT color space.</span></span>

<span data-ttu-id="16d48-436">La prima modifica è stata apportata per evitare problemi di inversione dei toni che possono verificarsi quando si usa la compressione verso un cuspide.</span><span class="sxs-lookup"><span data-stu-id="16d48-436">The first change was made to prevent tone inversion problems that can occur when using compression toward a cusp.</span></span> <span data-ttu-id="16d48-437">Come illustrato nella figura 10, la compressione cuspide può causare inversioni di tono.</span><span class="sxs-lookup"><span data-stu-id="16d48-437">As shown in Figure 10, cusp compression can cause tone inversions.</span></span> <span data-ttu-id="16d48-438">Questo problema può verificarsi quando i colori della croma alta sono più chiari dei colori della croma inferiore.</span><span class="sxs-lookup"><span data-stu-id="16d48-438">This can happen when colors of high chroma are lighter than colors of lower chroma.</span></span> <span data-ttu-id="16d48-439">Poiché SGCK comprime ogni pixel in modo indipendente sia nella luminosità che nel Chroma, non è garantita la conservazione della relazione di luminosità tra i valori dei pixel dopo la compressione.</span><span class="sxs-lookup"><span data-stu-id="16d48-439">Because SGCK compresses each pixel independently in both lightness and chroma, it is not guaranteed to preserve the lightness relationship between the pixel values after the compression.</span></span> <span data-ttu-id="16d48-440">Lo svantaggio noto a questa decisione di comprimere le linee di leggerezza costante è che è possibile soffrire di perdite di Chroma, in particolare nelle aree in cui il limite della gamma di destinazione è molto semplice, come avviene con gialli luminosi.</span><span class="sxs-lookup"><span data-stu-id="16d48-440">The well-known downside to this decision to compress on lines of constant lightness is that you can suffer losses of chroma, particular in areas where the destination gamut boundary is very flat, as happens with bright yellows.</span></span>

![Diagramma che mostra l'inversione del tono causata da SGCK.](images/gmmp-toneinversion.png)

<span data-ttu-id="16d48-442">**Figura 10** : inversione del tono causata da SGCK</span><span class="sxs-lookup"><span data-stu-id="16d48-442">**Figure 10** : Tone inversion caused by SGCK</span></span>

![Mostra un'immagine originale di una teiera.](images/originalteapot.jpg)![Mostra il risultato SGCK dell'immagine della teiera.](images/badteapot.jpg)![Mostra il risultato BasicPhoto dell'immagine della teiera.](images/betterteapot.jpg)

<span data-ttu-id="16d48-446">**Figura 11** : immagine originale, risultato SGCK e risultato BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="16d48-446">**Figure 11** : Original image, SGCK result, and BasicPhoto result</span></span>

<span data-ttu-id="16d48-447">Nella figura 11 è illustrata questa inversione del tono.</span><span class="sxs-lookup"><span data-stu-id="16d48-447">Figure 11 illustrates this tone inversion.</span></span> <span data-ttu-id="16d48-448">A sinistra è presente un'immagine originale acquisita da una fotocamera digitale; al centro, immagine riprodotta da SGCK; e a destra, l'immagine riprodotta da BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="16d48-448">On the left is an original image captured by a digital camera; in the center, the image as reproduced by SGCK; and on the right, the image as reproduced by BasicPhoto.</span></span> <span data-ttu-id="16d48-449">L'immagine a sinistra si trova nello spazio colore della fotocamera digitale, le immagini al centro e a destra si trovano nello spazio dei colori di uno schermo LCD.</span><span class="sxs-lookup"><span data-stu-id="16d48-449">The image on the left is in the digital camera's color space, the center and right images are in the color space of an LCD video display.</span></span> <span data-ttu-id="16d48-450">Nell'immagine originale la parte superiore della teiera è più scura della parte inferiore, perché la parte inferiore riflette la tovaglia su cui si trova.</span><span class="sxs-lookup"><span data-stu-id="16d48-450">In the original image, the top part of the teapot is darker than the bottom, because the bottom is reflecting the tablecloth that it is sitting upon.</span></span> <span data-ttu-id="16d48-451">Nell'immagine SGCK la parte superiore è effettivamente più chiara della parte inferiore, a causa dell'inversione del tono.</span><span class="sxs-lookup"><span data-stu-id="16d48-451">In the SGCK image, the top part is actually lighter than the bottom, because of the tone inversion.</span></span> <span data-ttu-id="16d48-452">Inoltre, è difficile vedere gli elementi riflessi nella parte inferiore della teiera.</span><span class="sxs-lookup"><span data-stu-id="16d48-452">Also, it is difficult to see the items reflected in the lower part of the teapot.</span></span> <span data-ttu-id="16d48-453">A destra, BasicPhoto ha corretto l'inversione del tono e gli articoli riflessi sono più chiaramente distinguibili.</span><span class="sxs-lookup"><span data-stu-id="16d48-453">On the right, BasicPhoto has fixed the tone inversion and the reflected articles are more clearly distinguishable.</span></span>

<span data-ttu-id="16d48-454">La seconda modifica è stata apportata per migliorare la riproduzione dei colori quasi neri sulle stampanti in cui il nero nero non rientra direttamente sull'asse CIECAM02 neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-454">The second change was made to improve the reproduction of nearly black colors on printers where the blackest black does not fall directly on the CIECAM02 neutral axis.</span></span> <span data-ttu-id="16d48-455">Nella figura 12 riportata di seguito viene illustrata un'immagine convertita in sRGB; riprodotto per una stampante inkjet RGB con SGCK; e riprodotto per la stessa stampante usando BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="16d48-455">The following Figure 12 shows an image converted to sRGB; reproduced for an RGB inkjet printer using SGCK; and reproduced for the same printer using BasicPhoto.</span></span> <span data-ttu-id="16d48-456">L'immagine al centro non usa il nero completo del dispositivo e pertanto manca il contrasto riscontrato nell'originale.</span><span class="sxs-lookup"><span data-stu-id="16d48-456">The image in the center is not using the full device black, and so it lacks the contrast seen in the original.</span></span> <span data-ttu-id="16d48-457">Il contrasto viene ripristinato con BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="16d48-457">The contrast is restored with BasicPhoto.</span></span>

![Mostra l'immagine originale di un complay.](images/playstructure.jpg)![Mostra l'immagine del gioco riprodotto per una stampante inkjet R G B con SGCK.](images/playstructurebad.jpg)![Mostra l'immagine del gioco riprodotto per una stampante inkjet R G B con BasicPhoto.](images/betterplaystructure.jpg)

<span data-ttu-id="16d48-461">**Figura 12** : nero avanzato</span><span class="sxs-lookup"><span data-stu-id="16d48-461">**Figure 12** : Enhanced black</span></span>

<span data-ttu-id="16d48-462">La terza modifica è stata apportata per migliorare la riproduzione dei colori per le fotocamere digitali.</span><span class="sxs-lookup"><span data-stu-id="16d48-462">The third change was made to improve the color reproduction for digital cameras.</span></span> <span data-ttu-id="16d48-463">In particolare nei casi in cui la fotocamera digitale è stata profilata usando una destinazione di riferimento, una descrizione del limite di gamut basata su colori misurati potrebbe non includere tutti i colori che possono essere acquisiti in una scena reale.</span><span class="sxs-lookup"><span data-stu-id="16d48-463">Particularly in cases where the digital camera has been profiled using a reference target, a gamut boundary description built from measured colors might not include all the colors that might be captured in a real world scene.</span></span> <span data-ttu-id="16d48-464">Anziché ritagliare tutti i colori alla gamma della destinazione dei colori misurata, si consente all'estrapolazione di produrre un limite di gamut plausibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-464">Rather than clipping all colors to the gamut of the measured color target, you allow for extrapolation to produce a plausible gamut boundary.</span></span> <span data-ttu-id="16d48-465">L'algoritmo BasicPhoto è progettato per supportare un limite di gamut estrapolato.</span><span class="sxs-lookup"><span data-stu-id="16d48-465">The BasicPhoto algorithm is designed to support such an extrapolated gamut boundary.</span></span>

<span data-ttu-id="16d48-466">La quarta modifica è stata apportata perché CIECAM02 funziona bene per il mapping di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-466">The fourth change was made because CIECAM02 works well for gamut mapping.</span></span> <span data-ttu-id="16d48-467">Il processo consigliato da TC8-03 per la conversione dei colori del dispositivo in D65 a 400 CD/m2, quindi l'uso dello spazio dei colori del RIT IPT è sia a elevato utilizzo di calcolo che richiede molto tempo.</span><span class="sxs-lookup"><span data-stu-id="16d48-467">The process recommended by TC8-03 of converting device colors to D65 at 400 cd/m2, and then using the RIT IPT color space is both computation-intensive and time-consuming.</span></span>

### <a name="hue-mapping"></a><span data-ttu-id="16d48-468">Mapping tonalità</span><span class="sxs-lookup"><span data-stu-id="16d48-468">Hue mapping</span></span>

<span data-ttu-id="16d48-469">HueMap è l'equivalente della finalità di saturazione ICC.</span><span class="sxs-lookup"><span data-stu-id="16d48-469">HueMap is the equivalent of the ICC Saturation intent.</span></span>

<span data-ttu-id="16d48-470">Se il limite della gamma di origine o il limite della gamma di destinazione non contiene primari, questo modello viene ripristinato nel modello tritato (relativo) descritto in una sezione precedente. ad esempio, i dispositivi per cui non è possibile determinare gli primari (profili ICC con più di quattro canali) o profili ICC monocromi.</span><span class="sxs-lookup"><span data-stu-id="16d48-470">If either the source gamut boundary or the destination gamut boundary does not contain primaries, this model reverts to the MinCD (relative) model described in a preceding section; for example, devices for which the primaries cannot be determined (ICC profiles with more than four channels) or monochrome ICC profiles.</span></span>

<span data-ttu-id="16d48-471">Questo algoritmo regola innanzitutto la tonalità del valore del colore di input.</span><span class="sxs-lookup"><span data-stu-id="16d48-471">This algorithm first adjusts the hue of the input color value.</span></span> <span data-ttu-id="16d48-472">Quindi regola simultaneamente la luminosità e il Chroma, usando un mapping di taglio.</span><span class="sxs-lookup"><span data-stu-id="16d48-472">Then it simultaneously adjusts the lightness and chroma, using a shearing mapping.</span></span> <span data-ttu-id="16d48-473">Infine, viene ritagliato il valore del colore per assicurarsi che si trovi all'interno di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-473">Finally, it clips color value to make sure it is within gamut.</span></span>

<span data-ttu-id="16d48-474">Il primo passaggio consiste nel determinare le "ruote Hue".</span><span class="sxs-lookup"><span data-stu-id="16d48-474">The first step is to determine the "Hue Wheels."</span></span> <span data-ttu-id="16d48-475">Trovare i valori di JCh per i colori primario e secondario per il dispositivo di origine e di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-475">Find the JCh values for primary and secondary colors for both source and destination device.</span></span> <span data-ttu-id="16d48-476">Si stanno prendendo in considerazione solo i componenti Hue.</span><span class="sxs-lookup"><span data-stu-id="16d48-476">You are only considering the hue components.</span></span> <span data-ttu-id="16d48-477">In questo modo viene generata una rotellina di tonalità primaria o secondaria con sei punti di colore per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-477">This results in a primary or secondary hue wheel with six color points for each device.</span></span> <span data-ttu-id="16d48-478">(Vedere la figura 13).</span><span class="sxs-lookup"><span data-stu-id="16d48-478">(See Figure 13.)</span></span>

![Diagramma che mostra le ruote Hue con sei punti di colore.](images/gmmp-figure12.png)

<span data-ttu-id="16d48-480">**Figura 13** : rotelle Hue</span><span class="sxs-lookup"><span data-stu-id="16d48-480">**Figure 13** : Hue wheels</span></span>

<span data-ttu-id="16d48-481">È possibile ottenere risultati migliori se l'origine blu primaria non viene ruotata nel database primario blu di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-481">Better results can be obtained if the source blue primary is not rotated to the destination blue primary.</span></span> <span data-ttu-id="16d48-482">L'angolo di tonalità primario blu di origine viene invece usato come angolo di tonalità principale blu di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-482">Instead, the source blue primary hue angle is used as the destination blue primary hue angle.</span></span>

<span data-ttu-id="16d48-483">Successivamente, eseguire le rotazioni tonalità per ogni colore di input dall'immagine di origine,</span><span class="sxs-lookup"><span data-stu-id="16d48-483">Next, perform the hue rotations for each input color from the source image,</span></span>

<span data-ttu-id="16d48-484">a) utilizzando l'angolo di sfumatura del colore di input, determinare la posizione del colore sulla rotellina di tonalità di origine rispetto al colore primario o secondario di due adiacenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-484">a)Using the hue angle of the input color, determine the location of the color on the source hue wheel relative to the two adjacent primary or secondary color.</span></span> <span data-ttu-id="16d48-485">La posizione può essere considerata come una percentuale della distanza tra le primarie.</span><span class="sxs-lookup"><span data-stu-id="16d48-485">The location can be thought of as a percentage of the distance between the primaries.</span></span> <span data-ttu-id="16d48-486">Ad esempio, la tonalità di colore di input è il 40% della strada dal valore di tonalità di Magenta al valore di tonalità di rosso.</span><span class="sxs-lookup"><span data-stu-id="16d48-486">For example, the input color hue is 40 percent of the way from the hue value of Magenta to the hue value of Red.</span></span>

<span data-ttu-id="16d48-487">b) nella rotellina Hue di destinazione trovare l'angolo di tonalità associato, ad esempio, 40% da Magenta a rosso.</span><span class="sxs-lookup"><span data-stu-id="16d48-487">b)On the destination hue wheel, find the associated hue angle, for example, 40 percent from Magenta to Red.</span></span> <span data-ttu-id="16d48-488">Questo valore sarà l'angolo di tonalità di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-488">This value will be the destination hue angle.</span></span>

<span data-ttu-id="16d48-489">In generale, le primarie e i database secondari di origine non si troveranno sugli stessi angoli di tonalità delle primarie di destinazione e dei database secondari; ovvero, l'angolo di tonalità di destinazione in genere sarà diverso dall'angolo di tonalità di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-489">In general, the source primaries and secondaries will not be at the same hue angles as the destination primaries and secondaries; that is, the destination hue angle usually will be different from the source hue angle.</span></span>

<span data-ttu-id="16d48-490">Si supponga, ad esempio, che le ruote Hue producano i valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="16d48-490">For example, suppose the hue wheels produce the following values:</span></span>

<span data-ttu-id="16d48-491">Source M = 295 Degrees, source R = 355 Degrees.</span><span class="sxs-lookup"><span data-stu-id="16d48-491">Source M = 295 degrees, Source R = 355 degrees.</span></span>

<span data-ttu-id="16d48-492">Destinazione M = 290 gradi, destinazione R = 346 gradi.</span><span class="sxs-lookup"><span data-stu-id="16d48-492">Destination M = 290 degrees, Destination R = 346 degrees.</span></span>

<span data-ttu-id="16d48-493">Se l'angolo di tinta del colore di input è 319 gradi, è il 40% dell'angolo (24 gradi) dall'origine M al codice sorgente R. L'angolo da M a R è 60 gradi e l'angolo da M a tonalità di input è di 24 gradi.</span><span class="sxs-lookup"><span data-stu-id="16d48-493">If the hue angle of the input color is 319 degrees, it is 40 percent of the angle (24 degrees) from source M to source R. The angle from M to R is 60 degrees, and the angle from M to input hue is 24 degrees.</span></span> <span data-ttu-id="16d48-494">Calcolare l'angolo sulla destinazione che corrisponde al 40% dalla destinazione M alla destinazione R (22 gradi), quindi l'angolo di tonalità del colore di destinazione è 312 gradi.</span><span class="sxs-lookup"><span data-stu-id="16d48-494">Calculate the angle on the destination that is 40 percent from destination M to destination R (22 degrees), so the hue angle of the destination color is 312 degrees.</span></span>

<span data-ttu-id="16d48-495">Calcolare quindi i punti di riferimento Hue per la tonalità di origine e la tonalità di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-495">Next, calculate the hue reference points for the source hue and the destination hue.</span></span> <span data-ttu-id="16d48-496">Per calcolare il punto di riferimento Hue per un particolare valore h (Hue), è necessario trovare il valore J (luminosità) e il valore C (Chroma).</span><span class="sxs-lookup"><span data-stu-id="16d48-496">To calculate the hue reference point for a particular h (hue) value, you want to find the J (lightness) value and C (chroma) value.</span></span>

-   <span data-ttu-id="16d48-497">Trovare il valore J del punto di riferimento tonalità eseguendo l'interpolazione tra i valori J per i punti primari o secondari adiacenti, usando la posizione relativa della tonalità. ad esempio, 40% in questo esempio.</span><span class="sxs-lookup"><span data-stu-id="16d48-497">Find the J value of the hue reference point by interpolating between the J values for the adjacent primary or secondary points, using the relative position of the hue; for example, 40 percent in this example.</span></span>
-   <span data-ttu-id="16d48-498">Trovare il valore massimo di C a questo valore J e il valore h.</span><span class="sxs-lookup"><span data-stu-id="16d48-498">Find the maximum C value at this J value and h value.</span></span> <span data-ttu-id="16d48-499">È ora disponibile il JCh del punto di riferimento Hue per tale tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-499">You now have the JCh of the hue reference point for that hue.</span></span>

![Diagramma che mostra una foglia tonalità.](images/gmmp-figure13.png)

<span data-ttu-id="16d48-501">**Figura 14** : foglia tonalità (visualizzazione di una sezione limite gamut in corrispondenza di una determinata tonalità)</span><span class="sxs-lookup"><span data-stu-id="16d48-501">**Figure 14** : A hue leaf (visualization of a gamut boundary slice at a specific hue)</span></span>

<span data-ttu-id="16d48-502">Il passaggio successivo consiste nel calcolare il mapping di taglio per ogni pixel.</span><span class="sxs-lookup"><span data-stu-id="16d48-502">The next step is to compute the shear mapping for each pixel.</span></span> <span data-ttu-id="16d48-503">Prima di tutto, visualizzare una foglia tonalità dalla gamma di origine per l'angolo di tinta del colore di origine e una foglia tonalità dalla gamma di destinazione per l'angolo di tonalità di destinazione calcolato durante la rotazione tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-503">First, visualize a hue leaf from the source gamut for the source color hue angle, and a hue leaf from the destination gamut for the destination hue angle computed during hue rotation.</span></span> <span data-ttu-id="16d48-504">Le foglie di tonalità vengono create eseguendo una "sezione" dalla superficie limite della gamma JCh in corrispondenza di un angolo di tonalità specifico (vedere la figura 14).</span><span class="sxs-lookup"><span data-stu-id="16d48-504">The hue leaves are created by taking a "slice" from the JCh gamut boundary surface at a specific hue angle (see Figure 14).</span></span>

<span data-ttu-id="16d48-505">Nota: per motivi di ottimizzazione delle prestazioni, le foglie Hue non vengono effettivamente create. vengono descritte e illustrate qui solo a scopo di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-505">NOTE: For performance optimization reasons, hue leaves are not actually created; they are described and shown here for visualization purposes only.</span></span> <span data-ttu-id="16d48-506">Le operazioni vengono eseguite direttamente sulla superficie limite del gamut alla tonalità specificata.</span><span class="sxs-lookup"><span data-stu-id="16d48-506">The operations are performed directly on the gamut boundary surface at the specified hue.</span></span> <span data-ttu-id="16d48-507">Quindi si calcolano i punti di riferimento Hue per determinare il mapping di taglio.</span><span class="sxs-lookup"><span data-stu-id="16d48-507">You then compute the hue reference points to determine the shear mapping.</span></span>

-   <span data-ttu-id="16d48-508">Eseguire un ridimensionamento della luminosità per eseguire il mapping dei punti neri e bianchi della foglia di origine alla foglia di destinazione (vedere la figura 15).</span><span class="sxs-lookup"><span data-stu-id="16d48-508">Perform a lightness rescaling to map the black and white points of the source leaf to the destination leaf (see Figure 15).</span></span> <span data-ttu-id="16d48-509">I punti neri e vuoti della foglia tonalità di origine vengono mappati in modo lineare ai punti neri e bianchi della foglia tonalità di destinazione, ridimensionando tutte le coordinate J del limite di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-509">The black and white points of the source hue leaf are mapped linearly to the black and white points of the destination hue leaf, by scaling all the J coordinates of the source boundary.</span></span> <span data-ttu-id="16d48-510">Il valore del colore di input mappato a tonalità viene ridimensionato nello stesso modo.</span><span class="sxs-lookup"><span data-stu-id="16d48-510">The hue-mapped input color value is scaled in the same manner.</span></span>

![Diagramma che mostra il mapping di luminosità.](images/gmmp-figure14.png)

<span data-ttu-id="16d48-512">**Figura 15** : mapping della luminosità</span><span class="sxs-lookup"><span data-stu-id="16d48-512">**Figure 15** : Lightness mapping</span></span>

-   <span data-ttu-id="16d48-513">Determinare i punti di riferimento Hue per ogni foglia tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-513">Determine the hue reference points for each hue leaf.</span></span> <span data-ttu-id="16d48-514">Applicare un mapping di taglio alla foglia di origine in modo che i punti di riferimento di origine e di destinazione coincidano (vedere la figura 16).</span><span class="sxs-lookup"><span data-stu-id="16d48-514">Apply a shear mapping to the source leaf so that the source and destination reference points coincide (see Figure 16).</span></span> <span data-ttu-id="16d48-515">Il punto di riferimento per una gamma a una determinata tonalità è il punto di riferimento della tonalità interpolata tra le primarie adiacenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-515">The reference point for a gamut at a specific hue is the interpolated hue reference point between the adjacent primaries.</span></span> <span data-ttu-id="16d48-516">Il punto di riferimento della foglia tonalità di origine viene mappato in modo lineare al punto di riferimento della foglia tonalità di destinazione, usando un'operazione di "distorsione" che blocca l'asse J, mantenendo i punti neri e i puntini bianchi fissi.</span><span class="sxs-lookup"><span data-stu-id="16d48-516">The reference point of the source hue leaf is mapped linearly to the reference point of the destination hue leaf, using a "shear" operation that locks the J axis, keeping the black points and the white points stationary.</span></span> <span data-ttu-id="16d48-517">I punti neri, i punti bianchi e i punti di riferimento delle foglie di tonalità di origine e di destinazione devono coincidere.</span><span class="sxs-lookup"><span data-stu-id="16d48-517">The black points, white points, and reference points of the source and destination hue leaves should coincide.</span></span>
-   <span data-ttu-id="16d48-518">Applicare il mapping di taglio al valore del colore di input con regolazione della luminosità.</span><span class="sxs-lookup"><span data-stu-id="16d48-518">Apply the shear mapping to the lightness-adjusted input color value.</span></span> <span data-ttu-id="16d48-519">Le coordinate J e C del valore del colore di origine vengono ridimensionate in modo proporzionale rispetto alla distanza dall'asse J.</span><span class="sxs-lookup"><span data-stu-id="16d48-519">The J and C coordinates of the source color value are proportionally scaled, relative to its distance from the J axis.</span></span>
-   <span data-ttu-id="16d48-520">Successivamente, una lieve compressione della luminosità dipendente da Chroma verso il valore J del punto di riferimento Hue viene eseguita sul punto di colore con mapping di taglio.</span><span class="sxs-lookup"><span data-stu-id="16d48-520">Next, a subtle chroma-dependent lightness compression toward the J-value of the hue reference point is performed on the shear-mapped color point.</span></span> <span data-ttu-id="16d48-521">La compressione verso il riferimento Hue J viene eseguita in un modo simile a gamma, dove bianco, nero, grigio e punti sul riferimento tonalità J non sono interessati.</span><span class="sxs-lookup"><span data-stu-id="16d48-521">The compression toward hue reference J is done in a gamma-like fashion, where white, black, grays, and points on the hue reference J are not affected.</span></span> <span data-ttu-id="16d48-522">Tutti gli altri punti tendono a raggiungere il riferimento di tonalità J in modo uniforme, leggermente raggruppando in prossimità del riferimento Hue J, con la costante Chroma rimanente.</span><span class="sxs-lookup"><span data-stu-id="16d48-522">All other points tend toward the hue reference J in a smooth fashion, slightly bunching up near the hue reference J, with chroma remaining constant.</span></span> <span data-ttu-id="16d48-523">La dipendenza Chroma garantisce che i colori neutri non siano interessati e che l'effetto venga aumentato sui colori con Chroma superiore.</span><span class="sxs-lookup"><span data-stu-id="16d48-523">The chroma dependency assures that neutral colors are not affected, and the effect is increased on colors with higher chroma.</span></span>

<span data-ttu-id="16d48-524">Di seguito è riportata una descrizione matematica della compressione della luminosità verso il riferimento di tonalità J o la modifica del valore J del punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-524">The following is a mathematical description of the lightness compression toward the hue reference J, or adjusting the J-value of the destination point.</span></span> <span data-ttu-id="16d48-525">Viene chiamato punto di destinazione perché è stato mappato al gamut di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-525">It is called the destination point because it has been shear mapped into the destination gamut.</span></span>

<span data-ttu-id="16d48-526">Per prima cosa, calcolare "factorC" (fattore di dipendenza Chroma) per il punto di destinazione, che determina la quantità di effetti della compressione della luminosità.</span><span class="sxs-lookup"><span data-stu-id="16d48-526">First, compute "factorC" (chroma dependency factor) for the destination point, which determines how much effect the lightness compression will have.</span></span> <span data-ttu-id="16d48-527">I punti vicini o sull'asse J avranno una compressione minima o nulla. i punti più lontani dall'asse J (High-Chroma) avranno una maggiore compressione applicata.</span><span class="sxs-lookup"><span data-stu-id="16d48-527">Points near or on the J-axis will have little or no compression; points farther away from the J-axis (high-chroma) will have more compression applied.</span></span> <span data-ttu-id="16d48-528">Moltiplicare per 0,5 per assicurarsi che factorC sia minore di 1, perché è possibile che sourceC sia leggermente maggiore di referenceC, ma non due volte più grande.</span><span class="sxs-lookup"><span data-stu-id="16d48-528">Multiply by 0.5 to ensure that factorC is less than 1, because it is possible that sourceC could be slightly greater than referenceC, but not twice as great.</span></span>

<span data-ttu-id="16d48-529">factorC = (destinationC/referenceC)?</span><span class="sxs-lookup"><span data-stu-id="16d48-529">factorC = (destinationC / referenceC) ?</span></span> <span data-ttu-id="16d48-530">0.5</span><span class="sxs-lookup"><span data-stu-id="16d48-530">0.5</span></span>

<span data-ttu-id="16d48-531">dove:</span><span class="sxs-lookup"><span data-stu-id="16d48-531">where:</span></span>

<span data-ttu-id="16d48-532">destinationC è il valore C del punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-532">destinationC is the C-value of the destination point.</span></span>

<span data-ttu-id="16d48-533">referenceC è il valore C del punto di riferimento tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-533">referenceC is the C-value of the Hue Reference point.</span></span>

<span data-ttu-id="16d48-534">Determinare quindi se il punto di destinazione J è al di sopra o al di sotto del riferimento di tonalità J. In caso contrario, eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="16d48-534">Next, determine whether the destination point J is above or below the hue reference J. If it is above, do the following:</span></span>

1.  <span data-ttu-id="16d48-535">Calcolare "factorJ" per il punto di destinazione rispetto a referenceJ.</span><span class="sxs-lookup"><span data-stu-id="16d48-535">Compute "factorJ" for the destination point relative to the referenceJ.</span></span> <span data-ttu-id="16d48-536">Il valore di factorJ sarà compreso tra 0 e 1 (0 se in referenceJ; 1 se in maxJ).</span><span class="sxs-lookup"><span data-stu-id="16d48-536">This factorJ value will be between 0 and 1 (0 if on the referenceJ; 1 if at maxJ).</span></span>
2.  <span data-ttu-id="16d48-537">factorJ = (destinationJ-referenceJ)/(maxJ-referenceJ)</span><span class="sxs-lookup"><span data-stu-id="16d48-537">factorJ = (destinationJ - referenceJ) / (maxJ - referenceJ)</span></span>

    <span data-ttu-id="16d48-538">dove:</span><span class="sxs-lookup"><span data-stu-id="16d48-538">where:</span></span>

    <span data-ttu-id="16d48-539">destinationJ è il valore J del punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-539">destinationJ is the J-value of the destination point.</span></span>

    <span data-ttu-id="16d48-540">referenceJ è il valore J del punto di riferimento tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-540">referenceJ is the J-value of the hue reference point.</span></span>

    <span data-ttu-id="16d48-541">maxJ è il valore J massimo della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-541">maxJ is the maximum J-value of the gamut.</span></span>

3.  <span data-ttu-id="16d48-542">Applicare una funzione di risparmio energia di tipo gamma a factorJ, che ridurrà factorJ di una determinata quantità.</span><span class="sxs-lookup"><span data-stu-id="16d48-542">Apply a gamma-like power function to factorJ, which will reduce factorJ by a certain amount.</span></span> <span data-ttu-id="16d48-543">Questo esempio usa la potenza di 2 (il quadrato).</span><span class="sxs-lookup"><span data-stu-id="16d48-543">This example uses the power of 2 (the square).</span></span> <span data-ttu-id="16d48-544">Sottrarre il factorJ ridotto dalla factorJ originale e moltiplicare il risultato per l'intervallo J totale sopra il referenceJ primario per trovare il "deltaJ", che rappresenta la modifica in J dopo la compressione della luminosità, ma senza includere la dipendenza Chroma.</span><span class="sxs-lookup"><span data-stu-id="16d48-544">Subtract the reduced factorJ from the original factorJ and multiply the result by the total J-range above the primary referenceJ to find the "deltaJ," which represents the change in J after the lightness compression, but not including the chroma dependency.</span></span>
4.  <span data-ttu-id="16d48-545">deltaJ = (factorJ-(factorJ?</span><span class="sxs-lookup"><span data-stu-id="16d48-545">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="16d48-546">factorJ)) ?</span><span class="sxs-lookup"><span data-stu-id="16d48-546">factorJ)) ?</span></span> <span data-ttu-id="16d48-547">(maxJ - referenceJ)</span><span class="sxs-lookup"><span data-stu-id="16d48-547">(maxJ - referenceJ)</span></span>

5.  <span data-ttu-id="16d48-548">Applicare factorC al deltaJ (maggiore è la Croma, maggiore sarà l'effetto) e calcolare il nuovo valore J per il punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-548">Apply factorC to the deltaJ (the higher the chroma, the greater the effect), and compute the new J-value for the destination point.</span></span>
6.  <span data-ttu-id="16d48-549">destinationJ = destinationJ-(deltaJ?</span><span class="sxs-lookup"><span data-stu-id="16d48-549">destinationJ = destinationJ - (deltaJ ?</span></span> <span data-ttu-id="16d48-550">factorC)</span><span class="sxs-lookup"><span data-stu-id="16d48-550">factorC)</span></span>

<span data-ttu-id="16d48-551">Se J-value per il punto di destinazione è inferiore a referenceJ, viene eseguito un calcolo simile ai passaggi precedenti a-C, usando minJ anziché maxJ per trovare l'intervallo in J per calcolare il factorJ e tenendo conto della polarità delle operazioni "sotto" referenceJ.</span><span class="sxs-lookup"><span data-stu-id="16d48-551">If J-value for the destination point is below referenceJ, then a similar computation to the preceding steps A-C is performed, using minJ instead of maxJ to find the range in J to compute the factorJ, and taking into account the polarity of the operations "underneath" the referenceJ.</span></span>

<span data-ttu-id="16d48-552">factorJ = (referenceJ-destinationJ)/(referenceJ-minJ)</span><span class="sxs-lookup"><span data-stu-id="16d48-552">factorJ = (referenceJ - destinationJ) / (referenceJ - minJ)</span></span>

<span data-ttu-id="16d48-553">deltaJ = (factorJ-(factorJ?</span><span class="sxs-lookup"><span data-stu-id="16d48-553">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="16d48-554">factorJ)) ?</span><span class="sxs-lookup"><span data-stu-id="16d48-554">factorJ)) ?</span></span> <span data-ttu-id="16d48-555">(referenceJ-minJ)</span><span class="sxs-lookup"><span data-stu-id="16d48-555">(referenceJ - minJ)</span></span>

<span data-ttu-id="16d48-556">destinationJ = destinationJ + (deltaJ?</span><span class="sxs-lookup"><span data-stu-id="16d48-556">destinationJ = destinationJ + (deltaJ ?</span></span> <span data-ttu-id="16d48-557">factorC)</span><span class="sxs-lookup"><span data-stu-id="16d48-557">factorC)</span></span>

<span data-ttu-id="16d48-558">dove:</span><span class="sxs-lookup"><span data-stu-id="16d48-558">where:</span></span>

<span data-ttu-id="16d48-559">minJ è il valore J minimo del gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-559">minJ is the minimum J-value of the gamut.</span></span>

<span data-ttu-id="16d48-560">La crominanza per i punti colore di input viene espansa in modo lineare (se possibile) insieme alla luminosità costante proporzionale al valore di Chroma massimo dei gamut di origine e di destinazione a tale tonalità e luminosità.</span><span class="sxs-lookup"><span data-stu-id="16d48-560">The chroma for input color points is expanded linearly (when possible) along constant lightness proportional to the maximum chroma value of the source and destination gamuts at that hue and lightness.</span></span> <span data-ttu-id="16d48-561">In combinazione con la precedente compressione della luminosità dipendente dalla Croma, questo consente di mantenere la saturazione perché il mapping di distorsione usando i punti di riferimento a volte causa la sovracompressione del punto di origine in Chroma (vedere la figura 16).</span><span class="sxs-lookup"><span data-stu-id="16d48-561">Combined with the preceding chroma-dependent lightness compression, this helps preserve the saturation because shear mapping using the reference points sometimes causes the source point to over-compress in chroma (see Figure 16).</span></span>

![Diagramma che mostra il mapping di taglio per trovare la corrispondenza con i punti di riferimento tonalità, prima del taglio a sinistra, dopo la distorsione a destra.](images/gmmp-shearmapping.png)

<span data-ttu-id="16d48-563">**Figura 16** : mapping di taglio, compressione della luminosità verso il riferimento di Hue J e espansione Chroma</span><span class="sxs-lookup"><span data-stu-id="16d48-563">**Figure 16** : Shear mapping, lightness compression toward hue reference J, and chroma expansion</span></span>

<span data-ttu-id="16d48-564">Di seguito è riportata una descrizione matematica del processo di espansione croma o la modifica del valore C del punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-564">The following is a mathematical description of the chroma expansion process, or adjusting the C-value of the destination point.</span></span> <span data-ttu-id="16d48-565">Viene chiamato punto di destinazione perché è stato mappato a forbice e la leggerezza è stata compressa nel gamut di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-565">It is called the destination point because it has been shear mapped and lightness compressed into the destination gamut.</span></span>

1.  <span data-ttu-id="16d48-566">Prima del mapping di taglio, determinare sourceExtentC (l'extent Chroma alla luminosità e alla tonalità del punto di origine).</span><span class="sxs-lookup"><span data-stu-id="16d48-566">Before the shear mapping, determine sourceExtentC (the chroma extent at the lightness and hue of the source point).</span></span>
2.  <span data-ttu-id="16d48-567">Dopo il mapping di taglio e la compressione della luminosità che trasformano il punto di origine nel punto di destinazione, determinare il destExtentC (l'extent Chroma alla luminosità e la tonalità del punto di destinazione).</span><span class="sxs-lookup"><span data-stu-id="16d48-567">After the shear mapping and lightness compression which transforms the source point into the destination point, determine the destExtentC (the chroma extent at the lightness and hue of the destination point).</span></span>
3.  <span data-ttu-id="16d48-568">Se sourceExtentC è maggiore di destExtentC, non è necessaria alcuna regolazione croma per il punto di destinazione ed è possibile ignorare il passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-568">If the sourceExtentC is greater than the destExtentC, no chroma adjustment to the destination point is necessary, and you can skip the next step.</span></span>
4.  <span data-ttu-id="16d48-569">Modificare destinationC (croma del punto di destinazione) per adattarlo all'ambito della croma di destinazione in base a questa luminosità e tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-569">Adjust destinationC (the chroma of the destination point) to fit within the destination chroma extent at this lightness and hue.</span></span>
5.  <span data-ttu-id="16d48-570">destinationC = destinationC?</span><span class="sxs-lookup"><span data-stu-id="16d48-570">destinationC = destinationC ?</span></span> <span data-ttu-id="16d48-571">(destExtentC / sourceExtentC)</span><span class="sxs-lookup"><span data-stu-id="16d48-571">(destExtentC / sourceExtentC)</span></span>

    <span data-ttu-id="16d48-572">dove:</span><span class="sxs-lookup"><span data-stu-id="16d48-572">where:</span></span>

    <span data-ttu-id="16d48-573">destinationC è il punto di destinazione C-value.</span><span class="sxs-lookup"><span data-stu-id="16d48-573">destinationC is the destination point C-value.</span></span>

    <span data-ttu-id="16d48-574">sourceExtentC è il valore C massimo della gamma di origine alla luminosità e alla tonalità del punto di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-574">sourceExtentC is the maximum C-value of the source gamut at the lightness and hue of the source point.</span></span>

    <span data-ttu-id="16d48-575">destExtentC è il valore C massimo della gamma di destinazione alla luminosità e alla tonalità del punto di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-575">destExtentC is the maximum C-value of the destination gamut at the lightness and hue of the destination point.</span></span>

<span data-ttu-id="16d48-576">Infine, eseguire il ritaglio della distanza di minimo.</span><span class="sxs-lookup"><span data-stu-id="16d48-576">Finally, perform the mimimum distance clipping.</span></span> <span data-ttu-id="16d48-577">Se il colore di input con rotazione tonalità, luminosità e con mapping di inclinazione è ancora leggermente esterno al gamut di destinazione, ritagliarlo (spostarlo) al punto più vicino sul limite della gamma di destinazione (vedere la figura 17).</span><span class="sxs-lookup"><span data-stu-id="16d48-577">If the hue-rotated, lightness-adjusted, and shear-mapped input color is still slightly outside the destination gamut, clip it (move it) to the closest point on the destination gamut boundary (see Figure 17).</span></span>

![Diagramma che mostra il ritaglio della distanza minima.](images/gmmp-figure15.png)

<span data-ttu-id="16d48-579">**Figura 17** : ritaglio a distanza minima</span><span class="sxs-lookup"><span data-stu-id="16d48-579">**Figure 17** : Minimum distance clipping</span></span>

## <a name="gamut-boundary-description-and-gamut-shell-algorithms"></a><span data-ttu-id="16d48-580">Descrizione limite gamut e algoritmi della shell gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-580">Gamut Boundary Description and Gamut Shell Algorithms</span></span>

<span data-ttu-id="16d48-581">La funzione limite gamma dispositivi usa il motore del modello di dispositivo e i parametri analitici per derivare un limite di gamut del dispositivo di colore, descritto come un elenco di vertici indicizzati dello scafo del gamut del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-581">The device gamut boundary function uses the device model engine and analytical parameters to derive a color device gamut boundary, described as an indexed vertex list of the hull of the device gamut.</span></span> <span data-ttu-id="16d48-582">Lo scafo viene calcolato in modo diverso a seconda che si stiano utilizzando dispositivi additivi, ad esempio monitoraggi e proiettori, o dispositivi sottrattivi.</span><span class="sxs-lookup"><span data-stu-id="16d48-582">The hull is computed differently depending on whether you are working with additive devices, such as monitors and projectors, or subtractive devices.</span></span> <span data-ttu-id="16d48-583">L'elenco di vertici indicizzati viene archiviato in CIEJab.</span><span class="sxs-lookup"><span data-stu-id="16d48-583">The indexed vertex list is stored in CIEJab.</span></span> <span data-ttu-id="16d48-584">La struttura dell'elenco di vertici indicizzati è ottimizzata per l'accelerazione hardware da DirectX.</span><span class="sxs-lookup"><span data-stu-id="16d48-584">The structure of the indexed vertex list is optimized for hardware acceleration by DirectX.</span></span>

<span data-ttu-id="16d48-585">Questo approccio presenta molte soluzioni ben note.</span><span class="sxs-lookup"><span data-stu-id="16d48-585">This approach has many well-known solutions.</span></span> <span data-ttu-id="16d48-586">Se si cerca "convessa Hull DirectX" sul Web, si ottengono più di 100 riscontri.</span><span class="sxs-lookup"><span data-stu-id="16d48-586">If you search for "convex hull DirectX" on the Web, you get more than 100 hits.</span></span> <span data-ttu-id="16d48-587">È ad esempio disponibile un riferimento da 1983 in questo argomento specifico (teoria grafica del computer e applicazione, "Shiphulls, superfici b-spline e CADCAM", pp. 34-49) con riferimenti che risalgono da 1970 a 1982 nell'argomento.</span><span class="sxs-lookup"><span data-stu-id="16d48-587">For example, there is a reference from 1983 on this specific topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces, and cadcam," pp. 34-49) with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="16d48-588">La raccolta di punti può essere determinata da informazioni disponibili esternamente, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="16d48-588">The collection of points can be determined from externally available information, as follows:</span></span>

-   <span data-ttu-id="16d48-589">I punti per la shell di riferimento per i monitoraggi vengono generati utilizzando un campionamento del cubo colori nello spazio di colore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-589">Points for the reference shell for monitors are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="16d48-590">I punti per la shell di riferimento per le stampanti e i dispositivi di acquisizione vengono ottenuti dai dati di esempio utilizzati per inizializzare il modello.</span><span class="sxs-lookup"><span data-stu-id="16d48-590">Points for the reference shell for printers and capture devices are obtained from the sample data used to initialize the model.</span></span>
-   <span data-ttu-id="16d48-591">I punti per la shell di riferimento per scRGB e sRGB vengono generati utilizzando un campionamento del cubo di colore per sRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-591">Points for the reference shell for scRGB and sRGB are generated using a sampling of the color cube for sRGB.</span></span>
-   <span data-ttu-id="16d48-592">I punti per la shell plausibile per i dispositivi di acquisizione vengono generati usando un campionamento del cubo di colori nello spazio di colore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-592">Points for the plausible shell for capture devices are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="16d48-593">I punti per la shell di riferimento per i proiettori vengono generati usando un campionamento di un poliedro nel cubo dei colori nello spazio colorante del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-593">Points for the reference shell for projectors are generated using a sampling of a polyhedron in the color cube in device colorant space.</span></span>
-   <span data-ttu-id="16d48-594">I punti per la shell possibile per gli spazi dei colori a intervalli dinamici estesi vengono generati utilizzando un campionamento del cubo di colori nello spazio stesso.</span><span class="sxs-lookup"><span data-stu-id="16d48-594">Points for the possible shell for wide dynamic range color spaces are generated using a sampling of the color cube in the space itself.</span></span>

<span data-ttu-id="16d48-595">È possibile creare un elenco di vertici che descrive in modo efficiente la gamma di colori dei dispositivi, dato un profilo di dispositivo e servizi di supporto del sistema.</span><span class="sxs-lookup"><span data-stu-id="16d48-595">You can create a vertex list that efficiently describes the color device gamut, given a device profile and system support services.</span></span>

<span data-ttu-id="16d48-596">Per i dispositivi di output, il limite della gamma descrive l'intervallo di colori che possono essere visualizzati dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-596">For output devices, the gamut boundary describes the range of colors that can be displayed by the device.</span></span> <span data-ttu-id="16d48-597">Un limite di gamut viene generato dagli stessi dati usati per modellare il comportamento del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-597">A gamut boundary is generated from the same data used to model the behavior of the device.</span></span> <span data-ttu-id="16d48-598">Dal punto di vista concettuale, viene restituito un campionamento dell'intervallo di colori che il dispositivo può produrre, misurare i colori, convertire le misurazioni in spazio di aspetto e quindi usare i risultati per creare il limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-598">Conceptually, you output a sampling of the range of colors the device can produce, measure the colors, convert the measurements into appearance space, and then use the results to create the gamut boundary.</span></span>

<span data-ttu-id="16d48-599">I dispositivi di input sono più complicati.</span><span class="sxs-lookup"><span data-stu-id="16d48-599">Input devices are trickier.</span></span> <span data-ttu-id="16d48-600">Ogni pixel in un'immagine di input deve avere un valore.</span><span class="sxs-lookup"><span data-stu-id="16d48-600">Each pixel in an input image must have some value.</span></span> <span data-ttu-id="16d48-601">Ogni pixel deve essere in grado di rappresentare in qualche modo qualsiasi colore trovato nel mondo reale.</span><span class="sxs-lookup"><span data-stu-id="16d48-601">Each pixel must be able to represent any color found in the real world in some way.</span></span> <span data-ttu-id="16d48-602">In questo senso, nessun colore è "fuori gamma" per un dispositivo di input, perché è sempre possibile rappresentarli.</span><span class="sxs-lookup"><span data-stu-id="16d48-602">In this sense, no colors are "out of gamut" for an input device, because they can always be represented.</span></span>

<span data-ttu-id="16d48-603">Tutti i formati di immagine digitale hanno un intervallo dinamico fisso.</span><span class="sxs-lookup"><span data-stu-id="16d48-603">All digital image formats have some fixed dynamic range.</span></span> <span data-ttu-id="16d48-604">A causa di questa limitazione, sono sempre presenti alcuni stimoli distinti che si mappano allo stesso valore digitale.</span><span class="sxs-lookup"><span data-stu-id="16d48-604">Because of this limitation, there is always some distinct stimuli that map to the same digital value.</span></span> <span data-ttu-id="16d48-605">Non è quindi possibile stabilire un mapping uno-a-uno tra i colori reali e i valori delle fotocamere digitali.</span><span class="sxs-lookup"><span data-stu-id="16d48-605">So, you cannot establish a one-to-one mapping between real-world colors and digital camera values.</span></span> <span data-ttu-id="16d48-606">Al contrario, il limite della gamma è formato dalla stima di un intervallo di colori reali che può produrre le risposte digitali della fotocamera.</span><span class="sxs-lookup"><span data-stu-id="16d48-606">Instead, the gamut boundary is formed by estimating a range of real-world colors that can produce the digital responses of the camera.</span></span> <span data-ttu-id="16d48-607">Si usa tale intervallo stimato come gamut per il dispositivo di input.</span><span class="sxs-lookup"><span data-stu-id="16d48-607">You use that estimated range as the gamut for the input device.</span></span>

<span data-ttu-id="16d48-608">Sono incluse le primarie per fornire il mapping del gamut dei tipi di business graphics.</span><span class="sxs-lookup"><span data-stu-id="16d48-608">Primaries are included to provide for business graphics intent-type gamut mapping.</span></span>

<span data-ttu-id="16d48-609">In uno stile orientato a oggetti reale si estrae la rappresentazione sottostante del limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-609">In true object-oriented style, you abstract the underlying representation of the gamut boundary.</span></span> <span data-ttu-id="16d48-610">In questo modo è possibile modificare la rappresentazione in futuro.</span><span class="sxs-lookup"><span data-stu-id="16d48-610">This allows you the flexibility to change the representation in the future.</span></span> <span data-ttu-id="16d48-611">Per comprendere il descrittore di limite gamut (GBD) usato nella nuova CTE, è necessario innanzitutto comprendere il funzionamento degli algoritmi di mapping di gamut (GMAs).</span><span class="sxs-lookup"><span data-stu-id="16d48-611">To understand the gamut boundary descriptor (GBD) used in the new CTE, you must first understand how gamut mapping algorithms (GMAs) work.</span></span> <span data-ttu-id="16d48-612">Tradizionalmente, GMAs è stato progettato per soddisfare le esigenze della community grafica. ovvero per riprodurre le immagini che sono già state visualizzate correttamente per il dispositivo in cui è stata creata l'immagine di input.</span><span class="sxs-lookup"><span data-stu-id="16d48-612">Traditionally, GMAs have been designed to meet the needs of the graphic art community; that is, to reproduce images that have already been properly rendered for the device on which the input image was created.</span></span> <span data-ttu-id="16d48-613">L'obiettivo di Graphic Arts GMAs è quello di eseguire la migliore riproduzione possibile dell'immagine di input nel dispositivo di output.</span><span class="sxs-lookup"><span data-stu-id="16d48-613">The goal of graphic arts GMAs is to make the best possible reproduction of the input image on the output device.</span></span> <span data-ttu-id="16d48-614">La nuova CTE GBD è progettata per risolvere quattro problemi principali.</span><span class="sxs-lookup"><span data-stu-id="16d48-614">The new CTE GBD is designed to solve four key problems.</span></span>

<span data-ttu-id="16d48-615">Poiché viene eseguito il rendering dell'immagine di input per il dispositivo di input, tutti i colori rientrano nell'intervallo tra il punto bianco e il punto nero del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-615">Because the input image is rendered for the input device, all colors fit within the range between the medium's white point and black point.</span></span> <span data-ttu-id="16d48-616">Si supponga che l'immagine sia una fotografia di una scena in cui è presente un bianco diffuso, ad esempio una persona in una maglietta bianca, e un'evidenziazione speculare, ad esempio la luce che riflette una finestra o un paraurti di Chrome.</span><span class="sxs-lookup"><span data-stu-id="16d48-616">Suppose that the image is a photograph of a scene in which there is a diffuse white, such as a person in a white tee shirt, and a specular highlight, such as light reflecting off a window or chrome bumper.</span></span> <span data-ttu-id="16d48-617">Verrà eseguito il rendering della scena sul supporto di input in modo che l'evidenziazione speculare venga mappata al punto bianco del supporto e che il bianco diffuso sia mappato a un colore neutro scuro rispetto al punto bianco del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-617">The scene will be rendered to the input medium so that the specular highlight is mapped to the medium's white point, and the diffuse white is mapped to some neutral color darker than the medium's white point.</span></span> <span data-ttu-id="16d48-618">La scelta di eseguire il mapping dei colori dalla scena al supporto di input è una decisione dipendente dalla scena e una decisione estetica.</span><span class="sxs-lookup"><span data-stu-id="16d48-618">The choice of how to map colors from the scene to the input medium is both a scene-dependent decision and an aesthetic decision.</span></span> <span data-ttu-id="16d48-619">Se l'evidenziazione speculare non era presente nella scena originale, il bianco diffuso verrebbe probabilmente mappato al punto bianco del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-619">If the specular highlight was missing from the original scene, then the diffuse white would probably be mapped to the medium's white point.</span></span> <span data-ttu-id="16d48-620">In una scena con una grande quantità di dettagli, viene lasciato un intervallo superiore tra il bianco speculare e il bianco diffuso.</span><span class="sxs-lookup"><span data-stu-id="16d48-620">In a scene with a lot of highlight detail, more range would be left between the specular white and the diffuse white.</span></span> <span data-ttu-id="16d48-621">In una scena in cui l'evidenziazione non è significativa, potrebbe essere lasciato un intervallo molto ridotto.</span><span class="sxs-lookup"><span data-stu-id="16d48-621">In a scene where the highlight is not significant, very little range might be left.</span></span>

<span data-ttu-id="16d48-622">Per le immagini pre-renderizzate, il mapping di gamut è relativamente semplice.</span><span class="sxs-lookup"><span data-stu-id="16d48-622">For pre-rendered images, gamut mapping is relatively straightforward.</span></span> <span data-ttu-id="16d48-623">Fondamentalmente, il punto bianco originale del supporto viene mappato al punto bianco del supporto di riproduzione, il punto nero di origine viene mappato al punto nero di destinazione e la maggior parte del mapping è completa.</span><span class="sxs-lookup"><span data-stu-id="16d48-623">Basically, the original medium's white point is mapped to the reproduction medium's white point, the source black point is mapped to the destination black point, and most of the mapping is complete.</span></span> <span data-ttu-id="16d48-624">I diversi GMAs in esistenza forniscono varianti per eseguire il mapping di altri punti sulla scala dei toni del supporto di origine e modi diversi per gestire i valori cromatici fuori gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-624">The different GMAs in existence provide variations for mapping other points on the source medium's tone scale and different ways to handle out-of-gamut chroma values.</span></span> <span data-ttu-id="16d48-625">Tuttavia, il mapping tra il bianco e il bianco e il nero a nero è coerente in tutte le varianti.</span><span class="sxs-lookup"><span data-stu-id="16d48-625">But the mapping of white to white and black to black is consistent throughout these variations.</span></span> <span data-ttu-id="16d48-626">Questa implementazione richiede che il bianco sia superiore a J \* di 50 e nero sotto un j \* di 50.</span><span class="sxs-lookup"><span data-stu-id="16d48-626">This implementation requires that white be above a J\* of 50 and black below a J\* of 50.</span></span>

<span data-ttu-id="16d48-627">Non tutte le codifiche dei colori limitano gli intervalli di colori per le immagini di input.</span><span class="sxs-lookup"><span data-stu-id="16d48-627">Not all color encodings limit color ranges for input images.</span></span> <span data-ttu-id="16d48-628">La codifica dei colori standard IEC (IEC 61966-2-2) fornisce 16 bit per ognuno dei tre canali di colore rosso, verde e blu (RGB).</span><span class="sxs-lookup"><span data-stu-id="16d48-628">The IEC standard color encoding scRGB (IEC 61966-2-2) provides 16 bits for each of the three color channels red, green, and blue (RGB).</span></span> <span data-ttu-id="16d48-629">In tale codifica, il riferimento nero non è codificato come triple RGB (0, 0, 0), ma come (4096, 4096, 4096).</span><span class="sxs-lookup"><span data-stu-id="16d48-629">In that encoding, reference black is not encoded as the RGB triple (0, 0, 0), but as (4096, 4096, 4096).</span></span> <span data-ttu-id="16d48-630">Il riferimento bianco è codificato come (12288, 12288, 12288).</span><span class="sxs-lookup"><span data-stu-id="16d48-630">Reference white is encoded as (12288, 12288, 12288).</span></span> <span data-ttu-id="16d48-631">La codifica scRGB può essere utilizzata per rappresentare le evidenziazioni speculari e i dettagli dell'ombreggiatura.</span><span class="sxs-lookup"><span data-stu-id="16d48-631">The scRGB encoding can be used to represent specular highlights and shadow detail.</span></span> <span data-ttu-id="16d48-632">Include triple RGB che non sono fisicamente possibili perché richiedono quantità di luce negative e codifiche esterne al locus spettrale CIE.</span><span class="sxs-lookup"><span data-stu-id="16d48-632">It includes RGB triples that are not physically possible because they require negative amounts of light, and encodings that are outside the CIE spectral locus.</span></span> <span data-ttu-id="16d48-633">Ovviamente, nessun dispositivo può produrre tutti i colori nella gamma di scRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-633">Clearly, no device can possibly produce all the colors in the scRGB gamut.</span></span> <span data-ttu-id="16d48-634">In realtà, nessun dispositivo può produrre tutti i colori che possono essere visualizzati da un uomo.</span><span class="sxs-lookup"><span data-stu-id="16d48-634">In fact, no device can produce all the colors that a human being can see.</span></span> <span data-ttu-id="16d48-635">Quindi, i dispositivi non possono riempire la gamma di scRGB e sarebbe utile poter rappresentare la parte della gamma che riempiono.</span><span class="sxs-lookup"><span data-stu-id="16d48-635">So, devices cannot fill the scRGB gamut, and it would be useful to be able to represent the part of the gamut that they do fill.</span></span> <span data-ttu-id="16d48-636">Ogni dispositivo ha un intervallo di valori nello spazio scRGB che può produrre.</span><span class="sxs-lookup"><span data-stu-id="16d48-636">Each device has a range of values in scRGB space that it can produce.</span></span> <span data-ttu-id="16d48-637">Questi sono i colori "previsti" per il dispositivo; sarebbe sorprendente per il dispositivo produrre colori al di fuori di questa gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-637">These are the "expected" colors for the device; it would be surprising for the device to produce colors outside this gamut.</span></span> <span data-ttu-id="16d48-638">Esiste una trasformazione definita dallo spazio scRGB allo spazio di aspetto, quindi ogni dispositivo dispone anche di un intervallo di valori di aspetto che dovrebbe essere riprodotto.</span><span class="sxs-lookup"><span data-stu-id="16d48-638">There is a defined transformation from scRGB space to appearance space, so each device also has a range of appearance values that it is expected to reproduce.</span></span>

<span data-ttu-id="16d48-639">In scRGB e input da dispositivi di acquisizione caratterizzati da una destinazione fissa, è possibile ottenere un valore non compreso nell'intervallo dei valori previsti.</span><span class="sxs-lookup"><span data-stu-id="16d48-639">In both scRGB and input from capture devices characterized with a fixed target, it is possible to get a value outside the range of expected values.</span></span> <span data-ttu-id="16d48-640">Se un utente calibra una fotocamera a una destinazione di test; quindi acquisisce una scena con evidenziazioni speculari. potrebbero essere presenti pixel più luminosi rispetto al punto bianco della destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-640">If someone calibrates a camera to a test target; and then captures a scene with specular highlights, there might be pixels that are brighter than the target's white point.</span></span> <span data-ttu-id="16d48-641">La stessa cosa può verificarsi se un rosso naturale è più cromatico rispetto a quello rosso di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-641">The same thing can happen if a naturally occurring red is more chromatic than the target red.</span></span> <span data-ttu-id="16d48-642">Se un utente accetta un'immagine di scRGB da un dispositivo e quindi modifica manualmente i colori nell'immagine, è possibile creare pixel che non rientrano nell'intervallo previsto del gamut del dispositivo, anche se si trovano all'interno del gamut completo di scRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-642">If someone takes an scRGB image from a device, and then manually edits the colors in the image, it is possible to create pixels that fall outside the expected range of the device gamut, even though they are within the full scRGB gamut.</span></span>

<span data-ttu-id="16d48-643">In primo luogo, un secondo problema potrebbe non essere correlato a questo.</span><span class="sxs-lookup"><span data-stu-id="16d48-643">A second problem may not, at first, seem to be related to this.</span></span> <span data-ttu-id="16d48-644">Si verifica quando si usa una destinazione dei colori per caratterizzare un dispositivo di input, ad esempio una fotocamera o uno scanner.</span><span class="sxs-lookup"><span data-stu-id="16d48-644">It arises when you use a color target to characterize an input device, such as a camera or scanner.</span></span> <span data-ttu-id="16d48-645">Gli obiettivi riflessivi vengono in genere prodotti su carta e contengono numerose patch colorate.</span><span class="sxs-lookup"><span data-stu-id="16d48-645">Reflective targets are typically produced on paper and contain a number of colored patches.</span></span> <span data-ttu-id="16d48-646">Manufaturers fornisce i file di dati con misurazioni colore eseguite in una condizione di visualizzazione fissa per ogni patch di colore.</span><span class="sxs-lookup"><span data-stu-id="16d48-646">Manufaturers provide data files with color measurements taken under a fixed viewing condition for each color patch.</span></span> <span data-ttu-id="16d48-647">Gli strumenti di profilatura dei colori creano un mapping tra questi valori misurati e i valori restituiti dai sensori di colore nei dispositivi.</span><span class="sxs-lookup"><span data-stu-id="16d48-647">Color profiling tools create a mapping between these measured values and the values returned by the color sensors in the devices.</span></span> <span data-ttu-id="16d48-648">Il problema è che spesso queste destinazioni dei colori non coprono l'intera gamma di valori del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-648">The problem is that often these color targets do not cover the full range of device values.</span></span> <span data-ttu-id="16d48-649">Ad esempio, lo scanner o la fotocamera potrebbe restituire un valore (253, 253, 253) per il punto bianco di riferimento e una patch rossa di riferimento potrebbe avere un valore RGB pari a (254, 12, 4).</span><span class="sxs-lookup"><span data-stu-id="16d48-649">For example, the scanner or camera might return a value of (253, 253, 253) for the reference white point, and a reference red patch might have an RGB value of (254, 12, 4).</span></span> <span data-ttu-id="16d48-650">Rappresentano l'intervallo di valori previsti per il dispositivo di input, in base ai valori di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-650">These represent the range of expected values for the input device, based on the target values.</span></span> <span data-ttu-id="16d48-651">Se si caratterizza il dispositivo di input in base alle risposte alla destinazione, si prevede che i colori si trovino solo all'interno di questo intervallo limitato.</span><span class="sxs-lookup"><span data-stu-id="16d48-651">If you characterize the input device based on the responses to the target, then you only expect colors within this narrow range.</span></span> <span data-ttu-id="16d48-652">Questo intervallo non solo è inferiore all'intervallo di colori che può essere visualizzato dagli utenti, è più piccolo dell'intervallo di colori che il dispositivo può produrre.</span><span class="sxs-lookup"><span data-stu-id="16d48-652">This range is not only smaller than the range of colors humans can see, it is smaller than the range of colors the device can produce.</span></span>

<span data-ttu-id="16d48-653">In entrambi i casi, è difficile stimare la gamma del dispositivo o dell'immagine di input, nonostante l'esistenza di un gamut o misurazioni di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-653">In both cases, it is difficult to estimate the gamut of the input device or image, despite the existence of a reference gamut or measurements.</span></span> <span data-ttu-id="16d48-654">Nel primo problema, la gamma plausibile del dispositivo di input è inferiore alla gamma completa di scRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-654">In the first problem, the plausible gamut of the input device is less than the full gamut of scRGB.</span></span> <span data-ttu-id="16d48-655">Nel secondo problema la gamma di riferimento della destinazione è inferiore alla gamma completa possibile del dispositivo di input.</span><span class="sxs-lookup"><span data-stu-id="16d48-655">In the second problem, the reference gamut of the target is less than the full possible gamut of the input device.</span></span>

<span data-ttu-id="16d48-656">Il terzo problema riguarda il mapping dei toni.</span><span class="sxs-lookup"><span data-stu-id="16d48-656">The third problem involves tone mapping.</span></span> <span data-ttu-id="16d48-657">Molti modelli di limiti di gamut che possono rappresentare in modo adeguato le immagini di cui è stato eseguito il rendering usati negli arti grafici sono stati proposti, ad esempio, Braun e Fairchild Mountain Range GBD (Braun \[ 97 \] ) e il descrittore di limite di Morovic segmento Maxima (Morovic \[ 98 \] ).</span><span class="sxs-lookup"><span data-stu-id="16d48-657">Many models of gamut boundaries that can adequately represent pre-rendered images used in the graphic arts have been proposed, for example, the Braun and Fairchild Mountain range GBD (Braun\[97\]), and Morovic's Segment Maxima boundary descriptor (Morovic\[98\]).</span></span> <span data-ttu-id="16d48-658">Tuttavia, questi modelli forniscono solo informazioni sugli estremi del gamut del dispositivo. non sono disponibili informazioni su altri punti nel mapping tonale.</span><span class="sxs-lookup"><span data-stu-id="16d48-658">But these models only provide information about the extremes of the device's gamut; they are missing information about other points in the tonal mapping.</span></span> <span data-ttu-id="16d48-659">Senza tali informazioni, GMAs è in grado di eseguire stime approssimative del mapping dei toni ottimali.</span><span class="sxs-lookup"><span data-stu-id="16d48-659">Without such information, GMAs can only make rough estimates of optimal tone mapping.</span></span> <span data-ttu-id="16d48-660">Peggiori, questi modelli non forniscono alcuna guida per l'intervallo dinamico esteso in scRGB e nelle immagini della fotocamera digitale.</span><span class="sxs-lookup"><span data-stu-id="16d48-660">Worse, these models provide no help for the extended dynamic range in scRGB and in digital camera images.</span></span>

<span data-ttu-id="16d48-661">In che modo questo problema è risolto nei settori fotografici e videografica?</span><span class="sxs-lookup"><span data-stu-id="16d48-661">How is this problem resolved in the photographic and videographic industries?</span></span> <span data-ttu-id="16d48-662">La fotocamera acquisisce un'immagine.</span><span class="sxs-lookup"><span data-stu-id="16d48-662">The camera captures an image.</span></span> <span data-ttu-id="16d48-663">Gli esperti potrebbero discutere della quantità di rendering eseguita nel dispositivo di acquisizione. ma accettano che non si tratta di un importo significativo.</span><span class="sxs-lookup"><span data-stu-id="16d48-663">Experts might debate how much rendering occurs in the capture device; but they agree that it is not a significant amount.</span></span> <span data-ttu-id="16d48-664">Entrambe le tecnologie non eseguono il mapping di un bianco diffuso in una scena acquisita al punto bianco del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-664">Both technologies do not map a diffuse white in a captured scene to the medium's white point.</span></span> <span data-ttu-id="16d48-665">Analogamente, non eseguono il mapping del punto nero dalla scena al punto nero del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-665">Similarly, they do not map the black point from the scene to the medium's black point.</span></span> <span data-ttu-id="16d48-666">Il comportamento di un film fotografico viene descritto in spazio di densità usando una curva caratteristica, spesso denominata "Hurt" e "Driffield" o la curva H&D.</span><span class="sxs-lookup"><span data-stu-id="16d48-666">The behavior of photographic film is described in density space using a characteristic curve, often called a Hurter and Driffield, or H&D curve.</span></span> <span data-ttu-id="16d48-667">La curva mostra la densità della scena originale e la densità risultante sul film.</span><span class="sxs-lookup"><span data-stu-id="16d48-667">The curve shows the density of the original scene and the resulting density on the film.</span></span> <span data-ttu-id="16d48-668">Nella figura 18 viene illustrata una tipica curva H&D.</span><span class="sxs-lookup"><span data-stu-id="16d48-668">Figure 18 shows a typical H&D curve.</span></span> <span data-ttu-id="16d48-669">L'asse x rappresenta un aumento dell'esposizione dei log.</span><span class="sxs-lookup"><span data-stu-id="16d48-669">The x-axis represents increasing log exposure.</span></span> <span data-ttu-id="16d48-670">L'asse y rappresenta la densità della diapositiva.</span><span class="sxs-lookup"><span data-stu-id="16d48-670">The y-axis represents the density on the slide.</span></span> <span data-ttu-id="16d48-671">Cinque punti di riferimento sono contrassegnati sulla curva: nero senza dettagli, che rappresenta la densità minima sul valore negativo. nero con dettaglio; riferimento alla scheda a metà grigio; bianco con dettaglio; e bianco senza dettagli.</span><span class="sxs-lookup"><span data-stu-id="16d48-671">Five reference points are marked on the curve: black without detail, which represents the minimum density on the negative; black with detail; reference mid-gray card; white with detail; and white without detail.</span></span> <span data-ttu-id="16d48-672">Si noti che c'è uno spazio tra il nero senza dettagli (che rappresenta il nero del dispositivo) e il nero con dettagli (nero scuro).</span><span class="sxs-lookup"><span data-stu-id="16d48-672">Note that there is space between black without detail (which represents device black) and black with detail (shadow black).</span></span> <span data-ttu-id="16d48-673">Analogamente, c'è uno spazio tra il bianco e il dettaglio (il bianco diffuso) e il bianco senza dettagli, che rappresenta il bianco del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-673">Similarly, there is space between white with detail (diffuse white) and white without detail (which represents device white).</span></span>

![Diagramma che mostra la curva H e D per la pellicola della diapositiva.](images/gmmp-image079.png)

<span data-ttu-id="16d48-675">**Figura 18** : curva H&D per la pellicola della diapositiva</span><span class="sxs-lookup"><span data-stu-id="16d48-675">**Figure 18** : H&D curve for slide film</span></span>

<span data-ttu-id="16d48-676">Il settore video fornisce "capacità" e "footroom" nelle immagini.</span><span class="sxs-lookup"><span data-stu-id="16d48-676">The video industry provides "headroom" and "footroom" in images.</span></span> <span data-ttu-id="16d48-677">Nella specifica ITU 709, la luminanza (denominata Y) viene codificata in 8 bit, con un intervallo compreso tra 0 e 255.</span><span class="sxs-lookup"><span data-stu-id="16d48-677">In the ITU 709 specification, luminance (called Y) is encoded in 8 bits, with a range of 0 to 255.</span></span> <span data-ttu-id="16d48-678">Tuttavia, il nero di riferimento è codificato a 15 e il riferimento bianco è codificato come 235.</span><span class="sxs-lookup"><span data-stu-id="16d48-678">However, reference black is encoded at 15 and reference white is encoded as 235.</span></span> <span data-ttu-id="16d48-679">Questa operazione lascia l'intervallo di codifica compreso tra 236 e 255 per rappresentare le evidenziazioni speculari.</span><span class="sxs-lookup"><span data-stu-id="16d48-679">This leaves the encoding range between 236 and 255 to represent specular highlights.</span></span>

<span data-ttu-id="16d48-680">Il settore video presenta un sistema di ciclo essenzialmente chiuso.</span><span class="sxs-lookup"><span data-stu-id="16d48-680">The video industry presents an essentially closed loop system.</span></span> <span data-ttu-id="16d48-681">Sebbene ci siano molti fornitori di apparecchiature diversi, i sistemi video si basano sui dispositivi di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-681">While there are many different equipment vendors, video systems are based upon reference devices.</span></span> <span data-ttu-id="16d48-682">Per le immagini video è disponibile una codifica standard.</span><span class="sxs-lookup"><span data-stu-id="16d48-682">There is a standard encoding for video images.</span></span> <span data-ttu-id="16d48-683">Non è necessario comunicare un limite di gamut con le immagini video, perché tutte le immagini sono codificate per la riproduzione nello stesso dispositivo di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-683">There is no need to communicate a gamut boundary with video images, because all images are encoded for reproduction on the same reference device.</span></span> <span data-ttu-id="16d48-684">Il film è anche un ciclo chiuso perché non è necessario trasferire i dati intermedi tra i diversi componenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-684">Film is also closed loop because there is no need to convey intermediate data between different components.</span></span> <span data-ttu-id="16d48-685">Si vuole una soluzione che consenta di creare immagini da dispositivi con gamme diverse e di rappresentare sia le scene pre-renderizzate che quelle non sottoposte a rendering da riprodurre nell'output con gamme diverse.</span><span class="sxs-lookup"><span data-stu-id="16d48-685">You want a solution that enables images from devices with varying gamuts and representing both pre-rendered and unrendered scenes to be reproduced on output with varying gamuts.</span></span>

<span data-ttu-id="16d48-686">Un quarto problema che deve essere risolto dalla nuova CTE è che i colori visivi in grigio prodotti da un dispositivo, ad esempio, quando rosso = verde = blu su un monitor, spesso non rientrano nell'asse neutro della camma (quando Chroma = 0,0).</span><span class="sxs-lookup"><span data-stu-id="16d48-686">A fourth problem that the new CTE must resolve is that the visually gray colors produced by a device, for example, when red=green=blue on a monitor, frequently do not fall upon the neutral axis of the CAM (when the chroma = 0.0).</span></span> <span data-ttu-id="16d48-687">Ciò causa grandi difficoltà per GMAs.</span><span class="sxs-lookup"><span data-stu-id="16d48-687">This causes great difficulties for GMAs.</span></span> <span data-ttu-id="16d48-688">Per fare in modo che GMAs funzioni correttamente, è necessario modificare la descrizione del gamut del dispositivo e dei punti di input in modo che l'asse neutro del dispositivo cada sull'asse neutro dello spazio aspetto.</span><span class="sxs-lookup"><span data-stu-id="16d48-688">To make GMAs work well, you have to adjust the description of the device's gamut and of the input points so that the device's neutral axis falls on the appearance space's neutral axis.</span></span> <span data-ttu-id="16d48-689">È necessario modificare i punti dall'asse neutro di un importo simile.</span><span class="sxs-lookup"><span data-stu-id="16d48-689">You have to adjust points off the neutral axis by a similar amount.</span></span> <span data-ttu-id="16d48-690">In caso contrario, non è possibile eseguire gradazioni uniformi tramite l'immagine.</span><span class="sxs-lookup"><span data-stu-id="16d48-690">Otherwise, you cannot make smooth gradations through the image.</span></span> <span data-ttu-id="16d48-691">All'esterno della GMA, questo mapping viene annullato rispetto all'asse neutro del dispositivo di output.</span><span class="sxs-lookup"><span data-stu-id="16d48-691">On the way out of the GMA, you undo this mapping, relative to the output device's neutral axis.</span></span> <span data-ttu-id="16d48-692">Questa operazione viene definita "Chiropratica" di raddrizzamento dell'asse.</span><span class="sxs-lookup"><span data-stu-id="16d48-692">This is referred to as a "chiropractic" straightening of the axis.</span></span> <span data-ttu-id="16d48-693">Come un chiropratico, non solo si raddrizza la Skeleton (asse neutro), ma si regola il resto del corpo per spostarsi insieme alla Skeleton.</span><span class="sxs-lookup"><span data-stu-id="16d48-693">Like a chiropractor, you not only straighten the skeleton (neutral axis), but you adjust the rest of the body to move along with the skeleton.</span></span> <span data-ttu-id="16d48-694">Analogamente a un chiropratico, la struttura non viene modificata in base alla stessa quantità nell'intero spazio.</span><span class="sxs-lookup"><span data-stu-id="16d48-694">Like a chiropractor, you do not adjust the skeleton by the same amount through the entire space.</span></span> <span data-ttu-id="16d48-695">Al contrario, si modificano le diverse sezioni in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="16d48-695">Instead, you adjust different sections differently.</span></span>

![Diagramma che mostra la curvatura dell'asse neutro del dispositivo rispetto all'asse neutro CIECAM.](images/gmmp-image081.png)

<span data-ttu-id="16d48-697">**Figura 19:** Curvatura dell'asse neutro del dispositivo rispetto all'asse neutro CIECAM</span><span class="sxs-lookup"><span data-stu-id="16d48-697">**Figure 19:** Curvature of the device neutral axis relative to the CIECAM neutral axis</span></span>

<span data-ttu-id="16d48-698">La nuova CTE richiede un modello di limite di gamut che può essere usato per rappresentare le immagini di origine sottoposte a rendering e non sottoposte a rendering, fornire informazioni sull'aspetto dei dispositivi neutri e fornire informazioni per le immagini di mapping del tono con un intervallo di luminanza ampio.</span><span class="sxs-lookup"><span data-stu-id="16d48-698">What the new CTE requires is a model of a gamut boundary that can be used to represent both rendered and unrendered source images, provide information about the appearance of device neutrals, and provide information for tone mapping images with a wide luminance range.</span></span>

![Diagramma che mostra le tre Shell della gamma.](images/gmmp-image083.png)

<span data-ttu-id="16d48-700">**Figura 20** : tre shell di gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-700">**Figure 20** : Three gamut shells</span></span>

<span data-ttu-id="16d48-701">Il limite della gamma è costituito da tre Shell che definiscono tre aree.</span><span class="sxs-lookup"><span data-stu-id="16d48-701">The gamut boundary is composed of three shells that define three regions.</span></span>

<span data-ttu-id="16d48-702">Nella nuova CTE la shell esterna della gamma viene formata con una struttura convessa eseguita da punti di esempio nel gamut del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-702">In the new CTE, the outer shell of the gamut is formed with a convex hull made from sample points in the device gamut.</span></span> <span data-ttu-id="16d48-703">Uno scafo è costituito da un set di punti di esempio che li circonda da una superficie.</span><span class="sxs-lookup"><span data-stu-id="16d48-703">A hull is formed by taking a set of sample points and surrounding them by a surface.</span></span> <span data-ttu-id="16d48-704">Una struttura convessa ha la proprietà aggiuntiva di essere convessa ovunque.</span><span class="sxs-lookup"><span data-stu-id="16d48-704">A convex hull has the additional property of being convex everywhere.</span></span> <span data-ttu-id="16d48-705">Non si tratta quindi dello scafo più piccolo possibile che può essere adattato ai dati.</span><span class="sxs-lookup"><span data-stu-id="16d48-705">Therefore, this is not the smallest possible hull that can be fit to the data.</span></span> <span data-ttu-id="16d48-706">Tuttavia, la sperimentazione ha dimostrato che l'adattamento dei punti di esempio causa troppe complicazioni negli artefatti delle immagini, ad esempio la mancanza di ombreggiatura uniforme.</span><span class="sxs-lookup"><span data-stu-id="16d48-706">But experimentation has shown that fitting the sample points too tightly causes unappealing artifacts in images, such as a lack of smooth shading.</span></span> <span data-ttu-id="16d48-707">Il guscio convesso sembra risolvere questi problemi.</span><span class="sxs-lookup"><span data-stu-id="16d48-707">The convex hull seems to solve these problems.</span></span>

<span data-ttu-id="16d48-708">Nell'algoritmo vengono ottenuti i valori di aspetto dei colori per un set di punti campionati dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-708">In the algorithm, color appearance values are obtained for a set of points sampled from the device.</span></span> <span data-ttu-id="16d48-709">Per i monitoraggi e le stampanti, i valori relativi all'aspetto dei colori vengono ottenuti tramite l'output degli esempi e quindi la relativa misurazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-709">For monitors and printers, the color appearance values are obtained by outputting samples, and then measuring them.</span></span> <span data-ttu-id="16d48-710">È anche possibile creare un modello di dispositivo, quindi eseguire dati sintetici tramite il modello di dispositivo per stimare i valori misurati.</span><span class="sxs-lookup"><span data-stu-id="16d48-710">You can also create a device model, and then run synthetic data through the device model to predict measured values.</span></span> <span data-ttu-id="16d48-711">I valori misurati vengono quindi convertiti da spazio colorimetrico (XYZ) a spazio aspetto (jab) e la struttura viene avvolta intorno ai punti.</span><span class="sxs-lookup"><span data-stu-id="16d48-711">The measured values are then converted from colorimetric space (XYZ) to appearance space (Jab), and the hull is wrapped around the points.</span></span>

<span data-ttu-id="16d48-712">Il punto chiave di questo algoritmo è che il punto bianco adottato usato nella conversione da colorimetrico a spazio aspetto non deve essere il punto bianco del supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-712">The key point to this algorithm is that the adopted white point used in the conversion from colorimetric to appearance space does not have to be the medium's white point.</span></span> <span data-ttu-id="16d48-713">In alternativa, è possibile selezionare un punto più a lungo all'interno della gamut e, in alternativa, l'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-713">Instead, you can select a point farther inside the gamut and on (or near) the neutral axis.</span></span> <span data-ttu-id="16d48-714">Tale punto avrà quindi un valore J pari a 100.</span><span class="sxs-lookup"><span data-stu-id="16d48-714">That point will then have a J-value of 100.</span></span> <span data-ttu-id="16d48-715">Gli esempi con un valore Y misurato superiore al punto bianco adottato finiranno con un valore J maggiore di 100.</span><span class="sxs-lookup"><span data-stu-id="16d48-715">Samples with a measured Y-value higher than the adopted white point will end up with a J-value greater than 100.</span></span>

<span data-ttu-id="16d48-716">Se si posiziona il punto bianco diffuso della scena come punto bianco adottato per la conversione dello spazio colore, le evidenziazioni speculari nella scena saranno facilmente rilevate come se avessero un valore J maggiore di 100.</span><span class="sxs-lookup"><span data-stu-id="16d48-716">If you place the scene's diffuse white point as the adopted white point for the color space conversion, then specular highlights in the scene will be easily detected as having a J-value greater than 100.</span></span>

<span data-ttu-id="16d48-717">Poiché il modello di colore CIECAM02 è basato sul sistema visivo umano, dopo che è stato selezionato un bianco adottato, il livello di luminanza del punto nero (J = 0) viene determinato automaticamente dal modello.</span><span class="sxs-lookup"><span data-stu-id="16d48-717">Because the CIECAM02 color model is based on the human visual system, after an adopted white is selected, the luminance level of the black point (J = 0) is automatically determined by the model.</span></span> <span data-ttu-id="16d48-718">Se l'immagine di input ha un intervallo dinamico ampio, è possibile che siano presenti valori che vengono mappati a J-valori minori di zero.</span><span class="sxs-lookup"><span data-stu-id="16d48-718">If the input image has a wide dynamic range, it is possible that there might be values that map to J-values less than zero.</span></span>

<span data-ttu-id="16d48-719">Nella figura 21 riportata di seguito vengono illustrati i dispositivi neutri in esecuzione al centro delle gamme plausibili e di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-719">The following Figure 21 shows the device neutrals running through the center of the plausible and reference gamuts.</span></span>

![Diagramma che mostra l'asse del dispositivo neutro aggiunto al limite della gamma.](images/gmmp-image085.png)

<span data-ttu-id="16d48-721">**Figura 21** : asse neutro del dispositivo aggiunto al limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-721">**Figure 21** : Device neutral axis added to gamut boundary</span></span>

<span data-ttu-id="16d48-722">Tutti i mapping di gamut coinvolgono il ritaglio di un intervallo di input in un gamut di output o la compressione del gamut di input per adattarlo all'interno del gamut di output.</span><span class="sxs-lookup"><span data-stu-id="16d48-722">All gamut mappings involve either clipping an input range to an output gamut, or compressing the input gamut to fit within the output gamut.</span></span> <span data-ttu-id="16d48-723">Algoritmi più complessi sono formati da comprimere e ritagliare in direzioni diverse oppure dividendo la gamma in aree diverse e quindi eseguendo il ritaglio o la compressione nelle diverse aree.</span><span class="sxs-lookup"><span data-stu-id="16d48-723">More complex algorithms are formed by compressing and clipping in different directions, or by dividing the gamut into different regions, and then performing clipping or compression in the different regions.</span></span>

<span data-ttu-id="16d48-724">La nuova CTE estende questo concetto per supportare le aree di una possibile gamma, una gamma plausibile e una gamma di riferimento e consente a GMAs di eseguire il mapping in modi diversi.</span><span class="sxs-lookup"><span data-stu-id="16d48-724">The new CTE extends this concept to support the regions of a possible gamut, a plausible gamut, and a reference gamut, and enables GMAs to map them in different ways.</span></span> <span data-ttu-id="16d48-725">Inoltre, i GMAs includono informazioni sull'asse neutro del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-725">In addition, the GMAs have information about the device neutral axis.</span></span> <span data-ttu-id="16d48-726">Nella discussione seguente viene illustrato come gestire le situazioni in cui le gamme plausibili e le gamme di riferimento sono state compresse l'una sull'altra.</span><span class="sxs-lookup"><span data-stu-id="16d48-726">The following discussion addresses how to handle situations where the plausible gamuts and reference gamuts have collapsed on each other.</span></span>

![Diagramma che mostra la G M A con due descrittori di gamut non compressi.](images/gmmp-image091.png)

<span data-ttu-id="16d48-728">**Figura 22** : GMA con due descrittori di gamut non compressi</span><span class="sxs-lookup"><span data-stu-id="16d48-728">**Figure 22** : GMA with two un-collapsed gamut descriptors</span></span>

<span data-ttu-id="16d48-729">Questo esempio può essere visualizzato se si esegue il mapping da un dispositivo di input, ad esempio una fotocamera o uno scanner caratterizzato da una destinazione riflettente, allo spazio scRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-729">You might see this example if you map from an input device, such as a camera or scanner that is characterized with a reflective target, to scRGB space.</span></span> <span data-ttu-id="16d48-730">Di seguito sono riportati i colori plausibili più chiari rispetto a quelli di riferimento bianco.</span><span class="sxs-lookup"><span data-stu-id="16d48-730">Here the plausible colors that are lighter than reference white are specular highlights.</span></span> <span data-ttu-id="16d48-731">In pratica, la caratterizzazione di una fotocamera con una destinazione potrebbe non generare l'intera gamma di valori possibili nella fotocamera; Tuttavia, le evidenziazioni speculari e i colori molto cromatici rilevati in natura.</span><span class="sxs-lookup"><span data-stu-id="16d48-731">In practice, characterizing a camera with a target might not generate the full range of values possible in the camera; however, specular highlights and very chromatic colors found in nature would.</span></span> <span data-ttu-id="16d48-732">(Le destinazioni di trasmissione in genere hanno una patch che è la densità minima possibile sul supporto.</span><span class="sxs-lookup"><span data-stu-id="16d48-732">(Transmissive targets usually have a patch that is the minimum density possible on the medium.</span></span> <span data-ttu-id="16d48-733">Con tale destinazione, le evidenziazioni speculari rientrano nell'intervallo della destinazione. Il nero di riferimento per una destinazione riflessiva è l'inizio dell'area nera Shadow.</span><span class="sxs-lookup"><span data-stu-id="16d48-733">With such a target, specular highlights would fall within the target's range.) The reference black for a reflective target would be the beginning of the shadow black region.</span></span> <span data-ttu-id="16d48-734">Ovvero, è probabile che siano presenti colori nelle ombre più scure del nero sulla destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-734">That is, there are likely to be colors in the shadows that are darker than the black on the target.</span></span> <span data-ttu-id="16d48-735">Se l'immagine contiene una grande quantità di contenuto interessante in tale area, potrebbe essere utile mantenere la variazione tonale.</span><span class="sxs-lookup"><span data-stu-id="16d48-735">If the image contains a lot of interesting content in that region, it may be worthwhile preserving that tonal variation.</span></span>

![Diagramma che mostra il G M A con un gamut di destinazione compresso.](images/gmmp-image095.png)

<span data-ttu-id="16d48-737">**Figura 23** : GMA con gamut di destinazione compresso</span><span class="sxs-lookup"><span data-stu-id="16d48-737">**Figure 23** : GMA with collapsed destination gamut</span></span>

<span data-ttu-id="16d48-738">La figura 23 Mostra un algoritmo di mapping di gamut possibile quando il gamut di destinazione fornisce solo l'intervallo dal dispositivo bianco al nero e non vi sono colori possibili al di fuori di questa gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-738">Figure 23 shows one possible gamut mapping algorithm when the destination gamut only provides the range from device white to black, and there are no possible colors outside this gamut.</span></span> <span data-ttu-id="16d48-739">Questo problema si verifica probabilmente per i dispositivi di output tipici, ad esempio le stampanti.</span><span class="sxs-lookup"><span data-stu-id="16d48-739">This is likely to happen for typical output devices, such as printers.</span></span> <span data-ttu-id="16d48-740">I colori possibili sono mappati al bordo del gamut di destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-740">The possible colors are mapped to the edge of the destination gamut.</span></span> <span data-ttu-id="16d48-741">Ma non dispone di una curva di tono per il dispositivo di output.</span><span class="sxs-lookup"><span data-stu-id="16d48-741">But it lacks a tone curve for the output device.</span></span> <span data-ttu-id="16d48-742">Il GMA deve selezionare un punto neutro della luminanza inferiore da usare come destinazione del mapping per il bianco di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-742">The GMA must select some neutral point of lower luminance to use as a mapping destination for the reference white.</span></span> <span data-ttu-id="16d48-743">Un algoritmo sofisticato può eseguire questa operazione histogramming lightnesses nell'immagine di origine e visualizzare il numero di rientri nell'intervallo di previsto ma più chiaro del bianco di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-743">A sophisticated algorithm can do this by histogramming the lightnesses in the source image and seeing how many fall in the range of expected but lighter than the reference white.</span></span> <span data-ttu-id="16d48-744">Maggiore è il numero di lightnesses, maggiore è il numero di spazio necessario nel dispositivo di destinazione tra i punti di mapping per le evidenziazioni speculari e il bianco di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-744">The more lightnesses, the more space is required in the destination device between the mapped points for the specular highlights and reference white.</span></span> <span data-ttu-id="16d48-745">Un algoritmo più semplice può scegliere una distanza arbitraria dalla scala di luminosità del dispositivo bianco, ad esempio il 5%.</span><span class="sxs-lookup"><span data-stu-id="16d48-745">A simpler algorithm might pick an arbitrary distance down the lightness scale from device white, such as 5 percent.</span></span> <span data-ttu-id="16d48-746">Un approccio simile è valido per il mapping del nero massimo e nero ombreggiato.</span><span class="sxs-lookup"><span data-stu-id="16d48-746">A similar approach applies for the mapping of the maximum black and shadow black.</span></span>

<span data-ttu-id="16d48-747">Dopo aver generato la curva di tono di destinazione, è possibile eseguire il mapping in un metodo simile a quello usato nella figura 23 precedente.</span><span class="sxs-lookup"><span data-stu-id="16d48-747">After you generate the destination tone curve, you can map in a method similar to that used in the preceding Figure 23.</span></span> <span data-ttu-id="16d48-748">Tutti i punti nella curva di tono di destinazione rientrano nel gamut del dispositivo e tutti i punti nel mapping devono rientrare nel gamut del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-748">All points in the destination tone curve will fall within the device gamut, and all points in the mapping must fall within the device gamut.</span></span>

<span data-ttu-id="16d48-749">Se si invertono le figure a sinistra e a destra e le direzioni delle frecce nella figura 23, è possibile descrivere il caso in cui l'immagine di origine dispone solo di una gamma di riferimento e le tre gamme del dispositivo di output non sono state compresse l'una sull'altra.</span><span class="sxs-lookup"><span data-stu-id="16d48-749">If you reverse the left figures and right figures, and the directions of the arrows in Figure 23, you can describe the case where the source image has only a reference gamut, and the three gamuts of the output device have not collapsed onto each other.</span></span> <span data-ttu-id="16d48-750">Un esempio potrebbe essere il mapping da un monitoraggio a scRGB.</span><span class="sxs-lookup"><span data-stu-id="16d48-750">An example of this might be mapping from a monitor to scRGB.</span></span> <span data-ttu-id="16d48-751">Anche in questo caso, la GMA deve sintetizzare i punti di controllo per i cinque punti sulla curva di tono per l'immagine di origine.</span><span class="sxs-lookup"><span data-stu-id="16d48-751">Again, the GMA must synthesize the control points for the five points on the tone curve for the source image.</span></span> <span data-ttu-id="16d48-752">Alcuni mapping potrebbero inserire tutti i punti della curva di tono all'interno del gamut del dispositivo scRGB, mentre altri mapping potrebbero utilizzare più della gamut di scRGB eseguendo il mapping tra il bianco e il bianco di riferimento e consentendo al bianco speculare di eseguire il mapping a un valore più chiaro.</span><span class="sxs-lookup"><span data-stu-id="16d48-752">Some mappings might put all points of the tone curve within the scRGB device gamut, while other mappings might use more of the scRGB gamut by mapping diffuse white to the reference white and allowing specular white to map to a lighter value.</span></span>

<span data-ttu-id="16d48-753">Infine, si ha il caso in cui entrambi i dispositivi hanno solo la gamma di riferimento, ovvero la maggior parte degli algoritmi di mapping di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-753">Finally, you have the case where both devices have only the reference gamut, which is how most gamut mapping algorithms work.</span></span> <span data-ttu-id="16d48-754">Per risolvere questo problema, è possibile eseguire il fallback solo sugli algoritmi correnti.</span><span class="sxs-lookup"><span data-stu-id="16d48-754">So you can resolve this by just falling back to current algorithms.</span></span> <span data-ttu-id="16d48-755">In alternativa, se si dispone di un modo ragionevole per determinare i cinque punti di riferimento per i dispositivi di origine e di destinazione, è possibile disporre di per eseguire il mapping dei punti di riferimento.</span><span class="sxs-lookup"><span data-stu-id="16d48-755">Alternatively, if you have a reasonable way to determine the five reference points for the source and destination devices, then you can arrange to map the reference points.</span></span>

<span data-ttu-id="16d48-756">Le gamme di dispositivi contengono più di cinque punti di riferimento sull'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-756">Device gamuts contain more than the five reference points on the neutral axis.</span></span> <span data-ttu-id="16d48-757">Rappresentano solo i limiti tra le aree potenziali nell'immagine.</span><span class="sxs-lookup"><span data-stu-id="16d48-757">These just represent the boundaries between potential regions in the image.</span></span> <span data-ttu-id="16d48-758">Tra i punti di riferimento è possibile usare qualsiasi tecnica di mapping di gamut esistente.</span><span class="sxs-lookup"><span data-stu-id="16d48-758">Between each of the reference points, you can use any of the existing gamut mapping techniques.</span></span> <span data-ttu-id="16d48-759">Quindi, è possibile ritagliare l'intervallo di colori imprevisti e comprimere tutti i colori tra il bianco e il nero previsti oppure è possibile ritagliare tutti i colori all'esterno dell'intervallo di riferimento e comprimere all'interno di tale intervallo.</span><span class="sxs-lookup"><span data-stu-id="16d48-759">So you might clip the range of unexpected colors, and compress all colors between the expected white and black, or you might clip all colors outside the reference range and compress within that range.</span></span> <span data-ttu-id="16d48-760">Sono disponibili molte possibilità, che possono essere implementate in GMAs diversi.</span><span class="sxs-lookup"><span data-stu-id="16d48-760">There are many possibilities, which can be implemented in different GMAs.</span></span> <span data-ttu-id="16d48-761">Inoltre, GMAs può comprimere e ritagliare in modi diversi.</span><span class="sxs-lookup"><span data-stu-id="16d48-761">Further, the GMAs can compress and clip in different ways.</span></span> <span data-ttu-id="16d48-762">Tutte queste combinazioni sono incluse in questa invenzione.</span><span class="sxs-lookup"><span data-stu-id="16d48-762">All of those combinations are covered within this invention.</span></span>

<span data-ttu-id="16d48-763">Finora in questa discussione, la gamma è stata trattata come se fosse solo una funzione del dispositivo in cui l'immagine è stata creata, acquisita o visualizzata.</span><span class="sxs-lookup"><span data-stu-id="16d48-763">So far in this discussion, the gamut has been treated as if it were solely a function of the device on which the image was created, captured, or displayed.</span></span> <span data-ttu-id="16d48-764">Tuttavia, non esiste alcun motivo per cui tutte le immagini per un dispositivo devono avere lo stesso gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-764">However, there is no reason why all images for a device must have the same gamut.</span></span> <span data-ttu-id="16d48-765">I GMAs dipendono dai dati in GBD.</span><span class="sxs-lookup"><span data-stu-id="16d48-765">The GMAs depend on the data in the GBD.</span></span> <span data-ttu-id="16d48-766">Se il descrittore viene modificato tra le immagini, non esiste alcun modo per la conoscenza del GMAs.</span><span class="sxs-lookup"><span data-stu-id="16d48-766">If the descriptor is changed between images, there is no way for the GMAs to know.</span></span> <span data-ttu-id="16d48-767">In particolare, se le immagini non hanno evidenziazioni speculari, GMAs prestazioni migliori se il descrittore della gamma non mostra che sono presenti colori più chiari rispetto al bianco diffuso.</span><span class="sxs-lookup"><span data-stu-id="16d48-767">In particular, if images have no specular highlights, GMAs perform better if the gamut descriptor does not show that there are colors lighter than diffuse white.</span></span>

<span data-ttu-id="16d48-768">Nella nuova architettura CTE è possibile usare più di un GMA.</span><span class="sxs-lookup"><span data-stu-id="16d48-768">In the new CTE architecture, it is possible to use more than one GMA.</span></span> <span data-ttu-id="16d48-769">L'uso di più GMAs è intrinsecamente definito in modo non corretto.</span><span class="sxs-lookup"><span data-stu-id="16d48-769">Using multiple GMAs is inherently ill-defined.</span></span> <span data-ttu-id="16d48-770">Se, ad esempio, un dispositivo di acquisizione associa un GMA al suo "aspetto", tende a eseguire questa operazione con una gamma di destinazione "mirata".</span><span class="sxs-lookup"><span data-stu-id="16d48-770">For example, if a capture device associates a GMA with its "look and feel," it tends to do so with a "targeted" destination gamut.</span></span> <span data-ttu-id="16d48-771">Lo stesso vale per i dispositivi di output e le gamme di origine "mirate".</span><span class="sxs-lookup"><span data-stu-id="16d48-771">The same is true for output devices and "targeted" source gamuts.</span></span> <span data-ttu-id="16d48-772">La gamut sRGB è una gamma implicita di destinazione comune.</span><span class="sxs-lookup"><span data-stu-id="16d48-772">The sRGB gamut is one commonly targeted implied gamut.</span></span> <span data-ttu-id="16d48-773">Si consiglia pertanto di usare un singolo GMA, se la prevedibilità è una priorità.</span><span class="sxs-lookup"><span data-stu-id="16d48-773">Therefore, it is strongly recommended that you use a single GMA, if predictability is a priority.</span></span> <span data-ttu-id="16d48-774">Un singolo flusso di lavoro GMA dovrebbe essere l'impostazione predefinita per tutti i flussi di lavoro, in particolare i flussi di lavoro consumer e prosumer.</span><span class="sxs-lookup"><span data-stu-id="16d48-774">A single GMA workflow should be the default for all workflows, especially consumer and prosumer workflows.</span></span> <span data-ttu-id="16d48-775">Sebbene il mapping di gamut per la riproduzione preferita venga eseguito una sola volta, sono presenti istanze in cui sono inclusi più processi di mapping.</span><span class="sxs-lookup"><span data-stu-id="16d48-775">While gamut mapping for preferred reproduction should be done one time, there are instances where multiple mapping processes are included.</span></span> <span data-ttu-id="16d48-776">Per prima cosa, per la correzione si esegue un mapping preferenziale alla gamma del dispositivo di destinazione finale, quindi un rendering colorimetrico nella gamma del dispositivo di correzione.</span><span class="sxs-lookup"><span data-stu-id="16d48-776">First, for proofing, you do a preferred mapping to the gamut of the final target device, and then a colorimetric rendering to the gamut of the proofing device.</span></span> <span data-ttu-id="16d48-777">In secondo luogo, alcuni tipi di mapping vengono usati per modificare le caratteristiche dell'immagine, ma non sono inclusi per eseguire il mapping a una gamma di dispositivi, ad esempio per regolare la curva di tono o la cromaticità.</span><span class="sxs-lookup"><span data-stu-id="16d48-777">Second, some types of mapping are used to alter the characteristics of the image, but aren't included to map to a device gamut, for example, adjusting the tone curve or the chromaticity.</span></span> <span data-ttu-id="16d48-778">Se vengono usati più GMAs, l'interfaccia di trasformazione accetta una matrice di mappe di gamut associate, ovvero mappe di gamut che sono state inizializzate con una coppia di descrizioni dei limiti della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-778">If multiple GMAs are used, the transform interface takes an array of bound gamut maps, that is, gamut maps that have been initialized with a pair of gamut boundary descriptions.</span></span> <span data-ttu-id="16d48-779">Quando è presente più di una mappa gamut, il limite della gamma di input per una mappa di gamut successiva deve corrispondere al limite della gamma di output del predecessore.</span><span class="sxs-lookup"><span data-stu-id="16d48-779">When there is more than one gamut map, the input gamut boundary for a succeeding gamut map must be the same as the output gamut boundary of its predecessor.</span></span>

<span data-ttu-id="16d48-780">La funzione limite della gamma di dispositivi accetta il motore del modello di dispositivo e i parametri analitici e deriva un limite di gamut dei dispositivi di colore descritto come un elenco di vertici ordinati della struttura convessa del gamut del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-780">The device gamut boundary function takes the device model engine and analytical parameters and derives a color device gamut boundary described as an ordered vertex list of the convex hull of the device gamut.</span></span> <span data-ttu-id="16d48-781">L'elenco dei vertici ordinati viene archiviato in CIEJab.</span><span class="sxs-lookup"><span data-stu-id="16d48-781">The ordered vertex list is stored in CIEJab.</span></span> <span data-ttu-id="16d48-782">La struttura dell'elenco dei vertici ordinati è ottimizzata per l'accelerazione hardware da DirectX.</span><span class="sxs-lookup"><span data-stu-id="16d48-782">The structure of the ordered vertex list is optimized for hardware acceleration by DirectX.</span></span> <span data-ttu-id="16d48-783">Questo approccio presenta molte soluzioni ben note (cercare "convesso Hull DirectX" sul Web e si ottengono oltre 100 riscontri).</span><span class="sxs-lookup"><span data-stu-id="16d48-783">This approach has many well known solutions (search for "convex hull DirectX" on the web and you get well over 100 hits).</span></span> <span data-ttu-id="16d48-784">In questo argomento è disponibile anche un riferimento a 1983 (teoria grafica del computer e applicazione, "Shiphulls, b-spline Surfaces e CADCAM" pp. 34-49), con riferimenti che risalgono da 1970 a 1982 nell'argomento.</span><span class="sxs-lookup"><span data-stu-id="16d48-784">There is also a reference from 1983 on this topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces and cadcam" pp. 34-49), with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="16d48-785">Per calcolare i triangoli nella shell gamut, è possibile usare due tecniche diverse.</span><span class="sxs-lookup"><span data-stu-id="16d48-785">Two different techniques can be used to compute the triangles in the gamut shell.</span></span> <span data-ttu-id="16d48-786">Per altri dispositivi diversi dai dispositivi RGB aggiuntivi, viene calcolata una struttura convessa.</span><span class="sxs-lookup"><span data-stu-id="16d48-786">For other devices other than additive RGB devices, you compute a convex hull.</span></span> <span data-ttu-id="16d48-787">Se si dispone dell'accesso diretto a tali dispositivi per convalidare l'affidabilità, le prestazioni e la fedeltà degli algoritmi, è possibile valutare il supporto della struttura non convessa per altri dispositivi.</span><span class="sxs-lookup"><span data-stu-id="16d48-787">You can consider investigating non-convex hull support for other devices if you have direct access to such devices to validate the robustness, performance, and fidelity of the algorithms.</span></span> <span data-ttu-id="16d48-788">Si tratta di un processo noto che non richiede una descrizione aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="16d48-788">This is a well-known process that does not require further description.</span></span> <span data-ttu-id="16d48-789">La tecnica usata per i dispositivi RGB aggiuntivi è descritta di seguito.</span><span class="sxs-lookup"><span data-stu-id="16d48-789">The technique used for additive RGB devices is described as follows.</span></span>

<span data-ttu-id="16d48-790">GBDs diversi presentano vantaggi e svantaggi.</span><span class="sxs-lookup"><span data-stu-id="16d48-790">Different GBDs have advantages and drawbacks.</span></span> <span data-ttu-id="16d48-791">La rappresentazione convessa della struttura garantisce proprietà geometriche interessanti, ad esempio sezioni di tonalità convesse che forniscono un punto di intersezione univoco con un raggio che emana da un punto sull'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-791">The convex hull representation guarantees nice geometric properties, such as convex hue slices that provide a unique intersection point with a ray emanating from a point on the neutral axis.</span></span> <span data-ttu-id="16d48-792">Anche il lato negativo della rappresentazione convessa è la convessità.</span><span class="sxs-lookup"><span data-stu-id="16d48-792">The downside of the convex hull representation is also convexity.</span></span> <span data-ttu-id="16d48-793">È noto che molti dispositivi, in particolare i dispositivi di visualizzazione, hanno gamme che non sono più convesse.</span><span class="sxs-lookup"><span data-stu-id="16d48-793">It is known that many devices, specifically display devices, have gamuts that are far from being convex.</span></span> <span data-ttu-id="16d48-794">Se il gamut effettivo devia significativamente dal presupposto della convessità, la rappresentazione della struttura convessa risulterebbe non accurata, probabilmente nella misura in cui non rappresenta la realtà.</span><span class="sxs-lookup"><span data-stu-id="16d48-794">If the actual gamut deviates significantly from the convexity assumption, the convex hull representation would be inaccurate, possibly to the extent that it doesn't represent reality.</span></span>

<span data-ttu-id="16d48-795">Dopo aver adottato un GBD che fornisce una rappresentazione ragionevolmente accurata del gamut reale, si verificano altri problemi, alcuni a causa del concetto di sezione tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-795">After you adopt a GBD that gives a reasonably accurate representation of the actual gamut, other problems arise, some due to the very concept of hue slice.</span></span> <span data-ttu-id="16d48-796">Esistono almeno due situazioni patologiche.</span><span class="sxs-lookup"><span data-stu-id="16d48-796">There are at least two pathological situations.</span></span> <span data-ttu-id="16d48-797">Nella figura seguente, una gamma CRT fornisce le sezioni Hue con "Islands".</span><span class="sxs-lookup"><span data-stu-id="16d48-797">In the following Figure 24, a CRT gamut gives rise to hue slices with "islands."</span></span> <span data-ttu-id="16d48-798">Nella figura 25 una gamma di stampanti viene sollevata in una sezione di tonalità con parte dell'asse neutro mancante.</span><span class="sxs-lookup"><span data-stu-id="16d48-798">In Figure 25, a printer gamut gives rise to a hue slice with part of the neutral axis missing.</span></span> <span data-ttu-id="16d48-799">In questi casi, le sezioni di tonalità patologiche non sono causate da limiti di gamut patologici.</span><span class="sxs-lookup"><span data-stu-id="16d48-799">The pathological hue slices are not caused by particularly pathological gamut boundaries in these cases.</span></span> <span data-ttu-id="16d48-800">Sono causati dal concetto di sezione Hue, perché (a) viene preso in tinta costante e (b) richiede solo una metà del piano che corrisponde all'angolo di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-800">They are caused by the very concept of hue slice, because (a) it is taken along constant hue, and (b) it only takes one-half of the plane that corresponds to the hue angle.</span></span>

![Diagramma che mostra una visualizzazione superiore e una visualizzazione laterale dell'"curvatura in" nelle tonalità blu.](images/gmmp-image097.jpg)

<span data-ttu-id="16d48-802">**Figura 24** : un tipico monitor CRT presenta una gamma che mostra la "curvatura" nelle tonalità blu.</span><span class="sxs-lookup"><span data-stu-id="16d48-802">**Figure 24** : A typical CRT monitor has a gamut that shows peculiar "curving in" in the blue hues.</span></span> <span data-ttu-id="16d48-803">Se vengono rilevate sezioni di tonalità in questo intervallo di tonalità, le isole isolate possono essere visualizzate nelle sezioni tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-803">If hue slices are taken within this hue range, isolated islands may appear in the hue slices.</span></span>

![Diagramma di una gamma con ' Gap ' nell'asse neutro.](images/gmmp-image099.jpg)

<span data-ttu-id="16d48-805">**Figura 25** : una stampante può avere una gamma con "gap" nell'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-805">**Figure 25** : A printer may have a gamut that has "gap" in its neutral axis.</span></span> <span data-ttu-id="16d48-806">Quando viene eseguita una sezione di tonalità (che corrisponde solo a una metà del piano), è presente un "dente" sulla parte del limite che rappresenta l'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-806">When a hue slice is taken (which is only one-half the plane), there is a "dent" on the part of the boundary that is the neutral axis.</span></span> <span data-ttu-id="16d48-807">Questo può essere difficile da risolvere algoritmicamente.</span><span class="sxs-lookup"><span data-stu-id="16d48-807">This can be hard to resolve algorithmically.</span></span>

<span data-ttu-id="16d48-808">Per risolvere queste patologie, viene proposto un nuovo Framework che abbandona il concetto di sezione Hue utilizzata come punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-808">To resolve these pathologies, a new framework is proposed that abandons the concept of hue slice that used as the starting point.</span></span> <span data-ttu-id="16d48-809">Il Framework usa invece il set di "elementi linea limite" o le linee che si trovano sul limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-809">Instead, the framework uses the set of "boundary line elements," or lines that lie on the gamut boundary.</span></span> <span data-ttu-id="16d48-810">Non forniscono necessariamente una visualizzazione geometrica coerente come le sezioni Hue, ma supportano tutte le operazioni di gamut comuni.</span><span class="sxs-lookup"><span data-stu-id="16d48-810">They do not necessarily provide a coherent geometric visualization like hue slices, but they support all the common gamut operations.</span></span> <span data-ttu-id="16d48-811">Oltre a risolvere i problemi citati in precedenza, questo approccio suggerisce anche che la costruzione di sezioni di tonalità, anche quando è possibile, è molto dispendiosa dal punto di vista del calcolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-811">Besides solving the problems mentioned previously, this approach also suggests that the construction of hue slices, even when it is possible, is computationally wasteful.</span></span>

### <a name="triangulation-of-the-gamut-boundary"></a><span data-ttu-id="16d48-812">Triangolazione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-812">Triangulation of the Gamut Boundary</span></span>

<span data-ttu-id="16d48-813">Il punto di partenza è un GBD costituito da una triangolazione del limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-813">The starting point is a GBD consisting of a triangulation of the gamut boundary.</span></span> <span data-ttu-id="16d48-814">I metodi noti per costruire GBDs in genere forniscono la triangolazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-814">Known methods of constructing GBDs usually provide that triangulation.</span></span> <span data-ttu-id="16d48-815">Per concreta, un metodo di costruzione di GBDs per i dispositivi additivi lo spazio del dispositivo è descritto qui.</span><span class="sxs-lookup"><span data-stu-id="16d48-815">For concreteness, one method of constructing GBDs for additive devices its device space is described here.</span></span> <span data-ttu-id="16d48-816">Questi dispositivi includono i monitoraggi (basati su CRT e su LCD) e i proiettori.</span><span class="sxs-lookup"><span data-stu-id="16d48-816">These devices include monitors (both CRT-based and LCD-based) and projectors.</span></span> <span data-ttu-id="16d48-817">La geometria semplice del cubo consente di introdurre un normale reticolo sul cubo.</span><span class="sxs-lookup"><span data-stu-id="16d48-817">The simple geometry of the cube enables you to introduce a regular lattice on the cube.</span></span> <span data-ttu-id="16d48-818">I visi limite del cubo possono essere triangolati in diversi modi, ad esempio quello illustrato nella figura 26.</span><span class="sxs-lookup"><span data-stu-id="16d48-818">The boundary faces of the cube can be triangulated in a number of fashions, such as the one shown in Figure 26.</span></span> <span data-ttu-id="16d48-819">L'architettura fornisce un modello di dispositivo per il dispositivo, in modo che sia possibile ottenere i valori colorimetrico dei punti di reticolo algoritmicamente oppure che le misurazioni siano state effettuate direttamente per tali punti.</span><span class="sxs-lookup"><span data-stu-id="16d48-819">The architecture provides either a device model for the device so that colorimetric values of the lattice points can be obtained algorithmically, or measurements have been made directly for those points.</span></span> <span data-ttu-id="16d48-820">L'architettura fornisce anche CIECAM02, in modo che sia possibile presupporre che i dati iniziali siano già stati mappati nello spazio CIECAM02 jab.</span><span class="sxs-lookup"><span data-stu-id="16d48-820">The architecture also provides CIECAM02, so that you can assume the starting data has already been mapped into CIECAM02 Jab space.</span></span> <span data-ttu-id="16d48-821">Ogni punto di reticolo sui bordi del cubo RGB dispone quindi di un punto corrispondente nello spazio jab.</span><span class="sxs-lookup"><span data-stu-id="16d48-821">Then each lattice point on the boundary faces of the RGB cube has a corresponding point in Jab space.</span></span> <span data-ttu-id="16d48-822">Le connessioni di punti che formano il set di triangoli nello spazio RGB provocano anche un set di triangoli nello spazio jab.</span><span class="sxs-lookup"><span data-stu-id="16d48-822">The connections of points that form the set of triangles in RGB space also induces a set of triangles in Jab space.</span></span> <span data-ttu-id="16d48-823">Questo set di triangoli costituisce una triangolazione ragionevole del limite della gamma se (a) il reticolo sul cubo RGB è sufficiente e (b) la trasformazione dallo spazio del dispositivo allo spazio uniforme del colore è topologicamente ben funzionante. ovvero, esegue il mapping del limite al limite e non trasforma la gamma interna, in modo che i punti interni diventino punti limite.</span><span class="sxs-lookup"><span data-stu-id="16d48-823">This set of triangles forms a reasonable triangulation of the gamut boundary if (a) the lattice on the RGB cube is fine enough, and (b) the transformation from device space to the uniform color space is topologically well-behaved; that is, it maps boundary to boundary, and it doesn't turn the gamut inside out so that interior points become boundary points.</span></span>

![Diagramma che illustra un metodo semplice per triangluate il limite della gamma di un dispositivo con R G B come spazio del dispositivo.](images/gmmp-image100.png)

<span data-ttu-id="16d48-825">**Figura 26** : un metodo semplice per triangolare il limite della gamma di un dispositivo con RGB come spazio del dispositivo</span><span class="sxs-lookup"><span data-stu-id="16d48-825">**Figure 26** : A simple method to triangulate the gamut boundary of a device with RGB as its device space</span></span>

### <a name="boundary-line-elements"></a><span data-ttu-id="16d48-826">Elementi linea limite</span><span class="sxs-lookup"><span data-stu-id="16d48-826">Boundary Line Elements</span></span>

<span data-ttu-id="16d48-827">La centralità di questo Framework è il concetto di elementi linea limite; un set di segmenti di linea che (a) si trovano sul limite della gamma e (b) si trovano su un piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-827">Central to this framework is the concept of boundary line elements; a set of line segments that (a) lie on the gamut boundary, and (b) lie on a plane.</span></span> <span data-ttu-id="16d48-828">In questo caso, il piano è un piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-828">In this case, the plane is a hue plane.</span></span> <span data-ttu-id="16d48-829">Ogni segmento di linea è il risultato dell'intersezione del piano con un triangolo di limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-829">Each line segment is the result of intersecting the plane with a gamut boundary triangle.</span></span> <span data-ttu-id="16d48-830">Anche se molti ricercatori hanno usato la costruzione dell'intersezione di un piano con triangoli limite, in genere analizzano la relazione tra questi segmenti di linea e tentano di costruire un oggetto geometrico coerente tra i segmenti di linea.</span><span class="sxs-lookup"><span data-stu-id="16d48-830">Although many researchers have used the construction of intersecting a plane with boundary triangles, they generally analyze the relationship among these line segments, and attempt to construct a coherent geometric object out of the line segments.</span></span> <span data-ttu-id="16d48-831">Sono stati concepiti algoritmi diversi per seguire questi segmenti di riga uno dopo l'altro fino a quando non viene ottenuta un'intera sezione di tonalità e sono stati effettuati molti tentativi per velocizzare il processo di ricerca.</span><span class="sxs-lookup"><span data-stu-id="16d48-831">Different algorithms have been devised to follow these line segments one after the other until a whole hue slice is obtained, and many attempts have been made to speed up the process of searching.</span></span>

<span data-ttu-id="16d48-832">Questo approccio è diverso.</span><span class="sxs-lookup"><span data-stu-id="16d48-832">This approach is different.</span></span> <span data-ttu-id="16d48-833">Il piano viene intersecato con i triangoli per ottenere i segmenti di linea.</span><span class="sxs-lookup"><span data-stu-id="16d48-833">You intersect the plane with the triangles to obtain the line segments.</span></span> <span data-ttu-id="16d48-834">Questi segmenti di linea vengono quindi considerati come oggetti concettuali di *base* .</span><span class="sxs-lookup"><span data-stu-id="16d48-834">You then consider these line segments as the *basic* conceptual objects.</span></span> <span data-ttu-id="16d48-835">È necessario analizzare la relazione tra i segmenti di linea; non è necessario capire come sono interconnesse tra loro.</span><span class="sxs-lookup"><span data-stu-id="16d48-835">It is necessary to analyze the relationship among the line segments; you don't have to know how they are interconnected with each other.</span></span> <span data-ttu-id="16d48-836">Questo punto di vista consente di risolvere il problema della sezione Hue con le isole.</span><span class="sxs-lookup"><span data-stu-id="16d48-836">This point of view solves the problem of hue slice with islands.</span></span> <span data-ttu-id="16d48-837">Gli approcci noti che tentano di costruire la sezione Hue presuppongono che, se uno inizia con un segmento di linea e lo segue al segmento di riga successivo e così via; Infine, viene restituito il punto iniziale, a quel punto viene costruita un'intera sezione di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-837">The known approaches that attempt to construct hue slice assume that, if one starts with one line segment and follows it to the next line segment, and so on; it eventually leads back to the starting point, at which point a whole hue slice would be constructed.</span></span> <span data-ttu-id="16d48-838">Sfortunatamente, questo approccio potrebbe perdere l'isola (e nello scenario peggiore, il continente).</span><span class="sxs-lookup"><span data-stu-id="16d48-838">Unfortunately, this approach would miss the island (and in the worst scenario, the continent).</span></span> <span data-ttu-id="16d48-839">Senza insistere sull'ottenimento di un'immagine geometrica coerente; ovvero, la sezione Hue consente di gestire facilmente il problema dell'isola.</span><span class="sxs-lookup"><span data-stu-id="16d48-839">By not insisting on obtaining a coherent geometric picture; that is, hue slice, you can handle the island problem effortlessly.</span></span> <span data-ttu-id="16d48-840">Un'altra differenza importante in questo approccio è che, per velocizzare la costruzione di segmenti di linea, viene usato un "filtro triangolo".</span><span class="sxs-lookup"><span data-stu-id="16d48-840">Another important difference in this approach is that, to speed up the construction of line segments, it uses a "triangle filter."</span></span> <span data-ttu-id="16d48-841">Il filtro del triangolo genera determinati triangoli che non produrranno i segmenti di linea che risultano utili nell'operazione di gamut corrente.</span><span class="sxs-lookup"><span data-stu-id="16d48-841">The triangle filter throws out certain triangles that will definitely not produce line segments that would be useful in the current gamut operation.</span></span> <span data-ttu-id="16d48-842">Poiché l'intersezione di un triangolo con il piano è costosa dal punto di vista del calcolo, questo migliora la velocità.</span><span class="sxs-lookup"><span data-stu-id="16d48-842">Because intersecting a triangle with the plane is expensive computationally, this improves speed.</span></span> <span data-ttu-id="16d48-843">Un effetto collaterale è che non è possibile costruire la sezione Hue perché alcuni segmenti di linea risultano mancanti a causa del filtro del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-843">A side effect is that, you cannot construct hue slice because some line segments would be missing due to the triangle filtering.</span></span>

### <a name="gamut-operation-checkgamut"></a><span data-ttu-id="16d48-844">Operazione gamut: CheckGamut</span><span class="sxs-lookup"><span data-stu-id="16d48-844">Gamut Operation: CheckGamut</span></span>

<span data-ttu-id="16d48-845">Nell'esempio seguente viene illustrato il funzionamento del Framework e il modo in cui viene eseguito CheckGamut, vale a dire l'operazione di verifica se un colore è in gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-845">The following example will explain how the framework works, and how CheckGamut is carried out, that is, the operation of checking if a color is in-gamut.</span></span>

<span data-ttu-id="16d48-846">Il framework generale è illustrato nella figura 27 seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-846">The general framework is illustrated in the following Figure 27.</span></span> <span data-ttu-id="16d48-847">Sono disponibili diversi componenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-847">There are various components.</span></span> <span data-ttu-id="16d48-848">I componenti etichettati in corsivo sono componenti che possono essere diversi nell'implementazione a seconda dell'operazione di gamut in questione.</span><span class="sxs-lookup"><span data-stu-id="16d48-848">The components labeled in italics are components that may be different in implementation depending on the gamut operation in question.</span></span> <span data-ttu-id="16d48-849">Gli altri componenti sono invariabili in tutte le operazioni di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-849">The other components are invariant across all gamut operations.</span></span> <span data-ttu-id="16d48-850">Per iniziare, l' ***input*** è un set di attributi di colore.</span><span class="sxs-lookup"><span data-stu-id="16d48-850">To begin, the ***Input*** is a set of color attributes.</span></span> <span data-ttu-id="16d48-851">Nel caso di CheckGamut, è il colore della query.</span><span class="sxs-lookup"><span data-stu-id="16d48-851">In the case of CheckGamut, it is the query color.</span></span> <span data-ttu-id="16d48-852">Nella figura 27 e nella discussione seguente si presuppone che l'angolo di tonalità sia tra gli attributi di colore di input o che possa essere ottenuto da essi.</span><span class="sxs-lookup"><span data-stu-id="16d48-852">In Figure 27 and the following discussion, it is assumed that the hue angle is either among the input color attributes, or can be obtained from them.</span></span> <span data-ttu-id="16d48-853">Questa situazione è evidente se l'input è l'intero punto di colore, in jab o JCh, da cui è possibile calcolare l'angolo di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-853">This is clearly the case if the input is the whole color point, either in Jab or JCh, from which you can then compute the hue angle.</span></span> <span data-ttu-id="16d48-854">Si noti che l'angolo di tonalità è necessario solo perché vengono usati i piani Hue.</span><span class="sxs-lookup"><span data-stu-id="16d48-854">Note that the hue angle is only needed because hue planes are being used.</span></span> <span data-ttu-id="16d48-855">A seconda dell'operazione di gamut in questione, potrebbe non essere necessario usare il piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-855">Depending on the gamut operation in question, it might not be necessary to use the hue plane.</span></span> <span data-ttu-id="16d48-856">Ad esempio, nella costruzione della routine CheckGamut, può essere necessario usare i piani di costante J. Si tratta di una generalità che non verrà utilizzata o discussa ulteriormente; può tuttavia essere utile ricordare questa flessibilità della metodologia per supportare altre operazioni di gamut quando il piano Hue potrebbe non essere la scelta migliore.</span><span class="sxs-lookup"><span data-stu-id="16d48-856">For example, in the construction of the routine CheckGamut, you might want to use planes of constant J. This is a generality that will not be used or discussed further; but it might be helpful to remember this flexibility of the methodology to support other gamut operations when hue plane might not be the best choice.</span></span>

![Diagramma che mostra il flusso per supportare le operazioni di gamut.](images/gmmp-image112.jpg)

<span data-ttu-id="16d48-858">**Figura 27** : Framework per supportare le operazioni di gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-858">**Figure 27** : The framework to support gamut operations</span></span>

<span data-ttu-id="16d48-859">L'angolo di tonalità, ottenuto direttamente dagli input o calcolato dagli input, viene usato per inizializzare il piano di Hue con etichetta **full Hue** nella figura.</span><span class="sxs-lookup"><span data-stu-id="16d48-859">The hue angle, which is obtained directly from the inputs or computed from the inputs, is used to initialize the hue plane labeled **Full Hue Plane** in the figure.</span></span> <span data-ttu-id="16d48-860">Viene enfatizzato "full" poiché si tratta del piano completo, non solo del piano di metà che contiene la tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-860">"Full" is emphasized because this is the full plane, not just the half-plane containing the hue.</span></span> <span data-ttu-id="16d48-861">Il piano completo contiene sia l'angolo di tonalità di input che l'angolo di 180 gradi opposto.</span><span class="sxs-lookup"><span data-stu-id="16d48-861">The full plane contains both the input hue angle and the angle 180 degrees opposite to it.</span></span> <span data-ttu-id="16d48-862">La funzionalità chiave del piano Hue è la funzione Intersect, descritta nella sottosezione seguente, Full Hue Plane: Intersect.</span><span class="sxs-lookup"><span data-stu-id="16d48-862">The key functionality of the hue plane is the Intersect function, which is explained in the following subsection, Full Hue Plane: Intersect.</span></span> <span data-ttu-id="16d48-863">Si supponga che GBD sia già stato costruito e che sia disponibile il set di **triangoli limite gamma** .</span><span class="sxs-lookup"><span data-stu-id="16d48-863">Assume that the GBD has already been constructed, and the set of **Gamut Boundary Triangles** is available.</span></span> <span data-ttu-id="16d48-864">Intersecare i triangoli che sono sopravvissuti al *_filtro triangolo_*\* con il piano di tonalità usando Intersect.</span><span class="sxs-lookup"><span data-stu-id="16d48-864">Intersect the triangles that have survived the \**_Triangle Filter_* _ with the hue plane using Intersect.</span></span> <span data-ttu-id="16d48-865">Il _componente filtro triangolo \* è contrassegnato in corsivo, il che significa che il componente varia nell'implementazione per diverse operazioni di gamut. Il *filtro del triangolo* per CheckGamut è illustrato nella sezione operazione gamut: CheckGamut (continua). Il risultato dell'intersezione di un triangolo con il piano di tonalità è vuoto o un **elemento della linea di limite** , ovvero una coppia di punti distinti. Se il risultato non è vuoto, viene passato al processore di elementi a *_linee_*_ , che esegue nuovamente diverse operazioni a seconda dell'operazione di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-865">The _Triangle Filter\* component is labeled in italics, which means that the component varies in implementation for different gamut operations. The *Triangle Filter* for CheckGamut is explained in the section, Gamut Operation: CheckGamut (continued). The result of intersecting a triangle with the hue plane is either empty or a **Boundary Line Element** , that is, a pair of distinct points. If the result is non-empty, it is passed into the \**_Line Element Processor_*_ , which again does different things depending on the gamut operation.</span></span> <span data-ttu-id="16d48-866">Il _processore di elementi linea \* Aggiorna la struttura dei dati interna, \***dati elaborati interni**_ il cui contenuto o layout dipende anche dall'operazione di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-866">The _Line Element Processor\* updates the internal data structure, \***Internal Processed Data**_ , whose content or layout also depends on the gamut operation.</span></span> <span data-ttu-id="16d48-867">In genere, i _dati elaborati interni \* contengono la risposta al problema, che viene continuamente aggiornata con ogni nuovo elemento linea limite trovato. Quando tutti gli elementi linea limite sono stati elaborati, la risposta è stata trovata. Rimane ad accedervi tramite l'adattatore di **output**_.</span><span class="sxs-lookup"><span data-stu-id="16d48-867">Generally, the _Internal Processed Data\* contains the "answer" to the problem, which is continually updated with each new Boundary Line Element found. When all the Boundary Line Elements have been processed, the answer has been found. It remains to access it through the \***Output Adaptor**_.</span></span> <span data-ttu-id="16d48-868">Poiché i dati elaborati _Internal \* sono specifici dell'operazione di gamma, anche l' *adattatore di output* è specifico dell'operazione di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-868">Because the _Internal Processed Data\* is gamut operation specific, the *Output Adaptor* is also gamut operation specific.</span></span>

### <a name="full-hue-plane-intersect"></a><span data-ttu-id="16d48-869">Piano di Hue completo: Intersect</span><span class="sxs-lookup"><span data-stu-id="16d48-869">Full Hue Plane: Intersect</span></span>

<span data-ttu-id="16d48-870">La funzione Intersect calcola l'intersezione tra il piano di tonalità e un triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-870">The Intersect function calculates the intersection of the hue plane and a triangle.</span></span> <span data-ttu-id="16d48-871">Questa funzione è importante per due motivi.</span><span class="sxs-lookup"><span data-stu-id="16d48-871">As simple as it sounds, this function is important for two reasons.</span></span>

<span data-ttu-id="16d48-872">Prima di tutto, l'intersezione di ogni bordo del triangolo con il piano potrebbe produrre tre punti di intersezione, una situazione geometricamente impossibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-872">First, intersecting each edge of the triangle with the plane might yield three intersection points, a geometrically impossible situation.</span></span> <span data-ttu-id="16d48-873">Il motivo per cui questa situazione potrebbe verificarsi nel calcolo è che, quando i calcoli vengono eseguiti in virgola mobile, ad esempio in formato IEEE, esistono incertezze o "rumore numerico" in ogni passaggio che influiscono sulla conclusione del fatto che un bordo interseca il piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-873">The reason why this might happen in the computation is that, when calculations are done in floating point, for example, IEEE format, there are uncertainties, or "numeric noise," in each step that affects the conclusion of whether an edge intersects the plane.</span></span> <span data-ttu-id="16d48-874">Quando il piano interseca i bordi in una situazione di mancata presenza, i punti di intersezione sono vicini tra loro e la determinazione che un punto di intersezione si trovi all'interno del bordo è casuale.</span><span class="sxs-lookup"><span data-stu-id="16d48-874">When the plane intersects the edges in a near-miss situation, the intersection points are close to each other, and the determination whether an intersection point lies within the edge is random.</span></span> <span data-ttu-id="16d48-875">Sebbene il rumore nei valori numerici dei punti sia piccolo, la conclusione qualitativa che ci sono più di due punti di intersezione è geometricamente impossibile e difficile da gestire correttamente nell'algoritmo.</span><span class="sxs-lookup"><span data-stu-id="16d48-875">Although noise in the numeric values of the points is small, the qualitative conclusion that there are more than two intersection points is geometrically impossible and difficult to handle correctly in the algorithm.</span></span>

<span data-ttu-id="16d48-876">In secondo luogo, questa funzione è nel ciclo critico per ogni bordo di ogni triangolo filtrato, quindi è importante ottimizzarne l'efficienza quanto più possibile.</span><span class="sxs-lookup"><span data-stu-id="16d48-876">Second, this function is in the critical loop for each edge of each filtered triangle, so it is important that you optimize its efficiency as much as possible.</span></span>

<span data-ttu-id="16d48-877">Per risolvere il primo problema del rumore numerico, eseguire i calcoli in numeri interi.</span><span class="sxs-lookup"><span data-stu-id="16d48-877">To address the first issue Of numeric noise, perform the calculations in integers.</span></span> <span data-ttu-id="16d48-878">Per risolvere il secondo problema di ottimizzazione dell'efficienza, memorizzare nella cache l'attributo più usato di ogni vertice o il "prodotto a punti" associato a ogni vertice.</span><span class="sxs-lookup"><span data-stu-id="16d48-878">To address the second issue of optimizing its efficiency, cache the most used attribute of each vertex, or the "dot product" associated with each vertex.</span></span> <span data-ttu-id="16d48-879">Il passaggio in numeri interi è un modo tipico per garantire la coerenza geometrica.</span><span class="sxs-lookup"><span data-stu-id="16d48-879">Passing into integers is a typical way to guarantee geometric consistency.</span></span> <span data-ttu-id="16d48-880">L'idea di base è che se è necessario quantizzare, eseguire l'operazione all'inizio.</span><span class="sxs-lookup"><span data-stu-id="16d48-880">The basic idea is that if you have to quantize, do it at the beginning.</span></span> <span data-ttu-id="16d48-881">I calcoli successivi possono essere eseguiti in numeri interi e se i numeri interi sono sufficientemente ampi, in modo che non vi sia alcun rischio di overflow, è possibile eseguire calcoli con una precisione infinita.</span><span class="sxs-lookup"><span data-stu-id="16d48-881">Then subsequent calculations can be performed in integers, and if the integers are wide enough so that there is no danger of overflow, the calculations can be done with infinite precision.</span></span> <span data-ttu-id="16d48-882">La funzione di quantizzazione seguente è utile a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="16d48-882">The following quantization function useful for this purpose.</span></span>

<span data-ttu-id="16d48-883">ScaleAndTruncate (x) = parte intera di x \* 10000</span><span class="sxs-lookup"><span data-stu-id="16d48-883">ScaleAndTruncate(x) = Integer part of x\*10000</span></span>

<span data-ttu-id="16d48-884">Il fattore di scala 10000 indica che il numero a virgola mobile di input ha quattro posizioni decimali, che è sufficientemente preciso per questa applicazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-884">The scaling factor 10000 means that the input floating-point number has four decimal places, which is precise enough for this application.</span></span> <span data-ttu-id="16d48-885">A seconda dell'intervallo di valori dello spazio aspetto colore, si desidera scegliere un tipo integer con bit sufficientemente ampio da includere i calcoli intermedi.</span><span class="sxs-lookup"><span data-stu-id="16d48-885">Depending on the range of values of the color appearance space, you want to choose an integer type with bits wide enough to hold the intermediate calculations.</span></span> <span data-ttu-id="16d48-886">Nella maggior parte degli spazi di aspetto dei colori, l'intervallo di ogni coordinata rientra nell'intervallo compreso tra-1.000 e 1.000.</span><span class="sxs-lookup"><span data-stu-id="16d48-886">In most color appearance spaces, the range of each coordinate is within the range -1,000 to 1,000.</span></span> <span data-ttu-id="16d48-887">La coordinata quantizzata ha un valore assoluto massimo possibile di 1.000 \* 10.000 = 10 milioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-887">The quantized coordinate has a maximum possible absolute value of 1,000\*10,000 = 10,000,000.</span></span> <span data-ttu-id="16d48-888">Come si vedrà, la quantità intermedia è un prodotto a virgola, ovvero una somma di due prodotti di coordinate, quindi il valore massimo possibile assoluto è 2 \* (10 milioni) ₂ = 2? 10 ₁ ₄.</span><span class="sxs-lookup"><span data-stu-id="16d48-888">As you will see, the intermediate quantity is a dot product, which is a sum of two products of coordinates, so it has a maximum possible absolute value of 2\*(10,000,000) ₂ = 2?10 ₁₄.</span></span> <span data-ttu-id="16d48-889">Il numero di bit richiesti è log ₂ (2? 10 ₁ ₄) = 47,51.</span><span class="sxs-lookup"><span data-stu-id="16d48-889">The number of bits required is log ₂ (2?10 ₁₄ ) = 47.51.</span></span> <span data-ttu-id="16d48-890">Una scelta ottimale per il tipo Integer è, pertanto, gli Integer a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="16d48-890">A convenient choice for the integer type is, therefore, 64-bit integers.</span></span>

<span data-ttu-id="16d48-891">Per garantire che l'intersezione di un piano con un triangolo fornisca sempre un set vuoto o un set di due punti, è necessario prendere in considerazione il triangolo nel suo complesso, non come singoli bordi del triangolo separatamente.</span><span class="sxs-lookup"><span data-stu-id="16d48-891">To guarantee that intersecting a plane with a triangle always gives either empty set or a set of two points, you must consider the triangle as a whole, not as individual edges of the triangle separately.</span></span> <span data-ttu-id="16d48-892">Per comprendere la situazione geometrica, prendere in considerazione le "distanze con segno" dei vertici del triangolo dal piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-892">To understand the geometric situation, consider the "signed distances" of the vertices of the triangle from the hue plane.</span></span> <span data-ttu-id="16d48-893">Non calcolare direttamente queste distanze firmate; calcolare invece i prodotti punto dei vettori di posizione dei vertici con il vettore normale quantizzato al piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-893">Do not calculate these signed distances directly; instead calculate the dot products of the position vectors of the vertices with the quantized normal vector to the plane.</span></span> <span data-ttu-id="16d48-894">In particolare, durante l'inizializzazione del piano di tonalità, il vettore normale quantizzato viene calcolato come segue.</span><span class="sxs-lookup"><span data-stu-id="16d48-894">More specifically, during the initialization of the hue plane, the quantized normal vector is calculated as follows.</span></span>

<span data-ttu-id="16d48-895">NormalVector = (ScaleAndTruncate (-sin (Hue)), ScaleAndTruncate (cos (Hue)))</span><span class="sxs-lookup"><span data-stu-id="16d48-895">NormalVector = (ScaleAndTruncate(-sin(hue)), ScaleAndTruncate(cos(hue)))</span></span>

<span data-ttu-id="16d48-896">Si noti che questo vettore è un vettore bidimensionale.</span><span class="sxs-lookup"><span data-stu-id="16d48-896">Note that this vector is a two-dimensional vector.</span></span> <span data-ttu-id="16d48-897">È possibile usare un vettore bidimensionale perché il piano Hue è verticale, quindi il terzo componente del vettore normale è sempre zero.</span><span class="sxs-lookup"><span data-stu-id="16d48-897">You can use a two-dimensional vector because the hue plane is vertical, so the third component of the normal vector is always zero.</span></span> <span data-ttu-id="16d48-898">Inoltre, una tabella di ricerca di prodotti punto viene inizializzata in modo da includere una voce per ogni vertice tra i triangoli dei limiti della gamma e il prodotto punto corrispondente impostato su un valore non valido.</span><span class="sxs-lookup"><span data-stu-id="16d48-898">Moreover, a lookup table of dot products is initialized to have an entry for each vertex from the Gamut Boundary Triangles and the corresponding dot product set to an invalid value.</span></span>

<span data-ttu-id="16d48-899">Durante un'operazione di intersezione del piano Hue con un triangolo, viene ricercato il prodotto punto di ogni vertice del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-899">During one operation of intersecting the hue plane with a triangle, the dot product of each vertex of the triangle is looked up.</span></span> <span data-ttu-id="16d48-900">Se il valore nella tabella di ricerca è un valore non valido, il prodotto punto viene calcolato usando l'espressione seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-900">If the value in the lookup table is the invalid value, then the dot product is computed using the following expression.</span></span>

<span data-ttu-id="16d48-901">NormalVector. a \* ScaleAndTruncate (Vertex. a) + NormalVector. b \* ScaleAndTruncate (Vertex. b)</span><span class="sxs-lookup"><span data-stu-id="16d48-901">NormalVector.a\*ScaleAndTruncate(vertex.a) + NormalVector.b\*ScaleAndTruncate(vertex.b)</span></span>

<span data-ttu-id="16d48-902">Anche in questo caso, il componente J del vertice non viene mai usato, perché il vettore normale è orizzontale.</span><span class="sxs-lookup"><span data-stu-id="16d48-902">Again, the J-component of the vertex is never used, because the normal vector is horizontal.</span></span> <span data-ttu-id="16d48-903">Questo prodotto a virgola viene quindi salvato nella tabella di ricerca in modo che non debba essere ricalcolato se viene eseguita una query in un secondo momento sul prodotto del vertice.</span><span class="sxs-lookup"><span data-stu-id="16d48-903">This dot product is then saved in the lookup table so that it doesn't have to be computed again if the dot product of the vertex is queried later.</span></span>

<span data-ttu-id="16d48-904">La memorizzazione nella cache consente di determinare rapidamente se un bordo interseca il piano, dopo che i prodotti punto sono stati catalogati nella tabella di ricerca, compilata progressivamente man mano che vengono elaborati i vertici.</span><span class="sxs-lookup"><span data-stu-id="16d48-904">Caching allows for a quick determination of whether an edge intersects the plane, after the dot products are tabulated in the lookup table, which is built progressively as the vertices are processed.</span></span>

![Diagramma che mostra l'intersezione del piano di tonalità con un triangolo.](images/gmmp-image114.jpg)

<span data-ttu-id="16d48-906">**Figura 28** : intersezione del piano Hue con un triangolo</span><span class="sxs-lookup"><span data-stu-id="16d48-906">**Figure 28** : Intersecting the hue plane with a triangle</span></span>

<span data-ttu-id="16d48-907">Per il triangolo nella figura 28 per intersecare il piano Hue in un segmento di linea non degenerate, i prodotti punto dei vertici devono trovarsi in uno dei modelli seguenti, se ordinati in ordine crescente.</span><span class="sxs-lookup"><span data-stu-id="16d48-907">For the triangle in Figure 28 to intersect the hue plane in a non-degenerate line segment, the dot products of the vertices must be in one of the following patterns, when sorted in ascending order.</span></span>

<span data-ttu-id="16d48-908">0, 0, +; -,0, 0; -, 0, +; -,-,+; -,+,+</span><span class="sxs-lookup"><span data-stu-id="16d48-908">0,0,+; -,0,0; -,0,+; -,-,+; -,+,+</span></span>

<span data-ttu-id="16d48-909">Un punto finale del segmento di linea si verifica quando il piano viene intersecato da un bordo con vertici con segni diversi nel prodotto del punto.</span><span class="sxs-lookup"><span data-stu-id="16d48-909">An end point of the line segment arises when the plane is intersected by an edge with vertices that have different signs in the dot product.</span></span> <span data-ttu-id="16d48-910">Se il segno è zero, il vertice si trova direttamente sul piano e l'intersezione del bordo con il piano è il vertice stesso.</span><span class="sxs-lookup"><span data-stu-id="16d48-910">If the sign is zero, then the vertex lies right on the plane, and the intersection of the edge with the plane is the vertex itself.</span></span> <span data-ttu-id="16d48-911">Si noti anche che i case 0, 0, 0; -,-, 0; 0, +, + non vengono segnalati.</span><span class="sxs-lookup"><span data-stu-id="16d48-911">Note also that the cases 0,0,0; -,-,0; 0,+,+ are not reported.</span></span> <span data-ttu-id="16d48-912">Il primo caso (0, 0, 0) indica che l'intero triangolo si trova sul piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-912">The first case (0,0,0) means the whole triangle lies on the plane.</span></span> <span data-ttu-id="16d48-913">Questo non viene segnalato perché ogni bordo del triangolo deve appartenere a un triangolo adiacente che non si trova interamente sul piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-913">This is not reported because each edge of the triangle should belong to a neighboring triangle that does not also lie entirely on the plane.</span></span> <span data-ttu-id="16d48-914">Il bordo verrà segnalato quando il triangolo viene considerato.</span><span class="sxs-lookup"><span data-stu-id="16d48-914">The edge will be reported when that triangle is considered.</span></span> <span data-ttu-id="16d48-915">Gli altri due casi (-,-, 0 e 0, +, +) corrispondono alla configurazione geometrica che il triangolo tocca il piano in un vertice.</span><span class="sxs-lookup"><span data-stu-id="16d48-915">The other two cases (-,-,0 and 0,+,+) correspond to the geometric configuration that the triangle touches the plane in one vertex.</span></span> <span data-ttu-id="16d48-916">Questi casi non vengono segnalati perché non danno luogo a un segmento di linea non degenerate.</span><span class="sxs-lookup"><span data-stu-id="16d48-916">These cases are not reported because they don't give rise to a non-degenerate line segment.</span></span>

<span data-ttu-id="16d48-917">L'algoritmo precedente determina quando calcolare un'intersezione tra un bordo del triangolo e il piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-917">The preceding algorithm determines when to calculate an intersection between an edge of the triangle and the hue plane.</span></span> <span data-ttu-id="16d48-918">Dopo aver determinato un bordo, l'intersezione viene calcolata usando equazioni parametriche.</span><span class="sxs-lookup"><span data-stu-id="16d48-918">After an edge is determined, the intersection is calculated using parametric equations.</span></span> <span data-ttu-id="16d48-919">Se uno dei prodotti punto è zero, l'intersezione è il vertice stesso, quindi non è necessario alcun calcolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-919">If one of the dot products is zero, the intersection is the vertex itself, so no calculation is necessary.</span></span> <span data-ttu-id="16d48-920">Supponendo che entrambi i prodotti punto dei vertici del perimetro siano diversi da zero, vertex1 è il vertice con il punto *negativo* prodotto dotProduct1; e VERTEX2 è il vertice con dotProduct2 punto *positivo* prodotto.</span><span class="sxs-lookup"><span data-stu-id="16d48-920">Assuming that both dot products of the vertices of the edge are non-zero , vertex1 is the vertex with *negative* dot product dotProduct1; and vertex2 is the vertex with *positive* dot product dotProduct2.</span></span> <span data-ttu-id="16d48-921">Questo ordine è importante per garantire che il punto di intersezione calcolato non dipenda dal modo in cui viene visualizzato l'ordine dei vertici nella rappresentazione del bordo.</span><span class="sxs-lookup"><span data-stu-id="16d48-921">This order is important to ensure that the calculated intersection point does not depend on how the ordering of the vertices appears in the representation of the edge.</span></span> <span data-ttu-id="16d48-922">Il concetto geometrico del perimetro è simmetrico rispetto ai vertici.</span><span class="sxs-lookup"><span data-stu-id="16d48-922">The geometric concept of the edge is symmetrical with respect to its vertices.</span></span> <span data-ttu-id="16d48-923">L'aspetto computazionale dell'uso di equazioni parametriche del perimetro introduce l'asimmetria (scelta del vertice iniziale), che può fornire un punto di intersezione leggermente diverso a causa del rumore numerico e del condizionamento delle equazioni lineari da risolvere.</span><span class="sxs-lookup"><span data-stu-id="16d48-923">The computational aspect of using parametric equations of the edge introduces asymmetry (choice of starting vertex), which may give a slightly different intersection point due to numeric noise and conditioning of the linear equations to be solved.</span></span> <span data-ttu-id="16d48-924">In questo modo, il punto di intersezione, intersezione, viene fornito dal codice seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-924">With this said, the intersection point, intersection,is given by the following.</span></span>

<span data-ttu-id="16d48-925">t = dotProduct1/(dotProduct1-dotProduct2)</span><span class="sxs-lookup"><span data-stu-id="16d48-925">t = dotProduct1/(dotProduct1 - dotProduct2)</span></span>

<span data-ttu-id="16d48-926">intersezione. J = vertex1. J + t \* (VERTEX2. J-vertex1. J</span><span class="sxs-lookup"><span data-stu-id="16d48-926">intersection.J = vertex1.J + t \* (vertex2.J - vertex1.J)</span></span>

<span data-ttu-id="16d48-927">intersezione. a = vertex1. a + t \* (VERTEX2. a-vertex1. a)</span><span class="sxs-lookup"><span data-stu-id="16d48-927">intersection.a = vertex1.a + t \* (vertex2.a - vertex1.a)</span></span>

<span data-ttu-id="16d48-928">intersezione. b = vertex1. b + t \* (VERTEX2. b-vertex1. b)</span><span class="sxs-lookup"><span data-stu-id="16d48-928">intersection.b = vertex1.b + t \* (vertex2.b - vertex1.b)</span></span>

### <a name="gamut-operation-checkgamut-continued"></a><span data-ttu-id="16d48-929">Operazione gamut: CheckGamut (continua)</span><span class="sxs-lookup"><span data-stu-id="16d48-929">Gamut Operation: CheckGamut (continued)</span></span>

<span data-ttu-id="16d48-930">L'algoritmo geometrico di base usato per la verifica del gamut consiste nel contare il numero di incroci del raggio.</span><span class="sxs-lookup"><span data-stu-id="16d48-930">The basic geometric algorithm used for gamut checking is to count the number of ray crossings.</span></span> <span data-ttu-id="16d48-931">Per un determinato punto di query, prendere in considerazione un raggio che inizia con il punto di query e punta verso l'alto (direzione J).</span><span class="sxs-lookup"><span data-stu-id="16d48-931">For a given query point, consider a ray starting with the query point and pointing upwards (J-direction).</span></span> <span data-ttu-id="16d48-932">Contare il numero di volte in cui questo raggio supera il limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-932">Count the number of times this ray crosses the gamut boundary.</span></span> <span data-ttu-id="16d48-933">Se questo numero è pari, il punto di query è fuori gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-933">If this number is even, then the query point is out-of-gamut.</span></span> <span data-ttu-id="16d48-934">Se questo numero è dispari, il punto si trova all'interno.</span><span class="sxs-lookup"><span data-stu-id="16d48-934">If this number is odd, the point is inside.</span></span> <span data-ttu-id="16d48-935">In linea di principio, questo algoritmo può essere implementato in 3D, in genere è afflitto da problemi causati da situazioni degenerate, ad esempio il raggio (in parte) in un triangolo limite o degenerazione di dimensioni inferiori, ad esempio il raggio (in parte) in un bordo di un triangolo di limite.</span><span class="sxs-lookup"><span data-stu-id="16d48-935">In principle, this algorithm can be implemented in 3-D, it is generally plagued by difficulties caused by degenerate situations, such as the ray lying (partly) on a boundary triangle, or lower dimensional degeneracy, such as the ray lying (partly) on an edge of a boundary triangle.</span></span> <span data-ttu-id="16d48-936">Anche in 2-D, è necessario gestire queste situazioni degenerate. Tuttavia, il problema è più semplice ed è stato risolto in modo soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="16d48-936">Even in 2-D, you have to deal with these degenerate situations; but the problem is simpler and has been addressed in a satisfactory manner.</span></span> <span data-ttu-id="16d48-937">Vedere \[ Rourke \] .</span><span class="sxs-lookup"><span data-stu-id="16d48-937">See \[O'Rourke\].</span></span>

<span data-ttu-id="16d48-938">Per un determinato punto di input diretto, determinare il relativo angolo di tonalità h, come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="16d48-938">For a given input point Jab, determine its hue angle h as follows.</span></span>

<span data-ttu-id="16d48-939">h = Atan (b/a),</span><span class="sxs-lookup"><span data-stu-id="16d48-939">h = atan(b/a),</span></span>

<span data-ttu-id="16d48-940">Inizializzare il piano di tonalità, quindi determinare gli elementi della linea limite corrispondenti a questo piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-940">Initialize the hue plane, and then determine the Boundary Line Elements corresponding to this hue plane.</span></span> <span data-ttu-id="16d48-941">Poiché gli elementi della linea limite sono rilevanti solo se intersecano il raggio ascendente, impostare un filtro triangolo per rimuovere i triangoli che forniscono elementi linea che non intersecano definitivamente il raggio ascendente.</span><span class="sxs-lookup"><span data-stu-id="16d48-941">Because the Boundary Line Elements are only relevant if they intersect the upward ray, set up a Triangle Filter to remove triangles that give line elements that definitely will not intersect the upward ray.</span></span> <span data-ttu-id="16d48-942">In questo caso, si consideri il rettangolo di delimitazione del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-942">In this case, consider the bounding box of the triangle.</span></span> <span data-ttu-id="16d48-943">Il raggio ascendente non interseca il triangolo se il punto di query si trova al di fuori del cast "Shadow" dal rettangolo di delimitazione se una sorgente di luce è stata immediatamente sopra.</span><span class="sxs-lookup"><span data-stu-id="16d48-943">The upward ray will not intersect the triangle if the query point is outside the "shadow" cast by the bounding box if a light source was directly above.</span></span> <span data-ttu-id="16d48-944">Ingrandire leggermente questo valore con una tolleranza prefissa per consentire un rumore numerico, in modo da non eliminare inavvertitamente triangoli che potrebbero fornire elementi linea utili.</span><span class="sxs-lookup"><span data-stu-id="16d48-944">Inflate this slightly with a pre-fixed tolerance to allow for numeric noise so that you don't inadvertently throw away triangles that might give useful line elements.</span></span> <span data-ttu-id="16d48-945">Il risultato è il cilindro rettangolare semi-infinito illustrato nella Figura 29.</span><span class="sxs-lookup"><span data-stu-id="16d48-945">The result is the semi-infinite rectangular cylinder shown in Figure 29.</span></span> <span data-ttu-id="16d48-946">Controllare se il punto di query si trova all'interno o all'esterno di questo cilindro può essere implementato in modo efficiente usando semplici disuguaglianze.</span><span class="sxs-lookup"><span data-stu-id="16d48-946">Checking whether the query point is inside or outside this cylinder can be efficiently implemented using simple inequalities.</span></span>

![Mostra il filtro del triangolo per CheckGamut.](images/gmmp-image116.jpg)

<span data-ttu-id="16d48-948">**Figura 29** : filtro triangolo per CheckGamut</span><span class="sxs-lookup"><span data-stu-id="16d48-948">**Figure 29** : Triangle Filter for CheckGamut</span></span>

<span data-ttu-id="16d48-949">CheckGamut dispone di tre componenti specifici per le operazioni di gamma: *dati elaborati interni*,*elaboratore di elementi linea* e *adattatore di output*.</span><span class="sxs-lookup"><span data-stu-id="16d48-949">CheckGamut has three gamut operation specific components: *Internal Processed Data*,*Line Element Processor*, and *Output Adaptor*.</span></span> <span data-ttu-id="16d48-950">I *dati elaborati interni* sono un elenco di elementi linea elaborati dal *processore di elementi linea*.</span><span class="sxs-lookup"><span data-stu-id="16d48-950">The *Internal Processed Data* is a list of line elements that have been processed by *Line Element Processor*.</span></span> <span data-ttu-id="16d48-951">In questo caso, il *processore di elementi linea* aggiunge semplicemente un elemento linea all'elenco.</span><span class="sxs-lookup"><span data-stu-id="16d48-951">In this case, the *Line Element Processor* simply adds a line element to the list.</span></span> <span data-ttu-id="16d48-952">La struttura dei dati interni per i *dati elaborati interni* può essere un elenco collegato o una matrice che può aumentare di dimensioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-952">The internal data structure for *Internal Processed Data* can be either a linked list or an array that can grow in size.</span></span>

<span data-ttu-id="16d48-953">L' *adattatore di output* è un modulo che accede all'elenco di elementi linea, determina se un elemento linea incrocia il raggio ascendente (conteggio 1) o meno (conteggio 0).</span><span class="sxs-lookup"><span data-stu-id="16d48-953">The *Output Adaptor* is a module that accesses the list of line elements, determines if a line element crosses the upward ray (count 1) or not (count 0).</span></span> <span data-ttu-id="16d48-954">Sommando tutti questi conteggi si ottiene un conteggio totale.</span><span class="sxs-lookup"><span data-stu-id="16d48-954">Summing all these counts gives a total count.</span></span> <span data-ttu-id="16d48-955">In definitiva, l' *adattatore di output* restituisce una risposta di "Sì" (in-gamut) o "No" (out-of-gamut), a seconda che il conteggio totale sia dispari o uniforme.</span><span class="sxs-lookup"><span data-stu-id="16d48-955">The *Output Adaptor* ultimately outputs an answer of "yes" (in-gamut) or "no" (out-of-gamut), depending on whether the total count is odd or even.</span></span> <span data-ttu-id="16d48-956">Il passaggio in cui si determina se un elemento linea incrocia il raggio ascendente merita un'attenzione perché questo è il punto in cui si verifica il problema di degenerazione e anche il problema del conteggio eccessivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-956">The step where you determine if a line element crosses the upward ray deserves some attention because this is where the problem of degeneracy arises and also the problem of over-counting arises.</span></span> <span data-ttu-id="16d48-957">Dopo \[ l' \] elemento Rourke, affinché un elemento Line attraversi il raggio, l'endpoint destro (il punto finale con Chroma maggiore) deve essere rigorosamente sul lato destro del raggio.</span><span class="sxs-lookup"><span data-stu-id="16d48-957">Following \[O'Rourke\], for a line element to cross the ray, the right end point (the end point with larger chroma) must be strictly on the right side of the ray.</span></span> <span data-ttu-id="16d48-958">Ciò garantisce che, se un punto finale si trova esattamente sul raggio, viene conteggiato una sola volta.</span><span class="sxs-lookup"><span data-stu-id="16d48-958">This guarantees that, if an end point ever lies exactly on the ray, it is only counted one time.</span></span> <span data-ttu-id="16d48-959">La stessa regola consente inoltre di risolvere la situazione di degenerazione in cui l'elemento riga si trova esattamente sul raggio.</span><span class="sxs-lookup"><span data-stu-id="16d48-959">The same rule also solves the degenerate situation where the line element lies exactly on the ray.</span></span> <span data-ttu-id="16d48-960">Non si incrementa il conteggio per questo elemento linea.</span><span class="sxs-lookup"><span data-stu-id="16d48-960">You do not increment the count for this line element.</span></span>

<span data-ttu-id="16d48-961">La figura 30 Mostra gli elementi riga risultanti di una gamut di esempio con il punto di query in varie posizioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-961">Figure 30 shows the resulting line elements of a sample gamut with the query point in various positions.</span></span>

![Diagramma che Mostra gli elementi riga risultanti di una gamut di esempio con il punto di query in varie posizioni.](images/gmmp-image118.jpg)

<span data-ttu-id="16d48-963">**Figura 30** : funzionamento di CheckGamut</span><span class="sxs-lookup"><span data-stu-id="16d48-963">**Figure 30** : How CheckGamut works</span></span>

### <a name="minimum-color-difference-gamut-mapping"></a><span data-ttu-id="16d48-964">Mapping del gamut di differenza colore minimo</span><span class="sxs-lookup"><span data-stu-id="16d48-964">Minimum Color Difference Gamut Mapping</span></span>

<span data-ttu-id="16d48-965">Il mapping del gamut dei colori minimo, MinDEMap, presenta una specifica semplice: se un colore è in gamut, non eseguire alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-965">The Minimum Color Difference Gamut Mapping, MinDEMap, has a simple specification: If a color is in-gamut, do nothing.</span></span> <span data-ttu-id="16d48-966">Se un colore è esterno al gamut, proiettarlo sul punto "più vicino" sul limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-966">If a color is out-of-gamut, project it to the "nearest" point on the gamut boundary.</span></span> <span data-ttu-id="16d48-967">La parola chiave "più vicina" non è ben definita fino a quando non si specifica l'equazione di differenza dei colori da usare.</span><span class="sxs-lookup"><span data-stu-id="16d48-967">The keyword "nearest" is not well-defined until you specify which color difference equation to use.</span></span> <span data-ttu-id="16d48-968">In pratica, per semplificare e velocizzare il calcolo, la distanza euclidea dello spazio di aspetto dei colori scelto o una variante di esso viene utilizzata come metrica di differenza dei colori.</span><span class="sxs-lookup"><span data-stu-id="16d48-968">In practice, to make computation easier and faster, the Euclidean distance of the chosen color appearance space, or a variant of it, is used as the color difference metric.</span></span> <span data-ttu-id="16d48-969">Il vantaggio della metrica euclidea è che è compatibile con il prodotto a punti dello spazio, che rende possibile l'uso di algebra lineare.</span><span class="sxs-lookup"><span data-stu-id="16d48-969">The advantage of the Euclidean metric is that it is compatible with the dot product of the space, which makes it possible to use linear algebra.</span></span> <span data-ttu-id="16d48-970">In dettaglio, se nello spazio viene definito un "prodotto punto", è possibile definire una distanza come radice quadrata del prodotto a punti del vettore di differenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-970">In detail, if a "dot product" is defined in the space, then a distance can be defined as the square root of the dot product of the difference vector with itself.</span></span> <span data-ttu-id="16d48-971">Un prodotto a virgola può in genere essere definito da una matrice 3x3 positiva definita A.</span><span class="sxs-lookup"><span data-stu-id="16d48-971">A dot product can generally be defined by a positive definite 3x3 matrix A.</span></span>

<span data-ttu-id="16d48-972">u? v = u <sub>T</sub> AV</span><span class="sxs-lookup"><span data-stu-id="16d48-972">u?v = u <sub>T</sub> Av</span></span>

<span data-ttu-id="16d48-973">dove il lato destro corrisponde alla moltiplicazione di matrice consueta.</span><span class="sxs-lookup"><span data-stu-id="16d48-973">where the right hand side is the usual matrix multiplication.</span></span> <span data-ttu-id="16d48-974">Se è la matrice di identità, viene recuperato il prodotto A virgola standard.</span><span class="sxs-lookup"><span data-stu-id="16d48-974">If A is the identity matrix, the standard dot product is recovered.</span></span> <span data-ttu-id="16d48-975">In pratica, se jab è lo spazio colore, non si desidera combinare i componenti, pertanto è possibile utilizzare una matrice diagonale diversa dalla matrice di identità.</span><span class="sxs-lookup"><span data-stu-id="16d48-975">In practice, if Jab is the color space, you do not want to mix up the components, so a diagonal matrix other than the identity matrix can be used.</span></span> <span data-ttu-id="16d48-976">Inoltre, potrebbe essere necessario mantenere la scala su a e b invariata in modo che la misura di tonalità venga mantenuta.</span><span class="sxs-lookup"><span data-stu-id="16d48-976">In addition, you might want to keep the scale on a and b unchanged so that the measure of hue is preserved.</span></span> <span data-ttu-id="16d48-977">Quindi, una variante utile del prodotto standard euclideo dot è la seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-977">So a useful variation of the standard Euclidean dot product is the following.</span></span>

<span data-ttu-id="16d48-978">w <sub>j</sub> (j componente di te) (j component of v) + (un componente di te) (componente di v) + (componente b di te) (componente b di v)</span><span class="sxs-lookup"><span data-stu-id="16d48-978">w <sub>J</sub> (J component of u)(J component of v) + (a component of u)(a component of v) + (b component of u)(b component of v)</span></span>

<span data-ttu-id="16d48-979">dove w <sub>J</sub> è un numero positivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-979">where w <sub>J</sub> is a positive number.</span></span> <span data-ttu-id="16d48-980">Un'ulteriore variazione consiste nel consentire a w <sub>J</sub> di variare con il punto di query di input:</span><span class="sxs-lookup"><span data-stu-id="16d48-980">One further variation is to let w <sub>J</sub> vary with the input query point:</span></span>

<span data-ttu-id="16d48-981">w <sub>j \ =</sub> w <sub>j</sub> (queryPoint)</span><span class="sxs-lookup"><span data-stu-id="16d48-981">w <sub>J\ =</sub> w <sub>J</sub> (queryPoint)</span></span>

<span data-ttu-id="16d48-982">Il risultato finale è una misura della distanza asimmetrica rispetto ai due punti e con pesi relativi diversi sulla luminosità e Chroma o Hue quando il punto di query di input varia.</span><span class="sxs-lookup"><span data-stu-id="16d48-982">The end result is a measure of distance that is asymmetric with respect to the two points, and with different relative weights on lightness and chroma or hue as the input query point varies.</span></span> <span data-ttu-id="16d48-983">In conformità con alcune osservazioni sulla percezione dei colori umani, le differenze di colore non vengono ponderate in modo uniforme in tutte le dimensioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-983">This is in accordance with some observations about human color perception that color differences are not weighted equally in all dimensions.</span></span> <span data-ttu-id="16d48-984">È stato rilevato che le persone sono meno sensibili alle differenze di luminosità rispetto a quelle di Hue e Chroma.</span><span class="sxs-lookup"><span data-stu-id="16d48-984">It has been found that people are less sensitive to differences in lightness than they are to differences in hue and chroma.</span></span>

<span data-ttu-id="16d48-985">La funzione Weight seguente è utile.</span><span class="sxs-lookup"><span data-stu-id="16d48-985">The following weight function is useful.</span></span>

<span data-ttu-id="16d48-986">w <sub>J</sub> = k ₂-k ₁ (C-c m ₐ ₓ) n</span><span class="sxs-lookup"><span data-stu-id="16d48-986">w <sub>J</sub> = k ₂ - k ₁ (C - C ₘₐₓ ) ₙ</span></span>

<span data-ttu-id="16d48-987">dove k ₂ = 1, k ₁ = 0,75/(C m ₐ ₓ) n, C m ₐ ₓ = 100, n = 2 e C è il più piccolo di Chroma del punto di query e C m ₐ ₓ.</span><span class="sxs-lookup"><span data-stu-id="16d48-987">where k ₂ = 1, k ₁ = 0.75/(C ₘₐₓ ) ₙ, C ₘₐₓ = 100, n = 2 and C is the smaller of chroma of the query point and C ₘₐₓ.</span></span>

<span data-ttu-id="16d48-988">in modo che un peso di 0,25 venga inserito nel termine J quando Chroma è zero e un peso di 1 quando Chroma è 100.</span><span class="sxs-lookup"><span data-stu-id="16d48-988">so that a weight of 0.25 is put on the J term when chroma is zero, and a weight of 1 when chroma is 100.</span></span> <span data-ttu-id="16d48-989">La tendenza a mettere un peso minore su J quando Chroma è piccola e un peso maggiore su J quando Chroma è grande segue l'utilizzo consigliato per CMC e CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="16d48-989">The trend of putting less weight on J when chroma is small, and more weight on J when chroma is large follows the recommended usage for CMC and CIEDE2000.</span></span>

![Grafico che mostra la funzione Weight sul componente J della metrica.](images/gmmp-image119.png)

<span data-ttu-id="16d48-991">**Figura 31** : funzione Weight sul componente J della metrica</span><span class="sxs-lookup"><span data-stu-id="16d48-991">**Figure 31** : The weight function on the J component of the metric</span></span>

<span data-ttu-id="16d48-992">Usare lo spazio jab per l'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="16d48-992">Use Jab space for the following example.</span></span> <span data-ttu-id="16d48-993">Il calcolo richiede la ricerca di tutti i triangoli limite per determinare il punto più vicino nella metrica euclidea.</span><span class="sxs-lookup"><span data-stu-id="16d48-993">It is computationally demanding to search through all the boundary triangles to determine the closest point in the Euclidean metric.</span></span> <span data-ttu-id="16d48-994">Di seguito è riportato un semplice approccio per rendere questo processo il più efficiente possibile, senza introdurre presupposti aggiuntivi che potrebbero velocizzare il processo, ma anche finire solo in una risposta approssimativa.</span><span class="sxs-lookup"><span data-stu-id="16d48-994">The following is a simple approach to make this process as efficient as possible, without introducing additional assumptions that may speed up the process but also end up in only an approximate answer.</span></span> <span data-ttu-id="16d48-995">Per prima cosa, è necessario comprendere la procedura geometrica per proiettare un punto sul triangolo specificato.</span><span class="sxs-lookup"><span data-stu-id="16d48-995">First, it is necessary to understand the geometric procedure of projecting a point onto the given triangle.</span></span> <span data-ttu-id="16d48-996">Qui viene fornita una descrizione.</span><span class="sxs-lookup"><span data-stu-id="16d48-996">A description is given here.</span></span>

<span data-ttu-id="16d48-997">Viene eseguita prima una proiezione ortogonale sul piano infinito che contiene il triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-997">An orthogonal projection onto the infinite plane containing the triangle is first performed.</span></span> <span data-ttu-id="16d48-998">La distanza più breve del punto di query dal piano può essere determinata in due passaggi.</span><span class="sxs-lookup"><span data-stu-id="16d48-998">The shortest distance of the query point from the plane can be determined in two steps.</span></span>

<span data-ttu-id="16d48-999">**(a)** calcolare il vettore del normale dell'unità al triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-999">**(a)** Calculate the unit normal vector to the triangle.</span></span>

<span data-ttu-id="16d48-1000">**(b)** calcolare il prodotto punto del vettore di unità normale e un vettore formato dal punto di query e un punto sul triangolo; ovvero uno dei vertici.</span><span class="sxs-lookup"><span data-stu-id="16d48-1000">**(b)** Calculate the dot product of the unit normal vector and a vector formed from the query point and a point on the triangle; that is, one of its vertices.</span></span> <span data-ttu-id="16d48-1001">Poiché il vettore normale presenta una lunghezza di unità, il valore assoluto di questo prodotto punto corrisponde alla distanza del punto di query dal piano.</span><span class="sxs-lookup"><span data-stu-id="16d48-1001">Because the normal vector has unit length, the absolute value of this dot product is the distance of the query point from the plane.</span></span>

<span data-ttu-id="16d48-1002">Il punto proiettato potrebbe non essere la risposta, perché potrebbe trovarsi all'esterno del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1002">The projected point might not be the answer, because it might lie outside the triangle.</span></span> <span data-ttu-id="16d48-1003">Pertanto, è necessario eseguire prima una verifica.</span><span class="sxs-lookup"><span data-stu-id="16d48-1003">So, you must perform a check first.</span></span> <span data-ttu-id="16d48-1004">Il calcolo equivale a calcolare le coordinate baricentrica del punto proiettato rispetto al triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1004">The calculation is equivalent to calculating the barycentric coordinates of the projected point relative to the triangle.</span></span> <span data-ttu-id="16d48-1005">Se il punto proiettato è determinato all'interno del triangolo, è la risposta.</span><span class="sxs-lookup"><span data-stu-id="16d48-1005">If the projected point is determined to be inside the triangle, it is the answer.</span></span> <span data-ttu-id="16d48-1006">In caso contrario, viene acquisito il punto più vicino su uno dei bordi del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1006">If not, the closest point is acquired on one of the edges of the triangle.</span></span> <span data-ttu-id="16d48-1007">Eseguire una ricerca su ognuno dei tre bordi.</span><span class="sxs-lookup"><span data-stu-id="16d48-1007">Perform a search on each of the three edges.</span></span> <span data-ttu-id="16d48-1008">Determinare la proiezione del punto di query su un bordo è un processo simile alla proiezione sul triangolo, ma una dimensione minore.</span><span class="sxs-lookup"><span data-stu-id="16d48-1008">Determining the projection of the query point onto an edge is a process similar to projection onto the triangle, but one dimension less.</span></span> <span data-ttu-id="16d48-1009">Viene innanzitutto calcolata una proiezione ortogonale.</span><span class="sxs-lookup"><span data-stu-id="16d48-1009">An orthogonal projection is first calculated.</span></span> <span data-ttu-id="16d48-1010">Se il punto proiettato si trova sul bordo, è la risposta.</span><span class="sxs-lookup"><span data-stu-id="16d48-1010">If the projected point lies on the edge, it is the answer.</span></span> <span data-ttu-id="16d48-1011">In caso contrario, viene acquisito il punto più vicino in uno dei due punti finali.</span><span class="sxs-lookup"><span data-stu-id="16d48-1011">If not, the closest point is acquired on one of the two end points.</span></span> <span data-ttu-id="16d48-1012">Eseguire una ricerca sui due punti finali; ovvero calcolare la distanza del punto di query da ciascuno di essi e confrontare quello più piccolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1012">Perform a search on the two end points; that is, calculate the distance of query point from each one, and compare which one is smaller.</span></span>

<span data-ttu-id="16d48-1013">L'analisi attenta rivela che è presente una grande quantità di ricerche ripetute quando si esaminano tutti i triangoli perché un bordo è sempre condiviso da due triangoli e un vertice condiviso da almeno tre bordi.</span><span class="sxs-lookup"><span data-stu-id="16d48-1013">Careful examination reveals that there is a lot of repeated searching when you go through all the triangles because an edge is always shared by two triangles, and a vertex shared by at least three edges.</span></span> <span data-ttu-id="16d48-1014">Inoltre, non si è molto interessati a trovare il punto più vicino a un particolare triangolo; si è invece interessati a trovare il punto più vicino all'intero limite della gamma.</span><span class="sxs-lookup"><span data-stu-id="16d48-1014">In addition, you are not much interested in finding the closest point to one particular triangle; instead you are interested in finding the closest point to the whole gamut boundary.</span></span> <span data-ttu-id="16d48-1015">Tuttavia, un particolare triangolo è quello in cui si raggiunge questa situazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-1015">However,one particular triangle would be the one in which this is achieved.</span></span> <span data-ttu-id="16d48-1016">Esistono due strategie che è possibile utilizzare per velocizzare la ricerca.</span><span class="sxs-lookup"><span data-stu-id="16d48-1016">There are two strategies that you can use to speed up the search.</span></span>

<span data-ttu-id="16d48-1017">**Strategia I**. Ogni vertice verrà elaborato al massimo una volta.</span><span class="sxs-lookup"><span data-stu-id="16d48-1017">**Strategy I**. Each vertex will be processed, at most, once.</span></span> <span data-ttu-id="16d48-1018">Ogni bordo verrà elaborato al massimo una volta.</span><span class="sxs-lookup"><span data-stu-id="16d48-1018">Each edge will be processed, at most, once.</span></span>

<span data-ttu-id="16d48-1019">**Strategia II**.</span><span class="sxs-lookup"><span data-stu-id="16d48-1019">**Strategy II**.</span></span> <span data-ttu-id="16d48-1020">In qualsiasi punto della ricerca si ha un candidato migliore con la distanza migliore corrispondente.</span><span class="sxs-lookup"><span data-stu-id="16d48-1020">At any point in the search, you have a best candidate with the corresponding best distance.</span></span> <span data-ttu-id="16d48-1021">Se è possibile determinare, mediante un controllo rapido, che un triangolo non è in grado di fornire una distanza migliore, non è necessario continuare ulteriormente il calcolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1021">If you can determine, by a quick check, that a triangle is not capable of giving a better distance, there is no need to continue the calculation further.</span></span> <span data-ttu-id="16d48-1022">Non sono necessari il punto e la distanza più vicini per questo triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1022">You do not need the closest point and distance for this triangle.</span></span>

![Diagramma che mostra il flusso del mapping minimo di.](images/gmmp-image120.png)

<span data-ttu-id="16d48-1024">**Figura 32** : schemi di mapping minimi</span><span class="sxs-lookup"><span data-stu-id="16d48-1024">**Figure 32** : Minimum DE Mapping schematics</span></span>

<span data-ttu-id="16d48-1025">La figura 32 illustra il flusso generale della logica per la mappa gamut MinDEMap.</span><span class="sxs-lookup"><span data-stu-id="16d48-1025">Figure 32 shows the general flow of logic for the gamut map MinDEMap.</span></span> <span data-ttu-id="16d48-1026">Per un punto di query, viene prima richiamata la funzione CheckGamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-1026">For a query point, the CheckGamut function is first invoked.</span></span> <span data-ttu-id="16d48-1027">Se il punto è in-gamut, la mappa è un no-op.</span><span class="sxs-lookup"><span data-stu-id="16d48-1027">If the point is in-gamut, the map is a no-op.</span></span> <span data-ttu-id="16d48-1028">Se il punto è out-of-gamut, chiamare ProjectPointToBoundary.</span><span class="sxs-lookup"><span data-stu-id="16d48-1028">If the point is out-of-gamut, call ProjectPointToBoundary.</span></span> <span data-ttu-id="16d48-1029">Passare ora alla figura 33.</span><span class="sxs-lookup"><span data-stu-id="16d48-1029">Now move on to Figure 33.</span></span> <span data-ttu-id="16d48-1030">A questo punto si presuppone che siano stati calcolati i valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-1030">At this point, it is assumed that the following values have been computed.</span></span>

<span data-ttu-id="16d48-1031">**(a)** unità vettore normale per ogni triangolo limite gamma rispetto al prodotto a virgola standard.</span><span class="sxs-lookup"><span data-stu-id="16d48-1031">**(a)** Unit normal vector to each Gamut Boundary Triangle with respect to the standard dot product.</span></span>

<span data-ttu-id="16d48-1032">**(b)** elenco di vertici e bordi, oltre all'elenco dei triangoli.</span><span class="sxs-lookup"><span data-stu-id="16d48-1032">**(b)** Vertex list and edge list, in addition to the triangle list.</span></span>

![Diagramma che mostra la routine ' ProjectPointToBoundary '.](images/gmmp-image122.jpg)

<span data-ttu-id="16d48-1034">**Figura 33** : routine ProjectPointToBoundary</span><span class="sxs-lookup"><span data-stu-id="16d48-1034">**Figure 33** : The ProjectPointToBoundary routine</span></span>

<span data-ttu-id="16d48-1035">Tutti questi sono un sovraccarico costante e potrebbero ridurre i costi se vengono eseguite query sufficienti per questo limite di gamut.</span><span class="sxs-lookup"><span data-stu-id="16d48-1035">All these are constant overhead, and would have diminishing cost if sufficient queries to this gamut boundary are made.</span></span> <span data-ttu-id="16d48-1036">In genere, questa situazione si verifica quando si compila un LUT di trasformazione da un dispositivo a un altro, in cui sono presenti solo due gamme fisse e il LUT di trasformazione viene eseguito attraverso punti della griglia campionata in modo uniforme.</span><span class="sxs-lookup"><span data-stu-id="16d48-1036">Usually, this is the case when you build a transform LUT from one device to another, where there are only two fixed gamuts, and the transform LUT runs through points on the uniformly sampled grid.</span></span> <span data-ttu-id="16d48-1037">Si precalcolano i vettori normali rispetto al prodotto punto standard, anche se la nozione di perpendicolarità sarà basata sul prodotto del punto ponderato, che dipende dal punto di query, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="16d48-1037">You pre-compute the normal vectors with respect to the standard dot product, even though the notion of perpendicularity will be based on the weighted dot product, which depends on the query point as explained previously.</span></span> <span data-ttu-id="16d48-1038">Il motivo è dovuto al fatto che un vettore normale rispetto al prodotto dot ponderato può essere ottenuto facilmente dal vettore normale rispetto al prodotto punto standard.</span><span class="sxs-lookup"><span data-stu-id="16d48-1038">The reason is because a normal vector with respect to the weighted dot product can be obtained easily from the normal vector with respect to the standard dot product.</span></span> <span data-ttu-id="16d48-1039">Se n ₀ è un vettore normale rispetto al prodotto punto standard,</span><span class="sxs-lookup"><span data-stu-id="16d48-1039">If n ₀ is a normal vector with respect to the standard dot product, then</span></span>

<span data-ttu-id="16d48-1040">n = (J-component of n ₀/w <sub>J</sub>, a-component of n ₀, b-component of n ₀)</span><span class="sxs-lookup"><span data-stu-id="16d48-1040">n = (J-component of n ₀ /w <sub>J</sub>, a-component of n ₀, b-component of n ₀ )</span></span>

<span data-ttu-id="16d48-1041">è normale per il triangolo rispetto al prodotto del punto ponderato.</span><span class="sxs-lookup"><span data-stu-id="16d48-1041">is normal to the triangle with respect to the weighted dot product.</span></span> <span data-ttu-id="16d48-1042">A causa di questa relazione, è comunque vantaggioso pre-calcolare n ₀ anche se deve essere regolato in base al punto di query.</span><span class="sxs-lookup"><span data-stu-id="16d48-1042">Because of this relationship, it is still beneficial to pre-compute n ₀ even though it must be adjusted based on the query point.</span></span>

<span data-ttu-id="16d48-1043">La routine ProjectPointToBoundary viene avviata reimpostando la "cronologia elaborata" dei vertici e dei bordi.</span><span class="sxs-lookup"><span data-stu-id="16d48-1043">The ProjectPointToBoundary routine starts by resetting the "processed history" of the vertices and edges.</span></span> <span data-ttu-id="16d48-1044">Si tratta di tabelle di flag BOOLEANI che rilevano se un vertice o un bordo è stato visitato prima.</span><span class="sxs-lookup"><span data-stu-id="16d48-1044">These are tables of BOOLEAN flags that track whether a vertex or edge has been visited before.</span></span> <span data-ttu-id="16d48-1045">Reimposta inoltre la variabile ShortestDistance su "INFINITY", che rappresenta il valore codificato massimo nel sistema con numero a virgola mobile utilizzato.</span><span class="sxs-lookup"><span data-stu-id="16d48-1045">It also resets the variable ShortestDistance to "INFINITY," which is the maximum encoded value in the floating-point number system used.</span></span> <span data-ttu-id="16d48-1046">Viene quindi eseguito un ciclo, cercando il punto più vicino da ogni triangolo usando la chiamata ProcessTriangle.</span><span class="sxs-lookup"><span data-stu-id="16d48-1046">Then it runs through a loop, searching for the closest point from each triangle using the ProcessTriangle call.</span></span> <span data-ttu-id="16d48-1047">ProcessTriangle è la routine per aggiornare la variabile ShortestDistance ed è chiaramente nel ciclo critico.</span><span class="sxs-lookup"><span data-stu-id="16d48-1047">ProcessTriangle is the routine to update the ShortestDistance variable and is clearly in the critical loop.</span></span> <span data-ttu-id="16d48-1048">Un'ottimizzazione consiste nell'arrestare quando il risultato è sufficientemente adatto.</span><span class="sxs-lookup"><span data-stu-id="16d48-1048">One optimization is to stop when the result is good enough.</span></span> <span data-ttu-id="16d48-1049">Dopo ogni chiamata a ProcessTriangle, viene esaminata la variabile ShortestDistance.</span><span class="sxs-lookup"><span data-stu-id="16d48-1049">After each call to ProcessTriangle, the variable ShortestDistance is examined.</span></span> <span data-ttu-id="16d48-1050">Se soddisfa una soglia predefinita, è possibile arrestare.</span><span class="sxs-lookup"><span data-stu-id="16d48-1050">If it satisfies a predefined threshold, you can stop.</span></span> <span data-ttu-id="16d48-1051">La soglia predefinita dipende dallo spazio di colore utilizzato e dall'accuratezza necessaria del sistema di imaging dei colori.</span><span class="sxs-lookup"><span data-stu-id="16d48-1051">The predefined threshold is dependent on the color space used and on the required accuracy of the color imaging system.</span></span> <span data-ttu-id="16d48-1052">Per un'applicazione tipica, non si desidera eseguire operazioni superflue se la differenza di colore è inferiore a quella che può essere individuata dalla visione umana.</span><span class="sxs-lookup"><span data-stu-id="16d48-1052">For a typical application, you do not want to do unnecessary work if the color difference is less than what can be discerned by human vision.</span></span> <span data-ttu-id="16d48-1053">Per CIECAM02, la differenza di colore è 1.</span><span class="sxs-lookup"><span data-stu-id="16d48-1053">For CIECAM02, this color difference is 1.</span></span> <span data-ttu-id="16d48-1054">Usare tuttavia un valore soglia di 0,005 nell'implementazione, per mantenere la precisione dei calcoli, perché potrebbe trattarsi solo di un passaggio intermedio in una catena di trasformazioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-1054">Use a threshold value of 0.005 in the implementation, however, to preserve the precision of computations, because this might be only an intermediate step in a chain of transforms.</span></span>

<span data-ttu-id="16d48-1055">ProcessTriangle implementa la strategia precedente II.</span><span class="sxs-lookup"><span data-stu-id="16d48-1055">ProcessTriangle implements the preceding Strategy II.</span></span> <span data-ttu-id="16d48-1056">Ottenendo un vettore normale dal vettore normale dell'unità pre-calcolata al triangolo rispetto al prodotto punto standard, viene calcolata la distanza tra il punto di query e il piano infinito che contiene il triangolo formando il prodotto a virgola del vettore di unità normale e il queryVector, il vettore da uno dei vertici del triangolo, vertex1, al punto di query , queryPoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1056">Obtaining a normal vector from the pre-computed unit normal vector to the triangle with respect to the standard dot product, it computes the distance of the query point to the infinite plane containing the triangle by forming the dot product of the unit normal vector and the queryVector, the vector from one of the vertices of the triangle, vertex1, to the query point, queryPoint.</span></span>

<span data-ttu-id="16d48-1057">queryVector = queryPoint-vertex1</span><span class="sxs-lookup"><span data-stu-id="16d48-1057">queryVector = queryPoint - vertex1</span></span>

<span data-ttu-id="16d48-1058">distance = \| normalVector \* queryVector \| / \| \| normalVector\|\|</span><span class="sxs-lookup"><span data-stu-id="16d48-1058">distance = \| normalVector \* queryVector \|/\|\|normalVector\|\|</span></span>

<span data-ttu-id="16d48-1059">Si tratta di un calcolo relativamente economico e la distanza è necessaria per eseguire ulteriori calcoli.</span><span class="sxs-lookup"><span data-stu-id="16d48-1059">This is a relatively inexpensive calculation, and the distance is required to carry out further calculations.</span></span> <span data-ttu-id="16d48-1060">Se questa distanza non è inferiore alla distanza ottimale corrente, ShortestDistance, questo triangolo non produrrà una distanza migliore, poiché non fornirà una distanza migliore rispetto al piano che la contiene.</span><span class="sxs-lookup"><span data-stu-id="16d48-1060">If this distance is not less than the current best distance, ShortestDistance, this triangle will not produce a better distance, because it will not give a better distance than the plane containing it.</span></span> <span data-ttu-id="16d48-1061">In questo caso, si restituisce il controllo al ciclo triangolare.</span><span class="sxs-lookup"><span data-stu-id="16d48-1061">In this case, you return control to the triangle loop.</span></span> <span data-ttu-id="16d48-1062">Se la distanza è inferiore a ShortestDistance, potenzialmente si ha un punto più vicino, se questo punto si trova all'interno del triangolo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1062">If the distance is smaller than ShortestDistance, potentially, you have a closer point, if this point lies inside the triangle.</span></span> <span data-ttu-id="16d48-1063">È necessario eseguire alcuni calcoli "rigidi" (anche se non oltre l'algebra lineare) per determinarlo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1063">You must perform some "hard" calculations (though nothing beyond linear algebra) to determine that.</span></span> <span data-ttu-id="16d48-1064">Se gli altri due vertici del triangolo sono VERTEX2 e vertex3, formare i vettori di base firstBasisVector e secondBasisVector.</span><span class="sxs-lookup"><span data-stu-id="16d48-1064">If the other two vertices of the triangle are vertex2 and vertex3, then form the basis vectors firstBasisVector and secondBasisVector.</span></span>

<span data-ttu-id="16d48-1065">firstBasisVector = VERTEX2-vertex1</span><span class="sxs-lookup"><span data-stu-id="16d48-1065">firstBasisVector = vertex2 - vertex1</span></span>

<span data-ttu-id="16d48-1066">secondBasisVector = vertex3-vertex1</span><span class="sxs-lookup"><span data-stu-id="16d48-1066">secondBasisVector = vertex3 - vertex1</span></span>

<span data-ttu-id="16d48-1067">Usare il sistema lineare di equazioni seguente per risolvere i problemi relativi a e v.</span><span class="sxs-lookup"><span data-stu-id="16d48-1067">Use the following linear system of equations to solve for unknowns u and v.</span></span>

<span data-ttu-id="16d48-1068">firstBasisVector \* queryVector = (firstBasisVector \* firstBasisVector) u + (firstBasisVector \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="16d48-1068">firstBasisVector \* queryVector = (firstBasisVector \* firstBasisVector)u + (firstBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="16d48-1069">secondBasisVector \* queryVector = (secondBasisVector \* firstBasisVector) u + (secondBasisVector \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="16d48-1069">secondBasisVector \* queryVector = (secondBasisVector \* firstBasisVector)u + (secondBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="16d48-1070">e le condizioni per il punto proiettato che si trovano all'interno del triangolo sono:</span><span class="sxs-lookup"><span data-stu-id="16d48-1070">and the conditions for the projected point to lie inside the triangle are:</span></span>

<span data-ttu-id="16d48-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 e u + v ≤ 1</span><span class="sxs-lookup"><span data-stu-id="16d48-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 and u + v ≤ 1</span></span>

<span data-ttu-id="16d48-1072">Dopo questo calcolo, se è stato determinato che il punto proiettato si trova all'interno del triangolo, è stato trovato un nuovo punto più vicino; la distanza calcolata all'inizio è la nuova distanza più breve.</span><span class="sxs-lookup"><span data-stu-id="16d48-1072">After this calculation, if it is determined that the projected point lies within the triangle, then you have found a new closest point; the distance that you calculated at the beginning is the new shortest distance.</span></span> <span data-ttu-id="16d48-1073">In questo caso, aggiornare le variabili ShortestDistance e ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1073">In this case, update the variables ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="16d48-1074">Se il punto proiettato si trova all'esterno del triangolo, è possibile trovare un punto più vicino su uno dei bordi.</span><span class="sxs-lookup"><span data-stu-id="16d48-1074">If the projected point lies outside the triangle, you might find a closer point on one of its edges.</span></span> <span data-ttu-id="16d48-1075">Quindi, è possibile chiamare la routine ProcessEdge su ognuno dei tre bordi.</span><span class="sxs-lookup"><span data-stu-id="16d48-1075">So, you can call the ProcessEdge routine on each of the three edges.</span></span>

![Diagramma che mostra il flusso delle routine ProcessEdge e ProcessVertex.](images/gmmp-image124.jpg)

<span data-ttu-id="16d48-1077">**Figura 34** : routine ProcessEdge e ProcessVertex</span><span class="sxs-lookup"><span data-stu-id="16d48-1077">**Figure 34** : ProcessEdge and ProcessVertex routines</span></span>

<span data-ttu-id="16d48-1078">La routine ProcessEdge implementa la strategia I, illustrata nella Figura 34.</span><span class="sxs-lookup"><span data-stu-id="16d48-1078">The ProcessEdge routine implements Strategy I, which is illustrated in Figure 34.</span></span> <span data-ttu-id="16d48-1079">ProcessEdge inizia controllando se il bordo è stato elaborato prima.</span><span class="sxs-lookup"><span data-stu-id="16d48-1079">ProcessEdge starts by checking whether the edge has been processed before.</span></span> <span data-ttu-id="16d48-1080">In tal caso, non viene eseguita alcuna azione ulteriore.</span><span class="sxs-lookup"><span data-stu-id="16d48-1080">If so, no further action is taken.</span></span> <span data-ttu-id="16d48-1081">In caso contrario, viene calcolata la proiezione ortogonale del punto di query sulla riga infinita che contiene il bordo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1081">If not, it proceeds to calculate the orthogonal projection of the query point onto the infinite line containing the edge.</span></span> <span data-ttu-id="16d48-1082">L'algebra lineare che interessano il calcolo è simile alle equazioni del triangolo precedenti.</span><span class="sxs-lookup"><span data-stu-id="16d48-1082">The linear algebra involved in the calculation is similar to the previous triangle equations.</span></span> <span data-ttu-id="16d48-1083">Tuttavia, il calcolo è più semplice e non è descritto qui.</span><span class="sxs-lookup"><span data-stu-id="16d48-1083">However, the calculation is simpler, it is not described here.</span></span> <span data-ttu-id="16d48-1084">Se il punto proiettato si trova all'interno del bordo, è possibile trovare la distanza del punto proiettato dal punto di query.</span><span class="sxs-lookup"><span data-stu-id="16d48-1084">If the projected point lies within the edge, you find the distance of the projected point from the query point.</span></span> <span data-ttu-id="16d48-1085">Se questa distanza è inferiore a ShortestDistance, è stato trovato un nuovo punto più vicino.</span><span class="sxs-lookup"><span data-stu-id="16d48-1085">If this distance is smaller than ShortestDistance, you have found a new closest point.</span></span> <span data-ttu-id="16d48-1086">Aggiornare sia ShortestDistance che ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1086">Update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="16d48-1087">Se il punto proiettato è esterno al bordo, chiamare ProcessVertex sui due endpoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1087">If the projected point lies outside the edge, call ProcessVertex on the two end points.</span></span> <span data-ttu-id="16d48-1088">Prima di restituire il controllo, aggiornare la cronologia perimetrale in modo che il bordo sia contrassegnato come "elaborato".</span><span class="sxs-lookup"><span data-stu-id="16d48-1088">Before returning control, update the edge history so that this edge is marked as "PROCESSED."</span></span>

<span data-ttu-id="16d48-1089">Infine, si dà una descrizione di ProcessVertex.</span><span class="sxs-lookup"><span data-stu-id="16d48-1089">Finally, you give a description of ProcessVertex.</span></span> <span data-ttu-id="16d48-1090">La routine ProjectVertex implementa anche la strategia I e mantiene una tabella di cronologia dei vertici.</span><span class="sxs-lookup"><span data-stu-id="16d48-1090">The ProjectVertex routine also implements Strategy I and maintains a vertex history table.</span></span> <span data-ttu-id="16d48-1091">Come illustrato nella Figura 34, prima controlla se il vertice è stato elaborato prima.</span><span class="sxs-lookup"><span data-stu-id="16d48-1091">As illustrated in Figure 34, it first checks whether the vertex has been processed before.</span></span> <span data-ttu-id="16d48-1092">In tal caso, non viene eseguita alcuna azione ulteriore.</span><span class="sxs-lookup"><span data-stu-id="16d48-1092">If so, no further action is taken.</span></span> <span data-ttu-id="16d48-1093">In caso contrario, viene calcolata la distanza del vertice dal punto di query.</span><span class="sxs-lookup"><span data-stu-id="16d48-1093">If not, it proceeds to calculate the distance of the vertex from the query point.</span></span> <span data-ttu-id="16d48-1094">Se la distanza è inferiore a ShortestDistance, aggiornare sia ShortestDistance che ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1094">If the distance is smaller than ShortestDistance, update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="16d48-1095">Alla fine, aggiorna la cronologia dei vertici in modo che questo vertice venga contrassegnato come "elaborato".</span><span class="sxs-lookup"><span data-stu-id="16d48-1095">At the end, it updates the vertex history so that this vertex is marked as "PROCESSED."</span></span>

<span data-ttu-id="16d48-1096">Quando il ciclo di controllo esterno ha esaurito tutti i triangoli o è stato terminato prima che venisse soddisfatta la soglia di differenza colore, viene eseguito l'accesso alla variabile ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="16d48-1096">When the outer control loop has either exhausted all the triangles or exited before color difference threshold has been met, the variable ClosestPoint is accessed.</span></span> <span data-ttu-id="16d48-1097">Questo è il risultato di MinDEMap.</span><span class="sxs-lookup"><span data-stu-id="16d48-1097">This is the result of MinDEMap.</span></span> <span data-ttu-id="16d48-1098">Il chiamante può anche recuperare ShortestDistance se è interessato alla distanza del colore mappato dal colore della query.</span><span class="sxs-lookup"><span data-stu-id="16d48-1098">The caller can also retrieve ShortestDistance if interested in how far the mapped color is from the query color.</span></span>

### <a name="hue-smoothing"></a><span data-ttu-id="16d48-1099">Smussatura tonalità</span><span class="sxs-lookup"><span data-stu-id="16d48-1099">Hue Smoothing</span></span>

![Diagramma che mostra due viste principali della smussatura tonalità, l'originale sulla parte superiore e la tonalità smussate in basso.](images/gmmp-image125.png)

<span data-ttu-id="16d48-1101">**Figura 35** : smussatura Hue</span><span class="sxs-lookup"><span data-stu-id="16d48-1101">**Figure 35** : Hue Smoothing</span></span>

<span data-ttu-id="16d48-1102">Si verifica un problema con le operazioni con tonalità vincolata; ovvero, l'operazione considera solo le variabili all'interno di un piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-1102">An issue arises with operations that are hue constrained; that is, the operation only considers variables within a hue plane.</span></span> <span data-ttu-id="16d48-1103">La figura 35 illustra un esempio di gamut che mostra le sezioni di tonalità "discontinue" nelle tonalità blu.</span><span class="sxs-lookup"><span data-stu-id="16d48-1103">Figure 35 shows an example of a gamut exhibiting "discontinuous" hue slices in the blue hues.</span></span> <span data-ttu-id="16d48-1104">All'interno di questo intervallo di tonalità, per determinati angoli di tonalità, il limite della gamma è tangente al piano di tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-1104">Within this hue range, for certain hue angles, the gamut boundary is tangential to the hue plane.</span></span> <span data-ttu-id="16d48-1105">In effetti, ciò causa una modifica nella struttura topologica delle sezioni tonalità.</span><span class="sxs-lookup"><span data-stu-id="16d48-1105">In effect, this causes a change in the topological structure of the hue slices.</span></span> <span data-ttu-id="16d48-1106">Nell'esempio illustrato, quando il piano di tonalità si estende in questo intervallo di tonalità, emerge una "isola" e le sottofusioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-1106">In the example shown, as the hue plane sweeps across this hue range, an "island" emerges and submerges.</span></span> <span data-ttu-id="16d48-1107">Questa modifica nella topologia causerà la discontinuità delle operazioni specifiche di Hue.</span><span class="sxs-lookup"><span data-stu-id="16d48-1107">This change in topology will cause hue specific operations to be discontinuous.</span></span> <span data-ttu-id="16d48-1108">Ad esempio, la cuspide a tonalità fissa verrà modificata bruscamente quando l'angolo di tonalità cambierà in questo intervallo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1108">For example, the cusp at fixed hue will change abruptly as the hue angle changes across this range.</span></span>

<span data-ttu-id="16d48-1109">Esiste una ragione per la scienza dei colori perché è consigliabile mantenere Hue in determinate operazioni.</span><span class="sxs-lookup"><span data-stu-id="16d48-1109">There is a color science reason why it is desirable to preserve hue in certain operations.</span></span> <span data-ttu-id="16d48-1110">Per risolvere il problema precedente, i triangoli di limite della gamma originale devono essere "tonalità smussata".</span><span class="sxs-lookup"><span data-stu-id="16d48-1110">To resolve the preceding issue, the original Gamut Boundary Triangles must be "hue smoothed."</span></span> <span data-ttu-id="16d48-1111">In generale, una sfumatura di tonalità di un set di triangoli di limite di gamut è un set di triangoli in modo che (a) formi il limite di un nuovo "gamut", che potrebbe non corrispondere al gamut effettivo del dispositivo e che contiene la gamma definita dal set originale di triangoli; e (b) i triangoli del nuovo set sono delimitati dall'esecuzione parallela ai piani Hue.</span><span class="sxs-lookup"><span data-stu-id="16d48-1111">Generally speaking, a hue smoothing of a set of Gamut Boundary Triangles is a set of triangles such that (a) it forms the boundary of a new "gamut," which might not correspond to the actual device gamut, and that contains the gamut defined by the original set of triangles; and (b) the triangles in the new set are bounded away from being parallel to the hue planes.</span></span>

<span data-ttu-id="16d48-1112">Un modo pratico per ottenere un set smussato di tonalità di triangoli consiste nel prendere la struttura convessa dei vertici originali.</span><span class="sxs-lookup"><span data-stu-id="16d48-1112">One practical way to obtain a hue smoothed set of triangles is to take the convex hull of the original vertices.</span></span> <span data-ttu-id="16d48-1113">Come illustrato nella Figura 35, le sezioni di tonalità della struttura convessa variano in modo uniforme nell'intervallo di tonalità problematico senza modifiche improvvise nella topologia.</span><span class="sxs-lookup"><span data-stu-id="16d48-1113">As illustrated in Figure 35, the hue slices of the convex hull vary smoothly in the problematic hue range without a sudden change in topology.</span></span>

### <a name="setting-primaries-and-secondaries-in-the-gamut-boundary-description"></a><span data-ttu-id="16d48-1114">Impostazione di primari e secondari nella descrizione del limite della gamma</span><span class="sxs-lookup"><span data-stu-id="16d48-1114">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>

<span data-ttu-id="16d48-1115">Determinati metodi di mapping di gamut, ad esempio HueMap, dipendono dalla posizione delle primarie del dispositivo e dei database secondari.</span><span class="sxs-lookup"><span data-stu-id="16d48-1115">Certain gamut mapping methods, such as HueMap, depend on the location of the device primaries and secondaries.</span></span> <span data-ttu-id="16d48-1116">Per i dispositivi additivi, i primari sono rosso, verde e blu (R, G e B); e i database secondari sono cyan, magenta e Yellow (C, M e Y).</span><span class="sxs-lookup"><span data-stu-id="16d48-1116">For additive devices, the primaries are red, green, and blue (R, G, and B); and the secondaries are cyan, magenta, and yellow (C, M, and Y).</span></span> <span data-ttu-id="16d48-1117">Per i dispositivi sottrattivi, le primarie sono C, M e Y; e i database secondari sono R, G e B. Il GBD tiene traccia di tutti i sei valori, più bianco e nero (W e K), in una matrice di valori di colore jab.</span><span class="sxs-lookup"><span data-stu-id="16d48-1117">For subtractive devices, the primaries are C, M, and Y; and the secondaries are R, G, and B. The GBD keeps track of all six of those values, plus white and black (W and K), in a array of Jab color values.</span></span> <span data-ttu-id="16d48-1118">Questi valori vengono impostati nella descrizione del limite della gamma al momento della creazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-1118">These values are set into the gamut boundary description when it is created.</span></span> <span data-ttu-id="16d48-1119">Per i dispositivi di output, è possibile determinare gli primari eseguendo combinazioni di valori di controllo del dispositivo tramite il modello di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="16d48-1119">For output devices, the primaries can be determined by running combinations of device control values through the device model.</span></span> <span data-ttu-id="16d48-1120">Per i dispositivi di acquisizione, questo approccio non è particolarmente adatto per la creazione del GBD di riferimento, perché è quasi impossibile acquisire un'immagine che restituisce un valore di dispositivo puro completamente saturo, ad esempio (0,0, 0,0, 1,0).</span><span class="sxs-lookup"><span data-stu-id="16d48-1120">For capture devices, this approach is not well-suited for creating the reference GBD, because it is almost impossible to capture an image that yields a fully saturated pure device value, such as (0.0, 0.0, 1.0).</span></span> <span data-ttu-id="16d48-1121">I profili dei dispositivi WCS contengono gli indici delle primarie nella destinazione di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="16d48-1121">WCS device profiles contain the indices of the primaries in the capture target.</span></span> <span data-ttu-id="16d48-1122">Poiché questi valori non sono contenuti in un profilo ICC, utilizzare i valori misurati da una tipica destinazione dello scanner dopo la conversione in jab rispetto alle condizioni di visualizzazione ICC.</span><span class="sxs-lookup"><span data-stu-id="16d48-1122">Because these values are not contained in an ICC profile, use values measured from a typical scanner target after converting to Jab, relative to the ICC viewing conditions.</span></span>

### <a name="setting-the-neutral-axis-in-the-gamut-boundary-description"></a><span data-ttu-id="16d48-1123">Impostazione dell'asse neutro nella descrizione del limite della gamut</span><span class="sxs-lookup"><span data-stu-id="16d48-1123">Setting the Neutral Axis in the Gamut Boundary Description</span></span>

<span data-ttu-id="16d48-1124">Il HueMap e i metodi di mapping di gamut tritati relativi usano l'asse neutro del dispositivo per la raddrizzatura.</span><span class="sxs-lookup"><span data-stu-id="16d48-1124">The HueMap and the Relative MinCD gamut mapping methods use the device neutral axis for straightening.</span></span> <span data-ttu-id="16d48-1125">Per i dispositivi di output di base, l'asse neutro può essere determinato eseguendo valori neutri del dispositivo (R = G = B o C = M = Y) tramite il metodo DeviceToColorimetric e quindi tramite il metodo ColorimetricToAppearance dell'oggetto CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="16d48-1125">For the baseline output devices, the neutral axis can be determined by running device neutral values (R=G=B or C=M=Y) through the DeviceToColorimetric method, and then through the ColorimetricToAppearance method of the CIECAM02 object.</span></span> <span data-ttu-id="16d48-1126">Tuttavia, i dispositivi di acquisizione non restituiscono sempre un valore neutro del dispositivo quando viene presentato un campione neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-1126">However, capture devices do not always return a device neutral value when presented with a neutral sample.</span></span> <span data-ttu-id="16d48-1127">Ciò è particolarmente vero quando l'illuminazione ambientale non è perfettamente neutra.</span><span class="sxs-lookup"><span data-stu-id="16d48-1127">This is particularly true when the ambient lighting is not perfectly neutral.</span></span> <span data-ttu-id="16d48-1128">I profili dei dispositivi WCS contengono gli indici degli esempi neutri nella destinazione.</span><span class="sxs-lookup"><span data-stu-id="16d48-1128">WCS device profiles contain the indices of the neutral samples in the target.</span></span> <span data-ttu-id="16d48-1129">Usare questi esempi per impostare l'asse neutro.</span><span class="sxs-lookup"><span data-stu-id="16d48-1129">Use those samples to set the neutral axis.</span></span> <span data-ttu-id="16d48-1130">Poiché queste informazioni non sono disponibili per i profili ICC, è necessario usare lo stesso metodo usato per i dispositivi di output. eseguire esempi di dispositivo neutro tramite il metodo DeviceToColorimetric, quindi abbinare i valori di input e i risultati di colorimetrico.</span><span class="sxs-lookup"><span data-stu-id="16d48-1130">Because this information is not available for ICC profiles, you must use the same method that is used for output devices; run device neutral samples through the DeviceToColorimetric method, and then couple the input values and the colorimetric results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="16d48-1131">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="16d48-1131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="16d48-1132">Concetti di base sulla gestione dei colori</span><span class="sxs-lookup"><span data-stu-id="16d48-1132">Basic color management concepts</span></span>](basic-color-management-concepts.md)
</dt> <dt>

[<span data-ttu-id="16d48-1133">Schemi e algoritmi del sistema di colori Windows</span><span class="sxs-lookup"><span data-stu-id="16d48-1133">Windows Color System Schemas and Algorithms</span></span>](windows-color-system-schemas-and-algorithms.md)
</dt> </dl>

 

 




