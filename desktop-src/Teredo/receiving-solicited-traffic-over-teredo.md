---
title: Ricezione di traffico richiesto su Teredo
description: Molte applicazioni come Microsoft Internet Explorer e Microsoft Outlook avviano solo connessioni a Internet.
ms.assetid: bff5d65e-050d-4b09-9982-8024612ffa6e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 035d067afeb9c62795efb5acd0bb28adc3afcb16
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/09/2020
ms.locfileid: "104517176"
---
# <a name="receiving-solicited-traffic-over-teredo"></a><span data-ttu-id="971f5-103">Ricezione di traffico richiesto su Teredo</span><span class="sxs-lookup"><span data-stu-id="971f5-103">Receiving Solicited Traffic Over Teredo</span></span>

<span data-ttu-id="971f5-104">Molte applicazioni come Microsoft Internet Explorer e Microsoft Outlook avviano solo connessioni a Internet.</span><span class="sxs-lookup"><span data-stu-id="971f5-104">Many applications such as Microsoft Internet Explorer and Microsoft Outlook only initiate connections to the Internet.</span></span> <span data-ttu-id="971f5-105">Per queste applicazioni, [Teredo](about-teredo.md) può garantire una connettività uniforme su IPv6 in assenza di altre interfacce IPv6.</span><span class="sxs-lookup"><span data-stu-id="971f5-105">For these applications, [Teredo](about-teredo.md) can provide seamless connectivity over IPv6 in the absence of other IPv6 interfaces.</span></span> <span data-ttu-id="971f5-106">Inoltre, il traffico richiesto può essere ricevuto tramite l'interfaccia Teredo sulle piattaforme precedenti di Microsoft Windows XP con Service Pack 2 (SP2) e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="971f5-106">Additionally, solicited traffic can be received over the Teredo Interface on the earlier Microsoft Windows XP with Service Pack 2 (SP2) and Windows Server 2003 platforms.</span></span>

<span data-ttu-id="971f5-107">Nella documentazione seguente viene illustrato il modo in cui queste applicazioni raggiungono la connettività e le circostanze in cui viene utilizzato Teredo.</span><span class="sxs-lookup"><span data-stu-id="971f5-107">The following documentation explains how these applications achieve connectivity, and the circumstances under which Teredo is used.</span></span>

## <a name="obtaining-a-destination-address"></a><span data-ttu-id="971f5-108">Acquisizione di un indirizzo di destinazione</span><span class="sxs-lookup"><span data-stu-id="971f5-108">Obtaining a Destination Address</span></span>

<span data-ttu-id="971f5-109">Un'applicazione tenta di ottenere l'indirizzo di destinazione utilizzando diversi metodi, ad esempio Domain Name System (DNS) o il protocollo PNRP (Peer Name Resolution Protocol).</span><span class="sxs-lookup"><span data-stu-id="971f5-109">An application attempts to obtain the destination address using various methods such as Domain Name System (DNS) or Peer Name Resolution Protocol (PNRP).</span></span> <span data-ttu-id="971f5-110">È possibile che l'applicazione ottenga più indirizzi IP IPv4 e IPv6 usando questi metodi.</span><span class="sxs-lookup"><span data-stu-id="971f5-110">It is possible for the application to obtain multiple IPv4 and IPv6 IP addresses using these methods.</span></span> <span data-ttu-id="971f5-111">Le API tipiche utilizzate per ottenere gli indirizzi IP includono l'API di Windows XP [**gethostbyname**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) e la nuova API di Windows Vista [**funzione getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span><span class="sxs-lookup"><span data-stu-id="971f5-111">The typical APIs used to obtain IP addresses include the Windows XP API [**GetHostByName**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) and the new Windows Vista API [**GetAddrInfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span></span> <span data-ttu-id="971f5-112">Ad esempio, l'uso dell'API funzione getaddrinfo con il parametro della *\_ famiglia ai* è impostato su AF \_ INET6 come hint per addrinfo/Protocol consente all'utente di eseguire query sui server DNS per indirizzi IPv6 in modo specifico.</span><span class="sxs-lookup"><span data-stu-id="971f5-112">For example, using the GetAddrInfo API with the *ai\_family* parameter set to AF\_INET6 as the addrinfo/protocol hint allows the user to query DNS servers for IPv6 addresses specifically.</span></span> <span data-ttu-id="971f5-113">L'API [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) con tipo DNS \_ \_ aaaa può essere usata anche per eseguire query sui server DNS per i record AAAA.</span><span class="sxs-lookup"><span data-stu-id="971f5-113">The [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) API with the type DNS\_TYPE\_AAAA can also be used to query the DNS servers for AAAA records.</span></span>

## <a name="establishing-a-connection"></a><span data-ttu-id="971f5-114">Istituzione di una connessione</span><span class="sxs-lookup"><span data-stu-id="971f5-114">Establishing a Connection</span></span>

<span data-ttu-id="971f5-115">Una connessione stabilita con Teredo viene descritta come ' seamless ' perché viene gestita come qualsiasi altra connessione IPv6.</span><span class="sxs-lookup"><span data-stu-id="971f5-115">A connection established with Teredo is described as 'seamless' because it is handled like any other IPv6 connection.</span></span> <span data-ttu-id="971f5-116">La programmazione di un'applicazione non richiede una particolare considerazione per poter utilizzare l'interfaccia Teredo.</span><span class="sxs-lookup"><span data-stu-id="971f5-116">The programming of an application does not require special consideration to be capable of utilizing the Teredo interface.</span></span> <span data-ttu-id="971f5-117">Quando viene stabilita una connessione tra le interfacce Teredo, non è necessario un router di inoltro, tipico di 6to4 e altre interfacce native.</span><span class="sxs-lookup"><span data-stu-id="971f5-117">When a connection is established between Teredo interfaces, a relay router, typical of 6to4 and other native interfaces, is not required.</span></span> <span data-ttu-id="971f5-118">Tuttavia, Teredo è progettato come ultima tecnologia di transizione per la connettività IPv6.</span><span class="sxs-lookup"><span data-stu-id="971f5-118">However, Teredo is designed as a last resort transition technology for IPv6 connectivity.</span></span>

> [!Note]  
> <span data-ttu-id="971f5-119">Teredo non viene utilizzato se il nome host fornito viene risolto solo negli indirizzi IPv4.</span><span class="sxs-lookup"><span data-stu-id="971f5-119">Teredo is not utilized if the supplied hostname resolves to IPv4 addresses only.</span></span>

 

<span data-ttu-id="971f5-120">Quando un'applicazione tenta di connettersi a una destinazione usando indirizzi IPv6, si verificherà quanto segue:</span><span class="sxs-lookup"><span data-stu-id="971f5-120">When an application attempts to connect to a destination using IPv6 addresses, the following will occur:</span></span>

-   <span data-ttu-id="971f5-121">L'applicazione ottiene un elenco di indirizzi IPv6 chiamando l'API [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) .</span><span class="sxs-lookup"><span data-stu-id="971f5-121">The application obtains a list of IPv6 addresses by calling the [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) API.</span></span> <span data-ttu-id="971f5-122">Lo stack di Windows Vista restituisce un elenco di tutte le interfacce basate sull'ordinamento specificato nella [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span><span class="sxs-lookup"><span data-stu-id="971f5-122">The Windows Vista stack returns a list of all interfaces based on the sorting order specified in [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span></span> <span data-ttu-id="971f5-123">Di conseguenza, le interfacce IPv6 IPv6 e 6to4 verranno elencate prima dell'interfaccia Teredo.</span><span class="sxs-lookup"><span data-stu-id="971f5-123">As a result, IPv6 and 6to4 IPv6 interfaces will be listed before Teredo interface.</span></span> <span data-ttu-id="971f5-124">Tuttavia, quando non è disponibile la connettività IPv6 o 6to4 nativa, Teredo sarà l'unica interfaccia in grado di supportare IPv6 elencata.</span><span class="sxs-lookup"><span data-stu-id="971f5-124">However, when native IPv6 or 6to4 connectivity is not available, Teredo will be the only IPv6 capable interface listed.</span></span>

    <span data-ttu-id="971f5-125">È importante ricordare che un'applicazione può utilizzare qualsiasi interfaccia fornita dallo stack di Windows Vista, tuttavia l'ordine dell'elenco di interfacce restituito genererà l'ultimo tentativo di Teredo.</span><span class="sxs-lookup"><span data-stu-id="971f5-125">It is important to remember that an application can use any interface provided by the Windows Vista stack, however the ordering of the interface list returned will most often result in Teredo being attempted last.</span></span>

-   <span data-ttu-id="971f5-126">Prima che Windows Vista tenti una connessione sull'interfaccia Teredo, il sistema operativo garantisce la stabilità dell'indirizzo IPv6.</span><span class="sxs-lookup"><span data-stu-id="971f5-126">Before Windows Vista attempts a connection over the Teredo interface, the operating system ensures that the IPv6 address has stabilized.</span></span> <span data-ttu-id="971f5-127">Questa operazione viene eseguita automaticamente per le connessioni in uscita e non è una considerazione cruciale per un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="971f5-127">This is done automatically for outgoing connections and is not a crucial consideration for an application.</span></span> <span data-ttu-id="971f5-128">Nel caso in cui l'applicazione sia necessaria per garantire la stabilità degli indirizzi, è possibile chiamare l'API [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) per assicurarsi che l'indirizzo Teredo sia stabile.</span><span class="sxs-lookup"><span data-stu-id="971f5-128">In the event the application is required to guarantee address stability, the [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) API can be called to ensure that the Teredo address is stable.</span></span>

-   <span data-ttu-id="971f5-129">Un'interfaccia Teredo tenterà di connettersi a un'altra interfaccia Teredo nella destinazione.</span><span class="sxs-lookup"><span data-stu-id="971f5-129">A Teredo interface will attempt to connect to another Teredo interface at the destination.</span></span> <span data-ttu-id="971f5-130">Se non è presente un'interfaccia Teredo, viene stabilita una connessione con un indirizzo di destinazione nativo o 6to4 tramite un inoltro specifico dell'host.</span><span class="sxs-lookup"><span data-stu-id="971f5-130">If a Teredo interface is not present, a connection is established with a native or 6to4 destination address through a host-specific relay.</span></span>

<span data-ttu-id="971f5-131">È anche possibile che le applicazioni che avviano connessioni a Internet ricevano traffico non richiesto.</span><span class="sxs-lookup"><span data-stu-id="971f5-131">It is also possible for applications that initiate connections to the Internet to receive unsolicited traffic.</span></span> <span data-ttu-id="971f5-132">Per altri dettagli, vedere [ricezione di traffico non richiesto su Teredo](receiving-unsolicited-traffic-over-teredo.md).</span><span class="sxs-lookup"><span data-stu-id="971f5-132">For more details see [Receiving Unsolicited Traffic Over Teredo](receiving-unsolicited-traffic-over-teredo.md).</span></span>

## <a name="using-the-wsaconnectbyname-api"></a><span data-ttu-id="971f5-133">Uso dell'API con WSAConnectByName</span><span class="sxs-lookup"><span data-stu-id="971f5-133">Using the WSAConnectByName API</span></span>

<span data-ttu-id="971f5-134">Chiamando l'API con WSAConnectByName, è possibile che un'applicazione si connetta a un nome di destinazione invece di specificare l'indirizzo IP esatto.</span><span class="sxs-lookup"><span data-stu-id="971f5-134">By calling the WSAConnectByName API, it is possible for an application to connect to a destination name instead of specifying the exact IP address.</span></span> <span data-ttu-id="971f5-135">Lo stack di Windows Vista preferisce IPv6 su IPv4 e, di conseguenza, verranno prima eseguiti tutti i tentativi di connessione agli indirizzi IPv6.</span><span class="sxs-lookup"><span data-stu-id="971f5-135">The Windows Vista stack prefers IPv6 over IPv4, and as a result any connection attempts will be made to IPv6 addresses first.</span></span>

<span data-ttu-id="971f5-136">Se si chiama l'API con WSAConnectByName, tutti gli indirizzi IP di destinazione ottenuti vengono ordinati nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="971f5-136">Calling the WSAConnectByName API will sort all destination IP addresses obtained in the following order:</span></span>

-   <span data-ttu-id="971f5-137">Indirizzo IPv6 nativo</span><span class="sxs-lookup"><span data-stu-id="971f5-137">Native IPv6 address</span></span>
-   <span data-ttu-id="971f5-138">Indirizzo IP 6to4</span><span class="sxs-lookup"><span data-stu-id="971f5-138">6to4 IP address</span></span>
-   <span data-ttu-id="971f5-139">IPv4 address (Indirizzo IPv4)</span><span class="sxs-lookup"><span data-stu-id="971f5-139">IPv4 address</span></span>
-   <span data-ttu-id="971f5-140">Indirizzo Teredo</span><span class="sxs-lookup"><span data-stu-id="971f5-140">Teredo address</span></span>

<span data-ttu-id="971f5-141">Quando gli indirizzi di destinazione vengono ordinati internamente, viene tentata una connessione alla destinazione in base alla route migliore disponibile nell'host locale per l'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="971f5-141">After the destination addresses are sorted internally, a connection to the destination is attempted based on the best route available on the local host for the destination address.</span></span> <span data-ttu-id="971f5-142">Come indicato dall'ordine degli indirizzi ordinati, se il nome di destinazione viene risolto in un indirizzo IPv4 e Teredo, per stabilire la connessione verrà usato l'indirizzo IPv4.</span><span class="sxs-lookup"><span data-stu-id="971f5-142">As indicated by the order of the sorted addresses, if the destination name resolves to a IPv4 and Teredo address, the IPv4 address will be used to establish the connection.</span></span>

<span data-ttu-id="971f5-143">L'API con WSAConnectByName funziona internamente per trovare la migliore corrispondenza tra gli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="971f5-143">The WSAConnectByName API works internally to find the best match between addresses.</span></span> <span data-ttu-id="971f5-144">Questo tentativo si basa sulle route disponibili nell'host locale e negli indirizzi di destinazione.</span><span class="sxs-lookup"><span data-stu-id="971f5-144">This attempt is based on the routes available on the local host and the destination addresses.</span></span>

<span data-ttu-id="971f5-145">A causa dell'assenza corrente degli inoltri Teredo su Internet, è improbabile che le connessioni agli indirizzi IPv6 nativi siano riuscite sull'interfaccia Teredo.</span><span class="sxs-lookup"><span data-stu-id="971f5-145">Due to current absence of Teredo relays on the Internet, connections to native IPv6 addresses are unlikely to succeed over the Teredo interface.</span></span> <span data-ttu-id="971f5-146">Se viene chiamato con WSAConnectByName, Windows Vista non emetterà query AAAA quando Teredo è l'unica interfaccia compatibile con IPv6 disponibile.</span><span class="sxs-lookup"><span data-stu-id="971f5-146">If WSAConnectByName is called, Windows Vista will not issue AAAA queries when Teredo is the only IPv6 capable interface available.</span></span> <span data-ttu-id="971f5-147">In questo modo si garantisce che gli indirizzi IPv6 nativi non vengano ottenuti come destinazione e che le connessioni vengano tentate su IPv4, con la massima probabilità di successo.</span><span class="sxs-lookup"><span data-stu-id="971f5-147">This ensures that native IPv6 addresses are not obtained as a destination and that connections are attempted over IPv4, which has the highest chance of success.</span></span> <span data-ttu-id="971f5-148">Per ottenere gli indirizzi IPv6 quando Teredo è l'unica interfaccia compatibile con IPv6, un'applicazione deve usare in modo esplicito l'API DnsQuery per i record AAAA.</span><span class="sxs-lookup"><span data-stu-id="971f5-148">In order to obtain IPv6 addresses when Teredo is the only IPv6 capable interface, an application must explicitly use the DnsQuery API for AAAA records.</span></span>

 

 