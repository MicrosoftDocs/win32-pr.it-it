---
title: Fase geometry shader
description: La fase geometry-shader (GS) esegue il codice shader specificato dall'applicazione con i vertici come input e la possibilità di generare vertici nell'output.
ms.assetid: F3208862-980E-403F-9154-13B34A882787
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: da66b1e3f9abf4e7db8010887f3e78676d02a874
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "103728386"
---
# <a name="geometry-shader-stage"></a><span data-ttu-id="d962e-103">Fase geometry shader</span><span class="sxs-lookup"><span data-stu-id="d962e-103">Geometry Shader Stage</span></span>

<span data-ttu-id="d962e-104">La fase geometry-shader (GS) esegue il codice shader specificato dall'applicazione con i vertici come input e la possibilità di generare vertici nell'output.</span><span class="sxs-lookup"><span data-stu-id="d962e-104">The geometry-shader (GS) stage runs application-specified shader code with vertices as input and the ability to generate vertices on output.</span></span>

## <a name="the-geometry-shader"></a><span data-ttu-id="d962e-105">Geometry shader</span><span class="sxs-lookup"><span data-stu-id="d962e-105">The Geometry Shader</span></span>

<span data-ttu-id="d962e-106">Diversamente dai vertex shader, che operano su un singolo vertice, gli input di Geometry shader sono i vertici di una primitiva completa (due vertici per le linee, tre vertici per i triangoli o un vertice singolo per Point).</span><span class="sxs-lookup"><span data-stu-id="d962e-106">Unlike vertex shaders, which operate on a single vertex, the geometry shader's inputs are the vertices for a full primitive (two vertices for lines, three vertices for triangles, or single vertex for point).</span></span> <span data-ttu-id="d962e-107">I geometry shader possono anche inserire i dati dei vertici per le primitive adiacenti al bordo come input (altri due vertici per una linea, tre ulteriori per un triangolo).</span><span class="sxs-lookup"><span data-stu-id="d962e-107">Geometry shaders can also bring in the vertex data for the edge-adjacent primitives as input (an additional two vertices for a line, an additional three for a triangle).</span></span> <span data-ttu-id="d962e-108">La figura seguente mostra un triangolo e una linea con vertici adiacenti.</span><span class="sxs-lookup"><span data-stu-id="d962e-108">The following illustration shows a triangle and a line with adjacent vertices.</span></span>

![illustrazione di un triangolo e di una linea con vertici adiacenti](images/d3d10-gs.png)

|     |                 |
|-----|-----------------|
| <span data-ttu-id="d962e-110">TV</span><span class="sxs-lookup"><span data-stu-id="d962e-110">TV</span></span>  | <span data-ttu-id="d962e-111">Vertice triangolo</span><span class="sxs-lookup"><span data-stu-id="d962e-111">Triangle vertex</span></span> |
| <span data-ttu-id="d962e-112">AV</span><span class="sxs-lookup"><span data-stu-id="d962e-112">AV</span></span>  | <span data-ttu-id="d962e-113">Vertice adiacente</span><span class="sxs-lookup"><span data-stu-id="d962e-113">Adjacent vertex</span></span> |
| <span data-ttu-id="d962e-114">LV</span><span class="sxs-lookup"><span data-stu-id="d962e-114">LV</span></span>  | <span data-ttu-id="d962e-115">Vertice linea</span><span class="sxs-lookup"><span data-stu-id="d962e-115">Line vertex</span></span>     |



 

<span data-ttu-id="d962e-116">La fase geometry-shader può utilizzare il \_ [valore generato dal sistema](d3d10-graphics-programming-guide-input-assembler-stage-using.md) SV PrimitiveID generato automaticamente dall'IA.</span><span class="sxs-lookup"><span data-stu-id="d962e-116">The geometry-shader stage can consume the SV\_PrimitiveID [system-generated value](d3d10-graphics-programming-guide-input-assembler-stage-using.md) that is auto-generated by the IA.</span></span> <span data-ttu-id="d962e-117">In questo modo è possibile recuperare o calcolare i dati per primitive, se lo si desidera.</span><span class="sxs-lookup"><span data-stu-id="d962e-117">This allows per-primitive data to be fetched or computed if desired.</span></span>

<span data-ttu-id="d962e-118">La fase geometry-shader è in grado di restituire più vertici che formano una singola topologia selezionata (le topologie di output della fase GS disponibili sono: tristrip, LineStrip e elenco di puntatori).</span><span class="sxs-lookup"><span data-stu-id="d962e-118">The geometry-shader stage is capable of outputting multiple vertices forming a single selected topology (GS stage output topologies available are: tristrip, linestrip, and pointlist).</span></span> <span data-ttu-id="d962e-119">Il numero di primitive emesse può variare liberamente all'interno di qualsiasi chiamata del geometry shader, sebbene il numero massimo di vertici che è possibile emettere debba essere dichiarato in modo statico.</span><span class="sxs-lookup"><span data-stu-id="d962e-119">The number of primitives emitted can vary freely within any invocation of the geometry shader, though the maximum number of vertices that could be emitted must be declared statically.</span></span> <span data-ttu-id="d962e-120">Le lunghezze di striscia emesse da una chiamata di shader Geometry possono essere arbitrarie e le nuove strisce possono essere create tramite la funzione [RestartStrip](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip) HLSL.</span><span class="sxs-lookup"><span data-stu-id="d962e-120">Strip lengths emitted from a geometry shader invocation can be arbitrary, and new strips can be created via the [RestartStrip](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip) HLSL function.</span></span>

<span data-ttu-id="d962e-121">L'output di Geometry shader può essere alimentato alla fase di rasterizzazione e/o a un buffer dei vertici in memoria tramite la fase di output del flusso.</span><span class="sxs-lookup"><span data-stu-id="d962e-121">Geometry shader output may be fed to the rasterizer stage and/or to a vertex buffer in memory via the stream output stage.</span></span> <span data-ttu-id="d962e-122">L'output alimentato alla memoria viene espanso nei singoli elenchi punto/linea/triangolo (esattamente come verrebbero passati al rasterizzatore).</span><span class="sxs-lookup"><span data-stu-id="d962e-122">Output fed to memory is expanded to individual point/line/triangle lists (exactly as they would be passed to the rasterizer).</span></span>

<span data-ttu-id="d962e-123">Quando un geometry shader è attivo, viene richiamato una volta per ogni primitiva passata o generata in precedenza nella pipeline.</span><span class="sxs-lookup"><span data-stu-id="d962e-123">When a geometry shader is active, it is invoked once for every primitive passed down or generated earlier in the pipeline.</span></span> <span data-ttu-id="d962e-124">Ogni chiamata di Geometry shader considera come input i dati per la primitiva chiamante, sia che si tratti di un singolo punto, di una singola riga o di un singolo triangolo.</span><span class="sxs-lookup"><span data-stu-id="d962e-124">Each invocation of the geometry shader sees as input the data for the invoking primitive, whether that is a single point, a single line, or a single triangle.</span></span> <span data-ttu-id="d962e-125">Una striscia di triangolo precedente nella pipeline comporterebbe una chiamata del geometry shader per ogni singolo triangolo nella striscia (come se la striscia venisse espansa in un elenco di triangolo).</span><span class="sxs-lookup"><span data-stu-id="d962e-125">A triangle strip from earlier in the pipeline would result in an invocation of the geometry shader for each individual triangle in the strip (as if the strip were expanded out into a triangle list).</span></span> <span data-ttu-id="d962e-126">Sono disponibili tutti i dati di input per ogni vertice della primitiva, ovvero 3 vertici per il triangolo, oltre ai dati dei vertici adiacenti, se applicabili o disponibili.</span><span class="sxs-lookup"><span data-stu-id="d962e-126">All the input data for each vertex in the individual primitive is available (i.e. 3 vertices for triangle), plus adjacent vertex data if applicable/available.</span></span>

<span data-ttu-id="d962e-127">Un geometry shader restituisce i dati un vertice alla volta aggiungendo i vertici a un oggetto del flusso di output.</span><span class="sxs-lookup"><span data-stu-id="d962e-127">A geometry shader outputs data one vertex at a time by appending vertices to an output stream object.</span></span> <span data-ttu-id="d962e-128">La topologia dei flussi è determinata da una dichiarazione fixed, scegliendo uno dei seguenti: PointStream, LineStream o TriangleStream come output per la fase GS.</span><span class="sxs-lookup"><span data-stu-id="d962e-128">The topology of the streams is determined by a fixed declaration, choosing one of: PointStream, LineStream, or TriangleStream as the output for the GS stage.</span></span> <span data-ttu-id="d962e-129">Sono disponibili tre tipi di oggetti flusso, PointStream, LineStream e TriangleStream, che sono tutti oggetti basati su modelli.</span><span class="sxs-lookup"><span data-stu-id="d962e-129">There are three types of stream objects available, PointStream, LineStream and TriangleStream which are all templated objects.</span></span> <span data-ttu-id="d962e-130">La topologia dell'output è determinata dal rispettivo tipo di oggetto, mentre il formato dei vertici accodati al flusso è determinato dal tipo di modello.</span><span class="sxs-lookup"><span data-stu-id="d962e-130">The topology of the output is determined by their respective object type, while the format of the vertices appended to the stream is determined by the template type.</span></span> <span data-ttu-id="d962e-131">L'esecuzione di un'istanza geometry shader è atomica da altre chiamate, ad eccezione del fatto che i dati aggiunti ai flussi sono di tipo seriale.</span><span class="sxs-lookup"><span data-stu-id="d962e-131">Execution of a geometry shader instance is atomic from other invocations, except that data added to the streams is serial.</span></span> <span data-ttu-id="d962e-132">Gli output di una determinata chiamata di uno shader Geometry sono indipendenti dalle altre chiamate (anche se l'ordinamento è rispettato).</span><span class="sxs-lookup"><span data-stu-id="d962e-132">The outputs of a given invocation of a geometry shader are independent of other invocations (though ordering is respected).</span></span> <span data-ttu-id="d962e-133">Un geometry shader che genera strisce triangolari avvierà una nuova striscia a ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="d962e-133">A geometry shader generating triangle strips will start a new strip on every invocation.</span></span>

<span data-ttu-id="d962e-134">Quando un output di Geometry shader viene identificato come valore interpretato dal sistema (ad esempio \_ , SV RenderTargetArrayIndex o SV \_ position), l'hardware esamina questi dati ed esegue un comportamento dipendente dal valore, oltre a essere in grado di passare i dati alla fase successiva dello shader per l'input.</span><span class="sxs-lookup"><span data-stu-id="d962e-134">When a geometry shader output is identified as a System Interpreted Value (e.g. SV\_RenderTargetArrayIndex or SV\_Position), hardware looks at this data and performs some behavior dependent on the value, in addition to being able to pass the data itself to the next shader stage for input.</span></span> <span data-ttu-id="d962e-135">Quando l'output di questo tipo di dati di Geometry shader ha un significato per l'hardware in base ai primitivi (ad esempio, SV \_ RenderTargetArrayIndex o SV \_ ViewportArrayIndex), anziché in base al singolo vertice (ad esempio \_ , SV Clipdistance \[ n \] o SV \_ position), i dati per primitivi vengono presi dal vertice principale emesso per la primitiva.</span><span class="sxs-lookup"><span data-stu-id="d962e-135">When such data output from the geometry shader has meaning to the hardware on a per-primitive basis (such as SV\_RenderTargetArrayIndex or SV\_ViewportArrayIndex), rather than on a per-vertex basis (such as SV\_ClipDistance\[n\] or SV\_Position), the per-primitive data is taken from the leading vertex emitted for the primitive.</span></span>

<span data-ttu-id="d962e-136">Le primitive parzialmente completate potrebbero essere generate dalla geometria shader se il geometry shader termina e la primitiva è incompleta.</span><span class="sxs-lookup"><span data-stu-id="d962e-136">Partially completed primitives could be generated by the geometry shader if the geometry shader ends and the primitive is incomplete.</span></span> <span data-ttu-id="d962e-137">Le primitive incomplete vengono scartate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="d962e-137">Incomplete primitives are silently discarded.</span></span> <span data-ttu-id="d962e-138">Questa operazione è simile al modo in cui l'IA tratta le primitive parzialmente completate.</span><span class="sxs-lookup"><span data-stu-id="d962e-138">This is similar to the way the IA treats partially completed primitives.</span></span>

<span data-ttu-id="d962e-139">Geometry shader può eseguire operazioni di campionamento del carico e della trama in cui i derivati dello spazio dello schermo non sono obbligatori (samplelevel, SampleCmpLevelZero, samplegrad).</span><span class="sxs-lookup"><span data-stu-id="d962e-139">The geometry shader can perform load and texture sampling operations where screen-space derivatives are not required (samplelevel, samplecmplevelzero, samplegrad).</span></span>

<span data-ttu-id="d962e-140">Gli algoritmi che possono essere implementati in Geometry shader includono:</span><span class="sxs-lookup"><span data-stu-id="d962e-140">Algorithms that can be implemented in the geometry shader include:</span></span>

-   <span data-ttu-id="d962e-141">Espansione sprite punto</span><span class="sxs-lookup"><span data-stu-id="d962e-141">Point Sprite Expansion</span></span>
-   <span data-ttu-id="d962e-142">Sistemi particellari dinamici</span><span class="sxs-lookup"><span data-stu-id="d962e-142">Dynamic Particle Systems</span></span>
-   <span data-ttu-id="d962e-143">Generazione di pellicce/pinna</span><span class="sxs-lookup"><span data-stu-id="d962e-143">Fur/Fin Generation</span></span>
-   <span data-ttu-id="d962e-144">Generazione del volume shadow</span><span class="sxs-lookup"><span data-stu-id="d962e-144">Shadow Volume Generation</span></span>
-   <span data-ttu-id="d962e-145">Rendering a passaggio singolo-a-mappa cubi</span><span class="sxs-lookup"><span data-stu-id="d962e-145">Single Pass Render-to-Cubemap</span></span>
-   <span data-ttu-id="d962e-146">Scambio di materiali Per-Primitive</span><span class="sxs-lookup"><span data-stu-id="d962e-146">Per-Primitive Material Swapping</span></span>
-   <span data-ttu-id="d962e-147">Per-Primitive la configurazione del materiale, inclusa la generazione di coordinate baricentrica come dati primitivi, in modo che un pixel shader possa eseguire l'interpolazione di attributi personalizzati (per un esempio di interpolazione normale di ordine superiore, vedere [esempio di CubeMapGS](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span><span class="sxs-lookup"><span data-stu-id="d962e-147">Per-Primitive Material Setup - Including generation of barycentric coordinates as primitive data so that a pixel shader can perform custom attribute interpolation (for an example of higher-order normal interpolation, see [CubeMapGS Sample](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d962e-148">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d962e-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d962e-149">Pipeline grafica</span><span class="sxs-lookup"><span data-stu-id="d962e-149">Graphics Pipeline</span></span>](overviews-direct3d-11-graphics-pipeline.md)
</dt> <dt>

[<span data-ttu-id="d962e-150">Fasi della pipeline (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="d962e-150">Pipeline Stages (Direct3D 10)</span></span>](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-pipeline-stages)
</dt> </dl>

 

 