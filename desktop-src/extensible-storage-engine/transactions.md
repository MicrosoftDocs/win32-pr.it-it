---
description: 'Altre informazioni su: transazioni (eventi di Windows)'
title: Transazioni (eventi di Windows)
TOCTitle: Transactions
ms:assetid: 1ceb362c-1efe-439b-b10a-016c8a54f27b
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269197(v=EXCHG.10)
ms:contentKeyID: 32765500
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 90b5b566f5ff961ce7b0ae3725f580e1f39c041d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104346956"
---
# <a name="transactions-windows-events"></a><span data-ttu-id="a0d6c-103">Transazioni (eventi di Windows)</span><span class="sxs-lookup"><span data-stu-id="a0d6c-103">Transactions (Windows Events)</span></span>


<span data-ttu-id="a0d6c-104">_**Si applica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="a0d6c-104">_**Applies to:** Windows�| Windows Server_</span></span>

## <a name="transactions"></a><span data-ttu-id="a0d6c-105">Transazioni</span><span class="sxs-lookup"><span data-stu-id="a0d6c-105">Transactions</span></span>

<span data-ttu-id="a0d6c-106">Le transazioni ESE sono unità logiche di elaborazione che controllano il modo in cui un'applicazione rileva e modifica le righe nel database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-106">ESE transactions are logical units of processing that control how an application sees and manipulates rows in the database.</span></span> <span data-ttu-id="a0d6c-107">L'applicazione può utilizzare i punti di salvataggio delle transazioni per determinare se conservare o eliminare un particolare set di modifiche al database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-107">Your application can use transaction save points to determine whether to keep or discard a particular set of changes to the database.</span></span> <span data-ttu-id="a0d6c-108">Tutte le transazioni in ESE sono atomiche, coerenti, isolate e durevoli (ACID), come descritto di seguito:</span><span class="sxs-lookup"><span data-stu-id="a0d6c-108">All transactions in ESE are atomic, consistent, isolated, and durable (ACID) as described below:</span></span>

  - <span data-ttu-id="a0d6c-109">**Atomic:** Tutti gli aggiornamenti nella transazione vengono visualizzati nel database o vengono eliminati.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-109">**Atomic:** All the updates in the transaction either appear in the database or they are discarded.</span></span>

<!-- end list -->

  - <span data-ttu-id="a0d6c-110">**Coerente:** Il database viene sempre avviato in uno stato valido e termina sempre con un altro stato valido.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-110">**Consistent:** The database will always start in a legal state and will always end in another legal state.</span></span> <span data-ttu-id="a0d6c-111">Per le applicazioni ESE, il motore di database controllerà alcuni vincoli semplici, ad esempio l'univocità di un indice univoco, ma l'applicazione stessa definirà quasi tutti gli altri aspetti del modo in cui il database si trova in uno stato valido.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-111">For ESE applications, the database engine will control some simple constraints, for example uniqueness of a unique index, but the application itself will define almost all other aspects of what it means for the database to be in a legal state.</span></span>

<!-- end list -->

  - <span data-ttu-id="a0d6c-112">**Isolamento:** Le transazioni sono isolate dagli aggiornamenti da altre sessioni.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-112">**Isolation:** Transactions are isolated from updates by other sessions.</span></span> <span data-ttu-id="a0d6c-113">Una transazione non visualizzerà mai un set parziale di modifiche apportate da un'altra transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-113">A transaction will never see a partial set of changes made by another transaction.</span></span>

<!-- end list -->

  - <span data-ttu-id="a0d6c-114">**Durevole:** Dopo che il motore di database ha confermato che è stato eseguito il commit di una transazione, le modifiche sono persistenti nel database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-114">**Durable:** After the database engine acknowledges that a transaction has been committed, its changes are persistent in the database.</span></span> <span data-ttu-id="a0d6c-115">La durabilità di una transazione può essere facoltativamente rinunciata per motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-115">The durability of a transaction may be optionally waived for performance reasons.</span></span>

<span data-ttu-id="a0d6c-116">Le transazioni vengono eseguite entro i limiti delle chiamate a [JetBeginTransaction](./jetbegintransaction-function.md) e [JetCommitTransaction](./jetcommittransaction-function.md) o [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="a0d6c-116">Transactions are performed within the bounds of the calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md).</span></span> <span data-ttu-id="a0d6c-117">Quando l'applicazione immette la transazione, il database viene visualizzato bloccato nell'istanza nel momento in cui inizia la transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-117">When the application enters the transaction, the database appears frozen at the instance in time that the transaction begins.</span></span> <span data-ttu-id="a0d6c-118">Questa operazione è denominata isolamento dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-118">This is called snapshot isolation.</span></span> <span data-ttu-id="a0d6c-119">Se la transazione viene terminata chiamando [JetRollback](./jetrollback-function.md), nessuna delle operazioni eseguite nella transazione viene sottoposta a commit nel database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-119">If the transaction is terminated by calling [JetRollback](./jetrollback-function.md), none of the operations performed in the transaction are committed to the database.</span></span> <span data-ttu-id="a0d6c-120">Se il processo o il computer si arresta in modo anomalo prima della chiamata a [JetCommitTransaction](./jetcommittransaction-function.md) , equivale alla chiamata a [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="a0d6c-120">If the process or the machine crashes before [JetCommitTransaction](./jetcommittransaction-function.md) is called, it is the same as calling [JetRollback](./jetrollback-function.md).</span></span>

<span data-ttu-id="a0d6c-121">Questa procedura illustra come avviare ed eseguire il commit di una transazione che legge e aggiorna i dati in un database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-121">This procedure shows how to start and commit a transaction that reads and updates data in a database.</span></span>

### <a name="to-start-and-commit-a-transaction"></a><span data-ttu-id="a0d6c-122">Per avviare ed eseguire il commit di una transazione</span><span class="sxs-lookup"><span data-stu-id="a0d6c-122">To start and commit a transaction</span></span>

1.  <span data-ttu-id="a0d6c-123">Chiamare [JetBeginTransaction](./jetbegintransaction-function.md) o [JETBEGINTRANSACTION2](./jetbegintransaction2-function.md) con l'ID sessione per avviare la transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-123">Call [JetBeginTransaction](./jetbegintransaction-function.md) or [JetBeginTransaction2](./jetbegintransaction2-function.md) with the session ID to start the transaction.</span></span>

2.  <span data-ttu-id="a0d6c-124">Spostare il cursore sul record desiderato chiamando [JetMove](./jetmove-function.md) con JET_MoveFirst specificato nel parametro *Crow* .</span><span class="sxs-lookup"><span data-stu-id="a0d6c-124">Move the cursor to the desired record by calling [JetMove](./jetmove-function.md) with JET_MoveFirst specified in the *cRow* parameter.</span></span> <span data-ttu-id="a0d6c-125">Per ulteriori informazioni su come spostare il cursore, vedere l'argomento [indicizzazione nell'](./indexing-in-the-table.md) argomento della tabella.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-125">For more information on how to move the cursor, see the [Indexing in the Table](./indexing-in-the-table.md) topic.</span></span>

3.  <span data-ttu-id="a0d6c-126">Chiamare [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) sul record corrente con JET_ColInfo specificato nel parametro *InfoLevel* per recuperare l'ID di colonna per la colonna.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-126">Call [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) on the current record with JET_ColInfo specified in the *InfoLevel* parameter to retrieve the column ID for the column.</span></span> <span data-ttu-id="a0d6c-127">L'ID di colonna viene restituito nella struttura [JET_COLUMNDEF](./jet-columndef-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="a0d6c-127">The column ID is returned in the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>

4.  <span data-ttu-id="a0d6c-128">Chiamare [JetSetColumn](./jetsetcolumn-function.md) con l'ID di sessione, l'ID di tabella e l'ID di colonna della colonna aggiornata.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-128">Call [JetSetColumn](./jetsetcolumn-function.md) with the session ID, table ID, and column ID of the column that is updated.</span></span> <span data-ttu-id="a0d6c-129">I dati della colonna sono contenuti nel parametro *pvData* .</span><span class="sxs-lookup"><span data-stu-id="a0d6c-129">The column data is contained in the *pvData* parameter.</span></span>

5.  <span data-ttu-id="a0d6c-130">Chiamare [JetCommitTransaction](./jetcommittransaction-function.md) per eseguire il commit della transazione nel database.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-130">Call [JetCommitTransaction](./jetcommittransaction-function.md) to commit the transaction to the database.</span></span>

<span data-ttu-id="a0d6c-131">Il modo in cui un motore di database ESE implementa l'isolamento dello snapshot presenta alcune differenze importanti rispetto ai modelli tradizionali di isolamento e blocco del database relazionale.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-131">The way in which an ESE database engine implements snapshot isolation has some important differences from traditional relational database isolation and locking models.</span></span> <span data-ttu-id="a0d6c-132">Quando una transazione legge una riga, può accedere sempre alla riga senza avere esito negativo o attendere che altre sessioni rilascino un blocco.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-132">When a transaction reads a row, it can always access the row without failing or waiting for other sessions to release a lock.</span></span> <span data-ttu-id="a0d6c-133">Quando una transazione tenta di aggiornare una riga, avrà esito positivo se è la prima sessione per aggiornare la riga, ovvero il primo writer WINS.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-133">When a transaction attempts to update a row, it will succeed if it is the first session to update that row, that is the first writer wins.</span></span> <span data-ttu-id="a0d6c-134">Se la sessione non è il primo writer, avrà immediatamente esito negativo con un errore di conflitto di scrittura.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-134">If the session is not the first writer then it will immediately fail with a write conflict error.</span></span> <span data-ttu-id="a0d6c-135">La sessione deve quindi interrompere la transazione, attendere (in genere tramite un ritardo casuale) per eseguire il commit delle modifiche da parte dell'altra transazione, quindi ripetere la transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-135">The session must then abort its transaction, wait (usually via a random delay), for the other transaction to commit its changes, and then retry the transaction.</span></span> <span data-ttu-id="a0d6c-136">Il motore di database non farà in modo che tale sessione attenda automaticamente il completamento dell'aggiornamento dell'altra transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-136">The database engine will not automatically cause that session to wait until the other transaction has finished its update.</span></span> <span data-ttu-id="a0d6c-137">In genere, una transazione verifica se è possibile aggiornare una riga all'interno della chiamata [JetUpdate](./jetupdate-function.md) .</span><span class="sxs-lookup"><span data-stu-id="a0d6c-137">Usually, a transaction will test if it can update a row inside of the [JetUpdate](./jetupdate-function.md) call.</span></span> <span data-ttu-id="a0d6c-138">Se non è possibile bloccare la riga per l'aggiornamento, [JetUpdate](./jetupdate-function.md) avrà esito negativo con JET_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-138">If it cannot lock the row for update then [JetUpdate](./jetupdate-function.md) will fail with JET_errWriteConflict.</span></span>

<span data-ttu-id="a0d6c-139">Le sessioni sono limitate a un thread dal momento in cui la transazione inizia fino alla fine della transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-139">Sessions are limited to one thread from the time the transaction starts to the end of the transaction.</span></span> <span data-ttu-id="a0d6c-140">È consigliabile eseguire tutte le operazioni di aggiornamento e recupero in una transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-140">It is recommended that all update and retrieve operations be performed in a transaction.</span></span> <span data-ttu-id="a0d6c-141">ESE supporta inoltre modifiche dello schema, ad esempio la creazione di tabelle e l'aggiunta di colonne all'interno della transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-141">ESE also supports schema modifications such as creating tables and adding columns inside the transaction.</span></span> <span data-ttu-id="a0d6c-142">È possibile eseguire le modifiche di aggiornamento e dello schema nella stessa transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-142">Both update and schema modifications can be performed in the same transaction.</span></span> <span data-ttu-id="a0d6c-143">Al termine della transazione con [JetCommitTransaction](./jetcommittransaction-function.md), l'aggiornamento viene registrato nel file di log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-143">After the transaction completes with [JetCommitTransaction](./jetcommittransaction-function.md), the update is logged in the transaction log file.</span></span> <span data-ttu-id="a0d6c-144">Questi file possono essere utilizzati per mantenere uno stato logicamente coerente in caso di interruzione imprevista di un processo o di arresto del sistema.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-144">These files can be used to maintain a logically consistent state in the event of an unexpected process termination or system shutdown.</span></span>

<span data-ttu-id="a0d6c-145">Le transazioni possono essere annidate fino a 7 livelli con chiamate corrispondenti a [JetBeginTransaction](./jetbegintransaction-function.md) e [JetCommitTransaction](./jetcommittransaction-function.md) o [JetRollback](./jetrollback-function.md) annidate l'una all'altra.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-145">Transactions may be nested up to 7 levels with matching calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md) nested within each other.</span></span> <span data-ttu-id="a0d6c-146">Ciò consente all'applicazione di eseguire il rollback di una parte della transazione senza dover eseguire il rollback dell'intera transazione.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-146">This allows the application to rollback a part of the transaction without having to back out of the entire transaction.</span></span> <span data-ttu-id="a0d6c-147">La chiamata nidificata a [JetCommitTransaction](./jetcommittransaction-function.md) indica che questo livello di elaborazione è stato completato; Tuttavia, non viene eseguito il commit della transazione nel database fino a quando la chiamata più esterna non esegue il commit della transazione con [JetCommitTransaction](./jetcommittransaction-function.md).</span><span class="sxs-lookup"><span data-stu-id="a0d6c-147">The nested call to [JetCommitTransaction](./jetcommittransaction-function.md) signifies that this level of processing is complete; however, the transaction is not committed to the database until the outer most call to commit the transaction with [JetCommitTransaction](./jetcommittransaction-function.md).</span></span>

<span data-ttu-id="a0d6c-148">È possibile aggiornare le colonne di aggiornamento del deposito simultaneamente da più sessioni senza errori Jet_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-148">Escrow update columns can be updated concurrently by multiple sessions without failing with Jet_errWriteConflict.</span></span> <span data-ttu-id="a0d6c-149">La funzione [JetEscrowUpdate](./jetescrowupdate-function.md) può essere chiamata solo su colonne escrow, che sono state create con Jet_bitColumnEscrowUpdate.</span><span class="sxs-lookup"><span data-stu-id="a0d6c-149">The [JetEscrowUpdate](./jetescrowupdate-function.md) function may only be called on escrow columns, columns that were created with Jet_bitColumnEscrowUpdate.</span></span>
