---
description: 'Altre informazioni su: chiave di indice'
title: Chiave di indice
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104562049"
---
# <a name="index-key"></a><span data-ttu-id="30247-103">Chiave di indice</span><span class="sxs-lookup"><span data-stu-id="30247-103">Index Key</span></span>


<span data-ttu-id="30247-104">_**Si applica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="30247-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="index-key"></a><span data-ttu-id="30247-105">Chiave di indice</span><span class="sxs-lookup"><span data-stu-id="30247-105">Index Key</span></span>

<span data-ttu-id="30247-106">Viene creato un indice sui dati della tabella con [JetCreateIndex](./jetcreateindex-function.md) oppure è possibile creare più indici contemporaneamente con [JetCreateIndex2](./jetcreateindex2-function.md) usando la struttura [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="30247-106">An index is created over data in the table with [JetCreateIndex](./jetcreateindex-function.md) or multiple indexes may be created simultaneously with [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="30247-107">L'indice è definito in termini di una matrice di colonne, in ordine di precedenza.</span><span class="sxs-lookup"><span data-stu-id="30247-107">The index is defined in terms of an array of columns, in precedence order.</span></span> <span data-ttu-id="30247-108">Questa matrice di colonne viene chiamata anche chiave di indice.</span><span class="sxs-lookup"><span data-stu-id="30247-108">This array of columns is also called the index key.</span></span> <span data-ttu-id="30247-109">La chiave di indice può essere definita come indice primario quando l'opzione JET_bitIndexPrimary è impostata nel parametro *grbit* di [JetCreateIndex](./jetcreateindex-function.md) o [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span><span class="sxs-lookup"><span data-stu-id="30247-109">The index key may be defined as the primary index when the JET_bitIndexPrimary option is set in the *grbit* parameter of [JetCreateIndex](./jetcreateindex-function.md) or [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span></span> <span data-ttu-id="30247-110">La chiave di indice è una stringa con terminazione null di token con terminazione null, come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="30247-110">The index key is a null terminated string of null terminated tokens as shown in the following example:</span></span>

<span data-ttu-id="30247-111">\+Col1 \\ 0-Col2 \\ 0 + Col3 \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="30247-111">\+Col1\\0-Col2\\0+Col3\\0\\0</span></span>

<span data-ttu-id="30247-112">La chiave nell'esempio può essere utilizzata per creare un indice in tre colonne della tabella.</span><span class="sxs-lookup"><span data-stu-id="30247-112">The key in the example may be used to create an index over three columns in the table.</span></span> <span data-ttu-id="30247-113">Ogni colonna specificata nell'indice viene definita "segmento di indice" o "colonna chiave".</span><span class="sxs-lookup"><span data-stu-id="30247-113">Each column specified in the index is referred to as the "index segment" or "key column".</span></span> <span data-ttu-id="30247-114">È possibile che il segmento di indice sia crescente o decrescente in termini di contributo dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="30247-114">The index segment may be either ascending or descending in terms of its ordering contribution.</span></span> <span data-ttu-id="30247-115">Nell'esempio precedente, il nome della prima colonna nell'indice è col1.</span><span class="sxs-lookup"><span data-stu-id="30247-115">In the example above, the name of the first column in the index is Col1.</span></span> <span data-ttu-id="30247-116">Il + indica che col1 è indicizzato in ordine crescente.</span><span class="sxs-lookup"><span data-stu-id="30247-116">The + indicates that Col1 is indexed in ascending order.</span></span> <span data-ttu-id="30247-117">Il – prima di col2 indica che è indicizzato in ordine decrescente.</span><span class="sxs-lookup"><span data-stu-id="30247-117">The – before Col2 indicates that it is indexed in descending order.</span></span>

<span data-ttu-id="30247-118">Quando nell'indice sono presenti colonne condizionali, la struttura [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) viene utilizzata per indicare il modo in cui vengono indicizzate.</span><span class="sxs-lookup"><span data-stu-id="30247-118">When conditional columns are present in the index, the [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) structure is used to indicate how they are indexed.</span></span> <span data-ttu-id="30247-119">Una colonna condizionale può essere utilizzata per controllare la presenza o l'assenza di una voce di indice in un indice in base al valore nella colonna condizionale corrispondente senza influire sull'ordinamento dell'indice.</span><span class="sxs-lookup"><span data-stu-id="30247-119">A conditional column may be used to control the presence or absence of an index entry in an index based on the value in the corresponding conditional column without affecting the sort order of the index.</span></span> <span data-ttu-id="30247-120">Una colonna condizionale può includere o escludere una voce di indice dall'indice se il valore della colonna condizionale è NULL per il record corrispondente.</span><span class="sxs-lookup"><span data-stu-id="30247-120">A conditional column may include or exclude an index entry from the index if the value of that conditional column is NULL for the corresponding record.</span></span>

<span data-ttu-id="30247-121">Per impostazione predefinita, la dimensione massima della chiave di indice viene fornita dalla costante JET_cbKeyMost che ha sempre avuto 255 byte di dati normalizzati (byte di dati, incluso l'overhead di indicizzazione).</span><span class="sxs-lookup"><span data-stu-id="30247-121">By default, the maximum size of the index key is given by the JET_cbKeyMost constant which has always been 255 bytes of normalized data (bytes of data including the indexing overhead).</span></span> <span data-ttu-id="30247-122">A partire da Windows Vista, è possibile impostare la dimensione massima della chiave di indice con la struttura [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="30247-122">Starting with Windows Vista, the maximum size of the index key can be set with the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="30247-123">La dimensione massima della chiave di indice corrisponde alla dimensione della pagina del database.</span><span class="sxs-lookup"><span data-stu-id="30247-123">The maximum size of the index key corresponds to the database page size.</span></span> <span data-ttu-id="30247-124">Per abilitare una dimensione massima personalizzata della chiave, specificare l'opzione Jet_bitIndexKeyMost nel membro grbits di [JET_INDEXCREATE](./jet-indexcreate-structure.md)e impostare il membro **cbKeyMost** su uno dei valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="30247-124">To enable a custom maximum key size, specify the Jet_bitIndexKeyMost option in the grbits member of [JET_INDEXCREATE](./jet-indexcreate-structure.md), and set the **cbKeyMost** member to one of the following values:</span></span>

  - <span data-ttu-id="30247-125">JET_cbKeyMost2KBytePage: se le dimensioni della pagina del database sono pari a 2048 byte, le dimensioni massime della chiave di indice possono essere comprese tra 255 byte e il valore massimo 500 byte.</span><span class="sxs-lookup"><span data-stu-id="30247-125">JET_cbKeyMost2KBytePage: When the database page size is 2048 bytes, the maximum index key size can be between 255 bytes minimum, and 500 bytes maximum.</span></span>

  - <span data-ttu-id="30247-126">JET_cbKeyMost4KBytePage: se le dimensioni della pagina del database sono pari a 4096 byte, le dimensioni massime della chiave di indice possono essere comprese tra 255 byte e il valore massimo 1000 byte.</span><span class="sxs-lookup"><span data-stu-id="30247-126">JET_cbKeyMost4KBytePage: When the database page size is 4096 bytes, the maximum index key size can be between 255 bytes minimum, and 1000 bytes maximum.</span></span>

  - <span data-ttu-id="30247-127">JET_cbKeyMost8KBytePage: se le dimensioni della pagina del database sono pari a 8196 byte, le dimensioni massime della chiave di indice possono essere comprese tra 255 byte e il valore massimo 2000 byte.</span><span class="sxs-lookup"><span data-stu-id="30247-127">JET_cbKeyMost8KBytePage: When the database page size is 8196 bytes, the maximum index key size can be between 255 bytes minimum, and 2000 bytes maximum.</span></span>

<span data-ttu-id="30247-128">Nell'esempio riportato di seguito viene illustrata una tabella contenente informazioni sui dipendenti.</span><span class="sxs-lookup"><span data-stu-id="30247-128">The example in the diagram below shows a table containing employee information.</span></span> <span data-ttu-id="30247-129">La tabella contiene 6 colonne, ognuna delle quali definisce un attributo dipendente specifico.</span><span class="sxs-lookup"><span data-stu-id="30247-129">The table has 6 columns, each defining a specific employee attribute.</span></span> <span data-ttu-id="30247-130">Un record della tabella contiene valori per un dipendente, ad esempio il nome del dipendente nella colonna 1 e l'ID dipendente nella colonna 2.</span><span class="sxs-lookup"><span data-stu-id="30247-130">A record in the table contains values for an employee, such as the employee name in column 1 and employee ID in column 2.</span></span> <span data-ttu-id="30247-131">Un indice primario creato per questa tabella consente di organizzare i dati in base al nome del dipendente per primo e all'ID dipendente.</span><span class="sxs-lookup"><span data-stu-id="30247-131">A primary index created for this table organizes the data according to the employee name first, and the employee ID second.</span></span> <span data-ttu-id="30247-132">Il nome e l'ID sono indicizzati in ordine crescente.</span><span class="sxs-lookup"><span data-stu-id="30247-132">Both name and ID are indexed in ascending order.</span></span> <span data-ttu-id="30247-133">Ad esempio, un record contenente il nome Johnson e il dipendente ID 12345 verrà elencato prima di un record con il nome di un dipendente Jones e l'ID 10000.</span><span class="sxs-lookup"><span data-stu-id="30247-133">For example, a record containing the name Johnson and employee ID 12345 will be listed before of a record with an employee name Jones and an ID of 10000.</span></span> <span data-ttu-id="30247-134">Tutti i record per Jones vengono archiviati insieme nella tabella, con gli ID dei dipendenti in ordine crescente, come illustrato nella tabella.</span><span class="sxs-lookup"><span data-stu-id="30247-134">All the records for Jones are stored together in the table, with their employee IDs in ascending order as shown in the table.</span></span>

<span data-ttu-id="30247-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span><span class="sxs-lookup"><span data-stu-id="30247-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span></span>

<span data-ttu-id="30247-136">La chiave nell'indice primario deve essere univoca, ma le chiavi nell'indice secondario possono essere duplicate.</span><span class="sxs-lookup"><span data-stu-id="30247-136">The key in the primary index must be unique, but the keys in the secondary index can be duplicates.</span></span> <span data-ttu-id="30247-137">Se, ad esempio, viene creato un indice in base al cognome e sono presenti due persone con Stevens nel database, ESE restituisce un errore di Jet_errKeyDuplicate da [JetUpdate](./jetupdate-function.md) o [JetUpdate2](./jetupdate2-function.md), quando l'applicazione tenta di inserire il secondo "Stevens".</span><span class="sxs-lookup"><span data-stu-id="30247-137">For example, if an index is created over last name, and there are two people with Stevens in the database, ESE returns a Jet_errKeyDuplicate error from [JetUpdate](./jetupdate-function.md) or [JetUpdate2](./jetupdate2-function.md), when the application attempts to insert the second "Stevens".</span></span> <span data-ttu-id="30247-138">Quando la chiave effettiva è maggiore della dimensione massima della chiave, la chiave viene troncata.</span><span class="sxs-lookup"><span data-stu-id="30247-138">When the actual key is larger than the maximum key size, the key is truncated.</span></span> <span data-ttu-id="30247-139">La ricerca e l'univocità degli effetti di troncamento chiave e devono essere gestiti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="30247-139">Key truncation effects searching and uniqueness and should be managed by the application.</span></span> <span data-ttu-id="30247-140">Se, ad esempio, "Stevens" e "Stevenson" sono stati archiviati in un indice in base al cognome e le dimensioni massime della chiave erano troppo piccole per archiviare la parte "on" di "Stevenson", il troncamento della chiave provocherebbe il fatto che il motore di database dichiara che "Stevens" e "Stevenson" sono duplicati anche se non lo sono.</span><span class="sxs-lookup"><span data-stu-id="30247-140">For example, if "Stevens" and "Stevenson" were stored in an index over last name and the max key size were too small to store the "on" portion of "Stevenson" then key truncation would result in the database engine declaring that "Stevens" and "Stevenson" are duplicates even though they are not.</span></span> <span data-ttu-id="30247-141">L'applicazione deve essere preparata a gestire i casi di questo tipo durante la ricerca e l'aggiornamento se la definizione dell'indice e i valori di colonna indicizzati sono tali che il troncamento delle chiavi è una possibilità.</span><span class="sxs-lookup"><span data-stu-id="30247-141">The application must be prepared to handle cases like this during search and update if the index definition and the column values it indexes are such that key truncation is a possibility.</span></span> <span data-ttu-id="30247-142">A partire da Windows Vista, le applicazioni possono specificare l'opzione Jet_bitIndexDisallowTruncation in [JET_INDEXCREATE](./jet-indexcreate-structure.md) o [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="30247-142">Starting in Windows Vista, applications can specify the Jet_bitIndexDisallowTruncation option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) or [JetMakeKey](./jetmakekey-function.md).</span></span> <span data-ttu-id="30247-143">Se si specifica questo flag, eventuali aggiornamenti all'indice che comporteranno la mancata riuscita di una chiave troncata con JET_errKeyTruncated.</span><span class="sxs-lookup"><span data-stu-id="30247-143">Specifying this flag will cause any update to the index that would result in a truncated key to fail with JET_errKeyTruncated.</span></span> <span data-ttu-id="30247-144">In caso contrario, le chiavi verranno troncate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="30247-144">Otherwise, keys will be silently truncated.</span></span> <span data-ttu-id="30247-145">Ciò consentirà all'applicazione di funzionare senza problemi per gli artefatti causati da un troncamento della chiave descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="30247-145">This will allow the application to function without concern for the artifacts caused by key truncation that were previously described.</span></span>
