---
description: 'Altre informazioni su: colonne con valore Long'
title: Colonne con valore Long
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "104049392"
---
# <a name="long-value-columns"></a><span data-ttu-id="b71b1-103">Colonne con valore Long</span><span class="sxs-lookup"><span data-stu-id="b71b1-103">Long Value Columns</span></span>


<span data-ttu-id="b71b1-104">_**Si applica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="b71b1-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="b71b1-105">Colonne con valore Long</span><span class="sxs-lookup"><span data-stu-id="b71b1-105">Long Value Columns</span></span>

<span data-ttu-id="b71b1-106">I tipi di colonna ESE JET_coltypLongText e JET_coltypLongBinary sono denominati tipi di colonna con valore Long.</span><span class="sxs-lookup"><span data-stu-id="b71b1-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="b71b1-107">Queste colonne sono stringhe di grandi dimensioni e oggetti binari di grandi dimensioni che possono essere archiviati in strutture B + separate dall'indice primario.</span><span class="sxs-lookup"><span data-stu-id="b71b1-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="b71b1-108">Quando i valori Long vengono archiviati separatamente dal record primario, vengono codificati internamente su un ID di valore Long (LID) e un offset di byte e sono accessibili come flusso.</span><span class="sxs-lookup"><span data-stu-id="b71b1-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="b71b1-109">Le colonne con valori di tipo Long vengono aggiunte alla tabella nella chiamata a [JetAddColumn](./jetaddcolumn-function.md) con il membro **coltyp** della struttura [JET_COLUMNDEF](./jet-columndef-structure.md) impostata su JET_coltypLongText o JET_coltypLongBinary.</span><span class="sxs-lookup"><span data-stu-id="b71b1-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="b71b1-110">La dimensione massima di un testo lungo o di un valore di colonna binario lungo è 2 GB-1.</span><span class="sxs-lookup"><span data-stu-id="b71b1-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="b71b1-111">ESE supporta le operazioni di Accodamento, sovrascrittura intervallo byte e dimensioni set per le colonne con valori di tipo Long per supportare implementazioni di flusso efficienti su questi tipi di colonne.</span><span class="sxs-lookup"><span data-stu-id="b71b1-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="b71b1-112">Per impostazione predefinita, i dati di valore Long vengono archiviati in un albero B + separato se è più grande di 1024 byte o se il record non rientra in una singola pagina di database quando i dati di valore lungo vengono archiviati nel record.</span><span class="sxs-lookup"><span data-stu-id="b71b1-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="b71b1-113">L'applicazione ha la possibilità di eseguire l'override del comportamento predefinito impostando le opzioni per archiviare i dati di valore lungo nel record (JET_bitSetIntrinsicLV) o per forzarne l'archiviazione nell'albero B + separato (JET_bitSetIntrinsicLV).</span><span class="sxs-lookup"><span data-stu-id="b71b1-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="b71b1-114">Questi valori vengono impostati nel parametro *grbit* in [JetSetColumn](./jetsetcolumn-function.md)oppure il membro **grbit** [JET_SETCOLUMN](./jet-setcolumn-structure.md) usato nella chiamata a [JetSetColumns](./jetsetcolumns-function.md) come segue:</span><span class="sxs-lookup"><span data-stu-id="b71b1-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="b71b1-115">Accodamento: (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="b71b1-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="b71b1-116">Sovrascrittura intervallo byte: (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="b71b1-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="b71b1-117">Dimensioni set: (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="b71b1-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="b71b1-118">Forza separato: (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="b71b1-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="b71b1-119">Archivia nel record: (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="b71b1-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="b71b1-120">I dati di valore Long vengono impostati indicando l'offset nel BLOB del valore Long e la lunghezza dei dati del valore Long nel BLOB.</span><span class="sxs-lookup"><span data-stu-id="b71b1-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="b71b1-121">L'offset al BLOB del valore Long viene impostato nel membro **ibLongValue** della struttura [JET_SETINFO](./jet-setinfo-structure.md) (per [JetSetColumn](./jetsetcolumn-function.md)) o del membro **ibLongValue** della struttura [JET_SETCOLUMN](./jet-setcolumn-structure.md) (per [JetSetColumns](./jetsetcolumns-function.md)).</span><span class="sxs-lookup"><span data-stu-id="b71b1-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="b71b1-122">Il membro **pvData** di [JET_SETCOLUMN](./jet-setcolumn-structure.md)e il parametro *pvData* nella chiamata a [JetSetColumn](./jetsetcolumn-function.md) contiene i dati del valore Long.</span><span class="sxs-lookup"><span data-stu-id="b71b1-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="b71b1-123">Gli aggiornamenti per le colonne con valori Long devono essere eseguiti all'interno di una transazione.</span><span class="sxs-lookup"><span data-stu-id="b71b1-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="b71b1-124">I dati con valori di tipo Long vengono sempre archiviati in una tabella separata quando l'applicazione imposta il JET_bitSetSeparateLV o JET_bitSetIntrinsicLV, in caso contrario viene decisa in modo euristico.</span><span class="sxs-lookup"><span data-stu-id="b71b1-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="b71b1-125">ESE archivia il valore Long separato se è più grande di 1024 byte o se il record non è adatto a una singola pagina di database se archiviato nel record.</span><span class="sxs-lookup"><span data-stu-id="b71b1-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="b71b1-126">Il diagramma seguente mostra i dati del valore Long archiviati in una tabella separata.</span><span class="sxs-lookup"><span data-stu-id="b71b1-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="b71b1-127">Quando un valore Long viene archiviato all'esterno del record, viene creato un nuovo ID con valore Long per fare riferimento al relativo valore.</span><span class="sxs-lookup"><span data-stu-id="b71b1-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="b71b1-128">Ciò consente a più record di fare riferimento allo stesso valore di colonna.</span><span class="sxs-lookup"><span data-stu-id="b71b1-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="b71b1-129">I conteggi dei riferimenti ai dati vengono aumentati se più di un record nei dati punta agli stessi dati di valore lungo.</span><span class="sxs-lookup"><span data-stu-id="b71b1-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="b71b1-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="b71b1-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="b71b1-131">ESE supporta inoltre una singola funzionalità dell'archivio di istanze che consente a più record di fare riferimento allo stesso oggetto binario di grandi dimensioni come se ogni record avesse una propria copia delle informazioni; evitando così copie duplicate dei dati del valore della colonna.</span><span class="sxs-lookup"><span data-stu-id="b71b1-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="b71b1-132">Questa funzionalità è abilitata nella chiamata a [JetPrepareUpdate](./jetprepareupdate-function.md) con l'opzione JET_prepInsertCopy impostata nel parametro *Prep* .</span><span class="sxs-lookup"><span data-stu-id="b71b1-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
