---
description: "Altre informazioni su: ricerca di record nell'indice"
title: Ricerca di record nell'indice
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106313075"
---
# <a name="searching-records-in-the-index"></a><span data-ttu-id="a39ea-103">Ricerca di record nell'indice</span><span class="sxs-lookup"><span data-stu-id="a39ea-103">Searching Records in the Index</span></span>


<span data-ttu-id="a39ea-104">_**Si applica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="a39ea-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="searching-records-in-the-index"></a><span data-ttu-id="a39ea-105">Ricerca di record nell'indice</span><span class="sxs-lookup"><span data-stu-id="a39ea-105">Searching Records in the Index</span></span>

<span data-ttu-id="a39ea-106">Vengono create chiavi di ricerca per cercare una singola voce o un set di voci in un indice.</span><span class="sxs-lookup"><span data-stu-id="a39ea-106">Search keys are created to search for a single entry or a set of entries in an index.</span></span> <span data-ttu-id="a39ea-107">I tasti di ricerca possono essere costruiti solo per le colonne chiave dell'indice e possono contenere uno o più valori di colonna.</span><span class="sxs-lookup"><span data-stu-id="a39ea-107">Search keys may only be constructed for the key columns in the index, and may contain one or more column values.</span></span> <span data-ttu-id="a39ea-108">La chiave di ricerca viene costruita con una singola chiamata o una serie di chiamate a [JetMakeKey](./jetmakekey-function.md)e può essere recuperata con [JetRetrieveKey](./jetretrievekey-function.md) usando JET_bitRetrieveCopy.</span><span class="sxs-lookup"><span data-stu-id="a39ea-108">The search key is constructed with a single call or a series of calls to [JetMakeKey](./jetmakekey-function.md), and may be retrieved with [JetRetrieveKey](./jetretrievekey-function.md) using JET_bitRetrieveCopy.</span></span> <span data-ttu-id="a39ea-109">Una volta creato, il tasto di ricerca può essere utilizzato per spostare il cursore sul record nell'indice.</span><span class="sxs-lookup"><span data-stu-id="a39ea-109">After the search key is constructed it can be used to move the cursor to the record in the index.</span></span>

<span data-ttu-id="a39ea-110">Sono disponibili tre metodi per trovare i record in una tabella:</span><span class="sxs-lookup"><span data-stu-id="a39ea-110">There are three methods of finding records in a table:</span></span>

1.  <span data-ttu-id="a39ea-111">Cercare una singola voce di indice.</span><span class="sxs-lookup"><span data-stu-id="a39ea-111">Search for a single index entry.</span></span> <span data-ttu-id="a39ea-112">A tale scopo, creare la chiave di ricerca con [JetMakeKey](./jetmakekey-function.md)e quindi passare a tale record con [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-112">To do this, create the search key with [JetMakeKey](./jetmakekey-function.md), and then move to that record with [JetSeek](./jetseek-function.md).</span></span>

2.  <span data-ttu-id="a39ea-113">Eseguire una ricerca nell'indice record per record.</span><span class="sxs-lookup"><span data-stu-id="a39ea-113">Search the index record-by-record.</span></span> <span data-ttu-id="a39ea-114">I record possono essere attraversati un record alla volta chiamando [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-114">Records can be traversed one record at a time by calling [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a39ea-115">È possibile spostare il cursore sul primo record nell'indice specificando JET_MoveFirst nel parametro *Crow* di [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-115">The cursor can be moved to the first record in the index by specifying JET_MoveFirst in the *cRow* parameter of [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a39ea-116">Allo stesso modo, è possibile spostare il cursore avanti, indietro o fino all'ultima voce dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a39ea-116">In the same way, the cursor can be moved forward, backward, or to the last entry in the index.</span></span>

3.  <span data-ttu-id="a39ea-117">Eseguire una ricerca in un set di record.</span><span class="sxs-lookup"><span data-stu-id="a39ea-117">Search through a set of records.</span></span> <span data-ttu-id="a39ea-118">A tale scopo, impostare un intervallo di voci di indice in cui eseguire la ricerca, quindi spostarsi tra i record in modo sequenziale.</span><span class="sxs-lookup"><span data-stu-id="a39ea-118">To do this, set a range of index entries to search, then move through the records sequentially.</span></span> <span data-ttu-id="a39ea-119">Per ulteriori informazioni, vedere [la sezione ricerca di un set di record]() di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="a39ea-119">For more information, see [Searching Through a Set of Records]() section of this topic.</span></span>

### <a name="searching-through-a-set-of-records"></a><span data-ttu-id="a39ea-120">Ricerca in un set di record</span><span class="sxs-lookup"><span data-stu-id="a39ea-120">Searching Through a Set of Records</span></span>

<span data-ttu-id="a39ea-121">Il diagramma mostra il cursore che scorre un intervallo di voci di indice definito dalle chiamate a [JetSeek](./jetseek-function.md) e [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-121">The diagram here shows the cursor moving through a range of index entries defined by calls to [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>

<span data-ttu-id="a39ea-122">Utilizzare la procedura seguente per eseguire la ricerca in un set di record in un indice.</span><span class="sxs-lookup"><span data-stu-id="a39ea-122">Use the following procedure to search through a set of records in an index.</span></span>

### <a name="to-search-a-set-of-records-in-an-index"></a><span data-ttu-id="a39ea-123">Per eseguire la ricerca in un set di record in un indice</span><span class="sxs-lookup"><span data-stu-id="a39ea-123">To search a set of records in an index</span></span>

1.  <span data-ttu-id="a39ea-124">Creare la chiave di ricerca per il primo record nel set di record in cui eseguire la ricerca con [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-124">Create the search key for the first record in the set of records to be searched with [JetMakeKey](./jetmakekey-function.md).</span></span>

2.  <span data-ttu-id="a39ea-125">Spostare il cursore sul record indicato nella chiave di ricerca con [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-125">Move the cursor to the record indicated in the search key with [JetSeek](./jetseek-function.md).</span></span>

3.  <span data-ttu-id="a39ea-126">Creare un'altra chiave di ricerca per l'ultima voce di indice nell'intervallo con [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-126">Create another search key for the last index entry in the range with [JetMakeKey](./jetmakekey-function.md).</span></span>

4.  <span data-ttu-id="a39ea-127">Impostare l'intervallo di indici con [JetSetIndexRange](./jetsetindexrange-function.md) usando la chiave creata nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="a39ea-127">Set the index range with [JetSetIndexRange](./jetsetindexrange-function.md) using the key created in step 3.</span></span>

5.  <span data-ttu-id="a39ea-128">Chiamare [JetMove](./jetmove-function.md) per spostarsi in sequenza attraverso ogni record nell'intervallo di indici, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="a39ea-128">Call [JetMove](./jetmove-function.md) to move sequentially through each record in the index range as shown in the following diagram.</span></span>

<span data-ttu-id="a39ea-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span><span class="sxs-lookup"><span data-stu-id="a39ea-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span></span>

<span data-ttu-id="a39ea-130">Il cursore del diagramma può spostarsi solo nell'intervallo di indici impostati nella chiamata a [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-130">The cursor in the diagram here may only move through the range of indices set in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span> <span data-ttu-id="a39ea-131">Se l'applicazione tenta di spostare il cursore oltre l'intervallo di indici, ESE restituisce un errore Jet_errNoCurrentRecord dalla chiamata a [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-131">If the application attempts to move the cursor beyond the index range, ESE returns a Jet_errNoCurrentRecord error from the call to [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="a39ea-132">Si noti che qualsiasi tipo di navigazione con il cursore diverso dal passaggio al record successivo o precedente annullerà l'intervallo di indici.</span><span class="sxs-lookup"><span data-stu-id="a39ea-132">Note that any type of navigation with this cursor other than moving to the next or previous record will cancel the index range.</span></span> <span data-ttu-id="a39ea-133">Per ulteriori informazioni, vedere [JetSetIndexRange](./jetsetindexrange-function.md) .</span><span class="sxs-lookup"><span data-stu-id="a39ea-133">See [JetSetIndexRange](./jetsetindexrange-function.md) for more information.</span></span>

<span data-ttu-id="a39ea-134">Il tipo di dati immessi nel parametro *pvData* per [JetMakeKey](./jetmakekey-function.md) deve corrispondere al tipo di dati e alle proprietà specificate per la colonna.</span><span class="sxs-lookup"><span data-stu-id="a39ea-134">The type of data entered in the *pvData* parameter for [JetMakeKey](./jetmakekey-function.md) must match the type of data and properties specified for the column.</span></span> <span data-ttu-id="a39ea-135">Ad esempio, la chiamata di [JetMakeKey](./jetmakekey-function.md) con "Ben Miller" specificata nel parametro *pvData* per un tipo di colonna JET_coltypText è un tipo di dati valido corrispondente.</span><span class="sxs-lookup"><span data-stu-id="a39ea-135">For example, calling [JetMakeKey](./jetmakekey-function.md) with "Ben Miller" specified in the *pvData* parameter for a column type JET_coltypText is a valid data type match.</span></span> <span data-ttu-id="a39ea-136">Se si vuole creare una chiave di ricerca per eseguire la ricerca tra i nomi "Ben Miller" e "Max Stevens" in un indice, spostare il cursore sul record con il nome "Ben Miller" chiamando [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-136">If you want to create a search key to search between the names "Ben Miller" and "Max Stevens" in an index, move the cursor to the record with the name "Ben Miller" by calling [JetSeek](./jetseek-function.md).</span></span> <span data-ttu-id="a39ea-137">Chiamare [JetMakeKey](./jetmakekey-function.md) una seconda volta e specificare un puntatore a una stringa contenente il nome "Max Stevens".</span><span class="sxs-lookup"><span data-stu-id="a39ea-137">Call [JetMakeKey](./jetmakekey-function.md) a second time and specify a pointer to a string containing the name "Max Stevens".</span></span> <span data-ttu-id="a39ea-138">L'intervallo di indicizzazione è impostato in modo da limitare il passaggio del cursore tra i nomi "Ben Miller" e "Max Stevens" nella chiamata a [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="a39ea-138">The index range is set to limit the cursor to move between the names "Ben Miller" and "Max Stevens" in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>
