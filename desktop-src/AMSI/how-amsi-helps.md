---
title: Come AMSI consente di difendersi dal malware
description: Gli sviluppatori di applicazioni possono partecipare attivamente a malware Defense. In particolare, è possibile proteggere i clienti da malware basati su script dinamici e da viali non tradizionali di cyberattack.
ms.topic: article
ms.date: 02/27/2019
ms.openlocfilehash: 0d6aee30034312073123f5ab14b1924fd01e6eac
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103708149"
---
# <a name="how-the-antimalware-scan-interface-amsi-helps-you-defend-against-malware"></a><span data-ttu-id="b3540-104">Come l'interfaccia di analisi antimalware (AMSI) consente di difendersi dal malware</span><span class="sxs-lookup"><span data-stu-id="b3540-104">How the Antimalware Scan Interface (AMSI) helps you defend against malware</span></span>

<span data-ttu-id="b3540-105">Per un'introduzione all'interfaccia di analisi antimalware di Windows (AMSI), vedere [interfaccia di analisi antimalware (AMSI)](antimalware-scan-interface-portal.md).</span><span class="sxs-lookup"><span data-stu-id="b3540-105">For an introduction to the Windows Antimalware Scan Interface (AMSI), see [Antimalware Scan Interface (AMSI)](antimalware-scan-interface-portal.md).</span></span>

<span data-ttu-id="b3540-106">Gli sviluppatori di applicazioni possono partecipare attivamente a malware Defense.</span><span class="sxs-lookup"><span data-stu-id="b3540-106">As an application developer, you can actively participate in malware defense.</span></span> <span data-ttu-id="b3540-107">In particolare, è possibile proteggere i clienti da malware basati su script dinamici e da viali non tradizionali di cyberattack.</span><span class="sxs-lookup"><span data-stu-id="b3540-107">Specifically, you can help protect your customers from dynamic script-based malware, and from non-traditional avenues of cyberattack.</span></span>

<span data-ttu-id="b3540-108">Per esempio, supponiamo che l'applicazione sia configurabile tramite script: accetta script arbitrari e lo esegue tramite un motore di script.</span><span class="sxs-lookup"><span data-stu-id="b3540-108">By way of an example, let's say that your application is scriptable: it accepts arbitrary script, and executes it via a scripting engine.</span></span> <span data-ttu-id="b3540-109">Nel momento in cui uno script è pronto per essere fornito al motore di script, l'applicazione può chiamare le API di Windows AMSI per richiedere un'analisi del contenuto.</span><span class="sxs-lookup"><span data-stu-id="b3540-109">At the point when a script is ready to be supplied to the scripting engine, your application can call the Windows AMSI APIs to request a scan of the content.</span></span> <span data-ttu-id="b3540-110">In questo modo, è possibile determinare in modo sicuro se lo script è dannoso prima di decidere di procedere ed eseguirlo.</span><span class="sxs-lookup"><span data-stu-id="b3540-110">That way, you can safely determine whether or not the script is malicious before you decide to go ahead and execute it.</span></span>

<span data-ttu-id="b3540-111">Questo vale anche se lo script è stato generato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="b3540-111">This is true even if the script was generated at runtime.</span></span> <span data-ttu-id="b3540-112">Lo script (dannoso o altro) può superare diversi passaggi di deoffuscamento.</span><span class="sxs-lookup"><span data-stu-id="b3540-112">Script (malicious or otherwise), might go through several passes of de-obfuscation.</span></span> <span data-ttu-id="b3540-113">Tuttavia, è necessario fornire il motore di scripting con codice normale e non offuscato.</span><span class="sxs-lookup"><span data-stu-id="b3540-113">But you ultimately need to supply the scripting engine with plain, un-obfuscated code.</span></span> <span data-ttu-id="b3540-114">Questo è il punto in cui vengono richiamate le API AMSI.</span><span class="sxs-lookup"><span data-stu-id="b3540-114">And that's the point at which you invoke the AMSI APIs.</span></span>

<span data-ttu-id="b3540-115">Di seguito è illustrata l'architettura AMSI, in cui l'applicazione è rappresentata da una delle caselle "altre applicazioni".</span><span class="sxs-lookup"><span data-stu-id="b3540-115">Here's an illustration of the AMSI architecture, where your own application is represented by one of the "Other Application" boxes.</span></span>

![architettura AMSI](images/AMSI7Archi.jpg)

<span data-ttu-id="b3540-117">L'interfaccia AMSI di Windows è aperta.</span><span class="sxs-lookup"><span data-stu-id="b3540-117">The Windows AMSI interface is open.</span></span> <span data-ttu-id="b3540-118">Il che significa che qualsiasi applicazione può chiamarla; qualsiasi motore antimalware registrato può elaborare il contenuto inviato.</span><span class="sxs-lookup"><span data-stu-id="b3540-118">Which means that any application can call it; and any registered Antimalware engine can process the content submitted to it.</span></span>

<span data-ttu-id="b3540-119">Non è necessario limitare la discussione ai motori di script.</span><span class="sxs-lookup"><span data-stu-id="b3540-119">We needn't limit the discussion to scripting engines, either.</span></span> <span data-ttu-id="b3540-120">Probabilmente l'applicazione è un'app di comunicazione e analizza i messaggi istantanei per i virus prima che vengano visualizzati ai clienti.</span><span class="sxs-lookup"><span data-stu-id="b3540-120">Perhaps your application is a communication app, and it scans instant messages for viruses before it shows them to your customers.</span></span> <span data-ttu-id="b3540-121">O forse il software è un gioco che convalida i plug-in prima di installarli.</span><span class="sxs-lookup"><span data-stu-id="b3540-121">Or maybe your software is a game that validates plugins before installing them.</span></span> <span data-ttu-id="b3540-122">Sono disponibili numerose opportunità e scenari per l'uso di AMSI.</span><span class="sxs-lookup"><span data-stu-id="b3540-122">There are plenty of opportunities and scenarios for using AMSI.</span></span>

## <a name="amsi-in-action"></a><span data-ttu-id="b3540-123">AMSI in azione</span><span class="sxs-lookup"><span data-stu-id="b3540-123">AMSI in action</span></span>

<span data-ttu-id="b3540-124">Diamo un'occhiata a AMSI in Action.</span><span class="sxs-lookup"><span data-stu-id="b3540-124">Let's take a look at AMSI in action.</span></span> <span data-ttu-id="b3540-125">In questo esempio, Windows Defender è l'applicazione che chiama le API AMSI.</span><span class="sxs-lookup"><span data-stu-id="b3540-125">In this example, Windows Defender is the application that's calling AMSI APIs.</span></span> <span data-ttu-id="b3540-126">È tuttavia possibile chiamare le stesse API dall'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b3540-126">But you can call the same APIs from within your own application.</span></span>

<span data-ttu-id="b3540-127">Di seguito è riportato un esempio di uno script che usa la tecnica di codifica XOR per nasconderne lo scopo, indipendentemente dal fatto che tale finalità sia benigna o meno.</span><span class="sxs-lookup"><span data-stu-id="b3540-127">Here's a sample of a script that uses the XOR-encoding technique to hide its intent (whether that intent is benign or not).</span></span> <span data-ttu-id="b3540-128">Per questa illustrazione, è possibile immaginare che lo script è stato scaricato da Internet.</span><span class="sxs-lookup"><span data-stu-id="b3540-128">For this illustration, we can imagine that this script was downloaded from the Internet.</span></span>

![script di esempio codificato in base 64](images/AMSI8.png)

<span data-ttu-id="b3540-130">Per rendere le cose più interessanti, è possibile immettere questo script manualmente dalla riga di comando, in modo che non esista un file effettivo da monitorare.</span><span class="sxs-lookup"><span data-stu-id="b3540-130">To make things more interesting, we can enter this script manually at the command line so that there is no actual file to monitor.</span></span> <span data-ttu-id="b3540-131">Questo mirroring è noto come "minaccia priva di file".</span><span class="sxs-lookup"><span data-stu-id="b3540-131">This mirrors what's known as a "fileless threat".</span></span> <span data-ttu-id="b3540-132">Non è semplice come analizzare i file su disco.</span><span class="sxs-lookup"><span data-stu-id="b3540-132">It's not as simple as scanning files on disk.</span></span> <span data-ttu-id="b3540-133">La minaccia potrebbe essere una backdoor che risiede solo nella memoria di un computer.</span><span class="sxs-lookup"><span data-stu-id="b3540-133">The threat might be a backdoor that lives only in the memory of a machine.</span></span>

<span data-ttu-id="b3540-134">Di seguito viene visualizzato il risultato dell'esecuzione dello script in Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b3540-134">Below, we see the result of running the script in Windows PowerShell.</span></span> <span data-ttu-id="b3540-135">Si noterà che Windows Defender è in grado di rilevare l'esempio di test AMSI in questo scenario complesso, usando semplicemente la firma di esempio di AMSI test standard.</span><span class="sxs-lookup"><span data-stu-id="b3540-135">You'll see that Windows Defender is able to detect the AMSI test sample in this complicated scenario, merely by using the standard AMSI test sample signature.</span></span>

![Windows Defender che rileva l'esempio di test di AMSI](images/AMSI9proper.png)

## <a name="amsi-integration-with-javascriptvba"></a><span data-ttu-id="b3540-137">Integrazione di AMSI con JavaScript/VBA</span><span class="sxs-lookup"><span data-stu-id="b3540-137">AMSI integration with JavaScript/VBA</span></span>

<span data-ttu-id="b3540-138">Il flusso di lavoro illustrato di seguito descrive il flusso end-to-end di un altro esempio, in cui viene illustrata l'integrazione di AMSI con l'esecuzione della macro all'interno Microsoft Office.</span><span class="sxs-lookup"><span data-stu-id="b3540-138">The illustrated workflow below describes the end-to-end flow of another example, in which we demonstrate AMSI's integration with macro execution within Microsoft Office.</span></span>

![Integrazione di AMSI con JavaScript/VBA](images/integ-js-vba.png)

- <span data-ttu-id="b3540-140">L'utente riceve un documento contenente una macro (dannosa), che elude le analisi statiche del software antivirus mediante tecniche quali l'offuscamento, i file protetti da password o altro.</span><span class="sxs-lookup"><span data-stu-id="b3540-140">The user receives a document containing a (malicious) macro, which evades static antivirus software scans by employing techniques such as obfuscation, password-protected files, or other.</span></span>
- <span data-ttu-id="b3540-141">L'utente apre quindi il documento che contiene la macro (dannosa).</span><span class="sxs-lookup"><span data-stu-id="b3540-141">The user then opens the document containing the (malicious) macro.</span></span> <span data-ttu-id="b3540-142">Se il documento viene aperto in visualizzazione protetta, l'utente fa clic su **Abilita modifica** per uscire dalla visualizzazione protetta.</span><span class="sxs-lookup"><span data-stu-id="b3540-142">If the document opens in Protected View, then the user clicks **Enable Editing** to exit Protected View.</span></span>
- <span data-ttu-id="b3540-143">L'utente fa clic su **Abilita macro** per consentire l'esecuzione delle macro.</span><span class="sxs-lookup"><span data-stu-id="b3540-143">The user clicks **Enable Macros** to allow macros to run.</span></span>
- <span data-ttu-id="b3540-144">Quando viene eseguita la macro, il runtime VBA usa un buffer circolare per registrare \[ 1 \] dato e i parametri correlati alle chiamate alle API Win32, com e VBA.</span><span class="sxs-lookup"><span data-stu-id="b3540-144">As the macro runs, the VBA runtime uses a circular buffer to log \[1\] data and parameters related to calls to Win32, COM, and VBA APIs.</span></span>
- <span data-ttu-id="b3540-145">Quando si osservano specifiche API Win32 o COM considerate a rischio elevato (noti anche come *trigger*) \[ 2 \] , l'esecuzione della macro viene interrotta e il contenuto del buffer circolare viene passato a AMSI.</span><span class="sxs-lookup"><span data-stu-id="b3540-145">When specific Win32 or COM APIs that are considered high risk (also known as *triggers*) \[2\] are observed, macro execution is halted, and the contents of the circular buffer are passed to AMSI.</span></span>
- <span data-ttu-id="b3540-146">Il provider di servizi anti-malware AMSI registrato risponde con un verdetto per indicare se il comportamento della macro è dannoso o meno.</span><span class="sxs-lookup"><span data-stu-id="b3540-146">The registered AMSI anti-malware service provider responds with a verdict to indicate whether or not the macro behavior is malicious.</span></span>
- <span data-ttu-id="b3540-147">Se il comportamento è non dannoso, l'esecuzione della macro continua.</span><span class="sxs-lookup"><span data-stu-id="b3540-147">If the behavior is non-malicious, then macro execution proceeds.</span></span>
- <span data-ttu-id="b3540-148">In caso contrario, se il comportamento è dannoso, Microsoft Office chiude la sessione in risposta all'avviso \[ 3 \] e l'AV può mettere in quarantena il file.</span><span class="sxs-lookup"><span data-stu-id="b3540-148">Otherwise, if the behavior is malicious, then Microsoft Office closes the session in response to the alert \[3\], and the AV can quarantine the file.</span></span>

## <a name="what-does-this-mean-for-you"></a><span data-ttu-id="b3540-149">Che cosa significa?</span><span class="sxs-lookup"><span data-stu-id="b3540-149">What does this mean for you?</span></span>

<span data-ttu-id="b3540-150">Per gli utenti di Windows, tutti i software dannosi che usano tecniche di offuscamento e evasione sugli host di scripting predefiniti di Windows 10 vengono controllati automaticamente a un livello più profondo che mai, garantendo livelli aggiuntivi di protezione.</span><span class="sxs-lookup"><span data-stu-id="b3540-150">For Windows users, any malicious software that uses obfuscation and evasion techniques on Windows 10's built-in scripting hosts is automatically inspected at a much deeper level than ever before, providing additional levels of protection.</span></span>

<span data-ttu-id="b3540-151">Per gli sviluppatori di applicazioni, provare a fare in modo che l'applicazione chiami l'interfaccia AMSI di Windows se si vuole trarre vantaggio da (e proteggere i clienti con) analisi e analisi aggiuntive di contenuto potenzialmente dannoso.</span><span class="sxs-lookup"><span data-stu-id="b3540-151">For you as an application developer, consider having your application call the Windows AMSI interface if you want to benefit from (and protect your customers with) extra scanning and analysis of potentially malicious content.</span></span>

<span data-ttu-id="b3540-152">Un fornitore di software antivirus può prendere in considerazione l'implementazione del supporto per l'interfaccia AMSI.</span><span class="sxs-lookup"><span data-stu-id="b3540-152">As an antivirus software vendor, you can consider implementing support for the AMSI interface.</span></span> <span data-ttu-id="b3540-153">Quando si esegue questa operazione, il motore avrà una visione più approfondita dei dati che le applicazioni (inclusi gli host di scripting predefiniti di Windows 10) considerano potenzialmente dannosi.</span><span class="sxs-lookup"><span data-stu-id="b3540-153">When you do, your engine will have much deeper insight into the data that applications (including Windows 10's built-in scripting hosts) consider to be potentially malicious.</span></span>

## <a name="more-background-info-about-fileless-threats"></a><span data-ttu-id="b3540-154">Altre informazioni di base sulle minacce per i file</span><span class="sxs-lookup"><span data-stu-id="b3540-154">More background info about fileless threats</span></span>

<span data-ttu-id="b3540-155">Per informazioni più dettagliate sui tipi di minacce informatiche che Windows AMSI è progettato per la difesa, potrebbe essere utile.</span><span class="sxs-lookup"><span data-stu-id="b3540-155">You may be curious for more background info about the kinds of fileless threats that Windows AMSI is designed to help you defend against.</span></span> <span data-ttu-id="b3540-156">In questa sezione si esaminerà il tradizionale gioco Cat-and-mouse che si svolge nell'ecosistema di malware.</span><span class="sxs-lookup"><span data-stu-id="b3540-156">In this section, we'll take a look at the traditional cat-and-mouse game that plays out in the malware ecosystem.</span></span>

<span data-ttu-id="b3540-157">Si userà PowerShell come esempio.</span><span class="sxs-lookup"><span data-stu-id="b3540-157">We'll use PowerShell as an example.</span></span> <span data-ttu-id="b3540-158">Tuttavia, è possibile sfruttare le stesse tecniche e processi che verranno illustrati con qualsiasi linguaggio dinamico &mdash; VBScript, Perl, Python, Ruby e altro ancora.</span><span class="sxs-lookup"><span data-stu-id="b3540-158">But you can leverage the same techniques and processes we'll demonstrate with any dynamic language&mdash;VBScript, Perl, Python, Ruby, and more.</span></span>

<span data-ttu-id="b3540-159">Ecco un esempio di script di PowerShell dannoso.</span><span class="sxs-lookup"><span data-stu-id="b3540-159">Here's an example of a malicious PowerShell script.</span></span>

![esempio di script di PowerShell dannoso](images/AMSI1.png)

<span data-ttu-id="b3540-161">Sebbene questo script scriva semplicemente un messaggio sullo schermo, malware è in genere più nefasto.</span><span class="sxs-lookup"><span data-stu-id="b3540-161">While this script simply writes a message to the screen, malware is typically more nefarious.</span></span> <span data-ttu-id="b3540-162">Tuttavia, è possibile scrivere facilmente una firma per individuarla.</span><span class="sxs-lookup"><span data-stu-id="b3540-162">But you could easily write a signature to detect this one.</span></span> <span data-ttu-id="b3540-163">Ad esempio, la firma potrebbe cercare la stringa "write-host ' pWnd!'"</span><span class="sxs-lookup"><span data-stu-id="b3540-163">For example, the signature could search for the string "Write-Host 'pwnd!'"</span></span> <span data-ttu-id="b3540-164">in qualsiasi file aperto dall'utente.</span><span class="sxs-lookup"><span data-stu-id="b3540-164">in any file that the user opens.</span></span> <span data-ttu-id="b3540-165">Ottimo: il primo malware è stato rilevato.</span><span class="sxs-lookup"><span data-stu-id="b3540-165">Great: we've detected our first malware!</span></span>

<span data-ttu-id="b3540-166">Dopo essere stato rilevato dalla prima firma, tuttavia, gli autori di malware rispondono.</span><span class="sxs-lookup"><span data-stu-id="b3540-166">After being detected by our first signature, though, malware authors will respond.</span></span> <span data-ttu-id="b3540-167">Rispondono creando script dinamici come questo esempio.</span><span class="sxs-lookup"><span data-stu-id="b3540-167">They respond by creating dynamic scripts such as this example.</span></span>

![esempio di script dinamico](images/AMSI2.png)

<span data-ttu-id="b3540-169">In questo scenario, gli autori di malware creano una stringa che rappresenta lo script di PowerShell da eseguire.</span><span class="sxs-lookup"><span data-stu-id="b3540-169">In that scenario, malware authors create a string representing the PowerShell script to run.</span></span> <span data-ttu-id="b3540-170">Ma usano una semplice tecnica di concatenazione di stringhe per suddividere la firma precedente.</span><span class="sxs-lookup"><span data-stu-id="b3540-170">But they use a simple string concatenation technique to break our earlier signature.</span></span> <span data-ttu-id="b3540-171">Se si visualizza l'origine di una pagina Web con carico elevato, si noterà che molte istanze di questa tecnica vengono usate per evitare il software di blocco ad.</span><span class="sxs-lookup"><span data-stu-id="b3540-171">If you ever view the source of an ad-laden web page, you'll see many instances of this technique being used to avoid ad-blocking software.</span></span>

<span data-ttu-id="b3540-172">Infine, l'autore del malware passa questa stringa concatenata `Invoke-Expression` al &mdash; meccanismo di PowerShell per il cmdlet per valutare gli script composti o creati in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="b3540-172">Finally, the malware author passes this concatenated string to the `Invoke-Expression` cmdlet&mdash;PowerShell's mechanism to evaluate scripts that are composed or created at runtime.</span></span>

<span data-ttu-id="b3540-173">In risposta, il software antimalware inizia a eseguire l'emulazione del linguaggio di base.</span><span class="sxs-lookup"><span data-stu-id="b3540-173">In response, antimalware software starts to do basic language emulation.</span></span> <span data-ttu-id="b3540-174">Se, ad esempio, sono presenti due stringhe concatenate, la concatenazione delle due stringhe viene emulata, quindi le firme vengono eseguite sul risultato.</span><span class="sxs-lookup"><span data-stu-id="b3540-174">For example, if we see two strings being concatenated, then we emulate the concatenation of those two strings, and then run our signatures on the result.</span></span> <span data-ttu-id="b3540-175">Sfortunatamente, si tratta di un approccio piuttosto fragile, perché i linguaggi tendono a offrire molti modi per rappresentare e concatenare le stringhe.</span><span class="sxs-lookup"><span data-stu-id="b3540-175">Unfortunately, this is a fairly fragile approach, because languages tend to have a lot of ways to represent and concatenate strings.</span></span>

<span data-ttu-id="b3540-176">Quindi, dopo essere stata rilevata da questa firma, gli autori di malware passano a qualcosa di più complesso, &mdash; ad esempio, codificando il contenuto dello script in Base64, come nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="b3540-176">So, after being caught by this signature, malware authors will move to something more complicated&mdash;for example, encoding script content in Base64, as in this next example.</span></span>

![esempio di contenuto di script in Base64](images/AMSI3.png)

<span data-ttu-id="b3540-178">In questo modo, la maggior parte dei motori antimalware implementano anche l'emulazione della decodifica Base64.</span><span class="sxs-lookup"><span data-stu-id="b3540-178">Being resourceful, most antimalware engines implement Base64 decoding emulation, as well.</span></span> <span data-ttu-id="b3540-179">Quindi, poiché viene implementata anche l'emulazione della decodifica Base64, l'esecuzione è più avanti.</span><span class="sxs-lookup"><span data-stu-id="b3540-179">So, since we also implement Base64 decoding emulation, we're ahead for a time.</span></span>

<span data-ttu-id="b3540-180">In risposta, gli autori di malware passano all'offuscamento algoritmico, &mdash; ad esempio un semplice meccanismo di codifica XOR negli script che eseguono.</span><span class="sxs-lookup"><span data-stu-id="b3540-180">In response, malware authors move to algorithmic obfuscation&mdash;such as a simple XOR-encoding mechanism in the scripts they run.</span></span>

![esempio di script di offuscamento algoritmico](images/AMSI4.png)

<span data-ttu-id="b3540-182">A questo punto, in genere i motori antivirus verranno emulati o rilevati, pertanto non sarà necessario rilevare necessariamente le attività dello script.</span><span class="sxs-lookup"><span data-stu-id="b3540-182">At this point, we're generally past what antivirus engines will emulate or detect, so we won't necessarily detect what this script is doing.</span></span> <span data-ttu-id="b3540-183">Tuttavia, è possibile iniziare a scrivere firme per le tecniche di offuscamento e codifica.</span><span class="sxs-lookup"><span data-stu-id="b3540-183">However, we can start to write signatures against the obfuscation and encoding techniques.</span></span> <span data-ttu-id="b3540-184">In realtà, si tratta di un account che rappresenta la maggior parte delle firme per il malware basato su script.</span><span class="sxs-lookup"><span data-stu-id="b3540-184">In fact, that's what accounts for the vast majority of signatures for script-based malware.</span></span>

<span data-ttu-id="b3540-185">Ma cosa accade se l'offuscatore è talmente semplice da avere un aspetto simile a quello di molti script ben funzionanti?</span><span class="sxs-lookup"><span data-stu-id="b3540-185">But what if the obfuscator is so trivial that it looks like many well-behaved scripts?</span></span> <span data-ttu-id="b3540-186">Una firma per esso genera un numero inaccettabile di falsi positivi.</span><span class="sxs-lookup"><span data-stu-id="b3540-186">A signature for it would generate an unacceptable number of false positives.</span></span> <span data-ttu-id="b3540-187">Ecco uno script di *stage* di esempio troppo benigno per il rilevamento autonomo.</span><span class="sxs-lookup"><span data-stu-id="b3540-187">Here's a sample *stager* script that's too benign to detect on its own.</span></span>

![uno script di staging di esempio troppo benigno per il rilevamento autonomo](images/AMSI5.png)

<span data-ttu-id="b3540-189">In questo esempio viene scaricata una pagina Web e viene richiamata parte del contenuto.</span><span class="sxs-lookup"><span data-stu-id="b3540-189">In that example, we're downloading a web page, and invoking some content from it.</span></span> <span data-ttu-id="b3540-190">Di seguito è riportato l'equivalente nello script Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="b3540-190">Here's the equivalent in Visual Basic script.</span></span>

![equivalente nello script Visual Basic](images/AMSI6.png)

<span data-ttu-id="b3540-192">Ciò che peggiora in entrambi questi esempi è che il motore antivirus controlla i file aperti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="b3540-192">What makes things worse in both of these examples is that the antivirus engine inspects files being opened by the user.</span></span> <span data-ttu-id="b3540-193">Se il contenuto dannoso risiede solo in memoria, l'attacco potrebbe non essere rilevato.</span><span class="sxs-lookup"><span data-stu-id="b3540-193">If the malicious content lives only in memory, then the attack can potentially go undetected.</span></span>

<span data-ttu-id="b3540-194">In questa sezione sono state illustrate le limitazioni del rilevamento tramite firme tradizionali.</span><span class="sxs-lookup"><span data-stu-id="b3540-194">This section showed the limitations of detection using traditional signatures.</span></span> <span data-ttu-id="b3540-195">Tuttavia, anche se uno script dannoso può passare attraverso diversi passaggi di deoffuscamento, è necessario fornire al motore di script un codice semplice e non offuscato.</span><span class="sxs-lookup"><span data-stu-id="b3540-195">But, while a malicious script might go through several passes of de-obfuscation, it ultimately needs to supply the scripting engine with plain, unobfuscated code.</span></span> <span data-ttu-id="b3540-196">A questo punto &mdash; , come descritto nella prima sezione sopra &mdash; gli host di scripting predefiniti di Windows 10, chiamare le API AMSI per richiedere un'analisi di questo contenuto non protetto.</span><span class="sxs-lookup"><span data-stu-id="b3540-196">And at that point&mdash;as we described in the first section above&mdash;Windows 10's built-in scripting hosts call the AMSI APIs to request a scan of this unprotected content.</span></span> <span data-ttu-id="b3540-197">E l'applicazione può eseguire la stessa operazione.</span><span class="sxs-lookup"><span data-stu-id="b3540-197">And your application can do the same thing.</span></span>

## <a name="related-resources"></a><span data-ttu-id="b3540-198">Risorse correlate</span><span class="sxs-lookup"><span data-stu-id="b3540-198">Related resources</span></span>

* [<span data-ttu-id="b3540-199">Minacce per i file</span><span class="sxs-lookup"><span data-stu-id="b3540-199">Fileless threats</span></span>](/windows/security/threat-protection/intelligence/fileless-threats)
* [<span data-ttu-id="b3540-200">Office VBA + AMSI: parte del velo sulle macro dannose</span><span class="sxs-lookup"><span data-stu-id="b3540-200">Office VBA + AMSI: Parting the veil on malicious macros</span></span>](https://cloudblogs.microsoft.com/microsoftsecure/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/)
* [<span data-ttu-id="b3540-201">Non visibile, ma non invisibile: la sconfitta di malware senza file con monitoraggio del comportamento, AMSI e Next-gen AV</span><span class="sxs-lookup"><span data-stu-id="b3540-201">Out of sight but not invisible: Defeating fileless malware with behavior monitoring, AMSI, and next-gen AV</span></span>](https://cloudblogs.microsoft.com/microsoftsecure/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/)
