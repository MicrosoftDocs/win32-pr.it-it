---
description: L'interfaccia IXpsOMPackageWriter crea un file di documento XPS in cui le applicazioni possono scrivere il contenuto delle interfacce IXpsOMPage di un OM XPS.
ms.assetid: eff1ab1e-2205-4f5c-9e32-199e073f5dbf
title: Uso dell'interfaccia IXpsOMPackageWriter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1e8a34a0538ff09cc050ac287d5314be93f0da8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106317284"
---
# <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="83860-103">Uso dell'interfaccia IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="83860-103">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="83860-104">L'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crea un file di documento XPS in cui le applicazioni possono scrivere il contenuto delle interfacce [**IXPSOMPAGE**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) di un OM XPS.</span><span class="sxs-lookup"><span data-stu-id="83860-104">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an XPS document file into which applications can write the contents of the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interfaces of an XPS OM.</span></span> <span data-ttu-id="83860-105">L'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) è particolarmente utile quando il contenuto del documento viene elaborato o creato in modo sequenziale.</span><span class="sxs-lookup"><span data-stu-id="83860-105">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface is most useful when document contents are being processed or created sequentially.</span></span> <span data-ttu-id="83860-106">A differenza dei metodi [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) e [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) dell'interfaccia [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) , per l'uso dell'interfaccia **IXpsOMPackageWriter** non è necessario che l'intero FixedDocument né il FixedDocumentSequence debbano essere completati.</span><span class="sxs-lookup"><span data-stu-id="83860-106">Unlike the [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) and [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) methods of the [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) interface, for the **IXpsOMPackageWriter** interface to be used neither the entire FixedDocument nor the FixedDocumentSequence has to be finished.</span></span>

## <a name="overview"></a><span data-ttu-id="83860-107">Panoramica</span><span class="sxs-lookup"><span data-stu-id="83860-107">Overview</span></span>

<span data-ttu-id="83860-108">L'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) scrive una pagina alla volta, dalla prima pagina di un documento XPS fino all'ultima.</span><span class="sxs-lookup"><span data-stu-id="83860-108">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface writes one page at a time, from the first page of an XPS document to the last.</span></span> <span data-ttu-id="83860-109">L'interfaccia può essere utilizzata per creare semplici file di documento XPS e anche file di documenti XPS complessi che contengono più di un FixedDocument in FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="83860-109">The interface can be used to create simple XPS document files and also complex XPS document files that contain more than one FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="83860-110">Nei file di documento XPS complessi, i FixedDocument vengono creati anche in sequenza, a partire dal primo FixedDocument in FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="83860-110">In complex XPS document files, the FixedDocuments are also created in sequence, starting with the first FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="83860-111">L'interfaccia **IXpsOMPackageWriter** non supporta la creazione di contenuto del documento in ordine casuale.</span><span class="sxs-lookup"><span data-stu-id="83860-111">The **IXpsOMPackageWriter** interface does not support the creation of document contents in random order.</span></span> <span data-ttu-id="83860-112">Usare, ad esempio, per creare un report sequenziale o per eseguire l'elaborazione in un filtro di driver di dispositivo in cui il contenuto del documento viene alimentato al driver in sequenza.</span><span class="sxs-lookup"><span data-stu-id="83860-112">Use it, for example, to create a sequential report or to perform processing in a device driver filter where the document contents are fed to the driver in sequence.</span></span>

## <a name="terminology-review"></a><span data-ttu-id="83860-113">Revisione della terminologia</span><span class="sxs-lookup"><span data-stu-id="83860-113">Terminology Review</span></span>

<span data-ttu-id="83860-114">Un *file di documento XPS* è un pacchetto Open Packaging Conventions (OPC) che è conforme alla specifica del documento XML.</span><span class="sxs-lookup"><span data-stu-id="83860-114">An *XPS document file* is an Open Packaging Conventions (OPC) package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="83860-115">Quindi, tecnicamente, l'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crea un *pacchetto OPC*, ma è un pacchetto OPC che è conforme alla specifica del documento XML.</span><span class="sxs-lookup"><span data-stu-id="83860-115">So, technically, the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an *OPC package*, but it is an OPC package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="83860-116">Per questo motivo, nelle discussioni sui documenti XPS, i termini *documento* e *pacchetto* XPS vengono spesso usati in modo interscambiabile.</span><span class="sxs-lookup"><span data-stu-id="83860-116">For this reason, in discussions about XPS documents, the terms *XPS document* and *package* are often used interchangeably.</span></span>

<span data-ttu-id="83860-117">Il *pacchetto* creato dall'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) conterrà i componenti del documento XPS necessari, ovvero un elemento FixedDocumentSequence, almeno un FixedDocument e almeno un FixedPage.</span><span class="sxs-lookup"><span data-stu-id="83860-117">The *package* created by the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface will contain the required XPS document components: a FixedDocumentSequence, at least one FixedDocument, and at least one FixedPage.</span></span> <span data-ttu-id="83860-118">FixedDocumentSequence viene creato quando viene creata un'istanza dell'interfaccia **IXpsOMPackageWriter** .</span><span class="sxs-lookup"><span data-stu-id="83860-118">The FixedDocumentSequence is created when the **IXpsOMPackageWriter** interface is instantiated.</span></span> <span data-ttu-id="83860-119">Un elemento FixedDocument viene creato ogni volta che viene chiamato [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) e viene creato un FixedPage ogni volta che viene chiamato [**IXpsOMPackageWriter:: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) .</span><span class="sxs-lookup"><span data-stu-id="83860-119">A FixedDocument is created every time [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) is called, and a FixedPage is created every time [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) is called.</span></span> <span data-ttu-id="83860-120">Poiché l'interfaccia scrive il contenuto del documento in modo sequenziale, il metodo **AddPage** aggiunge la pagina all'oggetto FixedDocument creato più di recente.</span><span class="sxs-lookup"><span data-stu-id="83860-120">Because the interface writes the document contents sequentially, the **AddPage** method adds the page to the most recently created FixedDocument.</span></span>

## <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="83860-121">Uso dell'interfaccia IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="83860-121">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="83860-122">Nella procedura riportata di seguito viene descritto come creare un file di documento XPS utilizzando l'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="83860-122">The following procedure describes how to create an XPS document file by using the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span> <span data-ttu-id="83860-123">La procedura non descrive come creare un'istanza di un'interfaccia [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) e il relativo contenuto.</span><span class="sxs-lookup"><span data-stu-id="83860-123">The procedure does not describe how to instantiate an [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface and its contents.</span></span> <span data-ttu-id="83860-124">Per ulteriori informazioni su **IXpsOMPage** e sull'aggiunta di contenuto a una pagina, vedere l'argomento relativo alle [interfacce di pagine XPS om](xps-object-model-page-interfaces.md) e gli argomenti elencati nella sezione vedere anche.</span><span class="sxs-lookup"><span data-stu-id="83860-124">For more information about **IXpsOMPage** and adding content to a page, see [XPS OM Page Interfaces](xps-object-model-page-interfaces.md) and the topics listed in the See Also section.</span></span>

 <span data-ttu-id="83860-125">**Creazione di un documento**</span><span class="sxs-lookup"><span data-stu-id="83860-125">**Creating a document**</span></span>

1.  <span data-ttu-id="83860-126">Creare un'istanza di un'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="83860-126">Instantiate an [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span>

    <span data-ttu-id="83860-127">Viene creato un FixedDocumentSequence vuoto nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="83860-127">This creates an empty FixedDocumentSequence in the package.</span></span>

    -   <span data-ttu-id="83860-128">Per creare un documento XPS in un file, chiamare [**IXpsOMObjectFactory:: CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span><span class="sxs-lookup"><span data-stu-id="83860-128">To create an XPS document in a file, call [**IXpsOMObjectFactory::CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span></span>
    -   <span data-ttu-id="83860-129">Per creare un documento XPS in un flusso, chiamare [**IXpsOMObjectFactory:: CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span><span class="sxs-lookup"><span data-stu-id="83860-129">To create an XPS document in a stream, call [**IXpsOMObjectFactory::CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span></span>

2.  <span data-ttu-id="83860-130">Avviare un nuovo documento nel pacchetto chiamando [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="83860-130">Start a new document in the package by calling [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>

    <span data-ttu-id="83860-131">Prima di aggiungere una pagina, chiamare [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) per aggiungere un FixedDocument al FixedDocumentSequence creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="83860-131">Before adding a page, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) to add a FixedDocument to the FixedDocumentSequence that was created in step 1.</span></span>

3.  <span data-ttu-id="83860-132">Aggiungere contenuto.</span><span class="sxs-lookup"><span data-stu-id="83860-132">Add content.</span></span>
    -   <span data-ttu-id="83860-133">Per aggiungere un nuovo elemento FixedPage al documento, chiamare [**IXpsOMPackageWriter:: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passandogli un puntatore all'interfaccia [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) che include il contenuto dell'elemento FixedPage che si desidera aggiungere.</span><span class="sxs-lookup"><span data-stu-id="83860-133">To add a new FixedPage to the document, call [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passing it a pointer to the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface that has the contents of the FixedPage that you want to add.</span></span>
    -   <span data-ttu-id="83860-134">Per creare un nuovo FixedDocument in FixedDocumentSequence, chiamare [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="83860-134">To create a new FixedDocument in the FixedDocumentSequence, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>
4.  <span data-ttu-id="83860-135">Chiudere il pacchetto e il relativo contenuto chiamando [**IXpsOMPackageWriter:: Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span><span class="sxs-lookup"><span data-stu-id="83860-135">Close the package and its contents by calling [**IXpsOMPackageWriter::Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span></span>

## <a name="advanced-features"></a><span data-ttu-id="83860-136">Funzionalità avanzate</span><span class="sxs-lookup"><span data-stu-id="83860-136">Advanced Features</span></span>

<span data-ttu-id="83860-137">I metodi dell'interfaccia [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) supportano anche l'aggiunta di risorse, anteprime e ticket di stampa.</span><span class="sxs-lookup"><span data-stu-id="83860-137">The methods of the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface also support the adding of resources, thumbnails, and print tickets.</span></span> <span data-ttu-id="83860-138">Questi componenti del documento possono essere aggiunti a livello di pacchetto, FixedDocumentSequence, FixedDocument e FixedPage.</span><span class="sxs-lookup"><span data-stu-id="83860-138">These document components can be added at the package, FixedDocumentSequence, FixedDocument, and FixedPage levels.</span></span> <span data-ttu-id="83860-139">Per ulteriori informazioni sull'utilizzo di questa interfaccia per la stampa, vedere [Print an XPS om](print-an-xps-om.md).</span><span class="sxs-lookup"><span data-stu-id="83860-139">For more information about using this interface for printing, see [Print an XPS OM](print-an-xps-om.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="83860-140">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="83860-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="83860-141">Uso dell'API di firma digitale XPS</span><span class="sxs-lookup"><span data-stu-id="83860-141">Using XPS Digital Signature API</span></span>](using-digital-signatures-in-xps-documents.md)
</dt> <dt>

[<span data-ttu-id="83860-142">Interfacce di pagine XPS OM</span><span class="sxs-lookup"><span data-stu-id="83860-142">XPS OM Page Interfaces</span></span>](xps-object-model-page-interfaces.md)
</dt> <dt>

[<span data-ttu-id="83860-143">Esplorare XPS OM</span><span class="sxs-lookup"><span data-stu-id="83860-143">Navigate the XPS OM</span></span>](navigate-the-xps-om.md)
</dt> <dt>

[<span data-ttu-id="83860-144">Uso di Canvas e interfacce visive di XPS OM</span><span class="sxs-lookup"><span data-stu-id="83860-144">Working with XPS OM Canvas and Visual Interfaces</span></span>](working-with-xpsomcanvas-interfaces.md)
</dt> <dt>

[<span data-ttu-id="83860-145">Utilizzo delle interfacce di percorso OM XPS</span><span class="sxs-lookup"><span data-stu-id="83860-145">Working with XPS OM Path Interfaces</span></span>](working-with-xps-object-model-path-interfaces.md)
</dt> <dt>

[<span data-ttu-id="83860-146">Utilizzo di interfacce di testo, grafica e immagini XPS OM</span><span class="sxs-lookup"><span data-stu-id="83860-146">Working with XPS OM Text, Graphics, and Image Interfaces</span></span>](working-with-xps-object-model-text-and-image-interfaces.md)
</dt> <dt>

[<span data-ttu-id="83860-147">Interfacce del ticket di stampa XPS OM</span><span class="sxs-lookup"><span data-stu-id="83860-147">XPS OM Print Ticket Interfaces</span></span>](xps-object-model-print-ticket-interfaces.md)
</dt> <dt>

[<span data-ttu-id="83860-148">**IXpsOMThumbnailGenerator**</span><span class="sxs-lookup"><span data-stu-id="83860-148">**IXpsOMThumbnailGenerator**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator)
</dt> <dt>

[<span data-ttu-id="83860-149">Informazioni di riferimento sulle API documento XPS</span><span class="sxs-lookup"><span data-stu-id="83860-149">XPS Document API Reference</span></span>](xps-programming-reference.md)
</dt> <dt>

[<span data-ttu-id="83860-150">XML Paper Specification</span><span class="sxs-lookup"><span data-stu-id="83860-150">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



