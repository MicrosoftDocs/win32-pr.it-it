---
description: Questo argomento non è aggiornato. Per informazioni aggiornate, vedere la specifica dello schema di stampa.
ms.assetid: 487f294f-dfe0-48f8-9077-06c55c3af8f1
title: Creazione di un Device-Specific PrintTicket
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d31644f25f231f7121e2e492bc3f41a81b82d0b4
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/05/2021
ms.locfileid: "106321057"
---
# <a name="creating-a-device-specific-printticket"></a><span data-ttu-id="c1ee5-104">Creazione di un Device-Specific PrintTicket</span><span class="sxs-lookup"><span data-stu-id="c1ee5-104">Creating a Device-Specific PrintTicket</span></span>

<span data-ttu-id="c1ee5-105">Questo argomento non è aggiornato.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-105">This topic is not current.</span></span> <span data-ttu-id="c1ee5-106">Per informazioni aggiornate, vedere la [specifica dello schema di stampa](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="c1ee5-106">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="c1ee5-107">Un oggetto PrintTicket specifico del dispositivo è destinato a un determinato dispositivo e pertanto non è generalmente portabile tra più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-107">A device-specific PrintTicket targets a particular device and is therefore not generally portable across multiple devices.</span></span>

<span data-ttu-id="c1ee5-108">I passaggi illustrati nell'elenco seguente devono essere usati quando si crea un oggetto PrintTicket specifico del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-108">The steps shown in the following list should be used when you create a device-specific PrintTicket.</span></span>

1.  <span data-ttu-id="c1ee5-109">Ottenere un documento PrintCapabilities contenente solo le istanze della funzionalità pertinenti per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-109">Obtain a PrintCapabilities document containing only the relevant Feature instances for the device.</span></span> <span data-ttu-id="c1ee5-110">Richiedere un documento PrintCapabilities predefinito.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-110">Request a default PrintCapabilities document.</span></span> <span data-ttu-id="c1ee5-111">Non è necessario specificare un oggetto PrintTicket di input perché gli attributi del dispositivo (istanze e parametri delle funzionalità e delle opzioni) usati per costruire l'oggetto PrintTicket sono indipendenti dalla configurazione.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-111">This does not require you to specify an input PrintTicket because the device attributes (Feature and Option instances and parameters) that are used to construct the PrintTicket are independent of the configuration.</span></span>

2.  <span data-ttu-id="c1ee5-112">Creare un documento XML vuoto contenente la radice PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-112">Create an empty XML document containing the PrintTicket root.</span></span> <span data-ttu-id="c1ee5-113">Assegnare un prefisso dello spazio dei nomi allo spazio dei nomi dello schema di stampa e assegnare i prefissi per tutti gli altri spazi dei nomi che verranno utilizzati dal PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-113">Assign a namespace prefix to the Print Schema namespace, and assign prefixes for all other namespaces that will be used by the PrintTicket.</span></span> <span data-ttu-id="c1ee5-114">Specificare la versione dello schema PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-114">Specify the PrintTicket Schema version.</span></span>

3.  <span data-ttu-id="c1ee5-115">È possibile definire le impostazioni nel PrintTicket per tutte le funzionalità e l'istanza di ParameterDef segnalate nel documento PrintCapabilities o solo quelle di interesse.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-115">You may define settings in the PrintTicket for every Feature and ParameterDef instance reported in the PrintCapabilities document, or only those of interest to you.</span></span> <span data-ttu-id="c1ee5-116">Se all'interfaccia PrintTicket viene presentato un oggetto PrintTicket parziale, vengono automaticamente fornite le impostazioni predefinite per le istanze ParameterDef e feature omesse durante la convalida PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-116">If a partial PrintTicket is presented to the PrintTicket interface, defaults are automatically provided for omitted Feature and ParameterDef instances during PrintTicket validation.</span></span>

4.  <span data-ttu-id="c1ee5-117">Esaminare il documento PrintCapabilities per le istanze di funzionalità e determinare quale di questi si desidera definire nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-117">Examine the PrintCapabilities document for Feature instances and determine which of these you want defined in your PrintTicket.</span></span> <span data-ttu-id="c1ee5-118">Aggiungere queste istanze della funzionalità al PrintTicket, ma non trasferire il contenuto delle istanze della funzionalità al PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-118">Add these Feature instances to the PrintTicket, but do not transfer the contents of the Feature instances to your PrintTicket.</span></span> <span data-ttu-id="c1ee5-119">Se si trasferisce una funzionalità secondaria, è necessario trasferire anche la funzionalità padre e la relazione padre-figlio deve essere mantenuta nell'oggetto PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-119">If you transfer a subfeature, the parent Feature must also be transferred, and the parent-child relationship must be preserved in the PrintTicket.</span></span>

    <span data-ttu-id="c1ee5-120">Per ogni funzionalità trasferita, determinare le istanze delle opzioni applicabili al PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-120">For each Feature that you transfer, determine which Option instances are applicable to your PrintTicket.</span></span> <span data-ttu-id="c1ee5-121">Trasferire l'intera opzione come definito nel documento PrintCapabilities, quindi rimuovere tutte le istanze di proprietà presenti.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-121">Transfer the entire Option as defined in the PrintCapabilities document, and then remove any Property instances that are present.</span></span> <span data-ttu-id="c1ee5-122">Le istanze di proprietà vengono utilizzate all'interno di documenti PrintCapabilities, ma non svolgono alcuna funzione nell'oggetto PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-122">The Property instances are used within PrintCapabilities documents, but serve no purpose in the PrintTicket.</span></span> <span data-ttu-id="c1ee5-123">Mantenere tutte le istanze di ScoredProperty, assicurandosi di conservarne la posizione; si tratta di una parte intrinseca della definizione dell'opzione.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-123">Keep all of the ScoredProperty instances, making sure that you preserve their location; they are an intrinsic part of the Option definition.</span></span>

5.  <span data-ttu-id="c1ee5-124">È anche possibile aggiungere istanze di proprietà a qualsiasi istanza di ScoredProperty.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-124">You may also add Property instances to any ScoredProperty instance.</span></span> <span data-ttu-id="c1ee5-125">Le istanze di proprietà vengono utilizzate solo se il provider PrintTicket ne supporta in modo esplicito l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-125">Property instances are used only if the PrintTicket provider explicitly supports their use.</span></span> <span data-ttu-id="c1ee5-126">Ogni provider deve documentare lo scopo e l'utilizzo di tutte le istanze di proprietà supportate.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-126">Each provider should document the purpose and use of all supported Property instances.</span></span> <span data-ttu-id="c1ee5-127">Si noti che durante la convalida tutte le istanze di proprietà contenute in un'istanza di opzione vengono rimosse, a meno che lo spazio dei nomi della proprietà non venga riconosciuto dal provider PrintCapabilities o PrintTicket di destinazione e un'opzione candidata venga trovata nel documento PrintCapabilities le cui istanze ScoredProperty corrispondono perfettamente a quelle definite nell'opzione di riferimento.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-127">Note that during validation, any Property instances contained within an Option instance are stripped off, unless the namespace of the Property is recognized by the target PrintCapabilities or PrintTicket provider, and a candidate Option is found in the PrintCapabilities document whose ScoredProperty instances perfectly match those defined in the reference Option.</span></span>

6.  <span data-ttu-id="c1ee5-128">Se le parole chiave dello schema di stampa impostano la proprietà SelectionType su PickMany per una particolare funzionalità, è possibile selezionare più di un'opzione per tale funzionalità, a condizione che l'opzione designata come IdentityOption non sia una di quelle selezionate.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-128">If the Print Schema Keywords set the SelectionType Property to PickMany for a particular Feature, you may select more than one Option for that Feature, provided that the Option designated as IdentityOption is not one of those selected.</span></span> <span data-ttu-id="c1ee5-129">IdentityOption nello schema di stampa ha lo stesso effetto dell'opzione None nei file PPD di PostScript e nei file Unidrv GPD; funge da no-op.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-129">IdentityOption in the Print Schema has the same effect as the None option in Postscript PPD files and Unidrv GPD files; it serves as a no-op.</span></span>

7.  <span data-ttu-id="c1ee5-130">Esaminare il documento PrintCapabilities per le istanze di ParameterDef da impostare nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-130">Examine the PrintCapabilities document for ParameterDef instances that should be set in your PrintTicket.</span></span> <span data-ttu-id="c1ee5-131">Per ogni istanza di ParameterDef di questo tipo, selezionare un valore da utilizzare nell'istanza di ParameterInit nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-131">For each such ParameterDef instance, select a Value to be used in the ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="c1ee5-132">Questo valore deve essere del tipo di dati corretto e deve rientrare nell'intervallo definito nell'istanza di ParameterDef e deve soddisfare tutti gli altri requisiti specificati nell'istanza di ParameterDef.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-132">This Value must be of the correct data type and must fall within the range defined in the ParameterDef instance, and must meet all of the other requirements specified in the ParameterDef instance.</span></span> <span data-ttu-id="c1ee5-133">Utilizzare un'istanza di ParameterInit per inizializzare il parametro sul valore selezionato.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-133">Use a ParameterInit instance to initialize the parameter to the Value you have selected.</span></span>

8.  <span data-ttu-id="c1ee5-134">Esaminare il contenuto di ogni istanza di opzione visualizzata nel PrintTicket per le occorrenze di istanze di ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-134">Examine the contents of each Option instance that appears in the PrintTicket for occurrences of ParameterRef instances.</span></span> <span data-ttu-id="c1ee5-135">Se un'istanza di ParameterInit corrispondente non è già presente nel PrintTicket, seguire il passaggio precedente per creare un'istanza di ParameterInit nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-135">If a corresponding ParameterInit instance does not already appear in the PrintTicket, follow the previous step to create a ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="c1ee5-136">Lo scopo di questa istanza di ParameterInit è inizializzare il parametro a cui fa riferimento l'istanza di ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-136">The purpose of this ParameterInit instance is to initialize the parameter referenced by the ParameterRef instance.</span></span>

9.  <span data-ttu-id="c1ee5-137">Tenere presente che i conflitti di vincolo possono impedire al dispositivo di applicare la configurazione specificata nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-137">Keep in mind that constraint conflicts might prevent the device from applying the configuration you have specified in the PrintTicket.</span></span> <span data-ttu-id="c1ee5-138">Se necessario, il processo di convalida modifica la configurazione definita nel PrintTicket a una che è priva di conflitti.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-138">If necessary, the validation process modifies the configuration defined in the PrintTicket to one that is free of conflicts.</span></span>

10. <span data-ttu-id="c1ee5-139">Esaminare le parole chiave dello schema di stampa per le istanze di proprietà che devono essere presenti nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-139">Examine the Print Schema Keywords for Property instances that must be present in your PrintTicket.</span></span> <span data-ttu-id="c1ee5-140">Aggiungere un'istanza di proprietà al PrintTicket per ogni richiesta e fornire un valore appropriato per tale istanza usando il tipo di elemento value.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-140">Add a Property instance to your PrintTicket for each that is required, and provide a suitable value for it using the Value element type.</span></span> <span data-ttu-id="c1ee5-141">Verificare che le istanze delle proprietà si trovino correttamente all'interno dell'oggetto PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-141">Make sure that Property instances are located properly within the PrintTicket.</span></span>

11. <span data-ttu-id="c1ee5-142">Esaminare le istanze di proprietà facoltative nello schema PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-142">Examine the optional Property instances in the PrintTicket Schema.</span></span> <span data-ttu-id="c1ee5-143">Se sono presenti istanze di queste proprietà che devono essere presenti nel PrintTicket, crearle nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-143">If there are any such Property instances that should be in your PrintTicket, create them in your PrintTicket.</span></span>

12. <span data-ttu-id="c1ee5-144">È anche possibile aggiungere istanze di proprietà definite privatamente a livello di radice o a qualsiasi funzionalità, opzione o istanza di proprietà.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-144">You may also add privately-defined Property instances at the root level, or to any Feature, Option, or Property instance.</span></span> <span data-ttu-id="c1ee5-145">Si noti tuttavia che queste istanze di proprietà definite privatamente vengono rimosse durante la convalida, a meno che lo spazio dei nomi a cui appartengono non sia riconosciuto dal provider PrintCapabilities o PrintTicket di destinazione.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-145">Note however, that these privately-defined Property instances are stripped off during validation, unless the namespace they belong to is recognized by the target PrintCapabilities or PrintTicket provider.</span></span> <span data-ttu-id="c1ee5-146">Inoltre, le istanze di proprietà visualizzate in un punto qualsiasi all'interno di un'istanza di opzione vengono rimosse durante la convalida, a meno che il documento PrintCapabilities non contenga un'opzione che rappresenta una corrispondenza perfetta.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-146">In addition, Property instances that appear anywhere within an Option instance are stripped off during validation, unless the PrintCapabilities document contains an Option that is a perfect match.</span></span> <span data-ttu-id="c1ee5-147">Due istanze delle opzioni rappresentano una corrispondenza perfetta se ogni ScoredProperty in un'istanza di opzione ha un ScoredProperty corrispondente nell'altro e i valori delle istanze ScoredProperty sono gli stessi.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-147">Two Option instances are a perfect match if every ScoredProperty in one Option instance has a corresponding ScoredProperty in the other, and the Values of the ScoredProperty instances are the same.</span></span> <span data-ttu-id="c1ee5-148">Consultare lo schema privato del provider PrintTicket per un elenco di istanze di proprietà private riconosciute e dei relativi utilizzi.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-148">Consult the PrintTicket provider's Private Schema for a list of recognized private Property instances and their uses.</span></span>

13. <span data-ttu-id="c1ee5-149">Gli elementi figlio dello stesso tipo di elemento potrebbero non annidarsi a una profondità superiore a 10 elementi.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-149">Children of the same element type may not nest to a depth of more than 10 elements.</span></span> <span data-ttu-id="c1ee5-150">Questa regola si applica in modo indipendente a ogni tipo di elemento che è possibile definire.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-150">This rule applies independently to each type of element that can be defined.</span></span>

> [!Note]  
> <span data-ttu-id="c1ee5-151">Il contenuto XML di PrintTicket deve essere codificato con UTF-8 o UTF-16.</span><span class="sxs-lookup"><span data-stu-id="c1ee5-151">PrintTicket XML content MUST be encoded using either UTF-8 or UTF-16.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="c1ee5-152">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c1ee5-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c1ee5-153">Specifica dello schema di stampa</span><span class="sxs-lookup"><span data-stu-id="c1ee5-153">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 



