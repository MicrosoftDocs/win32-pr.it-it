---
description: Questo argomento non è aggiornato. Per informazioni aggiornate, vedere la specifica dello schema di stampa.
ms.assetid: 1f991b6b-8443-4234-ad46-dc4220e34c5c
title: Creazione di un oggetto PrintTicket generico
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c34281eda82a48ea0ac4077248547522ddc305ea
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/05/2021
ms.locfileid: "106320872"
---
# <a name="creating-a-generic-printticket"></a><span data-ttu-id="68ca2-104">Creazione di un oggetto PrintTicket generico</span><span class="sxs-lookup"><span data-stu-id="68ca2-104">Creating a Generic PrintTicket</span></span>

<span data-ttu-id="68ca2-105">Questo argomento non è aggiornato.</span><span class="sxs-lookup"><span data-stu-id="68ca2-105">This topic is not current.</span></span> <span data-ttu-id="68ca2-106">Per informazioni aggiornate, vedere la [specifica dello schema di stampa](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="68ca2-106">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="68ca2-107">Se il documento PrintCapabilities per il dispositivo non è disponibile o se il dispositivo di destinazione è sconosciuto, è necessario creare un oggetto PrintTicket generico.</span><span class="sxs-lookup"><span data-stu-id="68ca2-107">If the PrintCapabilities document for the device is unavailable, or if the target device is unknown, you should construct a generic PrintTicket.</span></span> <span data-ttu-id="68ca2-108">Poiché non esiste un documento PrintCapabilities che fornisce un set di elementi Feature e Option, o parametri, le istanze supportate di questi tipi di elemento devono essere ottenute direttamente dalle parole chiave Print Schema.</span><span class="sxs-lookup"><span data-stu-id="68ca2-108">Because there is no PrintCapabilities document that provides a set of Feature and Option elements, or parameters, the supported instances of these element types must be obtained directly from the Print Schema Keywords.</span></span>

<span data-ttu-id="68ca2-109">Quando si crea un oggetto PrintTicket generico, è necessario usare i passaggi illustrati nell'elenco seguente.</span><span class="sxs-lookup"><span data-stu-id="68ca2-109">The steps shown in the following list should be used when you create a generic PrintTicket.</span></span>

1.  <span data-ttu-id="68ca2-110">Creare un documento XML vuoto contenente la radice PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-110">Create an empty XML document that contains the PrintTicket root.</span></span> <span data-ttu-id="68ca2-111">Assegnare un prefisso dello spazio dei nomi allo spazio dei nomi dello schema di stampa.</span><span class="sxs-lookup"><span data-stu-id="68ca2-111">Assign a namespace prefix to the Print Schema namespace.</span></span> <span data-ttu-id="68ca2-112">Specificare la versione dello schema.</span><span class="sxs-lookup"><span data-stu-id="68ca2-112">Specify the Schema version.</span></span>

2.  <span data-ttu-id="68ca2-113">Esaminare le istanze della funzionalità nelle parole chiave dello schema di stampa e determinare quale di questi si desidera definire nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-113">Examine the Feature instances in the Print Schema Keywords and determine which of these you want defined in your PrintTicket.</span></span> <span data-ttu-id="68ca2-114">Aggiungere queste istanze della funzionalità al PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-114">Add these Feature instances to your PrintTicket.</span></span> <span data-ttu-id="68ca2-115">Quando si trasferisce una funzionalità secondaria, è necessario trasferire la funzionalità padre e mantenere la relazione padre-figlio tra la funzionalità e la sottofunzionalità del PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-115">When you transfer a subfeature, you must transfer the parent Feature, and preserve the parent-child relationship between the Feature and subfeature in the PrintTicket.</span></span>

    <span data-ttu-id="68ca2-116">Per ogni istanza di funzionalità trasferita, determinare le istanze delle opzioni applicabili al PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-116">For each Feature instance that you transfer, determine which Option instances are applicable to your PrintTicket.</span></span> <span data-ttu-id="68ca2-117">Da questo set di istanze di opzioni, trasferire ogni intera istanza di opzione come appare nello schema di stampa, quindi rimuovere tutte le istanze di proprietà presenti, con la possibile eccezione di quelle che hanno significato per l'oggetto PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-117">From this set of Option instances, transfer each entire Option instance as it appears in the Print Schema, and then remove any Property instances that are present, with the possible exception of those that have significance to your PrintTicket.</span></span> <span data-ttu-id="68ca2-118">Mantenere tutte le istanze di ScoredProperty, assicurandosi di conservarne la posizione; si tratta di una parte intrinseca della definizione dell'opzione.</span><span class="sxs-lookup"><span data-stu-id="68ca2-118">Keep all of the ScoredProperty instances, making sure that you preserve their location; they are an intrinsic part of the Option definition.</span></span>

3.  <span data-ttu-id="68ca2-119">È anche possibile aggiungere istanze di proprietà a qualsiasi ScoredProperty.</span><span class="sxs-lookup"><span data-stu-id="68ca2-119">You may also add Property instances to any ScoredProperty.</span></span> <span data-ttu-id="68ca2-120">Gli elementi Property sono applicabili solo se il provider PrintTicket ne supporta in modo esplicito l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="68ca2-120">Property elements are applicable only if the PrintTicket provider explicitly supports their use.</span></span> <span data-ttu-id="68ca2-121">Ogni provider deve documentare lo scopo e l'utilizzo di tutte le istanze di proprietà supportate.</span><span class="sxs-lookup"><span data-stu-id="68ca2-121">Each provider should document the purpose and use of all supported Property instances.</span></span> <span data-ttu-id="68ca2-122">Poiché non si ha idea del provider che elaborerà l'oggetto PrintTicket, potrebbe essere necessario accodare solo le istanze di proprietà supportate in modo esplicito dal provider PrintTicket del sistema.</span><span class="sxs-lookup"><span data-stu-id="68ca2-122">Because you have no idea which provider will process the PrintTicket, you might wish to append only the Property instances that are explicitly supported by the system PrintTicket provider.</span></span>

4.  <span data-ttu-id="68ca2-123">Se le parole chiave dello schema di stampa impostano la proprietà SelectionType su PickMany per una particolare funzionalità, è possibile selezionare più di un'opzione per tale funzionalità, a condizione che l'opzione designata come IdentityOption non sia una di quelle selezionate.</span><span class="sxs-lookup"><span data-stu-id="68ca2-123">If the Print Schema Keywords set the SelectionType Property to PickMany for a particular Feature, you may select more than one Option for that Feature, provided that the Option designated as IdentityOption is not one of those selected.</span></span> <span data-ttu-id="68ca2-124">IdentityOption nello schema di stampa ha lo stesso effetto dell'opzione None nei file PPD di PostScript e nei file Unidrv GPD; funge da no-op.</span><span class="sxs-lookup"><span data-stu-id="68ca2-124">IdentityOption in the Print Schema has the same effect as the None option in Postscript PPD files and Unidrv GPD files; it serves as a no-op.</span></span>

5.  <span data-ttu-id="68ca2-125">Esaminare le parole chiave dello schema di stampa per le istanze di ParameterDef che devono essere inizializzate nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-125">Examine the Print Schema Keywords for ParameterDef instances that should be initialized in your PrintTicket.</span></span> <span data-ttu-id="68ca2-126">Per ogni istanza di ParameterDef di questo tipo, selezionare il valore da utilizzare nell'istanza di ParameterInit nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-126">For each such ParameterDef instance, select the Value to be used in the ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="68ca2-127">Questo valore deve essere del tipo di dati corretto, deve rientrare nell'intervallo definito nell'istanza di ParameterDef e deve soddisfare tutti gli altri requisiti specificati nell'istanza di ParameterDef.</span><span class="sxs-lookup"><span data-stu-id="68ca2-127">This Value must be of the correct data type, must fall within the range defined in the ParameterDef instance, and must meet all of the other requirements specified in the ParameterDef instance.</span></span> <span data-ttu-id="68ca2-128">Utilizzare un'istanza di ParameterInit per inizializzare il parametro sul valore selezionato.</span><span class="sxs-lookup"><span data-stu-id="68ca2-128">Use a ParameterInit instance to initialize the parameter to the Value you have selected.</span></span>

    <span data-ttu-id="68ca2-129">Se si sviluppa un componente dell'interfaccia utente, progettare i metodi di generazione PrintTicket in modo che gli utenti possano immettere il valore per l'elemento ParameterInit.</span><span class="sxs-lookup"><span data-stu-id="68ca2-129">If you are developing a user interface (UI) component, design your PrintTicket generation methods so that users can enter the Value for the ParameterInit element.</span></span> <span data-ttu-id="68ca2-130">Inoltre, il metodo di immissione dell'interfaccia utente deve osservare e rispettare le restrizioni di input specificate dall'elemento ParameterDef associato.</span><span class="sxs-lookup"><span data-stu-id="68ca2-130">In addition, the UI entry method should observe and comply with any input restrictions specified by the associated ParameterDef element.</span></span>

6.  <span data-ttu-id="68ca2-131">Esaminare il contenuto di ogni istanza di opzione visualizzata nel PrintTicket per le occorrenze di ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="68ca2-131">Examine the contents of each Option instance that appears in the PrintTicket for occurrences of ParameterRef.</span></span> <span data-ttu-id="68ca2-132">Se un'istanza di ParameterInit corrispondente non è già presente nel PrintTicket, seguire il passaggio precedente per creare un'istanza di ParameterInit nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-132">If a corresponding ParameterInit instance does not already appear in the PrintTicket, follow the previous step to create a ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="68ca2-133">Lo scopo di questa istanza di ParameterInit è inizializzare il parametro a cui fa riferimento l'istanza di ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="68ca2-133">The purpose of this ParameterInit instance is to initialize the parameter referenced by the ParameterRef instance.</span></span>

7.  <span data-ttu-id="68ca2-134">Tenere presente che il dispositivo che elabora il processo potrebbe non supportare tutte le funzionalità specificate in PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-134">Keep in mind that the device that processes the job might not support every Feature specified in the PrintTicket.</span></span> <span data-ttu-id="68ca2-135">Tenere presente inoltre che una funzionalità denominata potrebbe essere supportata, ma è possibile che un'opzione specificata della funzionalità non sia.</span><span class="sxs-lookup"><span data-stu-id="68ca2-135">Keep in mind also, that a named Feature might be supported, but a specified Option of that Feature might not be.</span></span> <span data-ttu-id="68ca2-136">Le stesse avvertenze si applicano ai parametri.</span><span class="sxs-lookup"><span data-stu-id="68ca2-136">The same caveats apply to parameters.</span></span> <span data-ttu-id="68ca2-137">Anche se un dispositivo supporta un parametro denominato, il valore specificato nell'istanza di ParameterInit potrebbe non essere compreso nell'intervallo valido per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="68ca2-137">Even if a device supports a named parameter, the Value specified in the ParameterInit instance might not be within the valid range for the device.</span></span>

8.  <span data-ttu-id="68ca2-138">Esaminare le parole chiave dello schema di stampa per le istanze di proprietà che devono essere presenti nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-138">Examine the Print Schema Keywords for Property instances that must be present in your PrintTicket.</span></span> <span data-ttu-id="68ca2-139">Aggiungere un'istanza di proprietà per ognuno di essi all'oggetto PrintTicket e fornire un valore appropriato per tale istanza usando il tipo di elemento value.</span><span class="sxs-lookup"><span data-stu-id="68ca2-139">Add a Property instance for each of these to your PrintTicket, and provide a suitable value for it using the Value element type.</span></span> <span data-ttu-id="68ca2-140">Verificare che le istanze delle proprietà si trovino correttamente all'interno dell'oggetto PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-140">Make sure that Property instances are located properly within the PrintTicket.</span></span> <span data-ttu-id="68ca2-141">Assicurarsi di consultare lo schema PrintTicket invece dello schema PrintCapabilities.</span><span class="sxs-lookup"><span data-stu-id="68ca2-141">Make sure that you consult the PrintTicket Schema rather than the PrintCapabilities Schema.</span></span>

9.  <span data-ttu-id="68ca2-142">Esaminare le istanze di proprietà facoltative definite nello schema PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-142">Examine the optional Property instances defined in the PrintTicket Schema.</span></span> <span data-ttu-id="68ca2-143">Se sono presenti istanze di queste proprietà che devono essere presenti nel PrintTicket, crearle nel PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="68ca2-143">If there are any such Property instances that should be in your PrintTicket, create them in your PrintTicket.</span></span>

10. <span data-ttu-id="68ca2-144">Gli elementi figlio dello stesso tipo di elemento potrebbero non annidarsi a una profondità superiore a 10 elementi.</span><span class="sxs-lookup"><span data-stu-id="68ca2-144">Children of the same element type may not nest to a depth of more than 10 elements.</span></span> <span data-ttu-id="68ca2-145">Questa regola si applica in modo indipendente a ogni tipo di elemento che è possibile definire.</span><span class="sxs-lookup"><span data-stu-id="68ca2-145">This rule applies independently to each type of element that can be defined.</span></span>

> [!Note]  
> <span data-ttu-id="68ca2-146">Il contenuto XML di PrintTicket deve essere codificato con UTF-8 o UTF-16.</span><span class="sxs-lookup"><span data-stu-id="68ca2-146">PrintTicket XML content MUST be encoded using either UTF-8 or UTF-16.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="68ca2-147">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="68ca2-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="68ca2-148">Specifica dello schema di stampa</span><span class="sxs-lookup"><span data-stu-id="68ca2-148">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 



