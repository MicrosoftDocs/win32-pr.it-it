---
description: Specifica di un Allocator-Presenter personalizzato per VMR-7
ms.assetid: 19b43c9b-2578-418f-b03b-af7c7a3a46e4
title: Specifica di un Allocator-Presenter personalizzato per VMR-7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e79f191401f990214b2551f9210fab4dfe4d43b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "104556553"
---
# <a name="supplying-a-custom-allocator-presenter-for-vmr-7"></a><span data-ttu-id="1a400-103">Specifica di un Allocator-Presenter personalizzato per VMR-7</span><span class="sxs-lookup"><span data-stu-id="1a400-103">Supplying a Custom Allocator-Presenter for VMR-7</span></span>

<span data-ttu-id="1a400-104">Allocator-Presenter è responsabile dell'allocazione delle superfici di DirectDraw e della presentazione dei fotogrammi video per il rendering.</span><span class="sxs-lookup"><span data-stu-id="1a400-104">The allocator-presenter is responsible for allocating DirectDraw surfaces and presenting the video frames for rendering.</span></span> <span data-ttu-id="1a400-105">Nella maggior parte degli scenari, la funzionalità di allocatore-Presenter predefinito sarà più che sufficiente per le esigenze di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1a400-105">In the vast majority of scenarios, the functionality of the default allocator-presenter will be more than sufficient for an application's needs.</span></span> <span data-ttu-id="1a400-106">Tuttavia, inserendo un allocatore-Presenter personalizzato, un'applicazione può ottenere l'accesso diretto ai bit video e controllare completamente il processo di rendering.</span><span class="sxs-lookup"><span data-stu-id="1a400-106">But by plugging in a custom allocator-presenter, an application can obtain direct access to the video bits and completely control the rendering process.</span></span> <span data-ttu-id="1a400-107">Il compromesso per questa maggiore potenza è che l'applicazione deve gestire la complessità aggiuntiva della gestione della superficie di DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="1a400-107">The trade-off for this increased power is that the application must handle the added complexity of DirectDraw surface management.</span></span>

![uso di un allocatore-Presenter personalizzato](images/custom-ap.png)

<span data-ttu-id="1a400-109">La figura precedente illustra le interfacce di comunicazione usate da VMR e da Allocator-Presenter.</span><span class="sxs-lookup"><span data-stu-id="1a400-109">The preceding figure shows the communication interfaces used by the VMR and the allocator-presenter.</span></span> <span data-ttu-id="1a400-110">Un allocatore-Presenter personalizzato che esegue l'override di tutte le funzionalità di allocazione e presentazione predefinite deve implementare le interfacce [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) e [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) e, facoltativamente, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span><span class="sxs-lookup"><span data-stu-id="1a400-110">A custom allocator-presenter that overrides all of the default allocation and presentation functionality must implement the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) and [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interfaces, and optionally, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span></span>

<span data-ttu-id="1a400-111">Per sostituire l'allocatore-Presenter predefinito, un'applicazione chiama il metodo [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) e passa un puntatore al nuovo allocatore-Presenter.</span><span class="sxs-lookup"><span data-stu-id="1a400-111">To replace the default allocator-presenter, an application calls the [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) method and passes in a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="1a400-112">In risposta a questa chiamata, VMR chiamerà il metodo [**IVMRSurfaceAllocator:: AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) di Allocator-Presenter per fornire il puntatore all'interfaccia [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) di VMR.</span><span class="sxs-lookup"><span data-stu-id="1a400-112">In response to this call, the VMR will call the allocator-presenter's [**IVMRSurfaceAllocator::AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) method to provide the pointer to the VMR's [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) interface.</span></span> <span data-ttu-id="1a400-113">Allocator-Presenter utilizzerà questo puntatore di interfaccia quando passa gli eventi a VMR con il metodo [**IVMRSurfaceAllocatorNotify:: NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) .</span><span class="sxs-lookup"><span data-stu-id="1a400-113">The allocator-presenter will use this interface pointer when passing events to the VMR with the [**IVMRSurfaceAllocatorNotify::NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) method.</span></span>

<span data-ttu-id="1a400-114">Come soluzione alternativa, un'applicazione può usare sia il proprio allocatore-Presenter che l'allocatore-Presenter predefinito.</span><span class="sxs-lookup"><span data-stu-id="1a400-114">As an alternate solution, an application can use both its own allocator-presenter and the default allocator-presenter.</span></span> <span data-ttu-id="1a400-115">In questo scenario, l'allocatore-Presenter personalizzato gestisce solo le chiamate in cui è necessaria la funzionalità personalizzata e passa il resto delle chiamate dal VMR al relatore allocatore predefinito.</span><span class="sxs-lookup"><span data-stu-id="1a400-115">In this scenario, the custom allocator-presenter handles only those calls where custom functionality is needed, and passes the rest of the calls from the VMR through to the default allocator-presenter.</span></span> <span data-ttu-id="1a400-116">In molti casi, è necessario solo eseguire l'override dell'interfaccia [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) .</span><span class="sxs-lookup"><span data-stu-id="1a400-116">In many cases, it is only necessary to override the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface.</span></span>

![uso di due allocatori-Presenter](images/custom-ap2.png)

<span data-ttu-id="1a400-118">Per usare un allocatore-Presenter personalizzato e l'allocatore-Presenter predefinito, un'applicazione chiama prima [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) per fornire un puntatore al nuovo allocatore-Presenter.</span><span class="sxs-lookup"><span data-stu-id="1a400-118">To use both a custom allocator-presenter and the default allocator-presenter, an application would first call [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) to provide a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="1a400-119">In questo modo l'oggetto Allocator-Presenter predefinito viene eliminato definitivamente, quindi l'applicazione deve crearne un'altra chiamando **QueryInterface** in VMR e richiedendo l'interfaccia [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) .</span><span class="sxs-lookup"><span data-stu-id="1a400-119">This causes the default allocator-presenter to be destroyed, so the application must create another instance of it by calling **QueryInterface** on the VMR and requesting the [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interface.</span></span> <span data-ttu-id="1a400-120">Come illustrato nella figura precedente, l'allocatore-Presenter personalizzato esegue l'override dei metodi dell'interfaccia [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) e passa semplicemente tutte le chiamate all'interfaccia **IVMRSurfaceAllocator** tramite l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="1a400-120">As shown in the preceding figure, the custom allocator-presenter overrides the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface methods, and simply passes all calls to the **IVMRSurfaceAllocator** interface through to the default implementation.</span></span> <span data-ttu-id="1a400-121">La figura mostra anche l'interfaccia [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) come implementata in Allocator-Presenter.</span><span class="sxs-lookup"><span data-stu-id="1a400-121">The figure also shows the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface as being implemented on the allocator-presenter.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a400-122">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="1a400-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a400-123">Specifica di un Allocator-Presenter personalizzato per VMR-9</span><span class="sxs-lookup"><span data-stu-id="1a400-123">Supplying a Custom Allocator-Presenter for VMR-9</span></span>](supplying-a-custom-allocator-presenter-for-vmr-9.md)
</dt> <dt>

[<span data-ttu-id="1a400-124">Modalità di riproduzione con rendering VMR (allocatore personalizzato-Presenter)</span><span class="sxs-lookup"><span data-stu-id="1a400-124">VMR Renderless Playback Mode (Custom Allocator-Presenters)</span></span>](vmr-renderless-playback-mode--custom-allocator-presenters.md)
</dt> </dl>

 

 



