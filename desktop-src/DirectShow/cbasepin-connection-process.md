---
description: Processo di connessione CBasePin
ms.assetid: 4b3a9023-0267-4caa-9d89-88237009df05
title: Processo di connessione CBasePin
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1441b0daba58857e00da0139d3312fb277287fc2
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "103965643"
---
# <a name="cbasepin-connection-process"></a><span data-ttu-id="466f0-103">Processo di connessione CBasePin</span><span class="sxs-lookup"><span data-stu-id="466f0-103">CBasePin Connection Process</span></span>

<span data-ttu-id="466f0-104">In questa sezione viene descritto il modo in cui la classe [**CBasePin**](cbasepin.md) implementa il processo di connessione del PIN.</span><span class="sxs-lookup"><span data-stu-id="466f0-104">This section describes how the [**CBasePin**](cbasepin.md) class implements the pin connection process.</span></span>

<span data-ttu-id="466f0-105">Il gestore del grafico del filtro avvia tutte le connessioni pin.</span><span class="sxs-lookup"><span data-stu-id="466f0-105">The Filter Graph Manager initiates all pin connections.</span></span> <span data-ttu-id="466f0-106">Chiama il metodo [**Ipin:: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) del PIN di output, specificando il pin di input.</span><span class="sxs-lookup"><span data-stu-id="466f0-106">It calls the output pin's [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) method, specifying the input pin.</span></span> <span data-ttu-id="466f0-107">Il pin di output completa la connessione chiamando il metodo [**Ipin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) del PIN di input.</span><span class="sxs-lookup"><span data-stu-id="466f0-107">The output pin completes the connection by calling the input pin's [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) method.</span></span> <span data-ttu-id="466f0-108">Il pin di input può accettare o rifiutare la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-108">The input pin can accept or reject the connection.</span></span>

<span data-ttu-id="466f0-109">Il gestore del grafo del filtro può inoltre specificare un tipo di supporto per la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-109">The Filter Graph Manager can also specify a media type for the connection.</span></span> <span data-ttu-id="466f0-110">In tal caso, i pin tentano di connettersi a tale tipo.</span><span class="sxs-lookup"><span data-stu-id="466f0-110">If so, the pins try to connect with that type.</span></span> <span data-ttu-id="466f0-111">In caso contrario, i pin devono negoziare il tipo.</span><span class="sxs-lookup"><span data-stu-id="466f0-111">If not, the pins must negotiate the type.</span></span> <span data-ttu-id="466f0-112">Il gestore del grafico del filtro può inoltre specificare un tipo di supporto *parziale* , il cui valore GUID è \_ null per il tipo principale, il sottotipo o il tipo di formato.</span><span class="sxs-lookup"><span data-stu-id="466f0-112">The Filter Graph Manager may also specify a *partial* media type, which has the value GUID\_NULL for either the major type, subtype, or format type.</span></span> <span data-ttu-id="466f0-113">In tal caso, i pin tentano di trovare la corrispondenza con qualsiasi parte del tipo di supporto specificato. il valore null del GUID \_ funge da carattere jolly.</span><span class="sxs-lookup"><span data-stu-id="466f0-113">In that case, the pins try to match whichever portions of the media type were specified; the value GUID\_NULL acts as a wildcard.</span></span>

<span data-ttu-id="466f0-114">Il metodo [**CBasePin:: Connect**](cbasepin-connect.md) inizia verificando che il pin possa accettare una connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-114">The [**CBasePin::Connect**](cbasepin-connect.md) method starts by verifying that the pin can accept a connection.</span></span> <span data-ttu-id="466f0-115">Ad esempio, verifica che il PIN non sia già connesso.</span><span class="sxs-lookup"><span data-stu-id="466f0-115">For example, it checks that the pin is not already connected.</span></span> <span data-ttu-id="466f0-116">Delega il resto del processo di connessione al metodo [**CBasePin:: AgreeMediaType**](cbasepin-agreemediatype.md) .</span><span class="sxs-lookup"><span data-stu-id="466f0-116">It delegates the rest of the connection process to the [**CBasePin::AgreeMediaType**](cbasepin-agreemediatype.md) method.</span></span> <span data-ttu-id="466f0-117">Tutti gli elementi seguenti vengono eseguiti da **AgreeMediaType**.</span><span class="sxs-lookup"><span data-stu-id="466f0-117">Everything that follows is performed by **AgreeMediaType**.</span></span>

<span data-ttu-id="466f0-118">Se il tipo di supporto è completamente specificato, il pin chiama il metodo [**CBasePin:: AttemptConnection**](cbasepin-attemptconnection.md) per tentare la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-118">If the media type is fully specified, the pin calls the [**CBasePin::AttemptConnection**](cbasepin-attemptconnection.md) method to attempt the connection.</span></span> <span data-ttu-id="466f0-119">In caso contrario, tenta i tipi di supporto nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="466f0-119">Otherwise, it tries media types in the following order:</span></span>

1.  <span data-ttu-id="466f0-120">Tipi preferiti del PIN di input.</span><span class="sxs-lookup"><span data-stu-id="466f0-120">The input pin's preferred types.</span></span>
2.  <span data-ttu-id="466f0-121">Tipi preferiti del PIN di output.</span><span class="sxs-lookup"><span data-stu-id="466f0-121">The output pin's preferred types.</span></span>

<span data-ttu-id="466f0-122">È possibile invertire questo ordine impostando il flag [**CBasePin:: m \_ BTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) su **true**.</span><span class="sxs-lookup"><span data-stu-id="466f0-122">You can reverse this order by setting the [**CBasePin::m\_bTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) flag to **TRUE**.</span></span>

<span data-ttu-id="466f0-123">In ogni caso, il pin chiama [**Ipin:: EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) per enumerare i tipi di supporto.</span><span class="sxs-lookup"><span data-stu-id="466f0-123">In each case, the pin calls [**IPin::EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) to enumerate the media types.</span></span> <span data-ttu-id="466f0-124">Questo metodo recupera un oggetto enumeratore, che viene passato al metodo [**CBasePin:: TryMediaTypes**](cbasepin-trymediatypes.md) .</span><span class="sxs-lookup"><span data-stu-id="466f0-124">This method retrieves an enumerator object, which is passed to the [**CBasePin::TryMediaTypes**](cbasepin-trymediatypes.md) method.</span></span> <span data-ttu-id="466f0-125">Il metodo **TryMediaTypes** esegue il ciclo di ogni tipo di supporto e chiama [**AttemptConnection**](cbasepin-attemptconnection.md) per ogni tipo.</span><span class="sxs-lookup"><span data-stu-id="466f0-125">The **TryMediaTypes** method loops through each media type and calls [**AttemptConnection**](cbasepin-attemptconnection.md) for each type.</span></span>

<span data-ttu-id="466f0-126">All'interno del metodo [**AttemptConnection**](cbasepin-attemptconnection.md) , il pin di output chiama i metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="466f0-126">Within the [**AttemptConnection**](cbasepin-attemptconnection.md) method, the output pin calls the following methods:</span></span>

-   <span data-ttu-id="466f0-127">Viene chiamato [**CBasePin:: CheckConnect**](cbasepin-checkconnect.md) per verificare se il pin di input è adatto.</span><span class="sxs-lookup"><span data-stu-id="466f0-127">It calls [**CBasePin::CheckConnect**](cbasepin-checkconnect.md) on itself, to check whether the input pin is suitable.</span></span>
-   <span data-ttu-id="466f0-128">Viene chiamato [**CBasePin:: CheckMediaType**](cbasepin-checkmediatype.md) su se stesso per convalidare il tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="466f0-128">It calls [**CBasePin::CheckMediaType**](cbasepin-checkmediatype.md) on itself, to validate the media type.</span></span>
-   <span data-ttu-id="466f0-129">Chiama [**Ipin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) sul pin di input.</span><span class="sxs-lookup"><span data-stu-id="466f0-129">It calls [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) on the input pin.</span></span> <span data-ttu-id="466f0-130">Il pin di input usa questo metodo per determinare se deve accettare la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-130">The input pin uses this method to determine whether it should accept the connection.</span></span>
-   <span data-ttu-id="466f0-131">Viene chiamato [**CBasePin:: CompleteConnect**](cbasepin-completeconnect.md) per completare la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-131">It calls [**CBasePin::CompleteConnect**](cbasepin-completeconnect.md) on itself to completes the connection.</span></span>

<span data-ttu-id="466f0-132">Tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="466f0-132">Note the following:</span></span>

-   <span data-ttu-id="466f0-133">[**CheckConnect**](cbasepin-checkconnect.md) è un metodo virtuale.</span><span class="sxs-lookup"><span data-stu-id="466f0-133">[**CheckConnect**](cbasepin-checkconnect.md) is a virtual method.</span></span> <span data-ttu-id="466f0-134">Nella classe di base, questo metodo controlla se le direzioni del pin sono compatibili.</span><span class="sxs-lookup"><span data-stu-id="466f0-134">In the base class, this method checks whether the pin directions are compatible.</span></span> <span data-ttu-id="466f0-135">I pin di output devono connettersi ai pin di input e viceversa.</span><span class="sxs-lookup"><span data-stu-id="466f0-135">Output pins must connect to input pins, and vice versa.</span></span> <span data-ttu-id="466f0-136">La classe pin derivata eseguirà in genere l'override di questo metodo per eseguire altri controlli.</span><span class="sxs-lookup"><span data-stu-id="466f0-136">The derived pin class will typically override this method to perform other checks.</span></span> <span data-ttu-id="466f0-137">Ad esempio, potrebbe eseguire una query sull'altro pin per un'interfaccia necessaria per la connessione.</span><span class="sxs-lookup"><span data-stu-id="466f0-137">For example, it might query the other pin for an interface that is required for the connection.</span></span> <span data-ttu-id="466f0-138">Se la classe derivata esegue l'override di **CheckConnect**, deve chiamare anche il metodo [**CBasePin**](cbasepin.md) .</span><span class="sxs-lookup"><span data-stu-id="466f0-138">If the derived class overrides **CheckConnect**, it should also call the [**CBasePin**](cbasepin.md) method.</span></span>
-   <span data-ttu-id="466f0-139">[**CheckMediaType**](cbasepin-checkmediatype.md) è un metodo virtuale puro, che deve essere implementato dalla classe derivata.</span><span class="sxs-lookup"><span data-stu-id="466f0-139">[**CheckMediaType**](cbasepin-checkmediatype.md) is a pure virtual method, which the derived class must implement.</span></span>
-   <span data-ttu-id="466f0-140">[**CompleteConnect**](cbasepin-completeconnect.md) è un metodo virtuale che non esegue alcuna operazione nella classe di base.</span><span class="sxs-lookup"><span data-stu-id="466f0-140">[**CompleteConnect**](cbasepin-completeconnect.md) is a virtual method that does nothing in the base class.</span></span> <span data-ttu-id="466f0-141">Le classi derivate possono eseguire l'override di questo metodo per eseguire operazioni aggiuntive necessarie per completare la connessione, ad esempio per decidere un allocatore di memoria.</span><span class="sxs-lookup"><span data-stu-id="466f0-141">Derived classes can override this method to perform any additional work needed to complete the connection, such as deciding a memory allocator.</span></span>

<span data-ttu-id="466f0-142">Se uno di questi passaggi ha esito negativo, il pin di output chiama il metodo [**CBasePin:: BreakConnect**](cbasepin-breakconnect.md) per annullare tutti i passaggi eseguiti da [**CheckConnect**](cbasepin-checkconnect.md).</span><span class="sxs-lookup"><span data-stu-id="466f0-142">If any of these steps fails, the output pin calls the [**CBasePin::BreakConnect**](cbasepin-breakconnect.md) method to undo whatever steps were taken by [**CheckConnect**](cbasepin-checkconnect.md).</span></span>

<span data-ttu-id="466f0-143">Il metodo [**ReceiveConnection**](cbasepin-receiveconnection.md) del PIN di input chiama i metodi [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md)e [**CompleteConnect**](cbasepin-completeconnect.md) del PIN di input.</span><span class="sxs-lookup"><span data-stu-id="466f0-143">The input pin's [**ReceiveConnection**](cbasepin-receiveconnection.md) method calls the input pin's [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md), and [**CompleteConnect**](cbasepin-completeconnect.md) methods.</span></span> <span data-ttu-id="466f0-144">Se uno di questi errori, anche il tentativo di connessione non riesce.</span><span class="sxs-lookup"><span data-stu-id="466f0-144">If any of these fail, the connection attempt also fails.</span></span>

<span data-ttu-id="466f0-145">Il diagramma seguente illustra il processo di connessione in [**CBasePin**](cbasepin.md):</span><span class="sxs-lookup"><span data-stu-id="466f0-145">The following diagram shows the connection process in [**CBasePin**](cbasepin.md):</span></span>

![processo di connessione CBasePin](images/cbasepin-connect.png)

## <a name="related-topics"></a><span data-ttu-id="466f0-147">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="466f0-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="466f0-148">**CBasePin**</span><span class="sxs-lookup"><span data-stu-id="466f0-148">**CBasePin**</span></span>](cbasepin.md)
</dt> </dl>

 

 



