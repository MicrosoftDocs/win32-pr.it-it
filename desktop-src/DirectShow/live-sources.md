---
description: Origini attive
ms.assetid: 571fe5e5-9616-463b-837c-f8dbb8adf1be
title: Origini attive
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43486cf3db797f493c9446bf782989b8beaae829
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104481749"
---
# <a name="live-sources"></a><span data-ttu-id="3bb0f-103">Origini attive</span><span class="sxs-lookup"><span data-stu-id="3bb0f-103">Live Sources</span></span>

<span data-ttu-id="3bb0f-104">Un'origine live, detta anche *origine push*, riceve i dati in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-104">A live source, also called a *push source*, receives data in real time.</span></span> <span data-ttu-id="3bb0f-105">Gli esempi includono acquisizione video e trasmissioni di rete.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-105">Examples include video capture and network broadcasts.</span></span> <span data-ttu-id="3bb0f-106">In generale, un'origine live non può controllare la velocità di arrivo dei dati.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-106">In general, a live source cannot control the rate at which data arrives.</span></span>

<span data-ttu-id="3bb0f-107">Un filtro viene considerato un'origine live se si verifica una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3bb0f-107">A filter is considered to be a live source if either of the following are true:</span></span>

-   <span data-ttu-id="3bb0f-108">Il filtro restituisce il \_ filtro am \_ \_ flag varie \_ è il \_ flag di origine del metodo [**IAMFilterMiscFlags:: GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) e almeno uno dei relativi pin di output espone l'interfaccia [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-108">The filter returns the AM\_FILTER\_MISC\_FLAGS\_IS\_SOURCE flag from the [**IAMFilterMiscFlags::GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) method, AND at least one of its output pins exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span>
-   <span data-ttu-id="3bb0f-109">Il filtro espone l'interfaccia [**IKsPropertySet**](ikspropertyset.md) e include un pin di acquisizione ( \_ acquisizione della categoria pin \_ ).</span><span class="sxs-lookup"><span data-stu-id="3bb0f-109">The filter exposes the [**IKsPropertySet**](ikspropertyset.md) interface and has a capture pin (PIN\_CATEGORY\_CAPTURE).</span></span> <span data-ttu-id="3bb0f-110">Per ulteriori informazioni, vedere il [set di proprietà pin](pin-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-110">See [Pin Property Set](pin-property-set.md) for more information.</span></span>

<span data-ttu-id="3bb0f-111">Se un filtro di origine Live fornisce un clock, il gestore del grafico del filtro preferisce tale clock quando sceglie l'orologio di riferimento del grafo.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-111">If a live source filter provides a clock, the Filter Graph Manager will prefer that clock when it chooses the graph reference clock.</span></span> <span data-ttu-id="3bb0f-112">Per ulteriori informazioni, vedere [clock di riferimento](reference-clocks.md) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-112">See [Reference Clocks](reference-clocks.md) for more information.</span></span>

<span data-ttu-id="3bb0f-113">**Latency**</span><span class="sxs-lookup"><span data-stu-id="3bb0f-113">**Latency**</span></span>

<span data-ttu-id="3bb0f-114">La latenza di un filtro è la quantità di tempo impiegato dal filtro per elaborare un campione.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-114">A filter's latency is the amount of time it takes the filter to process a sample.</span></span> <span data-ttu-id="3bb0f-115">Per le origini live, la latenza è determinata dalla dimensione del buffer usato per conservare gli esempi.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-115">For live sources, the latency is determined by the size of the buffer used to hold samples.</span></span> <span data-ttu-id="3bb0f-116">Si supponga, ad esempio, che il grafico di filtro includa un'origine video con una latenza di 33 millisecondi (MS) e un'origine audio con una latenza di 500 ms.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-116">For example, suppose the filter graph has a video source with a latency of 33 milliseconds (ms) and an audio source with a latency of 500 ms.</span></span> <span data-ttu-id="3bb0f-117">Ogni fotogramma video arriva al renderer video circa 470 ms prima che l'esempio audio corrispondente raggiunga il renderer audio.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-117">Each video frame arrives at the video renderer about 470 ms before the matching audio sample reaches the audio renderer.</span></span> <span data-ttu-id="3bb0f-118">Se il grafico non compensa la differenza, l'audio e il video non verranno sincronizzati.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-118">Unless the graph compensates for the difference, the audio and video will not be synchronized.</span></span>

<span data-ttu-id="3bb0f-119">Le origini attive possono essere sincronizzate tramite l'interfaccia [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-119">Live sources can be synchronized through the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="3bb0f-120">Filter Graph Manager non sincronizza le origini attive a meno che l'applicazione non consenta la sincronizzazione chiamando il metodo [**IAMGraphStreams:: SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-120">The Filter Graph Manager does not synchronize live sources unless the application enables synchronization by calling the [**IAMGraphStreams::SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) method.</span></span> <span data-ttu-id="3bb0f-121">Se la sincronizzazione è abilitata, il gestore del grafico dei filtri esegue una query su ogni filtro di origine per **IAMPushSource**.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-121">If synchronization is enabled, the Filter Graph Manager queries each source filter for **IAMPushSource**.</span></span> <span data-ttu-id="3bb0f-122">Se il filtro supporta **IAMPushSource**, il gestore del grafo dei filtri chiama [**IAMLatency:: getlatence**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) per recuperare la latenza prevista del filtro.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-122">If the filter supports **IAMPushSource**, the Filter Graph Manager calls [**IAMLatency::GetLatency**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) to retrieve the filter's expected latency.</span></span> <span data-ttu-id="3bb0f-123">(L'interfaccia **IAMPushSource** eredita [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency)). Dai valori di latenza combinati, il gestore del grafico dei filtri determina la latenza massima prevista nel grafico.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-123">(The **IAMPushSource** interface inherits [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency).) From the combined latency values, the Filter Graph Manager determines the maximum expected latency in the graph.</span></span> <span data-ttu-id="3bb0f-124">Chiama quindi [**IAMPushSource:: SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) per assegnare a ogni filtro di origine un offset del flusso, che tale filtro aggiunge agli indicatori temporali che genera.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-124">It then calls [**IAMPushSource::SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) to give each source filter a stream offset, which that filter adds to the time stamps that it generates.</span></span>

<span data-ttu-id="3bb0f-125">Questo metodo è destinato principalmente all'anteprima in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-125">This method is intended primarily for live preview.</span></span> <span data-ttu-id="3bb0f-126">Si noti tuttavia che un pin di anteprima in un dispositivo di acquisizione in tempo reale, ad esempio una fotocamera, non imposta i timestamp sugli esempi che fornisce.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-126">However, note that a preview pin on a live capture device (such as a camera) does not set time stamps on the samples it delivers.</span></span> <span data-ttu-id="3bb0f-127">Pertanto, per usare questo metodo con un dispositivo di acquisizione in tempo reale, è necessario visualizzare l'anteprima dal pin di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-127">Therefore, to use this method with a live capture device, you must preview from the capture pin.</span></span> <span data-ttu-id="3bb0f-128">Per altre informazioni, vedere [filtri di acquisizione video DirectShow](directshow-video-capture-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3bb0f-128">For more information, see [DirectShow Video Capture Filters](directshow-video-capture-filters.md).</span></span>

<span data-ttu-id="3bb0f-129">Attualmente l'interfaccia [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) è supportata dal filtro di [acquisizione di VFW](vfw-capture-filter.md) e dal filtro di [acquisizione audio](audio-capture-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-129">Currently the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface is supported by the [VFW Capture](vfw-capture-filter.md) filter and the [Audio Capture](audio-capture-filter.md) filter.</span></span>

<span data-ttu-id="3bb0f-130">**Corrispondenza frequenza**</span><span class="sxs-lookup"><span data-stu-id="3bb0f-130">**Rate Matching**</span></span>

<span data-ttu-id="3bb0f-131">Se un filtro renderer Pianifica esempi utilizzando un clock di riferimento, ma il filtro di origine li produce utilizzando un clock diverso, è possibile che si verifichino problemi durante la riproduzione.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-131">If a renderer filter schedules samples using one reference clock, but the source filter produces them using a different clock, glitches can occur in playback.</span></span> <span data-ttu-id="3bb0f-132">Il renderer potrebbe essere eseguito più velocemente rispetto all'origine, causando gap nei dati.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-132">The renderer might run faster than the source, causing gaps in the data.</span></span> <span data-ttu-id="3bb0f-133">In alternativa, è possibile che venga eseguito più lentamente rispetto all'origine, causando il "gruppo di campioni" fino a un certo punto in cui il grafico eliminerà i campioni.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-133">Or it might run slower than the source, causing samples to "bunch up," until at some point the graph will drop samples.</span></span> <span data-ttu-id="3bb0f-134">In genere, un'origine live non può controllare la velocità di produzione, quindi il renderer deve corrispondere alle frequenze con l'origine.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-134">Typically, a live source cannot control its production rate, so instead the renderer should match rates with the source.</span></span>

<span data-ttu-id="3bb0f-135">Attualmente, solo il renderer audio esegue la corrispondenza della frequenza, perché i glitch nella riproduzione audio sono più evidenti rispetto ai glitch nei video.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-135">Currently, only the audio renderer performs rate matching, because glitches in audio playback are more noticeable than glitches in video.</span></span> <span data-ttu-id="3bb0f-136">Per eseguire la corrispondenza della frequenza, il renderer audio deve selezionare un elemento rispetto al quale corrisponderà alle tariffe.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-136">To perform rate-matching, the audio renderer must select something against which it will match rates.</span></span> <span data-ttu-id="3bb0f-137">Usa l'algoritmo seguente:</span><span class="sxs-lookup"><span data-stu-id="3bb0f-137">It uses the following algorithm:</span></span>

-   <span data-ttu-id="3bb0f-138">Se il grafico non usa un orologio di riferimento, il renderer audio non tenta di trovare una corrispondenza con le tariffe.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-138">If the graph is not using a reference clock, the audio renderer does not try to match rates.</span></span> <span data-ttu-id="3bb0f-139">Ogni volta che il grafico non ha un clock di riferimento, viene sempre eseguito il rendering degli esempi immediatamente dopo l'arrivo.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-139">(Whenever the graph has no reference clock, samples are always rendered immediately as they arrive.)</span></span>
-   <span data-ttu-id="3bb0f-140">In caso contrario, se è presente un clock di riferimento per il grafo, il renderer audio controlla se è presente un'origine live upstream, usando i criteri descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-140">Otherwise, if there is a reference clock for the graph, the audio renderer checks whether there is a live source upstream, using the criteria described previously.</span></span> <span data-ttu-id="3bb0f-141">In caso contrario, il renderer audio non corrisponde alle tariffe.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-141">If not, the audio renderer does not match rates.</span></span>
-   <span data-ttu-id="3bb0f-142">Se è presente un'origine live upstream e tale origine espone l'interfaccia [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) sul pin di output, il renderer audio chiama [**IAMPushSource:: GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span><span class="sxs-lookup"><span data-stu-id="3bb0f-142">If there is a live source upstream, and that source exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface on its output pin, the audio renderer calls [**IAMPushSource::GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span></span> <span data-ttu-id="3bb0f-143">Cerca uno dei flag seguenti:</span><span class="sxs-lookup"><span data-stu-id="3bb0f-143">It looks for one of the following flags:</span></span>
    -   <span data-ttu-id="3bb0f-144">AM \_ PUSHSOURCECAPS \_ Internal \_ RM.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-144">AM\_PUSHSOURCECAPS\_INTERNAL\_RM.</span></span> <span data-ttu-id="3bb0f-145">Questo flag indica che il filtro di origine ha un proprio meccanismo di corrispondenza della frequenza, quindi il renderer audio non corrisponde alle tariffe.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-145">This flag means the source filter has its own rate-matching mechanism, so the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="3bb0f-146">il \_ PUSHSOURCECAPS \_ non è \_ attivo.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-146">AM\_PUSHSOURCECAPS\_NOT\_LIVE.</span></span> <span data-ttu-id="3bb0f-147">Questo flag indica che il filtro di origine non è realmente un'origine live, anche se espone l'interfaccia [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="3bb0f-147">This flag means the source filter is not really a live source, even though it exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="3bb0f-148">Pertanto, il renderer audio non corrisponde alle tariffe.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-148">Therefore, the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="3bb0f-149">AM \_ PUSHSOURCECAPS \_ private \_ Clock.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-149">AM\_PUSHSOURCECAPS\_PRIVATE\_CLOCK.</span></span> <span data-ttu-id="3bb0f-150">Questo flag indica che il filtro di origine utilizza un clock privato per generare timestamp.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-150">This flag means the source filter is using a private clock to generate time stamps.</span></span> <span data-ttu-id="3bb0f-151">In questo caso, il renderer audio corrisponde alle frequenze rispetto ai timestamp.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-151">In this case, the audio renderer matches rates against the time stamps.</span></span> <span data-ttu-id="3bb0f-152">Se gli esempi non hanno timestamp, tuttavia, il renderer ignora questo flag.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-152">(If the samples have no time stamps, however, the renderer ignores this flag.)</span></span>
-   <span data-ttu-id="3bb0f-153">Se [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) non restituisce alcun flag (zero), il comportamento del renderer audio dipende dal clock del grafico e dal fatto che gli esempi abbiano timestamp:</span><span class="sxs-lookup"><span data-stu-id="3bb0f-153">If [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) returns no flags (zero), the audio renderer's behavior depends on the graph clock and whether the samples have time stamps:</span></span>
    -   <span data-ttu-id="3bb0f-154">Se il renderer audio non è il clock del grafico e gli esempi hanno timestamp, il renderer audio corrisponde alle frequenze rispetto ai timestamp.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-154">If the audio renderer is not the graph clock, AND the samples have time stamps, the audio renderer matches rates against the time stamps.</span></span>
    -   <span data-ttu-id="3bb0f-155">Se gli esempi non hanno timestamp, il renderer audio tenta di trovare la corrispondenza con la frequenza dei dati audio in ingresso.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-155">If the samples do not have time stamps, the audio renderer tries to match the rate of incoming audio data.</span></span>
    -   <span data-ttu-id="3bb0f-156">Se il renderer audio è il clock del grafico, tenta di trovare una corrispondenza con la velocità dei dati in ingresso.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-156">If the audio renderer is the graph clock, it tries to match the incoming data rate.</span></span>

<span data-ttu-id="3bb0f-157">Il motivo dell'ultimo caso è il seguente: se il renderer audio è il clock di riferimento e il filtro di origine usa lo stesso clock per generare timestamp, il renderer audio non può corrispondere alle frequenze rispetto ai timestamp.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-157">The reason for the last case is the following: If the audio renderer is the reference clock, and the source filter is using the same clock to generate time stamps, then the audio renderer cannot match rates against the time stamps.</span></span> <span data-ttu-id="3bb0f-158">In caso affermativo, si tenterà di trovare una corrispondenza con le tariffe, che potrebbero causare la desincronizzazione del clock.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-158">If it did, in effect it would be trying to match rates with itself, which could cause the clock to drift.</span></span> <span data-ttu-id="3bb0f-159">Pertanto, in questo caso il renderer corrisponde alla frequenza dei dati audio in ingresso.</span><span class="sxs-lookup"><span data-stu-id="3bb0f-159">Therefore, in this case the renderer matches the rate of incoming audio data.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3bb0f-160">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3bb0f-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3bb0f-161">Time and Clocks in DirectShow</span><span class="sxs-lookup"><span data-stu-id="3bb0f-161">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



