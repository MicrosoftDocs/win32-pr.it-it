---
description: Elaborazione dei dati
ms.assetid: 823615df-ce50-4e20-957a-f83d3be66658
title: Elaborazione dei dati
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9bbece449df36c2de88414f313d477b8a16ba896
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "106304090"
---
# <a name="processing-data"></a><span data-ttu-id="afc91-103">Elaborazione dei dati</span><span class="sxs-lookup"><span data-stu-id="afc91-103">Processing Data</span></span>

<span data-ttu-id="afc91-104">**Analisi dei dati multimediali**</span><span class="sxs-lookup"><span data-stu-id="afc91-104">**Parsing Media Data**</span></span>

<span data-ttu-id="afc91-105">Se il filtro analizza i dati multimediali, non considerare attendibili le intestazioni o altri dati autodescrittivi nel contenuto.</span><span class="sxs-lookup"><span data-stu-id="afc91-105">If your filter parses media data, do not trust headers or other self-describing data in the content.</span></span> <span data-ttu-id="afc91-106">Ad esempio, non considerare attendibili i valori delle dimensioni che vengono visualizzati nei blocchi AVI o nei pacchetti MPEG.</span><span class="sxs-lookup"><span data-stu-id="afc91-106">For example, do not trust size values that appear in AVI RIFF chunks or MPEG packets.</span></span> <span data-ttu-id="afc91-107">Esempi comuni di questo tipo di errore includono:</span><span class="sxs-lookup"><span data-stu-id="afc91-107">Common examples of this kind of error include:</span></span>

-   <span data-ttu-id="afc91-108">Lettura di *n* byte di dati, in cui il valore di *n* deriva dal contenuto, senza controllare *n* rispetto alle dimensioni effettive del buffer.</span><span class="sxs-lookup"><span data-stu-id="afc91-108">Reading *N* bytes of data, where the value of *N* came from the content, without checking *N* against the actual size of your buffer.</span></span>
-   <span data-ttu-id="afc91-109">Passaggio a un offset di byte all'interno di un buffer, senza verificare che l'offset rientri nel buffer.</span><span class="sxs-lookup"><span data-stu-id="afc91-109">Jumping to a byte offset within a buffer, without verifying that the offset falls within the buffer.</span></span>

<span data-ttu-id="afc91-110">Un'altra classe comune di errori implica la mancata convalida delle descrizioni del formato trovate nel contenuto.</span><span class="sxs-lookup"><span data-stu-id="afc91-110">Another common class of errors involves not validating format descriptions that are found in the content.</span></span> <span data-ttu-id="afc91-111">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="afc91-111">For example:</span></span>

-   <span data-ttu-id="afc91-112">Una struttura [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) può essere seguita da una tabella dei colori.</span><span class="sxs-lookup"><span data-stu-id="afc91-112">A [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) structure can be followed by a color table.</span></span> <span data-ttu-id="afc91-113">La struttura **BITMAPINFO** viene definita come una struttura **BITMAPINFOHEADER** seguita da una matrice di valori **RGBQUAD** che compongono la tabella dei colori.</span><span class="sxs-lookup"><span data-stu-id="afc91-113">The **BITMAPINFO** structure is defined as a **BITMAPINFOHEADER** structure followed by an array of **RGBQUAD** values that make up the color table.</span></span> <span data-ttu-id="afc91-114">Le dimensioni della matrice sono determinate dal valore di **biClrUsed**.</span><span class="sxs-lookup"><span data-stu-id="afc91-114">The size of the array is determined by the value of **biClrUsed**.</span></span> <span data-ttu-id="afc91-115">Non copiare mai una tabella dei colori in un **BITMAPINFO** senza prima controllare la dimensione del buffer allocato per la struttura **BITMAPINFO** .</span><span class="sxs-lookup"><span data-stu-id="afc91-115">Never copy a color table into a **BITMAPINFO** without first checking the size of the buffer that was allocated for the **BITMAPINFO** structure.</span></span>
-   <span data-ttu-id="afc91-116">Una struttura [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85)) potrebbe avere informazioni aggiuntive sul formato aggiunte alla struttura.</span><span class="sxs-lookup"><span data-stu-id="afc91-116">A [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85)) structure might have extra format information appended to the structure.</span></span> <span data-ttu-id="afc91-117">Il membro **cbSize** specifica la dimensione delle informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="afc91-117">The **cbSize** member specifies the size of the extra information.</span></span>

<span data-ttu-id="afc91-118">Durante la connessione al pin, un filtro deve verificare che tutte le strutture di formato siano ben formate e contengano valori ragionevoli.</span><span class="sxs-lookup"><span data-stu-id="afc91-118">During pin connection, a filter should verify that all format structures are well-formed and contain reasonable values.</span></span> <span data-ttu-id="afc91-119">In caso contrario, rifiutare la connessione.</span><span class="sxs-lookup"><span data-stu-id="afc91-119">If not, reject the connection.</span></span> <span data-ttu-id="afc91-120">Nel codice che convalida la struttura del formato, prestare particolare attenzione all'overflow aritmetico.</span><span class="sxs-lookup"><span data-stu-id="afc91-120">In the code that validates the format structure, be especially careful about arithmetic overflow.</span></span> <span data-ttu-id="afc91-121">Ad esempio, in un **BITMAPINFOHEADER**, la larghezza e l'altezza sono valori **Long** a 32 bit, ma le dimensioni dell'immagine (che è una funzione del prodotto dei due) sono solo un valore **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="afc91-121">For example, in a **BITMAPINFOHEADER**, the width and height are 32-bit **long** values but the image size (which is a function of the product of the two) is only a **DWORD** value.</span></span>

<span data-ttu-id="afc91-122">Se i dati di formattazione dell'origine sono maggiori del buffer allocato, non troncare i dati di origine per poterli copiare nel buffer.</span><span class="sxs-lookup"><span data-stu-id="afc91-122">If format data from the source is larger than your allocated buffer, do not truncate the source data in order to copy it into your buffer.</span></span> <span data-ttu-id="afc91-123">In questo modo è possibile creare una struttura la cui dimensione implicita è maggiore delle dimensioni effettive.</span><span class="sxs-lookup"><span data-stu-id="afc91-123">Doing so can create a structure whose implicit size is larger than its actual size.</span></span> <span data-ttu-id="afc91-124">Ad esempio, un'intestazione bitmap potrebbe specificare una tabella della tavolozza che non esiste più.</span><span class="sxs-lookup"><span data-stu-id="afc91-124">For example, a bitmap header might specify a palette table which no longer exists.</span></span> <span data-ttu-id="afc91-125">In alternativa, riallocare il buffer o semplicemente interrompere la connessione.</span><span class="sxs-lookup"><span data-stu-id="afc91-125">Instead, reallocate the buffer or simply fail the connection.</span></span>

<span data-ttu-id="afc91-126">**Errori durante il flusso**</span><span class="sxs-lookup"><span data-stu-id="afc91-126">**Errors During Streaming**</span></span>

<span data-ttu-id="afc91-127">Quando il grafico è in esecuzione, se il filtro riceve contenuto non valido, deve terminare il flusso.</span><span class="sxs-lookup"><span data-stu-id="afc91-127">When the graph is running, if your filter receives malformed content, it should terminate streaming.</span></span> <span data-ttu-id="afc91-128">Eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="afc91-128">Do the following:</span></span>

-   <span data-ttu-id="afc91-129">Restituisce un codice di errore dalla **ricezione**.</span><span class="sxs-lookup"><span data-stu-id="afc91-129">Return an error code from **Receive**.</span></span>
-   <span data-ttu-id="afc91-130">Chiamare [**Ipin:: EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream) sul filtro downstream.</span><span class="sxs-lookup"><span data-stu-id="afc91-130">Call [**IPin::EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream) on the downstream filter.</span></span>
-   <span data-ttu-id="afc91-131">Chiamare [**CBaseFilter:: NotifyEvent**](cbasefilter-notifyevent.md) per pubblicare un evento [**EC \_ ERRORABORT**](ec-errorabort.md) .</span><span class="sxs-lookup"><span data-stu-id="afc91-131">Call [**CBaseFilter::NotifyEvent**](cbasefilter-notifyevent.md) to post an [**EC\_ERRORABORT**](ec-errorabort.md) event.</span></span>

<span data-ttu-id="afc91-132">**Modifiche al formato**</span><span class="sxs-lookup"><span data-stu-id="afc91-132">**Format Changes**</span></span>

<span data-ttu-id="afc91-133">Esistono diversi meccanismi per i filtri per modificare i formati a metà flusso.</span><span class="sxs-lookup"><span data-stu-id="afc91-133">Several mechanisms exist for filters to change formats mid-stream.</span></span> <span data-ttu-id="afc91-134">Ognuno di essi prevede più di un passaggio, che consente di creare le potenziali accettazioni false.</span><span class="sxs-lookup"><span data-stu-id="afc91-134">Each of them involves more than one step, which creates the potential for false acceptances.</span></span> <span data-ttu-id="afc91-135">Se il filtro riceve una richiesta di modifica del formato dinamico, deve rifiutare la richiesta oppure rispettare il nuovo formato al suo arrivo.</span><span class="sxs-lookup"><span data-stu-id="afc91-135">If your filter gets a request for a dynamic format change, then it must either reject the request, or else honor the new format when it arrives.</span></span> <span data-ttu-id="afc91-136">Analogamente, non cambiare mai i formati, a meno che l'altro filtro non accetti.</span><span class="sxs-lookup"><span data-stu-id="afc91-136">Similarly, never switch formats unless the other filter agrees.</span></span> <span data-ttu-id="afc91-137">Per altre informazioni, vedere [Dynamic Format Changes](dynamic-format-changes.md).</span><span class="sxs-lookup"><span data-stu-id="afc91-137">For more information, see [Dynamic Format Changes](dynamic-format-changes.md).</span></span>

 

 
