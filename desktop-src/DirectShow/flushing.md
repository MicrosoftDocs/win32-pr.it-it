---
description: Flushing
ms.assetid: 868218c4-3e1a-4da0-89fa-30a9848da0e8
title: Flushing
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 575f311020c2c7a567e544b80ba323a29051cc38
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104522401"
---
# <a name="flushing"></a><span data-ttu-id="04149-103">Flushing</span><span class="sxs-lookup"><span data-stu-id="04149-103">Flushing</span></span>

<span data-ttu-id="04149-104">Mentre il grafico del filtro è in esecuzione, è possibile spostarsi tra le quantità arbitrarie di dati nel grafico.</span><span class="sxs-lookup"><span data-stu-id="04149-104">While the filter graph is running, arbitrary amounts of data can be moving through the graph.</span></span> <span data-ttu-id="04149-105">Alcune di esse potrebbero trovarsi in code, in attesa di essere recapitate.</span><span class="sxs-lookup"><span data-stu-id="04149-105">Some of it might be in queues, waiting to be delivered.</span></span> <span data-ttu-id="04149-106">In alcuni casi il grafo del filtro deve rimuovere questi dati in sospeso il più rapidamente possibile e sostituirli con nuovi dati.</span><span class="sxs-lookup"><span data-stu-id="04149-106">There are times when the filter graph needs to remove this pending data as quickly as possible and replace it with new data.</span></span> <span data-ttu-id="04149-107">Dopo un comando seek, ad esempio, il filtro di origine genera esempi da una nuova posizione nell'origine.</span><span class="sxs-lookup"><span data-stu-id="04149-107">After a seek command, for example, the source filter generates samples from a new position in the source.</span></span> <span data-ttu-id="04149-108">Per ridurre al minimo la latenza, è necessario che i filtri downstream eliminino tutti gli esempi creati prima del comando seek.</span><span class="sxs-lookup"><span data-stu-id="04149-108">To minimize latency, downstream filters should discard any samples that were created before the seek command.</span></span> <span data-ttu-id="04149-109">Il processo di eliminazione degli esempi è denominato *svuotamento*.</span><span class="sxs-lookup"><span data-stu-id="04149-109">The process of discarding samples is called *flushing*.</span></span> <span data-ttu-id="04149-110">Consente al grafico di essere più reattivo quando gli eventi modificano il flusso di dati normale.</span><span class="sxs-lookup"><span data-stu-id="04149-110">It enables the graph to be more responsive when events alter the normal data flow.</span></span>

<span data-ttu-id="04149-111">Lo svuotamento viene gestito in modo leggermente diverso dal modello pull rispetto al modello push.</span><span class="sxs-lookup"><span data-stu-id="04149-111">Flushing is handled slightly differently by the pull model than the push model.</span></span> <span data-ttu-id="04149-112">Questo articolo inizia con la descrizione del modello push; descrive quindi le differenze nel modello pull.</span><span class="sxs-lookup"><span data-stu-id="04149-112">This article starts by describing the push model; then it describes the differences in the pull model.</span></span>

<span data-ttu-id="04149-113">Lo svuotamento avviene in due fasi.</span><span class="sxs-lookup"><span data-stu-id="04149-113">Flushing happens in two stages.</span></span>

-   <span data-ttu-id="04149-114">In primo luogo, il filtro di origine chiama [**Ipin:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) sul pin di input del filtro downstream.</span><span class="sxs-lookup"><span data-stu-id="04149-114">First, the source filter calls [**IPin::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) on the downstream filter's input pin.</span></span> <span data-ttu-id="04149-115">Il filtro downstream inizia a rifiutare gli esempi da upstream.</span><span class="sxs-lookup"><span data-stu-id="04149-115">The downstream filter starts rejecting samples from upstream.</span></span> <span data-ttu-id="04149-116">Elimina anche tutti gli esempi che contiene e Invia la chiamata **BeginFlush** downstream al filtro successivo.</span><span class="sxs-lookup"><span data-stu-id="04149-116">It also discards any samples it is holding, and sends the **BeginFlush** call downstream to the next filter.</span></span>
-   <span data-ttu-id="04149-117">Quando il filtro di origine è pronto per l'invio di nuovi dati, viene chiamato [**Ipin:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) sul pin di input.</span><span class="sxs-lookup"><span data-stu-id="04149-117">When the source filter is ready to send new data, it calls [**IPin::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) on the input pin.</span></span> <span data-ttu-id="04149-118">Viene segnalato il filtro downstream che può ricevere nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="04149-118">This signals the downstream filter that it can receive new samples.</span></span> <span data-ttu-id="04149-119">Il filtro downstream Invia la chiamata **EndFlush** al filtro successivo.</span><span class="sxs-lookup"><span data-stu-id="04149-119">The downstream filter sends the **EndFlush** call to the next filter.</span></span>

<span data-ttu-id="04149-120">Nel metodo **BeginFlush** , il pin di input esegue le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="04149-120">In the **BeginFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="04149-121">Chiama **BeginFlush** nei pin di input downstream.</span><span class="sxs-lookup"><span data-stu-id="04149-121">Calls **BeginFlush** on downstream input pins.</span></span>
2.  <span data-ttu-id="04149-122">Rifiuta qualsiasi altra chiamata che esegue il flusso dei dati, inclusi **Receive** e **EndOfStream**.</span><span class="sxs-lookup"><span data-stu-id="04149-122">Rejects any further calls that stream data, including **Receive** and **EndOfStream**.</span></span>
3.  <span data-ttu-id="04149-123">Sblocca tutti i filtri upstream che sono bloccati in attesa di un campione dall'allocatore del filtro.</span><span class="sxs-lookup"><span data-stu-id="04149-123">Unblocks any upstream filters that are blocked waiting for a sample from the filter's allocator.</span></span> <span data-ttu-id="04149-124">Alcuni filtri decommitno gli allocatori a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="04149-124">Some filters decommit their allocators for this purpose.</span></span>
4.  <span data-ttu-id="04149-125">Esce dalle attese che bloccano il flusso.</span><span class="sxs-lookup"><span data-stu-id="04149-125">Exits from any waits that block streaming.</span></span> <span data-ttu-id="04149-126">Ad esempio, i filtri renderer vengono bloccati quando vengono sospesi.</span><span class="sxs-lookup"><span data-stu-id="04149-126">For example, renderer filters block when paused.</span></span> <span data-ttu-id="04149-127">Si bloccano anche quando sono in attesa di eseguire il rendering di un campione nel momento in cui il flusso è corretto.</span><span class="sxs-lookup"><span data-stu-id="04149-127">They also block when they are waiting to render a sample at the correct stream time.</span></span> <span data-ttu-id="04149-128">Il filtro deve essere sbloccato, in modo che gli esempi in coda upstream possano essere recapitati e rifiutati.</span><span class="sxs-lookup"><span data-stu-id="04149-128">The filter must unblock, so that samples queued upstream can be delivered and rejected.</span></span> <span data-ttu-id="04149-129">Questo passaggio garantisce che tutti i filtri upstream si blocchino.</span><span class="sxs-lookup"><span data-stu-id="04149-129">This step ensures that all upstream filters eventually unblock.</span></span>

<span data-ttu-id="04149-130">Nel metodo **EndFlush** , il pin di input esegue le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="04149-130">In the **EndFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="04149-131">Attende che tutti gli esempi in coda vengano rimossi.</span><span class="sxs-lookup"><span data-stu-id="04149-131">Waits for all queued samples to be discarded.</span></span>
2.  <span data-ttu-id="04149-132">Libera tutti i dati memorizzati nel buffer.</span><span class="sxs-lookup"><span data-stu-id="04149-132">Frees any buffered data.</span></span> <span data-ttu-id="04149-133">Questo passaggio può essere eseguito a volte nel metodo **BeginFlush** .</span><span class="sxs-lookup"><span data-stu-id="04149-133">This step can sometimes be performed in the **BeginFlush** method.</span></span> <span data-ttu-id="04149-134">Tuttavia, **BeginFlush** non è sincronizzato con il thread di streaming.</span><span class="sxs-lookup"><span data-stu-id="04149-134">However, **BeginFlush** is not synchronized with the streaming thread.</span></span> <span data-ttu-id="04149-135">Il filtro non deve elaborare o memorizzare nel buffer più dati tra la chiamata a **BeginFlush** e la chiamata a **EndFlush**.</span><span class="sxs-lookup"><span data-stu-id="04149-135">The filter must not process or buffer any more data between the call to **BeginFlush** and the call to **EndFlush**.</span></span>
3.  <span data-ttu-id="04149-136">Cancella le notifiche complete di EC in sospeso \_ .</span><span class="sxs-lookup"><span data-stu-id="04149-136">Clears any pending EC\_COMPLETE notifications.</span></span>
4.  <span data-ttu-id="04149-137">Chiama **EndFlush** downstream.</span><span class="sxs-lookup"><span data-stu-id="04149-137">Calls **EndFlush** downstream.</span></span>

<span data-ttu-id="04149-138">A questo punto, il filtro può accettare nuovamente i campioni.</span><span class="sxs-lookup"><span data-stu-id="04149-138">At this point, the filter can accept samples again.</span></span> <span data-ttu-id="04149-139">Tutti gli esempi sono sicuramente più recenti dello scaricamento.</span><span class="sxs-lookup"><span data-stu-id="04149-139">All samples are guaranteed to be more recent than the flush.</span></span>

<span data-ttu-id="04149-140">Nel modello pull il filtro del parser avvia lo scaricamento, anziché il filtro di origine.</span><span class="sxs-lookup"><span data-stu-id="04149-140">In the pull model, the parser filter initiates flushing, rather than the source filter.</span></span> <span data-ttu-id="04149-141">Non solo chiama **Ipin:: BeginFlush** e **Ipin:: EndFlush** sul filtro downstream, chiama anche [**IAsyncReader:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) e [**IAsyncReader:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) sul pin di *output* del filtro di origine.</span><span class="sxs-lookup"><span data-stu-id="04149-141">Not only does it call **IPin::BeginFlush** and **IPin::EndFlush** on the downstream filter, it also calls [**IAsyncReader::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) and [**IAsyncReader::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) on the *output* pin of the source filter.</span></span> <span data-ttu-id="04149-142">Se il filtro di origine ha richieste di lettura in sospeso, le ignorerà.</span><span class="sxs-lookup"><span data-stu-id="04149-142">If the source filter has pending read requests, it will discard them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="04149-143">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="04149-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="04149-144">Scaricamento dei dati</span><span class="sxs-lookup"><span data-stu-id="04149-144">Flushing Data</span></span>](flushing-data.md)
</dt> </dl>

 

 



