---
description: Orologi di riferimento
ms.assetid: 43f1a4d6-dbed-4940-a301-d863ddd34bce
title: Orologi di riferimento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9b958787f4dbdb20cd595b10cf486f59222a072
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "106303902"
---
# <a name="reference-clocks"></a><span data-ttu-id="fe500-103">Orologi di riferimento</span><span class="sxs-lookup"><span data-stu-id="fe500-103">Reference Clocks</span></span>

<span data-ttu-id="fe500-104">Una funzione del gestore del grafo del filtro è la sincronizzazione di tutti i filtri nel grafico con lo stesso clock, denominato *clock di riferimento*.</span><span class="sxs-lookup"><span data-stu-id="fe500-104">One function of the Filter Graph Manager is to synchronize all of the filters in the graph to the same clock, called the *reference clock*.</span></span>

<span data-ttu-id="fe500-105">Qualsiasi oggetto che espone l'interfaccia [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) può fungere da orologio di riferimento.</span><span class="sxs-lookup"><span data-stu-id="fe500-105">Any object that exposes the [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) interface can act as the reference clock.</span></span> <span data-ttu-id="fe500-106">L'orologio di riferimento potrebbe essere fornito da un filtro DirectShow, in genere il renderer audio, che ha accesso a un timer hardware.</span><span class="sxs-lookup"><span data-stu-id="fe500-106">The reference clock might be provided by a DirectShow filter—typically the audio renderer, which has access to a hardware timer.</span></span> <span data-ttu-id="fe500-107">Come fallback, il gestore del grafo del filtro può utilizzare l'ora di sistema.</span><span class="sxs-lookup"><span data-stu-id="fe500-107">As a fallback, the Filter Graph Manager can use the system time.</span></span>

<span data-ttu-id="fe500-108">Nominalmente, un orologio di riferimento misura il tempo in intervalli di 100 nanosecondi, sebbene l'accuratezza effettiva dell'orologio potrebbe essere minore.</span><span class="sxs-lookup"><span data-stu-id="fe500-108">Nominally, a reference clock measures time in 100-nanosecond intervals, although the actual accuracy of the clock might be less.</span></span> <span data-ttu-id="fe500-109">Per recuperare l'ora corrente del clock, chiamare il metodo [**IReferenceClock:: GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) .</span><span class="sxs-lookup"><span data-stu-id="fe500-109">To retrieve the clock's current time, call the [**IReferenceClock::GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method.</span></span> <span data-ttu-id="fe500-110">La linea di base del clock, ovvero l'ora da cui inizia il conteggio, dipende dall'implementazione, quindi il valore restituito da **getTime** non è intrinsecamente significativo.</span><span class="sxs-lookup"><span data-stu-id="fe500-110">The clock's baseline—the time from which it starts counting—depends on the implementation, so the value returned by **GetTime** is not inherently meaningful.</span></span> <span data-ttu-id="fe500-111">Ciò che conta è il Delta rispetto all'avvio dell'esecuzione del grafico.</span><span class="sxs-lookup"><span data-stu-id="fe500-111">What matters is the delta from when the graph started running.</span></span>

<span data-ttu-id="fe500-112">Sebbene l'accuratezza di un clock di riferimento possa variare, le ore restituite dal metodo [**getTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) sono garantite per un aumento progressivo costante.</span><span class="sxs-lookup"><span data-stu-id="fe500-112">Although the accuracy of a reference clock can vary, the times returned by the [**GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method are guaranteed to increase monotonically.</span></span> <span data-ttu-id="fe500-113">In altre parole, i tempi di clock non verranno mai superati.</span><span class="sxs-lookup"><span data-stu-id="fe500-113">In other words, clock times will never go backward.</span></span> <span data-ttu-id="fe500-114">Se un orologio di riferimento genera tempi di clock da un'origine hardware e il clock dell'hardware viene interrotto indietro (ad esempio, se è presente una regolazione dell'orologio), il metodo **getTime** deve continuare a restituire l'ora dell'ultimo report fino a quando l'orologio hardware non viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="fe500-114">If a reference clock is generating clock times from a hardware source and the hardware clock jumps backward (for example, if there is an adjustment to the clock), the **GetTime** method should continue to return the last reported time until the hardware clock catches up.</span></span> <span data-ttu-id="fe500-115">Per ulteriori informazioni, vedere la [**classe CBaseReferenceClock**](cbasereferenceclock.md).</span><span class="sxs-lookup"><span data-stu-id="fe500-115">For more information, see [**CBaseReferenceClock Class**](cbasereferenceclock.md).</span></span>

<span data-ttu-id="fe500-116">**Clock di riferimento predefinito**</span><span class="sxs-lookup"><span data-stu-id="fe500-116">**Default Reference Clock**</span></span>

<span data-ttu-id="fe500-117">Il gestore del grafico dei filtri seleziona automaticamente un orologio di riferimento quando il grafico viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="fe500-117">The Filter Graph Manager automatically selects a reference clock when the graph runs.</span></span> <span data-ttu-id="fe500-118">Usa l'algoritmo seguente per selezionare il clock:</span><span class="sxs-lookup"><span data-stu-id="fe500-118">It uses the following algorithm to select the clock:</span></span>

-   <span data-ttu-id="fe500-119">Se l'applicazione ha selezionato un clock (vedere di seguito), usare tale clock.</span><span class="sxs-lookup"><span data-stu-id="fe500-119">If the application has selected a clock (see below), use that clock.</span></span>
-   <span data-ttu-id="fe500-120">Se il grafico contiene un filtro di origine live che supporta [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), usare tale filtro.</span><span class="sxs-lookup"><span data-stu-id="fe500-120">If the graph contains a live source filter that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), use that filter.</span></span> <span data-ttu-id="fe500-121">Per la definizione di un'origine live, vedere [Live](live-sources.md)sources.</span><span class="sxs-lookup"><span data-stu-id="fe500-121">For the definition of a live source, see [Live Sources](live-sources.md).</span></span>
-   <span data-ttu-id="fe500-122">Se il grafico non contiene filtri di origine attivi, usare qualsiasi filtro nel grafico che supporta [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), a partire dai renderer e lavorando a Monte.</span><span class="sxs-lookup"><span data-stu-id="fe500-122">If the graph does NOT contain any live source filters, use any filter in the graph that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), starting from the renderers and working upstream.</span></span> <span data-ttu-id="fe500-123">Preferisce i filtri connessi su filtri non connessi.</span><span class="sxs-lookup"><span data-stu-id="fe500-123">Prefer connected filters over unconnected filters.</span></span> <span data-ttu-id="fe500-124">Se il grafico sta eseguendo il rendering di un flusso audio, questo passaggio nell'algoritmo normalmente selezionerà il filtro renderer audio.</span><span class="sxs-lookup"><span data-stu-id="fe500-124">(If the graph is rendering an audio stream, this step in the algorithm will normally select the audio renderer filter.)</span></span>
-   <span data-ttu-id="fe500-125">Se nessun filtro fornisce un clock appropriato, utilizzare l' [orologio di riferimento del sistema](system-reference-clock.md), basato sull'ora di sistema.</span><span class="sxs-lookup"><span data-stu-id="fe500-125">If no filter provides a suitable clock, use the [System Reference Clock](system-reference-clock.md), which is based on the system time.</span></span>

<span data-ttu-id="fe500-126">**Impostazione dell'orologio di riferimento**</span><span class="sxs-lookup"><span data-stu-id="fe500-126">**Setting the Reference Clock**</span></span>

<span data-ttu-id="fe500-127">Un'applicazione può selezionare un clock chiamando il metodo [**IMediaFilter:: SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) in gestione grafico dei filtri.</span><span class="sxs-lookup"><span data-stu-id="fe500-127">An application can select a clock by calling the [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method on the Filter Graph Manager.</span></span> <span data-ttu-id="fe500-128">Questa operazione deve essere eseguita solo se si dispone di un motivo specifico per preferire un altro Clock.</span><span class="sxs-lookup"><span data-stu-id="fe500-128">You should do this only if you have a particular reason to prefer another clock.</span></span>

<span data-ttu-id="fe500-129">È possibile indicare a Filter Graph Manager di non usare un clock di riferimento chiamando [**SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) con il valore **null**.</span><span class="sxs-lookup"><span data-stu-id="fe500-129">You can instruct the Filter Graph Manager not to use a reference clock by calling [**SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) with the value **NULL**.</span></span> <span data-ttu-id="fe500-130">Ad esempio, è possibile eseguire questa operazione per elaborare i campioni il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="fe500-130">For example, you might do this to process samples as quickly as possible.</span></span> <span data-ttu-id="fe500-131">Per ripristinare l'orologio di riferimento predefinito, chiamare il metodo [**IFilterGraph:: SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) in gestione grafico dei filtri.</span><span class="sxs-lookup"><span data-stu-id="fe500-131">To restore the default reference clock, call the [**IFilterGraph::SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) method on the Filter Graph Manager.</span></span>

<span data-ttu-id="fe500-132">Ogni volta che viene modificato l'orologio di riferimento, il gestore del grafico dei filtri invia una notifica a ogni filtro chiamando il metodo [**IMediaFilter:: SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) .</span><span class="sxs-lookup"><span data-stu-id="fe500-132">Whenever the reference clock changes, the Filter Graph Manager notifies each filter by calling its [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method.</span></span> <span data-ttu-id="fe500-133">Le applicazioni non devono mai chiamare questo metodo sui filtri.</span><span class="sxs-lookup"><span data-stu-id="fe500-133">Applications should never call this method on filters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fe500-134">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="fe500-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fe500-135">Impostazione del clock del grafico</span><span class="sxs-lookup"><span data-stu-id="fe500-135">Setting the Graph Clock</span></span>](setting-the-graph-clock.md)
</dt> <dt>

[<span data-ttu-id="fe500-136">Time and Clocks in DirectShow</span><span class="sxs-lookup"><span data-stu-id="fe500-136">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



