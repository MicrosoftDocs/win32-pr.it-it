---
description: Timestamp
ms.assetid: 445fe6b9-9d5b-45fd-9c9e-8c632c5228ae
title: Timestamp
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 855d2c472d7964ccad6ec8bbc87efd39b1c4cdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/08/2021
ms.locfileid: "106319547"
---
# <a name="time-stamps"></a><span data-ttu-id="52e67-103">Timestamp</span><span class="sxs-lookup"><span data-stu-id="52e67-103">Time Stamps</span></span>

<span data-ttu-id="52e67-104">Il *timestamp* definisce l'ora di inizio e di fine di un campione multimediale, misurata nel tempo del flusso.</span><span class="sxs-lookup"><span data-stu-id="52e67-104">The *time stamp* defines a media sample's start and finish times, measured in stream time.</span></span> <span data-ttu-id="52e67-105">Il timestamp viene talvolta definito ora di *presentazione*.</span><span class="sxs-lookup"><span data-stu-id="52e67-105">The time stamp is sometimes called the *presentation time*.</span></span> <span data-ttu-id="52e67-106">Quando si legge la parte restante di questo articolo, è importante ricordare che non tutti i formati usano i timestamp nello stesso modo.</span><span class="sxs-lookup"><span data-stu-id="52e67-106">When reading the rest of this article, it is important to remember that not all formats use time stamps in the same way.</span></span> <span data-ttu-id="52e67-107">Ad esempio, non tutti gli esempi MPEG hanno un timestamp.</span><span class="sxs-lookup"><span data-stu-id="52e67-107">For example, not all MPEG samples are time stamped.</span></span> <span data-ttu-id="52e67-108">Nei grafici di filtro MPEG, il timestamp non viene applicato a ogni frame fino a quando non vengono restituiti dal decodificatore.</span><span class="sxs-lookup"><span data-stu-id="52e67-108">In MPEG filter graphs, the time stamp is not applied to each frame until they are output from the decoder.</span></span>

<span data-ttu-id="52e67-109">Quando un filtro renderer riceve un campione, Pianifica il rendering in base al timestamp.</span><span class="sxs-lookup"><span data-stu-id="52e67-109">When a renderer filter receives a sample, it schedules rendering based on the time stamp.</span></span> <span data-ttu-id="52e67-110">Se l'esempio arriva in ritardo o non ha timestamp, il filtro esegue immediatamente il rendering dell'esempio.</span><span class="sxs-lookup"><span data-stu-id="52e67-110">If the sample arrives late, or has no time stamp, the filter renders the sample immediately.</span></span> <span data-ttu-id="52e67-111">In caso contrario, il filtro attende fino all'ora di inizio dell'esempio prima di eseguire il rendering dell'esempio.</span><span class="sxs-lookup"><span data-stu-id="52e67-111">Otherwise, the filter waits until the sample's start time before it renders the sample.</span></span> <span data-ttu-id="52e67-112">Attende l'ora di inizio chiamando il metodo [**IReferenceClock:: AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) .</span><span class="sxs-lookup"><span data-stu-id="52e67-112">(It waits for the start time by calling the [**IReferenceClock::AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) method.)</span></span>

<span data-ttu-id="52e67-113">I filtri di origine e i filtri del parser sono responsabili dell'impostazione dei timestamp corretti sugli esempi che elaborano.</span><span class="sxs-lookup"><span data-stu-id="52e67-113">Source filters and parser filters are responsible for setting the correct time stamps on the samples they process.</span></span> <span data-ttu-id="52e67-114">Usare le linee guida seguenti.</span><span class="sxs-lookup"><span data-stu-id="52e67-114">Use the following guidelines.</span></span>

-   <span data-ttu-id="52e67-115">Riproduzione di file: il primo campione è il timestamp con l'ora di inizio zero.</span><span class="sxs-lookup"><span data-stu-id="52e67-115">File playback: The first sample is time stamped with a start time of zero.</span></span> <span data-ttu-id="52e67-116">I timestamp successivi sono determinati dalla lunghezza del campione e dalla velocità di riproduzione, che a sua volta è determinata dal formato del file.</span><span class="sxs-lookup"><span data-stu-id="52e67-116">Subsequent time stamps are determined by the sample length and the playback rate, which itself is determined by the file format.</span></span> <span data-ttu-id="52e67-117">Il filtro che analizza il file è responsabile del calcolo dei timestamp corretti (ad esempio, il [separatore AVI](avi-splitter-filter.md)).</span><span class="sxs-lookup"><span data-stu-id="52e67-117">The filter that parses the file is responsible for calculating the correct time stamps (for example, the [AVI Splitter](avi-splitter-filter.md)).</span></span>
-   <span data-ttu-id="52e67-118">Acquisizione video e audio: ogni campione ha un timestamp con un'ora di inizio uguale all'ora del flusso in cui è stato acquisito, con le avvertenze seguenti:</span><span class="sxs-lookup"><span data-stu-id="52e67-118">Video and audio capture: Every sample is time stamped with a start time equal to the stream time when it was captured, with the following caveats:</span></span>
    -   <span data-ttu-id="52e67-119">I fotogrammi video di un pin di anteprima, anziché un pin di acquisizione, non hanno un timestamp.</span><span class="sxs-lookup"><span data-stu-id="52e67-119">Video frames from a preview pin (as opposed to a capture pin) are not time stamped.</span></span> <span data-ttu-id="52e67-120">A causa della latenza del grafo, un frame video timbrato con il tempo di acquisizione arriverà sempre in ritardo nel renderer video.</span><span class="sxs-lookup"><span data-stu-id="52e67-120">Because of graph latency, a video frame that is stamped with the capture time will always arrive late at the video renderer.</span></span> <span data-ttu-id="52e67-121">Questo può causare l'eliminazione dei frame dal renderer, in un tentativo di controllo della qualità.</span><span class="sxs-lookup"><span data-stu-id="52e67-121">This may cause the renderer to drop frames, in an attempt at quality control.</span></span> <span data-ttu-id="52e67-122">Per informazioni sul controllo della qualità, vedere [gestione del controllo di qualità](quality-control-management.md).</span><span class="sxs-lookup"><span data-stu-id="52e67-122">For information about quality control, see [Quality-Control Management](quality-control-management.md).</span></span>
    -   <span data-ttu-id="52e67-123">Acquisizione audio: il filtro di acquisizione audio utilizza un proprio set di buffer distinti da quelli utilizzati dal driver audio.</span><span class="sxs-lookup"><span data-stu-id="52e67-123">Audio capture: The audio capture filter uses its own set of buffers, which are separate from those used by the audio driver.</span></span> <span data-ttu-id="52e67-124">Il driver audio riempie i buffer del filtro di acquisizione a intervalli fissi.</span><span class="sxs-lookup"><span data-stu-id="52e67-124">The audio driver fills the capture filter's buffers at fixed intervals.</span></span> <span data-ttu-id="52e67-125">L'intervallo dipende dal driver, ma in genere non supera i 10 millisecondi.</span><span class="sxs-lookup"><span data-stu-id="52e67-125">The interval depends on the driver, but generally is not more than 10 milliseconds.</span></span> <span data-ttu-id="52e67-126">Il timestamp degli esempi audio riflette l'ora in cui il driver ha riempito i buffer del filtro di acquisizione audio.</span><span class="sxs-lookup"><span data-stu-id="52e67-126">The time stamps on the audio samples reflect the time when the driver filled the audio capture filter's buffers.</span></span> <span data-ttu-id="52e67-127">Questi tempi possono essere leggermente non accurati, soprattutto se l'applicazione usa una dimensione del buffer molto piccola.</span><span class="sxs-lookup"><span data-stu-id="52e67-127">These times can be slightly inaccurate, especially if the application is using a very small buffer size.</span></span> <span data-ttu-id="52e67-128">Tuttavia, i tempi dei supporti rifletteranno in modo accurato il numero di campioni audio nel buffer.</span><span class="sxs-lookup"><span data-stu-id="52e67-128">However, the media times will accurately reflect the number audio samples in the buffer.</span></span>
-   <span data-ttu-id="52e67-129">Filtri Mux: a seconda del formato di output, è possibile che un filtro Mux debba generare timestamp, altrimenti potrebbe non essere possibile.</span><span class="sxs-lookup"><span data-stu-id="52e67-129">Mux filters: Depending on the output format, a mux filter may need to generate time stamps, or it may not.</span></span> <span data-ttu-id="52e67-130">Ad esempio, il formato di file AVI usa una frequenza dei fotogrammi fissa senza timestamp, quindi il filtro [Mux AVI](avi-mux-filter.md) presuppone che gli esempi arrivino approssimativamente al momento giusto.</span><span class="sxs-lookup"><span data-stu-id="52e67-130">For example, the AVI file format uses a fixed frame rate with no time stamps, so the [AVI Mux](avi-mux-filter.md) filter assumes that samples are arriving at approximately the right time.</span></span> <span data-ttu-id="52e67-131">Se i timestamp in ingresso mostrano un gap più grande di un frame, tuttavia, il mux AVI scrive una voce di indice con dimensioni pari a zero per indicare un frame eliminato.</span><span class="sxs-lookup"><span data-stu-id="52e67-131">If the incoming time stamps show a gap larger than one frame, however, the AVI Mux writes an index entry with size zero, to indicate a dropped frame.</span></span> <span data-ttu-id="52e67-132">Al momento della riproduzione, i nuovi timestamp vengono generati in fase di esecuzione, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="52e67-132">On file playback, new time stamps are generated at run time, as described previously.</span></span>

<span data-ttu-id="52e67-133">Per impostare il timestamp per un esempio, chiamare il metodo [**IMediaSample:: setime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) .</span><span class="sxs-lookup"><span data-stu-id="52e67-133">To set the time stamp on a sample, call the [**IMediaSample::SetTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) method.</span></span>

<span data-ttu-id="52e67-134">**Tempi dei supporti**</span><span class="sxs-lookup"><span data-stu-id="52e67-134">**Media Times**</span></span>

<span data-ttu-id="52e67-135">Facoltativamente, il filtro può specificare anche un *tempo di supporto* per l'esempio.</span><span class="sxs-lookup"><span data-stu-id="52e67-135">Optionally, the filter can also specify a *media time* for the sample.</span></span> <span data-ttu-id="52e67-136">In un flusso video, il tempo multimediale rappresenta il numero di frame.</span><span class="sxs-lookup"><span data-stu-id="52e67-136">In a video stream, media time represents the frame number.</span></span> <span data-ttu-id="52e67-137">In un flusso audio, media time rappresenta il numero di campione nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="52e67-137">In an audio stream, media time represents the sample number in the packet.</span></span> <span data-ttu-id="52e67-138">Se, ad esempio, ogni pacchetto contiene un secondo di audio 44,1 kilohertz (kHz), il primo pacchetto ha un'ora di inizio del supporto pari a zero e un tempo di arresto del supporto pari a 44100.</span><span class="sxs-lookup"><span data-stu-id="52e67-138">For example, if each packet contains one second of 44.1 kilohertz (kHz) audio, the first packet has a media start time of zero and a media stop time of 44100.</span></span> <span data-ttu-id="52e67-139">In un flusso ricercabile, il tempo dei supporti è sempre relativo all'ora di inizio del flusso.</span><span class="sxs-lookup"><span data-stu-id="52e67-139">In a seekable stream, the media time is always relative to the start time of the stream.</span></span> <span data-ttu-id="52e67-140">Si supponga, ad esempio, di dover cercare 2 secondi dall'inizio di un flusso video di 15 fps.</span><span class="sxs-lookup"><span data-stu-id="52e67-140">For example, suppose you seek to 2 seconds from the start of a 15-fps video stream.</span></span> <span data-ttu-id="52e67-141">Il primo campione multimediale dopo la ricerca ha un timestamp di zero, ma un tempo medio pari a 30.</span><span class="sxs-lookup"><span data-stu-id="52e67-141">The first media sample after the seek has a time stamp of zero but a media time of 30.</span></span>

<span data-ttu-id="52e67-142">I filtri renderer e MUX possono usare il tempo dei supporti per determinare se i frame o gli esempi sono stati eliminati, verificando la presenza di Gap.</span><span class="sxs-lookup"><span data-stu-id="52e67-142">Renderer and mux filters can use the media time to determine whether frames or samples have been dropped, by checking for gaps.</span></span> <span data-ttu-id="52e67-143">Tuttavia, i filtri non sono necessari per impostare il tempo del supporto.</span><span class="sxs-lookup"><span data-stu-id="52e67-143">However, filters are not required to set the media time.</span></span> <span data-ttu-id="52e67-144">Per impostare il tempo del supporto per un esempio, chiamare il metodo [**IMediaSample:: SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) .</span><span class="sxs-lookup"><span data-stu-id="52e67-144">To set the media time on a sample, call the [**IMediaSample::SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="52e67-145">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="52e67-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="52e67-146">Time and Clocks in DirectShow</span><span class="sxs-lookup"><span data-stu-id="52e67-146">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



