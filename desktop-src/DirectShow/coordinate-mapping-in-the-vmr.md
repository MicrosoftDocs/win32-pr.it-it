---
description: Mapping delle coordinate in VMR
ms.assetid: f0821b90-51d1-4e77-8aed-04337a3dd623
title: Mapping delle coordinate in VMR
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c18b38249471e6e68e36f1b9051f51e920f62b31
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "103876237"
---
# <a name="coordinate-mapping-in-the-vmr"></a><span data-ttu-id="e1c78-103">Mapping delle coordinate in VMR</span><span class="sxs-lookup"><span data-stu-id="e1c78-103">Coordinate Mapping in the VMR</span></span>

<span data-ttu-id="e1c78-104">In questa sezione vengono descritte le cinque trasformazioni applicate a un'immagine di origine prima che venga eseguito il mapping di VMR nell'immagine di output finale.</span><span class="sxs-lookup"><span data-stu-id="e1c78-104">This section describes the five transformations that are applied to a source image before it is mapped by the VMR onto the final output image.</span></span>

1.  <span data-ttu-id="e1c78-105">La trasformazione *T (src)* esegue il mapping del rettangolo di origine al rettangolo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="e1c78-105">The transformation *T(Src)* maps the source rectangle to the destination rectangle.</span></span> <span data-ttu-id="e1c78-106">Questi vengono specificati dai membri **rcSource** e **RcTarget** della struttura [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) o [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) nel tipo di supporto.</span><span class="sxs-lookup"><span data-stu-id="e1c78-106">These are specified by the **rcSource** and **rcTarget** members of the [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) or [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) structure in the media type.</span></span> <span data-ttu-id="e1c78-107">Questo mapping pre-elabora l'immagine di origine mentre passa a VMR.</span><span class="sxs-lookup"><span data-stu-id="e1c78-107">This mapping preprocesses the source image as it passes to the VMR.</span></span>
2.  <span data-ttu-id="e1c78-108">La trasformazione *T (flag)* esegue tutte le modifiche alle immagini specificate dai flag nell'esempio multimediale.</span><span class="sxs-lookup"><span data-stu-id="e1c78-108">The transformation *T(Flag)* performs any image manipulations specified by flags in the media sample.</span></span> <span data-ttu-id="e1c78-109">Incluse le trasformazioni, ad esempio la traslazione verticale e la scalabilità, per contenere i flag interlacci Bob.</span><span class="sxs-lookup"><span data-stu-id="e1c78-109">These included transformations such as the vertical translation and scale to accommodate the bob interlace flags.</span></span> <span data-ttu-id="e1c78-110">La trasformazione interlacciata raddoppia l'altezza dell'immagine e possibilmente converte l'immagine dalla metà di una linea video se si trova nel campo dispari.</span><span class="sxs-lookup"><span data-stu-id="e1c78-110">The interlace transformation doubles the image height and possibly translates the image by half of a video line if it is in the odd field.</span></span>
3.  <span data-ttu-id="e1c78-111">La trasformazione *T (AR)* regola l'immagine in pixel quadrati, in base alle proporzioni dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="e1c78-111">The transformation *T(AR)* adjusts the image to square pixels, based on the image aspect ratio.</span></span> <span data-ttu-id="e1c78-112">Per i tipi di supporto **VIDEOINFOHEADER** , le proporzioni sono determinate dalle dimensioni dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="e1c78-112">For **VIDEOINFOHEADER** media types, the aspect ratio is determined by the image size.</span></span> <span data-ttu-id="e1c78-113">Per i tipi **VIDEOINFOHEADER2** , le proporzioni sono determinate dai campi **dwPictAspectRatioX** e **dwPictAspectRatioY** , a meno che non \_ \_ siano impostati i flag AMCONTROL su \_ 16x9 o AMCONTROL \_ Pad \_ per 4x3 \_ .</span><span class="sxs-lookup"><span data-stu-id="e1c78-113">For **VIDEOINFOHEADER2** types, the aspect ratio is determined by the **dwPictAspectRatioX** and **dwPictAspectRatioY** fields, unless the AMCONTROL\_PAD\_TO\_16x9 or AMCONTROL\_PAD\_TO\_4x3 flags are set.</span></span> <span data-ttu-id="e1c78-114">Questa trasformazione presuppone che l'impostazione di visualizzazione del monitoraggio corrisponda alle proporzioni fisiche del monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="e1c78-114">This transformation assumes that the monitor display setting matches the physical aspect ratio of the monitor.</span></span> <span data-ttu-id="e1c78-115">Se, ad esempio, l'utente dispone di un monitoraggio con proporzioni di 4 x 3, ma imposta la visualizzazione su 1280 x 768 pixel (5 x 3), l'immagine non avrà le proporzioni corrette.</span><span class="sxs-lookup"><span data-stu-id="e1c78-115">For example, if the user has a monitor with 4 x 3 aspect ratio, but sets the display to 1280 x 768 pixels (5 x 3), the image will not have the correct aspect ratio.</span></span>
4.  <span data-ttu-id="e1c78-116">La trasformazione *T (Mix)* trasforma l'immagine all'interno dell'immagine di destinazione usando i rettangoli normalizzati specificati nei metodi [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) .</span><span class="sxs-lookup"><span data-stu-id="e1c78-116">The transformation *T(Mix)* transforms positions the image within the destination image, using the normalized rectangles specified in the [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) methods.</span></span> <span data-ttu-id="e1c78-117">I rettangoli normalizzati consentono all'applicazione di organizzare il modo in cui i flussi di origine sono posizionati e ridimensionati in relazione l'uno con l'altro.</span><span class="sxs-lookup"><span data-stu-id="e1c78-117">The normalized rectangles enable the application to organize how the source streams are positioned and scaled relative to each other.</span></span> <span data-ttu-id="e1c78-118">VMR calcola l'immagine di destinazione calcolando le dimensioni massime di tutte le immagini di origine e centrando ciascuna di esse all'interno di un rettangolo di delimitazione globale.</span><span class="sxs-lookup"><span data-stu-id="e1c78-118">The VMR computes the destination image by computing the maximum dimensions of all the source images and centering each inside an overall bounding rectangle.</span></span> <span data-ttu-id="e1c78-119">Agli angoli del rettangolo di delimitazione viene assegnato l'intervallo (0, 0) a (1,1).</span><span class="sxs-lookup"><span data-stu-id="e1c78-119">The corners of the bounding rectangle are assigned the range (0,0) to (1,1).</span></span> <span data-ttu-id="e1c78-120">Il rettangolo di delimitazione viene corretto prima dell'esecuzione del grafico e rimane costante anche se i flussi vengono aggiunti o eliminati.</span><span class="sxs-lookup"><span data-stu-id="e1c78-120">The bounding rectangle is fixed before the graph runs and remains constant even if streams are added or deleted.</span></span> <span data-ttu-id="e1c78-121">I rettangoli di destinazione per ogni flusso possono trovarsi all'esterno dell'intervallo (0, 0) a (1,1) e comunque essere validi.</span><span class="sxs-lookup"><span data-stu-id="e1c78-121">Destination rectangles for each stream can lie outside of the range (0,0) to (1,1) and still be valid.</span></span>
5.  <span data-ttu-id="e1c78-122">Infine, una parte dell'immagine mista può essere trasformata dal mapping *T (DST)*, specificato dai rettangoli di origine e di destinazione nell'interfaccia [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) in VMR.</span><span class="sxs-lookup"><span data-stu-id="e1c78-122">Finally, a portion of the mixed image can be transformed by the mapping *T(Dst)*, specified by the source and destination rectangles in the [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) interface on the VMR.</span></span> <span data-ttu-id="e1c78-123">Se il Allocator-Presenter viene sostituito e l'interfaccia **IBasicVideo** non viene usata, l'applicazione deve implementare l'interfaccia [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) ed eseguire il mapping delle coordinate in uno spazio lineare 2D.</span><span class="sxs-lookup"><span data-stu-id="e1c78-123">If the Allocator-Presenter is replaced and the **IBasicVideo** interface is not used, the application must implement the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface and map the coordinates back into a 2D linear space.</span></span> <span data-ttu-id="e1c78-124">Anche le coordinate del mouse restituite al navigatore DVD devono trovarsi in questo spazio.</span><span class="sxs-lookup"><span data-stu-id="e1c78-124">The mouse coordinates returned to the DVD navigator must also be in this space.</span></span> <span data-ttu-id="e1c78-125">Se, ad esempio, un'applicazione esegue il rendering di video su un cubo rotante, restituirà l'intero schermo per il controllo senza finestra e restituirà le coordinate del mouse relative alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e1c78-125">For example, if an application renders video onto a spinning cube, they would report back the entire display for the windowless control and return mouse coordinates relative to the display.</span></span>

<span data-ttu-id="e1c78-126">La trasformazione complessiva dell'immagine dai dati di origine al renderer finale è la seguente:</span><span class="sxs-lookup"><span data-stu-id="e1c78-126">The overall image transformation from the source data to the final renderer is:</span></span>

<span data-ttu-id="e1c78-127">T = T (src) \* t (flag) t (AR) t (Mix) \* t (DST)\*</span><span class="sxs-lookup"><span data-stu-id="e1c78-127">T = T(Src)\* T(Flag)T(Ar)T(Mix)\* T(Dst)\*</span></span>

<span data-ttu-id="e1c78-128">dove \* indica che l'immagine può essere ritagliata nell'immagine di destinazione in quella fase.</span><span class="sxs-lookup"><span data-stu-id="e1c78-128">where \* indicates that the image could be clipped to the destination image at that stage.</span></span> <span data-ttu-id="e1c78-129">Si noti che si tratta di tutte le trasformazioni affini, quindi il VMR può combinarle in un'unica trasformazione.</span><span class="sxs-lookup"><span data-stu-id="e1c78-129">Note that these are all affine transformations, so the VMR can combine them into a single transformation.</span></span>

<span data-ttu-id="e1c78-130">L'inverso della trasformazione è:</span><span class="sxs-lookup"><span data-stu-id="e1c78-130">The inverse of the transformation is:</span></span>

![trasformazione inversa](images/vmrmapping-t-1.png)

<span data-ttu-id="e1c78-132">Il fattore T (src) T (flag) T (AR) è relativo alla risoluzione dell'origine.</span><span class="sxs-lookup"><span data-stu-id="e1c78-132">The factor T(Src) T(Flag) T(Ar) is relative to the source resolution.</span></span> <span data-ttu-id="e1c78-133">In Factor T (Mix) il rettangolo di origine normalizzato è relativo all'immagine con correzione dell'aspetto.</span><span class="sxs-lookup"><span data-stu-id="e1c78-133">In the factor T(Mix), the normalized source rectangle is relative to the aspect-corrected image.</span></span> <span data-ttu-id="e1c78-134">Il rettangolo di destinazione normalizzato è relativo alla risoluzione dell'output.</span><span class="sxs-lookup"><span data-stu-id="e1c78-134">The normalized destination rectangle is relative to the output resolution.</span></span> <span data-ttu-id="e1c78-135">Nel diagramma seguente vengono illustrate queste relazioni.</span><span class="sxs-lookup"><span data-stu-id="e1c78-135">The following diagram shows these relationships.</span></span>

![passaggi di trasformazione immagine](images/vmrmapping-transform-steps.png)

## <a name="related-topics"></a><span data-ttu-id="e1c78-137">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="e1c78-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e1c78-138">Uso di VMR per gli sviluppatori di filtri DirectShow</span><span class="sxs-lookup"><span data-stu-id="e1c78-138">Using the VMR for DirectShow Filter Developers</span></span>](using-the-vmr-for-directshow-filter-developers.md)
</dt> </dl>

 

 



