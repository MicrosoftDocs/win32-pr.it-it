---
description: Come i dispositivi hardware partecipano al grafico di filtro
ms.assetid: 27e1c097-9bb4-4f9c-b9f9-0d4225c0d290
title: Come i dispositivi hardware partecipano al grafico di filtro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68794bbc046e633e9a435b2628a20b8ea8aab174
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104480740"
---
# <a name="how-hardware-devices-participate-in-the-filter-graph"></a><span data-ttu-id="d1183-103">Come i dispositivi hardware partecipano al grafico di filtro</span><span class="sxs-lookup"><span data-stu-id="d1183-103">How Hardware Devices Participate in the Filter Graph</span></span>

<span data-ttu-id="d1183-104">Questo articolo descrive il modo in cui DirectShow interagisce con hardware audio e video.</span><span class="sxs-lookup"><span data-stu-id="d1183-104">This article describes how DirectShow interacts with audio and video hardware.</span></span>

<span data-ttu-id="d1183-105">**Filtri wrapper**</span><span class="sxs-lookup"><span data-stu-id="d1183-105">**Wrapper Filters**</span></span>

<span data-ttu-id="d1183-106">Tutti i filtri DirectShow sono componenti software in modalità utente.</span><span class="sxs-lookup"><span data-stu-id="d1183-106">All DirectShow filters are user mode software components.</span></span> <span data-ttu-id="d1183-107">Per consentire a un dispositivo hardware in modalità kernel, ad esempio una scheda di acquisizione video, di aggiungere un grafico filtro DirectShow, il dispositivo deve essere rappresentato come filtro in modalità utente.</span><span class="sxs-lookup"><span data-stu-id="d1183-107">In order for a kernel mode hardware device, such as a video capture card, to join a DirectShow filter graph, the device must be represented as a user-mode filter.</span></span> <span data-ttu-id="d1183-108">Questa funzione viene eseguita da filtri "wrapper" specializzati forniti con DirectShow.</span><span class="sxs-lookup"><span data-stu-id="d1183-108">This function is performed by specialized "wrapper" filters provided with DirectShow.</span></span> <span data-ttu-id="d1183-109">Questi filtri includono il filtro di [acquisizione audio](audio-capture.md) , il filtro di [acquisizione di VFW](vfw-capture-filter.md) , il filtro del [sintonizzatore TV](tv-tuner-filter.md) , il filtro [audio TV](tv-audio-filter.md) e il filtro per la [traversa video analogo](analog-video-crossbar-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="d1183-109">These filters include the [Audio Capture](audio-capture.md) filter, the [VFW Capture](vfw-capture-filter.md) filter, the [TV Tuner](tv-tuner-filter.md) filter, the [TV Audio](tv-audio-filter.md) filter, and the [Analog Video Crossbar](analog-video-crossbar-filter.md) filter.</span></span> <span data-ttu-id="d1183-110">DirectShow fornisce anche un filtro denominato KsProxy, che può rappresentare qualsiasi tipo di dispositivo di streaming WDM (Windows Driver Model).</span><span class="sxs-lookup"><span data-stu-id="d1183-110">DirectShow also provides a filter called KsProxy, which can represent any type of Windows Driver Model (WDM) streaming device.</span></span> <span data-ttu-id="d1183-111">I fornitori di hardware possono estendere KsProxy per supportare funzionalità personalizzate, fornendo un *plug-in ksproxy*, che è un oggetto com aggregato da ksproxy.</span><span class="sxs-lookup"><span data-stu-id="d1183-111">Hardware vendors can extend KsProxy to support custom functionality, by providing a *Ksproxy plug-in*, which is a COM object aggregated by KsProxy.</span></span>

<span data-ttu-id="d1183-112">I filtri wrapper espongono interfacce COM che rappresentano le funzionalità del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d1183-112">The wrapper filters expose COM interfaces that represent the capabilities of the device.</span></span> <span data-ttu-id="d1183-113">L'applicazione usa queste interfacce per passare informazioni da e verso il filtro.</span><span class="sxs-lookup"><span data-stu-id="d1183-113">The application uses these interfaces to pass information to and from the filter.</span></span> <span data-ttu-id="d1183-114">Il filtro converte le chiamate al metodo COM in chiamate al driver di dispositivo, le passa al driver in modalità kernel e quindi converte di nuovo il risultato nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d1183-114">The filter translates the COM method calls into device driver calls, passes that information to the driver in kernel mode, and then translates the result back to the application.</span></span> <span data-ttu-id="d1183-115">Il sintonizzatore TV, audio TV, traversa video analogo e i filtri KsProxy supportano le proprietà del driver personalizzato tramite l'interfaccia [**IKsPropertySet**](ikspropertyset.md) .</span><span class="sxs-lookup"><span data-stu-id="d1183-115">The TV Tuner, TV Audio, Analog Video Crossbar, and KsProxy filters support custom driver properties through the [**IKsPropertySet**](ikspropertyset.md) interface.</span></span> <span data-ttu-id="d1183-116">Il filtro di acquisizione VFW e il filtro di acquisizione audio non sono estendibili in questo modo.</span><span class="sxs-lookup"><span data-stu-id="d1183-116">The VFW Capture filter and the Audio Capture filter are not extensible in this way.</span></span>

<span data-ttu-id="d1183-117">Per gli sviluppatori di applicazioni, i filtri wrapper consentono all'applicazione di controllare i dispositivi così come controllano qualsiasi altro filtro DirectShow.</span><span class="sxs-lookup"><span data-stu-id="d1183-117">For application developers, wrapper filters enable the application to control devices just as they control any other DirectShow filter.</span></span> <span data-ttu-id="d1183-118">Non è necessaria alcuna programmazione speciale. i dettagli della comunicazione con il dispositivo in modalità kernel vengono incapsulati all'interno del filtro.</span><span class="sxs-lookup"><span data-stu-id="d1183-118">No special programming is required; the details of communicating with the kernel-mode device are encapsulated within the filter.</span></span>

<span data-ttu-id="d1183-119">**Video per i dispositivi Windows**</span><span class="sxs-lookup"><span data-stu-id="d1183-119">**Video for Windows Devices**</span></span>

<span data-ttu-id="d1183-120">Il filtro di acquisizione VFW supporta le schede di acquisizione video for Windows (VfW) precedenti.</span><span class="sxs-lookup"><span data-stu-id="d1183-120">The VFW Capture filter supports earlier Video for Windows (VfW) capture cards.</span></span> <span data-ttu-id="d1183-121">Quando una scheda VfW è presente nel sistema di destinazione, può essere individuata e aggiunta al grafo del filtro usando l' [enumeratore del dispositivo di sistema](system-device-enumerator.md)DirectShow.</span><span class="sxs-lookup"><span data-stu-id="d1183-121">When a VfW card is present on the target system, it can be discovered and added to the filter graph using the DirectShow [System Device Enumerator](system-device-enumerator.md).</span></span> <span data-ttu-id="d1183-122">Per informazioni dettagliate, vedere [enumerazione di dispositivi e filtri](enumerating-devices-and-filters.md).</span><span class="sxs-lookup"><span data-stu-id="d1183-122">For details, see [Enumerating Devices and Filters](enumerating-devices-and-filters.md).</span></span>

<span data-ttu-id="d1183-123">**Acquisizione e combinazione di dispositivi audio (schede audio)**</span><span class="sxs-lookup"><span data-stu-id="d1183-123">**Audio Capture and Mixing Devices (Sound Cards)**</span></span>

<span data-ttu-id="d1183-124">Le schede audio più recenti hanno Jack di input per i microfoni e altri tipi di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="d1183-124">Newer sound cards have input jacks for microphones and other types of devices.</span></span> <span data-ttu-id="d1183-125">In genere, queste schede dispongono anche di funzionalità di combinazione sul bordo per il controllo del volume, degli acuti e dei bassi di ogni singolo input.</span><span class="sxs-lookup"><span data-stu-id="d1183-125">Typically these cards also have on-board mixing capabilities for controlling the volume, treble, and bass of each individual input.</span></span> <span data-ttu-id="d1183-126">In DirectShow gli input e il mixer della scheda audio sono inclusi nel filtro di acquisizione audio.</span><span class="sxs-lookup"><span data-stu-id="d1183-126">In DirectShow, the sound card's inputs and mixer are wrapped by the Audio Capture filter.</span></span> <span data-ttu-id="d1183-127">Ogni scheda audio può essere individuata con l'enumeratore di dispositivo di sistema.</span><span class="sxs-lookup"><span data-stu-id="d1183-127">Each sound card can be discovered with the System Device Enumerator.</span></span> <span data-ttu-id="d1183-128">Per visualizzare le schede audio del sistema, eseguire GraphEdit e selezionare la categoria origini acquisizione audio.</span><span class="sxs-lookup"><span data-stu-id="d1183-128">To view the sound cards in your system, run GraphEdit and select from the Audio Capture Sources category.</span></span> <span data-ttu-id="d1183-129">Ogni filtro in tale categoria è un'istanza separata del filtro di acquisizione audio.</span><span class="sxs-lookup"><span data-stu-id="d1183-129">Each filter in that category is a separate instance of the Audio Capture filter.</span></span> <span data-ttu-id="d1183-130">Vedere [uso di GraphEdit](using-graphedit.md).</span><span class="sxs-lookup"><span data-stu-id="d1183-130">(See [Using GraphEdit](using-graphedit.md).)</span></span>

<span data-ttu-id="d1183-131">**Dispositivi di streaming WDM**</span><span class="sxs-lookup"><span data-stu-id="d1183-131">**WDM Streaming Devices**</span></span>

<span data-ttu-id="d1183-132">I decodificatori hardware e le schede di acquisizione più recenti sono conformi alla specifica Windows Driver Model (WDM).</span><span class="sxs-lookup"><span data-stu-id="d1183-132">Newer hardware decoders and capture cards conform to the Windows Driver Model (WDM) specification.</span></span> <span data-ttu-id="d1183-133">Questi dispositivi hanno funzionalità maggiori rispetto ai dispositivi VfW.</span><span class="sxs-lookup"><span data-stu-id="d1183-133">These devices have greater functionality than VfW devices.</span></span> <span data-ttu-id="d1183-134">Le schede di acquisizione video WDM possono supportare funzionalità non disponibili in VfW, inclusa l'enumerazione dei formati di acquisizione, il controllo a livello di codice dei parametri video, ad esempio tonalità e luminosità, selezione input a livello di codice e supporto per sintonizzatori TV.</span><span class="sxs-lookup"><span data-stu-id="d1183-134">WDM video capture cards can support features that are not available under VfW, including the enumeration of capture formats, programmatic control of video parameters such as hue and brightness, programmatic input selection, and TV Tuner support.</span></span>

<span data-ttu-id="d1183-135">Per supportare i dispositivi di streaming WDM, DirectShow fornisce il filtro KsProxy (ksproxy.ax).</span><span class="sxs-lookup"><span data-stu-id="d1183-135">To support WDM streaming devices, DirectShow provides the KsProxy filter (ksproxy.ax).</span></span> <span data-ttu-id="d1183-136">KsProxy è stato chiamato "filtro coltelli svizzeri per l'esercito", perché esegue molte operazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="d1183-136">KsProxy has been called the "Swiss Army Knife filter" because it does so many different things.</span></span> <span data-ttu-id="d1183-137">Il numero di pin sul filtro e il numero di interfacce COM esposte dal filtro dipendono dalle funzionalità del driver sottostante.</span><span class="sxs-lookup"><span data-stu-id="d1183-137">The number of pins on the filter, and the number of COM interfaces exposed by the filter, depend on the capabilities of the underlying driver.</span></span> <span data-ttu-id="d1183-138">KsProxy non viene visualizzato nel grafico del filtro sotto il nome "KsProxy".</span><span class="sxs-lookup"><span data-stu-id="d1183-138">KsProxy does not appear in the filter graph under the name "KsProxy."</span></span> <span data-ttu-id="d1183-139">Accetta sempre il nome descrittivo del dispositivo, disponibile nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="d1183-139">It always takes the friendly name of the device, which is found in the registry.</span></span> <span data-ttu-id="d1183-140">Per visualizzare i dispositivi WDM nel sistema, eseguire GraphEdit e selezionare una delle categorie di streaming WDM.</span><span class="sxs-lookup"><span data-stu-id="d1183-140">To view the WDM devices on your system, run GraphEdit and select from the WDM Streaming categories.</span></span> <span data-ttu-id="d1183-141">Anche se nel sistema è presente una sola scheda WDM, tale scheda potrebbe contenere più di un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d1183-141">Even if you have only one WDM card on your system, that card might contain more than one device.</span></span> <span data-ttu-id="d1183-142">Ogni dispositivo è rappresentato come filtro separato e ognuno di questi filtri è effettivamente KsProxy.</span><span class="sxs-lookup"><span data-stu-id="d1183-142">Each device is represented as a separate filter, and each of these filters is actually KsProxy.</span></span>

<span data-ttu-id="d1183-143">Un'applicazione usa l'enumeratore di dispositivo di sistema per trovare i moniker del dispositivo WDM nel sistema.</span><span class="sxs-lookup"><span data-stu-id="d1183-143">An application uses the System Device Enumerator to find WDM device monikers on the system.</span></span> <span data-ttu-id="d1183-144">Viene creata un'istanza di KsProxy chiamando **BindToObject** sul moniker.</span><span class="sxs-lookup"><span data-stu-id="d1183-144">KsProxy is instantiated by calling **BindToObject** on the moniker.</span></span> <span data-ttu-id="d1183-145">Poiché KsProxy può rappresentare tutti i tipi di dispositivi WDM, deve eseguire una query sul driver per determinare quali proprietà sono supportate dal driver.</span><span class="sxs-lookup"><span data-stu-id="d1183-145">Because KsProxy can represent all kinds of WDM devices, it must query the driver to determine which property sets the driver supports.</span></span> <span data-ttu-id="d1183-146">I set di proprietà sono raccolte di strutture di dati utilizzate dai driver WDM e anche da alcuni filtri in modalità utente, ad esempio i decodificatori di software MPEG-2.</span><span class="sxs-lookup"><span data-stu-id="d1183-146">Property sets are collections of data structures used by WDM drivers, and also by some user mode filters, such as MPEG-2 software decoders.</span></span> <span data-ttu-id="d1183-147">KsProxy configura se stesso per esporre le interfacce COM che corrispondono a tali set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="d1183-147">KsProxy configures itself to expose the COM interfaces that correspond to those property sets.</span></span> <span data-ttu-id="d1183-148">KsProxy converte le chiamate al metodo COM in set di proprietà e le invia al driver.</span><span class="sxs-lookup"><span data-stu-id="d1183-148">KsProxy translates the COM method calls into property sets and sends these to the driver.</span></span> <span data-ttu-id="d1183-149">I fornitori di hardware possono estendere KsProxy fornendo plug-in, ovvero interfacce specifiche del fornitore che espongono le funzionalità speciali di un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d1183-149">Hardware vendors can extend KsProxy by supplying plug-ins, which are vendor-specific interfaces that expose the special capabilities of a device.</span></span> <span data-ttu-id="d1183-150">Tutti questi dettagli sono nascosti dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d1183-150">All these details are hidden from application.</span></span> <span data-ttu-id="d1183-151">L'applicazione controlla il dispositivo tramite KsProxy, nello stesso modo di qualsiasi altro filtro DirectShow.</span><span class="sxs-lookup"><span data-stu-id="d1183-151">The application controls the device by way of KsProxy, in the same way as any other DirectShow filter.</span></span>

<span data-ttu-id="d1183-152">**Flusso del kernel**</span><span class="sxs-lookup"><span data-stu-id="d1183-152">**Kernel Streaming**</span></span>

<span data-ttu-id="d1183-153">I dispositivi WDM supportano lo streaming del kernel, in cui i dati vengono trasmessi interamente in modalità kernel senza mai passare alla modalità utente.</span><span class="sxs-lookup"><span data-stu-id="d1183-153">WDM devices support kernel streaming, in which data is streamed entirely in kernel mode without ever switching to user mode.</span></span> <span data-ttu-id="d1183-154">Il cambio tra la modalità kernel e la modalità utente è costoso dal punto di vista del calcolo. il flusso del kernel consente velocità in bit elevate senza sovraccaricare la CPU dell'host.</span><span class="sxs-lookup"><span data-stu-id="d1183-154">Switching between kernel mode and user mode is computationally expensive; kernel streaming allows for high bit rates without burdening the host CPU.</span></span> <span data-ttu-id="d1183-155">I filtri basati su WDM possono usare il flusso di kernel per passare i dati multimediali direttamente da un dispositivo hardware a un altro, sulla stessa scheda o su una scheda diversa, senza copiare i dati nella memoria principale del sistema.</span><span class="sxs-lookup"><span data-stu-id="d1183-155">WDM-based filters can use kernel streaming to pass multimedia data directly from one hardware device to another, either on the same card or on a different card, without copying the data into the system's main memory.</span></span>

<span data-ttu-id="d1183-156">Dal punto di vista di un'applicazione, viene visualizzato come se i dati fossero spostati da un filtro in modalità utente a quello successivo.</span><span class="sxs-lookup"><span data-stu-id="d1183-156">From an application's point of view, it appears as if the data moves from one user-mode filter to the next.</span></span> <span data-ttu-id="d1183-157">In realtà, i dati potrebbero non passare mai alla modalità utente, ma possono essere trasmessi direttamente da un dispositivo in modalità kernel a un altro fino a quando non ne viene eseguito il rendering nella scheda video grafica.</span><span class="sxs-lookup"><span data-stu-id="d1183-157">In reality, the data might never pass into user mode at all, but instead might be streamed directly from one kernel-mode device to another until it is rendered on the video graphics card.</span></span> <span data-ttu-id="d1183-158">Alcuni scenari, ad esempio l'acquisizione in un file, richiedono che i dati vengano passati dalla modalità kernel alla modalità utente a un certo punto.</span><span class="sxs-lookup"><span data-stu-id="d1183-158">Some scenarios, such as capture to a file, require that the data pass from kernel mode to user mode at some point.</span></span> <span data-ttu-id="d1183-159">Tuttavia, questa opzione non richiede necessariamente che i dati vengano copiati in una nuova posizione in memoria.</span><span class="sxs-lookup"><span data-stu-id="d1183-159">However, this switch does not necessarily require the data to be copied to a new location in memory.</span></span>

<span data-ttu-id="d1183-160">Gli sviluppatori di applicazioni in genere non devono preoccuparsi dei dettagli del flusso del kernel, ad eccezione delle informazioni complementari.</span><span class="sxs-lookup"><span data-stu-id="d1183-160">Application developers generally do not need to be concerned with the details of kernel streaming, except as background information.</span></span> <span data-ttu-id="d1183-161">Per informazioni più dettagliate su WDM, streaming kernel, KsProxy e argomenti correlati, vedere Microsoft DDK.</span><span class="sxs-lookup"><span data-stu-id="d1183-161">See the Microsoft DDK for more detailed information about WDM, kernel streaming, KsProxy, and related topics.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d1183-162">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="d1183-162">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1183-163">Il grafico del filtro e i relativi componenti</span><span class="sxs-lookup"><span data-stu-id="d1183-163">The Filter Graph and Its Components</span></span>](the-filter-graph-and-its-components.md)
</dt> </dl>

 

 



