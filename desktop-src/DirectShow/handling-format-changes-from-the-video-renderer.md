---
description: Gestione delle modifiche al formato dal renderer video
ms.assetid: ac7d7b1c-3c9a-4693-87ea-0a10a8ab915c
title: Gestione delle modifiche al formato dal renderer video
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d731ac4b9d6985cf5ad92f642b6d8262209fa91d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "106303928"
---
# <a name="handling-format-changes-from-the-video-renderer"></a><span data-ttu-id="428a2-103">Gestione delle modifiche al formato dal renderer video</span><span class="sxs-lookup"><span data-stu-id="428a2-103">Handling Format Changes from the Video Renderer</span></span>

<span data-ttu-id="428a2-104">In questa sezione viene descritto in che modo un filtro decodificatore o un filtro di trasformazione deve gestire le modifiche al formato dal renderer video.</span><span class="sxs-lookup"><span data-stu-id="428a2-104">This section describes how a decoder filter or transform filter should handle format changes from the video renderer.</span></span>

<span data-ttu-id="428a2-105">**Filtro renderer video**</span><span class="sxs-lookup"><span data-stu-id="428a2-105">**Video Renderer Filter**</span></span>

<span data-ttu-id="428a2-106">Quando il filtro [renderer video](video-renderer-filter.md) precedente si connette, richiede un formato RGB che corrisponda al formato di visualizzazione del monitor primario.</span><span class="sxs-lookup"><span data-stu-id="428a2-106">When the old [Video Renderer](video-renderer-filter.md) filter connects, it requires an RGB format that matches the display format of the primary monitor.</span></span> <span data-ttu-id="428a2-107">In questo modo è possibile utilizzare GDI per il rendering se DirectDraw non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="428a2-107">This enables it to use GDI for rendering if DirectDraw is not available.</span></span> <span data-ttu-id="428a2-108">Quando viene avviata la riproduzione, il renderer video può passare a un formato compatibile con DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="428a2-108">When playback starts, the Video Renderer may switch to a DirectDraw-compatible format.</span></span> <span data-ttu-id="428a2-109">Per verfify se il filtro upstream può supportare il nuovo formato, il renderer video chiama [**Ipin:: QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) sul pin di output del filtro upstream.</span><span class="sxs-lookup"><span data-stu-id="428a2-109">To verfify whether the upstream filter can support the new format, the Video Renderer calls [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) on the upstream filter's output pin.</span></span> <span data-ttu-id="428a2-110">Se il filtro upstream accetta il nuovo formato, il metodo **QueryAccept** restituisce S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="428a2-110">If the upstream filter accepts the new format, the **QueryAccept** method returns S\_OK.</span></span> <span data-ttu-id="428a2-111">Il renderer video passa i formati connettendo un tipo di supporto con il nuovo formato all'esempio multimediale successivo restituito dall'allocatore.</span><span class="sxs-lookup"><span data-stu-id="428a2-111">The Video Renderer switches formats by attaching a media type with the new format to the next media sample returned by its allocator.</span></span> <span data-ttu-id="428a2-112">Il filtro upstream deve verificare la presenza di modifiche al formato chiamando [**IMediaSample:: GetMediaType**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) su ogni esempio.</span><span class="sxs-lookup"><span data-stu-id="428a2-112">The upstream filter should check for format changes by calling [**IMediaSample::GetMediaType**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) on each sample.</span></span> <span data-ttu-id="428a2-113">Il renderer video può passare dal formato originale al nuovo formato e viceversa in qualsiasi momento durante il flusso.</span><span class="sxs-lookup"><span data-stu-id="428a2-113">The Video Renderer may switch back and forth between the original format and new format at any time during streaming.</span></span> <span data-ttu-id="428a2-114">Non chiama **QueryAccept** dopo la modifica del primo formato.</span><span class="sxs-lookup"><span data-stu-id="428a2-114">It does not call **QueryAccept** after the first format change.</span></span> <span data-ttu-id="428a2-115">Una volta accettato il nuovo formato, il filtro upstream deve essere in grado di spostarsi avanti e indietro.</span><span class="sxs-lookup"><span data-stu-id="428a2-115">Once the upstream filter has accepted the new format, it must be able to switch back and forth.</span></span>

<span data-ttu-id="428a2-116">Il filtro upstream può rifiutare la modifica del formato restituendo S \_ false da **QueryAccept**.</span><span class="sxs-lookup"><span data-stu-id="428a2-116">The upstream filter can reject the format change by returning S\_FALSE from **QueryAccept**.</span></span> <span data-ttu-id="428a2-117">In tal caso, il renderer video continua a usare GDI con il formato originale.</span><span class="sxs-lookup"><span data-stu-id="428a2-117">In that case, the Video Renderer continues to use GDI with the original format.</span></span>

<span data-ttu-id="428a2-118">**Filtro renderer di combinazione video**</span><span class="sxs-lookup"><span data-stu-id="428a2-118">**Video Mixing Renderer Filter**</span></span>

<span data-ttu-id="428a2-119">Il filtro del renderer video mixing (VMR-7 e VMR-9) si connetterà con qualsiasi formato supportato dall'hardware grafico nel sistema.</span><span class="sxs-lookup"><span data-stu-id="428a2-119">The Video Mixing Renderer filter (VMR-7 and VMR-9) will connect with any format that is supported by the graphics hardware on the system.</span></span> <span data-ttu-id="428a2-120">VMR-7 utilizza sempre DirectDraw per il rendering e alloca le superfici DirectDraw sottostanti quando il filtro upstream si connette.</span><span class="sxs-lookup"><span data-stu-id="428a2-120">The VMR-7 always uses DirectDraw for rendering, and allocates the underlying DirectDraw surfaces when the upstream filter connects.</span></span> <span data-ttu-id="428a2-121">VMR-9 USA sempre Direct3D per il rendering e alloca le superfici Direct3D sottostanti quando il filtro upstream si connette.</span><span class="sxs-lookup"><span data-stu-id="428a2-121">The VMR-9 always uses Direct3D for rendering, and allocates the underlying Direct3D surfaces when the upstream filter connects.</span></span>

<span data-ttu-id="428a2-122">L'hardware grafico potrebbe richiedere uno stride della superficie superiore rispetto alla larghezza dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="428a2-122">The graphics hardware may require a larger surface stride than the image width.</span></span> <span data-ttu-id="428a2-123">In tal caso, VMR richiede un nuovo formato chiamando **QueryAccept**.</span><span class="sxs-lookup"><span data-stu-id="428a2-123">In that case, the VMR requests a new format by calling **QueryAccept**.</span></span> <span data-ttu-id="428a2-124">Segnala lo stride della superficie nel membro **biWidth** di [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) nel formato video.</span><span class="sxs-lookup"><span data-stu-id="428a2-124">It reports the surface stride in the **biWidth** member of the [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) in the video format.</span></span> <span data-ttu-id="428a2-125">Se il filtro upstream non restituisce \_ OK da **QUERYACCEPT**, VMR rifiuta il formato e tenta di connettersi usando il formato successivo annunciato dal filtro upstream.</span><span class="sxs-lookup"><span data-stu-id="428a2-125">If the upstream filter does not return S\_OK from **QueryAccept**, the VMR rejects the format and tries to connect using the next format advertised by the upstream filter.</span></span> <span data-ttu-id="428a2-126">VMR connette il tipo di supporto con il nuovo formato al primo campione multimediale.</span><span class="sxs-lookup"><span data-stu-id="428a2-126">The VMR attaches the media type with the new format to the first media sample.</span></span> <span data-ttu-id="428a2-127">Dopo il primo esempio, il formato rimane costante; VMR non comporterà il cambio di formato durante l'esecuzione del grafo.</span><span class="sxs-lookup"><span data-stu-id="428a2-127">After the first sample, the format remains constant; the VMR will not switch formats while the graph is running.</span></span>

<span data-ttu-id="428a2-128">**Rendering video migliorato (EVR)**</span><span class="sxs-lookup"><span data-stu-id="428a2-128">**Enhanced Video Render (EVR)**</span></span>

<span data-ttu-id="428a2-129">EVR usa sempre Direct3D per il rendering.</span><span class="sxs-lookup"><span data-stu-id="428a2-129">The EVR always uses Direct3D for rendering.</span></span> <span data-ttu-id="428a2-130">Se è necessario uno stride di superficie più grande, EVR usa lo stesso meccanismo **QueryAccept** di VMR.</span><span class="sxs-lookup"><span data-stu-id="428a2-130">If a larger surface stride is needed, the EVR uses the same **QueryAccept** mechanism as the VMR.</span></span>

## <a name="related-topics"></a><span data-ttu-id="428a2-131">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="428a2-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="428a2-132">QueryAccept (upstream)</span><span class="sxs-lookup"><span data-stu-id="428a2-132">QueryAccept (Upstream)</span></span>](queryaccept--upstream.md)
</dt> </dl>

 

 



