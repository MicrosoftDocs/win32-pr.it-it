---
description: Windows Update Agent (WUA) si aggiorna automaticamente quando è connesso a un server di Windows Server Update Services (WSUS) o Windows Update.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Aggiornamento dell'agente di Windows Update
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106307584"
---
# <a name="updating-windows-update-agent"></a><span data-ttu-id="8c800-103">Aggiornamento dell'agente di Windows Update</span><span class="sxs-lookup"><span data-stu-id="8c800-103">Updating Windows Update Agent</span></span>

<span data-ttu-id="8c800-104">Windows Update Agent (WUA) si aggiorna con diversi mezzi, a seconda della versione di Windows in esecuzione sul dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8c800-104">Windows Update Agent (WUA) updates itself through various means, depending on the version of Windows running on the device.</span></span> <span data-ttu-id="8c800-105">Le versioni precedenti di WUA potrebbero non essere in grado di connettersi ai servizi di aggiornamento correnti, potrebbero non essere compatibili con tutti gli aggiornamenti e potrebbero non supportare tutte le API documentate.</span><span class="sxs-lookup"><span data-stu-id="8c800-105">Old versions of WUA may not be able to connect to current update services, may not be compatible with all updates, and may not support all documented APIs.</span></span> <span data-ttu-id="8c800-106">Ecco come verificare che WUA sia completamente aggiornato e compatibile.</span><span class="sxs-lookup"><span data-stu-id="8c800-106">Here is how to insure that WUA is fully updated and compatible.</span></span>

<span data-ttu-id="8c800-107">**Nelle versioni di Windows a partire da Windows 7 e Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="8c800-107">**On versions of Windows beginning with Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="8c800-108">Gli aggiornamenti di Windows Update Agent (WUA) sono inclusi negli aggiornamenti periodici regolari di Windows distribuiti tramite Windows Update o per Windows Server Update Services (WSUS).</span><span class="sxs-lookup"><span data-stu-id="8c800-108">Windows Update Agent (WUA) updates are included in the regular periodic updates to Windows distributed through Windows Update or to Windows Server Update Services (WSUS).</span></span> <span data-ttu-id="8c800-109">Non è necessario eseguire alcun passaggio speciale per aggiornare WUA in queste versioni di Windows.</span><span class="sxs-lookup"><span data-stu-id="8c800-109">You do not need to take any special steps to update WUA on these Windows versions.</span></span>

<span data-ttu-id="8c800-110">**Nelle versioni di Windows precedenti a Windows 7 e Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="8c800-110">**On versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="8c800-111">WUA si aggiorna automaticamente quando Aggiornamenti automatici si connette a Windows Update o a WSUS.</span><span class="sxs-lookup"><span data-stu-id="8c800-111">WUA automatically updates itself when Automatic Updates connects to Windows Update or to WSUS.</span></span>

<span data-ttu-id="8c800-112">Se Aggiornamenti automatici non è ancora stato eseguito correttamente, è possibile che un dispositivo che esegue queste versioni di Windows esegua una versione precedente di WUA che non supporta tutte le API documentate.</span><span class="sxs-lookup"><span data-stu-id="8c800-112">If Automatic Updates has not yet successfully run, it is possible that a device running these Windows versions will be running an older version of WUA that does not support all the documented APIs.</span></span> <span data-ttu-id="8c800-113">Se si riceve un risultato WU_E_SELFUPDATE_REQUIRED quando si usa l'API WUA per eseguire un'analisi, scaricare o installare, questo errore indica che la versione installata di WUA è troppo vecchia per connettersi ai servizi Windows Update correnti.</span><span class="sxs-lookup"><span data-stu-id="8c800-113">If you receive a WU_E_SELFUPDATE_REQUIRED result when you use the WUA API to perform a scan, download, or install, this error tells you that the installed version of WUA is too old to connect to current Windows Update services.</span></span> <span data-ttu-id="8c800-114">Non è possibile usare le normali API WUA per aggiornare WUA in questi sistemi operativi.</span><span class="sxs-lookup"><span data-stu-id="8c800-114">You cannot use the normal WUA APIs to update WUA on these operating systems.</span></span> 

<span data-ttu-id="8c800-115">Un utente può aggiornare manualmente WUA a una versione corrente aprendo il pannello di controllo Windows Update, selezionando Controlla aggiornamenti, quindi accettando l'aggiornamento automatico visualizzato.</span><span class="sxs-lookup"><span data-stu-id="8c800-115">A user can manually update WUA to a current version by opening the Windows Update control panel, selecting Check for Updates, then accepting the self-update that appears.</span></span> <span data-ttu-id="8c800-116">In alternativa, è possibile aggiornare WUA a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="8c800-116">Alternately, you can update WUA programmatically.</span></span>

<span data-ttu-id="8c800-117">**Per aggiornare WUA a livello di codice nelle versioni di Windows precedenti a Windows 7 e Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="8c800-117">**To programmatically update WUA on versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

1.  <span data-ttu-id="8c800-118">Usare le API [WinHTTP](../winhttp/winhttp-start-page.md) per scaricare [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="8c800-118">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
2.  <span data-ttu-id="8c800-119">Utilizzare le [funzioni di crittografia](../seccrypto/cryptography-functions.md) per verificare che la copia scaricata di [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) disponga di una firma digitale di Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8c800-119">Use the [Cryptography Functions](../seccrypto/cryptography-functions.md) to verify that the downloaded copy of [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) has a digital signature from Microsoft.</span></span> <span data-ttu-id="8c800-120">Se non è possibile verificare la firma digitale, arrestare.</span><span class="sxs-lookup"><span data-stu-id="8c800-120">If you can't verify the digital signature, stop.</span></span>
3.  <span data-ttu-id="8c800-121">Utilizzare le API dell' [interfaccia di decompressione file](../devnotes/cabinet-api-functions.md) per estrarre il file XML dalla [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="8c800-121">Use the [File Decompression Interface](../devnotes/cabinet-api-functions.md) APIs to extract the XML file from [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
4.  <span data-ttu-id="8c800-122">Utilizzare le API Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) per caricare il file XML e individuare il nodo WURedist/StandaloneRedist/Architecture per l'architettura del computer.</span><span class="sxs-lookup"><span data-stu-id="8c800-122">Use the Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) APIs to load the XML file and locate the WURedist/StandaloneRedist/architecture node for the computer's architecture.</span></span> <span data-ttu-id="8c800-123">Per x86, ad esempio, individuare il nodo WURedist/StandaloneRedist/Architecture con l'attributo **Name** di x86.</span><span class="sxs-lookup"><span data-stu-id="8c800-123">For example, for x86, locate the WURedist/StandaloneRedist/architecture node with the **name** attribute of x86.</span></span>
5.  <span data-ttu-id="8c800-124">Chiamare [**IWindowsUpdateAgentInfo:: GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) per determinare la versione corrente di WUA.</span><span class="sxs-lookup"><span data-stu-id="8c800-124">Call [**IWindowsUpdateAgentInfo::GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) to determine the current version of WUA.</span></span> <span data-ttu-id="8c800-125">Se **IWindowsUpdateAgentInfo:: GetInfo** restituisce un numero di versione che è almeno uguale all'attributo **ClientVersion** nel nodo Architecture individuato, arrestare.</span><span class="sxs-lookup"><span data-stu-id="8c800-125">If **IWindowsUpdateAgentInfo::GetInfo** returns a version number that is at least as high as the **clientVersion** attribute in the architecture node you located, stop.</span></span>
6.  <span data-ttu-id="8c800-126">Utilizzare le API [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) per leggere l'attributo **DownloadUrl** dal nodo Architecture individuato.</span><span class="sxs-lookup"><span data-stu-id="8c800-126">Use the [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) APIs to read the **downloadUrl** attribute from the architecture node that you located.</span></span> <span data-ttu-id="8c800-127">**DownloadUrl** fornisce l'URL di download per il programma di installazione di WUA appropriato per l'architettura del computer.</span><span class="sxs-lookup"><span data-stu-id="8c800-127">**downloadUrl** gives you the download URL for the appropriate WUA installer for the computer's architecture.</span></span>
7.  <span data-ttu-id="8c800-128">Utilizzare le API [WinHTTP](../winhttp/winhttp-start-page.md) per scaricare il programma di installazione appropriato.</span><span class="sxs-lookup"><span data-stu-id="8c800-128">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download the appropriate installer.</span></span>
8.  <span data-ttu-id="8c800-129">Usare la funzione [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) o un'API simile per eseguire il programma di installazione scaricato.</span><span class="sxs-lookup"><span data-stu-id="8c800-129">Use the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function or a similar API to execute the downloaded installer.</span></span>

 

 
