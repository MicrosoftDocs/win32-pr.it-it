---
description: In questo argomento vengono identificate le linee guida da seguire quando si eseguono operazioni asincrone di Windows Update Agent (WUA).
ms.assetid: 1fb16904-732d-4341-8267-ab8896fc0f7c
title: Linee guida per le operazioni WUA asincrone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1a4b2198a235d9a03e3730e5d6dce2cd54c0e1f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2021
ms.locfileid: "106309731"
---
# <a name="guidelines-for-asynchronous-wua-operations"></a><span data-ttu-id="8a0f5-103">Linee guida per le operazioni WUA asincrone</span><span class="sxs-lookup"><span data-stu-id="8a0f5-103">Guidelines for Asynchronous WUA Operations</span></span>

<span data-ttu-id="8a0f5-104">In questo argomento vengono identificate le linee guida da seguire quando si eseguono operazioni asincrone di Windows Update Agent (WUA).</span><span class="sxs-lookup"><span data-stu-id="8a0f5-104">This topic identifies guidelines for you to the follow when you perform asynchronous Windows Update Agent (WUA) operations.</span></span>

-   <span data-ttu-id="8a0f5-105">Le operazioni WUA asincrone non garantiscono una particolare velocità di completamento.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-105">The asynchronous WUA operations do not guarantee any particular completion speed.</span></span> <span data-ttu-id="8a0f5-106">Il tempo di completamento per un'operazione WUA asincrona può variare notevolmente a seconda dell'hardware del computer, della versione del sistema operativo e della configurazione di rete.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-106">The completion time for an asynchronous WUA operation can vary widely depending on computer hardware, version of the operating system, and network configuration.</span></span> <span data-ttu-id="8a0f5-107">Come per le altre API Windows con dipendenze di rete e che non contengono un parametro di timeout o una durata documentata di timeout, è consigliabile implementare i propri meccanismi di timeout se sono necessari tempi di risposta garantiti.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-107">As with other Windows APIs that have network dependencies and that do not contain a time-out parameter or a documented time-out duration, we recommend that you consider implementing your own time-out mechanisms if you need guaranteed response times.</span></span> <span data-ttu-id="8a0f5-108">Ad esempio, è possibile creare un thread di lavoro che chiama un metodo WUA asincrono e che imposta un evento o un altro oggetto di sincronizzazione al completamento dell'operazione WUA asincrona; il thread principale può quindi usare la funzione [**WaitForSingleObject**](/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject) o [**WaitForMultipleObjects**](/windows/desktop/api/synchapi/nf-synchapi-waitformultipleobjects) , che consente di specificare un valore di timeout.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-108">For example, you can create a worker thread that calls an asynchronous WUA method and that sets an event or other synchronization object when the asynchronous WUA operation completes; the main thread can then use the [**WaitForSingleObject**](/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject) or [**WaitForMultipleObjects**](/windows/desktop/api/synchapi/nf-synchapi-waitformultipleobjects) function, which allows you to specify a time-out value.</span></span>
-   <span data-ttu-id="8a0f5-109">Quando si termina una ricerca, il download, l'installazione o la disinstallazione degli aggiornamenti, è possibile usare [**IUpdateSearcher:: EndSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-endsearch), [**IUpdateDowloader:: Metodo**](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader), [**IUpdateInstaller:: EndInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-endinstall) e [**IUpdateInstaller:: EndUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-enduninstall) da qualsiasi thread.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-109">When you end a search, download, installation, or uninstallation of updates, you can use [**IUpdateSearcher::EndSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-endsearch), [**IUpdateDowloader::EndDownload**](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader), [**IUpdateInstaller::EndInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-endinstall) and [**IUpdateInstaller::EndUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-enduninstall) from any thread.</span></span>
-   <span data-ttu-id="8a0f5-110">Quando si avvia una ricerca, il download, l'installazione o la disinstallazione degli aggiornamenti tramite [**IUpdateSearcher:: BeginSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-beginsearch), [**IUpdateDownloader:: BeginDownload**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatedownloader-begindownload), [**IUpdateInstaller:: BeginInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-begininstall)e [**IUpdateInstaller:: BeginUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-beginuninstall), assicurarsi di mantenere un accesso sufficiente le autorizzazioni quando si rilasciano i riferimenti agli oggetti API WUA.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-110">When you start a search, download, installation, or uninstallation of updates by using [**IUpdateSearcher::BeginSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-beginsearch), [**IUpdateDownloader::BeginDownload**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatedownloader-begindownload), [**IUpdateInstaller::BeginInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-begininstall), and [**IUpdateInstaller::BeginUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-beginuninstall), ensure that you maintain sufficient access permisssions when you release references to WUA API objects.</span></span>
    -   <span data-ttu-id="8a0f5-111">Assicurarsi che per tutti gli oggetti di callback utilizzati nell'operazione asincrona non venga fatto riferimento prima di eliminarli.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-111">Make sure any callback objects that are used in the asynchronous operation are unreferenced before you destroy them.</span></span> <span data-ttu-id="8a0f5-112">Attendere che il conteggio dei riferimenti di un oggetto callback torni al valore iniziale prima di eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-112">Wait for the reference count of a callback object to return to the initial value before you destroy it.</span></span>
    -   <span data-ttu-id="8a0f5-113">Il riferimento all'oggetto processo restituito dal metodo **Begin** corrispondente deve essere controllato da un oggetto che differisce dagli oggetti di callback.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-113">The reference to the job object that is returned from the corresponding **Begin** method should be controlled by an object that differs from the callback objects.</span></span> <span data-ttu-id="8a0f5-114">Usare un oggetto diverso dagli oggetti di callback per evitare riferimenti circolari.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-114">Use an object that differs from the callback objects to avoid circular references.</span></span>
    -   <span data-ttu-id="8a0f5-115">Se si tenta di controllare il riferimento all'oggetto processo usando un oggetto callback, è necessario chiamare il metodo [**IDownloadJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-idownloadjob-cleanup), [**IInstallationJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-iinstallationjob-cleanup)o [**ISearchJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-isearchjob-cleanup) al di fuori della funzione di callback per disconnettere l'oggetto processo dall'oggetto callback.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-115">If you attempt to control the reference to the job object by using a callback object, you must call the [**IDownloadJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-idownloadjob-cleanup), [**IInstallationJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-iinstallationjob-cleanup), or [**ISearchJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-isearchjob-cleanup) method outside the callback function to disconnect the job object from the callback object.</span></span> <span data-ttu-id="8a0f5-116">È necessario eseguire questa operazione prima di rilasciare il riferimento all'oggetto processo restituito dal metodo **Begin** .</span><span class="sxs-lookup"><span data-stu-id="8a0f5-116">You must do this before you release the reference to the job object that is returned by the **Begin** method.</span></span>
-   <span data-ttu-id="8a0f5-117">Assicurarsi che le operazioni WUA asincrone siano completate.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-117">Make sure that asynchronous WUA operations are complete.</span></span> <span data-ttu-id="8a0f5-118">Windows script host può terminare uno script quando tutti i comandi all'esterno di qualsiasi funzione sono completati, anche se l'API WUA contiene ancora riferimenti all'oggetto callback.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-118">Windows Script Host can terminate a script when all the commands outside of any function are complete, even if the WUA API still has references to the callback object.</span></span>
    -   <span data-ttu-id="8a0f5-119">Usare uno dei metodi di **pulitura** o fare in modo che la funzione di callback imposti una variabile globale condivisa al termine dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-119">Use one of the **CleanUp** methods or have the callback function set a shared global variable upon completion.</span></span>
    -   <span data-ttu-id="8a0f5-120">Non chiamare mai [**IDownloadJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-idownloadjob-cleanup), [**IInstallationJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-iinstallationjob-cleanup)o [**ISearchJob:: Cleanup**](/windows/desktop/api/Wuapi/nf-wuapi-isearchjob-cleanup) su un oggetto processo nella relativa funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-120">Never call [**IDownloadJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-idownloadjob-cleanup), [**IInstallationJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-iinstallationjob-cleanup), or [**ISearchJob::CleanUp**](/windows/desktop/api/Wuapi/nf-wuapi-isearchjob-cleanup) on a job object in its callback function.</span></span>
    -   <span data-ttu-id="8a0f5-121">Per garantire la corretta sequenza di pulizia in uno script in esecuzione in Windows Internet Explorer, chiamare il metodo **Cleanup** su tutti gli oggetti processo durante l'elaborazione di Window. onbeforeunload.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-121">To ensure the correct clean-up sequence in a script that is running on Windows Internet Explorer, call the **CleanUp** method on all the job objects when processing window.onbeforeunload.</span></span>
-   <span data-ttu-id="8a0f5-122">Non usare tipi di dati definiti dall'utente (UDT) per le operazioni WUA asincrone.</span><span class="sxs-lookup"><span data-stu-id="8a0f5-122">Do not use user-defined data types (UDT) for asynchronous WUA operations.</span></span> <span data-ttu-id="8a0f5-123">Il tipo non è supportato da [**IUpdateSearcher:: BeginSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-beginsearch), [**IUpdateDownloader:: BeginDownload**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatedownloader-begindownload), [**IUpdateInstaller:: BeginInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-begininstall)o [**IUpdateInstaller:: BeginUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-beginuninstall).</span><span class="sxs-lookup"><span data-stu-id="8a0f5-123">The type is not supported by [**IUpdateSearcher::BeginSearch**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatesearcher-beginsearch), [**IUpdateDownloader::BeginDownload**](/windows/desktop/api/Wuapi/nf-wuapi-iupdatedownloader-begindownload), [**IUpdateInstaller::BeginInstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-begininstall), or [**IUpdateInstaller::BeginUninstall**](/windows/desktop/api/Wuapi/nf-wuapi-iupdateinstaller-beginuninstall).</span></span>

 

 
