---
description: Le API di manipolazione diretta consentono di creare ottime procedure per la panoramica, lo zoom e il trascinamento dell'esperienza utente. A tale scopo, elabora input tocco su un'area o un oggetto, genera trasformazioni di output e applica le trasformazioni agli elementi dell'interfaccia utente.
ms.assetid: 26358bc5-71e9-40f0-9243-9bddd961a0e5
title: Manipolazione diretta
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: 6db2a50893914dfb25050768f88cb289a1ecf3ea
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104124317"
---
# <a name="direct-manipulation"></a><span data-ttu-id="2f3ac-104">Manipolazione diretta</span><span class="sxs-lookup"><span data-stu-id="2f3ac-104">Direct Manipulation</span></span>

<span data-ttu-id="2f3ac-105">Le API di manipolazione diretta consentono di creare ottime procedure per la panoramica, lo zoom e il trascinamento dell'esperienza utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-105">The Direct Manipulation APIs let you create great pan, zoom, and drag user experiences.</span></span> <span data-ttu-id="2f3ac-106">A tale scopo, elabora input tocco su un'area o un oggetto, genera trasformazioni di output e applica le trasformazioni agli elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-106">To do this, it processes touch input on a region or object, generates output transforms, and applies the transforms to UI elements.</span></span> <span data-ttu-id="2f3ac-107">È possibile usare la manipolazione diretta per ottimizzare la velocità di risposta e ridurre la latenza tramite l'elaborazione di input fuori thread, l'hit testing di input fuori thread facoltativo e la stima di input/output.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-107">You can use Direct Manipulation to optimize responsiveness and reduce latency through off-thread input processing, optional off-thread input hit testing, and input/output prediction.</span></span>

<span data-ttu-id="2f3ac-108">Qualsiasi applicazione che usa la manipolazione diretta per elaborare interazioni touch Visualizza le animazioni di Windows 8 fluide e i comportamenti di feedback di interazione conformi alle [linee guida per le interazioni utente comuni](/windows/uwp/design/input/).</span><span class="sxs-lookup"><span data-stu-id="2f3ac-108">Any application that uses Direct Manipulation to process touch interactions displays the fluid Windows 8 animations and interaction feedback behaviors that conform to the [Guidelines for common user interactions](/windows/uwp/design/input/).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="2f3ac-109">Sviluppatori</span><span class="sxs-lookup"><span data-stu-id="2f3ac-109">Developer Audience</span></span>

<span data-ttu-id="2f3ac-110">L'API di manipolazione diretta è destinata agli sviluppatori esperti che conoscono C/C++, hanno una conoscenza approfondita del [Component Object Model (com)](../com/component-object-model--com--portal.md)e hanno familiarità con i concetti di programmazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-110">The Direct Manipulation API is for experienced developers who know C/C++, have a solid understanding of the [Component Object Model (COM)](../com/component-object-model--com--portal.md), and are familiar with Windows programming concepts.</span></span>

## <a name="run-time-requirements"></a><span data-ttu-id="2f3ac-111">Requisiti di runtime</span><span class="sxs-lookup"><span data-stu-id="2f3ac-111">Run-time requirements</span></span>

<span data-ttu-id="2f3ac-112">La manipolazione diretta è stata introdotta in Windows 8.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-112">Direct Manipulation was introduced in Windows 8.</span></span> <span data-ttu-id="2f3ac-113">È incluso nelle versioni a 32 bit e a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-113">It is included in both 32-bit and 64-bit versions.</span></span>

## <a name="why-use-directmanipulation"></a><span data-ttu-id="2f3ac-114">Perché usare DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2f3ac-114">Why use DirectManipulation</span></span>

### <a name="handles-interactions-in-a-straightforward-and-consistent-manner"></a><span data-ttu-id="2f3ac-115">Gestisce le interazioni in modo semplice e coerente</span><span class="sxs-lookup"><span data-stu-id="2f3ac-115">Handles interactions in a straightforward and consistent manner</span></span>

<span data-ttu-id="2f3ac-116">La manipolazione diretta funziona predichiarando i comportamenti e le interazioni per un'area o un oggetto.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-116">Direct Manipulation works by pre-declaring the behaviors and interactions for a region or object.</span></span> <span data-ttu-id="2f3ac-117">Una pagina Web, ad esempio, è spesso configurata per la panoramica e lo zoom.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-117">For example, a web page is often configured for pan and zoom.</span></span> <span data-ttu-id="2f3ac-118">In fase di esecuzione, l'input viene quindi associato a questa area/oggetto tramite una semplice chiamata API.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-118">At runtime, input is then associated with this region/object through a simple API call.</span></span> <span data-ttu-id="2f3ac-119">Da questo punto in poi la manipolazione diretta esegue tutte le operazioni di elaborazione dell'input, applicando vincoli e personalità e generando le trasformazioni di output.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-119">From this point forward Direct Manipulation does all the heavy lifting of processing the input, applying constraints and personality, and generating the output transforms.</span></span>

### <a name="build-responsive-touch-applications"></a><span data-ttu-id="2f3ac-120">Creazione di applicazioni touch reattive</span><span class="sxs-lookup"><span data-stu-id="2f3ac-120">Build responsive touch applications</span></span>

<span data-ttu-id="2f3ac-121">Per ottimizzare la velocità di risposta e ridurre al minimo la latenza, l'elaborazione della manipolazione diretta avviene in un thread indipendente separato dal thread UI.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-121">To optimize responsiveness and minimize latency, Direct Manipulation processing occurs on a separate, independent thread from the UI thread.</span></span> <span data-ttu-id="2f3ac-122">Di conseguenza, le trasformazioni di output possono essere eseguite in parallelo all'attività sul thread dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-122">As a result, output transforms can run in parallel to activity on the UI thread.</span></span> <span data-ttu-id="2f3ac-123">L'attività del thread dell'interfaccia utente può includere la logica dell'applicazione, il rendering, il layout e qualsiasi altro elemento che utilizza cicli nel processore.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-123">The UI thread activity may include application logic, rendering, layout, and anything else that consumes cycles on the processor.</span></span>

### <a name="implementation-flexibility"></a><span data-ttu-id="2f3ac-124">Flessibilità di implementazione</span><span class="sxs-lookup"><span data-stu-id="2f3ac-124">Implementation flexibility</span></span>

<span data-ttu-id="2f3ac-125">Le interfacce incluse con la manipolazione diretta forniscono un supporto completo per la gestione dell'input, il riconoscimento interazione, le notifiche di feedback e gli aggiornamenti dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-125">The interfaces included with Direct Manipulation provide comprehensive support for input handling, interaction recognition, feedback notifications, and UI updates.</span></span> <span data-ttu-id="2f3ac-126">Le interfacce incorporano anche servizi di sistema, ad esempio [DirectComposition](../directcomp/directcomposition-portal.md).</span><span class="sxs-lookup"><span data-stu-id="2f3ac-126">The interfaces also incorporate system services such as [DirectComposition](../directcomp/directcomposition-portal.md).</span></span>

## <a name="basic-concepts"></a><span data-ttu-id="2f3ac-127">Concetti fondamentali</span><span class="sxs-lookup"><span data-stu-id="2f3ac-127">Basic concepts</span></span>

<span data-ttu-id="2f3ac-128">L'implementazione della manipolazione diretta più semplice è costituita da un *viewport*, da un *contenuto* e da *interazioni*.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-128">The most basic Direct Manipulation implementation consists of a *viewport*, *content*, and *interactions*.</span></span> <span data-ttu-id="2f3ac-129">Il *viewport* è un'area in grado di ricevere ed elaborare l'input dalle interazioni utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-129">The *viewport* is a region that is able to receive and process input from user interactions.</span></span> <span data-ttu-id="2f3ac-130">È anche l'area del contenuto visibile per l'utente finale.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-130">It is also the region of the content that is visible to the end-user.</span></span> <span data-ttu-id="2f3ac-131">Il *contenuto* è l'oggetto effettivo che gli utenti finali possono vedere ed è ciò che si sposta o ridimensiona in risposta all'interazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-131">The *content* is the actual object that end-users can see and is what moves or scales in response to a user interaction.</span></span> <span data-ttu-id="2f3ac-132">Le *interazioni* dell'utente principale (note anche come *modifiche*) supportate dalla manipolazione diretta sono la panoramica e lo zoom.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-132">The primary user *interactions* (also known as *manipulations*) supported by Direct Manipulation are panning and zooming.</span></span> <span data-ttu-id="2f3ac-133">Queste interazioni applicano rispettivamente una trasformazione Converti o Ridimensiona al contenuto all'interno del viewport.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-133">These interactions apply a translate or scale transform to the content within the viewport, respectively.</span></span> <span data-ttu-id="2f3ac-134">È possibile configurare più Viewport (ognuno con il proprio contenuto) in un'unica finestra per creare un'interfaccia utente avanzata.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-134">Multiple viewports (each with their own content) can be configured in a single window to create a rich UI experience.</span></span>

<span data-ttu-id="2f3ac-135">In questa figura viene illustrata un'implementazione di base della manipolazione diretta prima e dopo la panoramica.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-135">This figure shows a basic Direct Manipulation implementation before and after panning.</span></span>

![implementazione di base della manipolazione diretta prima e dopo la panoramica.](images/dm-art-1.png)

<span data-ttu-id="2f3ac-137">Durante l'inizializzazione della manipolazione diretta, viene creata un'istanza dell'oggetto **DCompDirectManipulationCompositor** ed è associato alla manipolazione diretta.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-137">During initialization of Direct Manipulation a **DCompDirectManipulationCompositor** object is instantiated and is associated with Direct Manipulation.</span></span> <span data-ttu-id="2f3ac-138">Questo oggetto è un wrapper per [DirectComposition](../directcomp/directcomposition-portal.md), che è il compositore del sistema.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-138">This object is a wrapper around [DirectComposition](../directcomp/directcomposition-portal.md), which is the system compositor.</span></span> <span data-ttu-id="2f3ac-139">L'oggetto è responsabile dell'applicazione delle trasformazioni di output e della Guida degli aggiornamenti visivi.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-139">The object is responsible for applying the output transforms and driving visual updates.</span></span>

<span data-ttu-id="2f3ac-140">Un contatto rappresenta un punto di tocco identificato dalla **PointerId** fornita nel messaggio [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) .</span><span class="sxs-lookup"><span data-stu-id="2f3ac-140">A contact represents a touch point identified by the **pointerId** provided in the [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) message.</span></span> <span data-ttu-id="2f3ac-141">Quando viene ricevuto un messaggio **WM \_ POINTERDOWN** , l'applicazione chiama il [**secontatto**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span><span class="sxs-lookup"><span data-stu-id="2f3ac-141">When a **WM\_POINTERDOWN** message is received, the application calls [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span></span> <span data-ttu-id="2f3ac-142">L'applicazione invia una notifica diretta a Manipulationabout i contatti che devono essere gestiti e i viewport che devono rispondere a tali contatti.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-142">The application notifies Direct Manipulationabout the contacts that should be handled and the viewport(s) that should react to those contacts.</span></span> <span data-ttu-id="2f3ac-143">Gli input della tastiera e del mouse hanno valori **PointerId** speciali che possono essere gestiti in modo appropriato dalla manipolazione diretta.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-143">Keyboard and mouse input have special **pointerId** values so they can be handled appropriately by Direct Manipulation.</span></span>

<span data-ttu-id="2f3ac-144">Nel caso di base precedente, quando [**secontact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) viene chiamato, si verificano alcune operazioni:</span><span class="sxs-lookup"><span data-stu-id="2f3ac-144">In our basic case above, when [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) is called a few things happen:</span></span>

- <span data-ttu-id="2f3ac-145">Quando l'utente esegue una panoramica, viene inviato un messaggio [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) all'applicazione per notificare che il contatto è stato utilizzato dalla manipolazione diretta.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-145">When the user performs a pan, a [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) message is sent to the application to notify that the contact has been consumed by Direct Manipulation.</span></span>
- <span data-ttu-id="2f3ac-146">Quando l'utente sposta lo spostamento, il viewport genera gli eventi di aggiornamento che vengono usati dal wrapper [DirectComposition](../directcomp/directcomposition-portal.md) per guidare gli aggiornamenti visivi sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-146">When the user moves the moves, the viewport fires update events which are used by the [DirectComposition](../directcomp/directcomposition-portal.md) wrapper to drive visual updates to the screen.</span></span> <span data-ttu-id="2f3ac-147">Per la Panoramica di un utente in un viewport, il contenuto verrà visualizzato in modo graduale sotto il contatto.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-147">To a user panning in a viewport, the content will appear to move smoothly under the contact.</span></span>
- <span data-ttu-id="2f3ac-148">Quando l'utente solleva il contatto, l'utente vede che il contenuto continua a spostarsi mentre passa in un'animazione di inerzia, rallentando gradualmente fino a raggiungere il punto di riposo finale.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-148">When the user lifts the contact, the user sees the content continue to move as it transitions into an inertia animation, gradually decelerating until it reaches its final resting place.</span></span>

## <a name="processing-keyboard-and-mouse-input"></a><span data-ttu-id="2f3ac-149">Elaborazione dell'input da tastiera e mouse</span><span class="sxs-lookup"><span data-stu-id="2f3ac-149">Processing keyboard and mouse input</span></span>

<span data-ttu-id="2f3ac-150">La manipolazione diretta consente l'invio manuale dei messaggi della tastiera e del mouse dal thread dell'interfaccia utente dell'applicazione tramite l'API [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) in modo che possano essere gestiti in modo appropriato dalla manipolazione diretta.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-150">Direct Manipulation allows keyboard and mouse messages to be forwarded manually from the application UI thread via the [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) API such that they can be handled appropriately by Direct Manipulation.</span></span>

## <a name="directmanipulation-and-the-hwnd"></a><span data-ttu-id="2f3ac-151">DirectManipulation e HWND</span><span class="sxs-lookup"><span data-stu-id="2f3ac-151">DirectManipulation and the HWND</span></span>

<span data-ttu-id="2f3ac-152">La manipolazione diretta è associata a un HWND Win32 per ricevere ed elaborare i messaggi di input del puntatore per tale finestra.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-152">Direct Manipulation is associated with a Win32 HWND in order to receive and process pointer input messages for that window.</span></span> <span data-ttu-id="2f3ac-153">Poiché la manipolazione diretta calcola i valori di output, esegue le richiamate asincrone agli oggetti COM (Direct Manipulation [Component Object Model)](../com/component-object-model--com--portal.md) implementati nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-153">As Direct Manipulation computes output values, it makes asynchronous callbacks to the Direct Manipulation [Component Object Model (COM)](../com/component-object-model--com--portal.md) objects that are implemented in the application.</span></span> <span data-ttu-id="2f3ac-154">Questi callback informano l'applicazione sulla trasformazione applicata agli oggetti.</span><span class="sxs-lookup"><span data-stu-id="2f3ac-154">These callbacks inform the application about the transform that was applied to the objects.</span></span> <span data-ttu-id="2f3ac-155">La manipolazione diretta viene attivata sull'HWND specificato chiamando [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span><span class="sxs-lookup"><span data-stu-id="2f3ac-155">Direct Manipulation is activated on the specified HWND by calling [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span></span>

## <a name="supporting-documentation"></a><span data-ttu-id="2f3ac-156">Documentazione di supporto</span><span class="sxs-lookup"><span data-stu-id="2f3ac-156">Supporting documentation</span></span>

- [<span data-ttu-id="2f3ac-157">Viewport e contenuto</span><span class="sxs-lookup"><span data-stu-id="2f3ac-157">Viewports and content</span></span>](directmanipulation-viewports-and-content.md)
- [<span data-ttu-id="2f3ac-158">Uso di più viewport in DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2f3ac-158">Using multiple viewports in DirectManipulation</span></span>](directmanipulation-multiple-vieports.md)
- [<span data-ttu-id="2f3ac-159">Elaborazione dell'input con DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2f3ac-159">Processing input with DirectManipulation</span></span>](directmanipulation-processing-input-with-directmanipulation.md)
- [<span data-ttu-id="2f3ac-160">Motore di composizione</span><span class="sxs-lookup"><span data-stu-id="2f3ac-160">Composition engine</span></span>](directmanipulation-composition-engine.md)
- [<span data-ttu-id="2f3ac-161">Guida di riferimento alla manipolazione diretta</span><span class="sxs-lookup"><span data-stu-id="2f3ac-161">Direct Manipulation Reference</span></span>](direct-manipulation-reference.md)

- [<span data-ttu-id="2f3ac-162">BUILD 2013: WCL-022: rendere l'app desktop eccezionale grazie a tocco, mouse e penna</span><span class="sxs-lookup"><span data-stu-id="2f3ac-162">BUILD 2013: WCL-022: Make your desktop app great with touch, mouse, and pen</span></span>](https://channel9.msdn.com/Events/Build/2013/4-022)
- [<span data-ttu-id="2f3ac-163">Esempio di elaborazione di input touch con manipolazione diretta</span><span class="sxs-lookup"><span data-stu-id="2f3ac-163">Process touch input with Direct Manipulation sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/1d363ff4bd17d8e20415b92e2ee989d615cc0d91/Samples/TouchInputDirectManipulation)
