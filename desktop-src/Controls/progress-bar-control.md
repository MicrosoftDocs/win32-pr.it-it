---
title: Informazioni sui controlli indicatore di stato
description: Un indicatore di stato è una finestra che può essere utilizzata da un'applicazione per indicare lo stato di avanzamento di un'operazione di lunga durata. È costituito da un rettangolo che viene animato durante l'avanzamento di un'operazione.
ms.assetid: 1db7a5c9-71cd-4ebc-86b8-8159f30348fa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f00c80b1f9e97cec1657fe979a19437f607251b8
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730450"
---
# <a name="about-progress-bar-controls"></a><span data-ttu-id="92ad5-104">Informazioni sui controlli indicatore di stato</span><span class="sxs-lookup"><span data-stu-id="92ad5-104">About Progress Bar Controls</span></span>

<span data-ttu-id="92ad5-105">Un indicatore di stato è una finestra che può essere utilizzata da un'applicazione per indicare lo stato di avanzamento di un'operazione di lunga durata.</span><span class="sxs-lookup"><span data-stu-id="92ad5-105">A progress bar is a window that an application can use to indicate the progress of a lengthy operation.</span></span>

<span data-ttu-id="92ad5-106">È costituito da un rettangolo che viene animato durante l'avanzamento di un'operazione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-106">It consists of a rectangle that is animated as an operation progresses.</span></span>

<span data-ttu-id="92ad5-107">La figura seguente mostra un indicatore di stato che non usa gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-107">The following illustration shows a progress bar that does not use visual styles.</span></span>

![Screenshot di un indicatore di stato che aggiunge rettangoli in una riga per indicare lo stato di avanzamento](images/pb-oldstyle.png)

<span data-ttu-id="92ad5-109">La figura seguente mostra un indicatore di stato con gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-109">The following illustration shows a progress bar using visual styles.</span></span> <span data-ttu-id="92ad5-110">L'aspetto del controllo può variare a seconda del sistema operativo e del tema selezionato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-110">The appearance of the control will vary depending on the operating system and the selected theme.</span></span> <span data-ttu-id="92ad5-111">Per altre informazioni, vedere [stili di visualizzazione](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="92ad5-111">For more information, see [Visual Styles](themes-overview.md).</span></span>

![Screenshot di un indicatore di stato che allunga un rettangolo verde animato per indicare lo stato di avanzamento](images/pb-newstyle.png)

<span data-ttu-id="92ad5-113">Altre informazioni sono contenute nelle intestazioni riportate di seguito.</span><span class="sxs-lookup"><span data-stu-id="92ad5-113">More information is contained under the following headings.</span></span>

-   [<span data-ttu-id="92ad5-114">Uso delle barre di stato</span><span class="sxs-lookup"><span data-stu-id="92ad5-114">Using Progress Bars</span></span>](#using-progress-bars)
    -   [<span data-ttu-id="92ad5-115">Intervallo e posizione corrente</span><span class="sxs-lookup"><span data-stu-id="92ad5-115">Range and Current Position</span></span>](#range-and-current-position)
    -   [<span data-ttu-id="92ad5-116">Elaborazione messaggio indicatore di stato predefinito</span><span class="sxs-lookup"><span data-stu-id="92ad5-116">Default Progress Bar Message Processing</span></span>](#default-progress-bar-message-processing)
    -   [<span data-ttu-id="92ad5-117">Stile Marquee</span><span class="sxs-lookup"><span data-stu-id="92ad5-117">Marquee Style</span></span>](#marquee-style)

## <a name="using-progress-bars"></a><span data-ttu-id="92ad5-118">Uso delle barre di stato</span><span class="sxs-lookup"><span data-stu-id="92ad5-118">Using Progress Bars</span></span>

<span data-ttu-id="92ad5-119">È possibile creare un indicatore di stato usando la funzione [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) , specificando la classe della finestra di [**avanzamento della \_ classe**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="92ad5-119">You can create a progress bar by using the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**PROGRESS\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="92ad5-120">Questa classe della finestra viene registrata quando viene caricata la DLL dei controlli comuni.</span><span class="sxs-lookup"><span data-stu-id="92ad5-120">This window class is registered when the common controls DLL is loaded.</span></span> <span data-ttu-id="92ad5-121">Per ulteriori informazioni, vedere [informazioni sui controlli comuni](common-controls-intro.md).</span><span class="sxs-lookup"><span data-stu-id="92ad5-121">For more information, see [About Common Controls](common-controls-intro.md).</span></span>

<span data-ttu-id="92ad5-122">Il controllo è disponibile anche nella casella degli strumenti Microsoft Visual Studio, dove viene chiamato controllo dello stato di avanzamento.</span><span class="sxs-lookup"><span data-stu-id="92ad5-122">The control is also available in the Microsoft Visual Studio Toolbox, where it is called Progress Control.</span></span>

### <a name="range-and-current-position"></a><span data-ttu-id="92ad5-123">Intervallo e posizione corrente</span><span class="sxs-lookup"><span data-stu-id="92ad5-123">Range and Current Position</span></span>

<span data-ttu-id="92ad5-124">L' *intervallo* di un indicatore di stato rappresenta l'intera durata dell'operazione e la *posizione corrente* rappresenta lo stato di avanzamento dell'applicazione verso il completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-124">A progress bar's *range* represents the entire duration of the operation, and the *current position* represents the progress that the application has made toward completing the operation.</span></span> <span data-ttu-id="92ad5-125">La routine della finestra usa l'intervallo e la posizione corrente per determinare la percentuale dell'indicatore di stato da riempire con il colore di evidenziazione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-125">The window procedure uses the range and the current position to determine the percentage of the progress bar to fill with the highlight color.</span></span>

<span data-ttu-id="92ad5-126">Se non si impostano i valori di intervallo, il sistema imposta il valore minimo su 0 e il valore massimo su 100.</span><span class="sxs-lookup"><span data-stu-id="92ad5-126">If you do not set the range values, the system sets the minimum value to 0 and the maximum value to 100.</span></span> <span data-ttu-id="92ad5-127">È possibile regolare l'intervallo con i valori integer pratici usando il messaggio di [**\_ SetRange PBM**](pbm-setrange.md) .</span><span class="sxs-lookup"><span data-stu-id="92ad5-127">You can adjust the range to convenient integers by using the [**PBM\_SETRANGE**](pbm-setrange.md) message.</span></span>

<span data-ttu-id="92ad5-128">Un indicatore di stato fornisce diversi messaggi che è possibile utilizzare per impostare la posizione corrente.</span><span class="sxs-lookup"><span data-stu-id="92ad5-128">A progress bar provides several messages that you can use to set the current position.</span></span> <span data-ttu-id="92ad5-129">Il [**messaggio \_ SETPOS di PBM**](pbm-setpos.md) imposta la posizione su un valore specificato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-129">The [**PBM\_SETPOS**](pbm-setpos.md) message sets the position to a given value.</span></span> <span data-ttu-id="92ad5-130">Il [**messaggio \_ DELTAPOS di PBM**](pbm-deltapos.md) fa avanzare la posizione aggiungendo un valore specificato alla posizione corrente.</span><span class="sxs-lookup"><span data-stu-id="92ad5-130">The [**PBM\_DELTAPOS**](pbm-deltapos.md) message advances the position by adding a specified value to the current position.</span></span>

<span data-ttu-id="92ad5-131">Il messaggio con estensione PBM consente di specificare un incremento del passaggio per un indicatore di stato. [**\_**](pbm-setstep.md)</span><span class="sxs-lookup"><span data-stu-id="92ad5-131">The [**PBM\_SETSTEP**](pbm-setstep.md) message allows you to specify a step increment for a progress bar.</span></span> <span data-ttu-id="92ad5-132">Successivamente, ogni volta che si invia il messaggio [**\_ STEPIT di PBM**](pbm-stepit.md) all'indicatore di stato, la posizione corrente avanza in base all'incremento specificato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-132">Subsequently, whenever you send the [**PBM\_STEPIT**](pbm-stepit.md) message to the progress bar, the current position advances by the specified increment.</span></span> <span data-ttu-id="92ad5-133">Per impostazione predefinita, l'incremento del passaggio è impostato su 10.</span><span class="sxs-lookup"><span data-stu-id="92ad5-133">By default, the step increment is set to 10.</span></span>

### <a name="default-progress-bar-message-processing"></a><span data-ttu-id="92ad5-134">Elaborazione messaggio indicatore di stato predefinito</span><span class="sxs-lookup"><span data-stu-id="92ad5-134">Default Progress Bar Message Processing</span></span>

<span data-ttu-id="92ad5-135">In questa sezione vengono descritti i messaggi gestiti dalla routine della finestra [**per \_ la classe Progress**](common-control-window-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="92ad5-135">This section describes the messages handled by the window procedure for the [**PROGRESS\_CLASS**](common-control-window-classes.md) class.</span></span>



| <span data-ttu-id="92ad5-136">Message</span><span class="sxs-lookup"><span data-stu-id="92ad5-136">Message</span></span>            | <span data-ttu-id="92ad5-137">Elaborazione eseguita</span><span class="sxs-lookup"><span data-stu-id="92ad5-137">Processing performed</span></span>                                                                                                                                                               |
|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="92ad5-138">**creazione di WM \_**</span><span class="sxs-lookup"><span data-stu-id="92ad5-138">**WM\_CREATE**</span></span>     | <span data-ttu-id="92ad5-139">Alloca e Inizializza una struttura iniziale.</span><span class="sxs-lookup"><span data-stu-id="92ad5-139">Allocates and initializes an initial structure.</span></span>                                                                                                                                    |
| <span data-ttu-id="92ad5-140">**eliminazione di WM \_**</span><span class="sxs-lookup"><span data-stu-id="92ad5-140">**WM\_DESTROY**</span></span>    | <span data-ttu-id="92ad5-141">Libera tutte le risorse associate all'indicatore di stato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-141">Frees all resources associated with the progress bar.</span></span>                                                                                                                              |
| <span data-ttu-id="92ad5-142">**\_ERASEBKGND WM**</span><span class="sxs-lookup"><span data-stu-id="92ad5-142">**WM\_ERASEBKGND**</span></span> | <span data-ttu-id="92ad5-143">Disegna lo sfondo e i bordi dell'indicatore di stato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-143">Draws the background and borders of the progress bar.</span></span>                                                                                                                              |
| <span data-ttu-id="92ad5-144">**\_tipo di carattere WM GetFont**</span><span class="sxs-lookup"><span data-stu-id="92ad5-144">**WM\_GETFONT**</span></span>    | <span data-ttu-id="92ad5-145">Restituisce l'handle per il tipo di carattere corrente.</span><span class="sxs-lookup"><span data-stu-id="92ad5-145">Returns the handle to the current font.</span></span> <span data-ttu-id="92ad5-146">Nell'indicatore di stato non viene attualmente disegnato il testo, quindi l'invio di questo messaggio non ha alcun effetto sul controllo.</span><span class="sxs-lookup"><span data-stu-id="92ad5-146">The progress bar does not currently draw text, so sending this message has no effect on the control.</span></span>                                       |
| <span data-ttu-id="92ad5-147">**\_disegno WM**</span><span class="sxs-lookup"><span data-stu-id="92ad5-147">**WM\_PAINT**</span></span>      | <span data-ttu-id="92ad5-148">Disegna l'indicatore di stato.</span><span class="sxs-lookup"><span data-stu-id="92ad5-148">Draws the progress bar.</span></span> <span data-ttu-id="92ad5-149">Se il parametro *wParam* è diverso da **null**, il controllo presuppone che il valore sia un HDC e i colori che usano tale contesto di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="92ad5-149">If the *wParam* parameter is non-**NULL**, the control assumes that the value is an HDC and paints using that device context.</span></span>                              |
| <span data-ttu-id="92ad5-150">**\_tipo di carattere WM**</span><span class="sxs-lookup"><span data-stu-id="92ad5-150">**WM\_SETFONT**</span></span>    | <span data-ttu-id="92ad5-151">Salva l'handle nel nuovo tipo di carattere e restituisce l'handle al tipo di carattere precedente.</span><span class="sxs-lookup"><span data-stu-id="92ad5-151">Saves the handle to the new font and returns the handle to the previous font.</span></span> <span data-ttu-id="92ad5-152">Nell'indicatore di stato non viene attualmente disegnato il testo, quindi l'invio di questo messaggio non ha alcun effetto sul controllo.</span><span class="sxs-lookup"><span data-stu-id="92ad5-152">The progress bar does not currently draw text, so sending this message has no effect on the control.</span></span> |



 

### <a name="marquee-style"></a><span data-ttu-id="92ad5-153">Stile Marquee</span><span class="sxs-lookup"><span data-stu-id="92ad5-153">Marquee Style</span></span>

<span data-ttu-id="92ad5-154">Creando il controllo indicatore di stato con lo stile di [**\_ selezione PBS**](progress-bar-control-styles.md) , è possibile animarlo in modo che mostri l'attività, ma non indichi quale percentuale dell'attività è stata completata.</span><span class="sxs-lookup"><span data-stu-id="92ad5-154">By creating the progress bar control with the [**PBS\_MARQUEE**](progress-bar-control-styles.md) style, you can animate it in a way that shows activity but does not indicate what proportion of the task is complete.</span></span> <span data-ttu-id="92ad5-155">La parte evidenziata dell'indicatore di stato viene spostata ripetutamente lungo la lunghezza della barra.</span><span class="sxs-lookup"><span data-stu-id="92ad5-155">The highlighted part of the progress bar moves repeatedly along the length of the bar.</span></span> <span data-ttu-id="92ad5-156">È possibile avviare e arrestare l'animazione e controllarne la velocità inviando il messaggio di proprietà [**PBM \_**](pbm-setmarquee.md) .</span><span class="sxs-lookup"><span data-stu-id="92ad5-156">You can start and stop the animation, and control its speed, by sending the [**PBM\_SETMARQUEE**](pbm-setmarquee.md) message.</span></span> <span data-ttu-id="92ad5-157">Gli indicatori di stato Marquee non hanno un intervallo o una posizione.</span><span class="sxs-lookup"><span data-stu-id="92ad5-157">Marquee progress bars do not have a range or position.</span></span>

<span data-ttu-id="92ad5-158">La figura seguente mostra un indicatore di stato in modalità marquee.</span><span class="sxs-lookup"><span data-stu-id="92ad5-158">The following illustration shows a progress bar in marquee mode.</span></span> <span data-ttu-id="92ad5-159">La parte evidenziata si sposta sulla barra.</span><span class="sxs-lookup"><span data-stu-id="92ad5-159">The highlighted part moves across the bar.</span></span>

![Screenshot di un indicatore di stato che sposta un'evidenziazione verde in un rettangolo grigio per indicare lo stato di avanzamento](images/pb-marquee.png)

 

 