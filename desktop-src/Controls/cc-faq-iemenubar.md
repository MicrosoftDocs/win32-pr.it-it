---
title: Come creare una barra dei menu Explorer-Style Internet
description: A prima vista, la barra dei menu in Microsoft Internet Explorer 5 e versioni successive ha un aspetto simile a quello di un menu standard. Tuttavia, l'aspetto è molto diverso quando si inizia a usarlo.
ms.assetid: e0fe25f2-3d49-4c5a-a3f9-2f468f2cfef2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b262bc55407d263c97d4bd7e3938a9794d3a58f5
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "103873001"
---
# <a name="how-to-create-an-internet-explorer-style-menu-bar"></a><span data-ttu-id="6d80f-104">Come creare una barra dei menu Explorer-Style Internet</span><span class="sxs-lookup"><span data-stu-id="6d80f-104">How to Create an Internet Explorer-Style Menu Bar</span></span>

<span data-ttu-id="6d80f-105">A prima vista, la barra dei menu in Microsoft Internet Explorer 5 e versioni successive ha un aspetto simile a quello di un menu standard.</span><span class="sxs-lookup"><span data-stu-id="6d80f-105">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="6d80f-106">Tuttavia, l'aspetto è molto diverso quando si inizia a usarlo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-106">However, it looks quite different when you begin using it.</span></span>

<span data-ttu-id="6d80f-107">Lo screenshot seguente mostra la barra dei menu di Windows Internet Explorer con il menu strumenti selezionato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-107">The following screen shot shows the Windows Internet Explorer menu bar with the Tools menu selected.</span></span>

![screenshot che mostra la barra dei menu di Windows Internet Explorer con il menu strumenti selezionato](images/howto8.jpg)

<span data-ttu-id="6d80f-109">La barra dei menu è in realtà un controllo Toolbar simile a un menu standard.</span><span class="sxs-lookup"><span data-stu-id="6d80f-109">The menu bar is actually a toolbar control that looks like a standard menu.</span></span> <span data-ttu-id="6d80f-110">Anziché le voci di menu di primo livello, una barra dei menu include una serie di pulsanti di solo testo che visualizzano un menu a discesa quando si fa clic su di esso.</span><span class="sxs-lookup"><span data-stu-id="6d80f-110">Instead of top-level menu items, a menu bar has a series of text-only buttons that display a drop-down menu when clicked.</span></span> <span data-ttu-id="6d80f-111">Tuttavia, come tipo specializzato di barra degli strumenti, una barra dei menu presenta alcune funzionalità non disponibili nei menu standard:</span><span class="sxs-lookup"><span data-stu-id="6d80f-111">However, as a specialized type of toolbar, a menu bar has some capabilities that standard menus lack:</span></span>

-   <span data-ttu-id="6d80f-112">Può essere personalizzato utilizzando le tecniche standard della barra degli strumenti, consentendo all'utente di spostare, eliminare o aggiungere elementi.</span><span class="sxs-lookup"><span data-stu-id="6d80f-112">It can be customized using standard toolbar techniques, allowing the user to move, delete, or add items.</span></span>
-   <span data-ttu-id="6d80f-113">È possibile eseguire il monitoraggio a caldo, in modo che gli utenti sappiano quando si trovano su un elemento di livello superiore senza prima fare clic su di esso.</span><span class="sxs-lookup"><span data-stu-id="6d80f-113">It can have hot-tracking, so that users will know when they are over a top-level item without having to click it first.</span></span>

<span data-ttu-id="6d80f-114">Una barra dei menu può essere incorporata in un controllo Rebar, fornendo le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="6d80f-114">A menu bar can be incorporated into a rebar control, giving it the following features:</span></span>

-   <span data-ttu-id="6d80f-115">Può avere un grip, che consente all'utente di spostare o ridimensionare la banda.</span><span class="sxs-lookup"><span data-stu-id="6d80f-115">It can have a gripper, which allows the user to move or resize the band.</span></span>
-   <span data-ttu-id="6d80f-116">Può condividere una striscia nel controllo Rebar con altre bande, ad esempio la barra degli strumenti standard nella figura precedente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-116">It can share a strip in the rebar control with other bands, such as the standard toolbar in the preceding illustration.</span></span>
-   <span data-ttu-id="6d80f-117">Può visualizzare una freccia di espansione quando è coperta da una banda adiacente, concedendo all'utente l'accesso agli elementi nascosti.</span><span class="sxs-lookup"><span data-stu-id="6d80f-117">It can display a chevron when it is covered by an adjacent band, giving the user access to the hidden items.</span></span>
-   <span data-ttu-id="6d80f-118">Può avere una bitmap di sfondo definita dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6d80f-118">It can have an application-defined background bitmap.</span></span>

<span data-ttu-id="6d80f-119">In questo argomento viene illustrato come implementare una barra dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-119">This topic discusses how to implement a menu bar.</span></span> <span data-ttu-id="6d80f-120">Poiché una barra dei menu è un'implementazione specializzata di un controllo Toolbar, lo stato attivo si troverà negli argomenti specifici delle barre dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-120">Since a menu bar is a specialized implementation of a toolbar control, the focus will be on topics that are specific to menu bars.</span></span> <span data-ttu-id="6d80f-121">Per informazioni su come incorporare una barra degli strumenti in un controllo Rebar, vedere [come creare una barra degli strumenti Explorer-Style Internet](cc-faq-ietoolbar.md) e [informazioni sui controlli Rebar](rebar-controls.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-121">For a discussion of how to incorporate a toolbar into a rebar control, see [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) and [About Rebar Controls](rebar-controls.md).</span></span>

-   [<span data-ttu-id="6d80f-122">Creazione di una barra degli strumenti in una barra dei menu</span><span class="sxs-lookup"><span data-stu-id="6d80f-122">Making a Toolbar into a Menu Bar</span></span>](#making-a-toolbar-into-a-menu-bar)
-   [<span data-ttu-id="6d80f-123">Gestione della navigazione con il menu Hot-Tracking disabilitato</span><span class="sxs-lookup"><span data-stu-id="6d80f-123">Handling Navigation with Menu Hot-Tracking Disabled</span></span>](#handling-navigation-with-menu-hot-tracking-disabled)
    -   [<span data-ttu-id="6d80f-124">Navigazione del mouse</span><span class="sxs-lookup"><span data-stu-id="6d80f-124">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="6d80f-125">Navigazione da tastiera</span><span class="sxs-lookup"><span data-stu-id="6d80f-125">Keyboard Navigation</span></span>](#keyboard-navigation)
    -   [<span data-ttu-id="6d80f-126">Navigazione mista</span><span class="sxs-lookup"><span data-stu-id="6d80f-126">Mixed Navigation</span></span>](#mixed-navigation)
-   [<span data-ttu-id="6d80f-127">Gestione della navigazione con il menu Hot-Tracking abilitato</span><span class="sxs-lookup"><span data-stu-id="6d80f-127">Handling Navigation with Menu Hot-Tracking Enabled</span></span>](#handling-navigation-with-menu-hot-tracking-enabled)
    -   [<span data-ttu-id="6d80f-128">Elaborazione dei messaggi per il rilevamento a caldo del menu</span><span class="sxs-lookup"><span data-stu-id="6d80f-128">Message Processing for Menu Hot-Tracking</span></span>](#message-processing-for-menu-hot-tracking)
    -   [<span data-ttu-id="6d80f-129">Navigazione del mouse</span><span class="sxs-lookup"><span data-stu-id="6d80f-129">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="6d80f-130">Navigazione da tastiera</span><span class="sxs-lookup"><span data-stu-id="6d80f-130">Keyboard Navigation</span></span>](#keyboard-navigation)

## <a name="making-a-toolbar-into-a-menu-bar"></a><span data-ttu-id="6d80f-131">Creazione di una barra degli strumenti in una barra dei menu</span><span class="sxs-lookup"><span data-stu-id="6d80f-131">Making a Toolbar into a Menu Bar</span></span>

<span data-ttu-id="6d80f-132">Per creare una barra degli strumenti in una barra dei menu:</span><span class="sxs-lookup"><span data-stu-id="6d80f-132">To make a toolbar into a menu bar:</span></span>

-   <span data-ttu-id="6d80f-133">Creare una barra degli strumenti Flat includendo [**TBSTYLE \_ Flat**](toolbar-control-and-button-styles.md) con gli altri flag di stile della finestra.</span><span class="sxs-lookup"><span data-stu-id="6d80f-133">Create a flat toolbar by including [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="6d80f-134">Lo **stile \_ Flat TBSTYLE** Abilita anche il rilevamento a caldo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-134">The **TBSTYLE\_FLAT** style also enables hot-tracking.</span></span> <span data-ttu-id="6d80f-135">Con questo stile, la barra dei menu è simile a un menu standard fino a quando l'utente non attiva un pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-135">With this style, the menu bar looks much like a standard menu until the user activates a button.</span></span> <span data-ttu-id="6d80f-136">Quindi, il pulsante sembra uscire dalla barra degli strumenti e premere quando si fa clic su di esso, proprio come un pulsante standard.</span><span class="sxs-lookup"><span data-stu-id="6d80f-136">Then, the button appears to stand out from the toolbar and depress when it is clicked, just like a standard button.</span></span> <span data-ttu-id="6d80f-137">Poiché il rilevamento a caldo è abilitato, per attivare un pulsante è sufficiente passare il puntatore del mouse su di esso.</span><span class="sxs-lookup"><span data-stu-id="6d80f-137">Because hot-tracking is enabled, all that is needed to activate a button is for the cursor to hover over it.</span></span> <span data-ttu-id="6d80f-138">Se il cursore si sposta su un altro pulsante, viene attivato e il pulsante precedente viene disattivato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-138">If the cursor moves to another button, it will be activated and the old button deactivated.</span></span>
-   <span data-ttu-id="6d80f-139">Creare pulsanti di tipo elenco includendo [**l' \_ elenco TBSTYLE**](toolbar-control-and-button-styles.md) con gli altri flag di stile della finestra.</span><span class="sxs-lookup"><span data-stu-id="6d80f-139">Create list-style buttons by including [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="6d80f-140">Questo stile crea un pulsante più sottile che sembra più simile a una voce di menu di primo livello standard.</span><span class="sxs-lookup"><span data-stu-id="6d80f-140">This style creates a thinner button that looks more like a standard top-level menu item.</span></span>
-   <span data-ttu-id="6d80f-141">Impostare i pulsanti solo per il testo impostando il membro **iBitmap** della struttura [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) del pulsante su i \_ IMAGENONE e il  membro di di base al testo del pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-141">Make the buttons text-only by setting the **iBitmap** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to I\_IMAGENONE and the **iString** member to the button text.</span></span>
-   <span data-ttu-id="6d80f-142">Assegnare a ogni pulsante lo stile a [**\_ discesa BTNS**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-142">Give each button the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="6d80f-143">Quando si fa clic sul pulsante, il controllo Toolbar invia all'applicazione una notifica a [ \_ discesa TBN](tbn-dropdown.md) per chiedere di visualizzare il menu del pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-143">When the button is clicked, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification to prompt it to display the button's menu.</span></span>
-   <span data-ttu-id="6d80f-144">Incorporare la barra dei menu in una banda del controllo Rebar.</span><span class="sxs-lookup"><span data-stu-id="6d80f-144">Incorporate the menu bar into a rebar band.</span></span> <span data-ttu-id="6d80f-145">Abilitare sia i grip che le frecce, come illustrato in [come creare una barra degli strumenti Explorer-Style Internet](cc-faq-ietoolbar.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-145">Enable both grippers and chevrons, as discussed in [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span></span>
-   <span data-ttu-id="6d80f-146">Implementare un gestore a [ \_ discesa TBN](tbn-dropdown.md) per visualizzare il *menu a discesa* del pulsante quando viene selezionato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-146">Implement a [TBN\_DROPDOWN](tbn-dropdown.md) handler to display the button's *drop-down menu* when it is clicked.</span></span> <span data-ttu-id="6d80f-147">Il menu a discesa è un tipo di menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="6d80f-147">The drop-down menu is a type of pop-up menu.</span></span> <span data-ttu-id="6d80f-148">Viene creato tramite la funzione [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) , con l'angolo superiore sinistro allineato all'angolo inferiore sinistro del pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-148">It is created by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function, with its upper-left corner aligned with the lower-left corner of the button.</span></span>
-   <span data-ttu-id="6d80f-149">Implementare la navigazione tramite tastiera, in modo che la barra dei menu sia completamente accessibile senza mouse.</span><span class="sxs-lookup"><span data-stu-id="6d80f-149">Implement keyboard navigation, so that the menu bar is fully accessible without a mouse.</span></span>
-   <span data-ttu-id="6d80f-150">Implementare il monitoraggio a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-150">Implement menu hot-tracking.</span></span> <span data-ttu-id="6d80f-151">Con i menu standard, dopo che è stato visualizzato il menu di una voce di menu di primo livello, lo stato del cursore su un altro elemento di primo livello Visualizza automaticamente il menu e comprime il menu dell'elemento precedente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-151">With standard menus, once a top level menu item's menu has been displayed, moving the cursor over another top-level item automatically displays its menu and collapses the menu of the previous item.</span></span> <span data-ttu-id="6d80f-152">Il controllo Toolbar rileverà il cursore e modificherà l'immagine del pulsante, ma visualizzerà automaticamente il nuovo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-152">The toolbar control will hot-track the cursor and change the button image, but it does automatically display the new menu.</span></span> <span data-ttu-id="6d80f-153">L'applicazione deve eseguire questa operazione in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="6d80f-153">Your application must do so explicitly.</span></span>

<span data-ttu-id="6d80f-154">La maggior parte di questi elementi è semplice da implementare e viene discussa altrove.</span><span class="sxs-lookup"><span data-stu-id="6d80f-154">Most of these items are straightforward to implement and are discussed elsewhere.</span></span> <span data-ttu-id="6d80f-155">Per informazioni generali su come usare le barre degli strumenti e i controlli Rebar, vedere [come creare una barra degli strumenti Explorer-Style Internet](cc-faq-ietoolbar.md), [informazioni sui controlli della barra degli strumenti](toolbar-controls-overview.md)o [sui controlli Rebar](rebar-controls.md) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-155">See [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md), [About Toolbar Controls](toolbar-controls-overview.md), or [About Rebar Controls](rebar-controls.md) for a general discussion of how to use toolbars and rebar controls.</span></span> <span data-ttu-id="6d80f-156">Per informazioni su come gestire i menu popup, vedere i [menu](/windows/desktop/menurc/menus) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-156">See [Menus](/windows/desktop/menurc/menus) for a discussion of how to handle pop-up menus.</span></span> <span data-ttu-id="6d80f-157">Nella parte restante di questo argomento vengono illustrati i due elementi finali, la navigazione da tastiera e il monitoraggio a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-157">The final two items, keyboard navigation and menu hot-tracking, are discussed in the remainder of this topic.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-disabled"></a><span data-ttu-id="6d80f-158">Gestione della navigazione con il menu Hot-Tracking disabilitato</span><span class="sxs-lookup"><span data-stu-id="6d80f-158">Handling Navigation with Menu Hot-Tracking Disabled</span></span>

<span data-ttu-id="6d80f-159">Gli utenti possono scegliere di spostarsi sulla barra dei menu con il mouse, la tastiera o una combinazione di entrambi.</span><span class="sxs-lookup"><span data-stu-id="6d80f-159">Users can choose to navigate the menu bar with the mouse, the keyboard, or a mixture of both.</span></span> <span data-ttu-id="6d80f-160">Per implementare la navigazione della barra dei menu, l'applicazione deve gestire le notifiche della barra degli strumenti e monitorare il mouse e la tastiera.</span><span class="sxs-lookup"><span data-stu-id="6d80f-160">To implement menu bar navigation, your application must handle toolbar notifications and monitor the mouse and keyboard.</span></span> <span data-ttu-id="6d80f-161">Questa attività può essere suddivisa in due parti distinte: con e senza rilevamento a caldo dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-161">This task can be broken into two distinct parts: with and without menu hot-tracking.</span></span> <span data-ttu-id="6d80f-162">In questa sezione viene illustrato come gestire la navigazione quando non viene visualizzato alcun menu e il menu di scelta rapida non è abilitato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-162">This section discusses how to handle navigation when no menus are displayed and menu hot-tracking is not enabled.</span></span>

### <a name="mouse-navigation"></a><span data-ttu-id="6d80f-163">Navigazione del mouse</span><span class="sxs-lookup"><span data-stu-id="6d80f-163">Mouse Navigation</span></span>

<span data-ttu-id="6d80f-164">Se la registrazione a caldo del menu è disabilitata, è possibile trattare una barra dei menu come barra degli strumenti normale.</span><span class="sxs-lookup"><span data-stu-id="6d80f-164">If menu hot-tracking is disabled, you can treat a menu bar as a normal toolbar.</span></span> <span data-ttu-id="6d80f-165">Se l'utente si sposta con un mouse, è necessario che tutte le applicazioni eseguano la gestione della notifica a [ \_ discesa TBN](tbn-dropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-165">If the user is navigating with a mouse, all your application needs to do is handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="6d80f-166">Quando viene ricevuta questa notifica, Visualizza il menu a discesa appropriato e Abilita il rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-166">When this notification is received, display the appropriate drop-down menu, and enable menu hot-tracking.</span></span> <span data-ttu-id="6d80f-167">Da quel punto in poi, si sta usando il menu di scelta rapida per la [gestione della navigazione con il menu Hot-Tracking abilitata](#handling-navigation-with-menu-hot-tracking-enabled).</span><span class="sxs-lookup"><span data-stu-id="6d80f-167">From then on, you are in the menu hot-tracking regime discussed in [Handling Navigation with Menu Hot-Tracking Enabled](#handling-navigation-with-menu-hot-tracking-enabled).</span></span>

<span data-ttu-id="6d80f-168">Come descritto in [navigazione mista](#mixed-navigation), è anche necessario gestire la notifica [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) per tenere traccia del pulsante attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-168">As discussed in [Mixed Navigation](#mixed-navigation), you also need to handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="6d80f-169">Questa notifica non è rilevante se l'utente si sposta solo con il mouse, ma è necessario quando lo spostamento del mouse e della tastiera è misto.</span><span class="sxs-lookup"><span data-stu-id="6d80f-169">This notification is irrelevant if the user is only navigating with the mouse, but it is necessary when mouse and keyboard navigation are mixed.</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="6d80f-170">Navigazione tramite tastiera</span><span class="sxs-lookup"><span data-stu-id="6d80f-170">Keyboard Navigation</span></span>

<span data-ttu-id="6d80f-171">Come indicato nella sezione precedente, l'utente può eseguire una serie di operazioni di spostamento con la tastiera quando il menu di rilevamento a caldo è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-171">As noted in the previous section, the user can do a number of navigation operations with the keyboard when menu hot-tracking is disabled.</span></span> <span data-ttu-id="6d80f-172">I controlli Toolbar supportano la navigazione tramite tastiera solo se hanno lo stato attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-172">Toolbar controls support keyboard navigation only if they have focus.</span></span> <span data-ttu-id="6d80f-173">Non gestiscono inoltre tutte le pressioni dei tasti necessarie per le barre dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-173">They also do not handle all the key presses that are needed for menu bars.</span></span> <span data-ttu-id="6d80f-174">La soluzione più semplice per gestire la navigazione da tastiera consiste nell'elaborare in modo esplicito gli eventi di pressione del tasto pertinenti.</span><span class="sxs-lookup"><span data-stu-id="6d80f-174">The simplest solution to handling keyboard navigation is to process the relevant key press events explicitly.</span></span>

<span data-ttu-id="6d80f-175">Se il rilevamento a caldo del menu è disabilitato, l'applicazione deve gestire questi eventi di pressione del tasto nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="6d80f-175">If menu hot-tracking is disabled, your application must handle these key press events in the following way:</span></span>

-   <span data-ttu-id="6d80f-176">Tasto F10.</span><span class="sxs-lookup"><span data-stu-id="6d80f-176">The F10 key.</span></span> <span data-ttu-id="6d80f-177">Attivare il primo pulsante con [**TB \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-177">Activate the first button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span>
-   <span data-ttu-id="6d80f-178">Tasti freccia sinistra e freccia destra.</span><span class="sxs-lookup"><span data-stu-id="6d80f-178">The LEFT ARROW and RIGHT ARROW keys.</span></span> <span data-ttu-id="6d80f-179">Attivare il pulsante adiacente con [**TB \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-179">Activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="6d80f-180">Se l'utente tenta di spostarsi in una delle estremità della barra dei menu, attivare il primo pulsante all'estremità opposta.</span><span class="sxs-lookup"><span data-stu-id="6d80f-180">If the user attempts to navigate off either end of the menu bar, activate the first button at the opposite end.</span></span>
-   <span data-ttu-id="6d80f-181">Tasto ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="6d80f-181">The ESCAPE key.</span></span> <span data-ttu-id="6d80f-182">Disattiva il pulsante attivo con [**TB \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-182">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="6d80f-183">La barra dei menu deve essere restituita allo stato precedente all'attivazione del primo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-183">The menu bar should be returned to the state it had prior to activating the first button.</span></span>
-   <span data-ttu-id="6d80f-184">Tasto di scelta rapida del *tasto* Alt.</span><span class="sxs-lookup"><span data-stu-id="6d80f-184">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="6d80f-185">Usare il messaggio [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) per determinare il pulsante a cui corrisponde il carattere *chiave* .</span><span class="sxs-lookup"><span data-stu-id="6d80f-185">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="6d80f-186">Consente di visualizzare il menu a discesa del pulsante e di abilitare il menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="6d80f-186">Display the button's drop-down menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="6d80f-187">Tasto freccia GIÙ.</span><span class="sxs-lookup"><span data-stu-id="6d80f-187">The DOWN ARROW key.</span></span> <span data-ttu-id="6d80f-188">Se un pulsante è attivo ma non è stato visualizzato alcun menu, visualizzare il menu del pulsante e abilitare il monitoraggio a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-188">If a button is active but no menu has been displayed, display the button's menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="6d80f-189">Tasto INVIO.</span><span class="sxs-lookup"><span data-stu-id="6d80f-189">The ENTER key.</span></span> <span data-ttu-id="6d80f-190">Disattiva il pulsante attivo con [**TB \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="6d80f-190">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="6d80f-191">La barra dei menu deve essere restituita allo stato precedente all'attivazione del primo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-191">The menu bar should be returned to the state it had prior to activating the first button.</span></span>

### <a name="mixed-navigation"></a><span data-ttu-id="6d80f-192">Navigazione mista</span><span class="sxs-lookup"><span data-stu-id="6d80f-192">Mixed Navigation</span></span>

<span data-ttu-id="6d80f-193">I gestori di navigazione da tastiera descritti nella sezione precedente eseguono essenzialmente due attività: tenere traccia del pulsante attivo e visualizzare il menu appropriato quando si seleziona un pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-193">The keyboard navigation handlers outlined in the preceding section basically do two tasks: keep track of the active button and display the appropriate menu when a button is selected.</span></span> <span data-ttu-id="6d80f-194">Questi gestori sono sufficienti fino a quando l'utente si sposta solo con la tastiera.</span><span class="sxs-lookup"><span data-stu-id="6d80f-194">These handlers are sufficient as long as the user navigates only with the keyboard.</span></span> <span data-ttu-id="6d80f-195">Tuttavia, gli utenti spesso combinano la navigazione da tastiera e mouse.</span><span class="sxs-lookup"><span data-stu-id="6d80f-195">However, users often mix keyboard and mouse navigation.</span></span> <span data-ttu-id="6d80f-196">Ad esempio, potrebbe attivare il primo pulsante con la chiave F10, utilizzare il mouse per attivare un pulsante diverso e quindi aprire il relativo menu con il tasto freccia giù.</span><span class="sxs-lookup"><span data-stu-id="6d80f-196">For example, they might activate the first button with the F10 key, use the mouse to activate a different button, and then open its menu with the DOWN ARROW key.</span></span> <span data-ttu-id="6d80f-197">Se si esegue il monitoraggio solo delle pressioni dei tasti per tenere traccia del tasto attivo, verrà visualizzato il menu errato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-197">If you are only monitoring key presses to keep track of the active key, you will display the wrong menu.</span></span> <span data-ttu-id="6d80f-198">È anche necessario gestire la notifica [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) per tenere traccia in modo accurato del pulsante attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-198">You must also handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to accurately keep track of the active button.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-enabled"></a><span data-ttu-id="6d80f-199">Gestione della navigazione con il menu Hot-Tracking abilitato</span><span class="sxs-lookup"><span data-stu-id="6d80f-199">Handling Navigation with Menu Hot-Tracking Enabled</span></span>

<span data-ttu-id="6d80f-200">Quando è abilitata la funzionalità di rilevamento a caldo del menu, l'applicazione deve modificare il modo in cui risponde alla navigazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-200">When menu hot-tracking is enabled, your application must change the way it responds to user navigation.</span></span> <span data-ttu-id="6d80f-201">Per replicare il comportamento dei menu standard, è necessario implementare in modo esplicito le funzionalità seguenti.</span><span class="sxs-lookup"><span data-stu-id="6d80f-201">To replicate the behavior of standard menus, you must implement the following features explicitly.</span></span>

<span data-ttu-id="6d80f-202">Con la navigazione del mouse:</span><span class="sxs-lookup"><span data-stu-id="6d80f-202">With mouse navigation:</span></span>

-   <span data-ttu-id="6d80f-203">Se l'utente sposta il cursore su un altro pulsante, il menu viene visualizzato immediatamente e il menu precedente scompare.</span><span class="sxs-lookup"><span data-stu-id="6d80f-203">If the user moves the cursor over another button, that menu immediately appears and the previous menu disappears.</span></span>
-   <span data-ttu-id="6d80f-204">Il rilevamento a caldo del menu rimane attivo fino a quando l'utente non seleziona un comando o fa clic su un punto che non fa parte dell'area dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-204">Menu hot-tracking stays active until the user selects a command or clicks a point that is not part of the menu region.</span></span> <span data-ttu-id="6d80f-205">L'azione disattiva il rilevamento a caldo del menu fino a quando non si fa clic su un altro pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-205">Either action deactivates menu hot-tracking until another button is clicked.</span></span>
-   <span data-ttu-id="6d80f-206">Se il cursore si sposta dal menu, il menu a discesa corrente rimane fino a quando il cursore non viene spostato di nuovo o quando l'utente fa clic su un punto esterno all'area coperta dal menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-206">If the cursor moves off the menu, the current drop-down menu remains until the cursor moves back onto, or the user clicks a point outside, the area covered by the menu.</span></span> <span data-ttu-id="6d80f-207">Se il cursore torna a un pulsante diverso da quello attualmente visualizzato, il menu precedente viene compresso e viene visualizzato il nuovo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-207">If the cursor returns to a different button than the one currently being displayed, the old menu is collapsed and the new menu is displayed.</span></span>

<span data-ttu-id="6d80f-208">Con navigazione da tastiera:</span><span class="sxs-lookup"><span data-stu-id="6d80f-208">With keyboard navigation:</span></span>

-   <span data-ttu-id="6d80f-209">Il tasto freccia destra sposta lo stato attivo a destra.</span><span class="sxs-lookup"><span data-stu-id="6d80f-209">The RIGHT ARROW key moves the focus to the right.</span></span> <span data-ttu-id="6d80f-210">Se l'elemento dispone di un sottomenu, visualizzare il sottomenu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-210">If the item has a submenu, display the submenu.</span></span> <span data-ttu-id="6d80f-211">Se l'elemento non dispone di un sottomenu, comprimere il menu e i sottomenu, attivare il pulsante avanti con [**TB \_ SETHOTITEM**](tb-sethotitem.md)e visualizzare il menu per il pulsante adiacente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-211">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="6d80f-212">Se l'ultimo pulsante è attivo quando viene ricevuto questo messaggio, visualizzare il menu per il primo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-212">If the last button is active when this message is received, display the menu for the first button.</span></span>
-   <span data-ttu-id="6d80f-213">Il tasto freccia sinistra sposta lo stato attivo a sinistra.</span><span class="sxs-lookup"><span data-stu-id="6d80f-213">The LEFT ARROW key moves the focus to the left.</span></span> <span data-ttu-id="6d80f-214">Se l'elemento è un sottomenu, comprimerlo e spostare lo stato attivo sul menu padre.</span><span class="sxs-lookup"><span data-stu-id="6d80f-214">If the item is a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="6d80f-215">Se l'elemento non è un sottomenu, comprimere il menu, attivare il pulsante avanti con [**TB \_ SETHOTITEM**](tb-sethotitem.md)e visualizzare il menu per tale pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-215">If the item is not a submenu, collapse the menu, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for that button.</span></span>

<!-- -->

-   <span data-ttu-id="6d80f-216">Il tasto ESCAPE esegue il backup della visualizzazione di un passaggio.</span><span class="sxs-lookup"><span data-stu-id="6d80f-216">The ESCAPE key backs the display up one step.</span></span>
    -   <span data-ttu-id="6d80f-217">Se viene visualizzato un sottomenu, questo viene compresso e lo stato attivo passa al menu padre.</span><span class="sxs-lookup"><span data-stu-id="6d80f-217">If a submenu is displayed, it is collapsed and focus shifts to the parent menu.</span></span>
    -   <span data-ttu-id="6d80f-218">Se il menu di un pulsante viene visualizzato, viene compresso e il menu di scelta rapida del menu è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-218">If a button's menu is displayed, it is collapsed and menu hot-tracking is disabled.</span></span> <span data-ttu-id="6d80f-219">Il pulsante dell'elemento rimane attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-219">The item's button remains active.</span></span>
    -   <span data-ttu-id="6d80f-220">Se non vengono visualizzati menu ma un pulsante è attivo, il pulsante viene disattivato e il menu di scelta rapida del menu è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-220">If no menus are displayed but a button is active, the button is deactivated and menu hot-tracking is disabled.</span></span>
-   <span data-ttu-id="6d80f-221">I tasti freccia su e freccia giù vengono usati solo per spostarsi all'interno di un menu specifico.</span><span class="sxs-lookup"><span data-stu-id="6d80f-221">The UP ARROW and DOWN ARROW keys are used only to navigate within a particular menu.</span></span>
-   <span data-ttu-id="6d80f-222">Il tasto invio avvia il comando associato a una voce di menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-222">The ENTER key launches the command associated with a menu item.</span></span> <span data-ttu-id="6d80f-223">Se la voce di menu dispone di un sottomenu, il tasto invio lo Visualizza.</span><span class="sxs-lookup"><span data-stu-id="6d80f-223">If the menu item has a submenu, the ENTER key displays it.</span></span>

<span data-ttu-id="6d80f-224">Come nel caso di disabilitato rilevamento a caldo del menu, l'applicazione deve essere in grado di gestire il mouse, la tastiera e la navigazione mista.</span><span class="sxs-lookup"><span data-stu-id="6d80f-224">As with the menu hot-tracking disabled case, your application must be able to handle mouse, keyboard, and mixed navigation.</span></span> <span data-ttu-id="6d80f-225">Tuttavia, il fatto che venga visualizzato un menu significa che la messaggistica dovrà essere gestita in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="6d80f-225">However, the fact that a menu is displayed means that messaging will have to be handled somewhat differently.</span></span>

### <a name="message-processing-for-menu-hot-tracking"></a><span data-ttu-id="6d80f-226">Elaborazione dei messaggi per il menu Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="6d80f-226">Message Processing for Menu Hot-Tracking</span></span>

<span data-ttu-id="6d80f-227">Per il controllo attivo del menu è necessario che venga visualizzato un menu in qualsiasi momento, a parte il breve intervallo necessario per passare a un nuovo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-227">Menu hot-tracking requires that a menu be displayed at all times, apart from the brief interval required to switch to a new menu.</span></span> <span data-ttu-id="6d80f-228">Tuttavia, il menu a discesa visualizzato da [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) è modale.</span><span class="sxs-lookup"><span data-stu-id="6d80f-228">However, the drop-down menu that is displayed by [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) is modal.</span></span> <span data-ttu-id="6d80f-229">L'applicazione continuerà a ricevere direttamente alcuni messaggi, inclusi [**i \_ comandi WM**](/windows/desktop/menurc/wm-command), [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md)e i normali messaggi correlati ai menu, ad esempio [**WM \_ MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span><span class="sxs-lookup"><span data-stu-id="6d80f-229">Your application will continue to receive some messages directly, including [**WM\_COMMAND**](/windows/desktop/menurc/wm-command), [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md), and normal menu-related messages such as [**WM\_MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span></span> <span data-ttu-id="6d80f-230">Tuttavia, non riceverà direttamente i messaggi della tastiera o del mouse di basso livello.</span><span class="sxs-lookup"><span data-stu-id="6d80f-230">However, it will not receive low-level keyboard or mouse messages directly.</span></span> <span data-ttu-id="6d80f-231">Per gestire i messaggi, ad esempio [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), è necessario impostare un hook del messaggio per intercettare i messaggi indirizzati al menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-231">To handle messages such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), you must set a message hook to intercept messages that are directed to the menu.</span></span>

<span data-ttu-id="6d80f-232">Quando viene visualizzato un menu a discesa, impostare l'hook del messaggio chiamando la funzione [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) con il parametro *IDHOOK* impostato su WH \_ msgfilter.</span><span class="sxs-lookup"><span data-stu-id="6d80f-232">When a drop-down menu is displayed, set the message hook by calling the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function with the *idHook* parameter set to WH\_MSGFILTER.</span></span> <span data-ttu-id="6d80f-233">Tutti i messaggi destinati al menu verranno passati alla [routine hook](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6d80f-233">All messages intended for the menu will be passed to your [hook procedure](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span></span> <span data-ttu-id="6d80f-234">Il frammento di codice seguente, ad esempio, imposta un hook di messaggio che consente di intercettare i messaggi che passano a un menu a discesa.</span><span class="sxs-lookup"><span data-stu-id="6d80f-234">For example, the following code fragment sets a message hook that will trap messages that are going to a drop-down menu.</span></span> <span data-ttu-id="6d80f-235">`MsgHook` è il nome della routine hook e `hhookMsg` è l'handle per la routine.</span><span class="sxs-lookup"><span data-stu-id="6d80f-235">`MsgHook` is the name of the hook procedure, and `hhookMsg` is the handle to the procedure.</span></span>


```
hhookMsg = SetWindowsHookEx(WH_MSGFILTER, MsgHook, HINST_THISDLL, 0);
```



<span data-ttu-id="6d80f-236">I messaggi di menu vengono identificati impostando il parametro *nCode* della routine hook sul \_ menu MSGF.</span><span class="sxs-lookup"><span data-stu-id="6d80f-236">Menu messages are identified by setting the hook procedure's *nCode* parameter to MSGF\_MENU.</span></span> <span data-ttu-id="6d80f-237">Il parametro *lParam* punterà a una struttura [**msg**](/windows/win32/api/winuser/ns-winuser-msg) con il messaggio.</span><span class="sxs-lookup"><span data-stu-id="6d80f-237">The *lParam* parameter will point to a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure with the message.</span></span> <span data-ttu-id="6d80f-238">I dettagli dei messaggi che devono essere gestiti e il modo in cui vengono descritti nella parte restante di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="6d80f-238">The details of which messages need to be handled, and how, are discussed in the remainder of this topic.</span></span>

<span data-ttu-id="6d80f-239">L'applicazione deve passare tutti i messaggi al hook del messaggio successivo chiamando la funzione [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-239">Your application must pass all messages on to the next message hook by calling the [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) function.</span></span> <span data-ttu-id="6d80f-240">È inoltre necessario inviare i messaggi del mouse direttamente al controllo Toolbar, assicurandosi di convertire le coordinate dei punti nello spazio delle coordinate del client della barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="6d80f-240">You must also send mouse messages directly to the toolbar control, making sure to convert any point coordinates to the toolbar client coordinate space.</span></span> <span data-ttu-id="6d80f-241">L'invio diretto dei messaggi garantisce che il controllo Toolbar riceva i messaggi del mouse appropriati.</span><span class="sxs-lookup"><span data-stu-id="6d80f-241">Sending the messages directly ensures that the toolbar control receives the appropriate mouse messages.</span></span> <span data-ttu-id="6d80f-242">Ad esempio, la barra degli strumenti deve ricevere messaggi di [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) per tenere traccia dei pulsanti.</span><span class="sxs-lookup"><span data-stu-id="6d80f-242">For instance, the toolbar needs to receive [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in order to hot-track its buttons.</span></span>

<span data-ttu-id="6d80f-243">Quando viene attivato un nuovo pulsante, l'applicazione deve comprimere il vecchio menu a discesa con un messaggio [**WM \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) e visualizzare un nuovo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-243">When a new button is activated, your application must collapse the old drop-down menu with a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message, and display a new menu.</span></span> <span data-ttu-id="6d80f-244">Deve inoltre comprimere il menu a discesa quando lo stato attivo viene ricavato dalla barra dei menu con navigazione da tastiera oppure facendo clic all'esterno dell'area dei menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-244">It must also collapse the drop-down menu when focus is taken from the menu bar with keyboard navigation or by clicking outside the menu area.</span></span> <span data-ttu-id="6d80f-245">Quando si comprime un menu, è necessario liberarne l'hook del messaggio usando la funzione [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) .</span><span class="sxs-lookup"><span data-stu-id="6d80f-245">Whenever you collapse a menu, you should free its message hook by using the [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) function.</span></span> <span data-ttu-id="6d80f-246">Se è necessario visualizzare un altro menu a discesa, creare un nuovo hook del messaggio.</span><span class="sxs-lookup"><span data-stu-id="6d80f-246">If you need to display another drop-down menu, create a new message hook.</span></span> <span data-ttu-id="6d80f-247">Quando viene avviato un comando, il menu viene compresso automaticamente, ma è necessario liberare in modo esplicito l'hook del messaggio.</span><span class="sxs-lookup"><span data-stu-id="6d80f-247">When a command is launched, the menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="6d80f-248">Nell'esempio di codice seguente viene liberato l'hook del messaggio impostato nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-248">The following code example frees the message hook that was set in the previous example.</span></span>


```
UnhookWindowsHookEx(hhookMsg);
```



### <a name="mouse-navigation"></a><span data-ttu-id="6d80f-249">Navigazione del mouse</span><span class="sxs-lookup"><span data-stu-id="6d80f-249">Mouse Navigation</span></span>

<span data-ttu-id="6d80f-250">Quando una barra degli strumenti normale controlla i pulsanti sensibili, evidenzia il pulsante attivo e invia all'applicazione una notifica [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) ogni volta che viene attivato un nuovo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-250">When a normal toolbar control hot-tracks buttons, it highlights the active button and sends the application a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification each time a new button is activated.</span></span> <span data-ttu-id="6d80f-251">L'applicazione è responsabile della visualizzazione del menu a discesa appropriato.</span><span class="sxs-lookup"><span data-stu-id="6d80f-251">Your application is responsible for displaying the appropriate drop-down menu.</span></span> <span data-ttu-id="6d80f-252">Deve:</span><span class="sxs-lookup"><span data-stu-id="6d80f-252">It must:</span></span>

-   <span data-ttu-id="6d80f-253">Gestire la notifica [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) per tenere traccia del pulsante attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-253">Handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="6d80f-254">Quando si modifica il pulsante attivo, comprimere il vecchio menu e crearne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-254">When the active button changes, collapse the old menu and create a new one.</span></span>
-   <span data-ttu-id="6d80f-255">Gestire la notifica a [ \_ discesa TBN](tbn-dropdown.md) inviata quando si fa clic su un pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-255">Handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification that is sent when a button is clicked.</span></span> <span data-ttu-id="6d80f-256">Dovrebbe quindi comprimere il menu e disabilitare il rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-256">It should then collapse the menu and disable menu hot-tracking.</span></span> <span data-ttu-id="6d80f-257">Il pulsante rimane attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-257">The button remains active.</span></span>
-   <span data-ttu-id="6d80f-258">Gestire i messaggi [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM \_ RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown)e [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) nella routine hook del messaggio, per tenere traccia della posizione del mouse.</span><span class="sxs-lookup"><span data-stu-id="6d80f-258">Handle the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown), and [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in your message hook procedure, to keep track of the mouse position.</span></span> <span data-ttu-id="6d80f-259">Se si fa clic con il mouse all'esterno dell'area dei menu, comprimere il menu a discesa corrente, disattivare il monitoraggio a caldo del menu e tornare alla barra dei menu sullo stato di preattivazione.</span><span class="sxs-lookup"><span data-stu-id="6d80f-259">If the mouse is clicked outside the menu area, collapse the current drop-down menu, deactivate menu hot-tracking, and return the menu bar to its preactivation state.</span></span>
-   <span data-ttu-id="6d80f-260">Quando viene avviato un comando di menu, Disabilita il rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-260">When a menu command is launched, disable menu hot-tracking.</span></span> <span data-ttu-id="6d80f-261">Il menu verrà compresso automaticamente, ma è necessario liberare in modo esplicito l'hook del messaggio.</span><span class="sxs-lookup"><span data-stu-id="6d80f-261">The menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="6d80f-262">È inoltre necessario gestire la messaggistica relativa ai menu, ad esempio il messaggio [**WM \_ INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) inviato quando una voce di menu deve visualizzare un sottomenu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-262">You must also handle menu-related messaging, such as the [**WM\_INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) message that is sent when a menu item needs to display a submenu.</span></span> <span data-ttu-id="6d80f-263">Per informazioni su come gestire tali messaggi, vedere [menu](/windows/desktop/menurc/menus).</span><span class="sxs-lookup"><span data-stu-id="6d80f-263">For a discussion of how to handle such messages, see [Menus](/windows/desktop/menurc/menus).</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="6d80f-264">Navigazione tramite tastiera</span><span class="sxs-lookup"><span data-stu-id="6d80f-264">Keyboard Navigation</span></span>

<span data-ttu-id="6d80f-265">L'applicazione deve elaborare i messaggi della tastiera nella procedura di hook del messaggio e agire su quelli che influiscono sul rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-265">Your application must process keyboard messages in the message hook procedure and act on those that affect menu hot-tracking.</span></span> <span data-ttu-id="6d80f-266">È necessario gestire le pressioni di tasto seguenti:</span><span class="sxs-lookup"><span data-stu-id="6d80f-266">The following key presses must be handled:</span></span>

-   <span data-ttu-id="6d80f-267">Tasto ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="6d80f-267">The ESCAPE key.</span></span> <span data-ttu-id="6d80f-268">Il tasto ESCAPE supporta la visualizzazione di un livello verso l'alto.</span><span class="sxs-lookup"><span data-stu-id="6d80f-268">The ESCAPE key backs the display up one level.</span></span> <span data-ttu-id="6d80f-269">Se un sottomenu viene visualizzato, deve essere compresso.</span><span class="sxs-lookup"><span data-stu-id="6d80f-269">If a submenu is being displayed, it must be collapsed.</span></span> <span data-ttu-id="6d80f-270">Se viene visualizzato il menu primario di un pulsante, comprimerlo e disabilitare il rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-270">If a button's primary menu is displayed, collapse it and disable menu hot-tracking.</span></span> <span data-ttu-id="6d80f-271">Il pulsante rimane attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-271">The button remains active.</span></span>
-   <span data-ttu-id="6d80f-272">Tasto freccia DESTRA.</span><span class="sxs-lookup"><span data-stu-id="6d80f-272">The RIGHT ARROW key.</span></span> <span data-ttu-id="6d80f-273">Se l'elemento contiene un sottomenu, visualizzarlo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-273">If the item has a submenu, display it.</span></span> <span data-ttu-id="6d80f-274">Se l'elemento non dispone di un sottomenu, comprimere il menu e i sottomenu, attivare il pulsante avanti con [**TB \_ SETHOTITEM**](tb-sethotitem.md)e visualizzare il relativo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-274">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="6d80f-275">Se l'ultimo pulsante era attivo al momento della ricezione della notifica, visualizzare il menu per il primo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-275">If the last button was active when this notification was received, display the menu for the first button.</span></span>
-   <span data-ttu-id="6d80f-276">Tasto freccia SINISTRA.</span><span class="sxs-lookup"><span data-stu-id="6d80f-276">The LEFT ARROW key.</span></span> <span data-ttu-id="6d80f-277">Se l'elemento si trova in un sottomenu, comprimerlo e spostare lo stato attivo sul menu padre.</span><span class="sxs-lookup"><span data-stu-id="6d80f-277">If the item is in a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="6d80f-278">Se l'elemento non è un sottomenu, comprimere il menu, attivare il pulsante adiacente con [**TB \_ SETHOTITEM**](tb-sethotitem.md)e visualizzare il relativo menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-278">If the item is not a submenu, collapse the menu, activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="6d80f-279">Se il primo pulsante era attivo al momento della ricezione della notifica, visualizzare il menu per l'ultimo pulsante.</span><span class="sxs-lookup"><span data-stu-id="6d80f-279">If the first button was active when this notification was received, display the menu for the last button.</span></span>
-   <span data-ttu-id="6d80f-280">Tasti freccia su e freccia giù.</span><span class="sxs-lookup"><span data-stu-id="6d80f-280">The UP ARROW and DOWN ARROW keys.</span></span> <span data-ttu-id="6d80f-281">Queste chiavi vengono usate per spostarsi all'interno di un menu, ma non influiscono direttamente sul rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-281">These keys are used to navigate within a menu but do not directly affect menu hot-tracking.</span></span>
-   <span data-ttu-id="6d80f-282">Tasto di scelta rapida del *tasto* Alt.</span><span class="sxs-lookup"><span data-stu-id="6d80f-282">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="6d80f-283">Usare il messaggio [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) per determinare il pulsante a cui corrisponde il carattere *chiave* .</span><span class="sxs-lookup"><span data-stu-id="6d80f-283">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="6d80f-284">Se corrisponde a un pulsante diverso da quello attualmente attivo, comprimere il menu a discesa corrente, attivare il pulsante nuovo con [**TB \_ SETHOTITEM**](tb-sethotitem.md)e visualizzare il menu per il pulsante adiacente.</span><span class="sxs-lookup"><span data-stu-id="6d80f-284">If it corresponds to a different button than the currently active one, collapse the current drop-down menu, activate the new button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="6d80f-285">Se il *carattere chiave* corrisponde al pulsante attualmente visualizzato, comprimere il menu a discesa e disabilitare il rilevamento a caldo del menu.</span><span class="sxs-lookup"><span data-stu-id="6d80f-285">If the *Key character* corresponds to the currently displayed button, collapse the drop-down menu and disable menu hot-tracking.</span></span> <span data-ttu-id="6d80f-286">Il pulsante deve rimanere attivo.</span><span class="sxs-lookup"><span data-stu-id="6d80f-286">The button should remain active.</span></span>

 

 