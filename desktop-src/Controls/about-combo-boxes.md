---
title: Informazioni sulle caselle combinate
description: In questa sezione vengono illustrati i diversi tipi di caselle combinate.
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2020
ms.locfileid: "104560137"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="97bdc-103">Informazioni sulle caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-103">About Combo Boxes</span></span>

<span data-ttu-id="97bdc-104">Una casella combinata combina una casella di modifica o un testo statico e un elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="97bdc-105">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="97bdc-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="97bdc-106">Tipi e stili di caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="97bdc-107">Elenco di caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="97bdc-108">Selezione corrente</span><span class="sxs-lookup"><span data-stu-id="97bdc-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="97bdc-109">Elenchi a discesa</span><span class="sxs-lookup"><span data-stu-id="97bdc-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="97bdc-110">Contenuto elenco</span><span class="sxs-lookup"><span data-stu-id="97bdc-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="97bdc-111">Modificare i campi di selezione del controllo</span><span class="sxs-lookup"><span data-stu-id="97bdc-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="97bdc-112">Caselle combinate create dal proprietario</span><span class="sxs-lookup"><span data-stu-id="97bdc-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="97bdc-113">Caselle combinate sottoclassi</span><span class="sxs-lookup"><span data-stu-id="97bdc-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="97bdc-114">Tipi e stili di caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="97bdc-115">Una casella combinata è costituita da un elenco e da un campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="97bdc-116">L'elenco presenta le opzioni che un utente può selezionare e il campo di selezione Visualizza la selezione corrente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="97bdc-117">Se il campo di selezione è un controllo di modifica, l'utente può immettere informazioni non disponibili nell'elenco; in caso contrario, l'utente può solo selezionare gli elementi nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="97bdc-118">La libreria di controlli comuni include tre stili principali della casella combinata, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="97bdc-119">Tipo di casella combinata</span><span class="sxs-lookup"><span data-stu-id="97bdc-119">Combo box type</span></span>             | <span data-ttu-id="97bdc-120">Costante Style</span><span class="sxs-lookup"><span data-stu-id="97bdc-120">Style constant</span></span>                                                 | <span data-ttu-id="97bdc-121">Descrizione</span><span class="sxs-lookup"><span data-stu-id="97bdc-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="97bdc-122">Semplice</span><span class="sxs-lookup"><span data-stu-id="97bdc-122">Simple</span></span>                     | [<span data-ttu-id="97bdc-123">**\_semplice CBS**</span><span class="sxs-lookup"><span data-stu-id="97bdc-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="97bdc-124">Visualizza l'elenco in qualsiasi momento e Mostra l'elemento selezionato in un controllo di modifica.</span><span class="sxs-lookup"><span data-stu-id="97bdc-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="97bdc-125">Drop-down</span><span class="sxs-lookup"><span data-stu-id="97bdc-125">Drop-down</span></span>                  | [<span data-ttu-id="97bdc-126">**\_elenco a discesa CBS**</span><span class="sxs-lookup"><span data-stu-id="97bdc-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="97bdc-127">Visualizza l'elenco quando si fa clic sull'icona e Mostra l'elemento selezionato in un controllo di modifica.</span><span class="sxs-lookup"><span data-stu-id="97bdc-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="97bdc-128">Elenco a discesa (elenco a discesa)</span><span class="sxs-lookup"><span data-stu-id="97bdc-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="97bdc-129">**\_DropDownList CBS**</span><span class="sxs-lookup"><span data-stu-id="97bdc-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="97bdc-130">Visualizza l'elenco quando si fa clic sull'icona e Mostra l'elemento selezionato in un controllo statico.</span><span class="sxs-lookup"><span data-stu-id="97bdc-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="97bdc-131">Le schermate seguenti mostrano i tre tipi di casella combinata che potrebbero essere visualizzati in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="97bdc-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="97bdc-132">Nella prima schermata, l'utente ha selezionato un elemento nella casella combinata semplice.</span><span class="sxs-lookup"><span data-stu-id="97bdc-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="97bdc-133">L'utente può anche digitare un nuovo valore nella casella di modifica del controllo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="97bdc-134">L'elenco è stato dimensionato nell'editor di risorse Microsoft Visual Studio ed è sufficientemente grande da contenere due elementi.</span><span class="sxs-lookup"><span data-stu-id="97bdc-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![cattura di schermata che mostra un elemento selezionato in una casella combinata semplice](images/simplecombo.png)

<span data-ttu-id="97bdc-136">Nella seconda schermata, l'utente ha digitato nuovo testo nel controllo di modifica della casella combinata a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="97bdc-137">È anche possibile che l'utente abbia selezionato un elemento esistente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="97bdc-138">La casella di riepilogo si espande per contenere il maggior numero possibile di elementi.</span><span class="sxs-lookup"><span data-stu-id="97bdc-138">The list box expands to accommodate as many items as possible.</span></span>

![screenshot che mostra il testo digitato in una casella combinata a discesa](images/dropdown.png)

<span data-ttu-id="97bdc-140">Nella terza schermata, l'utente ha aperto la casella combinata dell'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="97bdc-141">La casella di riepilogo si espande per contenere il maggior numero possibile di elementi.</span><span class="sxs-lookup"><span data-stu-id="97bdc-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="97bdc-142">L'utente non può immettere nuovo testo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-142">The user cannot enter new text.</span></span>

![screenshot che mostra un elemento selezionato in un elenco a discesa casella combinata](images/droplist.png)

<span data-ttu-id="97bdc-144">Sono inoltre disponibili diversi stili di caselle combinate che definiscono proprietà specifiche.</span><span class="sxs-lookup"><span data-stu-id="97bdc-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="97bdc-145">Gli stili della casella combinata definiscono proprietà specifiche di una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="97bdc-146">È possibile combinare gli stili; Tuttavia, alcuni stili si applicano solo a determinati tipi di caselle combinate.</span><span class="sxs-lookup"><span data-stu-id="97bdc-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="97bdc-147">Per una tabella di stili di caselle combinate, vedere [stili di caselle combinate](combo-box-styles.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="97bdc-148">Per usare gli stili di visualizzazione con le caselle combinate, un'applicazione deve includere un manifesto e deve chiamare [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) all'inizio del programma.</span><span class="sxs-lookup"><span data-stu-id="97bdc-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="97bdc-149">Per informazioni sugli stili di visualizzazione, vedere [stili di visualizzazione](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="97bdc-150">Per informazioni sui manifesti, vedere [Abilitazione degli stili di visualizzazione](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="97bdc-151">Elenco di caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-151">Combo Box List</span></span>

<span data-ttu-id="97bdc-152">L'elenco è la parte di una casella combinata che consente di visualizzare gli elementi selezionabili da un utente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="97bdc-153">In genere, un'applicazione Inizializza il contenuto dell'elenco quando crea una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="97bdc-154">Qualsiasi elemento elenco selezionato dall'utente è la *selezione corrente*.</span><span class="sxs-lookup"><span data-stu-id="97bdc-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="97bdc-155">Non è possibile selezionare più elementi.</span><span class="sxs-lookup"><span data-stu-id="97bdc-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="97bdc-156">Nelle caselle combinate semplici e a discesa l'utente può digitare il campo di selezione anziché selezionare un elemento dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="97bdc-157">In questi casi, non è presente alcuna selezione corrente ed è responsabilità dell'applicazione aggiungere l'elemento all'elenco e impostarlo come selezione corrente, se è appropriato.</span><span class="sxs-lookup"><span data-stu-id="97bdc-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="97bdc-158">In questa sezione vengono illustrati gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="97bdc-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="97bdc-159">Selezione corrente</span><span class="sxs-lookup"><span data-stu-id="97bdc-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="97bdc-160">Elenchi a discesa</span><span class="sxs-lookup"><span data-stu-id="97bdc-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="97bdc-161">Contenuto elenco</span><span class="sxs-lookup"><span data-stu-id="97bdc-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="97bdc-162">Selezione corrente</span><span class="sxs-lookup"><span data-stu-id="97bdc-162">Current Selection</span></span>

<span data-ttu-id="97bdc-163">La selezione corrente è un elemento elenco selezionato dall'utente. il testo selezionato verrà visualizzato nel campo di selezione della casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="97bdc-164">Tuttavia, nel caso di una casella combinata semplice o di una casella combinata a discesa, la selezione corrente è solo una forma di possibile input utente in una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="97bdc-165">L'utente può anche digitare il testo nel campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="97bdc-166">La selezione corrente è identificata dall'indice in base zero dell'elemento di elenco selezionato.</span><span class="sxs-lookup"><span data-stu-id="97bdc-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="97bdc-167">Un'applicazione può impostarla e recuperarla in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="97bdc-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="97bdc-168">La finestra padre o la routine della finestra di dialogo riceve una notifica quando l'utente modifica la selezione corrente per una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="97bdc-169">La finestra padre o la finestra di dialogo non viene notificata quando l'applicazione modifica la selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="97bdc-170">Quando viene creata una casella combinata, non è presente alcuna selezione corrente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="97bdc-171">Questo vale anche per una casella combinata semplice o a discesa, se l'utente ha modificato il contenuto del campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="97bdc-172">Per impostare la selezione corrente, un'applicazione invia il messaggio di errore [**CB \_**](cb-setcursel.md) alla casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="97bdc-173">Un'applicazione può anche usare il messaggio [**CB \_ SELECTSTRING**](cb-selectstring.md) per impostare la selezione corrente su un elemento dell'elenco la cui stringa inizia con una stringa specificata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="97bdc-174">Per determinare la selezione corrente, un'applicazione invia il messaggio del [**CB \_ GetCurSel**](cb-getcursel.md) alla casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="97bdc-175">Se non è presente alcuna selezione corrente, questo messaggio restituisce CB \_ Err.</span><span class="sxs-lookup"><span data-stu-id="97bdc-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="97bdc-176">Quando l'utente modifica la selezione corrente in una casella combinata, la finestra padre o la routine della finestra di dialogo riceve un messaggio di [**\_ comando WM**](/windows/desktop/menurc/wm-command) con il codice di notifica [CBN \_ selChange](cbn-selchange.md) nella parola più ordinata del parametro *wParam* .</span><span class="sxs-lookup"><span data-stu-id="97bdc-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="97bdc-177">Questo codice di notifica non viene inviato quando la selezione corrente viene impostata tramite il messaggio di base [**CB \_**](cb-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="97bdc-178">Una casella combinata a discesa o una casella di riepilogo a discesa Invia il codice di notifica [ \_ primo piano CBN](cbn-closeup.md) alla finestra padre o alla procedura della finestra di dialogo quando l'elenco a discesa viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="97bdc-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="97bdc-179">Se l'utente ha modificato la selezione corrente, la casella combinata invia anche il codice di notifica di [CBN \_ selChange](cbn-selchange.md) quando l'elenco a discesa viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="97bdc-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="97bdc-180">Per eseguire un processo specifico ogni volta che l'utente seleziona una voce di elenco, è possibile gestire il \_ codice di notifica di CBN SelChange o CBN \_ closeup.</span><span class="sxs-lookup"><span data-stu-id="97bdc-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="97bdc-181">In genere, è possibile attendere il \_ codice di notifica primo piano CBN prima di elaborare una modifica nella selezione corrente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="97bdc-182">Questo può essere particolarmente importante se è necessaria una quantità significativa di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="97bdc-183">Un'applicazione può anche elaborare i codici di notifica [CBN \_ SELENDOK](cbn-selendok.md) e [CBN \_ SELENDCANCEL](cbn-selendcancel.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="97bdc-184">Il sistema invia \_ SELENDOK CBN quando l'utente seleziona un elemento elenco o seleziona un elemento e quindi lo chiude.</span><span class="sxs-lookup"><span data-stu-id="97bdc-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="97bdc-185">Indica che l'utente ha terminato e che la selezione deve essere elaborata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="97bdc-186">\_Il SELENDCANCEL CBN viene inviato quando l'utente seleziona un elemento, ma seleziona un altro controllo, preme ESC mentre l'elenco a discesa è aperto o chiude la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="97bdc-187">Indica che la selezione dell'utente deve essere ignorata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="97bdc-188">Il \_ SELENDOK CBN viene inviato prima di ogni messaggio [ \_ selChange CBN](cbn-selchange.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="97bdc-189">In una casella combinata semplice, il sistema invia il codice di notifica di [CBN \_ DBLCLK](cbn-dblclk.md) quando l'utente fa doppio clic su un elemento dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="97bdc-190">In una casella combinata a discesa o un elenco a discesa, un singolo clic nasconde l'elenco, quindi non è possibile fare doppio clic su un elemento.</span><span class="sxs-lookup"><span data-stu-id="97bdc-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="97bdc-191">Elenchi a discesa</span><span class="sxs-lookup"><span data-stu-id="97bdc-191">Drop-down Lists</span></span>

<span data-ttu-id="97bdc-192">Alcune notifiche e messaggi si applicano solo alle caselle combinate contenenti elenchi a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="97bdc-193">Quando un elenco a discesa è aperto o chiuso, la finestra padre di una casella combinata riceve una notifica sotto forma di messaggio di [**\_ comando WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="97bdc-194">Se l'elenco viene aperto, la parola più significativa di *wParam* è l'elenco [a \_ discesa CBN](cbn-dropdown.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="97bdc-195">Se l'elenco è in fase di chiusura, [il \_ primo è CBN](cbn-closeup.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="97bdc-196">Un'applicazione può aprire l'elenco di una casella combinata a discesa o una casella di riepilogo a discesa usando il messaggio [**CB \_ SHOWDROPDOWN**](cb-showdropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="97bdc-197">Può determinare se l'elenco è aperto usando il messaggio [**CB \_ GETDROPPEDSTATE**](cb-getdroppedstate.md) e può determinare le coordinate di un elenco a discesa usando il messaggio [**CB \_ GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="97bdc-198">Un'applicazione può anche aumentare la larghezza di un elenco a discesa usando il messaggio [**CB \_ SETDROPPEDWIDTH**](cb-setdroppedwidth.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="97bdc-199">Contenuto elenco</span><span class="sxs-lookup"><span data-stu-id="97bdc-199">List Contents</span></span>

<span data-ttu-id="97bdc-200">Quando un'applicazione crea una casella combinata, in genere Inizializza la casella combinata aggiungendo uno o più elementi all'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="97bdc-201">Successivamente, un'applicazione può aggiungere o eliminare elementi elenco, reinizializzare l'elenco o recuperare informazioni sugli elementi.</span><span class="sxs-lookup"><span data-stu-id="97bdc-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="97bdc-202">Un'applicazione aggiunge elementi elenco a una casella combinata inviando il messaggio [**CB \_ ADDSTRING**](cb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="97bdc-203">L'elemento specificato viene aggiunto alla fine dell'elenco o, in una casella combinata ordinata, nella posizione corretta ordinata in base alla stringa dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="97bdc-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="97bdc-204">In una casella combinata non ordinata, un'applicazione può usare il messaggio [**CB \_ INSERTSTRING**](cb-insertstring.md) per inserire un elemento in una posizione specifica.</span><span class="sxs-lookup"><span data-stu-id="97bdc-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="97bdc-205">Una volta aggiunto, una voce di elenco viene identificata dalla relativa posizione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="97bdc-206">Utilizzando il messaggio [**CB \_ FindString**](cb-findstring.md) o [**CB \_ FindExactString**](cb-findstringexact.md) , un'applicazione può determinare la posizione di un elemento elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="97bdc-207">**CB \_ FINDSTRING** trova un elemento la cui stringa inizia con la stringa specificata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="97bdc-208">**CB \_ FINDEXACTSTRING** trova un elemento la cui stringa corrisponde esattamente alla stringa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="97bdc-209">Nessun messaggio fa distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="97bdc-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="97bdc-210">Un'applicazione può rimuovere una voce di elenco usando il messaggio [**CB \_ DELETESTRING**](cb-deletestring.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="97bdc-211">Se un'applicazione deve reinizializzare l'elenco di caselle combinate, può innanzitutto cancellare l'intero contenuto usando il messaggio [**CB \_ ResetContent**](cb-resetcontent.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="97bdc-212">Quando si aggiungono più elementi all'elenco dopo che è già stata visualizzata una casella combinata, un'applicazione può deselezionare il flag di ridisegno per impedire che la casella combinata venga ridisegnata dopo l'aggiunta di ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="97bdc-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="97bdc-213">Per ulteriori informazioni sul ridisegno, vedere la descrizione del messaggio [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="97bdc-214">Per recuperare la stringa associata a un elemento elenco, un'applicazione può usare il [**messaggio \_ GETLBTEXT CB**](cb-getlbtext.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="97bdc-215">La stringa dell'elemento viene copiata nel buffer specificato dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="97bdc-216">Per assicurarsi che il buffer sia sufficientemente grande da ricevere la stringa, l'applicazione può innanzitutto usare il messaggio [**CB \_ GETLBTEXTLEN**](cb-getlbtextlen.md) per determinare la lunghezza della stringa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="97bdc-217">Per ottenere il numero di voci di elenco in una casella combinata, un'applicazione può usare il messaggio [**CB \_ GetCount**](cb-getcount.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="97bdc-218">Modificare i campi di selezione del controllo</span><span class="sxs-lookup"><span data-stu-id="97bdc-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="97bdc-219">Un'applicazione può recuperare o impostare il contenuto del campo di selezione ed è in grado di determinare o impostare la selezione di modifica.</span><span class="sxs-lookup"><span data-stu-id="97bdc-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="97bdc-220">L'applicazione può anche limitare la quantità di testo che un utente può digitare nel campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="97bdc-221">Quando il contenuto del campo di selezione viene modificato, il sistema invia messaggi di notifica alla finestra padre o alla routine della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="97bdc-222">Per recuperare il contenuto del campo di selezione, un'applicazione può inviare il messaggio [**WM \_ gettext**](/windows/desktop/winmsg/wm-gettext) alla casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="97bdc-223">Per impostare il contenuto del campo di selezione di una casella combinata semplice o a discesa, un'applicazione può inviare il messaggio [**di \_ testo WM**](/windows/desktop/winmsg/wm-settext) alla casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="97bdc-224">La selezione di modifica è l'intervallo di testo selezionato, se presente, nel campo di selezione di una casella combinata semplice o a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="97bdc-225">Un'applicazione può determinare le posizioni dei caratteri iniziale e finale della selezione corrente usando il messaggio [**CB \_ GETEDITSEL**](cb-geteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="97bdc-226">Può anche selezionare i caratteri nella selezione di modifica usando il messaggio [**CB \_ SETEDITSEL**](cb-seteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="97bdc-227">Inizialmente, la quantità di testo che l'utente può digitare nel campo di selezione è limitata dalla dimensione del campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="97bdc-228">Tuttavia, se la casella combinata ha lo stile [**CBS \_ AUTOHSCROLL**](combo-box-styles.md) , il testo può continuare oltre le dimensioni del campo di selezione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="97bdc-229">Un'applicazione può usare il messaggio [**CB \_ LIMITTEXT**](cb-limittext.md) per limitare la quantità di testo che un utente può digitare nel campo di selezione, indipendentemente dal fatto che il controllo abbia lo stile **\_ AUTOHSCROLL CBS** .</span><span class="sxs-lookup"><span data-stu-id="97bdc-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="97bdc-230">Quando l'utente modifica il contenuto del campo di selezione, la finestra padre o la routine della finestra di dialogo riceve i messaggi di notifica.</span><span class="sxs-lookup"><span data-stu-id="97bdc-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="97bdc-231">Il codice di notifica di [CBN \_ EDITUPDATE](cbn-editupdate.md) viene inviato per primo, a indicare che il testo nel campo di selezione è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="97bdc-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="97bdc-232">Una volta visualizzato il testo modificato, il sistema invia [il \_ EDITCHANGE CBN](cbn-editchange.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="97bdc-233">Quando il contenuto del campo di selezione viene modificato in seguito alla selezione di un elemento elenco, questi messaggi non vengono inviati.</span><span class="sxs-lookup"><span data-stu-id="97bdc-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="97bdc-234">Owner-Drawn caselle combinate</span><span class="sxs-lookup"><span data-stu-id="97bdc-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="97bdc-235">Un'applicazione può creare una casella combinata creata dal proprietario per avere la responsabilità di disegnare gli elementi dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="97bdc-236">La finestra padre di una casella combinata creata dal proprietario (il proprietario) riceve i messaggi [**WM \_ DrawItem**](wm-drawitem.md) quando è necessario disegnare una parte della casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="97bdc-237">Una casella combinata creata dal proprietario può elencare informazioni diverse da, o in aggiunta a, stringhe di testo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="97bdc-238">Le caselle combinate create dal proprietario possono essere di qualsiasi tipo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="97bdc-239">Tuttavia, il controllo di modifica in una casella combinata semplice o a discesa può visualizzare solo testo, mentre il proprietario dipinge il campo di selezione in una casella di riepilogo a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="97bdc-240">Il proprietario di una casella combinata creata dal proprietario deve elaborare il messaggio [**WM \_ DrawItem**](wm-drawitem.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="97bdc-241">Questo messaggio viene inviato ogni volta che è necessario ricreare una parte della casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="97bdc-242">Il proprietario potrebbe dover elaborare altri messaggi, a seconda degli stili specificati per la casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="97bdc-243">Un'applicazione può creare una casella combinata creata dal proprietario specificando lo stile [**CBS \_ OwnerDrawFixed**](combo-box-styles.md) o [**CBS \_ OwnerDrawVariable**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="97bdc-244">Se tutti gli elementi dell'elenco nella casella combinata hanno la stessa altezza, ad esempio stringhe o icone, un'applicazione può usare lo stile **CBS \_ OwnerDrawFixed** .</span><span class="sxs-lookup"><span data-stu-id="97bdc-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="97bdc-245">Se gli elementi dell'elenco hanno un'altezza variabile, ad esempio bitmap di dimensioni diverse, un'applicazione può usare lo stile **\_ OwnerDrawVariable CBS** .</span><span class="sxs-lookup"><span data-stu-id="97bdc-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="97bdc-246">Il proprietario di una casella combinata creata dal proprietario può elaborare un messaggio [**WM \_ MeasureItem**](wm-measureitem.md) per specificare le dimensioni degli elementi dell'elenco nella casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="97bdc-247">Se l'applicazione crea la casella combinata usando lo stile [**CBS \_ OwnerDrawFixed**](combo-box-styles.md) , il sistema invia il messaggio **WM \_ MeasureItem** una sola volta.</span><span class="sxs-lookup"><span data-stu-id="97bdc-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="97bdc-248">Le dimensioni specificate dal proprietario vengono utilizzate per tutti gli elementi dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="97bdc-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="97bdc-249">Se viene usato lo stile [**CBS \_ OwnerDrawVariable**](combo-box-styles.md) , il sistema invia un messaggio **WM \_ MeasureItem** per ogni elemento elenco aggiunto alla casella combinata.</span><span class="sxs-lookup"><span data-stu-id="97bdc-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="97bdc-250">Il proprietario può determinare o impostare l'altezza di un elemento di elenco in qualsiasi momento usando i messaggi [**CB \_ GETITEMHEIGHT**](cb-getitemheight.md) e [**CB \_ SETITEMHEIGHT**](cb-setitemheight.md) , rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="97bdc-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="97bdc-251">Se le informazioni visualizzate in una casella combinata creata dal proprietario includono testo, un'applicazione può tenere traccia del testo per ogni elemento dell'elenco specificando lo [**stile \_ HASSTRINGS CBS**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="97bdc-252">Le caselle combinate con lo stile di [**\_ ordinamento CBS**](combo-box-styles.md) sono ordinate in base a questo testo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="97bdc-253">Se una casella combinata è ordinata e non dello stile **CBS \_ HASSTRINGS** , il proprietario deve elaborare il messaggio [**WM \_ COMPAREITEM**](wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="97bdc-254">In una casella combinata creata dal proprietario, il proprietario deve tenere traccia degli elementi elenco contenenti informazioni diverse da o oltre al testo.</span><span class="sxs-lookup"><span data-stu-id="97bdc-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="97bdc-255">Un modo pratico per eseguire questa operazione consiste nel salvare l'handle nelle informazioni come dati dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="97bdc-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="97bdc-256">Per liberare gli oggetti dati associati agli elementi di una casella combinata, il proprietario può elaborare il messaggio [**WM \_ DeleteItem**](wm-deleteitem.md) .</span><span class="sxs-lookup"><span data-stu-id="97bdc-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="97bdc-257">Caselle combinate sottoclassi</span><span class="sxs-lookup"><span data-stu-id="97bdc-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="97bdc-258">La sottoclasse è una procedura che consente a un'applicazione di intercettare ed elaborare i messaggi inviati o pubblicati in una finestra.</span><span class="sxs-lookup"><span data-stu-id="97bdc-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="97bdc-259">Utilizzando la sottoclasse, un'applicazione può sostituire la propria elaborazione per determinati messaggi, lasciando la maggior parte dell'elaborazione del messaggio alla routine della finestra definita dalla classe.</span><span class="sxs-lookup"><span data-stu-id="97bdc-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="97bdc-260">Quando il sistema operativo crea una finestra, Salva le relative informazioni in una struttura di dati interna che include un puntatore alla routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="97bdc-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="97bdc-261">Per sottoporre a una sottoclasse una finestra, un'applicazione chiama la funzione [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) per sostituire il puntatore alla procedura con un puntatore a una routine di sottoclasse definita dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97bdc-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="97bdc-262">Successivamente, tutti i messaggi alla finestra vengono inviati alla procedura di sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="97bdc-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="97bdc-263">Questa procedura usa quindi la funzione [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) per passare i messaggi non elaborati alla routine della finestra originale.</span><span class="sxs-lookup"><span data-stu-id="97bdc-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="97bdc-264">Per una descrizione dell'elaborazione dei messaggi eseguita dalla procedura della finestra della classe COMBOBOX, vedere [comportamento predefinito della casella combinata](combo-box-features.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="97bdc-265">Quando la casella combinata si trova al di fuori di una finestra di dialogo, un'applicazione non può elaborare la scheda, immettere ed eseguire il tasto ESC, a meno che non utilizzi una routine di sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="97bdc-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="97bdc-266">Quando una casella combinata semplice o a discesa riceve lo stato attivo per l'input, imposta immediatamente lo stato attivo sul relativo controllo di modifica figlio.</span><span class="sxs-lookup"><span data-stu-id="97bdc-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="97bdc-267">Un'applicazione deve quindi sottoporre a sottoclasse il controllo Edit per intercettare l'input da tastiera per una casella combinata semplice o a discesa.</span><span class="sxs-lookup"><span data-stu-id="97bdc-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="97bdc-268">Per un esempio, vedere la pagina relativa alla [sottoclasse di una casella combinata](using-combo-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="97bdc-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="97bdc-269">Se una routine di sottoclasse elabora il messaggio di [**\_ disegno WM**](/windows/desktop/gdi/wm-paint) , è necessario utilizzare la funzione [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) per prepararsi per il disegno.</span><span class="sxs-lookup"><span data-stu-id="97bdc-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="97bdc-270">Prima di chiamare la funzione [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) , passa l'handle del contesto di dispositivo (DC) come parametro *wParam* per la routine della finestra.</span><span class="sxs-lookup"><span data-stu-id="97bdc-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="97bdc-271">Se **EndPaint** viene chiamato per primo, la routine della finestra della classe non esegue il disegno perché **EndPaint** convalida l'intera finestra.</span><span class="sxs-lookup"><span data-stu-id="97bdc-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="97bdc-272">Una tecnica correlata alla sottoclasse è la superclasse.</span><span class="sxs-lookup"><span data-stu-id="97bdc-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="97bdc-273">Una superclasse è simile a qualsiasi altra classe con la differenza che la routine della finestra non chiama [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) per gestire i messaggi non elaborati.</span><span class="sxs-lookup"><span data-stu-id="97bdc-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="97bdc-274">Passa invece messaggi non elaborati alla routine della finestra per la classe della finestra padre.</span><span class="sxs-lookup"><span data-stu-id="97bdc-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="97bdc-275">Seguire le linee guida nelle [procedure di Windows](/windows/desktop/winmsg/window-procedures) per evitare problemi che possono verificarsi con la sottoclasse e la superclasse.</span><span class="sxs-lookup"><span data-stu-id="97bdc-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 