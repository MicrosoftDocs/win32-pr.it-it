---
title: Come creare procedure guidate
description: Una procedura guidata è un tipo di finestra delle proprietà che fornisce un modo semplice e potente per guidare gli utenti attraverso una procedura.
ms.assetid: f8def159-0a68-4d7f-9840-c7b6b906ed08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fedd35bd0454e0d78ddbe74d832543e58d0a8fc7
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/19/2021
ms.locfileid: "106323846"
---
# <a name="how-to-create-wizards"></a><span data-ttu-id="a1d32-103">Come creare procedure guidate</span><span class="sxs-lookup"><span data-stu-id="a1d32-103">How to Create Wizards</span></span>

<span data-ttu-id="a1d32-104">Una procedura guidata è un tipo di finestra delle proprietà che fornisce un modo semplice e potente per guidare gli utenti attraverso una procedura.</span><span class="sxs-lookup"><span data-stu-id="a1d32-104">A wizard is a type of property sheet that provides a simple and powerful way to guide users through a procedure.</span></span>

<span data-ttu-id="a1d32-105">Le procedure guidate sono una delle chiavi per semplificare l'esperienza utente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-105">Wizards are one of the keys to simplifying the user experience.</span></span> <span data-ttu-id="a1d32-106">Consentono di eseguire un'operazione complessa, ad esempio la configurazione di un'applicazione, e di suddividerla in una serie di semplici passaggi.</span><span class="sxs-lookup"><span data-stu-id="a1d32-106">They allow you to take a complex operation, such as configuration of an application, and break it into a series of simple steps.</span></span> <span data-ttu-id="a1d32-107">In ogni punto del processo è possibile fornire una spiegazione degli elementi necessari e visualizzare i controlli che consentono all'utente di effettuare le selezioni e immettere il testo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-107">At each point in the process, you can provide an explanation of what is needed, and display controls that allow the user to make selections and enter text.</span></span>

<span data-ttu-id="a1d32-108">Una procedura guidata è effettivamente un tipo di finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-108">A wizard is actually a type of property sheet.</span></span> <span data-ttu-id="a1d32-109">Una finestra delle proprietà è essenzialmente un contenitore per una raccolta di *pagine*, in cui ogni pagina è una finestra di dialogo separata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-109">A property sheet is essentially a container for a collection of *pages*, where each page is a separate dialog box.</span></span> <span data-ttu-id="a1d32-110">Mentre le finestre delle proprietà normali consentono all'utente di accedere a qualsiasi pagina in qualsiasi momento, le procedure guidate presentano le pagine in sequenza.</span><span class="sxs-lookup"><span data-stu-id="a1d32-110">Whereas regular property sheets allow the user to access any page at any time, wizards present pages in sequence.</span></span> <span data-ttu-id="a1d32-111">Anziché le schede, i pulsanti vengono usati per spostarsi avanti e indietro.</span><span class="sxs-lookup"><span data-stu-id="a1d32-111">Instead of tabs, buttons are used to navigate forward and backward.</span></span> <span data-ttu-id="a1d32-112">L'ordine in cui vengono visualizzate le pagine è controllato dall'applicazione e può essere modificato in base all'input dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-112">The order in which pages are displayed is controlled by the application and can be modified based on user input.</span></span>

<span data-ttu-id="a1d32-113">Sono disponibili due stili principali della procedura guidata: lo stile Wizard97 precedente e lo stile Aero introdotto in Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a1d32-113">There are two main styles of wizard: the older Wizard97 style, and the Aero style introduced in Windows Vista.</span></span> <span data-ttu-id="a1d32-114">Per le illustrazioni, vedere [informazioni sulle finestre delle proprietà](property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="a1d32-114">For illustrations, see [About Property Sheets](property-sheets.md).</span></span> <span data-ttu-id="a1d32-115">(Un terzo stile, usando solo PSH \_ La procedura guidata \_ o \_ il flag PSH Wizard Lite presenta una semplice sequenza di finestre delle proprietà senza intestazioni o filigrane.</span><span class="sxs-lookup"><span data-stu-id="a1d32-115">(A third style, using just the PSH\_WIZARD or PSH\_WIZARD\_LITE flag, presents a simple sequence of property sheets with no headers or watermarks.)</span></span>

> [!Note]  
> <span data-ttu-id="a1d32-116">Una "filigrana" nel contesto delle procedure guidate è una bitmap visualizzata nel margine sinistro di alcune pagine.</span><span class="sxs-lookup"><span data-stu-id="a1d32-116">A "watermark" in the context of wizards is a bitmap that appears in the left margin of some pages.</span></span>

 

<span data-ttu-id="a1d32-117">Nella maggior parte di questo documento si presuppone che si stia implementando una procedura guidata per un sistema con la [versione 5,80](common-control-versions.md) o successive dei controlli comuni.</span><span class="sxs-lookup"><span data-stu-id="a1d32-117">The discussion in most of this document assumes that you are implementing a wizard for a system with [version 5.80](common-control-versions.md) or later of the common controls.</span></span> <span data-ttu-id="a1d32-118">Se si tenta di utilizzare lo stile Wizard97 con le versioni precedenti dei controlli comuni, è possibile che l'applicazione venga compilata, ma non viene visualizzata correttamente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-118">If you attempt to use the Wizard97 style with earlier versions of the common controls, your application may compile but it will not display properly.</span></span> <span data-ttu-id="a1d32-119">Per informazioni su come creare una procedura guidata compatibile con Wizard97 nei sistemi precedenti, vedere la pagina relativa alle procedure guidate compatibili con le versioni precedenti più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="a1d32-119">For a discussion about how to create a Wizard97-compatible wizard on earlier systems, see Backward Compatible Wizards later in this topic.</span></span>

## <a name="what-you-need-to-know"></a><span data-ttu-id="a1d32-120">Informazioni importanti</span><span class="sxs-lookup"><span data-stu-id="a1d32-120">What you need to know</span></span>

### <a name="technologies"></a><span data-ttu-id="a1d32-121">Tecnologie</span><span class="sxs-lookup"><span data-stu-id="a1d32-121">Technologies</span></span>

-   [<span data-ttu-id="a1d32-122">Controlli Windows</span><span class="sxs-lookup"><span data-stu-id="a1d32-122">Windows Controls</span></span>](window-controls.md)

### <a name="prerequisites"></a><span data-ttu-id="a1d32-123">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="a1d32-123">Prerequisites</span></span>

-   <span data-ttu-id="a1d32-124">C/C++</span><span class="sxs-lookup"><span data-stu-id="a1d32-124">C/C++</span></span>
-   <span data-ttu-id="a1d32-125">Programmazione dell'interfaccia utente di Windows</span><span class="sxs-lookup"><span data-stu-id="a1d32-125">Windows User Interface Programming</span></span>

## <a name="instructions"></a><span data-ttu-id="a1d32-126">Istruzioni</span><span class="sxs-lookup"><span data-stu-id="a1d32-126">Instructions</span></span>

### <a name="wizard-implementation"></a><span data-ttu-id="a1d32-127">Implementazione della procedura guidata</span><span class="sxs-lookup"><span data-stu-id="a1d32-127">Wizard Implementation</span></span>

<span data-ttu-id="a1d32-128">L'implementazione di una procedura guidata è simile all'implementazione di una normale finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-128">Implementing a wizard is similar to implementing a regular property sheet.</span></span> <span data-ttu-id="a1d32-129">Al livello più elementare, è importante impostare uno dei flag o combinazioni di flag seguenti nella struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) che definisce la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-129">At the most basic level, it is a matter of setting one of the following flags or combinations of flags in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure that defines the property sheet.</span></span>



| <span data-ttu-id="a1d32-130">Contrassegno</span><span class="sxs-lookup"><span data-stu-id="a1d32-130">Flag</span></span>                           | <span data-ttu-id="a1d32-131">Stile</span><span class="sxs-lookup"><span data-stu-id="a1d32-131">Style</span></span>                                                                                                                                                 |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a1d32-132">\_procedura guidata PSH</span><span class="sxs-lookup"><span data-stu-id="a1d32-132">PSH\_WIZARD</span></span>                    | <span data-ttu-id="a1d32-133">Procedura guidata semplice senza intestazioni o bitmap.</span><span class="sxs-lookup"><span data-stu-id="a1d32-133">A simple wizard with no headers or bitmaps.</span></span>                                                                                                           |
| <span data-ttu-id="a1d32-134">\_procedura guidata PSH \_ Lite</span><span class="sxs-lookup"><span data-stu-id="a1d32-134">PSH\_WIZARD\_LITE</span></span>              | <span data-ttu-id="a1d32-135">Analogamente alla \_ procedura guidata PSH, con alcune differenze minime nell'aspetto. ad esempio, il divisore sopra i pulsanti è impostato sulla larghezza intera della finestra.</span><span class="sxs-lookup"><span data-stu-id="a1d32-135">Similar to PSH\_WIZARD, with some minor differences in appearance; for example, the divider above the buttons is set to the full width of the window.</span></span> |
| <span data-ttu-id="a1d32-136">\_WIZARD97 PSH</span><span class="sxs-lookup"><span data-stu-id="a1d32-136">PSH\_WIZARD97</span></span>                  | <span data-ttu-id="a1d32-137">Procedura guidata Wizard97 con intestazioni (facoltative), bitmap di intestazione e filigrane.</span><span class="sxs-lookup"><span data-stu-id="a1d32-137">A Wizard97 wizard with (optional) headers, header bitmaps, and watermarks.</span></span>                                                                            |
| <span data-ttu-id="a1d32-138">PSH \_ Wizard \| PSH \_ AEROWIZARD</span><span class="sxs-lookup"><span data-stu-id="a1d32-138">PSH\_WIZARD \| PSH\_AEROWIZARD</span></span> | <span data-ttu-id="a1d32-139">Procedura guidata Aero.</span><span class="sxs-lookup"><span data-stu-id="a1d32-139">An Aero Wizard.</span></span> <span data-ttu-id="a1d32-140">Le creazioni guidate Aero non utilizzano filigrane o bitmap di intestazione.</span><span class="sxs-lookup"><span data-stu-id="a1d32-140">Aero Wizards do not use watermarks or header bitmaps.</span></span> <span data-ttu-id="a1d32-141">Richiedono il modello di Apartment a thread singolo (STA).</span><span class="sxs-lookup"><span data-stu-id="a1d32-141">They require the single-threaded apartment (STA) model.</span></span>                         |



 

<span data-ttu-id="a1d32-142">La procedura di base per l'implementazione di una procedura guidata è la seguente:</span><span class="sxs-lookup"><span data-stu-id="a1d32-142">The basic procedure for implementing a wizard is as follows:</span></span>

1.  <span data-ttu-id="a1d32-143">Creare un modello di finestra di dialogo per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-143">Create a dialog box template for each page.</span></span>
2.  <span data-ttu-id="a1d32-144">Definire le pagine creando una struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-144">Define the pages by creating a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure for each page.</span></span> <span data-ttu-id="a1d32-145">Questa struttura definisce la pagina e contiene i puntatori al modello della finestra di dialogo ed eventuali bitmap o altre risorse.</span><span class="sxs-lookup"><span data-stu-id="a1d32-145">This structure defines the page, and contains pointers to the dialog box template and any bitmaps or other resources.</span></span>
3.  <span data-ttu-id="a1d32-146">Passare la struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) creata nel passaggio precedente alla funzione [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) per creare l'handle HPROPSHEETPAGE della pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-146">Pass the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that was created in the previous step to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>
4.  <span data-ttu-id="a1d32-147">Definire la procedura guidata creando una struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-147">Define the wizard by creating a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure for it.</span></span>
5.  <span data-ttu-id="a1d32-148">Passare la struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) alla funzione [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) per visualizzare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-148">Pass the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to display the wizard.</span></span>
6.  <span data-ttu-id="a1d32-149">Implementare le procedure della finestra di dialogo per ogni pagina per gestire i messaggi di notifica dai controlli della pagina e i pulsanti della procedura guidata e per elaborare altri messaggi di Windows.</span><span class="sxs-lookup"><span data-stu-id="a1d32-149">Implement dialog box procedures for each page to handle notification messages from the page's controls and the wizard's buttons and to process other Windows messaging.</span></span>

### <a name="create-the-dialog-box-templates"></a><span data-ttu-id="a1d32-150">Creare i modelli della finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="a1d32-150">Create the Dialog Box Templates</span></span>

<span data-ttu-id="a1d32-151">Sono disponibili due tipi di base della pagina della procedura guidata: esterno e interno.</span><span class="sxs-lookup"><span data-stu-id="a1d32-151">There are two basic types of wizard page: exterior and interior.</span></span> <span data-ttu-id="a1d32-152">Le pagine esterne sono le pagine introduttive (introduttive) e di completamento.</span><span class="sxs-lookup"><span data-stu-id="a1d32-152">Exterior pages are the introduction (welcome) and completion pages.</span></span> <span data-ttu-id="a1d32-153">Tutti gli altri sono pagine interne.</span><span class="sxs-lookup"><span data-stu-id="a1d32-153">All others are interior pages.</span></span>

<span data-ttu-id="a1d32-154">**Modelli di finestra di dialogo della pagina esterna**</span><span class="sxs-lookup"><span data-stu-id="a1d32-154">**Exterior Page Dialog Box Templates**</span></span>

<span data-ttu-id="a1d32-155">Il layout di base delle pagine introduttive e di completamento è identico.</span><span class="sxs-lookup"><span data-stu-id="a1d32-155">The basic layout of the introduction and completion pages is identical.</span></span> <span data-ttu-id="a1d32-156">Nella figura seguente è illustrata una pagina introduttiva di esempio Wizard97 con una filigrana segnaposto.</span><span class="sxs-lookup"><span data-stu-id="a1d32-156">The following illustration shows a sample Wizard97 introduction page, with a placeholder watermark.</span></span>

![screenshot che mostra una pagina della procedura guidata con un grafico a sinistra, un titolo e un testo del corpo a destra e pulsanti indietro, avanti e Annulla nella parte inferiore](images/wiz97exterior.png)

<span data-ttu-id="a1d32-158">Per le pagine esterne di Wizard97, il modello della finestra di dialogo è unità di dialogo 317x193.</span><span class="sxs-lookup"><span data-stu-id="a1d32-158">For Wizard97 exterior pages, the dialog box template is 317x193 dialog units.</span></span> <span data-ttu-id="a1d32-159">Riempie tutta la procedura guidata, eccetto la didascalia e la banda nella parte inferiore che contiene i pulsanti **indietro**, **Avanti** e **Annulla** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-159">It fills all of the wizard, except for the caption and the band at the bottom that contains the **Back**, **Next**, and **Cancel** buttons.</span></span> <span data-ttu-id="a1d32-160">Il lato sinistro del modello, riservato per una bitmap "watermark", non deve contenere alcun controllo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-160">The left side of the template, which is reserved for a "watermark" bitmap, should not contain any controls.</span></span> <span data-ttu-id="a1d32-161">La filigrana viene specificata nella struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) della procedura guidata e viene aggiunta automaticamente alla pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-161">The watermark is specified in the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure and is added to the page automatically.</span></span> <span data-ttu-id="a1d32-162">Quando si progetta il modello di risorsa, è necessario consentirne lo spazio.</span><span class="sxs-lookup"><span data-stu-id="a1d32-162">You must allow space for it when designing the resource template.</span></span>

<span data-ttu-id="a1d32-163">Quando si crea la bitmap della filigrana, tenere presente che la dimensione della finestra di dialogo può aumentare se, ad esempio, l'utente sceglie un tipo di carattere di sistema di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="a1d32-163">When you create the watermark bitmap, keep in mind that the dialog box may increase in size if, for example, the user chooses a large system font.</span></span> <span data-ttu-id="a1d32-164">Lingue diverse tendono anche a avere metriche dei tipi di carattere differenti.</span><span class="sxs-lookup"><span data-stu-id="a1d32-164">Different languages also tend to have different font metrics.</span></span> <span data-ttu-id="a1d32-165">Quando la pagina cresce, l'area riservata per la filigrana è proporzionalmente più grande.</span><span class="sxs-lookup"><span data-stu-id="a1d32-165">When the page grows, the area reserved for the watermark gets proportionately larger.</span></span> <span data-ttu-id="a1d32-166">Tuttavia, non è possibile modificare la bitmap della filigrana né la bitmap estesa per riempire l'area più grande.</span><span class="sxs-lookup"><span data-stu-id="a1d32-166">However, you cannot change the watermark bitmap, nor is the bitmap stretched to fill the larger area.</span></span> <span data-ttu-id="a1d32-167">La bitmap viene invece lasciata nelle dimensioni originali nella parte superiore sinistra dell'area riservata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-167">Instead, the bitmap is left in its original size in the upper-left portion of the reserved area.</span></span> <span data-ttu-id="a1d32-168">La parte dell'area riservata più grande che non è coperta dalla filigrana viene riempita automaticamente con il colore del pixel in alto a sinistra della bitmap.</span><span class="sxs-lookup"><span data-stu-id="a1d32-168">The part of the larger reserved area that is not covered by the watermark is automatically filled with the color of the bitmap's upper-left pixel.</span></span>

<span data-ttu-id="a1d32-169">Se è necessario disporre di bitmap di filigrana di dimensioni diverse per le diverse metriche dei tipi di carattere, sono disponibili due soluzioni:</span><span class="sxs-lookup"><span data-stu-id="a1d32-169">If you need to have different-sized watermark bitmaps for different font metrics, two possible solutions are:</span></span>

-   <span data-ttu-id="a1d32-170">Ottenere la metrica del tipo di carattere prima di creare la procedura guidata e specificare una bitmap di filigrana opportunamente dimensionata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-170">Get the font metrics before creating the wizard, and specify an appropriately sized watermark bitmap.</span></span>
-   <span data-ttu-id="a1d32-171">Non specificare una bitmap della filigrana quando si crea la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-171">Do not specify a watermark bitmap when you create the wizard.</span></span> <span data-ttu-id="a1d32-172">Wizard97 lascerà vuota l'area della filigrana.</span><span class="sxs-lookup"><span data-stu-id="a1d32-172">Wizard97 will leave the watermark area blank.</span></span> <span data-ttu-id="a1d32-173">Quindi, creare una bitmap di dimensioni appropriate nell'area riservata per la filigrana.</span><span class="sxs-lookup"><span data-stu-id="a1d32-173">Then draw an appropriately sized bitmap on the area reserved for the watermark.</span></span>

<span data-ttu-id="a1d32-174">È possibile posizionare i controlli nell'area a destra della filigrana come per una normale finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-174">You can place controls in the area to the right of the watermark as you would for a regular dialog box.</span></span> <span data-ttu-id="a1d32-175">Il colore di sfondo di quest'area è determinato dal sistema e non richiede alcuna azione da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-175">The background color of this area is determined by the system, and requires no action on your part.</span></span> <span data-ttu-id="a1d32-176">In questa area vengono in genere inseriti due controlli statici.</span><span class="sxs-lookup"><span data-stu-id="a1d32-176">You typically put two static controls in this area.</span></span> <span data-ttu-id="a1d32-177">Il valore superiore include il titolo e usa un carattere grassetto di grandi dimensioni (Verdana in grassetto a 12 punti per Wizard97).</span><span class="sxs-lookup"><span data-stu-id="a1d32-177">The upper one holds the title and uses a large bold font (12 point Verdana Bold for Wizard97).</span></span> <span data-ttu-id="a1d32-178">L'altro, che è per il testo esplicativo, usa il tipo di carattere standard della finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-178">The other one, which is for explanatory text, uses the standard dialog box font.</span></span>

<span data-ttu-id="a1d32-179">La differenza principale tra le pagine introduttive e di completamento è costituita dai pulsanti della procedura guidata e dal testo nei controlli statici.</span><span class="sxs-lookup"><span data-stu-id="a1d32-179">The main difference between the introduction and completion pages is the wizard buttons and the text in the static controls.</span></span> <span data-ttu-id="a1d32-180">Le pagine introduttive dispongono in genere di un pulsante **Avanti** e **indietro** , in cui è abilitato solo il pulsante **Avanti** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-180">Introduction pages normally have a **Next** and a **Back** button, with only the **Next** button enabled.</span></span> <span data-ttu-id="a1d32-181">Nelle pagine di completamento è abilitato il pulsante **indietro** e il pulsante **Avanti** viene sostituito da un pulsante **fine** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-181">Completion pages have the **Back** button enabled, and the **Next** button is replaced by a **Finish** button.</span></span>

> [!Note]  
> <span data-ttu-id="a1d32-182">Nelle procedure guidate Aero il pulsante **indietro** viene sostituito da un pulsante freccia sulla barra del titolo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-182">In Aero Wizards, the **Back** button is replaced by an arrow button in the caption bar.</span></span>

 

<span data-ttu-id="a1d32-183">È possibile modificare il testo nel pulsante **fine** inviando la procedura guidata un messaggio [**PSM \_ SETFINISHTEXT**](psm-setfinishtext.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-183">You can modify the text on the **Finish** button by sending the wizard a [**PSM\_SETFINISHTEXT**](psm-setfinishtext.md) message.</span></span> <span data-ttu-id="a1d32-184">Per impostazione predefinita, il pulsante **fine** non include un tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="a1d32-184">By default, the **Finish** button does not include a keyboard accelerator.</span></span> <span data-ttu-id="a1d32-185">Per definire un tasto di scelta rapida, includere una e commerciale nella stringa di testo passata a PSM \_ SETFINISHTEXT.</span><span class="sxs-lookup"><span data-stu-id="a1d32-185">To define a keyboard accelerator, include an ampersand in the text string that you pass to PSM\_SETFINISHTEXT.</span></span> <span data-ttu-id="a1d32-186">Ad esempio, "&Finish" definisce "F" come tasto di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="a1d32-186">For instance, "&Finish" defines 'F' as the keyboard accelerator.</span></span>

<span data-ttu-id="a1d32-187">**Modelli di finestra di dialogo della pagina interna**</span><span class="sxs-lookup"><span data-stu-id="a1d32-187">**Interior Page Dialog Box Templates**</span></span>

<span data-ttu-id="a1d32-188">Le pagine interne hanno un aspetto leggermente diverso rispetto alle pagine esterne.</span><span class="sxs-lookup"><span data-stu-id="a1d32-188">Interior pages have a somewhat different appearance than exterior pages.</span></span> <span data-ttu-id="a1d32-189">Nella figura seguente è illustrata una pagina interna di esempio di Wizard97 con una bitmap dell'intestazione segnaposto.</span><span class="sxs-lookup"><span data-stu-id="a1d32-189">The following illustration shows a sample Wizard97 interior page, with a placeholder header bitmap.</span></span>

![Screenshot di una pagina della procedura guidata con testo titolo e sottotitolo e un elemento grafico nella parte superiore, testo al centro e pulsanti in basso](images/wiz97interior.png)

<span data-ttu-id="a1d32-191">L'area di intestazione nella parte superiore della pagina viene gestita dalla finestra delle proprietà, quindi non è inclusa nel modello.</span><span class="sxs-lookup"><span data-stu-id="a1d32-191">The header area at the top of the page is handled by the property sheet, so it is not included in the template.</span></span> <span data-ttu-id="a1d32-192">Il contenuto dell'intestazione viene specificato nella struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) della pagina e nella struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-192">The contents of the header are specified in the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure and the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="a1d32-193">Poiché la pagina interna deve rientrare tra l'intestazione e i pulsanti, il modello della finestra di dialogo Wizard97 è unità di dialogo 317x143, leggermente più piccolo del modello per le pagine esterne.</span><span class="sxs-lookup"><span data-stu-id="a1d32-193">Because the interior page needs to fit between the header and the buttons, the Wizard97 dialog box template is 317x143 dialog units, somewhat smaller than the template for exterior pages.</span></span>

<span data-ttu-id="a1d32-194">Nella figura seguente è illustrata una procedura guidata Aero creata con lo stesso modello.</span><span class="sxs-lookup"><span data-stu-id="a1d32-194">The following illustration shows an Aero Wizard that was created from the same template.</span></span>

![Screenshot diverso da quello precedente con un'area del titolo nella parte superiore e solo i pulsanti avanti e Annulla nella parte inferiore](images/wizardaerointerior.png)

### <a name="define-the-wizard-pages"></a><span data-ttu-id="a1d32-196">Definire le pagine della procedura guidata</span><span class="sxs-lookup"><span data-stu-id="a1d32-196">Define the Wizard Pages</span></span>

<span data-ttu-id="a1d32-197">Dopo aver creato i modelli della finestra di dialogo e le risorse correlate, ad esempio le bitmap e le tabelle di stringhe, è possibile creare le pagine della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-197">After you have created the dialog box templates and related resources such as bitmaps and string tables, you can create the property sheet pages.</span></span> <span data-ttu-id="a1d32-198">La procedura è simile a quella per le finestre delle proprietà standard.</span><span class="sxs-lookup"><span data-stu-id="a1d32-198">The procedure is similar to that for standard property sheets.</span></span> <span data-ttu-id="a1d32-199">Per prima cosa, compilare i membri appropriati di una struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-199">First, fill in the appropriate members of a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="a1d32-200">Alcuni membri sono specifici delle procedure guidate. Chiamare quindi la funzione [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) per creare l'handle HPROPSHEETPAGE della pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-200">(Some members are specific to wizards.) Then call the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>

<span data-ttu-id="a1d32-201">I flag seguenti relativi alla procedura guidata possono essere impostati nel membro **dwFlags** della struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-201">The following wizard-related flags can be set in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>



| <span data-ttu-id="a1d32-202">Flag</span><span class="sxs-lookup"><span data-stu-id="a1d32-202">Flag</span></span>                   | <span data-ttu-id="a1d32-203">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a1d32-203">Description</span></span>                                                                                                                         |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a1d32-204">\_HIDEHEADER PSP</span><span class="sxs-lookup"><span data-stu-id="a1d32-204">PSP\_HIDEHEADER</span></span>        | <span data-ttu-id="a1d32-205">Impostare questo flag per le pagine esterne in Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a1d32-205">Set this flag for exterior pages in Wizard97.</span></span> <span data-ttu-id="a1d32-206">L'intestazione non viene visualizzata e può essere visualizzata una filigrana.</span><span class="sxs-lookup"><span data-stu-id="a1d32-206">The header is not shown, and a watermark can be shown.</span></span>                                |
| <span data-ttu-id="a1d32-207">\_USEHEADERTITLE PSP</span><span class="sxs-lookup"><span data-stu-id="a1d32-207">PSP\_USEHEADERTITLE</span></span>    | <span data-ttu-id="a1d32-208">Impostare questo flag per le pagine interne per inserire un titolo nell'area di intestazione in Wizard97 o nella parte superiore dell'area client in una procedura guidata Aero.</span><span class="sxs-lookup"><span data-stu-id="a1d32-208">Set this flag for interior pages to put a title in the header area in Wizard97, or at the top of the client area in an Aero Wizard.</span></span> |
| <span data-ttu-id="a1d32-209">\_USEHEADERSUBTITLE PSP</span><span class="sxs-lookup"><span data-stu-id="a1d32-209">PSP\_USEHEADERSUBTITLE</span></span> | <span data-ttu-id="a1d32-210">Impostare questo flag per le pagine interne per inserire un sottotitolo nell'area di intestazione di Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a1d32-210">Set this flag for interior pages to put a subtitle in the header area in Wizard97.</span></span>                                                  |



 

<span data-ttu-id="a1d32-211">Se è stato impostato PSP \_ USEHEADERTITLE o PSP \_ USEHEADERSUBTITLE, assegnare il testo titolo e sottotitolo ai membri **pszHeaderTitle** e **pszHeaderSubtitle** , rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-211">If you have set PSP\_USEHEADERTITLE or PSP\_USEHEADERSUBTITLE, assign the title and subtitle text to the **pszHeaderTitle** and **pszHeaderSubtitle** members, respectively.</span></span> <span data-ttu-id="a1d32-212">Quando si assegnano stringhe di testo ai membri delle strutture [**PROPSHEETPAGE**](pss-propsheetpage.md) e [**PROPSHEETHEADER**](pss-propsheetheader.md) , è possibile assegnare un puntatore di stringa o usare la macro **MAKEINTRESOURCE** per assegnare un valore da una risorsa di tipo stringa.</span><span class="sxs-lookup"><span data-stu-id="a1d32-212">When you assign text strings to members of the [**PROPSHEETPAGE**](pss-propsheetpage.md) and [**PROPSHEETHEADER**](pss-propsheetheader.md) structures, you can either assign a string pointer or use the **MAKEINTRESOURCE** macro to assign a value from a string resource.</span></span> <span data-ttu-id="a1d32-213">La risorsa di stringa viene caricata dal modulo specificato nel membro **HINSTANCE** della struttura **PROPSHEETHEADER** della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-213">The string resource is loaded from the module specified in the **hInstance** member of the wizard's **PROPSHEETHEADER** structure.</span></span>

<span data-ttu-id="a1d32-214">Quando si chiama [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) per creare una pagina, assegnare il risultato a un elemento di una matrice di handle HPROPSHEETPAGE.</span><span class="sxs-lookup"><span data-stu-id="a1d32-214">When you call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) to create a page, assign the result to an element of an array of HPROPSHEETPAGE handles.</span></span> <span data-ttu-id="a1d32-215">Questa matrice viene utilizzata durante la creazione della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-215">This array is used when creating the property sheet.</span></span> <span data-ttu-id="a1d32-216">L'indice della matrice di un handle di pagina determina l'ordine predefinito in cui viene visualizzato.</span><span class="sxs-lookup"><span data-stu-id="a1d32-216">The array index of a page's handle determines the default order in which it is displayed.</span></span> <span data-ttu-id="a1d32-217">Dopo aver creato un handle HPROPSHEETPAGE della pagina, è possibile riutilizzare la stessa struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) per creare la pagina successiva assegnando nuovi valori ai membri pertinenti.</span><span class="sxs-lookup"><span data-stu-id="a1d32-217">After you have created a page's HPROPSHEETPAGE handle, you can reuse the same [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to create the next page by assigning new values to the relevant members.</span></span>

<span data-ttu-id="a1d32-218">Un modo alternativo per creare pagine consiste nell'usare strutture [**PROPSHEETPAGE**](pss-propsheetpage.md) separate per ogni pagina e creare una matrice di strutture.</span><span class="sxs-lookup"><span data-stu-id="a1d32-218">An alternative way to create pages is to use separate [**PROPSHEETPAGE**](pss-propsheetpage.md) structures for each page, and create an array of structures.</span></span> <span data-ttu-id="a1d32-219">Questa matrice viene usata al posto di una matrice di handle HPROPSHEETPAGE durante la creazione della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-219">This array is used instead of an array of HPROPSHEETPAGE handles when creating the property sheet.</span></span> <span data-ttu-id="a1d32-220">L'uso di strutture **PROPSHEETPAGE** separate Elimina la necessità di chiamare [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) ma usa una maggiore quantità di memoria.</span><span class="sxs-lookup"><span data-stu-id="a1d32-220">Using separate **PROPSHEETPAGE** structures eliminates the need to call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) but uses more memory.</span></span> <span data-ttu-id="a1d32-221">In caso contrario, non esiste alcuna differenza significativa tra i due approcci.</span><span class="sxs-lookup"><span data-stu-id="a1d32-221">Otherwise, there is no significant difference between the two approaches.</span></span>

<span data-ttu-id="a1d32-222">Nell'esempio seguente viene definita una pagina Wizard97 interna assegnando valori a una struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-222">The following example defines an interior Wizard97 page by assigning values to a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="a1d32-223">In questo esempio il titolo, il sottotitolo e il modello della finestra di dialogo della pagina sono tutti identificati dai relativi ID di risorsa.</span><span class="sxs-lookup"><span data-stu-id="a1d32-223">In this example, the page's title, subtitle, and dialog box template are all identified by their resource IDs.</span></span> <span data-ttu-id="a1d32-224">Viene quindi chiamata la funzione [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) per creare l'handle HPROPSHEETPAGE della pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-224">The [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function is then called to create the page's HPROPSHEETPAGE handle.</span></span> <span data-ttu-id="a1d32-225">Poiché verrà visualizzata la seconda pagina, l'handle viene assegnato alla matrice di Handles, *ahpsp*, con indice 1.</span><span class="sxs-lookup"><span data-stu-id="a1d32-225">Because it will be the second page to appear, the handle is assigned to the array of handles, *ahpsp*, with an index of 1.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// IntPage1DlgProc is the dialog procedure for this page.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETPAGE psp = { sizeof(psp) };

psp.hInstance         = g_hInstance;
psp.dwFlags           = PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE;
psp.lParam            = (LPARAM) &wizdata;
psp.pszHeaderTitle    = MAKEINTRESOURCE(IDS_TITLE1);
psp.pszHeaderSubTitle = MAKEINTRESOURCE(IDS_SUBTITLE1);
psp.pszTemplate       = MAKEINTRESOURCE(IDD_INTERIOR1);
psp.pfnDlgProc        = IntPage1DlgProc;

ahpsp[1] = CreatePropertySheetPage(&psp);
```



### <a name="custom-page-data"></a><span data-ttu-id="a1d32-226">Dati della pagina personalizzati</span><span class="sxs-lookup"><span data-stu-id="a1d32-226">Custom Page Data</span></span>

<span data-ttu-id="a1d32-227">Quando si crea una pagina, è possibile assegnarvi dati personalizzati usando il membro **lParam** della struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) , in genere assegnando un puntatore a una struttura definita dall'utente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-227">When you create a page, you can assign custom data to it by using the **lParam** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, typically by assigning it a pointer to a user-defined structure.</span></span>

<span data-ttu-id="a1d32-228">Quando la pagina viene selezionata per la prima volta, la relativa routine della finestra di dialogo riceve un messaggio [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-228">When the page is first selected, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a1d32-229">Il valore *lParam* del messaggio punta a una copia della struttura [**PROPSHEETPAGE**](pss-propsheetpage.md) della pagina, da cui è possibile recuperare i dati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="a1d32-229">The message's *lParam* value points to a copy of of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, from which you can retrieve the custom data.</span></span> <span data-ttu-id="a1d32-230">È quindi possibile archiviare questi dati per l'uso nei messaggi successivi usando [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) con GWL \_ UserData come parametro di indice.</span><span class="sxs-lookup"><span data-stu-id="a1d32-230">You can then store this data for use in subsequent messages by using [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) with GWL\_USERDATA as the index parameter.</span></span> <span data-ttu-id="a1d32-231">Più pagine possono avere un puntatore per gli stessi dati e qualsiasi modifica apportata ai dati da una pagina è disponibile per le altre pagine nelle relative procedure di dialogo.</span><span class="sxs-lookup"><span data-stu-id="a1d32-231">Multiple pages can have a pointer to the same data, and any change to the data made by one page is available to the other pages in their dialog procedures.</span></span>

### <a name="define-the-wizard-property-sheet"></a><span data-ttu-id="a1d32-232">Definire la finestra delle proprietà della procedura guidata</span><span class="sxs-lookup"><span data-stu-id="a1d32-232">Define the Wizard Property Sheet</span></span>

<span data-ttu-id="a1d32-233">Come per le finestre delle proprietà ordinarie, si definisce la finestra delle proprietà della procedura guidata compilando i membri di una struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-233">As with ordinary property sheets, you define the wizard's property sheet by filling in members of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="a1d32-234">Questa struttura consente di specificare le pagine che costituiscono la procedura guidata e l'ordine predefinito in cui vengono visualizzate, insieme a diversi parametri correlati.</span><span class="sxs-lookup"><span data-stu-id="a1d32-234">This structure allows you to specify the pages that make up the wizard and the default order in which they are displayed, along with several related parameters.</span></span> <span data-ttu-id="a1d32-235">Viene quindi avviata la procedura guidata chiamando la funzione [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-235">You then launch the wizard by calling the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="a1d32-236">Nello stile Wizard97, il membro **pszCaption** della struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="a1d32-236">In the Wizard97 style, the **pszCaption** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure is ignored.</span></span> <span data-ttu-id="a1d32-237">Al contrario, nella procedura guidata viene visualizzata la didascalia specificata nel modello della finestra di dialogo della pagina corrente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-237">Instead, the wizard displays the caption that is specified in the current page's dialog box template.</span></span> <span data-ttu-id="a1d32-238">Se il modello non dispone di una didascalia, viene visualizzata la didascalia della pagina precedente.</span><span class="sxs-lookup"><span data-stu-id="a1d32-238">If the template lacks a caption, the caption from the previous page is displayed.</span></span> <span data-ttu-id="a1d32-239">Quindi, per visualizzare la stessa didascalia in tutte le pagine, specificare la didascalia nel modello per la pagina introduttiva.</span><span class="sxs-lookup"><span data-stu-id="a1d32-239">Thus, to display the same caption on all pages, specify the caption in the template for the introductory page.</span></span>

<span data-ttu-id="a1d32-240">Nello stile della procedura guidata Aero la didascalia della finestra di dialogo viene ricavata da **pszCaption**.</span><span class="sxs-lookup"><span data-stu-id="a1d32-240">In the Aero Wizard style, the dialog box caption is taken from **pszCaption**.</span></span>

<span data-ttu-id="a1d32-241">Se è stata creata una matrice di handle HPROPSHEETPAGE per le pagine, assegnare la matrice al membro **phpage** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-241">If you have created an array of HPROPSHEETPAGE handles for your pages, assign the array to the **phpage** member.</span></span> <span data-ttu-id="a1d32-242">Se invece è stata creata una matrice di strutture [**PROPSHEETPAGE**](pss-propsheetpage.md) , assegnare la matrice al membro **ppSP** e impostare il flag PSH \_ PROPSHEETPAGE nel membro **dwFlags** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-242">If you have instead created an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures, assign the array to the **ppsp** member and set the PSH\_PROPSHEETPAGE flag in the **dwFlags** member.</span></span>

<span data-ttu-id="a1d32-243">Nell'esempio seguente vengono assegnati valori a *PSH*, una struttura [**PROPSHEETHEADER**](pss-propsheetheader.md) e viene chiamata la funzione [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) per avviare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-243">The following example assigns values to *psh*, a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure, and calls the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to launch the wizard.</span></span> <span data-ttu-id="a1d32-244">La procedura guidata di tipo Wizard97 ha sia la filigrana che la grafica dell'intestazione, specificata dai rispettivi ID di risorsa.</span><span class="sxs-lookup"><span data-stu-id="a1d32-244">The Wizard97-style wizard has both watermark and header graphics, specified by their resource IDs.</span></span> <span data-ttu-id="a1d32-245">La matrice *ahpsp* contiene tutti gli handle HPROPSHEETPAGE e definisce l'ordine predefinito in cui vengono visualizzati.</span><span class="sxs-lookup"><span data-stu-id="a1d32-245">The *ahpsp* array contains all the HPROPSHEETPAGE handles and defines the default order in which they are displayed.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETHEADER psh = { sizeof(psh) };

psh.hInstance      = g_hInstance;
psh.hwndParent     = NULL;
psh.phpage         = ahpsp;
psh.dwFlags        = PSH_WIZARD97 | PSH_WATERMARK | PSH_HEADER;
psh.pszbmWatermark = MAKEINTRESOURCE(IDB_WATERMARK);
psh.pszbmHeader    = MAKEINTRESOURCE(IDB_BANNER);
psh.nStartPage     = 0;
psh.nPages         = 4;

PropertySheet(&psh);
```



### <a name="the-dialog-box-procedure"></a><span data-ttu-id="a1d32-246">Routine della finestra di dialogo</span><span class="sxs-lookup"><span data-stu-id="a1d32-246">The Dialog Box Procedure</span></span>

<span data-ttu-id="a1d32-247">Per ogni pagina della procedura guidata è necessaria una routine della finestra di dialogo per elaborare i messaggi di Windows, in particolare le notifiche dei controlli e della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-247">Each page of the wizard needs a dialog box procedure to process Windows messages, particularly notifications from its controls and the wizard.</span></span> <span data-ttu-id="a1d32-248">I tre messaggi che quasi tutte le procedure guidate devono essere in grado di gestire sono [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy)e [**WM \_ Notify**](wm-notify.md).</span><span class="sxs-lookup"><span data-stu-id="a1d32-248">The three messages that almost all wizards must be able to handle are [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy), and [**WM\_NOTIFY**](wm-notify.md).</span></span>

<span data-ttu-id="a1d32-249">Il messaggio di [**\_ notifica WM**](wm-notify.md) viene ricevuto prima che la pagina venga visualizzata e quando si fa clic su uno dei pulsanti della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-249">The [**WM\_NOTIFY**](wm-notify.md) message is received before the page is displayed and when any of the wizard's buttons are clicked.</span></span> <span data-ttu-id="a1d32-250">Il parametro *lParam* del messaggio è un puntatore a una struttura di intestazione [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-250">The *lParam* parameter of the message is a pointer to a [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) header structure.</span></span> <span data-ttu-id="a1d32-251">L'ID della notifica è contenuto nel membro del **codice** della struttura.</span><span class="sxs-lookup"><span data-stu-id="a1d32-251">The notification's ID is contained in the structure's **code** member.</span></span> <span data-ttu-id="a1d32-252">Di seguito sono riportate le quattro notifiche che devono essere gestite dalla maggior parte delle procedure guidate.</span><span class="sxs-lookup"><span data-stu-id="a1d32-252">The four notifications that most wizards need to handle are the following.</span></span>



| <span data-ttu-id="a1d32-253">Codice</span><span class="sxs-lookup"><span data-stu-id="a1d32-253">Code</span></span>                                | <span data-ttu-id="a1d32-254">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a1d32-254">Description</span></span>                                 |
|-------------------------------------|---------------------------------------------|
| [<span data-ttu-id="a1d32-255">seactive PSN \_</span><span class="sxs-lookup"><span data-stu-id="a1d32-255">PSN\_SETACTIVE</span></span>](psn-setactive.md) | <span data-ttu-id="a1d32-256">Inviato prima della visualizzazione della pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-256">Sent before the page is displayed.</span></span>          |
| [<span data-ttu-id="a1d32-257">\_WIZBACK PSN</span><span class="sxs-lookup"><span data-stu-id="a1d32-257">PSN\_WIZBACK</span></span>](psn-wizback.md)     | <span data-ttu-id="a1d32-258">Inviato quando si fa clic sul pulsante **indietro** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-258">Sent when the **Back** button is clicked.</span></span>   |
| [<span data-ttu-id="a1d32-259">\_WIZNEXT PSN</span><span class="sxs-lookup"><span data-stu-id="a1d32-259">PSN\_WIZNEXT</span></span>](psn-wiznext.md)     | <span data-ttu-id="a1d32-260">Inviato quando si fa clic sul pulsante **Avanti** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-260">Sent when the **Next** button is clicked.</span></span>   |
| [<span data-ttu-id="a1d32-261">\_WIZFINISH PSN</span><span class="sxs-lookup"><span data-stu-id="a1d32-261">PSN\_WIZFINISH</span></span>](psn-wizfinish.md) | <span data-ttu-id="a1d32-262">Inviato quando si fa clic sul pulsante **fine** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-262">Sent when the **Finish** button is clicked.</span></span> |



 

### <a name="handle-wm_initdialog-and-wm_destroy"></a><span data-ttu-id="a1d32-263">Gestisci WM \_ INITDIALOG e WM \_ Destroy</span><span class="sxs-lookup"><span data-stu-id="a1d32-263">Handle WM\_INITDIALOG and WM\_DESTROY</span></span>

<span data-ttu-id="a1d32-264">Quando una pagina sta per essere visualizzata per la prima volta, la relativa routine della finestra di dialogo riceve un messaggio [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-264">When a page is about to be displayed for the first time, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a1d32-265">Gestione di questo messaggio consente alla procedura guidata di eseguire le attività di inizializzazione necessarie, ad esempio l'archiviazione di dati personalizzati o l'impostazione di tipi di carattere.</span><span class="sxs-lookup"><span data-stu-id="a1d32-265">Handling this message allows the wizard to do any needed initialization tasks, such as storing custom data or setting fonts.</span></span>

<span data-ttu-id="a1d32-266">Quando la finestra delle proprietà viene distrutta, viene visualizzato un messaggio [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-266">When the property sheet is destroyed, you receive a [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy) message.</span></span> <span data-ttu-id="a1d32-267">La procedura guidata viene automaticamente eliminata dal sistema, ma la gestione di questo messaggio consente di eseguire tutte le operazioni di pulizia necessarie.</span><span class="sxs-lookup"><span data-stu-id="a1d32-267">The wizard is automatically destroyed by the system, but handling this message allows you to do any needed cleanup.</span></span>

### <a name="handle-psn_setactive"></a><span data-ttu-id="a1d32-268">Gestire PSN in modo \_ SEattivo</span><span class="sxs-lookup"><span data-stu-id="a1d32-268">Handle PSN\_SETACTIVE</span></span>

<span data-ttu-id="a1d32-269">Il codice di notifica [ \_ seattivo PSN](psn-setactive.md) viene inviato ogni volta che una pagina sta per essere resa visibile.</span><span class="sxs-lookup"><span data-stu-id="a1d32-269">The [PSN\_SETACTIVE](psn-setactive.md) notification code is sent each time a page is about to be made visible.</span></span> <span data-ttu-id="a1d32-270">La prima volta che viene visitata una pagina, PSN \_ seactive segue il messaggio [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-270">The first time a page is visited, PSN\_SETACTIVE follows the [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a1d32-271">Se la pagina viene successivamente rivisitata, riceve solo una \_ notifica SEATTIVA PSN.</span><span class="sxs-lookup"><span data-stu-id="a1d32-271">If the page is subsequently revisited, it receives only a PSN\_SETACTIVE notification.</span></span> <span data-ttu-id="a1d32-272">Questa notifica viene in genere gestita per inizializzare i dati della pagina e abilitare i pulsanti appropriati.</span><span class="sxs-lookup"><span data-stu-id="a1d32-272">This notification is usually handled to initialize data for the page and enable the appropriate buttons.</span></span>

<span data-ttu-id="a1d32-273">Per impostazione predefinita, la procedura guidata Visualizza i pulsanti **indietro**, **Avanti** e **Annulla** con tutti i pulsanti abilitati.</span><span class="sxs-lookup"><span data-stu-id="a1d32-273">By default, the wizard displays **Back**, **Next**, and **Cancel** buttons, with all buttons enabled.</span></span> <span data-ttu-id="a1d32-274">Per disabilitare un pulsante o la visualizzazione **fine** anziché **successiva**, è necessario inviare un messaggio [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-274">To disable a button or display **Finish** instead of **Next**, you must send a [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message.</span></span> <span data-ttu-id="a1d32-275">Una volta inviato questo messaggio, lo stato dei pulsanti viene mantenuto finché non viene modificato da un altro messaggio **PSM \_ SETWIZBUTTONS** , anche se è stata selezionata una nuova pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-275">After this message has been sent, the state of the buttons is preserved until it is modified by another **PSM\_SETWIZBUTTONS** message, even if a new page is selected.</span></span> <span data-ttu-id="a1d32-276">In genere, tutti i gestori di [PSN \_ seactive](psn-setactive.md) inviano questo messaggio per assicurarsi che ogni pagina abbia lo stato del pulsante corretto.</span><span class="sxs-lookup"><span data-stu-id="a1d32-276">Typically, all [PSN\_SETACTIVE](psn-setactive.md) handlers send this message to ensure that each page has the correct button state.</span></span>

<span data-ttu-id="a1d32-277">È possibile modificare lo stato del pulsante con questo messaggio in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="a1d32-277">You can change the button state with this message at any time.</span></span> <span data-ttu-id="a1d32-278">Ad esempio, potrebbe essere necessario disabilitare inizialmente il pulsante **Avanti** .</span><span class="sxs-lookup"><span data-stu-id="a1d32-278">For example, you may want the **Next** button to be initially disabled.</span></span> <span data-ttu-id="a1d32-279">Dopo che un utente ha immesso tutte le informazioni necessarie, è possibile inviare un altro messaggio di [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) per abilitare il pulsante **Avanti** e consentire all'utente di passare alla pagina successiva.</span><span class="sxs-lookup"><span data-stu-id="a1d32-279">After a user has entered all the necessary information, you can send another [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message to enable the **Next** button and let the user proceed to the next page.</span></span>

<span data-ttu-id="a1d32-280">Il frammento di codice seguente usa la macro [**PropSheet \_ SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) per abilitare i pulsanti **indietro** e **Avanti** in una pagina interna prima che venga visualizzata.</span><span class="sxs-lookup"><span data-stu-id="a1d32-280">The following code fragment uses the [**PropSheet\_SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) macro to enable the **Back** and **Next** buttons on an interior page before it is displayed.</span></span>


```C++
case WM_NOTIFY :
    {
        LPNMHDR pnmh = (LPNMHDR)lParam;
        
        switch(pnmh->code)
        {
        
        ...
        
        case PSN_SETACTIVE :
        
            ...
            
            // This is an interior page.
            PropSheet_SetWizButtons(hwnd, PSWIZB_NEXT | PSWIZB_BACK);
            
            ...
        }
    ...
    
    }
```



### <a name="handle-psn_wiznext-psnwizback-and-psn_wizfinish"></a><span data-ttu-id="a1d32-281">Gestire PSN \_ WIZNEXT, PSNWIZBACK e PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="a1d32-281">Handle PSN\_WIZNEXT, PSNWIZBACK, and PSN\_WIZFINISH</span></span>

<span data-ttu-id="a1d32-282">Quando si fa clic su un pulsante **Avanti** o **indietro** , si riceve un codice di notifica [PSN \_ WIZNEXT](psn-wiznext.md) o [PSN \_ WIZBACK](psn-wizback.md) .</span><span class="sxs-lookup"><span data-stu-id="a1d32-282">When a **Next** or **Back** button is clicked, you receive a [PSN\_WIZNEXT](psn-wiznext.md) or [PSN\_WIZBACK](psn-wizback.md) notification code.</span></span> <span data-ttu-id="a1d32-283">Per impostazione predefinita, la procedura guidata passa automaticamente alla pagina precedente o successiva nell'ordine definito al momento della creazione della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="a1d32-283">By default, the wizard automatically goes to either the next or previous page in the order that is defined when the property sheet is created.</span></span> <span data-ttu-id="a1d32-284">Un motivo comune per gestire queste notifiche è impedire all'utente di cambiare le pagine o di eseguire l'override dell'ordine predefinito della pagina.</span><span class="sxs-lookup"><span data-stu-id="a1d32-284">A common reason to handle these notifications is to prevent the user from switching pages, or to override the default page order.</span></span>

<span data-ttu-id="a1d32-285">Per impedire all'utente di passare da una pagina all'altra, gestire la notifica dei pulsanti, chiamare la funzione [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con il \_ valore di MSGRESULT DWL impostato su-1 e restituire **true**.</span><span class="sxs-lookup"><span data-stu-id="a1d32-285">To prevent the user from switching pages, handle the button notification, call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the DWL\_MSGRESULT value set to –1, and return **TRUE**.</span></span> <span data-ttu-id="a1d32-286">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a1d32-286">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Do not go to the next page yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, -1);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="a1d32-287">Per eseguire l'override dell'ordine standard e passare a una pagina specifica, chiamare [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con il \_ valore DWL MSGRESULT impostato sull'ID di risorsa della finestra di dialogo della pagina e restituire **true**.</span><span class="sxs-lookup"><span data-stu-id="a1d32-287">To override the standard order and go to a particular page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to the page's dialog box resource ID, and return **TRUE**.</span></span> <span data-ttu-id="a1d32-288">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a1d32-288">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Go straight to the completion page.
        SetWindowLong(hwnd, DWL_MSGRESULT, IDD_FINISH);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="a1d32-289">Quando si fa clic sul pulsante **fine** o **Annulla** , viene visualizzato rispettivamente un codice di notifica di [ \_ reimpostazione](psn-reset.md) PSN [ \_ WIZFINISH](psn-wizfinish.md) o PSN.</span><span class="sxs-lookup"><span data-stu-id="a1d32-289">When the **Finish** or **Cancel** button is clicked, you receive a [PSN\_WIZFINISH](psn-wizfinish.md) or [PSN\_RESET](psn-reset.md) notification code, respectively.</span></span> <span data-ttu-id="a1d32-290">Quando si fa clic su uno di questi pulsanti, la procedura guidata viene automaticamente eliminata dal sistema.</span><span class="sxs-lookup"><span data-stu-id="a1d32-290">When either of these buttons is clicked, the wizard is automatically destroyed by the system.</span></span> <span data-ttu-id="a1d32-291">Tuttavia, è possibile gestire queste notifiche se è necessario eseguire attività di pulizia prima che la procedura guidata venga distrutta.</span><span class="sxs-lookup"><span data-stu-id="a1d32-291">However, you can handle these notifications if you need to perform cleanup tasks before the wizard is destroyed.</span></span> <span data-ttu-id="a1d32-292">Per evitare che la procedura guidata venga distrutta quando si riceve una \_ notifica di WIZFINISH PSN, chiamare [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con il \_ valore DWL MSGRESULT impostato su **true** e restituire **true**.</span><span class="sxs-lookup"><span data-stu-id="a1d32-292">To prevent the wizard from being destroyed when you receive a PSN\_WIZFINISH notification, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to **TRUE**, and return **TRUE**.</span></span> <span data-ttu-id="a1d32-293">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a1d32-293">For example:</span></span>


```C++
case PSN_WIZFINISH :

        ...
        
        // Not finished yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, TRUE);
        
        return TRUE;
        
        ...
```



### <a name="backward-compatible-wizards"></a><span data-ttu-id="a1d32-294">Procedure guidate compatibili con le versioni precedenti</span><span class="sxs-lookup"><span data-stu-id="a1d32-294">Backward Compatible Wizards</span></span>

<span data-ttu-id="a1d32-295">Nella sezione precedente si presuppone che si stia implementando una procedura guidata per un sistema con la [versione 5](common-control-versions.md) o successiva dei controlli comuni.</span><span class="sxs-lookup"><span data-stu-id="a1d32-295">The preceding section assumes that you are implementing a wizard for a system with [version 5](common-control-versions.md) or later of the common controls.</span></span>

<span data-ttu-id="a1d32-296">Se si sta scrivendo una procedura guidata per i sistemi con versioni precedenti dei controlli comuni, molte delle funzionalità descritte nella sezione precedente non saranno disponibili.</span><span class="sxs-lookup"><span data-stu-id="a1d32-296">If you are writing a wizard for systems with earlier versions of the common controls, many of the features discussed in the preceding section will not be available.</span></span> <span data-ttu-id="a1d32-297">Molti dei membri delle strutture [**PROPSHEETHEADER**](pss-propsheetheader.md) e [**PROPSHEETPAGE**](pss-propsheetpage.md) usati dallo stile Wizard97 sono supportati solo dai controlli comuni versione 5 e successive.</span><span class="sxs-lookup"><span data-stu-id="a1d32-297">A number of the members of the [**PROPSHEETHEADER**](pss-propsheetheader.md) and [**PROPSHEETPAGE**](pss-propsheetpage.md) structures that are used by the Wizard97 style are supported only by common controls version 5 and later.</span></span> <span data-ttu-id="a1d32-298">Tuttavia, è comunque possibile implementare una procedura guidata *compatibile con le versioni precedenti* con un aspetto simile a quello dello stile Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a1d32-298">However, it is still possible to implement a *backward compatible* wizard with an appearance similar to that of the Wizard97 style.</span></span> <span data-ttu-id="a1d32-299">A tale scopo, è necessario implementare in modo esplicito quanto segue:</span><span class="sxs-lookup"><span data-stu-id="a1d32-299">To do so, you must explicitly implement the following:</span></span>

-   <span data-ttu-id="a1d32-300">Aggiungere l'immagine della filigrana al modello della finestra di dialogo per le pagine introduttive e di completamento.</span><span class="sxs-lookup"><span data-stu-id="a1d32-300">Add the watermark graphic to the dialog box template for your introduction and completion pages.</span></span>
-   <span data-ttu-id="a1d32-301">Rendere le stesse dimensioni di tutti i modelli.</span><span class="sxs-lookup"><span data-stu-id="a1d32-301">Make all your templates the same size.</span></span> <span data-ttu-id="a1d32-302">Non esiste un'area di intestazione definita dal sistema separata per le pagine interne.</span><span class="sxs-lookup"><span data-stu-id="a1d32-302">There is no separate system-defined header area for interior pages.</span></span>
-   <span data-ttu-id="a1d32-303">Creare l'area di intestazione della pagina interna in modo esplicito sui modelli.</span><span class="sxs-lookup"><span data-stu-id="a1d32-303">Create the interior page's header area explicitly on your templates.</span></span>
-   <span data-ttu-id="a1d32-304">Non usare una rappresentazione grafica dell'intestazione perché potrebbe essere in conflitto con il titolo o il sottotitolo se la procedura guidata cambia dimensione.</span><span class="sxs-lookup"><span data-stu-id="a1d32-304">Do not use a header graphic because it may conflict with the title or subtitle if the wizard changes size.</span></span>

<span data-ttu-id="a1d32-305">Per ulteriori informazioni sulle procedure guidate compatibili con le versioni precedenti, vedere la [procedura guidata compatibile con](/previous-versions//ms737910(v=vs.85))le versioni precedenti 97.</span><span class="sxs-lookup"><span data-stu-id="a1d32-305">For further discussion of backward-compatible wizards, see [Backward Compatible Wizard 97](/previous-versions//ms737910(v=vs.85)).</span></span>

## <a name="remarks"></a><span data-ttu-id="a1d32-306">Commenti</span><span class="sxs-lookup"><span data-stu-id="a1d32-306">Remarks</span></span>

<span data-ttu-id="a1d32-307">Per una descrizione completa dei problemi di progettazione per Wizard97, vedere la [specifica Wizard97](/previous-versions//ms738248(v=vs.85)), in altre parti del Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="a1d32-307">For a complete discussion of design issues for Wizard97, see the [Wizard97 Specification](/previous-versions//ms738248(v=vs.85)), elsewhere in the Windows SDK.</span></span> <span data-ttu-id="a1d32-308">Questo documento contiene linee guida per elementi quali le dimensioni delle finestre di dialogo, le dimensioni e i colori bitmap e il posizionamento dei controlli.</span><span class="sxs-lookup"><span data-stu-id="a1d32-308">This document has guidelines for such things as the dimensions for the dialog boxes, bitmap dimensions and colors, and the placement of controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a1d32-309">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="a1d32-309">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a1d32-310">Utilizzo delle finestre delle proprietà</span><span class="sxs-lookup"><span data-stu-id="a1d32-310">Using Property Sheets</span></span>](using-property-sheets.md)
</dt> <dt>

<span data-ttu-id="a1d32-311">[Demo sui controlli comuni di Windows (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span><span class="sxs-lookup"><span data-stu-id="a1d32-311">[Windows common controls demo (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span></span>
</dt> </dl>

 

 