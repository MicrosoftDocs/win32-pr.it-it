---
title: Riconfigurazione della barra multifunzione con le modalità applicazione
description: Il Framework della barra multifunzione di Windows supporta la riconfigurazione dinamica e l'esposizione degli elementi principali dell'interfaccia utente della barra multifunzione in fase di esecuzione, in base allo stato dell'applicazione (noto anche come contesto).
ms.assetid: 8e9d85c5-33e4-4212-b9e4-2fc3b492c273
keywords:
- Barra multifunzione di Windows, riconfigurazione con modalità applicazione
- Barra multifunzione, riconfigurazione con modalità applicazione
- riconfigurazione della barra multifunzione di Windows con modalità applicazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d206c238e6fe7463562077daaa52a5522a79d9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104399042"
---
# <a name="reconfiguring-the-ribbon-with-application-modes"></a><span data-ttu-id="14a11-106">Riconfigurazione della barra multifunzione con le modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-106">Reconfiguring the Ribbon with Application Modes</span></span>

<span data-ttu-id="14a11-107">Il Framework della barra multifunzione di Windows supporta la riconfigurazione dinamica e l'esposizione degli elementi principali dell'interfaccia utente della barra multifunzione in fase di esecuzione, in base allo stato dell'applicazione (noto anche come contesto).</span><span class="sxs-lookup"><span data-stu-id="14a11-107">The Windows Ribbon framework supports the dynamic reconfiguring and exposing of core elements of the Ribbon UI at run time, based on the application's state (also referred to as context).</span></span> <span data-ttu-id="14a11-108">Dichiarati e associati a elementi specifici nel markup, i vari stati supportati da un'applicazione sono definiti modalità applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-108">Declared and associated with specific elements in markup, the various states supported by an application are referred to as application modes.</span></span>

-   [<span data-ttu-id="14a11-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="14a11-109">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="14a11-110">Interfaccia utente contestuale</span><span class="sxs-lookup"><span data-stu-id="14a11-110">Contextual User Interface</span></span>](#contextual-user-interface)
    -   [<span data-ttu-id="14a11-111">Uno scenario semplice in modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-111">A Simple Application Mode Scenario</span></span>](#a-simple-application-mode-scenario)
-   [<span data-ttu-id="14a11-112">Implementazione di modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-112">Implementing Application Modes</span></span>](#implementing-application-modes)
    -   [<span data-ttu-id="14a11-113">Identificare le modalità</span><span class="sxs-lookup"><span data-stu-id="14a11-113">Identify the Modes</span></span>](#identify-the-modes)
    -   [<span data-ttu-id="14a11-114">Assegnare controlli alle modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-114">Assign Controls to Application Modes</span></span>](#assign-controls-to-application-modes)
    -   [<span data-ttu-id="14a11-115">Modalità switch in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="14a11-115">Switch Modes at Runtime</span></span>](#switch-modes-at-runtime)
-   [<span data-ttu-id="14a11-116">Osservazioni:</span><span class="sxs-lookup"><span data-stu-id="14a11-116">Remarks</span></span>](#remarks)
-   [<span data-ttu-id="14a11-117">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="14a11-117">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="14a11-118">Introduzione</span><span class="sxs-lookup"><span data-stu-id="14a11-118">Introduction</span></span>

<span data-ttu-id="14a11-119">Le modalità applicazione sono costituite da gruppi logici di controlli che espongono alcune funzionalità principali dell'applicazione nell'interfaccia utente della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-119">Application modes consist of logical groups of controls that expose some core application functionality in the Ribbon UI.</span></span> <span data-ttu-id="14a11-120">Queste modalità sono abilitate o disabilitate in modo dinamico dall'applicazione tramite una chiamata al metodo del Framework [**IUIFramework:: Semodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), che attiva o disattiva la visibilità di una o più modalità di applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-120">These modes are dynamically enabled or disabled by the application through a call to the framework method [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), which turns the visibility of one or more application modes on or off.</span></span>

## <a name="contextual-user-interface"></a><span data-ttu-id="14a11-121">Interfaccia utente contestuale</span><span class="sxs-lookup"><span data-stu-id="14a11-121">Contextual User Interface</span></span>

<span data-ttu-id="14a11-122">Il Framework della barra multifunzione offre un'esperienza utente avanzata incorporando controlli dinamici che rispondono facilmente all'interazione dell'utente e al contesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-122">The Ribbon framework provides rich user experience by incorporating dynamic controls that respond seamlessly to user interaction and application context.</span></span> <span data-ttu-id="14a11-123">Questa ricca interfaccia utente contestuale viene fornita tramite una combinazione dei meccanismi seguenti:</span><span class="sxs-lookup"><span data-stu-id="14a11-123">This rich contextual UI is delivered through a combination of the following mechanisms:</span></span>

-   <span data-ttu-id="14a11-124">Raccolte: controlli basati su raccolte che supportano la manipolazione dinamica delle raccolte di elementi.</span><span class="sxs-lookup"><span data-stu-id="14a11-124">Galleries - collection-based controls that support the dynamic manipulation of their item collections.</span></span>
-   <span data-ttu-id="14a11-125">Schede contestuali: schede della barra multifunzione con visibilità determinata da una modifica nel contesto dell'area di lavoro, ad esempio la selezione di un'immagine in un documento.</span><span class="sxs-lookup"><span data-stu-id="14a11-125">Contextual tabs - ribbon tabs that have their visibility determined by a change in workspace context, such as the selection of an image in a document.</span></span>
-   <span data-ttu-id="14a11-126">Modalità applicazione: funzionalità dell'applicazione principale che dipende dal contesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-126">Application modes - core application functionality that is dependent on application context.</span></span>

<span data-ttu-id="14a11-127">In alcuni casi, le modalità di applicazione sono apparentemente simili alle schede contestuali.</span><span class="sxs-lookup"><span data-stu-id="14a11-127">In some respects, application modes appear functionally similar to contextual tabs.</span></span> <span data-ttu-id="14a11-128">Tuttavia, la distinzione fondamentale risiede nello scopo e nell'ambito di ciascuna di esse.</span><span class="sxs-lookup"><span data-stu-id="14a11-128">However, the fundamental distinction lies in the intent and scope of each.</span></span>

<span data-ttu-id="14a11-129">I controlli contestuali vengono attivati in risposta a una modifica del contesto all'interno di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-129">Contextual controls are activated in response to a change of context within an application.</span></span> <span data-ttu-id="14a11-130">Ad esempio, in Microsoft Paint per Windows 7, una scheda contestuale contenente gruppi di comandi correlati al testo viene visualizzata quando un utente inserisce un'area di testo nell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="14a11-130">For example, in Microsoft Paint for Windows 7, a contextual tab that contains groups of text-related commands is displayed when a user inserts a text area into the workspace.</span></span> <span data-ttu-id="14a11-131">Questa scheda contestuale non contiene i comandi di base per l'applicazione ed è esposta solo nell'interfaccia utente perché il contesto *all'interno* dell'applicazione è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="14a11-131">This contextual tab does not contain core commands for the application and is only exposed in the UI because the context *within* the application has changed.</span></span> <span data-ttu-id="14a11-132">La funzionalità di base dell'applicazione, ovvero i comandi per la modifica di immagini, è ancora pertinente e disponibile per l'utente, anche con la scheda contestuale visibile.</span><span class="sxs-lookup"><span data-stu-id="14a11-132">The core functionality of the application (the image editing commands) is still relevant and available to the user, even with the contextual tab visible.</span></span>

<span data-ttu-id="14a11-133">Le modalità di applicazione sono diverse dai controlli contestuali perché riconfigurano le funzionalità in risposta alle modifiche nel contesto in cui l'applicazione sta operando.</span><span class="sxs-lookup"><span data-stu-id="14a11-133">Application modes differ from contextual controls in that they reconfigure functionality in response to changes in the context that the application is operating in.</span></span> <span data-ttu-id="14a11-134">Le modalità dell'applicazione si trovano a un livello superiore di astrazione; consentono di riconfigurare la funzionalità di base di un'applicazione anziché esporre temporaneamente la funzionalità che non è un componente principale dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-134">Application modes sit at a higher level of abstraction; they provide a way to reconfigure the core functionality of an application instead of temporarily exposing functionality that is not a core component of the UI.</span></span> <span data-ttu-id="14a11-135">Ad esempio, in Microsoft Paint per Windows 7, un'opzione in modalità applicazione si verifica quando viene richiamato il comando **Anteprima di stampa** .</span><span class="sxs-lookup"><span data-stu-id="14a11-135">For example, in Microsoft Paint for Windows 7, a switch in application mode occurs when the **Print preview** command is invoked.</span></span> <span data-ttu-id="14a11-136">Quando Microsoft Paint passa all' **Anteprima di stampa**, il contesto in cui l'applicazione sta operando passa dalla modifica alla visualizzazione in anteprima.</span><span class="sxs-lookup"><span data-stu-id="14a11-136">When Microsoft Paint switches to **Print preview**, the context that the application is operating in changes from editing to previewing.</span></span> <span data-ttu-id="14a11-137">Di conseguenza, le funzionalità principali dell'applicazione cambiano fino a quando l' **Anteprima di stampa** non viene annullata e l'applicazione entra nuovamente nel contesto di modifica.</span><span class="sxs-lookup"><span data-stu-id="14a11-137">As a result, the core functionality of the application changes until the **Print preview** is canceled and the application enters the editing context again.</span></span>

### <a name="a-simple-application-mode-scenario"></a><span data-ttu-id="14a11-138">Uno scenario semplice in modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-138">A Simple Application Mode Scenario</span></span>

<span data-ttu-id="14a11-139">Nello scenario seguente viene illustrato come vengono utilizzate le modalità applicazione, in un'applicazione denominata RibbonApp, per esporre aspetti discreti della funzionalità di base.</span><span class="sxs-lookup"><span data-stu-id="14a11-139">The following scenario demonstrates how application modes are used, in an application called RibbonApp, to expose discrete aspects of core functionality.</span></span>

<span data-ttu-id="14a11-140">In RibbonApp sono definite due modalità di applicazione:</span><span class="sxs-lookup"><span data-stu-id="14a11-140">Two application modes are defined in RibbonApp:</span></span>

-   <span data-ttu-id="14a11-141">La modalità **semplice** espone i comandi di base nell'interfaccia utente della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-141">**Simple** mode exposes basic commands throughout the Ribbon UI.</span></span> <span data-ttu-id="14a11-142">Questi comandi vengono visualizzati sempre, indipendentemente dalla modalità di applicazione attiva.</span><span class="sxs-lookup"><span data-stu-id="14a11-142">These commands appear at all times, no matter which application mode is active.</span></span>
-   <span data-ttu-id="14a11-143">La modalità **avanzata** espone comandi complessi destinati a utenti esperti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-143">**Advanced** mode exposes complex commands intended for expert users of the application.</span></span> <span data-ttu-id="14a11-144">Questi comandi avanzati vengono visualizzati nell'interfaccia utente della barra multifunzione, oltre ai semplici comandi.</span><span class="sxs-lookup"><span data-stu-id="14a11-144">These advanced commands appear throughout the Ribbon UI, in addition to the simple commands.</span></span>

<span data-ttu-id="14a11-145">Per impostazione predefinita, RibbonApp è impostato per l'apertura in modalità **semplice** e i comandi richiesti dagli utenti esperti vengono visualizzati nel **menu applicazione** e nella scheda **Home** . Le schermate seguenti mostrano il **menu dell'applicazione** RibbonApp e la scheda **Home** in modalità **semplice** , evidenziando i controlli modali.</span><span class="sxs-lookup"><span data-stu-id="14a11-145">By default, RibbonApp is set to open in **Simple** mode, and the commands required by novice users are displayed in the **Application Menu** and the **Home** tab. The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Simple** mode, highlighting the modal controls.</span></span>

![screenshot che mostra una scheda per la modalità applicazione semplice.](images/overviews/appmode-hometab.png)![screenshot che mostra il menu applicazione per la modalità applicazione semplice.](images/overviews/appmode-simpleappmenu.png)

<span data-ttu-id="14a11-148">Sebbene questi comandi siano sufficienti per gli utenti principianti, RibbonApp supporta anche gli utenti esperti tramite una modalità **avanzata** che, quando attivata, facendo clic sul pulsante **passa a modalità avanzata** nel **menu applicazione**, Visualizza funzionalità principali aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="14a11-148">While these commands may be sufficient for novice users, the RibbonApp also supports expert users through an **Advanced** mode that, when activated by clicking the **Switch to Advanced Mode** button in the **Application Menu**, displays additional core functionality.</span></span>

<span data-ttu-id="14a11-149">Questo scenario viene facilmente implementato associando vari elementi nel markup a modalità di applicazione discrete che possono essere attivate e disattivate in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="14a11-149">This scenario is easily implemented by binding various elements in markup to discrete application modes that can be turned on and off as required.</span></span> <span data-ttu-id="14a11-150">Le schermate seguenti mostrano il **menu dell'applicazione** RibbonApp e la scheda **Home** in modalità **avanzata** , evidenziando i controlli modali.</span><span class="sxs-lookup"><span data-stu-id="14a11-150">The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Advanced** mode, highlighting the modal controls.</span></span>

![screenshot che mostra una scheda per la modalità di applicazione avanzata.](images/overviews/appmode-advancedtab.png)![screenshot che mostra il menu dell'applicazione per la modalità di applicazione avanzata.](images/overviews/appmode-advancedappmenu.png)

## <a name="implementing-application-modes"></a><span data-ttu-id="14a11-153">Implementazione di modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-153">Implementing Application Modes</span></span>

<span data-ttu-id="14a11-154">In questa sezione vengono illustrati i tre passaggi necessari per l'implementazione delle modalità applicazione della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-154">This section outlines the three steps typically required for the implementation of Ribbon framework application modes.</span></span> <span data-ttu-id="14a11-155">RibbonApp viene usato per fornire un esempio per ogni passaggio.</span><span class="sxs-lookup"><span data-stu-id="14a11-155">RibbonApp is used to provide an example for each step.</span></span>

### <a name="identify-the-modes"></a><span data-ttu-id="14a11-156">Identificare le modalità</span><span class="sxs-lookup"><span data-stu-id="14a11-156">Identify the Modes</span></span>

<span data-ttu-id="14a11-157">Ogni modalità in un'applicazione deve rappresentare un set logico di funzionalità che dipende dal contesto in cui un'applicazione è in grado di operare.</span><span class="sxs-lookup"><span data-stu-id="14a11-157">Each mode in an application should represent a logical set of functionality that depends on the context an application is able to operate in.</span></span> <span data-ttu-id="14a11-158">Se, ad esempio, in un'applicazione vengono visualizzati i controlli rilevanti solo quando viene rilevata una connessione di rete, tali controlli operano all'interno di un contesto di rete che potrebbe giustificare la creazione di una modalità di **rete** .</span><span class="sxs-lookup"><span data-stu-id="14a11-158">For example, if an application displays controls that are only relevant when a network connection is detected, those controls operate within a networking context that might justify the creation of a **Network** mode.</span></span>

<span data-ttu-id="14a11-159">In RibbonApp sono disponibili due contesti che possono essere attivi in un determinato momento, ovvero **semplici** e **avanzati**.</span><span class="sxs-lookup"><span data-stu-id="14a11-159">RibbonApp has two contexts that can be active at any given time: **Simple** and **Advanced**.</span></span> <span data-ttu-id="14a11-160">RibbonApp richiede quindi due modalità: **semplice** e **avanzata**.</span><span class="sxs-lookup"><span data-stu-id="14a11-160">Therefore, RibbonApp requires two modes: **Simple** and **Advanced**.</span></span>

### <a name="assign-controls-to-application-modes"></a><span data-ttu-id="14a11-161">Assegnare controlli alle modalità applicazione</span><span class="sxs-lookup"><span data-stu-id="14a11-161">Assign Controls to Application Modes</span></span>

<span data-ttu-id="14a11-162">Una volta identificate le modalità dell'applicazione, assegnare ogni controllo Ribbon a una modalità dichiarando un attributo *ApplicationModes* nel markup per gli elementi di controllo che supportano le modalità di applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-162">Once the application modes have been identified, assign each Ribbon control to a mode by declaring an *ApplicationModes* attribute in markup for those control elements that support application modes.</span></span>

<span data-ttu-id="14a11-163">La visualizzazione della barra multifunzione consente di specificare le modalità sugli elementi di controllo seguenti:</span><span class="sxs-lookup"><span data-stu-id="14a11-163">The Ribbon View allows modes to be specified on the following control elements:</span></span>

-   <span data-ttu-id="14a11-164">Elementi principali della [**scheda**](windowsribbon-element-tab.md) .</span><span class="sxs-lookup"><span data-stu-id="14a11-164">Core [**Tab**](windowsribbon-element-tab.md) elements.</span></span>
-   <span data-ttu-id="14a11-165">[**Raggruppa**](windowsribbon-element-group.md) gli elementi figlio di un elemento [**scheda**](windowsribbon-element-tab.md) principale.</span><span class="sxs-lookup"><span data-stu-id="14a11-165">[**Group**](windowsribbon-element-group.md) elements that are child elements of a core [**Tab**](windowsribbon-element-tab.md) element.</span></span>
-   <span data-ttu-id="14a11-166">Elementi [**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md)e [**DropDownButton**](windowsribbon-element-dropdownbutton.md) assegnati a un [**MenuGroup**](windowsribbon-element-menugroup.md) nel [menu dell'applicazione](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="14a11-166">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements assigned to a [**MenuGroup**](windowsribbon-element-menugroup.md) within the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
    > [!Note]  
    > <span data-ttu-id="14a11-167">Gli elementi [**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md)e [**DropDownButton**](windowsribbon-element-dropdownbutton.md) non possono essere assegnati a una modalità a meno che non siano ospitati nel [menu dell'applicazione](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="14a11-167">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements cannot be assigned to a mode unless hosted in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>

     

<span data-ttu-id="14a11-168">Nel framework della barra multifunzione questi elementi di controllo sono detti controlli modali.</span><span class="sxs-lookup"><span data-stu-id="14a11-168">In the Ribbon framework, these control elements are referred to as modal controls.</span></span> <span data-ttu-id="14a11-169">Vengono visualizzati solo se una modalità a cui sono associati è attiva nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-169">They appear only if a mode to which they are bound is active in the UI.</span></span>

<span data-ttu-id="14a11-170">Gli elementi del controllo contenuti in un controllo modale ereditano il comportamento della modalità di applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-170">Control elements that are contained within a modal control inherit the application mode behavior.</span></span> <span data-ttu-id="14a11-171">Se, ad esempio, un controllo modale del [**gruppo**](windowsribbon-element-group.md) viene assegnato a una modalità **avanzata** e la modalità **avanzata** non è attiva, il **gruppo** e gli eventuali controlli, modale o altro, non saranno visibili nell'interfaccia utente della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-171">For example, if a [**Group**](windowsribbon-element-group.md) modal control is assigned to an **Advanced** mode and the **Advanced** mode is not active, then that **Group** and any controls in it, modal or otherwise, will not be visible in the Ribbon UI.</span></span>

<span data-ttu-id="14a11-172">Con l'uso dell'attributo *ApplicationModes* , le modalità vengono assegnate ai controlli modali in una relazione 1: N (uno-a-molti), in cui un singolo controllo modale può essere associato a più modalità.</span><span class="sxs-lookup"><span data-stu-id="14a11-172">With the use of the *ApplicationModes* attribute, modes are assigned to modal controls in a 1:N (one-to-many) relationship, where a single modal control can be associated with several modes.</span></span>

<span data-ttu-id="14a11-173">Il Framework della barra multifunzione fa riferimento alle modalità numeriche, da 0 a 31, con la modalità 0 considerata la modalità predefinita attivata automaticamente all'avvio di un'applicazione barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-173">The Ribbon framework refers to modes numerically, from 0 to 31, with mode 0 considered the default mode that is automatically activated when a Ribbon application starts.</span></span> <span data-ttu-id="14a11-174">Qualsiasi controllo modale che non specifica un attributo *ApplicationModes* viene considerato membro della modalità predefinita.</span><span class="sxs-lookup"><span data-stu-id="14a11-174">Any modal control that does not specify an *ApplicationModes* attribute is considered to be a member of the default mode.</span></span>

<span data-ttu-id="14a11-175">In RibbonApp, **Simple** è la modalità predefinita, con la funzionalità modalità **avanzata** visualizzata solo quando viene avviata dall'utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-175">In RibbonApp, **Simple** is the default mode, with **Advanced** mode functionality displayed only when it is initiated by the user.</span></span>

<span data-ttu-id="14a11-176">Nell'esempio seguente viene illustrato il markup richiesto per RibbonApp.</span><span class="sxs-lookup"><span data-stu-id="14a11-176">The following example demonstrates the markup required for RibbonApp.</span></span>


```C++
<Application.Views>
  <Ribbon>

    <!--Application Menu-->
    <Ribbon.ApplicationMenu>
      <ApplicationMenu CommandName='cmdAppMenu'>                    
        <MenuGroup>
          <Button CommandName='cmdSave'/>                        
          <Button CommandName='cmdExportMetadata' ApplicationModes='1'/>                   
        </MenuGroup>              
        <MenuGroup>
          <Button CommandName='cmdSwitchModes' ApplicationModes ='0,1'/>
          <Button CommandName='cmdExit'/>
        </MenuGroup>
      </ApplicationMenu>
    </Ribbon.ApplicationMenu>
            
    <!--Tabs-->
    <Ribbon.Tabs>
      <!--Home Tab-->
      <Tab CommandName='cmdHomeTab'>
                    
        <!--Scaling Policy for Home tab-->
        <Tab.ScalingPolicy>
          <ScalingPolicy>
            <ScalingPolicy.IdealSizes>
              <Scale Group='cmdSimpleControlsGroup' Size='Medium'/>                                
            </ScalingPolicy.IdealSizes>                     
          </ScalingPolicy>
        </Tab.ScalingPolicy>     
                    
        <!--Simple Controls Group-->
        <Group CommandName='cmdSimpleControlsGroup' SizeDefinition='ThreeButtons-OneBigAndTwoSmall'>                        
          <Button CommandName="cmdPaste" />
          <Button CommandName='cmdCut'/>                        
          <Button CommandName='cmdCopy'/>                        
        </Group>
      </Tab>
                
      <!--Advanced Tab-->
      <Tab CommandName='cmdAdvancedTab' ApplicationModes='1'>
        <!--Advanced Controls Group-->
        <Group CommandName='cmdMetadataGroup' ApplicationModes='1' SizeDefinition='TwoButtons'>
          <Button CommandName='cmdEditMetadata' />
          <Button CommandName='cmdCheckErrors' />
        </Group>
      </Tab>
    </Ribbon.Tabs>                   
                             
  </Ribbon>         
</Application.Views>
```



<span data-ttu-id="14a11-177">In questo esempio viene illustrato quanto segue:</span><span class="sxs-lookup"><span data-stu-id="14a11-177">This example demonstrates the following:</span></span>

-   <span data-ttu-id="14a11-178">Non è necessario dichiarare in modo esplicito la modalità predefinita 0.</span><span class="sxs-lookup"><span data-stu-id="14a11-178">Default mode 0 does not need to be explicitly declared.</span></span> <span data-ttu-id="14a11-179">Poiché i controlli modali che non specificano l'attributo *ApplicationModes* vengono associati automaticamente alla modalità 0 (modalità **semplice** nell'esempio RibbonApp), non è necessario dichiarare in modo esplicito l'attributo per i controlli modali predefiniti.</span><span class="sxs-lookup"><span data-stu-id="14a11-179">Because modal controls that do not specify the *ApplicationModes* attribute are automatically bound to mode 0 (**Simple** mode in the RibbonApp example), there is no need to explicitly declare the attribute for default modal controls.</span></span>
-   <span data-ttu-id="14a11-180">I controlli possono essere associati a più modalità.</span><span class="sxs-lookup"><span data-stu-id="14a11-180">Controls can be bound to multiple modes.</span></span> <span data-ttu-id="14a11-181">Per RibbonApp, l'unico elemento necessario per l'attributo *ApplicationModes* in un controllo in modalità **semplice** è il `cmdSwitchModes` pulsante, perché fa parte di entrambe le modalità **semplici** e **Avanzate** .</span><span class="sxs-lookup"><span data-stu-id="14a11-181">For RibbonApp, the only need for the *ApplicationModes* attribute in a **Simple** mode control is the `cmdSwitchModes` button , since it is a part of both **Simple** and **Advanced** modes.</span></span> <span data-ttu-id="14a11-182">Se una delle due modalità è attiva, questo controllo verrà visualizzato nel [menu dell'applicazione](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="14a11-182">If either mode is active, this control will appear in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
-   <span data-ttu-id="14a11-183">I controlli modali non ereditano dagli elementi padre.</span><span class="sxs-lookup"><span data-stu-id="14a11-183">Modal controls do not inherit from their parents.</span></span> <span data-ttu-id="14a11-184">La scheda **Avanzate** di RibbonApp contiene un gruppo di **metadati** . entrambi i controlli modali sono assegnati alla modalità 1 (modalità **avanzata** ).</span><span class="sxs-lookup"><span data-stu-id="14a11-184">The **Advanced** tab of RibbonApp contains a **Metadata** group; both of these modal controls are assigned to mode 1 (**Advanced** mode).</span></span> <span data-ttu-id="14a11-185">L'assegnazione della scheda **Avanzate** alla modalità 1 non assegna automaticamente i controlli figlio, ad esempio il gruppo di **metadati** , alla modalità 1.</span><span class="sxs-lookup"><span data-stu-id="14a11-185">Assigning the **Advanced** tab to mode 1 does not automatically assign child controls, such as the **Metadata** group, to mode 1.</span></span> <span data-ttu-id="14a11-186">In questo modo, tutti i gruppi all'interno di una scheda possono essere abilitati o disabilitati indipendentemente in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-186">This allows any group within a tab to be independently enabled or disabled at runtime.</span></span>
-   <span data-ttu-id="14a11-187">I controlli non modale possono continuare a basarsi su commutatori di modalità.</span><span class="sxs-lookup"><span data-stu-id="14a11-187">Non-modal controls can still rely on mode switches.</span></span> <span data-ttu-id="14a11-188">I pulsanti **Modifica metadati** e **Controlla errori** di RibbonApp sono per utenti avanzati e sono disponibili solo quando l'utente passa alla modalità **avanzata** .</span><span class="sxs-lookup"><span data-stu-id="14a11-188">The **Edit Metadata** and **Check for Errors** buttons of RibbonApp are for advanced users and available only when the user switches to **Advanced** mode.</span></span> <span data-ttu-id="14a11-189">I controlli pulsante che non sono ospitati nel [menu dell'applicazione](windowsribbon-controls-applicationmenu.md) sono non modale; Tuttavia, poiché questi pulsanti sono ospitati all'interno di un controllo modale (il gruppo di **metadati** ), sono visibili quando il gruppo è visibile.</span><span class="sxs-lookup"><span data-stu-id="14a11-189">Button controls that are not hosted inside the [Application Menu](windowsribbon-controls-applicationmenu.md) are non-modal; however, because these buttons are hosted inside a modal control (the **Metadata** group), they are visible when the group is visible.</span></span> <span data-ttu-id="14a11-190">Pertanto, questi pulsanti vengono visualizzati quando viene attivata la modalità avanzata e il gruppo di **metadati** viene esposto nell'interfaccia utente della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-190">Therefore, these buttons appear when the advanced mode is activated and the **Metadata** group is exposed in the Ribbon UI.</span></span>

### <a name="switch-modes-at-runtime"></a><span data-ttu-id="14a11-191">Modalità switch in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="14a11-191">Switch Modes at Runtime</span></span>

<span data-ttu-id="14a11-192">Una volta definite nel markup, le modalità possono essere facilmente abilitate o disabilitate in risposta a eventi contestuali.</span><span class="sxs-lookup"><span data-stu-id="14a11-192">After modes are defined in markup, they can be easily enabled or disabled in response to contextual events.</span></span> <span data-ttu-id="14a11-193">Come indicato in precedenza, le applicazioni Ribbon vengono sempre avviate nella modalità predefinita 0.</span><span class="sxs-lookup"><span data-stu-id="14a11-193">As mentioned previously, Ribbon applications always start in the default mode 0.</span></span> <span data-ttu-id="14a11-194">Dopo che l'applicazione è stata inizializzata e la modalità 0 è attiva, il set di modalità attive può essere modificato chiamando la funzione [**IUIFramework:: Semodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) .</span><span class="sxs-lookup"><span data-stu-id="14a11-194">After the application has initialized and mode 0 is active, the set of active modes can be changed by calling the [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) function.</span></span> <span data-ttu-id="14a11-195">Questa funzione accetta un intero a 32 bit come rappresentazione bit per bit delle modalità che devono essere attive. il bit meno significativo rappresenta la modalità 0 e il bit più significativo rappresenta la modalità 31.</span><span class="sxs-lookup"><span data-stu-id="14a11-195">This function takes a 32-bit integer as a bitwise representation of the modes that should be active; the least significant bit represents mode 0 and the most significant bit represents mode 31.</span></span> <span data-ttu-id="14a11-196">Se un bit è impostato su zero, la modalità non è attiva nell'interfaccia utente della barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-196">If a bit is set to zero, the mode is not active in the Ribbon UI.</span></span>

<span data-ttu-id="14a11-197">In RibbonApp, quando un utente abilita la modalità **avanzata** , i comandi avanzati vengono visualizzati insieme ai semplici comandi.</span><span class="sxs-lookup"><span data-stu-id="14a11-197">In RibbonApp, when a user enables **Advanced** mode, the advanced commands are displayed alongside the simple commands.</span></span> <span data-ttu-id="14a11-198">Il gestore di comandi per il pulsante **passa a modalità avanzata** chiama [**IUIFramework:: semodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) per impostare le modalità 0 (**semplice**) e 1 (**avanzata**) come attivo nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-198">The command handler for the **Switch to Advanced Mode** button calls [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) in order to set modes 0 (**Simple**) and 1 (**Advanced**) as active in the UI.</span></span> <span data-ttu-id="14a11-199">Nell'esempio seguente viene riportato il codice RibbonApp per la chiamata di funzione:</span><span class="sxs-lookup"><span data-stu-id="14a11-199">The following example is the RibbonApp code for this function call :</span></span>


```C++
const int SIMPLE_MODE = 0;
const int ADVANCED_MODE = 1;
pFramework->SetModes( UI_MAKEAPPMODE(SIMPLE_MODE) | UI_MAKEAPPMODE(ADVANCED_MODE) );
```



> [!Note]  
> <span data-ttu-id="14a11-200">La macro MAKEAPPMODE dell'interfaccia utente del Framework della barra multifunzione \_ semplifica l'impostazione corretta di questi bit in preparazione alla chiamata a [**IUIFramework:: semodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span><span class="sxs-lookup"><span data-stu-id="14a11-200">The Ribbon framework UI\_MAKEAPPMODE macro simplifies the task of setting these bits correctly in preparation for the call to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span></span>

 

<span data-ttu-id="14a11-201">In questo esempio viene illustrato quanto segue:</span><span class="sxs-lookup"><span data-stu-id="14a11-201">This example demonstrates the following:</span></span>

-   <span data-ttu-id="14a11-202">Usare la macro MAKEAPPMODE dell'interfaccia utente \_ per compilare un set di modalità.</span><span class="sxs-lookup"><span data-stu-id="14a11-202">Use the UI\_MAKEAPPMODE macro to build a mode set.</span></span>
-   <span data-ttu-id="14a11-203">Le modalità vengono impostate in modo esplicito e atomico.</span><span class="sxs-lookup"><span data-stu-id="14a11-203">Modes are set explicitly and atomically.</span></span> <span data-ttu-id="14a11-204">Il valore integer passato a [**IUIFramework::**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) sequests rappresenta le modalità che saranno attive dopo la restituzione della funzione.</span><span class="sxs-lookup"><span data-stu-id="14a11-204">The integer value that is passed to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) represents the modes that will be active after the function returns.</span></span> <span data-ttu-id="14a11-205">Sebbene la modalità **semplice** fosse precedentemente attiva, **IUIFramework:: semodes** deve indicare che la modalità **semplice** rimane attiva quando viene attivata la modalità **avanzata** .</span><span class="sxs-lookup"><span data-stu-id="14a11-205">Although the **Simple** mode was previously active, **IUIFramework::SetModes** must indicate that the **Simple** mode remain active when the **Advanced** mode is activated.</span></span>
-   <span data-ttu-id="14a11-206">La modalità predefinita può essere rimossa.</span><span class="sxs-lookup"><span data-stu-id="14a11-206">The default mode can be removed.</span></span> <span data-ttu-id="14a11-207">Sebbene in RibbonApp la modalità predefinita (modalità 0) non venga mai rimossa, è possibile rimuoverla con la chiamata seguente: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))` , esponendo solo i comandi avanzati nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-207">Although in RibbonApp the default mode (mode 0) is never removed, it can be removed with the following call: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))`, exposing only the advanced commands in the UI.</span></span>

> [!Note]  
> <span data-ttu-id="14a11-208">Quando le modalità di un'applicazione vengono riconfigurate, la barra multifunzione tenterà di mantenere la scheda selezionata in precedenza nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-208">When the modes of an application are reconfigured, the Ribbon will attempt to preserve the previously selected tab in the UI.</span></span> <span data-ttu-id="14a11-209">Se il nuovo set di modalità non contiene più la scheda selezionata prima della chiamata, la barra multifunzione selezionerà la scheda nel layout più vicino al [menu dell'applicazione](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="14a11-209">If the new set of modes no longer contains the tab that was selected before the call, the Ribbon will select the tab in its layout that is closest to the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span> <span data-ttu-id="14a11-210">Questa scheda è destinata a contenere i comandi più rilevanti per l'utente.</span><span class="sxs-lookup"><span data-stu-id="14a11-210">This tab is meant to contain the commands that are most relevant to the user.</span></span> <span data-ttu-id="14a11-211">Per altre informazioni, vedere [linee guida sull'esperienza utente della barra multifunzione](https://msdn.microsoft.com/library/cc872782.aspx).</span><span class="sxs-lookup"><span data-stu-id="14a11-211">For more information, see [Ribbon User Experience Guidelines](https://msdn.microsoft.com/library/cc872782.aspx).</span></span>

 

## <a name="remarks"></a><span data-ttu-id="14a11-212">Commenti</span><span class="sxs-lookup"><span data-stu-id="14a11-212">Remarks</span></span>

<span data-ttu-id="14a11-213">La barra multifunzione deve avere almeno una modalità attiva in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="14a11-213">The Ribbon must have at least one active mode at all times.</span></span> <span data-ttu-id="14a11-214">Se un'applicazione tenta di disattivare tutte le modalità chiamando [**IUIFramework:: Semodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) con un valore di modalità pari a 0, \_ viene restituito l'errore e il set di modalità attivo rimane invariato.</span><span class="sxs-lookup"><span data-stu-id="14a11-214">If an application attempts to deactivate all modes by calling [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) with a mode value of 0, E\_FAIL is returned and the active mode set remains unchanged.</span></span>

<span data-ttu-id="14a11-215">Il Framework richiede che almeno una scheda sia presente nell'interfaccia utente della barra multifunzione sempre.</span><span class="sxs-lookup"><span data-stu-id="14a11-215">The framework requires that at least one tab exist in the Ribbon UI at all times.</span></span> <span data-ttu-id="14a11-216">Di conseguenza, deve essere presente almeno una scheda esposta dalla modalità predefinita (modalità 0) e dopo ogni cambio di modalità.</span><span class="sxs-lookup"><span data-stu-id="14a11-216">As a result, there must be at least one tab exposed by the default mode (mode 0) and after each mode switch.</span></span>

<span data-ttu-id="14a11-217">Non tutte le aree dell'interfaccia utente della barra multifunzione sono interessate dalle modalità di applicazione.</span><span class="sxs-lookup"><span data-stu-id="14a11-217">Not all areas of the Ribbon UI are affected by application modes.</span></span> <span data-ttu-id="14a11-218">Se, ad esempio, la disabilitazione di una modalità causa la scomparsa dei pulsanti della barra multifunzione aggiunti in precedenza alla [barra di accesso rapido](windowsribbon-controls-quickaccesstoolbar.md), tali pulsanti rimarranno nella barra di accesso rapido, consentendo agli utenti di eseguire i comandi associati ai pulsanti.</span><span class="sxs-lookup"><span data-stu-id="14a11-218">For example, if disabling a mode causes the disappearance of buttons from the Ribbon that were previously added to the [Quick Access Toolbar](windowsribbon-controls-quickaccesstoolbar.md), those buttons remain in the Quick Access Toolbar, allowing users to execute the Commands bound to the buttons.</span></span> <span data-ttu-id="14a11-219">Come regola generale, se un comando appartiene a una o più modalità inattive, è necessario disabilitare anche tale comando impostando la proprietà [UI \_ pkey \_ Enabled](windowsribbon-reference-properties-uipkey-enabled.md) su 0 (variante \_ false).</span><span class="sxs-lookup"><span data-stu-id="14a11-219">As a general rule, if a Command belongs to one or more inactive modes, then that Command should also be disabled by setting the [UI\_PKEY\_Enabled](windowsribbon-reference-properties-uipkey-enabled.md) property to 0 (VARIANT\_FALSE) .</span></span>

## <a name="related-topics"></a><span data-ttu-id="14a11-220">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="14a11-220">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="14a11-221">Linee guida sull'esperienza utente della barra multifunzione</span><span class="sxs-lookup"><span data-stu-id="14a11-221">Ribbon User Experience Guidelines</span></span>](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[<span data-ttu-id="14a11-222">Visualizzazione di schede contestuali</span><span class="sxs-lookup"><span data-stu-id="14a11-222">Displaying Contextual Tabs</span></span>](ribbon-contextualtabs.md)
</dt> </dl>

 

 