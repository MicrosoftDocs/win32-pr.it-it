---
description: Un buffer di profondità, spesso denominato buffer z o w-buffer, è una proprietà del dispositivo che archivia le informazioni di profondità che devono essere usate da Direct3D.
ms.assetid: vs|directx_sdk|~\depth_buffers.htm
title: Buffer di profondità (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc1ab41ba98ca5e3b08980ac90a572a19fc8a72a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104481549"
---
# <a name="depth-buffers-direct3d-9"></a><span data-ttu-id="c3c80-103">Buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-103">Depth Buffers (Direct3D 9)</span></span>

<span data-ttu-id="c3c80-104">Un buffer di profondità, spesso denominato buffer z o w-buffer, è una proprietà del dispositivo che archivia le informazioni di profondità che devono essere usate da Direct3D.</span><span class="sxs-lookup"><span data-stu-id="c3c80-104">A depth buffer, often called a z-buffer or a w-buffer, is a property of the device that stores depth information to be used by Direct3D.</span></span> <span data-ttu-id="c3c80-105">Quando Direct3D esegue il rendering di una scena in una superficie di destinazione, può usare la memoria in una superficie del buffer di profondità associata come area di lavoro per determinare il modo in cui i pixel dei poligoni rasterizzati occludere l'uno all'altro.</span><span class="sxs-lookup"><span data-stu-id="c3c80-105">When Direct3D renders a scene to a target surface, it can use the memory in an associated depth-buffer surface as a workspace to determine how the pixels of rasterized polygons occlude one another.</span></span> <span data-ttu-id="c3c80-106">Direct3D usa una superficie Direct3D fuori schermo come destinazione in cui vengono scritti i valori dei colori finali.</span><span class="sxs-lookup"><span data-stu-id="c3c80-106">Direct3D uses an off-screen Direct3D surface as the target to which final color values are written.</span></span> <span data-ttu-id="c3c80-107">La superficie del buffer di profondità associata alla superficie di destinazione di rendering viene utilizzata per archiviare informazioni di profondità che indicano a Direct3D il livello di profondità di ogni pixel visibile nella scena.</span><span class="sxs-lookup"><span data-stu-id="c3c80-107">The depth-buffer surface that is associated with the render-target surface is used to store depth information that tells Direct3D how deep each visible pixel is in the scene.</span></span>

<span data-ttu-id="c3c80-108">Quando una scena viene rasterizzata con il buffering di profondità abilitato, viene testato ogni punto della superficie di rendering.</span><span class="sxs-lookup"><span data-stu-id="c3c80-108">When a scene is rasterized with depth buffering enabled, each point on the rendering surface is tested.</span></span> <span data-ttu-id="c3c80-109">I valori nel buffer di profondità possono essere una coordinata z di un punto o la relativa coordinata w uniforme, dalla posizione del punto (x, y, z, w) nello spazio di proiezione.</span><span class="sxs-lookup"><span data-stu-id="c3c80-109">The values in the depth buffer can be a point's z-coordinate or its homogeneous w-coordinate - from the point's (x,y,z,w) location in projection space.</span></span> <span data-ttu-id="c3c80-110">Un buffer di profondità che usa i valori z è spesso definito un buffer z e uno che usa i valori w viene definito w-buffer.</span><span class="sxs-lookup"><span data-stu-id="c3c80-110">A depth buffer that uses z values is often called a z-buffer, and one that uses w values is called a w-buffer.</span></span> <span data-ttu-id="c3c80-111">Ogni tipo di buffer di profondità presenta vantaggi e svantaggi, descritti più avanti.</span><span class="sxs-lookup"><span data-stu-id="c3c80-111">Each type of depth buffer has advantages and disadvantages, which are discussed later.</span></span>

<span data-ttu-id="c3c80-112">All'inizio del test, il valore di profondità nel buffer di profondità viene impostato sul valore massimo possibile per la scena.</span><span class="sxs-lookup"><span data-stu-id="c3c80-112">At the beginning of the test, the depth value in the depth buffer is set to the largest possible value for the scene.</span></span> <span data-ttu-id="c3c80-113">Il valore del colore sulla superficie di rendering è impostato sul valore del colore di sfondo o sul valore del colore della trama di sfondo in quel punto.</span><span class="sxs-lookup"><span data-stu-id="c3c80-113">The color value on the rendering surface is set to either the background color value or the color value of the background texture at that point.</span></span> <span data-ttu-id="c3c80-114">Ogni poligono nella scena viene testato per verificare se si interseca con la coordinata corrente (x, y) sulla superficie di rendering.</span><span class="sxs-lookup"><span data-stu-id="c3c80-114">Each polygon in the scene is tested to see if it intersects with the current coordinate (x,y) on the rendering surface.</span></span> <span data-ttu-id="c3c80-115">In caso contrario, il valore di profondità, che sarà la coordinata z in un buffer z, e la coordinata w in un w-buffer, nel punto corrente viene testato per verificare se è più piccolo del valore di profondità archiviato nel buffer di profondità.</span><span class="sxs-lookup"><span data-stu-id="c3c80-115">If it does, the depth value - which will be the z coordinate in a z-buffer, and the w coordinate in a w-buffer - at the current point is tested to see if it is smaller than the depth value stored in the depth buffer.</span></span> <span data-ttu-id="c3c80-116">Se la profondità del valore del poligono è inferiore, viene archiviata nel buffer di profondità e il valore del colore del poligono viene scritto nel punto corrente sulla superficie di rendering.</span><span class="sxs-lookup"><span data-stu-id="c3c80-116">If the depth of the polygon value is smaller, it is stored in the depth buffer and the color value from the polygon is written to the current point on the rendering surface.</span></span> <span data-ttu-id="c3c80-117">Se il valore di profondità del poligono a quel punto è maggiore, viene testato il poligono successivo nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="c3c80-117">If the depth value of the polygon at that point is larger, the next polygon in the list is tested.</span></span> <span data-ttu-id="c3c80-118">Questo processo è illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="c3c80-118">This process is shown in the following diagram.</span></span>

![diagramma dei valori di profondità del test](images/zbuffer.png)

> [!Note]  
> <span data-ttu-id="c3c80-120">Anche se la maggior parte delle applicazioni non usa questa funzionalità, è possibile modificare il confronto usato da Direct3D per determinare quali valori vengono inseriti nel buffer di profondità e successivamente la superficie di destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="c3c80-120">Although most applications don't use this feature, you can change the comparison that Direct3D uses to determine which values are placed in the depth buffer and subsequently the render-target surface.</span></span> <span data-ttu-id="c3c80-121">A tale scopo, modificare il valore dello stato di \_ rendering ZFUNC di D3DRS.</span><span class="sxs-lookup"><span data-stu-id="c3c80-121">To do so, change the value for the D3DRS\_ZFUNC render state.</span></span> <span data-ttu-id="c3c80-122">In alcuni componenti hardware, la modifica della funzione compare può disabilitare il test gerarchico z.</span><span class="sxs-lookup"><span data-stu-id="c3c80-122">On some hardware, changing the compare function may disable hierarchical z testing.</span></span>

 

<span data-ttu-id="c3c80-123">Quasi tutti gli acceleratori sul mercato supportano il buffering z, rendendo attualmente il buffer z il tipo più comune di buffer di profondità.</span><span class="sxs-lookup"><span data-stu-id="c3c80-123">Nearly all accelerators on the market support z-buffering, making z-buffers the most common type of depth buffer today.</span></span> <span data-ttu-id="c3c80-124">I buffer z, tuttavia, presentano svantaggi.</span><span class="sxs-lookup"><span data-stu-id="c3c80-124">However ubiquitous, z-buffers have their drawbacks.</span></span> <span data-ttu-id="c3c80-125">A causa della matematica, i valori z generati in un buffer z tendono a non essere distribuiti in modo uniforme nell'intervallo del buffer z (in genere da 0,0 a 1,0, inclusi).</span><span class="sxs-lookup"><span data-stu-id="c3c80-125">Due to the mathematics involved, the generated z values in a z-buffer tend not to be distributed evenly across the z-buffer range (typically 0.0 to 1.0, inclusive).</span></span> <span data-ttu-id="c3c80-126">In particolare, il rapporto tra i piani di ritaglio lontani e vicini influiscono fortemente sul modo in cui i valori z vengono distribuiti in modo non uniforme.</span><span class="sxs-lookup"><span data-stu-id="c3c80-126">Specifically, the ratio between the far and near clipping planes strongly affects how unevenly z values are distributed.</span></span> <span data-ttu-id="c3c80-127">Se si utilizza un rapporto distanza dal piano esterno a distanza quasi dal piano di 100, il 90% dell'intervallo di buffer di profondità viene impiegato per il primo 10% dell'intervallo di profondità della scena.</span><span class="sxs-lookup"><span data-stu-id="c3c80-127">Using a far-plane distance to near-plane distance ratio of 100, 90 percent of the depth buffer range is spent on the first 10 percent of the scene depth range.</span></span> <span data-ttu-id="c3c80-128">Le applicazioni tipiche per le simulazioni visive o di intrattenimento con scenari esterni richiedono spesso rapporti di tipo piano/vicino a un piano di distanza compreso tra 1.000 e 10.000.</span><span class="sxs-lookup"><span data-stu-id="c3c80-128">Typical applications for entertainment or visual simulations with exterior scenes often require far-plane/near-plane ratios of anywhere between 1,000 to 10,000.</span></span> <span data-ttu-id="c3c80-129">Con un rapporto di 1.000, il 98% dell'intervallo viene impiegato per il primo 2% dell'intervallo di profondità e la distribuzione diventa peggiore con rapporti più elevati.</span><span class="sxs-lookup"><span data-stu-id="c3c80-129">At a ratio of 1,000, 98 percent of the range is spent on the first 2 percent of the depth range, and the distribution becomes worse with higher ratios.</span></span> <span data-ttu-id="c3c80-130">Ciò può causare l'inserimento di elementi di superficie nascosti in oggetti distanti, soprattutto quando si usano buffer di profondità a 16 bit, la più comunemente supportata profondità di bit.</span><span class="sxs-lookup"><span data-stu-id="c3c80-130">This can cause hidden surface artifacts in distant objects, especially when using 16-bit depth buffers, the most commonly supported bit-depth.</span></span>

<span data-ttu-id="c3c80-131">Un buffer di profondità basato su w, d'altra parte, è spesso distribuito in modo più uniforme tra i piani di ritaglio vicini e lontani rispetto a un buffer z.</span><span class="sxs-lookup"><span data-stu-id="c3c80-131">A w-based depth buffer, on the other hand, is often more evenly distributed between the near and far clip planes than a z-buffer.</span></span> <span data-ttu-id="c3c80-132">Il vantaggio principale è che il rapporto tra le distanze per i piani di ritaglio lontani e vicini non è più un problema.</span><span class="sxs-lookup"><span data-stu-id="c3c80-132">The key benefit is that the ratio of distances for the far and near clipping planes is no longer an issue.</span></span> <span data-ttu-id="c3c80-133">Questo consente alle applicazioni di supportare intervalli massimi elevati, ottenendo al tempo stesso un buffer di profondità relativamente accurato vicino al punto d'occhio.</span><span class="sxs-lookup"><span data-stu-id="c3c80-133">This allows applications to support large maximum ranges, while still getting relatively accurate depth buffering close to the eye point.</span></span> <span data-ttu-id="c3c80-134">Un buffer di profondità basato su w non è perfetto e talvolta può presentare elementi della superficie nascosta per oggetti near.</span><span class="sxs-lookup"><span data-stu-id="c3c80-134">A w-based depth buffer isn't perfect, and can sometimes exhibit hidden surface artifacts for near objects.</span></span> <span data-ttu-id="c3c80-135">Un altro svantaggio dell'approccio con buffer w è correlato al supporto hardware: w-buffering non è supportato con l'hardware come il buffer z.</span><span class="sxs-lookup"><span data-stu-id="c3c80-135">Another drawback to the w-buffered approach is related to hardware support: w-buffering isn't supported as widely in hardware as z-buffering.</span></span>

<span data-ttu-id="c3c80-136">L'uso di un buffer z richiede un sovraccarico durante il rendering.</span><span class="sxs-lookup"><span data-stu-id="c3c80-136">Using a z-buffer requires overhead during rendering.</span></span> <span data-ttu-id="c3c80-137">È possibile utilizzare varie tecniche per ottimizzare il rendering quando si utilizzano i buffer z.</span><span class="sxs-lookup"><span data-stu-id="c3c80-137">Various techniques can be used to optimize rendering when using z-buffers.</span></span> <span data-ttu-id="c3c80-138">Per informazioni dettagliate, vedere [prestazioni del buffer Z](performance-optimizations.md).</span><span class="sxs-lookup"><span data-stu-id="c3c80-138">For details, see [Z-Buffer Performance](performance-optimizations.md).</span></span>

> [!Note]  
> <span data-ttu-id="c3c80-139">L'interpretazione effettiva di un valore di profondità è specifica per il renderer.</span><span class="sxs-lookup"><span data-stu-id="c3c80-139">The actual interpretation of a depth value is specific to the renderer.</span></span>

 

<span data-ttu-id="c3c80-140">Questa sezione presenta informazioni sull'uso dei buffer di profondità per la rimozione della linea nascosta e della superficie nascosta.</span><span class="sxs-lookup"><span data-stu-id="c3c80-140">This section presents information about using depth buffers for hidden line and hidden surface removal.</span></span>

-   [<span data-ttu-id="c3c80-141">Esecuzione di query per il supporto del buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-141">Querying for Depth Buffer Support (Direct3D 9)</span></span>](querying-for-depth-buffer-support.md)
-   [<span data-ttu-id="c3c80-142">Creazione di un buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-142">Creating a Depth Buffer (Direct3D 9)</span></span>](creating-a-depth-buffer.md)
-   [<span data-ttu-id="c3c80-143">Abilitazione del buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-143">Enabling Depth Buffering (Direct3D 9)</span></span>](enabling-depth-buffering.md)
-   [<span data-ttu-id="c3c80-144">Recupero di un buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-144">Retrieving a Depth Buffer (Direct3D 9)</span></span>](retrieving-a-depth-buffer.md)
-   [<span data-ttu-id="c3c80-145">Cancellazione dei buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-145">Clearing Depth Buffers (Direct3D 9)</span></span>](clearing-depth-buffers.md)
-   [<span data-ttu-id="c3c80-146">Modifica dell'accesso in scrittura al buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-146">Changing Depth Buffer Write Access (Direct3D 9)</span></span>](changing-depth-buffer-write-access.md)
-   [<span data-ttu-id="c3c80-147">Modifica delle funzioni di confronto del buffer di profondità (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="c3c80-147">Changing Depth Buffer Comparison Functions (Direct3D 9)</span></span>](changing-depth-buffer-comparison-functions.md)

## <a name="related-topics"></a><span data-ttu-id="c3c80-148">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="c3c80-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c3c80-149">Rendering Direct3D</span><span class="sxs-lookup"><span data-stu-id="c3c80-149">Direct3D Rendering</span></span>](direct3d-rendering.md)
</dt> </dl>

 

 



