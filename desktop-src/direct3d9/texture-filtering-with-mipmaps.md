---
description: Un mipmap è una sequenza di trame, ognuna delle quali è una rappresentazione di risoluzione progressivamente inferiore della stessa immagine.
ms.assetid: b64abca9-0efb-4939-849d-e75a8d0dc10b
title: Filtraggio delle trame con mipmap (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bdc109ae6de93a26b5d5e5b90e948761e92ee92c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104561441"
---
# <a name="texture-filtering-with-mipmaps-direct3d-9"></a><span data-ttu-id="acc67-103">Filtraggio delle trame con mipmap (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="acc67-103">Texture Filtering with Mipmaps (Direct3D 9)</span></span>

<span data-ttu-id="acc67-104">Un mipmap è una sequenza di trame, ognuna delle quali è una rappresentazione di risoluzione progressivamente inferiore della stessa immagine.</span><span class="sxs-lookup"><span data-stu-id="acc67-104">A mipmap is a sequence of textures, each of which is a progressively lower resolution representation of the same image.</span></span> <span data-ttu-id="acc67-105">L'altezza e la larghezza di ogni immagine, o livello, in mipmap sono una potenza di due dimensioni inferiori al livello precedente.</span><span class="sxs-lookup"><span data-stu-id="acc67-105">The height and width of each image, or level, in the mipmap is a power of two smaller than the previous level.</span></span> <span data-ttu-id="acc67-106">Non è necessario che mipmap sia quadrato.</span><span class="sxs-lookup"><span data-stu-id="acc67-106">Mipmaps do not have to be square.</span></span>

<span data-ttu-id="acc67-107">Per gli oggetti vicini all'utente viene utilizzata un'immagine mipmap ad alta risoluzione.</span><span class="sxs-lookup"><span data-stu-id="acc67-107">A high-resolution mipmap image is used for objects that are close to the user.</span></span> <span data-ttu-id="acc67-108">Le immagini con risoluzione inferiore vengono utilizzate quando l'oggetto viene visualizzato più lontano.</span><span class="sxs-lookup"><span data-stu-id="acc67-108">Lower-resolution images are used as the object appears farther away.</span></span> <span data-ttu-id="acc67-109">Mapping MIP migliora la qualità delle trame di cui è stato eseguito il rendering a scapito dell'utilizzo di più memoria.</span><span class="sxs-lookup"><span data-stu-id="acc67-109">Mipmapping improves the quality of rendered textures at the expense of using more memory.</span></span>

<span data-ttu-id="acc67-110">Direct3D rappresenta mipmap come una catena di superfici collegate.</span><span class="sxs-lookup"><span data-stu-id="acc67-110">Direct3D represents mipmaps as a chain of attached surfaces.</span></span> <span data-ttu-id="acc67-111">La trama con la risoluzione più elevata si trova all'inizio della catena e ha il livello successivo del mipmap come allegato.</span><span class="sxs-lookup"><span data-stu-id="acc67-111">The highest resolution texture is at the head of the chain and has the next level of the mipmap as an attachment.</span></span> <span data-ttu-id="acc67-112">A sua volta, tale livello ha un allegato che rappresenta il livello successivo in mipmap e così via, fino al livello di risoluzione più basso di mipmap.</span><span class="sxs-lookup"><span data-stu-id="acc67-112">In turn, that level has an attachment that is the next level in the mipmap, and so on, down to the lowest resolution level of the mipmap.</span></span>

<span data-ttu-id="acc67-113">Le illustrazioni seguenti mostrano un esempio di questi livelli.</span><span class="sxs-lookup"><span data-stu-id="acc67-113">The following illustrations shows an example of these levels.</span></span> <span data-ttu-id="acc67-114">Le trame bitmap rappresentano un segno di un contenitore in un gioco di prima persona 3D.</span><span class="sxs-lookup"><span data-stu-id="acc67-114">The bitmap textures represent a sign on a container in a 3D first-person game.</span></span> <span data-ttu-id="acc67-115">Quando viene creato come mipmap, la trama con la risoluzione più alta è la prima nel set.</span><span class="sxs-lookup"><span data-stu-id="acc67-115">When created as a mipmap, the highest resolution texture is first in the set.</span></span> <span data-ttu-id="acc67-116">Ogni trama successiva nel set di mipmap è più piccola in altezza e larghezza per una potenza di 2.</span><span class="sxs-lookup"><span data-stu-id="acc67-116">Each succeeding texture in the mipmap set is smaller in height and width by a power of 2.</span></span> <span data-ttu-id="acc67-117">In questo caso, la mipmap di risoluzione massima è 256 pixel di 256 pixel.</span><span class="sxs-lookup"><span data-stu-id="acc67-117">In this case, the maximum-resolution mipmap is 256 pixels by 256 pixels.</span></span> <span data-ttu-id="acc67-118">La trama successiva è 128x128.</span><span class="sxs-lookup"><span data-stu-id="acc67-118">The next, texture is 128x128.</span></span> <span data-ttu-id="acc67-119">L'ultima trama nella catena è 64x64.</span><span class="sxs-lookup"><span data-stu-id="acc67-119">The last texture in the chain is 64x64.</span></span>

<span data-ttu-id="acc67-120">Questo segno ha una distanza massima da cui è visibile.</span><span class="sxs-lookup"><span data-stu-id="acc67-120">This sign has a maximum distance from which it is visible.</span></span> <span data-ttu-id="acc67-121">Se l'utente inizia a distanza dal segno, il gioco Visualizza la trama più piccola nella catena mipmap, che in questo caso è la trama 64x64.</span><span class="sxs-lookup"><span data-stu-id="acc67-121">If the user begins far away from the sign, the game displays the smallest texture in the mipmap chain, which in this case the 64x64 texture.</span></span>

![illustrazione di una trama 64x64 di un segno di pericolo](images/mip1.jpg)

<span data-ttu-id="acc67-123">Quando l'utente sposta il punto di vista più vicino al segno, vengono usate trame a risoluzione progressiva più elevata nella catena mipmap.</span><span class="sxs-lookup"><span data-stu-id="acc67-123">As the user moves the point of view closer to the sign, progressively higher-resolution textures in the mipmap chain are used.</span></span> <span data-ttu-id="acc67-124">La risoluzione nella figura seguente è 128x128.</span><span class="sxs-lookup"><span data-stu-id="acc67-124">The resolution in the following illustration is 128x128.</span></span>

![illustrazione di una trama 128x128 di un segno di pericolo](images/mip2.jpg)

<span data-ttu-id="acc67-126">La trama con la risoluzione più elevata viene utilizzata quando il punto di visualizzazione dell'utente è alla distanza minima consentita dal segno, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="acc67-126">The highest resolution texture is used when the user's point of view is at the minimum allowable distance from the sign, as shown in the following illustration.</span></span>

![illustrazione di una trama 256x256 di un segno di pericolo](images/mip3.jpg)

<span data-ttu-id="acc67-128">Si tratta di un modo più efficiente per simulare la prospettiva per le trame.</span><span class="sxs-lookup"><span data-stu-id="acc67-128">This is a more efficient way of simulating perspective for textures.</span></span> <span data-ttu-id="acc67-129">Anziché eseguire il rendering di una singola trama a molte risoluzioni, è più veloce usare più trame con diverse risoluzioni.</span><span class="sxs-lookup"><span data-stu-id="acc67-129">Rather than render a single texture at many resolutions, it is faster to use multiple textures at varying resolutions.</span></span>

<span data-ttu-id="acc67-130">Direct3D può valutare quale trama in un set di mipmap è la risoluzione più vicina all'output desiderato ed è in grado di mappare i pixel nello spazio Texel.</span><span class="sxs-lookup"><span data-stu-id="acc67-130">Direct3D can assess which texture in a mipmap set is the closest resolution to the desired output, and it can map pixels into its texel space.</span></span> <span data-ttu-id="acc67-131">Se la risoluzione dell'immagine finale è compresa tra le risoluzioni delle trame nel set di mipmap, Direct3D può esaminare i Texel in entrambi i mipmap e fondere i valori dei colori.</span><span class="sxs-lookup"><span data-stu-id="acc67-131">If the resolution of the final image is between the resolutions of the textures in the mipmap set, Direct3D can examine texels in both mipmaps and blend their color values together.</span></span>

<span data-ttu-id="acc67-132">Per usare mipmap, l'applicazione deve compilare un set di mipmap.</span><span class="sxs-lookup"><span data-stu-id="acc67-132">To use mipmaps, your application must build a set of mipmaps.</span></span> <span data-ttu-id="acc67-133">Le applicazioni applicano mipmap selezionando il mipmap impostato come prima trama nel set di trame correnti.</span><span class="sxs-lookup"><span data-stu-id="acc67-133">Applications apply mipmaps by selecting the mipmap set as the first texture in the set of current textures.</span></span> <span data-ttu-id="acc67-134">Per altre informazioni, vedere [blending di trame (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="acc67-134">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="acc67-135">Successivamente, l'applicazione deve impostare il metodo di filtro usato da Direct3D per campionare Texel.</span><span class="sxs-lookup"><span data-stu-id="acc67-135">Next, your application must set the filtering method that Direct3D uses to sample texels.</span></span> <span data-ttu-id="acc67-136">Il metodo più veloce per filtrare mipmap consiste nel fare in modo che Direct3D selezioni il Texel più vicino.</span><span class="sxs-lookup"><span data-stu-id="acc67-136">The fastest method of mipmap filtering is to have Direct3D select the nearest texel.</span></span> <span data-ttu-id="acc67-137">Usare il \_ valore enumerato Point D3DTEXF per selezionare questa.</span><span class="sxs-lookup"><span data-stu-id="acc67-137">Use the D3DTEXF\_POINT enumerated value to select this.</span></span> <span data-ttu-id="acc67-138">Direct3D può produrre risultati di filtro migliori se l'applicazione usa il \_ valore enumerato D3DTEXF lineare.</span><span class="sxs-lookup"><span data-stu-id="acc67-138">Direct3D can produce better filtering results if your application uses the D3DTEXF\_LINEAR enumerated value.</span></span> <span data-ttu-id="acc67-139">Viene selezionato il mipmap più vicino, quindi viene calcolata una media ponderata dei Texel che circonda la posizione nella trama a cui viene eseguito il mapping del pixel corrente.</span><span class="sxs-lookup"><span data-stu-id="acc67-139">This selects the nearest mipmap, and then computes a weighted average of the texels surrounding the location in the texture to which the current pixel maps.</span></span>

<span data-ttu-id="acc67-140">Le trame mipmap vengono usate nelle scene 3D per ridurre il tempo necessario per eseguire il rendering di una scena.</span><span class="sxs-lookup"><span data-stu-id="acc67-140">Mipmap textures are used in 3D scenes to decrease the time required to render a scene.</span></span> <span data-ttu-id="acc67-141">Inoltre, migliorano il realismo della scena.</span><span class="sxs-lookup"><span data-stu-id="acc67-141">They also improve the scene's realism.</span></span> <span data-ttu-id="acc67-142">Tuttavia, spesso richiedono grandi quantità di memoria.</span><span class="sxs-lookup"><span data-stu-id="acc67-142">However, they often require large amounts of memory.</span></span>

## <a name="creating-a-set-of-mipmaps"></a><span data-ttu-id="acc67-143">Creazione di un set di mipmap</span><span class="sxs-lookup"><span data-stu-id="acc67-143">Creating a Set of Mipmaps</span></span>

<span data-ttu-id="acc67-144">L'esempio seguente mostra come l'applicazione può chiamare il metodo [**IDirect3DDevice9:: createTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) per compilare una catena di cinque livelli mipmap: 256x256, 128x128, 64x64, 32x32 e 16x16.</span><span class="sxs-lookup"><span data-stu-id="acc67-144">The following example shows how your application can call the [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) method to build a chain of five mipmap levels: 256x256, 128x128, 64x64, 32x32, and 16x16.</span></span>


```
// This code example assumes that m_d3dDevice is a
// valid pointer to a IDirect3DDevice9 interface

IDirect3DTexture9 * pMipMap;
m_pD3DDevice->CreateTexture(256, 256, 5, 0, D3DFMT_R8G8B8, 
    D3DPOOL_MANAGED, &pMipMap);
```



<span data-ttu-id="acc67-145">I primi due parametri accettati da [**IDirect3DDevice9:: createTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) sono le dimensioni e la larghezza della trama di primo livello.</span><span class="sxs-lookup"><span data-stu-id="acc67-145">The first two parameters that are accepted by [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) are the size and width of the top-level texture.</span></span> <span data-ttu-id="acc67-146">Il terzo parametro specifica il numero di livelli nella trama.</span><span class="sxs-lookup"><span data-stu-id="acc67-146">The third parameter specifies the number of levels in the texture.</span></span> <span data-ttu-id="acc67-147">Se si imposta questo valore su zero, Direct3D crea una catena di superfici, ciascuna con una potenza di due minore di quella precedente, fino alla dimensione minima possibile di 1x1.</span><span class="sxs-lookup"><span data-stu-id="acc67-147">If you set this to zero, Direct3D creates a chain of surfaces, each a power of two smaller than the previous one, down to the smallest possible size of 1x1.</span></span> <span data-ttu-id="acc67-148">Il quarto parametro specifica l'utilizzo della risorsa. in questo caso, viene specificato 0 per indicare nessun utilizzo specifico per la risorsa.</span><span class="sxs-lookup"><span data-stu-id="acc67-148">The fourth parameter specifies the usage for this resource; in this case, 0 is specified to indicate no specific usage for the resource.</span></span> <span data-ttu-id="acc67-149">Il quinto parametro specifica il formato di superficie per la trama.</span><span class="sxs-lookup"><span data-stu-id="acc67-149">The fifth parameter specifies the surface format for the texture.</span></span> <span data-ttu-id="acc67-150">Usare un valore dal tipo enumerato [D3DFORMAT](d3dformat.md) per questo parametro.</span><span class="sxs-lookup"><span data-stu-id="acc67-150">Use a value from the [D3DFORMAT](d3dformat.md) enumerated type for this parameter.</span></span> <span data-ttu-id="acc67-151">Il sesto parametro specifica un membro del tipo enumerato [**D3DPOOL**](./d3dpool.md) che indica la classe di memoria in cui inserire la risorsa creata.</span><span class="sxs-lookup"><span data-stu-id="acc67-151">The sixth parameter specifies a member of the [**D3DPOOL**](./d3dpool.md) enumerated type indicating the memory class into which to place the created resource.</span></span> <span data-ttu-id="acc67-152">A meno che non si stiano usando trame dinamiche, \_ è consigliabile gestire D3DPOOL.</span><span class="sxs-lookup"><span data-stu-id="acc67-152">Unless you are using dynamic textures, D3DPOOL\_MANAGED is recommended.</span></span> <span data-ttu-id="acc67-153">Il parametro finale accetta l'indirizzo di un puntatore a un'interfaccia [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) .</span><span class="sxs-lookup"><span data-stu-id="acc67-153">The final parameter takes the address of a pointer to an [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) interface.</span></span>

> [!Note]  
> <span data-ttu-id="acc67-154">Ogni superficie in una catena mipmap ha dimensioni che sono una metà della superficie precedente della catena.</span><span class="sxs-lookup"><span data-stu-id="acc67-154">Each surface in a mipmap chain has dimensions that are one-half that of the previous surface in the chain.</span></span> <span data-ttu-id="acc67-155">Se il mipmap di primo livello ha dimensioni di con dimensioni 256x128, le dimensioni del mipmap di secondo livello sono 128x64, il terzo livello è 64x32 e così via, fino a 1x1.</span><span class="sxs-lookup"><span data-stu-id="acc67-155">If the top-level mipmap has dimensions of 256x128, the dimensions of the second-level mipmap are 128x64, the third-level are 64x32, and so on, down to 1x1.</span></span> <span data-ttu-id="acc67-156">Non è possibile richiedere un numero di livelli di mipmap in livelli che causerebbero la larghezza o l'altezza di qualsiasi mipmap nella catena inferiore a 1.</span><span class="sxs-lookup"><span data-stu-id="acc67-156">You cannot request a number of mipmap levels in Levels that would cause either the width or height of any mipmap in the chain to be smaller than 1.</span></span> <span data-ttu-id="acc67-157">Nel caso più semplice di una superficie mipmap di primo livello 4x2, il valore massimo consentito per i livelli è tre.</span><span class="sxs-lookup"><span data-stu-id="acc67-157">In the simple case of a 4x2 top-level mipmap surface, the maximum value allowed for Levels is three.</span></span> <span data-ttu-id="acc67-158">Le dimensioni di primo livello sono 4x2, le dimensioni di secondo livello sono 2x1 e le dimensioni del terzo livello sono 1x1.</span><span class="sxs-lookup"><span data-stu-id="acc67-158">The top-level dimensions are 4x2, the second-level dimensions are 2x1, and the dimensions for the third level are 1x1.</span></span> <span data-ttu-id="acc67-159">Un valore maggiore di 3 in livelli restituisce un valore frazionario nell'altezza del mipmap di secondo livello e pertanto non è consentito.</span><span class="sxs-lookup"><span data-stu-id="acc67-159">A value larger than 3 in Levels results in a fractional value in the height of the second-level mipmap, and is therefore disallowed.</span></span>

 

## <a name="selecting-and-displaying-a-mipmap"></a><span data-ttu-id="acc67-160">Selezione e visualizzazione di un mipmap</span><span class="sxs-lookup"><span data-stu-id="acc67-160">Selecting and Displaying a Mipmap</span></span>

<span data-ttu-id="acc67-161">Chiamare il metodo [**IDirect3DDevice9:: setexture**](/windows/desktop/api) per impostare il set di trame mipmap come prima trama nell'elenco delle trame correnti.</span><span class="sxs-lookup"><span data-stu-id="acc67-161">Call the [**IDirect3DDevice9::SetTexture**](/windows/desktop/api) method to set the mipmap texture set as the first texture in the list of current textures.</span></span> <span data-ttu-id="acc67-162">Per altre informazioni, vedere [blending di trame (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="acc67-162">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="acc67-163">Dopo che l'applicazione ha selezionato il set di trama mipmap, deve assegnare i valori dal tipo enumerato [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) allo \_ stato del campionatore MIPFILTER D3DSAMP.</span><span class="sxs-lookup"><span data-stu-id="acc67-163">After your application selects the mipmap texture set, it must assign values from the [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) enumerated type to the D3DSAMP\_MIPFILTER sampler state.</span></span> <span data-ttu-id="acc67-164">Direct3D esegue quindi automaticamente il filtro della trama mipmap.</span><span class="sxs-lookup"><span data-stu-id="acc67-164">Direct3D then automatically performs mipmap texture filtering.</span></span> <span data-ttu-id="acc67-165">L'abilitazione del filtro della trama mipmap è illustrata nell'esempio di codice seguente.</span><span class="sxs-lookup"><span data-stu-id="acc67-165">Enabling mipmap texture filtering is demonstrated in the following code example.</span></span>


```
m_pD3DDevice->SetTexture(0, pMipMap);
m_pD3DDevice->SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_POINT);
```



<span data-ttu-id="acc67-166">L'applicazione può anche attraversare manualmente una catena di superfici mipmap usando il metodo [**IDirect3DTexture9:: GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) e specificando il livello mipmap da recuperare.</span><span class="sxs-lookup"><span data-stu-id="acc67-166">Your application can also manually traverse a chain of mipmap surfaces by using the [**IDirect3DTexture9::GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) method and specifying the mipmap level to retrieve.</span></span> <span data-ttu-id="acc67-167">Nell'esempio seguente viene attraversata una catena mipmap dalla risoluzione più alta alla più bassa.</span><span class="sxs-lookup"><span data-stu-id="acc67-167">The following example traverses a mipmap chain from highest to lowest resolutions.</span></span>


```
IDirect3DSurface9 * pSurfaceLevel;
for (int iLevel = 0; iLevel < pMipMap->GetLevelCount(); iLevel++)
{
    pMipMap->GetSurfaceLevel(iLevel, &pSurfaceLevel);
    // Process this level
    pSurfaceLevel->Release();
}
```



<span data-ttu-id="acc67-168">Le applicazioni devono attraversare manualmente una catena mipmap per caricare i dati bitmap in ogni superficie della catena.</span><span class="sxs-lookup"><span data-stu-id="acc67-168">Applications need to manually traverse a mipmap chain to load bitmap data into each surface in the chain.</span></span> <span data-ttu-id="acc67-169">Si tratta in genere dell'unico motivo per attraversare la catena.</span><span class="sxs-lookup"><span data-stu-id="acc67-169">This is typically the only reason to traverse the chain.</span></span> <span data-ttu-id="acc67-170">Un'applicazione può recuperare il numero di livelli in un mipmap chiamando [**IDirect3DBaseTexture9:: GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span><span class="sxs-lookup"><span data-stu-id="acc67-170">An application can retrieve the number of levels in a mipmap by calling [**IDirect3DBaseTexture9::GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span></span>

## <a name="related-topics"></a><span data-ttu-id="acc67-171">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="acc67-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="acc67-172">Filtraggio trama</span><span class="sxs-lookup"><span data-stu-id="acc67-172">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
