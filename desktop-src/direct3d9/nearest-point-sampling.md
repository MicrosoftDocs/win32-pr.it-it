---
description: Non è necessario che le applicazioni utilizzino il filtro della trama.
ms.assetid: bba0e485-ac5a-4e43-9eb7-25cd0c90d316
title: Campionamento Nearest-Point (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b11cf98ee917b124b35f3c30ff263365ec3c46e1
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "104401193"
---
# <a name="nearest-point-sampling-direct3d-9"></a><span data-ttu-id="3af50-103">Campionamento Nearest-Point (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3af50-103">Nearest-Point Sampling (Direct3D 9)</span></span>

<span data-ttu-id="3af50-104">Non è necessario che le applicazioni utilizzino il filtro della trama.</span><span class="sxs-lookup"><span data-stu-id="3af50-104">Applications are not required to use texture filtering.</span></span> <span data-ttu-id="3af50-105">Direct3D può essere impostato in modo da calcolare l'indirizzo di Texel, che spesso non restituisce Integer, e copia il colore del Texel con l'indirizzo integer più vicino.</span><span class="sxs-lookup"><span data-stu-id="3af50-105">Direct3D can be set so that it computes the texel address, which often does not evaluate to integers, and copies the color of the texel with the closest integer address.</span></span> <span data-ttu-id="3af50-106">Questo processo è denominato campionamento del punto più vicino.</span><span class="sxs-lookup"><span data-stu-id="3af50-106">This process is called nearest-point sampling.</span></span> <span data-ttu-id="3af50-107">Questo può essere un modo rapido ed efficiente per elaborare le trame se la dimensione della trama è simile alla dimensione dell'immagine della primitiva sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="3af50-107">This can be a fast and efficient way to process textures if the size of the texture is similar to the size of the primitive's image on the screen.</span></span> <span data-ttu-id="3af50-108">In caso contrario, la trama deve essere ingrandita o minimizzati.</span><span class="sxs-lookup"><span data-stu-id="3af50-108">If not, the texture must be magnified or minified.</span></span> <span data-ttu-id="3af50-109">Il risultato può essere un'immagine chunked, con alias o sfocata.</span><span class="sxs-lookup"><span data-stu-id="3af50-109">The result can be a chunky, aliased, or blurred image.</span></span>

<span data-ttu-id="3af50-110">L'applicazione C++ può selezionare il campionamento dei punti più vicini chiamando il metodo [**IDirect3DDevice9:: SetSamplerState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) .</span><span class="sxs-lookup"><span data-stu-id="3af50-110">Your C++ application can select nearest-point sampling by calling the [**IDirect3DDevice9::SetSamplerState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) method.</span></span> <span data-ttu-id="3af50-111">Impostare il valore del primo parametro sul numero di indice Integer (0-7) della trama per cui si seleziona un metodo di filtro della trama.</span><span class="sxs-lookup"><span data-stu-id="3af50-111">Set the value of the first parameter to the integer index number (0-7) of the texture for which you are selecting a texture filtering method.</span></span> <span data-ttu-id="3af50-112">Passare D3DSAMP \_ MAGFILTER, D3DSAMP \_ MINFILTER o D3DSAMP \_ MIPFILTER per il secondo parametro per impostare il filtro di ingrandimento, minification o mapping MIP.</span><span class="sxs-lookup"><span data-stu-id="3af50-112">Pass D3DSAMP\_MAGFILTER, D3DSAMP\_MINFILTER, or D3DSAMP\_MIPFILTER for the second parameter to set the magnification, minification, or mipmapping filter.</span></span> <span data-ttu-id="3af50-113">Passare \_ il punto D3DTEXF nel terzo parametro.</span><span class="sxs-lookup"><span data-stu-id="3af50-113">Pass D3DTEXF\_POINT in the third parameter.</span></span>

<span data-ttu-id="3af50-114">È consigliabile usare attentamente il campionamento dei punti più vicini, perché talvolta può causare artefatti grafici quando la trama viene campionata al limite tra due Texel.</span><span class="sxs-lookup"><span data-stu-id="3af50-114">You should use nearest-point sampling carefully, because it can sometimes cause graphic artifacts when the texture is sampled at the boundary between two texels.</span></span> <span data-ttu-id="3af50-115">Questo limite è la posizione lungo la trama (u o v) in cui il Texel campionato passa da un Texel a quello successivo.</span><span class="sxs-lookup"><span data-stu-id="3af50-115">This boundary is the position along the texture (u or v) at which the sampled texel transitions from one texel to the next.</span></span> <span data-ttu-id="3af50-116">Quando si usa il campionamento dei punti, il sistema sceglie un Texel di esempio o l'altro e il risultato può cambiare bruscamente da un Texel al Texel successivo quando il limite viene attraversato.</span><span class="sxs-lookup"><span data-stu-id="3af50-116">When point sampling is used, the system chooses one sample texel or the other, and the result can change abruptly from one texel to the next texel as the boundary is crossed.</span></span> <span data-ttu-id="3af50-117">Questo effetto può essere visualizzato come elementi grafici indesiderati nella trama visualizzata.</span><span class="sxs-lookup"><span data-stu-id="3af50-117">This effect can appear as undesired graphic artifacts in the displayed texture.</span></span> <span data-ttu-id="3af50-118">Quando si usa il filtro lineare, il Texel risultante viene calcolato da entrambi i Texel adiacenti e si fonde armoniosamente tra di essi quando l'indice di trama passa attraverso il limite.</span><span class="sxs-lookup"><span data-stu-id="3af50-118">When linear filtering is used, the resulting texel is computed from both adjacent texels and smoothly blends between them as the texture index moves through the boundary.</span></span>

<span data-ttu-id="3af50-119">Questo effetto si verifica quando si esegue il mapping di una trama molto piccola su un poligono di dimensioni molto grandi: un'operazione spesso denominata ingrandimento.</span><span class="sxs-lookup"><span data-stu-id="3af50-119">This effect can be seen when mapping a very small texture onto a very large polygon: an operation often called magnification.</span></span> <span data-ttu-id="3af50-120">Ad esempio, quando si usa una trama simile a una scacchiera, il campionamento del punto più vicino genera una scacchiera più grande che Mostra bordi distinti.</span><span class="sxs-lookup"><span data-stu-id="3af50-120">For example, when using a texture that looks like a checkerboard, nearest-point sampling results in a larger checkerboard that shows distinct edges.</span></span> <span data-ttu-id="3af50-121">Al contrario, il filtro di trama lineare produce un'immagine in cui i colori della scacchiera variano in modo uniforme nel poligono.</span><span class="sxs-lookup"><span data-stu-id="3af50-121">By contrast, linear texture filtering results in an image where the checkerboard colors vary smoothly across the polygon.</span></span>

<span data-ttu-id="3af50-122">Nella maggior parte dei casi, le applicazioni ricevono i migliori risultati evitando laddove possibile il campione più vicino.</span><span class="sxs-lookup"><span data-stu-id="3af50-122">In most cases, applications receive the best results by avoiding nearest-point sample wherever possible.</span></span> <span data-ttu-id="3af50-123">La maggior parte dell'hardware oggi è ottimizzata per i filtri lineari, quindi l'applicazione non deve soffrire di prestazioni ridotte.</span><span class="sxs-lookup"><span data-stu-id="3af50-123">The majority of hardware today is optimized for linear filtering, so your application should not suffer degraded performance.</span></span> <span data-ttu-id="3af50-124">Se l'effetto desiderato richiede assolutamente l'uso del campionamento dei punti più vicino, ad esempio quando si usano trame per visualizzare caratteri di testo leggibili, l'applicazione deve prestare molta attenzione a evitare il campionamento ai limiti di Texel, che potrebbero causare effetti indesiderati.</span><span class="sxs-lookup"><span data-stu-id="3af50-124">If the effect you desire absolutely requires the use of the nearest-point sampling - such as when using textures to display readable text characters - then your application should be extremely careful to avoid sampling at the texel boundaries, which might result in undesired effects.</span></span> <span data-ttu-id="3af50-125">Nella figura seguente sono illustrati gli elementi che possono essere simili.</span><span class="sxs-lookup"><span data-stu-id="3af50-125">The following illustration shows what these artifacts can look like.</span></span>

![illustrazione di una casella a sei sezioni con linee orizzontali non continue nei due quadrati superiore destro](images/ptrtfct.png)

<span data-ttu-id="3af50-127">Si noti che i due quadrati nella parte superiore destra del gruppo appaiono diversi dagli elementi adiacenti, con offset diagonali in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="3af50-127">Notice that the two squares in the upper right of the group appear different than their neighbors, with diagonal offsets running through them.</span></span> <span data-ttu-id="3af50-128">Per evitare artefatti grafici come questi, è necessario avere familiarità con le regole di campionamento di trama Direct3D per il filtro dei punti più vicino.</span><span class="sxs-lookup"><span data-stu-id="3af50-128">To avoid graphic artifacts like these, you must be familiar with Direct3D texture sampling rules for nearest-point filtering.</span></span> <span data-ttu-id="3af50-129">Direct3D esegue il mapping di una coordinata di trama a virgola mobile compresa tra \[ 0,0, 1,0 \] (da 0,0 a 1,0, inclusi) a un valore dello spazio di Texel intero compreso tra \[ -0,5 e n-0,5 \] , dove n è il numero di Texel in una determinata dimensione sulla trama.</span><span class="sxs-lookup"><span data-stu-id="3af50-129">Direct3D maps a floating-point texture coordinate ranging from \[0.0, 1.0\] (0.0 to 1.0, inclusive) to an integer texel space value ranging from \[ - 0.5, n - 0.5\], where n is the number of texels in a given dimension on the texture.</span></span> <span data-ttu-id="3af50-130">L'indice di trama risultante viene arrotondato all'intero più vicino.</span><span class="sxs-lookup"><span data-stu-id="3af50-130">The resulting texture index is rounded to the nearest integer.</span></span> <span data-ttu-id="3af50-131">Questo mapping può introdurre inesattezze di campionamento ai limiti di Texel.</span><span class="sxs-lookup"><span data-stu-id="3af50-131">This mapping can introduce sampling inaccuracies at texel boundaries.</span></span>

<span data-ttu-id="3af50-132">Per un esempio semplice, si supponga che un'applicazione esegua il rendering dei poligoni con la \_ modalità di indirizzamento della trama D3DTADDRESS wrap.</span><span class="sxs-lookup"><span data-stu-id="3af50-132">For a simple example, imagine an application that renders polygons with the D3DTADDRESS\_WRAP texture addressing mode.</span></span> <span data-ttu-id="3af50-133">Usando il mapping usato da Direct3D, l'indice di trama u viene mappato come illustrato nel diagramma seguente per una trama con una larghezza di 4 Texel.</span><span class="sxs-lookup"><span data-stu-id="3af50-133">Using the mapping employed by Direct3D, the u texture index maps as show in the following diagram for a texture with a width of 4 texels.</span></span>

![diagramma delle coordinate di trama 0,0 e 1,0 al confine tra i Texel](images/ptsmpprb.png)

<span data-ttu-id="3af50-135">Si noti che le coordinate di trama 0,0 e 1,0 per questa illustrazione sono esattamente al confine tra i Texel.</span><span class="sxs-lookup"><span data-stu-id="3af50-135">Notice that the texture coordinates, 0.0 and 1.0 for this illustration, are exactly at the boundary between texels.</span></span> <span data-ttu-id="3af50-136">Utilizzando il metodo in base al quale Direct3D esegue il mapping dei valori, le coordinate di trama variano da \[ -0,5, 4-0,5 \] , dove 4 è la larghezza della trama.</span><span class="sxs-lookup"><span data-stu-id="3af50-136">Using the method by which Direct3D maps values, the texture coordinates range from \[ - 0.5, 4 - 0.5\], where 4 is the width of the texture.</span></span> <span data-ttu-id="3af50-137">Per questo caso, il Texel campione è il Texel 0 per un indice di trama 1,0.</span><span class="sxs-lookup"><span data-stu-id="3af50-137">For this case, the sampled texel is the 0 texel for a texture index of 1.0.</span></span> <span data-ttu-id="3af50-138">Tuttavia, se la coordinata di trama era solo leggermente inferiore a 1,0, il Texel campione sarebbe il Texel n anziché il Texel 0.</span><span class="sxs-lookup"><span data-stu-id="3af50-138">However, if the texture coordinate was only slightly less than 1.0, the sampled texel would be the n texel instead of the 0 texel.</span></span>

<span data-ttu-id="3af50-139">L'implicazione è che l'ingrandimento di una trama di piccole dimensioni usando le coordinate di trama esattamente 0,0 e 1,0 con il filtro del punto più vicino in un triangolo allineato allo spazio dello schermo restituisce pixel per i quali viene campionata la mappa di trama al confine tra i Texel.</span><span class="sxs-lookup"><span data-stu-id="3af50-139">The implication of this is that magnifying a small texture using texture coordinates of exactly 0.0 and 1.0 with nearest-point filtering on a screen-space aligned triangle results in pixels for which the texture map is sampled at the boundary between texels.</span></span> <span data-ttu-id="3af50-140">Eventuali inesattezze nel calcolo di coordinate di trama, tuttavia di dimensioni ridotte, generano artefatti lungo le aree dell'immagine di cui è stato eseguito il rendering che corrispondono ai bordi Texel della mappa di trama.</span><span class="sxs-lookup"><span data-stu-id="3af50-140">Any inaccuracies in the computation of texture coordinates, however small, results in artifacts along the areas in the rendered image which correspond to the texel edges of the texture map.</span></span>

<span data-ttu-id="3af50-141">L'esecuzione di questo mapping delle coordinate di trama a virgola mobile a Texel di tipo integer con accuratezza perfetta è un'operazione complessa, che richiede molto tempo e non è in genere necessaria.</span><span class="sxs-lookup"><span data-stu-id="3af50-141">Performing this mapping of floating point texture coordinates to integer texels with perfect accuracy is difficult, computationally time-consuming, and generally not necessary.</span></span> <span data-ttu-id="3af50-142">La maggior parte delle implementazioni hardware usa un approccio iterativo per calcolare le coordinate di trama in ogni posizione dei pixel all'interno di un triangolo.</span><span class="sxs-lookup"><span data-stu-id="3af50-142">Most hardware implementations use an iterative approach for computing texture coordinates at each pixel location within a triangle.</span></span> <span data-ttu-id="3af50-143">Gli approcci iterativi tendono a nascondere queste imprecisioni perché gli errori vengono accumulati uniformemente durante l'iterazione.</span><span class="sxs-lookup"><span data-stu-id="3af50-143">Iterative approaches tend to hide these inaccuracies because the errors are accumulated evenly during iteration.</span></span>

<span data-ttu-id="3af50-144">L'rasterizzazione dei riferimenti Direct3D usa un approccio di valutazione diretta per il calcolo degli indici di trama in ogni posizione dei pixel.</span><span class="sxs-lookup"><span data-stu-id="3af50-144">The Direct3D reference rasterizer uses a direct-evaluation approach for computing texture indexes at each pixel location.</span></span> <span data-ttu-id="3af50-145">La valutazione diretta differisce dall'approccio iterativo in quanto qualsiasi inesattezza nell'operazione presenta una distribuzione degli errori più casuale.</span><span class="sxs-lookup"><span data-stu-id="3af50-145">Direct evaluation differs from the iterative approach in that any inaccuracy in the operation exhibits a more random error distribution.</span></span> <span data-ttu-id="3af50-146">Il risultato è che gli errori di campionamento che si verificano ai limiti possono essere più evidenti perché l'rasterizzazione dei riferimenti non esegue questa operazione con una precisione perfetta.</span><span class="sxs-lookup"><span data-stu-id="3af50-146">The result of this is that the sampling errors that occur at the boundaries can be more noticeable because the reference rasterizer does not perform this operation with perfect accuracy.</span></span>

<span data-ttu-id="3af50-147">L'approccio migliore consiste nell'usare il filtro dei punti più vicini solo quando necessario.</span><span class="sxs-lookup"><span data-stu-id="3af50-147">The best approach is to use nearest-point filtering only when necessary.</span></span> <span data-ttu-id="3af50-148">Quando è necessario usarlo, è consigliabile sfalsare leggermente le coordinate di trama dalle posizioni dei limiti per evitare gli artefatti.</span><span class="sxs-lookup"><span data-stu-id="3af50-148">When you must use it, it is recommended that you offset texture coordinates slightly from the boundary positions to avoid artifacts.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3af50-149">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3af50-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3af50-150">Filtraggio trama</span><span class="sxs-lookup"><span data-stu-id="3af50-150">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
