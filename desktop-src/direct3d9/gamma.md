---
description: Il contenuto della trama viene spesso archiviato in formato sRGB.
ms.assetid: d076140d-3e91-412a-b099-9baa52f8d7d8
title: Gamma (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4cea4b3ba224452e1c3be8f96b7136f4e4f649c8
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/06/2021
ms.locfileid: "106303679"
---
# <a name="gamma-direct3d-9"></a><span data-ttu-id="0b3d8-103">Gamma (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="0b3d8-103">Gamma (Direct3D 9)</span></span>

<span data-ttu-id="0b3d8-104">Il contenuto della trama viene spesso archiviato in formato sRGB.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-104">Texture content is often stored in sRGB format.</span></span> <span data-ttu-id="0b3d8-105">Tradizionalmente, le pipeline di pixel presumevano che i colori fossero lineari, quindi le operazioni di fusione venivano eseguite nello spazio lineare.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-105">Traditionally, pixel pipelines assumed the colors to be linear so blending operations were performed in linear space.</span></span> <span data-ttu-id="0b3d8-106">Tuttavia, poiché il contenuto sRGB è con correzione gamma, le operazioni di fusione nello spazio lineare producono risultati non corretti.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-106">However, since sRGB content is gamma corrected, blending operations in linear space will produce incorrect results.</span></span> <span data-ttu-id="0b3d8-107">Le schede video possono ora risolvere questo problema annullando la correzione gamma quando leggono qualsiasi contenuto sRGB e convertono i dati dei pixel nel formato sRGB quando scrivono i pixel.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-107">Video cards can now fix this problem by undoing the gamma correction when they read any sRGB content, and convert pixel data back to the sRGB format when writing out pixels.</span></span> <span data-ttu-id="0b3d8-108">In questo caso, tutte le operazioni all'interno della pipeline pixel vengono eseguite nello spazio lineare.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-108">In this case, all operations inside the pixel pipeline are performed in the linear space.</span></span>

## <a name="gamma-correction"></a><span data-ttu-id="0b3d8-109">Correzione gamma</span><span class="sxs-lookup"><span data-stu-id="0b3d8-109">Gamma Correction</span></span>

<span data-ttu-id="0b3d8-110">Direct3D 9 può:</span><span class="sxs-lookup"><span data-stu-id="0b3d8-110">Direct3D 9 can:</span></span>

-   <span data-ttu-id="0b3d8-111">Indica se una trama è di gamma 2,2 con correzione o meno (sRGB o meno).</span><span class="sxs-lookup"><span data-stu-id="0b3d8-111">Indicate whether a texture is gamma 2.2 corrected or not (sRGB or not).</span></span> <span data-ttu-id="0b3d8-112">Il driver eseguirà la conversione a una gamma lineare per le operazioni di fusione in fase di distrama oppure il campionatore lo convertirà in dati lineari al momento della ricerca.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-112">The driver will either convert to a linear gamma for blending operations at SetTexture time, or the sampler will convert it to linear data at lookup time.</span></span>
-   <span data-ttu-id="0b3d8-113">Consente di indicare se la pipeline di pixel deve restituire una gamma di correzione allo spazio sRGB durante la scrittura nella destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-113">Indicate whether the pixel pipeline should gamma correct back to sRGB space when writing out to the render target.</span></span>

<span data-ttu-id="0b3d8-114">Tutti gli altri colori (colore chiaro, colore del materiale, colore del vertice e così via) si presume siano nello spazio lineare.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-114">All other colors (clear color, material color, vertex color, etc.) are assumed to be in linear space.</span></span> <span data-ttu-id="0b3d8-115">Le applicazioni possono correggere la gamma dei colori scritti nel buffer dei frame usando le istruzioni pixel shader.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-115">Applications can gamma-correct the colors written into the frame buffer using pixel shader instructions.</span></span> <span data-ttu-id="0b3d8-116">La linearizzazione deve essere applicata solo ai canali RGB e non al canale alfa.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-116">The linearization should be applied only to the RGB channels and not to the alpha channel.</span></span>

<span data-ttu-id="0b3d8-117">Non è possibile linearizzare tutti i formati di superficie.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-117">Not all surface formats can be linearized.</span></span> <span data-ttu-id="0b3d8-118">È possibile linearizzare solo i formati che passano [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) con D3DUSAGE \_ query \_ SRGBREAD.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-118">Only the formats that pass [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with D3DUSAGE\_QUERY\_SRGBREAD can be linearized.</span></span> <span data-ttu-id="0b3d8-119">Lo stato del campionatore D3DSAMP \_ SRGBTEXTURE viene ignorato per il resto.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-119">The sampler state D3DSAMP\_SRGBTEXTURE is ignored for the rest.</span></span> <span data-ttu-id="0b3d8-120">Per supportare questa conversione sono previsti solo formati di trama senza segno.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-120">Only unsigned texture formats are expected to support this conversion.</span></span> <span data-ttu-id="0b3d8-121">I formati di trama senza segno includono solo i componenti R, G, B e L.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-121">Unsigned texture formats include only R, G, B, and L components.</span></span> <span data-ttu-id="0b3d8-122">Se il canale alfa è presente, viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-122">If the alpha channel is present, it is ignored.</span></span> <span data-ttu-id="0b3d8-123">Se i formati misti supportano la linearizzazione sRGB, saranno interessati solo i canali senza segno.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-123">If mixed formats support sRGB linearization, only the unsigned channels are affected.</span></span> <span data-ttu-id="0b3d8-124">Idealmente, l'hardware deve eseguire la linearizzazione prima di filtrare, ma in Direct3D 9 l'hardware può eseguire la linearizzazione dopo il filtro.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-124">Ideally, hardware should perform the linearization before filtering but in Direct3D 9, hardware is allowed to perform the linearization after filtering.</span></span>

<span data-ttu-id="0b3d8-125">Non tutti i formati di superficie possono essere scritti nello spazio sRGB.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-125">Not all surface formats can be written in sRGB space.</span></span> <span data-ttu-id="0b3d8-126">È possibile linearizzare solo i formati che passano il [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) con il flag di utilizzo D3DUSAGE \_ query \_ SRGBWRITE.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-126">Only the formats that pass the [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with the usage flag D3DUSAGE\_QUERY\_SRGBWRITE can be linearized.</span></span> <span data-ttu-id="0b3d8-127">Lo stato di rendering D3DRS \_ SRGBWRITEENABLE viene ignorato per il resto.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-127">The render state D3DRS\_SRGBWRITEENABLE is ignored for the rest.</span></span> <span data-ttu-id="0b3d8-128">Per esporre questa possibilità, è previsto che i formati RGB non firmati di otto bit per canale siano esposte.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-128">Eight bits per channel RGB unsigned formats are expected to expose this ability.</span></span>

<span data-ttu-id="0b3d8-129">Idealmente, l'hardware deve eseguire le operazioni di fusione del buffer dei frame nello spazio lineare, ma l'hardware è autorizzato a eseguirlo dopo il pixel shader ma prima di frame buffer Blender.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-129">Ideally, hardware should perform the frame buffer blending operations in the linear space, but hardware is allowed to perform it after the pixel shader but before the frame buffer blender.</span></span> <span data-ttu-id="0b3d8-130">Ciò significa che le operazioni di fusione del buffer dei frame che avvengono nello spazio sRGB produrranno risultati non corretti.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-130">This means that the frame buffer blending operations that take place in sRGB space will produce incorrect results.</span></span> <span data-ttu-id="0b3d8-131">D3DRS \_ SRGBWRITEENABLE viene rispettato durante l'esecuzione di una cancellazione della destinazione di rendering.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-131">D3DRS\_SRGBWRITEENABLE is honored while performing a clear of the render target.</span></span> <span data-ttu-id="0b3d8-132">Per l'hardware che supporta [più destinazioni di rendering (Direct3D 9)](multiple-render-targets.md) o [trame a più elementi (Direct3D 9)](multiple-element-textures.md), viene scritta solo la prima destinazione di rendering o elemento.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-132">For hardware that supports [Multiple Render Targets (Direct3D 9)](multiple-render-targets.md) or [Multiple-element Textures (Direct3D 9)](multiple-element-textures.md), only the first render target or element is written.</span></span>

### <a name="api-changes"></a><span data-ttu-id="0b3d8-133">Modifiche API</span><span class="sxs-lookup"><span data-stu-id="0b3d8-133">API Changes</span></span>


```
// New sampler state (DWORD)
// If this is nonzero, the texture is linearized on lookup.
D3DSAMP_SRGBTEXTURE       // Default FALSE

// New render state (DWORD)
D3DRS_SRGBWRITEENABLE     // Default FALSE

// New usage flags
D3DUSAGE_QUERY_SRGBWRITE
D3DUSAGE_QUERY_SRGBREAD
```



### <a name="windowed-swap-chains"></a><span data-ttu-id="0b3d8-134">Catene di scambio finestra</span><span class="sxs-lookup"><span data-stu-id="0b3d8-134">Windowed Swap Chains</span></span>

<span data-ttu-id="0b3d8-135">È importante che le applicazioni mantengano i buffer indietro delle catene di scambio nello spazio lineare per consentire le operazioni di fusione corrette.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-135">It is valuable for applications to keep the back buffers of their swap chains in linear space in order to enable correct blending operations.</span></span> <span data-ttu-id="0b3d8-136">Poiché il desktop in genere non è nello spazio lineare, è necessaria una correzione gamma prima che sia possibile presentare il contenuto del buffer nascosto.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-136">Since the desktop is typically not in linear space, a gamma correction is required before the contents of the back buffer can be presented.</span></span> <span data-ttu-id="0b3d8-137">L'applicazione può applicare questa correzione allocando un buffer aggiuntivo ed eseguendo la propria copia di correzione dal buffer lineare al buffer nascosto.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-137">The application can effect this correction itself by allocating an additional buffer and performing its own correcting copy from the linear buffer to the back buffer.</span></span> <span data-ttu-id="0b3d8-138">Questa operazione richiede una copia aggiuntiva che può essere evitata se il driver esegue la correzione gamma come parte del blit di presentazione.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-138">This necessitates an extra copy which can be avoided if the driver performs gamma correction as part of the presentation blit.</span></span>

<span data-ttu-id="0b3d8-139">In Direct3D 9 è disponibile un nuovo flag, [D3DPRESENT \_ Linear \_ Content](d3dpresent.md) [**, che consente alla presentazione di eseguire**](/windows/desktop/api) la conversione implicita dallo spazio lineare a sRGB/gamma 2,2.</span><span class="sxs-lookup"><span data-stu-id="0b3d8-139">In Direct3D 9 a new flag, [D3DPRESENT\_LINEAR\_CONTENT](d3dpresent.md), is available for [**Present**](/windows/desktop/api) that allows the presentation to implicitly convert from linear space to sRGB/gamma 2.2.</span></span> <span data-ttu-id="0b3d8-140">Le applicazioni devono specificare questo flag se il formato backBuffer è a virgola mobile a 16 bit per abbinare la modalità a finestra presente al comportamento gamma a schermo intero, purché \_ \_ \_ venga restituita la presentazione D3DCAPS3 lineare a sRGB \_ per le funzionalità del dispositivo recuperate tramite [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span><span class="sxs-lookup"><span data-stu-id="0b3d8-140">Applications should specify this flag if the backbuffer format is 16-bit floating point in order to match windowed mode present to full screen gamma behavior, provided D3DCAPS3\_LINEAR\_TO\_SRGB\_PRESENTATION is returned for device capabilities retrieved through [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span></span>

## <a name="related-topics"></a><span data-ttu-id="0b3d8-141">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="0b3d8-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0b3d8-142">Buffer frame</span><span class="sxs-lookup"><span data-stu-id="0b3d8-142">Frame Buffer</span></span>](frame-buffer.md)
</dt> </dl>

 

 
