---
title: Registrazione dell'oggetto COM del menu di scelta rapida in un identificatore di visualizzazione
description: In questo argomento vengono illustrate le chiavi del registro di sistema che devono essere modificate per registrare un oggetto COM del menu di scelta rapida.
ms.assetid: 389bc249-4849-4763-9d1b-b35598a51050
ms.tgt_platform: multiple
keywords:
- Registrazione dell'oggetto COM del menu di scelta rapida in un identificatore di visualizzazione
- ANNUNCIO dell'oggetto COM del menu di scelta rapida, registrazione
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62ae30c1a60a1a0bc5a8ec388a3578ab13829c95
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "104046491"
---
# <a name="registering-the-context-menu-com-object-in-a-display-specifier"></a><span data-ttu-id="f0d11-105">Registrazione dell'oggetto COM del menu di scelta rapida in un identificatore di visualizzazione</span><span class="sxs-lookup"><span data-stu-id="f0d11-105">Registering the Context Menu COM Object in a Display Specifier</span></span>

<span data-ttu-id="f0d11-106">Quando si utilizza COM per creare una DLL di estensione del menu di scelta rapida per un servizio di Active Directory directory, l'estensione deve essere registrata con il registro di sistema di Windows e Active Directory Domain Services per inviare una notifica ai Active Directory snap-in MMC amministrativi e la shell di Windows dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="f0d11-106">When you use COM to create a context menu extension DLL for an Active Directory directory service, the extension must be registered with the Windows registry and Active Directory Domain Services to notify the Active Directory administrative MMC snap-ins and the Windows shell of the extension.</span></span>

## <a name="registering-in-the-windows-registry"></a><span data-ttu-id="f0d11-107">Registrazione nel registro di sistema di Windows</span><span class="sxs-lookup"><span data-stu-id="f0d11-107">Registering in the Windows Registry</span></span>

<span data-ttu-id="f0d11-108">Come tutti i server COM, un'estensione del menu di scelta rapida deve essere registrata nel registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="f0d11-108">Like all COM servers, a context menu extension must be registered in the registry.</span></span> <span data-ttu-id="f0d11-109">L'estensione viene registrata con la chiave seguente.</span><span class="sxs-lookup"><span data-stu-id="f0d11-109">The extension is registered under the following key.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      <clsid>
```

<span data-ttu-id="f0d11-110">*<clsid>* rappresentazione di stringa del CLSID come prodotto dalla funzione [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="f0d11-110">*<clsid>* is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="f0d11-111">Sotto la *<clsid>* chiave è presente una chiave **InprocServer32** che identifica l'oggetto come server in-process a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="f0d11-111">Under the *<clsid>* key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="f0d11-112">Nella chiave **InprocServer32** il percorso della dll viene specificato nel valore predefinito e il modello di Threading viene specificato nel valore **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="f0d11-112">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="f0d11-113">Per tutte le estensioni del menu di scelta rapida è necessario utilizzare il modello di threading "Apartment".</span><span class="sxs-lookup"><span data-stu-id="f0d11-113">All context menu extension must use the "Apartment" threading model.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="f0d11-114">Registrazione con Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="f0d11-114">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="f0d11-115">La registrazione dell'estensione del menu di scelta rapida è specifica di un'impostazione locale.</span><span class="sxs-lookup"><span data-stu-id="f0d11-115">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="f0d11-116">Se l'estensione del menu di scelta rapida si applica a tutte le impostazioni locali, deve essere registrata nell'oggetto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) della classe di oggetti in tutti i sottocontenitori delle impostazioni locali nel contenitore degli identificatori di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="f0d11-116">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="f0d11-117">Se l'estensione del menu di scelta rapida è localizzata per determinate impostazioni locali, è necessario registrarla nell'oggetto **displaySpecifier** del sottocontenitore delle impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="f0d11-117">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="f0d11-118">Per ulteriori informazioni sul contenitore e le impostazioni locali per gli identificatori di visualizzazione, vedere la pagina relativa agli [identificatori di visualizzazione](display-specifiers.md) e al [contenitore DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="f0d11-118">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="f0d11-119">Sono disponibili due attributi dell'identificatore di visualizzazione in cui è possibile registrare un elemento di estensione del menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f0d11-119">There are two display specifier attributes that a context menu extension item can be registered under.</span></span> <span data-ttu-id="f0d11-120">Si tratta di [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="f0d11-120">These are [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="f0d11-121">L'attributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica i menu di scelta rapida amministrativi da visualizzare in Active Directory snap-in amministrativi. Il menu di scelta rapida viene visualizzato quando l'utente Visualizza il menu di scelta rapida per gli oggetti della classe appropriata in uno dei Active Directory snap-in MMC amministrativi.</span><span class="sxs-lookup"><span data-stu-id="f0d11-121">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in Active Directory administrative snap-ins. The context menu appears when the user displays the context menu for objects of the appropriate class in one of the Active Directory administrative MMC snap-ins.</span></span>

<span data-ttu-id="f0d11-122">L'attributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica i menu di scelta rapida dell'utente finale da visualizzare nella shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="f0d11-122">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="f0d11-123">Il menu di scelta rapida viene visualizzato quando l'utente Visualizza il menu di scelta rapida per gli oggetti della classe appropriata in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="f0d11-123">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="f0d11-124">A partire da Windows Server 2003, la shell di Windows non Visualizza più gli oggetti di Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="f0d11-124">Beginning with Windows Server 2003, the Windows shell no longer displays objects of Active Directory Domain Services.</span></span>

<span data-ttu-id="f0d11-125">Tutti questi attributi sono multivalore.</span><span class="sxs-lookup"><span data-stu-id="f0d11-125">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="f0d11-126">Quando si registra un'estensione del menu di scelta rapida, i valori per gli attributi [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) richiedono il formato seguente.</span><span class="sxs-lookup"><span data-stu-id="f0d11-126">When registering a context menu extension, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<clsid>
```



<span data-ttu-id="f0d11-127">Il " &lt; numero di ordine &gt; " è un numero senza segno che rappresenta la posizione dell'elemento nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f0d11-127">The "&lt;order number&gt;" is an unsigned number that represents the item position in the context menu.</span></span> <span data-ttu-id="f0d11-128">Quando viene visualizzato un menu di scelta rapida, i valori vengono ordinati usando un confronto tra il " &lt; numero di ordine" di ogni valore &gt; .</span><span class="sxs-lookup"><span data-stu-id="f0d11-128">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="f0d11-129">Se più di un valore ha lo stesso " &lt; numero &gt; di ordine", le estensioni del menu di scelta rapida vengono caricate nell'ordine in cui vengono lette dal server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f0d11-129">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="f0d11-130">Se possibile, usare un " &lt; numero di ordine" non esistente &gt; , ovvero uno che non è stato usato da altri valori nella proprietà.</span><span class="sxs-lookup"><span data-stu-id="f0d11-130">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="f0d11-131">Non sono consentite posizioni iniziali e gap nella &lt; sequenza "Order Number &gt; ".</span><span class="sxs-lookup"><span data-stu-id="f0d11-131">There is no prescribed starting position and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="f0d11-132">" &lt; CLSID &gt; " è la rappresentazione di stringa del CLSID come prodotto dalla funzione [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="f0d11-132">The "&lt;clsid&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

<span data-ttu-id="f0d11-133">Nella shell di Windows sono supportate le voci del menu di scelta rapida a selezione multipla.</span><span class="sxs-lookup"><span data-stu-id="f0d11-133">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="f0d11-134">In questo caso, l'estensione del menu di scelta rapida viene richiamata per ogni oggetto selezionato.</span><span class="sxs-lookup"><span data-stu-id="f0d11-134">In this case, the context menu extension is invoked for each selected object.</span></span> <span data-ttu-id="f0d11-135">In Active Directory snap-in amministrazione sono supportati anche gli elementi di estensione del menu di scelta rapida a selezione multipla.</span><span class="sxs-lookup"><span data-stu-id="f0d11-135">In Active Directory administrative snap-ins, multiple-selection context menu extension items are also supported.</span></span> <span data-ttu-id="f0d11-136">In questo caso, la struttura [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) conterrà una struttura [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) per ogni oggetto directory selezionato.</span><span class="sxs-lookup"><span data-stu-id="f0d11-136">In this case, the [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) structure will contain a [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structure for each directory object selected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f0d11-137">Per la shell di Windows, le informazioni sugli identificatori di visualizzazione vengono recuperate all'accesso dell'utente e memorizzate nella cache per la sessione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f0d11-137">For the Windows shell, display specifier information is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="f0d11-138">Per gli snap-in amministrativi, i dati dell'identificatore di visualizzazione vengono recuperati quando lo snap-in viene caricato e viene memorizzato nella cache per la durata del processo.</span><span class="sxs-lookup"><span data-stu-id="f0d11-138">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="f0d11-139">Per la shell di Windows, ciò significa che le modifiche apportate agli identificatori di visualizzazione diventano effettive dopo che un utente si disconnette e si riaccende.</span><span class="sxs-lookup"><span data-stu-id="f0d11-139">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="f0d11-140">Per gli snap-in amministrativi, le modifiche diventano effettive quando lo snap-in o il file della console viene ricaricato, ovvero se si avvia una nuova istanza del file di console o di una nuova istanza di Mmc.exe e si aggiunge lo snap-in, vengono recuperati i dati più recenti dell'identificatore di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="f0d11-140">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded, that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="f0d11-141">Per ulteriori informazioni e un esempio di codice relativo all'implementazione di un'estensione del menu di scelta rapida, vedere [codice di esempio per l'implementazione dell'oggetto com del menu di scelta rapida](example-code-for-implementation-of-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="f0d11-141">For more information, and a code example of how to implement a context menu extension, see [Example Code for Implementation of the Context Menu COM Object](example-code-for-implementation-of-the-context-menu-com-object.md).</span></span>

 

 