---
title: Lettura di un set di diritti di accesso di controllo nell'ACL di un oggetto
description: Le proprietà dell'interfaccia IADsAccessControlEntry vengono usate per concedere o negare i diritti di accesso del controllo.
ms.assetid: 2c6fef91-990e-4954-9aff-c9ec72d13972
ms.tgt_platform: multiple
keywords:
- Lettura di un set di diritti di accesso di controllo nell'ACL di un oggetto Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4877c96a95fc94095c79ad129e8a07b1c786abe1
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "104046495"
---
# <a name="reading-a-control-access-right-set-in-an-objects-acl"></a><span data-ttu-id="2536f-104">Lettura di un set di diritti di accesso di controllo nell'ACL di un oggetto</span><span class="sxs-lookup"><span data-stu-id="2536f-104">Reading a Control Access Right Set in an Object's ACL</span></span>

<span data-ttu-id="2536f-105">Utilizzando ADSI, è possibile leggere un controllo ACE right Access Right come qualsiasi altra voce ACE in un ACL.</span><span class="sxs-lookup"><span data-stu-id="2536f-105">Using ADSI, you read a control access right ACE just as you would any other ACE in an ACL.</span></span> <span data-ttu-id="2536f-106">Tenere presente che è inoltre possibile utilizzare le API di sicurezza Win32 per leggere gli ACL negli oggetti directory.</span><span class="sxs-lookup"><span data-stu-id="2536f-106">Be aware that you can also use the Win32 security APIs to read ACLs on directory objects.</span></span> <span data-ttu-id="2536f-107">Tuttavia, i diritti di accesso di controllo usano le proprietà dell'interfaccia [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) in modo specifico per concedere e negare i diritti di accesso di controllo:</span><span class="sxs-lookup"><span data-stu-id="2536f-107">However, control access rights use the properties of the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface in a manner that is specific to granting and denying control access rights:</span></span>

-   <span data-ttu-id="2536f-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) deve contenere gli **annunci di \_ \_ controllo DS Rights \_ \_ Access**.</span><span class="sxs-lookup"><span data-stu-id="2536f-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) must contain **ADS\_RIGHT\_DS\_CONTROL\_ACCESS**.</span></span>
-   <span data-ttu-id="2536f-109">Il valore di [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) è il **tipo di \_ oggetto flag Ads \_ \_ \_ presente**.</span><span class="sxs-lookup"><span data-stu-id="2536f-109">[**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value is **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**.</span></span>
-   <span data-ttu-id="2536f-110">[**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) è il formato stringa dell'attributo **rightsGuid** del diritto di accesso del controllo.</span><span class="sxs-lookup"><span data-stu-id="2536f-110">[**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the string form of the **rightsGUID** attribute of the control access right.</span></span> <span data-ttu-id="2536f-111">Il formato della stringa del GUID è lo stesso formato della stringa della funzione della libreria COM [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) .</span><span class="sxs-lookup"><span data-stu-id="2536f-111">The string format of the GUID is the same string format as the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) COM Library function.</span></span>
-   <span data-ttu-id="2536f-112">[**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) è l' **\_ oggetto AceType \_ di \_ accesso \_ consentito ADS** per concedere al trustee il diritto di accesso di controllo o l' **\_ \_ \_ \_ oggetto accesso negato di ADS AceType** per negare al trustee il diritto di accesso del controllo.</span><span class="sxs-lookup"><span data-stu-id="2536f-112">[**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is either **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the trustee the control access right.</span></span>
-   <span data-ttu-id="2536f-113">Il [**trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) è l'entità di sicurezza. ovvero l'utente, il gruppo, il computer e così via, a cui si applica la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-113">[**Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the security principal; that is the user, group, computer, and so on, to which the ACE applies.</span></span>

<span data-ttu-id="2536f-114">Utilizzare la seguente procedura per leggere una voce ACE per un oggetto ADSI.</span><span class="sxs-lookup"><span data-stu-id="2536f-114">Use the following procedure to read an ACE for an ADSI object.</span></span> <span data-ttu-id="2536f-115">La procedura seguente si applica alle applicazioni C e C++.</span><span class="sxs-lookup"><span data-stu-id="2536f-115">The following procedure applies to C and C++ applications.</span></span>

<span data-ttu-id="2536f-116">**Per leggere una voce ACE per un oggetto ADSI**</span><span class="sxs-lookup"><span data-stu-id="2536f-116">**To read an ACE for an ADSI object**</span></span>

1.  <span data-ttu-id="2536f-117">Ottiene un puntatore di interfaccia [**IADs**](/windows/desktop/api/iads/nn-iads-iads) all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2536f-117">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="2536f-118">Usare il metodo [**IADs:: Get**](/windows/desktop/api/iads/nf-iads-iads-get) per ottenere il descrittore di sicurezza dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2536f-118">Use the [**IADs::Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="2536f-119">Il nome della proprietà che contiene il descrittore di sicurezza è "nTSecurityDescriptor".</span><span class="sxs-lookup"><span data-stu-id="2536f-119">The name of the property that contains the security descriptor is "nTSecurityDescriptor".</span></span> <span data-ttu-id="2536f-120">La proprietà verrà restituita come **variante** che contiene un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="2536f-120">The property will be returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="2536f-121">Tenere presente che il membro **VT** è **VT \_ Dispatch**.</span><span class="sxs-lookup"><span data-stu-id="2536f-121">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="2536f-122">Chiamare **QueryInterface** su tale puntatore **IDispatch** per ottenere un'interfaccia [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) per usare i metodi su tale interfaccia per accedere all'ACL del descrittore di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="2536f-122">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor ACL.</span></span>
3.  <span data-ttu-id="2536f-123">Usare il metodo [**IADsSecurityDescriptor:: Get \_ DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) per ottenere l'ACL.</span><span class="sxs-lookup"><span data-stu-id="2536f-123">Use the [**IADsSecurityDescriptor::get\_DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) method to get the ACL.</span></span> <span data-ttu-id="2536f-124">Il metodo restituisce un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="2536f-124">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="2536f-125">Chiamare **QueryInterface** su tale puntatore **IDispatch** per ottenere un'interfaccia [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) per usare i metodi su tale interfaccia per accedere alle singole voci ACE nell'ACL.</span><span class="sxs-lookup"><span data-stu-id="2536f-125">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="2536f-126">Usare il metodo [**IADsAccessControlList:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) per enumerare le voci ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-126">Use the [**IADsAccessControlList::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) method to enumerate the ACEs.</span></span> <span data-ttu-id="2536f-127">Il metodo restituisce un puntatore [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="2536f-127">The method returns an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer.</span></span> <span data-ttu-id="2536f-128">Chiamare **QueryInterface** su quel puntatore **IUnknown** per ottenere un'interfaccia [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) .</span><span class="sxs-lookup"><span data-stu-id="2536f-128">Call **QueryInterface** on that **IUnknown** pointer to get an [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) interface.</span></span>
5.  <span data-ttu-id="2536f-129">Usare il metodo [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) per enumerare le voci ACE nell'ACL.</span><span class="sxs-lookup"><span data-stu-id="2536f-129">Use the [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) method to enumerate the ACEs in the ACL.</span></span> <span data-ttu-id="2536f-130">La proprietà viene restituita come **variante** che contiene un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="2536f-130">The property is returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="2536f-131">Tenere presente che il membro **VT** è **VT \_ Dispatch**.</span><span class="sxs-lookup"><span data-stu-id="2536f-131">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="2536f-132">Chiamare **QueryInterface** su tale puntatore **IDispatch** per ottenere un'interfaccia [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) per leggere la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-132">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface to read the ACE.</span></span>
6.  <span data-ttu-id="2536f-133">Chiamare il [**Metodo IADsAccessControlEntry:: Get \_ accessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per ottenere **accessMask** e verificare che il valore di **accessMask** per il flag di **\_ \_ \_ \_ accesso di controllo DS Rights ADS** .</span><span class="sxs-lookup"><span data-stu-id="2536f-133">Call the [**IADsAccessControlEntry::get\_AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the **AccessMask** and verify that the **AccessMask** value for the **ADS\_RIGHT\_DS\_CONTROL\_ACCESS** flag.</span></span> <span data-ttu-id="2536f-134">Se dispone di questo flag, la voce ACE contiene un diritto di accesso al controllo.</span><span class="sxs-lookup"><span data-stu-id="2536f-134">If it has this flag, the ACE contains a control access right.</span></span>
7.  <span data-ttu-id="2536f-135">Chiamare il metodo [**IADsAccessControlEntry:: Get \_ Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per ottenere il flag per il tipo di oggetto.</span><span class="sxs-lookup"><span data-stu-id="2536f-135">Call the [**IADsAccessControlEntry::get\_Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the flag for the object type.</span></span>
8.  <span data-ttu-id="2536f-136">Flag [**di controllo del**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) valore per il **tipo di oggetto flag ADS del flag \_ \_ \_ \_ present** .</span><span class="sxs-lookup"><span data-stu-id="2536f-136">Check [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value for **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT** flag.</span></span> <span data-ttu-id="2536f-137">Se **Flags** è impostato **sul \_ tipo di oggetto flag Ads \_ \_ \_ presente**, chiamare il metodo **IADsAccessControlEntry:: Get \_ ObjectType** per ottenere una stringa che contiene il RightsGUID del diritto di accesso al controllo a cui si applica la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-137">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, call the **IADsAccessControlEntry::get\_ObjectType** method to get a string that contains the rightsGUID of the control access right that the ACE applies to.</span></span>
9.  <span data-ttu-id="2536f-138">Chiamare il metodo [**IADsAccessControlEntry:: Get \_ AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per ottenere il tipo ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-138">Call the [**IADsAccessControlEntry::get\_AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the ACE type.</span></span> <span data-ttu-id="2536f-139">Il tipo sarà un **oggetto Ads \_ ACETYPE \_ Access \_ allowed \_** per concedere al trustee il diritto di accesso di controllo o l' **\_ oggetto ADS ACETYPE \_ accesso \_ negato \_** per negare il diritto di accesso al controllo.</span><span class="sxs-lookup"><span data-stu-id="2536f-139">The type will be an **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the control access right.</span></span>
10. <span data-ttu-id="2536f-140">Chiamare il metodo [**IADsAccessControlEntry:: Get \_ trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per ottenere l'entità di sicurezza, ovvero utente, gruppo, computer e così via a cui viene applicata la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="2536f-140">Call the [**IADsAccessControlEntry::get\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the security principal; that is user, group, computer, and so on to which the ACE applies.</span></span>
11. <span data-ttu-id="2536f-141">Al termine delle stringhe [**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) e **trustee** , usare [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) per liberare la memoria per tali stringhe.</span><span class="sxs-lookup"><span data-stu-id="2536f-141">When finished with the [**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) and **Trustee** strings, use [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) to free the memory for those strings.</span></span>
12. <span data-ttu-id="2536f-142">Al termine delle interfacce, chiamare **Release** per decrementare o rilasciare tutti i riferimenti all'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="2536f-142">When finished with the interfaces, call **Release** to decrement or release all the interface references.</span></span>

 

 