---
title: Enumerazione dei gruppi in un dominio
description: I gruppi possono essere inseriti in qualsiasi contenitore o unità organizzativa (OU) in un dominio e nella radice del dominio.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Enumerazione dei gruppi in un dominio Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724562"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="59d31-104">Enumerazione dei gruppi in un dominio</span><span class="sxs-lookup"><span data-stu-id="59d31-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="59d31-105">I gruppi possono essere inseriti in qualsiasi contenitore o unità organizzativa (OU) in un dominio e nella radice del dominio.</span><span class="sxs-lookup"><span data-stu-id="59d31-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="59d31-106">Ciò significa che i gruppi possono trovarsi in numerose posizioni nella gerarchia di directory.</span><span class="sxs-lookup"><span data-stu-id="59d31-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="59d31-107">Sono pertanto disponibili due opzioni per l'enumerazione dei gruppi:</span><span class="sxs-lookup"><span data-stu-id="59d31-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="59d31-108">Enumerare i gruppi direttamente contenuti in un contenitore, OU o alla radice del dominio.</span><span class="sxs-lookup"><span data-stu-id="59d31-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="59d31-109">Associare in modo esplicito all'oggetto contenitore contenente i gruppi da enumerare, impostare un filtro che contiene "gruppi" come classe usando la proprietà [**IADsContainer. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) e usare il metodo [**IADsContainer:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) per enumerare gli oggetti gruppo.</span><span class="sxs-lookup"><span data-stu-id="59d31-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="59d31-110">Questa tecnica enumera i gruppi contenuti direttamente in un contenitore o in un oggetto OU.</span><span class="sxs-lookup"><span data-stu-id="59d31-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="59d31-111">Se il contenitore contiene altri contenitori che possono potenzialmente contenere altri gruppi, è necessario associarli a tali contenitori ed enumerare in modo ricorsivo i gruppi in tali contenitori.</span><span class="sxs-lookup"><span data-stu-id="59d31-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="59d31-112">Per modificare gli oggetti gruppo e leggere solo proprietà specifiche, usare la ricerca completa descritta nell'opzione 2.</span><span class="sxs-lookup"><span data-stu-id="59d31-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="59d31-113">Poiché l'enumerazione restituisce i puntatori agli oggetti ADSI COM che rappresentano ciascun oggetto gruppo, è possibile chiamare [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per ottenere i puntatori all'interfaccia [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup)e [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) per l'oggetto gruppo. ovvero, è possibile ottenere i puntatori di interfaccia a ogni oggetto gruppo enumerato in un contenitore senza dover associare in modo esplicito a ogni oggetto gruppo.</span><span class="sxs-lookup"><span data-stu-id="59d31-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="59d31-114">Per eseguire operazioni su tutti i gruppi direttamente all'interno di un contenitore, l'enumerazione non richiede l'associazione a ogni gruppo per chiamare i metodi **IADs** o **IADsGroup** .</span><span class="sxs-lookup"><span data-stu-id="59d31-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="59d31-115">Per recuperare proprietà specifiche dai gruppi, usare [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) come descritto nella seconda opzione.</span><span class="sxs-lookup"><span data-stu-id="59d31-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="59d31-116">Un'eccezione a questo problema si verifica quando si tenta di enumerare un gruppo che contiene membri che sono entità di sicurezza rinomate, ad esempio tutti gli utenti autenticati, il BATCH e così via.</span><span class="sxs-lookup"><span data-stu-id="59d31-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="59d31-117">Poiché non è possibile eseguire il binding a questi tipi di oggetti, non vengono elencati quando si enumerano i gruppi nell'ambito WinNT, anche se può sembrare associato, perché determinati metodi IADs, ad esempio Class, ADsPath e Name, restituiscono risultati corretti quando vengono richiamati sui membri enumerati.</span><span class="sxs-lookup"><span data-stu-id="59d31-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="59d31-118">Eseguire una ricerca completa per "objectCategory = Group" per trovare tutti i gruppi in un albero.</span><span class="sxs-lookup"><span data-stu-id="59d31-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="59d31-119">Per prima cosa, eseguire l'associazione all'oggetto contenitore in cui iniziare la ricerca.</span><span class="sxs-lookup"><span data-stu-id="59d31-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="59d31-120">Ad esempio, per trovare tutti i gruppi in un dominio, effettuare l'associazione alla radice del dominio; per trovare tutti i gruppi nella foresta, effettuare l'associazione al catalogo globale e cercare dalla radice del GC.</span><span class="sxs-lookup"><span data-stu-id="59d31-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="59d31-121">Usare quindi [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) per eseguire una query usando un filtro di ricerca che contiene (objectCategory = Group) e la preferenza di ricerca del **\_ \_ sottoalbero con ambito ADS**.</span><span class="sxs-lookup"><span data-stu-id="59d31-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="59d31-122">È possibile eseguire una ricerca con una preferenza di ricerca **dell' \_ ambito Ads \_ unlivello** per limitare la ricerca ai contenuti diretti dell'oggetto contenitore associato.</span><span class="sxs-lookup"><span data-stu-id="59d31-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="59d31-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) recupera solo i valori di proprietà specifiche dai gruppi.</span><span class="sxs-lookup"><span data-stu-id="59d31-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="59d31-124">Per recuperare i valori, usare **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="59d31-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="59d31-125">Per modificare gli oggetti gruppo restituiti da una ricerca, ovvero per usare i metodi [**IADs**](/windows/desktop/api/iads/nn-iads-iads) o [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) , è possibile associarli in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="59d31-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="59d31-126">A tale scopo, specificare **Distinguishname** come una delle proprietà da restituire dalla ricerca e utilizzare i nomi distinti restituiti per eseguire l'associazione a ogni gruppo restituito nella ricerca.</span><span class="sxs-lookup"><span data-stu-id="59d31-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="59d31-127">Vengono recuperate solo le proprietà specifiche.</span><span class="sxs-lookup"><span data-stu-id="59d31-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="59d31-128">Non è possibile recuperare tutti gli attributi senza specificare in modo esplicito ogni possibile attributo della classe Group.</span><span class="sxs-lookup"><span data-stu-id="59d31-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 