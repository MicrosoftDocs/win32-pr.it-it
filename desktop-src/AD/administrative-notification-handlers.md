---
title: Gestori di notifiche amministrative
description: Lo snap-in MMC utenti e computer di Microsoft Active Directory fornisce un meccanismo per consentire ai componenti di ricevere notifiche quando l'utente Elimina, Rinomina, sposta o modifica le proprietà di un oggetto usando lo snap-in.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- Gestione notifiche amministrative AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baa6f48f8b56ab8e4a1d64d0fe15543bfee6c09e
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "103872330"
---
# <a name="administrative-notification-handlers"></a><span data-ttu-id="406d6-104">Gestori di notifiche amministrative</span><span class="sxs-lookup"><span data-stu-id="406d6-104">Administrative Notification Handlers</span></span>

<span data-ttu-id="406d6-105">Lo snap-in MMC utenti e computer di Microsoft Active Directory fornisce un meccanismo per consentire ai componenti di ricevere notifiche quando l'utente Elimina, Rinomina, sposta o modifica le proprietà di un oggetto usando lo snap-in.</span><span class="sxs-lookup"><span data-stu-id="406d6-105">The Microsoft Active Directory Users and Computers MMC snap-in provides a mechanism to enable components to receive notifications when the user deletes, renames, moves, or changes the properties of an object using the snap-in.</span></span> <span data-ttu-id="406d6-106">Il componente che riceve le notifiche è noto come "gestore notifiche".</span><span class="sxs-lookup"><span data-stu-id="406d6-106">The component that receives the notifications is known as a "notification handler".</span></span>

<span data-ttu-id="406d6-107">Questa operazione è utile quando più oggetti sono collegati tra loro e devono esistere nello stesso contenitore.</span><span class="sxs-lookup"><span data-stu-id="406d6-107">This is useful when multiple objects are linked together and must exist within the same container.</span></span> <span data-ttu-id="406d6-108">Se uno degli oggetti collegati viene spostato, viene fornita una notifica al gestore delle notifiche e il gestore delle notifiche può spostare gli altri oggetti collegati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="406d6-108">If one of the linked objects is moved, a notification is supplied to the notification handler and the notification handler can move the other linked objects to the same folder.</span></span>

<span data-ttu-id="406d6-109">Quando si esegue una delle operazioni e si installa uno o più gestori di notifiche, nello snap-in utenti e computer verrà visualizzata una finestra di dialogo di conferma in cui sono elencati i gestori delle notifiche e una casella di controllo per ogni gestore.</span><span class="sxs-lookup"><span data-stu-id="406d6-109">When one of the operations is performed and one or more notification handlers is installed, the Users and Computers snap-in will display a confirmation dialog box that lists the notification handlers and a check box for each handler.</span></span> <span data-ttu-id="406d6-110">Se è selezionata la casella di controllo per un gestore, viene inviata una notifica al gestore.</span><span class="sxs-lookup"><span data-stu-id="406d6-110">If the check box for a handler is selected, the handler is notified.</span></span> <span data-ttu-id="406d6-111">Se la casella di controllo non è selezionata, il gestore non riceve alcuna notifica.</span><span class="sxs-lookup"><span data-stu-id="406d6-111">If the check box is not selected, the handler is not notified.</span></span>

## <a name="implementing-a-notification-handler"></a><span data-ttu-id="406d6-112">Implementazione di un gestore notifiche</span><span class="sxs-lookup"><span data-stu-id="406d6-112">Implementing a Notification Handler</span></span>

<span data-ttu-id="406d6-113">Un gestore notifiche è un oggetto COM implementato come server in-process.</span><span class="sxs-lookup"><span data-stu-id="406d6-113">A notification handler is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="406d6-114">Il gestore delle notifiche deve implementare l'interfaccia [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) .</span><span class="sxs-lookup"><span data-stu-id="406d6-114">The notification handler must implement the [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) interface.</span></span>

<span data-ttu-id="406d6-115">Quando si verifica un evento che genera una notifica, lo snap-in utenti e computer enumera i gestori delle notifiche registrati e li crea utilizzando il CLSID per il gestore.</span><span class="sxs-lookup"><span data-stu-id="406d6-115">When an event occurs that will cause a notification, the Users and Computers snap-in enumerates the registered notification handlers and creates each one using the CLSID for the handler.</span></span> <span data-ttu-id="406d6-116">Dopo la creazione del gestore, lo snap-in chiama il metodo [**IDsAdminNotifyHandler:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) .</span><span class="sxs-lookup"><span data-stu-id="406d6-116">After the handler is created, the snap-in calls the [**IDsAdminNotifyHandler::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) method.</span></span> <span data-ttu-id="406d6-117">Il metodo **Initialize** fornisce lo snap-in con gli eventi che devono essere ricevuti dal gestore.</span><span class="sxs-lookup"><span data-stu-id="406d6-117">The **Initialize** method supplies the snap-in with the events the handler should receive.</span></span>

<span data-ttu-id="406d6-118">Se l'evento è un evento che deve essere inviato al gestore di notifiche, lo snap-in chiama il metodo [**IDsAdminNotifyHandler:: Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) .</span><span class="sxs-lookup"><span data-stu-id="406d6-118">If the event is one that should be sent to the notification handler, the snap-in calls the [**IDsAdminNotifyHandler::Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method.</span></span> <span data-ttu-id="406d6-119">Il metodo **Begin** fornisce il gestore con l'evento che si verifica, i dati sull'oggetto su cui si sta verificando l'evento e, a seconda dell'evento, i dati relativi all'oggetto diventerà.</span><span class="sxs-lookup"><span data-stu-id="406d6-119">The **Begin** method provides the handler with the event occurring, data about the object that the event is occurring on and, depending on the event, data about what the object will become.</span></span> <span data-ttu-id="406d6-120">Il metodo **Begin** fornisce inoltre lo snap-in con il testo da visualizzare per il gestore nella finestra di dialogo di conferma.</span><span class="sxs-lookup"><span data-stu-id="406d6-120">The **Begin** method also provides the snap-in with the text that should be displayed for the handler in the confirmation dialog box.</span></span>

<span data-ttu-id="406d6-121">Quando viene chiamato il metodo [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) per ogni gestore, nello snap-in viene visualizzata la finestra di dialogo di conferma.</span><span class="sxs-lookup"><span data-stu-id="406d6-121">When the [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method for each handler has been called, the snap-in displays the confirmation dialog box.</span></span> <span data-ttu-id="406d6-122">La finestra di dialogo di conferma chiede all'utente di selezionare i gestori che riceveranno la notifica.</span><span class="sxs-lookup"><span data-stu-id="406d6-122">The confirmation dialog box prompts the user to select which handlers will receive the notification.</span></span> <span data-ttu-id="406d6-123">Se l'utente preme il pulsante **No** push nella finestra di dialogo di conferma, nessuno dei gestori riceve una notifica.</span><span class="sxs-lookup"><span data-stu-id="406d6-123">If the user presses the **No** push button in the confirmation dialog, none of the handlers are notified.</span></span> <span data-ttu-id="406d6-124">Se l'utente preme il pulsante **Sì** , ogni gestore selezionato nella finestra di dialogo di conferma riceve la notifica.</span><span class="sxs-lookup"><span data-stu-id="406d6-124">If the user presses the **Yes** push button, each of the handlers selected in the confirmation dialog box receive the notification.</span></span> <span data-ttu-id="406d6-125">Lo snap-in Invia la notifica al gestore chiamando il metodo [**IDsAdminNotifyHandler:: Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .</span><span class="sxs-lookup"><span data-stu-id="406d6-125">The snap-in sends the notification to the handler by calling the [**IDsAdminNotifyHandler::Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method.</span></span>

<span data-ttu-id="406d6-126">Dopo che tutti i gestori sono stati informati, lo snap-in chiama il metodo [**IDsAdminNotifyHandler:: end**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) .</span><span class="sxs-lookup"><span data-stu-id="406d6-126">After all of the handlers have been notified, the snap-in calls the [**IDsAdminNotifyHandler::End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) method.</span></span> <span data-ttu-id="406d6-127">Il metodo **end** viene sempre chiamato, anche se il metodo [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) non viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="406d6-127">The **End** method is always called, even if the [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method is not called.</span></span>

## <a name="registering-a-notification-handler-in-the-windows-registry"></a><span data-ttu-id="406d6-128">Registrazione di un gestore notifiche nel registro di sistema di Windows</span><span class="sxs-lookup"><span data-stu-id="406d6-128">Registering a Notification Handler in the Windows Registry</span></span>

<span data-ttu-id="406d6-129">Come tutti i server COM, un gestore di notifiche deve essere registrato nel registro di sistema di Windows.</span><span class="sxs-lookup"><span data-stu-id="406d6-129">Like all COM servers, a notification handler must be registered in the Windows registry.</span></span> <span data-ttu-id="406d6-130">Il gestore viene registrato con la seguente chiave:</span><span class="sxs-lookup"><span data-stu-id="406d6-130">The handler is registered under the following key:</span></span>


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



<span data-ttu-id="406d6-131">**<CLSID>** rappresentazione di stringa del CLSID come prodotto dalla funzione [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="406d6-131">**<CLSID>** is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="406d6-132">Sotto la **<CLSID>** chiave è presente una chiave **InprocServer32** che identifica l'oggetto come server in-process a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="406d6-132">Under the **<CLSID>** key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="406d6-133">Nella chiave **InprocServer32** il percorso della dll viene specificato nel valore predefinito e il modello di Threading viene specificato nel valore **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="406d6-133">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="406d6-134">Tutti i gestori di notifiche devono utilizzare il modello di threading dell' **Apartment** .</span><span class="sxs-lookup"><span data-stu-id="406d6-134">All notification handlers must use the **Apartment** threading model.</span></span>

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a><span data-ttu-id="406d6-135">Registrazione di un gestore di notifiche con un server di Active Directory</span><span class="sxs-lookup"><span data-stu-id="406d6-135">Registering a Notification Handler with an Active Directory Server</span></span>

<span data-ttu-id="406d6-136">All'interno Active Directory Domain Services la registrazione del gestore delle notifiche è specifica di un'impostazione locale.</span><span class="sxs-lookup"><span data-stu-id="406d6-136">Within Active Directory Domain Services, notification handler registration is specific to one locale.</span></span> <span data-ttu-id="406d6-137">Se il gestore di notifiche si applica a tutte le impostazioni locali, è necessario registrarlo nell'oggetto **displaySpecifier** in tutti i sottocontenitori delle impostazioni locali nel contenitore DisplaySpecifiers.</span><span class="sxs-lookup"><span data-stu-id="406d6-137">If the notification handler applies to all locales, it must be registered in the **displaySpecifier** object in all of the locale subcontainers in the DisplaySpecifiers container.</span></span> <span data-ttu-id="406d6-138">Se il gestore delle notifiche è localizzato per determinate impostazioni locali, viene registrato nell'oggetto **displaySpecifier** del sottocontenitore delle impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="406d6-138">If the notification handler is localized for a certain locale, it is registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="406d6-139">Per altre informazioni sul contenitore e sulle impostazioni locali di DisplaySpecifiers, vedere [identificatori di visualizzazione](display-specifiers.md) e [contenitore DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="406d6-139">For more information about the DisplaySpecifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="406d6-140">I gestori di notifiche sono registrati nell'attributo **dsUIAdminNotification** nel contenitore **DS-UI-default-settings** .</span><span class="sxs-lookup"><span data-stu-id="406d6-140">Notification handlers are registered under the **dsUIAdminNotification** attribute in the **DS-UI-Default-Settings** container.</span></span> <span data-ttu-id="406d6-141">Si tratta di un valore stringa Unicode multivalore in cui ogni valore richiede il formato seguente:</span><span class="sxs-lookup"><span data-stu-id="406d6-141">This a multi-valued Unicode string value where each value requires the following format:</span></span>


```C++
<order number>,<CLSID>
```



<span data-ttu-id="406d6-142">Il " &lt; numero di ordine &gt; " è un numero senza segno che rappresenta la posizione del gestore nella finestra di dialogo di conferma.</span><span class="sxs-lookup"><span data-stu-id="406d6-142">The "&lt;order number&gt;" is an unsigned number that represents the position of the handler in the confirmation dialog.</span></span> <span data-ttu-id="406d6-143">Quando viene visualizzata la finestra di dialogo di conferma, i valori vengono ordinati usando un confronto tra il "numero di ordine" di ogni valore &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="406d6-143">When the confirmation dialog is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="406d6-144">Se più di un valore ha lo stesso " &lt; numero &gt; di ordine", tali gestori vengono visualizzati nell'ordine in cui vengono letti dal server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="406d6-144">If more than one value has the same "&lt;order number&gt;", those handlers are displayed in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="406d6-145">Un oggetto non esistente, ovvero uno non usato da altri valori nella proprietà, &lt; &gt; se possibile, deve essere usato "Order Number".</span><span class="sxs-lookup"><span data-stu-id="406d6-145">A non-existing, that is, one not used by other values in the property, "&lt;order number&gt;" should be used if possible.</span></span> <span data-ttu-id="406d6-146">Non esiste alcuna posizione di inizio prescritta e i gap possono comparire nella &lt; sequenza "Numero ordine &gt; ".</span><span class="sxs-lookup"><span data-stu-id="406d6-146">There is no prescribed starting position, and gaps can appear in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="406d6-147">" &lt; CLSID &gt; " è la rappresentazione di stringa del CLSID come prodotto dalla funzione [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="406d6-147">The "&lt;CLSID&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

 

 